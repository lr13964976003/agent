<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="29pt" height="2520pt"
 viewBox="0.00 0.00 28.91 2520.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.02 0.02) rotate(0) translate(4 156992.89)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-156992.89 1797,-156992.89 1797,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightgray" stroke="black" d="M551.5,-156470.98C551.5,-156470.98 1243.5,-156470.98 1243.5,-156470.98 1249.5,-156470.98 1255.5,-156476.98 1255.5,-156482.98 1255.5,-156482.98 1255.5,-156897.15 1255.5,-156897.15 1255.5,-156903.15 1249.5,-156909.15 1243.5,-156909.15 1243.5,-156909.15 551.5,-156909.15 551.5,-156909.15 545.5,-156909.15 539.5,-156903.15 539.5,-156897.15 539.5,-156897.15 539.5,-156482.98 539.5,-156482.98 539.5,-156476.98 545.5,-156470.98 551.5,-156470.98"/>
<text text-anchor="middle" x="897.5" y="-156893.95" font-family="Times,serif" font-size="14.00">Stage 0: GPUs [0,1]</text>
<text text-anchor="middle" x="897.5" y="-156878.95" font-family="Times,serif" font-size="14.00">Layers 0&#45;19</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgray" stroke="black" d="M435.5,-117214.54C435.5,-117214.54 1127.5,-117214.54 1127.5,-117214.54 1133.5,-117214.54 1139.5,-117220.54 1139.5,-117226.54 1139.5,-117226.54 1139.5,-117640.7 1139.5,-117640.7 1139.5,-117646.7 1133.5,-117652.7 1127.5,-117652.7 1127.5,-117652.7 435.5,-117652.7 435.5,-117652.7 429.5,-117652.7 423.5,-117646.7 423.5,-117640.7 423.5,-117640.7 423.5,-117226.54 423.5,-117226.54 423.5,-117220.54 429.5,-117214.54 435.5,-117214.54"/>
<text text-anchor="middle" x="781.5" y="-117637.5" font-family="Times,serif" font-size="14.00">Stage 1: GPUs [2,3]</text>
<text text-anchor="middle" x="781.5" y="-117622.5" font-family="Times,serif" font-size="14.00">Layers 20&#45;39</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="lightgray" stroke="black" d="M371.5,-77958.1C371.5,-77958.1 1063.5,-77958.1 1063.5,-77958.1 1069.5,-77958.1 1075.5,-77964.1 1075.5,-77970.1 1075.5,-77970.1 1075.5,-78384.26 1075.5,-78384.26 1075.5,-78390.26 1069.5,-78396.26 1063.5,-78396.26 1063.5,-78396.26 371.5,-78396.26 371.5,-78396.26 365.5,-78396.26 359.5,-78390.26 359.5,-78384.26 359.5,-78384.26 359.5,-77970.1 359.5,-77970.1 359.5,-77964.1 365.5,-77958.1 371.5,-77958.1"/>
<text text-anchor="middle" x="717.5" y="-78381.06" font-family="Times,serif" font-size="14.00">Stage 2: GPUs [4,5]</text>
<text text-anchor="middle" x="717.5" y="-78366.06" font-family="Times,serif" font-size="14.00">Layers 40&#45;59</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="lightgray" stroke="black" d="M174.5,-38673.49C174.5,-38673.49 866.5,-38673.49 866.5,-38673.49 872.5,-38673.49 878.5,-38679.49 878.5,-38685.49 878.5,-38685.49 878.5,-39127.82 878.5,-39127.82 878.5,-39133.82 872.5,-39139.82 866.5,-39139.82 866.5,-39139.82 174.5,-39139.82 174.5,-39139.82 168.5,-39139.82 162.5,-39133.82 162.5,-39127.82 162.5,-39127.82 162.5,-38685.49 162.5,-38685.49 162.5,-38679.49 168.5,-38673.49 174.5,-38673.49"/>
<text text-anchor="middle" x="520.5" y="-39124.62" font-family="Times,serif" font-size="14.00">Stage 3: GPUs [6,7]</text>
<text text-anchor="middle" x="520.5" y="-39109.62" font-family="Times,serif" font-size="14.00">Layers 60&#45;79</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="897.5" cy="-156962.02" rx="239" ry="26.74"/>
<text text-anchor="middle" x="897.5" y="-156965.82" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="897.5" y="-156950.82" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=8192]</text>
</g>
<!-- split_stage0 -->
<g id="node2" class="node">
<title>split_stage0</title>
<polygon fill="lightyellow" stroke="black" points="1247.85,-156863.15 690.52,-156863.15 547.15,-156787.15 1104.48,-156787.15 1247.85,-156863.15"/>
<text text-anchor="middle" x="897.5" y="-156828.95" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="897.5" y="-156813.95" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;split_stage0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;split_stage0</title>
<path fill="none" stroke="black" d="M897.5,-156934.98C897.5,-156934.98 897.5,-156873.27 897.5,-156873.27"/>
<polygon fill="black" stroke="black" points="901,-156873.27 897.5,-156863.27 894,-156873.27 901,-156873.27"/>
</g>
<!-- layer0_embed_0 -->
<g id="node3" class="node">
<title>layer0_embed_0</title>
<polygon fill="#ffe6e6" stroke="black" points="850.5,-156715.15 678.5,-156715.15 678.5,-156647.15 850.5,-156647.15 850.5,-156715.15"/>
<text text-anchor="middle" x="764.5" y="-156699.95" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="764.5" y="-156684.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="764.5" y="-156669.95" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="764.5" y="-156654.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage0&#45;&gt;layer0_embed_0 -->
<g id="edge2" class="edge">
<title>split_stage0&#45;&gt;layer0_embed_0</title>
<path fill="none" stroke="black" d="M764.5,-156786.93C764.5,-156786.93 764.5,-156725.59 764.5,-156725.59"/>
<polygon fill="black" stroke="black" points="768,-156725.59 764.5,-156715.59 761,-156725.59 768,-156725.59"/>
</g>
<!-- layer0_embed_1 -->
<g id="node4" class="node">
<title>layer0_embed_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1058.5,-156715.15 886.5,-156715.15 886.5,-156647.15 1058.5,-156647.15 1058.5,-156715.15"/>
<text text-anchor="middle" x="972.5" y="-156699.95" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="972.5" y="-156684.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="972.5" y="-156669.95" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="972.5" y="-156654.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage0&#45;&gt;layer0_embed_1 -->
<g id="edge3" class="edge">
<title>split_stage0&#45;&gt;layer0_embed_1</title>
<path fill="none" stroke="black" d="M972.5,-156786.93C972.5,-156786.93 972.5,-156725.59 972.5,-156725.59"/>
<polygon fill="black" stroke="black" points="976,-156725.59 972.5,-156715.59 969,-156725.59 976,-156725.59"/>
</g>
<!-- embed_ag_stage0 -->
<g id="node7" class="node">
<title>embed_ag_stage0</title>
<ellipse fill="lightblue" stroke="black" cx="868.5" cy="-156527.06" rx="124.4" ry="48.17"/>
<text text-anchor="middle" x="868.5" y="-156545.86" font-family="Times,serif" font-size="14.00">All&#45;Gather Embedding</text>
<text text-anchor="middle" x="868.5" y="-156530.86" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="868.5" y="-156515.86" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="868.5" y="-156500.86" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_embed_0&#45;&gt;embed_ag_stage0 -->
<g id="edge644" class="edge">
<title>layer0_embed_0&#45;&gt;embed_ag_stage0</title>
<path fill="none" stroke="black" d="M797.27,-156646.95C797.27,-156646.95 797.27,-156576.61 797.27,-156576.61"/>
<polygon fill="black" stroke="black" points="800.77,-156576.61 797.27,-156566.61 793.77,-156576.61 800.77,-156576.61"/>
</g>
<!-- layer0_embed_1&#45;&gt;embed_ag_stage0 -->
<g id="edge645" class="edge">
<title>layer0_embed_1&#45;&gt;embed_ag_stage0</title>
<path fill="none" stroke="black" d="M939.73,-156646.95C939.73,-156646.95 939.73,-156576.61 939.73,-156576.61"/>
<polygon fill="black" stroke="black" points="943.23,-156576.61 939.73,-156566.61 936.23,-156576.61 943.23,-156576.61"/>
</g>
<!-- layer0_norm_0 -->
<g id="node5" class="node">
<title>layer0_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="849.5,-156406.98 677.5,-156406.98 677.5,-156338.98 849.5,-156338.98 849.5,-156406.98"/>
<text text-anchor="middle" x="763.5" y="-156391.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="763.5" y="-156376.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="763.5" y="-156361.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="763.5" y="-156346.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_qkv_0 -->
<g id="node8" class="node">
<title>layer0_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="850,-156266.98 669,-156266.98 669,-156198.98 850,-156198.98 850,-156266.98"/>
<text text-anchor="middle" x="759.5" y="-156251.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="759.5" y="-156236.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="759.5" y="-156221.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="759.5" y="-156206.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer0_norm_0&#45;&gt;layer0_qkv_0 -->
<g id="edge6" class="edge">
<title>layer0_norm_0&#45;&gt;layer0_qkv_0</title>
<path fill="none" stroke="black" d="M763.5,-156338.73C763.5,-156338.73 763.5,-156277.36 763.5,-156277.36"/>
<polygon fill="black" stroke="black" points="767,-156277.36 763.5,-156267.36 760,-156277.36 767,-156277.36"/>
</g>
<!-- layer0_norm_1 -->
<g id="node6" class="node">
<title>layer0_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1059.5,-156406.98 887.5,-156406.98 887.5,-156338.98 1059.5,-156338.98 1059.5,-156406.98"/>
<text text-anchor="middle" x="973.5" y="-156391.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="973.5" y="-156376.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="973.5" y="-156361.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="973.5" y="-156346.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_qkv_1 -->
<g id="node9" class="node">
<title>layer0_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1067,-156266.98 886,-156266.98 886,-156198.98 1067,-156198.98 1067,-156266.98"/>
<text text-anchor="middle" x="976.5" y="-156251.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="976.5" y="-156236.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="976.5" y="-156221.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="976.5" y="-156206.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer0_norm_1&#45;&gt;layer0_qkv_1 -->
<g id="edge7" class="edge">
<title>layer0_norm_1&#45;&gt;layer0_qkv_1</title>
<path fill="none" stroke="black" d="M973.5,-156338.73C973.5,-156338.73 973.5,-156277.36 973.5,-156277.36"/>
<polygon fill="black" stroke="black" points="977,-156277.36 973.5,-156267.36 970,-156277.36 977,-156277.36"/>
</g>
<!-- embed_ag_stage0&#45;&gt;layer0_norm_0 -->
<g id="edge4" class="edge">
<title>embed_ag_stage0&#45;&gt;layer0_norm_0</title>
<path fill="none" stroke="black" d="M796.77,-156487.38C796.77,-156487.38 796.77,-156417.04 796.77,-156417.04"/>
<polygon fill="black" stroke="black" points="800.27,-156417.04 796.77,-156407.04 793.27,-156417.04 800.27,-156417.04"/>
</g>
<!-- embed_ag_stage0&#45;&gt;layer0_norm_1 -->
<g id="edge5" class="edge">
<title>embed_ag_stage0&#45;&gt;layer0_norm_1</title>
<path fill="none" stroke="black" d="M940.23,-156487.38C940.23,-156487.38 940.23,-156417.04 940.23,-156417.04"/>
<polygon fill="black" stroke="black" points="943.73,-156417.04 940.23,-156407.04 936.73,-156417.04 943.73,-156417.04"/>
</g>
<!-- layer0_qkv_ar -->
<g id="node10" class="node">
<title>layer0_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="867.5" cy="-156078.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="867.5" y="-156097.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="867.5" y="-156082.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="867.5" y="-156067.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="867.5" y="-156052.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer0_qkv_0&#45;&gt;layer0_qkv_ar -->
<g id="edge8" class="edge">
<title>layer0_qkv_0&#45;&gt;layer0_qkv_ar</title>
<path fill="none" stroke="black" d="M794.76,-156198.78C794.76,-156198.78 794.76,-156128.72 794.76,-156128.72"/>
<polygon fill="black" stroke="black" points="798.26,-156128.72 794.76,-156118.72 791.26,-156128.72 798.26,-156128.72"/>
</g>
<!-- layer0_qkv_1&#45;&gt;layer0_qkv_ar -->
<g id="edge9" class="edge">
<title>layer0_qkv_1&#45;&gt;layer0_qkv_ar</title>
<path fill="none" stroke="black" d="M940.74,-156198.78C940.74,-156198.78 940.74,-156128.44 940.74,-156128.44"/>
<polygon fill="black" stroke="black" points="944.24,-156128.44 940.74,-156118.44 937.24,-156128.44 944.24,-156128.44"/>
</g>
<!-- layer0_attn_0 -->
<g id="node11" class="node">
<title>layer0_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="849.5,-155958.81 677.5,-155958.81 677.5,-155890.81 849.5,-155890.81 849.5,-155958.81"/>
<text text-anchor="middle" x="763.5" y="-155943.61" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="763.5" y="-155928.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="763.5" y="-155913.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="763.5" y="-155898.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer0_qkv_ar&#45;&gt;layer0_attn_0 -->
<g id="edge10" class="edge">
<title>layer0_qkv_ar&#45;&gt;layer0_attn_0</title>
<path fill="none" stroke="black" d="M794.51,-156039.22C794.51,-156039.22 794.51,-155968.87 794.51,-155968.87"/>
<polygon fill="black" stroke="black" points="798.01,-155968.87 794.51,-155958.87 791.01,-155968.87 798.01,-155968.87"/>
</g>
<!-- layer0_attn_1 -->
<g id="node12" class="node">
<title>layer0_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1057.5,-155958.81 885.5,-155958.81 885.5,-155890.81 1057.5,-155890.81 1057.5,-155958.81"/>
<text text-anchor="middle" x="971.5" y="-155943.61" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="971.5" y="-155928.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="971.5" y="-155913.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="971.5" y="-155898.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer0_qkv_ar&#45;&gt;layer0_attn_1 -->
<g id="edge11" class="edge">
<title>layer0_qkv_ar&#45;&gt;layer0_attn_1</title>
<path fill="none" stroke="black" d="M940.49,-156039.22C940.49,-156039.22 940.49,-155968.87 940.49,-155968.87"/>
<polygon fill="black" stroke="black" points="943.99,-155968.87 940.49,-155958.87 936.99,-155968.87 943.99,-155968.87"/>
</g>
<!-- layer0_attn_out_0 -->
<g id="node13" class="node">
<title>layer0_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="849.5,-155818.81 677.5,-155818.81 677.5,-155750.81 849.5,-155750.81 849.5,-155818.81"/>
<text text-anchor="middle" x="763.5" y="-155803.61" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="763.5" y="-155788.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="763.5" y="-155773.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="763.5" y="-155758.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer0_attn_0&#45;&gt;layer0_attn_out_0 -->
<g id="edge12" class="edge">
<title>layer0_attn_0&#45;&gt;layer0_attn_out_0</title>
<path fill="none" stroke="black" d="M763.5,-155890.57C763.5,-155890.57 763.5,-155829.19 763.5,-155829.19"/>
<polygon fill="black" stroke="black" points="767,-155829.19 763.5,-155819.19 760,-155829.19 767,-155829.19"/>
</g>
<!-- layer0_attn_out_1 -->
<g id="node14" class="node">
<title>layer0_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1057.5,-155818.81 885.5,-155818.81 885.5,-155750.81 1057.5,-155750.81 1057.5,-155818.81"/>
<text text-anchor="middle" x="971.5" y="-155803.61" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="971.5" y="-155788.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="971.5" y="-155773.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="971.5" y="-155758.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer0_attn_1&#45;&gt;layer0_attn_out_1 -->
<g id="edge13" class="edge">
<title>layer0_attn_1&#45;&gt;layer0_attn_out_1</title>
<path fill="none" stroke="black" d="M971.5,-155890.57C971.5,-155890.57 971.5,-155829.19 971.5,-155829.19"/>
<polygon fill="black" stroke="black" points="975,-155829.19 971.5,-155819.19 968,-155829.19 975,-155829.19"/>
</g>
<!-- layer0_attn_ar -->
<g id="node15" class="node">
<title>layer0_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="867.5" cy="-155630.73" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="867.5" y="-155649.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="867.5" y="-155634.53" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="867.5" y="-155619.53" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="867.5" y="-155604.53" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_attn_out_0&#45;&gt;layer0_attn_ar -->
<g id="edge14" class="edge">
<title>layer0_attn_out_0&#45;&gt;layer0_attn_ar</title>
<path fill="none" stroke="black" d="M797.69,-155750.62C797.69,-155750.62 797.69,-155680.27 797.69,-155680.27"/>
<polygon fill="black" stroke="black" points="801.19,-155680.27 797.69,-155670.27 794.19,-155680.27 801.19,-155680.27"/>
</g>
<!-- layer0_attn_out_1&#45;&gt;layer0_attn_ar -->
<g id="edge15" class="edge">
<title>layer0_attn_out_1&#45;&gt;layer0_attn_ar</title>
<path fill="none" stroke="black" d="M937.31,-155750.62C937.31,-155750.62 937.31,-155680.27 937.31,-155680.27"/>
<polygon fill="black" stroke="black" points="940.81,-155680.27 937.31,-155670.27 933.81,-155680.27 940.81,-155680.27"/>
</g>
<!-- layer0_ffn_norm_0 -->
<g id="node16" class="node">
<title>layer0_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="845.5,-155510.65 673.5,-155510.65 673.5,-155442.65 845.5,-155442.65 845.5,-155510.65"/>
<text text-anchor="middle" x="759.5" y="-155495.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="759.5" y="-155480.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="759.5" y="-155465.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="759.5" y="-155450.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_attn_ar&#45;&gt;layer0_ffn_norm_0 -->
<g id="edge16" class="edge">
<title>layer0_attn_ar&#45;&gt;layer0_ffn_norm_0</title>
<path fill="none" stroke="black" d="M795.69,-155591.85C795.69,-155591.85 795.69,-155520.79 795.69,-155520.79"/>
<polygon fill="black" stroke="black" points="799.19,-155520.79 795.69,-155510.79 792.19,-155520.79 799.19,-155520.79"/>
</g>
<!-- layer0_ffn_norm_1 -->
<g id="node17" class="node">
<title>layer0_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1062.5,-155510.65 890.5,-155510.65 890.5,-155442.65 1062.5,-155442.65 1062.5,-155510.65"/>
<text text-anchor="middle" x="976.5" y="-155495.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="976.5" y="-155480.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="976.5" y="-155465.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="976.5" y="-155450.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_attn_ar&#45;&gt;layer0_ffn_norm_1 -->
<g id="edge17" class="edge">
<title>layer0_attn_ar&#45;&gt;layer0_ffn_norm_1</title>
<path fill="none" stroke="black" d="M939.81,-155591.85C939.81,-155591.85 939.81,-155520.79 939.81,-155520.79"/>
<polygon fill="black" stroke="black" points="943.31,-155520.79 939.81,-155510.79 936.31,-155520.79 943.31,-155520.79"/>
</g>
<!-- layer0_ffn_gate_0 -->
<g id="node18" class="node">
<title>layer0_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="850,-155370.65 669,-155370.65 669,-155302.65 850,-155302.65 850,-155370.65"/>
<text text-anchor="middle" x="759.5" y="-155355.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="759.5" y="-155340.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="759.5" y="-155325.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="759.5" y="-155310.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_ffn_norm_0&#45;&gt;layer0_ffn_gate_0 -->
<g id="edge18" class="edge">
<title>layer0_ffn_norm_0&#45;&gt;layer0_ffn_gate_0</title>
<path fill="none" stroke="black" d="M759.5,-155442.4C759.5,-155442.4 759.5,-155381.03 759.5,-155381.03"/>
<polygon fill="black" stroke="black" points="763,-155381.03 759.5,-155371.03 756,-155381.03 763,-155381.03"/>
</g>
<!-- layer0_ffn_up_0 -->
<g id="node20" class="node">
<title>layer0_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="633,-155370.65 452,-155370.65 452,-155302.65 633,-155302.65 633,-155370.65"/>
<text text-anchor="middle" x="542.5" y="-155355.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="542.5" y="-155340.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="542.5" y="-155325.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="542.5" y="-155310.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_ffn_norm_0&#45;&gt;layer0_ffn_up_0 -->
<g id="edge20" class="edge">
<title>layer0_ffn_norm_0&#45;&gt;layer0_ffn_up_0</title>
<path fill="none" stroke="black" d="M673.28,-155476C631.42,-155476 590.04,-155476 590.04,-155476 590.04,-155476 590.04,-155380.74 590.04,-155380.74"/>
<polygon fill="black" stroke="black" points="593.54,-155380.74 590.04,-155370.74 586.54,-155380.74 593.54,-155380.74"/>
</g>
<!-- layer0_ffn_gate_1 -->
<g id="node19" class="node">
<title>layer0_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1284,-155370.65 1103,-155370.65 1103,-155302.65 1284,-155302.65 1284,-155370.65"/>
<text text-anchor="middle" x="1193.5" y="-155355.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1193.5" y="-155340.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1193.5" y="-155325.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1193.5" y="-155310.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_ffn_norm_1&#45;&gt;layer0_ffn_gate_1 -->
<g id="edge19" class="edge">
<title>layer0_ffn_norm_1&#45;&gt;layer0_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1062.61,-155476C1116.38,-155476 1175.46,-155476 1175.46,-155476 1175.46,-155476 1175.46,-155380.74 1175.46,-155380.74"/>
<polygon fill="black" stroke="black" points="1178.96,-155380.74 1175.46,-155370.74 1171.96,-155380.74 1178.96,-155380.74"/>
</g>
<!-- layer0_ffn_up_1 -->
<g id="node21" class="node">
<title>layer0_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1067,-155370.65 886,-155370.65 886,-155302.65 1067,-155302.65 1067,-155370.65"/>
<text text-anchor="middle" x="976.5" y="-155355.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="976.5" y="-155340.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="976.5" y="-155325.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="976.5" y="-155310.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_ffn_norm_1&#45;&gt;layer0_ffn_up_1 -->
<g id="edge21" class="edge">
<title>layer0_ffn_norm_1&#45;&gt;layer0_ffn_up_1</title>
<path fill="none" stroke="black" d="M976.5,-155442.4C976.5,-155442.4 976.5,-155381.03 976.5,-155381.03"/>
<polygon fill="black" stroke="black" points="980,-155381.03 976.5,-155371.03 973,-155381.03 980,-155381.03"/>
</g>
<!-- layer0_gate_ar -->
<g id="node22" class="node">
<title>layer0_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1067.5" cy="-155182.56" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1067.5" y="-155201.36" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1067.5" y="-155186.36" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1067.5" y="-155171.36" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1067.5" y="-155156.36" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer0_ffn_gate_0&#45;&gt;layer0_gate_ar -->
<g id="edge22" class="edge">
<title>layer0_ffn_gate_0&#45;&gt;layer0_gate_ar</title>
<path fill="none" stroke="black" d="M850.08,-155336C860.79,-155336 868,-155336 868,-155336 868,-155336 868,-155198 868,-155198 868,-155198 936.28,-155198 936.28,-155198"/>
<polygon fill="black" stroke="black" points="936.28,-155201.5 946.28,-155198 936.28,-155194.5 936.28,-155201.5"/>
</g>
<!-- layer0_ffn_gate_1&#45;&gt;layer0_gate_ar -->
<g id="edge23" class="edge">
<title>layer0_ffn_gate_1&#45;&gt;layer0_gate_ar</title>
<path fill="none" stroke="black" d="M1149.24,-155302.45C1149.24,-155302.45 1149.24,-155229.63 1149.24,-155229.63"/>
<polygon fill="black" stroke="black" points="1152.74,-155229.63 1149.24,-155219.63 1145.74,-155229.63 1152.74,-155229.63"/>
</g>
<!-- layer0_up_ar -->
<g id="node23" class="node">
<title>layer0_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="721.5" cy="-155182.56" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="721.5" y="-155201.36" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="721.5" y="-155186.36" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="721.5" y="-155171.36" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="721.5" y="-155156.36" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer0_ffn_up_0&#45;&gt;layer0_up_ar -->
<g id="edge24" class="edge">
<title>layer0_ffn_up_0&#45;&gt;layer0_up_ar</title>
<path fill="none" stroke="black" d="M613.26,-155302.45C613.26,-155302.45 613.26,-155218.53 613.26,-155218.53"/>
<polygon fill="black" stroke="black" points="616.76,-155218.53 613.26,-155208.53 609.76,-155218.53 616.76,-155218.53"/>
</g>
<!-- layer0_ffn_up_1&#45;&gt;layer0_up_ar -->
<g id="edge25" class="edge">
<title>layer0_ffn_up_1&#45;&gt;layer0_up_ar</title>
<path fill="none" stroke="black" d="M912.76,-155302.52C912.76,-155252.72 912.76,-155166 912.76,-155166 912.76,-155166 851.81,-155166 851.81,-155166"/>
<polygon fill="black" stroke="black" points="851.81,-155162.5 841.81,-155166 851.81,-155169.5 851.81,-155162.5"/>
</g>
<!-- layer0_silu_0 -->
<g id="node24" class="node">
<title>layer0_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="995,-155062.48 814,-155062.48 814,-154994.48 995,-154994.48 995,-155062.48"/>
<text text-anchor="middle" x="904.5" y="-155047.28" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="904.5" y="-155032.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="904.5" y="-155017.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="904.5" y="-155002.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_gate_ar&#45;&gt;layer0_silu_0 -->
<g id="edge26" class="edge">
<title>layer0_gate_ar&#45;&gt;layer0_silu_0</title>
<path fill="none" stroke="black" d="M967.26,-155152.49C967.26,-155152.49 967.26,-155072.5 967.26,-155072.5"/>
<polygon fill="black" stroke="black" points="970.76,-155072.5 967.26,-155062.5 963.76,-155072.5 970.76,-155072.5"/>
</g>
<!-- layer0_silu_1 -->
<g id="node25" class="node">
<title>layer0_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1212,-155062.48 1031,-155062.48 1031,-154994.48 1212,-154994.48 1212,-155062.48"/>
<text text-anchor="middle" x="1121.5" y="-155047.28" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1121.5" y="-155032.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1121.5" y="-155017.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1121.5" y="-155002.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_gate_ar&#45;&gt;layer0_silu_1 -->
<g id="edge27" class="edge">
<title>layer0_gate_ar&#45;&gt;layer0_silu_1</title>
<path fill="none" stroke="black" d="M1113.24,-155137.58C1113.24,-155137.58 1113.24,-155072.49 1113.24,-155072.49"/>
<polygon fill="black" stroke="black" points="1116.74,-155072.49 1113.24,-155062.49 1109.74,-155072.49 1116.74,-155072.49"/>
</g>
<!-- layer0_mul_0 -->
<g id="node26" class="node">
<title>layer0_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="885,-154922.48 704,-154922.48 704,-154854.48 885,-154854.48 885,-154922.48"/>
<text text-anchor="middle" x="794.5" y="-154907.28" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="794.5" y="-154892.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="794.5" y="-154877.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="794.5" y="-154862.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_up_ar&#45;&gt;layer0_mul_0 -->
<g id="edge29" class="edge">
<title>layer0_up_ar&#45;&gt;layer0_mul_0</title>
<path fill="none" stroke="black" d="M759,-155136.29C759,-155136.29 759,-154932.56 759,-154932.56"/>
<polygon fill="black" stroke="black" points="762.5,-154932.56 759,-154922.56 755.5,-154932.56 762.5,-154932.56"/>
</g>
<!-- layer0_mul_1 -->
<g id="node27" class="node">
<title>layer0_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1102,-154922.48 921,-154922.48 921,-154854.48 1102,-154854.48 1102,-154922.48"/>
<text text-anchor="middle" x="1011.5" y="-154907.28" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1011.5" y="-154892.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1011.5" y="-154877.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1011.5" y="-154862.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer0_up_ar&#45;&gt;layer0_mul_1 -->
<g id="edge31" class="edge">
<title>layer0_up_ar&#45;&gt;layer0_mul_1</title>
<path fill="none" stroke="black" d="M831.74,-155158.1C831.74,-155133.13 831.74,-155098 831.74,-155098 831.74,-155098 1013,-155098 1013,-155098 1013,-155098 1013,-154932.61 1013,-154932.61"/>
<polygon fill="black" stroke="black" points="1016.5,-154932.61 1013,-154922.61 1009.5,-154932.61 1016.5,-154932.61"/>
</g>
<!-- layer0_silu_0&#45;&gt;layer0_mul_0 -->
<g id="edge28" class="edge">
<title>layer0_silu_0&#45;&gt;layer0_mul_0</title>
<path fill="none" stroke="black" d="M849.5,-154994.23C849.5,-154994.23 849.5,-154932.86 849.5,-154932.86"/>
<polygon fill="black" stroke="black" points="853,-154932.86 849.5,-154922.86 846,-154932.86 853,-154932.86"/>
</g>
<!-- layer0_silu_1&#45;&gt;layer0_mul_1 -->
<g id="edge30" class="edge">
<title>layer0_silu_1&#45;&gt;layer0_mul_1</title>
<path fill="none" stroke="black" d="M1066.5,-154994.23C1066.5,-154994.23 1066.5,-154932.86 1066.5,-154932.86"/>
<polygon fill="black" stroke="black" points="1070,-154932.86 1066.5,-154922.86 1063,-154932.86 1070,-154932.86"/>
</g>
<!-- layer0_ffn_down_0 -->
<g id="node28" class="node">
<title>layer0_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="884.5,-154782.48 712.5,-154782.48 712.5,-154714.48 884.5,-154714.48 884.5,-154782.48"/>
<text text-anchor="middle" x="798.5" y="-154767.28" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="798.5" y="-154752.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="798.5" y="-154737.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="798.5" y="-154722.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer0_mul_0&#45;&gt;layer0_ffn_down_0 -->
<g id="edge32" class="edge">
<title>layer0_mul_0&#45;&gt;layer0_ffn_down_0</title>
<path fill="none" stroke="black" d="M798.5,-154854.23C798.5,-154854.23 798.5,-154792.86 798.5,-154792.86"/>
<polygon fill="black" stroke="black" points="802,-154792.86 798.5,-154782.86 795,-154792.86 802,-154792.86"/>
</g>
<!-- layer0_ffn_down_1 -->
<g id="node29" class="node">
<title>layer0_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1094.5,-154782.48 922.5,-154782.48 922.5,-154714.48 1094.5,-154714.48 1094.5,-154782.48"/>
<text text-anchor="middle" x="1008.5" y="-154767.28" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1008.5" y="-154752.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1008.5" y="-154737.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1008.5" y="-154722.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer0_mul_1&#45;&gt;layer0_ffn_down_1 -->
<g id="edge33" class="edge">
<title>layer0_mul_1&#45;&gt;layer0_ffn_down_1</title>
<path fill="none" stroke="black" d="M1008.5,-154854.23C1008.5,-154854.23 1008.5,-154792.86 1008.5,-154792.86"/>
<polygon fill="black" stroke="black" points="1012,-154792.86 1008.5,-154782.86 1005,-154792.86 1012,-154792.86"/>
</g>
<!-- layer0_ffn_ar -->
<g id="node30" class="node">
<title>layer0_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="902.5" cy="-154594.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="902.5" y="-154613.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="902.5" y="-154598.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="902.5" y="-154583.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="902.5" y="-154568.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_ffn_down_0&#45;&gt;layer0_ffn_ar -->
<g id="edge34" class="edge">
<title>layer0_ffn_down_0&#45;&gt;layer0_ffn_ar</title>
<path fill="none" stroke="black" d="M832.69,-154714.28C832.69,-154714.28 832.69,-154643.94 832.69,-154643.94"/>
<polygon fill="black" stroke="black" points="836.19,-154643.94 832.69,-154633.94 829.19,-154643.94 836.19,-154643.94"/>
</g>
<!-- layer0_ffn_down_1&#45;&gt;layer0_ffn_ar -->
<g id="edge35" class="edge">
<title>layer0_ffn_down_1&#45;&gt;layer0_ffn_ar</title>
<path fill="none" stroke="black" d="M973.31,-154714.28C973.31,-154714.28 973.31,-154643.66 973.31,-154643.66"/>
<polygon fill="black" stroke="black" points="976.81,-154643.66 973.31,-154633.66 969.81,-154643.66 976.81,-154643.66"/>
</g>
<!-- layer1_norm_0 -->
<g id="node31" class="node">
<title>layer1_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="884.5,-154474.31 712.5,-154474.31 712.5,-154406.31 884.5,-154406.31 884.5,-154474.31"/>
<text text-anchor="middle" x="798.5" y="-154459.11" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="798.5" y="-154444.11" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="798.5" y="-154429.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="798.5" y="-154414.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_ffn_ar&#45;&gt;layer1_norm_0 -->
<g id="edge36" class="edge">
<title>layer0_ffn_ar&#45;&gt;layer1_norm_0</title>
<path fill="none" stroke="black" d="M832.69,-154554.72C832.69,-154554.72 832.69,-154484.37 832.69,-154484.37"/>
<polygon fill="black" stroke="black" points="836.19,-154484.37 832.69,-154474.37 829.19,-154484.37 836.19,-154484.37"/>
</g>
<!-- layer1_norm_1 -->
<g id="node32" class="node">
<title>layer1_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1094.5,-154474.31 922.5,-154474.31 922.5,-154406.31 1094.5,-154406.31 1094.5,-154474.31"/>
<text text-anchor="middle" x="1008.5" y="-154459.11" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1008.5" y="-154444.11" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1008.5" y="-154429.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1008.5" y="-154414.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer0_ffn_ar&#45;&gt;layer1_norm_1 -->
<g id="edge37" class="edge">
<title>layer0_ffn_ar&#45;&gt;layer1_norm_1</title>
<path fill="none" stroke="black" d="M973.31,-154555.12C973.31,-154555.12 973.31,-154484.54 973.31,-154484.54"/>
<polygon fill="black" stroke="black" points="976.81,-154484.54 973.31,-154474.54 969.81,-154484.54 976.81,-154484.54"/>
</g>
<!-- layer1_qkv_0 -->
<g id="node33" class="node">
<title>layer1_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="885,-154334.31 704,-154334.31 704,-154266.31 885,-154266.31 885,-154334.31"/>
<text text-anchor="middle" x="794.5" y="-154319.11" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="794.5" y="-154304.11" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="794.5" y="-154289.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="794.5" y="-154274.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer1_norm_0&#45;&gt;layer1_qkv_0 -->
<g id="edge38" class="edge">
<title>layer1_norm_0&#45;&gt;layer1_qkv_0</title>
<path fill="none" stroke="black" d="M798.5,-154406.07C798.5,-154406.07 798.5,-154344.69 798.5,-154344.69"/>
<polygon fill="black" stroke="black" points="802,-154344.69 798.5,-154334.69 795,-154344.69 802,-154344.69"/>
</g>
<!-- layer1_qkv_1 -->
<g id="node34" class="node">
<title>layer1_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1102,-154334.31 921,-154334.31 921,-154266.31 1102,-154266.31 1102,-154334.31"/>
<text text-anchor="middle" x="1011.5" y="-154319.11" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1011.5" y="-154304.11" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1011.5" y="-154289.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1011.5" y="-154274.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer1_norm_1&#45;&gt;layer1_qkv_1 -->
<g id="edge39" class="edge">
<title>layer1_norm_1&#45;&gt;layer1_qkv_1</title>
<path fill="none" stroke="black" d="M1008.5,-154406.07C1008.5,-154406.07 1008.5,-154344.69 1008.5,-154344.69"/>
<polygon fill="black" stroke="black" points="1012,-154344.69 1008.5,-154334.69 1005,-154344.69 1012,-154344.69"/>
</g>
<!-- layer1_qkv_ar -->
<g id="node35" class="node">
<title>layer1_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="902.5" cy="-154146.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="902.5" y="-154165.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="902.5" y="-154150.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="902.5" y="-154135.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="902.5" y="-154120.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer1_qkv_0&#45;&gt;layer1_qkv_ar -->
<g id="edge40" class="edge">
<title>layer1_qkv_0&#45;&gt;layer1_qkv_ar</title>
<path fill="none" stroke="black" d="M829.76,-154266.12C829.76,-154266.12 829.76,-154196.05 829.76,-154196.05"/>
<polygon fill="black" stroke="black" points="833.26,-154196.05 829.76,-154186.05 826.26,-154196.05 833.26,-154196.05"/>
</g>
<!-- layer1_qkv_1&#45;&gt;layer1_qkv_ar -->
<g id="edge41" class="edge">
<title>layer1_qkv_1&#45;&gt;layer1_qkv_ar</title>
<path fill="none" stroke="black" d="M975.74,-154266.12C975.74,-154266.12 975.74,-154195.77 975.74,-154195.77"/>
<polygon fill="black" stroke="black" points="979.24,-154195.77 975.74,-154185.77 972.24,-154195.77 979.24,-154195.77"/>
</g>
<!-- layer1_attn_0 -->
<g id="node36" class="node">
<title>layer1_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="884.5,-154026.15 712.5,-154026.15 712.5,-153958.15 884.5,-153958.15 884.5,-154026.15"/>
<text text-anchor="middle" x="798.5" y="-154010.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="798.5" y="-153995.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="798.5" y="-153980.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="798.5" y="-153965.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer1_qkv_ar&#45;&gt;layer1_attn_0 -->
<g id="edge42" class="edge">
<title>layer1_qkv_ar&#45;&gt;layer1_attn_0</title>
<path fill="none" stroke="black" d="M829.51,-154106.55C829.51,-154106.55 829.51,-154036.2 829.51,-154036.2"/>
<polygon fill="black" stroke="black" points="833.01,-154036.2 829.51,-154026.2 826.01,-154036.2 833.01,-154036.2"/>
</g>
<!-- layer1_attn_1 -->
<g id="node37" class="node">
<title>layer1_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1092.5,-154026.15 920.5,-154026.15 920.5,-153958.15 1092.5,-153958.15 1092.5,-154026.15"/>
<text text-anchor="middle" x="1006.5" y="-154010.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1006.5" y="-153995.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1006.5" y="-153980.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1006.5" y="-153965.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer1_qkv_ar&#45;&gt;layer1_attn_1 -->
<g id="edge43" class="edge">
<title>layer1_qkv_ar&#45;&gt;layer1_attn_1</title>
<path fill="none" stroke="black" d="M975.49,-154106.55C975.49,-154106.55 975.49,-154036.2 975.49,-154036.2"/>
<polygon fill="black" stroke="black" points="978.99,-154036.2 975.49,-154026.2 971.99,-154036.2 978.99,-154036.2"/>
</g>
<!-- layer1_attn_out_0 -->
<g id="node38" class="node">
<title>layer1_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="884.5,-153886.15 712.5,-153886.15 712.5,-153818.15 884.5,-153818.15 884.5,-153886.15"/>
<text text-anchor="middle" x="798.5" y="-153870.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="798.5" y="-153855.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="798.5" y="-153840.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="798.5" y="-153825.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer1_attn_0&#45;&gt;layer1_attn_out_0 -->
<g id="edge44" class="edge">
<title>layer1_attn_0&#45;&gt;layer1_attn_out_0</title>
<path fill="none" stroke="black" d="M798.5,-153957.9C798.5,-153957.9 798.5,-153896.53 798.5,-153896.53"/>
<polygon fill="black" stroke="black" points="802,-153896.53 798.5,-153886.53 795,-153896.53 802,-153896.53"/>
</g>
<!-- layer1_attn_out_1 -->
<g id="node39" class="node">
<title>layer1_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1092.5,-153886.15 920.5,-153886.15 920.5,-153818.15 1092.5,-153818.15 1092.5,-153886.15"/>
<text text-anchor="middle" x="1006.5" y="-153870.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1006.5" y="-153855.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1006.5" y="-153840.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1006.5" y="-153825.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer1_attn_1&#45;&gt;layer1_attn_out_1 -->
<g id="edge45" class="edge">
<title>layer1_attn_1&#45;&gt;layer1_attn_out_1</title>
<path fill="none" stroke="black" d="M1006.5,-153957.9C1006.5,-153957.9 1006.5,-153896.53 1006.5,-153896.53"/>
<polygon fill="black" stroke="black" points="1010,-153896.53 1006.5,-153886.53 1003,-153896.53 1010,-153896.53"/>
</g>
<!-- layer1_attn_ar -->
<g id="node40" class="node">
<title>layer1_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="902.5" cy="-153698.06" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="902.5" y="-153716.86" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="902.5" y="-153701.86" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="902.5" y="-153686.86" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="902.5" y="-153671.86" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_attn_out_0&#45;&gt;layer1_attn_ar -->
<g id="edge46" class="edge">
<title>layer1_attn_out_0&#45;&gt;layer1_attn_ar</title>
<path fill="none" stroke="black" d="M832.69,-153817.95C832.69,-153817.95 832.69,-153747.61 832.69,-153747.61"/>
<polygon fill="black" stroke="black" points="836.19,-153747.61 832.69,-153737.61 829.19,-153747.61 836.19,-153747.61"/>
</g>
<!-- layer1_attn_out_1&#45;&gt;layer1_attn_ar -->
<g id="edge47" class="edge">
<title>layer1_attn_out_1&#45;&gt;layer1_attn_ar</title>
<path fill="none" stroke="black" d="M972.31,-153817.95C972.31,-153817.95 972.31,-153747.61 972.31,-153747.61"/>
<polygon fill="black" stroke="black" points="975.81,-153747.61 972.31,-153737.61 968.81,-153747.61 975.81,-153747.61"/>
</g>
<!-- layer1_ffn_norm_0 -->
<g id="node41" class="node">
<title>layer1_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="880.5,-153577.98 708.5,-153577.98 708.5,-153509.98 880.5,-153509.98 880.5,-153577.98"/>
<text text-anchor="middle" x="794.5" y="-153562.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="794.5" y="-153547.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="794.5" y="-153532.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="794.5" y="-153517.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_attn_ar&#45;&gt;layer1_ffn_norm_0 -->
<g id="edge48" class="edge">
<title>layer1_attn_ar&#45;&gt;layer1_ffn_norm_0</title>
<path fill="none" stroke="black" d="M830.69,-153659.18C830.69,-153659.18 830.69,-153588.13 830.69,-153588.13"/>
<polygon fill="black" stroke="black" points="834.19,-153588.13 830.69,-153578.13 827.19,-153588.13 834.19,-153588.13"/>
</g>
<!-- layer1_ffn_norm_1 -->
<g id="node42" class="node">
<title>layer1_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1097.5,-153577.98 925.5,-153577.98 925.5,-153509.98 1097.5,-153509.98 1097.5,-153577.98"/>
<text text-anchor="middle" x="1011.5" y="-153562.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1011.5" y="-153547.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1011.5" y="-153532.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1011.5" y="-153517.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_attn_ar&#45;&gt;layer1_ffn_norm_1 -->
<g id="edge49" class="edge">
<title>layer1_attn_ar&#45;&gt;layer1_ffn_norm_1</title>
<path fill="none" stroke="black" d="M974.81,-153659.18C974.81,-153659.18 974.81,-153588.13 974.81,-153588.13"/>
<polygon fill="black" stroke="black" points="978.31,-153588.13 974.81,-153578.13 971.31,-153588.13 978.31,-153588.13"/>
</g>
<!-- layer1_ffn_gate_0 -->
<g id="node43" class="node">
<title>layer1_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="885,-153437.98 704,-153437.98 704,-153369.98 885,-153369.98 885,-153437.98"/>
<text text-anchor="middle" x="794.5" y="-153422.78" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="794.5" y="-153407.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="794.5" y="-153392.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="794.5" y="-153377.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_ffn_norm_0&#45;&gt;layer1_ffn_gate_0 -->
<g id="edge50" class="edge">
<title>layer1_ffn_norm_0&#45;&gt;layer1_ffn_gate_0</title>
<path fill="none" stroke="black" d="M794.5,-153509.73C794.5,-153509.73 794.5,-153448.36 794.5,-153448.36"/>
<polygon fill="black" stroke="black" points="798,-153448.36 794.5,-153438.36 791,-153448.36 798,-153448.36"/>
</g>
<!-- layer1_ffn_up_0 -->
<g id="node45" class="node">
<title>layer1_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="668,-153437.98 487,-153437.98 487,-153369.98 668,-153369.98 668,-153437.98"/>
<text text-anchor="middle" x="577.5" y="-153422.78" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="577.5" y="-153407.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="577.5" y="-153392.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="577.5" y="-153377.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_ffn_norm_0&#45;&gt;layer1_ffn_up_0 -->
<g id="edge52" class="edge">
<title>layer1_ffn_norm_0&#45;&gt;layer1_ffn_up_0</title>
<path fill="none" stroke="black" d="M708.31,-153543C668.86,-153543 630.76,-153543 630.76,-153543 630.76,-153543 630.76,-153447.99 630.76,-153447.99"/>
<polygon fill="black" stroke="black" points="634.26,-153447.99 630.76,-153437.99 627.26,-153447.99 634.26,-153447.99"/>
</g>
<!-- layer1_ffn_gate_1 -->
<g id="node44" class="node">
<title>layer1_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1319,-153437.98 1138,-153437.98 1138,-153369.98 1319,-153369.98 1319,-153437.98"/>
<text text-anchor="middle" x="1228.5" y="-153422.78" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1228.5" y="-153407.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1228.5" y="-153392.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1228.5" y="-153377.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_ffn_norm_1&#45;&gt;layer1_ffn_gate_1 -->
<g id="edge51" class="edge">
<title>layer1_ffn_norm_1&#45;&gt;layer1_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1097.56,-153543C1136.95,-153543 1175,-153543 1175,-153543 1175,-153543 1175,-153447.99 1175,-153447.99"/>
<polygon fill="black" stroke="black" points="1178.5,-153447.99 1175,-153437.99 1171.5,-153447.99 1178.5,-153447.99"/>
</g>
<!-- layer1_ffn_up_1 -->
<g id="node46" class="node">
<title>layer1_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1102,-153437.98 921,-153437.98 921,-153369.98 1102,-153369.98 1102,-153437.98"/>
<text text-anchor="middle" x="1011.5" y="-153422.78" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1011.5" y="-153407.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1011.5" y="-153392.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1011.5" y="-153377.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_ffn_norm_1&#45;&gt;layer1_ffn_up_1 -->
<g id="edge53" class="edge">
<title>layer1_ffn_norm_1&#45;&gt;layer1_ffn_up_1</title>
<path fill="none" stroke="black" d="M1011.5,-153509.73C1011.5,-153509.73 1011.5,-153448.36 1011.5,-153448.36"/>
<polygon fill="black" stroke="black" points="1015,-153448.36 1011.5,-153438.36 1008,-153448.36 1015,-153448.36"/>
</g>
<!-- layer1_gate_ar -->
<g id="node47" class="node">
<title>layer1_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1102.5" cy="-153249.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1102.5" y="-153268.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1102.5" y="-153253.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1102.5" y="-153238.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1102.5" y="-153223.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer1_ffn_gate_0&#45;&gt;layer1_gate_ar -->
<g id="edge54" class="edge">
<title>layer1_ffn_gate_0&#45;&gt;layer1_gate_ar</title>
<path fill="none" stroke="black" d="M885.08,-153403C895.79,-153403 903,-153403 903,-153403 903,-153403 903,-153265 903,-153265 903,-153265 970.99,-153265 970.99,-153265"/>
<polygon fill="black" stroke="black" points="970.99,-153268.5 980.99,-153265 970.99,-153261.5 970.99,-153268.5"/>
</g>
<!-- layer1_ffn_gate_1&#45;&gt;layer1_gate_ar -->
<g id="edge55" class="edge">
<title>layer1_ffn_gate_1&#45;&gt;layer1_gate_ar</title>
<path fill="none" stroke="black" d="M1184.24,-153369.78C1184.24,-153369.78 1184.24,-153296.96 1184.24,-153296.96"/>
<polygon fill="black" stroke="black" points="1187.74,-153296.96 1184.24,-153286.96 1180.74,-153296.96 1187.74,-153296.96"/>
</g>
<!-- layer1_up_ar -->
<g id="node48" class="node">
<title>layer1_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="756.5" cy="-153249.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="756.5" y="-153268.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="756.5" y="-153253.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="756.5" y="-153238.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="756.5" y="-153223.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer1_ffn_up_0&#45;&gt;layer1_up_ar -->
<g id="edge56" class="edge">
<title>layer1_ffn_up_0&#45;&gt;layer1_up_ar</title>
<path fill="none" stroke="black" d="M648.26,-153369.78C648.26,-153369.78 648.26,-153285.86 648.26,-153285.86"/>
<polygon fill="black" stroke="black" points="651.76,-153285.86 648.26,-153275.86 644.76,-153285.86 651.76,-153285.86"/>
</g>
<!-- layer1_ffn_up_1&#45;&gt;layer1_up_ar -->
<g id="edge57" class="edge">
<title>layer1_ffn_up_1&#45;&gt;layer1_up_ar</title>
<path fill="none" stroke="black" d="M947.76,-153369.79C947.76,-153319.89 947.76,-153233 947.76,-153233 947.76,-153233 886.54,-153233 886.54,-153233"/>
<polygon fill="black" stroke="black" points="886.54,-153229.5 876.54,-153233 886.54,-153236.5 886.54,-153229.5"/>
</g>
<!-- layer1_silu_0 -->
<g id="node49" class="node">
<title>layer1_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1030,-153129.81 849,-153129.81 849,-153061.81 1030,-153061.81 1030,-153129.81"/>
<text text-anchor="middle" x="939.5" y="-153114.61" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="939.5" y="-153099.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="939.5" y="-153084.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="939.5" y="-153069.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_gate_ar&#45;&gt;layer1_silu_0 -->
<g id="edge58" class="edge">
<title>layer1_gate_ar&#45;&gt;layer1_silu_0</title>
<path fill="none" stroke="black" d="M1002.26,-153219.82C1002.26,-153219.82 1002.26,-153139.84 1002.26,-153139.84"/>
<polygon fill="black" stroke="black" points="1005.76,-153139.84 1002.26,-153129.84 998.76,-153139.84 1005.76,-153139.84"/>
</g>
<!-- layer1_silu_1 -->
<g id="node50" class="node">
<title>layer1_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1247,-153129.81 1066,-153129.81 1066,-153061.81 1247,-153061.81 1247,-153129.81"/>
<text text-anchor="middle" x="1156.5" y="-153114.61" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1156.5" y="-153099.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1156.5" y="-153084.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1156.5" y="-153069.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_gate_ar&#45;&gt;layer1_silu_1 -->
<g id="edge59" class="edge">
<title>layer1_gate_ar&#45;&gt;layer1_silu_1</title>
<path fill="none" stroke="black" d="M1148.24,-153204.92C1148.24,-153204.92 1148.24,-153139.82 1148.24,-153139.82"/>
<polygon fill="black" stroke="black" points="1151.74,-153139.82 1148.24,-153129.82 1144.74,-153139.82 1151.74,-153139.82"/>
</g>
<!-- layer1_mul_0 -->
<g id="node51" class="node">
<title>layer1_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="920,-152989.81 739,-152989.81 739,-152921.81 920,-152921.81 920,-152989.81"/>
<text text-anchor="middle" x="829.5" y="-152974.61" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="829.5" y="-152959.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="829.5" y="-152944.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="829.5" y="-152929.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_up_ar&#45;&gt;layer1_mul_0 -->
<g id="edge61" class="edge">
<title>layer1_up_ar&#45;&gt;layer1_mul_0</title>
<path fill="none" stroke="black" d="M794,-153203.62C794,-153203.62 794,-152999.9 794,-152999.9"/>
<polygon fill="black" stroke="black" points="797.5,-152999.9 794,-152989.9 790.5,-152999.9 797.5,-152999.9"/>
</g>
<!-- layer1_mul_1 -->
<g id="node52" class="node">
<title>layer1_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1137,-152989.81 956,-152989.81 956,-152921.81 1137,-152921.81 1137,-152989.81"/>
<text text-anchor="middle" x="1046.5" y="-152974.61" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1046.5" y="-152959.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1046.5" y="-152944.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1046.5" y="-152929.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer1_up_ar&#45;&gt;layer1_mul_1 -->
<g id="edge63" class="edge">
<title>layer1_up_ar&#45;&gt;layer1_mul_1</title>
<path fill="none" stroke="black" d="M866.74,-153225.34C866.74,-153200.27 866.74,-153165 866.74,-153165 866.74,-153165 1048,-153165 1048,-153165 1048,-153165 1048,-152999.89 1048,-152999.89"/>
<polygon fill="black" stroke="black" points="1051.5,-152999.89 1048,-152989.89 1044.5,-152999.89 1051.5,-152999.89"/>
</g>
<!-- layer1_silu_0&#45;&gt;layer1_mul_0 -->
<g id="edge60" class="edge">
<title>layer1_silu_0&#45;&gt;layer1_mul_0</title>
<path fill="none" stroke="black" d="M884.5,-153061.57C884.5,-153061.57 884.5,-153000.19 884.5,-153000.19"/>
<polygon fill="black" stroke="black" points="888,-153000.19 884.5,-152990.19 881,-153000.19 888,-153000.19"/>
</g>
<!-- layer1_silu_1&#45;&gt;layer1_mul_1 -->
<g id="edge62" class="edge">
<title>layer1_silu_1&#45;&gt;layer1_mul_1</title>
<path fill="none" stroke="black" d="M1101.5,-153061.57C1101.5,-153061.57 1101.5,-153000.19 1101.5,-153000.19"/>
<polygon fill="black" stroke="black" points="1105,-153000.19 1101.5,-152990.19 1098,-153000.19 1105,-153000.19"/>
</g>
<!-- layer1_ffn_down_0 -->
<g id="node53" class="node">
<title>layer1_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="919.5,-152849.81 747.5,-152849.81 747.5,-152781.81 919.5,-152781.81 919.5,-152849.81"/>
<text text-anchor="middle" x="833.5" y="-152834.61" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="833.5" y="-152819.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="833.5" y="-152804.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="833.5" y="-152789.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer1_mul_0&#45;&gt;layer1_ffn_down_0 -->
<g id="edge64" class="edge">
<title>layer1_mul_0&#45;&gt;layer1_ffn_down_0</title>
<path fill="none" stroke="black" d="M833.5,-152921.57C833.5,-152921.57 833.5,-152860.19 833.5,-152860.19"/>
<polygon fill="black" stroke="black" points="837,-152860.19 833.5,-152850.19 830,-152860.19 837,-152860.19"/>
</g>
<!-- layer1_ffn_down_1 -->
<g id="node54" class="node">
<title>layer1_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1129.5,-152849.81 957.5,-152849.81 957.5,-152781.81 1129.5,-152781.81 1129.5,-152849.81"/>
<text text-anchor="middle" x="1043.5" y="-152834.61" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1043.5" y="-152819.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1043.5" y="-152804.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1043.5" y="-152789.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer1_mul_1&#45;&gt;layer1_ffn_down_1 -->
<g id="edge65" class="edge">
<title>layer1_mul_1&#45;&gt;layer1_ffn_down_1</title>
<path fill="none" stroke="black" d="M1043.5,-152921.57C1043.5,-152921.57 1043.5,-152860.19 1043.5,-152860.19"/>
<polygon fill="black" stroke="black" points="1047,-152860.19 1043.5,-152850.19 1040,-152860.19 1047,-152860.19"/>
</g>
<!-- layer1_ffn_ar -->
<g id="node55" class="node">
<title>layer1_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="937.5" cy="-152661.73" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="937.5" y="-152680.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="937.5" y="-152665.53" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="937.5" y="-152650.53" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="937.5" y="-152635.53" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_ffn_down_0&#45;&gt;layer1_ffn_ar -->
<g id="edge66" class="edge">
<title>layer1_ffn_down_0&#45;&gt;layer1_ffn_ar</title>
<path fill="none" stroke="black" d="M867.69,-152781.62C867.69,-152781.62 867.69,-152711.27 867.69,-152711.27"/>
<polygon fill="black" stroke="black" points="871.19,-152711.27 867.69,-152701.27 864.19,-152711.27 871.19,-152711.27"/>
</g>
<!-- layer1_ffn_down_1&#45;&gt;layer1_ffn_ar -->
<g id="edge67" class="edge">
<title>layer1_ffn_down_1&#45;&gt;layer1_ffn_ar</title>
<path fill="none" stroke="black" d="M1008.31,-152781.62C1008.31,-152781.62 1008.31,-152711 1008.31,-152711"/>
<polygon fill="black" stroke="black" points="1011.81,-152711 1008.31,-152701 1004.81,-152711 1011.81,-152711"/>
</g>
<!-- layer2_norm_0 -->
<g id="node56" class="node">
<title>layer2_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="919.5,-152541.65 747.5,-152541.65 747.5,-152473.65 919.5,-152473.65 919.5,-152541.65"/>
<text text-anchor="middle" x="833.5" y="-152526.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="833.5" y="-152511.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="833.5" y="-152496.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="833.5" y="-152481.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_ffn_ar&#45;&gt;layer2_norm_0 -->
<g id="edge68" class="edge">
<title>layer1_ffn_ar&#45;&gt;layer2_norm_0</title>
<path fill="none" stroke="black" d="M867.69,-152622.05C867.69,-152622.05 867.69,-152551.7 867.69,-152551.7"/>
<polygon fill="black" stroke="black" points="871.19,-152551.7 867.69,-152541.7 864.19,-152551.7 871.19,-152551.7"/>
</g>
<!-- layer2_norm_1 -->
<g id="node57" class="node">
<title>layer2_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1129.5,-152541.65 957.5,-152541.65 957.5,-152473.65 1129.5,-152473.65 1129.5,-152541.65"/>
<text text-anchor="middle" x="1043.5" y="-152526.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1043.5" y="-152511.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1043.5" y="-152496.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1043.5" y="-152481.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_ffn_ar&#45;&gt;layer2_norm_1 -->
<g id="edge69" class="edge">
<title>layer1_ffn_ar&#45;&gt;layer2_norm_1</title>
<path fill="none" stroke="black" d="M1008.31,-152622.45C1008.31,-152622.45 1008.31,-152551.88 1008.31,-152551.88"/>
<polygon fill="black" stroke="black" points="1011.81,-152551.88 1008.31,-152541.88 1004.81,-152551.88 1011.81,-152551.88"/>
</g>
<!-- layer2_qkv_0 -->
<g id="node58" class="node">
<title>layer2_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="920,-152401.65 739,-152401.65 739,-152333.65 920,-152333.65 920,-152401.65"/>
<text text-anchor="middle" x="829.5" y="-152386.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="829.5" y="-152371.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="829.5" y="-152356.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="829.5" y="-152341.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer2_norm_0&#45;&gt;layer2_qkv_0 -->
<g id="edge70" class="edge">
<title>layer2_norm_0&#45;&gt;layer2_qkv_0</title>
<path fill="none" stroke="black" d="M833.5,-152473.4C833.5,-152473.4 833.5,-152412.03 833.5,-152412.03"/>
<polygon fill="black" stroke="black" points="837,-152412.03 833.5,-152402.03 830,-152412.03 837,-152412.03"/>
</g>
<!-- layer2_qkv_1 -->
<g id="node59" class="node">
<title>layer2_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1137,-152401.65 956,-152401.65 956,-152333.65 1137,-152333.65 1137,-152401.65"/>
<text text-anchor="middle" x="1046.5" y="-152386.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1046.5" y="-152371.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1046.5" y="-152356.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1046.5" y="-152341.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer2_norm_1&#45;&gt;layer2_qkv_1 -->
<g id="edge71" class="edge">
<title>layer2_norm_1&#45;&gt;layer2_qkv_1</title>
<path fill="none" stroke="black" d="M1043.5,-152473.4C1043.5,-152473.4 1043.5,-152412.03 1043.5,-152412.03"/>
<polygon fill="black" stroke="black" points="1047,-152412.03 1043.5,-152402.03 1040,-152412.03 1047,-152412.03"/>
</g>
<!-- layer2_qkv_ar -->
<g id="node60" class="node">
<title>layer2_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="937.5" cy="-152213.56" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="937.5" y="-152232.36" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="937.5" y="-152217.36" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="937.5" y="-152202.36" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="937.5" y="-152187.36" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer2_qkv_0&#45;&gt;layer2_qkv_ar -->
<g id="edge72" class="edge">
<title>layer2_qkv_0&#45;&gt;layer2_qkv_ar</title>
<path fill="none" stroke="black" d="M864.76,-152333.45C864.76,-152333.45 864.76,-152263.39 864.76,-152263.39"/>
<polygon fill="black" stroke="black" points="868.26,-152263.39 864.76,-152253.39 861.26,-152263.39 868.26,-152263.39"/>
</g>
<!-- layer2_qkv_1&#45;&gt;layer2_qkv_ar -->
<g id="edge73" class="edge">
<title>layer2_qkv_1&#45;&gt;layer2_qkv_ar</title>
<path fill="none" stroke="black" d="M1010.74,-152333.45C1010.74,-152333.45 1010.74,-152263.11 1010.74,-152263.11"/>
<polygon fill="black" stroke="black" points="1014.24,-152263.11 1010.74,-152253.11 1007.24,-152263.11 1014.24,-152263.11"/>
</g>
<!-- layer2_attn_0 -->
<g id="node61" class="node">
<title>layer2_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="919.5,-152093.48 747.5,-152093.48 747.5,-152025.48 919.5,-152025.48 919.5,-152093.48"/>
<text text-anchor="middle" x="833.5" y="-152078.28" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="833.5" y="-152063.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="833.5" y="-152048.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="833.5" y="-152033.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer2_qkv_ar&#45;&gt;layer2_attn_0 -->
<g id="edge74" class="edge">
<title>layer2_qkv_ar&#45;&gt;layer2_attn_0</title>
<path fill="none" stroke="black" d="M864.51,-152173.88C864.51,-152173.88 864.51,-152103.54 864.51,-152103.54"/>
<polygon fill="black" stroke="black" points="868.01,-152103.54 864.51,-152093.54 861.01,-152103.54 868.01,-152103.54"/>
</g>
<!-- layer2_attn_1 -->
<g id="node62" class="node">
<title>layer2_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1127.5,-152093.48 955.5,-152093.48 955.5,-152025.48 1127.5,-152025.48 1127.5,-152093.48"/>
<text text-anchor="middle" x="1041.5" y="-152078.28" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1041.5" y="-152063.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1041.5" y="-152048.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1041.5" y="-152033.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer2_qkv_ar&#45;&gt;layer2_attn_1 -->
<g id="edge75" class="edge">
<title>layer2_qkv_ar&#45;&gt;layer2_attn_1</title>
<path fill="none" stroke="black" d="M1010.49,-152173.88C1010.49,-152173.88 1010.49,-152103.54 1010.49,-152103.54"/>
<polygon fill="black" stroke="black" points="1013.99,-152103.54 1010.49,-152093.54 1006.99,-152103.54 1013.99,-152103.54"/>
</g>
<!-- layer2_attn_out_0 -->
<g id="node63" class="node">
<title>layer2_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="919.5,-151953.48 747.5,-151953.48 747.5,-151885.48 919.5,-151885.48 919.5,-151953.48"/>
<text text-anchor="middle" x="833.5" y="-151938.28" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="833.5" y="-151923.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="833.5" y="-151908.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="833.5" y="-151893.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer2_attn_0&#45;&gt;layer2_attn_out_0 -->
<g id="edge76" class="edge">
<title>layer2_attn_0&#45;&gt;layer2_attn_out_0</title>
<path fill="none" stroke="black" d="M833.5,-152025.23C833.5,-152025.23 833.5,-151963.86 833.5,-151963.86"/>
<polygon fill="black" stroke="black" points="837,-151963.86 833.5,-151953.86 830,-151963.86 837,-151963.86"/>
</g>
<!-- layer2_attn_out_1 -->
<g id="node64" class="node">
<title>layer2_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1127.5,-151953.48 955.5,-151953.48 955.5,-151885.48 1127.5,-151885.48 1127.5,-151953.48"/>
<text text-anchor="middle" x="1041.5" y="-151938.28" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1041.5" y="-151923.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1041.5" y="-151908.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1041.5" y="-151893.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer2_attn_1&#45;&gt;layer2_attn_out_1 -->
<g id="edge77" class="edge">
<title>layer2_attn_1&#45;&gt;layer2_attn_out_1</title>
<path fill="none" stroke="black" d="M1041.5,-152025.23C1041.5,-152025.23 1041.5,-151963.86 1041.5,-151963.86"/>
<polygon fill="black" stroke="black" points="1045,-151963.86 1041.5,-151953.86 1038,-151963.86 1045,-151963.86"/>
</g>
<!-- layer2_attn_ar -->
<g id="node65" class="node">
<title>layer2_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="937.5" cy="-151765.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="937.5" y="-151784.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="937.5" y="-151769.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="937.5" y="-151754.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="937.5" y="-151739.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_attn_out_0&#45;&gt;layer2_attn_ar -->
<g id="edge78" class="edge">
<title>layer2_attn_out_0&#45;&gt;layer2_attn_ar</title>
<path fill="none" stroke="black" d="M867.69,-151885.28C867.69,-151885.28 867.69,-151814.94 867.69,-151814.94"/>
<polygon fill="black" stroke="black" points="871.19,-151814.94 867.69,-151804.94 864.19,-151814.94 871.19,-151814.94"/>
</g>
<!-- layer2_attn_out_1&#45;&gt;layer2_attn_ar -->
<g id="edge79" class="edge">
<title>layer2_attn_out_1&#45;&gt;layer2_attn_ar</title>
<path fill="none" stroke="black" d="M1007.31,-151885.28C1007.31,-151885.28 1007.31,-151814.94 1007.31,-151814.94"/>
<polygon fill="black" stroke="black" points="1010.81,-151814.94 1007.31,-151804.94 1003.81,-151814.94 1010.81,-151814.94"/>
</g>
<!-- layer2_ffn_norm_0 -->
<g id="node66" class="node">
<title>layer2_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="915.5,-151645.31 743.5,-151645.31 743.5,-151577.31 915.5,-151577.31 915.5,-151645.31"/>
<text text-anchor="middle" x="829.5" y="-151630.11" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="829.5" y="-151615.11" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="829.5" y="-151600.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="829.5" y="-151585.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_attn_ar&#45;&gt;layer2_ffn_norm_0 -->
<g id="edge80" class="edge">
<title>layer2_attn_ar&#45;&gt;layer2_ffn_norm_0</title>
<path fill="none" stroke="black" d="M865.69,-151726.52C865.69,-151726.52 865.69,-151655.46 865.69,-151655.46"/>
<polygon fill="black" stroke="black" points="869.19,-151655.46 865.69,-151645.46 862.19,-151655.46 869.19,-151655.46"/>
</g>
<!-- layer2_ffn_norm_1 -->
<g id="node67" class="node">
<title>layer2_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1132.5,-151645.31 960.5,-151645.31 960.5,-151577.31 1132.5,-151577.31 1132.5,-151645.31"/>
<text text-anchor="middle" x="1046.5" y="-151630.11" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1046.5" y="-151615.11" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1046.5" y="-151600.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1046.5" y="-151585.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_attn_ar&#45;&gt;layer2_ffn_norm_1 -->
<g id="edge81" class="edge">
<title>layer2_attn_ar&#45;&gt;layer2_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1009.81,-151726.52C1009.81,-151726.52 1009.81,-151655.46 1009.81,-151655.46"/>
<polygon fill="black" stroke="black" points="1013.31,-151655.46 1009.81,-151645.46 1006.31,-151655.46 1013.31,-151655.46"/>
</g>
<!-- layer2_ffn_gate_0 -->
<g id="node68" class="node">
<title>layer2_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="920,-151505.31 739,-151505.31 739,-151437.31 920,-151437.31 920,-151505.31"/>
<text text-anchor="middle" x="829.5" y="-151490.11" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="829.5" y="-151475.11" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="829.5" y="-151460.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="829.5" y="-151445.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_ffn_norm_0&#45;&gt;layer2_ffn_gate_0 -->
<g id="edge82" class="edge">
<title>layer2_ffn_norm_0&#45;&gt;layer2_ffn_gate_0</title>
<path fill="none" stroke="black" d="M829.5,-151577.07C829.5,-151577.07 829.5,-151515.69 829.5,-151515.69"/>
<polygon fill="black" stroke="black" points="833,-151515.69 829.5,-151505.69 826,-151515.69 833,-151515.69"/>
</g>
<!-- layer2_ffn_up_0 -->
<g id="node70" class="node">
<title>layer2_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="703,-151505.31 522,-151505.31 522,-151437.31 703,-151437.31 703,-151505.31"/>
<text text-anchor="middle" x="612.5" y="-151490.11" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="612.5" y="-151475.11" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="612.5" y="-151460.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="612.5" y="-151445.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_ffn_norm_0&#45;&gt;layer2_ffn_up_0 -->
<g id="edge84" class="edge">
<title>layer2_ffn_norm_0&#45;&gt;layer2_ffn_up_0</title>
<path fill="none" stroke="black" d="M743.31,-151611C703.86,-151611 665.76,-151611 665.76,-151611 665.76,-151611 665.76,-151515.49 665.76,-151515.49"/>
<polygon fill="black" stroke="black" points="669.26,-151515.49 665.76,-151505.49 662.26,-151515.49 669.26,-151515.49"/>
</g>
<!-- layer2_ffn_gate_1 -->
<g id="node69" class="node">
<title>layer2_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1354,-151505.31 1173,-151505.31 1173,-151437.31 1354,-151437.31 1354,-151505.31"/>
<text text-anchor="middle" x="1263.5" y="-151490.11" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1263.5" y="-151475.11" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1263.5" y="-151460.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1263.5" y="-151445.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_ffn_norm_1&#45;&gt;layer2_ffn_gate_1 -->
<g id="edge83" class="edge">
<title>layer2_ffn_norm_1&#45;&gt;layer2_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1132.56,-151611C1171.95,-151611 1210,-151611 1210,-151611 1210,-151611 1210,-151515.49 1210,-151515.49"/>
<polygon fill="black" stroke="black" points="1213.5,-151515.49 1210,-151505.49 1206.5,-151515.49 1213.5,-151515.49"/>
</g>
<!-- layer2_ffn_up_1 -->
<g id="node71" class="node">
<title>layer2_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1137,-151505.31 956,-151505.31 956,-151437.31 1137,-151437.31 1137,-151505.31"/>
<text text-anchor="middle" x="1046.5" y="-151490.11" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1046.5" y="-151475.11" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1046.5" y="-151460.11" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1046.5" y="-151445.11" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_ffn_norm_1&#45;&gt;layer2_ffn_up_1 -->
<g id="edge85" class="edge">
<title>layer2_ffn_norm_1&#45;&gt;layer2_ffn_up_1</title>
<path fill="none" stroke="black" d="M1046.5,-151577.07C1046.5,-151577.07 1046.5,-151515.69 1046.5,-151515.69"/>
<polygon fill="black" stroke="black" points="1050,-151515.69 1046.5,-151505.69 1043,-151515.69 1050,-151515.69"/>
</g>
<!-- layer2_gate_ar -->
<g id="node72" class="node">
<title>layer2_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1137.5" cy="-151317.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1137.5" y="-151336.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1137.5" y="-151321.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1137.5" y="-151306.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1137.5" y="-151291.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer2_ffn_gate_0&#45;&gt;layer2_gate_ar -->
<g id="edge86" class="edge">
<title>layer2_ffn_gate_0&#45;&gt;layer2_gate_ar</title>
<path fill="none" stroke="black" d="M920.08,-151471C930.79,-151471 938,-151471 938,-151471 938,-151471 938,-151333 938,-151333 938,-151333 1006.56,-151333 1006.56,-151333"/>
<polygon fill="black" stroke="black" points="1006.56,-151336.5 1016.56,-151333 1006.56,-151329.5 1006.56,-151336.5"/>
</g>
<!-- layer2_ffn_gate_1&#45;&gt;layer2_gate_ar -->
<g id="edge87" class="edge">
<title>layer2_ffn_gate_1&#45;&gt;layer2_gate_ar</title>
<path fill="none" stroke="black" d="M1219.24,-151437.12C1219.24,-151437.12 1219.24,-151364.29 1219.24,-151364.29"/>
<polygon fill="black" stroke="black" points="1222.74,-151364.29 1219.24,-151354.29 1215.74,-151364.29 1222.74,-151364.29"/>
</g>
<!-- layer2_up_ar -->
<g id="node73" class="node">
<title>layer2_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="791.5" cy="-151317.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="791.5" y="-151336.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="791.5" y="-151321.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="791.5" y="-151306.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="791.5" y="-151291.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer2_ffn_up_0&#45;&gt;layer2_up_ar -->
<g id="edge88" class="edge">
<title>layer2_ffn_up_0&#45;&gt;layer2_up_ar</title>
<path fill="none" stroke="black" d="M683.26,-151437.12C683.26,-151437.12 683.26,-151353.2 683.26,-151353.2"/>
<polygon fill="black" stroke="black" points="686.76,-151353.2 683.26,-151343.2 679.76,-151353.2 686.76,-151353.2"/>
</g>
<!-- layer2_ffn_up_1&#45;&gt;layer2_up_ar -->
<g id="edge89" class="edge">
<title>layer2_ffn_up_1&#45;&gt;layer2_up_ar</title>
<path fill="none" stroke="black" d="M982.76,-151437.26C982.76,-151387.56 982.76,-151301 982.76,-151301 982.76,-151301 922.08,-151301 922.08,-151301"/>
<polygon fill="black" stroke="black" points="922.08,-151297.5 912.08,-151301 922.08,-151304.5 922.08,-151297.5"/>
</g>
<!-- layer2_silu_0 -->
<g id="node74" class="node">
<title>layer2_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1065,-151197.15 884,-151197.15 884,-151129.15 1065,-151129.15 1065,-151197.15"/>
<text text-anchor="middle" x="974.5" y="-151181.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="974.5" y="-151166.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="974.5" y="-151151.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="974.5" y="-151136.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_gate_ar&#45;&gt;layer2_silu_0 -->
<g id="edge90" class="edge">
<title>layer2_gate_ar&#45;&gt;layer2_silu_0</title>
<path fill="none" stroke="black" d="M1037.26,-151287.16C1037.26,-151287.16 1037.26,-151207.17 1037.26,-151207.17"/>
<polygon fill="black" stroke="black" points="1040.76,-151207.17 1037.26,-151197.17 1033.76,-151207.17 1040.76,-151207.17"/>
</g>
<!-- layer2_silu_1 -->
<g id="node75" class="node">
<title>layer2_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1282,-151197.15 1101,-151197.15 1101,-151129.15 1282,-151129.15 1282,-151197.15"/>
<text text-anchor="middle" x="1191.5" y="-151181.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1191.5" y="-151166.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1191.5" y="-151151.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1191.5" y="-151136.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_gate_ar&#45;&gt;layer2_silu_1 -->
<g id="edge91" class="edge">
<title>layer2_gate_ar&#45;&gt;layer2_silu_1</title>
<path fill="none" stroke="black" d="M1183.24,-151272.25C1183.24,-151272.25 1183.24,-151207.15 1183.24,-151207.15"/>
<polygon fill="black" stroke="black" points="1186.74,-151207.15 1183.24,-151197.15 1179.74,-151207.15 1186.74,-151207.15"/>
</g>
<!-- layer2_mul_0 -->
<g id="node76" class="node">
<title>layer2_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="955,-151057.15 774,-151057.15 774,-150989.15 955,-150989.15 955,-151057.15"/>
<text text-anchor="middle" x="864.5" y="-151041.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="864.5" y="-151026.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="864.5" y="-151011.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="864.5" y="-150996.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_up_ar&#45;&gt;layer2_mul_0 -->
<g id="edge93" class="edge">
<title>layer2_up_ar&#45;&gt;layer2_mul_0</title>
<path fill="none" stroke="black" d="M829,-151270.96C829,-151270.96 829,-151067.23 829,-151067.23"/>
<polygon fill="black" stroke="black" points="832.5,-151067.23 829,-151057.23 825.5,-151067.23 832.5,-151067.23"/>
</g>
<!-- layer2_mul_1 -->
<g id="node77" class="node">
<title>layer2_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1172,-151057.15 991,-151057.15 991,-150989.15 1172,-150989.15 1172,-151057.15"/>
<text text-anchor="middle" x="1081.5" y="-151041.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1081.5" y="-151026.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1081.5" y="-151011.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1081.5" y="-150996.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer2_up_ar&#45;&gt;layer2_mul_1 -->
<g id="edge95" class="edge">
<title>layer2_up_ar&#45;&gt;layer2_mul_1</title>
<path fill="none" stroke="black" d="M901.74,-151292.41C901.74,-151267.57 901.74,-151233 901.74,-151233 901.74,-151233 1083,-151233 1083,-151233 1083,-151233 1083,-151067.33 1083,-151067.33"/>
<polygon fill="black" stroke="black" points="1086.5,-151067.33 1083,-151057.33 1079.5,-151067.33 1086.5,-151067.33"/>
</g>
<!-- layer2_silu_0&#45;&gt;layer2_mul_0 -->
<g id="edge92" class="edge">
<title>layer2_silu_0&#45;&gt;layer2_mul_0</title>
<path fill="none" stroke="black" d="M919.5,-151128.9C919.5,-151128.9 919.5,-151067.53 919.5,-151067.53"/>
<polygon fill="black" stroke="black" points="923,-151067.53 919.5,-151057.53 916,-151067.53 923,-151067.53"/>
</g>
<!-- layer2_silu_1&#45;&gt;layer2_mul_1 -->
<g id="edge94" class="edge">
<title>layer2_silu_1&#45;&gt;layer2_mul_1</title>
<path fill="none" stroke="black" d="M1136.5,-151128.9C1136.5,-151128.9 1136.5,-151067.53 1136.5,-151067.53"/>
<polygon fill="black" stroke="black" points="1140,-151067.53 1136.5,-151057.53 1133,-151067.53 1140,-151067.53"/>
</g>
<!-- layer2_ffn_down_0 -->
<g id="node78" class="node">
<title>layer2_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="953.5,-150917.15 781.5,-150917.15 781.5,-150849.15 953.5,-150849.15 953.5,-150917.15"/>
<text text-anchor="middle" x="867.5" y="-150901.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="867.5" y="-150886.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="867.5" y="-150871.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="867.5" y="-150856.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer2_mul_0&#45;&gt;layer2_ffn_down_0 -->
<g id="edge96" class="edge">
<title>layer2_mul_0&#45;&gt;layer2_ffn_down_0</title>
<path fill="none" stroke="black" d="M867.5,-150988.9C867.5,-150988.9 867.5,-150927.53 867.5,-150927.53"/>
<polygon fill="black" stroke="black" points="871,-150927.53 867.5,-150917.53 864,-150927.53 871,-150927.53"/>
</g>
<!-- layer2_ffn_down_1 -->
<g id="node79" class="node">
<title>layer2_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1163.5,-150917.15 991.5,-150917.15 991.5,-150849.15 1163.5,-150849.15 1163.5,-150917.15"/>
<text text-anchor="middle" x="1077.5" y="-150901.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1077.5" y="-150886.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1077.5" y="-150871.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1077.5" y="-150856.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer2_mul_1&#45;&gt;layer2_ffn_down_1 -->
<g id="edge97" class="edge">
<title>layer2_mul_1&#45;&gt;layer2_ffn_down_1</title>
<path fill="none" stroke="black" d="M1077.5,-150988.9C1077.5,-150988.9 1077.5,-150927.53 1077.5,-150927.53"/>
<polygon fill="black" stroke="black" points="1081,-150927.53 1077.5,-150917.53 1074,-150927.53 1081,-150927.53"/>
</g>
<!-- layer2_ffn_ar -->
<g id="node80" class="node">
<title>layer2_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="971.5" cy="-150729.06" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="971.5" y="-150747.86" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="971.5" y="-150732.86" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="971.5" y="-150717.86" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="971.5" y="-150702.86" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_ffn_down_0&#45;&gt;layer2_ffn_ar -->
<g id="edge98" class="edge">
<title>layer2_ffn_down_0&#45;&gt;layer2_ffn_ar</title>
<path fill="none" stroke="black" d="M901.69,-150848.95C901.69,-150848.95 901.69,-150778.61 901.69,-150778.61"/>
<polygon fill="black" stroke="black" points="905.19,-150778.61 901.69,-150768.61 898.19,-150778.61 905.19,-150778.61"/>
</g>
<!-- layer2_ffn_down_1&#45;&gt;layer2_ffn_ar -->
<g id="edge99" class="edge">
<title>layer2_ffn_down_1&#45;&gt;layer2_ffn_ar</title>
<path fill="none" stroke="black" d="M1042.31,-150848.95C1042.31,-150848.95 1042.31,-150778.33 1042.31,-150778.33"/>
<polygon fill="black" stroke="black" points="1045.81,-150778.33 1042.31,-150768.33 1038.81,-150778.33 1045.81,-150778.33"/>
</g>
<!-- layer3_norm_0 -->
<g id="node81" class="node">
<title>layer3_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="953.5,-150608.98 781.5,-150608.98 781.5,-150540.98 953.5,-150540.98 953.5,-150608.98"/>
<text text-anchor="middle" x="867.5" y="-150593.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="867.5" y="-150578.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="867.5" y="-150563.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="867.5" y="-150548.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_ffn_ar&#45;&gt;layer3_norm_0 -->
<g id="edge100" class="edge">
<title>layer2_ffn_ar&#45;&gt;layer3_norm_0</title>
<path fill="none" stroke="black" d="M901.69,-150689.38C901.69,-150689.38 901.69,-150619.04 901.69,-150619.04"/>
<polygon fill="black" stroke="black" points="905.19,-150619.04 901.69,-150609.04 898.19,-150619.04 905.19,-150619.04"/>
</g>
<!-- layer3_norm_1 -->
<g id="node82" class="node">
<title>layer3_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1163.5,-150608.98 991.5,-150608.98 991.5,-150540.98 1163.5,-150540.98 1163.5,-150608.98"/>
<text text-anchor="middle" x="1077.5" y="-150593.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1077.5" y="-150578.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1077.5" y="-150563.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1077.5" y="-150548.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_ffn_ar&#45;&gt;layer3_norm_1 -->
<g id="edge101" class="edge">
<title>layer2_ffn_ar&#45;&gt;layer3_norm_1</title>
<path fill="none" stroke="black" d="M1042.31,-150689.78C1042.31,-150689.78 1042.31,-150619.21 1042.31,-150619.21"/>
<polygon fill="black" stroke="black" points="1045.81,-150619.21 1042.31,-150609.21 1038.81,-150619.21 1045.81,-150619.21"/>
</g>
<!-- layer3_qkv_0 -->
<g id="node83" class="node">
<title>layer3_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="954,-150468.98 773,-150468.98 773,-150400.98 954,-150400.98 954,-150468.98"/>
<text text-anchor="middle" x="863.5" y="-150453.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="863.5" y="-150438.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="863.5" y="-150423.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="863.5" y="-150408.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer3_norm_0&#45;&gt;layer3_qkv_0 -->
<g id="edge102" class="edge">
<title>layer3_norm_0&#45;&gt;layer3_qkv_0</title>
<path fill="none" stroke="black" d="M867.5,-150540.73C867.5,-150540.73 867.5,-150479.36 867.5,-150479.36"/>
<polygon fill="black" stroke="black" points="871,-150479.36 867.5,-150469.36 864,-150479.36 871,-150479.36"/>
</g>
<!-- layer3_qkv_1 -->
<g id="node84" class="node">
<title>layer3_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1171,-150468.98 990,-150468.98 990,-150400.98 1171,-150400.98 1171,-150468.98"/>
<text text-anchor="middle" x="1080.5" y="-150453.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1080.5" y="-150438.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1080.5" y="-150423.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1080.5" y="-150408.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer3_norm_1&#45;&gt;layer3_qkv_1 -->
<g id="edge103" class="edge">
<title>layer3_norm_1&#45;&gt;layer3_qkv_1</title>
<path fill="none" stroke="black" d="M1077.5,-150540.73C1077.5,-150540.73 1077.5,-150479.36 1077.5,-150479.36"/>
<polygon fill="black" stroke="black" points="1081,-150479.36 1077.5,-150469.36 1074,-150479.36 1081,-150479.36"/>
</g>
<!-- layer3_qkv_ar -->
<g id="node85" class="node">
<title>layer3_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="971.5" cy="-150280.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="971.5" y="-150299.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="971.5" y="-150284.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="971.5" y="-150269.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="971.5" y="-150254.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer3_qkv_0&#45;&gt;layer3_qkv_ar -->
<g id="edge104" class="edge">
<title>layer3_qkv_0&#45;&gt;layer3_qkv_ar</title>
<path fill="none" stroke="black" d="M898.76,-150400.79C898.76,-150400.79 898.76,-150330.72 898.76,-150330.72"/>
<polygon fill="black" stroke="black" points="902.26,-150330.72 898.76,-150320.72 895.26,-150330.72 902.26,-150330.72"/>
</g>
<!-- layer3_qkv_1&#45;&gt;layer3_qkv_ar -->
<g id="edge105" class="edge">
<title>layer3_qkv_1&#45;&gt;layer3_qkv_ar</title>
<path fill="none" stroke="black" d="M1044.74,-150400.79C1044.74,-150400.79 1044.74,-150330.44 1044.74,-150330.44"/>
<polygon fill="black" stroke="black" points="1048.24,-150330.44 1044.74,-150320.44 1041.24,-150330.44 1048.24,-150330.44"/>
</g>
<!-- layer3_attn_0 -->
<g id="node86" class="node">
<title>layer3_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="953.5,-150160.81 781.5,-150160.81 781.5,-150092.81 953.5,-150092.81 953.5,-150160.81"/>
<text text-anchor="middle" x="867.5" y="-150145.61" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="867.5" y="-150130.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="867.5" y="-150115.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="867.5" y="-150100.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer3_qkv_ar&#45;&gt;layer3_attn_0 -->
<g id="edge106" class="edge">
<title>layer3_qkv_ar&#45;&gt;layer3_attn_0</title>
<path fill="none" stroke="black" d="M898.51,-150241.22C898.51,-150241.22 898.51,-150170.87 898.51,-150170.87"/>
<polygon fill="black" stroke="black" points="902.01,-150170.87 898.51,-150160.87 895.01,-150170.87 902.01,-150170.87"/>
</g>
<!-- layer3_attn_1 -->
<g id="node87" class="node">
<title>layer3_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1161.5,-150160.81 989.5,-150160.81 989.5,-150092.81 1161.5,-150092.81 1161.5,-150160.81"/>
<text text-anchor="middle" x="1075.5" y="-150145.61" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1075.5" y="-150130.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1075.5" y="-150115.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1075.5" y="-150100.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer3_qkv_ar&#45;&gt;layer3_attn_1 -->
<g id="edge107" class="edge">
<title>layer3_qkv_ar&#45;&gt;layer3_attn_1</title>
<path fill="none" stroke="black" d="M1044.49,-150241.22C1044.49,-150241.22 1044.49,-150170.87 1044.49,-150170.87"/>
<polygon fill="black" stroke="black" points="1047.99,-150170.87 1044.49,-150160.87 1040.99,-150170.87 1047.99,-150170.87"/>
</g>
<!-- layer3_attn_out_0 -->
<g id="node88" class="node">
<title>layer3_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="953.5,-150020.81 781.5,-150020.81 781.5,-149952.81 953.5,-149952.81 953.5,-150020.81"/>
<text text-anchor="middle" x="867.5" y="-150005.61" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="867.5" y="-149990.61" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="867.5" y="-149975.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="867.5" y="-149960.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer3_attn_0&#45;&gt;layer3_attn_out_0 -->
<g id="edge108" class="edge">
<title>layer3_attn_0&#45;&gt;layer3_attn_out_0</title>
<path fill="none" stroke="black" d="M867.5,-150092.57C867.5,-150092.57 867.5,-150031.19 867.5,-150031.19"/>
<polygon fill="black" stroke="black" points="871,-150031.19 867.5,-150021.19 864,-150031.19 871,-150031.19"/>
</g>
<!-- layer3_attn_out_1 -->
<g id="node89" class="node">
<title>layer3_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1161.5,-150020.81 989.5,-150020.81 989.5,-149952.81 1161.5,-149952.81 1161.5,-150020.81"/>
<text text-anchor="middle" x="1075.5" y="-150005.61" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1075.5" y="-149990.61" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1075.5" y="-149975.61" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1075.5" y="-149960.61" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer3_attn_1&#45;&gt;layer3_attn_out_1 -->
<g id="edge109" class="edge">
<title>layer3_attn_1&#45;&gt;layer3_attn_out_1</title>
<path fill="none" stroke="black" d="M1075.5,-150092.57C1075.5,-150092.57 1075.5,-150031.19 1075.5,-150031.19"/>
<polygon fill="black" stroke="black" points="1079,-150031.19 1075.5,-150021.19 1072,-150031.19 1079,-150031.19"/>
</g>
<!-- layer3_attn_ar -->
<g id="node90" class="node">
<title>layer3_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="971.5" cy="-149832.73" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="971.5" y="-149851.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="971.5" y="-149836.53" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="971.5" y="-149821.53" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="971.5" y="-149806.53" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_attn_out_0&#45;&gt;layer3_attn_ar -->
<g id="edge110" class="edge">
<title>layer3_attn_out_0&#45;&gt;layer3_attn_ar</title>
<path fill="none" stroke="black" d="M901.69,-149952.62C901.69,-149952.62 901.69,-149882.27 901.69,-149882.27"/>
<polygon fill="black" stroke="black" points="905.19,-149882.27 901.69,-149872.27 898.19,-149882.27 905.19,-149882.27"/>
</g>
<!-- layer3_attn_out_1&#45;&gt;layer3_attn_ar -->
<g id="edge111" class="edge">
<title>layer3_attn_out_1&#45;&gt;layer3_attn_ar</title>
<path fill="none" stroke="black" d="M1041.31,-149952.62C1041.31,-149952.62 1041.31,-149882.27 1041.31,-149882.27"/>
<polygon fill="black" stroke="black" points="1044.81,-149882.27 1041.31,-149872.27 1037.81,-149882.27 1044.81,-149882.27"/>
</g>
<!-- layer3_ffn_norm_0 -->
<g id="node91" class="node">
<title>layer3_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="949.5,-149712.65 777.5,-149712.65 777.5,-149644.65 949.5,-149644.65 949.5,-149712.65"/>
<text text-anchor="middle" x="863.5" y="-149697.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="863.5" y="-149682.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="863.5" y="-149667.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="863.5" y="-149652.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_attn_ar&#45;&gt;layer3_ffn_norm_0 -->
<g id="edge112" class="edge">
<title>layer3_attn_ar&#45;&gt;layer3_ffn_norm_0</title>
<path fill="none" stroke="black" d="M899.69,-149793.85C899.69,-149793.85 899.69,-149722.8 899.69,-149722.8"/>
<polygon fill="black" stroke="black" points="903.19,-149722.8 899.69,-149712.8 896.19,-149722.8 903.19,-149722.8"/>
</g>
<!-- layer3_ffn_norm_1 -->
<g id="node92" class="node">
<title>layer3_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1166.5,-149712.65 994.5,-149712.65 994.5,-149644.65 1166.5,-149644.65 1166.5,-149712.65"/>
<text text-anchor="middle" x="1080.5" y="-149697.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1080.5" y="-149682.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1080.5" y="-149667.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1080.5" y="-149652.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_attn_ar&#45;&gt;layer3_ffn_norm_1 -->
<g id="edge113" class="edge">
<title>layer3_attn_ar&#45;&gt;layer3_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1043.81,-149793.85C1043.81,-149793.85 1043.81,-149722.8 1043.81,-149722.8"/>
<polygon fill="black" stroke="black" points="1047.31,-149722.8 1043.81,-149712.8 1040.31,-149722.8 1047.31,-149722.8"/>
</g>
<!-- layer3_ffn_gate_0 -->
<g id="node93" class="node">
<title>layer3_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="954,-149572.65 773,-149572.65 773,-149504.65 954,-149504.65 954,-149572.65"/>
<text text-anchor="middle" x="863.5" y="-149557.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="863.5" y="-149542.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="863.5" y="-149527.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="863.5" y="-149512.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_ffn_norm_0&#45;&gt;layer3_ffn_gate_0 -->
<g id="edge114" class="edge">
<title>layer3_ffn_norm_0&#45;&gt;layer3_ffn_gate_0</title>
<path fill="none" stroke="black" d="M863.5,-149644.4C863.5,-149644.4 863.5,-149583.03 863.5,-149583.03"/>
<polygon fill="black" stroke="black" points="867,-149583.03 863.5,-149573.03 860,-149583.03 867,-149583.03"/>
</g>
<!-- layer3_ffn_up_0 -->
<g id="node95" class="node">
<title>layer3_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="737,-149572.65 556,-149572.65 556,-149504.65 737,-149504.65 737,-149572.65"/>
<text text-anchor="middle" x="646.5" y="-149557.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="646.5" y="-149542.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="646.5" y="-149527.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="646.5" y="-149512.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_ffn_norm_0&#45;&gt;layer3_ffn_up_0 -->
<g id="edge116" class="edge">
<title>layer3_ffn_norm_0&#45;&gt;layer3_ffn_up_0</title>
<path fill="none" stroke="black" d="M777.1,-149678C737.94,-149678 700.26,-149678 700.26,-149678 700.26,-149678 700.26,-149582.74 700.26,-149582.74"/>
<polygon fill="black" stroke="black" points="703.76,-149582.74 700.26,-149572.74 696.76,-149582.74 703.76,-149582.74"/>
</g>
<!-- layer3_ffn_gate_1 -->
<g id="node94" class="node">
<title>layer3_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1388,-149572.65 1207,-149572.65 1207,-149504.65 1388,-149504.65 1388,-149572.65"/>
<text text-anchor="middle" x="1297.5" y="-149557.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1297.5" y="-149542.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1297.5" y="-149527.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1297.5" y="-149512.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_ffn_norm_1&#45;&gt;layer3_ffn_gate_1 -->
<g id="edge115" class="edge">
<title>layer3_ffn_norm_1&#45;&gt;layer3_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1166.82,-149678C1206.33,-149678 1244.5,-149678 1244.5,-149678 1244.5,-149678 1244.5,-149582.74 1244.5,-149582.74"/>
<polygon fill="black" stroke="black" points="1248,-149582.74 1244.5,-149572.74 1241,-149582.74 1248,-149582.74"/>
</g>
<!-- layer3_ffn_up_1 -->
<g id="node96" class="node">
<title>layer3_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1171,-149572.65 990,-149572.65 990,-149504.65 1171,-149504.65 1171,-149572.65"/>
<text text-anchor="middle" x="1080.5" y="-149557.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1080.5" y="-149542.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1080.5" y="-149527.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1080.5" y="-149512.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_ffn_norm_1&#45;&gt;layer3_ffn_up_1 -->
<g id="edge117" class="edge">
<title>layer3_ffn_norm_1&#45;&gt;layer3_ffn_up_1</title>
<path fill="none" stroke="black" d="M1080.5,-149644.4C1080.5,-149644.4 1080.5,-149583.03 1080.5,-149583.03"/>
<polygon fill="black" stroke="black" points="1084,-149583.03 1080.5,-149573.03 1077,-149583.03 1084,-149583.03"/>
</g>
<!-- layer3_gate_ar -->
<g id="node97" class="node">
<title>layer3_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1171.5" cy="-149384.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1171.5" y="-149403.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1171.5" y="-149388.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1171.5" y="-149373.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1171.5" y="-149358.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer3_ffn_gate_0&#45;&gt;layer3_gate_ar -->
<g id="edge118" class="edge">
<title>layer3_ffn_gate_0&#45;&gt;layer3_gate_ar</title>
<path fill="none" stroke="black" d="M954.08,-149538C964.79,-149538 972,-149538 972,-149538 972,-149538 972,-149400 972,-149400 972,-149400 1040.28,-149400 1040.28,-149400"/>
<polygon fill="black" stroke="black" points="1040.28,-149403.5 1050.28,-149400 1040.28,-149396.5 1040.28,-149403.5"/>
</g>
<!-- layer3_ffn_gate_1&#45;&gt;layer3_gate_ar -->
<g id="edge119" class="edge">
<title>layer3_ffn_gate_1&#45;&gt;layer3_gate_ar</title>
<path fill="none" stroke="black" d="M1253.24,-149504.45C1253.24,-149504.45 1253.24,-149431.63 1253.24,-149431.63"/>
<polygon fill="black" stroke="black" points="1256.74,-149431.63 1253.24,-149421.63 1249.74,-149431.63 1256.74,-149431.63"/>
</g>
<!-- layer3_up_ar -->
<g id="node98" class="node">
<title>layer3_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="825.5" cy="-149384.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="825.5" y="-149403.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="825.5" y="-149388.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="825.5" y="-149373.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="825.5" y="-149358.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer3_ffn_up_0&#45;&gt;layer3_up_ar -->
<g id="edge120" class="edge">
<title>layer3_ffn_up_0&#45;&gt;layer3_up_ar</title>
<path fill="none" stroke="black" d="M717.26,-149504.45C717.26,-149504.45 717.26,-149420.53 717.26,-149420.53"/>
<polygon fill="black" stroke="black" points="720.76,-149420.53 717.26,-149410.53 713.76,-149420.53 720.76,-149420.53"/>
</g>
<!-- layer3_ffn_up_1&#45;&gt;layer3_up_ar -->
<g id="edge121" class="edge">
<title>layer3_ffn_up_1&#45;&gt;layer3_up_ar</title>
<path fill="none" stroke="black" d="M1016.76,-149504.53C1016.76,-149454.73 1016.76,-149368 1016.76,-149368 1016.76,-149368 955.81,-149368 955.81,-149368"/>
<polygon fill="black" stroke="black" points="955.81,-149364.5 945.81,-149368 955.81,-149371.5 955.81,-149364.5"/>
</g>
<!-- layer3_silu_0 -->
<g id="node99" class="node">
<title>layer3_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1099,-149264.48 918,-149264.48 918,-149196.48 1099,-149196.48 1099,-149264.48"/>
<text text-anchor="middle" x="1008.5" y="-149249.28" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1008.5" y="-149234.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1008.5" y="-149219.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1008.5" y="-149204.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_gate_ar&#45;&gt;layer3_silu_0 -->
<g id="edge122" class="edge">
<title>layer3_gate_ar&#45;&gt;layer3_silu_0</title>
<path fill="none" stroke="black" d="M1071.26,-149354.49C1071.26,-149354.49 1071.26,-149274.5 1071.26,-149274.5"/>
<polygon fill="black" stroke="black" points="1074.76,-149274.5 1071.26,-149264.5 1067.76,-149274.5 1074.76,-149274.5"/>
</g>
<!-- layer3_silu_1 -->
<g id="node100" class="node">
<title>layer3_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1316,-149264.48 1135,-149264.48 1135,-149196.48 1316,-149196.48 1316,-149264.48"/>
<text text-anchor="middle" x="1225.5" y="-149249.28" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1225.5" y="-149234.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1225.5" y="-149219.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1225.5" y="-149204.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_gate_ar&#45;&gt;layer3_silu_1 -->
<g id="edge123" class="edge">
<title>layer3_gate_ar&#45;&gt;layer3_silu_1</title>
<path fill="none" stroke="black" d="M1217.24,-149339.58C1217.24,-149339.58 1217.24,-149274.49 1217.24,-149274.49"/>
<polygon fill="black" stroke="black" points="1220.74,-149274.49 1217.24,-149264.49 1213.74,-149274.49 1220.74,-149274.49"/>
</g>
<!-- layer3_mul_0 -->
<g id="node101" class="node">
<title>layer3_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="989,-149124.48 808,-149124.48 808,-149056.48 989,-149056.48 989,-149124.48"/>
<text text-anchor="middle" x="898.5" y="-149109.28" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="898.5" y="-149094.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="898.5" y="-149079.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="898.5" y="-149064.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_up_ar&#45;&gt;layer3_mul_0 -->
<g id="edge125" class="edge">
<title>layer3_up_ar&#45;&gt;layer3_mul_0</title>
<path fill="none" stroke="black" d="M863,-149338.29C863,-149338.29 863,-149134.57 863,-149134.57"/>
<polygon fill="black" stroke="black" points="866.5,-149134.57 863,-149124.57 859.5,-149134.57 866.5,-149134.57"/>
</g>
<!-- layer3_mul_1 -->
<g id="node102" class="node">
<title>layer3_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1206,-149124.48 1025,-149124.48 1025,-149056.48 1206,-149056.48 1206,-149124.48"/>
<text text-anchor="middle" x="1115.5" y="-149109.28" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1115.5" y="-149094.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1115.5" y="-149079.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1115.5" y="-149064.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer3_up_ar&#45;&gt;layer3_mul_1 -->
<g id="edge127" class="edge">
<title>layer3_up_ar&#45;&gt;layer3_mul_1</title>
<path fill="none" stroke="black" d="M935.74,-149360.11C935.74,-149335.13 935.74,-149300 935.74,-149300 935.74,-149300 1117,-149300 1117,-149300 1117,-149300 1117,-149134.61 1117,-149134.61"/>
<polygon fill="black" stroke="black" points="1120.5,-149134.61 1117,-149124.61 1113.5,-149134.61 1120.5,-149134.61"/>
</g>
<!-- layer3_silu_0&#45;&gt;layer3_mul_0 -->
<g id="edge124" class="edge">
<title>layer3_silu_0&#45;&gt;layer3_mul_0</title>
<path fill="none" stroke="black" d="M953.5,-149196.23C953.5,-149196.23 953.5,-149134.86 953.5,-149134.86"/>
<polygon fill="black" stroke="black" points="957,-149134.86 953.5,-149124.86 950,-149134.86 957,-149134.86"/>
</g>
<!-- layer3_silu_1&#45;&gt;layer3_mul_1 -->
<g id="edge126" class="edge">
<title>layer3_silu_1&#45;&gt;layer3_mul_1</title>
<path fill="none" stroke="black" d="M1170.5,-149196.23C1170.5,-149196.23 1170.5,-149134.86 1170.5,-149134.86"/>
<polygon fill="black" stroke="black" points="1174,-149134.86 1170.5,-149124.86 1167,-149134.86 1174,-149134.86"/>
</g>
<!-- layer3_ffn_down_0 -->
<g id="node103" class="node">
<title>layer3_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="988.5,-148984.48 816.5,-148984.48 816.5,-148916.48 988.5,-148916.48 988.5,-148984.48"/>
<text text-anchor="middle" x="902.5" y="-148969.28" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="902.5" y="-148954.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="902.5" y="-148939.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="902.5" y="-148924.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer3_mul_0&#45;&gt;layer3_ffn_down_0 -->
<g id="edge128" class="edge">
<title>layer3_mul_0&#45;&gt;layer3_ffn_down_0</title>
<path fill="none" stroke="black" d="M902.5,-149056.23C902.5,-149056.23 902.5,-148994.86 902.5,-148994.86"/>
<polygon fill="black" stroke="black" points="906,-148994.86 902.5,-148984.86 899,-148994.86 906,-148994.86"/>
</g>
<!-- layer3_ffn_down_1 -->
<g id="node104" class="node">
<title>layer3_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1198.5,-148984.48 1026.5,-148984.48 1026.5,-148916.48 1198.5,-148916.48 1198.5,-148984.48"/>
<text text-anchor="middle" x="1112.5" y="-148969.28" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1112.5" y="-148954.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1112.5" y="-148939.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1112.5" y="-148924.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer3_mul_1&#45;&gt;layer3_ffn_down_1 -->
<g id="edge129" class="edge">
<title>layer3_mul_1&#45;&gt;layer3_ffn_down_1</title>
<path fill="none" stroke="black" d="M1112.5,-149056.23C1112.5,-149056.23 1112.5,-148994.86 1112.5,-148994.86"/>
<polygon fill="black" stroke="black" points="1116,-148994.86 1112.5,-148984.86 1109,-148994.86 1116,-148994.86"/>
</g>
<!-- layer3_ffn_ar -->
<g id="node105" class="node">
<title>layer3_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1006.5" cy="-148796.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1006.5" y="-148815.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1006.5" y="-148800.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1006.5" y="-148785.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1006.5" y="-148770.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_ffn_down_0&#45;&gt;layer3_ffn_ar -->
<g id="edge130" class="edge">
<title>layer3_ffn_down_0&#45;&gt;layer3_ffn_ar</title>
<path fill="none" stroke="black" d="M936.69,-148916.29C936.69,-148916.29 936.69,-148845.94 936.69,-148845.94"/>
<polygon fill="black" stroke="black" points="940.19,-148845.94 936.69,-148835.94 933.19,-148845.94 940.19,-148845.94"/>
</g>
<!-- layer3_ffn_down_1&#45;&gt;layer3_ffn_ar -->
<g id="edge131" class="edge">
<title>layer3_ffn_down_1&#45;&gt;layer3_ffn_ar</title>
<path fill="none" stroke="black" d="M1077.31,-148916.29C1077.31,-148916.29 1077.31,-148845.66 1077.31,-148845.66"/>
<polygon fill="black" stroke="black" points="1080.81,-148845.66 1077.31,-148835.66 1073.81,-148845.66 1080.81,-148845.66"/>
</g>
<!-- layer4_norm_0 -->
<g id="node106" class="node">
<title>layer4_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="988.5,-148676.32 816.5,-148676.32 816.5,-148608.32 988.5,-148608.32 988.5,-148676.32"/>
<text text-anchor="middle" x="902.5" y="-148661.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="902.5" y="-148646.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="902.5" y="-148631.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="902.5" y="-148616.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_ffn_ar&#45;&gt;layer4_norm_0 -->
<g id="edge132" class="edge">
<title>layer3_ffn_ar&#45;&gt;layer4_norm_0</title>
<path fill="none" stroke="black" d="M936.69,-148756.72C936.69,-148756.72 936.69,-148686.37 936.69,-148686.37"/>
<polygon fill="black" stroke="black" points="940.19,-148686.37 936.69,-148676.37 933.19,-148686.37 940.19,-148686.37"/>
</g>
<!-- layer4_norm_1 -->
<g id="node107" class="node">
<title>layer4_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1198.5,-148676.32 1026.5,-148676.32 1026.5,-148608.32 1198.5,-148608.32 1198.5,-148676.32"/>
<text text-anchor="middle" x="1112.5" y="-148661.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1112.5" y="-148646.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1112.5" y="-148631.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1112.5" y="-148616.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_ffn_ar&#45;&gt;layer4_norm_1 -->
<g id="edge133" class="edge">
<title>layer3_ffn_ar&#45;&gt;layer4_norm_1</title>
<path fill="none" stroke="black" d="M1077.31,-148757.12C1077.31,-148757.12 1077.31,-148686.55 1077.31,-148686.55"/>
<polygon fill="black" stroke="black" points="1080.81,-148686.55 1077.31,-148676.55 1073.81,-148686.55 1080.81,-148686.55"/>
</g>
<!-- layer4_qkv_0 -->
<g id="node108" class="node">
<title>layer4_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="989,-148536.32 808,-148536.32 808,-148468.32 989,-148468.32 989,-148536.32"/>
<text text-anchor="middle" x="898.5" y="-148521.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="898.5" y="-148506.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="898.5" y="-148491.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="898.5" y="-148476.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer4_norm_0&#45;&gt;layer4_qkv_0 -->
<g id="edge134" class="edge">
<title>layer4_norm_0&#45;&gt;layer4_qkv_0</title>
<path fill="none" stroke="black" d="M902.5,-148608.07C902.5,-148608.07 902.5,-148546.69 902.5,-148546.69"/>
<polygon fill="black" stroke="black" points="906,-148546.69 902.5,-148536.69 899,-148546.69 906,-148546.69"/>
</g>
<!-- layer4_qkv_1 -->
<g id="node109" class="node">
<title>layer4_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1206,-148536.32 1025,-148536.32 1025,-148468.32 1206,-148468.32 1206,-148536.32"/>
<text text-anchor="middle" x="1115.5" y="-148521.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1115.5" y="-148506.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1115.5" y="-148491.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1115.5" y="-148476.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer4_norm_1&#45;&gt;layer4_qkv_1 -->
<g id="edge135" class="edge">
<title>layer4_norm_1&#45;&gt;layer4_qkv_1</title>
<path fill="none" stroke="black" d="M1112.5,-148608.07C1112.5,-148608.07 1112.5,-148546.69 1112.5,-148546.69"/>
<polygon fill="black" stroke="black" points="1116,-148546.69 1112.5,-148536.69 1109,-148546.69 1116,-148546.69"/>
</g>
<!-- layer4_qkv_ar -->
<g id="node110" class="node">
<title>layer4_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1006.5" cy="-148348.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1006.5" y="-148367.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1006.5" y="-148352.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1006.5" y="-148337.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1006.5" y="-148322.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer4_qkv_0&#45;&gt;layer4_qkv_ar -->
<g id="edge136" class="edge">
<title>layer4_qkv_0&#45;&gt;layer4_qkv_ar</title>
<path fill="none" stroke="black" d="M933.76,-148468.12C933.76,-148468.12 933.76,-148398.05 933.76,-148398.05"/>
<polygon fill="black" stroke="black" points="937.26,-148398.05 933.76,-148388.05 930.26,-148398.05 937.26,-148398.05"/>
</g>
<!-- layer4_qkv_1&#45;&gt;layer4_qkv_ar -->
<g id="edge137" class="edge">
<title>layer4_qkv_1&#45;&gt;layer4_qkv_ar</title>
<path fill="none" stroke="black" d="M1079.74,-148468.12C1079.74,-148468.12 1079.74,-148397.77 1079.74,-148397.77"/>
<polygon fill="black" stroke="black" points="1083.24,-148397.77 1079.74,-148387.77 1076.24,-148397.77 1083.24,-148397.77"/>
</g>
<!-- layer4_attn_0 -->
<g id="node111" class="node">
<title>layer4_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="988.5,-148228.15 816.5,-148228.15 816.5,-148160.15 988.5,-148160.15 988.5,-148228.15"/>
<text text-anchor="middle" x="902.5" y="-148212.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="902.5" y="-148197.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="902.5" y="-148182.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="902.5" y="-148167.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer4_qkv_ar&#45;&gt;layer4_attn_0 -->
<g id="edge138" class="edge">
<title>layer4_qkv_ar&#45;&gt;layer4_attn_0</title>
<path fill="none" stroke="black" d="M933.51,-148308.55C933.51,-148308.55 933.51,-148238.21 933.51,-148238.21"/>
<polygon fill="black" stroke="black" points="937.01,-148238.21 933.51,-148228.21 930.01,-148238.21 937.01,-148238.21"/>
</g>
<!-- layer4_attn_1 -->
<g id="node112" class="node">
<title>layer4_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1196.5,-148228.15 1024.5,-148228.15 1024.5,-148160.15 1196.5,-148160.15 1196.5,-148228.15"/>
<text text-anchor="middle" x="1110.5" y="-148212.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1110.5" y="-148197.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1110.5" y="-148182.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1110.5" y="-148167.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer4_qkv_ar&#45;&gt;layer4_attn_1 -->
<g id="edge139" class="edge">
<title>layer4_qkv_ar&#45;&gt;layer4_attn_1</title>
<path fill="none" stroke="black" d="M1079.49,-148308.55C1079.49,-148308.55 1079.49,-148238.21 1079.49,-148238.21"/>
<polygon fill="black" stroke="black" points="1082.99,-148238.21 1079.49,-148228.21 1075.99,-148238.21 1082.99,-148238.21"/>
</g>
<!-- layer4_attn_out_0 -->
<g id="node113" class="node">
<title>layer4_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="988.5,-148088.15 816.5,-148088.15 816.5,-148020.15 988.5,-148020.15 988.5,-148088.15"/>
<text text-anchor="middle" x="902.5" y="-148072.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="902.5" y="-148057.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="902.5" y="-148042.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="902.5" y="-148027.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer4_attn_0&#45;&gt;layer4_attn_out_0 -->
<g id="edge140" class="edge">
<title>layer4_attn_0&#45;&gt;layer4_attn_out_0</title>
<path fill="none" stroke="black" d="M902.5,-148159.9C902.5,-148159.9 902.5,-148098.53 902.5,-148098.53"/>
<polygon fill="black" stroke="black" points="906,-148098.53 902.5,-148088.53 899,-148098.53 906,-148098.53"/>
</g>
<!-- layer4_attn_out_1 -->
<g id="node114" class="node">
<title>layer4_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1196.5,-148088.15 1024.5,-148088.15 1024.5,-148020.15 1196.5,-148020.15 1196.5,-148088.15"/>
<text text-anchor="middle" x="1110.5" y="-148072.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1110.5" y="-148057.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1110.5" y="-148042.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1110.5" y="-148027.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer4_attn_1&#45;&gt;layer4_attn_out_1 -->
<g id="edge141" class="edge">
<title>layer4_attn_1&#45;&gt;layer4_attn_out_1</title>
<path fill="none" stroke="black" d="M1110.5,-148159.9C1110.5,-148159.9 1110.5,-148098.53 1110.5,-148098.53"/>
<polygon fill="black" stroke="black" points="1114,-148098.53 1110.5,-148088.53 1107,-148098.53 1114,-148098.53"/>
</g>
<!-- layer4_attn_ar -->
<g id="node115" class="node">
<title>layer4_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1006.5" cy="-147900.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1006.5" y="-147918.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1006.5" y="-147903.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1006.5" y="-147888.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1006.5" y="-147873.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_attn_out_0&#45;&gt;layer4_attn_ar -->
<g id="edge142" class="edge">
<title>layer4_attn_out_0&#45;&gt;layer4_attn_ar</title>
<path fill="none" stroke="black" d="M936.69,-148019.95C936.69,-148019.95 936.69,-147949.61 936.69,-147949.61"/>
<polygon fill="black" stroke="black" points="940.19,-147949.61 936.69,-147939.61 933.19,-147949.61 940.19,-147949.61"/>
</g>
<!-- layer4_attn_out_1&#45;&gt;layer4_attn_ar -->
<g id="edge143" class="edge">
<title>layer4_attn_out_1&#45;&gt;layer4_attn_ar</title>
<path fill="none" stroke="black" d="M1076.31,-148019.95C1076.31,-148019.95 1076.31,-147949.61 1076.31,-147949.61"/>
<polygon fill="black" stroke="black" points="1079.81,-147949.61 1076.31,-147939.61 1072.81,-147949.61 1079.81,-147949.61"/>
</g>
<!-- layer4_ffn_norm_0 -->
<g id="node116" class="node">
<title>layer4_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="984.5,-147779.98 812.5,-147779.98 812.5,-147711.98 984.5,-147711.98 984.5,-147779.98"/>
<text text-anchor="middle" x="898.5" y="-147764.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="898.5" y="-147749.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="898.5" y="-147734.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="898.5" y="-147719.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_attn_ar&#45;&gt;layer4_ffn_norm_0 -->
<g id="edge144" class="edge">
<title>layer4_attn_ar&#45;&gt;layer4_ffn_norm_0</title>
<path fill="none" stroke="black" d="M934.69,-147861.18C934.69,-147861.18 934.69,-147790.13 934.69,-147790.13"/>
<polygon fill="black" stroke="black" points="938.19,-147790.13 934.69,-147780.13 931.19,-147790.13 938.19,-147790.13"/>
</g>
<!-- layer4_ffn_norm_1 -->
<g id="node117" class="node">
<title>layer4_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1201.5,-147779.98 1029.5,-147779.98 1029.5,-147711.98 1201.5,-147711.98 1201.5,-147779.98"/>
<text text-anchor="middle" x="1115.5" y="-147764.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1115.5" y="-147749.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1115.5" y="-147734.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1115.5" y="-147719.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_attn_ar&#45;&gt;layer4_ffn_norm_1 -->
<g id="edge145" class="edge">
<title>layer4_attn_ar&#45;&gt;layer4_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1078.81,-147861.18C1078.81,-147861.18 1078.81,-147790.13 1078.81,-147790.13"/>
<polygon fill="black" stroke="black" points="1082.31,-147790.13 1078.81,-147780.13 1075.31,-147790.13 1082.31,-147790.13"/>
</g>
<!-- layer4_ffn_gate_0 -->
<g id="node118" class="node">
<title>layer4_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="989,-147639.98 808,-147639.98 808,-147571.98 989,-147571.98 989,-147639.98"/>
<text text-anchor="middle" x="898.5" y="-147624.78" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="898.5" y="-147609.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="898.5" y="-147594.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="898.5" y="-147579.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_ffn_norm_0&#45;&gt;layer4_ffn_gate_0 -->
<g id="edge146" class="edge">
<title>layer4_ffn_norm_0&#45;&gt;layer4_ffn_gate_0</title>
<path fill="none" stroke="black" d="M898.5,-147711.73C898.5,-147711.73 898.5,-147650.36 898.5,-147650.36"/>
<polygon fill="black" stroke="black" points="902,-147650.36 898.5,-147640.36 895,-147650.36 902,-147650.36"/>
</g>
<!-- layer4_ffn_up_0 -->
<g id="node120" class="node">
<title>layer4_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="772,-147639.98 591,-147639.98 591,-147571.98 772,-147571.98 772,-147639.98"/>
<text text-anchor="middle" x="681.5" y="-147624.78" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="681.5" y="-147609.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="681.5" y="-147594.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="681.5" y="-147579.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_ffn_norm_0&#45;&gt;layer4_ffn_up_0 -->
<g id="edge148" class="edge">
<title>layer4_ffn_norm_0&#45;&gt;layer4_ffn_up_0</title>
<path fill="none" stroke="black" d="M812.31,-147745C772.86,-147745 734.76,-147745 734.76,-147745 734.76,-147745 734.76,-147649.99 734.76,-147649.99"/>
<polygon fill="black" stroke="black" points="738.26,-147649.99 734.76,-147639.99 731.26,-147649.99 738.26,-147649.99"/>
</g>
<!-- layer4_ffn_gate_1 -->
<g id="node119" class="node">
<title>layer4_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1423,-147639.98 1242,-147639.98 1242,-147571.98 1423,-147571.98 1423,-147639.98"/>
<text text-anchor="middle" x="1332.5" y="-147624.78" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1332.5" y="-147609.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1332.5" y="-147594.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1332.5" y="-147579.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_ffn_norm_1&#45;&gt;layer4_ffn_gate_1 -->
<g id="edge147" class="edge">
<title>layer4_ffn_norm_1&#45;&gt;layer4_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1201.56,-147745C1240.95,-147745 1279,-147745 1279,-147745 1279,-147745 1279,-147649.99 1279,-147649.99"/>
<polygon fill="black" stroke="black" points="1282.5,-147649.99 1279,-147639.99 1275.5,-147649.99 1282.5,-147649.99"/>
</g>
<!-- layer4_ffn_up_1 -->
<g id="node121" class="node">
<title>layer4_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1206,-147639.98 1025,-147639.98 1025,-147571.98 1206,-147571.98 1206,-147639.98"/>
<text text-anchor="middle" x="1115.5" y="-147624.78" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1115.5" y="-147609.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1115.5" y="-147594.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1115.5" y="-147579.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_ffn_norm_1&#45;&gt;layer4_ffn_up_1 -->
<g id="edge149" class="edge">
<title>layer4_ffn_norm_1&#45;&gt;layer4_ffn_up_1</title>
<path fill="none" stroke="black" d="M1115.5,-147711.73C1115.5,-147711.73 1115.5,-147650.36 1115.5,-147650.36"/>
<polygon fill="black" stroke="black" points="1119,-147650.36 1115.5,-147640.36 1112,-147650.36 1119,-147650.36"/>
</g>
<!-- layer4_gate_ar -->
<g id="node122" class="node">
<title>layer4_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1153.5" cy="-147451.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1153.5" y="-147470.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1153.5" y="-147455.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1153.5" y="-147440.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1153.5" y="-147425.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer4_ffn_gate_0&#45;&gt;layer4_gate_ar -->
<g id="edge150" class="edge">
<title>layer4_ffn_gate_0&#45;&gt;layer4_gate_ar</title>
<path fill="none" stroke="black" d="M962.24,-147571.79C962.24,-147521.9 962.24,-147435 962.24,-147435 962.24,-147435 1023.46,-147435 1023.46,-147435"/>
<polygon fill="black" stroke="black" points="1023.46,-147438.5 1033.46,-147435 1023.46,-147431.5 1023.46,-147438.5"/>
</g>
<!-- layer4_ffn_gate_1&#45;&gt;layer4_gate_ar -->
<g id="edge151" class="edge">
<title>layer4_ffn_gate_1&#45;&gt;layer4_gate_ar</title>
<path fill="none" stroke="black" d="M1261.74,-147571.79C1261.74,-147571.79 1261.74,-147487.86 1261.74,-147487.86"/>
<polygon fill="black" stroke="black" points="1265.24,-147487.86 1261.74,-147477.86 1258.24,-147487.86 1265.24,-147487.86"/>
</g>
<!-- layer4_up_ar -->
<g id="node123" class="node">
<title>layer4_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="807.5" cy="-147451.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="807.5" y="-147470.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="807.5" y="-147455.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="807.5" y="-147440.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="807.5" y="-147425.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer4_ffn_up_0&#45;&gt;layer4_up_ar -->
<g id="edge152" class="edge">
<title>layer4_ffn_up_0&#45;&gt;layer4_up_ar</title>
<path fill="none" stroke="black" d="M725.76,-147571.79C725.76,-147571.79 725.76,-147498.96 725.76,-147498.96"/>
<polygon fill="black" stroke="black" points="729.26,-147498.96 725.76,-147488.96 722.26,-147498.96 729.26,-147498.96"/>
</g>
<!-- layer4_ffn_up_1&#45;&gt;layer4_up_ar -->
<g id="edge153" class="edge">
<title>layer4_ffn_up_1&#45;&gt;layer4_up_ar</title>
<path fill="none" stroke="black" d="M1024.92,-147605C1014.21,-147605 1007,-147605 1007,-147605 1007,-147605 1007,-147467 1007,-147467 1007,-147467 939.01,-147467 939.01,-147467"/>
<polygon fill="black" stroke="black" points="939.01,-147463.5 929.01,-147467 939.01,-147470.5 939.01,-147463.5"/>
</g>
<!-- layer4_silu_0 -->
<g id="node124" class="node">
<title>layer4_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1081,-147331.82 900,-147331.82 900,-147263.82 1081,-147263.82 1081,-147331.82"/>
<text text-anchor="middle" x="990.5" y="-147316.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="990.5" y="-147301.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="990.5" y="-147286.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="990.5" y="-147271.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_gate_ar&#45;&gt;layer4_silu_0 -->
<g id="edge154" class="edge">
<title>layer4_gate_ar&#45;&gt;layer4_silu_0</title>
<path fill="none" stroke="black" d="M1053.26,-147421.82C1053.26,-147421.82 1053.26,-147341.84 1053.26,-147341.84"/>
<polygon fill="black" stroke="black" points="1056.76,-147341.84 1053.26,-147331.84 1049.76,-147341.84 1056.76,-147341.84"/>
</g>
<!-- layer4_silu_1 -->
<g id="node125" class="node">
<title>layer4_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1298,-147331.82 1117,-147331.82 1117,-147263.82 1298,-147263.82 1298,-147331.82"/>
<text text-anchor="middle" x="1207.5" y="-147316.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1207.5" y="-147301.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1207.5" y="-147286.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1207.5" y="-147271.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_gate_ar&#45;&gt;layer4_silu_1 -->
<g id="edge155" class="edge">
<title>layer4_gate_ar&#45;&gt;layer4_silu_1</title>
<path fill="none" stroke="black" d="M1199.24,-147406.92C1199.24,-147406.92 1199.24,-147341.82 1199.24,-147341.82"/>
<polygon fill="black" stroke="black" points="1202.74,-147341.82 1199.24,-147331.82 1195.74,-147341.82 1202.74,-147341.82"/>
</g>
<!-- layer4_mul_0 -->
<g id="node126" class="node">
<title>layer4_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="971,-147191.82 790,-147191.82 790,-147123.82 971,-147123.82 971,-147191.82"/>
<text text-anchor="middle" x="880.5" y="-147176.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="880.5" y="-147161.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="880.5" y="-147146.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="880.5" y="-147131.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_up_ar&#45;&gt;layer4_mul_0 -->
<g id="edge157" class="edge">
<title>layer4_up_ar&#45;&gt;layer4_mul_0</title>
<path fill="none" stroke="black" d="M845,-147405.63C845,-147405.63 845,-147201.9 845,-147201.9"/>
<polygon fill="black" stroke="black" points="848.5,-147201.9 845,-147191.9 841.5,-147201.9 848.5,-147201.9"/>
</g>
<!-- layer4_mul_1 -->
<g id="node127" class="node">
<title>layer4_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1188,-147191.82 1007,-147191.82 1007,-147123.82 1188,-147123.82 1188,-147191.82"/>
<text text-anchor="middle" x="1097.5" y="-147176.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1097.5" y="-147161.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1097.5" y="-147146.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1097.5" y="-147131.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer4_up_ar&#45;&gt;layer4_mul_1 -->
<g id="edge159" class="edge">
<title>layer4_up_ar&#45;&gt;layer4_mul_1</title>
<path fill="none" stroke="black" d="M917.74,-147427.34C917.74,-147402.27 917.74,-147367 917.74,-147367 917.74,-147367 1099,-147367 1099,-147367 1099,-147367 1099,-147201.89 1099,-147201.89"/>
<polygon fill="black" stroke="black" points="1102.5,-147201.89 1099,-147191.89 1095.5,-147201.89 1102.5,-147201.89"/>
</g>
<!-- layer4_silu_0&#45;&gt;layer4_mul_0 -->
<g id="edge156" class="edge">
<title>layer4_silu_0&#45;&gt;layer4_mul_0</title>
<path fill="none" stroke="black" d="M935.5,-147263.57C935.5,-147263.57 935.5,-147202.2 935.5,-147202.2"/>
<polygon fill="black" stroke="black" points="939,-147202.2 935.5,-147192.2 932,-147202.2 939,-147202.2"/>
</g>
<!-- layer4_silu_1&#45;&gt;layer4_mul_1 -->
<g id="edge158" class="edge">
<title>layer4_silu_1&#45;&gt;layer4_mul_1</title>
<path fill="none" stroke="black" d="M1152.5,-147263.57C1152.5,-147263.57 1152.5,-147202.2 1152.5,-147202.2"/>
<polygon fill="black" stroke="black" points="1156,-147202.2 1152.5,-147192.2 1149,-147202.2 1156,-147202.2"/>
</g>
<!-- layer4_ffn_down_0 -->
<g id="node128" class="node">
<title>layer4_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="970.5,-147051.82 798.5,-147051.82 798.5,-146983.82 970.5,-146983.82 970.5,-147051.82"/>
<text text-anchor="middle" x="884.5" y="-147036.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="884.5" y="-147021.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="884.5" y="-147006.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="884.5" y="-146991.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer4_mul_0&#45;&gt;layer4_ffn_down_0 -->
<g id="edge160" class="edge">
<title>layer4_mul_0&#45;&gt;layer4_ffn_down_0</title>
<path fill="none" stroke="black" d="M884.5,-147123.57C884.5,-147123.57 884.5,-147062.2 884.5,-147062.2"/>
<polygon fill="black" stroke="black" points="888,-147062.2 884.5,-147052.2 881,-147062.2 888,-147062.2"/>
</g>
<!-- layer4_ffn_down_1 -->
<g id="node129" class="node">
<title>layer4_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1180.5,-147051.82 1008.5,-147051.82 1008.5,-146983.82 1180.5,-146983.82 1180.5,-147051.82"/>
<text text-anchor="middle" x="1094.5" y="-147036.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1094.5" y="-147021.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1094.5" y="-147006.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1094.5" y="-146991.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer4_mul_1&#45;&gt;layer4_ffn_down_1 -->
<g id="edge161" class="edge">
<title>layer4_mul_1&#45;&gt;layer4_ffn_down_1</title>
<path fill="none" stroke="black" d="M1094.5,-147123.57C1094.5,-147123.57 1094.5,-147062.2 1094.5,-147062.2"/>
<polygon fill="black" stroke="black" points="1098,-147062.2 1094.5,-147052.2 1091,-147062.2 1098,-147062.2"/>
</g>
<!-- layer4_ffn_ar -->
<g id="node130" class="node">
<title>layer4_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="988.5" cy="-146863.73" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="988.5" y="-146882.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="988.5" y="-146867.53" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="988.5" y="-146852.53" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-146837.53" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_ffn_down_0&#45;&gt;layer4_ffn_ar -->
<g id="edge162" class="edge">
<title>layer4_ffn_down_0&#45;&gt;layer4_ffn_ar</title>
<path fill="none" stroke="black" d="M918.69,-146983.62C918.69,-146983.62 918.69,-146913.28 918.69,-146913.28"/>
<polygon fill="black" stroke="black" points="922.19,-146913.28 918.69,-146903.28 915.19,-146913.28 922.19,-146913.28"/>
</g>
<!-- layer4_ffn_down_1&#45;&gt;layer4_ffn_ar -->
<g id="edge163" class="edge">
<title>layer4_ffn_down_1&#45;&gt;layer4_ffn_ar</title>
<path fill="none" stroke="black" d="M1059.31,-146983.62C1059.31,-146983.62 1059.31,-146913 1059.31,-146913"/>
<polygon fill="black" stroke="black" points="1062.81,-146913 1059.31,-146903 1055.81,-146913 1062.81,-146913"/>
</g>
<!-- layer5_norm_0 -->
<g id="node131" class="node">
<title>layer5_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="970.5,-146743.65 798.5,-146743.65 798.5,-146675.65 970.5,-146675.65 970.5,-146743.65"/>
<text text-anchor="middle" x="884.5" y="-146728.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="884.5" y="-146713.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="884.5" y="-146698.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="884.5" y="-146683.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_ffn_ar&#45;&gt;layer5_norm_0 -->
<g id="edge164" class="edge">
<title>layer4_ffn_ar&#45;&gt;layer5_norm_0</title>
<path fill="none" stroke="black" d="M918.69,-146824.05C918.69,-146824.05 918.69,-146753.71 918.69,-146753.71"/>
<polygon fill="black" stroke="black" points="922.19,-146753.71 918.69,-146743.71 915.19,-146753.71 922.19,-146753.71"/>
</g>
<!-- layer5_norm_1 -->
<g id="node132" class="node">
<title>layer5_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1180.5,-146743.65 1008.5,-146743.65 1008.5,-146675.65 1180.5,-146675.65 1180.5,-146743.65"/>
<text text-anchor="middle" x="1094.5" y="-146728.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1094.5" y="-146713.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1094.5" y="-146698.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1094.5" y="-146683.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_ffn_ar&#45;&gt;layer5_norm_1 -->
<g id="edge165" class="edge">
<title>layer4_ffn_ar&#45;&gt;layer5_norm_1</title>
<path fill="none" stroke="black" d="M1059.31,-146824.45C1059.31,-146824.45 1059.31,-146753.88 1059.31,-146753.88"/>
<polygon fill="black" stroke="black" points="1062.81,-146753.88 1059.31,-146743.88 1055.81,-146753.88 1062.81,-146753.88"/>
</g>
<!-- layer5_qkv_0 -->
<g id="node133" class="node">
<title>layer5_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="971,-146603.65 790,-146603.65 790,-146535.65 971,-146535.65 971,-146603.65"/>
<text text-anchor="middle" x="880.5" y="-146588.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="880.5" y="-146573.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="880.5" y="-146558.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="880.5" y="-146543.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer5_norm_0&#45;&gt;layer5_qkv_0 -->
<g id="edge166" class="edge">
<title>layer5_norm_0&#45;&gt;layer5_qkv_0</title>
<path fill="none" stroke="black" d="M884.5,-146675.4C884.5,-146675.4 884.5,-146614.03 884.5,-146614.03"/>
<polygon fill="black" stroke="black" points="888,-146614.03 884.5,-146604.03 881,-146614.03 888,-146614.03"/>
</g>
<!-- layer5_qkv_1 -->
<g id="node134" class="node">
<title>layer5_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1188,-146603.65 1007,-146603.65 1007,-146535.65 1188,-146535.65 1188,-146603.65"/>
<text text-anchor="middle" x="1097.5" y="-146588.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1097.5" y="-146573.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1097.5" y="-146558.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1097.5" y="-146543.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer5_norm_1&#45;&gt;layer5_qkv_1 -->
<g id="edge167" class="edge">
<title>layer5_norm_1&#45;&gt;layer5_qkv_1</title>
<path fill="none" stroke="black" d="M1094.5,-146675.4C1094.5,-146675.4 1094.5,-146614.03 1094.5,-146614.03"/>
<polygon fill="black" stroke="black" points="1098,-146614.03 1094.5,-146604.03 1091,-146614.03 1098,-146614.03"/>
</g>
<!-- layer5_qkv_ar -->
<g id="node135" class="node">
<title>layer5_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="988.5" cy="-146415.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="988.5" y="-146434.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="988.5" y="-146419.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="988.5" y="-146404.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="988.5" y="-146389.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer5_qkv_0&#45;&gt;layer5_qkv_ar -->
<g id="edge168" class="edge">
<title>layer5_qkv_0&#45;&gt;layer5_qkv_ar</title>
<path fill="none" stroke="black" d="M915.76,-146535.45C915.76,-146535.45 915.76,-146465.39 915.76,-146465.39"/>
<polygon fill="black" stroke="black" points="919.26,-146465.39 915.76,-146455.39 912.26,-146465.39 919.26,-146465.39"/>
</g>
<!-- layer5_qkv_1&#45;&gt;layer5_qkv_ar -->
<g id="edge169" class="edge">
<title>layer5_qkv_1&#45;&gt;layer5_qkv_ar</title>
<path fill="none" stroke="black" d="M1061.74,-146535.45C1061.74,-146535.45 1061.74,-146465.11 1061.74,-146465.11"/>
<polygon fill="black" stroke="black" points="1065.24,-146465.11 1061.74,-146455.11 1058.24,-146465.11 1065.24,-146465.11"/>
</g>
<!-- layer5_attn_0 -->
<g id="node136" class="node">
<title>layer5_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="970.5,-146295.48 798.5,-146295.48 798.5,-146227.48 970.5,-146227.48 970.5,-146295.48"/>
<text text-anchor="middle" x="884.5" y="-146280.28" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="884.5" y="-146265.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="884.5" y="-146250.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="884.5" y="-146235.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer5_qkv_ar&#45;&gt;layer5_attn_0 -->
<g id="edge170" class="edge">
<title>layer5_qkv_ar&#45;&gt;layer5_attn_0</title>
<path fill="none" stroke="black" d="M915.51,-146375.89C915.51,-146375.89 915.51,-146305.54 915.51,-146305.54"/>
<polygon fill="black" stroke="black" points="919.01,-146305.54 915.51,-146295.54 912.01,-146305.54 919.01,-146305.54"/>
</g>
<!-- layer5_attn_1 -->
<g id="node137" class="node">
<title>layer5_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1178.5,-146295.48 1006.5,-146295.48 1006.5,-146227.48 1178.5,-146227.48 1178.5,-146295.48"/>
<text text-anchor="middle" x="1092.5" y="-146280.28" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1092.5" y="-146265.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1092.5" y="-146250.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1092.5" y="-146235.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer5_qkv_ar&#45;&gt;layer5_attn_1 -->
<g id="edge171" class="edge">
<title>layer5_qkv_ar&#45;&gt;layer5_attn_1</title>
<path fill="none" stroke="black" d="M1061.49,-146375.89C1061.49,-146375.89 1061.49,-146305.54 1061.49,-146305.54"/>
<polygon fill="black" stroke="black" points="1064.99,-146305.54 1061.49,-146295.54 1057.99,-146305.54 1064.99,-146305.54"/>
</g>
<!-- layer5_attn_out_0 -->
<g id="node138" class="node">
<title>layer5_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="970.5,-146155.48 798.5,-146155.48 798.5,-146087.48 970.5,-146087.48 970.5,-146155.48"/>
<text text-anchor="middle" x="884.5" y="-146140.28" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="884.5" y="-146125.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="884.5" y="-146110.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="884.5" y="-146095.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer5_attn_0&#45;&gt;layer5_attn_out_0 -->
<g id="edge172" class="edge">
<title>layer5_attn_0&#45;&gt;layer5_attn_out_0</title>
<path fill="none" stroke="black" d="M884.5,-146227.23C884.5,-146227.23 884.5,-146165.86 884.5,-146165.86"/>
<polygon fill="black" stroke="black" points="888,-146165.86 884.5,-146155.86 881,-146165.86 888,-146165.86"/>
</g>
<!-- layer5_attn_out_1 -->
<g id="node139" class="node">
<title>layer5_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1178.5,-146155.48 1006.5,-146155.48 1006.5,-146087.48 1178.5,-146087.48 1178.5,-146155.48"/>
<text text-anchor="middle" x="1092.5" y="-146140.28" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1092.5" y="-146125.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1092.5" y="-146110.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1092.5" y="-146095.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer5_attn_1&#45;&gt;layer5_attn_out_1 -->
<g id="edge173" class="edge">
<title>layer5_attn_1&#45;&gt;layer5_attn_out_1</title>
<path fill="none" stroke="black" d="M1092.5,-146227.23C1092.5,-146227.23 1092.5,-146165.86 1092.5,-146165.86"/>
<polygon fill="black" stroke="black" points="1096,-146165.86 1092.5,-146155.86 1089,-146165.86 1096,-146165.86"/>
</g>
<!-- layer5_attn_ar -->
<g id="node140" class="node">
<title>layer5_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="988.5" cy="-145967.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="988.5" y="-145986.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="988.5" y="-145971.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="988.5" y="-145956.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-145941.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_attn_out_0&#45;&gt;layer5_attn_ar -->
<g id="edge174" class="edge">
<title>layer5_attn_out_0&#45;&gt;layer5_attn_ar</title>
<path fill="none" stroke="black" d="M918.69,-146087.29C918.69,-146087.29 918.69,-146016.94 918.69,-146016.94"/>
<polygon fill="black" stroke="black" points="922.19,-146016.94 918.69,-146006.94 915.19,-146016.94 922.19,-146016.94"/>
</g>
<!-- layer5_attn_out_1&#45;&gt;layer5_attn_ar -->
<g id="edge175" class="edge">
<title>layer5_attn_out_1&#45;&gt;layer5_attn_ar</title>
<path fill="none" stroke="black" d="M1058.31,-146087.29C1058.31,-146087.29 1058.31,-146016.94 1058.31,-146016.94"/>
<polygon fill="black" stroke="black" points="1061.81,-146016.94 1058.31,-146006.94 1054.81,-146016.94 1061.81,-146016.94"/>
</g>
<!-- layer5_ffn_norm_0 -->
<g id="node141" class="node">
<title>layer5_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="966.5,-145847.32 794.5,-145847.32 794.5,-145779.32 966.5,-145779.32 966.5,-145847.32"/>
<text text-anchor="middle" x="880.5" y="-145832.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="880.5" y="-145817.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="880.5" y="-145802.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="880.5" y="-145787.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_attn_ar&#45;&gt;layer5_ffn_norm_0 -->
<g id="edge176" class="edge">
<title>layer5_attn_ar&#45;&gt;layer5_ffn_norm_0</title>
<path fill="none" stroke="black" d="M916.69,-145928.52C916.69,-145928.52 916.69,-145857.46 916.69,-145857.46"/>
<polygon fill="black" stroke="black" points="920.19,-145857.46 916.69,-145847.46 913.19,-145857.46 920.19,-145857.46"/>
</g>
<!-- layer5_ffn_norm_1 -->
<g id="node142" class="node">
<title>layer5_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1183.5,-145847.32 1011.5,-145847.32 1011.5,-145779.32 1183.5,-145779.32 1183.5,-145847.32"/>
<text text-anchor="middle" x="1097.5" y="-145832.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1097.5" y="-145817.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1097.5" y="-145802.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1097.5" y="-145787.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_attn_ar&#45;&gt;layer5_ffn_norm_1 -->
<g id="edge177" class="edge">
<title>layer5_attn_ar&#45;&gt;layer5_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1060.81,-145928.52C1060.81,-145928.52 1060.81,-145857.46 1060.81,-145857.46"/>
<polygon fill="black" stroke="black" points="1064.31,-145857.46 1060.81,-145847.46 1057.31,-145857.46 1064.31,-145857.46"/>
</g>
<!-- layer5_ffn_gate_0 -->
<g id="node143" class="node">
<title>layer5_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="971,-145707.32 790,-145707.32 790,-145639.32 971,-145639.32 971,-145707.32"/>
<text text-anchor="middle" x="880.5" y="-145692.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="880.5" y="-145677.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="880.5" y="-145662.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="880.5" y="-145647.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_ffn_norm_0&#45;&gt;layer5_ffn_gate_0 -->
<g id="edge178" class="edge">
<title>layer5_ffn_norm_0&#45;&gt;layer5_ffn_gate_0</title>
<path fill="none" stroke="black" d="M880.5,-145779.07C880.5,-145779.07 880.5,-145717.7 880.5,-145717.7"/>
<polygon fill="black" stroke="black" points="884,-145717.7 880.5,-145707.7 877,-145717.7 884,-145717.7"/>
</g>
<!-- layer5_ffn_up_0 -->
<g id="node145" class="node">
<title>layer5_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="754,-145707.32 573,-145707.32 573,-145639.32 754,-145639.32 754,-145707.32"/>
<text text-anchor="middle" x="663.5" y="-145692.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="663.5" y="-145677.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="663.5" y="-145662.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="663.5" y="-145647.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_ffn_norm_0&#45;&gt;layer5_ffn_up_0 -->
<g id="edge180" class="edge">
<title>layer5_ffn_norm_0&#45;&gt;layer5_ffn_up_0</title>
<path fill="none" stroke="black" d="M794.31,-145813C754.86,-145813 716.76,-145813 716.76,-145813 716.76,-145813 716.76,-145717.49 716.76,-145717.49"/>
<polygon fill="black" stroke="black" points="720.26,-145717.49 716.76,-145707.49 713.26,-145717.49 720.26,-145717.49"/>
</g>
<!-- layer5_ffn_gate_1 -->
<g id="node144" class="node">
<title>layer5_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1405,-145707.32 1224,-145707.32 1224,-145639.32 1405,-145639.32 1405,-145707.32"/>
<text text-anchor="middle" x="1314.5" y="-145692.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1314.5" y="-145677.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1314.5" y="-145662.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1314.5" y="-145647.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_ffn_norm_1&#45;&gt;layer5_ffn_gate_1 -->
<g id="edge179" class="edge">
<title>layer5_ffn_norm_1&#45;&gt;layer5_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1183.56,-145813C1222.95,-145813 1261,-145813 1261,-145813 1261,-145813 1261,-145717.49 1261,-145717.49"/>
<polygon fill="black" stroke="black" points="1264.5,-145717.49 1261,-145707.49 1257.5,-145717.49 1264.5,-145717.49"/>
</g>
<!-- layer5_ffn_up_1 -->
<g id="node146" class="node">
<title>layer5_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1188,-145707.32 1007,-145707.32 1007,-145639.32 1188,-145639.32 1188,-145707.32"/>
<text text-anchor="middle" x="1097.5" y="-145692.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1097.5" y="-145677.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1097.5" y="-145662.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1097.5" y="-145647.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_ffn_norm_1&#45;&gt;layer5_ffn_up_1 -->
<g id="edge181" class="edge">
<title>layer5_ffn_norm_1&#45;&gt;layer5_ffn_up_1</title>
<path fill="none" stroke="black" d="M1097.5,-145779.07C1097.5,-145779.07 1097.5,-145717.7 1097.5,-145717.7"/>
<polygon fill="black" stroke="black" points="1101,-145717.7 1097.5,-145707.7 1094,-145717.7 1101,-145717.7"/>
</g>
<!-- layer5_gate_ar -->
<g id="node147" class="node">
<title>layer5_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1188.5" cy="-145519.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1188.5" y="-145538.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1188.5" y="-145523.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1188.5" y="-145508.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1188.5" y="-145493.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer5_ffn_gate_0&#45;&gt;layer5_gate_ar -->
<g id="edge182" class="edge">
<title>layer5_ffn_gate_0&#45;&gt;layer5_gate_ar</title>
<path fill="none" stroke="black" d="M971.08,-145673C981.79,-145673 989,-145673 989,-145673 989,-145673 989,-145535 989,-145535 989,-145535 1057.56,-145535 1057.56,-145535"/>
<polygon fill="black" stroke="black" points="1057.56,-145538.5 1067.56,-145535 1057.56,-145531.5 1057.56,-145538.5"/>
</g>
<!-- layer5_ffn_gate_1&#45;&gt;layer5_gate_ar -->
<g id="edge183" class="edge">
<title>layer5_ffn_gate_1&#45;&gt;layer5_gate_ar</title>
<path fill="none" stroke="black" d="M1270.24,-145639.12C1270.24,-145639.12 1270.24,-145566.3 1270.24,-145566.3"/>
<polygon fill="black" stroke="black" points="1273.74,-145566.3 1270.24,-145556.3 1266.74,-145566.3 1273.74,-145566.3"/>
</g>
<!-- layer5_up_ar -->
<g id="node148" class="node">
<title>layer5_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="842.5" cy="-145519.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="842.5" y="-145538.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="842.5" y="-145523.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="842.5" y="-145508.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="842.5" y="-145493.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer5_ffn_up_0&#45;&gt;layer5_up_ar -->
<g id="edge184" class="edge">
<title>layer5_ffn_up_0&#45;&gt;layer5_up_ar</title>
<path fill="none" stroke="black" d="M734.26,-145639.12C734.26,-145639.12 734.26,-145555.2 734.26,-145555.2"/>
<polygon fill="black" stroke="black" points="737.76,-145555.2 734.26,-145545.2 730.76,-145555.2 737.76,-145555.2"/>
</g>
<!-- layer5_ffn_up_1&#45;&gt;layer5_up_ar -->
<g id="edge185" class="edge">
<title>layer5_ffn_up_1&#45;&gt;layer5_up_ar</title>
<path fill="none" stroke="black" d="M1033.76,-145639.26C1033.76,-145589.56 1033.76,-145503 1033.76,-145503 1033.76,-145503 973.08,-145503 973.08,-145503"/>
<polygon fill="black" stroke="black" points="973.08,-145499.5 963.08,-145503 973.08,-145506.5 973.08,-145499.5"/>
</g>
<!-- layer5_silu_0 -->
<g id="node149" class="node">
<title>layer5_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1116,-145399.15 935,-145399.15 935,-145331.15 1116,-145331.15 1116,-145399.15"/>
<text text-anchor="middle" x="1025.5" y="-145383.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1025.5" y="-145368.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1025.5" y="-145353.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1025.5" y="-145338.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_gate_ar&#45;&gt;layer5_silu_0 -->
<g id="edge186" class="edge">
<title>layer5_gate_ar&#45;&gt;layer5_silu_0</title>
<path fill="none" stroke="black" d="M1088.26,-145489.16C1088.26,-145489.16 1088.26,-145409.17 1088.26,-145409.17"/>
<polygon fill="black" stroke="black" points="1091.76,-145409.17 1088.26,-145399.17 1084.76,-145409.17 1091.76,-145409.17"/>
</g>
<!-- layer5_silu_1 -->
<g id="node150" class="node">
<title>layer5_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1333,-145399.15 1152,-145399.15 1152,-145331.15 1333,-145331.15 1333,-145399.15"/>
<text text-anchor="middle" x="1242.5" y="-145383.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1242.5" y="-145368.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1242.5" y="-145353.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1242.5" y="-145338.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_gate_ar&#45;&gt;layer5_silu_1 -->
<g id="edge187" class="edge">
<title>layer5_gate_ar&#45;&gt;layer5_silu_1</title>
<path fill="none" stroke="black" d="M1234.24,-145474.25C1234.24,-145474.25 1234.24,-145409.16 1234.24,-145409.16"/>
<polygon fill="black" stroke="black" points="1237.74,-145409.16 1234.24,-145399.16 1230.74,-145409.16 1237.74,-145409.16"/>
</g>
<!-- layer5_mul_0 -->
<g id="node151" class="node">
<title>layer5_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1006,-145259.15 825,-145259.15 825,-145191.15 1006,-145191.15 1006,-145259.15"/>
<text text-anchor="middle" x="915.5" y="-145243.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="915.5" y="-145228.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="915.5" y="-145213.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="915.5" y="-145198.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_up_ar&#45;&gt;layer5_mul_0 -->
<g id="edge189" class="edge">
<title>layer5_up_ar&#45;&gt;layer5_mul_0</title>
<path fill="none" stroke="black" d="M880,-145472.96C880,-145472.96 880,-145269.23 880,-145269.23"/>
<polygon fill="black" stroke="black" points="883.5,-145269.23 880,-145259.23 876.5,-145269.23 883.5,-145269.23"/>
</g>
<!-- layer5_mul_1 -->
<g id="node152" class="node">
<title>layer5_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1223,-145259.15 1042,-145259.15 1042,-145191.15 1223,-145191.15 1223,-145259.15"/>
<text text-anchor="middle" x="1132.5" y="-145243.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1132.5" y="-145228.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1132.5" y="-145213.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1132.5" y="-145198.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer5_up_ar&#45;&gt;layer5_mul_1 -->
<g id="edge191" class="edge">
<title>layer5_up_ar&#45;&gt;layer5_mul_1</title>
<path fill="none" stroke="black" d="M952.74,-145494.42C952.74,-145469.57 952.74,-145435 952.74,-145435 952.74,-145435 1134,-145435 1134,-145435 1134,-145435 1134,-145269.33 1134,-145269.33"/>
<polygon fill="black" stroke="black" points="1137.5,-145269.33 1134,-145259.33 1130.5,-145269.33 1137.5,-145269.33"/>
</g>
<!-- layer5_silu_0&#45;&gt;layer5_mul_0 -->
<g id="edge188" class="edge">
<title>layer5_silu_0&#45;&gt;layer5_mul_0</title>
<path fill="none" stroke="black" d="M970.5,-145330.9C970.5,-145330.9 970.5,-145269.53 970.5,-145269.53"/>
<polygon fill="black" stroke="black" points="974,-145269.53 970.5,-145259.53 967,-145269.53 974,-145269.53"/>
</g>
<!-- layer5_silu_1&#45;&gt;layer5_mul_1 -->
<g id="edge190" class="edge">
<title>layer5_silu_1&#45;&gt;layer5_mul_1</title>
<path fill="none" stroke="black" d="M1187.5,-145330.9C1187.5,-145330.9 1187.5,-145269.53 1187.5,-145269.53"/>
<polygon fill="black" stroke="black" points="1191,-145269.53 1187.5,-145259.53 1184,-145269.53 1191,-145269.53"/>
</g>
<!-- layer5_ffn_down_0 -->
<g id="node153" class="node">
<title>layer5_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1005.5,-145119.15 833.5,-145119.15 833.5,-145051.15 1005.5,-145051.15 1005.5,-145119.15"/>
<text text-anchor="middle" x="919.5" y="-145103.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="919.5" y="-145088.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="919.5" y="-145073.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="919.5" y="-145058.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer5_mul_0&#45;&gt;layer5_ffn_down_0 -->
<g id="edge192" class="edge">
<title>layer5_mul_0&#45;&gt;layer5_ffn_down_0</title>
<path fill="none" stroke="black" d="M919.5,-145190.9C919.5,-145190.9 919.5,-145129.53 919.5,-145129.53"/>
<polygon fill="black" stroke="black" points="923,-145129.53 919.5,-145119.53 916,-145129.53 923,-145129.53"/>
</g>
<!-- layer5_ffn_down_1 -->
<g id="node154" class="node">
<title>layer5_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1215.5,-145119.15 1043.5,-145119.15 1043.5,-145051.15 1215.5,-145051.15 1215.5,-145119.15"/>
<text text-anchor="middle" x="1129.5" y="-145103.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1129.5" y="-145088.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1129.5" y="-145073.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1129.5" y="-145058.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer5_mul_1&#45;&gt;layer5_ffn_down_1 -->
<g id="edge193" class="edge">
<title>layer5_mul_1&#45;&gt;layer5_ffn_down_1</title>
<path fill="none" stroke="black" d="M1129.5,-145190.9C1129.5,-145190.9 1129.5,-145129.53 1129.5,-145129.53"/>
<polygon fill="black" stroke="black" points="1133,-145129.53 1129.5,-145119.53 1126,-145129.53 1133,-145129.53"/>
</g>
<!-- layer5_ffn_ar -->
<g id="node155" class="node">
<title>layer5_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1023.5" cy="-144931.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1023.5" y="-144949.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1023.5" y="-144934.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1023.5" y="-144919.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1023.5" y="-144904.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_ffn_down_0&#45;&gt;layer5_ffn_ar -->
<g id="edge194" class="edge">
<title>layer5_ffn_down_0&#45;&gt;layer5_ffn_ar</title>
<path fill="none" stroke="black" d="M953.69,-145050.95C953.69,-145050.95 953.69,-144980.61 953.69,-144980.61"/>
<polygon fill="black" stroke="black" points="957.19,-144980.61 953.69,-144970.61 950.19,-144980.61 957.19,-144980.61"/>
</g>
<!-- layer5_ffn_down_1&#45;&gt;layer5_ffn_ar -->
<g id="edge195" class="edge">
<title>layer5_ffn_down_1&#45;&gt;layer5_ffn_ar</title>
<path fill="none" stroke="black" d="M1094.31,-145050.95C1094.31,-145050.95 1094.31,-144980.33 1094.31,-144980.33"/>
<polygon fill="black" stroke="black" points="1097.81,-144980.33 1094.31,-144970.33 1090.81,-144980.33 1097.81,-144980.33"/>
</g>
<!-- layer6_norm_0 -->
<g id="node156" class="node">
<title>layer6_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1005.5,-144810.98 833.5,-144810.98 833.5,-144742.98 1005.5,-144742.98 1005.5,-144810.98"/>
<text text-anchor="middle" x="919.5" y="-144795.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="919.5" y="-144780.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="919.5" y="-144765.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="919.5" y="-144750.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_ffn_ar&#45;&gt;layer6_norm_0 -->
<g id="edge196" class="edge">
<title>layer5_ffn_ar&#45;&gt;layer6_norm_0</title>
<path fill="none" stroke="black" d="M953.69,-144891.39C953.69,-144891.39 953.69,-144821.04 953.69,-144821.04"/>
<polygon fill="black" stroke="black" points="957.19,-144821.04 953.69,-144811.04 950.19,-144821.04 957.19,-144821.04"/>
</g>
<!-- layer6_norm_1 -->
<g id="node157" class="node">
<title>layer6_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1215.5,-144810.98 1043.5,-144810.98 1043.5,-144742.98 1215.5,-144742.98 1215.5,-144810.98"/>
<text text-anchor="middle" x="1129.5" y="-144795.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1129.5" y="-144780.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1129.5" y="-144765.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1129.5" y="-144750.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_ffn_ar&#45;&gt;layer6_norm_1 -->
<g id="edge197" class="edge">
<title>layer5_ffn_ar&#45;&gt;layer6_norm_1</title>
<path fill="none" stroke="black" d="M1094.31,-144891.79C1094.31,-144891.79 1094.31,-144821.21 1094.31,-144821.21"/>
<polygon fill="black" stroke="black" points="1097.81,-144821.21 1094.31,-144811.21 1090.81,-144821.21 1097.81,-144821.21"/>
</g>
<!-- layer6_qkv_0 -->
<g id="node158" class="node">
<title>layer6_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1006,-144670.98 825,-144670.98 825,-144602.98 1006,-144602.98 1006,-144670.98"/>
<text text-anchor="middle" x="915.5" y="-144655.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="915.5" y="-144640.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="915.5" y="-144625.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="915.5" y="-144610.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer6_norm_0&#45;&gt;layer6_qkv_0 -->
<g id="edge198" class="edge">
<title>layer6_norm_0&#45;&gt;layer6_qkv_0</title>
<path fill="none" stroke="black" d="M919.5,-144742.74C919.5,-144742.74 919.5,-144681.36 919.5,-144681.36"/>
<polygon fill="black" stroke="black" points="923,-144681.36 919.5,-144671.36 916,-144681.36 923,-144681.36"/>
</g>
<!-- layer6_qkv_1 -->
<g id="node159" class="node">
<title>layer6_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1223,-144670.98 1042,-144670.98 1042,-144602.98 1223,-144602.98 1223,-144670.98"/>
<text text-anchor="middle" x="1132.5" y="-144655.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1132.5" y="-144640.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1132.5" y="-144625.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1132.5" y="-144610.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer6_norm_1&#45;&gt;layer6_qkv_1 -->
<g id="edge199" class="edge">
<title>layer6_norm_1&#45;&gt;layer6_qkv_1</title>
<path fill="none" stroke="black" d="M1129.5,-144742.74C1129.5,-144742.74 1129.5,-144681.36 1129.5,-144681.36"/>
<polygon fill="black" stroke="black" points="1133,-144681.36 1129.5,-144671.36 1126,-144681.36 1133,-144681.36"/>
</g>
<!-- layer6_qkv_ar -->
<g id="node160" class="node">
<title>layer6_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1023.5" cy="-144482.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1023.5" y="-144501.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1023.5" y="-144486.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1023.5" y="-144471.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1023.5" y="-144456.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer6_qkv_0&#45;&gt;layer6_qkv_ar -->
<g id="edge200" class="edge">
<title>layer6_qkv_0&#45;&gt;layer6_qkv_ar</title>
<path fill="none" stroke="black" d="M950.76,-144602.79C950.76,-144602.79 950.76,-144532.72 950.76,-144532.72"/>
<polygon fill="black" stroke="black" points="954.26,-144532.72 950.76,-144522.72 947.26,-144532.72 954.26,-144532.72"/>
</g>
<!-- layer6_qkv_1&#45;&gt;layer6_qkv_ar -->
<g id="edge201" class="edge">
<title>layer6_qkv_1&#45;&gt;layer6_qkv_ar</title>
<path fill="none" stroke="black" d="M1096.74,-144602.79C1096.74,-144602.79 1096.74,-144532.44 1096.74,-144532.44"/>
<polygon fill="black" stroke="black" points="1100.24,-144532.44 1096.74,-144522.44 1093.24,-144532.44 1100.24,-144532.44"/>
</g>
<!-- layer6_attn_0 -->
<g id="node161" class="node">
<title>layer6_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1005.5,-144362.82 833.5,-144362.82 833.5,-144294.82 1005.5,-144294.82 1005.5,-144362.82"/>
<text text-anchor="middle" x="919.5" y="-144347.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="919.5" y="-144332.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="919.5" y="-144317.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="919.5" y="-144302.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer6_qkv_ar&#45;&gt;layer6_attn_0 -->
<g id="edge202" class="edge">
<title>layer6_qkv_ar&#45;&gt;layer6_attn_0</title>
<path fill="none" stroke="black" d="M950.51,-144443.22C950.51,-144443.22 950.51,-144372.87 950.51,-144372.87"/>
<polygon fill="black" stroke="black" points="954.01,-144372.87 950.51,-144362.87 947.01,-144372.87 954.01,-144372.87"/>
</g>
<!-- layer6_attn_1 -->
<g id="node162" class="node">
<title>layer6_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1213.5,-144362.82 1041.5,-144362.82 1041.5,-144294.82 1213.5,-144294.82 1213.5,-144362.82"/>
<text text-anchor="middle" x="1127.5" y="-144347.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1127.5" y="-144332.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1127.5" y="-144317.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1127.5" y="-144302.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer6_qkv_ar&#45;&gt;layer6_attn_1 -->
<g id="edge203" class="edge">
<title>layer6_qkv_ar&#45;&gt;layer6_attn_1</title>
<path fill="none" stroke="black" d="M1096.49,-144443.22C1096.49,-144443.22 1096.49,-144372.87 1096.49,-144372.87"/>
<polygon fill="black" stroke="black" points="1099.99,-144372.87 1096.49,-144362.87 1092.99,-144372.87 1099.99,-144372.87"/>
</g>
<!-- layer6_attn_out_0 -->
<g id="node163" class="node">
<title>layer6_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1005.5,-144222.82 833.5,-144222.82 833.5,-144154.82 1005.5,-144154.82 1005.5,-144222.82"/>
<text text-anchor="middle" x="919.5" y="-144207.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="919.5" y="-144192.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="919.5" y="-144177.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="919.5" y="-144162.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer6_attn_0&#45;&gt;layer6_attn_out_0 -->
<g id="edge204" class="edge">
<title>layer6_attn_0&#45;&gt;layer6_attn_out_0</title>
<path fill="none" stroke="black" d="M919.5,-144294.57C919.5,-144294.57 919.5,-144233.2 919.5,-144233.2"/>
<polygon fill="black" stroke="black" points="923,-144233.2 919.5,-144223.2 916,-144233.2 923,-144233.2"/>
</g>
<!-- layer6_attn_out_1 -->
<g id="node164" class="node">
<title>layer6_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1213.5,-144222.82 1041.5,-144222.82 1041.5,-144154.82 1213.5,-144154.82 1213.5,-144222.82"/>
<text text-anchor="middle" x="1127.5" y="-144207.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1127.5" y="-144192.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1127.5" y="-144177.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1127.5" y="-144162.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer6_attn_1&#45;&gt;layer6_attn_out_1 -->
<g id="edge205" class="edge">
<title>layer6_attn_1&#45;&gt;layer6_attn_out_1</title>
<path fill="none" stroke="black" d="M1127.5,-144294.57C1127.5,-144294.57 1127.5,-144233.2 1127.5,-144233.2"/>
<polygon fill="black" stroke="black" points="1131,-144233.2 1127.5,-144223.2 1124,-144233.2 1131,-144233.2"/>
</g>
<!-- layer6_attn_ar -->
<g id="node165" class="node">
<title>layer6_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1023.5" cy="-144034.73" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1023.5" y="-144053.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1023.5" y="-144038.53" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1023.5" y="-144023.53" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1023.5" y="-144008.53" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_attn_out_0&#45;&gt;layer6_attn_ar -->
<g id="edge206" class="edge">
<title>layer6_attn_out_0&#45;&gt;layer6_attn_ar</title>
<path fill="none" stroke="black" d="M953.69,-144154.62C953.69,-144154.62 953.69,-144084.28 953.69,-144084.28"/>
<polygon fill="black" stroke="black" points="957.19,-144084.28 953.69,-144074.28 950.19,-144084.28 957.19,-144084.28"/>
</g>
<!-- layer6_attn_out_1&#45;&gt;layer6_attn_ar -->
<g id="edge207" class="edge">
<title>layer6_attn_out_1&#45;&gt;layer6_attn_ar</title>
<path fill="none" stroke="black" d="M1093.31,-144154.62C1093.31,-144154.62 1093.31,-144084.28 1093.31,-144084.28"/>
<polygon fill="black" stroke="black" points="1096.81,-144084.28 1093.31,-144074.28 1089.81,-144084.28 1096.81,-144084.28"/>
</g>
<!-- layer6_ffn_norm_0 -->
<g id="node166" class="node">
<title>layer6_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1001.5,-143914.65 829.5,-143914.65 829.5,-143846.65 1001.5,-143846.65 1001.5,-143914.65"/>
<text text-anchor="middle" x="915.5" y="-143899.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="915.5" y="-143884.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="915.5" y="-143869.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="915.5" y="-143854.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_attn_ar&#45;&gt;layer6_ffn_norm_0 -->
<g id="edge208" class="edge">
<title>layer6_attn_ar&#45;&gt;layer6_ffn_norm_0</title>
<path fill="none" stroke="black" d="M951.69,-143995.85C951.69,-143995.85 951.69,-143924.8 951.69,-143924.8"/>
<polygon fill="black" stroke="black" points="955.19,-143924.8 951.69,-143914.8 948.19,-143924.8 955.19,-143924.8"/>
</g>
<!-- layer6_ffn_norm_1 -->
<g id="node167" class="node">
<title>layer6_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1218.5,-143914.65 1046.5,-143914.65 1046.5,-143846.65 1218.5,-143846.65 1218.5,-143914.65"/>
<text text-anchor="middle" x="1132.5" y="-143899.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1132.5" y="-143884.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1132.5" y="-143869.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1132.5" y="-143854.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_attn_ar&#45;&gt;layer6_ffn_norm_1 -->
<g id="edge209" class="edge">
<title>layer6_attn_ar&#45;&gt;layer6_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1095.81,-143995.85C1095.81,-143995.85 1095.81,-143924.8 1095.81,-143924.8"/>
<polygon fill="black" stroke="black" points="1099.31,-143924.8 1095.81,-143914.8 1092.31,-143924.8 1099.31,-143924.8"/>
</g>
<!-- layer6_ffn_gate_0 -->
<g id="node168" class="node">
<title>layer6_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1006,-143774.65 825,-143774.65 825,-143706.65 1006,-143706.65 1006,-143774.65"/>
<text text-anchor="middle" x="915.5" y="-143759.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="915.5" y="-143744.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="915.5" y="-143729.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="915.5" y="-143714.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_ffn_norm_0&#45;&gt;layer6_ffn_gate_0 -->
<g id="edge210" class="edge">
<title>layer6_ffn_norm_0&#45;&gt;layer6_ffn_gate_0</title>
<path fill="none" stroke="black" d="M915.5,-143846.4C915.5,-143846.4 915.5,-143785.03 915.5,-143785.03"/>
<polygon fill="black" stroke="black" points="919,-143785.03 915.5,-143775.03 912,-143785.03 919,-143785.03"/>
</g>
<!-- layer6_ffn_up_0 -->
<g id="node170" class="node">
<title>layer6_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="789,-143774.65 608,-143774.65 608,-143706.65 789,-143706.65 789,-143774.65"/>
<text text-anchor="middle" x="698.5" y="-143759.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="698.5" y="-143744.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="698.5" y="-143729.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="698.5" y="-143714.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_ffn_norm_0&#45;&gt;layer6_ffn_up_0 -->
<g id="edge212" class="edge">
<title>layer6_ffn_norm_0&#45;&gt;layer6_ffn_up_0</title>
<path fill="none" stroke="black" d="M829.31,-143880C789.86,-143880 751.76,-143880 751.76,-143880 751.76,-143880 751.76,-143784.74 751.76,-143784.74"/>
<polygon fill="black" stroke="black" points="755.26,-143784.74 751.76,-143774.74 748.26,-143784.74 755.26,-143784.74"/>
</g>
<!-- layer6_ffn_gate_1 -->
<g id="node169" class="node">
<title>layer6_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1440,-143774.65 1259,-143774.65 1259,-143706.65 1440,-143706.65 1440,-143774.65"/>
<text text-anchor="middle" x="1349.5" y="-143759.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1349.5" y="-143744.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1349.5" y="-143729.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1349.5" y="-143714.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_ffn_norm_1&#45;&gt;layer6_ffn_gate_1 -->
<g id="edge211" class="edge">
<title>layer6_ffn_norm_1&#45;&gt;layer6_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1218.56,-143880C1257.95,-143880 1296,-143880 1296,-143880 1296,-143880 1296,-143784.74 1296,-143784.74"/>
<polygon fill="black" stroke="black" points="1299.5,-143784.74 1296,-143774.74 1292.5,-143784.74 1299.5,-143784.74"/>
</g>
<!-- layer6_ffn_up_1 -->
<g id="node171" class="node">
<title>layer6_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1223,-143774.65 1042,-143774.65 1042,-143706.65 1223,-143706.65 1223,-143774.65"/>
<text text-anchor="middle" x="1132.5" y="-143759.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1132.5" y="-143744.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1132.5" y="-143729.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1132.5" y="-143714.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_ffn_norm_1&#45;&gt;layer6_ffn_up_1 -->
<g id="edge213" class="edge">
<title>layer6_ffn_norm_1&#45;&gt;layer6_ffn_up_1</title>
<path fill="none" stroke="black" d="M1132.5,-143846.4C1132.5,-143846.4 1132.5,-143785.03 1132.5,-143785.03"/>
<polygon fill="black" stroke="black" points="1136,-143785.03 1132.5,-143775.03 1129,-143785.03 1136,-143785.03"/>
</g>
<!-- layer6_gate_ar -->
<g id="node172" class="node">
<title>layer6_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1223.5" cy="-143586.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1223.5" y="-143605.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1223.5" y="-143590.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1223.5" y="-143575.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1223.5" y="-143560.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer6_ffn_gate_0&#45;&gt;layer6_gate_ar -->
<g id="edge214" class="edge">
<title>layer6_ffn_gate_0&#45;&gt;layer6_gate_ar</title>
<path fill="none" stroke="black" d="M1006.08,-143740C1016.79,-143740 1024,-143740 1024,-143740 1024,-143740 1024,-143602 1024,-143602 1024,-143602 1092.28,-143602 1092.28,-143602"/>
<polygon fill="black" stroke="black" points="1092.28,-143605.5 1102.28,-143602 1092.28,-143598.5 1092.28,-143605.5"/>
</g>
<!-- layer6_ffn_gate_1&#45;&gt;layer6_gate_ar -->
<g id="edge215" class="edge">
<title>layer6_ffn_gate_1&#45;&gt;layer6_gate_ar</title>
<path fill="none" stroke="black" d="M1305.24,-143706.45C1305.24,-143706.45 1305.24,-143633.63 1305.24,-143633.63"/>
<polygon fill="black" stroke="black" points="1308.74,-143633.63 1305.24,-143623.63 1301.74,-143633.63 1308.74,-143633.63"/>
</g>
<!-- layer6_up_ar -->
<g id="node173" class="node">
<title>layer6_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="877.5" cy="-143586.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="877.5" y="-143605.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="877.5" y="-143590.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="877.5" y="-143575.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="877.5" y="-143560.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer6_ffn_up_0&#45;&gt;layer6_up_ar -->
<g id="edge216" class="edge">
<title>layer6_ffn_up_0&#45;&gt;layer6_up_ar</title>
<path fill="none" stroke="black" d="M769.26,-143706.45C769.26,-143706.45 769.26,-143622.53 769.26,-143622.53"/>
<polygon fill="black" stroke="black" points="772.76,-143622.53 769.26,-143612.53 765.76,-143622.53 772.76,-143622.53"/>
</g>
<!-- layer6_ffn_up_1&#45;&gt;layer6_up_ar -->
<g id="edge217" class="edge">
<title>layer6_ffn_up_1&#45;&gt;layer6_up_ar</title>
<path fill="none" stroke="black" d="M1068.76,-143706.53C1068.76,-143656.73 1068.76,-143570 1068.76,-143570 1068.76,-143570 1007.81,-143570 1007.81,-143570"/>
<polygon fill="black" stroke="black" points="1007.81,-143566.5 997.81,-143570 1007.81,-143573.5 1007.81,-143566.5"/>
</g>
<!-- layer6_silu_0 -->
<g id="node174" class="node">
<title>layer6_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1151,-143466.48 970,-143466.48 970,-143398.48 1151,-143398.48 1151,-143466.48"/>
<text text-anchor="middle" x="1060.5" y="-143451.28" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1060.5" y="-143436.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1060.5" y="-143421.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1060.5" y="-143406.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_gate_ar&#45;&gt;layer6_silu_0 -->
<g id="edge218" class="edge">
<title>layer6_gate_ar&#45;&gt;layer6_silu_0</title>
<path fill="none" stroke="black" d="M1123.26,-143556.49C1123.26,-143556.49 1123.26,-143476.51 1123.26,-143476.51"/>
<polygon fill="black" stroke="black" points="1126.76,-143476.51 1123.26,-143466.51 1119.76,-143476.51 1126.76,-143476.51"/>
</g>
<!-- layer6_silu_1 -->
<g id="node175" class="node">
<title>layer6_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1368,-143466.48 1187,-143466.48 1187,-143398.48 1368,-143398.48 1368,-143466.48"/>
<text text-anchor="middle" x="1277.5" y="-143451.28" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1277.5" y="-143436.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1277.5" y="-143421.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1277.5" y="-143406.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_gate_ar&#45;&gt;layer6_silu_1 -->
<g id="edge219" class="edge">
<title>layer6_gate_ar&#45;&gt;layer6_silu_1</title>
<path fill="none" stroke="black" d="M1269.24,-143541.59C1269.24,-143541.59 1269.24,-143476.49 1269.24,-143476.49"/>
<polygon fill="black" stroke="black" points="1272.74,-143476.49 1269.24,-143466.49 1265.74,-143476.49 1272.74,-143476.49"/>
</g>
<!-- layer6_mul_0 -->
<g id="node176" class="node">
<title>layer6_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1041,-143326.48 860,-143326.48 860,-143258.48 1041,-143258.48 1041,-143326.48"/>
<text text-anchor="middle" x="950.5" y="-143311.28" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="950.5" y="-143296.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="950.5" y="-143281.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="950.5" y="-143266.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_up_ar&#45;&gt;layer6_mul_0 -->
<g id="edge221" class="edge">
<title>layer6_up_ar&#45;&gt;layer6_mul_0</title>
<path fill="none" stroke="black" d="M915,-143540.29C915,-143540.29 915,-143336.57 915,-143336.57"/>
<polygon fill="black" stroke="black" points="918.5,-143336.57 915,-143326.57 911.5,-143336.57 918.5,-143336.57"/>
</g>
<!-- layer6_mul_1 -->
<g id="node177" class="node">
<title>layer6_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1258,-143326.48 1077,-143326.48 1077,-143258.48 1258,-143258.48 1258,-143326.48"/>
<text text-anchor="middle" x="1167.5" y="-143311.28" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1167.5" y="-143296.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1167.5" y="-143281.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1167.5" y="-143266.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer6_up_ar&#45;&gt;layer6_mul_1 -->
<g id="edge223" class="edge">
<title>layer6_up_ar&#45;&gt;layer6_mul_1</title>
<path fill="none" stroke="black" d="M987.74,-143562.11C987.74,-143537.13 987.74,-143502 987.74,-143502 987.74,-143502 1169,-143502 1169,-143502 1169,-143502 1169,-143336.61 1169,-143336.61"/>
<polygon fill="black" stroke="black" points="1172.5,-143336.61 1169,-143326.61 1165.5,-143336.61 1172.5,-143336.61"/>
</g>
<!-- layer6_silu_0&#45;&gt;layer6_mul_0 -->
<g id="edge220" class="edge">
<title>layer6_silu_0&#45;&gt;layer6_mul_0</title>
<path fill="none" stroke="black" d="M1005.5,-143398.24C1005.5,-143398.24 1005.5,-143336.86 1005.5,-143336.86"/>
<polygon fill="black" stroke="black" points="1009,-143336.86 1005.5,-143326.86 1002,-143336.86 1009,-143336.86"/>
</g>
<!-- layer6_silu_1&#45;&gt;layer6_mul_1 -->
<g id="edge222" class="edge">
<title>layer6_silu_1&#45;&gt;layer6_mul_1</title>
<path fill="none" stroke="black" d="M1222.5,-143398.24C1222.5,-143398.24 1222.5,-143336.86 1222.5,-143336.86"/>
<polygon fill="black" stroke="black" points="1226,-143336.86 1222.5,-143326.86 1219,-143336.86 1226,-143336.86"/>
</g>
<!-- layer6_ffn_down_0 -->
<g id="node178" class="node">
<title>layer6_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1040.5,-143186.48 868.5,-143186.48 868.5,-143118.48 1040.5,-143118.48 1040.5,-143186.48"/>
<text text-anchor="middle" x="954.5" y="-143171.28" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="954.5" y="-143156.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="954.5" y="-143141.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="954.5" y="-143126.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer6_mul_0&#45;&gt;layer6_ffn_down_0 -->
<g id="edge224" class="edge">
<title>layer6_mul_0&#45;&gt;layer6_ffn_down_0</title>
<path fill="none" stroke="black" d="M954.5,-143258.24C954.5,-143258.24 954.5,-143196.86 954.5,-143196.86"/>
<polygon fill="black" stroke="black" points="958,-143196.86 954.5,-143186.86 951,-143196.86 958,-143196.86"/>
</g>
<!-- layer6_ffn_down_1 -->
<g id="node179" class="node">
<title>layer6_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1250.5,-143186.48 1078.5,-143186.48 1078.5,-143118.48 1250.5,-143118.48 1250.5,-143186.48"/>
<text text-anchor="middle" x="1164.5" y="-143171.28" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1164.5" y="-143156.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1164.5" y="-143141.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1164.5" y="-143126.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer6_mul_1&#45;&gt;layer6_ffn_down_1 -->
<g id="edge225" class="edge">
<title>layer6_mul_1&#45;&gt;layer6_ffn_down_1</title>
<path fill="none" stroke="black" d="M1164.5,-143258.24C1164.5,-143258.24 1164.5,-143196.86 1164.5,-143196.86"/>
<polygon fill="black" stroke="black" points="1168,-143196.86 1164.5,-143186.86 1161,-143196.86 1168,-143196.86"/>
</g>
<!-- layer6_ffn_ar -->
<g id="node180" class="node">
<title>layer6_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1060.5" cy="-142998.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1060.5" y="-143017.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1060.5" y="-143002.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1060.5" y="-142987.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1060.5" y="-142972.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_ffn_down_0&#45;&gt;layer6_ffn_ar -->
<g id="edge226" class="edge">
<title>layer6_ffn_down_0&#45;&gt;layer6_ffn_ar</title>
<path fill="none" stroke="black" d="M989.69,-143118.29C989.69,-143118.29 989.69,-143047.67 989.69,-143047.67"/>
<polygon fill="black" stroke="black" points="993.19,-143047.67 989.69,-143037.67 986.19,-143047.67 993.19,-143047.67"/>
</g>
<!-- layer6_ffn_down_1&#45;&gt;layer6_ffn_ar -->
<g id="edge227" class="edge">
<title>layer6_ffn_down_1&#45;&gt;layer6_ffn_ar</title>
<path fill="none" stroke="black" d="M1130.31,-143118.29C1130.31,-143118.29 1130.31,-143047.94 1130.31,-143047.94"/>
<polygon fill="black" stroke="black" points="1133.81,-143047.94 1130.31,-143037.94 1126.81,-143047.94 1133.81,-143047.94"/>
</g>
<!-- layer7_norm_0 -->
<g id="node181" class="node">
<title>layer7_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1042.5,-142878.32 870.5,-142878.32 870.5,-142810.32 1042.5,-142810.32 1042.5,-142878.32"/>
<text text-anchor="middle" x="956.5" y="-142863.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="956.5" y="-142848.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="956.5" y="-142833.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="956.5" y="-142818.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_ffn_ar&#45;&gt;layer7_norm_0 -->
<g id="edge228" class="edge">
<title>layer6_ffn_ar&#45;&gt;layer7_norm_0</title>
<path fill="none" stroke="black" d="M990.69,-142958.72C990.69,-142958.72 990.69,-142888.37 990.69,-142888.37"/>
<polygon fill="black" stroke="black" points="994.19,-142888.37 990.69,-142878.37 987.19,-142888.37 994.19,-142888.37"/>
</g>
<!-- layer7_norm_1 -->
<g id="node182" class="node">
<title>layer7_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1252.5,-142878.32 1080.5,-142878.32 1080.5,-142810.32 1252.5,-142810.32 1252.5,-142878.32"/>
<text text-anchor="middle" x="1166.5" y="-142863.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1166.5" y="-142848.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1166.5" y="-142833.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1166.5" y="-142818.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_ffn_ar&#45;&gt;layer7_norm_1 -->
<g id="edge229" class="edge">
<title>layer6_ffn_ar&#45;&gt;layer7_norm_1</title>
<path fill="none" stroke="black" d="M1131.31,-142959.12C1131.31,-142959.12 1131.31,-142888.55 1131.31,-142888.55"/>
<polygon fill="black" stroke="black" points="1134.81,-142888.55 1131.31,-142878.55 1127.81,-142888.55 1134.81,-142888.55"/>
</g>
<!-- layer7_qkv_0 -->
<g id="node183" class="node">
<title>layer7_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1043,-142738.32 862,-142738.32 862,-142670.32 1043,-142670.32 1043,-142738.32"/>
<text text-anchor="middle" x="952.5" y="-142723.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="952.5" y="-142708.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="952.5" y="-142693.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="952.5" y="-142678.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer7_norm_0&#45;&gt;layer7_qkv_0 -->
<g id="edge230" class="edge">
<title>layer7_norm_0&#45;&gt;layer7_qkv_0</title>
<path fill="none" stroke="black" d="M956.5,-142810.07C956.5,-142810.07 956.5,-142748.7 956.5,-142748.7"/>
<polygon fill="black" stroke="black" points="960,-142748.7 956.5,-142738.7 953,-142748.7 960,-142748.7"/>
</g>
<!-- layer7_qkv_1 -->
<g id="node184" class="node">
<title>layer7_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1260,-142738.32 1079,-142738.32 1079,-142670.32 1260,-142670.32 1260,-142738.32"/>
<text text-anchor="middle" x="1169.5" y="-142723.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1169.5" y="-142708.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1169.5" y="-142693.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1169.5" y="-142678.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer7_norm_1&#45;&gt;layer7_qkv_1 -->
<g id="edge231" class="edge">
<title>layer7_norm_1&#45;&gt;layer7_qkv_1</title>
<path fill="none" stroke="black" d="M1166.5,-142810.07C1166.5,-142810.07 1166.5,-142748.7 1166.5,-142748.7"/>
<polygon fill="black" stroke="black" points="1170,-142748.7 1166.5,-142738.7 1163,-142748.7 1170,-142748.7"/>
</g>
<!-- layer7_qkv_ar -->
<g id="node185" class="node">
<title>layer7_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1060.5" cy="-142550.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1060.5" y="-142569.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1060.5" y="-142554.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1060.5" y="-142539.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1060.5" y="-142524.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer7_qkv_0&#45;&gt;layer7_qkv_ar -->
<g id="edge232" class="edge">
<title>layer7_qkv_0&#45;&gt;layer7_qkv_ar</title>
<path fill="none" stroke="black" d="M987.76,-142670.12C987.76,-142670.12 987.76,-142600.05 987.76,-142600.05"/>
<polygon fill="black" stroke="black" points="991.26,-142600.05 987.76,-142590.05 984.26,-142600.05 991.26,-142600.05"/>
</g>
<!-- layer7_qkv_1&#45;&gt;layer7_qkv_ar -->
<g id="edge233" class="edge">
<title>layer7_qkv_1&#45;&gt;layer7_qkv_ar</title>
<path fill="none" stroke="black" d="M1133.74,-142670.12C1133.74,-142670.12 1133.74,-142599.78 1133.74,-142599.78"/>
<polygon fill="black" stroke="black" points="1137.24,-142599.78 1133.74,-142589.78 1130.24,-142599.78 1137.24,-142599.78"/>
</g>
<!-- layer7_attn_0 -->
<g id="node186" class="node">
<title>layer7_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1042.5,-142430.15 870.5,-142430.15 870.5,-142362.15 1042.5,-142362.15 1042.5,-142430.15"/>
<text text-anchor="middle" x="956.5" y="-142414.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="956.5" y="-142399.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="956.5" y="-142384.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="956.5" y="-142369.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer7_qkv_ar&#45;&gt;layer7_attn_0 -->
<g id="edge234" class="edge">
<title>layer7_qkv_ar&#45;&gt;layer7_attn_0</title>
<path fill="none" stroke="black" d="M987.51,-142510.55C987.51,-142510.55 987.51,-142440.21 987.51,-142440.21"/>
<polygon fill="black" stroke="black" points="991.01,-142440.21 987.51,-142430.21 984.01,-142440.21 991.01,-142440.21"/>
</g>
<!-- layer7_attn_1 -->
<g id="node187" class="node">
<title>layer7_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1250.5,-142430.15 1078.5,-142430.15 1078.5,-142362.15 1250.5,-142362.15 1250.5,-142430.15"/>
<text text-anchor="middle" x="1164.5" y="-142414.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1164.5" y="-142399.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1164.5" y="-142384.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1164.5" y="-142369.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer7_qkv_ar&#45;&gt;layer7_attn_1 -->
<g id="edge235" class="edge">
<title>layer7_qkv_ar&#45;&gt;layer7_attn_1</title>
<path fill="none" stroke="black" d="M1133.49,-142510.55C1133.49,-142510.55 1133.49,-142440.21 1133.49,-142440.21"/>
<polygon fill="black" stroke="black" points="1136.99,-142440.21 1133.49,-142430.21 1129.99,-142440.21 1136.99,-142440.21"/>
</g>
<!-- layer7_attn_out_0 -->
<g id="node188" class="node">
<title>layer7_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1042.5,-142290.15 870.5,-142290.15 870.5,-142222.15 1042.5,-142222.15 1042.5,-142290.15"/>
<text text-anchor="middle" x="956.5" y="-142274.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="956.5" y="-142259.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="956.5" y="-142244.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="956.5" y="-142229.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer7_attn_0&#45;&gt;layer7_attn_out_0 -->
<g id="edge236" class="edge">
<title>layer7_attn_0&#45;&gt;layer7_attn_out_0</title>
<path fill="none" stroke="black" d="M956.5,-142361.9C956.5,-142361.9 956.5,-142300.53 956.5,-142300.53"/>
<polygon fill="black" stroke="black" points="960,-142300.53 956.5,-142290.53 953,-142300.53 960,-142300.53"/>
</g>
<!-- layer7_attn_out_1 -->
<g id="node189" class="node">
<title>layer7_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1250.5,-142290.15 1078.5,-142290.15 1078.5,-142222.15 1250.5,-142222.15 1250.5,-142290.15"/>
<text text-anchor="middle" x="1164.5" y="-142274.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1164.5" y="-142259.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1164.5" y="-142244.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1164.5" y="-142229.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer7_attn_1&#45;&gt;layer7_attn_out_1 -->
<g id="edge237" class="edge">
<title>layer7_attn_1&#45;&gt;layer7_attn_out_1</title>
<path fill="none" stroke="black" d="M1164.5,-142361.9C1164.5,-142361.9 1164.5,-142300.53 1164.5,-142300.53"/>
<polygon fill="black" stroke="black" points="1168,-142300.53 1164.5,-142290.53 1161,-142300.53 1168,-142300.53"/>
</g>
<!-- layer7_attn_ar -->
<g id="node190" class="node">
<title>layer7_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1060.5" cy="-142102.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1060.5" y="-142120.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1060.5" y="-142105.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1060.5" y="-142090.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1060.5" y="-142075.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_attn_out_0&#45;&gt;layer7_attn_ar -->
<g id="edge238" class="edge">
<title>layer7_attn_out_0&#45;&gt;layer7_attn_ar</title>
<path fill="none" stroke="black" d="M990.69,-142221.95C990.69,-142221.95 990.69,-142151.61 990.69,-142151.61"/>
<polygon fill="black" stroke="black" points="994.19,-142151.61 990.69,-142141.61 987.19,-142151.61 994.19,-142151.61"/>
</g>
<!-- layer7_attn_out_1&#45;&gt;layer7_attn_ar -->
<g id="edge239" class="edge">
<title>layer7_attn_out_1&#45;&gt;layer7_attn_ar</title>
<path fill="none" stroke="black" d="M1130.31,-142221.95C1130.31,-142221.95 1130.31,-142151.61 1130.31,-142151.61"/>
<polygon fill="black" stroke="black" points="1133.81,-142151.61 1130.31,-142141.61 1126.81,-142151.61 1133.81,-142151.61"/>
</g>
<!-- layer7_ffn_norm_0 -->
<g id="node191" class="node">
<title>layer7_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1038.5,-141981.98 866.5,-141981.98 866.5,-141913.98 1038.5,-141913.98 1038.5,-141981.98"/>
<text text-anchor="middle" x="952.5" y="-141966.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="952.5" y="-141951.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="952.5" y="-141936.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="952.5" y="-141921.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_attn_ar&#45;&gt;layer7_ffn_norm_0 -->
<g id="edge240" class="edge">
<title>layer7_attn_ar&#45;&gt;layer7_ffn_norm_0</title>
<path fill="none" stroke="black" d="M988.69,-142063.19C988.69,-142063.19 988.69,-141992.13 988.69,-141992.13"/>
<polygon fill="black" stroke="black" points="992.19,-141992.13 988.69,-141982.13 985.19,-141992.13 992.19,-141992.13"/>
</g>
<!-- layer7_ffn_norm_1 -->
<g id="node192" class="node">
<title>layer7_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1255.5,-141981.98 1083.5,-141981.98 1083.5,-141913.98 1255.5,-141913.98 1255.5,-141981.98"/>
<text text-anchor="middle" x="1169.5" y="-141966.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1169.5" y="-141951.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1169.5" y="-141936.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1169.5" y="-141921.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_attn_ar&#45;&gt;layer7_ffn_norm_1 -->
<g id="edge241" class="edge">
<title>layer7_attn_ar&#45;&gt;layer7_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1132.81,-142063.19C1132.81,-142063.19 1132.81,-141992.13 1132.81,-141992.13"/>
<polygon fill="black" stroke="black" points="1136.31,-141992.13 1132.81,-141982.13 1129.31,-141992.13 1136.31,-141992.13"/>
</g>
<!-- layer7_ffn_gate_0 -->
<g id="node193" class="node">
<title>layer7_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1043,-141841.98 862,-141841.98 862,-141773.98 1043,-141773.98 1043,-141841.98"/>
<text text-anchor="middle" x="952.5" y="-141826.78" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="952.5" y="-141811.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="952.5" y="-141796.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="952.5" y="-141781.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_ffn_norm_0&#45;&gt;layer7_ffn_gate_0 -->
<g id="edge242" class="edge">
<title>layer7_ffn_norm_0&#45;&gt;layer7_ffn_gate_0</title>
<path fill="none" stroke="black" d="M952.5,-141913.74C952.5,-141913.74 952.5,-141852.36 952.5,-141852.36"/>
<polygon fill="black" stroke="black" points="956,-141852.36 952.5,-141842.36 949,-141852.36 956,-141852.36"/>
</g>
<!-- layer7_ffn_up_0 -->
<g id="node195" class="node">
<title>layer7_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="826,-141841.98 645,-141841.98 645,-141773.98 826,-141773.98 826,-141841.98"/>
<text text-anchor="middle" x="735.5" y="-141826.78" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="735.5" y="-141811.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="735.5" y="-141796.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="735.5" y="-141781.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_ffn_norm_0&#45;&gt;layer7_ffn_up_0 -->
<g id="edge244" class="edge">
<title>layer7_ffn_norm_0&#45;&gt;layer7_ffn_up_0</title>
<path fill="none" stroke="black" d="M866.27,-141947C826.41,-141947 787.76,-141947 787.76,-141947 787.76,-141947 787.76,-141851.99 787.76,-141851.99"/>
<polygon fill="black" stroke="black" points="791.26,-141851.99 787.76,-141841.99 784.26,-141851.99 791.26,-141851.99"/>
</g>
<!-- layer7_ffn_gate_1 -->
<g id="node194" class="node">
<title>layer7_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1477,-141841.98 1296,-141841.98 1296,-141773.98 1477,-141773.98 1477,-141841.98"/>
<text text-anchor="middle" x="1386.5" y="-141826.78" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1386.5" y="-141811.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1386.5" y="-141796.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1386.5" y="-141781.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_ffn_norm_1&#45;&gt;layer7_ffn_gate_1 -->
<g id="edge243" class="edge">
<title>layer7_ffn_norm_1&#45;&gt;layer7_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1255.51,-141947C1294.49,-141947 1332,-141947 1332,-141947 1332,-141947 1332,-141851.99 1332,-141851.99"/>
<polygon fill="black" stroke="black" points="1335.5,-141851.99 1332,-141841.99 1328.5,-141851.99 1335.5,-141851.99"/>
</g>
<!-- layer7_ffn_up_1 -->
<g id="node196" class="node">
<title>layer7_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1260,-141841.98 1079,-141841.98 1079,-141773.98 1260,-141773.98 1260,-141841.98"/>
<text text-anchor="middle" x="1169.5" y="-141826.78" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1169.5" y="-141811.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1169.5" y="-141796.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1169.5" y="-141781.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_ffn_norm_1&#45;&gt;layer7_ffn_up_1 -->
<g id="edge245" class="edge">
<title>layer7_ffn_norm_1&#45;&gt;layer7_ffn_up_1</title>
<path fill="none" stroke="black" d="M1169.5,-141913.74C1169.5,-141913.74 1169.5,-141852.36 1169.5,-141852.36"/>
<polygon fill="black" stroke="black" points="1173,-141852.36 1169.5,-141842.36 1166,-141852.36 1173,-141852.36"/>
</g>
<!-- layer7_gate_ar -->
<g id="node197" class="node">
<title>layer7_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1260.5" cy="-141653.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1260.5" y="-141672.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1260.5" y="-141657.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1260.5" y="-141642.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1260.5" y="-141627.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer7_ffn_gate_0&#45;&gt;layer7_gate_ar -->
<g id="edge246" class="edge">
<title>layer7_ffn_gate_0&#45;&gt;layer7_gate_ar</title>
<path fill="none" stroke="black" d="M1043.08,-141807C1053.79,-141807 1061,-141807 1061,-141807 1061,-141807 1061,-141669 1061,-141669 1061,-141669 1128.7,-141669 1128.7,-141669"/>
<polygon fill="black" stroke="black" points="1128.7,-141672.5 1138.7,-141669 1128.7,-141665.5 1128.7,-141672.5"/>
</g>
<!-- layer7_ffn_gate_1&#45;&gt;layer7_gate_ar -->
<g id="edge247" class="edge">
<title>layer7_ffn_gate_1&#45;&gt;layer7_gate_ar</title>
<path fill="none" stroke="black" d="M1342.24,-141773.79C1342.24,-141773.79 1342.24,-141700.96 1342.24,-141700.96"/>
<polygon fill="black" stroke="black" points="1345.74,-141700.96 1342.24,-141690.96 1338.74,-141700.96 1345.74,-141700.96"/>
</g>
<!-- layer7_up_ar -->
<g id="node198" class="node">
<title>layer7_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="914.5" cy="-141653.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="914.5" y="-141672.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="914.5" y="-141657.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="914.5" y="-141642.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="914.5" y="-141627.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer7_ffn_up_0&#45;&gt;layer7_up_ar -->
<g id="edge248" class="edge">
<title>layer7_ffn_up_0&#45;&gt;layer7_up_ar</title>
<path fill="none" stroke="black" d="M806.26,-141773.79C806.26,-141773.79 806.26,-141689.86 806.26,-141689.86"/>
<polygon fill="black" stroke="black" points="809.76,-141689.86 806.26,-141679.86 802.76,-141689.86 809.76,-141689.86"/>
</g>
<!-- layer7_ffn_up_1&#45;&gt;layer7_up_ar -->
<g id="edge249" class="edge">
<title>layer7_ffn_up_1&#45;&gt;layer7_up_ar</title>
<path fill="none" stroke="black" d="M1105.76,-141773.79C1105.76,-141723.9 1105.76,-141637 1105.76,-141637 1105.76,-141637 1044.54,-141637 1044.54,-141637"/>
<polygon fill="black" stroke="black" points="1044.54,-141633.5 1034.54,-141637 1044.54,-141640.5 1044.54,-141633.5"/>
</g>
<!-- layer7_silu_0 -->
<g id="node199" class="node">
<title>layer7_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1188,-141533.82 1007,-141533.82 1007,-141465.82 1188,-141465.82 1188,-141533.82"/>
<text text-anchor="middle" x="1097.5" y="-141518.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1097.5" y="-141503.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1097.5" y="-141488.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1097.5" y="-141473.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_gate_ar&#45;&gt;layer7_silu_0 -->
<g id="edge250" class="edge">
<title>layer7_gate_ar&#45;&gt;layer7_silu_0</title>
<path fill="none" stroke="black" d="M1160.26,-141623.83C1160.26,-141623.83 1160.26,-141543.84 1160.26,-141543.84"/>
<polygon fill="black" stroke="black" points="1163.76,-141543.84 1160.26,-141533.84 1156.76,-141543.84 1163.76,-141543.84"/>
</g>
<!-- layer7_silu_1 -->
<g id="node200" class="node">
<title>layer7_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1405,-141533.82 1224,-141533.82 1224,-141465.82 1405,-141465.82 1405,-141533.82"/>
<text text-anchor="middle" x="1314.5" y="-141518.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1314.5" y="-141503.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1314.5" y="-141488.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1314.5" y="-141473.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_gate_ar&#45;&gt;layer7_silu_1 -->
<g id="edge251" class="edge">
<title>layer7_gate_ar&#45;&gt;layer7_silu_1</title>
<path fill="none" stroke="black" d="M1306.24,-141608.92C1306.24,-141608.92 1306.24,-141543.82 1306.24,-141543.82"/>
<polygon fill="black" stroke="black" points="1309.74,-141543.82 1306.24,-141533.82 1302.74,-141543.82 1309.74,-141543.82"/>
</g>
<!-- layer7_mul_0 -->
<g id="node201" class="node">
<title>layer7_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1078,-141393.82 897,-141393.82 897,-141325.82 1078,-141325.82 1078,-141393.82"/>
<text text-anchor="middle" x="987.5" y="-141378.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="987.5" y="-141363.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="987.5" y="-141348.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="987.5" y="-141333.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_up_ar&#45;&gt;layer7_mul_0 -->
<g id="edge253" class="edge">
<title>layer7_up_ar&#45;&gt;layer7_mul_0</title>
<path fill="none" stroke="black" d="M952,-141607.63C952,-141607.63 952,-141403.9 952,-141403.9"/>
<polygon fill="black" stroke="black" points="955.5,-141403.9 952,-141393.9 948.5,-141403.9 955.5,-141403.9"/>
</g>
<!-- layer7_mul_1 -->
<g id="node202" class="node">
<title>layer7_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1295,-141393.82 1114,-141393.82 1114,-141325.82 1295,-141325.82 1295,-141393.82"/>
<text text-anchor="middle" x="1204.5" y="-141378.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1204.5" y="-141363.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1204.5" y="-141348.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1204.5" y="-141333.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer7_up_ar&#45;&gt;layer7_mul_1 -->
<g id="edge255" class="edge">
<title>layer7_up_ar&#45;&gt;layer7_mul_1</title>
<path fill="none" stroke="black" d="M1024.74,-141629.34C1024.74,-141604.27 1024.74,-141569 1024.74,-141569 1024.74,-141569 1206,-141569 1206,-141569 1206,-141569 1206,-141403.89 1206,-141403.89"/>
<polygon fill="black" stroke="black" points="1209.5,-141403.89 1206,-141393.89 1202.5,-141403.89 1209.5,-141403.89"/>
</g>
<!-- layer7_silu_0&#45;&gt;layer7_mul_0 -->
<g id="edge252" class="edge">
<title>layer7_silu_0&#45;&gt;layer7_mul_0</title>
<path fill="none" stroke="black" d="M1042.5,-141465.57C1042.5,-141465.57 1042.5,-141404.2 1042.5,-141404.2"/>
<polygon fill="black" stroke="black" points="1046,-141404.2 1042.5,-141394.2 1039,-141404.2 1046,-141404.2"/>
</g>
<!-- layer7_silu_1&#45;&gt;layer7_mul_1 -->
<g id="edge254" class="edge">
<title>layer7_silu_1&#45;&gt;layer7_mul_1</title>
<path fill="none" stroke="black" d="M1259.5,-141465.57C1259.5,-141465.57 1259.5,-141404.2 1259.5,-141404.2"/>
<polygon fill="black" stroke="black" points="1263,-141404.2 1259.5,-141394.2 1256,-141404.2 1263,-141404.2"/>
</g>
<!-- layer7_ffn_down_0 -->
<g id="node203" class="node">
<title>layer7_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1077.5,-141253.82 905.5,-141253.82 905.5,-141185.82 1077.5,-141185.82 1077.5,-141253.82"/>
<text text-anchor="middle" x="991.5" y="-141238.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="991.5" y="-141223.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="991.5" y="-141208.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="991.5" y="-141193.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer7_mul_0&#45;&gt;layer7_ffn_down_0 -->
<g id="edge256" class="edge">
<title>layer7_mul_0&#45;&gt;layer7_ffn_down_0</title>
<path fill="none" stroke="black" d="M991.5,-141325.57C991.5,-141325.57 991.5,-141264.2 991.5,-141264.2"/>
<polygon fill="black" stroke="black" points="995,-141264.2 991.5,-141254.2 988,-141264.2 995,-141264.2"/>
</g>
<!-- layer7_ffn_down_1 -->
<g id="node204" class="node">
<title>layer7_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1287.5,-141253.82 1115.5,-141253.82 1115.5,-141185.82 1287.5,-141185.82 1287.5,-141253.82"/>
<text text-anchor="middle" x="1201.5" y="-141238.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1201.5" y="-141223.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1201.5" y="-141208.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1201.5" y="-141193.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer7_mul_1&#45;&gt;layer7_ffn_down_1 -->
<g id="edge257" class="edge">
<title>layer7_mul_1&#45;&gt;layer7_ffn_down_1</title>
<path fill="none" stroke="black" d="M1201.5,-141325.57C1201.5,-141325.57 1201.5,-141264.2 1201.5,-141264.2"/>
<polygon fill="black" stroke="black" points="1205,-141264.2 1201.5,-141254.2 1198,-141264.2 1205,-141264.2"/>
</g>
<!-- layer7_ffn_ar -->
<g id="node205" class="node">
<title>layer7_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1095.5" cy="-141065.73" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1095.5" y="-141084.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1095.5" y="-141069.53" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1095.5" y="-141054.53" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1095.5" y="-141039.53" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_ffn_down_0&#45;&gt;layer7_ffn_ar -->
<g id="edge258" class="edge">
<title>layer7_ffn_down_0&#45;&gt;layer7_ffn_ar</title>
<path fill="none" stroke="black" d="M1025.69,-141185.62C1025.69,-141185.62 1025.69,-141115.28 1025.69,-141115.28"/>
<polygon fill="black" stroke="black" points="1029.19,-141115.28 1025.69,-141105.28 1022.19,-141115.28 1029.19,-141115.28"/>
</g>
<!-- layer7_ffn_down_1&#45;&gt;layer7_ffn_ar -->
<g id="edge259" class="edge">
<title>layer7_ffn_down_1&#45;&gt;layer7_ffn_ar</title>
<path fill="none" stroke="black" d="M1166.31,-141185.62C1166.31,-141185.62 1166.31,-141115 1166.31,-141115"/>
<polygon fill="black" stroke="black" points="1169.81,-141115 1166.31,-141105 1162.81,-141115 1169.81,-141115"/>
</g>
<!-- layer8_norm_0 -->
<g id="node206" class="node">
<title>layer8_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1077.5,-140945.65 905.5,-140945.65 905.5,-140877.65 1077.5,-140877.65 1077.5,-140945.65"/>
<text text-anchor="middle" x="991.5" y="-140930.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="991.5" y="-140915.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="991.5" y="-140900.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="991.5" y="-140885.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_ffn_ar&#45;&gt;layer8_norm_0 -->
<g id="edge260" class="edge">
<title>layer7_ffn_ar&#45;&gt;layer8_norm_0</title>
<path fill="none" stroke="black" d="M1025.69,-141026.05C1025.69,-141026.05 1025.69,-140955.71 1025.69,-140955.71"/>
<polygon fill="black" stroke="black" points="1029.19,-140955.71 1025.69,-140945.71 1022.19,-140955.71 1029.19,-140955.71"/>
</g>
<!-- layer8_norm_1 -->
<g id="node207" class="node">
<title>layer8_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1287.5,-140945.65 1115.5,-140945.65 1115.5,-140877.65 1287.5,-140877.65 1287.5,-140945.65"/>
<text text-anchor="middle" x="1201.5" y="-140930.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1201.5" y="-140915.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1201.5" y="-140900.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1201.5" y="-140885.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_ffn_ar&#45;&gt;layer8_norm_1 -->
<g id="edge261" class="edge">
<title>layer7_ffn_ar&#45;&gt;layer8_norm_1</title>
<path fill="none" stroke="black" d="M1166.31,-141026.45C1166.31,-141026.45 1166.31,-140955.88 1166.31,-140955.88"/>
<polygon fill="black" stroke="black" points="1169.81,-140955.88 1166.31,-140945.88 1162.81,-140955.88 1169.81,-140955.88"/>
</g>
<!-- layer8_qkv_0 -->
<g id="node208" class="node">
<title>layer8_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1078,-140805.65 897,-140805.65 897,-140737.65 1078,-140737.65 1078,-140805.65"/>
<text text-anchor="middle" x="987.5" y="-140790.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="987.5" y="-140775.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="987.5" y="-140760.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="987.5" y="-140745.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer8_norm_0&#45;&gt;layer8_qkv_0 -->
<g id="edge262" class="edge">
<title>layer8_norm_0&#45;&gt;layer8_qkv_0</title>
<path fill="none" stroke="black" d="M991.5,-140877.4C991.5,-140877.4 991.5,-140816.03 991.5,-140816.03"/>
<polygon fill="black" stroke="black" points="995,-140816.03 991.5,-140806.03 988,-140816.03 995,-140816.03"/>
</g>
<!-- layer8_qkv_1 -->
<g id="node209" class="node">
<title>layer8_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1295,-140805.65 1114,-140805.65 1114,-140737.65 1295,-140737.65 1295,-140805.65"/>
<text text-anchor="middle" x="1204.5" y="-140790.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1204.5" y="-140775.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1204.5" y="-140760.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1204.5" y="-140745.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer8_norm_1&#45;&gt;layer8_qkv_1 -->
<g id="edge263" class="edge">
<title>layer8_norm_1&#45;&gt;layer8_qkv_1</title>
<path fill="none" stroke="black" d="M1201.5,-140877.4C1201.5,-140877.4 1201.5,-140816.03 1201.5,-140816.03"/>
<polygon fill="black" stroke="black" points="1205,-140816.03 1201.5,-140806.03 1198,-140816.03 1205,-140816.03"/>
</g>
<!-- layer8_qkv_ar -->
<g id="node210" class="node">
<title>layer8_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1095.5" cy="-140617.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1095.5" y="-140636.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1095.5" y="-140621.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1095.5" y="-140606.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1095.5" y="-140591.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer8_qkv_0&#45;&gt;layer8_qkv_ar -->
<g id="edge264" class="edge">
<title>layer8_qkv_0&#45;&gt;layer8_qkv_ar</title>
<path fill="none" stroke="black" d="M1022.76,-140737.45C1022.76,-140737.45 1022.76,-140667.39 1022.76,-140667.39"/>
<polygon fill="black" stroke="black" points="1026.26,-140667.39 1022.76,-140657.39 1019.26,-140667.39 1026.26,-140667.39"/>
</g>
<!-- layer8_qkv_1&#45;&gt;layer8_qkv_ar -->
<g id="edge265" class="edge">
<title>layer8_qkv_1&#45;&gt;layer8_qkv_ar</title>
<path fill="none" stroke="black" d="M1168.74,-140737.45C1168.74,-140737.45 1168.74,-140667.11 1168.74,-140667.11"/>
<polygon fill="black" stroke="black" points="1172.24,-140667.11 1168.74,-140657.11 1165.24,-140667.11 1172.24,-140667.11"/>
</g>
<!-- layer8_attn_0 -->
<g id="node211" class="node">
<title>layer8_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1077.5,-140497.48 905.5,-140497.48 905.5,-140429.48 1077.5,-140429.48 1077.5,-140497.48"/>
<text text-anchor="middle" x="991.5" y="-140482.28" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="991.5" y="-140467.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="991.5" y="-140452.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="991.5" y="-140437.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer8_qkv_ar&#45;&gt;layer8_attn_0 -->
<g id="edge266" class="edge">
<title>layer8_qkv_ar&#45;&gt;layer8_attn_0</title>
<path fill="none" stroke="black" d="M1022.51,-140577.89C1022.51,-140577.89 1022.51,-140507.54 1022.51,-140507.54"/>
<polygon fill="black" stroke="black" points="1026.01,-140507.54 1022.51,-140497.54 1019.01,-140507.54 1026.01,-140507.54"/>
</g>
<!-- layer8_attn_1 -->
<g id="node212" class="node">
<title>layer8_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1285.5,-140497.48 1113.5,-140497.48 1113.5,-140429.48 1285.5,-140429.48 1285.5,-140497.48"/>
<text text-anchor="middle" x="1199.5" y="-140482.28" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1199.5" y="-140467.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1199.5" y="-140452.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1199.5" y="-140437.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer8_qkv_ar&#45;&gt;layer8_attn_1 -->
<g id="edge267" class="edge">
<title>layer8_qkv_ar&#45;&gt;layer8_attn_1</title>
<path fill="none" stroke="black" d="M1168.49,-140577.89C1168.49,-140577.89 1168.49,-140507.54 1168.49,-140507.54"/>
<polygon fill="black" stroke="black" points="1171.99,-140507.54 1168.49,-140497.54 1164.99,-140507.54 1171.99,-140507.54"/>
</g>
<!-- layer8_attn_out_0 -->
<g id="node213" class="node">
<title>layer8_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1077.5,-140357.48 905.5,-140357.48 905.5,-140289.48 1077.5,-140289.48 1077.5,-140357.48"/>
<text text-anchor="middle" x="991.5" y="-140342.28" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="991.5" y="-140327.28" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="991.5" y="-140312.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="991.5" y="-140297.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer8_attn_0&#45;&gt;layer8_attn_out_0 -->
<g id="edge268" class="edge">
<title>layer8_attn_0&#45;&gt;layer8_attn_out_0</title>
<path fill="none" stroke="black" d="M991.5,-140429.24C991.5,-140429.24 991.5,-140367.86 991.5,-140367.86"/>
<polygon fill="black" stroke="black" points="995,-140367.86 991.5,-140357.86 988,-140367.86 995,-140367.86"/>
</g>
<!-- layer8_attn_out_1 -->
<g id="node214" class="node">
<title>layer8_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1285.5,-140357.48 1113.5,-140357.48 1113.5,-140289.48 1285.5,-140289.48 1285.5,-140357.48"/>
<text text-anchor="middle" x="1199.5" y="-140342.28" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1199.5" y="-140327.28" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1199.5" y="-140312.28" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1199.5" y="-140297.28" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer8_attn_1&#45;&gt;layer8_attn_out_1 -->
<g id="edge269" class="edge">
<title>layer8_attn_1&#45;&gt;layer8_attn_out_1</title>
<path fill="none" stroke="black" d="M1199.5,-140429.24C1199.5,-140429.24 1199.5,-140367.86 1199.5,-140367.86"/>
<polygon fill="black" stroke="black" points="1203,-140367.86 1199.5,-140357.86 1196,-140367.86 1203,-140367.86"/>
</g>
<!-- layer8_attn_ar -->
<g id="node215" class="node">
<title>layer8_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1095.5" cy="-140169.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1095.5" y="-140188.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1095.5" y="-140173.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1095.5" y="-140158.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1095.5" y="-140143.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_attn_out_0&#45;&gt;layer8_attn_ar -->
<g id="edge270" class="edge">
<title>layer8_attn_out_0&#45;&gt;layer8_attn_ar</title>
<path fill="none" stroke="black" d="M1025.69,-140289.29C1025.69,-140289.29 1025.69,-140218.94 1025.69,-140218.94"/>
<polygon fill="black" stroke="black" points="1029.19,-140218.94 1025.69,-140208.94 1022.19,-140218.94 1029.19,-140218.94"/>
</g>
<!-- layer8_attn_out_1&#45;&gt;layer8_attn_ar -->
<g id="edge271" class="edge">
<title>layer8_attn_out_1&#45;&gt;layer8_attn_ar</title>
<path fill="none" stroke="black" d="M1165.31,-140289.29C1165.31,-140289.29 1165.31,-140218.94 1165.31,-140218.94"/>
<polygon fill="black" stroke="black" points="1168.81,-140218.94 1165.31,-140208.94 1161.81,-140218.94 1168.81,-140218.94"/>
</g>
<!-- layer8_ffn_norm_0 -->
<g id="node216" class="node">
<title>layer8_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1073.5,-140049.32 901.5,-140049.32 901.5,-139981.32 1073.5,-139981.32 1073.5,-140049.32"/>
<text text-anchor="middle" x="987.5" y="-140034.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="987.5" y="-140019.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="987.5" y="-140004.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="987.5" y="-139989.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_attn_ar&#45;&gt;layer8_ffn_norm_0 -->
<g id="edge272" class="edge">
<title>layer8_attn_ar&#45;&gt;layer8_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1023.69,-140130.52C1023.69,-140130.52 1023.69,-140059.47 1023.69,-140059.47"/>
<polygon fill="black" stroke="black" points="1027.19,-140059.47 1023.69,-140049.47 1020.19,-140059.47 1027.19,-140059.47"/>
</g>
<!-- layer8_ffn_norm_1 -->
<g id="node217" class="node">
<title>layer8_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1290.5,-140049.32 1118.5,-140049.32 1118.5,-139981.32 1290.5,-139981.32 1290.5,-140049.32"/>
<text text-anchor="middle" x="1204.5" y="-140034.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1204.5" y="-140019.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1204.5" y="-140004.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1204.5" y="-139989.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_attn_ar&#45;&gt;layer8_ffn_norm_1 -->
<g id="edge273" class="edge">
<title>layer8_attn_ar&#45;&gt;layer8_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1167.81,-140130.52C1167.81,-140130.52 1167.81,-140059.47 1167.81,-140059.47"/>
<polygon fill="black" stroke="black" points="1171.31,-140059.47 1167.81,-140049.47 1164.31,-140059.47 1171.31,-140059.47"/>
</g>
<!-- layer8_ffn_gate_0 -->
<g id="node218" class="node">
<title>layer8_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1078,-139909.32 897,-139909.32 897,-139841.32 1078,-139841.32 1078,-139909.32"/>
<text text-anchor="middle" x="987.5" y="-139894.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="987.5" y="-139879.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="987.5" y="-139864.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="987.5" y="-139849.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_ffn_norm_0&#45;&gt;layer8_ffn_gate_0 -->
<g id="edge274" class="edge">
<title>layer8_ffn_norm_0&#45;&gt;layer8_ffn_gate_0</title>
<path fill="none" stroke="black" d="M987.5,-139981.07C987.5,-139981.07 987.5,-139919.7 987.5,-139919.7"/>
<polygon fill="black" stroke="black" points="991,-139919.7 987.5,-139909.7 984,-139919.7 991,-139919.7"/>
</g>
<!-- layer8_ffn_up_0 -->
<g id="node220" class="node">
<title>layer8_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="861,-139909.32 680,-139909.32 680,-139841.32 861,-139841.32 861,-139909.32"/>
<text text-anchor="middle" x="770.5" y="-139894.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="770.5" y="-139879.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="770.5" y="-139864.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="770.5" y="-139849.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_ffn_norm_0&#45;&gt;layer8_ffn_up_0 -->
<g id="edge276" class="edge">
<title>layer8_ffn_norm_0&#45;&gt;layer8_ffn_up_0</title>
<path fill="none" stroke="black" d="M901.31,-140015C861.86,-140015 823.76,-140015 823.76,-140015 823.76,-140015 823.76,-139919.49 823.76,-139919.49"/>
<polygon fill="black" stroke="black" points="827.26,-139919.49 823.76,-139909.49 820.26,-139919.49 827.26,-139919.49"/>
</g>
<!-- layer8_ffn_gate_1 -->
<g id="node219" class="node">
<title>layer8_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1512,-139909.32 1331,-139909.32 1331,-139841.32 1512,-139841.32 1512,-139909.32"/>
<text text-anchor="middle" x="1421.5" y="-139894.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1421.5" y="-139879.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1421.5" y="-139864.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1421.5" y="-139849.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_ffn_norm_1&#45;&gt;layer8_ffn_gate_1 -->
<g id="edge275" class="edge">
<title>layer8_ffn_norm_1&#45;&gt;layer8_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1290.56,-140015C1329.95,-140015 1368,-140015 1368,-140015 1368,-140015 1368,-139919.49 1368,-139919.49"/>
<polygon fill="black" stroke="black" points="1371.5,-139919.49 1368,-139909.49 1364.5,-139919.49 1371.5,-139919.49"/>
</g>
<!-- layer8_ffn_up_1 -->
<g id="node221" class="node">
<title>layer8_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1295,-139909.32 1114,-139909.32 1114,-139841.32 1295,-139841.32 1295,-139909.32"/>
<text text-anchor="middle" x="1204.5" y="-139894.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1204.5" y="-139879.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1204.5" y="-139864.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1204.5" y="-139849.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_ffn_norm_1&#45;&gt;layer8_ffn_up_1 -->
<g id="edge277" class="edge">
<title>layer8_ffn_norm_1&#45;&gt;layer8_ffn_up_1</title>
<path fill="none" stroke="black" d="M1204.5,-139981.07C1204.5,-139981.07 1204.5,-139919.7 1204.5,-139919.7"/>
<polygon fill="black" stroke="black" points="1208,-139919.7 1204.5,-139909.7 1201,-139919.7 1208,-139919.7"/>
</g>
<!-- layer8_gate_ar -->
<g id="node222" class="node">
<title>layer8_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1295.5" cy="-139721.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1295.5" y="-139740.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1295.5" y="-139725.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1295.5" y="-139710.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1295.5" y="-139695.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer8_ffn_gate_0&#45;&gt;layer8_gate_ar -->
<g id="edge278" class="edge">
<title>layer8_ffn_gate_0&#45;&gt;layer8_gate_ar</title>
<path fill="none" stroke="black" d="M1078.08,-139875C1088.79,-139875 1096,-139875 1096,-139875 1096,-139875 1096,-139737 1096,-139737 1096,-139737 1164.56,-139737 1164.56,-139737"/>
<polygon fill="black" stroke="black" points="1164.56,-139740.5 1174.56,-139737 1164.56,-139733.5 1164.56,-139740.5"/>
</g>
<!-- layer8_ffn_gate_1&#45;&gt;layer8_gate_ar -->
<g id="edge279" class="edge">
<title>layer8_ffn_gate_1&#45;&gt;layer8_gate_ar</title>
<path fill="none" stroke="black" d="M1377.24,-139841.12C1377.24,-139841.12 1377.24,-139768.3 1377.24,-139768.3"/>
<polygon fill="black" stroke="black" points="1380.74,-139768.3 1377.24,-139758.3 1373.74,-139768.3 1380.74,-139768.3"/>
</g>
<!-- layer8_up_ar -->
<g id="node223" class="node">
<title>layer8_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="949.5" cy="-139721.23" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="949.5" y="-139740.03" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="949.5" y="-139725.03" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="949.5" y="-139710.03" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="949.5" y="-139695.03" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer8_ffn_up_0&#45;&gt;layer8_up_ar -->
<g id="edge280" class="edge">
<title>layer8_ffn_up_0&#45;&gt;layer8_up_ar</title>
<path fill="none" stroke="black" d="M841.26,-139841.12C841.26,-139841.12 841.26,-139757.2 841.26,-139757.2"/>
<polygon fill="black" stroke="black" points="844.76,-139757.2 841.26,-139747.2 837.76,-139757.2 844.76,-139757.2"/>
</g>
<!-- layer8_ffn_up_1&#45;&gt;layer8_up_ar -->
<g id="edge281" class="edge">
<title>layer8_ffn_up_1&#45;&gt;layer8_up_ar</title>
<path fill="none" stroke="black" d="M1140.76,-139841.26C1140.76,-139791.56 1140.76,-139705 1140.76,-139705 1140.76,-139705 1080.08,-139705 1080.08,-139705"/>
<polygon fill="black" stroke="black" points="1080.08,-139701.5 1070.08,-139705 1080.08,-139708.5 1080.08,-139701.5"/>
</g>
<!-- layer8_silu_0 -->
<g id="node224" class="node">
<title>layer8_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1223,-139601.15 1042,-139601.15 1042,-139533.15 1223,-139533.15 1223,-139601.15"/>
<text text-anchor="middle" x="1132.5" y="-139585.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1132.5" y="-139570.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1132.5" y="-139555.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1132.5" y="-139540.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_gate_ar&#45;&gt;layer8_silu_0 -->
<g id="edge282" class="edge">
<title>layer8_gate_ar&#45;&gt;layer8_silu_0</title>
<path fill="none" stroke="black" d="M1195.26,-139691.16C1195.26,-139691.16 1195.26,-139611.17 1195.26,-139611.17"/>
<polygon fill="black" stroke="black" points="1198.76,-139611.17 1195.26,-139601.17 1191.76,-139611.17 1198.76,-139611.17"/>
</g>
<!-- layer8_silu_1 -->
<g id="node225" class="node">
<title>layer8_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1440,-139601.15 1259,-139601.15 1259,-139533.15 1440,-139533.15 1440,-139601.15"/>
<text text-anchor="middle" x="1349.5" y="-139585.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1349.5" y="-139570.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1349.5" y="-139555.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1349.5" y="-139540.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_gate_ar&#45;&gt;layer8_silu_1 -->
<g id="edge283" class="edge">
<title>layer8_gate_ar&#45;&gt;layer8_silu_1</title>
<path fill="none" stroke="black" d="M1341.24,-139676.25C1341.24,-139676.25 1341.24,-139611.16 1341.24,-139611.16"/>
<polygon fill="black" stroke="black" points="1344.74,-139611.16 1341.24,-139601.16 1337.74,-139611.16 1344.74,-139611.16"/>
</g>
<!-- layer8_mul_0 -->
<g id="node226" class="node">
<title>layer8_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1113,-139461.15 932,-139461.15 932,-139393.15 1113,-139393.15 1113,-139461.15"/>
<text text-anchor="middle" x="1022.5" y="-139445.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1022.5" y="-139430.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1022.5" y="-139415.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1022.5" y="-139400.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_up_ar&#45;&gt;layer8_mul_0 -->
<g id="edge285" class="edge">
<title>layer8_up_ar&#45;&gt;layer8_mul_0</title>
<path fill="none" stroke="black" d="M987,-139674.96C987,-139674.96 987,-139471.24 987,-139471.24"/>
<polygon fill="black" stroke="black" points="990.5,-139471.24 987,-139461.24 983.5,-139471.24 990.5,-139471.24"/>
</g>
<!-- layer8_mul_1 -->
<g id="node227" class="node">
<title>layer8_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1330,-139461.15 1149,-139461.15 1149,-139393.15 1330,-139393.15 1330,-139461.15"/>
<text text-anchor="middle" x="1239.5" y="-139445.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1239.5" y="-139430.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1239.5" y="-139415.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1239.5" y="-139400.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer8_up_ar&#45;&gt;layer8_mul_1 -->
<g id="edge287" class="edge">
<title>layer8_up_ar&#45;&gt;layer8_mul_1</title>
<path fill="none" stroke="black" d="M1059.74,-139696.42C1059.74,-139671.57 1059.74,-139637 1059.74,-139637 1059.74,-139637 1241,-139637 1241,-139637 1241,-139637 1241,-139471.33 1241,-139471.33"/>
<polygon fill="black" stroke="black" points="1244.5,-139471.33 1241,-139461.33 1237.5,-139471.33 1244.5,-139471.33"/>
</g>
<!-- layer8_silu_0&#45;&gt;layer8_mul_0 -->
<g id="edge284" class="edge">
<title>layer8_silu_0&#45;&gt;layer8_mul_0</title>
<path fill="none" stroke="black" d="M1077.5,-139532.9C1077.5,-139532.9 1077.5,-139471.53 1077.5,-139471.53"/>
<polygon fill="black" stroke="black" points="1081,-139471.53 1077.5,-139461.53 1074,-139471.53 1081,-139471.53"/>
</g>
<!-- layer8_silu_1&#45;&gt;layer8_mul_1 -->
<g id="edge286" class="edge">
<title>layer8_silu_1&#45;&gt;layer8_mul_1</title>
<path fill="none" stroke="black" d="M1294.5,-139532.9C1294.5,-139532.9 1294.5,-139471.53 1294.5,-139471.53"/>
<polygon fill="black" stroke="black" points="1298,-139471.53 1294.5,-139461.53 1291,-139471.53 1298,-139471.53"/>
</g>
<!-- layer8_ffn_down_0 -->
<g id="node228" class="node">
<title>layer8_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1112.5,-139321.15 940.5,-139321.15 940.5,-139253.15 1112.5,-139253.15 1112.5,-139321.15"/>
<text text-anchor="middle" x="1026.5" y="-139305.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1026.5" y="-139290.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1026.5" y="-139275.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1026.5" y="-139260.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer8_mul_0&#45;&gt;layer8_ffn_down_0 -->
<g id="edge288" class="edge">
<title>layer8_mul_0&#45;&gt;layer8_ffn_down_0</title>
<path fill="none" stroke="black" d="M1026.5,-139392.9C1026.5,-139392.9 1026.5,-139331.53 1026.5,-139331.53"/>
<polygon fill="black" stroke="black" points="1030,-139331.53 1026.5,-139321.53 1023,-139331.53 1030,-139331.53"/>
</g>
<!-- layer8_ffn_down_1 -->
<g id="node229" class="node">
<title>layer8_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1322.5,-139321.15 1150.5,-139321.15 1150.5,-139253.15 1322.5,-139253.15 1322.5,-139321.15"/>
<text text-anchor="middle" x="1236.5" y="-139305.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1236.5" y="-139290.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1236.5" y="-139275.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1236.5" y="-139260.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer8_mul_1&#45;&gt;layer8_ffn_down_1 -->
<g id="edge289" class="edge">
<title>layer8_mul_1&#45;&gt;layer8_ffn_down_1</title>
<path fill="none" stroke="black" d="M1236.5,-139392.9C1236.5,-139392.9 1236.5,-139331.53 1236.5,-139331.53"/>
<polygon fill="black" stroke="black" points="1240,-139331.53 1236.5,-139321.53 1233,-139331.53 1240,-139331.53"/>
</g>
<!-- layer8_ffn_ar -->
<g id="node230" class="node">
<title>layer8_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1130.5" cy="-139133.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1130.5" y="-139151.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1130.5" y="-139136.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1130.5" y="-139121.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1130.5" y="-139106.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_ffn_down_0&#45;&gt;layer8_ffn_ar -->
<g id="edge290" class="edge">
<title>layer8_ffn_down_0&#45;&gt;layer8_ffn_ar</title>
<path fill="none" stroke="black" d="M1060.69,-139252.96C1060.69,-139252.96 1060.69,-139182.61 1060.69,-139182.61"/>
<polygon fill="black" stroke="black" points="1064.19,-139182.61 1060.69,-139172.61 1057.19,-139182.61 1064.19,-139182.61"/>
</g>
<!-- layer8_ffn_down_1&#45;&gt;layer8_ffn_ar -->
<g id="edge291" class="edge">
<title>layer8_ffn_down_1&#45;&gt;layer8_ffn_ar</title>
<path fill="none" stroke="black" d="M1201.31,-139252.96C1201.31,-139252.96 1201.31,-139182.33 1201.31,-139182.33"/>
<polygon fill="black" stroke="black" points="1204.81,-139182.33 1201.31,-139172.33 1197.81,-139182.33 1204.81,-139182.33"/>
</g>
<!-- layer9_norm_0 -->
<g id="node231" class="node">
<title>layer9_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1112.5,-139012.98 940.5,-139012.98 940.5,-138944.98 1112.5,-138944.98 1112.5,-139012.98"/>
<text text-anchor="middle" x="1026.5" y="-138997.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1026.5" y="-138982.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1026.5" y="-138967.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1026.5" y="-138952.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_ffn_ar&#45;&gt;layer9_norm_0 -->
<g id="edge292" class="edge">
<title>layer8_ffn_ar&#45;&gt;layer9_norm_0</title>
<path fill="none" stroke="black" d="M1060.69,-139093.39C1060.69,-139093.39 1060.69,-139023.04 1060.69,-139023.04"/>
<polygon fill="black" stroke="black" points="1064.19,-139023.04 1060.69,-139013.04 1057.19,-139023.04 1064.19,-139023.04"/>
</g>
<!-- layer9_norm_1 -->
<g id="node232" class="node">
<title>layer9_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1322.5,-139012.98 1150.5,-139012.98 1150.5,-138944.98 1322.5,-138944.98 1322.5,-139012.98"/>
<text text-anchor="middle" x="1236.5" y="-138997.78" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1236.5" y="-138982.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1236.5" y="-138967.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1236.5" y="-138952.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_ffn_ar&#45;&gt;layer9_norm_1 -->
<g id="edge293" class="edge">
<title>layer8_ffn_ar&#45;&gt;layer9_norm_1</title>
<path fill="none" stroke="black" d="M1201.31,-139093.79C1201.31,-139093.79 1201.31,-139023.22 1201.31,-139023.22"/>
<polygon fill="black" stroke="black" points="1204.81,-139023.22 1201.31,-139013.22 1197.81,-139023.22 1204.81,-139023.22"/>
</g>
<!-- layer9_qkv_0 -->
<g id="node233" class="node">
<title>layer9_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1113,-138872.98 932,-138872.98 932,-138804.98 1113,-138804.98 1113,-138872.98"/>
<text text-anchor="middle" x="1022.5" y="-138857.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1022.5" y="-138842.78" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1022.5" y="-138827.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1022.5" y="-138812.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer9_norm_0&#45;&gt;layer9_qkv_0 -->
<g id="edge294" class="edge">
<title>layer9_norm_0&#45;&gt;layer9_qkv_0</title>
<path fill="none" stroke="black" d="M1026.5,-138944.74C1026.5,-138944.74 1026.5,-138883.36 1026.5,-138883.36"/>
<polygon fill="black" stroke="black" points="1030,-138883.36 1026.5,-138873.36 1023,-138883.36 1030,-138883.36"/>
</g>
<!-- layer9_qkv_1 -->
<g id="node234" class="node">
<title>layer9_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1330,-138872.98 1149,-138872.98 1149,-138804.98 1330,-138804.98 1330,-138872.98"/>
<text text-anchor="middle" x="1239.5" y="-138857.78" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1239.5" y="-138842.78" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1239.5" y="-138827.78" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1239.5" y="-138812.78" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer9_norm_1&#45;&gt;layer9_qkv_1 -->
<g id="edge295" class="edge">
<title>layer9_norm_1&#45;&gt;layer9_qkv_1</title>
<path fill="none" stroke="black" d="M1236.5,-138944.74C1236.5,-138944.74 1236.5,-138883.36 1236.5,-138883.36"/>
<polygon fill="black" stroke="black" points="1240,-138883.36 1236.5,-138873.36 1233,-138883.36 1240,-138883.36"/>
</g>
<!-- layer9_qkv_ar -->
<g id="node235" class="node">
<title>layer9_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1130.5" cy="-138684.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1130.5" y="-138703.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1130.5" y="-138688.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1130.5" y="-138673.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1130.5" y="-138658.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer9_qkv_0&#45;&gt;layer9_qkv_ar -->
<g id="edge296" class="edge">
<title>layer9_qkv_0&#45;&gt;layer9_qkv_ar</title>
<path fill="none" stroke="black" d="M1057.76,-138804.79C1057.76,-138804.79 1057.76,-138734.72 1057.76,-138734.72"/>
<polygon fill="black" stroke="black" points="1061.26,-138734.72 1057.76,-138724.72 1054.26,-138734.72 1061.26,-138734.72"/>
</g>
<!-- layer9_qkv_1&#45;&gt;layer9_qkv_ar -->
<g id="edge297" class="edge">
<title>layer9_qkv_1&#45;&gt;layer9_qkv_ar</title>
<path fill="none" stroke="black" d="M1203.74,-138804.79C1203.74,-138804.79 1203.74,-138734.44 1203.74,-138734.44"/>
<polygon fill="black" stroke="black" points="1207.24,-138734.44 1203.74,-138724.44 1200.24,-138734.44 1207.24,-138734.44"/>
</g>
<!-- layer9_attn_0 -->
<g id="node236" class="node">
<title>layer9_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1112.5,-138564.82 940.5,-138564.82 940.5,-138496.82 1112.5,-138496.82 1112.5,-138564.82"/>
<text text-anchor="middle" x="1026.5" y="-138549.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1026.5" y="-138534.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1026.5" y="-138519.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1026.5" y="-138504.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer9_qkv_ar&#45;&gt;layer9_attn_0 -->
<g id="edge298" class="edge">
<title>layer9_qkv_ar&#45;&gt;layer9_attn_0</title>
<path fill="none" stroke="black" d="M1057.51,-138645.22C1057.51,-138645.22 1057.51,-138574.88 1057.51,-138574.88"/>
<polygon fill="black" stroke="black" points="1061.01,-138574.88 1057.51,-138564.88 1054.01,-138574.88 1061.01,-138574.88"/>
</g>
<!-- layer9_attn_1 -->
<g id="node237" class="node">
<title>layer9_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1320.5,-138564.82 1148.5,-138564.82 1148.5,-138496.82 1320.5,-138496.82 1320.5,-138564.82"/>
<text text-anchor="middle" x="1234.5" y="-138549.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1234.5" y="-138534.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1234.5" y="-138519.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1234.5" y="-138504.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer9_qkv_ar&#45;&gt;layer9_attn_1 -->
<g id="edge299" class="edge">
<title>layer9_qkv_ar&#45;&gt;layer9_attn_1</title>
<path fill="none" stroke="black" d="M1203.49,-138645.22C1203.49,-138645.22 1203.49,-138574.88 1203.49,-138574.88"/>
<polygon fill="black" stroke="black" points="1206.99,-138574.88 1203.49,-138564.88 1199.99,-138574.88 1206.99,-138574.88"/>
</g>
<!-- layer9_attn_out_0 -->
<g id="node238" class="node">
<title>layer9_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1112.5,-138424.82 940.5,-138424.82 940.5,-138356.82 1112.5,-138356.82 1112.5,-138424.82"/>
<text text-anchor="middle" x="1026.5" y="-138409.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1026.5" y="-138394.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1026.5" y="-138379.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1026.5" y="-138364.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer9_attn_0&#45;&gt;layer9_attn_out_0 -->
<g id="edge300" class="edge">
<title>layer9_attn_0&#45;&gt;layer9_attn_out_0</title>
<path fill="none" stroke="black" d="M1026.5,-138496.57C1026.5,-138496.57 1026.5,-138435.2 1026.5,-138435.2"/>
<polygon fill="black" stroke="black" points="1030,-138435.2 1026.5,-138425.2 1023,-138435.2 1030,-138435.2"/>
</g>
<!-- layer9_attn_out_1 -->
<g id="node239" class="node">
<title>layer9_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1320.5,-138424.82 1148.5,-138424.82 1148.5,-138356.82 1320.5,-138356.82 1320.5,-138424.82"/>
<text text-anchor="middle" x="1234.5" y="-138409.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1234.5" y="-138394.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1234.5" y="-138379.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1234.5" y="-138364.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer9_attn_1&#45;&gt;layer9_attn_out_1 -->
<g id="edge301" class="edge">
<title>layer9_attn_1&#45;&gt;layer9_attn_out_1</title>
<path fill="none" stroke="black" d="M1234.5,-138496.57C1234.5,-138496.57 1234.5,-138435.2 1234.5,-138435.2"/>
<polygon fill="black" stroke="black" points="1238,-138435.2 1234.5,-138425.2 1231,-138435.2 1238,-138435.2"/>
</g>
<!-- layer9_attn_ar -->
<g id="node240" class="node">
<title>layer9_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1130.5" cy="-138236.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1130.5" y="-138255.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1130.5" y="-138240.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1130.5" y="-138225.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1130.5" y="-138210.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_attn_out_0&#45;&gt;layer9_attn_ar -->
<g id="edge302" class="edge">
<title>layer9_attn_out_0&#45;&gt;layer9_attn_ar</title>
<path fill="none" stroke="black" d="M1060.69,-138356.62C1060.69,-138356.62 1060.69,-138286.28 1060.69,-138286.28"/>
<polygon fill="black" stroke="black" points="1064.19,-138286.28 1060.69,-138276.28 1057.19,-138286.28 1064.19,-138286.28"/>
</g>
<!-- layer9_attn_out_1&#45;&gt;layer9_attn_ar -->
<g id="edge303" class="edge">
<title>layer9_attn_out_1&#45;&gt;layer9_attn_ar</title>
<path fill="none" stroke="black" d="M1200.31,-138356.62C1200.31,-138356.62 1200.31,-138286.28 1200.31,-138286.28"/>
<polygon fill="black" stroke="black" points="1203.81,-138286.28 1200.31,-138276.28 1196.81,-138286.28 1203.81,-138286.28"/>
</g>
<!-- layer9_ffn_norm_0 -->
<g id="node241" class="node">
<title>layer9_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1108.5,-138116.65 936.5,-138116.65 936.5,-138048.65 1108.5,-138048.65 1108.5,-138116.65"/>
<text text-anchor="middle" x="1022.5" y="-138101.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1022.5" y="-138086.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1022.5" y="-138071.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1022.5" y="-138056.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_attn_ar&#45;&gt;layer9_ffn_norm_0 -->
<g id="edge304" class="edge">
<title>layer9_attn_ar&#45;&gt;layer9_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1058.69,-138197.85C1058.69,-138197.85 1058.69,-138126.8 1058.69,-138126.8"/>
<polygon fill="black" stroke="black" points="1062.19,-138126.8 1058.69,-138116.8 1055.19,-138126.8 1062.19,-138126.8"/>
</g>
<!-- layer9_ffn_norm_1 -->
<g id="node242" class="node">
<title>layer9_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1325.5,-138116.65 1153.5,-138116.65 1153.5,-138048.65 1325.5,-138048.65 1325.5,-138116.65"/>
<text text-anchor="middle" x="1239.5" y="-138101.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1239.5" y="-138086.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1239.5" y="-138071.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1239.5" y="-138056.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_attn_ar&#45;&gt;layer9_ffn_norm_1 -->
<g id="edge305" class="edge">
<title>layer9_attn_ar&#45;&gt;layer9_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1202.81,-138197.85C1202.81,-138197.85 1202.81,-138126.8 1202.81,-138126.8"/>
<polygon fill="black" stroke="black" points="1206.31,-138126.8 1202.81,-138116.8 1199.31,-138126.8 1206.31,-138126.8"/>
</g>
<!-- layer9_ffn_gate_0 -->
<g id="node243" class="node">
<title>layer9_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1113,-137976.65 932,-137976.65 932,-137908.65 1113,-137908.65 1113,-137976.65"/>
<text text-anchor="middle" x="1022.5" y="-137961.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1022.5" y="-137946.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1022.5" y="-137931.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1022.5" y="-137916.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_ffn_norm_0&#45;&gt;layer9_ffn_gate_0 -->
<g id="edge306" class="edge">
<title>layer9_ffn_norm_0&#45;&gt;layer9_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1022.5,-138048.4C1022.5,-138048.4 1022.5,-137987.03 1022.5,-137987.03"/>
<polygon fill="black" stroke="black" points="1026,-137987.03 1022.5,-137977.03 1019,-137987.03 1026,-137987.03"/>
</g>
<!-- layer9_ffn_up_0 -->
<g id="node245" class="node">
<title>layer9_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="896,-137976.65 715,-137976.65 715,-137908.65 896,-137908.65 896,-137976.65"/>
<text text-anchor="middle" x="805.5" y="-137961.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="805.5" y="-137946.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="805.5" y="-137931.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="805.5" y="-137916.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_ffn_norm_0&#45;&gt;layer9_ffn_up_0 -->
<g id="edge308" class="edge">
<title>layer9_ffn_norm_0&#45;&gt;layer9_ffn_up_0</title>
<path fill="none" stroke="black" d="M936.31,-138082C896.86,-138082 858.76,-138082 858.76,-138082 858.76,-138082 858.76,-137986.74 858.76,-137986.74"/>
<polygon fill="black" stroke="black" points="862.26,-137986.74 858.76,-137976.74 855.26,-137986.74 862.26,-137986.74"/>
</g>
<!-- layer9_ffn_gate_1 -->
<g id="node244" class="node">
<title>layer9_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1547,-137976.65 1366,-137976.65 1366,-137908.65 1547,-137908.65 1547,-137976.65"/>
<text text-anchor="middle" x="1456.5" y="-137961.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1456.5" y="-137946.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1456.5" y="-137931.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1456.5" y="-137916.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_ffn_norm_1&#45;&gt;layer9_ffn_gate_1 -->
<g id="edge307" class="edge">
<title>layer9_ffn_norm_1&#45;&gt;layer9_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1325.56,-138082C1364.95,-138082 1403,-138082 1403,-138082 1403,-138082 1403,-137986.74 1403,-137986.74"/>
<polygon fill="black" stroke="black" points="1406.5,-137986.74 1403,-137976.74 1399.5,-137986.74 1406.5,-137986.74"/>
</g>
<!-- layer9_ffn_up_1 -->
<g id="node246" class="node">
<title>layer9_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1330,-137976.65 1149,-137976.65 1149,-137908.65 1330,-137908.65 1330,-137976.65"/>
<text text-anchor="middle" x="1239.5" y="-137961.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1239.5" y="-137946.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1239.5" y="-137931.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1239.5" y="-137916.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_ffn_norm_1&#45;&gt;layer9_ffn_up_1 -->
<g id="edge309" class="edge">
<title>layer9_ffn_norm_1&#45;&gt;layer9_ffn_up_1</title>
<path fill="none" stroke="black" d="M1239.5,-138048.4C1239.5,-138048.4 1239.5,-137987.03 1239.5,-137987.03"/>
<polygon fill="black" stroke="black" points="1243,-137987.03 1239.5,-137977.03 1236,-137987.03 1243,-137987.03"/>
</g>
<!-- layer9_gate_ar -->
<g id="node247" class="node">
<title>layer9_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1330.5" cy="-137788.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1330.5" y="-137807.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1330.5" y="-137792.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1330.5" y="-137777.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1330.5" y="-137762.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer9_ffn_gate_0&#45;&gt;layer9_gate_ar -->
<g id="edge310" class="edge">
<title>layer9_ffn_gate_0&#45;&gt;layer9_gate_ar</title>
<path fill="none" stroke="black" d="M1113.08,-137942C1123.79,-137942 1131,-137942 1131,-137942 1131,-137942 1131,-137804 1131,-137804 1131,-137804 1199.28,-137804 1199.28,-137804"/>
<polygon fill="black" stroke="black" points="1199.28,-137807.5 1209.28,-137804 1199.28,-137800.5 1199.28,-137807.5"/>
</g>
<!-- layer9_ffn_gate_1&#45;&gt;layer9_gate_ar -->
<g id="edge311" class="edge">
<title>layer9_ffn_gate_1&#45;&gt;layer9_gate_ar</title>
<path fill="none" stroke="black" d="M1412.24,-137908.46C1412.24,-137908.46 1412.24,-137835.63 1412.24,-137835.63"/>
<polygon fill="black" stroke="black" points="1415.74,-137835.63 1412.24,-137825.63 1408.74,-137835.63 1415.74,-137835.63"/>
</g>
<!-- layer9_up_ar -->
<g id="node248" class="node">
<title>layer9_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="984.5" cy="-137788.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="984.5" y="-137807.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="984.5" y="-137792.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="984.5" y="-137777.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="984.5" y="-137762.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer9_ffn_up_0&#45;&gt;layer9_up_ar -->
<g id="edge312" class="edge">
<title>layer9_ffn_up_0&#45;&gt;layer9_up_ar</title>
<path fill="none" stroke="black" d="M876.26,-137908.46C876.26,-137908.46 876.26,-137824.53 876.26,-137824.53"/>
<polygon fill="black" stroke="black" points="879.76,-137824.53 876.26,-137814.53 872.76,-137824.53 879.76,-137824.53"/>
</g>
<!-- layer9_ffn_up_1&#45;&gt;layer9_up_ar -->
<g id="edge313" class="edge">
<title>layer9_ffn_up_1&#45;&gt;layer9_up_ar</title>
<path fill="none" stroke="black" d="M1175.76,-137908.53C1175.76,-137858.73 1175.76,-137772 1175.76,-137772 1175.76,-137772 1114.81,-137772 1114.81,-137772"/>
<polygon fill="black" stroke="black" points="1114.81,-137768.5 1104.81,-137772 1114.81,-137775.5 1114.81,-137768.5"/>
</g>
<!-- layer9_silu_0 -->
<g id="node249" class="node">
<title>layer9_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1258,-137668.49 1077,-137668.49 1077,-137600.49 1258,-137600.49 1258,-137668.49"/>
<text text-anchor="middle" x="1167.5" y="-137653.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1167.5" y="-137638.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1167.5" y="-137623.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1167.5" y="-137608.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_gate_ar&#45;&gt;layer9_silu_0 -->
<g id="edge314" class="edge">
<title>layer9_gate_ar&#45;&gt;layer9_silu_0</title>
<path fill="none" stroke="black" d="M1230.26,-137758.49C1230.26,-137758.49 1230.26,-137678.51 1230.26,-137678.51"/>
<polygon fill="black" stroke="black" points="1233.76,-137678.51 1230.26,-137668.51 1226.76,-137678.51 1233.76,-137678.51"/>
</g>
<!-- layer9_silu_1 -->
<g id="node250" class="node">
<title>layer9_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1475,-137668.49 1294,-137668.49 1294,-137600.49 1475,-137600.49 1475,-137668.49"/>
<text text-anchor="middle" x="1384.5" y="-137653.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1384.5" y="-137638.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1384.5" y="-137623.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1384.5" y="-137608.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_gate_ar&#45;&gt;layer9_silu_1 -->
<g id="edge315" class="edge">
<title>layer9_gate_ar&#45;&gt;layer9_silu_1</title>
<path fill="none" stroke="black" d="M1376.24,-137743.59C1376.24,-137743.59 1376.24,-137678.49 1376.24,-137678.49"/>
<polygon fill="black" stroke="black" points="1379.74,-137678.49 1376.24,-137668.49 1372.74,-137678.49 1379.74,-137678.49"/>
</g>
<!-- layer9_mul_0 -->
<g id="node251" class="node">
<title>layer9_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1148,-137528.49 967,-137528.49 967,-137460.49 1148,-137460.49 1148,-137528.49"/>
<text text-anchor="middle" x="1057.5" y="-137513.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1057.5" y="-137498.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1057.5" y="-137483.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1057.5" y="-137468.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_up_ar&#45;&gt;layer9_mul_0 -->
<g id="edge317" class="edge">
<title>layer9_up_ar&#45;&gt;layer9_mul_0</title>
<path fill="none" stroke="black" d="M1022,-137742.29C1022,-137742.29 1022,-137538.57 1022,-137538.57"/>
<polygon fill="black" stroke="black" points="1025.5,-137538.57 1022,-137528.57 1018.5,-137538.57 1025.5,-137538.57"/>
</g>
<!-- layer9_mul_1 -->
<g id="node252" class="node">
<title>layer9_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1365,-137528.49 1184,-137528.49 1184,-137460.49 1365,-137460.49 1365,-137528.49"/>
<text text-anchor="middle" x="1274.5" y="-137513.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1274.5" y="-137498.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1274.5" y="-137483.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1274.5" y="-137468.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer9_up_ar&#45;&gt;layer9_mul_1 -->
<g id="edge319" class="edge">
<title>layer9_up_ar&#45;&gt;layer9_mul_1</title>
<path fill="none" stroke="black" d="M1094.74,-137764.11C1094.74,-137739.13 1094.74,-137704 1094.74,-137704 1094.74,-137704 1276,-137704 1276,-137704 1276,-137704 1276,-137538.61 1276,-137538.61"/>
<polygon fill="black" stroke="black" points="1279.5,-137538.61 1276,-137528.61 1272.5,-137538.61 1279.5,-137538.61"/>
</g>
<!-- layer9_silu_0&#45;&gt;layer9_mul_0 -->
<g id="edge316" class="edge">
<title>layer9_silu_0&#45;&gt;layer9_mul_0</title>
<path fill="none" stroke="black" d="M1112.5,-137600.24C1112.5,-137600.24 1112.5,-137538.86 1112.5,-137538.86"/>
<polygon fill="black" stroke="black" points="1116,-137538.86 1112.5,-137528.86 1109,-137538.86 1116,-137538.86"/>
</g>
<!-- layer9_silu_1&#45;&gt;layer9_mul_1 -->
<g id="edge318" class="edge">
<title>layer9_silu_1&#45;&gt;layer9_mul_1</title>
<path fill="none" stroke="black" d="M1329.5,-137600.24C1329.5,-137600.24 1329.5,-137538.86 1329.5,-137538.86"/>
<polygon fill="black" stroke="black" points="1333,-137538.86 1329.5,-137528.86 1326,-137538.86 1333,-137538.86"/>
</g>
<!-- layer9_ffn_down_0 -->
<g id="node253" class="node">
<title>layer9_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1147.5,-137388.49 975.5,-137388.49 975.5,-137320.49 1147.5,-137320.49 1147.5,-137388.49"/>
<text text-anchor="middle" x="1061.5" y="-137373.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1061.5" y="-137358.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1061.5" y="-137343.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1061.5" y="-137328.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer9_mul_0&#45;&gt;layer9_ffn_down_0 -->
<g id="edge320" class="edge">
<title>layer9_mul_0&#45;&gt;layer9_ffn_down_0</title>
<path fill="none" stroke="black" d="M1061.5,-137460.24C1061.5,-137460.24 1061.5,-137398.86 1061.5,-137398.86"/>
<polygon fill="black" stroke="black" points="1065,-137398.86 1061.5,-137388.86 1058,-137398.86 1065,-137398.86"/>
</g>
<!-- layer9_ffn_down_1 -->
<g id="node254" class="node">
<title>layer9_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1357.5,-137388.49 1185.5,-137388.49 1185.5,-137320.49 1357.5,-137320.49 1357.5,-137388.49"/>
<text text-anchor="middle" x="1271.5" y="-137373.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1271.5" y="-137358.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1271.5" y="-137343.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1271.5" y="-137328.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer9_mul_1&#45;&gt;layer9_ffn_down_1 -->
<g id="edge321" class="edge">
<title>layer9_mul_1&#45;&gt;layer9_ffn_down_1</title>
<path fill="none" stroke="black" d="M1271.5,-137460.24C1271.5,-137460.24 1271.5,-137398.86 1271.5,-137398.86"/>
<polygon fill="black" stroke="black" points="1275,-137398.86 1271.5,-137388.86 1268,-137398.86 1275,-137398.86"/>
</g>
<!-- layer9_ffn_ar -->
<g id="node255" class="node">
<title>layer9_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1165.5" cy="-137200.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1165.5" y="-137219.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1165.5" y="-137204.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1165.5" y="-137189.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1165.5" y="-137174.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_ffn_down_0&#45;&gt;layer9_ffn_ar -->
<g id="edge322" class="edge">
<title>layer9_ffn_down_0&#45;&gt;layer9_ffn_ar</title>
<path fill="none" stroke="black" d="M1095.69,-137320.29C1095.69,-137320.29 1095.69,-137249.94 1095.69,-137249.94"/>
<polygon fill="black" stroke="black" points="1099.19,-137249.94 1095.69,-137239.94 1092.19,-137249.94 1099.19,-137249.94"/>
</g>
<!-- layer9_ffn_down_1&#45;&gt;layer9_ffn_ar -->
<g id="edge323" class="edge">
<title>layer9_ffn_down_1&#45;&gt;layer9_ffn_ar</title>
<path fill="none" stroke="black" d="M1236.31,-137320.29C1236.31,-137320.29 1236.31,-137249.67 1236.31,-137249.67"/>
<polygon fill="black" stroke="black" points="1239.81,-137249.67 1236.31,-137239.67 1232.81,-137249.67 1239.81,-137249.67"/>
</g>
<!-- layer10_norm_0 -->
<g id="node256" class="node">
<title>layer10_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1147.5,-137080.32 975.5,-137080.32 975.5,-137012.32 1147.5,-137012.32 1147.5,-137080.32"/>
<text text-anchor="middle" x="1061.5" y="-137065.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1061.5" y="-137050.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1061.5" y="-137035.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1061.5" y="-137020.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_ffn_ar&#45;&gt;layer10_norm_0 -->
<g id="edge324" class="edge">
<title>layer9_ffn_ar&#45;&gt;layer10_norm_0</title>
<path fill="none" stroke="black" d="M1095.69,-137160.72C1095.69,-137160.72 1095.69,-137090.38 1095.69,-137090.38"/>
<polygon fill="black" stroke="black" points="1099.19,-137090.38 1095.69,-137080.38 1092.19,-137090.38 1099.19,-137090.38"/>
</g>
<!-- layer10_norm_1 -->
<g id="node257" class="node">
<title>layer10_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1357.5,-137080.32 1185.5,-137080.32 1185.5,-137012.32 1357.5,-137012.32 1357.5,-137080.32"/>
<text text-anchor="middle" x="1271.5" y="-137065.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1271.5" y="-137050.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1271.5" y="-137035.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1271.5" y="-137020.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_ffn_ar&#45;&gt;layer10_norm_1 -->
<g id="edge325" class="edge">
<title>layer9_ffn_ar&#45;&gt;layer10_norm_1</title>
<path fill="none" stroke="black" d="M1236.31,-137161.12C1236.31,-137161.12 1236.31,-137090.55 1236.31,-137090.55"/>
<polygon fill="black" stroke="black" points="1239.81,-137090.55 1236.31,-137080.55 1232.81,-137090.55 1239.81,-137090.55"/>
</g>
<!-- layer10_qkv_0 -->
<g id="node258" class="node">
<title>layer10_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1148,-136940.32 967,-136940.32 967,-136872.32 1148,-136872.32 1148,-136940.32"/>
<text text-anchor="middle" x="1057.5" y="-136925.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1057.5" y="-136910.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1057.5" y="-136895.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1057.5" y="-136880.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer10_norm_0&#45;&gt;layer10_qkv_0 -->
<g id="edge326" class="edge">
<title>layer10_norm_0&#45;&gt;layer10_qkv_0</title>
<path fill="none" stroke="black" d="M1061.5,-137012.07C1061.5,-137012.07 1061.5,-136950.7 1061.5,-136950.7"/>
<polygon fill="black" stroke="black" points="1065,-136950.7 1061.5,-136940.7 1058,-136950.7 1065,-136950.7"/>
</g>
<!-- layer10_qkv_1 -->
<g id="node259" class="node">
<title>layer10_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1365,-136940.32 1184,-136940.32 1184,-136872.32 1365,-136872.32 1365,-136940.32"/>
<text text-anchor="middle" x="1274.5" y="-136925.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1274.5" y="-136910.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1274.5" y="-136895.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1274.5" y="-136880.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer10_norm_1&#45;&gt;layer10_qkv_1 -->
<g id="edge327" class="edge">
<title>layer10_norm_1&#45;&gt;layer10_qkv_1</title>
<path fill="none" stroke="black" d="M1271.5,-137012.07C1271.5,-137012.07 1271.5,-136950.7 1271.5,-136950.7"/>
<polygon fill="black" stroke="black" points="1275,-136950.7 1271.5,-136940.7 1268,-136950.7 1275,-136950.7"/>
</g>
<!-- layer10_qkv_ar -->
<g id="node260" class="node">
<title>layer10_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1165.5" cy="-136752.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1165.5" y="-136771.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1165.5" y="-136756.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1165.5" y="-136741.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1165.5" y="-136726.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer10_qkv_0&#45;&gt;layer10_qkv_ar -->
<g id="edge328" class="edge">
<title>layer10_qkv_0&#45;&gt;layer10_qkv_ar</title>
<path fill="none" stroke="black" d="M1092.76,-136872.12C1092.76,-136872.12 1092.76,-136802.06 1092.76,-136802.06"/>
<polygon fill="black" stroke="black" points="1096.26,-136802.06 1092.76,-136792.06 1089.26,-136802.06 1096.26,-136802.06"/>
</g>
<!-- layer10_qkv_1&#45;&gt;layer10_qkv_ar -->
<g id="edge329" class="edge">
<title>layer10_qkv_1&#45;&gt;layer10_qkv_ar</title>
<path fill="none" stroke="black" d="M1238.74,-136872.12C1238.74,-136872.12 1238.74,-136801.78 1238.74,-136801.78"/>
<polygon fill="black" stroke="black" points="1242.24,-136801.78 1238.74,-136791.78 1235.24,-136801.78 1242.24,-136801.78"/>
</g>
<!-- layer10_attn_0 -->
<g id="node261" class="node">
<title>layer10_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1147.5,-136632.15 975.5,-136632.15 975.5,-136564.15 1147.5,-136564.15 1147.5,-136632.15"/>
<text text-anchor="middle" x="1061.5" y="-136616.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1061.5" y="-136601.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1061.5" y="-136586.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1061.5" y="-136571.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer10_qkv_ar&#45;&gt;layer10_attn_0 -->
<g id="edge330" class="edge">
<title>layer10_qkv_ar&#45;&gt;layer10_attn_0</title>
<path fill="none" stroke="black" d="M1092.51,-136712.56C1092.51,-136712.56 1092.51,-136642.21 1092.51,-136642.21"/>
<polygon fill="black" stroke="black" points="1096.01,-136642.21 1092.51,-136632.21 1089.01,-136642.21 1096.01,-136642.21"/>
</g>
<!-- layer10_attn_1 -->
<g id="node262" class="node">
<title>layer10_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1355.5,-136632.15 1183.5,-136632.15 1183.5,-136564.15 1355.5,-136564.15 1355.5,-136632.15"/>
<text text-anchor="middle" x="1269.5" y="-136616.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1269.5" y="-136601.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1269.5" y="-136586.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1269.5" y="-136571.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer10_qkv_ar&#45;&gt;layer10_attn_1 -->
<g id="edge331" class="edge">
<title>layer10_qkv_ar&#45;&gt;layer10_attn_1</title>
<path fill="none" stroke="black" d="M1238.49,-136712.56C1238.49,-136712.56 1238.49,-136642.21 1238.49,-136642.21"/>
<polygon fill="black" stroke="black" points="1241.99,-136642.21 1238.49,-136632.21 1234.99,-136642.21 1241.99,-136642.21"/>
</g>
<!-- layer10_attn_out_0 -->
<g id="node263" class="node">
<title>layer10_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1147.5,-136492.15 975.5,-136492.15 975.5,-136424.15 1147.5,-136424.15 1147.5,-136492.15"/>
<text text-anchor="middle" x="1061.5" y="-136476.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1061.5" y="-136461.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1061.5" y="-136446.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1061.5" y="-136431.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer10_attn_0&#45;&gt;layer10_attn_out_0 -->
<g id="edge332" class="edge">
<title>layer10_attn_0&#45;&gt;layer10_attn_out_0</title>
<path fill="none" stroke="black" d="M1061.5,-136563.9C1061.5,-136563.9 1061.5,-136502.53 1061.5,-136502.53"/>
<polygon fill="black" stroke="black" points="1065,-136502.53 1061.5,-136492.53 1058,-136502.53 1065,-136502.53"/>
</g>
<!-- layer10_attn_out_1 -->
<g id="node264" class="node">
<title>layer10_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1355.5,-136492.15 1183.5,-136492.15 1183.5,-136424.15 1355.5,-136424.15 1355.5,-136492.15"/>
<text text-anchor="middle" x="1269.5" y="-136476.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1269.5" y="-136461.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1269.5" y="-136446.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1269.5" y="-136431.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer10_attn_1&#45;&gt;layer10_attn_out_1 -->
<g id="edge333" class="edge">
<title>layer10_attn_1&#45;&gt;layer10_attn_out_1</title>
<path fill="none" stroke="black" d="M1269.5,-136563.9C1269.5,-136563.9 1269.5,-136502.53 1269.5,-136502.53"/>
<polygon fill="black" stroke="black" points="1273,-136502.53 1269.5,-136492.53 1266,-136502.53 1273,-136502.53"/>
</g>
<!-- layer10_attn_ar -->
<g id="node265" class="node">
<title>layer10_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1165.5" cy="-136304.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1165.5" y="-136322.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1165.5" y="-136307.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1165.5" y="-136292.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1165.5" y="-136277.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_attn_out_0&#45;&gt;layer10_attn_ar -->
<g id="edge334" class="edge">
<title>layer10_attn_out_0&#45;&gt;layer10_attn_ar</title>
<path fill="none" stroke="black" d="M1095.69,-136423.96C1095.69,-136423.96 1095.69,-136353.61 1095.69,-136353.61"/>
<polygon fill="black" stroke="black" points="1099.19,-136353.61 1095.69,-136343.61 1092.19,-136353.61 1099.19,-136353.61"/>
</g>
<!-- layer10_attn_out_1&#45;&gt;layer10_attn_ar -->
<g id="edge335" class="edge">
<title>layer10_attn_out_1&#45;&gt;layer10_attn_ar</title>
<path fill="none" stroke="black" d="M1235.31,-136423.96C1235.31,-136423.96 1235.31,-136353.61 1235.31,-136353.61"/>
<polygon fill="black" stroke="black" points="1238.81,-136353.61 1235.31,-136343.61 1231.81,-136353.61 1238.81,-136353.61"/>
</g>
<!-- layer10_ffn_norm_0 -->
<g id="node266" class="node">
<title>layer10_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1143.5,-136183.99 971.5,-136183.99 971.5,-136115.99 1143.5,-136115.99 1143.5,-136183.99"/>
<text text-anchor="middle" x="1057.5" y="-136168.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1057.5" y="-136153.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1057.5" y="-136138.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1057.5" y="-136123.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_attn_ar&#45;&gt;layer10_ffn_norm_0 -->
<g id="edge336" class="edge">
<title>layer10_attn_ar&#45;&gt;layer10_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1093.69,-136265.19C1093.69,-136265.19 1093.69,-136194.13 1093.69,-136194.13"/>
<polygon fill="black" stroke="black" points="1097.19,-136194.13 1093.69,-136184.13 1090.19,-136194.13 1097.19,-136194.13"/>
</g>
<!-- layer10_ffn_norm_1 -->
<g id="node267" class="node">
<title>layer10_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1360.5,-136183.99 1188.5,-136183.99 1188.5,-136115.99 1360.5,-136115.99 1360.5,-136183.99"/>
<text text-anchor="middle" x="1274.5" y="-136168.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1274.5" y="-136153.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1274.5" y="-136138.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1274.5" y="-136123.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_attn_ar&#45;&gt;layer10_ffn_norm_1 -->
<g id="edge337" class="edge">
<title>layer10_attn_ar&#45;&gt;layer10_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1237.81,-136265.19C1237.81,-136265.19 1237.81,-136194.13 1237.81,-136194.13"/>
<polygon fill="black" stroke="black" points="1241.31,-136194.13 1237.81,-136184.13 1234.31,-136194.13 1241.31,-136194.13"/>
</g>
<!-- layer10_ffn_gate_0 -->
<g id="node268" class="node">
<title>layer10_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1148,-136043.99 967,-136043.99 967,-135975.99 1148,-135975.99 1148,-136043.99"/>
<text text-anchor="middle" x="1057.5" y="-136028.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1057.5" y="-136013.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1057.5" y="-135998.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1057.5" y="-135983.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_ffn_norm_0&#45;&gt;layer10_ffn_gate_0 -->
<g id="edge338" class="edge">
<title>layer10_ffn_norm_0&#45;&gt;layer10_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1057.5,-136115.74C1057.5,-136115.74 1057.5,-136054.37 1057.5,-136054.37"/>
<polygon fill="black" stroke="black" points="1061,-136054.37 1057.5,-136044.37 1054,-136054.37 1061,-136054.37"/>
</g>
<!-- layer10_ffn_up_0 -->
<g id="node270" class="node">
<title>layer10_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="931,-136043.99 750,-136043.99 750,-135975.99 931,-135975.99 931,-136043.99"/>
<text text-anchor="middle" x="840.5" y="-136028.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="840.5" y="-136013.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="840.5" y="-135998.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="840.5" y="-135983.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_ffn_norm_0&#45;&gt;layer10_ffn_up_0 -->
<g id="edge340" class="edge">
<title>layer10_ffn_norm_0&#45;&gt;layer10_ffn_up_0</title>
<path fill="none" stroke="black" d="M971.31,-136149C931.86,-136149 893.76,-136149 893.76,-136149 893.76,-136149 893.76,-136053.99 893.76,-136053.99"/>
<polygon fill="black" stroke="black" points="897.26,-136053.99 893.76,-136043.99 890.26,-136053.99 897.26,-136053.99"/>
</g>
<!-- layer10_ffn_gate_1 -->
<g id="node269" class="node">
<title>layer10_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1582,-136043.99 1401,-136043.99 1401,-135975.99 1582,-135975.99 1582,-136043.99"/>
<text text-anchor="middle" x="1491.5" y="-136028.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1491.5" y="-136013.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1491.5" y="-135998.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1491.5" y="-135983.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_ffn_norm_1&#45;&gt;layer10_ffn_gate_1 -->
<g id="edge339" class="edge">
<title>layer10_ffn_norm_1&#45;&gt;layer10_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1360.56,-136149C1399.95,-136149 1438,-136149 1438,-136149 1438,-136149 1438,-136053.99 1438,-136053.99"/>
<polygon fill="black" stroke="black" points="1441.5,-136053.99 1438,-136043.99 1434.5,-136053.99 1441.5,-136053.99"/>
</g>
<!-- layer10_ffn_up_1 -->
<g id="node271" class="node">
<title>layer10_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1365,-136043.99 1184,-136043.99 1184,-135975.99 1365,-135975.99 1365,-136043.99"/>
<text text-anchor="middle" x="1274.5" y="-136028.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1274.5" y="-136013.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1274.5" y="-135998.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1274.5" y="-135983.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_ffn_norm_1&#45;&gt;layer10_ffn_up_1 -->
<g id="edge341" class="edge">
<title>layer10_ffn_norm_1&#45;&gt;layer10_ffn_up_1</title>
<path fill="none" stroke="black" d="M1274.5,-136115.74C1274.5,-136115.74 1274.5,-136054.37 1274.5,-136054.37"/>
<polygon fill="black" stroke="black" points="1278,-136054.37 1274.5,-136044.37 1271,-136054.37 1278,-136054.37"/>
</g>
<!-- layer10_gate_ar -->
<g id="node272" class="node">
<title>layer10_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1365.5" cy="-135855.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1365.5" y="-135874.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1365.5" y="-135859.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1365.5" y="-135844.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1365.5" y="-135829.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer10_ffn_gate_0&#45;&gt;layer10_gate_ar -->
<g id="edge342" class="edge">
<title>layer10_ffn_gate_0&#45;&gt;layer10_gate_ar</title>
<path fill="none" stroke="black" d="M1148.08,-136009C1158.79,-136009 1166,-136009 1166,-136009 1166,-136009 1166,-135871 1166,-135871 1166,-135871 1233.7,-135871 1233.7,-135871"/>
<polygon fill="black" stroke="black" points="1233.7,-135874.5 1243.7,-135871 1233.7,-135867.5 1233.7,-135874.5"/>
</g>
<!-- layer10_ffn_gate_1&#45;&gt;layer10_gate_ar -->
<g id="edge343" class="edge">
<title>layer10_ffn_gate_1&#45;&gt;layer10_gate_ar</title>
<path fill="none" stroke="black" d="M1447.24,-135975.79C1447.24,-135975.79 1447.24,-135902.97 1447.24,-135902.97"/>
<polygon fill="black" stroke="black" points="1450.74,-135902.97 1447.24,-135892.97 1443.74,-135902.97 1450.74,-135902.97"/>
</g>
<!-- layer10_up_ar -->
<g id="node273" class="node">
<title>layer10_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1019.5" cy="-135855.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1019.5" y="-135874.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1019.5" y="-135859.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1019.5" y="-135844.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1019.5" y="-135829.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer10_ffn_up_0&#45;&gt;layer10_up_ar -->
<g id="edge344" class="edge">
<title>layer10_ffn_up_0&#45;&gt;layer10_up_ar</title>
<path fill="none" stroke="black" d="M911.26,-135975.79C911.26,-135975.79 911.26,-135891.87 911.26,-135891.87"/>
<polygon fill="black" stroke="black" points="914.76,-135891.87 911.26,-135881.87 907.76,-135891.87 914.76,-135891.87"/>
</g>
<!-- layer10_ffn_up_1&#45;&gt;layer10_up_ar -->
<g id="edge345" class="edge">
<title>layer10_ffn_up_1&#45;&gt;layer10_up_ar</title>
<path fill="none" stroke="black" d="M1210.76,-135975.8C1210.76,-135925.9 1210.76,-135839 1210.76,-135839 1210.76,-135839 1149.54,-135839 1149.54,-135839"/>
<polygon fill="black" stroke="black" points="1149.54,-135835.5 1139.54,-135839 1149.54,-135842.5 1149.54,-135835.5"/>
</g>
<!-- layer10_silu_0 -->
<g id="node274" class="node">
<title>layer10_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1293,-135735.82 1112,-135735.82 1112,-135667.82 1293,-135667.82 1293,-135735.82"/>
<text text-anchor="middle" x="1202.5" y="-135720.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1202.5" y="-135705.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1202.5" y="-135690.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1202.5" y="-135675.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_gate_ar&#45;&gt;layer10_silu_0 -->
<g id="edge346" class="edge">
<title>layer10_gate_ar&#45;&gt;layer10_silu_0</title>
<path fill="none" stroke="black" d="M1265.26,-135825.83C1265.26,-135825.83 1265.26,-135745.84 1265.26,-135745.84"/>
<polygon fill="black" stroke="black" points="1268.76,-135745.84 1265.26,-135735.84 1261.76,-135745.84 1268.76,-135745.84"/>
</g>
<!-- layer10_silu_1 -->
<g id="node275" class="node">
<title>layer10_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1510,-135735.82 1329,-135735.82 1329,-135667.82 1510,-135667.82 1510,-135735.82"/>
<text text-anchor="middle" x="1419.5" y="-135720.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1419.5" y="-135705.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1419.5" y="-135690.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1419.5" y="-135675.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_gate_ar&#45;&gt;layer10_silu_1 -->
<g id="edge347" class="edge">
<title>layer10_gate_ar&#45;&gt;layer10_silu_1</title>
<path fill="none" stroke="black" d="M1411.24,-135810.92C1411.24,-135810.92 1411.24,-135745.83 1411.24,-135745.83"/>
<polygon fill="black" stroke="black" points="1414.74,-135745.83 1411.24,-135735.83 1407.74,-135745.83 1414.74,-135745.83"/>
</g>
<!-- layer10_mul_0 -->
<g id="node276" class="node">
<title>layer10_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1183,-135595.82 1002,-135595.82 1002,-135527.82 1183,-135527.82 1183,-135595.82"/>
<text text-anchor="middle" x="1092.5" y="-135580.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1092.5" y="-135565.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1092.5" y="-135550.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1092.5" y="-135535.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_up_ar&#45;&gt;layer10_mul_0 -->
<g id="edge349" class="edge">
<title>layer10_up_ar&#45;&gt;layer10_mul_0</title>
<path fill="none" stroke="black" d="M1057,-135809.63C1057,-135809.63 1057,-135605.9 1057,-135605.9"/>
<polygon fill="black" stroke="black" points="1060.5,-135605.9 1057,-135595.9 1053.5,-135605.9 1060.5,-135605.9"/>
</g>
<!-- layer10_mul_1 -->
<g id="node277" class="node">
<title>layer10_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1400,-135595.82 1219,-135595.82 1219,-135527.82 1400,-135527.82 1400,-135595.82"/>
<text text-anchor="middle" x="1309.5" y="-135580.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1309.5" y="-135565.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1309.5" y="-135550.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1309.5" y="-135535.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer10_up_ar&#45;&gt;layer10_mul_1 -->
<g id="edge351" class="edge">
<title>layer10_up_ar&#45;&gt;layer10_mul_1</title>
<path fill="none" stroke="black" d="M1129.74,-135831.35C1129.74,-135806.27 1129.74,-135771 1129.74,-135771 1129.74,-135771 1311,-135771 1311,-135771 1311,-135771 1311,-135605.89 1311,-135605.89"/>
<polygon fill="black" stroke="black" points="1314.5,-135605.89 1311,-135595.89 1307.5,-135605.89 1314.5,-135605.89"/>
</g>
<!-- layer10_silu_0&#45;&gt;layer10_mul_0 -->
<g id="edge348" class="edge">
<title>layer10_silu_0&#45;&gt;layer10_mul_0</title>
<path fill="none" stroke="black" d="M1147.5,-135667.57C1147.5,-135667.57 1147.5,-135606.2 1147.5,-135606.2"/>
<polygon fill="black" stroke="black" points="1151,-135606.2 1147.5,-135596.2 1144,-135606.2 1151,-135606.2"/>
</g>
<!-- layer10_silu_1&#45;&gt;layer10_mul_1 -->
<g id="edge350" class="edge">
<title>layer10_silu_1&#45;&gt;layer10_mul_1</title>
<path fill="none" stroke="black" d="M1364.5,-135667.57C1364.5,-135667.57 1364.5,-135606.2 1364.5,-135606.2"/>
<polygon fill="black" stroke="black" points="1368,-135606.2 1364.5,-135596.2 1361,-135606.2 1368,-135606.2"/>
</g>
<!-- layer10_ffn_down_0 -->
<g id="node278" class="node">
<title>layer10_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1182.5,-135455.82 1010.5,-135455.82 1010.5,-135387.82 1182.5,-135387.82 1182.5,-135455.82"/>
<text text-anchor="middle" x="1096.5" y="-135440.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1096.5" y="-135425.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1096.5" y="-135410.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1096.5" y="-135395.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer10_mul_0&#45;&gt;layer10_ffn_down_0 -->
<g id="edge352" class="edge">
<title>layer10_mul_0&#45;&gt;layer10_ffn_down_0</title>
<path fill="none" stroke="black" d="M1096.5,-135527.57C1096.5,-135527.57 1096.5,-135466.2 1096.5,-135466.2"/>
<polygon fill="black" stroke="black" points="1100,-135466.2 1096.5,-135456.2 1093,-135466.2 1100,-135466.2"/>
</g>
<!-- layer10_ffn_down_1 -->
<g id="node279" class="node">
<title>layer10_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1392.5,-135455.82 1220.5,-135455.82 1220.5,-135387.82 1392.5,-135387.82 1392.5,-135455.82"/>
<text text-anchor="middle" x="1306.5" y="-135440.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1306.5" y="-135425.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1306.5" y="-135410.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1306.5" y="-135395.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer10_mul_1&#45;&gt;layer10_ffn_down_1 -->
<g id="edge353" class="edge">
<title>layer10_mul_1&#45;&gt;layer10_ffn_down_1</title>
<path fill="none" stroke="black" d="M1306.5,-135527.57C1306.5,-135527.57 1306.5,-135466.2 1306.5,-135466.2"/>
<polygon fill="black" stroke="black" points="1310,-135466.2 1306.5,-135456.2 1303,-135466.2 1310,-135466.2"/>
</g>
<!-- layer10_ffn_ar -->
<g id="node280" class="node">
<title>layer10_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1200.5" cy="-135267.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1200.5" y="-135286.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1200.5" y="-135271.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1200.5" y="-135256.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1200.5" y="-135241.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_ffn_down_0&#45;&gt;layer10_ffn_ar -->
<g id="edge354" class="edge">
<title>layer10_ffn_down_0&#45;&gt;layer10_ffn_ar</title>
<path fill="none" stroke="black" d="M1130.69,-135387.62C1130.69,-135387.62 1130.69,-135317.28 1130.69,-135317.28"/>
<polygon fill="black" stroke="black" points="1134.19,-135317.28 1130.69,-135307.28 1127.19,-135317.28 1134.19,-135317.28"/>
</g>
<!-- layer10_ffn_down_1&#45;&gt;layer10_ffn_ar -->
<g id="edge355" class="edge">
<title>layer10_ffn_down_1&#45;&gt;layer10_ffn_ar</title>
<path fill="none" stroke="black" d="M1271.31,-135387.62C1271.31,-135387.62 1271.31,-135317 1271.31,-135317"/>
<polygon fill="black" stroke="black" points="1274.81,-135317 1271.31,-135307 1267.81,-135317 1274.81,-135317"/>
</g>
<!-- layer11_norm_0 -->
<g id="node281" class="node">
<title>layer11_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1182.5,-135147.65 1010.5,-135147.65 1010.5,-135079.65 1182.5,-135079.65 1182.5,-135147.65"/>
<text text-anchor="middle" x="1096.5" y="-135132.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1096.5" y="-135117.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1096.5" y="-135102.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1096.5" y="-135087.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_ffn_ar&#45;&gt;layer11_norm_0 -->
<g id="edge356" class="edge">
<title>layer10_ffn_ar&#45;&gt;layer11_norm_0</title>
<path fill="none" stroke="black" d="M1130.69,-135228.06C1130.69,-135228.06 1130.69,-135157.71 1130.69,-135157.71"/>
<polygon fill="black" stroke="black" points="1134.19,-135157.71 1130.69,-135147.71 1127.19,-135157.71 1134.19,-135157.71"/>
</g>
<!-- layer11_norm_1 -->
<g id="node282" class="node">
<title>layer11_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1392.5,-135147.65 1220.5,-135147.65 1220.5,-135079.65 1392.5,-135079.65 1392.5,-135147.65"/>
<text text-anchor="middle" x="1306.5" y="-135132.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1306.5" y="-135117.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1306.5" y="-135102.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1306.5" y="-135087.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_ffn_ar&#45;&gt;layer11_norm_1 -->
<g id="edge357" class="edge">
<title>layer10_ffn_ar&#45;&gt;layer11_norm_1</title>
<path fill="none" stroke="black" d="M1271.31,-135228.46C1271.31,-135228.46 1271.31,-135157.88 1271.31,-135157.88"/>
<polygon fill="black" stroke="black" points="1274.81,-135157.88 1271.31,-135147.88 1267.81,-135157.88 1274.81,-135157.88"/>
</g>
<!-- layer11_qkv_0 -->
<g id="node283" class="node">
<title>layer11_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1183,-135007.65 1002,-135007.65 1002,-134939.65 1183,-134939.65 1183,-135007.65"/>
<text text-anchor="middle" x="1092.5" y="-134992.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1092.5" y="-134977.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1092.5" y="-134962.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1092.5" y="-134947.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer11_norm_0&#45;&gt;layer11_qkv_0 -->
<g id="edge358" class="edge">
<title>layer11_norm_0&#45;&gt;layer11_qkv_0</title>
<path fill="none" stroke="black" d="M1096.5,-135079.4C1096.5,-135079.4 1096.5,-135018.03 1096.5,-135018.03"/>
<polygon fill="black" stroke="black" points="1100,-135018.03 1096.5,-135008.03 1093,-135018.03 1100,-135018.03"/>
</g>
<!-- layer11_qkv_1 -->
<g id="node284" class="node">
<title>layer11_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1400,-135007.65 1219,-135007.65 1219,-134939.65 1400,-134939.65 1400,-135007.65"/>
<text text-anchor="middle" x="1309.5" y="-134992.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1309.5" y="-134977.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1309.5" y="-134962.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1309.5" y="-134947.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer11_norm_1&#45;&gt;layer11_qkv_1 -->
<g id="edge359" class="edge">
<title>layer11_norm_1&#45;&gt;layer11_qkv_1</title>
<path fill="none" stroke="black" d="M1306.5,-135079.4C1306.5,-135079.4 1306.5,-135018.03 1306.5,-135018.03"/>
<polygon fill="black" stroke="black" points="1310,-135018.03 1306.5,-135008.03 1303,-135018.03 1310,-135018.03"/>
</g>
<!-- layer11_qkv_ar -->
<g id="node285" class="node">
<title>layer11_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1201.5" cy="-134819.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1201.5" y="-134838.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1201.5" y="-134823.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1201.5" y="-134808.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1201.5" y="-134793.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer11_qkv_0&#45;&gt;layer11_qkv_ar -->
<g id="edge360" class="edge">
<title>layer11_qkv_0&#45;&gt;layer11_qkv_ar</title>
<path fill="none" stroke="black" d="M1128.26,-134939.46C1128.26,-134939.46 1128.26,-134869.11 1128.26,-134869.11"/>
<polygon fill="black" stroke="black" points="1131.76,-134869.11 1128.26,-134859.11 1124.76,-134869.11 1131.76,-134869.11"/>
</g>
<!-- layer11_qkv_1&#45;&gt;layer11_qkv_ar -->
<g id="edge361" class="edge">
<title>layer11_qkv_1&#45;&gt;layer11_qkv_ar</title>
<path fill="none" stroke="black" d="M1274.24,-134939.46C1274.24,-134939.46 1274.24,-134869.39 1274.24,-134869.39"/>
<polygon fill="black" stroke="black" points="1277.74,-134869.39 1274.24,-134859.39 1270.74,-134869.39 1277.74,-134869.39"/>
</g>
<!-- layer11_attn_0 -->
<g id="node286" class="node">
<title>layer11_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1183.5,-134699.49 1011.5,-134699.49 1011.5,-134631.49 1183.5,-134631.49 1183.5,-134699.49"/>
<text text-anchor="middle" x="1097.5" y="-134684.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1097.5" y="-134669.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1097.5" y="-134654.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1097.5" y="-134639.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer11_qkv_ar&#45;&gt;layer11_attn_0 -->
<g id="edge362" class="edge">
<title>layer11_qkv_ar&#45;&gt;layer11_attn_0</title>
<path fill="none" stroke="black" d="M1128.51,-134779.89C1128.51,-134779.89 1128.51,-134709.54 1128.51,-134709.54"/>
<polygon fill="black" stroke="black" points="1132.01,-134709.54 1128.51,-134699.54 1125.01,-134709.54 1132.01,-134709.54"/>
</g>
<!-- layer11_attn_1 -->
<g id="node287" class="node">
<title>layer11_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1391.5,-134699.49 1219.5,-134699.49 1219.5,-134631.49 1391.5,-134631.49 1391.5,-134699.49"/>
<text text-anchor="middle" x="1305.5" y="-134684.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1305.5" y="-134669.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1305.5" y="-134654.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1305.5" y="-134639.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer11_qkv_ar&#45;&gt;layer11_attn_1 -->
<g id="edge363" class="edge">
<title>layer11_qkv_ar&#45;&gt;layer11_attn_1</title>
<path fill="none" stroke="black" d="M1274.49,-134779.89C1274.49,-134779.89 1274.49,-134709.54 1274.49,-134709.54"/>
<polygon fill="black" stroke="black" points="1277.99,-134709.54 1274.49,-134699.54 1270.99,-134709.54 1277.99,-134709.54"/>
</g>
<!-- layer11_attn_out_0 -->
<g id="node288" class="node">
<title>layer11_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1183.5,-134559.49 1011.5,-134559.49 1011.5,-134491.49 1183.5,-134491.49 1183.5,-134559.49"/>
<text text-anchor="middle" x="1097.5" y="-134544.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1097.5" y="-134529.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1097.5" y="-134514.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1097.5" y="-134499.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer11_attn_0&#45;&gt;layer11_attn_out_0 -->
<g id="edge364" class="edge">
<title>layer11_attn_0&#45;&gt;layer11_attn_out_0</title>
<path fill="none" stroke="black" d="M1097.5,-134631.24C1097.5,-134631.24 1097.5,-134569.87 1097.5,-134569.87"/>
<polygon fill="black" stroke="black" points="1101,-134569.87 1097.5,-134559.87 1094,-134569.87 1101,-134569.87"/>
</g>
<!-- layer11_attn_out_1 -->
<g id="node289" class="node">
<title>layer11_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1391.5,-134559.49 1219.5,-134559.49 1219.5,-134491.49 1391.5,-134491.49 1391.5,-134559.49"/>
<text text-anchor="middle" x="1305.5" y="-134544.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1305.5" y="-134529.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1305.5" y="-134514.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1305.5" y="-134499.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer11_attn_1&#45;&gt;layer11_attn_out_1 -->
<g id="edge365" class="edge">
<title>layer11_attn_1&#45;&gt;layer11_attn_out_1</title>
<path fill="none" stroke="black" d="M1305.5,-134631.24C1305.5,-134631.24 1305.5,-134569.87 1305.5,-134569.87"/>
<polygon fill="black" stroke="black" points="1309,-134569.87 1305.5,-134559.87 1302,-134569.87 1309,-134569.87"/>
</g>
<!-- layer11_attn_ar -->
<g id="node290" class="node">
<title>layer11_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1201.5" cy="-134371.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1201.5" y="-134390.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1201.5" y="-134375.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1201.5" y="-134360.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1201.5" y="-134345.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_attn_out_0&#45;&gt;layer11_attn_ar -->
<g id="edge366" class="edge">
<title>layer11_attn_out_0&#45;&gt;layer11_attn_ar</title>
<path fill="none" stroke="black" d="M1131.69,-134491.29C1131.69,-134491.29 1131.69,-134420.95 1131.69,-134420.95"/>
<polygon fill="black" stroke="black" points="1135.19,-134420.95 1131.69,-134410.95 1128.19,-134420.95 1135.19,-134420.95"/>
</g>
<!-- layer11_attn_out_1&#45;&gt;layer11_attn_ar -->
<g id="edge367" class="edge">
<title>layer11_attn_out_1&#45;&gt;layer11_attn_ar</title>
<path fill="none" stroke="black" d="M1271.31,-134491.29C1271.31,-134491.29 1271.31,-134420.95 1271.31,-134420.95"/>
<polygon fill="black" stroke="black" points="1274.81,-134420.95 1271.31,-134410.95 1267.81,-134420.95 1274.81,-134420.95"/>
</g>
<!-- layer11_ffn_norm_0 -->
<g id="node291" class="node">
<title>layer11_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1179.5,-134251.32 1007.5,-134251.32 1007.5,-134183.32 1179.5,-134183.32 1179.5,-134251.32"/>
<text text-anchor="middle" x="1093.5" y="-134236.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1093.5" y="-134221.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1093.5" y="-134206.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1093.5" y="-134191.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_attn_ar&#45;&gt;layer11_ffn_norm_0 -->
<g id="edge368" class="edge">
<title>layer11_attn_ar&#45;&gt;layer11_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1129.69,-134332.52C1129.69,-134332.52 1129.69,-134261.47 1129.69,-134261.47"/>
<polygon fill="black" stroke="black" points="1133.19,-134261.47 1129.69,-134251.47 1126.19,-134261.47 1133.19,-134261.47"/>
</g>
<!-- layer11_ffn_norm_1 -->
<g id="node292" class="node">
<title>layer11_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1396.5,-134251.32 1224.5,-134251.32 1224.5,-134183.32 1396.5,-134183.32 1396.5,-134251.32"/>
<text text-anchor="middle" x="1310.5" y="-134236.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1310.5" y="-134221.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1310.5" y="-134206.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1310.5" y="-134191.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_attn_ar&#45;&gt;layer11_ffn_norm_1 -->
<g id="edge369" class="edge">
<title>layer11_attn_ar&#45;&gt;layer11_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1273.81,-134332.52C1273.81,-134332.52 1273.81,-134261.47 1273.81,-134261.47"/>
<polygon fill="black" stroke="black" points="1277.31,-134261.47 1273.81,-134251.47 1270.31,-134261.47 1277.31,-134261.47"/>
</g>
<!-- layer11_ffn_gate_0 -->
<g id="node293" class="node">
<title>layer11_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1184,-134111.32 1003,-134111.32 1003,-134043.32 1184,-134043.32 1184,-134111.32"/>
<text text-anchor="middle" x="1093.5" y="-134096.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1093.5" y="-134081.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1093.5" y="-134066.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1093.5" y="-134051.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_ffn_norm_0&#45;&gt;layer11_ffn_gate_0 -->
<g id="edge370" class="edge">
<title>layer11_ffn_norm_0&#45;&gt;layer11_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1093.5,-134183.07C1093.5,-134183.07 1093.5,-134121.7 1093.5,-134121.7"/>
<polygon fill="black" stroke="black" points="1097,-134121.7 1093.5,-134111.7 1090,-134121.7 1097,-134121.7"/>
</g>
<!-- layer11_ffn_up_0 -->
<g id="node295" class="node">
<title>layer11_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="967,-134111.32 786,-134111.32 786,-134043.32 967,-134043.32 967,-134111.32"/>
<text text-anchor="middle" x="876.5" y="-134096.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="876.5" y="-134081.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="876.5" y="-134066.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="876.5" y="-134051.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_ffn_norm_0&#45;&gt;layer11_ffn_up_0 -->
<g id="edge372" class="edge">
<title>layer11_ffn_norm_0&#45;&gt;layer11_ffn_up_0</title>
<path fill="none" stroke="black" d="M1007.05,-134217C967.48,-134217 929.26,-134217 929.26,-134217 929.26,-134217 929.26,-134121.49 929.26,-134121.49"/>
<polygon fill="black" stroke="black" points="932.76,-134121.49 929.26,-134111.49 925.76,-134121.49 932.76,-134121.49"/>
</g>
<!-- layer11_ffn_gate_1 -->
<g id="node294" class="node">
<title>layer11_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1618,-134111.32 1437,-134111.32 1437,-134043.32 1618,-134043.32 1618,-134111.32"/>
<text text-anchor="middle" x="1527.5" y="-134096.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1527.5" y="-134081.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1527.5" y="-134066.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1527.5" y="-134051.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_ffn_norm_1&#45;&gt;layer11_ffn_gate_1 -->
<g id="edge371" class="edge">
<title>layer11_ffn_norm_1&#45;&gt;layer11_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1396.77,-134217C1435.87,-134217 1473.5,-134217 1473.5,-134217 1473.5,-134217 1473.5,-134121.49 1473.5,-134121.49"/>
<polygon fill="black" stroke="black" points="1477,-134121.49 1473.5,-134111.49 1470,-134121.49 1477,-134121.49"/>
</g>
<!-- layer11_ffn_up_1 -->
<g id="node296" class="node">
<title>layer11_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1401,-134111.32 1220,-134111.32 1220,-134043.32 1401,-134043.32 1401,-134111.32"/>
<text text-anchor="middle" x="1310.5" y="-134096.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1310.5" y="-134081.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1310.5" y="-134066.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1310.5" y="-134051.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_ffn_norm_1&#45;&gt;layer11_ffn_up_1 -->
<g id="edge373" class="edge">
<title>layer11_ffn_norm_1&#45;&gt;layer11_ffn_up_1</title>
<path fill="none" stroke="black" d="M1310.5,-134183.07C1310.5,-134183.07 1310.5,-134121.7 1310.5,-134121.7"/>
<polygon fill="black" stroke="black" points="1314,-134121.7 1310.5,-134111.7 1307,-134121.7 1314,-134121.7"/>
</g>
<!-- layer11_gate_ar -->
<g id="node297" class="node">
<title>layer11_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1401.5" cy="-133923.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1401.5" y="-133942.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1401.5" y="-133927.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1401.5" y="-133912.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1401.5" y="-133897.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer11_ffn_gate_0&#45;&gt;layer11_gate_ar -->
<g id="edge374" class="edge">
<title>layer11_ffn_gate_0&#45;&gt;layer11_gate_ar</title>
<path fill="none" stroke="black" d="M1184.08,-134077C1194.79,-134077 1202,-134077 1202,-134077 1202,-134077 1202,-133939 1202,-133939 1202,-133939 1270.56,-133939 1270.56,-133939"/>
<polygon fill="black" stroke="black" points="1270.56,-133942.5 1280.56,-133939 1270.56,-133935.5 1270.56,-133942.5"/>
</g>
<!-- layer11_ffn_gate_1&#45;&gt;layer11_gate_ar -->
<g id="edge375" class="edge">
<title>layer11_ffn_gate_1&#45;&gt;layer11_gate_ar</title>
<path fill="none" stroke="black" d="M1483.24,-134043.12C1483.24,-134043.12 1483.24,-133970.3 1483.24,-133970.3"/>
<polygon fill="black" stroke="black" points="1486.74,-133970.3 1483.24,-133960.3 1479.74,-133970.3 1486.74,-133970.3"/>
</g>
<!-- layer11_up_ar -->
<g id="node298" class="node">
<title>layer11_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1055.5" cy="-133923.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1055.5" y="-133942.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1055.5" y="-133927.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1055.5" y="-133912.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1055.5" y="-133897.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer11_ffn_up_0&#45;&gt;layer11_up_ar -->
<g id="edge376" class="edge">
<title>layer11_ffn_up_0&#45;&gt;layer11_up_ar</title>
<path fill="none" stroke="black" d="M947.26,-134043.12C947.26,-134043.12 947.26,-133959.2 947.26,-133959.2"/>
<polygon fill="black" stroke="black" points="950.76,-133959.2 947.26,-133949.2 943.76,-133959.2 950.76,-133959.2"/>
</g>
<!-- layer11_ffn_up_1&#45;&gt;layer11_up_ar -->
<g id="edge377" class="edge">
<title>layer11_ffn_up_1&#45;&gt;layer11_up_ar</title>
<path fill="none" stroke="black" d="M1246.76,-134043.26C1246.76,-133993.56 1246.76,-133907 1246.76,-133907 1246.76,-133907 1186.08,-133907 1186.08,-133907"/>
<polygon fill="black" stroke="black" points="1186.08,-133903.5 1176.08,-133907 1186.08,-133910.5 1186.08,-133903.5"/>
</g>
<!-- layer11_silu_0 -->
<g id="node299" class="node">
<title>layer11_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1329,-133803.15 1148,-133803.15 1148,-133735.15 1329,-133735.15 1329,-133803.15"/>
<text text-anchor="middle" x="1238.5" y="-133787.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1238.5" y="-133772.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1238.5" y="-133757.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1238.5" y="-133742.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_gate_ar&#45;&gt;layer11_silu_0 -->
<g id="edge378" class="edge">
<title>layer11_gate_ar&#45;&gt;layer11_silu_0</title>
<path fill="none" stroke="black" d="M1301.26,-133893.16C1301.26,-133893.16 1301.26,-133813.18 1301.26,-133813.18"/>
<polygon fill="black" stroke="black" points="1304.76,-133813.18 1301.26,-133803.18 1297.76,-133813.18 1304.76,-133813.18"/>
</g>
<!-- layer11_silu_1 -->
<g id="node300" class="node">
<title>layer11_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1546,-133803.15 1365,-133803.15 1365,-133735.15 1546,-133735.15 1546,-133803.15"/>
<text text-anchor="middle" x="1455.5" y="-133787.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1455.5" y="-133772.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1455.5" y="-133757.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1455.5" y="-133742.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_gate_ar&#45;&gt;layer11_silu_1 -->
<g id="edge379" class="edge">
<title>layer11_gate_ar&#45;&gt;layer11_silu_1</title>
<path fill="none" stroke="black" d="M1447.24,-133878.25C1447.24,-133878.25 1447.24,-133813.16 1447.24,-133813.16"/>
<polygon fill="black" stroke="black" points="1450.74,-133813.16 1447.24,-133803.16 1443.74,-133813.16 1450.74,-133813.16"/>
</g>
<!-- layer11_mul_0 -->
<g id="node301" class="node">
<title>layer11_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1219,-133663.15 1038,-133663.15 1038,-133595.15 1219,-133595.15 1219,-133663.15"/>
<text text-anchor="middle" x="1128.5" y="-133647.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1128.5" y="-133632.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1128.5" y="-133617.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1128.5" y="-133602.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_up_ar&#45;&gt;layer11_mul_0 -->
<g id="edge381" class="edge">
<title>layer11_up_ar&#45;&gt;layer11_mul_0</title>
<path fill="none" stroke="black" d="M1093,-133876.96C1093,-133876.96 1093,-133673.24 1093,-133673.24"/>
<polygon fill="black" stroke="black" points="1096.5,-133673.24 1093,-133663.24 1089.5,-133673.24 1096.5,-133673.24"/>
</g>
<!-- layer11_mul_1 -->
<g id="node302" class="node">
<title>layer11_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1436,-133663.15 1255,-133663.15 1255,-133595.15 1436,-133595.15 1436,-133663.15"/>
<text text-anchor="middle" x="1345.5" y="-133647.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1345.5" y="-133632.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1345.5" y="-133617.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1345.5" y="-133602.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer11_up_ar&#45;&gt;layer11_mul_1 -->
<g id="edge383" class="edge">
<title>layer11_up_ar&#45;&gt;layer11_mul_1</title>
<path fill="none" stroke="black" d="M1165.74,-133898.42C1165.74,-133873.57 1165.74,-133839 1165.74,-133839 1165.74,-133839 1347,-133839 1347,-133839 1347,-133839 1347,-133673.34 1347,-133673.34"/>
<polygon fill="black" stroke="black" points="1350.5,-133673.34 1347,-133663.34 1343.5,-133673.34 1350.5,-133673.34"/>
</g>
<!-- layer11_silu_0&#45;&gt;layer11_mul_0 -->
<g id="edge380" class="edge">
<title>layer11_silu_0&#45;&gt;layer11_mul_0</title>
<path fill="none" stroke="black" d="M1183.5,-133734.91C1183.5,-133734.91 1183.5,-133673.53 1183.5,-133673.53"/>
<polygon fill="black" stroke="black" points="1187,-133673.53 1183.5,-133663.53 1180,-133673.53 1187,-133673.53"/>
</g>
<!-- layer11_silu_1&#45;&gt;layer11_mul_1 -->
<g id="edge382" class="edge">
<title>layer11_silu_1&#45;&gt;layer11_mul_1</title>
<path fill="none" stroke="black" d="M1400.5,-133734.91C1400.5,-133734.91 1400.5,-133673.53 1400.5,-133673.53"/>
<polygon fill="black" stroke="black" points="1404,-133673.53 1400.5,-133663.53 1397,-133673.53 1404,-133673.53"/>
</g>
<!-- layer11_ffn_down_0 -->
<g id="node303" class="node">
<title>layer11_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1218.5,-133523.15 1046.5,-133523.15 1046.5,-133455.15 1218.5,-133455.15 1218.5,-133523.15"/>
<text text-anchor="middle" x="1132.5" y="-133507.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1132.5" y="-133492.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1132.5" y="-133477.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1132.5" y="-133462.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer11_mul_0&#45;&gt;layer11_ffn_down_0 -->
<g id="edge384" class="edge">
<title>layer11_mul_0&#45;&gt;layer11_ffn_down_0</title>
<path fill="none" stroke="black" d="M1132.5,-133594.91C1132.5,-133594.91 1132.5,-133533.53 1132.5,-133533.53"/>
<polygon fill="black" stroke="black" points="1136,-133533.53 1132.5,-133523.53 1129,-133533.53 1136,-133533.53"/>
</g>
<!-- layer11_ffn_down_1 -->
<g id="node304" class="node">
<title>layer11_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1428.5,-133523.15 1256.5,-133523.15 1256.5,-133455.15 1428.5,-133455.15 1428.5,-133523.15"/>
<text text-anchor="middle" x="1342.5" y="-133507.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1342.5" y="-133492.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1342.5" y="-133477.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1342.5" y="-133462.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer11_mul_1&#45;&gt;layer11_ffn_down_1 -->
<g id="edge385" class="edge">
<title>layer11_mul_1&#45;&gt;layer11_ffn_down_1</title>
<path fill="none" stroke="black" d="M1342.5,-133594.91C1342.5,-133594.91 1342.5,-133533.53 1342.5,-133533.53"/>
<polygon fill="black" stroke="black" points="1346,-133533.53 1342.5,-133523.53 1339,-133533.53 1346,-133533.53"/>
</g>
<!-- layer11_ffn_ar -->
<g id="node305" class="node">
<title>layer11_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1236.5" cy="-133335.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1236.5" y="-133353.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1236.5" y="-133338.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1236.5" y="-133323.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1236.5" y="-133308.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_ffn_down_0&#45;&gt;layer11_ffn_ar -->
<g id="edge386" class="edge">
<title>layer11_ffn_down_0&#45;&gt;layer11_ffn_ar</title>
<path fill="none" stroke="black" d="M1166.69,-133454.96C1166.69,-133454.96 1166.69,-133384.61 1166.69,-133384.61"/>
<polygon fill="black" stroke="black" points="1170.19,-133384.61 1166.69,-133374.61 1163.19,-133384.61 1170.19,-133384.61"/>
</g>
<!-- layer11_ffn_down_1&#45;&gt;layer11_ffn_ar -->
<g id="edge387" class="edge">
<title>layer11_ffn_down_1&#45;&gt;layer11_ffn_ar</title>
<path fill="none" stroke="black" d="M1307.31,-133454.96C1307.31,-133454.96 1307.31,-133384.33 1307.31,-133384.33"/>
<polygon fill="black" stroke="black" points="1310.81,-133384.33 1307.31,-133374.33 1303.81,-133384.33 1310.81,-133384.33"/>
</g>
<!-- layer12_norm_0 -->
<g id="node306" class="node">
<title>layer12_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1218.5,-133214.99 1046.5,-133214.99 1046.5,-133146.99 1218.5,-133146.99 1218.5,-133214.99"/>
<text text-anchor="middle" x="1132.5" y="-133199.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1132.5" y="-133184.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1132.5" y="-133169.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1132.5" y="-133154.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_ffn_ar&#45;&gt;layer12_norm_0 -->
<g id="edge388" class="edge">
<title>layer11_ffn_ar&#45;&gt;layer12_norm_0</title>
<path fill="none" stroke="black" d="M1166.69,-133295.39C1166.69,-133295.39 1166.69,-133225.04 1166.69,-133225.04"/>
<polygon fill="black" stroke="black" points="1170.19,-133225.04 1166.69,-133215.04 1163.19,-133225.04 1170.19,-133225.04"/>
</g>
<!-- layer12_norm_1 -->
<g id="node307" class="node">
<title>layer12_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1428.5,-133214.99 1256.5,-133214.99 1256.5,-133146.99 1428.5,-133146.99 1428.5,-133214.99"/>
<text text-anchor="middle" x="1342.5" y="-133199.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1342.5" y="-133184.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1342.5" y="-133169.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1342.5" y="-133154.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_ffn_ar&#45;&gt;layer12_norm_1 -->
<g id="edge389" class="edge">
<title>layer11_ffn_ar&#45;&gt;layer12_norm_1</title>
<path fill="none" stroke="black" d="M1307.31,-133295.79C1307.31,-133295.79 1307.31,-133225.22 1307.31,-133225.22"/>
<polygon fill="black" stroke="black" points="1310.81,-133225.22 1307.31,-133215.22 1303.81,-133225.22 1310.81,-133225.22"/>
</g>
<!-- layer12_qkv_0 -->
<g id="node308" class="node">
<title>layer12_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1219,-133074.99 1038,-133074.99 1038,-133006.99 1219,-133006.99 1219,-133074.99"/>
<text text-anchor="middle" x="1128.5" y="-133059.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1128.5" y="-133044.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1128.5" y="-133029.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1128.5" y="-133014.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer12_norm_0&#45;&gt;layer12_qkv_0 -->
<g id="edge390" class="edge">
<title>layer12_norm_0&#45;&gt;layer12_qkv_0</title>
<path fill="none" stroke="black" d="M1132.5,-133146.74C1132.5,-133146.74 1132.5,-133085.37 1132.5,-133085.37"/>
<polygon fill="black" stroke="black" points="1136,-133085.37 1132.5,-133075.37 1129,-133085.37 1136,-133085.37"/>
</g>
<!-- layer12_qkv_1 -->
<g id="node309" class="node">
<title>layer12_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1436,-133074.99 1255,-133074.99 1255,-133006.99 1436,-133006.99 1436,-133074.99"/>
<text text-anchor="middle" x="1345.5" y="-133059.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1345.5" y="-133044.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1345.5" y="-133029.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1345.5" y="-133014.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer12_norm_1&#45;&gt;layer12_qkv_1 -->
<g id="edge391" class="edge">
<title>layer12_norm_1&#45;&gt;layer12_qkv_1</title>
<path fill="none" stroke="black" d="M1342.5,-133146.74C1342.5,-133146.74 1342.5,-133085.37 1342.5,-133085.37"/>
<polygon fill="black" stroke="black" points="1346,-133085.37 1342.5,-133075.37 1339,-133085.37 1346,-133085.37"/>
</g>
<!-- layer12_qkv_ar -->
<g id="node310" class="node">
<title>layer12_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1236.5" cy="-132886.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1236.5" y="-132905.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1236.5" y="-132890.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1236.5" y="-132875.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1236.5" y="-132860.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer12_qkv_0&#45;&gt;layer12_qkv_ar -->
<g id="edge392" class="edge">
<title>layer12_qkv_0&#45;&gt;layer12_qkv_ar</title>
<path fill="none" stroke="black" d="M1163.76,-133006.79C1163.76,-133006.79 1163.76,-132936.72 1163.76,-132936.72"/>
<polygon fill="black" stroke="black" points="1167.26,-132936.72 1163.76,-132926.72 1160.26,-132936.72 1167.26,-132936.72"/>
</g>
<!-- layer12_qkv_1&#45;&gt;layer12_qkv_ar -->
<g id="edge393" class="edge">
<title>layer12_qkv_1&#45;&gt;layer12_qkv_ar</title>
<path fill="none" stroke="black" d="M1309.74,-133006.79C1309.74,-133006.79 1309.74,-132936.45 1309.74,-132936.45"/>
<polygon fill="black" stroke="black" points="1313.24,-132936.45 1309.74,-132926.45 1306.24,-132936.45 1313.24,-132936.45"/>
</g>
<!-- layer12_attn_0 -->
<g id="node311" class="node">
<title>layer12_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1218.5,-132766.82 1046.5,-132766.82 1046.5,-132698.82 1218.5,-132698.82 1218.5,-132766.82"/>
<text text-anchor="middle" x="1132.5" y="-132751.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1132.5" y="-132736.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1132.5" y="-132721.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1132.5" y="-132706.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer12_qkv_ar&#45;&gt;layer12_attn_0 -->
<g id="edge394" class="edge">
<title>layer12_qkv_ar&#45;&gt;layer12_attn_0</title>
<path fill="none" stroke="black" d="M1163.51,-132847.22C1163.51,-132847.22 1163.51,-132776.88 1163.51,-132776.88"/>
<polygon fill="black" stroke="black" points="1167.01,-132776.88 1163.51,-132766.88 1160.01,-132776.88 1167.01,-132776.88"/>
</g>
<!-- layer12_attn_1 -->
<g id="node312" class="node">
<title>layer12_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1426.5,-132766.82 1254.5,-132766.82 1254.5,-132698.82 1426.5,-132698.82 1426.5,-132766.82"/>
<text text-anchor="middle" x="1340.5" y="-132751.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1340.5" y="-132736.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1340.5" y="-132721.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1340.5" y="-132706.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer12_qkv_ar&#45;&gt;layer12_attn_1 -->
<g id="edge395" class="edge">
<title>layer12_qkv_ar&#45;&gt;layer12_attn_1</title>
<path fill="none" stroke="black" d="M1309.49,-132847.22C1309.49,-132847.22 1309.49,-132776.88 1309.49,-132776.88"/>
<polygon fill="black" stroke="black" points="1312.99,-132776.88 1309.49,-132766.88 1305.99,-132776.88 1312.99,-132776.88"/>
</g>
<!-- layer12_attn_out_0 -->
<g id="node313" class="node">
<title>layer12_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1218.5,-132626.82 1046.5,-132626.82 1046.5,-132558.82 1218.5,-132558.82 1218.5,-132626.82"/>
<text text-anchor="middle" x="1132.5" y="-132611.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1132.5" y="-132596.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1132.5" y="-132581.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1132.5" y="-132566.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer12_attn_0&#45;&gt;layer12_attn_out_0 -->
<g id="edge396" class="edge">
<title>layer12_attn_0&#45;&gt;layer12_attn_out_0</title>
<path fill="none" stroke="black" d="M1132.5,-132698.57C1132.5,-132698.57 1132.5,-132637.2 1132.5,-132637.2"/>
<polygon fill="black" stroke="black" points="1136,-132637.2 1132.5,-132627.2 1129,-132637.2 1136,-132637.2"/>
</g>
<!-- layer12_attn_out_1 -->
<g id="node314" class="node">
<title>layer12_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1426.5,-132626.82 1254.5,-132626.82 1254.5,-132558.82 1426.5,-132558.82 1426.5,-132626.82"/>
<text text-anchor="middle" x="1340.5" y="-132611.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1340.5" y="-132596.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1340.5" y="-132581.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1340.5" y="-132566.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer12_attn_1&#45;&gt;layer12_attn_out_1 -->
<g id="edge397" class="edge">
<title>layer12_attn_1&#45;&gt;layer12_attn_out_1</title>
<path fill="none" stroke="black" d="M1340.5,-132698.57C1340.5,-132698.57 1340.5,-132637.2 1340.5,-132637.2"/>
<polygon fill="black" stroke="black" points="1344,-132637.2 1340.5,-132627.2 1337,-132637.2 1344,-132637.2"/>
</g>
<!-- layer12_attn_ar -->
<g id="node315" class="node">
<title>layer12_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1236.5" cy="-132438.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1236.5" y="-132457.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1236.5" y="-132442.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1236.5" y="-132427.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1236.5" y="-132412.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_attn_out_0&#45;&gt;layer12_attn_ar -->
<g id="edge398" class="edge">
<title>layer12_attn_out_0&#45;&gt;layer12_attn_ar</title>
<path fill="none" stroke="black" d="M1166.69,-132558.62C1166.69,-132558.62 1166.69,-132488.28 1166.69,-132488.28"/>
<polygon fill="black" stroke="black" points="1170.19,-132488.28 1166.69,-132478.28 1163.19,-132488.28 1170.19,-132488.28"/>
</g>
<!-- layer12_attn_out_1&#45;&gt;layer12_attn_ar -->
<g id="edge399" class="edge">
<title>layer12_attn_out_1&#45;&gt;layer12_attn_ar</title>
<path fill="none" stroke="black" d="M1306.31,-132558.62C1306.31,-132558.62 1306.31,-132488.28 1306.31,-132488.28"/>
<polygon fill="black" stroke="black" points="1309.81,-132488.28 1306.31,-132478.28 1302.81,-132488.28 1309.81,-132488.28"/>
</g>
<!-- layer12_ffn_norm_0 -->
<g id="node316" class="node">
<title>layer12_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1214.5,-132318.65 1042.5,-132318.65 1042.5,-132250.65 1214.5,-132250.65 1214.5,-132318.65"/>
<text text-anchor="middle" x="1128.5" y="-132303.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1128.5" y="-132288.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1128.5" y="-132273.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1128.5" y="-132258.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_attn_ar&#45;&gt;layer12_ffn_norm_0 -->
<g id="edge400" class="edge">
<title>layer12_attn_ar&#45;&gt;layer12_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1164.69,-132399.86C1164.69,-132399.86 1164.69,-132328.8 1164.69,-132328.8"/>
<polygon fill="black" stroke="black" points="1168.19,-132328.8 1164.69,-132318.8 1161.19,-132328.8 1168.19,-132328.8"/>
</g>
<!-- layer12_ffn_norm_1 -->
<g id="node317" class="node">
<title>layer12_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1431.5,-132318.65 1259.5,-132318.65 1259.5,-132250.65 1431.5,-132250.65 1431.5,-132318.65"/>
<text text-anchor="middle" x="1345.5" y="-132303.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1345.5" y="-132288.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1345.5" y="-132273.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1345.5" y="-132258.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_attn_ar&#45;&gt;layer12_ffn_norm_1 -->
<g id="edge401" class="edge">
<title>layer12_attn_ar&#45;&gt;layer12_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1308.81,-132399.86C1308.81,-132399.86 1308.81,-132328.8 1308.81,-132328.8"/>
<polygon fill="black" stroke="black" points="1312.31,-132328.8 1308.81,-132318.8 1305.31,-132328.8 1312.31,-132328.8"/>
</g>
<!-- layer12_ffn_gate_0 -->
<g id="node318" class="node">
<title>layer12_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1219,-132178.65 1038,-132178.65 1038,-132110.65 1219,-132110.65 1219,-132178.65"/>
<text text-anchor="middle" x="1128.5" y="-132163.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1128.5" y="-132148.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1128.5" y="-132133.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1128.5" y="-132118.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_ffn_norm_0&#45;&gt;layer12_ffn_gate_0 -->
<g id="edge402" class="edge">
<title>layer12_ffn_norm_0&#45;&gt;layer12_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1128.5,-132250.41C1128.5,-132250.41 1128.5,-132189.03 1128.5,-132189.03"/>
<polygon fill="black" stroke="black" points="1132,-132189.03 1128.5,-132179.03 1125,-132189.03 1132,-132189.03"/>
</g>
<!-- layer12_ffn_up_0 -->
<g id="node320" class="node">
<title>layer12_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1002,-132178.65 821,-132178.65 821,-132110.65 1002,-132110.65 1002,-132178.65"/>
<text text-anchor="middle" x="911.5" y="-132163.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="911.5" y="-132148.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="911.5" y="-132133.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="911.5" y="-132118.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_ffn_norm_0&#45;&gt;layer12_ffn_up_0 -->
<g id="edge404" class="edge">
<title>layer12_ffn_norm_0&#45;&gt;layer12_ffn_up_0</title>
<path fill="none" stroke="black" d="M1042.31,-132284C1002.86,-132284 964.76,-132284 964.76,-132284 964.76,-132284 964.76,-132188.74 964.76,-132188.74"/>
<polygon fill="black" stroke="black" points="968.26,-132188.74 964.76,-132178.74 961.26,-132188.74 968.26,-132188.74"/>
</g>
<!-- layer12_ffn_gate_1 -->
<g id="node319" class="node">
<title>layer12_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1653,-132178.65 1472,-132178.65 1472,-132110.65 1653,-132110.65 1653,-132178.65"/>
<text text-anchor="middle" x="1562.5" y="-132163.45" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1562.5" y="-132148.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1562.5" y="-132133.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1562.5" y="-132118.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_ffn_norm_1&#45;&gt;layer12_ffn_gate_1 -->
<g id="edge403" class="edge">
<title>layer12_ffn_norm_1&#45;&gt;layer12_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1431.56,-132284C1470.95,-132284 1509,-132284 1509,-132284 1509,-132284 1509,-132188.74 1509,-132188.74"/>
<polygon fill="black" stroke="black" points="1512.5,-132188.74 1509,-132178.74 1505.5,-132188.74 1512.5,-132188.74"/>
</g>
<!-- layer12_ffn_up_1 -->
<g id="node321" class="node">
<title>layer12_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1436,-132178.65 1255,-132178.65 1255,-132110.65 1436,-132110.65 1436,-132178.65"/>
<text text-anchor="middle" x="1345.5" y="-132163.45" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1345.5" y="-132148.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1345.5" y="-132133.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1345.5" y="-132118.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_ffn_norm_1&#45;&gt;layer12_ffn_up_1 -->
<g id="edge405" class="edge">
<title>layer12_ffn_norm_1&#45;&gt;layer12_ffn_up_1</title>
<path fill="none" stroke="black" d="M1345.5,-132250.41C1345.5,-132250.41 1345.5,-132189.03 1345.5,-132189.03"/>
<polygon fill="black" stroke="black" points="1349,-132189.03 1345.5,-132179.03 1342,-132189.03 1349,-132189.03"/>
</g>
<!-- layer12_gate_ar -->
<g id="node322" class="node">
<title>layer12_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1436.5" cy="-131990.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1436.5" y="-132009.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1436.5" y="-131994.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1436.5" y="-131979.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1436.5" y="-131964.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer12_ffn_gate_0&#45;&gt;layer12_gate_ar -->
<g id="edge406" class="edge">
<title>layer12_ffn_gate_0&#45;&gt;layer12_gate_ar</title>
<path fill="none" stroke="black" d="M1219.08,-132144C1229.79,-132144 1237,-132144 1237,-132144 1237,-132144 1237,-132006 1237,-132006 1237,-132006 1305.28,-132006 1305.28,-132006"/>
<polygon fill="black" stroke="black" points="1305.28,-132009.5 1315.28,-132006 1305.28,-132002.5 1305.28,-132009.5"/>
</g>
<!-- layer12_ffn_gate_1&#45;&gt;layer12_gate_ar -->
<g id="edge407" class="edge">
<title>layer12_ffn_gate_1&#45;&gt;layer12_gate_ar</title>
<path fill="none" stroke="black" d="M1518.24,-132110.46C1518.24,-132110.46 1518.24,-132037.63 1518.24,-132037.63"/>
<polygon fill="black" stroke="black" points="1521.74,-132037.63 1518.24,-132027.63 1514.74,-132037.63 1521.74,-132037.63"/>
</g>
<!-- layer12_up_ar -->
<g id="node323" class="node">
<title>layer12_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1090.5" cy="-131990.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1090.5" y="-132009.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1090.5" y="-131994.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1090.5" y="-131979.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1090.5" y="-131964.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer12_ffn_up_0&#45;&gt;layer12_up_ar -->
<g id="edge408" class="edge">
<title>layer12_ffn_up_0&#45;&gt;layer12_up_ar</title>
<path fill="none" stroke="black" d="M982.26,-132110.46C982.26,-132110.46 982.26,-132026.53 982.26,-132026.53"/>
<polygon fill="black" stroke="black" points="985.76,-132026.53 982.26,-132016.53 978.76,-132026.53 985.76,-132026.53"/>
</g>
<!-- layer12_ffn_up_1&#45;&gt;layer12_up_ar -->
<g id="edge409" class="edge">
<title>layer12_ffn_up_1&#45;&gt;layer12_up_ar</title>
<path fill="none" stroke="black" d="M1281.76,-132110.53C1281.76,-132060.73 1281.76,-131974 1281.76,-131974 1281.76,-131974 1220.81,-131974 1220.81,-131974"/>
<polygon fill="black" stroke="black" points="1220.81,-131970.5 1210.81,-131974 1220.81,-131977.5 1220.81,-131970.5"/>
</g>
<!-- layer12_silu_0 -->
<g id="node324" class="node">
<title>layer12_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1364,-131870.49 1183,-131870.49 1183,-131802.49 1364,-131802.49 1364,-131870.49"/>
<text text-anchor="middle" x="1273.5" y="-131855.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1273.5" y="-131840.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1273.5" y="-131825.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1273.5" y="-131810.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_gate_ar&#45;&gt;layer12_silu_0 -->
<g id="edge410" class="edge">
<title>layer12_gate_ar&#45;&gt;layer12_silu_0</title>
<path fill="none" stroke="black" d="M1336.26,-131960.5C1336.26,-131960.5 1336.26,-131880.51 1336.26,-131880.51"/>
<polygon fill="black" stroke="black" points="1339.76,-131880.51 1336.26,-131870.51 1332.76,-131880.51 1339.76,-131880.51"/>
</g>
<!-- layer12_silu_1 -->
<g id="node325" class="node">
<title>layer12_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1581,-131870.49 1400,-131870.49 1400,-131802.49 1581,-131802.49 1581,-131870.49"/>
<text text-anchor="middle" x="1490.5" y="-131855.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1490.5" y="-131840.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1490.5" y="-131825.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1490.5" y="-131810.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_gate_ar&#45;&gt;layer12_silu_1 -->
<g id="edge411" class="edge">
<title>layer12_gate_ar&#45;&gt;layer12_silu_1</title>
<path fill="none" stroke="black" d="M1482.24,-131945.59C1482.24,-131945.59 1482.24,-131880.49 1482.24,-131880.49"/>
<polygon fill="black" stroke="black" points="1485.74,-131880.49 1482.24,-131870.49 1478.74,-131880.49 1485.74,-131880.49"/>
</g>
<!-- layer12_mul_0 -->
<g id="node326" class="node">
<title>layer12_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1254,-131730.49 1073,-131730.49 1073,-131662.49 1254,-131662.49 1254,-131730.49"/>
<text text-anchor="middle" x="1163.5" y="-131715.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1163.5" y="-131700.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1163.5" y="-131685.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1163.5" y="-131670.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_up_ar&#45;&gt;layer12_mul_0 -->
<g id="edge413" class="edge">
<title>layer12_up_ar&#45;&gt;layer12_mul_0</title>
<path fill="none" stroke="black" d="M1128,-131944.3C1128,-131944.3 1128,-131740.57 1128,-131740.57"/>
<polygon fill="black" stroke="black" points="1131.5,-131740.57 1128,-131730.57 1124.5,-131740.57 1131.5,-131740.57"/>
</g>
<!-- layer12_mul_1 -->
<g id="node327" class="node">
<title>layer12_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1471,-131730.49 1290,-131730.49 1290,-131662.49 1471,-131662.49 1471,-131730.49"/>
<text text-anchor="middle" x="1380.5" y="-131715.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1380.5" y="-131700.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1380.5" y="-131685.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1380.5" y="-131670.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer12_up_ar&#45;&gt;layer12_mul_1 -->
<g id="edge415" class="edge">
<title>layer12_up_ar&#45;&gt;layer12_mul_1</title>
<path fill="none" stroke="black" d="M1200.74,-131966.11C1200.74,-131941.13 1200.74,-131906 1200.74,-131906 1200.74,-131906 1382,-131906 1382,-131906 1382,-131906 1382,-131740.62 1382,-131740.62"/>
<polygon fill="black" stroke="black" points="1385.5,-131740.62 1382,-131730.62 1378.5,-131740.62 1385.5,-131740.62"/>
</g>
<!-- layer12_silu_0&#45;&gt;layer12_mul_0 -->
<g id="edge412" class="edge">
<title>layer12_silu_0&#45;&gt;layer12_mul_0</title>
<path fill="none" stroke="black" d="M1218.5,-131802.24C1218.5,-131802.24 1218.5,-131740.87 1218.5,-131740.87"/>
<polygon fill="black" stroke="black" points="1222,-131740.87 1218.5,-131730.87 1215,-131740.87 1222,-131740.87"/>
</g>
<!-- layer12_silu_1&#45;&gt;layer12_mul_1 -->
<g id="edge414" class="edge">
<title>layer12_silu_1&#45;&gt;layer12_mul_1</title>
<path fill="none" stroke="black" d="M1435.5,-131802.24C1435.5,-131802.24 1435.5,-131740.87 1435.5,-131740.87"/>
<polygon fill="black" stroke="black" points="1439,-131740.87 1435.5,-131730.87 1432,-131740.87 1439,-131740.87"/>
</g>
<!-- layer12_ffn_down_0 -->
<g id="node328" class="node">
<title>layer12_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1253.5,-131590.49 1081.5,-131590.49 1081.5,-131522.49 1253.5,-131522.49 1253.5,-131590.49"/>
<text text-anchor="middle" x="1167.5" y="-131575.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1167.5" y="-131560.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1167.5" y="-131545.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1167.5" y="-131530.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer12_mul_0&#45;&gt;layer12_ffn_down_0 -->
<g id="edge416" class="edge">
<title>layer12_mul_0&#45;&gt;layer12_ffn_down_0</title>
<path fill="none" stroke="black" d="M1167.5,-131662.24C1167.5,-131662.24 1167.5,-131600.87 1167.5,-131600.87"/>
<polygon fill="black" stroke="black" points="1171,-131600.87 1167.5,-131590.87 1164,-131600.87 1171,-131600.87"/>
</g>
<!-- layer12_ffn_down_1 -->
<g id="node329" class="node">
<title>layer12_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1463.5,-131590.49 1291.5,-131590.49 1291.5,-131522.49 1463.5,-131522.49 1463.5,-131590.49"/>
<text text-anchor="middle" x="1377.5" y="-131575.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1377.5" y="-131560.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1377.5" y="-131545.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1377.5" y="-131530.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer12_mul_1&#45;&gt;layer12_ffn_down_1 -->
<g id="edge417" class="edge">
<title>layer12_mul_1&#45;&gt;layer12_ffn_down_1</title>
<path fill="none" stroke="black" d="M1377.5,-131662.24C1377.5,-131662.24 1377.5,-131600.87 1377.5,-131600.87"/>
<polygon fill="black" stroke="black" points="1381,-131600.87 1377.5,-131590.87 1374,-131600.87 1381,-131600.87"/>
</g>
<!-- layer12_ffn_ar -->
<g id="node330" class="node">
<title>layer12_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1271.5" cy="-131402.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1271.5" y="-131421.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1271.5" y="-131406.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1271.5" y="-131391.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1271.5" y="-131376.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_ffn_down_0&#45;&gt;layer12_ffn_ar -->
<g id="edge418" class="edge">
<title>layer12_ffn_down_0&#45;&gt;layer12_ffn_ar</title>
<path fill="none" stroke="black" d="M1201.69,-131522.29C1201.69,-131522.29 1201.69,-131451.95 1201.69,-131451.95"/>
<polygon fill="black" stroke="black" points="1205.19,-131451.95 1201.69,-131441.95 1198.19,-131451.95 1205.19,-131451.95"/>
</g>
<!-- layer12_ffn_down_1&#45;&gt;layer12_ffn_ar -->
<g id="edge419" class="edge">
<title>layer12_ffn_down_1&#45;&gt;layer12_ffn_ar</title>
<path fill="none" stroke="black" d="M1342.31,-131522.29C1342.31,-131522.29 1342.31,-131451.67 1342.31,-131451.67"/>
<polygon fill="black" stroke="black" points="1345.81,-131451.67 1342.31,-131441.67 1338.81,-131451.67 1345.81,-131451.67"/>
</g>
<!-- layer13_norm_0 -->
<g id="node331" class="node">
<title>layer13_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1253.5,-131282.32 1081.5,-131282.32 1081.5,-131214.32 1253.5,-131214.32 1253.5,-131282.32"/>
<text text-anchor="middle" x="1167.5" y="-131267.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1167.5" y="-131252.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1167.5" y="-131237.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1167.5" y="-131222.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_ffn_ar&#45;&gt;layer13_norm_0 -->
<g id="edge420" class="edge">
<title>layer12_ffn_ar&#45;&gt;layer13_norm_0</title>
<path fill="none" stroke="black" d="M1201.69,-131362.72C1201.69,-131362.72 1201.69,-131292.38 1201.69,-131292.38"/>
<polygon fill="black" stroke="black" points="1205.19,-131292.38 1201.69,-131282.38 1198.19,-131292.38 1205.19,-131292.38"/>
</g>
<!-- layer13_norm_1 -->
<g id="node332" class="node">
<title>layer13_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1463.5,-131282.32 1291.5,-131282.32 1291.5,-131214.32 1463.5,-131214.32 1463.5,-131282.32"/>
<text text-anchor="middle" x="1377.5" y="-131267.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1377.5" y="-131252.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1377.5" y="-131237.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1377.5" y="-131222.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_ffn_ar&#45;&gt;layer13_norm_1 -->
<g id="edge421" class="edge">
<title>layer12_ffn_ar&#45;&gt;layer13_norm_1</title>
<path fill="none" stroke="black" d="M1342.31,-131363.12C1342.31,-131363.12 1342.31,-131292.55 1342.31,-131292.55"/>
<polygon fill="black" stroke="black" points="1345.81,-131292.55 1342.31,-131282.55 1338.81,-131292.55 1345.81,-131292.55"/>
</g>
<!-- layer13_qkv_0 -->
<g id="node333" class="node">
<title>layer13_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1254,-131142.32 1073,-131142.32 1073,-131074.32 1254,-131074.32 1254,-131142.32"/>
<text text-anchor="middle" x="1163.5" y="-131127.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1163.5" y="-131112.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1163.5" y="-131097.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1163.5" y="-131082.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer13_norm_0&#45;&gt;layer13_qkv_0 -->
<g id="edge422" class="edge">
<title>layer13_norm_0&#45;&gt;layer13_qkv_0</title>
<path fill="none" stroke="black" d="M1167.5,-131214.07C1167.5,-131214.07 1167.5,-131152.7 1167.5,-131152.7"/>
<polygon fill="black" stroke="black" points="1171,-131152.7 1167.5,-131142.7 1164,-131152.7 1171,-131152.7"/>
</g>
<!-- layer13_qkv_1 -->
<g id="node334" class="node">
<title>layer13_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1471,-131142.32 1290,-131142.32 1290,-131074.32 1471,-131074.32 1471,-131142.32"/>
<text text-anchor="middle" x="1380.5" y="-131127.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1380.5" y="-131112.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1380.5" y="-131097.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1380.5" y="-131082.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer13_norm_1&#45;&gt;layer13_qkv_1 -->
<g id="edge423" class="edge">
<title>layer13_norm_1&#45;&gt;layer13_qkv_1</title>
<path fill="none" stroke="black" d="M1377.5,-131214.07C1377.5,-131214.07 1377.5,-131152.7 1377.5,-131152.7"/>
<polygon fill="black" stroke="black" points="1381,-131152.7 1377.5,-131142.7 1374,-131152.7 1381,-131152.7"/>
</g>
<!-- layer13_qkv_ar -->
<g id="node335" class="node">
<title>layer13_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1271.5" cy="-130954.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1271.5" y="-130973.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1271.5" y="-130958.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1271.5" y="-130943.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1271.5" y="-130928.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer13_qkv_0&#45;&gt;layer13_qkv_ar -->
<g id="edge424" class="edge">
<title>layer13_qkv_0&#45;&gt;layer13_qkv_ar</title>
<path fill="none" stroke="black" d="M1198.76,-131074.12C1198.76,-131074.12 1198.76,-131004.06 1198.76,-131004.06"/>
<polygon fill="black" stroke="black" points="1202.26,-131004.06 1198.76,-130994.06 1195.26,-131004.06 1202.26,-131004.06"/>
</g>
<!-- layer13_qkv_1&#45;&gt;layer13_qkv_ar -->
<g id="edge425" class="edge">
<title>layer13_qkv_1&#45;&gt;layer13_qkv_ar</title>
<path fill="none" stroke="black" d="M1344.74,-131074.12C1344.74,-131074.12 1344.74,-131003.78 1344.74,-131003.78"/>
<polygon fill="black" stroke="black" points="1348.24,-131003.78 1344.74,-130993.78 1341.24,-131003.78 1348.24,-131003.78"/>
</g>
<!-- layer13_attn_0 -->
<g id="node336" class="node">
<title>layer13_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1253.5,-130834.15 1081.5,-130834.15 1081.5,-130766.15 1253.5,-130766.15 1253.5,-130834.15"/>
<text text-anchor="middle" x="1167.5" y="-130818.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1167.5" y="-130803.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1167.5" y="-130788.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1167.5" y="-130773.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer13_qkv_ar&#45;&gt;layer13_attn_0 -->
<g id="edge426" class="edge">
<title>layer13_qkv_ar&#45;&gt;layer13_attn_0</title>
<path fill="none" stroke="black" d="M1198.51,-130914.56C1198.51,-130914.56 1198.51,-130844.21 1198.51,-130844.21"/>
<polygon fill="black" stroke="black" points="1202.01,-130844.21 1198.51,-130834.21 1195.01,-130844.21 1202.01,-130844.21"/>
</g>
<!-- layer13_attn_1 -->
<g id="node337" class="node">
<title>layer13_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1461.5,-130834.15 1289.5,-130834.15 1289.5,-130766.15 1461.5,-130766.15 1461.5,-130834.15"/>
<text text-anchor="middle" x="1375.5" y="-130818.95" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1375.5" y="-130803.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1375.5" y="-130788.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1375.5" y="-130773.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer13_qkv_ar&#45;&gt;layer13_attn_1 -->
<g id="edge427" class="edge">
<title>layer13_qkv_ar&#45;&gt;layer13_attn_1</title>
<path fill="none" stroke="black" d="M1344.49,-130914.56C1344.49,-130914.56 1344.49,-130844.21 1344.49,-130844.21"/>
<polygon fill="black" stroke="black" points="1347.99,-130844.21 1344.49,-130834.21 1340.99,-130844.21 1347.99,-130844.21"/>
</g>
<!-- layer13_attn_out_0 -->
<g id="node338" class="node">
<title>layer13_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1253.5,-130694.15 1081.5,-130694.15 1081.5,-130626.15 1253.5,-130626.15 1253.5,-130694.15"/>
<text text-anchor="middle" x="1167.5" y="-130678.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1167.5" y="-130663.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1167.5" y="-130648.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1167.5" y="-130633.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer13_attn_0&#45;&gt;layer13_attn_out_0 -->
<g id="edge428" class="edge">
<title>layer13_attn_0&#45;&gt;layer13_attn_out_0</title>
<path fill="none" stroke="black" d="M1167.5,-130765.91C1167.5,-130765.91 1167.5,-130704.53 1167.5,-130704.53"/>
<polygon fill="black" stroke="black" points="1171,-130704.53 1167.5,-130694.53 1164,-130704.53 1171,-130704.53"/>
</g>
<!-- layer13_attn_out_1 -->
<g id="node339" class="node">
<title>layer13_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1461.5,-130694.15 1289.5,-130694.15 1289.5,-130626.15 1461.5,-130626.15 1461.5,-130694.15"/>
<text text-anchor="middle" x="1375.5" y="-130678.95" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1375.5" y="-130663.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1375.5" y="-130648.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1375.5" y="-130633.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer13_attn_1&#45;&gt;layer13_attn_out_1 -->
<g id="edge429" class="edge">
<title>layer13_attn_1&#45;&gt;layer13_attn_out_1</title>
<path fill="none" stroke="black" d="M1375.5,-130765.91C1375.5,-130765.91 1375.5,-130704.53 1375.5,-130704.53"/>
<polygon fill="black" stroke="black" points="1379,-130704.53 1375.5,-130694.53 1372,-130704.53 1379,-130704.53"/>
</g>
<!-- layer13_attn_ar -->
<g id="node340" class="node">
<title>layer13_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1271.5" cy="-130506.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1271.5" y="-130524.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1271.5" y="-130509.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1271.5" y="-130494.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1271.5" y="-130479.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_attn_out_0&#45;&gt;layer13_attn_ar -->
<g id="edge430" class="edge">
<title>layer13_attn_out_0&#45;&gt;layer13_attn_ar</title>
<path fill="none" stroke="black" d="M1201.69,-130625.96C1201.69,-130625.96 1201.69,-130555.61 1201.69,-130555.61"/>
<polygon fill="black" stroke="black" points="1205.19,-130555.61 1201.69,-130545.61 1198.19,-130555.61 1205.19,-130555.61"/>
</g>
<!-- layer13_attn_out_1&#45;&gt;layer13_attn_ar -->
<g id="edge431" class="edge">
<title>layer13_attn_out_1&#45;&gt;layer13_attn_ar</title>
<path fill="none" stroke="black" d="M1341.31,-130625.96C1341.31,-130625.96 1341.31,-130555.61 1341.31,-130555.61"/>
<polygon fill="black" stroke="black" points="1344.81,-130555.61 1341.31,-130545.61 1337.81,-130555.61 1344.81,-130555.61"/>
</g>
<!-- layer13_ffn_norm_0 -->
<g id="node341" class="node">
<title>layer13_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1249.5,-130385.99 1077.5,-130385.99 1077.5,-130317.99 1249.5,-130317.99 1249.5,-130385.99"/>
<text text-anchor="middle" x="1163.5" y="-130370.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1163.5" y="-130355.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1163.5" y="-130340.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1163.5" y="-130325.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_attn_ar&#45;&gt;layer13_ffn_norm_0 -->
<g id="edge432" class="edge">
<title>layer13_attn_ar&#45;&gt;layer13_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1199.69,-130467.19C1199.69,-130467.19 1199.69,-130396.14 1199.69,-130396.14"/>
<polygon fill="black" stroke="black" points="1203.19,-130396.14 1199.69,-130386.14 1196.19,-130396.14 1203.19,-130396.14"/>
</g>
<!-- layer13_ffn_norm_1 -->
<g id="node342" class="node">
<title>layer13_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1466.5,-130385.99 1294.5,-130385.99 1294.5,-130317.99 1466.5,-130317.99 1466.5,-130385.99"/>
<text text-anchor="middle" x="1380.5" y="-130370.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1380.5" y="-130355.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1380.5" y="-130340.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1380.5" y="-130325.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_attn_ar&#45;&gt;layer13_ffn_norm_1 -->
<g id="edge433" class="edge">
<title>layer13_attn_ar&#45;&gt;layer13_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1343.81,-130467.19C1343.81,-130467.19 1343.81,-130396.14 1343.81,-130396.14"/>
<polygon fill="black" stroke="black" points="1347.31,-130396.14 1343.81,-130386.14 1340.31,-130396.14 1347.31,-130396.14"/>
</g>
<!-- layer13_ffn_gate_0 -->
<g id="node343" class="node">
<title>layer13_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1254,-130245.99 1073,-130245.99 1073,-130177.99 1254,-130177.99 1254,-130245.99"/>
<text text-anchor="middle" x="1163.5" y="-130230.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1163.5" y="-130215.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1163.5" y="-130200.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1163.5" y="-130185.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_ffn_norm_0&#45;&gt;layer13_ffn_gate_0 -->
<g id="edge434" class="edge">
<title>layer13_ffn_norm_0&#45;&gt;layer13_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1163.5,-130317.74C1163.5,-130317.74 1163.5,-130256.37 1163.5,-130256.37"/>
<polygon fill="black" stroke="black" points="1167,-130256.37 1163.5,-130246.37 1160,-130256.37 1167,-130256.37"/>
</g>
<!-- layer13_ffn_up_0 -->
<g id="node345" class="node">
<title>layer13_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1037,-130245.99 856,-130245.99 856,-130177.99 1037,-130177.99 1037,-130245.99"/>
<text text-anchor="middle" x="946.5" y="-130230.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="946.5" y="-130215.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="946.5" y="-130200.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="946.5" y="-130185.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_ffn_norm_0&#45;&gt;layer13_ffn_up_0 -->
<g id="edge436" class="edge">
<title>layer13_ffn_norm_0&#45;&gt;layer13_ffn_up_0</title>
<path fill="none" stroke="black" d="M1077.31,-130351C1037.86,-130351 999.76,-130351 999.76,-130351 999.76,-130351 999.76,-130255.99 999.76,-130255.99"/>
<polygon fill="black" stroke="black" points="1003.26,-130255.99 999.76,-130245.99 996.26,-130255.99 1003.26,-130255.99"/>
</g>
<!-- layer13_ffn_gate_1 -->
<g id="node344" class="node">
<title>layer13_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1688,-130245.99 1507,-130245.99 1507,-130177.99 1688,-130177.99 1688,-130245.99"/>
<text text-anchor="middle" x="1597.5" y="-130230.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1597.5" y="-130215.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1597.5" y="-130200.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1597.5" y="-130185.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_ffn_norm_1&#45;&gt;layer13_ffn_gate_1 -->
<g id="edge435" class="edge">
<title>layer13_ffn_norm_1&#45;&gt;layer13_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1466.56,-130351C1505.95,-130351 1544,-130351 1544,-130351 1544,-130351 1544,-130255.99 1544,-130255.99"/>
<polygon fill="black" stroke="black" points="1547.5,-130255.99 1544,-130245.99 1540.5,-130255.99 1547.5,-130255.99"/>
</g>
<!-- layer13_ffn_up_1 -->
<g id="node346" class="node">
<title>layer13_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1471,-130245.99 1290,-130245.99 1290,-130177.99 1471,-130177.99 1471,-130245.99"/>
<text text-anchor="middle" x="1380.5" y="-130230.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1380.5" y="-130215.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1380.5" y="-130200.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1380.5" y="-130185.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_ffn_norm_1&#45;&gt;layer13_ffn_up_1 -->
<g id="edge437" class="edge">
<title>layer13_ffn_norm_1&#45;&gt;layer13_ffn_up_1</title>
<path fill="none" stroke="black" d="M1380.5,-130317.74C1380.5,-130317.74 1380.5,-130256.37 1380.5,-130256.37"/>
<polygon fill="black" stroke="black" points="1384,-130256.37 1380.5,-130246.37 1377,-130256.37 1384,-130256.37"/>
</g>
<!-- layer13_gate_ar -->
<g id="node347" class="node">
<title>layer13_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1471.5" cy="-130057.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1471.5" y="-130076.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1471.5" y="-130061.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1471.5" y="-130046.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1471.5" y="-130031.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer13_ffn_gate_0&#45;&gt;layer13_gate_ar -->
<g id="edge438" class="edge">
<title>layer13_ffn_gate_0&#45;&gt;layer13_gate_ar</title>
<path fill="none" stroke="black" d="M1254.08,-130211C1264.79,-130211 1272,-130211 1272,-130211 1272,-130211 1272,-130073 1272,-130073 1272,-130073 1339.7,-130073 1339.7,-130073"/>
<polygon fill="black" stroke="black" points="1339.7,-130076.5 1349.7,-130073 1339.7,-130069.5 1339.7,-130076.5"/>
</g>
<!-- layer13_ffn_gate_1&#45;&gt;layer13_gate_ar -->
<g id="edge439" class="edge">
<title>layer13_ffn_gate_1&#45;&gt;layer13_gate_ar</title>
<path fill="none" stroke="black" d="M1553.24,-130177.79C1553.24,-130177.79 1553.24,-130104.97 1553.24,-130104.97"/>
<polygon fill="black" stroke="black" points="1556.74,-130104.97 1553.24,-130094.97 1549.74,-130104.97 1556.74,-130104.97"/>
</g>
<!-- layer13_up_ar -->
<g id="node348" class="node">
<title>layer13_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1125.5" cy="-130057.9" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1125.5" y="-130076.7" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1125.5" y="-130061.7" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1125.5" y="-130046.7" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1125.5" y="-130031.7" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer13_ffn_up_0&#45;&gt;layer13_up_ar -->
<g id="edge440" class="edge">
<title>layer13_ffn_up_0&#45;&gt;layer13_up_ar</title>
<path fill="none" stroke="black" d="M1017.26,-130177.79C1017.26,-130177.79 1017.26,-130093.87 1017.26,-130093.87"/>
<polygon fill="black" stroke="black" points="1020.76,-130093.87 1017.26,-130083.87 1013.76,-130093.87 1020.76,-130093.87"/>
</g>
<!-- layer13_ffn_up_1&#45;&gt;layer13_up_ar -->
<g id="edge441" class="edge">
<title>layer13_ffn_up_1&#45;&gt;layer13_up_ar</title>
<path fill="none" stroke="black" d="M1316.76,-130177.8C1316.76,-130127.9 1316.76,-130041 1316.76,-130041 1316.76,-130041 1255.54,-130041 1255.54,-130041"/>
<polygon fill="black" stroke="black" points="1255.54,-130037.5 1245.54,-130041 1255.54,-130044.5 1255.54,-130037.5"/>
</g>
<!-- layer13_silu_0 -->
<g id="node349" class="node">
<title>layer13_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1399,-129937.82 1218,-129937.82 1218,-129869.82 1399,-129869.82 1399,-129937.82"/>
<text text-anchor="middle" x="1308.5" y="-129922.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1308.5" y="-129907.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1308.5" y="-129892.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1308.5" y="-129877.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_gate_ar&#45;&gt;layer13_silu_0 -->
<g id="edge442" class="edge">
<title>layer13_gate_ar&#45;&gt;layer13_silu_0</title>
<path fill="none" stroke="black" d="M1371.26,-130027.83C1371.26,-130027.83 1371.26,-129947.84 1371.26,-129947.84"/>
<polygon fill="black" stroke="black" points="1374.76,-129947.84 1371.26,-129937.84 1367.76,-129947.84 1374.76,-129947.84"/>
</g>
<!-- layer13_silu_1 -->
<g id="node350" class="node">
<title>layer13_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1616,-129937.82 1435,-129937.82 1435,-129869.82 1616,-129869.82 1616,-129937.82"/>
<text text-anchor="middle" x="1525.5" y="-129922.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1525.5" y="-129907.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1525.5" y="-129892.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1525.5" y="-129877.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_gate_ar&#45;&gt;layer13_silu_1 -->
<g id="edge443" class="edge">
<title>layer13_gate_ar&#45;&gt;layer13_silu_1</title>
<path fill="none" stroke="black" d="M1517.24,-130012.92C1517.24,-130012.92 1517.24,-129947.83 1517.24,-129947.83"/>
<polygon fill="black" stroke="black" points="1520.74,-129947.83 1517.24,-129937.83 1513.74,-129947.83 1520.74,-129947.83"/>
</g>
<!-- layer13_mul_0 -->
<g id="node351" class="node">
<title>layer13_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1289,-129797.82 1108,-129797.82 1108,-129729.82 1289,-129729.82 1289,-129797.82"/>
<text text-anchor="middle" x="1198.5" y="-129782.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1198.5" y="-129767.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1198.5" y="-129752.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1198.5" y="-129737.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_up_ar&#45;&gt;layer13_mul_0 -->
<g id="edge445" class="edge">
<title>layer13_up_ar&#45;&gt;layer13_mul_0</title>
<path fill="none" stroke="black" d="M1163,-130011.63C1163,-130011.63 1163,-129807.91 1163,-129807.91"/>
<polygon fill="black" stroke="black" points="1166.5,-129807.91 1163,-129797.91 1159.5,-129807.91 1166.5,-129807.91"/>
</g>
<!-- layer13_mul_1 -->
<g id="node352" class="node">
<title>layer13_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1506,-129797.82 1325,-129797.82 1325,-129729.82 1506,-129729.82 1506,-129797.82"/>
<text text-anchor="middle" x="1415.5" y="-129782.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1415.5" y="-129767.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1415.5" y="-129752.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1415.5" y="-129737.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer13_up_ar&#45;&gt;layer13_mul_1 -->
<g id="edge447" class="edge">
<title>layer13_up_ar&#45;&gt;layer13_mul_1</title>
<path fill="none" stroke="black" d="M1235.74,-130033.35C1235.74,-130008.27 1235.74,-129973 1235.74,-129973 1235.74,-129973 1417,-129973 1417,-129973 1417,-129973 1417,-129807.89 1417,-129807.89"/>
<polygon fill="black" stroke="black" points="1420.5,-129807.89 1417,-129797.89 1413.5,-129807.89 1420.5,-129807.89"/>
</g>
<!-- layer13_silu_0&#45;&gt;layer13_mul_0 -->
<g id="edge444" class="edge">
<title>layer13_silu_0&#45;&gt;layer13_mul_0</title>
<path fill="none" stroke="black" d="M1253.5,-129869.57C1253.5,-129869.57 1253.5,-129808.2 1253.5,-129808.2"/>
<polygon fill="black" stroke="black" points="1257,-129808.2 1253.5,-129798.2 1250,-129808.2 1257,-129808.2"/>
</g>
<!-- layer13_silu_1&#45;&gt;layer13_mul_1 -->
<g id="edge446" class="edge">
<title>layer13_silu_1&#45;&gt;layer13_mul_1</title>
<path fill="none" stroke="black" d="M1470.5,-129869.57C1470.5,-129869.57 1470.5,-129808.2 1470.5,-129808.2"/>
<polygon fill="black" stroke="black" points="1474,-129808.2 1470.5,-129798.2 1467,-129808.2 1474,-129808.2"/>
</g>
<!-- layer13_ffn_down_0 -->
<g id="node353" class="node">
<title>layer13_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1288.5,-129657.82 1116.5,-129657.82 1116.5,-129589.82 1288.5,-129589.82 1288.5,-129657.82"/>
<text text-anchor="middle" x="1202.5" y="-129642.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1202.5" y="-129627.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1202.5" y="-129612.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1202.5" y="-129597.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer13_mul_0&#45;&gt;layer13_ffn_down_0 -->
<g id="edge448" class="edge">
<title>layer13_mul_0&#45;&gt;layer13_ffn_down_0</title>
<path fill="none" stroke="black" d="M1202.5,-129729.57C1202.5,-129729.57 1202.5,-129668.2 1202.5,-129668.2"/>
<polygon fill="black" stroke="black" points="1206,-129668.2 1202.5,-129658.2 1199,-129668.2 1206,-129668.2"/>
</g>
<!-- layer13_ffn_down_1 -->
<g id="node354" class="node">
<title>layer13_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1498.5,-129657.82 1326.5,-129657.82 1326.5,-129589.82 1498.5,-129589.82 1498.5,-129657.82"/>
<text text-anchor="middle" x="1412.5" y="-129642.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1412.5" y="-129627.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1412.5" y="-129612.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1412.5" y="-129597.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer13_mul_1&#45;&gt;layer13_ffn_down_1 -->
<g id="edge449" class="edge">
<title>layer13_mul_1&#45;&gt;layer13_ffn_down_1</title>
<path fill="none" stroke="black" d="M1412.5,-129729.57C1412.5,-129729.57 1412.5,-129668.2 1412.5,-129668.2"/>
<polygon fill="black" stroke="black" points="1416,-129668.2 1412.5,-129658.2 1409,-129668.2 1416,-129668.2"/>
</g>
<!-- layer13_ffn_ar -->
<g id="node355" class="node">
<title>layer13_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1306.5" cy="-129469.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1306.5" y="-129488.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1306.5" y="-129473.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1306.5" y="-129458.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1306.5" y="-129443.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_ffn_down_0&#45;&gt;layer13_ffn_ar -->
<g id="edge450" class="edge">
<title>layer13_ffn_down_0&#45;&gt;layer13_ffn_ar</title>
<path fill="none" stroke="black" d="M1236.69,-129589.62C1236.69,-129589.62 1236.69,-129519.28 1236.69,-129519.28"/>
<polygon fill="black" stroke="black" points="1240.19,-129519.28 1236.69,-129509.28 1233.19,-129519.28 1240.19,-129519.28"/>
</g>
<!-- layer13_ffn_down_1&#45;&gt;layer13_ffn_ar -->
<g id="edge451" class="edge">
<title>layer13_ffn_down_1&#45;&gt;layer13_ffn_ar</title>
<path fill="none" stroke="black" d="M1377.31,-129589.62C1377.31,-129589.62 1377.31,-129519 1377.31,-129519"/>
<polygon fill="black" stroke="black" points="1380.81,-129519 1377.31,-129509 1373.81,-129519 1380.81,-129519"/>
</g>
<!-- layer14_norm_0 -->
<g id="node356" class="node">
<title>layer14_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1288.5,-129349.65 1116.5,-129349.65 1116.5,-129281.65 1288.5,-129281.65 1288.5,-129349.65"/>
<text text-anchor="middle" x="1202.5" y="-129334.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1202.5" y="-129319.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1202.5" y="-129304.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1202.5" y="-129289.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_ffn_ar&#45;&gt;layer14_norm_0 -->
<g id="edge452" class="edge">
<title>layer13_ffn_ar&#45;&gt;layer14_norm_0</title>
<path fill="none" stroke="black" d="M1236.69,-129430.06C1236.69,-129430.06 1236.69,-129359.71 1236.69,-129359.71"/>
<polygon fill="black" stroke="black" points="1240.19,-129359.71 1236.69,-129349.71 1233.19,-129359.71 1240.19,-129359.71"/>
</g>
<!-- layer14_norm_1 -->
<g id="node357" class="node">
<title>layer14_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1498.5,-129349.65 1326.5,-129349.65 1326.5,-129281.65 1498.5,-129281.65 1498.5,-129349.65"/>
<text text-anchor="middle" x="1412.5" y="-129334.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1412.5" y="-129319.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1412.5" y="-129304.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1412.5" y="-129289.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_ffn_ar&#45;&gt;layer14_norm_1 -->
<g id="edge453" class="edge">
<title>layer13_ffn_ar&#45;&gt;layer14_norm_1</title>
<path fill="none" stroke="black" d="M1377.31,-129430.46C1377.31,-129430.46 1377.31,-129359.89 1377.31,-129359.89"/>
<polygon fill="black" stroke="black" points="1380.81,-129359.89 1377.31,-129349.89 1373.81,-129359.89 1380.81,-129359.89"/>
</g>
<!-- layer14_qkv_0 -->
<g id="node358" class="node">
<title>layer14_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1289,-129209.65 1108,-129209.65 1108,-129141.65 1289,-129141.65 1289,-129209.65"/>
<text text-anchor="middle" x="1198.5" y="-129194.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1198.5" y="-129179.45" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1198.5" y="-129164.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1198.5" y="-129149.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer14_norm_0&#45;&gt;layer14_qkv_0 -->
<g id="edge454" class="edge">
<title>layer14_norm_0&#45;&gt;layer14_qkv_0</title>
<path fill="none" stroke="black" d="M1202.5,-129281.41C1202.5,-129281.41 1202.5,-129220.03 1202.5,-129220.03"/>
<polygon fill="black" stroke="black" points="1206,-129220.03 1202.5,-129210.03 1199,-129220.03 1206,-129220.03"/>
</g>
<!-- layer14_qkv_1 -->
<g id="node359" class="node">
<title>layer14_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1506,-129209.65 1325,-129209.65 1325,-129141.65 1506,-129141.65 1506,-129209.65"/>
<text text-anchor="middle" x="1415.5" y="-129194.45" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1415.5" y="-129179.45" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1415.5" y="-129164.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1415.5" y="-129149.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer14_norm_1&#45;&gt;layer14_qkv_1 -->
<g id="edge455" class="edge">
<title>layer14_norm_1&#45;&gt;layer14_qkv_1</title>
<path fill="none" stroke="black" d="M1412.5,-129281.41C1412.5,-129281.41 1412.5,-129220.03 1412.5,-129220.03"/>
<polygon fill="black" stroke="black" points="1416,-129220.03 1412.5,-129210.03 1409,-129220.03 1416,-129220.03"/>
</g>
<!-- layer14_qkv_ar -->
<g id="node360" class="node">
<title>layer14_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1306.5" cy="-129021.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1306.5" y="-129040.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1306.5" y="-129025.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1306.5" y="-129010.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1306.5" y="-128995.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer14_qkv_0&#45;&gt;layer14_qkv_ar -->
<g id="edge456" class="edge">
<title>layer14_qkv_0&#45;&gt;layer14_qkv_ar</title>
<path fill="none" stroke="black" d="M1233.76,-129141.46C1233.76,-129141.46 1233.76,-129071.39 1233.76,-129071.39"/>
<polygon fill="black" stroke="black" points="1237.26,-129071.39 1233.76,-129061.39 1230.26,-129071.39 1237.26,-129071.39"/>
</g>
<!-- layer14_qkv_1&#45;&gt;layer14_qkv_ar -->
<g id="edge457" class="edge">
<title>layer14_qkv_1&#45;&gt;layer14_qkv_ar</title>
<path fill="none" stroke="black" d="M1379.74,-129141.46C1379.74,-129141.46 1379.74,-129071.11 1379.74,-129071.11"/>
<polygon fill="black" stroke="black" points="1383.24,-129071.11 1379.74,-129061.11 1376.24,-129071.11 1383.24,-129071.11"/>
</g>
<!-- layer14_attn_0 -->
<g id="node361" class="node">
<title>layer14_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1288.5,-128901.49 1116.5,-128901.49 1116.5,-128833.49 1288.5,-128833.49 1288.5,-128901.49"/>
<text text-anchor="middle" x="1202.5" y="-128886.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1202.5" y="-128871.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1202.5" y="-128856.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1202.5" y="-128841.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer14_qkv_ar&#45;&gt;layer14_attn_0 -->
<g id="edge458" class="edge">
<title>layer14_qkv_ar&#45;&gt;layer14_attn_0</title>
<path fill="none" stroke="black" d="M1233.51,-128981.89C1233.51,-128981.89 1233.51,-128911.55 1233.51,-128911.55"/>
<polygon fill="black" stroke="black" points="1237.01,-128911.55 1233.51,-128901.55 1230.01,-128911.55 1237.01,-128911.55"/>
</g>
<!-- layer14_attn_1 -->
<g id="node362" class="node">
<title>layer14_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1496.5,-128901.49 1324.5,-128901.49 1324.5,-128833.49 1496.5,-128833.49 1496.5,-128901.49"/>
<text text-anchor="middle" x="1410.5" y="-128886.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1410.5" y="-128871.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1410.5" y="-128856.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1410.5" y="-128841.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer14_qkv_ar&#45;&gt;layer14_attn_1 -->
<g id="edge459" class="edge">
<title>layer14_qkv_ar&#45;&gt;layer14_attn_1</title>
<path fill="none" stroke="black" d="M1379.49,-128981.89C1379.49,-128981.89 1379.49,-128911.55 1379.49,-128911.55"/>
<polygon fill="black" stroke="black" points="1382.99,-128911.55 1379.49,-128901.55 1375.99,-128911.55 1382.99,-128911.55"/>
</g>
<!-- layer14_attn_out_0 -->
<g id="node363" class="node">
<title>layer14_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1288.5,-128761.49 1116.5,-128761.49 1116.5,-128693.49 1288.5,-128693.49 1288.5,-128761.49"/>
<text text-anchor="middle" x="1202.5" y="-128746.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1202.5" y="-128731.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1202.5" y="-128716.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1202.5" y="-128701.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer14_attn_0&#45;&gt;layer14_attn_out_0 -->
<g id="edge460" class="edge">
<title>layer14_attn_0&#45;&gt;layer14_attn_out_0</title>
<path fill="none" stroke="black" d="M1202.5,-128833.24C1202.5,-128833.24 1202.5,-128771.87 1202.5,-128771.87"/>
<polygon fill="black" stroke="black" points="1206,-128771.87 1202.5,-128761.87 1199,-128771.87 1206,-128771.87"/>
</g>
<!-- layer14_attn_out_1 -->
<g id="node364" class="node">
<title>layer14_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1496.5,-128761.49 1324.5,-128761.49 1324.5,-128693.49 1496.5,-128693.49 1496.5,-128761.49"/>
<text text-anchor="middle" x="1410.5" y="-128746.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1410.5" y="-128731.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1410.5" y="-128716.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1410.5" y="-128701.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer14_attn_1&#45;&gt;layer14_attn_out_1 -->
<g id="edge461" class="edge">
<title>layer14_attn_1&#45;&gt;layer14_attn_out_1</title>
<path fill="none" stroke="black" d="M1410.5,-128833.24C1410.5,-128833.24 1410.5,-128771.87 1410.5,-128771.87"/>
<polygon fill="black" stroke="black" points="1414,-128771.87 1410.5,-128761.87 1407,-128771.87 1414,-128771.87"/>
</g>
<!-- layer14_attn_ar -->
<g id="node365" class="node">
<title>layer14_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1306.5" cy="-128573.4" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1306.5" y="-128592.2" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1306.5" y="-128577.2" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1306.5" y="-128562.2" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1306.5" y="-128547.2" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_attn_out_0&#45;&gt;layer14_attn_ar -->
<g id="edge462" class="edge">
<title>layer14_attn_out_0&#45;&gt;layer14_attn_ar</title>
<path fill="none" stroke="black" d="M1236.69,-128693.29C1236.69,-128693.29 1236.69,-128622.95 1236.69,-128622.95"/>
<polygon fill="black" stroke="black" points="1240.19,-128622.95 1236.69,-128612.95 1233.19,-128622.95 1240.19,-128622.95"/>
</g>
<!-- layer14_attn_out_1&#45;&gt;layer14_attn_ar -->
<g id="edge463" class="edge">
<title>layer14_attn_out_1&#45;&gt;layer14_attn_ar</title>
<path fill="none" stroke="black" d="M1376.31,-128693.29C1376.31,-128693.29 1376.31,-128622.95 1376.31,-128622.95"/>
<polygon fill="black" stroke="black" points="1379.81,-128622.95 1376.31,-128612.95 1372.81,-128622.95 1379.81,-128622.95"/>
</g>
<!-- layer14_ffn_norm_0 -->
<g id="node366" class="node">
<title>layer14_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1284.5,-128453.32 1112.5,-128453.32 1112.5,-128385.32 1284.5,-128385.32 1284.5,-128453.32"/>
<text text-anchor="middle" x="1198.5" y="-128438.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1198.5" y="-128423.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1198.5" y="-128408.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1198.5" y="-128393.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_attn_ar&#45;&gt;layer14_ffn_norm_0 -->
<g id="edge464" class="edge">
<title>layer14_attn_ar&#45;&gt;layer14_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1234.69,-128534.52C1234.69,-128534.52 1234.69,-128463.47 1234.69,-128463.47"/>
<polygon fill="black" stroke="black" points="1238.19,-128463.47 1234.69,-128453.47 1231.19,-128463.47 1238.19,-128463.47"/>
</g>
<!-- layer14_ffn_norm_1 -->
<g id="node367" class="node">
<title>layer14_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1501.5,-128453.32 1329.5,-128453.32 1329.5,-128385.32 1501.5,-128385.32 1501.5,-128453.32"/>
<text text-anchor="middle" x="1415.5" y="-128438.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1415.5" y="-128423.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1415.5" y="-128408.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1415.5" y="-128393.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_attn_ar&#45;&gt;layer14_ffn_norm_1 -->
<g id="edge465" class="edge">
<title>layer14_attn_ar&#45;&gt;layer14_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1378.81,-128534.52C1378.81,-128534.52 1378.81,-128463.47 1378.81,-128463.47"/>
<polygon fill="black" stroke="black" points="1382.31,-128463.47 1378.81,-128453.47 1375.31,-128463.47 1382.31,-128463.47"/>
</g>
<!-- layer14_ffn_gate_0 -->
<g id="node368" class="node">
<title>layer14_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1289,-128313.32 1108,-128313.32 1108,-128245.32 1289,-128245.32 1289,-128313.32"/>
<text text-anchor="middle" x="1198.5" y="-128298.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1198.5" y="-128283.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1198.5" y="-128268.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1198.5" y="-128253.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_ffn_norm_0&#45;&gt;layer14_ffn_gate_0 -->
<g id="edge466" class="edge">
<title>layer14_ffn_norm_0&#45;&gt;layer14_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1198.5,-128385.07C1198.5,-128385.07 1198.5,-128323.7 1198.5,-128323.7"/>
<polygon fill="black" stroke="black" points="1202,-128323.7 1198.5,-128313.7 1195,-128323.7 1202,-128323.7"/>
</g>
<!-- layer14_ffn_up_0 -->
<g id="node370" class="node">
<title>layer14_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1072,-128313.32 891,-128313.32 891,-128245.32 1072,-128245.32 1072,-128313.32"/>
<text text-anchor="middle" x="981.5" y="-128298.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="981.5" y="-128283.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="981.5" y="-128268.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="981.5" y="-128253.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_ffn_norm_0&#45;&gt;layer14_ffn_up_0 -->
<g id="edge468" class="edge">
<title>layer14_ffn_norm_0&#45;&gt;layer14_ffn_up_0</title>
<path fill="none" stroke="black" d="M1112.31,-128419C1072.86,-128419 1034.76,-128419 1034.76,-128419 1034.76,-128419 1034.76,-128323.49 1034.76,-128323.49"/>
<polygon fill="black" stroke="black" points="1038.26,-128323.49 1034.76,-128313.49 1031.26,-128323.49 1038.26,-128323.49"/>
</g>
<!-- layer14_ffn_gate_1 -->
<g id="node369" class="node">
<title>layer14_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1723,-128313.32 1542,-128313.32 1542,-128245.32 1723,-128245.32 1723,-128313.32"/>
<text text-anchor="middle" x="1632.5" y="-128298.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1632.5" y="-128283.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1632.5" y="-128268.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1632.5" y="-128253.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_ffn_norm_1&#45;&gt;layer14_ffn_gate_1 -->
<g id="edge467" class="edge">
<title>layer14_ffn_norm_1&#45;&gt;layer14_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1501.56,-128419C1540.95,-128419 1579,-128419 1579,-128419 1579,-128419 1579,-128323.49 1579,-128323.49"/>
<polygon fill="black" stroke="black" points="1582.5,-128323.49 1579,-128313.49 1575.5,-128323.49 1582.5,-128323.49"/>
</g>
<!-- layer14_ffn_up_1 -->
<g id="node371" class="node">
<title>layer14_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1506,-128313.32 1325,-128313.32 1325,-128245.32 1506,-128245.32 1506,-128313.32"/>
<text text-anchor="middle" x="1415.5" y="-128298.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1415.5" y="-128283.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1415.5" y="-128268.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1415.5" y="-128253.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_ffn_norm_1&#45;&gt;layer14_ffn_up_1 -->
<g id="edge469" class="edge">
<title>layer14_ffn_norm_1&#45;&gt;layer14_ffn_up_1</title>
<path fill="none" stroke="black" d="M1415.5,-128385.07C1415.5,-128385.07 1415.5,-128323.7 1415.5,-128323.7"/>
<polygon fill="black" stroke="black" points="1419,-128323.7 1415.5,-128313.7 1412,-128323.7 1419,-128323.7"/>
</g>
<!-- layer14_gate_ar -->
<g id="node372" class="node">
<title>layer14_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1506.5" cy="-128125.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1506.5" y="-128144.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1506.5" y="-128129.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1506.5" y="-128114.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1506.5" y="-128099.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer14_ffn_gate_0&#45;&gt;layer14_gate_ar -->
<g id="edge470" class="edge">
<title>layer14_ffn_gate_0&#45;&gt;layer14_gate_ar</title>
<path fill="none" stroke="black" d="M1289.08,-128279C1299.79,-128279 1307,-128279 1307,-128279 1307,-128279 1307,-128141 1307,-128141 1307,-128141 1375.56,-128141 1375.56,-128141"/>
<polygon fill="black" stroke="black" points="1375.56,-128144.5 1385.56,-128141 1375.56,-128137.5 1375.56,-128144.5"/>
</g>
<!-- layer14_ffn_gate_1&#45;&gt;layer14_gate_ar -->
<g id="edge471" class="edge">
<title>layer14_ffn_gate_1&#45;&gt;layer14_gate_ar</title>
<path fill="none" stroke="black" d="M1588.24,-128245.13C1588.24,-128245.13 1588.24,-128172.3 1588.24,-128172.3"/>
<polygon fill="black" stroke="black" points="1591.74,-128172.3 1588.24,-128162.3 1584.74,-128172.3 1591.74,-128172.3"/>
</g>
<!-- layer14_up_ar -->
<g id="node373" class="node">
<title>layer14_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1160.5" cy="-128125.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1160.5" y="-128144.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1160.5" y="-128129.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1160.5" y="-128114.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1160.5" y="-128099.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer14_ffn_up_0&#45;&gt;layer14_up_ar -->
<g id="edge472" class="edge">
<title>layer14_ffn_up_0&#45;&gt;layer14_up_ar</title>
<path fill="none" stroke="black" d="M1052.26,-128245.13C1052.26,-128245.13 1052.26,-128161.2 1052.26,-128161.2"/>
<polygon fill="black" stroke="black" points="1055.76,-128161.2 1052.26,-128151.2 1048.76,-128161.2 1055.76,-128161.2"/>
</g>
<!-- layer14_ffn_up_1&#45;&gt;layer14_up_ar -->
<g id="edge473" class="edge">
<title>layer14_ffn_up_1&#45;&gt;layer14_up_ar</title>
<path fill="none" stroke="black" d="M1351.76,-128245.26C1351.76,-128195.56 1351.76,-128109 1351.76,-128109 1351.76,-128109 1291.08,-128109 1291.08,-128109"/>
<polygon fill="black" stroke="black" points="1291.08,-128105.5 1281.08,-128109 1291.08,-128112.5 1291.08,-128105.5"/>
</g>
<!-- layer14_silu_0 -->
<g id="node374" class="node">
<title>layer14_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1434,-128005.15 1253,-128005.15 1253,-127937.15 1434,-127937.15 1434,-128005.15"/>
<text text-anchor="middle" x="1343.5" y="-127989.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1343.5" y="-127974.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1343.5" y="-127959.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1343.5" y="-127944.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_gate_ar&#45;&gt;layer14_silu_0 -->
<g id="edge474" class="edge">
<title>layer14_gate_ar&#45;&gt;layer14_silu_0</title>
<path fill="none" stroke="black" d="M1406.26,-128095.16C1406.26,-128095.16 1406.26,-128015.18 1406.26,-128015.18"/>
<polygon fill="black" stroke="black" points="1409.76,-128015.18 1406.26,-128005.18 1402.76,-128015.18 1409.76,-128015.18"/>
</g>
<!-- layer14_silu_1 -->
<g id="node375" class="node">
<title>layer14_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1651,-128005.15 1470,-128005.15 1470,-127937.15 1651,-127937.15 1651,-128005.15"/>
<text text-anchor="middle" x="1560.5" y="-127989.95" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1560.5" y="-127974.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1560.5" y="-127959.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1560.5" y="-127944.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_gate_ar&#45;&gt;layer14_silu_1 -->
<g id="edge475" class="edge">
<title>layer14_gate_ar&#45;&gt;layer14_silu_1</title>
<path fill="none" stroke="black" d="M1552.24,-128080.26C1552.24,-128080.26 1552.24,-128015.16 1552.24,-128015.16"/>
<polygon fill="black" stroke="black" points="1555.74,-128015.16 1552.24,-128005.16 1548.74,-128015.16 1555.74,-128015.16"/>
</g>
<!-- layer14_mul_0 -->
<g id="node376" class="node">
<title>layer14_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1324,-127865.15 1143,-127865.15 1143,-127797.15 1324,-127797.15 1324,-127865.15"/>
<text text-anchor="middle" x="1233.5" y="-127849.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1233.5" y="-127834.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1233.5" y="-127819.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1233.5" y="-127804.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_up_ar&#45;&gt;layer14_mul_0 -->
<g id="edge477" class="edge">
<title>layer14_up_ar&#45;&gt;layer14_mul_0</title>
<path fill="none" stroke="black" d="M1198,-128078.96C1198,-128078.96 1198,-127875.24 1198,-127875.24"/>
<polygon fill="black" stroke="black" points="1201.5,-127875.24 1198,-127865.24 1194.5,-127875.24 1201.5,-127875.24"/>
</g>
<!-- layer14_mul_1 -->
<g id="node377" class="node">
<title>layer14_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1541,-127865.15 1360,-127865.15 1360,-127797.15 1541,-127797.15 1541,-127865.15"/>
<text text-anchor="middle" x="1450.5" y="-127849.95" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1450.5" y="-127834.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1450.5" y="-127819.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1450.5" y="-127804.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer14_up_ar&#45;&gt;layer14_mul_1 -->
<g id="edge479" class="edge">
<title>layer14_up_ar&#45;&gt;layer14_mul_1</title>
<path fill="none" stroke="black" d="M1270.74,-128100.42C1270.74,-128075.57 1270.74,-128041 1270.74,-128041 1270.74,-128041 1452,-128041 1452,-128041 1452,-128041 1452,-127875.34 1452,-127875.34"/>
<polygon fill="black" stroke="black" points="1455.5,-127875.34 1452,-127865.34 1448.5,-127875.34 1455.5,-127875.34"/>
</g>
<!-- layer14_silu_0&#45;&gt;layer14_mul_0 -->
<g id="edge476" class="edge">
<title>layer14_silu_0&#45;&gt;layer14_mul_0</title>
<path fill="none" stroke="black" d="M1288.5,-127936.91C1288.5,-127936.91 1288.5,-127875.53 1288.5,-127875.53"/>
<polygon fill="black" stroke="black" points="1292,-127875.53 1288.5,-127865.53 1285,-127875.53 1292,-127875.53"/>
</g>
<!-- layer14_silu_1&#45;&gt;layer14_mul_1 -->
<g id="edge478" class="edge">
<title>layer14_silu_1&#45;&gt;layer14_mul_1</title>
<path fill="none" stroke="black" d="M1505.5,-127936.91C1505.5,-127936.91 1505.5,-127875.53 1505.5,-127875.53"/>
<polygon fill="black" stroke="black" points="1509,-127875.53 1505.5,-127865.53 1502,-127875.53 1509,-127875.53"/>
</g>
<!-- layer14_ffn_down_0 -->
<g id="node378" class="node">
<title>layer14_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1323.5,-127725.15 1151.5,-127725.15 1151.5,-127657.15 1323.5,-127657.15 1323.5,-127725.15"/>
<text text-anchor="middle" x="1237.5" y="-127709.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1237.5" y="-127694.95" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1237.5" y="-127679.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1237.5" y="-127664.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer14_mul_0&#45;&gt;layer14_ffn_down_0 -->
<g id="edge480" class="edge">
<title>layer14_mul_0&#45;&gt;layer14_ffn_down_0</title>
<path fill="none" stroke="black" d="M1237.5,-127796.91C1237.5,-127796.91 1237.5,-127735.53 1237.5,-127735.53"/>
<polygon fill="black" stroke="black" points="1241,-127735.53 1237.5,-127725.53 1234,-127735.53 1241,-127735.53"/>
</g>
<!-- layer14_ffn_down_1 -->
<g id="node379" class="node">
<title>layer14_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1533.5,-127725.15 1361.5,-127725.15 1361.5,-127657.15 1533.5,-127657.15 1533.5,-127725.15"/>
<text text-anchor="middle" x="1447.5" y="-127709.95" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1447.5" y="-127694.95" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1447.5" y="-127679.95" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1447.5" y="-127664.95" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer14_mul_1&#45;&gt;layer14_ffn_down_1 -->
<g id="edge481" class="edge">
<title>layer14_mul_1&#45;&gt;layer14_ffn_down_1</title>
<path fill="none" stroke="black" d="M1447.5,-127796.91C1447.5,-127796.91 1447.5,-127735.53 1447.5,-127735.53"/>
<polygon fill="black" stroke="black" points="1451,-127735.53 1447.5,-127725.53 1444,-127735.53 1451,-127735.53"/>
</g>
<!-- layer14_ffn_ar -->
<g id="node380" class="node">
<title>layer14_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1341.5" cy="-127537.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1341.5" y="-127555.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1341.5" y="-127540.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1341.5" y="-127525.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1341.5" y="-127510.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_ffn_down_0&#45;&gt;layer14_ffn_ar -->
<g id="edge482" class="edge">
<title>layer14_ffn_down_0&#45;&gt;layer14_ffn_ar</title>
<path fill="none" stroke="black" d="M1271.69,-127656.96C1271.69,-127656.96 1271.69,-127586.61 1271.69,-127586.61"/>
<polygon fill="black" stroke="black" points="1275.19,-127586.61 1271.69,-127576.61 1268.19,-127586.61 1275.19,-127586.61"/>
</g>
<!-- layer14_ffn_down_1&#45;&gt;layer14_ffn_ar -->
<g id="edge483" class="edge">
<title>layer14_ffn_down_1&#45;&gt;layer14_ffn_ar</title>
<path fill="none" stroke="black" d="M1412.31,-127656.96C1412.31,-127656.96 1412.31,-127586.34 1412.31,-127586.34"/>
<polygon fill="black" stroke="black" points="1415.81,-127586.34 1412.31,-127576.34 1408.81,-127586.34 1415.81,-127586.34"/>
</g>
<!-- layer15_norm_0 -->
<g id="node381" class="node">
<title>layer15_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1323.5,-127416.99 1151.5,-127416.99 1151.5,-127348.99 1323.5,-127348.99 1323.5,-127416.99"/>
<text text-anchor="middle" x="1237.5" y="-127401.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1237.5" y="-127386.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1237.5" y="-127371.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1237.5" y="-127356.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_ffn_ar&#45;&gt;layer15_norm_0 -->
<g id="edge484" class="edge">
<title>layer14_ffn_ar&#45;&gt;layer15_norm_0</title>
<path fill="none" stroke="black" d="M1271.69,-127497.39C1271.69,-127497.39 1271.69,-127427.05 1271.69,-127427.05"/>
<polygon fill="black" stroke="black" points="1275.19,-127427.05 1271.69,-127417.05 1268.19,-127427.05 1275.19,-127427.05"/>
</g>
<!-- layer15_norm_1 -->
<g id="node382" class="node">
<title>layer15_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1533.5,-127416.99 1361.5,-127416.99 1361.5,-127348.99 1533.5,-127348.99 1533.5,-127416.99"/>
<text text-anchor="middle" x="1447.5" y="-127401.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1447.5" y="-127386.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1447.5" y="-127371.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1447.5" y="-127356.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_ffn_ar&#45;&gt;layer15_norm_1 -->
<g id="edge485" class="edge">
<title>layer14_ffn_ar&#45;&gt;layer15_norm_1</title>
<path fill="none" stroke="black" d="M1412.31,-127497.79C1412.31,-127497.79 1412.31,-127427.22 1412.31,-127427.22"/>
<polygon fill="black" stroke="black" points="1415.81,-127427.22 1412.31,-127417.22 1408.81,-127427.22 1415.81,-127427.22"/>
</g>
<!-- layer15_qkv_0 -->
<g id="node383" class="node">
<title>layer15_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1324,-127276.99 1143,-127276.99 1143,-127208.99 1324,-127208.99 1324,-127276.99"/>
<text text-anchor="middle" x="1233.5" y="-127261.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1233.5" y="-127246.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1233.5" y="-127231.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-127216.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer15_norm_0&#45;&gt;layer15_qkv_0 -->
<g id="edge486" class="edge">
<title>layer15_norm_0&#45;&gt;layer15_qkv_0</title>
<path fill="none" stroke="black" d="M1237.5,-127348.74C1237.5,-127348.74 1237.5,-127287.37 1237.5,-127287.37"/>
<polygon fill="black" stroke="black" points="1241,-127287.37 1237.5,-127277.37 1234,-127287.37 1241,-127287.37"/>
</g>
<!-- layer15_qkv_1 -->
<g id="node384" class="node">
<title>layer15_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1541,-127276.99 1360,-127276.99 1360,-127208.99 1541,-127208.99 1541,-127276.99"/>
<text text-anchor="middle" x="1450.5" y="-127261.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1450.5" y="-127246.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1450.5" y="-127231.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1450.5" y="-127216.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer15_norm_1&#45;&gt;layer15_qkv_1 -->
<g id="edge487" class="edge">
<title>layer15_norm_1&#45;&gt;layer15_qkv_1</title>
<path fill="none" stroke="black" d="M1447.5,-127348.74C1447.5,-127348.74 1447.5,-127287.37 1447.5,-127287.37"/>
<polygon fill="black" stroke="black" points="1451,-127287.37 1447.5,-127277.37 1444,-127287.37 1451,-127287.37"/>
</g>
<!-- layer15_qkv_ar -->
<g id="node385" class="node">
<title>layer15_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1341.5" cy="-127088.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1341.5" y="-127107.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1341.5" y="-127092.71" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1341.5" y="-127077.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1341.5" y="-127062.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer15_qkv_0&#45;&gt;layer15_qkv_ar -->
<g id="edge488" class="edge">
<title>layer15_qkv_0&#45;&gt;layer15_qkv_ar</title>
<path fill="none" stroke="black" d="M1268.76,-127208.79C1268.76,-127208.79 1268.76,-127138.73 1268.76,-127138.73"/>
<polygon fill="black" stroke="black" points="1272.26,-127138.73 1268.76,-127128.73 1265.26,-127138.73 1272.26,-127138.73"/>
</g>
<!-- layer15_qkv_1&#45;&gt;layer15_qkv_ar -->
<g id="edge489" class="edge">
<title>layer15_qkv_1&#45;&gt;layer15_qkv_ar</title>
<path fill="none" stroke="black" d="M1414.74,-127208.79C1414.74,-127208.79 1414.74,-127138.45 1414.74,-127138.45"/>
<polygon fill="black" stroke="black" points="1418.24,-127138.45 1414.74,-127128.45 1411.24,-127138.45 1418.24,-127138.45"/>
</g>
<!-- layer15_attn_0 -->
<g id="node386" class="node">
<title>layer15_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1323.5,-126968.82 1151.5,-126968.82 1151.5,-126900.82 1323.5,-126900.82 1323.5,-126968.82"/>
<text text-anchor="middle" x="1237.5" y="-126953.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1237.5" y="-126938.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1237.5" y="-126923.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1237.5" y="-126908.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer15_qkv_ar&#45;&gt;layer15_attn_0 -->
<g id="edge490" class="edge">
<title>layer15_qkv_ar&#45;&gt;layer15_attn_0</title>
<path fill="none" stroke="black" d="M1268.51,-127049.22C1268.51,-127049.22 1268.51,-126978.88 1268.51,-126978.88"/>
<polygon fill="black" stroke="black" points="1272.01,-126978.88 1268.51,-126968.88 1265.01,-126978.88 1272.01,-126978.88"/>
</g>
<!-- layer15_attn_1 -->
<g id="node387" class="node">
<title>layer15_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1531.5,-126968.82 1359.5,-126968.82 1359.5,-126900.82 1531.5,-126900.82 1531.5,-126968.82"/>
<text text-anchor="middle" x="1445.5" y="-126953.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1445.5" y="-126938.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1445.5" y="-126923.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1445.5" y="-126908.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer15_qkv_ar&#45;&gt;layer15_attn_1 -->
<g id="edge491" class="edge">
<title>layer15_qkv_ar&#45;&gt;layer15_attn_1</title>
<path fill="none" stroke="black" d="M1414.49,-127049.22C1414.49,-127049.22 1414.49,-126978.88 1414.49,-126978.88"/>
<polygon fill="black" stroke="black" points="1417.99,-126978.88 1414.49,-126968.88 1410.99,-126978.88 1417.99,-126978.88"/>
</g>
<!-- layer15_attn_out_0 -->
<g id="node388" class="node">
<title>layer15_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1323.5,-126828.82 1151.5,-126828.82 1151.5,-126760.82 1323.5,-126760.82 1323.5,-126828.82"/>
<text text-anchor="middle" x="1237.5" y="-126813.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1237.5" y="-126798.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1237.5" y="-126783.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1237.5" y="-126768.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer15_attn_0&#45;&gt;layer15_attn_out_0 -->
<g id="edge492" class="edge">
<title>layer15_attn_0&#45;&gt;layer15_attn_out_0</title>
<path fill="none" stroke="black" d="M1237.5,-126900.57C1237.5,-126900.57 1237.5,-126839.2 1237.5,-126839.2"/>
<polygon fill="black" stroke="black" points="1241,-126839.2 1237.5,-126829.2 1234,-126839.2 1241,-126839.2"/>
</g>
<!-- layer15_attn_out_1 -->
<g id="node389" class="node">
<title>layer15_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1531.5,-126828.82 1359.5,-126828.82 1359.5,-126760.82 1531.5,-126760.82 1531.5,-126828.82"/>
<text text-anchor="middle" x="1445.5" y="-126813.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1445.5" y="-126798.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1445.5" y="-126783.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1445.5" y="-126768.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer15_attn_1&#45;&gt;layer15_attn_out_1 -->
<g id="edge493" class="edge">
<title>layer15_attn_1&#45;&gt;layer15_attn_out_1</title>
<path fill="none" stroke="black" d="M1445.5,-126900.57C1445.5,-126900.57 1445.5,-126839.2 1445.5,-126839.2"/>
<polygon fill="black" stroke="black" points="1449,-126839.2 1445.5,-126829.2 1442,-126839.2 1449,-126839.2"/>
</g>
<!-- layer15_attn_ar -->
<g id="node390" class="node">
<title>layer15_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1341.5" cy="-126640.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1341.5" y="-126659.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1341.5" y="-126644.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1341.5" y="-126629.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1341.5" y="-126614.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_attn_out_0&#45;&gt;layer15_attn_ar -->
<g id="edge494" class="edge">
<title>layer15_attn_out_0&#45;&gt;layer15_attn_ar</title>
<path fill="none" stroke="black" d="M1271.69,-126760.63C1271.69,-126760.63 1271.69,-126690.28 1271.69,-126690.28"/>
<polygon fill="black" stroke="black" points="1275.19,-126690.28 1271.69,-126680.28 1268.19,-126690.28 1275.19,-126690.28"/>
</g>
<!-- layer15_attn_out_1&#45;&gt;layer15_attn_ar -->
<g id="edge495" class="edge">
<title>layer15_attn_out_1&#45;&gt;layer15_attn_ar</title>
<path fill="none" stroke="black" d="M1411.31,-126760.63C1411.31,-126760.63 1411.31,-126690.28 1411.31,-126690.28"/>
<polygon fill="black" stroke="black" points="1414.81,-126690.28 1411.31,-126680.28 1407.81,-126690.28 1414.81,-126690.28"/>
</g>
<!-- layer15_ffn_norm_0 -->
<g id="node391" class="node">
<title>layer15_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1319.5,-126520.66 1147.5,-126520.66 1147.5,-126452.66 1319.5,-126452.66 1319.5,-126520.66"/>
<text text-anchor="middle" x="1233.5" y="-126505.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1233.5" y="-126490.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1233.5" y="-126475.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-126460.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_attn_ar&#45;&gt;layer15_ffn_norm_0 -->
<g id="edge496" class="edge">
<title>layer15_attn_ar&#45;&gt;layer15_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1269.69,-126601.86C1269.69,-126601.86 1269.69,-126530.8 1269.69,-126530.8"/>
<polygon fill="black" stroke="black" points="1273.19,-126530.8 1269.69,-126520.8 1266.19,-126530.8 1273.19,-126530.8"/>
</g>
<!-- layer15_ffn_norm_1 -->
<g id="node392" class="node">
<title>layer15_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1536.5,-126520.66 1364.5,-126520.66 1364.5,-126452.66 1536.5,-126452.66 1536.5,-126520.66"/>
<text text-anchor="middle" x="1450.5" y="-126505.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1450.5" y="-126490.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1450.5" y="-126475.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1450.5" y="-126460.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_attn_ar&#45;&gt;layer15_ffn_norm_1 -->
<g id="edge497" class="edge">
<title>layer15_attn_ar&#45;&gt;layer15_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1413.81,-126601.86C1413.81,-126601.86 1413.81,-126530.8 1413.81,-126530.8"/>
<polygon fill="black" stroke="black" points="1417.31,-126530.8 1413.81,-126520.8 1410.31,-126530.8 1417.31,-126530.8"/>
</g>
<!-- layer15_ffn_gate_0 -->
<g id="node393" class="node">
<title>layer15_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1324,-126380.66 1143,-126380.66 1143,-126312.66 1324,-126312.66 1324,-126380.66"/>
<text text-anchor="middle" x="1233.5" y="-126365.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1233.5" y="-126350.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1233.5" y="-126335.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-126320.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_ffn_norm_0&#45;&gt;layer15_ffn_gate_0 -->
<g id="edge498" class="edge">
<title>layer15_ffn_norm_0&#45;&gt;layer15_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1233.5,-126452.41C1233.5,-126452.41 1233.5,-126391.03 1233.5,-126391.03"/>
<polygon fill="black" stroke="black" points="1237,-126391.03 1233.5,-126381.03 1230,-126391.03 1237,-126391.03"/>
</g>
<!-- layer15_ffn_up_0 -->
<g id="node395" class="node">
<title>layer15_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1107,-126380.66 926,-126380.66 926,-126312.66 1107,-126312.66 1107,-126380.66"/>
<text text-anchor="middle" x="1016.5" y="-126365.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1016.5" y="-126350.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1016.5" y="-126335.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-126320.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_ffn_norm_0&#45;&gt;layer15_ffn_up_0 -->
<g id="edge500" class="edge">
<title>layer15_ffn_norm_0&#45;&gt;layer15_ffn_up_0</title>
<path fill="none" stroke="black" d="M1147.31,-126486C1107.86,-126486 1069.76,-126486 1069.76,-126486 1069.76,-126486 1069.76,-126390.74 1069.76,-126390.74"/>
<polygon fill="black" stroke="black" points="1073.26,-126390.74 1069.76,-126380.74 1066.26,-126390.74 1073.26,-126390.74"/>
</g>
<!-- layer15_ffn_gate_1 -->
<g id="node394" class="node">
<title>layer15_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1758,-126380.66 1577,-126380.66 1577,-126312.66 1758,-126312.66 1758,-126380.66"/>
<text text-anchor="middle" x="1667.5" y="-126365.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1667.5" y="-126350.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1667.5" y="-126335.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1667.5" y="-126320.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_ffn_norm_1&#45;&gt;layer15_ffn_gate_1 -->
<g id="edge499" class="edge">
<title>layer15_ffn_norm_1&#45;&gt;layer15_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1536.56,-126486C1575.95,-126486 1614,-126486 1614,-126486 1614,-126486 1614,-126390.74 1614,-126390.74"/>
<polygon fill="black" stroke="black" points="1617.5,-126390.74 1614,-126380.74 1610.5,-126390.74 1617.5,-126390.74"/>
</g>
<!-- layer15_ffn_up_1 -->
<g id="node396" class="node">
<title>layer15_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1541,-126380.66 1360,-126380.66 1360,-126312.66 1541,-126312.66 1541,-126380.66"/>
<text text-anchor="middle" x="1450.5" y="-126365.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1450.5" y="-126350.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1450.5" y="-126335.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1450.5" y="-126320.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_ffn_norm_1&#45;&gt;layer15_ffn_up_1 -->
<g id="edge501" class="edge">
<title>layer15_ffn_norm_1&#45;&gt;layer15_ffn_up_1</title>
<path fill="none" stroke="black" d="M1450.5,-126452.41C1450.5,-126452.41 1450.5,-126391.03 1450.5,-126391.03"/>
<polygon fill="black" stroke="black" points="1454,-126391.03 1450.5,-126381.03 1447,-126391.03 1454,-126391.03"/>
</g>
<!-- layer15_gate_ar -->
<g id="node397" class="node">
<title>layer15_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1541.5" cy="-126192.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1541.5" y="-126211.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1541.5" y="-126196.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1541.5" y="-126181.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1541.5" y="-126166.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer15_ffn_gate_0&#45;&gt;layer15_gate_ar -->
<g id="edge502" class="edge">
<title>layer15_ffn_gate_0&#45;&gt;layer15_gate_ar</title>
<path fill="none" stroke="black" d="M1324.08,-126346C1334.79,-126346 1342,-126346 1342,-126346 1342,-126346 1342,-126208 1342,-126208 1342,-126208 1410.28,-126208 1410.28,-126208"/>
<polygon fill="black" stroke="black" points="1410.28,-126211.5 1420.28,-126208 1410.28,-126204.5 1410.28,-126211.5"/>
</g>
<!-- layer15_ffn_gate_1&#45;&gt;layer15_gate_ar -->
<g id="edge503" class="edge">
<title>layer15_ffn_gate_1&#45;&gt;layer15_gate_ar</title>
<path fill="none" stroke="black" d="M1623.24,-126312.46C1623.24,-126312.46 1623.24,-126239.64 1623.24,-126239.64"/>
<polygon fill="black" stroke="black" points="1626.74,-126239.64 1623.24,-126229.64 1619.74,-126239.64 1626.74,-126239.64"/>
</g>
<!-- layer15_up_ar -->
<g id="node398" class="node">
<title>layer15_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1195.5" cy="-126192.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1195.5" y="-126211.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1195.5" y="-126196.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1195.5" y="-126181.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1195.5" y="-126166.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer15_ffn_up_0&#45;&gt;layer15_up_ar -->
<g id="edge504" class="edge">
<title>layer15_ffn_up_0&#45;&gt;layer15_up_ar</title>
<path fill="none" stroke="black" d="M1087.26,-126312.46C1087.26,-126312.46 1087.26,-126228.54 1087.26,-126228.54"/>
<polygon fill="black" stroke="black" points="1090.76,-126228.54 1087.26,-126218.54 1083.76,-126228.54 1090.76,-126228.54"/>
</g>
<!-- layer15_ffn_up_1&#45;&gt;layer15_up_ar -->
<g id="edge505" class="edge">
<title>layer15_ffn_up_1&#45;&gt;layer15_up_ar</title>
<path fill="none" stroke="black" d="M1386.76,-126312.53C1386.76,-126262.73 1386.76,-126176 1386.76,-126176 1386.76,-126176 1325.81,-126176 1325.81,-126176"/>
<polygon fill="black" stroke="black" points="1325.81,-126172.5 1315.81,-126176 1325.81,-126179.5 1325.81,-126172.5"/>
</g>
<!-- layer15_silu_0 -->
<g id="node399" class="node">
<title>layer15_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1469,-126072.49 1288,-126072.49 1288,-126004.49 1469,-126004.49 1469,-126072.49"/>
<text text-anchor="middle" x="1378.5" y="-126057.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1378.5" y="-126042.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1378.5" y="-126027.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1378.5" y="-126012.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_gate_ar&#45;&gt;layer15_silu_0 -->
<g id="edge506" class="edge">
<title>layer15_gate_ar&#45;&gt;layer15_silu_0</title>
<path fill="none" stroke="black" d="M1441.26,-126162.5C1441.26,-126162.5 1441.26,-126082.51 1441.26,-126082.51"/>
<polygon fill="black" stroke="black" points="1444.76,-126082.51 1441.26,-126072.51 1437.76,-126082.51 1444.76,-126082.51"/>
</g>
<!-- layer15_silu_1 -->
<g id="node400" class="node">
<title>layer15_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1686,-126072.49 1505,-126072.49 1505,-126004.49 1686,-126004.49 1686,-126072.49"/>
<text text-anchor="middle" x="1595.5" y="-126057.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1595.5" y="-126042.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1595.5" y="-126027.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1595.5" y="-126012.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_gate_ar&#45;&gt;layer15_silu_1 -->
<g id="edge507" class="edge">
<title>layer15_gate_ar&#45;&gt;layer15_silu_1</title>
<path fill="none" stroke="black" d="M1587.24,-126147.59C1587.24,-126147.59 1587.24,-126082.5 1587.24,-126082.5"/>
<polygon fill="black" stroke="black" points="1590.74,-126082.5 1587.24,-126072.5 1583.74,-126082.5 1590.74,-126082.5"/>
</g>
<!-- layer15_mul_0 -->
<g id="node401" class="node">
<title>layer15_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1359,-125932.49 1178,-125932.49 1178,-125864.49 1359,-125864.49 1359,-125932.49"/>
<text text-anchor="middle" x="1268.5" y="-125917.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1268.5" y="-125902.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1268.5" y="-125887.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1268.5" y="-125872.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_up_ar&#45;&gt;layer15_mul_0 -->
<g id="edge509" class="edge">
<title>layer15_up_ar&#45;&gt;layer15_mul_0</title>
<path fill="none" stroke="black" d="M1233,-126146.3C1233,-126146.3 1233,-125942.57 1233,-125942.57"/>
<polygon fill="black" stroke="black" points="1236.5,-125942.57 1233,-125932.57 1229.5,-125942.57 1236.5,-125942.57"/>
</g>
<!-- layer15_mul_1 -->
<g id="node402" class="node">
<title>layer15_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1576,-125932.49 1395,-125932.49 1395,-125864.49 1576,-125864.49 1576,-125932.49"/>
<text text-anchor="middle" x="1485.5" y="-125917.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1485.5" y="-125902.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1485.5" y="-125887.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1485.5" y="-125872.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer15_up_ar&#45;&gt;layer15_mul_1 -->
<g id="edge511" class="edge">
<title>layer15_up_ar&#45;&gt;layer15_mul_1</title>
<path fill="none" stroke="black" d="M1305.74,-126168.11C1305.74,-126143.13 1305.74,-126108 1305.74,-126108 1305.74,-126108 1487,-126108 1487,-126108 1487,-126108 1487,-125942.62 1487,-125942.62"/>
<polygon fill="black" stroke="black" points="1490.5,-125942.62 1487,-125932.62 1483.5,-125942.62 1490.5,-125942.62"/>
</g>
<!-- layer15_silu_0&#45;&gt;layer15_mul_0 -->
<g id="edge508" class="edge">
<title>layer15_silu_0&#45;&gt;layer15_mul_0</title>
<path fill="none" stroke="black" d="M1323.5,-126004.24C1323.5,-126004.24 1323.5,-125942.87 1323.5,-125942.87"/>
<polygon fill="black" stroke="black" points="1327,-125942.87 1323.5,-125932.87 1320,-125942.87 1327,-125942.87"/>
</g>
<!-- layer15_silu_1&#45;&gt;layer15_mul_1 -->
<g id="edge510" class="edge">
<title>layer15_silu_1&#45;&gt;layer15_mul_1</title>
<path fill="none" stroke="black" d="M1540.5,-126004.24C1540.5,-126004.24 1540.5,-125942.87 1540.5,-125942.87"/>
<polygon fill="black" stroke="black" points="1544,-125942.87 1540.5,-125932.87 1537,-125942.87 1544,-125942.87"/>
</g>
<!-- layer15_ffn_down_0 -->
<g id="node403" class="node">
<title>layer15_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1358.5,-125792.49 1186.5,-125792.49 1186.5,-125724.49 1358.5,-125724.49 1358.5,-125792.49"/>
<text text-anchor="middle" x="1272.5" y="-125777.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1272.5" y="-125762.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1272.5" y="-125747.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1272.5" y="-125732.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer15_mul_0&#45;&gt;layer15_ffn_down_0 -->
<g id="edge512" class="edge">
<title>layer15_mul_0&#45;&gt;layer15_ffn_down_0</title>
<path fill="none" stroke="black" d="M1272.5,-125864.24C1272.5,-125864.24 1272.5,-125802.87 1272.5,-125802.87"/>
<polygon fill="black" stroke="black" points="1276,-125802.87 1272.5,-125792.87 1269,-125802.87 1276,-125802.87"/>
</g>
<!-- layer15_ffn_down_1 -->
<g id="node404" class="node">
<title>layer15_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1568.5,-125792.49 1396.5,-125792.49 1396.5,-125724.49 1568.5,-125724.49 1568.5,-125792.49"/>
<text text-anchor="middle" x="1482.5" y="-125777.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1482.5" y="-125762.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1482.5" y="-125747.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1482.5" y="-125732.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer15_mul_1&#45;&gt;layer15_ffn_down_1 -->
<g id="edge513" class="edge">
<title>layer15_mul_1&#45;&gt;layer15_ffn_down_1</title>
<path fill="none" stroke="black" d="M1482.5,-125864.24C1482.5,-125864.24 1482.5,-125802.87 1482.5,-125802.87"/>
<polygon fill="black" stroke="black" points="1486,-125802.87 1482.5,-125792.87 1479,-125802.87 1486,-125802.87"/>
</g>
<!-- layer15_ffn_ar -->
<g id="node405" class="node">
<title>layer15_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1376.5" cy="-125604.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1376.5" y="-125623.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1376.5" y="-125608.21" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1376.5" y="-125593.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1376.5" y="-125578.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_ffn_down_0&#45;&gt;layer15_ffn_ar -->
<g id="edge514" class="edge">
<title>layer15_ffn_down_0&#45;&gt;layer15_ffn_ar</title>
<path fill="none" stroke="black" d="M1306.69,-125724.29C1306.69,-125724.29 1306.69,-125653.95 1306.69,-125653.95"/>
<polygon fill="black" stroke="black" points="1310.19,-125653.95 1306.69,-125643.95 1303.19,-125653.95 1310.19,-125653.95"/>
</g>
<!-- layer15_ffn_down_1&#45;&gt;layer15_ffn_ar -->
<g id="edge515" class="edge">
<title>layer15_ffn_down_1&#45;&gt;layer15_ffn_ar</title>
<path fill="none" stroke="black" d="M1447.31,-125724.29C1447.31,-125724.29 1447.31,-125653.67 1447.31,-125653.67"/>
<polygon fill="black" stroke="black" points="1450.81,-125653.67 1447.31,-125643.67 1443.81,-125653.67 1450.81,-125653.67"/>
</g>
<!-- layer16_norm_0 -->
<g id="node406" class="node">
<title>layer16_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1358.5,-125484.32 1186.5,-125484.32 1186.5,-125416.32 1358.5,-125416.32 1358.5,-125484.32"/>
<text text-anchor="middle" x="1272.5" y="-125469.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1272.5" y="-125454.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1272.5" y="-125439.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1272.5" y="-125424.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_ffn_ar&#45;&gt;layer16_norm_0 -->
<g id="edge516" class="edge">
<title>layer15_ffn_ar&#45;&gt;layer16_norm_0</title>
<path fill="none" stroke="black" d="M1306.69,-125564.73C1306.69,-125564.73 1306.69,-125494.38 1306.69,-125494.38"/>
<polygon fill="black" stroke="black" points="1310.19,-125494.38 1306.69,-125484.38 1303.19,-125494.38 1310.19,-125494.38"/>
</g>
<!-- layer16_norm_1 -->
<g id="node407" class="node">
<title>layer16_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1568.5,-125484.32 1396.5,-125484.32 1396.5,-125416.32 1568.5,-125416.32 1568.5,-125484.32"/>
<text text-anchor="middle" x="1482.5" y="-125469.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1482.5" y="-125454.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1482.5" y="-125439.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1482.5" y="-125424.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_ffn_ar&#45;&gt;layer16_norm_1 -->
<g id="edge517" class="edge">
<title>layer15_ffn_ar&#45;&gt;layer16_norm_1</title>
<path fill="none" stroke="black" d="M1447.31,-125565.13C1447.31,-125565.13 1447.31,-125494.55 1447.31,-125494.55"/>
<polygon fill="black" stroke="black" points="1450.81,-125494.55 1447.31,-125484.55 1443.81,-125494.55 1450.81,-125494.55"/>
</g>
<!-- layer16_qkv_0 -->
<g id="node408" class="node">
<title>layer16_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1359,-125344.32 1178,-125344.32 1178,-125276.32 1359,-125276.32 1359,-125344.32"/>
<text text-anchor="middle" x="1268.5" y="-125329.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1268.5" y="-125314.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1268.5" y="-125299.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-125284.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer16_norm_0&#45;&gt;layer16_qkv_0 -->
<g id="edge518" class="edge">
<title>layer16_norm_0&#45;&gt;layer16_qkv_0</title>
<path fill="none" stroke="black" d="M1272.5,-125416.07C1272.5,-125416.07 1272.5,-125354.7 1272.5,-125354.7"/>
<polygon fill="black" stroke="black" points="1276,-125354.7 1272.5,-125344.7 1269,-125354.7 1276,-125354.7"/>
</g>
<!-- layer16_qkv_1 -->
<g id="node409" class="node">
<title>layer16_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1576,-125344.32 1395,-125344.32 1395,-125276.32 1576,-125276.32 1576,-125344.32"/>
<text text-anchor="middle" x="1485.5" y="-125329.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1485.5" y="-125314.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1485.5" y="-125299.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1485.5" y="-125284.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer16_norm_1&#45;&gt;layer16_qkv_1 -->
<g id="edge519" class="edge">
<title>layer16_norm_1&#45;&gt;layer16_qkv_1</title>
<path fill="none" stroke="black" d="M1482.5,-125416.07C1482.5,-125416.07 1482.5,-125354.7 1482.5,-125354.7"/>
<polygon fill="black" stroke="black" points="1486,-125354.7 1482.5,-125344.7 1479,-125354.7 1486,-125354.7"/>
</g>
<!-- layer16_qkv_ar -->
<g id="node410" class="node">
<title>layer16_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1376.5" cy="-125156.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1376.5" y="-125175.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1376.5" y="-125160.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1376.5" y="-125145.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1376.5" y="-125130.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer16_qkv_0&#45;&gt;layer16_qkv_ar -->
<g id="edge520" class="edge">
<title>layer16_qkv_0&#45;&gt;layer16_qkv_ar</title>
<path fill="none" stroke="black" d="M1303.76,-125276.13C1303.76,-125276.13 1303.76,-125206.06 1303.76,-125206.06"/>
<polygon fill="black" stroke="black" points="1307.26,-125206.06 1303.76,-125196.06 1300.26,-125206.06 1307.26,-125206.06"/>
</g>
<!-- layer16_qkv_1&#45;&gt;layer16_qkv_ar -->
<g id="edge521" class="edge">
<title>layer16_qkv_1&#45;&gt;layer16_qkv_ar</title>
<path fill="none" stroke="black" d="M1449.74,-125276.13C1449.74,-125276.13 1449.74,-125205.78 1449.74,-125205.78"/>
<polygon fill="black" stroke="black" points="1453.24,-125205.78 1449.74,-125195.78 1446.24,-125205.78 1453.24,-125205.78"/>
</g>
<!-- layer16_attn_0 -->
<g id="node411" class="node">
<title>layer16_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1358.5,-125036.16 1186.5,-125036.16 1186.5,-124968.16 1358.5,-124968.16 1358.5,-125036.16"/>
<text text-anchor="middle" x="1272.5" y="-125020.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1272.5" y="-125005.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1272.5" y="-124990.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1272.5" y="-124975.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer16_qkv_ar&#45;&gt;layer16_attn_0 -->
<g id="edge522" class="edge">
<title>layer16_qkv_ar&#45;&gt;layer16_attn_0</title>
<path fill="none" stroke="black" d="M1303.51,-125116.56C1303.51,-125116.56 1303.51,-125046.21 1303.51,-125046.21"/>
<polygon fill="black" stroke="black" points="1307.01,-125046.21 1303.51,-125036.21 1300.01,-125046.21 1307.01,-125046.21"/>
</g>
<!-- layer16_attn_1 -->
<g id="node412" class="node">
<title>layer16_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1566.5,-125036.16 1394.5,-125036.16 1394.5,-124968.16 1566.5,-124968.16 1566.5,-125036.16"/>
<text text-anchor="middle" x="1480.5" y="-125020.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1480.5" y="-125005.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1480.5" y="-124990.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1480.5" y="-124975.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer16_qkv_ar&#45;&gt;layer16_attn_1 -->
<g id="edge523" class="edge">
<title>layer16_qkv_ar&#45;&gt;layer16_attn_1</title>
<path fill="none" stroke="black" d="M1449.49,-125116.56C1449.49,-125116.56 1449.49,-125046.21 1449.49,-125046.21"/>
<polygon fill="black" stroke="black" points="1452.99,-125046.21 1449.49,-125036.21 1445.99,-125046.21 1452.99,-125046.21"/>
</g>
<!-- layer16_attn_out_0 -->
<g id="node413" class="node">
<title>layer16_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1358.5,-124896.16 1186.5,-124896.16 1186.5,-124828.16 1358.5,-124828.16 1358.5,-124896.16"/>
<text text-anchor="middle" x="1272.5" y="-124880.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1272.5" y="-124865.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1272.5" y="-124850.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1272.5" y="-124835.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer16_attn_0&#45;&gt;layer16_attn_out_0 -->
<g id="edge524" class="edge">
<title>layer16_attn_0&#45;&gt;layer16_attn_out_0</title>
<path fill="none" stroke="black" d="M1272.5,-124967.91C1272.5,-124967.91 1272.5,-124906.54 1272.5,-124906.54"/>
<polygon fill="black" stroke="black" points="1276,-124906.54 1272.5,-124896.54 1269,-124906.54 1276,-124906.54"/>
</g>
<!-- layer16_attn_out_1 -->
<g id="node414" class="node">
<title>layer16_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1566.5,-124896.16 1394.5,-124896.16 1394.5,-124828.16 1566.5,-124828.16 1566.5,-124896.16"/>
<text text-anchor="middle" x="1480.5" y="-124880.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1480.5" y="-124865.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1480.5" y="-124850.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1480.5" y="-124835.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer16_attn_1&#45;&gt;layer16_attn_out_1 -->
<g id="edge525" class="edge">
<title>layer16_attn_1&#45;&gt;layer16_attn_out_1</title>
<path fill="none" stroke="black" d="M1480.5,-124967.91C1480.5,-124967.91 1480.5,-124906.54 1480.5,-124906.54"/>
<polygon fill="black" stroke="black" points="1484,-124906.54 1480.5,-124896.54 1477,-124906.54 1484,-124906.54"/>
</g>
<!-- layer16_attn_ar -->
<g id="node415" class="node">
<title>layer16_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1376.5" cy="-124708.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1376.5" y="-124726.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1376.5" y="-124711.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1376.5" y="-124696.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1376.5" y="-124681.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_attn_out_0&#45;&gt;layer16_attn_ar -->
<g id="edge526" class="edge">
<title>layer16_attn_out_0&#45;&gt;layer16_attn_ar</title>
<path fill="none" stroke="black" d="M1306.69,-124827.96C1306.69,-124827.96 1306.69,-124757.62 1306.69,-124757.62"/>
<polygon fill="black" stroke="black" points="1310.19,-124757.62 1306.69,-124747.62 1303.19,-124757.62 1310.19,-124757.62"/>
</g>
<!-- layer16_attn_out_1&#45;&gt;layer16_attn_ar -->
<g id="edge527" class="edge">
<title>layer16_attn_out_1&#45;&gt;layer16_attn_ar</title>
<path fill="none" stroke="black" d="M1446.31,-124827.96C1446.31,-124827.96 1446.31,-124757.62 1446.31,-124757.62"/>
<polygon fill="black" stroke="black" points="1449.81,-124757.62 1446.31,-124747.62 1442.81,-124757.62 1449.81,-124757.62"/>
</g>
<!-- layer16_ffn_norm_0 -->
<g id="node416" class="node">
<title>layer16_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1354.5,-124587.99 1182.5,-124587.99 1182.5,-124519.99 1354.5,-124519.99 1354.5,-124587.99"/>
<text text-anchor="middle" x="1268.5" y="-124572.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1268.5" y="-124557.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1268.5" y="-124542.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-124527.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_attn_ar&#45;&gt;layer16_ffn_norm_0 -->
<g id="edge528" class="edge">
<title>layer16_attn_ar&#45;&gt;layer16_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1304.69,-124669.19C1304.69,-124669.19 1304.69,-124598.14 1304.69,-124598.14"/>
<polygon fill="black" stroke="black" points="1308.19,-124598.14 1304.69,-124588.14 1301.19,-124598.14 1308.19,-124598.14"/>
</g>
<!-- layer16_ffn_norm_1 -->
<g id="node417" class="node">
<title>layer16_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1571.5,-124587.99 1399.5,-124587.99 1399.5,-124519.99 1571.5,-124519.99 1571.5,-124587.99"/>
<text text-anchor="middle" x="1485.5" y="-124572.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1485.5" y="-124557.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1485.5" y="-124542.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1485.5" y="-124527.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_attn_ar&#45;&gt;layer16_ffn_norm_1 -->
<g id="edge529" class="edge">
<title>layer16_attn_ar&#45;&gt;layer16_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1448.81,-124669.19C1448.81,-124669.19 1448.81,-124598.14 1448.81,-124598.14"/>
<polygon fill="black" stroke="black" points="1452.31,-124598.14 1448.81,-124588.14 1445.31,-124598.14 1452.31,-124598.14"/>
</g>
<!-- layer16_ffn_gate_0 -->
<g id="node418" class="node">
<title>layer16_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1359,-124447.99 1178,-124447.99 1178,-124379.99 1359,-124379.99 1359,-124447.99"/>
<text text-anchor="middle" x="1268.5" y="-124432.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1268.5" y="-124417.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1268.5" y="-124402.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-124387.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_ffn_norm_0&#45;&gt;layer16_ffn_gate_0 -->
<g id="edge530" class="edge">
<title>layer16_ffn_norm_0&#45;&gt;layer16_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1268.5,-124519.74C1268.5,-124519.74 1268.5,-124458.37 1268.5,-124458.37"/>
<polygon fill="black" stroke="black" points="1272,-124458.37 1268.5,-124448.37 1265,-124458.37 1272,-124458.37"/>
</g>
<!-- layer16_ffn_up_0 -->
<g id="node420" class="node">
<title>layer16_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1142,-124447.99 961,-124447.99 961,-124379.99 1142,-124379.99 1142,-124447.99"/>
<text text-anchor="middle" x="1051.5" y="-124432.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1051.5" y="-124417.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1051.5" y="-124402.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-124387.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_ffn_norm_0&#45;&gt;layer16_ffn_up_0 -->
<g id="edge532" class="edge">
<title>layer16_ffn_norm_0&#45;&gt;layer16_ffn_up_0</title>
<path fill="none" stroke="black" d="M1182.31,-124553C1142.86,-124553 1104.76,-124553 1104.76,-124553 1104.76,-124553 1104.76,-124458 1104.76,-124458"/>
<polygon fill="black" stroke="black" points="1108.26,-124458 1104.76,-124448 1101.26,-124458 1108.26,-124458"/>
</g>
<!-- layer16_ffn_gate_1 -->
<g id="node419" class="node">
<title>layer16_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1793,-124447.99 1612,-124447.99 1612,-124379.99 1793,-124379.99 1793,-124447.99"/>
<text text-anchor="middle" x="1702.5" y="-124432.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1702.5" y="-124417.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1702.5" y="-124402.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1702.5" y="-124387.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_ffn_norm_1&#45;&gt;layer16_ffn_gate_1 -->
<g id="edge531" class="edge">
<title>layer16_ffn_norm_1&#45;&gt;layer16_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1571.56,-124553C1610.95,-124553 1649,-124553 1649,-124553 1649,-124553 1649,-124458 1649,-124458"/>
<polygon fill="black" stroke="black" points="1652.5,-124458 1649,-124448 1645.5,-124458 1652.5,-124458"/>
</g>
<!-- layer16_ffn_up_1 -->
<g id="node421" class="node">
<title>layer16_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1576,-124447.99 1395,-124447.99 1395,-124379.99 1576,-124379.99 1576,-124447.99"/>
<text text-anchor="middle" x="1485.5" y="-124432.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1485.5" y="-124417.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1485.5" y="-124402.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1485.5" y="-124387.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_ffn_norm_1&#45;&gt;layer16_ffn_up_1 -->
<g id="edge533" class="edge">
<title>layer16_ffn_norm_1&#45;&gt;layer16_ffn_up_1</title>
<path fill="none" stroke="black" d="M1485.5,-124519.74C1485.5,-124519.74 1485.5,-124458.37 1485.5,-124458.37"/>
<polygon fill="black" stroke="black" points="1489,-124458.37 1485.5,-124448.37 1482,-124458.37 1489,-124458.37"/>
</g>
<!-- layer16_gate_ar -->
<g id="node422" class="node">
<title>layer16_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1576.5" cy="-124259.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1576.5" y="-124278.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1576.5" y="-124263.71" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1576.5" y="-124248.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1576.5" y="-124233.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer16_ffn_gate_0&#45;&gt;layer16_gate_ar -->
<g id="edge534" class="edge">
<title>layer16_ffn_gate_0&#45;&gt;layer16_gate_ar</title>
<path fill="none" stroke="black" d="M1359.08,-124413C1369.79,-124413 1377,-124413 1377,-124413 1377,-124413 1377,-124275 1377,-124275 1377,-124275 1444.7,-124275 1444.7,-124275"/>
<polygon fill="black" stroke="black" points="1444.7,-124278.5 1454.7,-124275 1444.7,-124271.5 1444.7,-124278.5"/>
</g>
<!-- layer16_ffn_gate_1&#45;&gt;layer16_gate_ar -->
<g id="edge535" class="edge">
<title>layer16_ffn_gate_1&#45;&gt;layer16_gate_ar</title>
<path fill="none" stroke="black" d="M1658.24,-124379.79C1658.24,-124379.79 1658.24,-124306.97 1658.24,-124306.97"/>
<polygon fill="black" stroke="black" points="1661.74,-124306.97 1658.24,-124296.97 1654.74,-124306.97 1661.74,-124306.97"/>
</g>
<!-- layer16_up_ar -->
<g id="node423" class="node">
<title>layer16_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1230.5" cy="-124259.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1230.5" y="-124278.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1230.5" y="-124263.71" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1230.5" y="-124248.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1230.5" y="-124233.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer16_ffn_up_0&#45;&gt;layer16_up_ar -->
<g id="edge536" class="edge">
<title>layer16_ffn_up_0&#45;&gt;layer16_up_ar</title>
<path fill="none" stroke="black" d="M1122.26,-124379.79C1122.26,-124379.79 1122.26,-124295.87 1122.26,-124295.87"/>
<polygon fill="black" stroke="black" points="1125.76,-124295.87 1122.26,-124285.87 1118.76,-124295.87 1125.76,-124295.87"/>
</g>
<!-- layer16_ffn_up_1&#45;&gt;layer16_up_ar -->
<g id="edge537" class="edge">
<title>layer16_ffn_up_1&#45;&gt;layer16_up_ar</title>
<path fill="none" stroke="black" d="M1421.76,-124379.8C1421.76,-124329.9 1421.76,-124243 1421.76,-124243 1421.76,-124243 1360.54,-124243 1360.54,-124243"/>
<polygon fill="black" stroke="black" points="1360.54,-124239.5 1350.54,-124243 1360.54,-124246.5 1360.54,-124239.5"/>
</g>
<!-- layer16_silu_0 -->
<g id="node424" class="node">
<title>layer16_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1504,-124139.82 1323,-124139.82 1323,-124071.82 1504,-124071.82 1504,-124139.82"/>
<text text-anchor="middle" x="1413.5" y="-124124.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1413.5" y="-124109.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1413.5" y="-124094.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1413.5" y="-124079.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_gate_ar&#45;&gt;layer16_silu_0 -->
<g id="edge538" class="edge">
<title>layer16_gate_ar&#45;&gt;layer16_silu_0</title>
<path fill="none" stroke="black" d="M1476.26,-124229.83C1476.26,-124229.83 1476.26,-124149.84 1476.26,-124149.84"/>
<polygon fill="black" stroke="black" points="1479.76,-124149.84 1476.26,-124139.84 1472.76,-124149.84 1479.76,-124149.84"/>
</g>
<!-- layer16_silu_1 -->
<g id="node425" class="node">
<title>layer16_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1721,-124139.82 1540,-124139.82 1540,-124071.82 1721,-124071.82 1721,-124139.82"/>
<text text-anchor="middle" x="1630.5" y="-124124.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1630.5" y="-124109.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1630.5" y="-124094.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1630.5" y="-124079.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_gate_ar&#45;&gt;layer16_silu_1 -->
<g id="edge539" class="edge">
<title>layer16_gate_ar&#45;&gt;layer16_silu_1</title>
<path fill="none" stroke="black" d="M1622.24,-124214.92C1622.24,-124214.92 1622.24,-124149.83 1622.24,-124149.83"/>
<polygon fill="black" stroke="black" points="1625.74,-124149.83 1622.24,-124139.83 1618.74,-124149.83 1625.74,-124149.83"/>
</g>
<!-- layer16_mul_0 -->
<g id="node426" class="node">
<title>layer16_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1394,-123999.82 1213,-123999.82 1213,-123931.82 1394,-123931.82 1394,-123999.82"/>
<text text-anchor="middle" x="1303.5" y="-123984.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1303.5" y="-123969.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1303.5" y="-123954.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1303.5" y="-123939.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_up_ar&#45;&gt;layer16_mul_0 -->
<g id="edge541" class="edge">
<title>layer16_up_ar&#45;&gt;layer16_mul_0</title>
<path fill="none" stroke="black" d="M1268,-124213.63C1268,-124213.63 1268,-124009.91 1268,-124009.91"/>
<polygon fill="black" stroke="black" points="1271.5,-124009.91 1268,-123999.91 1264.5,-124009.91 1271.5,-124009.91"/>
</g>
<!-- layer16_mul_1 -->
<g id="node427" class="node">
<title>layer16_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1611,-123999.82 1430,-123999.82 1430,-123931.82 1611,-123931.82 1611,-123999.82"/>
<text text-anchor="middle" x="1520.5" y="-123984.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1520.5" y="-123969.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1520.5" y="-123954.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1520.5" y="-123939.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer16_up_ar&#45;&gt;layer16_mul_1 -->
<g id="edge543" class="edge">
<title>layer16_up_ar&#45;&gt;layer16_mul_1</title>
<path fill="none" stroke="black" d="M1340.74,-124235.35C1340.74,-124210.27 1340.74,-124175 1340.74,-124175 1340.74,-124175 1522,-124175 1522,-124175 1522,-124175 1522,-124009.9 1522,-124009.9"/>
<polygon fill="black" stroke="black" points="1525.5,-124009.9 1522,-123999.9 1518.5,-124009.9 1525.5,-124009.9"/>
</g>
<!-- layer16_silu_0&#45;&gt;layer16_mul_0 -->
<g id="edge540" class="edge">
<title>layer16_silu_0&#45;&gt;layer16_mul_0</title>
<path fill="none" stroke="black" d="M1358.5,-124071.57C1358.5,-124071.57 1358.5,-124010.2 1358.5,-124010.2"/>
<polygon fill="black" stroke="black" points="1362,-124010.2 1358.5,-124000.2 1355,-124010.2 1362,-124010.2"/>
</g>
<!-- layer16_silu_1&#45;&gt;layer16_mul_1 -->
<g id="edge542" class="edge">
<title>layer16_silu_1&#45;&gt;layer16_mul_1</title>
<path fill="none" stroke="black" d="M1575.5,-124071.57C1575.5,-124071.57 1575.5,-124010.2 1575.5,-124010.2"/>
<polygon fill="black" stroke="black" points="1579,-124010.2 1575.5,-124000.2 1572,-124010.2 1579,-124010.2"/>
</g>
<!-- layer16_ffn_down_0 -->
<g id="node428" class="node">
<title>layer16_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1393.5,-123859.82 1221.5,-123859.82 1221.5,-123791.82 1393.5,-123791.82 1393.5,-123859.82"/>
<text text-anchor="middle" x="1307.5" y="-123844.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1307.5" y="-123829.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1307.5" y="-123814.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1307.5" y="-123799.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer16_mul_0&#45;&gt;layer16_ffn_down_0 -->
<g id="edge544" class="edge">
<title>layer16_mul_0&#45;&gt;layer16_ffn_down_0</title>
<path fill="none" stroke="black" d="M1307.5,-123931.57C1307.5,-123931.57 1307.5,-123870.2 1307.5,-123870.2"/>
<polygon fill="black" stroke="black" points="1311,-123870.2 1307.5,-123860.2 1304,-123870.2 1311,-123870.2"/>
</g>
<!-- layer16_ffn_down_1 -->
<g id="node429" class="node">
<title>layer16_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1603.5,-123859.82 1431.5,-123859.82 1431.5,-123791.82 1603.5,-123791.82 1603.5,-123859.82"/>
<text text-anchor="middle" x="1517.5" y="-123844.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1517.5" y="-123829.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1517.5" y="-123814.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1517.5" y="-123799.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer16_mul_1&#45;&gt;layer16_ffn_down_1 -->
<g id="edge545" class="edge">
<title>layer16_mul_1&#45;&gt;layer16_ffn_down_1</title>
<path fill="none" stroke="black" d="M1517.5,-123931.57C1517.5,-123931.57 1517.5,-123870.2 1517.5,-123870.2"/>
<polygon fill="black" stroke="black" points="1521,-123870.2 1517.5,-123860.2 1514,-123870.2 1521,-123870.2"/>
</g>
<!-- layer16_ffn_ar -->
<g id="node430" class="node">
<title>layer16_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1385.5" cy="-123671.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1385.5" y="-123690.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1385.5" y="-123675.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1385.5" y="-123660.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1385.5" y="-123645.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_ffn_down_0&#45;&gt;layer16_ffn_ar -->
<g id="edge546" class="edge">
<title>layer16_ffn_down_0&#45;&gt;layer16_ffn_ar</title>
<path fill="none" stroke="black" d="M1328.69,-123791.63C1328.69,-123791.63 1328.69,-123724.38 1328.69,-123724.38"/>
<polygon fill="black" stroke="black" points="1332.19,-123724.38 1328.69,-123714.38 1325.19,-123724.38 1332.19,-123724.38"/>
</g>
<!-- layer16_ffn_down_1&#45;&gt;layer16_ffn_ar -->
<g id="edge547" class="edge">
<title>layer16_ffn_down_1&#45;&gt;layer16_ffn_ar</title>
<path fill="none" stroke="black" d="M1469.31,-123791.63C1469.31,-123791.63 1469.31,-123716.64 1469.31,-123716.64"/>
<polygon fill="black" stroke="black" points="1472.81,-123716.64 1469.31,-123706.64 1465.81,-123716.64 1472.81,-123716.64"/>
</g>
<!-- layer17_norm_0 -->
<g id="node431" class="node">
<title>layer17_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1367.5,-123551.66 1195.5,-123551.66 1195.5,-123483.66 1367.5,-123483.66 1367.5,-123551.66"/>
<text text-anchor="middle" x="1281.5" y="-123536.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1281.5" y="-123521.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1281.5" y="-123506.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1281.5" y="-123491.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_ffn_ar&#45;&gt;layer17_norm_0 -->
<g id="edge548" class="edge">
<title>layer16_ffn_ar&#45;&gt;layer17_norm_0</title>
<path fill="none" stroke="black" d="M1315.69,-123632.06C1315.69,-123632.06 1315.69,-123561.71 1315.69,-123561.71"/>
<polygon fill="black" stroke="black" points="1319.19,-123561.71 1315.69,-123551.71 1312.19,-123561.71 1319.19,-123561.71"/>
</g>
<!-- layer17_norm_1 -->
<g id="node432" class="node">
<title>layer17_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1577.5,-123551.66 1405.5,-123551.66 1405.5,-123483.66 1577.5,-123483.66 1577.5,-123551.66"/>
<text text-anchor="middle" x="1491.5" y="-123536.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1491.5" y="-123521.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1491.5" y="-123506.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1491.5" y="-123491.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_ffn_ar&#45;&gt;layer17_norm_1 -->
<g id="edge549" class="edge">
<title>layer16_ffn_ar&#45;&gt;layer17_norm_1</title>
<path fill="none" stroke="black" d="M1456.31,-123632.46C1456.31,-123632.46 1456.31,-123561.89 1456.31,-123561.89"/>
<polygon fill="black" stroke="black" points="1459.81,-123561.89 1456.31,-123551.89 1452.81,-123561.89 1459.81,-123561.89"/>
</g>
<!-- layer17_qkv_0 -->
<g id="node433" class="node">
<title>layer17_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1368,-123411.66 1187,-123411.66 1187,-123343.66 1368,-123343.66 1368,-123411.66"/>
<text text-anchor="middle" x="1277.5" y="-123396.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1277.5" y="-123381.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1277.5" y="-123366.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1277.5" y="-123351.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer17_norm_0&#45;&gt;layer17_qkv_0 -->
<g id="edge550" class="edge">
<title>layer17_norm_0&#45;&gt;layer17_qkv_0</title>
<path fill="none" stroke="black" d="M1281.5,-123483.41C1281.5,-123483.41 1281.5,-123422.04 1281.5,-123422.04"/>
<polygon fill="black" stroke="black" points="1285,-123422.04 1281.5,-123412.04 1278,-123422.04 1285,-123422.04"/>
</g>
<!-- layer17_qkv_1 -->
<g id="node434" class="node">
<title>layer17_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1585,-123411.66 1404,-123411.66 1404,-123343.66 1585,-123343.66 1585,-123411.66"/>
<text text-anchor="middle" x="1494.5" y="-123396.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1494.5" y="-123381.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1494.5" y="-123366.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1494.5" y="-123351.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer17_norm_1&#45;&gt;layer17_qkv_1 -->
<g id="edge551" class="edge">
<title>layer17_norm_1&#45;&gt;layer17_qkv_1</title>
<path fill="none" stroke="black" d="M1491.5,-123483.41C1491.5,-123483.41 1491.5,-123422.04 1491.5,-123422.04"/>
<polygon fill="black" stroke="black" points="1495,-123422.04 1491.5,-123412.04 1488,-123422.04 1495,-123422.04"/>
</g>
<!-- layer17_qkv_ar -->
<g id="node435" class="node">
<title>layer17_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1370.5" cy="-123223.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1370.5" y="-123242.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1370.5" y="-123227.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1370.5" y="-123212.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1370.5" y="-123197.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer17_qkv_0&#45;&gt;layer17_qkv_ar -->
<g id="edge552" class="edge">
<title>layer17_qkv_0&#45;&gt;layer17_qkv_ar</title>
<path fill="none" stroke="black" d="M1305.26,-123343.46C1305.26,-123343.46 1305.26,-123275.08 1305.26,-123275.08"/>
<polygon fill="black" stroke="black" points="1308.76,-123275.08 1305.26,-123265.08 1301.76,-123275.08 1308.76,-123275.08"/>
</g>
<!-- layer17_qkv_1&#45;&gt;layer17_qkv_ar -->
<g id="edge553" class="edge">
<title>layer17_qkv_1&#45;&gt;layer17_qkv_ar</title>
<path fill="none" stroke="black" d="M1451.24,-123343.46C1451.24,-123343.46 1451.24,-123270.91 1451.24,-123270.91"/>
<polygon fill="black" stroke="black" points="1454.74,-123270.91 1451.24,-123260.91 1447.74,-123270.91 1454.74,-123270.91"/>
</g>
<!-- layer17_attn_0 -->
<g id="node436" class="node">
<title>layer17_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1352.5,-123103.49 1180.5,-123103.49 1180.5,-123035.49 1352.5,-123035.49 1352.5,-123103.49"/>
<text text-anchor="middle" x="1266.5" y="-123088.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1266.5" y="-123073.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1266.5" y="-123058.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1266.5" y="-123043.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer17_qkv_ar&#45;&gt;layer17_attn_0 -->
<g id="edge554" class="edge">
<title>layer17_qkv_ar&#45;&gt;layer17_attn_0</title>
<path fill="none" stroke="black" d="M1297.51,-123183.89C1297.51,-123183.89 1297.51,-123113.55 1297.51,-123113.55"/>
<polygon fill="black" stroke="black" points="1301.01,-123113.55 1297.51,-123103.55 1294.01,-123113.55 1301.01,-123113.55"/>
</g>
<!-- layer17_attn_1 -->
<g id="node437" class="node">
<title>layer17_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1560.5,-123103.49 1388.5,-123103.49 1388.5,-123035.49 1560.5,-123035.49 1560.5,-123103.49"/>
<text text-anchor="middle" x="1474.5" y="-123088.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1474.5" y="-123073.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1474.5" y="-123058.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1474.5" y="-123043.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer17_qkv_ar&#45;&gt;layer17_attn_1 -->
<g id="edge555" class="edge">
<title>layer17_qkv_ar&#45;&gt;layer17_attn_1</title>
<path fill="none" stroke="black" d="M1443.49,-123183.89C1443.49,-123183.89 1443.49,-123113.55 1443.49,-123113.55"/>
<polygon fill="black" stroke="black" points="1446.99,-123113.55 1443.49,-123103.55 1439.99,-123113.55 1446.99,-123113.55"/>
</g>
<!-- layer17_attn_out_0 -->
<g id="node438" class="node">
<title>layer17_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1352.5,-122963.49 1180.5,-122963.49 1180.5,-122895.49 1352.5,-122895.49 1352.5,-122963.49"/>
<text text-anchor="middle" x="1266.5" y="-122948.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1266.5" y="-122933.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1266.5" y="-122918.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1266.5" y="-122903.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer17_attn_0&#45;&gt;layer17_attn_out_0 -->
<g id="edge556" class="edge">
<title>layer17_attn_0&#45;&gt;layer17_attn_out_0</title>
<path fill="none" stroke="black" d="M1266.5,-123035.24C1266.5,-123035.24 1266.5,-122973.87 1266.5,-122973.87"/>
<polygon fill="black" stroke="black" points="1270,-122973.87 1266.5,-122963.87 1263,-122973.87 1270,-122973.87"/>
</g>
<!-- layer17_attn_out_1 -->
<g id="node439" class="node">
<title>layer17_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1560.5,-122963.49 1388.5,-122963.49 1388.5,-122895.49 1560.5,-122895.49 1560.5,-122963.49"/>
<text text-anchor="middle" x="1474.5" y="-122948.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1474.5" y="-122933.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1474.5" y="-122918.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1474.5" y="-122903.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer17_attn_1&#45;&gt;layer17_attn_out_1 -->
<g id="edge557" class="edge">
<title>layer17_attn_1&#45;&gt;layer17_attn_out_1</title>
<path fill="none" stroke="black" d="M1474.5,-123035.24C1474.5,-123035.24 1474.5,-122973.87 1474.5,-122973.87"/>
<polygon fill="black" stroke="black" points="1478,-122973.87 1474.5,-122963.87 1471,-122973.87 1478,-122973.87"/>
</g>
<!-- layer17_attn_ar -->
<g id="node440" class="node">
<title>layer17_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1365.5" cy="-122775.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1365.5" y="-122794.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1365.5" y="-122779.21" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1365.5" y="-122764.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1365.5" y="-122749.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_attn_out_0&#45;&gt;layer17_attn_ar -->
<g id="edge558" class="edge">
<title>layer17_attn_out_0&#45;&gt;layer17_attn_ar</title>
<path fill="none" stroke="black" d="M1298.19,-122895.29C1298.19,-122895.29 1298.19,-122825.51 1298.19,-122825.51"/>
<polygon fill="black" stroke="black" points="1301.69,-122825.51 1298.19,-122815.51 1294.69,-122825.51 1301.69,-122825.51"/>
</g>
<!-- layer17_attn_out_1&#45;&gt;layer17_attn_ar -->
<g id="edge559" class="edge">
<title>layer17_attn_out_1&#45;&gt;layer17_attn_ar</title>
<path fill="none" stroke="black" d="M1437.81,-122895.29C1437.81,-122895.29 1437.81,-122824.12 1437.81,-122824.12"/>
<polygon fill="black" stroke="black" points="1441.31,-122824.12 1437.81,-122814.12 1434.31,-122824.12 1441.31,-122824.12"/>
</g>
<!-- layer17_ffn_norm_0 -->
<g id="node441" class="node">
<title>layer17_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1343.5,-122655.32 1171.5,-122655.32 1171.5,-122587.32 1343.5,-122587.32 1343.5,-122655.32"/>
<text text-anchor="middle" x="1257.5" y="-122640.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1257.5" y="-122625.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1257.5" y="-122610.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1257.5" y="-122595.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_attn_ar&#45;&gt;layer17_ffn_norm_0 -->
<g id="edge560" class="edge">
<title>layer17_attn_ar&#45;&gt;layer17_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1293.69,-122736.52C1293.69,-122736.52 1293.69,-122665.47 1293.69,-122665.47"/>
<polygon fill="black" stroke="black" points="1297.19,-122665.47 1293.69,-122655.47 1290.19,-122665.47 1297.19,-122665.47"/>
</g>
<!-- layer17_ffn_norm_1 -->
<g id="node442" class="node">
<title>layer17_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1560.5,-122655.32 1388.5,-122655.32 1388.5,-122587.32 1560.5,-122587.32 1560.5,-122655.32"/>
<text text-anchor="middle" x="1474.5" y="-122640.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1474.5" y="-122625.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1474.5" y="-122610.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1474.5" y="-122595.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_attn_ar&#45;&gt;layer17_ffn_norm_1 -->
<g id="edge561" class="edge">
<title>layer17_attn_ar&#45;&gt;layer17_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1437.81,-122736.52C1437.81,-122736.52 1437.81,-122665.47 1437.81,-122665.47"/>
<polygon fill="black" stroke="black" points="1441.31,-122665.47 1437.81,-122655.47 1434.31,-122665.47 1441.31,-122665.47"/>
</g>
<!-- layer17_ffn_gate_0 -->
<g id="node443" class="node">
<title>layer17_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1348,-122515.32 1167,-122515.32 1167,-122447.32 1348,-122447.32 1348,-122515.32"/>
<text text-anchor="middle" x="1257.5" y="-122500.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1257.5" y="-122485.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1257.5" y="-122470.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1257.5" y="-122455.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_ffn_norm_0&#45;&gt;layer17_ffn_gate_0 -->
<g id="edge562" class="edge">
<title>layer17_ffn_norm_0&#45;&gt;layer17_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1257.5,-122587.08C1257.5,-122587.08 1257.5,-122525.7 1257.5,-122525.7"/>
<polygon fill="black" stroke="black" points="1261,-122525.7 1257.5,-122515.7 1254,-122525.7 1261,-122525.7"/>
</g>
<!-- layer17_ffn_up_0 -->
<g id="node445" class="node">
<title>layer17_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1131,-122515.32 950,-122515.32 950,-122447.32 1131,-122447.32 1131,-122515.32"/>
<text text-anchor="middle" x="1040.5" y="-122500.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1040.5" y="-122485.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1040.5" y="-122470.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1040.5" y="-122455.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_ffn_norm_0&#45;&gt;layer17_ffn_up_0 -->
<g id="edge564" class="edge">
<title>layer17_ffn_norm_0&#45;&gt;layer17_ffn_up_0</title>
<path fill="none" stroke="black" d="M1171.17,-122621C1142.04,-122621 1116.76,-122621 1116.76,-122621 1116.76,-122621 1116.76,-122525.49 1116.76,-122525.49"/>
<polygon fill="black" stroke="black" points="1120.26,-122525.49 1116.76,-122515.49 1113.26,-122525.49 1120.26,-122525.49"/>
</g>
<!-- layer17_ffn_gate_1 -->
<g id="node444" class="node">
<title>layer17_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1782,-122515.32 1601,-122515.32 1601,-122447.32 1782,-122447.32 1782,-122515.32"/>
<text text-anchor="middle" x="1691.5" y="-122500.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1691.5" y="-122485.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1691.5" y="-122470.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1691.5" y="-122455.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_ffn_norm_1&#45;&gt;layer17_ffn_gate_1 -->
<g id="edge563" class="edge">
<title>layer17_ffn_norm_1&#45;&gt;layer17_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1560.82,-122621C1586.18,-122621 1607.25,-122621 1607.25,-122621 1607.25,-122621 1607.25,-122525.49 1607.25,-122525.49"/>
<polygon fill="black" stroke="black" points="1610.75,-122525.49 1607.25,-122515.49 1603.75,-122525.49 1610.75,-122525.49"/>
</g>
<!-- layer17_ffn_up_1 -->
<g id="node446" class="node">
<title>layer17_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1565,-122515.32 1384,-122515.32 1384,-122447.32 1565,-122447.32 1565,-122515.32"/>
<text text-anchor="middle" x="1474.5" y="-122500.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1474.5" y="-122485.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1474.5" y="-122470.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1474.5" y="-122455.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_ffn_norm_1&#45;&gt;layer17_ffn_up_1 -->
<g id="edge565" class="edge">
<title>layer17_ffn_norm_1&#45;&gt;layer17_ffn_up_1</title>
<path fill="none" stroke="black" d="M1474.5,-122587.08C1474.5,-122587.08 1474.5,-122525.7 1474.5,-122525.7"/>
<polygon fill="black" stroke="black" points="1478,-122525.7 1474.5,-122515.7 1471,-122525.7 1478,-122525.7"/>
</g>
<!-- layer17_gate_ar -->
<g id="node447" class="node">
<title>layer17_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1489.5" cy="-122327.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1489.5" y="-122346.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1489.5" y="-122331.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1489.5" y="-122316.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1489.5" y="-122301.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer17_ffn_gate_0&#45;&gt;layer17_gate_ar -->
<g id="edge566" class="edge">
<title>layer17_ffn_gate_0&#45;&gt;layer17_gate_ar</title>
<path fill="none" stroke="black" d="M1348.03,-122469C1362.46,-122469 1372.76,-122469 1372.76,-122469 1372.76,-122469 1372.76,-122356.95 1372.76,-122356.95"/>
<polygon fill="black" stroke="black" points="1376.26,-122356.95 1372.76,-122346.95 1369.26,-122356.95 1376.26,-122356.95"/>
</g>
<!-- layer17_ffn_gate_1&#45;&gt;layer17_gate_ar -->
<g id="edge567" class="edge">
<title>layer17_ffn_gate_1&#45;&gt;layer17_gate_ar</title>
<path fill="none" stroke="black" d="M1609.24,-122447.13C1609.24,-122447.13 1609.24,-122354.23 1609.24,-122354.23"/>
<polygon fill="black" stroke="black" points="1612.74,-122354.23 1609.24,-122344.23 1605.74,-122354.23 1612.74,-122354.23"/>
</g>
<!-- layer17_up_ar -->
<g id="node448" class="node">
<title>layer17_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1143.5" cy="-122327.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1143.5" y="-122346.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1143.5" y="-122331.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1143.5" y="-122316.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1143.5" y="-122301.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer17_ffn_up_0&#45;&gt;layer17_up_ar -->
<g id="edge568" class="edge">
<title>layer17_ffn_up_0&#45;&gt;layer17_up_ar</title>
<path fill="none" stroke="black" d="M1073.26,-122447.13C1073.26,-122447.13 1073.26,-122377.62 1073.26,-122377.62"/>
<polygon fill="black" stroke="black" points="1076.76,-122377.62 1073.26,-122367.62 1069.76,-122377.62 1076.76,-122377.62"/>
</g>
<!-- layer17_ffn_up_1&#45;&gt;layer17_up_ar -->
<g id="edge569" class="edge">
<title>layer17_ffn_up_1&#45;&gt;layer17_up_ar</title>
<path fill="none" stroke="black" d="M1383.74,-122492C1367.04,-122492 1354.76,-122492 1354.76,-122492 1354.76,-122492 1354.76,-122327 1354.76,-122327 1354.76,-122327 1281.57,-122327 1281.57,-122327"/>
<polygon fill="black" stroke="black" points="1281.57,-122323.5 1271.57,-122327 1281.57,-122330.5 1281.57,-122323.5"/>
</g>
<!-- layer17_silu_0 -->
<g id="node449" class="node">
<title>layer17_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1417,-122207.16 1236,-122207.16 1236,-122139.16 1417,-122139.16 1417,-122207.16"/>
<text text-anchor="middle" x="1326.5" y="-122191.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1326.5" y="-122176.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1326.5" y="-122161.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1326.5" y="-122146.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_gate_ar&#45;&gt;layer17_silu_0 -->
<g id="edge570" class="edge">
<title>layer17_gate_ar&#45;&gt;layer17_silu_0</title>
<path fill="none" stroke="black" d="M1389.26,-122297.17C1389.26,-122297.17 1389.26,-122217.18 1389.26,-122217.18"/>
<polygon fill="black" stroke="black" points="1392.76,-122217.18 1389.26,-122207.18 1385.76,-122217.18 1392.76,-122217.18"/>
</g>
<!-- layer17_silu_1 -->
<g id="node450" class="node">
<title>layer17_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1634,-122207.16 1453,-122207.16 1453,-122139.16 1634,-122139.16 1634,-122207.16"/>
<text text-anchor="middle" x="1543.5" y="-122191.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1543.5" y="-122176.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1543.5" y="-122161.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1543.5" y="-122146.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_gate_ar&#45;&gt;layer17_silu_1 -->
<g id="edge571" class="edge">
<title>layer17_gate_ar&#45;&gt;layer17_silu_1</title>
<path fill="none" stroke="black" d="M1535.24,-122282.26C1535.24,-122282.26 1535.24,-122217.16 1535.24,-122217.16"/>
<polygon fill="black" stroke="black" points="1538.74,-122217.16 1535.24,-122207.16 1531.74,-122217.16 1538.74,-122217.16"/>
</g>
<!-- layer17_mul_0 -->
<g id="node451" class="node">
<title>layer17_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1267,-122067.16 1086,-122067.16 1086,-121999.16 1267,-121999.16 1267,-122067.16"/>
<text text-anchor="middle" x="1176.5" y="-122051.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1176.5" y="-122036.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1176.5" y="-122021.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1176.5" y="-122006.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_up_ar&#45;&gt;layer17_mul_0 -->
<g id="edge573" class="edge">
<title>layer17_up_ar&#45;&gt;layer17_mul_0</title>
<path fill="none" stroke="black" d="M1161,-122279.34C1161,-122279.34 1161,-122077.26 1161,-122077.26"/>
<polygon fill="black" stroke="black" points="1164.5,-122077.26 1161,-122067.26 1157.5,-122077.26 1164.5,-122077.26"/>
</g>
<!-- layer17_mul_1 -->
<g id="node452" class="node">
<title>layer17_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1484,-122067.16 1303,-122067.16 1303,-121999.16 1484,-121999.16 1484,-122067.16"/>
<text text-anchor="middle" x="1393.5" y="-122051.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1393.5" y="-122036.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1393.5" y="-122021.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1393.5" y="-122006.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer17_up_ar&#45;&gt;layer17_mul_1 -->
<g id="edge575" class="edge">
<title>layer17_up_ar&#45;&gt;layer17_mul_1</title>
<path fill="none" stroke="black" d="M1253.74,-122302.42C1253.74,-122277.57 1253.74,-122243 1253.74,-122243 1253.74,-122243 1435,-122243 1435,-122243 1435,-122243 1435,-122077.34 1435,-122077.34"/>
<polygon fill="black" stroke="black" points="1438.5,-122077.34 1435,-122067.34 1431.5,-122077.34 1438.5,-122077.34"/>
</g>
<!-- layer17_silu_0&#45;&gt;layer17_mul_0 -->
<g id="edge572" class="edge">
<title>layer17_silu_0&#45;&gt;layer17_mul_0</title>
<path fill="none" stroke="black" d="M1251.5,-122138.91C1251.5,-122138.91 1251.5,-122077.54 1251.5,-122077.54"/>
<polygon fill="black" stroke="black" points="1255,-122077.54 1251.5,-122067.54 1248,-122077.54 1255,-122077.54"/>
</g>
<!-- layer17_silu_1&#45;&gt;layer17_mul_1 -->
<g id="edge574" class="edge">
<title>layer17_silu_1&#45;&gt;layer17_mul_1</title>
<path fill="none" stroke="black" d="M1468.5,-122138.91C1468.5,-122138.91 1468.5,-122077.54 1468.5,-122077.54"/>
<polygon fill="black" stroke="black" points="1472,-122077.54 1468.5,-122067.54 1465,-122077.54 1472,-122077.54"/>
</g>
<!-- layer17_ffn_down_0 -->
<g id="node453" class="node">
<title>layer17_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1266.5,-121927.16 1094.5,-121927.16 1094.5,-121859.16 1266.5,-121859.16 1266.5,-121927.16"/>
<text text-anchor="middle" x="1180.5" y="-121911.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1180.5" y="-121896.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1180.5" y="-121881.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1180.5" y="-121866.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer17_mul_0&#45;&gt;layer17_ffn_down_0 -->
<g id="edge576" class="edge">
<title>layer17_mul_0&#45;&gt;layer17_ffn_down_0</title>
<path fill="none" stroke="black" d="M1180.5,-121998.91C1180.5,-121998.91 1180.5,-121937.54 1180.5,-121937.54"/>
<polygon fill="black" stroke="black" points="1184,-121937.54 1180.5,-121927.54 1177,-121937.54 1184,-121937.54"/>
</g>
<!-- layer17_ffn_down_1 -->
<g id="node454" class="node">
<title>layer17_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1476.5,-121927.16 1304.5,-121927.16 1304.5,-121859.16 1476.5,-121859.16 1476.5,-121927.16"/>
<text text-anchor="middle" x="1390.5" y="-121911.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1390.5" y="-121896.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1390.5" y="-121881.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1390.5" y="-121866.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer17_mul_1&#45;&gt;layer17_ffn_down_1 -->
<g id="edge577" class="edge">
<title>layer17_mul_1&#45;&gt;layer17_ffn_down_1</title>
<path fill="none" stroke="black" d="M1390.5,-121998.91C1390.5,-121998.91 1390.5,-121937.54 1390.5,-121937.54"/>
<polygon fill="black" stroke="black" points="1394,-121937.54 1390.5,-121927.54 1387,-121937.54 1394,-121937.54"/>
</g>
<!-- layer17_ffn_ar -->
<g id="node455" class="node">
<title>layer17_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1213.5" cy="-121739.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1213.5" y="-121757.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1213.5" y="-121742.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1213.5" y="-121727.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1213.5" y="-121712.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_ffn_down_0&#45;&gt;layer17_ffn_ar -->
<g id="edge578" class="edge">
<title>layer17_ffn_down_0&#45;&gt;layer17_ffn_ar</title>
<path fill="none" stroke="black" d="M1180.5,-121858.96C1180.5,-121858.96 1180.5,-121795.45 1180.5,-121795.45"/>
<polygon fill="black" stroke="black" points="1184,-121795.45 1180.5,-121785.45 1177,-121795.45 1184,-121795.45"/>
</g>
<!-- layer17_ffn_down_1&#45;&gt;layer17_ffn_ar -->
<g id="edge579" class="edge">
<title>layer17_ffn_down_1&#45;&gt;layer17_ffn_ar</title>
<path fill="none" stroke="black" d="M1319.81,-121858.96C1319.81,-121858.96 1319.81,-121772.66 1319.81,-121772.66"/>
<polygon fill="black" stroke="black" points="1323.31,-121772.66 1319.81,-121762.66 1316.31,-121772.66 1323.31,-121772.66"/>
</g>
<!-- layer18_norm_0 -->
<g id="node456" class="node">
<title>layer18_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1195.5,-121618.99 1023.5,-121618.99 1023.5,-121550.99 1195.5,-121550.99 1195.5,-121618.99"/>
<text text-anchor="middle" x="1109.5" y="-121603.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1109.5" y="-121588.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1109.5" y="-121573.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1109.5" y="-121558.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_ffn_ar&#45;&gt;layer18_norm_0 -->
<g id="edge580" class="edge">
<title>layer17_ffn_ar&#45;&gt;layer18_norm_0</title>
<path fill="none" stroke="black" d="M1143.69,-121699.39C1143.69,-121699.39 1143.69,-121629.05 1143.69,-121629.05"/>
<polygon fill="black" stroke="black" points="1147.19,-121629.05 1143.69,-121619.05 1140.19,-121629.05 1147.19,-121629.05"/>
</g>
<!-- layer18_norm_1 -->
<g id="node457" class="node">
<title>layer18_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1405.5,-121618.99 1233.5,-121618.99 1233.5,-121550.99 1405.5,-121550.99 1405.5,-121618.99"/>
<text text-anchor="middle" x="1319.5" y="-121603.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1319.5" y="-121588.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1319.5" y="-121573.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1319.5" y="-121558.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_ffn_ar&#45;&gt;layer18_norm_1 -->
<g id="edge581" class="edge">
<title>layer17_ffn_ar&#45;&gt;layer18_norm_1</title>
<path fill="none" stroke="black" d="M1284.31,-121699.79C1284.31,-121699.79 1284.31,-121629.22 1284.31,-121629.22"/>
<polygon fill="black" stroke="black" points="1287.81,-121629.22 1284.31,-121619.22 1280.81,-121629.22 1287.81,-121629.22"/>
</g>
<!-- layer18_qkv_0 -->
<g id="node458" class="node">
<title>layer18_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1196,-121478.99 1015,-121478.99 1015,-121410.99 1196,-121410.99 1196,-121478.99"/>
<text text-anchor="middle" x="1105.5" y="-121463.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1105.5" y="-121448.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1105.5" y="-121433.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1105.5" y="-121418.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer18_norm_0&#45;&gt;layer18_qkv_0 -->
<g id="edge582" class="edge">
<title>layer18_norm_0&#45;&gt;layer18_qkv_0</title>
<path fill="none" stroke="black" d="M1109.5,-121550.74C1109.5,-121550.74 1109.5,-121489.37 1109.5,-121489.37"/>
<polygon fill="black" stroke="black" points="1113,-121489.37 1109.5,-121479.37 1106,-121489.37 1113,-121489.37"/>
</g>
<!-- layer18_qkv_1 -->
<g id="node459" class="node">
<title>layer18_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1413,-121478.99 1232,-121478.99 1232,-121410.99 1413,-121410.99 1413,-121478.99"/>
<text text-anchor="middle" x="1322.5" y="-121463.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1322.5" y="-121448.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1322.5" y="-121433.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1322.5" y="-121418.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer18_norm_1&#45;&gt;layer18_qkv_1 -->
<g id="edge583" class="edge">
<title>layer18_norm_1&#45;&gt;layer18_qkv_1</title>
<path fill="none" stroke="black" d="M1319.5,-121550.74C1319.5,-121550.74 1319.5,-121489.37 1319.5,-121489.37"/>
<polygon fill="black" stroke="black" points="1323,-121489.37 1319.5,-121479.37 1316,-121489.37 1323,-121489.37"/>
</g>
<!-- layer18_qkv_ar -->
<g id="node460" class="node">
<title>layer18_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1176.5" cy="-121290.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1176.5" y="-121309.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1176.5" y="-121294.71" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1176.5" y="-121279.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1176.5" y="-121264.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer18_qkv_0&#45;&gt;layer18_qkv_ar -->
<g id="edge584" class="edge">
<title>layer18_qkv_0&#45;&gt;layer18_qkv_ar</title>
<path fill="none" stroke="black" d="M1122.26,-121410.79C1122.26,-121410.79 1122.26,-121344.68 1122.26,-121344.68"/>
<polygon fill="black" stroke="black" points="1125.76,-121344.68 1122.26,-121334.68 1118.76,-121344.68 1125.76,-121344.68"/>
</g>
<!-- layer18_qkv_1&#45;&gt;layer18_qkv_ar -->
<g id="edge585" class="edge">
<title>layer18_qkv_1&#45;&gt;layer18_qkv_ar</title>
<path fill="none" stroke="black" d="M1268.24,-121410.79C1268.24,-121410.79 1268.24,-121334.48 1268.24,-121334.48"/>
<polygon fill="black" stroke="black" points="1271.74,-121334.48 1268.24,-121324.48 1264.74,-121334.48 1271.74,-121334.48"/>
</g>
<!-- layer18_attn_0 -->
<g id="node461" class="node">
<title>layer18_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1158.5,-121170.82 986.5,-121170.82 986.5,-121102.82 1158.5,-121102.82 1158.5,-121170.82"/>
<text text-anchor="middle" x="1072.5" y="-121155.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1072.5" y="-121140.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1072.5" y="-121125.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1072.5" y="-121110.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer18_qkv_ar&#45;&gt;layer18_attn_0 -->
<g id="edge586" class="edge">
<title>layer18_qkv_ar&#45;&gt;layer18_attn_0</title>
<path fill="none" stroke="black" d="M1103.51,-121251.23C1103.51,-121251.23 1103.51,-121180.88 1103.51,-121180.88"/>
<polygon fill="black" stroke="black" points="1107.01,-121180.88 1103.51,-121170.88 1100.01,-121180.88 1107.01,-121180.88"/>
</g>
<!-- layer18_attn_1 -->
<g id="node462" class="node">
<title>layer18_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1366.5,-121170.82 1194.5,-121170.82 1194.5,-121102.82 1366.5,-121102.82 1366.5,-121170.82"/>
<text text-anchor="middle" x="1280.5" y="-121155.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1280.5" y="-121140.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1280.5" y="-121125.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1280.5" y="-121110.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer18_qkv_ar&#45;&gt;layer18_attn_1 -->
<g id="edge587" class="edge">
<title>layer18_qkv_ar&#45;&gt;layer18_attn_1</title>
<path fill="none" stroke="black" d="M1249.49,-121251.23C1249.49,-121251.23 1249.49,-121180.88 1249.49,-121180.88"/>
<polygon fill="black" stroke="black" points="1252.99,-121180.88 1249.49,-121170.88 1245.99,-121180.88 1252.99,-121180.88"/>
</g>
<!-- layer18_attn_out_0 -->
<g id="node463" class="node">
<title>layer18_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1158.5,-121030.82 986.5,-121030.82 986.5,-120962.82 1158.5,-120962.82 1158.5,-121030.82"/>
<text text-anchor="middle" x="1072.5" y="-121015.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1072.5" y="-121000.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1072.5" y="-120985.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1072.5" y="-120970.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer18_attn_0&#45;&gt;layer18_attn_out_0 -->
<g id="edge588" class="edge">
<title>layer18_attn_0&#45;&gt;layer18_attn_out_0</title>
<path fill="none" stroke="black" d="M1072.5,-121102.58C1072.5,-121102.58 1072.5,-121041.2 1072.5,-121041.2"/>
<polygon fill="black" stroke="black" points="1076,-121041.2 1072.5,-121031.2 1069,-121041.2 1076,-121041.2"/>
</g>
<!-- layer18_attn_out_1 -->
<g id="node464" class="node">
<title>layer18_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1366.5,-121030.82 1194.5,-121030.82 1194.5,-120962.82 1366.5,-120962.82 1366.5,-121030.82"/>
<text text-anchor="middle" x="1280.5" y="-121015.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1280.5" y="-121000.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1280.5" y="-120985.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1280.5" y="-120970.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer18_attn_1&#45;&gt;layer18_attn_out_1 -->
<g id="edge589" class="edge">
<title>layer18_attn_1&#45;&gt;layer18_attn_out_1</title>
<path fill="none" stroke="black" d="M1280.5,-121102.58C1280.5,-121102.58 1280.5,-121041.2 1280.5,-121041.2"/>
<polygon fill="black" stroke="black" points="1284,-121041.2 1280.5,-121031.2 1277,-121041.2 1284,-121041.2"/>
</g>
<!-- layer18_attn_ar -->
<g id="node465" class="node">
<title>layer18_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1159.5" cy="-120842.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1159.5" y="-120861.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1159.5" y="-120846.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1159.5" y="-120831.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1159.5" y="-120816.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_attn_out_0&#45;&gt;layer18_attn_ar -->
<g id="edge590" class="edge">
<title>layer18_attn_out_0&#45;&gt;layer18_attn_ar</title>
<path fill="none" stroke="black" d="M1098.19,-120962.63C1098.19,-120962.63 1098.19,-120894.53 1098.19,-120894.53"/>
<polygon fill="black" stroke="black" points="1101.69,-120894.53 1098.19,-120884.53 1094.69,-120894.53 1101.69,-120894.53"/>
</g>
<!-- layer18_attn_out_1&#45;&gt;layer18_attn_ar -->
<g id="edge591" class="edge">
<title>layer18_attn_out_1&#45;&gt;layer18_attn_ar</title>
<path fill="none" stroke="black" d="M1237.81,-120962.63C1237.81,-120962.63 1237.81,-120889.53 1237.81,-120889.53"/>
<polygon fill="black" stroke="black" points="1241.31,-120889.53 1237.81,-120879.53 1234.31,-120889.53 1241.31,-120889.53"/>
</g>
<!-- layer18_ffn_norm_0 -->
<g id="node466" class="node">
<title>layer18_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1137.5,-120722.66 965.5,-120722.66 965.5,-120654.66 1137.5,-120654.66 1137.5,-120722.66"/>
<text text-anchor="middle" x="1051.5" y="-120707.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1051.5" y="-120692.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1051.5" y="-120677.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-120662.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_attn_ar&#45;&gt;layer18_ffn_norm_0 -->
<g id="edge592" class="edge">
<title>layer18_attn_ar&#45;&gt;layer18_ffn_norm_0</title>
<path fill="none" stroke="black" d="M1087.69,-120803.86C1087.69,-120803.86 1087.69,-120732.81 1087.69,-120732.81"/>
<polygon fill="black" stroke="black" points="1091.19,-120732.81 1087.69,-120722.81 1084.19,-120732.81 1091.19,-120732.81"/>
</g>
<!-- layer18_ffn_norm_1 -->
<g id="node467" class="node">
<title>layer18_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1354.5,-120722.66 1182.5,-120722.66 1182.5,-120654.66 1354.5,-120654.66 1354.5,-120722.66"/>
<text text-anchor="middle" x="1268.5" y="-120707.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1268.5" y="-120692.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1268.5" y="-120677.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-120662.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_attn_ar&#45;&gt;layer18_ffn_norm_1 -->
<g id="edge593" class="edge">
<title>layer18_attn_ar&#45;&gt;layer18_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1231.81,-120803.86C1231.81,-120803.86 1231.81,-120732.81 1231.81,-120732.81"/>
<polygon fill="black" stroke="black" points="1235.31,-120732.81 1231.81,-120722.81 1228.31,-120732.81 1235.31,-120732.81"/>
</g>
<!-- layer18_ffn_gate_0 -->
<g id="node468" class="node">
<title>layer18_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1142,-120582.66 961,-120582.66 961,-120514.66 1142,-120514.66 1142,-120582.66"/>
<text text-anchor="middle" x="1051.5" y="-120567.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1051.5" y="-120552.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1051.5" y="-120537.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-120522.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_ffn_norm_0&#45;&gt;layer18_ffn_gate_0 -->
<g id="edge594" class="edge">
<title>layer18_ffn_norm_0&#45;&gt;layer18_ffn_gate_0</title>
<path fill="none" stroke="black" d="M1051.5,-120654.41C1051.5,-120654.41 1051.5,-120593.04 1051.5,-120593.04"/>
<polygon fill="black" stroke="black" points="1055,-120593.04 1051.5,-120583.04 1048,-120593.04 1055,-120593.04"/>
</g>
<!-- layer18_ffn_up_0 -->
<g id="node470" class="node">
<title>layer18_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="925,-120582.66 744,-120582.66 744,-120514.66 925,-120514.66 925,-120582.66"/>
<text text-anchor="middle" x="834.5" y="-120567.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="834.5" y="-120552.46" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="834.5" y="-120537.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="834.5" y="-120522.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_ffn_norm_0&#45;&gt;layer18_ffn_up_0 -->
<g id="edge596" class="edge">
<title>layer18_ffn_norm_0&#45;&gt;layer18_ffn_up_0</title>
<path fill="none" stroke="black" d="M965.13,-120688C934.74,-120688 908,-120688 908,-120688 908,-120688 908,-120592.74 908,-120592.74"/>
<polygon fill="black" stroke="black" points="911.5,-120592.74 908,-120582.74 904.5,-120592.74 911.5,-120592.74"/>
</g>
<!-- layer18_ffn_gate_1 -->
<g id="node469" class="node">
<title>layer18_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1576,-120582.66 1395,-120582.66 1395,-120514.66 1576,-120514.66 1576,-120582.66"/>
<text text-anchor="middle" x="1485.5" y="-120567.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1485.5" y="-120552.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1485.5" y="-120537.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1485.5" y="-120522.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_ffn_norm_1&#45;&gt;layer18_ffn_gate_1 -->
<g id="edge595" class="edge">
<title>layer18_ffn_norm_1&#45;&gt;layer18_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1354.7,-120688C1381.42,-120688 1404,-120688 1404,-120688 1404,-120688 1404,-120592.74 1404,-120592.74"/>
<polygon fill="black" stroke="black" points="1407.5,-120592.74 1404,-120582.74 1400.5,-120592.74 1407.5,-120592.74"/>
</g>
<!-- layer18_ffn_up_1 -->
<g id="node471" class="node">
<title>layer18_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1359,-120582.66 1178,-120582.66 1178,-120514.66 1359,-120514.66 1359,-120582.66"/>
<text text-anchor="middle" x="1268.5" y="-120567.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1268.5" y="-120552.46" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1268.5" y="-120537.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-120522.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_ffn_norm_1&#45;&gt;layer18_ffn_up_1 -->
<g id="edge597" class="edge">
<title>layer18_ffn_norm_1&#45;&gt;layer18_ffn_up_1</title>
<path fill="none" stroke="black" d="M1268.5,-120654.41C1268.5,-120654.41 1268.5,-120593.04 1268.5,-120593.04"/>
<polygon fill="black" stroke="black" points="1272,-120593.04 1268.5,-120583.04 1265,-120593.04 1272,-120593.04"/>
</g>
<!-- layer18_gate_ar -->
<g id="node472" class="node">
<title>layer18_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1278.5" cy="-120394.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1278.5" y="-120413.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1278.5" y="-120398.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1278.5" y="-120383.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1278.5" y="-120368.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer18_ffn_gate_0&#45;&gt;layer18_gate_ar -->
<g id="edge598" class="edge">
<title>layer18_ffn_gate_0&#45;&gt;layer18_gate_ar</title>
<path fill="none" stroke="black" d="M1142.25,-120537C1155.21,-120537 1164.26,-120537 1164.26,-120537 1164.26,-120537 1164.26,-120426.52 1164.26,-120426.52"/>
<polygon fill="black" stroke="black" points="1167.76,-120426.52 1164.26,-120416.52 1160.76,-120426.52 1167.76,-120426.52"/>
</g>
<!-- layer18_ffn_gate_1&#45;&gt;layer18_gate_ar -->
<g id="edge599" class="edge">
<title>layer18_ffn_gate_1&#45;&gt;layer18_gate_ar</title>
<path fill="none" stroke="black" d="M1400.74,-120514.46C1400.74,-120514.46 1400.74,-120419.17 1400.74,-120419.17"/>
<polygon fill="black" stroke="black" points="1404.24,-120419.16 1400.74,-120409.17 1397.24,-120419.17 1404.24,-120419.16"/>
</g>
<!-- layer18_up_ar -->
<g id="node473" class="node">
<title>layer18_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="932.5" cy="-120394.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="932.5" y="-120413.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="932.5" y="-120398.37" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="932.5" y="-120383.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="932.5" y="-120368.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer18_ffn_up_0&#45;&gt;layer18_up_ar -->
<g id="edge600" class="edge">
<title>layer18_ffn_up_0&#45;&gt;layer18_up_ar</title>
<path fill="none" stroke="black" d="M864.76,-120514.46C864.76,-120514.46 864.76,-120445.51 864.76,-120445.51"/>
<polygon fill="black" stroke="black" points="868.26,-120445.51 864.76,-120435.51 861.26,-120445.51 868.26,-120445.51"/>
</g>
<!-- layer18_ffn_up_1&#45;&gt;layer18_up_ar -->
<g id="edge601" class="edge">
<title>layer18_ffn_up_1&#45;&gt;layer18_up_ar</title>
<path fill="none" stroke="black" d="M1177.74,-120559C1159.73,-120559 1146.26,-120559 1146.26,-120559 1146.26,-120559 1146.26,-120394 1146.26,-120394 1146.26,-120394 1070.55,-120394 1070.55,-120394"/>
<polygon fill="black" stroke="black" points="1070.55,-120390.5 1060.55,-120394 1070.55,-120397.5 1070.55,-120390.5"/>
</g>
<!-- layer18_silu_0 -->
<g id="node474" class="node">
<title>layer18_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1206,-120274.49 1025,-120274.49 1025,-120206.49 1206,-120206.49 1206,-120274.49"/>
<text text-anchor="middle" x="1115.5" y="-120259.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1115.5" y="-120244.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1115.5" y="-120229.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1115.5" y="-120214.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_gate_ar&#45;&gt;layer18_silu_0 -->
<g id="edge602" class="edge">
<title>layer18_gate_ar&#45;&gt;layer18_silu_0</title>
<path fill="none" stroke="black" d="M1178.26,-120364.5C1178.26,-120364.5 1178.26,-120284.51 1178.26,-120284.51"/>
<polygon fill="black" stroke="black" points="1181.76,-120284.51 1178.26,-120274.51 1174.76,-120284.51 1181.76,-120284.51"/>
</g>
<!-- layer18_silu_1 -->
<g id="node475" class="node">
<title>layer18_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1423,-120274.49 1242,-120274.49 1242,-120206.49 1423,-120206.49 1423,-120274.49"/>
<text text-anchor="middle" x="1332.5" y="-120259.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1332.5" y="-120244.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1332.5" y="-120229.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1332.5" y="-120214.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_gate_ar&#45;&gt;layer18_silu_1 -->
<g id="edge603" class="edge">
<title>layer18_gate_ar&#45;&gt;layer18_silu_1</title>
<path fill="none" stroke="black" d="M1324.24,-120349.59C1324.24,-120349.59 1324.24,-120284.5 1324.24,-120284.5"/>
<polygon fill="black" stroke="black" points="1327.74,-120284.5 1324.24,-120274.5 1320.74,-120284.5 1327.74,-120284.5"/>
</g>
<!-- layer18_mul_0 -->
<g id="node476" class="node">
<title>layer18_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1053,-120134.49 872,-120134.49 872,-120066.49 1053,-120066.49 1053,-120134.49"/>
<text text-anchor="middle" x="962.5" y="-120119.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="962.5" y="-120104.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="962.5" y="-120089.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="962.5" y="-120074.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_up_ar&#45;&gt;layer18_mul_0 -->
<g id="edge605" class="edge">
<title>layer18_up_ar&#45;&gt;layer18_mul_0</title>
<path fill="none" stroke="black" d="M948.5,-120346.67C948.5,-120346.67 948.5,-120144.6 948.5,-120144.6"/>
<polygon fill="black" stroke="black" points="952,-120144.6 948.5,-120134.6 945,-120144.6 952,-120144.6"/>
</g>
<!-- layer18_mul_1 -->
<g id="node477" class="node">
<title>layer18_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1270,-120134.49 1089,-120134.49 1089,-120066.49 1270,-120066.49 1270,-120134.49"/>
<text text-anchor="middle" x="1179.5" y="-120119.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1179.5" y="-120104.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1179.5" y="-120089.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1179.5" y="-120074.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer18_up_ar&#45;&gt;layer18_mul_1 -->
<g id="edge607" class="edge">
<title>layer18_up_ar&#45;&gt;layer18_mul_1</title>
<path fill="none" stroke="black" d="M1042.74,-120370.11C1042.74,-120345.13 1042.74,-120310 1042.74,-120310 1042.74,-120310 1224,-120310 1224,-120310 1224,-120310 1224,-120144.62 1224,-120144.62"/>
<polygon fill="black" stroke="black" points="1227.5,-120144.62 1224,-120134.62 1220.5,-120144.62 1227.5,-120144.62"/>
</g>
<!-- layer18_silu_0&#45;&gt;layer18_mul_0 -->
<g id="edge604" class="edge">
<title>layer18_silu_0&#45;&gt;layer18_mul_0</title>
<path fill="none" stroke="black" d="M1039,-120206.24C1039,-120206.24 1039,-120144.87 1039,-120144.87"/>
<polygon fill="black" stroke="black" points="1042.5,-120144.87 1039,-120134.87 1035.5,-120144.87 1042.5,-120144.87"/>
</g>
<!-- layer18_silu_1&#45;&gt;layer18_mul_1 -->
<g id="edge606" class="edge">
<title>layer18_silu_1&#45;&gt;layer18_mul_1</title>
<path fill="none" stroke="black" d="M1256,-120206.24C1256,-120206.24 1256,-120144.87 1256,-120144.87"/>
<polygon fill="black" stroke="black" points="1259.5,-120144.87 1256,-120134.87 1252.5,-120144.87 1259.5,-120144.87"/>
</g>
<!-- layer18_ffn_down_0 -->
<g id="node478" class="node">
<title>layer18_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1052.5,-119994.49 880.5,-119994.49 880.5,-119926.49 1052.5,-119926.49 1052.5,-119994.49"/>
<text text-anchor="middle" x="966.5" y="-119979.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="966.5" y="-119964.29" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="966.5" y="-119949.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="966.5" y="-119934.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer18_mul_0&#45;&gt;layer18_ffn_down_0 -->
<g id="edge608" class="edge">
<title>layer18_mul_0&#45;&gt;layer18_ffn_down_0</title>
<path fill="none" stroke="black" d="M966.5,-120066.24C966.5,-120066.24 966.5,-120004.87 966.5,-120004.87"/>
<polygon fill="black" stroke="black" points="970,-120004.87 966.5,-119994.87 963,-120004.87 970,-120004.87"/>
</g>
<!-- layer18_ffn_down_1 -->
<g id="node479" class="node">
<title>layer18_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1262.5,-119994.49 1090.5,-119994.49 1090.5,-119926.49 1262.5,-119926.49 1262.5,-119994.49"/>
<text text-anchor="middle" x="1176.5" y="-119979.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1176.5" y="-119964.29" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1176.5" y="-119949.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1176.5" y="-119934.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer18_mul_1&#45;&gt;layer18_ffn_down_1 -->
<g id="edge609" class="edge">
<title>layer18_mul_1&#45;&gt;layer18_ffn_down_1</title>
<path fill="none" stroke="black" d="M1176.5,-120066.24C1176.5,-120066.24 1176.5,-120004.87 1176.5,-120004.87"/>
<polygon fill="black" stroke="black" points="1180,-120004.87 1176.5,-119994.87 1173,-120004.87 1180,-120004.87"/>
</g>
<!-- layer18_ffn_ar -->
<g id="node480" class="node">
<title>layer18_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="998.5" cy="-119806.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="998.5" y="-119825.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="998.5" y="-119810.21" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="998.5" y="-119795.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="998.5" y="-119780.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_ffn_down_0&#45;&gt;layer18_ffn_ar -->
<g id="edge610" class="edge">
<title>layer18_ffn_down_0&#45;&gt;layer18_ffn_ar</title>
<path fill="none" stroke="black" d="M966.5,-119926.29C966.5,-119926.29 966.5,-119863.07 966.5,-119863.07"/>
<polygon fill="black" stroke="black" points="970,-119863.07 966.5,-119853.07 963,-119863.07 970,-119863.07"/>
</g>
<!-- layer18_ffn_down_1&#45;&gt;layer18_ffn_ar -->
<g id="edge611" class="edge">
<title>layer18_ffn_down_1&#45;&gt;layer18_ffn_ar</title>
<path fill="none" stroke="black" d="M1105.31,-119926.29C1105.31,-119926.29 1105.31,-119839.53 1105.31,-119839.53"/>
<polygon fill="black" stroke="black" points="1108.81,-119839.53 1105.31,-119829.53 1101.81,-119839.53 1108.81,-119839.53"/>
</g>
<!-- layer19_norm_0 -->
<g id="node481" class="node">
<title>layer19_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="980.5,-119686.32 808.5,-119686.32 808.5,-119618.32 980.5,-119618.32 980.5,-119686.32"/>
<text text-anchor="middle" x="894.5" y="-119671.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="894.5" y="-119656.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="894.5" y="-119641.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="894.5" y="-119626.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_ffn_ar&#45;&gt;layer19_norm_0 -->
<g id="edge612" class="edge">
<title>layer18_ffn_ar&#45;&gt;layer19_norm_0</title>
<path fill="none" stroke="black" d="M928.69,-119766.73C928.69,-119766.73 928.69,-119696.38 928.69,-119696.38"/>
<polygon fill="black" stroke="black" points="932.19,-119696.38 928.69,-119686.38 925.19,-119696.38 932.19,-119696.38"/>
</g>
<!-- layer19_norm_1 -->
<g id="node482" class="node">
<title>layer19_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1190.5,-119686.32 1018.5,-119686.32 1018.5,-119618.32 1190.5,-119618.32 1190.5,-119686.32"/>
<text text-anchor="middle" x="1104.5" y="-119671.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1104.5" y="-119656.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1104.5" y="-119641.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1104.5" y="-119626.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_ffn_ar&#45;&gt;layer19_norm_1 -->
<g id="edge613" class="edge">
<title>layer18_ffn_ar&#45;&gt;layer19_norm_1</title>
<path fill="none" stroke="black" d="M1069.31,-119767.13C1069.31,-119767.13 1069.31,-119696.56 1069.31,-119696.56"/>
<polygon fill="black" stroke="black" points="1072.81,-119696.56 1069.31,-119686.56 1065.81,-119696.56 1072.81,-119696.56"/>
</g>
<!-- layer19_qkv_0 -->
<g id="node483" class="node">
<title>layer19_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="981,-119546.32 800,-119546.32 800,-119478.32 981,-119478.32 981,-119546.32"/>
<text text-anchor="middle" x="890.5" y="-119531.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="890.5" y="-119516.12" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="890.5" y="-119501.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="890.5" y="-119486.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer19_norm_0&#45;&gt;layer19_qkv_0 -->
<g id="edge614" class="edge">
<title>layer19_norm_0&#45;&gt;layer19_qkv_0</title>
<path fill="none" stroke="black" d="M894.5,-119618.08C894.5,-119618.08 894.5,-119556.7 894.5,-119556.7"/>
<polygon fill="black" stroke="black" points="898,-119556.7 894.5,-119546.7 891,-119556.7 898,-119556.7"/>
</g>
<!-- layer19_qkv_1 -->
<g id="node484" class="node">
<title>layer19_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1198,-119546.32 1017,-119546.32 1017,-119478.32 1198,-119478.32 1198,-119546.32"/>
<text text-anchor="middle" x="1107.5" y="-119531.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1107.5" y="-119516.12" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1107.5" y="-119501.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1107.5" y="-119486.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer19_norm_1&#45;&gt;layer19_qkv_1 -->
<g id="edge615" class="edge">
<title>layer19_norm_1&#45;&gt;layer19_qkv_1</title>
<path fill="none" stroke="black" d="M1104.5,-119618.08C1104.5,-119618.08 1104.5,-119556.7 1104.5,-119556.7"/>
<polygon fill="black" stroke="black" points="1108,-119556.7 1104.5,-119546.7 1101,-119556.7 1108,-119556.7"/>
</g>
<!-- layer19_qkv_ar -->
<g id="node485" class="node">
<title>layer19_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="960.5" cy="-119358.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="960.5" y="-119377.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="960.5" y="-119362.04" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="960.5" y="-119347.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="960.5" y="-119332.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer19_qkv_0&#45;&gt;layer19_qkv_ar -->
<g id="edge616" class="edge">
<title>layer19_qkv_0&#45;&gt;layer19_qkv_ar</title>
<path fill="none" stroke="black" d="M906.76,-119478.13C906.76,-119478.13 906.76,-119412.02 906.76,-119412.02"/>
<polygon fill="black" stroke="black" points="910.26,-119412.02 906.76,-119402.02 903.26,-119412.02 910.26,-119412.02"/>
</g>
<!-- layer19_qkv_1&#45;&gt;layer19_qkv_ar -->
<g id="edge617" class="edge">
<title>layer19_qkv_1&#45;&gt;layer19_qkv_ar</title>
<path fill="none" stroke="black" d="M1052.74,-119478.13C1052.74,-119478.13 1052.74,-119401.81 1052.74,-119401.81"/>
<polygon fill="black" stroke="black" points="1056.24,-119401.81 1052.74,-119391.81 1049.24,-119401.81 1056.24,-119401.81"/>
</g>
<!-- layer19_attn_0 -->
<g id="node486" class="node">
<title>layer19_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="942.5,-119238.16 770.5,-119238.16 770.5,-119170.16 942.5,-119170.16 942.5,-119238.16"/>
<text text-anchor="middle" x="856.5" y="-119222.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="856.5" y="-119207.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="856.5" y="-119192.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="856.5" y="-119177.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer19_qkv_ar&#45;&gt;layer19_attn_0 -->
<g id="edge618" class="edge">
<title>layer19_qkv_ar&#45;&gt;layer19_attn_0</title>
<path fill="none" stroke="black" d="M887.51,-119318.56C887.51,-119318.56 887.51,-119248.21 887.51,-119248.21"/>
<polygon fill="black" stroke="black" points="891.01,-119248.21 887.51,-119238.21 884.01,-119248.21 891.01,-119248.21"/>
</g>
<!-- layer19_attn_1 -->
<g id="node487" class="node">
<title>layer19_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1150.5,-119238.16 978.5,-119238.16 978.5,-119170.16 1150.5,-119170.16 1150.5,-119238.16"/>
<text text-anchor="middle" x="1064.5" y="-119222.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1064.5" y="-119207.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1064.5" y="-119192.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1064.5" y="-119177.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer19_qkv_ar&#45;&gt;layer19_attn_1 -->
<g id="edge619" class="edge">
<title>layer19_qkv_ar&#45;&gt;layer19_attn_1</title>
<path fill="none" stroke="black" d="M1033.49,-119318.56C1033.49,-119318.56 1033.49,-119248.21 1033.49,-119248.21"/>
<polygon fill="black" stroke="black" points="1036.99,-119248.21 1033.49,-119238.21 1029.99,-119248.21 1036.99,-119248.21"/>
</g>
<!-- layer19_attn_out_0 -->
<g id="node488" class="node">
<title>layer19_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="942.5,-119098.16 770.5,-119098.16 770.5,-119030.16 942.5,-119030.16 942.5,-119098.16"/>
<text text-anchor="middle" x="856.5" y="-119082.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="856.5" y="-119067.96" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="856.5" y="-119052.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="856.5" y="-119037.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer19_attn_0&#45;&gt;layer19_attn_out_0 -->
<g id="edge620" class="edge">
<title>layer19_attn_0&#45;&gt;layer19_attn_out_0</title>
<path fill="none" stroke="black" d="M856.5,-119169.91C856.5,-119169.91 856.5,-119108.54 856.5,-119108.54"/>
<polygon fill="black" stroke="black" points="860,-119108.54 856.5,-119098.54 853,-119108.54 860,-119108.54"/>
</g>
<!-- layer19_attn_out_1 -->
<g id="node489" class="node">
<title>layer19_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1150.5,-119098.16 978.5,-119098.16 978.5,-119030.16 1150.5,-119030.16 1150.5,-119098.16"/>
<text text-anchor="middle" x="1064.5" y="-119082.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1064.5" y="-119067.96" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1064.5" y="-119052.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1064.5" y="-119037.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer19_attn_1&#45;&gt;layer19_attn_out_1 -->
<g id="edge621" class="edge">
<title>layer19_attn_1&#45;&gt;layer19_attn_out_1</title>
<path fill="none" stroke="black" d="M1064.5,-119169.91C1064.5,-119169.91 1064.5,-119108.54 1064.5,-119108.54"/>
<polygon fill="black" stroke="black" points="1068,-119108.54 1064.5,-119098.54 1061,-119108.54 1068,-119108.54"/>
</g>
<!-- layer19_attn_ar -->
<g id="node490" class="node">
<title>layer19_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="943.5" cy="-118910.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="943.5" y="-118928.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="943.5" y="-118913.87" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="943.5" y="-118898.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="943.5" y="-118883.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_attn_out_0&#45;&gt;layer19_attn_ar -->
<g id="edge622" class="edge">
<title>layer19_attn_out_0&#45;&gt;layer19_attn_ar</title>
<path fill="none" stroke="black" d="M882.19,-119029.96C882.19,-119029.96 882.19,-118961.86 882.19,-118961.86"/>
<polygon fill="black" stroke="black" points="885.69,-118961.86 882.19,-118951.86 878.69,-118961.86 885.69,-118961.86"/>
</g>
<!-- layer19_attn_out_1&#45;&gt;layer19_attn_ar -->
<g id="edge623" class="edge">
<title>layer19_attn_out_1&#45;&gt;layer19_attn_ar</title>
<path fill="none" stroke="black" d="M1021.81,-119029.96C1021.81,-119029.96 1021.81,-118956.86 1021.81,-118956.86"/>
<polygon fill="black" stroke="black" points="1025.31,-118956.86 1021.81,-118946.86 1018.31,-118956.86 1025.31,-118956.86"/>
</g>
<!-- layer19_ffn_norm_0 -->
<g id="node491" class="node">
<title>layer19_ffn_norm_0</title>
<polygon fill="#ffe6e6" stroke="black" points="921.5,-118789.99 749.5,-118789.99 749.5,-118721.99 921.5,-118721.99 921.5,-118789.99"/>
<text text-anchor="middle" x="835.5" y="-118774.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="835.5" y="-118759.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="835.5" y="-118744.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="835.5" y="-118729.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_attn_ar&#45;&gt;layer19_ffn_norm_0 -->
<g id="edge624" class="edge">
<title>layer19_attn_ar&#45;&gt;layer19_ffn_norm_0</title>
<path fill="none" stroke="black" d="M871.69,-118871.19C871.69,-118871.19 871.69,-118800.14 871.69,-118800.14"/>
<polygon fill="black" stroke="black" points="875.19,-118800.14 871.69,-118790.14 868.19,-118800.14 875.19,-118800.14"/>
</g>
<!-- layer19_ffn_norm_1 -->
<g id="node492" class="node">
<title>layer19_ffn_norm_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1138.5,-118789.99 966.5,-118789.99 966.5,-118721.99 1138.5,-118721.99 1138.5,-118789.99"/>
<text text-anchor="middle" x="1052.5" y="-118774.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1052.5" y="-118759.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1052.5" y="-118744.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1052.5" y="-118729.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_attn_ar&#45;&gt;layer19_ffn_norm_1 -->
<g id="edge625" class="edge">
<title>layer19_attn_ar&#45;&gt;layer19_ffn_norm_1</title>
<path fill="none" stroke="black" d="M1015.81,-118871.19C1015.81,-118871.19 1015.81,-118800.14 1015.81,-118800.14"/>
<polygon fill="black" stroke="black" points="1019.31,-118800.14 1015.81,-118790.14 1012.31,-118800.14 1019.31,-118800.14"/>
</g>
<!-- layer19_ffn_gate_0 -->
<g id="node493" class="node">
<title>layer19_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="926,-118649.99 745,-118649.99 745,-118581.99 926,-118581.99 926,-118649.99"/>
<text text-anchor="middle" x="835.5" y="-118634.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="835.5" y="-118619.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="835.5" y="-118604.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="835.5" y="-118589.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_ffn_norm_0&#45;&gt;layer19_ffn_gate_0 -->
<g id="edge626" class="edge">
<title>layer19_ffn_norm_0&#45;&gt;layer19_ffn_gate_0</title>
<path fill="none" stroke="black" d="M835.5,-118721.74C835.5,-118721.74 835.5,-118660.37 835.5,-118660.37"/>
<polygon fill="black" stroke="black" points="839,-118660.37 835.5,-118650.37 832,-118660.37 839,-118660.37"/>
</g>
<!-- layer19_ffn_up_0 -->
<g id="node495" class="node">
<title>layer19_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="709,-118649.99 528,-118649.99 528,-118581.99 709,-118581.99 709,-118649.99"/>
<text text-anchor="middle" x="618.5" y="-118634.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="618.5" y="-118619.79" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="618.5" y="-118604.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="618.5" y="-118589.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_ffn_norm_0&#45;&gt;layer19_ffn_up_0 -->
<g id="edge628" class="edge">
<title>layer19_ffn_norm_0&#45;&gt;layer19_ffn_up_0</title>
<path fill="none" stroke="black" d="M749.42,-118755C720.06,-118755 694.5,-118755 694.5,-118755 694.5,-118755 694.5,-118660 694.5,-118660"/>
<polygon fill="black" stroke="black" points="698,-118660 694.5,-118650 691,-118660 698,-118660"/>
</g>
<!-- layer19_ffn_gate_1 -->
<g id="node494" class="node">
<title>layer19_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1360,-118649.99 1179,-118649.99 1179,-118581.99 1360,-118581.99 1360,-118649.99"/>
<text text-anchor="middle" x="1269.5" y="-118634.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1269.5" y="-118619.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1269.5" y="-118604.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1269.5" y="-118589.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_ffn_norm_1&#45;&gt;layer19_ffn_gate_1 -->
<g id="edge627" class="edge">
<title>layer19_ffn_norm_1&#45;&gt;layer19_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1138.63,-118755C1165.62,-118755 1188.5,-118755 1188.5,-118755 1188.5,-118755 1188.5,-118660 1188.5,-118660"/>
<polygon fill="black" stroke="black" points="1192,-118660 1188.5,-118650 1185,-118660 1192,-118660"/>
</g>
<!-- layer19_ffn_up_1 -->
<g id="node496" class="node">
<title>layer19_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1143,-118649.99 962,-118649.99 962,-118581.99 1143,-118581.99 1143,-118649.99"/>
<text text-anchor="middle" x="1052.5" y="-118634.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1052.5" y="-118619.79" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1052.5" y="-118604.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1052.5" y="-118589.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_ffn_norm_1&#45;&gt;layer19_ffn_up_1 -->
<g id="edge629" class="edge">
<title>layer19_ffn_norm_1&#45;&gt;layer19_ffn_up_1</title>
<path fill="none" stroke="black" d="M1052.5,-118721.74C1052.5,-118721.74 1052.5,-118660.37 1052.5,-118660.37"/>
<polygon fill="black" stroke="black" points="1056,-118660.37 1052.5,-118650.37 1049,-118660.37 1056,-118660.37"/>
</g>
<!-- layer19_gate_ar -->
<g id="node497" class="node">
<title>layer19_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1061.5" cy="-118461.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1061.5" y="-118480.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1061.5" y="-118465.71" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="1061.5" y="-118450.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1061.5" y="-118435.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer19_ffn_gate_0&#45;&gt;layer19_gate_ar -->
<g id="edge630" class="edge">
<title>layer19_ffn_gate_0&#45;&gt;layer19_gate_ar</title>
<path fill="none" stroke="black" d="M926.11,-118604C938.88,-118604 947.76,-118604 947.76,-118604 947.76,-118604 947.76,-118494.11 947.76,-118494.11"/>
<polygon fill="black" stroke="black" points="951.26,-118494.11 947.76,-118484.11 944.26,-118494.11 951.26,-118494.11"/>
</g>
<!-- layer19_ffn_gate_1&#45;&gt;layer19_gate_ar -->
<g id="edge631" class="edge">
<title>layer19_ffn_gate_1&#45;&gt;layer19_gate_ar</title>
<path fill="none" stroke="black" d="M1184.24,-118581.79C1184.24,-118581.79 1184.24,-118485.73 1184.24,-118485.73"/>
<polygon fill="black" stroke="black" points="1187.74,-118485.73 1184.24,-118475.73 1180.74,-118485.73 1187.74,-118485.73"/>
</g>
<!-- layer19_up_ar -->
<g id="node498" class="node">
<title>layer19_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="715.5" cy="-118461.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="715.5" y="-118480.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="715.5" y="-118465.71" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="715.5" y="-118450.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="715.5" y="-118435.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer19_ffn_up_0&#45;&gt;layer19_up_ar -->
<g id="edge632" class="edge">
<title>layer19_ffn_up_0&#45;&gt;layer19_up_ar</title>
<path fill="none" stroke="black" d="M648.26,-118581.79C648.26,-118581.79 648.26,-118512.85 648.26,-118512.85"/>
<polygon fill="black" stroke="black" points="651.76,-118512.85 648.26,-118502.85 644.76,-118512.85 651.76,-118512.85"/>
</g>
<!-- layer19_ffn_up_1&#45;&gt;layer19_up_ar -->
<g id="edge633" class="edge">
<title>layer19_ffn_up_1&#45;&gt;layer19_up_ar</title>
<path fill="none" stroke="black" d="M961.69,-118627C943.45,-118627 929.76,-118627 929.76,-118627 929.76,-118627 929.76,-118461 929.76,-118461 929.76,-118461 853.54,-118461 853.54,-118461"/>
<polygon fill="black" stroke="black" points="853.54,-118457.5 843.54,-118461 853.54,-118464.5 853.54,-118457.5"/>
</g>
<!-- layer19_silu_0 -->
<g id="node499" class="node">
<title>layer19_silu_0</title>
<polygon fill="#ffe6e6" stroke="black" points="989,-118341.82 808,-118341.82 808,-118273.82 989,-118273.82 989,-118341.82"/>
<text text-anchor="middle" x="898.5" y="-118326.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="898.5" y="-118311.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="898.5" y="-118296.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="898.5" y="-118281.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_gate_ar&#45;&gt;layer19_silu_0 -->
<g id="edge634" class="edge">
<title>layer19_gate_ar&#45;&gt;layer19_silu_0</title>
<path fill="none" stroke="black" d="M961.26,-118431.83C961.26,-118431.83 961.26,-118351.85 961.26,-118351.85"/>
<polygon fill="black" stroke="black" points="964.76,-118351.85 961.26,-118341.85 957.76,-118351.85 964.76,-118351.85"/>
</g>
<!-- layer19_silu_1 -->
<g id="node500" class="node">
<title>layer19_silu_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1206,-118341.82 1025,-118341.82 1025,-118273.82 1206,-118273.82 1206,-118341.82"/>
<text text-anchor="middle" x="1115.5" y="-118326.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1115.5" y="-118311.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1115.5" y="-118296.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1115.5" y="-118281.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_gate_ar&#45;&gt;layer19_silu_1 -->
<g id="edge635" class="edge">
<title>layer19_gate_ar&#45;&gt;layer19_silu_1</title>
<path fill="none" stroke="black" d="M1107.24,-118416.93C1107.24,-118416.93 1107.24,-118351.83 1107.24,-118351.83"/>
<polygon fill="black" stroke="black" points="1110.74,-118351.83 1107.24,-118341.83 1103.74,-118351.83 1110.74,-118351.83"/>
</g>
<!-- layer19_mul_0 -->
<g id="node501" class="node">
<title>layer19_mul_0</title>
<polygon fill="#ffe6e6" stroke="black" points="836,-118201.82 655,-118201.82 655,-118133.82 836,-118133.82 836,-118201.82"/>
<text text-anchor="middle" x="745.5" y="-118186.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="745.5" y="-118171.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="745.5" y="-118156.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="745.5" y="-118141.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_up_ar&#45;&gt;layer19_mul_0 -->
<g id="edge637" class="edge">
<title>layer19_up_ar&#45;&gt;layer19_mul_0</title>
<path fill="none" stroke="black" d="M731.5,-118414C731.5,-118414 731.5,-118211.93 731.5,-118211.93"/>
<polygon fill="black" stroke="black" points="735,-118211.93 731.5,-118201.93 728,-118211.93 735,-118211.93"/>
</g>
<!-- layer19_mul_1 -->
<g id="node502" class="node">
<title>layer19_mul_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1053,-118201.82 872,-118201.82 872,-118133.82 1053,-118133.82 1053,-118201.82"/>
<text text-anchor="middle" x="962.5" y="-118186.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="962.5" y="-118171.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="962.5" y="-118156.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="962.5" y="-118141.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer19_up_ar&#45;&gt;layer19_mul_1 -->
<g id="edge639" class="edge">
<title>layer19_up_ar&#45;&gt;layer19_mul_1</title>
<path fill="none" stroke="black" d="M825.74,-118437.35C825.74,-118412.27 825.74,-118377 825.74,-118377 825.74,-118377 1007,-118377 1007,-118377 1007,-118377 1007,-118211.9 1007,-118211.9"/>
<polygon fill="black" stroke="black" points="1010.5,-118211.9 1007,-118201.9 1003.5,-118211.9 1010.5,-118211.9"/>
</g>
<!-- layer19_silu_0&#45;&gt;layer19_mul_0 -->
<g id="edge636" class="edge">
<title>layer19_silu_0&#45;&gt;layer19_mul_0</title>
<path fill="none" stroke="black" d="M822,-118273.58C822,-118273.58 822,-118212.2 822,-118212.2"/>
<polygon fill="black" stroke="black" points="825.5,-118212.2 822,-118202.2 818.5,-118212.2 825.5,-118212.2"/>
</g>
<!-- layer19_silu_1&#45;&gt;layer19_mul_1 -->
<g id="edge638" class="edge">
<title>layer19_silu_1&#45;&gt;layer19_mul_1</title>
<path fill="none" stroke="black" d="M1039,-118273.58C1039,-118273.58 1039,-118212.2 1039,-118212.2"/>
<polygon fill="black" stroke="black" points="1042.5,-118212.2 1039,-118202.2 1035.5,-118212.2 1042.5,-118212.2"/>
</g>
<!-- layer19_ffn_down_0 -->
<g id="node503" class="node">
<title>layer19_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="835.5,-118061.82 663.5,-118061.82 663.5,-117993.82 835.5,-117993.82 835.5,-118061.82"/>
<text text-anchor="middle" x="749.5" y="-118046.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="749.5" y="-118031.62" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="749.5" y="-118016.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="749.5" y="-118001.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer19_mul_0&#45;&gt;layer19_ffn_down_0 -->
<g id="edge640" class="edge">
<title>layer19_mul_0&#45;&gt;layer19_ffn_down_0</title>
<path fill="none" stroke="black" d="M749.5,-118133.58C749.5,-118133.58 749.5,-118072.2 749.5,-118072.2"/>
<polygon fill="black" stroke="black" points="753,-118072.2 749.5,-118062.2 746,-118072.2 753,-118072.2"/>
</g>
<!-- layer19_ffn_down_1 -->
<g id="node504" class="node">
<title>layer19_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1045.5,-118061.82 873.5,-118061.82 873.5,-117993.82 1045.5,-117993.82 1045.5,-118061.82"/>
<text text-anchor="middle" x="959.5" y="-118046.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="959.5" y="-118031.62" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="959.5" y="-118016.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="959.5" y="-118001.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer19_mul_1&#45;&gt;layer19_ffn_down_1 -->
<g id="edge641" class="edge">
<title>layer19_mul_1&#45;&gt;layer19_ffn_down_1</title>
<path fill="none" stroke="black" d="M959.5,-118133.58C959.5,-118133.58 959.5,-118072.2 959.5,-118072.2"/>
<polygon fill="black" stroke="black" points="963,-118072.2 959.5,-118062.2 956,-118072.2 963,-118072.2"/>
</g>
<!-- layer19_ffn_ar -->
<g id="node505" class="node">
<title>layer19_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="781.5" cy="-117873.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="781.5" y="-117892.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="781.5" y="-117877.54" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
<text text-anchor="middle" x="781.5" y="-117862.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="781.5" y="-117847.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_ffn_down_0&#45;&gt;layer19_ffn_ar -->
<g id="edge642" class="edge">
<title>layer19_ffn_down_0&#45;&gt;layer19_ffn_ar</title>
<path fill="none" stroke="black" d="M749.5,-117993.63C749.5,-117993.63 749.5,-117930.41 749.5,-117930.41"/>
<polygon fill="black" stroke="black" points="753,-117930.41 749.5,-117920.41 746,-117930.41 753,-117930.41"/>
</g>
<!-- layer19_ffn_down_1&#45;&gt;layer19_ffn_ar -->
<g id="edge643" class="edge">
<title>layer19_ffn_down_1&#45;&gt;layer19_ffn_ar</title>
<path fill="none" stroke="black" d="M888.31,-117993.63C888.31,-117993.63 888.31,-117906.86 888.31,-117906.86"/>
<polygon fill="black" stroke="black" points="891.81,-117906.86 888.31,-117896.86 884.81,-117906.86 891.81,-117906.86"/>
</g>
<!-- pp_send_0_1 -->
<g id="node506" class="node">
<title>pp_send_0_1</title>
<ellipse fill="lightcoral" stroke="black" cx="781.5" cy="-117716.18" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="781.5" y="-117727.48" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="781.5" y="-117712.48" font-family="Times,serif" font-size="14.00">Stage 01</text>
<text text-anchor="middle" x="781.5" y="-117697.48" font-family="Times,serif" font-size="14.00">GPU:[1][2]</text>
</g>
<!-- layer19_ffn_ar&#45;&gt;pp_send_0_1 -->
<g id="edge646" class="edge">
<title>layer19_ffn_ar&#45;&gt;pp_send_0_1</title>
<path fill="none" stroke="black" d="M781.5,-117825.61C781.5,-117825.61 781.5,-117763.77 781.5,-117763.77"/>
<polygon fill="black" stroke="black" points="785,-117763.77 781.5,-117753.77 778,-117763.77 785,-117763.77"/>
</g>
<!-- split_stage1 -->
<g id="node507" class="node">
<title>split_stage1</title>
<polygon fill="lightyellow" stroke="black" points="1131.85,-117606.7 574.52,-117606.7 431.15,-117530.7 988.48,-117530.7 1131.85,-117606.7"/>
<text text-anchor="middle" x="781.5" y="-117572.5" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="781.5" y="-117557.5" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=4096]</text>
</g>
<!-- pp_send_0_1&#45;&gt;split_stage1 -->
<g id="edge647" class="edge">
<title>pp_send_0_1&#45;&gt;split_stage1</title>
<path fill="none" stroke="black" d="M781.5,-117678.59C781.5,-117678.59 781.5,-117616.74 781.5,-117616.74"/>
<polygon fill="black" stroke="black" points="785,-117616.74 781.5,-117606.74 778,-117616.74 785,-117616.74"/>
</g>
<!-- layer20_embed_2 -->
<g id="node508" class="node">
<title>layer20_embed_2</title>
<polygon fill="#e6ffe6" stroke="black" points="704.5,-117458.7 532.5,-117458.7 532.5,-117390.7 704.5,-117390.7 704.5,-117458.7"/>
<text text-anchor="middle" x="618.5" y="-117443.5" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="618.5" y="-117428.5" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="618.5" y="-117413.5" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="618.5" y="-117398.5" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage1&#45;&gt;layer20_embed_2 -->
<g id="edge648" class="edge">
<title>split_stage1&#45;&gt;layer20_embed_2</title>
<path fill="none" stroke="black" d="M618.5,-117530.49C618.5,-117530.49 618.5,-117469.15 618.5,-117469.15"/>
<polygon fill="black" stroke="black" points="622,-117469.15 618.5,-117459.15 615,-117469.15 622,-117469.15"/>
</g>
<!-- layer20_embed_3 -->
<g id="node509" class="node">
<title>layer20_embed_3</title>
<polygon fill="#e6ffe6" stroke="black" points="912.5,-117458.7 740.5,-117458.7 740.5,-117390.7 912.5,-117390.7 912.5,-117458.7"/>
<text text-anchor="middle" x="826.5" y="-117443.5" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="826.5" y="-117428.5" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="826.5" y="-117413.5" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="826.5" y="-117398.5" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage1&#45;&gt;layer20_embed_3 -->
<g id="edge649" class="edge">
<title>split_stage1&#45;&gt;layer20_embed_3</title>
<path fill="none" stroke="black" d="M826.5,-117530.49C826.5,-117530.49 826.5,-117469.15 826.5,-117469.15"/>
<polygon fill="black" stroke="black" points="830,-117469.15 826.5,-117459.15 823,-117469.15 830,-117469.15"/>
</g>
<!-- embed_ag_stage1 -->
<g id="node512" class="node">
<title>embed_ag_stage1</title>
<ellipse fill="lightblue" stroke="black" cx="722.5" cy="-117270.62" rx="124.4" ry="48.17"/>
<text text-anchor="middle" x="722.5" y="-117289.42" font-family="Times,serif" font-size="14.00">All&#45;Gather Embedding</text>
<text text-anchor="middle" x="722.5" y="-117274.42" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="722.5" y="-117259.42" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="722.5" y="-117244.42" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_embed_2&#45;&gt;embed_ag_stage1 -->
<g id="edge1290" class="edge">
<title>layer20_embed_2&#45;&gt;embed_ag_stage1</title>
<path fill="none" stroke="black" d="M651.27,-117390.51C651.27,-117390.51 651.27,-117320.16 651.27,-117320.16"/>
<polygon fill="black" stroke="black" points="654.77,-117320.16 651.27,-117310.16 647.77,-117320.16 654.77,-117320.16"/>
</g>
<!-- layer20_embed_3&#45;&gt;embed_ag_stage1 -->
<g id="edge1291" class="edge">
<title>layer20_embed_3&#45;&gt;embed_ag_stage1</title>
<path fill="none" stroke="black" d="M793.73,-117390.51C793.73,-117390.51 793.73,-117320.16 793.73,-117320.16"/>
<polygon fill="black" stroke="black" points="797.23,-117320.16 793.73,-117310.16 790.23,-117320.16 797.23,-117320.16"/>
</g>
<!-- layer20_norm_2 -->
<g id="node510" class="node">
<title>layer20_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="703.5,-117150.54 531.5,-117150.54 531.5,-117082.54 703.5,-117082.54 703.5,-117150.54"/>
<text text-anchor="middle" x="617.5" y="-117135.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="617.5" y="-117120.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="617.5" y="-117105.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="617.5" y="-117090.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_qkv_2 -->
<g id="node513" class="node">
<title>layer20_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="704,-117010.54 523,-117010.54 523,-116942.54 704,-116942.54 704,-117010.54"/>
<text text-anchor="middle" x="613.5" y="-116995.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="613.5" y="-116980.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="613.5" y="-116965.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="613.5" y="-116950.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer20_norm_2&#45;&gt;layer20_qkv_2 -->
<g id="edge652" class="edge">
<title>layer20_norm_2&#45;&gt;layer20_qkv_2</title>
<path fill="none" stroke="black" d="M617.5,-117082.29C617.5,-117082.29 617.5,-117020.92 617.5,-117020.92"/>
<polygon fill="black" stroke="black" points="621,-117020.92 617.5,-117010.92 614,-117020.92 621,-117020.92"/>
</g>
<!-- layer20_norm_3 -->
<g id="node511" class="node">
<title>layer20_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="913.5,-117150.54 741.5,-117150.54 741.5,-117082.54 913.5,-117082.54 913.5,-117150.54"/>
<text text-anchor="middle" x="827.5" y="-117135.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="827.5" y="-117120.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="827.5" y="-117105.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="827.5" y="-117090.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_qkv_3 -->
<g id="node514" class="node">
<title>layer20_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="921,-117010.54 740,-117010.54 740,-116942.54 921,-116942.54 921,-117010.54"/>
<text text-anchor="middle" x="830.5" y="-116995.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="830.5" y="-116980.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="830.5" y="-116965.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="830.5" y="-116950.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer20_norm_3&#45;&gt;layer20_qkv_3 -->
<g id="edge653" class="edge">
<title>layer20_norm_3&#45;&gt;layer20_qkv_3</title>
<path fill="none" stroke="black" d="M827.5,-117082.29C827.5,-117082.29 827.5,-117020.92 827.5,-117020.92"/>
<polygon fill="black" stroke="black" points="831,-117020.92 827.5,-117010.92 824,-117020.92 831,-117020.92"/>
</g>
<!-- embed_ag_stage1&#45;&gt;layer20_norm_2 -->
<g id="edge650" class="edge">
<title>embed_ag_stage1&#45;&gt;layer20_norm_2</title>
<path fill="none" stroke="black" d="M650.77,-117230.94C650.77,-117230.94 650.77,-117160.6 650.77,-117160.6"/>
<polygon fill="black" stroke="black" points="654.27,-117160.6 650.77,-117150.6 647.27,-117160.6 654.27,-117160.6"/>
</g>
<!-- embed_ag_stage1&#45;&gt;layer20_norm_3 -->
<g id="edge651" class="edge">
<title>embed_ag_stage1&#45;&gt;layer20_norm_3</title>
<path fill="none" stroke="black" d="M794.23,-117230.94C794.23,-117230.94 794.23,-117160.6 794.23,-117160.6"/>
<polygon fill="black" stroke="black" points="797.73,-117160.6 794.23,-117150.6 790.73,-117160.6 797.73,-117160.6"/>
</g>
<!-- layer20_qkv_ar -->
<g id="node515" class="node">
<title>layer20_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="722.5" cy="-116822.45" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="722.5" y="-116841.25" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="722.5" y="-116826.25" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="722.5" y="-116811.25" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="722.5" y="-116796.25" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer20_qkv_2&#45;&gt;layer20_qkv_ar -->
<g id="edge654" class="edge">
<title>layer20_qkv_2&#45;&gt;layer20_qkv_ar</title>
<path fill="none" stroke="black" d="M649.26,-116942.34C649.26,-116942.34 649.26,-116872 649.26,-116872"/>
<polygon fill="black" stroke="black" points="652.76,-116872 649.26,-116862 645.76,-116872 652.76,-116872"/>
</g>
<!-- layer20_qkv_3&#45;&gt;layer20_qkv_ar -->
<g id="edge655" class="edge">
<title>layer20_qkv_3&#45;&gt;layer20_qkv_ar</title>
<path fill="none" stroke="black" d="M795.24,-116942.34C795.24,-116942.34 795.24,-116872.28 795.24,-116872.28"/>
<polygon fill="black" stroke="black" points="798.74,-116872.28 795.24,-116862.28 791.74,-116872.28 798.74,-116872.28"/>
</g>
<!-- layer20_attn_2 -->
<g id="node516" class="node">
<title>layer20_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="704.5,-116702.37 532.5,-116702.37 532.5,-116634.37 704.5,-116634.37 704.5,-116702.37"/>
<text text-anchor="middle" x="618.5" y="-116687.17" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="618.5" y="-116672.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="618.5" y="-116657.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="618.5" y="-116642.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer20_qkv_ar&#45;&gt;layer20_attn_2 -->
<g id="edge656" class="edge">
<title>layer20_qkv_ar&#45;&gt;layer20_attn_2</title>
<path fill="none" stroke="black" d="M649.51,-116782.77C649.51,-116782.77 649.51,-116712.43 649.51,-116712.43"/>
<polygon fill="black" stroke="black" points="653.01,-116712.43 649.51,-116702.43 646.01,-116712.43 653.01,-116712.43"/>
</g>
<!-- layer20_attn_3 -->
<g id="node517" class="node">
<title>layer20_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="912.5,-116702.37 740.5,-116702.37 740.5,-116634.37 912.5,-116634.37 912.5,-116702.37"/>
<text text-anchor="middle" x="826.5" y="-116687.17" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="826.5" y="-116672.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="826.5" y="-116657.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="826.5" y="-116642.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer20_qkv_ar&#45;&gt;layer20_attn_3 -->
<g id="edge657" class="edge">
<title>layer20_qkv_ar&#45;&gt;layer20_attn_3</title>
<path fill="none" stroke="black" d="M795.49,-116782.77C795.49,-116782.77 795.49,-116712.43 795.49,-116712.43"/>
<polygon fill="black" stroke="black" points="798.99,-116712.43 795.49,-116702.43 791.99,-116712.43 798.99,-116712.43"/>
</g>
<!-- layer20_attn_out_2 -->
<g id="node518" class="node">
<title>layer20_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="704.5,-116562.37 532.5,-116562.37 532.5,-116494.37 704.5,-116494.37 704.5,-116562.37"/>
<text text-anchor="middle" x="618.5" y="-116547.17" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="618.5" y="-116532.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="618.5" y="-116517.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="618.5" y="-116502.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer20_attn_2&#45;&gt;layer20_attn_out_2 -->
<g id="edge658" class="edge">
<title>layer20_attn_2&#45;&gt;layer20_attn_out_2</title>
<path fill="none" stroke="black" d="M618.5,-116634.12C618.5,-116634.12 618.5,-116572.75 618.5,-116572.75"/>
<polygon fill="black" stroke="black" points="622,-116572.75 618.5,-116562.75 615,-116572.75 622,-116572.75"/>
</g>
<!-- layer20_attn_out_3 -->
<g id="node519" class="node">
<title>layer20_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="912.5,-116562.37 740.5,-116562.37 740.5,-116494.37 912.5,-116494.37 912.5,-116562.37"/>
<text text-anchor="middle" x="826.5" y="-116547.17" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="826.5" y="-116532.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="826.5" y="-116517.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="826.5" y="-116502.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer20_attn_3&#45;&gt;layer20_attn_out_3 -->
<g id="edge659" class="edge">
<title>layer20_attn_3&#45;&gt;layer20_attn_out_3</title>
<path fill="none" stroke="black" d="M826.5,-116634.12C826.5,-116634.12 826.5,-116572.75 826.5,-116572.75"/>
<polygon fill="black" stroke="black" points="830,-116572.75 826.5,-116562.75 823,-116572.75 830,-116572.75"/>
</g>
<!-- layer20_attn_ar -->
<g id="node520" class="node">
<title>layer20_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="722.5" cy="-116374.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="722.5" y="-116393.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="722.5" y="-116378.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="722.5" y="-116363.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="722.5" y="-116348.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_attn_out_2&#45;&gt;layer20_attn_ar -->
<g id="edge660" class="edge">
<title>layer20_attn_out_2&#45;&gt;layer20_attn_ar</title>
<path fill="none" stroke="black" d="M652.69,-116494.18C652.69,-116494.18 652.69,-116423.83 652.69,-116423.83"/>
<polygon fill="black" stroke="black" points="656.19,-116423.83 652.69,-116413.83 649.19,-116423.83 656.19,-116423.83"/>
</g>
<!-- layer20_attn_out_3&#45;&gt;layer20_attn_ar -->
<g id="edge661" class="edge">
<title>layer20_attn_out_3&#45;&gt;layer20_attn_ar</title>
<path fill="none" stroke="black" d="M792.31,-116494.18C792.31,-116494.18 792.31,-116423.83 792.31,-116423.83"/>
<polygon fill="black" stroke="black" points="795.81,-116423.83 792.31,-116413.83 788.81,-116423.83 795.81,-116423.83"/>
</g>
<!-- layer20_ffn_norm_2 -->
<g id="node521" class="node">
<title>layer20_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="700.5,-116254.21 528.5,-116254.21 528.5,-116186.21 700.5,-116186.21 700.5,-116254.21"/>
<text text-anchor="middle" x="614.5" y="-116239.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="614.5" y="-116224.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="614.5" y="-116209.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="614.5" y="-116194.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_attn_ar&#45;&gt;layer20_ffn_norm_2 -->
<g id="edge662" class="edge">
<title>layer20_attn_ar&#45;&gt;layer20_ffn_norm_2</title>
<path fill="none" stroke="black" d="M650.69,-116335.41C650.69,-116335.41 650.69,-116264.35 650.69,-116264.35"/>
<polygon fill="black" stroke="black" points="654.19,-116264.35 650.69,-116254.35 647.19,-116264.35 654.19,-116264.35"/>
</g>
<!-- layer20_ffn_norm_3 -->
<g id="node522" class="node">
<title>layer20_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="917.5,-116254.21 745.5,-116254.21 745.5,-116186.21 917.5,-116186.21 917.5,-116254.21"/>
<text text-anchor="middle" x="831.5" y="-116239.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="831.5" y="-116224.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="831.5" y="-116209.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="831.5" y="-116194.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_attn_ar&#45;&gt;layer20_ffn_norm_3 -->
<g id="edge663" class="edge">
<title>layer20_attn_ar&#45;&gt;layer20_ffn_norm_3</title>
<path fill="none" stroke="black" d="M794.81,-116335.41C794.81,-116335.41 794.81,-116264.35 794.81,-116264.35"/>
<polygon fill="black" stroke="black" points="798.31,-116264.35 794.81,-116254.35 791.31,-116264.35 798.31,-116264.35"/>
</g>
<!-- layer20_ffn_gate_2 -->
<g id="node523" class="node">
<title>layer20_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="705,-116114.21 524,-116114.21 524,-116046.21 705,-116046.21 705,-116114.21"/>
<text text-anchor="middle" x="614.5" y="-116099.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="614.5" y="-116084.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="614.5" y="-116069.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="614.5" y="-116054.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_ffn_norm_2&#45;&gt;layer20_ffn_gate_2 -->
<g id="edge664" class="edge">
<title>layer20_ffn_norm_2&#45;&gt;layer20_ffn_gate_2</title>
<path fill="none" stroke="black" d="M614.5,-116185.96C614.5,-116185.96 614.5,-116124.58 614.5,-116124.58"/>
<polygon fill="black" stroke="black" points="618,-116124.58 614.5,-116114.58 611,-116124.58 618,-116124.58"/>
</g>
<!-- layer20_ffn_up_2 -->
<g id="node525" class="node">
<title>layer20_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="488,-116114.21 307,-116114.21 307,-116046.21 488,-116046.21 488,-116114.21"/>
<text text-anchor="middle" x="397.5" y="-116099.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="397.5" y="-116084.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="397.5" y="-116069.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="397.5" y="-116054.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_ffn_norm_2&#45;&gt;layer20_ffn_up_2 -->
<g id="edge666" class="edge">
<title>layer20_ffn_norm_2&#45;&gt;layer20_ffn_up_2</title>
<path fill="none" stroke="black" d="M528.41,-116220C492.74,-116220 459.54,-116220 459.54,-116220 459.54,-116220 459.54,-116124.4 459.54,-116124.4"/>
<polygon fill="black" stroke="black" points="463.04,-116124.4 459.54,-116114.4 456.04,-116124.4 463.04,-116124.4"/>
</g>
<!-- layer20_ffn_gate_3 -->
<g id="node524" class="node">
<title>layer20_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1139,-116114.21 958,-116114.21 958,-116046.21 1139,-116046.21 1139,-116114.21"/>
<text text-anchor="middle" x="1048.5" y="-116099.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1048.5" y="-116084.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1048.5" y="-116069.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1048.5" y="-116054.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_ffn_norm_3&#45;&gt;layer20_ffn_gate_3 -->
<g id="edge665" class="edge">
<title>layer20_ffn_norm_3&#45;&gt;layer20_ffn_gate_3</title>
<path fill="none" stroke="black" d="M917.71,-116220C976.95,-116220 1044.96,-116220 1044.96,-116220 1044.96,-116220 1044.96,-116124.4 1044.96,-116124.4"/>
<polygon fill="black" stroke="black" points="1048.46,-116124.4 1044.96,-116114.4 1041.46,-116124.4 1048.46,-116124.4"/>
</g>
<!-- layer20_ffn_up_3 -->
<g id="node526" class="node">
<title>layer20_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="922,-116114.21 741,-116114.21 741,-116046.21 922,-116046.21 922,-116114.21"/>
<text text-anchor="middle" x="831.5" y="-116099.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="831.5" y="-116084.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="831.5" y="-116069.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="831.5" y="-116054.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_ffn_norm_3&#45;&gt;layer20_ffn_up_3 -->
<g id="edge667" class="edge">
<title>layer20_ffn_norm_3&#45;&gt;layer20_ffn_up_3</title>
<path fill="none" stroke="black" d="M831.5,-116185.96C831.5,-116185.96 831.5,-116124.58 831.5,-116124.58"/>
<polygon fill="black" stroke="black" points="835,-116124.58 831.5,-116114.58 828,-116124.58 835,-116124.58"/>
</g>
<!-- layer20_gate_ar -->
<g id="node527" class="node">
<title>layer20_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="869.5" cy="-115926.12" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="869.5" y="-115944.92" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="869.5" y="-115929.92" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="869.5" y="-115914.92" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="869.5" y="-115899.92" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer20_ffn_gate_2&#45;&gt;layer20_gate_ar -->
<g id="edge668" class="edge">
<title>layer20_ffn_gate_2&#45;&gt;layer20_gate_ar</title>
<path fill="none" stroke="black" d="M678.24,-116046.17C678.24,-115996.5 678.24,-115910 678.24,-115910 678.24,-115910 738.92,-115910 738.92,-115910"/>
<polygon fill="black" stroke="black" points="738.92,-115913.5 748.92,-115910 738.92,-115906.5 738.92,-115913.5"/>
</g>
<!-- layer20_ffn_gate_3&#45;&gt;layer20_gate_ar -->
<g id="edge669" class="edge">
<title>layer20_ffn_gate_3&#45;&gt;layer20_gate_ar</title>
<path fill="none" stroke="black" d="M977.74,-116046.01C977.74,-116046.01 977.74,-115962.09 977.74,-115962.09"/>
<polygon fill="black" stroke="black" points="981.24,-115962.09 977.74,-115952.09 974.24,-115962.09 981.24,-115962.09"/>
</g>
<!-- layer20_up_ar -->
<g id="node528" class="node">
<title>layer20_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="523.5" cy="-115926.12" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="523.5" y="-115944.92" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="523.5" y="-115929.92" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="523.5" y="-115914.92" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="523.5" y="-115899.92" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer20_ffn_up_2&#45;&gt;layer20_up_ar -->
<g id="edge670" class="edge">
<title>layer20_ffn_up_2&#45;&gt;layer20_up_ar</title>
<path fill="none" stroke="black" d="M441.76,-116046.01C441.76,-116046.01 441.76,-115973.18 441.76,-115973.18"/>
<polygon fill="black" stroke="black" points="445.26,-115973.18 441.76,-115963.18 438.26,-115973.18 445.26,-115973.18"/>
</g>
<!-- layer20_ffn_up_3&#45;&gt;layer20_up_ar -->
<g id="edge671" class="edge">
<title>layer20_ffn_up_3&#45;&gt;layer20_up_ar</title>
<path fill="none" stroke="black" d="M740.92,-116080C730.21,-116080 723,-116080 723,-116080 723,-116080 723,-115942 723,-115942 723,-115942 654.44,-115942 654.44,-115942"/>
<polygon fill="black" stroke="black" points="654.44,-115938.5 644.44,-115942 654.44,-115945.5 654.44,-115938.5"/>
</g>
<!-- layer20_silu_2 -->
<g id="node529" class="node">
<title>layer20_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="797,-115806.04 616,-115806.04 616,-115738.04 797,-115738.04 797,-115806.04"/>
<text text-anchor="middle" x="706.5" y="-115790.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="706.5" y="-115775.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="706.5" y="-115760.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="706.5" y="-115745.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_gate_ar&#45;&gt;layer20_silu_2 -->
<g id="edge672" class="edge">
<title>layer20_gate_ar&#45;&gt;layer20_silu_2</title>
<path fill="none" stroke="black" d="M769.26,-115896.05C769.26,-115896.05 769.26,-115816.06 769.26,-115816.06"/>
<polygon fill="black" stroke="black" points="772.76,-115816.06 769.26,-115806.06 765.76,-115816.06 772.76,-115816.06"/>
</g>
<!-- layer20_silu_3 -->
<g id="node530" class="node">
<title>layer20_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1014,-115806.04 833,-115806.04 833,-115738.04 1014,-115738.04 1014,-115806.04"/>
<text text-anchor="middle" x="923.5" y="-115790.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="923.5" y="-115775.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="923.5" y="-115760.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="923.5" y="-115745.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_gate_ar&#45;&gt;layer20_silu_3 -->
<g id="edge673" class="edge">
<title>layer20_gate_ar&#45;&gt;layer20_silu_3</title>
<path fill="none" stroke="black" d="M915.24,-115881.14C915.24,-115881.14 915.24,-115816.04 915.24,-115816.04"/>
<polygon fill="black" stroke="black" points="918.74,-115816.04 915.24,-115806.04 911.74,-115816.04 918.74,-115816.04"/>
</g>
<!-- layer20_mul_2 -->
<g id="node531" class="node">
<title>layer20_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="687,-115666.04 506,-115666.04 506,-115598.04 687,-115598.04 687,-115666.04"/>
<text text-anchor="middle" x="596.5" y="-115650.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="596.5" y="-115635.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="596.5" y="-115620.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="596.5" y="-115605.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_up_ar&#45;&gt;layer20_mul_2 -->
<g id="edge675" class="edge">
<title>layer20_up_ar&#45;&gt;layer20_mul_2</title>
<path fill="none" stroke="black" d="M561,-115879.85C561,-115879.85 561,-115676.12 561,-115676.12"/>
<polygon fill="black" stroke="black" points="564.5,-115676.12 561,-115666.12 557.5,-115676.12 564.5,-115676.12"/>
</g>
<!-- layer20_mul_3 -->
<g id="node532" class="node">
<title>layer20_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="904,-115666.04 723,-115666.04 723,-115598.04 904,-115598.04 904,-115666.04"/>
<text text-anchor="middle" x="813.5" y="-115650.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="813.5" y="-115635.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="813.5" y="-115620.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="813.5" y="-115605.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer20_up_ar&#45;&gt;layer20_mul_3 -->
<g id="edge677" class="edge">
<title>layer20_up_ar&#45;&gt;layer20_mul_3</title>
<path fill="none" stroke="black" d="M633.74,-115901.34C633.74,-115876.52 633.74,-115842 633.74,-115842 633.74,-115842 815,-115842 815,-115842 815,-115842 815,-115676.24 815,-115676.24"/>
<polygon fill="black" stroke="black" points="818.5,-115676.24 815,-115666.24 811.5,-115676.24 818.5,-115676.24"/>
</g>
<!-- layer20_silu_2&#45;&gt;layer20_mul_2 -->
<g id="edge674" class="edge">
<title>layer20_silu_2&#45;&gt;layer20_mul_2</title>
<path fill="none" stroke="black" d="M651.5,-115737.79C651.5,-115737.79 651.5,-115676.42 651.5,-115676.42"/>
<polygon fill="black" stroke="black" points="655,-115676.42 651.5,-115666.42 648,-115676.42 655,-115676.42"/>
</g>
<!-- layer20_silu_3&#45;&gt;layer20_mul_3 -->
<g id="edge676" class="edge">
<title>layer20_silu_3&#45;&gt;layer20_mul_3</title>
<path fill="none" stroke="black" d="M868.5,-115737.79C868.5,-115737.79 868.5,-115676.42 868.5,-115676.42"/>
<polygon fill="black" stroke="black" points="872,-115676.42 868.5,-115666.42 865,-115676.42 872,-115676.42"/>
</g>
<!-- layer20_ffn_down_2 -->
<g id="node533" class="node">
<title>layer20_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="686.5,-115526.04 514.5,-115526.04 514.5,-115458.04 686.5,-115458.04 686.5,-115526.04"/>
<text text-anchor="middle" x="600.5" y="-115510.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="600.5" y="-115495.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="600.5" y="-115480.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="600.5" y="-115465.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer20_mul_2&#45;&gt;layer20_ffn_down_2 -->
<g id="edge678" class="edge">
<title>layer20_mul_2&#45;&gt;layer20_ffn_down_2</title>
<path fill="none" stroke="black" d="M600.5,-115597.79C600.5,-115597.79 600.5,-115536.42 600.5,-115536.42"/>
<polygon fill="black" stroke="black" points="604,-115536.42 600.5,-115526.42 597,-115536.42 604,-115536.42"/>
</g>
<!-- layer20_ffn_down_3 -->
<g id="node534" class="node">
<title>layer20_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="896.5,-115526.04 724.5,-115526.04 724.5,-115458.04 896.5,-115458.04 896.5,-115526.04"/>
<text text-anchor="middle" x="810.5" y="-115510.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="810.5" y="-115495.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="810.5" y="-115480.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="810.5" y="-115465.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer20_mul_3&#45;&gt;layer20_ffn_down_3 -->
<g id="edge679" class="edge">
<title>layer20_mul_3&#45;&gt;layer20_ffn_down_3</title>
<path fill="none" stroke="black" d="M810.5,-115597.79C810.5,-115597.79 810.5,-115536.42 810.5,-115536.42"/>
<polygon fill="black" stroke="black" points="814,-115536.42 810.5,-115526.42 807,-115536.42 814,-115536.42"/>
</g>
<!-- layer20_ffn_ar -->
<g id="node535" class="node">
<title>layer20_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="704.5" cy="-115337.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="704.5" y="-115356.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="704.5" y="-115341.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="704.5" y="-115326.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="704.5" y="-115311.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_ffn_down_2&#45;&gt;layer20_ffn_ar -->
<g id="edge680" class="edge">
<title>layer20_ffn_down_2&#45;&gt;layer20_ffn_ar</title>
<path fill="none" stroke="black" d="M634.69,-115457.84C634.69,-115457.84 634.69,-115387.5 634.69,-115387.5"/>
<polygon fill="black" stroke="black" points="638.19,-115387.5 634.69,-115377.5 631.19,-115387.5 638.19,-115387.5"/>
</g>
<!-- layer20_ffn_down_3&#45;&gt;layer20_ffn_ar -->
<g id="edge681" class="edge">
<title>layer20_ffn_down_3&#45;&gt;layer20_ffn_ar</title>
<path fill="none" stroke="black" d="M775.31,-115457.84C775.31,-115457.84 775.31,-115387.22 775.31,-115387.22"/>
<polygon fill="black" stroke="black" points="778.81,-115387.22 775.31,-115377.22 771.81,-115387.22 778.81,-115387.22"/>
</g>
<!-- layer21_norm_2 -->
<g id="node536" class="node">
<title>layer21_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="686.5,-115217.87 514.5,-115217.87 514.5,-115149.87 686.5,-115149.87 686.5,-115217.87"/>
<text text-anchor="middle" x="600.5" y="-115202.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="600.5" y="-115187.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="600.5" y="-115172.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="600.5" y="-115157.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_ffn_ar&#45;&gt;layer21_norm_2 -->
<g id="edge682" class="edge">
<title>layer20_ffn_ar&#45;&gt;layer21_norm_2</title>
<path fill="none" stroke="black" d="M634.69,-115298.27C634.69,-115298.27 634.69,-115227.93 634.69,-115227.93"/>
<polygon fill="black" stroke="black" points="638.19,-115227.93 634.69,-115217.93 631.19,-115227.93 638.19,-115227.93"/>
</g>
<!-- layer21_norm_3 -->
<g id="node537" class="node">
<title>layer21_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="896.5,-115217.87 724.5,-115217.87 724.5,-115149.87 896.5,-115149.87 896.5,-115217.87"/>
<text text-anchor="middle" x="810.5" y="-115202.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="810.5" y="-115187.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="810.5" y="-115172.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="810.5" y="-115157.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer20_ffn_ar&#45;&gt;layer21_norm_3 -->
<g id="edge683" class="edge">
<title>layer20_ffn_ar&#45;&gt;layer21_norm_3</title>
<path fill="none" stroke="black" d="M775.31,-115298.67C775.31,-115298.67 775.31,-115228.1 775.31,-115228.1"/>
<polygon fill="black" stroke="black" points="778.81,-115228.1 775.31,-115218.1 771.81,-115228.1 778.81,-115228.1"/>
</g>
<!-- layer21_qkv_2 -->
<g id="node538" class="node">
<title>layer21_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="687,-115077.87 506,-115077.87 506,-115009.87 687,-115009.87 687,-115077.87"/>
<text text-anchor="middle" x="596.5" y="-115062.67" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="596.5" y="-115047.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="596.5" y="-115032.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="596.5" y="-115017.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer21_norm_2&#45;&gt;layer21_qkv_2 -->
<g id="edge684" class="edge">
<title>layer21_norm_2&#45;&gt;layer21_qkv_2</title>
<path fill="none" stroke="black" d="M600.5,-115149.62C600.5,-115149.62 600.5,-115088.25 600.5,-115088.25"/>
<polygon fill="black" stroke="black" points="604,-115088.25 600.5,-115078.25 597,-115088.25 604,-115088.25"/>
</g>
<!-- layer21_qkv_3 -->
<g id="node539" class="node">
<title>layer21_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="904,-115077.87 723,-115077.87 723,-115009.87 904,-115009.87 904,-115077.87"/>
<text text-anchor="middle" x="813.5" y="-115062.67" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="813.5" y="-115047.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="813.5" y="-115032.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="813.5" y="-115017.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer21_norm_3&#45;&gt;layer21_qkv_3 -->
<g id="edge685" class="edge">
<title>layer21_norm_3&#45;&gt;layer21_qkv_3</title>
<path fill="none" stroke="black" d="M810.5,-115149.62C810.5,-115149.62 810.5,-115088.25 810.5,-115088.25"/>
<polygon fill="black" stroke="black" points="814,-115088.25 810.5,-115078.25 807,-115088.25 814,-115088.25"/>
</g>
<!-- layer21_qkv_ar -->
<g id="node540" class="node">
<title>layer21_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="704.5" cy="-114889.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="704.5" y="-114908.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="704.5" y="-114893.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="704.5" y="-114878.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="704.5" y="-114863.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer21_qkv_2&#45;&gt;layer21_qkv_ar -->
<g id="edge686" class="edge">
<title>layer21_qkv_2&#45;&gt;layer21_qkv_ar</title>
<path fill="none" stroke="black" d="M631.76,-115009.68C631.76,-115009.68 631.76,-114939.61 631.76,-114939.61"/>
<polygon fill="black" stroke="black" points="635.26,-114939.61 631.76,-114929.61 628.26,-114939.61 635.26,-114939.61"/>
</g>
<!-- layer21_qkv_3&#45;&gt;layer21_qkv_ar -->
<g id="edge687" class="edge">
<title>layer21_qkv_3&#45;&gt;layer21_qkv_ar</title>
<path fill="none" stroke="black" d="M777.74,-115009.68C777.74,-115009.68 777.74,-114939.33 777.74,-114939.33"/>
<polygon fill="black" stroke="black" points="781.24,-114939.33 777.74,-114929.33 774.24,-114939.33 781.24,-114939.33"/>
</g>
<!-- layer21_attn_2 -->
<g id="node541" class="node">
<title>layer21_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="686.5,-114769.71 514.5,-114769.71 514.5,-114701.71 686.5,-114701.71 686.5,-114769.71"/>
<text text-anchor="middle" x="600.5" y="-114754.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="600.5" y="-114739.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="600.5" y="-114724.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="600.5" y="-114709.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer21_qkv_ar&#45;&gt;layer21_attn_2 -->
<g id="edge688" class="edge">
<title>layer21_qkv_ar&#45;&gt;layer21_attn_2</title>
<path fill="none" stroke="black" d="M631.51,-114850.11C631.51,-114850.11 631.51,-114779.76 631.51,-114779.76"/>
<polygon fill="black" stroke="black" points="635.01,-114779.76 631.51,-114769.76 628.01,-114779.76 635.01,-114779.76"/>
</g>
<!-- layer21_attn_3 -->
<g id="node542" class="node">
<title>layer21_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="894.5,-114769.71 722.5,-114769.71 722.5,-114701.71 894.5,-114701.71 894.5,-114769.71"/>
<text text-anchor="middle" x="808.5" y="-114754.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="808.5" y="-114739.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="808.5" y="-114724.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="808.5" y="-114709.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer21_qkv_ar&#45;&gt;layer21_attn_3 -->
<g id="edge689" class="edge">
<title>layer21_qkv_ar&#45;&gt;layer21_attn_3</title>
<path fill="none" stroke="black" d="M777.49,-114850.11C777.49,-114850.11 777.49,-114779.76 777.49,-114779.76"/>
<polygon fill="black" stroke="black" points="780.99,-114779.76 777.49,-114769.76 773.99,-114779.76 780.99,-114779.76"/>
</g>
<!-- layer21_attn_out_2 -->
<g id="node543" class="node">
<title>layer21_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="686.5,-114629.71 514.5,-114629.71 514.5,-114561.71 686.5,-114561.71 686.5,-114629.71"/>
<text text-anchor="middle" x="600.5" y="-114614.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="600.5" y="-114599.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="600.5" y="-114584.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="600.5" y="-114569.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer21_attn_2&#45;&gt;layer21_attn_out_2 -->
<g id="edge690" class="edge">
<title>layer21_attn_2&#45;&gt;layer21_attn_out_2</title>
<path fill="none" stroke="black" d="M600.5,-114701.46C600.5,-114701.46 600.5,-114640.08 600.5,-114640.08"/>
<polygon fill="black" stroke="black" points="604,-114640.08 600.5,-114630.08 597,-114640.08 604,-114640.08"/>
</g>
<!-- layer21_attn_out_3 -->
<g id="node544" class="node">
<title>layer21_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="894.5,-114629.71 722.5,-114629.71 722.5,-114561.71 894.5,-114561.71 894.5,-114629.71"/>
<text text-anchor="middle" x="808.5" y="-114614.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="808.5" y="-114599.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="808.5" y="-114584.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="808.5" y="-114569.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer21_attn_3&#45;&gt;layer21_attn_out_3 -->
<g id="edge691" class="edge">
<title>layer21_attn_3&#45;&gt;layer21_attn_out_3</title>
<path fill="none" stroke="black" d="M808.5,-114701.46C808.5,-114701.46 808.5,-114640.08 808.5,-114640.08"/>
<polygon fill="black" stroke="black" points="812,-114640.08 808.5,-114630.08 805,-114640.08 812,-114640.08"/>
</g>
<!-- layer21_attn_ar -->
<g id="node545" class="node">
<title>layer21_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="704.5" cy="-114441.62" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="704.5" y="-114460.42" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="704.5" y="-114445.42" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="704.5" y="-114430.42" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="704.5" y="-114415.42" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer21_attn_out_2&#45;&gt;layer21_attn_ar -->
<g id="edge692" class="edge">
<title>layer21_attn_out_2&#45;&gt;layer21_attn_ar</title>
<path fill="none" stroke="black" d="M634.69,-114561.51C634.69,-114561.51 634.69,-114491.16 634.69,-114491.16"/>
<polygon fill="black" stroke="black" points="638.19,-114491.16 634.69,-114481.16 631.19,-114491.16 638.19,-114491.16"/>
</g>
<!-- layer21_attn_out_3&#45;&gt;layer21_attn_ar -->
<g id="edge693" class="edge">
<title>layer21_attn_out_3&#45;&gt;layer21_attn_ar</title>
<path fill="none" stroke="black" d="M774.31,-114561.51C774.31,-114561.51 774.31,-114491.16 774.31,-114491.16"/>
<polygon fill="black" stroke="black" points="777.81,-114491.16 774.31,-114481.16 770.81,-114491.16 777.81,-114491.16"/>
</g>
<!-- layer21_ffn_norm_2 -->
<g id="node546" class="node">
<title>layer21_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="682.5,-114321.54 510.5,-114321.54 510.5,-114253.54 682.5,-114253.54 682.5,-114321.54"/>
<text text-anchor="middle" x="596.5" y="-114306.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="596.5" y="-114291.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="596.5" y="-114276.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="596.5" y="-114261.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer21_attn_ar&#45;&gt;layer21_ffn_norm_2 -->
<g id="edge694" class="edge">
<title>layer21_attn_ar&#45;&gt;layer21_ffn_norm_2</title>
<path fill="none" stroke="black" d="M632.69,-114402.74C632.69,-114402.74 632.69,-114331.69 632.69,-114331.69"/>
<polygon fill="black" stroke="black" points="636.19,-114331.69 632.69,-114321.69 629.19,-114331.69 636.19,-114331.69"/>
</g>
<!-- layer21_ffn_norm_3 -->
<g id="node547" class="node">
<title>layer21_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="899.5,-114321.54 727.5,-114321.54 727.5,-114253.54 899.5,-114253.54 899.5,-114321.54"/>
<text text-anchor="middle" x="813.5" y="-114306.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="813.5" y="-114291.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="813.5" y="-114276.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="813.5" y="-114261.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer21_attn_ar&#45;&gt;layer21_ffn_norm_3 -->
<g id="edge695" class="edge">
<title>layer21_attn_ar&#45;&gt;layer21_ffn_norm_3</title>
<path fill="none" stroke="black" d="M776.81,-114402.74C776.81,-114402.74 776.81,-114331.69 776.81,-114331.69"/>
<polygon fill="black" stroke="black" points="780.31,-114331.69 776.81,-114321.69 773.31,-114331.69 780.31,-114331.69"/>
</g>
<!-- layer21_ffn_gate_2 -->
<g id="node548" class="node">
<title>layer21_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="687,-114181.54 506,-114181.54 506,-114113.54 687,-114113.54 687,-114181.54"/>
<text text-anchor="middle" x="596.5" y="-114166.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="596.5" y="-114151.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="596.5" y="-114136.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="596.5" y="-114121.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_ffn_norm_2&#45;&gt;layer21_ffn_gate_2 -->
<g id="edge696" class="edge">
<title>layer21_ffn_norm_2&#45;&gt;layer21_ffn_gate_2</title>
<path fill="none" stroke="black" d="M596.5,-114253.29C596.5,-114253.29 596.5,-114191.92 596.5,-114191.92"/>
<polygon fill="black" stroke="black" points="600,-114191.92 596.5,-114181.92 593,-114191.92 600,-114191.92"/>
</g>
<!-- layer21_ffn_up_2 -->
<g id="node550" class="node">
<title>layer21_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="470,-114181.54 289,-114181.54 289,-114113.54 470,-114113.54 470,-114181.54"/>
<text text-anchor="middle" x="379.5" y="-114166.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="379.5" y="-114151.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="379.5" y="-114136.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="379.5" y="-114121.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_ffn_norm_2&#45;&gt;layer21_ffn_up_2 -->
<g id="edge698" class="edge">
<title>layer21_ffn_norm_2&#45;&gt;layer21_ffn_up_2</title>
<path fill="none" stroke="black" d="M510.31,-114287C470.86,-114287 432.76,-114287 432.76,-114287 432.76,-114287 432.76,-114191.65 432.76,-114191.65"/>
<polygon fill="black" stroke="black" points="436.26,-114191.65 432.76,-114181.65 429.26,-114191.65 436.26,-114191.65"/>
</g>
<!-- layer21_ffn_gate_3 -->
<g id="node549" class="node">
<title>layer21_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1121,-114181.54 940,-114181.54 940,-114113.54 1121,-114113.54 1121,-114181.54"/>
<text text-anchor="middle" x="1030.5" y="-114166.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1030.5" y="-114151.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1030.5" y="-114136.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1030.5" y="-114121.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_ffn_norm_3&#45;&gt;layer21_ffn_gate_3 -->
<g id="edge697" class="edge">
<title>layer21_ffn_norm_3&#45;&gt;layer21_ffn_gate_3</title>
<path fill="none" stroke="black" d="M899.56,-114287C938.95,-114287 977,-114287 977,-114287 977,-114287 977,-114191.65 977,-114191.65"/>
<polygon fill="black" stroke="black" points="980.5,-114191.65 977,-114181.65 973.5,-114191.65 980.5,-114191.65"/>
</g>
<!-- layer21_ffn_up_3 -->
<g id="node551" class="node">
<title>layer21_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="904,-114181.54 723,-114181.54 723,-114113.54 904,-114113.54 904,-114181.54"/>
<text text-anchor="middle" x="813.5" y="-114166.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="813.5" y="-114151.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="813.5" y="-114136.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="813.5" y="-114121.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_ffn_norm_3&#45;&gt;layer21_ffn_up_3 -->
<g id="edge699" class="edge">
<title>layer21_ffn_norm_3&#45;&gt;layer21_ffn_up_3</title>
<path fill="none" stroke="black" d="M813.5,-114253.29C813.5,-114253.29 813.5,-114191.92 813.5,-114191.92"/>
<polygon fill="black" stroke="black" points="817,-114191.92 813.5,-114181.92 810,-114191.92 817,-114191.92"/>
</g>
<!-- layer21_gate_ar -->
<g id="node552" class="node">
<title>layer21_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="904.5" cy="-113993.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="904.5" y="-114012.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="904.5" y="-113997.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="904.5" y="-113982.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="904.5" y="-113967.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer21_ffn_gate_2&#45;&gt;layer21_gate_ar -->
<g id="edge700" class="edge">
<title>layer21_ffn_gate_2&#45;&gt;layer21_gate_ar</title>
<path fill="none" stroke="black" d="M687.08,-114147C697.79,-114147 705,-114147 705,-114147 705,-114147 705,-114009 705,-114009 705,-114009 773.28,-114009 773.28,-114009"/>
<polygon fill="black" stroke="black" points="773.28,-114012.5 783.28,-114009 773.28,-114005.5 773.28,-114012.5"/>
</g>
<!-- layer21_ffn_gate_3&#45;&gt;layer21_gate_ar -->
<g id="edge701" class="edge">
<title>layer21_ffn_gate_3&#45;&gt;layer21_gate_ar</title>
<path fill="none" stroke="black" d="M986.24,-114113.34C986.24,-114113.34 986.24,-114040.52 986.24,-114040.52"/>
<polygon fill="black" stroke="black" points="989.74,-114040.52 986.24,-114030.52 982.74,-114040.52 989.74,-114040.52"/>
</g>
<!-- layer21_up_ar -->
<g id="node553" class="node">
<title>layer21_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="558.5" cy="-113993.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="558.5" y="-114012.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="558.5" y="-113997.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="558.5" y="-113982.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="558.5" y="-113967.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer21_ffn_up_2&#45;&gt;layer21_up_ar -->
<g id="edge702" class="edge">
<title>layer21_ffn_up_2&#45;&gt;layer21_up_ar</title>
<path fill="none" stroke="black" d="M450.26,-114113.34C450.26,-114113.34 450.26,-114029.42 450.26,-114029.42"/>
<polygon fill="black" stroke="black" points="453.76,-114029.42 450.26,-114019.42 446.76,-114029.42 453.76,-114029.42"/>
</g>
<!-- layer21_ffn_up_3&#45;&gt;layer21_up_ar -->
<g id="edge703" class="edge">
<title>layer21_ffn_up_3&#45;&gt;layer21_up_ar</title>
<path fill="none" stroke="black" d="M749.76,-114113.44C749.76,-114063.67 749.76,-113977 749.76,-113977 749.76,-113977 688.81,-113977 688.81,-113977"/>
<polygon fill="black" stroke="black" points="688.81,-113973.5 678.81,-113977 688.81,-113980.5 688.81,-113973.5"/>
</g>
<!-- layer21_silu_2 -->
<g id="node554" class="node">
<title>layer21_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="832,-113873.37 651,-113873.37 651,-113805.37 832,-113805.37 832,-113873.37"/>
<text text-anchor="middle" x="741.5" y="-113858.17" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="741.5" y="-113843.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="741.5" y="-113828.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="741.5" y="-113813.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_gate_ar&#45;&gt;layer21_silu_2 -->
<g id="edge704" class="edge">
<title>layer21_gate_ar&#45;&gt;layer21_silu_2</title>
<path fill="none" stroke="black" d="M804.26,-113963.38C804.26,-113963.38 804.26,-113883.39 804.26,-113883.39"/>
<polygon fill="black" stroke="black" points="807.76,-113883.39 804.26,-113873.39 800.76,-113883.39 807.76,-113883.39"/>
</g>
<!-- layer21_silu_3 -->
<g id="node555" class="node">
<title>layer21_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1049,-113873.37 868,-113873.37 868,-113805.37 1049,-113805.37 1049,-113873.37"/>
<text text-anchor="middle" x="958.5" y="-113858.17" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="958.5" y="-113843.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="958.5" y="-113828.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="958.5" y="-113813.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_gate_ar&#45;&gt;layer21_silu_3 -->
<g id="edge705" class="edge">
<title>layer21_gate_ar&#45;&gt;layer21_silu_3</title>
<path fill="none" stroke="black" d="M950.24,-113948.47C950.24,-113948.47 950.24,-113883.38 950.24,-113883.38"/>
<polygon fill="black" stroke="black" points="953.74,-113883.38 950.24,-113873.38 946.74,-113883.38 953.74,-113883.38"/>
</g>
<!-- layer21_mul_2 -->
<g id="node556" class="node">
<title>layer21_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="722,-113733.37 541,-113733.37 541,-113665.37 722,-113665.37 722,-113733.37"/>
<text text-anchor="middle" x="631.5" y="-113718.17" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="631.5" y="-113703.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="631.5" y="-113688.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="631.5" y="-113673.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_up_ar&#45;&gt;layer21_mul_2 -->
<g id="edge707" class="edge">
<title>layer21_up_ar&#45;&gt;layer21_mul_2</title>
<path fill="none" stroke="black" d="M596,-113947.18C596,-113947.18 596,-113743.46 596,-113743.46"/>
<polygon fill="black" stroke="black" points="599.5,-113743.46 596,-113733.46 592.5,-113743.46 599.5,-113743.46"/>
</g>
<!-- layer21_mul_3 -->
<g id="node557" class="node">
<title>layer21_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="939,-113733.37 758,-113733.37 758,-113665.37 939,-113665.37 939,-113733.37"/>
<text text-anchor="middle" x="848.5" y="-113718.17" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="848.5" y="-113703.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="848.5" y="-113688.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="848.5" y="-113673.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer21_up_ar&#45;&gt;layer21_mul_3 -->
<g id="edge709" class="edge">
<title>layer21_up_ar&#45;&gt;layer21_mul_3</title>
<path fill="none" stroke="black" d="M668.74,-113969.03C668.74,-113944.08 668.74,-113909 668.74,-113909 668.74,-113909 850,-113909 850,-113909 850,-113909 850,-113743.52 850,-113743.52"/>
<polygon fill="black" stroke="black" points="853.5,-113743.52 850,-113733.52 846.5,-113743.52 853.5,-113743.52"/>
</g>
<!-- layer21_silu_2&#45;&gt;layer21_mul_2 -->
<g id="edge706" class="edge">
<title>layer21_silu_2&#45;&gt;layer21_mul_2</title>
<path fill="none" stroke="black" d="M686.5,-113805.12C686.5,-113805.12 686.5,-113743.75 686.5,-113743.75"/>
<polygon fill="black" stroke="black" points="690,-113743.75 686.5,-113733.75 683,-113743.75 690,-113743.75"/>
</g>
<!-- layer21_silu_3&#45;&gt;layer21_mul_3 -->
<g id="edge708" class="edge">
<title>layer21_silu_3&#45;&gt;layer21_mul_3</title>
<path fill="none" stroke="black" d="M903.5,-113805.12C903.5,-113805.12 903.5,-113743.75 903.5,-113743.75"/>
<polygon fill="black" stroke="black" points="907,-113743.75 903.5,-113733.75 900,-113743.75 907,-113743.75"/>
</g>
<!-- layer21_ffn_down_2 -->
<g id="node558" class="node">
<title>layer21_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="721.5,-113593.37 549.5,-113593.37 549.5,-113525.37 721.5,-113525.37 721.5,-113593.37"/>
<text text-anchor="middle" x="635.5" y="-113578.17" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="635.5" y="-113563.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="635.5" y="-113548.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="635.5" y="-113533.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer21_mul_2&#45;&gt;layer21_ffn_down_2 -->
<g id="edge710" class="edge">
<title>layer21_mul_2&#45;&gt;layer21_ffn_down_2</title>
<path fill="none" stroke="black" d="M635.5,-113665.12C635.5,-113665.12 635.5,-113603.75 635.5,-113603.75"/>
<polygon fill="black" stroke="black" points="639,-113603.75 635.5,-113593.75 632,-113603.75 639,-113603.75"/>
</g>
<!-- layer21_ffn_down_3 -->
<g id="node559" class="node">
<title>layer21_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="931.5,-113593.37 759.5,-113593.37 759.5,-113525.37 931.5,-113525.37 931.5,-113593.37"/>
<text text-anchor="middle" x="845.5" y="-113578.17" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="845.5" y="-113563.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="845.5" y="-113548.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="845.5" y="-113533.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer21_mul_3&#45;&gt;layer21_ffn_down_3 -->
<g id="edge711" class="edge">
<title>layer21_mul_3&#45;&gt;layer21_ffn_down_3</title>
<path fill="none" stroke="black" d="M845.5,-113665.12C845.5,-113665.12 845.5,-113603.75 845.5,-113603.75"/>
<polygon fill="black" stroke="black" points="849,-113603.75 845.5,-113593.75 842,-113603.75 849,-113603.75"/>
</g>
<!-- layer21_ffn_ar -->
<g id="node560" class="node">
<title>layer21_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="739.5" cy="-113405.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="739.5" y="-113424.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="739.5" y="-113409.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="739.5" y="-113394.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="739.5" y="-113379.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer21_ffn_down_2&#45;&gt;layer21_ffn_ar -->
<g id="edge712" class="edge">
<title>layer21_ffn_down_2&#45;&gt;layer21_ffn_ar</title>
<path fill="none" stroke="black" d="M669.69,-113525.18C669.69,-113525.18 669.69,-113454.83 669.69,-113454.83"/>
<polygon fill="black" stroke="black" points="673.19,-113454.83 669.69,-113444.83 666.19,-113454.83 673.19,-113454.83"/>
</g>
<!-- layer21_ffn_down_3&#45;&gt;layer21_ffn_ar -->
<g id="edge713" class="edge">
<title>layer21_ffn_down_3&#45;&gt;layer21_ffn_ar</title>
<path fill="none" stroke="black" d="M810.31,-113525.18C810.31,-113525.18 810.31,-113454.55 810.31,-113454.55"/>
<polygon fill="black" stroke="black" points="813.81,-113454.55 810.31,-113444.55 806.81,-113454.55 813.81,-113454.55"/>
</g>
<!-- layer22_norm_2 -->
<g id="node561" class="node">
<title>layer22_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="721.5,-113285.21 549.5,-113285.21 549.5,-113217.21 721.5,-113217.21 721.5,-113285.21"/>
<text text-anchor="middle" x="635.5" y="-113270.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="635.5" y="-113255.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="635.5" y="-113240.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="635.5" y="-113225.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer21_ffn_ar&#45;&gt;layer22_norm_2 -->
<g id="edge714" class="edge">
<title>layer21_ffn_ar&#45;&gt;layer22_norm_2</title>
<path fill="none" stroke="black" d="M669.69,-113365.61C669.69,-113365.61 669.69,-113295.26 669.69,-113295.26"/>
<polygon fill="black" stroke="black" points="673.19,-113295.26 669.69,-113285.26 666.19,-113295.26 673.19,-113295.26"/>
</g>
<!-- layer22_norm_3 -->
<g id="node562" class="node">
<title>layer22_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="931.5,-113285.21 759.5,-113285.21 759.5,-113217.21 931.5,-113217.21 931.5,-113285.21"/>
<text text-anchor="middle" x="845.5" y="-113270.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="845.5" y="-113255.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="845.5" y="-113240.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="845.5" y="-113225.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer21_ffn_ar&#45;&gt;layer22_norm_3 -->
<g id="edge715" class="edge">
<title>layer21_ffn_ar&#45;&gt;layer22_norm_3</title>
<path fill="none" stroke="black" d="M810.31,-113366.01C810.31,-113366.01 810.31,-113295.44 810.31,-113295.44"/>
<polygon fill="black" stroke="black" points="813.81,-113295.44 810.31,-113285.44 806.81,-113295.44 813.81,-113295.44"/>
</g>
<!-- layer22_qkv_2 -->
<g id="node563" class="node">
<title>layer22_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="722,-113145.21 541,-113145.21 541,-113077.21 722,-113077.21 722,-113145.21"/>
<text text-anchor="middle" x="631.5" y="-113130.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="631.5" y="-113115.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="631.5" y="-113100.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="631.5" y="-113085.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer22_norm_2&#45;&gt;layer22_qkv_2 -->
<g id="edge716" class="edge">
<title>layer22_norm_2&#45;&gt;layer22_qkv_2</title>
<path fill="none" stroke="black" d="M635.5,-113216.96C635.5,-113216.96 635.5,-113155.59 635.5,-113155.59"/>
<polygon fill="black" stroke="black" points="639,-113155.59 635.5,-113145.59 632,-113155.59 639,-113155.59"/>
</g>
<!-- layer22_qkv_3 -->
<g id="node564" class="node">
<title>layer22_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="939,-113145.21 758,-113145.21 758,-113077.21 939,-113077.21 939,-113145.21"/>
<text text-anchor="middle" x="848.5" y="-113130.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="848.5" y="-113115.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="848.5" y="-113100.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="848.5" y="-113085.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer22_norm_3&#45;&gt;layer22_qkv_3 -->
<g id="edge717" class="edge">
<title>layer22_norm_3&#45;&gt;layer22_qkv_3</title>
<path fill="none" stroke="black" d="M845.5,-113216.96C845.5,-113216.96 845.5,-113155.59 845.5,-113155.59"/>
<polygon fill="black" stroke="black" points="849,-113155.59 845.5,-113145.59 842,-113155.59 849,-113155.59"/>
</g>
<!-- layer22_qkv_ar -->
<g id="node565" class="node">
<title>layer22_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="739.5" cy="-112957.12" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="739.5" y="-112975.92" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="739.5" y="-112960.92" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="739.5" y="-112945.92" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="739.5" y="-112930.92" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer22_qkv_2&#45;&gt;layer22_qkv_ar -->
<g id="edge718" class="edge">
<title>layer22_qkv_2&#45;&gt;layer22_qkv_ar</title>
<path fill="none" stroke="black" d="M666.76,-113077.01C666.76,-113077.01 666.76,-113006.94 666.76,-113006.94"/>
<polygon fill="black" stroke="black" points="670.26,-113006.94 666.76,-112996.94 663.26,-113006.94 670.26,-113006.94"/>
</g>
<!-- layer22_qkv_3&#45;&gt;layer22_qkv_ar -->
<g id="edge719" class="edge">
<title>layer22_qkv_3&#45;&gt;layer22_qkv_ar</title>
<path fill="none" stroke="black" d="M812.74,-113077.01C812.74,-113077.01 812.74,-113006.67 812.74,-113006.67"/>
<polygon fill="black" stroke="black" points="816.24,-113006.67 812.74,-112996.67 809.24,-113006.67 816.24,-113006.67"/>
</g>
<!-- layer22_attn_2 -->
<g id="node566" class="node">
<title>layer22_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="721.5,-112837.04 549.5,-112837.04 549.5,-112769.04 721.5,-112769.04 721.5,-112837.04"/>
<text text-anchor="middle" x="635.5" y="-112821.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="635.5" y="-112806.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="635.5" y="-112791.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="635.5" y="-112776.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer22_qkv_ar&#45;&gt;layer22_attn_2 -->
<g id="edge720" class="edge">
<title>layer22_qkv_ar&#45;&gt;layer22_attn_2</title>
<path fill="none" stroke="black" d="M666.51,-112917.44C666.51,-112917.44 666.51,-112847.1 666.51,-112847.1"/>
<polygon fill="black" stroke="black" points="670.01,-112847.1 666.51,-112837.1 663.01,-112847.1 670.01,-112847.1"/>
</g>
<!-- layer22_attn_3 -->
<g id="node567" class="node">
<title>layer22_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="929.5,-112837.04 757.5,-112837.04 757.5,-112769.04 929.5,-112769.04 929.5,-112837.04"/>
<text text-anchor="middle" x="843.5" y="-112821.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="843.5" y="-112806.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="843.5" y="-112791.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="843.5" y="-112776.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer22_qkv_ar&#45;&gt;layer22_attn_3 -->
<g id="edge721" class="edge">
<title>layer22_qkv_ar&#45;&gt;layer22_attn_3</title>
<path fill="none" stroke="black" d="M812.49,-112917.44C812.49,-112917.44 812.49,-112847.1 812.49,-112847.1"/>
<polygon fill="black" stroke="black" points="815.99,-112847.1 812.49,-112837.1 808.99,-112847.1 815.99,-112847.1"/>
</g>
<!-- layer22_attn_out_2 -->
<g id="node568" class="node">
<title>layer22_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="721.5,-112697.04 549.5,-112697.04 549.5,-112629.04 721.5,-112629.04 721.5,-112697.04"/>
<text text-anchor="middle" x="635.5" y="-112681.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="635.5" y="-112666.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="635.5" y="-112651.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="635.5" y="-112636.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer22_attn_2&#45;&gt;layer22_attn_out_2 -->
<g id="edge722" class="edge">
<title>layer22_attn_2&#45;&gt;layer22_attn_out_2</title>
<path fill="none" stroke="black" d="M635.5,-112768.79C635.5,-112768.79 635.5,-112707.42 635.5,-112707.42"/>
<polygon fill="black" stroke="black" points="639,-112707.42 635.5,-112697.42 632,-112707.42 639,-112707.42"/>
</g>
<!-- layer22_attn_out_3 -->
<g id="node569" class="node">
<title>layer22_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="929.5,-112697.04 757.5,-112697.04 757.5,-112629.04 929.5,-112629.04 929.5,-112697.04"/>
<text text-anchor="middle" x="843.5" y="-112681.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="843.5" y="-112666.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="843.5" y="-112651.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="843.5" y="-112636.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer22_attn_3&#45;&gt;layer22_attn_out_3 -->
<g id="edge723" class="edge">
<title>layer22_attn_3&#45;&gt;layer22_attn_out_3</title>
<path fill="none" stroke="black" d="M843.5,-112768.79C843.5,-112768.79 843.5,-112707.42 843.5,-112707.42"/>
<polygon fill="black" stroke="black" points="847,-112707.42 843.5,-112697.42 840,-112707.42 847,-112707.42"/>
</g>
<!-- layer22_attn_ar -->
<g id="node570" class="node">
<title>layer22_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="739.5" cy="-112508.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="739.5" y="-112527.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="739.5" y="-112512.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="739.5" y="-112497.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="739.5" y="-112482.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer22_attn_out_2&#45;&gt;layer22_attn_ar -->
<g id="edge724" class="edge">
<title>layer22_attn_out_2&#45;&gt;layer22_attn_ar</title>
<path fill="none" stroke="black" d="M669.69,-112628.84C669.69,-112628.84 669.69,-112558.5 669.69,-112558.5"/>
<polygon fill="black" stroke="black" points="673.19,-112558.5 669.69,-112548.5 666.19,-112558.5 673.19,-112558.5"/>
</g>
<!-- layer22_attn_out_3&#45;&gt;layer22_attn_ar -->
<g id="edge725" class="edge">
<title>layer22_attn_out_3&#45;&gt;layer22_attn_ar</title>
<path fill="none" stroke="black" d="M809.31,-112628.84C809.31,-112628.84 809.31,-112558.5 809.31,-112558.5"/>
<polygon fill="black" stroke="black" points="812.81,-112558.5 809.31,-112548.5 805.81,-112558.5 812.81,-112558.5"/>
</g>
<!-- layer22_ffn_norm_2 -->
<g id="node571" class="node">
<title>layer22_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="717.5,-112388.87 545.5,-112388.87 545.5,-112320.87 717.5,-112320.87 717.5,-112388.87"/>
<text text-anchor="middle" x="631.5" y="-112373.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="631.5" y="-112358.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="631.5" y="-112343.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="631.5" y="-112328.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer22_attn_ar&#45;&gt;layer22_ffn_norm_2 -->
<g id="edge726" class="edge">
<title>layer22_attn_ar&#45;&gt;layer22_ffn_norm_2</title>
<path fill="none" stroke="black" d="M667.69,-112470.07C667.69,-112470.07 667.69,-112399.02 667.69,-112399.02"/>
<polygon fill="black" stroke="black" points="671.19,-112399.02 667.69,-112389.02 664.19,-112399.02 671.19,-112399.02"/>
</g>
<!-- layer22_ffn_norm_3 -->
<g id="node572" class="node">
<title>layer22_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="934.5,-112388.87 762.5,-112388.87 762.5,-112320.87 934.5,-112320.87 934.5,-112388.87"/>
<text text-anchor="middle" x="848.5" y="-112373.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="848.5" y="-112358.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="848.5" y="-112343.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="848.5" y="-112328.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer22_attn_ar&#45;&gt;layer22_ffn_norm_3 -->
<g id="edge727" class="edge">
<title>layer22_attn_ar&#45;&gt;layer22_ffn_norm_3</title>
<path fill="none" stroke="black" d="M811.81,-112470.07C811.81,-112470.07 811.81,-112399.02 811.81,-112399.02"/>
<polygon fill="black" stroke="black" points="815.31,-112399.02 811.81,-112389.02 808.31,-112399.02 815.31,-112399.02"/>
</g>
<!-- layer22_ffn_gate_2 -->
<g id="node573" class="node">
<title>layer22_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="722,-112248.87 541,-112248.87 541,-112180.87 722,-112180.87 722,-112248.87"/>
<text text-anchor="middle" x="631.5" y="-112233.67" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="631.5" y="-112218.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="631.5" y="-112203.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="631.5" y="-112188.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_ffn_norm_2&#45;&gt;layer22_ffn_gate_2 -->
<g id="edge728" class="edge">
<title>layer22_ffn_norm_2&#45;&gt;layer22_ffn_gate_2</title>
<path fill="none" stroke="black" d="M631.5,-112320.62C631.5,-112320.62 631.5,-112259.25 631.5,-112259.25"/>
<polygon fill="black" stroke="black" points="635,-112259.25 631.5,-112249.25 628,-112259.25 635,-112259.25"/>
</g>
<!-- layer22_ffn_up_2 -->
<g id="node575" class="node">
<title>layer22_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="505,-112248.87 324,-112248.87 324,-112180.87 505,-112180.87 505,-112248.87"/>
<text text-anchor="middle" x="414.5" y="-112233.67" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="414.5" y="-112218.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="414.5" y="-112203.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="414.5" y="-112188.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_ffn_norm_2&#45;&gt;layer22_ffn_up_2 -->
<g id="edge730" class="edge">
<title>layer22_ffn_norm_2&#45;&gt;layer22_ffn_up_2</title>
<path fill="none" stroke="black" d="M545.31,-112354C505.86,-112354 467.76,-112354 467.76,-112354 467.76,-112354 467.76,-112258.91 467.76,-112258.91"/>
<polygon fill="black" stroke="black" points="471.26,-112258.91 467.76,-112248.91 464.26,-112258.91 471.26,-112258.91"/>
</g>
<!-- layer22_ffn_gate_3 -->
<g id="node574" class="node">
<title>layer22_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1156,-112248.87 975,-112248.87 975,-112180.87 1156,-112180.87 1156,-112248.87"/>
<text text-anchor="middle" x="1065.5" y="-112233.67" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1065.5" y="-112218.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1065.5" y="-112203.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1065.5" y="-112188.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_ffn_norm_3&#45;&gt;layer22_ffn_gate_3 -->
<g id="edge729" class="edge">
<title>layer22_ffn_norm_3&#45;&gt;layer22_ffn_gate_3</title>
<path fill="none" stroke="black" d="M934.56,-112354C973.95,-112354 1012,-112354 1012,-112354 1012,-112354 1012,-112258.91 1012,-112258.91"/>
<polygon fill="black" stroke="black" points="1015.5,-112258.91 1012,-112248.91 1008.5,-112258.91 1015.5,-112258.91"/>
</g>
<!-- layer22_ffn_up_3 -->
<g id="node576" class="node">
<title>layer22_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="939,-112248.87 758,-112248.87 758,-112180.87 939,-112180.87 939,-112248.87"/>
<text text-anchor="middle" x="848.5" y="-112233.67" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="848.5" y="-112218.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="848.5" y="-112203.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="848.5" y="-112188.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_ffn_norm_3&#45;&gt;layer22_ffn_up_3 -->
<g id="edge731" class="edge">
<title>layer22_ffn_norm_3&#45;&gt;layer22_ffn_up_3</title>
<path fill="none" stroke="black" d="M848.5,-112320.62C848.5,-112320.62 848.5,-112259.25 848.5,-112259.25"/>
<polygon fill="black" stroke="black" points="852,-112259.25 848.5,-112249.25 845,-112259.25 852,-112259.25"/>
</g>
<!-- layer22_gate_ar -->
<g id="node577" class="node">
<title>layer22_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="939.5" cy="-112060.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="939.5" y="-112079.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="939.5" y="-112064.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="939.5" y="-112049.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="939.5" y="-112034.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer22_ffn_gate_2&#45;&gt;layer22_gate_ar -->
<g id="edge732" class="edge">
<title>layer22_ffn_gate_2&#45;&gt;layer22_gate_ar</title>
<path fill="none" stroke="black" d="M722.08,-112214C732.79,-112214 740,-112214 740,-112214 740,-112214 740,-112076 740,-112076 740,-112076 807.99,-112076 807.99,-112076"/>
<polygon fill="black" stroke="black" points="807.99,-112079.5 817.99,-112076 807.99,-112072.5 807.99,-112079.5"/>
</g>
<!-- layer22_ffn_gate_3&#45;&gt;layer22_gate_ar -->
<g id="edge733" class="edge">
<title>layer22_ffn_gate_3&#45;&gt;layer22_gate_ar</title>
<path fill="none" stroke="black" d="M1021.24,-112180.68C1021.24,-112180.68 1021.24,-112107.85 1021.24,-112107.85"/>
<polygon fill="black" stroke="black" points="1024.74,-112107.85 1021.24,-112097.85 1017.74,-112107.85 1024.74,-112107.85"/>
</g>
<!-- layer22_up_ar -->
<g id="node578" class="node">
<title>layer22_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="593.5" cy="-112060.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="593.5" y="-112079.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="593.5" y="-112064.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="593.5" y="-112049.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="593.5" y="-112034.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer22_ffn_up_2&#45;&gt;layer22_up_ar -->
<g id="edge734" class="edge">
<title>layer22_ffn_up_2&#45;&gt;layer22_up_ar</title>
<path fill="none" stroke="black" d="M485.26,-112180.68C485.26,-112180.68 485.26,-112096.75 485.26,-112096.75"/>
<polygon fill="black" stroke="black" points="488.76,-112096.75 485.26,-112086.75 481.76,-112096.75 488.76,-112096.75"/>
</g>
<!-- layer22_ffn_up_3&#45;&gt;layer22_up_ar -->
<g id="edge735" class="edge">
<title>layer22_ffn_up_3&#45;&gt;layer22_up_ar</title>
<path fill="none" stroke="black" d="M784.76,-112180.7C784.76,-112130.84 784.76,-112044 784.76,-112044 784.76,-112044 723.54,-112044 723.54,-112044"/>
<polygon fill="black" stroke="black" points="723.54,-112040.5 713.54,-112044 723.54,-112047.5 723.54,-112040.5"/>
</g>
<!-- layer22_silu_2 -->
<g id="node579" class="node">
<title>layer22_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="867,-111940.71 686,-111940.71 686,-111872.71 867,-111872.71 867,-111940.71"/>
<text text-anchor="middle" x="776.5" y="-111925.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="776.5" y="-111910.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="776.5" y="-111895.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="776.5" y="-111880.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_gate_ar&#45;&gt;layer22_silu_2 -->
<g id="edge736" class="edge">
<title>layer22_gate_ar&#45;&gt;layer22_silu_2</title>
<path fill="none" stroke="black" d="M839.26,-112030.71C839.26,-112030.71 839.26,-111950.73 839.26,-111950.73"/>
<polygon fill="black" stroke="black" points="842.76,-111950.73 839.26,-111940.73 835.76,-111950.73 842.76,-111950.73"/>
</g>
<!-- layer22_silu_3 -->
<g id="node580" class="node">
<title>layer22_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1084,-111940.71 903,-111940.71 903,-111872.71 1084,-111872.71 1084,-111940.71"/>
<text text-anchor="middle" x="993.5" y="-111925.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="993.5" y="-111910.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="993.5" y="-111895.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="993.5" y="-111880.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_gate_ar&#45;&gt;layer22_silu_3 -->
<g id="edge737" class="edge">
<title>layer22_gate_ar&#45;&gt;layer22_silu_3</title>
<path fill="none" stroke="black" d="M985.24,-112015.81C985.24,-112015.81 985.24,-111950.71 985.24,-111950.71"/>
<polygon fill="black" stroke="black" points="988.74,-111950.71 985.24,-111940.71 981.74,-111950.71 988.74,-111950.71"/>
</g>
<!-- layer22_mul_2 -->
<g id="node581" class="node">
<title>layer22_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="757,-111800.71 576,-111800.71 576,-111732.71 757,-111732.71 757,-111800.71"/>
<text text-anchor="middle" x="666.5" y="-111785.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="666.5" y="-111770.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="666.5" y="-111755.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="666.5" y="-111740.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_up_ar&#45;&gt;layer22_mul_2 -->
<g id="edge739" class="edge">
<title>layer22_up_ar&#45;&gt;layer22_mul_2</title>
<path fill="none" stroke="black" d="M631,-112014.52C631,-112014.52 631,-111810.79 631,-111810.79"/>
<polygon fill="black" stroke="black" points="634.5,-111810.79 631,-111800.79 627.5,-111810.79 634.5,-111810.79"/>
</g>
<!-- layer22_mul_3 -->
<g id="node582" class="node">
<title>layer22_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="974,-111800.71 793,-111800.71 793,-111732.71 974,-111732.71 974,-111800.71"/>
<text text-anchor="middle" x="883.5" y="-111785.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="883.5" y="-111770.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="883.5" y="-111755.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="883.5" y="-111740.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer22_up_ar&#45;&gt;layer22_mul_3 -->
<g id="edge741" class="edge">
<title>layer22_up_ar&#45;&gt;layer22_mul_3</title>
<path fill="none" stroke="black" d="M703.74,-112036.26C703.74,-112011.22 703.74,-111976 703.74,-111976 703.74,-111976 885,-111976 885,-111976 885,-111976 885,-111810.8 885,-111810.8"/>
<polygon fill="black" stroke="black" points="888.5,-111810.8 885,-111800.8 881.5,-111810.8 888.5,-111810.8"/>
</g>
<!-- layer22_silu_2&#45;&gt;layer22_mul_2 -->
<g id="edge738" class="edge">
<title>layer22_silu_2&#45;&gt;layer22_mul_2</title>
<path fill="none" stroke="black" d="M721.5,-111872.46C721.5,-111872.46 721.5,-111811.09 721.5,-111811.09"/>
<polygon fill="black" stroke="black" points="725,-111811.09 721.5,-111801.09 718,-111811.09 725,-111811.09"/>
</g>
<!-- layer22_silu_3&#45;&gt;layer22_mul_3 -->
<g id="edge740" class="edge">
<title>layer22_silu_3&#45;&gt;layer22_mul_3</title>
<path fill="none" stroke="black" d="M938.5,-111872.46C938.5,-111872.46 938.5,-111811.09 938.5,-111811.09"/>
<polygon fill="black" stroke="black" points="942,-111811.09 938.5,-111801.09 935,-111811.09 942,-111811.09"/>
</g>
<!-- layer22_ffn_down_2 -->
<g id="node583" class="node">
<title>layer22_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="756.5,-111660.71 584.5,-111660.71 584.5,-111592.71 756.5,-111592.71 756.5,-111660.71"/>
<text text-anchor="middle" x="670.5" y="-111645.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="670.5" y="-111630.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="670.5" y="-111615.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="670.5" y="-111600.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer22_mul_2&#45;&gt;layer22_ffn_down_2 -->
<g id="edge742" class="edge">
<title>layer22_mul_2&#45;&gt;layer22_ffn_down_2</title>
<path fill="none" stroke="black" d="M670.5,-111732.46C670.5,-111732.46 670.5,-111671.09 670.5,-111671.09"/>
<polygon fill="black" stroke="black" points="674,-111671.09 670.5,-111661.09 667,-111671.09 674,-111671.09"/>
</g>
<!-- layer22_ffn_down_3 -->
<g id="node584" class="node">
<title>layer22_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="966.5,-111660.71 794.5,-111660.71 794.5,-111592.71 966.5,-111592.71 966.5,-111660.71"/>
<text text-anchor="middle" x="880.5" y="-111645.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="880.5" y="-111630.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="880.5" y="-111615.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="880.5" y="-111600.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer22_mul_3&#45;&gt;layer22_ffn_down_3 -->
<g id="edge743" class="edge">
<title>layer22_mul_3&#45;&gt;layer22_ffn_down_3</title>
<path fill="none" stroke="black" d="M880.5,-111732.46C880.5,-111732.46 880.5,-111671.09 880.5,-111671.09"/>
<polygon fill="black" stroke="black" points="884,-111671.09 880.5,-111661.09 877,-111671.09 884,-111671.09"/>
</g>
<!-- layer22_ffn_ar -->
<g id="node585" class="node">
<title>layer22_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="774.5" cy="-111472.62" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="774.5" y="-111491.42" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="774.5" y="-111476.42" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="774.5" y="-111461.42" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="774.5" y="-111446.42" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer22_ffn_down_2&#45;&gt;layer22_ffn_ar -->
<g id="edge744" class="edge">
<title>layer22_ffn_down_2&#45;&gt;layer22_ffn_ar</title>
<path fill="none" stroke="black" d="M704.69,-111592.51C704.69,-111592.51 704.69,-111522.17 704.69,-111522.17"/>
<polygon fill="black" stroke="black" points="708.19,-111522.17 704.69,-111512.17 701.19,-111522.17 708.19,-111522.17"/>
</g>
<!-- layer22_ffn_down_3&#45;&gt;layer22_ffn_ar -->
<g id="edge745" class="edge">
<title>layer22_ffn_down_3&#45;&gt;layer22_ffn_ar</title>
<path fill="none" stroke="black" d="M845.31,-111592.51C845.31,-111592.51 845.31,-111521.89 845.31,-111521.89"/>
<polygon fill="black" stroke="black" points="848.81,-111521.89 845.31,-111511.89 841.81,-111521.89 848.81,-111521.89"/>
</g>
<!-- layer23_norm_2 -->
<g id="node586" class="node">
<title>layer23_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="756.5,-111352.54 584.5,-111352.54 584.5,-111284.54 756.5,-111284.54 756.5,-111352.54"/>
<text text-anchor="middle" x="670.5" y="-111337.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="670.5" y="-111322.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="670.5" y="-111307.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="670.5" y="-111292.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer22_ffn_ar&#45;&gt;layer23_norm_2 -->
<g id="edge746" class="edge">
<title>layer22_ffn_ar&#45;&gt;layer23_norm_2</title>
<path fill="none" stroke="black" d="M704.69,-111432.94C704.69,-111432.94 704.69,-111362.6 704.69,-111362.6"/>
<polygon fill="black" stroke="black" points="708.19,-111362.6 704.69,-111352.6 701.19,-111362.6 708.19,-111362.6"/>
</g>
<!-- layer23_norm_3 -->
<g id="node587" class="node">
<title>layer23_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="966.5,-111352.54 794.5,-111352.54 794.5,-111284.54 966.5,-111284.54 966.5,-111352.54"/>
<text text-anchor="middle" x="880.5" y="-111337.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="880.5" y="-111322.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="880.5" y="-111307.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="880.5" y="-111292.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer22_ffn_ar&#45;&gt;layer23_norm_3 -->
<g id="edge747" class="edge">
<title>layer22_ffn_ar&#45;&gt;layer23_norm_3</title>
<path fill="none" stroke="black" d="M845.31,-111433.34C845.31,-111433.34 845.31,-111362.77 845.31,-111362.77"/>
<polygon fill="black" stroke="black" points="848.81,-111362.77 845.31,-111352.77 841.81,-111362.77 848.81,-111362.77"/>
</g>
<!-- layer23_qkv_2 -->
<g id="node588" class="node">
<title>layer23_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="757,-111212.54 576,-111212.54 576,-111144.54 757,-111144.54 757,-111212.54"/>
<text text-anchor="middle" x="666.5" y="-111197.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="666.5" y="-111182.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="666.5" y="-111167.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="666.5" y="-111152.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer23_norm_2&#45;&gt;layer23_qkv_2 -->
<g id="edge748" class="edge">
<title>layer23_norm_2&#45;&gt;layer23_qkv_2</title>
<path fill="none" stroke="black" d="M670.5,-111284.29C670.5,-111284.29 670.5,-111222.92 670.5,-111222.92"/>
<polygon fill="black" stroke="black" points="674,-111222.92 670.5,-111212.92 667,-111222.92 674,-111222.92"/>
</g>
<!-- layer23_qkv_3 -->
<g id="node589" class="node">
<title>layer23_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="974,-111212.54 793,-111212.54 793,-111144.54 974,-111144.54 974,-111212.54"/>
<text text-anchor="middle" x="883.5" y="-111197.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="883.5" y="-111182.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="883.5" y="-111167.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="883.5" y="-111152.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer23_norm_3&#45;&gt;layer23_qkv_3 -->
<g id="edge749" class="edge">
<title>layer23_norm_3&#45;&gt;layer23_qkv_3</title>
<path fill="none" stroke="black" d="M880.5,-111284.29C880.5,-111284.29 880.5,-111222.92 880.5,-111222.92"/>
<polygon fill="black" stroke="black" points="884,-111222.92 880.5,-111212.92 877,-111222.92 884,-111222.92"/>
</g>
<!-- layer23_qkv_ar -->
<g id="node590" class="node">
<title>layer23_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="774.5" cy="-111024.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="774.5" y="-111043.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="774.5" y="-111028.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="774.5" y="-111013.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="774.5" y="-110998.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer23_qkv_2&#45;&gt;layer23_qkv_ar -->
<g id="edge750" class="edge">
<title>layer23_qkv_2&#45;&gt;layer23_qkv_ar</title>
<path fill="none" stroke="black" d="M701.76,-111144.34C701.76,-111144.34 701.76,-111074.28 701.76,-111074.28"/>
<polygon fill="black" stroke="black" points="705.26,-111074.28 701.76,-111064.28 698.26,-111074.28 705.26,-111074.28"/>
</g>
<!-- layer23_qkv_3&#45;&gt;layer23_qkv_ar -->
<g id="edge751" class="edge">
<title>layer23_qkv_3&#45;&gt;layer23_qkv_ar</title>
<path fill="none" stroke="black" d="M847.74,-111144.34C847.74,-111144.34 847.74,-111074 847.74,-111074"/>
<polygon fill="black" stroke="black" points="851.24,-111074 847.74,-111064 844.24,-111074 851.24,-111074"/>
</g>
<!-- layer23_attn_2 -->
<g id="node591" class="node">
<title>layer23_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="756.5,-110904.37 584.5,-110904.37 584.5,-110836.37 756.5,-110836.37 756.5,-110904.37"/>
<text text-anchor="middle" x="670.5" y="-110889.17" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="670.5" y="-110874.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="670.5" y="-110859.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="670.5" y="-110844.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer23_qkv_ar&#45;&gt;layer23_attn_2 -->
<g id="edge752" class="edge">
<title>layer23_qkv_ar&#45;&gt;layer23_attn_2</title>
<path fill="none" stroke="black" d="M701.51,-110984.78C701.51,-110984.78 701.51,-110914.43 701.51,-110914.43"/>
<polygon fill="black" stroke="black" points="705.01,-110914.43 701.51,-110904.43 698.01,-110914.43 705.01,-110914.43"/>
</g>
<!-- layer23_attn_3 -->
<g id="node592" class="node">
<title>layer23_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="964.5,-110904.37 792.5,-110904.37 792.5,-110836.37 964.5,-110836.37 964.5,-110904.37"/>
<text text-anchor="middle" x="878.5" y="-110889.17" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="878.5" y="-110874.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="878.5" y="-110859.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="878.5" y="-110844.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer23_qkv_ar&#45;&gt;layer23_attn_3 -->
<g id="edge753" class="edge">
<title>layer23_qkv_ar&#45;&gt;layer23_attn_3</title>
<path fill="none" stroke="black" d="M847.49,-110984.78C847.49,-110984.78 847.49,-110914.43 847.49,-110914.43"/>
<polygon fill="black" stroke="black" points="850.99,-110914.43 847.49,-110904.43 843.99,-110914.43 850.99,-110914.43"/>
</g>
<!-- layer23_attn_out_2 -->
<g id="node593" class="node">
<title>layer23_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="756.5,-110764.37 584.5,-110764.37 584.5,-110696.37 756.5,-110696.37 756.5,-110764.37"/>
<text text-anchor="middle" x="670.5" y="-110749.17" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="670.5" y="-110734.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="670.5" y="-110719.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="670.5" y="-110704.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer23_attn_2&#45;&gt;layer23_attn_out_2 -->
<g id="edge754" class="edge">
<title>layer23_attn_2&#45;&gt;layer23_attn_out_2</title>
<path fill="none" stroke="black" d="M670.5,-110836.13C670.5,-110836.13 670.5,-110774.75 670.5,-110774.75"/>
<polygon fill="black" stroke="black" points="674,-110774.75 670.5,-110764.75 667,-110774.75 674,-110774.75"/>
</g>
<!-- layer23_attn_out_3 -->
<g id="node594" class="node">
<title>layer23_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="964.5,-110764.37 792.5,-110764.37 792.5,-110696.37 964.5,-110696.37 964.5,-110764.37"/>
<text text-anchor="middle" x="878.5" y="-110749.17" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="878.5" y="-110734.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="878.5" y="-110719.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="878.5" y="-110704.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer23_attn_3&#45;&gt;layer23_attn_out_3 -->
<g id="edge755" class="edge">
<title>layer23_attn_3&#45;&gt;layer23_attn_out_3</title>
<path fill="none" stroke="black" d="M878.5,-110836.13C878.5,-110836.13 878.5,-110774.75 878.5,-110774.75"/>
<polygon fill="black" stroke="black" points="882,-110774.75 878.5,-110764.75 875,-110774.75 882,-110774.75"/>
</g>
<!-- layer23_attn_ar -->
<g id="node595" class="node">
<title>layer23_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="774.5" cy="-110576.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="774.5" y="-110595.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="774.5" y="-110580.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="774.5" y="-110565.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="774.5" y="-110550.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer23_attn_out_2&#45;&gt;layer23_attn_ar -->
<g id="edge756" class="edge">
<title>layer23_attn_out_2&#45;&gt;layer23_attn_ar</title>
<path fill="none" stroke="black" d="M704.69,-110696.18C704.69,-110696.18 704.69,-110625.83 704.69,-110625.83"/>
<polygon fill="black" stroke="black" points="708.19,-110625.83 704.69,-110615.83 701.19,-110625.83 708.19,-110625.83"/>
</g>
<!-- layer23_attn_out_3&#45;&gt;layer23_attn_ar -->
<g id="edge757" class="edge">
<title>layer23_attn_out_3&#45;&gt;layer23_attn_ar</title>
<path fill="none" stroke="black" d="M844.31,-110696.18C844.31,-110696.18 844.31,-110625.83 844.31,-110625.83"/>
<polygon fill="black" stroke="black" points="847.81,-110625.83 844.31,-110615.83 840.81,-110625.83 847.81,-110625.83"/>
</g>
<!-- layer23_ffn_norm_2 -->
<g id="node596" class="node">
<title>layer23_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="752.5,-110456.21 580.5,-110456.21 580.5,-110388.21 752.5,-110388.21 752.5,-110456.21"/>
<text text-anchor="middle" x="666.5" y="-110441.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="666.5" y="-110426.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="666.5" y="-110411.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="666.5" y="-110396.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer23_attn_ar&#45;&gt;layer23_ffn_norm_2 -->
<g id="edge758" class="edge">
<title>layer23_attn_ar&#45;&gt;layer23_ffn_norm_2</title>
<path fill="none" stroke="black" d="M702.69,-110537.41C702.69,-110537.41 702.69,-110466.36 702.69,-110466.36"/>
<polygon fill="black" stroke="black" points="706.19,-110466.35 702.69,-110456.36 699.19,-110466.36 706.19,-110466.35"/>
</g>
<!-- layer23_ffn_norm_3 -->
<g id="node597" class="node">
<title>layer23_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="969.5,-110456.21 797.5,-110456.21 797.5,-110388.21 969.5,-110388.21 969.5,-110456.21"/>
<text text-anchor="middle" x="883.5" y="-110441.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="883.5" y="-110426.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="883.5" y="-110411.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="883.5" y="-110396.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer23_attn_ar&#45;&gt;layer23_ffn_norm_3 -->
<g id="edge759" class="edge">
<title>layer23_attn_ar&#45;&gt;layer23_ffn_norm_3</title>
<path fill="none" stroke="black" d="M846.81,-110537.41C846.81,-110537.41 846.81,-110466.36 846.81,-110466.36"/>
<polygon fill="black" stroke="black" points="850.31,-110466.35 846.81,-110456.36 843.31,-110466.36 850.31,-110466.35"/>
</g>
<!-- layer23_ffn_gate_2 -->
<g id="node598" class="node">
<title>layer23_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="757,-110316.21 576,-110316.21 576,-110248.21 757,-110248.21 757,-110316.21"/>
<text text-anchor="middle" x="666.5" y="-110301.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="666.5" y="-110286.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="666.5" y="-110271.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="666.5" y="-110256.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_ffn_norm_2&#45;&gt;layer23_ffn_gate_2 -->
<g id="edge760" class="edge">
<title>layer23_ffn_norm_2&#45;&gt;layer23_ffn_gate_2</title>
<path fill="none" stroke="black" d="M666.5,-110387.96C666.5,-110387.96 666.5,-110326.59 666.5,-110326.59"/>
<polygon fill="black" stroke="black" points="670,-110326.59 666.5,-110316.59 663,-110326.59 670,-110326.59"/>
</g>
<!-- layer23_ffn_up_2 -->
<g id="node600" class="node">
<title>layer23_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="540,-110316.21 359,-110316.21 359,-110248.21 540,-110248.21 540,-110316.21"/>
<text text-anchor="middle" x="449.5" y="-110301.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="449.5" y="-110286.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="449.5" y="-110271.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="449.5" y="-110256.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_ffn_norm_2&#45;&gt;layer23_ffn_up_2 -->
<g id="edge762" class="edge">
<title>layer23_ffn_norm_2&#45;&gt;layer23_ffn_up_2</title>
<path fill="none" stroke="black" d="M580.31,-110422C540.86,-110422 502.76,-110422 502.76,-110422 502.76,-110422 502.76,-110326.4 502.76,-110326.4"/>
<polygon fill="black" stroke="black" points="506.26,-110326.4 502.76,-110316.4 499.26,-110326.4 506.26,-110326.4"/>
</g>
<!-- layer23_ffn_gate_3 -->
<g id="node599" class="node">
<title>layer23_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1191,-110316.21 1010,-110316.21 1010,-110248.21 1191,-110248.21 1191,-110316.21"/>
<text text-anchor="middle" x="1100.5" y="-110301.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1100.5" y="-110286.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1100.5" y="-110271.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1100.5" y="-110256.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_ffn_norm_3&#45;&gt;layer23_ffn_gate_3 -->
<g id="edge761" class="edge">
<title>layer23_ffn_norm_3&#45;&gt;layer23_ffn_gate_3</title>
<path fill="none" stroke="black" d="M969.56,-110422C1008.95,-110422 1047,-110422 1047,-110422 1047,-110422 1047,-110326.4 1047,-110326.4"/>
<polygon fill="black" stroke="black" points="1050.5,-110326.4 1047,-110316.4 1043.5,-110326.4 1050.5,-110326.4"/>
</g>
<!-- layer23_ffn_up_3 -->
<g id="node601" class="node">
<title>layer23_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="974,-110316.21 793,-110316.21 793,-110248.21 974,-110248.21 974,-110316.21"/>
<text text-anchor="middle" x="883.5" y="-110301.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="883.5" y="-110286.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="883.5" y="-110271.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="883.5" y="-110256.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_ffn_norm_3&#45;&gt;layer23_ffn_up_3 -->
<g id="edge763" class="edge">
<title>layer23_ffn_norm_3&#45;&gt;layer23_ffn_up_3</title>
<path fill="none" stroke="black" d="M883.5,-110387.96C883.5,-110387.96 883.5,-110326.59 883.5,-110326.59"/>
<polygon fill="black" stroke="black" points="887,-110326.59 883.5,-110316.59 880,-110326.59 887,-110326.59"/>
</g>
<!-- layer23_gate_ar -->
<g id="node602" class="node">
<title>layer23_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="974.5" cy="-110128.12" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="974.5" y="-110146.92" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="974.5" y="-110131.92" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="974.5" y="-110116.92" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="974.5" y="-110101.92" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer23_ffn_gate_2&#45;&gt;layer23_gate_ar -->
<g id="edge764" class="edge">
<title>layer23_ffn_gate_2&#45;&gt;layer23_gate_ar</title>
<path fill="none" stroke="black" d="M757.08,-110282C767.79,-110282 775,-110282 775,-110282 775,-110282 775,-110144 775,-110144 775,-110144 843.56,-110144 843.56,-110144"/>
<polygon fill="black" stroke="black" points="843.56,-110147.5 853.56,-110144 843.56,-110140.5 843.56,-110147.5"/>
</g>
<!-- layer23_ffn_gate_3&#45;&gt;layer23_gate_ar -->
<g id="edge765" class="edge">
<title>layer23_ffn_gate_3&#45;&gt;layer23_gate_ar</title>
<path fill="none" stroke="black" d="M1056.24,-110248.01C1056.24,-110248.01 1056.24,-110175.19 1056.24,-110175.19"/>
<polygon fill="black" stroke="black" points="1059.74,-110175.19 1056.24,-110165.19 1052.74,-110175.19 1059.74,-110175.19"/>
</g>
<!-- layer23_up_ar -->
<g id="node603" class="node">
<title>layer23_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="628.5" cy="-110128.12" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="628.5" y="-110146.92" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="628.5" y="-110131.92" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="628.5" y="-110116.92" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="628.5" y="-110101.92" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer23_ffn_up_2&#45;&gt;layer23_up_ar -->
<g id="edge766" class="edge">
<title>layer23_ffn_up_2&#45;&gt;layer23_up_ar</title>
<path fill="none" stroke="black" d="M520.26,-110248.01C520.26,-110248.01 520.26,-110164.09 520.26,-110164.09"/>
<polygon fill="black" stroke="black" points="523.76,-110164.09 520.26,-110154.09 516.76,-110164.09 523.76,-110164.09"/>
</g>
<!-- layer23_ffn_up_3&#45;&gt;layer23_up_ar -->
<g id="edge767" class="edge">
<title>layer23_ffn_up_3&#45;&gt;layer23_up_ar</title>
<path fill="none" stroke="black" d="M819.76,-110248.17C819.76,-110198.5 819.76,-110112 819.76,-110112 819.76,-110112 759.08,-110112 759.08,-110112"/>
<polygon fill="black" stroke="black" points="759.08,-110108.5 749.08,-110112 759.08,-110115.5 759.08,-110108.5"/>
</g>
<!-- layer23_silu_2 -->
<g id="node604" class="node">
<title>layer23_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="902,-110008.04 721,-110008.04 721,-109940.04 902,-109940.04 902,-110008.04"/>
<text text-anchor="middle" x="811.5" y="-109992.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="811.5" y="-109977.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="811.5" y="-109962.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="811.5" y="-109947.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_gate_ar&#45;&gt;layer23_silu_2 -->
<g id="edge768" class="edge">
<title>layer23_gate_ar&#45;&gt;layer23_silu_2</title>
<path fill="none" stroke="black" d="M874.26,-110098.05C874.26,-110098.05 874.26,-110018.06 874.26,-110018.06"/>
<polygon fill="black" stroke="black" points="877.76,-110018.06 874.26,-110008.06 870.76,-110018.06 877.76,-110018.06"/>
</g>
<!-- layer23_silu_3 -->
<g id="node605" class="node">
<title>layer23_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1119,-110008.04 938,-110008.04 938,-109940.04 1119,-109940.04 1119,-110008.04"/>
<text text-anchor="middle" x="1028.5" y="-109992.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1028.5" y="-109977.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1028.5" y="-109962.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1028.5" y="-109947.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_gate_ar&#45;&gt;layer23_silu_3 -->
<g id="edge769" class="edge">
<title>layer23_gate_ar&#45;&gt;layer23_silu_3</title>
<path fill="none" stroke="black" d="M1020.24,-110083.14C1020.24,-110083.14 1020.24,-110018.05 1020.24,-110018.05"/>
<polygon fill="black" stroke="black" points="1023.74,-110018.05 1020.24,-110008.05 1016.74,-110018.05 1023.74,-110018.05"/>
</g>
<!-- layer23_mul_2 -->
<g id="node606" class="node">
<title>layer23_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="792,-109868.04 611,-109868.04 611,-109800.04 792,-109800.04 792,-109868.04"/>
<text text-anchor="middle" x="701.5" y="-109852.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="701.5" y="-109837.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="701.5" y="-109822.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="701.5" y="-109807.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_up_ar&#45;&gt;layer23_mul_2 -->
<g id="edge771" class="edge">
<title>layer23_up_ar&#45;&gt;layer23_mul_2</title>
<path fill="none" stroke="black" d="M666,-110081.85C666,-110081.85 666,-109878.13 666,-109878.13"/>
<polygon fill="black" stroke="black" points="669.5,-109878.12 666,-109868.13 662.5,-109878.13 669.5,-109878.12"/>
</g>
<!-- layer23_mul_3 -->
<g id="node607" class="node">
<title>layer23_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1009,-109868.04 828,-109868.04 828,-109800.04 1009,-109800.04 1009,-109868.04"/>
<text text-anchor="middle" x="918.5" y="-109852.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="918.5" y="-109837.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="918.5" y="-109822.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="918.5" y="-109807.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer23_up_ar&#45;&gt;layer23_mul_3 -->
<g id="edge773" class="edge">
<title>layer23_up_ar&#45;&gt;layer23_mul_3</title>
<path fill="none" stroke="black" d="M738.74,-110103.34C738.74,-110078.52 738.74,-110044 738.74,-110044 738.74,-110044 920,-110044 920,-110044 920,-110044 920,-109878.24 920,-109878.24"/>
<polygon fill="black" stroke="black" points="923.5,-109878.24 920,-109868.24 916.5,-109878.24 923.5,-109878.24"/>
</g>
<!-- layer23_silu_2&#45;&gt;layer23_mul_2 -->
<g id="edge770" class="edge">
<title>layer23_silu_2&#45;&gt;layer23_mul_2</title>
<path fill="none" stroke="black" d="M756.5,-109939.79C756.5,-109939.79 756.5,-109878.42 756.5,-109878.42"/>
<polygon fill="black" stroke="black" points="760,-109878.42 756.5,-109868.42 753,-109878.42 760,-109878.42"/>
</g>
<!-- layer23_silu_3&#45;&gt;layer23_mul_3 -->
<g id="edge772" class="edge">
<title>layer23_silu_3&#45;&gt;layer23_mul_3</title>
<path fill="none" stroke="black" d="M973.5,-109939.79C973.5,-109939.79 973.5,-109878.42 973.5,-109878.42"/>
<polygon fill="black" stroke="black" points="977,-109878.42 973.5,-109868.42 970,-109878.42 977,-109878.42"/>
</g>
<!-- layer23_ffn_down_2 -->
<g id="node608" class="node">
<title>layer23_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="791.5,-109728.04 619.5,-109728.04 619.5,-109660.04 791.5,-109660.04 791.5,-109728.04"/>
<text text-anchor="middle" x="705.5" y="-109712.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="705.5" y="-109697.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="705.5" y="-109682.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="705.5" y="-109667.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer23_mul_2&#45;&gt;layer23_ffn_down_2 -->
<g id="edge774" class="edge">
<title>layer23_mul_2&#45;&gt;layer23_ffn_down_2</title>
<path fill="none" stroke="black" d="M705.5,-109799.79C705.5,-109799.79 705.5,-109738.42 705.5,-109738.42"/>
<polygon fill="black" stroke="black" points="709,-109738.42 705.5,-109728.42 702,-109738.42 709,-109738.42"/>
</g>
<!-- layer23_ffn_down_3 -->
<g id="node609" class="node">
<title>layer23_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1002.5,-109728.04 830.5,-109728.04 830.5,-109660.04 1002.5,-109660.04 1002.5,-109728.04"/>
<text text-anchor="middle" x="916.5" y="-109712.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="916.5" y="-109697.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="916.5" y="-109682.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="916.5" y="-109667.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer23_mul_3&#45;&gt;layer23_ffn_down_3 -->
<g id="edge775" class="edge">
<title>layer23_mul_3&#45;&gt;layer23_ffn_down_3</title>
<path fill="none" stroke="black" d="M916.5,-109799.79C916.5,-109799.79 916.5,-109738.42 916.5,-109738.42"/>
<polygon fill="black" stroke="black" points="920,-109738.42 916.5,-109728.42 913,-109738.42 920,-109738.42"/>
</g>
<!-- layer23_ffn_ar -->
<g id="node610" class="node">
<title>layer23_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="810.5" cy="-109539.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="810.5" y="-109558.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="810.5" y="-109543.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="810.5" y="-109528.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="810.5" y="-109513.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer23_ffn_down_2&#45;&gt;layer23_ffn_ar -->
<g id="edge776" class="edge">
<title>layer23_ffn_down_2&#45;&gt;layer23_ffn_ar</title>
<path fill="none" stroke="black" d="M740.19,-109659.84C740.19,-109659.84 740.19,-109589.22 740.19,-109589.22"/>
<polygon fill="black" stroke="black" points="743.69,-109589.22 740.19,-109579.22 736.69,-109589.22 743.69,-109589.22"/>
</g>
<!-- layer23_ffn_down_3&#45;&gt;layer23_ffn_ar -->
<g id="edge777" class="edge">
<title>layer23_ffn_down_3&#45;&gt;layer23_ffn_ar</title>
<path fill="none" stroke="black" d="M881.31,-109659.84C881.31,-109659.84 881.31,-109589.22 881.31,-109589.22"/>
<polygon fill="black" stroke="black" points="884.81,-109589.22 881.31,-109579.22 877.81,-109589.22 884.81,-109589.22"/>
</g>
<!-- layer24_norm_2 -->
<g id="node611" class="node">
<title>layer24_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="792.5,-109419.87 620.5,-109419.87 620.5,-109351.87 792.5,-109351.87 792.5,-109419.87"/>
<text text-anchor="middle" x="706.5" y="-109404.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="706.5" y="-109389.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="706.5" y="-109374.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="706.5" y="-109359.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer23_ffn_ar&#45;&gt;layer24_norm_2 -->
<g id="edge778" class="edge">
<title>layer23_ffn_ar&#45;&gt;layer24_norm_2</title>
<path fill="none" stroke="black" d="M740.69,-109500.28C740.69,-109500.28 740.69,-109429.93 740.69,-109429.93"/>
<polygon fill="black" stroke="black" points="744.19,-109429.93 740.69,-109419.93 737.19,-109429.93 744.19,-109429.93"/>
</g>
<!-- layer24_norm_3 -->
<g id="node612" class="node">
<title>layer24_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1002.5,-109419.87 830.5,-109419.87 830.5,-109351.87 1002.5,-109351.87 1002.5,-109419.87"/>
<text text-anchor="middle" x="916.5" y="-109404.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="916.5" y="-109389.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="916.5" y="-109374.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="916.5" y="-109359.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer23_ffn_ar&#45;&gt;layer24_norm_3 -->
<g id="edge779" class="edge">
<title>layer23_ffn_ar&#45;&gt;layer24_norm_3</title>
<path fill="none" stroke="black" d="M881.31,-109500.68C881.31,-109500.68 881.31,-109430.1 881.31,-109430.1"/>
<polygon fill="black" stroke="black" points="884.81,-109430.1 881.31,-109420.1 877.81,-109430.1 884.81,-109430.1"/>
</g>
<!-- layer24_qkv_2 -->
<g id="node613" class="node">
<title>layer24_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="793,-109279.87 612,-109279.87 612,-109211.87 793,-109211.87 793,-109279.87"/>
<text text-anchor="middle" x="702.5" y="-109264.67" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="702.5" y="-109249.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="702.5" y="-109234.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="702.5" y="-109219.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer24_norm_2&#45;&gt;layer24_qkv_2 -->
<g id="edge780" class="edge">
<title>layer24_norm_2&#45;&gt;layer24_qkv_2</title>
<path fill="none" stroke="black" d="M706.5,-109351.63C706.5,-109351.63 706.5,-109290.25 706.5,-109290.25"/>
<polygon fill="black" stroke="black" points="710,-109290.25 706.5,-109280.25 703,-109290.25 710,-109290.25"/>
</g>
<!-- layer24_qkv_3 -->
<g id="node614" class="node">
<title>layer24_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1010,-109279.87 829,-109279.87 829,-109211.87 1010,-109211.87 1010,-109279.87"/>
<text text-anchor="middle" x="919.5" y="-109264.67" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="919.5" y="-109249.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="919.5" y="-109234.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="919.5" y="-109219.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer24_norm_3&#45;&gt;layer24_qkv_3 -->
<g id="edge781" class="edge">
<title>layer24_norm_3&#45;&gt;layer24_qkv_3</title>
<path fill="none" stroke="black" d="M916.5,-109351.63C916.5,-109351.63 916.5,-109290.25 916.5,-109290.25"/>
<polygon fill="black" stroke="black" points="920,-109290.25 916.5,-109280.25 913,-109290.25 920,-109290.25"/>
</g>
<!-- layer24_qkv_ar -->
<g id="node615" class="node">
<title>layer24_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="810.5" cy="-109091.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="810.5" y="-109110.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="810.5" y="-109095.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="810.5" y="-109080.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="810.5" y="-109065.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer24_qkv_2&#45;&gt;layer24_qkv_ar -->
<g id="edge782" class="edge">
<title>layer24_qkv_2&#45;&gt;layer24_qkv_ar</title>
<path fill="none" stroke="black" d="M737.76,-109211.68C737.76,-109211.68 737.76,-109141.61 737.76,-109141.61"/>
<polygon fill="black" stroke="black" points="741.26,-109141.61 737.76,-109131.61 734.26,-109141.61 741.26,-109141.61"/>
</g>
<!-- layer24_qkv_3&#45;&gt;layer24_qkv_ar -->
<g id="edge783" class="edge">
<title>layer24_qkv_3&#45;&gt;layer24_qkv_ar</title>
<path fill="none" stroke="black" d="M883.74,-109211.68C883.74,-109211.68 883.74,-109141.33 883.74,-109141.33"/>
<polygon fill="black" stroke="black" points="887.24,-109141.33 883.74,-109131.33 880.24,-109141.33 887.24,-109141.33"/>
</g>
<!-- layer24_attn_2 -->
<g id="node616" class="node">
<title>layer24_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="792.5,-108971.71 620.5,-108971.71 620.5,-108903.71 792.5,-108903.71 792.5,-108971.71"/>
<text text-anchor="middle" x="706.5" y="-108956.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="706.5" y="-108941.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="706.5" y="-108926.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="706.5" y="-108911.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer24_qkv_ar&#45;&gt;layer24_attn_2 -->
<g id="edge784" class="edge">
<title>layer24_qkv_ar&#45;&gt;layer24_attn_2</title>
<path fill="none" stroke="black" d="M737.51,-109052.11C737.51,-109052.11 737.51,-108981.76 737.51,-108981.76"/>
<polygon fill="black" stroke="black" points="741.01,-108981.76 737.51,-108971.76 734.01,-108981.76 741.01,-108981.76"/>
</g>
<!-- layer24_attn_3 -->
<g id="node617" class="node">
<title>layer24_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1000.5,-108971.71 828.5,-108971.71 828.5,-108903.71 1000.5,-108903.71 1000.5,-108971.71"/>
<text text-anchor="middle" x="914.5" y="-108956.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="914.5" y="-108941.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="914.5" y="-108926.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="914.5" y="-108911.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer24_qkv_ar&#45;&gt;layer24_attn_3 -->
<g id="edge785" class="edge">
<title>layer24_qkv_ar&#45;&gt;layer24_attn_3</title>
<path fill="none" stroke="black" d="M883.49,-109052.11C883.49,-109052.11 883.49,-108981.76 883.49,-108981.76"/>
<polygon fill="black" stroke="black" points="886.99,-108981.76 883.49,-108971.76 879.99,-108981.76 886.99,-108981.76"/>
</g>
<!-- layer24_attn_out_2 -->
<g id="node618" class="node">
<title>layer24_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="792.5,-108831.71 620.5,-108831.71 620.5,-108763.71 792.5,-108763.71 792.5,-108831.71"/>
<text text-anchor="middle" x="706.5" y="-108816.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="706.5" y="-108801.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="706.5" y="-108786.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="706.5" y="-108771.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer24_attn_2&#45;&gt;layer24_attn_out_2 -->
<g id="edge786" class="edge">
<title>layer24_attn_2&#45;&gt;layer24_attn_out_2</title>
<path fill="none" stroke="black" d="M706.5,-108903.46C706.5,-108903.46 706.5,-108842.09 706.5,-108842.09"/>
<polygon fill="black" stroke="black" points="710,-108842.09 706.5,-108832.09 703,-108842.09 710,-108842.09"/>
</g>
<!-- layer24_attn_out_3 -->
<g id="node619" class="node">
<title>layer24_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1000.5,-108831.71 828.5,-108831.71 828.5,-108763.71 1000.5,-108763.71 1000.5,-108831.71"/>
<text text-anchor="middle" x="914.5" y="-108816.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="914.5" y="-108801.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="914.5" y="-108786.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="914.5" y="-108771.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer24_attn_3&#45;&gt;layer24_attn_out_3 -->
<g id="edge787" class="edge">
<title>layer24_attn_3&#45;&gt;layer24_attn_out_3</title>
<path fill="none" stroke="black" d="M914.5,-108903.46C914.5,-108903.46 914.5,-108842.09 914.5,-108842.09"/>
<polygon fill="black" stroke="black" points="918,-108842.09 914.5,-108832.09 911,-108842.09 918,-108842.09"/>
</g>
<!-- layer24_attn_ar -->
<g id="node620" class="node">
<title>layer24_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="810.5" cy="-108643.62" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="810.5" y="-108662.42" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="810.5" y="-108647.42" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="810.5" y="-108632.42" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="810.5" y="-108617.42" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer24_attn_out_2&#45;&gt;layer24_attn_ar -->
<g id="edge788" class="edge">
<title>layer24_attn_out_2&#45;&gt;layer24_attn_ar</title>
<path fill="none" stroke="black" d="M740.69,-108763.51C740.69,-108763.51 740.69,-108693.17 740.69,-108693.17"/>
<polygon fill="black" stroke="black" points="744.19,-108693.17 740.69,-108683.17 737.19,-108693.17 744.19,-108693.17"/>
</g>
<!-- layer24_attn_out_3&#45;&gt;layer24_attn_ar -->
<g id="edge789" class="edge">
<title>layer24_attn_out_3&#45;&gt;layer24_attn_ar</title>
<path fill="none" stroke="black" d="M880.31,-108763.51C880.31,-108763.51 880.31,-108693.17 880.31,-108693.17"/>
<polygon fill="black" stroke="black" points="883.81,-108693.17 880.31,-108683.17 876.81,-108693.17 883.81,-108693.17"/>
</g>
<!-- layer24_ffn_norm_2 -->
<g id="node621" class="node">
<title>layer24_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="788.5,-108523.54 616.5,-108523.54 616.5,-108455.54 788.5,-108455.54 788.5,-108523.54"/>
<text text-anchor="middle" x="702.5" y="-108508.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="702.5" y="-108493.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="702.5" y="-108478.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="702.5" y="-108463.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer24_attn_ar&#45;&gt;layer24_ffn_norm_2 -->
<g id="edge790" class="edge">
<title>layer24_attn_ar&#45;&gt;layer24_ffn_norm_2</title>
<path fill="none" stroke="black" d="M738.69,-108604.74C738.69,-108604.74 738.69,-108533.69 738.69,-108533.69"/>
<polygon fill="black" stroke="black" points="742.19,-108533.69 738.69,-108523.69 735.19,-108533.69 742.19,-108533.69"/>
</g>
<!-- layer24_ffn_norm_3 -->
<g id="node622" class="node">
<title>layer24_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1005.5,-108523.54 833.5,-108523.54 833.5,-108455.54 1005.5,-108455.54 1005.5,-108523.54"/>
<text text-anchor="middle" x="919.5" y="-108508.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="919.5" y="-108493.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="919.5" y="-108478.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="919.5" y="-108463.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer24_attn_ar&#45;&gt;layer24_ffn_norm_3 -->
<g id="edge791" class="edge">
<title>layer24_attn_ar&#45;&gt;layer24_ffn_norm_3</title>
<path fill="none" stroke="black" d="M882.81,-108604.74C882.81,-108604.74 882.81,-108533.69 882.81,-108533.69"/>
<polygon fill="black" stroke="black" points="886.31,-108533.69 882.81,-108523.69 879.31,-108533.69 886.31,-108533.69"/>
</g>
<!-- layer24_ffn_gate_2 -->
<g id="node623" class="node">
<title>layer24_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="793,-108383.54 612,-108383.54 612,-108315.54 793,-108315.54 793,-108383.54"/>
<text text-anchor="middle" x="702.5" y="-108368.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="702.5" y="-108353.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="702.5" y="-108338.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="702.5" y="-108323.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_ffn_norm_2&#45;&gt;layer24_ffn_gate_2 -->
<g id="edge792" class="edge">
<title>layer24_ffn_norm_2&#45;&gt;layer24_ffn_gate_2</title>
<path fill="none" stroke="black" d="M702.5,-108455.29C702.5,-108455.29 702.5,-108393.92 702.5,-108393.92"/>
<polygon fill="black" stroke="black" points="706,-108393.92 702.5,-108383.92 699,-108393.92 706,-108393.92"/>
</g>
<!-- layer24_ffn_up_2 -->
<g id="node625" class="node">
<title>layer24_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="576,-108383.54 395,-108383.54 395,-108315.54 576,-108315.54 576,-108383.54"/>
<text text-anchor="middle" x="485.5" y="-108368.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="485.5" y="-108353.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="485.5" y="-108338.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="485.5" y="-108323.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_ffn_norm_2&#45;&gt;layer24_ffn_up_2 -->
<g id="edge794" class="edge">
<title>layer24_ffn_norm_2&#45;&gt;layer24_ffn_up_2</title>
<path fill="none" stroke="black" d="M616.05,-108489C576.48,-108489 538.26,-108489 538.26,-108489 538.26,-108489 538.26,-108393.66 538.26,-108393.66"/>
<polygon fill="black" stroke="black" points="541.76,-108393.66 538.26,-108383.66 534.76,-108393.66 541.76,-108393.66"/>
</g>
<!-- layer24_ffn_gate_3 -->
<g id="node624" class="node">
<title>layer24_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1227,-108383.54 1046,-108383.54 1046,-108315.54 1227,-108315.54 1227,-108383.54"/>
<text text-anchor="middle" x="1136.5" y="-108368.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1136.5" y="-108353.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1136.5" y="-108338.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1136.5" y="-108323.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_ffn_norm_3&#45;&gt;layer24_ffn_gate_3 -->
<g id="edge793" class="edge">
<title>layer24_ffn_norm_3&#45;&gt;layer24_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1005.77,-108489C1044.87,-108489 1082.5,-108489 1082.5,-108489 1082.5,-108489 1082.5,-108393.66 1082.5,-108393.66"/>
<polygon fill="black" stroke="black" points="1086,-108393.66 1082.5,-108383.66 1079,-108393.66 1086,-108393.66"/>
</g>
<!-- layer24_ffn_up_3 -->
<g id="node626" class="node">
<title>layer24_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1010,-108383.54 829,-108383.54 829,-108315.54 1010,-108315.54 1010,-108383.54"/>
<text text-anchor="middle" x="919.5" y="-108368.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="919.5" y="-108353.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="919.5" y="-108338.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="919.5" y="-108323.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_ffn_norm_3&#45;&gt;layer24_ffn_up_3 -->
<g id="edge795" class="edge">
<title>layer24_ffn_norm_3&#45;&gt;layer24_ffn_up_3</title>
<path fill="none" stroke="black" d="M919.5,-108455.29C919.5,-108455.29 919.5,-108393.92 919.5,-108393.92"/>
<polygon fill="black" stroke="black" points="923,-108393.92 919.5,-108383.92 916,-108393.92 923,-108393.92"/>
</g>
<!-- layer24_gate_ar -->
<g id="node627" class="node">
<title>layer24_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1010.5" cy="-108195.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1010.5" y="-108214.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1010.5" y="-108199.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1010.5" y="-108184.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1010.5" y="-108169.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer24_ffn_gate_2&#45;&gt;layer24_gate_ar -->
<g id="edge796" class="edge">
<title>layer24_ffn_gate_2&#45;&gt;layer24_gate_ar</title>
<path fill="none" stroke="black" d="M793.08,-108349C803.79,-108349 811,-108349 811,-108349 811,-108349 811,-108211 811,-108211 811,-108211 879.28,-108211 879.28,-108211"/>
<polygon fill="black" stroke="black" points="879.28,-108214.5 889.28,-108211 879.28,-108207.5 879.28,-108214.5"/>
</g>
<!-- layer24_ffn_gate_3&#45;&gt;layer24_gate_ar -->
<g id="edge797" class="edge">
<title>layer24_ffn_gate_3&#45;&gt;layer24_gate_ar</title>
<path fill="none" stroke="black" d="M1092.24,-108315.34C1092.24,-108315.34 1092.24,-108242.52 1092.24,-108242.52"/>
<polygon fill="black" stroke="black" points="1095.74,-108242.52 1092.24,-108232.52 1088.74,-108242.52 1095.74,-108242.52"/>
</g>
<!-- layer24_up_ar -->
<g id="node628" class="node">
<title>layer24_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="664.5" cy="-108195.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="664.5" y="-108214.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="664.5" y="-108199.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="664.5" y="-108184.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="664.5" y="-108169.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer24_ffn_up_2&#45;&gt;layer24_up_ar -->
<g id="edge798" class="edge">
<title>layer24_ffn_up_2&#45;&gt;layer24_up_ar</title>
<path fill="none" stroke="black" d="M556.26,-108315.34C556.26,-108315.34 556.26,-108231.42 556.26,-108231.42"/>
<polygon fill="black" stroke="black" points="559.76,-108231.42 556.26,-108221.42 552.76,-108231.42 559.76,-108231.42"/>
</g>
<!-- layer24_ffn_up_3&#45;&gt;layer24_up_ar -->
<g id="edge799" class="edge">
<title>layer24_ffn_up_3&#45;&gt;layer24_up_ar</title>
<path fill="none" stroke="black" d="M855.76,-108315.44C855.76,-108265.67 855.76,-108179 855.76,-108179 855.76,-108179 794.81,-108179 794.81,-108179"/>
<polygon fill="black" stroke="black" points="794.81,-108175.5 784.81,-108179 794.81,-108182.5 794.81,-108175.5"/>
</g>
<!-- layer24_silu_2 -->
<g id="node629" class="node">
<title>layer24_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="938,-108075.37 757,-108075.37 757,-108007.37 938,-108007.37 938,-108075.37"/>
<text text-anchor="middle" x="847.5" y="-108060.17" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="847.5" y="-108045.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="847.5" y="-108030.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="847.5" y="-108015.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_gate_ar&#45;&gt;layer24_silu_2 -->
<g id="edge800" class="edge">
<title>layer24_gate_ar&#45;&gt;layer24_silu_2</title>
<path fill="none" stroke="black" d="M910.26,-108165.38C910.26,-108165.38 910.26,-108085.4 910.26,-108085.4"/>
<polygon fill="black" stroke="black" points="913.76,-108085.4 910.26,-108075.4 906.76,-108085.4 913.76,-108085.4"/>
</g>
<!-- layer24_silu_3 -->
<g id="node630" class="node">
<title>layer24_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1155,-108075.37 974,-108075.37 974,-108007.37 1155,-108007.37 1155,-108075.37"/>
<text text-anchor="middle" x="1064.5" y="-108060.17" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1064.5" y="-108045.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1064.5" y="-108030.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1064.5" y="-108015.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_gate_ar&#45;&gt;layer24_silu_3 -->
<g id="edge801" class="edge">
<title>layer24_gate_ar&#45;&gt;layer24_silu_3</title>
<path fill="none" stroke="black" d="M1056.24,-108150.48C1056.24,-108150.48 1056.24,-108085.38 1056.24,-108085.38"/>
<polygon fill="black" stroke="black" points="1059.74,-108085.38 1056.24,-108075.38 1052.74,-108085.38 1059.74,-108085.38"/>
</g>
<!-- layer24_mul_2 -->
<g id="node631" class="node">
<title>layer24_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="828,-107935.37 647,-107935.37 647,-107867.37 828,-107867.37 828,-107935.37"/>
<text text-anchor="middle" x="737.5" y="-107920.17" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="737.5" y="-107905.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="737.5" y="-107890.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="737.5" y="-107875.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_up_ar&#45;&gt;layer24_mul_2 -->
<g id="edge803" class="edge">
<title>layer24_up_ar&#45;&gt;layer24_mul_2</title>
<path fill="none" stroke="black" d="M702,-108149.18C702,-108149.18 702,-107945.46 702,-107945.46"/>
<polygon fill="black" stroke="black" points="705.5,-107945.46 702,-107935.46 698.5,-107945.46 705.5,-107945.46"/>
</g>
<!-- layer24_mul_3 -->
<g id="node632" class="node">
<title>layer24_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1045,-107935.37 864,-107935.37 864,-107867.37 1045,-107867.37 1045,-107935.37"/>
<text text-anchor="middle" x="954.5" y="-107920.17" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="954.5" y="-107905.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="954.5" y="-107890.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="954.5" y="-107875.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer24_up_ar&#45;&gt;layer24_mul_3 -->
<g id="edge805" class="edge">
<title>layer24_up_ar&#45;&gt;layer24_mul_3</title>
<path fill="none" stroke="black" d="M774.74,-108171.03C774.74,-108146.09 774.74,-108111 774.74,-108111 774.74,-108111 956,-108111 956,-108111 956,-108111 956,-107945.52 956,-107945.52"/>
<polygon fill="black" stroke="black" points="959.5,-107945.52 956,-107935.52 952.5,-107945.52 959.5,-107945.52"/>
</g>
<!-- layer24_silu_2&#45;&gt;layer24_mul_2 -->
<g id="edge802" class="edge">
<title>layer24_silu_2&#45;&gt;layer24_mul_2</title>
<path fill="none" stroke="black" d="M792.5,-108007.13C792.5,-108007.13 792.5,-107945.75 792.5,-107945.75"/>
<polygon fill="black" stroke="black" points="796,-107945.75 792.5,-107935.75 789,-107945.75 796,-107945.75"/>
</g>
<!-- layer24_silu_3&#45;&gt;layer24_mul_3 -->
<g id="edge804" class="edge">
<title>layer24_silu_3&#45;&gt;layer24_mul_3</title>
<path fill="none" stroke="black" d="M1009.5,-108007.13C1009.5,-108007.13 1009.5,-107945.75 1009.5,-107945.75"/>
<polygon fill="black" stroke="black" points="1013,-107945.75 1009.5,-107935.75 1006,-107945.75 1013,-107945.75"/>
</g>
<!-- layer24_ffn_down_2 -->
<g id="node633" class="node">
<title>layer24_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="826.5,-107795.37 654.5,-107795.37 654.5,-107727.37 826.5,-107727.37 826.5,-107795.37"/>
<text text-anchor="middle" x="740.5" y="-107780.17" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="740.5" y="-107765.17" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="740.5" y="-107750.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="740.5" y="-107735.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer24_mul_2&#45;&gt;layer24_ffn_down_2 -->
<g id="edge806" class="edge">
<title>layer24_mul_2&#45;&gt;layer24_ffn_down_2</title>
<path fill="none" stroke="black" d="M740.5,-107867.13C740.5,-107867.13 740.5,-107805.75 740.5,-107805.75"/>
<polygon fill="black" stroke="black" points="744,-107805.75 740.5,-107795.75 737,-107805.75 744,-107805.75"/>
</g>
<!-- layer24_ffn_down_3 -->
<g id="node634" class="node">
<title>layer24_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1036.5,-107795.37 864.5,-107795.37 864.5,-107727.37 1036.5,-107727.37 1036.5,-107795.37"/>
<text text-anchor="middle" x="950.5" y="-107780.17" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="950.5" y="-107765.17" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="950.5" y="-107750.17" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="950.5" y="-107735.17" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer24_mul_3&#45;&gt;layer24_ffn_down_3 -->
<g id="edge807" class="edge">
<title>layer24_mul_3&#45;&gt;layer24_ffn_down_3</title>
<path fill="none" stroke="black" d="M950.5,-107867.13C950.5,-107867.13 950.5,-107805.75 950.5,-107805.75"/>
<polygon fill="black" stroke="black" points="954,-107805.75 950.5,-107795.75 947,-107805.75 954,-107805.75"/>
</g>
<!-- layer24_ffn_ar -->
<g id="node635" class="node">
<title>layer24_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="844.5" cy="-107607.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="844.5" y="-107626.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="844.5" y="-107611.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="844.5" y="-107596.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="844.5" y="-107581.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer24_ffn_down_2&#45;&gt;layer24_ffn_ar -->
<g id="edge808" class="edge">
<title>layer24_ffn_down_2&#45;&gt;layer24_ffn_ar</title>
<path fill="none" stroke="black" d="M774.69,-107727.18C774.69,-107727.18 774.69,-107656.83 774.69,-107656.83"/>
<polygon fill="black" stroke="black" points="778.19,-107656.83 774.69,-107646.83 771.19,-107656.83 778.19,-107656.83"/>
</g>
<!-- layer24_ffn_down_3&#45;&gt;layer24_ffn_ar -->
<g id="edge809" class="edge">
<title>layer24_ffn_down_3&#45;&gt;layer24_ffn_ar</title>
<path fill="none" stroke="black" d="M915.31,-107727.18C915.31,-107727.18 915.31,-107656.56 915.31,-107656.56"/>
<polygon fill="black" stroke="black" points="918.81,-107656.56 915.31,-107646.56 911.81,-107656.56 918.81,-107656.56"/>
</g>
<!-- layer25_norm_2 -->
<g id="node636" class="node">
<title>layer25_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="826.5,-107487.21 654.5,-107487.21 654.5,-107419.21 826.5,-107419.21 826.5,-107487.21"/>
<text text-anchor="middle" x="740.5" y="-107472.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="740.5" y="-107457.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="740.5" y="-107442.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="740.5" y="-107427.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer24_ffn_ar&#45;&gt;layer25_norm_2 -->
<g id="edge810" class="edge">
<title>layer24_ffn_ar&#45;&gt;layer25_norm_2</title>
<path fill="none" stroke="black" d="M774.69,-107567.61C774.69,-107567.61 774.69,-107497.26 774.69,-107497.26"/>
<polygon fill="black" stroke="black" points="778.19,-107497.26 774.69,-107487.26 771.19,-107497.26 778.19,-107497.26"/>
</g>
<!-- layer25_norm_3 -->
<g id="node637" class="node">
<title>layer25_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1036.5,-107487.21 864.5,-107487.21 864.5,-107419.21 1036.5,-107419.21 1036.5,-107487.21"/>
<text text-anchor="middle" x="950.5" y="-107472.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="950.5" y="-107457.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="950.5" y="-107442.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="950.5" y="-107427.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer24_ffn_ar&#45;&gt;layer25_norm_3 -->
<g id="edge811" class="edge">
<title>layer24_ffn_ar&#45;&gt;layer25_norm_3</title>
<path fill="none" stroke="black" d="M915.31,-107568.01C915.31,-107568.01 915.31,-107497.44 915.31,-107497.44"/>
<polygon fill="black" stroke="black" points="918.81,-107497.44 915.31,-107487.44 911.81,-107497.44 918.81,-107497.44"/>
</g>
<!-- layer25_qkv_2 -->
<g id="node638" class="node">
<title>layer25_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="827,-107347.21 646,-107347.21 646,-107279.21 827,-107279.21 827,-107347.21"/>
<text text-anchor="middle" x="736.5" y="-107332.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="736.5" y="-107317.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="736.5" y="-107302.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="736.5" y="-107287.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer25_norm_2&#45;&gt;layer25_qkv_2 -->
<g id="edge812" class="edge">
<title>layer25_norm_2&#45;&gt;layer25_qkv_2</title>
<path fill="none" stroke="black" d="M740.5,-107418.96C740.5,-107418.96 740.5,-107357.59 740.5,-107357.59"/>
<polygon fill="black" stroke="black" points="744,-107357.59 740.5,-107347.59 737,-107357.59 744,-107357.59"/>
</g>
<!-- layer25_qkv_3 -->
<g id="node639" class="node">
<title>layer25_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1044,-107347.21 863,-107347.21 863,-107279.21 1044,-107279.21 1044,-107347.21"/>
<text text-anchor="middle" x="953.5" y="-107332.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="953.5" y="-107317.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="953.5" y="-107302.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="953.5" y="-107287.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer25_norm_3&#45;&gt;layer25_qkv_3 -->
<g id="edge813" class="edge">
<title>layer25_norm_3&#45;&gt;layer25_qkv_3</title>
<path fill="none" stroke="black" d="M950.5,-107418.96C950.5,-107418.96 950.5,-107357.59 950.5,-107357.59"/>
<polygon fill="black" stroke="black" points="954,-107357.59 950.5,-107347.59 947,-107357.59 954,-107357.59"/>
</g>
<!-- layer25_qkv_ar -->
<g id="node640" class="node">
<title>layer25_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="844.5" cy="-107159.12" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="844.5" y="-107177.92" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="844.5" y="-107162.92" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="844.5" y="-107147.92" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="844.5" y="-107132.92" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer25_qkv_2&#45;&gt;layer25_qkv_ar -->
<g id="edge814" class="edge">
<title>layer25_qkv_2&#45;&gt;layer25_qkv_ar</title>
<path fill="none" stroke="black" d="M771.76,-107279.01C771.76,-107279.01 771.76,-107208.95 771.76,-107208.95"/>
<polygon fill="black" stroke="black" points="775.26,-107208.95 771.76,-107198.95 768.26,-107208.95 775.26,-107208.95"/>
</g>
<!-- layer25_qkv_3&#45;&gt;layer25_qkv_ar -->
<g id="edge815" class="edge">
<title>layer25_qkv_3&#45;&gt;layer25_qkv_ar</title>
<path fill="none" stroke="black" d="M917.74,-107279.01C917.74,-107279.01 917.74,-107208.67 917.74,-107208.67"/>
<polygon fill="black" stroke="black" points="921.24,-107208.67 917.74,-107198.67 914.24,-107208.67 921.24,-107208.67"/>
</g>
<!-- layer25_attn_2 -->
<g id="node641" class="node">
<title>layer25_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="826.5,-107039.04 654.5,-107039.04 654.5,-106971.04 826.5,-106971.04 826.5,-107039.04"/>
<text text-anchor="middle" x="740.5" y="-107023.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="740.5" y="-107008.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="740.5" y="-106993.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="740.5" y="-106978.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer25_qkv_ar&#45;&gt;layer25_attn_2 -->
<g id="edge816" class="edge">
<title>layer25_qkv_ar&#45;&gt;layer25_attn_2</title>
<path fill="none" stroke="black" d="M771.51,-107119.44C771.51,-107119.44 771.51,-107049.1 771.51,-107049.1"/>
<polygon fill="black" stroke="black" points="775.01,-107049.1 771.51,-107039.1 768.01,-107049.1 775.01,-107049.1"/>
</g>
<!-- layer25_attn_3 -->
<g id="node642" class="node">
<title>layer25_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1034.5,-107039.04 862.5,-107039.04 862.5,-106971.04 1034.5,-106971.04 1034.5,-107039.04"/>
<text text-anchor="middle" x="948.5" y="-107023.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="948.5" y="-107008.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="948.5" y="-106993.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="948.5" y="-106978.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer25_qkv_ar&#45;&gt;layer25_attn_3 -->
<g id="edge817" class="edge">
<title>layer25_qkv_ar&#45;&gt;layer25_attn_3</title>
<path fill="none" stroke="black" d="M917.49,-107119.44C917.49,-107119.44 917.49,-107049.1 917.49,-107049.1"/>
<polygon fill="black" stroke="black" points="920.99,-107049.1 917.49,-107039.1 913.99,-107049.1 920.99,-107049.1"/>
</g>
<!-- layer25_attn_out_2 -->
<g id="node643" class="node">
<title>layer25_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="826.5,-106899.04 654.5,-106899.04 654.5,-106831.04 826.5,-106831.04 826.5,-106899.04"/>
<text text-anchor="middle" x="740.5" y="-106883.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="740.5" y="-106868.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="740.5" y="-106853.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="740.5" y="-106838.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer25_attn_2&#45;&gt;layer25_attn_out_2 -->
<g id="edge818" class="edge">
<title>layer25_attn_2&#45;&gt;layer25_attn_out_2</title>
<path fill="none" stroke="black" d="M740.5,-106970.79C740.5,-106970.79 740.5,-106909.42 740.5,-106909.42"/>
<polygon fill="black" stroke="black" points="744,-106909.42 740.5,-106899.42 737,-106909.42 744,-106909.42"/>
</g>
<!-- layer25_attn_out_3 -->
<g id="node644" class="node">
<title>layer25_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1034.5,-106899.04 862.5,-106899.04 862.5,-106831.04 1034.5,-106831.04 1034.5,-106899.04"/>
<text text-anchor="middle" x="948.5" y="-106883.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="948.5" y="-106868.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="948.5" y="-106853.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="948.5" y="-106838.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer25_attn_3&#45;&gt;layer25_attn_out_3 -->
<g id="edge819" class="edge">
<title>layer25_attn_3&#45;&gt;layer25_attn_out_3</title>
<path fill="none" stroke="black" d="M948.5,-106970.79C948.5,-106970.79 948.5,-106909.42 948.5,-106909.42"/>
<polygon fill="black" stroke="black" points="952,-106909.42 948.5,-106899.42 945,-106909.42 952,-106909.42"/>
</g>
<!-- layer25_attn_ar -->
<g id="node645" class="node">
<title>layer25_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="844.5" cy="-106710.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="844.5" y="-106729.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="844.5" y="-106714.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="844.5" y="-106699.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="844.5" y="-106684.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer25_attn_out_2&#45;&gt;layer25_attn_ar -->
<g id="edge820" class="edge">
<title>layer25_attn_out_2&#45;&gt;layer25_attn_ar</title>
<path fill="none" stroke="black" d="M774.69,-106830.85C774.69,-106830.85 774.69,-106760.5 774.69,-106760.5"/>
<polygon fill="black" stroke="black" points="778.19,-106760.5 774.69,-106750.5 771.19,-106760.5 778.19,-106760.5"/>
</g>
<!-- layer25_attn_out_3&#45;&gt;layer25_attn_ar -->
<g id="edge821" class="edge">
<title>layer25_attn_out_3&#45;&gt;layer25_attn_ar</title>
<path fill="none" stroke="black" d="M914.31,-106830.85C914.31,-106830.85 914.31,-106760.5 914.31,-106760.5"/>
<polygon fill="black" stroke="black" points="917.81,-106760.5 914.31,-106750.5 910.81,-106760.5 917.81,-106760.5"/>
</g>
<!-- layer25_ffn_norm_2 -->
<g id="node646" class="node">
<title>layer25_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="822.5,-106590.87 650.5,-106590.87 650.5,-106522.87 822.5,-106522.87 822.5,-106590.87"/>
<text text-anchor="middle" x="736.5" y="-106575.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="736.5" y="-106560.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="736.5" y="-106545.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="736.5" y="-106530.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer25_attn_ar&#45;&gt;layer25_ffn_norm_2 -->
<g id="edge822" class="edge">
<title>layer25_attn_ar&#45;&gt;layer25_ffn_norm_2</title>
<path fill="none" stroke="black" d="M772.69,-106672.08C772.69,-106672.08 772.69,-106601.02 772.69,-106601.02"/>
<polygon fill="black" stroke="black" points="776.19,-106601.02 772.69,-106591.02 769.19,-106601.02 776.19,-106601.02"/>
</g>
<!-- layer25_ffn_norm_3 -->
<g id="node647" class="node">
<title>layer25_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1039.5,-106590.87 867.5,-106590.87 867.5,-106522.87 1039.5,-106522.87 1039.5,-106590.87"/>
<text text-anchor="middle" x="953.5" y="-106575.67" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="953.5" y="-106560.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="953.5" y="-106545.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="953.5" y="-106530.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer25_attn_ar&#45;&gt;layer25_ffn_norm_3 -->
<g id="edge823" class="edge">
<title>layer25_attn_ar&#45;&gt;layer25_ffn_norm_3</title>
<path fill="none" stroke="black" d="M916.81,-106672.08C916.81,-106672.08 916.81,-106601.02 916.81,-106601.02"/>
<polygon fill="black" stroke="black" points="920.31,-106601.02 916.81,-106591.02 913.31,-106601.02 920.31,-106601.02"/>
</g>
<!-- layer25_ffn_gate_2 -->
<g id="node648" class="node">
<title>layer25_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="827,-106450.87 646,-106450.87 646,-106382.87 827,-106382.87 827,-106450.87"/>
<text text-anchor="middle" x="736.5" y="-106435.67" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="736.5" y="-106420.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="736.5" y="-106405.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="736.5" y="-106390.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_ffn_norm_2&#45;&gt;layer25_ffn_gate_2 -->
<g id="edge824" class="edge">
<title>layer25_ffn_norm_2&#45;&gt;layer25_ffn_gate_2</title>
<path fill="none" stroke="black" d="M736.5,-106522.63C736.5,-106522.63 736.5,-106461.25 736.5,-106461.25"/>
<polygon fill="black" stroke="black" points="740,-106461.25 736.5,-106451.25 733,-106461.25 740,-106461.25"/>
</g>
<!-- layer25_ffn_up_2 -->
<g id="node650" class="node">
<title>layer25_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="610,-106450.87 429,-106450.87 429,-106382.87 610,-106382.87 610,-106450.87"/>
<text text-anchor="middle" x="519.5" y="-106435.67" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="519.5" y="-106420.67" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="519.5" y="-106405.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="519.5" y="-106390.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_ffn_norm_2&#45;&gt;layer25_ffn_up_2 -->
<g id="edge826" class="edge">
<title>layer25_ffn_norm_2&#45;&gt;layer25_ffn_up_2</title>
<path fill="none" stroke="black" d="M650.1,-106556C610.94,-106556 573.26,-106556 573.26,-106556 573.26,-106556 573.26,-106460.91 573.26,-106460.91"/>
<polygon fill="black" stroke="black" points="576.76,-106460.91 573.26,-106450.91 569.76,-106460.91 576.76,-106460.91"/>
</g>
<!-- layer25_ffn_gate_3 -->
<g id="node649" class="node">
<title>layer25_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1261,-106450.87 1080,-106450.87 1080,-106382.87 1261,-106382.87 1261,-106450.87"/>
<text text-anchor="middle" x="1170.5" y="-106435.67" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1170.5" y="-106420.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1170.5" y="-106405.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1170.5" y="-106390.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_ffn_norm_3&#45;&gt;layer25_ffn_gate_3 -->
<g id="edge825" class="edge">
<title>layer25_ffn_norm_3&#45;&gt;layer25_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1039.82,-106556C1079.33,-106556 1117.5,-106556 1117.5,-106556 1117.5,-106556 1117.5,-106460.91 1117.5,-106460.91"/>
<polygon fill="black" stroke="black" points="1121,-106460.91 1117.5,-106450.91 1114,-106460.91 1121,-106460.91"/>
</g>
<!-- layer25_ffn_up_3 -->
<g id="node651" class="node">
<title>layer25_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1044,-106450.87 863,-106450.87 863,-106382.87 1044,-106382.87 1044,-106450.87"/>
<text text-anchor="middle" x="953.5" y="-106435.67" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="953.5" y="-106420.67" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="953.5" y="-106405.67" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="953.5" y="-106390.67" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_ffn_norm_3&#45;&gt;layer25_ffn_up_3 -->
<g id="edge827" class="edge">
<title>layer25_ffn_norm_3&#45;&gt;layer25_ffn_up_3</title>
<path fill="none" stroke="black" d="M953.5,-106522.63C953.5,-106522.63 953.5,-106461.25 953.5,-106461.25"/>
<polygon fill="black" stroke="black" points="957,-106461.25 953.5,-106451.25 950,-106461.25 957,-106461.25"/>
</g>
<!-- layer25_gate_ar -->
<g id="node652" class="node">
<title>layer25_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1044.5" cy="-106262.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1044.5" y="-106281.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1044.5" y="-106266.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1044.5" y="-106251.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1044.5" y="-106236.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer25_ffn_gate_2&#45;&gt;layer25_gate_ar -->
<g id="edge828" class="edge">
<title>layer25_ffn_gate_2&#45;&gt;layer25_gate_ar</title>
<path fill="none" stroke="black" d="M827.08,-106416C837.79,-106416 845,-106416 845,-106416 845,-106416 845,-106278 845,-106278 845,-106278 912.99,-106278 912.99,-106278"/>
<polygon fill="black" stroke="black" points="912.99,-106281.5 922.99,-106278 912.99,-106274.5 912.99,-106281.5"/>
</g>
<!-- layer25_ffn_gate_3&#45;&gt;layer25_gate_ar -->
<g id="edge829" class="edge">
<title>layer25_ffn_gate_3&#45;&gt;layer25_gate_ar</title>
<path fill="none" stroke="black" d="M1126.24,-106382.68C1126.24,-106382.68 1126.24,-106309.85 1126.24,-106309.85"/>
<polygon fill="black" stroke="black" points="1129.74,-106309.85 1126.24,-106299.85 1122.74,-106309.85 1129.74,-106309.85"/>
</g>
<!-- layer25_up_ar -->
<g id="node653" class="node">
<title>layer25_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="698.5" cy="-106262.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="698.5" y="-106281.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="698.5" y="-106266.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="698.5" y="-106251.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="698.5" y="-106236.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer25_ffn_up_2&#45;&gt;layer25_up_ar -->
<g id="edge830" class="edge">
<title>layer25_ffn_up_2&#45;&gt;layer25_up_ar</title>
<path fill="none" stroke="black" d="M590.26,-106382.68C590.26,-106382.68 590.26,-106298.76 590.26,-106298.76"/>
<polygon fill="black" stroke="black" points="593.76,-106298.76 590.26,-106288.76 586.76,-106298.76 593.76,-106298.76"/>
</g>
<!-- layer25_ffn_up_3&#45;&gt;layer25_up_ar -->
<g id="edge831" class="edge">
<title>layer25_ffn_up_3&#45;&gt;layer25_up_ar</title>
<path fill="none" stroke="black" d="M889.76,-106382.71C889.76,-106332.84 889.76,-106246 889.76,-106246 889.76,-106246 828.54,-106246 828.54,-106246"/>
<polygon fill="black" stroke="black" points="828.54,-106242.5 818.54,-106246 828.54,-106249.5 828.54,-106242.5"/>
</g>
<!-- layer25_silu_2 -->
<g id="node654" class="node">
<title>layer25_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="972,-106142.71 791,-106142.71 791,-106074.71 972,-106074.71 972,-106142.71"/>
<text text-anchor="middle" x="881.5" y="-106127.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="881.5" y="-106112.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="881.5" y="-106097.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="881.5" y="-106082.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_gate_ar&#45;&gt;layer25_silu_2 -->
<g id="edge832" class="edge">
<title>layer25_gate_ar&#45;&gt;layer25_silu_2</title>
<path fill="none" stroke="black" d="M944.26,-106232.72C944.26,-106232.72 944.26,-106152.73 944.26,-106152.73"/>
<polygon fill="black" stroke="black" points="947.76,-106152.73 944.26,-106142.73 940.76,-106152.73 947.76,-106152.73"/>
</g>
<!-- layer25_silu_3 -->
<g id="node655" class="node">
<title>layer25_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1189,-106142.71 1008,-106142.71 1008,-106074.71 1189,-106074.71 1189,-106142.71"/>
<text text-anchor="middle" x="1098.5" y="-106127.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1098.5" y="-106112.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1098.5" y="-106097.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1098.5" y="-106082.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_gate_ar&#45;&gt;layer25_silu_3 -->
<g id="edge833" class="edge">
<title>layer25_gate_ar&#45;&gt;layer25_silu_3</title>
<path fill="none" stroke="black" d="M1090.24,-106217.81C1090.24,-106217.81 1090.24,-106152.71 1090.24,-106152.71"/>
<polygon fill="black" stroke="black" points="1093.74,-106152.71 1090.24,-106142.71 1086.74,-106152.71 1093.74,-106152.71"/>
</g>
<!-- layer25_mul_2 -->
<g id="node656" class="node">
<title>layer25_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="862,-106002.71 681,-106002.71 681,-105934.71 862,-105934.71 862,-106002.71"/>
<text text-anchor="middle" x="771.5" y="-105987.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="771.5" y="-105972.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="771.5" y="-105957.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="771.5" y="-105942.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_up_ar&#45;&gt;layer25_mul_2 -->
<g id="edge835" class="edge">
<title>layer25_up_ar&#45;&gt;layer25_mul_2</title>
<path fill="none" stroke="black" d="M736,-106216.52C736,-106216.52 736,-106012.79 736,-106012.79"/>
<polygon fill="black" stroke="black" points="739.5,-106012.79 736,-106002.79 732.5,-106012.79 739.5,-106012.79"/>
</g>
<!-- layer25_mul_3 -->
<g id="node657" class="node">
<title>layer25_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1079,-106002.71 898,-106002.71 898,-105934.71 1079,-105934.71 1079,-106002.71"/>
<text text-anchor="middle" x="988.5" y="-105987.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="988.5" y="-105972.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="988.5" y="-105957.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="988.5" y="-105942.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer25_up_ar&#45;&gt;layer25_mul_3 -->
<g id="edge837" class="edge">
<title>layer25_up_ar&#45;&gt;layer25_mul_3</title>
<path fill="none" stroke="black" d="M808.74,-106238.27C808.74,-106213.22 808.74,-106178 808.74,-106178 808.74,-106178 990,-106178 990,-106178 990,-106178 990,-106012.8 990,-106012.8"/>
<polygon fill="black" stroke="black" points="993.5,-106012.8 990,-106002.8 986.5,-106012.8 993.5,-106012.8"/>
</g>
<!-- layer25_silu_2&#45;&gt;layer25_mul_2 -->
<g id="edge834" class="edge">
<title>layer25_silu_2&#45;&gt;layer25_mul_2</title>
<path fill="none" stroke="black" d="M826.5,-106074.46C826.5,-106074.46 826.5,-106013.09 826.5,-106013.09"/>
<polygon fill="black" stroke="black" points="830,-106013.09 826.5,-106003.09 823,-106013.09 830,-106013.09"/>
</g>
<!-- layer25_silu_3&#45;&gt;layer25_mul_3 -->
<g id="edge836" class="edge">
<title>layer25_silu_3&#45;&gt;layer25_mul_3</title>
<path fill="none" stroke="black" d="M1043.5,-106074.46C1043.5,-106074.46 1043.5,-106013.09 1043.5,-106013.09"/>
<polygon fill="black" stroke="black" points="1047,-106013.09 1043.5,-106003.09 1040,-106013.09 1047,-106013.09"/>
</g>
<!-- layer25_ffn_down_2 -->
<g id="node658" class="node">
<title>layer25_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="861.5,-105862.71 689.5,-105862.71 689.5,-105794.71 861.5,-105794.71 861.5,-105862.71"/>
<text text-anchor="middle" x="775.5" y="-105847.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="775.5" y="-105832.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="775.5" y="-105817.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="775.5" y="-105802.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer25_mul_2&#45;&gt;layer25_ffn_down_2 -->
<g id="edge838" class="edge">
<title>layer25_mul_2&#45;&gt;layer25_ffn_down_2</title>
<path fill="none" stroke="black" d="M775.5,-105934.46C775.5,-105934.46 775.5,-105873.09 775.5,-105873.09"/>
<polygon fill="black" stroke="black" points="779,-105873.09 775.5,-105863.09 772,-105873.09 779,-105873.09"/>
</g>
<!-- layer25_ffn_down_3 -->
<g id="node659" class="node">
<title>layer25_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1071.5,-105862.71 899.5,-105862.71 899.5,-105794.71 1071.5,-105794.71 1071.5,-105862.71"/>
<text text-anchor="middle" x="985.5" y="-105847.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="985.5" y="-105832.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="985.5" y="-105817.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="985.5" y="-105802.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer25_mul_3&#45;&gt;layer25_ffn_down_3 -->
<g id="edge839" class="edge">
<title>layer25_mul_3&#45;&gt;layer25_ffn_down_3</title>
<path fill="none" stroke="black" d="M985.5,-105934.46C985.5,-105934.46 985.5,-105873.09 985.5,-105873.09"/>
<polygon fill="black" stroke="black" points="989,-105873.09 985.5,-105863.09 982,-105873.09 989,-105873.09"/>
</g>
<!-- layer25_ffn_ar -->
<g id="node660" class="node">
<title>layer25_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="879.5" cy="-105674.62" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="879.5" y="-105693.42" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="879.5" y="-105678.42" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="879.5" y="-105663.42" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="879.5" y="-105648.42" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer25_ffn_down_2&#45;&gt;layer25_ffn_ar -->
<g id="edge840" class="edge">
<title>layer25_ffn_down_2&#45;&gt;layer25_ffn_ar</title>
<path fill="none" stroke="black" d="M809.69,-105794.51C809.69,-105794.51 809.69,-105724.17 809.69,-105724.17"/>
<polygon fill="black" stroke="black" points="813.19,-105724.17 809.69,-105714.17 806.19,-105724.17 813.19,-105724.17"/>
</g>
<!-- layer25_ffn_down_3&#45;&gt;layer25_ffn_ar -->
<g id="edge841" class="edge">
<title>layer25_ffn_down_3&#45;&gt;layer25_ffn_ar</title>
<path fill="none" stroke="black" d="M950.31,-105794.51C950.31,-105794.51 950.31,-105723.89 950.31,-105723.89"/>
<polygon fill="black" stroke="black" points="953.81,-105723.89 950.31,-105713.89 946.81,-105723.89 953.81,-105723.89"/>
</g>
<!-- layer26_norm_2 -->
<g id="node661" class="node">
<title>layer26_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="861.5,-105554.54 689.5,-105554.54 689.5,-105486.54 861.5,-105486.54 861.5,-105554.54"/>
<text text-anchor="middle" x="775.5" y="-105539.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="775.5" y="-105524.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="775.5" y="-105509.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="775.5" y="-105494.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer25_ffn_ar&#45;&gt;layer26_norm_2 -->
<g id="edge842" class="edge">
<title>layer25_ffn_ar&#45;&gt;layer26_norm_2</title>
<path fill="none" stroke="black" d="M809.69,-105634.94C809.69,-105634.94 809.69,-105564.6 809.69,-105564.6"/>
<polygon fill="black" stroke="black" points="813.19,-105564.6 809.69,-105554.6 806.19,-105564.6 813.19,-105564.6"/>
</g>
<!-- layer26_norm_3 -->
<g id="node662" class="node">
<title>layer26_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1071.5,-105554.54 899.5,-105554.54 899.5,-105486.54 1071.5,-105486.54 1071.5,-105554.54"/>
<text text-anchor="middle" x="985.5" y="-105539.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="985.5" y="-105524.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="985.5" y="-105509.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="985.5" y="-105494.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer25_ffn_ar&#45;&gt;layer26_norm_3 -->
<g id="edge843" class="edge">
<title>layer25_ffn_ar&#45;&gt;layer26_norm_3</title>
<path fill="none" stroke="black" d="M950.31,-105635.34C950.31,-105635.34 950.31,-105564.77 950.31,-105564.77"/>
<polygon fill="black" stroke="black" points="953.81,-105564.77 950.31,-105554.77 946.81,-105564.77 953.81,-105564.77"/>
</g>
<!-- layer26_qkv_2 -->
<g id="node663" class="node">
<title>layer26_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="862,-105414.54 681,-105414.54 681,-105346.54 862,-105346.54 862,-105414.54"/>
<text text-anchor="middle" x="771.5" y="-105399.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="771.5" y="-105384.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="771.5" y="-105369.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="771.5" y="-105354.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer26_norm_2&#45;&gt;layer26_qkv_2 -->
<g id="edge844" class="edge">
<title>layer26_norm_2&#45;&gt;layer26_qkv_2</title>
<path fill="none" stroke="black" d="M775.5,-105486.29C775.5,-105486.29 775.5,-105424.92 775.5,-105424.92"/>
<polygon fill="black" stroke="black" points="779,-105424.92 775.5,-105414.92 772,-105424.92 779,-105424.92"/>
</g>
<!-- layer26_qkv_3 -->
<g id="node664" class="node">
<title>layer26_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1079,-105414.54 898,-105414.54 898,-105346.54 1079,-105346.54 1079,-105414.54"/>
<text text-anchor="middle" x="988.5" y="-105399.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="988.5" y="-105384.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="988.5" y="-105369.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-105354.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer26_norm_3&#45;&gt;layer26_qkv_3 -->
<g id="edge845" class="edge">
<title>layer26_norm_3&#45;&gt;layer26_qkv_3</title>
<path fill="none" stroke="black" d="M985.5,-105486.29C985.5,-105486.29 985.5,-105424.92 985.5,-105424.92"/>
<polygon fill="black" stroke="black" points="989,-105424.92 985.5,-105414.92 982,-105424.92 989,-105424.92"/>
</g>
<!-- layer26_qkv_ar -->
<g id="node665" class="node">
<title>layer26_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="879.5" cy="-105226.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="879.5" y="-105245.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="879.5" y="-105230.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="879.5" y="-105215.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="879.5" y="-105200.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer26_qkv_2&#45;&gt;layer26_qkv_ar -->
<g id="edge846" class="edge">
<title>layer26_qkv_2&#45;&gt;layer26_qkv_ar</title>
<path fill="none" stroke="black" d="M806.76,-105346.35C806.76,-105346.35 806.76,-105276.28 806.76,-105276.28"/>
<polygon fill="black" stroke="black" points="810.26,-105276.28 806.76,-105266.28 803.26,-105276.28 810.26,-105276.28"/>
</g>
<!-- layer26_qkv_3&#45;&gt;layer26_qkv_ar -->
<g id="edge847" class="edge">
<title>layer26_qkv_3&#45;&gt;layer26_qkv_ar</title>
<path fill="none" stroke="black" d="M952.74,-105346.35C952.74,-105346.35 952.74,-105276 952.74,-105276"/>
<polygon fill="black" stroke="black" points="956.24,-105276 952.74,-105266 949.24,-105276 956.24,-105276"/>
</g>
<!-- layer26_attn_2 -->
<g id="node666" class="node">
<title>layer26_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="861.5,-105106.38 689.5,-105106.38 689.5,-105038.38 861.5,-105038.38 861.5,-105106.38"/>
<text text-anchor="middle" x="775.5" y="-105091.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="775.5" y="-105076.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="775.5" y="-105061.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="775.5" y="-105046.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer26_qkv_ar&#45;&gt;layer26_attn_2 -->
<g id="edge848" class="edge">
<title>layer26_qkv_ar&#45;&gt;layer26_attn_2</title>
<path fill="none" stroke="black" d="M806.51,-105186.78C806.51,-105186.78 806.51,-105116.43 806.51,-105116.43"/>
<polygon fill="black" stroke="black" points="810.01,-105116.43 806.51,-105106.43 803.01,-105116.43 810.01,-105116.43"/>
</g>
<!-- layer26_attn_3 -->
<g id="node667" class="node">
<title>layer26_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1069.5,-105106.38 897.5,-105106.38 897.5,-105038.38 1069.5,-105038.38 1069.5,-105106.38"/>
<text text-anchor="middle" x="983.5" y="-105091.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="983.5" y="-105076.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="983.5" y="-105061.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="983.5" y="-105046.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer26_qkv_ar&#45;&gt;layer26_attn_3 -->
<g id="edge849" class="edge">
<title>layer26_qkv_ar&#45;&gt;layer26_attn_3</title>
<path fill="none" stroke="black" d="M952.49,-105186.78C952.49,-105186.78 952.49,-105116.43 952.49,-105116.43"/>
<polygon fill="black" stroke="black" points="955.99,-105116.43 952.49,-105106.43 948.99,-105116.43 955.99,-105116.43"/>
</g>
<!-- layer26_attn_out_2 -->
<g id="node668" class="node">
<title>layer26_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="861.5,-104966.38 689.5,-104966.38 689.5,-104898.38 861.5,-104898.38 861.5,-104966.38"/>
<text text-anchor="middle" x="775.5" y="-104951.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="775.5" y="-104936.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="775.5" y="-104921.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="775.5" y="-104906.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer26_attn_2&#45;&gt;layer26_attn_out_2 -->
<g id="edge850" class="edge">
<title>layer26_attn_2&#45;&gt;layer26_attn_out_2</title>
<path fill="none" stroke="black" d="M775.5,-105038.13C775.5,-105038.13 775.5,-104976.75 775.5,-104976.75"/>
<polygon fill="black" stroke="black" points="779,-104976.75 775.5,-104966.75 772,-104976.75 779,-104976.75"/>
</g>
<!-- layer26_attn_out_3 -->
<g id="node669" class="node">
<title>layer26_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1069.5,-104966.38 897.5,-104966.38 897.5,-104898.38 1069.5,-104898.38 1069.5,-104966.38"/>
<text text-anchor="middle" x="983.5" y="-104951.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="983.5" y="-104936.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="983.5" y="-104921.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="983.5" y="-104906.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer26_attn_3&#45;&gt;layer26_attn_out_3 -->
<g id="edge851" class="edge">
<title>layer26_attn_3&#45;&gt;layer26_attn_out_3</title>
<path fill="none" stroke="black" d="M983.5,-105038.13C983.5,-105038.13 983.5,-104976.75 983.5,-104976.75"/>
<polygon fill="black" stroke="black" points="987,-104976.75 983.5,-104966.75 980,-104976.75 987,-104976.75"/>
</g>
<!-- layer26_attn_ar -->
<g id="node670" class="node">
<title>layer26_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="879.5" cy="-104778.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="879.5" y="-104797.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="879.5" y="-104782.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="879.5" y="-104767.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="879.5" y="-104752.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer26_attn_out_2&#45;&gt;layer26_attn_ar -->
<g id="edge852" class="edge">
<title>layer26_attn_out_2&#45;&gt;layer26_attn_ar</title>
<path fill="none" stroke="black" d="M809.69,-104898.18C809.69,-104898.18 809.69,-104827.83 809.69,-104827.83"/>
<polygon fill="black" stroke="black" points="813.19,-104827.83 809.69,-104817.83 806.19,-104827.83 813.19,-104827.83"/>
</g>
<!-- layer26_attn_out_3&#45;&gt;layer26_attn_ar -->
<g id="edge853" class="edge">
<title>layer26_attn_out_3&#45;&gt;layer26_attn_ar</title>
<path fill="none" stroke="black" d="M949.31,-104898.18C949.31,-104898.18 949.31,-104827.83 949.31,-104827.83"/>
<polygon fill="black" stroke="black" points="952.81,-104827.83 949.31,-104817.83 945.81,-104827.83 952.81,-104827.83"/>
</g>
<!-- layer26_ffn_norm_2 -->
<g id="node671" class="node">
<title>layer26_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="857.5,-104658.21 685.5,-104658.21 685.5,-104590.21 857.5,-104590.21 857.5,-104658.21"/>
<text text-anchor="middle" x="771.5" y="-104643.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="771.5" y="-104628.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="771.5" y="-104613.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="771.5" y="-104598.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer26_attn_ar&#45;&gt;layer26_ffn_norm_2 -->
<g id="edge854" class="edge">
<title>layer26_attn_ar&#45;&gt;layer26_ffn_norm_2</title>
<path fill="none" stroke="black" d="M807.69,-104739.41C807.69,-104739.41 807.69,-104668.36 807.69,-104668.36"/>
<polygon fill="black" stroke="black" points="811.19,-104668.36 807.69,-104658.36 804.19,-104668.36 811.19,-104668.36"/>
</g>
<!-- layer26_ffn_norm_3 -->
<g id="node672" class="node">
<title>layer26_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1074.5,-104658.21 902.5,-104658.21 902.5,-104590.21 1074.5,-104590.21 1074.5,-104658.21"/>
<text text-anchor="middle" x="988.5" y="-104643.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="988.5" y="-104628.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="988.5" y="-104613.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-104598.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer26_attn_ar&#45;&gt;layer26_ffn_norm_3 -->
<g id="edge855" class="edge">
<title>layer26_attn_ar&#45;&gt;layer26_ffn_norm_3</title>
<path fill="none" stroke="black" d="M951.81,-104739.41C951.81,-104739.41 951.81,-104668.36 951.81,-104668.36"/>
<polygon fill="black" stroke="black" points="955.31,-104668.36 951.81,-104658.36 948.31,-104668.36 955.31,-104668.36"/>
</g>
<!-- layer26_ffn_gate_2 -->
<g id="node673" class="node">
<title>layer26_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="862,-104518.21 681,-104518.21 681,-104450.21 862,-104450.21 862,-104518.21"/>
<text text-anchor="middle" x="771.5" y="-104503.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="771.5" y="-104488.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="771.5" y="-104473.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="771.5" y="-104458.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_ffn_norm_2&#45;&gt;layer26_ffn_gate_2 -->
<g id="edge856" class="edge">
<title>layer26_ffn_norm_2&#45;&gt;layer26_ffn_gate_2</title>
<path fill="none" stroke="black" d="M771.5,-104589.96C771.5,-104589.96 771.5,-104528.59 771.5,-104528.59"/>
<polygon fill="black" stroke="black" points="775,-104528.59 771.5,-104518.59 768,-104528.59 775,-104528.59"/>
</g>
<!-- layer26_ffn_up_2 -->
<g id="node675" class="node">
<title>layer26_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="645,-104518.21 464,-104518.21 464,-104450.21 645,-104450.21 645,-104518.21"/>
<text text-anchor="middle" x="554.5" y="-104503.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="554.5" y="-104488.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="554.5" y="-104473.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="554.5" y="-104458.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_ffn_norm_2&#45;&gt;layer26_ffn_up_2 -->
<g id="edge858" class="edge">
<title>layer26_ffn_norm_2&#45;&gt;layer26_ffn_up_2</title>
<path fill="none" stroke="black" d="M685.31,-104624C645.86,-104624 607.76,-104624 607.76,-104624 607.76,-104624 607.76,-104528.41 607.76,-104528.41"/>
<polygon fill="black" stroke="black" points="611.26,-104528.41 607.76,-104518.41 604.26,-104528.41 611.26,-104528.41"/>
</g>
<!-- layer26_ffn_gate_3 -->
<g id="node674" class="node">
<title>layer26_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1296,-104518.21 1115,-104518.21 1115,-104450.21 1296,-104450.21 1296,-104518.21"/>
<text text-anchor="middle" x="1205.5" y="-104503.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1205.5" y="-104488.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1205.5" y="-104473.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1205.5" y="-104458.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_ffn_norm_3&#45;&gt;layer26_ffn_gate_3 -->
<g id="edge857" class="edge">
<title>layer26_ffn_norm_3&#45;&gt;layer26_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1074.56,-104624C1113.95,-104624 1152,-104624 1152,-104624 1152,-104624 1152,-104528.41 1152,-104528.41"/>
<polygon fill="black" stroke="black" points="1155.5,-104528.41 1152,-104518.41 1148.5,-104528.41 1155.5,-104528.41"/>
</g>
<!-- layer26_ffn_up_3 -->
<g id="node676" class="node">
<title>layer26_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1079,-104518.21 898,-104518.21 898,-104450.21 1079,-104450.21 1079,-104518.21"/>
<text text-anchor="middle" x="988.5" y="-104503.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="988.5" y="-104488.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="988.5" y="-104473.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-104458.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_ffn_norm_3&#45;&gt;layer26_ffn_up_3 -->
<g id="edge859" class="edge">
<title>layer26_ffn_norm_3&#45;&gt;layer26_ffn_up_3</title>
<path fill="none" stroke="black" d="M988.5,-104589.96C988.5,-104589.96 988.5,-104528.59 988.5,-104528.59"/>
<polygon fill="black" stroke="black" points="992,-104528.59 988.5,-104518.59 985,-104528.59 992,-104528.59"/>
</g>
<!-- layer26_gate_ar -->
<g id="node677" class="node">
<title>layer26_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1079.5" cy="-104330.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1079.5" y="-104348.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1079.5" y="-104333.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1079.5" y="-104318.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1079.5" y="-104303.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer26_ffn_gate_2&#45;&gt;layer26_gate_ar -->
<g id="edge860" class="edge">
<title>layer26_ffn_gate_2&#45;&gt;layer26_gate_ar</title>
<path fill="none" stroke="black" d="M862.08,-104484C872.79,-104484 880,-104484 880,-104484 880,-104484 880,-104346 880,-104346 880,-104346 948.56,-104346 948.56,-104346"/>
<polygon fill="black" stroke="black" points="948.56,-104349.5 958.56,-104346 948.56,-104342.5 948.56,-104349.5"/>
</g>
<!-- layer26_ffn_gate_3&#45;&gt;layer26_gate_ar -->
<g id="edge861" class="edge">
<title>layer26_ffn_gate_3&#45;&gt;layer26_gate_ar</title>
<path fill="none" stroke="black" d="M1161.24,-104450.01C1161.24,-104450.01 1161.24,-104377.19 1161.24,-104377.19"/>
<polygon fill="black" stroke="black" points="1164.74,-104377.19 1161.24,-104367.19 1157.74,-104377.19 1164.74,-104377.19"/>
</g>
<!-- layer26_up_ar -->
<g id="node678" class="node">
<title>layer26_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="733.5" cy="-104330.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="733.5" y="-104348.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="733.5" y="-104333.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="733.5" y="-104318.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="733.5" y="-104303.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer26_ffn_up_2&#45;&gt;layer26_up_ar -->
<g id="edge862" class="edge">
<title>layer26_ffn_up_2&#45;&gt;layer26_up_ar</title>
<path fill="none" stroke="black" d="M625.26,-104450.01C625.26,-104450.01 625.26,-104366.09 625.26,-104366.09"/>
<polygon fill="black" stroke="black" points="628.76,-104366.09 625.26,-104356.09 621.76,-104366.09 628.76,-104366.09"/>
</g>
<!-- layer26_ffn_up_3&#45;&gt;layer26_up_ar -->
<g id="edge863" class="edge">
<title>layer26_ffn_up_3&#45;&gt;layer26_up_ar</title>
<path fill="none" stroke="black" d="M924.76,-104450.17C924.76,-104400.5 924.76,-104314 924.76,-104314 924.76,-104314 864.08,-104314 864.08,-104314"/>
<polygon fill="black" stroke="black" points="864.08,-104310.5 854.08,-104314 864.08,-104317.5 864.08,-104310.5"/>
</g>
<!-- layer26_silu_2 -->
<g id="node679" class="node">
<title>layer26_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1007,-104210.04 826,-104210.04 826,-104142.04 1007,-104142.04 1007,-104210.04"/>
<text text-anchor="middle" x="916.5" y="-104194.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="916.5" y="-104179.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="916.5" y="-104164.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="916.5" y="-104149.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_gate_ar&#45;&gt;layer26_silu_2 -->
<g id="edge864" class="edge">
<title>layer26_gate_ar&#45;&gt;layer26_silu_2</title>
<path fill="none" stroke="black" d="M979.26,-104300.05C979.26,-104300.05 979.26,-104220.06 979.26,-104220.06"/>
<polygon fill="black" stroke="black" points="982.76,-104220.06 979.26,-104210.06 975.76,-104220.06 982.76,-104220.06"/>
</g>
<!-- layer26_silu_3 -->
<g id="node680" class="node">
<title>layer26_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1224,-104210.04 1043,-104210.04 1043,-104142.04 1224,-104142.04 1224,-104210.04"/>
<text text-anchor="middle" x="1133.5" y="-104194.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1133.5" y="-104179.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1133.5" y="-104164.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1133.5" y="-104149.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_gate_ar&#45;&gt;layer26_silu_3 -->
<g id="edge865" class="edge">
<title>layer26_gate_ar&#45;&gt;layer26_silu_3</title>
<path fill="none" stroke="black" d="M1125.24,-104285.14C1125.24,-104285.14 1125.24,-104220.05 1125.24,-104220.05"/>
<polygon fill="black" stroke="black" points="1128.74,-104220.05 1125.24,-104210.05 1121.74,-104220.05 1128.74,-104220.05"/>
</g>
<!-- layer26_mul_2 -->
<g id="node681" class="node">
<title>layer26_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="897,-104070.04 716,-104070.04 716,-104002.04 897,-104002.04 897,-104070.04"/>
<text text-anchor="middle" x="806.5" y="-104054.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="806.5" y="-104039.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="806.5" y="-104024.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="806.5" y="-104009.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_up_ar&#45;&gt;layer26_mul_2 -->
<g id="edge867" class="edge">
<title>layer26_up_ar&#45;&gt;layer26_mul_2</title>
<path fill="none" stroke="black" d="M771,-104283.85C771,-104283.85 771,-104080.13 771,-104080.13"/>
<polygon fill="black" stroke="black" points="774.5,-104080.13 771,-104070.13 767.5,-104080.13 774.5,-104080.13"/>
</g>
<!-- layer26_mul_3 -->
<g id="node682" class="node">
<title>layer26_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1114,-104070.04 933,-104070.04 933,-104002.04 1114,-104002.04 1114,-104070.04"/>
<text text-anchor="middle" x="1023.5" y="-104054.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1023.5" y="-104039.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1023.5" y="-104024.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1023.5" y="-104009.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer26_up_ar&#45;&gt;layer26_mul_3 -->
<g id="edge869" class="edge">
<title>layer26_up_ar&#45;&gt;layer26_mul_3</title>
<path fill="none" stroke="black" d="M843.74,-104305.34C843.74,-104280.53 843.74,-104246 843.74,-104246 843.74,-104246 1025,-104246 1025,-104246 1025,-104246 1025,-104080.24 1025,-104080.24"/>
<polygon fill="black" stroke="black" points="1028.5,-104080.24 1025,-104070.24 1021.5,-104080.24 1028.5,-104080.24"/>
</g>
<!-- layer26_silu_2&#45;&gt;layer26_mul_2 -->
<g id="edge866" class="edge">
<title>layer26_silu_2&#45;&gt;layer26_mul_2</title>
<path fill="none" stroke="black" d="M861.5,-104141.79C861.5,-104141.79 861.5,-104080.42 861.5,-104080.42"/>
<polygon fill="black" stroke="black" points="865,-104080.42 861.5,-104070.42 858,-104080.42 865,-104080.42"/>
</g>
<!-- layer26_silu_3&#45;&gt;layer26_mul_3 -->
<g id="edge868" class="edge">
<title>layer26_silu_3&#45;&gt;layer26_mul_3</title>
<path fill="none" stroke="black" d="M1078.5,-104141.79C1078.5,-104141.79 1078.5,-104080.42 1078.5,-104080.42"/>
<polygon fill="black" stroke="black" points="1082,-104080.42 1078.5,-104070.42 1075,-104080.42 1082,-104080.42"/>
</g>
<!-- layer26_ffn_down_2 -->
<g id="node683" class="node">
<title>layer26_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="896.5,-103930.04 724.5,-103930.04 724.5,-103862.04 896.5,-103862.04 896.5,-103930.04"/>
<text text-anchor="middle" x="810.5" y="-103914.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="810.5" y="-103899.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="810.5" y="-103884.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="810.5" y="-103869.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer26_mul_2&#45;&gt;layer26_ffn_down_2 -->
<g id="edge870" class="edge">
<title>layer26_mul_2&#45;&gt;layer26_ffn_down_2</title>
<path fill="none" stroke="black" d="M810.5,-104001.79C810.5,-104001.79 810.5,-103940.42 810.5,-103940.42"/>
<polygon fill="black" stroke="black" points="814,-103940.42 810.5,-103930.42 807,-103940.42 814,-103940.42"/>
</g>
<!-- layer26_ffn_down_3 -->
<g id="node684" class="node">
<title>layer26_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1106.5,-103930.04 934.5,-103930.04 934.5,-103862.04 1106.5,-103862.04 1106.5,-103930.04"/>
<text text-anchor="middle" x="1020.5" y="-103914.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1020.5" y="-103899.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1020.5" y="-103884.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1020.5" y="-103869.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer26_mul_3&#45;&gt;layer26_ffn_down_3 -->
<g id="edge871" class="edge">
<title>layer26_mul_3&#45;&gt;layer26_ffn_down_3</title>
<path fill="none" stroke="black" d="M1020.5,-104001.79C1020.5,-104001.79 1020.5,-103940.42 1020.5,-103940.42"/>
<polygon fill="black" stroke="black" points="1024,-103940.42 1020.5,-103930.42 1017,-103940.42 1024,-103940.42"/>
</g>
<!-- layer26_ffn_ar -->
<g id="node685" class="node">
<title>layer26_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="914.5" cy="-103741.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="914.5" y="-103760.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="914.5" y="-103745.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="914.5" y="-103730.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="914.5" y="-103715.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer26_ffn_down_2&#45;&gt;layer26_ffn_ar -->
<g id="edge872" class="edge">
<title>layer26_ffn_down_2&#45;&gt;layer26_ffn_ar</title>
<path fill="none" stroke="black" d="M844.69,-103861.85C844.69,-103861.85 844.69,-103791.5 844.69,-103791.5"/>
<polygon fill="black" stroke="black" points="848.19,-103791.5 844.69,-103781.5 841.19,-103791.5 848.19,-103791.5"/>
</g>
<!-- layer26_ffn_down_3&#45;&gt;layer26_ffn_ar -->
<g id="edge873" class="edge">
<title>layer26_ffn_down_3&#45;&gt;layer26_ffn_ar</title>
<path fill="none" stroke="black" d="M985.31,-103861.85C985.31,-103861.85 985.31,-103791.22 985.31,-103791.22"/>
<polygon fill="black" stroke="black" points="988.81,-103791.22 985.31,-103781.22 981.81,-103791.22 988.81,-103791.22"/>
</g>
<!-- layer27_norm_2 -->
<g id="node686" class="node">
<title>layer27_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="896.5,-103621.88 724.5,-103621.88 724.5,-103553.88 896.5,-103553.88 896.5,-103621.88"/>
<text text-anchor="middle" x="810.5" y="-103606.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="810.5" y="-103591.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="810.5" y="-103576.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="810.5" y="-103561.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer26_ffn_ar&#45;&gt;layer27_norm_2 -->
<g id="edge874" class="edge">
<title>layer26_ffn_ar&#45;&gt;layer27_norm_2</title>
<path fill="none" stroke="black" d="M844.69,-103702.28C844.69,-103702.28 844.69,-103631.93 844.69,-103631.93"/>
<polygon fill="black" stroke="black" points="848.19,-103631.93 844.69,-103621.93 841.19,-103631.93 848.19,-103631.93"/>
</g>
<!-- layer27_norm_3 -->
<g id="node687" class="node">
<title>layer27_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1106.5,-103621.88 934.5,-103621.88 934.5,-103553.88 1106.5,-103553.88 1106.5,-103621.88"/>
<text text-anchor="middle" x="1020.5" y="-103606.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1020.5" y="-103591.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1020.5" y="-103576.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1020.5" y="-103561.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer26_ffn_ar&#45;&gt;layer27_norm_3 -->
<g id="edge875" class="edge">
<title>layer26_ffn_ar&#45;&gt;layer27_norm_3</title>
<path fill="none" stroke="black" d="M985.31,-103702.68C985.31,-103702.68 985.31,-103632.11 985.31,-103632.11"/>
<polygon fill="black" stroke="black" points="988.81,-103632.11 985.31,-103622.11 981.81,-103632.11 988.81,-103632.11"/>
</g>
<!-- layer27_qkv_2 -->
<g id="node688" class="node">
<title>layer27_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="897,-103481.88 716,-103481.88 716,-103413.88 897,-103413.88 897,-103481.88"/>
<text text-anchor="middle" x="806.5" y="-103466.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="806.5" y="-103451.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="806.5" y="-103436.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="806.5" y="-103421.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer27_norm_2&#45;&gt;layer27_qkv_2 -->
<g id="edge876" class="edge">
<title>layer27_norm_2&#45;&gt;layer27_qkv_2</title>
<path fill="none" stroke="black" d="M810.5,-103553.63C810.5,-103553.63 810.5,-103492.25 810.5,-103492.25"/>
<polygon fill="black" stroke="black" points="814,-103492.25 810.5,-103482.25 807,-103492.25 814,-103492.25"/>
</g>
<!-- layer27_qkv_3 -->
<g id="node689" class="node">
<title>layer27_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1114,-103481.88 933,-103481.88 933,-103413.88 1114,-103413.88 1114,-103481.88"/>
<text text-anchor="middle" x="1023.5" y="-103466.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1023.5" y="-103451.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1023.5" y="-103436.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1023.5" y="-103421.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer27_norm_3&#45;&gt;layer27_qkv_3 -->
<g id="edge877" class="edge">
<title>layer27_norm_3&#45;&gt;layer27_qkv_3</title>
<path fill="none" stroke="black" d="M1020.5,-103553.63C1020.5,-103553.63 1020.5,-103492.25 1020.5,-103492.25"/>
<polygon fill="black" stroke="black" points="1024,-103492.25 1020.5,-103482.25 1017,-103492.25 1024,-103492.25"/>
</g>
<!-- layer27_qkv_ar -->
<g id="node690" class="node">
<title>layer27_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="914.5" cy="-103293.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="914.5" y="-103312.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="914.5" y="-103297.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="914.5" y="-103282.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="914.5" y="-103267.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer27_qkv_2&#45;&gt;layer27_qkv_ar -->
<g id="edge878" class="edge">
<title>layer27_qkv_2&#45;&gt;layer27_qkv_ar</title>
<path fill="none" stroke="black" d="M841.76,-103413.68C841.76,-103413.68 841.76,-103343.61 841.76,-103343.61"/>
<polygon fill="black" stroke="black" points="845.26,-103343.61 841.76,-103333.61 838.26,-103343.61 845.26,-103343.61"/>
</g>
<!-- layer27_qkv_3&#45;&gt;layer27_qkv_ar -->
<g id="edge879" class="edge">
<title>layer27_qkv_3&#45;&gt;layer27_qkv_ar</title>
<path fill="none" stroke="black" d="M987.74,-103413.68C987.74,-103413.68 987.74,-103343.33 987.74,-103343.33"/>
<polygon fill="black" stroke="black" points="991.24,-103343.33 987.74,-103333.33 984.24,-103343.33 991.24,-103343.33"/>
</g>
<!-- layer27_attn_2 -->
<g id="node691" class="node">
<title>layer27_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="896.5,-103173.71 724.5,-103173.71 724.5,-103105.71 896.5,-103105.71 896.5,-103173.71"/>
<text text-anchor="middle" x="810.5" y="-103158.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="810.5" y="-103143.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="810.5" y="-103128.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="810.5" y="-103113.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer27_qkv_ar&#45;&gt;layer27_attn_2 -->
<g id="edge880" class="edge">
<title>layer27_qkv_ar&#45;&gt;layer27_attn_2</title>
<path fill="none" stroke="black" d="M841.51,-103254.11C841.51,-103254.11 841.51,-103183.77 841.51,-103183.77"/>
<polygon fill="black" stroke="black" points="845.01,-103183.77 841.51,-103173.77 838.01,-103183.77 845.01,-103183.77"/>
</g>
<!-- layer27_attn_3 -->
<g id="node692" class="node">
<title>layer27_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1104.5,-103173.71 932.5,-103173.71 932.5,-103105.71 1104.5,-103105.71 1104.5,-103173.71"/>
<text text-anchor="middle" x="1018.5" y="-103158.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1018.5" y="-103143.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1018.5" y="-103128.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1018.5" y="-103113.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer27_qkv_ar&#45;&gt;layer27_attn_3 -->
<g id="edge881" class="edge">
<title>layer27_qkv_ar&#45;&gt;layer27_attn_3</title>
<path fill="none" stroke="black" d="M987.49,-103254.11C987.49,-103254.11 987.49,-103183.77 987.49,-103183.77"/>
<polygon fill="black" stroke="black" points="990.99,-103183.77 987.49,-103173.77 983.99,-103183.77 990.99,-103183.77"/>
</g>
<!-- layer27_attn_out_2 -->
<g id="node693" class="node">
<title>layer27_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="896.5,-103033.71 724.5,-103033.71 724.5,-102965.71 896.5,-102965.71 896.5,-103033.71"/>
<text text-anchor="middle" x="810.5" y="-103018.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="810.5" y="-103003.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="810.5" y="-102988.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="810.5" y="-102973.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer27_attn_2&#45;&gt;layer27_attn_out_2 -->
<g id="edge882" class="edge">
<title>layer27_attn_2&#45;&gt;layer27_attn_out_2</title>
<path fill="none" stroke="black" d="M810.5,-103105.46C810.5,-103105.46 810.5,-103044.09 810.5,-103044.09"/>
<polygon fill="black" stroke="black" points="814,-103044.09 810.5,-103034.09 807,-103044.09 814,-103044.09"/>
</g>
<!-- layer27_attn_out_3 -->
<g id="node694" class="node">
<title>layer27_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1104.5,-103033.71 932.5,-103033.71 932.5,-102965.71 1104.5,-102965.71 1104.5,-103033.71"/>
<text text-anchor="middle" x="1018.5" y="-103018.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1018.5" y="-103003.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1018.5" y="-102988.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1018.5" y="-102973.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer27_attn_3&#45;&gt;layer27_attn_out_3 -->
<g id="edge883" class="edge">
<title>layer27_attn_3&#45;&gt;layer27_attn_out_3</title>
<path fill="none" stroke="black" d="M1018.5,-103105.46C1018.5,-103105.46 1018.5,-103044.09 1018.5,-103044.09"/>
<polygon fill="black" stroke="black" points="1022,-103044.09 1018.5,-103034.09 1015,-103044.09 1022,-103044.09"/>
</g>
<!-- layer27_attn_ar -->
<g id="node695" class="node">
<title>layer27_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="914.5" cy="-102845.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="914.5" y="-102864.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="914.5" y="-102849.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="914.5" y="-102834.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="914.5" y="-102819.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer27_attn_out_2&#45;&gt;layer27_attn_ar -->
<g id="edge884" class="edge">
<title>layer27_attn_out_2&#45;&gt;layer27_attn_ar</title>
<path fill="none" stroke="black" d="M844.69,-102965.51C844.69,-102965.51 844.69,-102895.17 844.69,-102895.17"/>
<polygon fill="black" stroke="black" points="848.19,-102895.17 844.69,-102885.17 841.19,-102895.17 848.19,-102895.17"/>
</g>
<!-- layer27_attn_out_3&#45;&gt;layer27_attn_ar -->
<g id="edge885" class="edge">
<title>layer27_attn_out_3&#45;&gt;layer27_attn_ar</title>
<path fill="none" stroke="black" d="M984.31,-102965.51C984.31,-102965.51 984.31,-102895.17 984.31,-102895.17"/>
<polygon fill="black" stroke="black" points="987.81,-102895.17 984.31,-102885.17 980.81,-102895.17 987.81,-102895.17"/>
</g>
<!-- layer27_ffn_norm_2 -->
<g id="node696" class="node">
<title>layer27_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="892.5,-102725.54 720.5,-102725.54 720.5,-102657.54 892.5,-102657.54 892.5,-102725.54"/>
<text text-anchor="middle" x="806.5" y="-102710.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="806.5" y="-102695.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="806.5" y="-102680.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="806.5" y="-102665.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer27_attn_ar&#45;&gt;layer27_ffn_norm_2 -->
<g id="edge886" class="edge">
<title>layer27_attn_ar&#45;&gt;layer27_ffn_norm_2</title>
<path fill="none" stroke="black" d="M842.69,-102806.74C842.69,-102806.74 842.69,-102735.69 842.69,-102735.69"/>
<polygon fill="black" stroke="black" points="846.19,-102735.69 842.69,-102725.69 839.19,-102735.69 846.19,-102735.69"/>
</g>
<!-- layer27_ffn_norm_3 -->
<g id="node697" class="node">
<title>layer27_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1109.5,-102725.54 937.5,-102725.54 937.5,-102657.54 1109.5,-102657.54 1109.5,-102725.54"/>
<text text-anchor="middle" x="1023.5" y="-102710.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1023.5" y="-102695.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1023.5" y="-102680.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1023.5" y="-102665.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer27_attn_ar&#45;&gt;layer27_ffn_norm_3 -->
<g id="edge887" class="edge">
<title>layer27_attn_ar&#45;&gt;layer27_ffn_norm_3</title>
<path fill="none" stroke="black" d="M986.81,-102806.74C986.81,-102806.74 986.81,-102735.69 986.81,-102735.69"/>
<polygon fill="black" stroke="black" points="990.31,-102735.69 986.81,-102725.69 983.31,-102735.69 990.31,-102735.69"/>
</g>
<!-- layer27_ffn_gate_2 -->
<g id="node698" class="node">
<title>layer27_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="897,-102585.54 716,-102585.54 716,-102517.54 897,-102517.54 897,-102585.54"/>
<text text-anchor="middle" x="806.5" y="-102570.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="806.5" y="-102555.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="806.5" y="-102540.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="806.5" y="-102525.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_ffn_norm_2&#45;&gt;layer27_ffn_gate_2 -->
<g id="edge888" class="edge">
<title>layer27_ffn_norm_2&#45;&gt;layer27_ffn_gate_2</title>
<path fill="none" stroke="black" d="M806.5,-102657.29C806.5,-102657.29 806.5,-102595.92 806.5,-102595.92"/>
<polygon fill="black" stroke="black" points="810,-102595.92 806.5,-102585.92 803,-102595.92 810,-102595.92"/>
</g>
<!-- layer27_ffn_up_2 -->
<g id="node700" class="node">
<title>layer27_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="680,-102585.54 499,-102585.54 499,-102517.54 680,-102517.54 680,-102585.54"/>
<text text-anchor="middle" x="589.5" y="-102570.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="589.5" y="-102555.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="589.5" y="-102540.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="589.5" y="-102525.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_ffn_norm_2&#45;&gt;layer27_ffn_up_2 -->
<g id="edge890" class="edge">
<title>layer27_ffn_norm_2&#45;&gt;layer27_ffn_up_2</title>
<path fill="none" stroke="black" d="M720.31,-102691C680.86,-102691 642.76,-102691 642.76,-102691 642.76,-102691 642.76,-102595.66 642.76,-102595.66"/>
<polygon fill="black" stroke="black" points="646.26,-102595.66 642.76,-102585.66 639.26,-102595.66 646.26,-102595.66"/>
</g>
<!-- layer27_ffn_gate_3 -->
<g id="node699" class="node">
<title>layer27_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1331,-102585.54 1150,-102585.54 1150,-102517.54 1331,-102517.54 1331,-102585.54"/>
<text text-anchor="middle" x="1240.5" y="-102570.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1240.5" y="-102555.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1240.5" y="-102540.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1240.5" y="-102525.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_ffn_norm_3&#45;&gt;layer27_ffn_gate_3 -->
<g id="edge889" class="edge">
<title>layer27_ffn_norm_3&#45;&gt;layer27_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1109.56,-102691C1148.95,-102691 1187,-102691 1187,-102691 1187,-102691 1187,-102595.66 1187,-102595.66"/>
<polygon fill="black" stroke="black" points="1190.5,-102595.66 1187,-102585.66 1183.5,-102595.66 1190.5,-102595.66"/>
</g>
<!-- layer27_ffn_up_3 -->
<g id="node701" class="node">
<title>layer27_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1114,-102585.54 933,-102585.54 933,-102517.54 1114,-102517.54 1114,-102585.54"/>
<text text-anchor="middle" x="1023.5" y="-102570.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1023.5" y="-102555.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1023.5" y="-102540.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1023.5" y="-102525.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_ffn_norm_3&#45;&gt;layer27_ffn_up_3 -->
<g id="edge891" class="edge">
<title>layer27_ffn_norm_3&#45;&gt;layer27_ffn_up_3</title>
<path fill="none" stroke="black" d="M1023.5,-102657.29C1023.5,-102657.29 1023.5,-102595.92 1023.5,-102595.92"/>
<polygon fill="black" stroke="black" points="1027,-102595.92 1023.5,-102585.92 1020,-102595.92 1027,-102595.92"/>
</g>
<!-- layer27_gate_ar -->
<g id="node702" class="node">
<title>layer27_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1114.5" cy="-102397.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1114.5" y="-102416.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1114.5" y="-102401.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1114.5" y="-102386.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1114.5" y="-102371.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer27_ffn_gate_2&#45;&gt;layer27_gate_ar -->
<g id="edge892" class="edge">
<title>layer27_ffn_gate_2&#45;&gt;layer27_gate_ar</title>
<path fill="none" stroke="black" d="M897.08,-102551C907.79,-102551 915,-102551 915,-102551 915,-102551 915,-102413 915,-102413 915,-102413 983.28,-102413 983.28,-102413"/>
<polygon fill="black" stroke="black" points="983.28,-102416.5 993.28,-102413 983.28,-102409.5 983.28,-102416.5"/>
</g>
<!-- layer27_ffn_gate_3&#45;&gt;layer27_gate_ar -->
<g id="edge893" class="edge">
<title>layer27_ffn_gate_3&#45;&gt;layer27_gate_ar</title>
<path fill="none" stroke="black" d="M1196.24,-102517.35C1196.24,-102517.35 1196.24,-102444.52 1196.24,-102444.52"/>
<polygon fill="black" stroke="black" points="1199.74,-102444.52 1196.24,-102434.52 1192.74,-102444.52 1199.74,-102444.52"/>
</g>
<!-- layer27_up_ar -->
<g id="node703" class="node">
<title>layer27_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="768.5" cy="-102397.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="768.5" y="-102416.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="768.5" y="-102401.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="768.5" y="-102386.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="768.5" y="-102371.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer27_ffn_up_2&#45;&gt;layer27_up_ar -->
<g id="edge894" class="edge">
<title>layer27_ffn_up_2&#45;&gt;layer27_up_ar</title>
<path fill="none" stroke="black" d="M660.26,-102517.35C660.26,-102517.35 660.26,-102433.42 660.26,-102433.42"/>
<polygon fill="black" stroke="black" points="663.76,-102433.42 660.26,-102423.42 656.76,-102433.42 663.76,-102433.42"/>
</g>
<!-- layer27_ffn_up_3&#45;&gt;layer27_up_ar -->
<g id="edge895" class="edge">
<title>layer27_ffn_up_3&#45;&gt;layer27_up_ar</title>
<path fill="none" stroke="black" d="M959.76,-102517.44C959.76,-102467.67 959.76,-102381 959.76,-102381 959.76,-102381 898.81,-102381 898.81,-102381"/>
<polygon fill="black" stroke="black" points="898.81,-102377.5 888.81,-102381 898.81,-102384.5 898.81,-102377.5"/>
</g>
<!-- layer27_silu_2 -->
<g id="node704" class="node">
<title>layer27_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1042,-102277.38 861,-102277.38 861,-102209.38 1042,-102209.38 1042,-102277.38"/>
<text text-anchor="middle" x="951.5" y="-102262.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="951.5" y="-102247.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="951.5" y="-102232.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="951.5" y="-102217.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_gate_ar&#45;&gt;layer27_silu_2 -->
<g id="edge896" class="edge">
<title>layer27_gate_ar&#45;&gt;layer27_silu_2</title>
<path fill="none" stroke="black" d="M1014.26,-102367.38C1014.26,-102367.38 1014.26,-102287.4 1014.26,-102287.4"/>
<polygon fill="black" stroke="black" points="1017.76,-102287.4 1014.26,-102277.4 1010.76,-102287.4 1017.76,-102287.4"/>
</g>
<!-- layer27_silu_3 -->
<g id="node705" class="node">
<title>layer27_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1259,-102277.38 1078,-102277.38 1078,-102209.38 1259,-102209.38 1259,-102277.38"/>
<text text-anchor="middle" x="1168.5" y="-102262.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1168.5" y="-102247.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1168.5" y="-102232.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1168.5" y="-102217.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_gate_ar&#45;&gt;layer27_silu_3 -->
<g id="edge897" class="edge">
<title>layer27_gate_ar&#45;&gt;layer27_silu_3</title>
<path fill="none" stroke="black" d="M1160.24,-102352.48C1160.24,-102352.48 1160.24,-102287.38 1160.24,-102287.38"/>
<polygon fill="black" stroke="black" points="1163.74,-102287.38 1160.24,-102277.38 1156.74,-102287.38 1163.74,-102287.38"/>
</g>
<!-- layer27_mul_2 -->
<g id="node706" class="node">
<title>layer27_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="932,-102137.38 751,-102137.38 751,-102069.38 932,-102069.38 932,-102137.38"/>
<text text-anchor="middle" x="841.5" y="-102122.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="841.5" y="-102107.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="841.5" y="-102092.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="841.5" y="-102077.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_up_ar&#45;&gt;layer27_mul_2 -->
<g id="edge899" class="edge">
<title>layer27_up_ar&#45;&gt;layer27_mul_2</title>
<path fill="none" stroke="black" d="M806,-102351.19C806,-102351.19 806,-102147.46 806,-102147.46"/>
<polygon fill="black" stroke="black" points="809.5,-102147.46 806,-102137.46 802.5,-102147.46 809.5,-102147.46"/>
</g>
<!-- layer27_mul_3 -->
<g id="node707" class="node">
<title>layer27_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1149,-102137.38 968,-102137.38 968,-102069.38 1149,-102069.38 1149,-102137.38"/>
<text text-anchor="middle" x="1058.5" y="-102122.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1058.5" y="-102107.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1058.5" y="-102092.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1058.5" y="-102077.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer27_up_ar&#45;&gt;layer27_mul_3 -->
<g id="edge901" class="edge">
<title>layer27_up_ar&#45;&gt;layer27_mul_3</title>
<path fill="none" stroke="black" d="M878.74,-102373.03C878.74,-102348.09 878.74,-102313 878.74,-102313 878.74,-102313 1060,-102313 1060,-102313 1060,-102313 1060,-102147.52 1060,-102147.52"/>
<polygon fill="black" stroke="black" points="1063.5,-102147.52 1060,-102137.52 1056.5,-102147.52 1063.5,-102147.52"/>
</g>
<!-- layer27_silu_2&#45;&gt;layer27_mul_2 -->
<g id="edge898" class="edge">
<title>layer27_silu_2&#45;&gt;layer27_mul_2</title>
<path fill="none" stroke="black" d="M896.5,-102209.13C896.5,-102209.13 896.5,-102147.76 896.5,-102147.76"/>
<polygon fill="black" stroke="black" points="900,-102147.76 896.5,-102137.76 893,-102147.76 900,-102147.76"/>
</g>
<!-- layer27_silu_3&#45;&gt;layer27_mul_3 -->
<g id="edge900" class="edge">
<title>layer27_silu_3&#45;&gt;layer27_mul_3</title>
<path fill="none" stroke="black" d="M1113.5,-102209.13C1113.5,-102209.13 1113.5,-102147.76 1113.5,-102147.76"/>
<polygon fill="black" stroke="black" points="1117,-102147.76 1113.5,-102137.76 1110,-102147.76 1117,-102147.76"/>
</g>
<!-- layer27_ffn_down_2 -->
<g id="node708" class="node">
<title>layer27_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="931.5,-101997.38 759.5,-101997.38 759.5,-101929.38 931.5,-101929.38 931.5,-101997.38"/>
<text text-anchor="middle" x="845.5" y="-101982.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="845.5" y="-101967.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="845.5" y="-101952.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="845.5" y="-101937.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer27_mul_2&#45;&gt;layer27_ffn_down_2 -->
<g id="edge902" class="edge">
<title>layer27_mul_2&#45;&gt;layer27_ffn_down_2</title>
<path fill="none" stroke="black" d="M845.5,-102069.13C845.5,-102069.13 845.5,-102007.76 845.5,-102007.76"/>
<polygon fill="black" stroke="black" points="849,-102007.76 845.5,-101997.76 842,-102007.76 849,-102007.76"/>
</g>
<!-- layer27_ffn_down_3 -->
<g id="node709" class="node">
<title>layer27_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1141.5,-101997.38 969.5,-101997.38 969.5,-101929.38 1141.5,-101929.38 1141.5,-101997.38"/>
<text text-anchor="middle" x="1055.5" y="-101982.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1055.5" y="-101967.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1055.5" y="-101952.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1055.5" y="-101937.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer27_mul_3&#45;&gt;layer27_ffn_down_3 -->
<g id="edge903" class="edge">
<title>layer27_mul_3&#45;&gt;layer27_ffn_down_3</title>
<path fill="none" stroke="black" d="M1055.5,-102069.13C1055.5,-102069.13 1055.5,-102007.76 1055.5,-102007.76"/>
<polygon fill="black" stroke="black" points="1059,-102007.76 1055.5,-101997.76 1052,-102007.76 1059,-102007.76"/>
</g>
<!-- layer27_ffn_ar -->
<g id="node710" class="node">
<title>layer27_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="949.5" cy="-101809.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="949.5" y="-101828.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="949.5" y="-101813.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="949.5" y="-101798.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="949.5" y="-101783.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer27_ffn_down_2&#45;&gt;layer27_ffn_ar -->
<g id="edge904" class="edge">
<title>layer27_ffn_down_2&#45;&gt;layer27_ffn_ar</title>
<path fill="none" stroke="black" d="M879.69,-101929.18C879.69,-101929.18 879.69,-101858.84 879.69,-101858.84"/>
<polygon fill="black" stroke="black" points="883.19,-101858.84 879.69,-101848.84 876.19,-101858.84 883.19,-101858.84"/>
</g>
<!-- layer27_ffn_down_3&#45;&gt;layer27_ffn_ar -->
<g id="edge905" class="edge">
<title>layer27_ffn_down_3&#45;&gt;layer27_ffn_ar</title>
<path fill="none" stroke="black" d="M1020.31,-101929.18C1020.31,-101929.18 1020.31,-101858.56 1020.31,-101858.56"/>
<polygon fill="black" stroke="black" points="1023.81,-101858.56 1020.31,-101848.56 1016.81,-101858.56 1023.81,-101858.56"/>
</g>
<!-- layer28_norm_2 -->
<g id="node711" class="node">
<title>layer28_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="931.5,-101689.21 759.5,-101689.21 759.5,-101621.21 931.5,-101621.21 931.5,-101689.21"/>
<text text-anchor="middle" x="845.5" y="-101674.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="845.5" y="-101659.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="845.5" y="-101644.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="845.5" y="-101629.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer27_ffn_ar&#45;&gt;layer28_norm_2 -->
<g id="edge906" class="edge">
<title>layer27_ffn_ar&#45;&gt;layer28_norm_2</title>
<path fill="none" stroke="black" d="M879.69,-101769.61C879.69,-101769.61 879.69,-101699.27 879.69,-101699.27"/>
<polygon fill="black" stroke="black" points="883.19,-101699.27 879.69,-101689.27 876.19,-101699.27 883.19,-101699.27"/>
</g>
<!-- layer28_norm_3 -->
<g id="node712" class="node">
<title>layer28_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1141.5,-101689.21 969.5,-101689.21 969.5,-101621.21 1141.5,-101621.21 1141.5,-101689.21"/>
<text text-anchor="middle" x="1055.5" y="-101674.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1055.5" y="-101659.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1055.5" y="-101644.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1055.5" y="-101629.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer27_ffn_ar&#45;&gt;layer28_norm_3 -->
<g id="edge907" class="edge">
<title>layer27_ffn_ar&#45;&gt;layer28_norm_3</title>
<path fill="none" stroke="black" d="M1020.31,-101770.01C1020.31,-101770.01 1020.31,-101699.44 1020.31,-101699.44"/>
<polygon fill="black" stroke="black" points="1023.81,-101699.44 1020.31,-101689.44 1016.81,-101699.44 1023.81,-101699.44"/>
</g>
<!-- layer28_qkv_2 -->
<g id="node713" class="node">
<title>layer28_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="932,-101549.21 751,-101549.21 751,-101481.21 932,-101481.21 932,-101549.21"/>
<text text-anchor="middle" x="841.5" y="-101534.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="841.5" y="-101519.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="841.5" y="-101504.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="841.5" y="-101489.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer28_norm_2&#45;&gt;layer28_qkv_2 -->
<g id="edge908" class="edge">
<title>layer28_norm_2&#45;&gt;layer28_qkv_2</title>
<path fill="none" stroke="black" d="M845.5,-101620.96C845.5,-101620.96 845.5,-101559.59 845.5,-101559.59"/>
<polygon fill="black" stroke="black" points="849,-101559.59 845.5,-101549.59 842,-101559.59 849,-101559.59"/>
</g>
<!-- layer28_qkv_3 -->
<g id="node714" class="node">
<title>layer28_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1149,-101549.21 968,-101549.21 968,-101481.21 1149,-101481.21 1149,-101549.21"/>
<text text-anchor="middle" x="1058.5" y="-101534.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1058.5" y="-101519.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1058.5" y="-101504.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1058.5" y="-101489.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer28_norm_3&#45;&gt;layer28_qkv_3 -->
<g id="edge909" class="edge">
<title>layer28_norm_3&#45;&gt;layer28_qkv_3</title>
<path fill="none" stroke="black" d="M1055.5,-101620.96C1055.5,-101620.96 1055.5,-101559.59 1055.5,-101559.59"/>
<polygon fill="black" stroke="black" points="1059,-101559.59 1055.5,-101549.59 1052,-101559.59 1059,-101559.59"/>
</g>
<!-- layer28_qkv_ar -->
<g id="node715" class="node">
<title>layer28_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="949.5" cy="-101361.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="949.5" y="-101379.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="949.5" y="-101364.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="949.5" y="-101349.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="949.5" y="-101334.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer28_qkv_2&#45;&gt;layer28_qkv_ar -->
<g id="edge910" class="edge">
<title>layer28_qkv_2&#45;&gt;layer28_qkv_ar</title>
<path fill="none" stroke="black" d="M876.76,-101481.01C876.76,-101481.01 876.76,-101410.95 876.76,-101410.95"/>
<polygon fill="black" stroke="black" points="880.26,-101410.95 876.76,-101400.95 873.26,-101410.95 880.26,-101410.95"/>
</g>
<!-- layer28_qkv_3&#45;&gt;layer28_qkv_ar -->
<g id="edge911" class="edge">
<title>layer28_qkv_3&#45;&gt;layer28_qkv_ar</title>
<path fill="none" stroke="black" d="M1022.74,-101481.01C1022.74,-101481.01 1022.74,-101410.67 1022.74,-101410.67"/>
<polygon fill="black" stroke="black" points="1026.24,-101410.67 1022.74,-101400.67 1019.24,-101410.67 1026.24,-101410.67"/>
</g>
<!-- layer28_attn_2 -->
<g id="node716" class="node">
<title>layer28_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="931.5,-101241.04 759.5,-101241.04 759.5,-101173.04 931.5,-101173.04 931.5,-101241.04"/>
<text text-anchor="middle" x="845.5" y="-101225.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="845.5" y="-101210.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="845.5" y="-101195.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="845.5" y="-101180.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer28_qkv_ar&#45;&gt;layer28_attn_2 -->
<g id="edge912" class="edge">
<title>layer28_qkv_ar&#45;&gt;layer28_attn_2</title>
<path fill="none" stroke="black" d="M876.51,-101321.45C876.51,-101321.45 876.51,-101251.1 876.51,-101251.1"/>
<polygon fill="black" stroke="black" points="880.01,-101251.1 876.51,-101241.1 873.01,-101251.1 880.01,-101251.1"/>
</g>
<!-- layer28_attn_3 -->
<g id="node717" class="node">
<title>layer28_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1139.5,-101241.04 967.5,-101241.04 967.5,-101173.04 1139.5,-101173.04 1139.5,-101241.04"/>
<text text-anchor="middle" x="1053.5" y="-101225.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1053.5" y="-101210.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1053.5" y="-101195.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1053.5" y="-101180.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer28_qkv_ar&#45;&gt;layer28_attn_3 -->
<g id="edge913" class="edge">
<title>layer28_qkv_ar&#45;&gt;layer28_attn_3</title>
<path fill="none" stroke="black" d="M1022.49,-101321.45C1022.49,-101321.45 1022.49,-101251.1 1022.49,-101251.1"/>
<polygon fill="black" stroke="black" points="1025.99,-101251.1 1022.49,-101241.1 1018.99,-101251.1 1025.99,-101251.1"/>
</g>
<!-- layer28_attn_out_2 -->
<g id="node718" class="node">
<title>layer28_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="931.5,-101101.04 759.5,-101101.04 759.5,-101033.04 931.5,-101033.04 931.5,-101101.04"/>
<text text-anchor="middle" x="845.5" y="-101085.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="845.5" y="-101070.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="845.5" y="-101055.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="845.5" y="-101040.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer28_attn_2&#45;&gt;layer28_attn_out_2 -->
<g id="edge914" class="edge">
<title>layer28_attn_2&#45;&gt;layer28_attn_out_2</title>
<path fill="none" stroke="black" d="M845.5,-101172.79C845.5,-101172.79 845.5,-101111.42 845.5,-101111.42"/>
<polygon fill="black" stroke="black" points="849,-101111.42 845.5,-101101.42 842,-101111.42 849,-101111.42"/>
</g>
<!-- layer28_attn_out_3 -->
<g id="node719" class="node">
<title>layer28_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1139.5,-101101.04 967.5,-101101.04 967.5,-101033.04 1139.5,-101033.04 1139.5,-101101.04"/>
<text text-anchor="middle" x="1053.5" y="-101085.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1053.5" y="-101070.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1053.5" y="-101055.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1053.5" y="-101040.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer28_attn_3&#45;&gt;layer28_attn_out_3 -->
<g id="edge915" class="edge">
<title>layer28_attn_3&#45;&gt;layer28_attn_out_3</title>
<path fill="none" stroke="black" d="M1053.5,-101172.79C1053.5,-101172.79 1053.5,-101111.42 1053.5,-101111.42"/>
<polygon fill="black" stroke="black" points="1057,-101111.42 1053.5,-101101.42 1050,-101111.42 1057,-101111.42"/>
</g>
<!-- layer28_attn_ar -->
<g id="node720" class="node">
<title>layer28_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="949.5" cy="-100912.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="949.5" y="-100931.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="949.5" y="-100916.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="949.5" y="-100901.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="949.5" y="-100886.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer28_attn_out_2&#45;&gt;layer28_attn_ar -->
<g id="edge916" class="edge">
<title>layer28_attn_out_2&#45;&gt;layer28_attn_ar</title>
<path fill="none" stroke="black" d="M879.69,-101032.85C879.69,-101032.85 879.69,-100962.5 879.69,-100962.5"/>
<polygon fill="black" stroke="black" points="883.19,-100962.5 879.69,-100952.5 876.19,-100962.5 883.19,-100962.5"/>
</g>
<!-- layer28_attn_out_3&#45;&gt;layer28_attn_ar -->
<g id="edge917" class="edge">
<title>layer28_attn_out_3&#45;&gt;layer28_attn_ar</title>
<path fill="none" stroke="black" d="M1019.31,-101032.85C1019.31,-101032.85 1019.31,-100962.5 1019.31,-100962.5"/>
<polygon fill="black" stroke="black" points="1022.81,-100962.5 1019.31,-100952.5 1015.81,-100962.5 1022.81,-100962.5"/>
</g>
<!-- layer28_ffn_norm_2 -->
<g id="node721" class="node">
<title>layer28_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="927.5,-100792.88 755.5,-100792.88 755.5,-100724.88 927.5,-100724.88 927.5,-100792.88"/>
<text text-anchor="middle" x="841.5" y="-100777.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="841.5" y="-100762.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="841.5" y="-100747.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="841.5" y="-100732.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer28_attn_ar&#45;&gt;layer28_ffn_norm_2 -->
<g id="edge918" class="edge">
<title>layer28_attn_ar&#45;&gt;layer28_ffn_norm_2</title>
<path fill="none" stroke="black" d="M877.69,-100874.08C877.69,-100874.08 877.69,-100803.02 877.69,-100803.02"/>
<polygon fill="black" stroke="black" points="881.19,-100803.02 877.69,-100793.02 874.19,-100803.02 881.19,-100803.02"/>
</g>
<!-- layer28_ffn_norm_3 -->
<g id="node722" class="node">
<title>layer28_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1144.5,-100792.88 972.5,-100792.88 972.5,-100724.88 1144.5,-100724.88 1144.5,-100792.88"/>
<text text-anchor="middle" x="1058.5" y="-100777.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1058.5" y="-100762.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1058.5" y="-100747.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1058.5" y="-100732.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer28_attn_ar&#45;&gt;layer28_ffn_norm_3 -->
<g id="edge919" class="edge">
<title>layer28_attn_ar&#45;&gt;layer28_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1021.81,-100874.08C1021.81,-100874.08 1021.81,-100803.02 1021.81,-100803.02"/>
<polygon fill="black" stroke="black" points="1025.31,-100803.02 1021.81,-100793.02 1018.31,-100803.02 1025.31,-100803.02"/>
</g>
<!-- layer28_ffn_gate_2 -->
<g id="node723" class="node">
<title>layer28_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="932,-100652.88 751,-100652.88 751,-100584.88 932,-100584.88 932,-100652.88"/>
<text text-anchor="middle" x="841.5" y="-100637.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="841.5" y="-100622.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="841.5" y="-100607.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="841.5" y="-100592.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_ffn_norm_2&#45;&gt;layer28_ffn_gate_2 -->
<g id="edge920" class="edge">
<title>layer28_ffn_norm_2&#45;&gt;layer28_ffn_gate_2</title>
<path fill="none" stroke="black" d="M841.5,-100724.63C841.5,-100724.63 841.5,-100663.26 841.5,-100663.26"/>
<polygon fill="black" stroke="black" points="845,-100663.26 841.5,-100653.26 838,-100663.26 845,-100663.26"/>
</g>
<!-- layer28_ffn_up_2 -->
<g id="node725" class="node">
<title>layer28_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="715,-100652.88 534,-100652.88 534,-100584.88 715,-100584.88 715,-100652.88"/>
<text text-anchor="middle" x="624.5" y="-100637.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="624.5" y="-100622.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="624.5" y="-100607.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="624.5" y="-100592.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_ffn_norm_2&#45;&gt;layer28_ffn_up_2 -->
<g id="edge922" class="edge">
<title>layer28_ffn_norm_2&#45;&gt;layer28_ffn_up_2</title>
<path fill="none" stroke="black" d="M755.31,-100758C715.86,-100758 677.76,-100758 677.76,-100758 677.76,-100758 677.76,-100662.91 677.76,-100662.91"/>
<polygon fill="black" stroke="black" points="681.26,-100662.91 677.76,-100652.91 674.26,-100662.91 681.26,-100662.91"/>
</g>
<!-- layer28_ffn_gate_3 -->
<g id="node724" class="node">
<title>layer28_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1366,-100652.88 1185,-100652.88 1185,-100584.88 1366,-100584.88 1366,-100652.88"/>
<text text-anchor="middle" x="1275.5" y="-100637.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1275.5" y="-100622.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1275.5" y="-100607.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1275.5" y="-100592.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_ffn_norm_3&#45;&gt;layer28_ffn_gate_3 -->
<g id="edge921" class="edge">
<title>layer28_ffn_norm_3&#45;&gt;layer28_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1144.56,-100758C1183.95,-100758 1222,-100758 1222,-100758 1222,-100758 1222,-100662.91 1222,-100662.91"/>
<polygon fill="black" stroke="black" points="1225.5,-100662.91 1222,-100652.91 1218.5,-100662.91 1225.5,-100662.91"/>
</g>
<!-- layer28_ffn_up_3 -->
<g id="node726" class="node">
<title>layer28_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1149,-100652.88 968,-100652.88 968,-100584.88 1149,-100584.88 1149,-100652.88"/>
<text text-anchor="middle" x="1058.5" y="-100637.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1058.5" y="-100622.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1058.5" y="-100607.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1058.5" y="-100592.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_ffn_norm_3&#45;&gt;layer28_ffn_up_3 -->
<g id="edge923" class="edge">
<title>layer28_ffn_norm_3&#45;&gt;layer28_ffn_up_3</title>
<path fill="none" stroke="black" d="M1058.5,-100724.63C1058.5,-100724.63 1058.5,-100663.26 1058.5,-100663.26"/>
<polygon fill="black" stroke="black" points="1062,-100663.26 1058.5,-100653.26 1055,-100663.26 1062,-100663.26"/>
</g>
<!-- layer28_gate_ar -->
<g id="node727" class="node">
<title>layer28_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1149.5" cy="-100464.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1149.5" y="-100483.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1149.5" y="-100468.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1149.5" y="-100453.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1149.5" y="-100438.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer28_ffn_gate_2&#45;&gt;layer28_gate_ar -->
<g id="edge924" class="edge">
<title>layer28_ffn_gate_2&#45;&gt;layer28_gate_ar</title>
<path fill="none" stroke="black" d="M932.08,-100618C942.79,-100618 950,-100618 950,-100618 950,-100618 950,-100480 950,-100480 950,-100480 1017.99,-100480 1017.99,-100480"/>
<polygon fill="black" stroke="black" points="1017.99,-100483.5 1027.99,-100480 1017.99,-100476.5 1017.99,-100483.5"/>
</g>
<!-- layer28_ffn_gate_3&#45;&gt;layer28_gate_ar -->
<g id="edge925" class="edge">
<title>layer28_ffn_gate_3&#45;&gt;layer28_gate_ar</title>
<path fill="none" stroke="black" d="M1231.24,-100584.68C1231.24,-100584.68 1231.24,-100511.86 1231.24,-100511.86"/>
<polygon fill="black" stroke="black" points="1234.74,-100511.86 1231.24,-100501.86 1227.74,-100511.86 1234.74,-100511.86"/>
</g>
<!-- layer28_up_ar -->
<g id="node728" class="node">
<title>layer28_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="803.5" cy="-100464.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="803.5" y="-100483.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="803.5" y="-100468.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="803.5" y="-100453.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="803.5" y="-100438.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer28_ffn_up_2&#45;&gt;layer28_up_ar -->
<g id="edge926" class="edge">
<title>layer28_ffn_up_2&#45;&gt;layer28_up_ar</title>
<path fill="none" stroke="black" d="M695.26,-100584.68C695.26,-100584.68 695.26,-100500.76 695.26,-100500.76"/>
<polygon fill="black" stroke="black" points="698.76,-100500.76 695.26,-100490.76 691.76,-100500.76 698.76,-100500.76"/>
</g>
<!-- layer28_ffn_up_3&#45;&gt;layer28_up_ar -->
<g id="edge927" class="edge">
<title>layer28_ffn_up_3&#45;&gt;layer28_up_ar</title>
<path fill="none" stroke="black" d="M994.76,-100584.71C994.76,-100534.84 994.76,-100448 994.76,-100448 994.76,-100448 933.54,-100448 933.54,-100448"/>
<polygon fill="black" stroke="black" points="933.54,-100444.5 923.54,-100448 933.54,-100451.5 933.54,-100444.5"/>
</g>
<!-- layer28_silu_2 -->
<g id="node729" class="node">
<title>layer28_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1077,-100344.71 896,-100344.71 896,-100276.71 1077,-100276.71 1077,-100344.71"/>
<text text-anchor="middle" x="986.5" y="-100329.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="986.5" y="-100314.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="986.5" y="-100299.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="986.5" y="-100284.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_gate_ar&#45;&gt;layer28_silu_2 -->
<g id="edge928" class="edge">
<title>layer28_gate_ar&#45;&gt;layer28_silu_2</title>
<path fill="none" stroke="black" d="M1049.26,-100434.72C1049.26,-100434.72 1049.26,-100354.73 1049.26,-100354.73"/>
<polygon fill="black" stroke="black" points="1052.76,-100354.73 1049.26,-100344.73 1045.76,-100354.73 1052.76,-100354.73"/>
</g>
<!-- layer28_silu_3 -->
<g id="node730" class="node">
<title>layer28_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1294,-100344.71 1113,-100344.71 1113,-100276.71 1294,-100276.71 1294,-100344.71"/>
<text text-anchor="middle" x="1203.5" y="-100329.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1203.5" y="-100314.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1203.5" y="-100299.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1203.5" y="-100284.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_gate_ar&#45;&gt;layer28_silu_3 -->
<g id="edge929" class="edge">
<title>layer28_gate_ar&#45;&gt;layer28_silu_3</title>
<path fill="none" stroke="black" d="M1195.24,-100419.81C1195.24,-100419.81 1195.24,-100354.72 1195.24,-100354.72"/>
<polygon fill="black" stroke="black" points="1198.74,-100354.72 1195.24,-100344.72 1191.74,-100354.72 1198.74,-100354.72"/>
</g>
<!-- layer28_mul_2 -->
<g id="node731" class="node">
<title>layer28_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="967,-100204.71 786,-100204.71 786,-100136.71 967,-100136.71 967,-100204.71"/>
<text text-anchor="middle" x="876.5" y="-100189.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="876.5" y="-100174.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="876.5" y="-100159.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="876.5" y="-100144.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_up_ar&#45;&gt;layer28_mul_2 -->
<g id="edge931" class="edge">
<title>layer28_up_ar&#45;&gt;layer28_mul_2</title>
<path fill="none" stroke="black" d="M841,-100418.52C841,-100418.52 841,-100214.79 841,-100214.79"/>
<polygon fill="black" stroke="black" points="844.5,-100214.79 841,-100204.79 837.5,-100214.79 844.5,-100214.79"/>
</g>
<!-- layer28_mul_3 -->
<g id="node732" class="node">
<title>layer28_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1184,-100204.71 1003,-100204.71 1003,-100136.71 1184,-100136.71 1184,-100204.71"/>
<text text-anchor="middle" x="1093.5" y="-100189.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1093.5" y="-100174.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1093.5" y="-100159.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1093.5" y="-100144.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer28_up_ar&#45;&gt;layer28_mul_3 -->
<g id="edge933" class="edge">
<title>layer28_up_ar&#45;&gt;layer28_mul_3</title>
<path fill="none" stroke="black" d="M913.74,-100440.27C913.74,-100415.22 913.74,-100380 913.74,-100380 913.74,-100380 1095,-100380 1095,-100380 1095,-100380 1095,-100214.8 1095,-100214.8"/>
<polygon fill="black" stroke="black" points="1098.5,-100214.8 1095,-100204.8 1091.5,-100214.8 1098.5,-100214.8"/>
</g>
<!-- layer28_silu_2&#45;&gt;layer28_mul_2 -->
<g id="edge930" class="edge">
<title>layer28_silu_2&#45;&gt;layer28_mul_2</title>
<path fill="none" stroke="black" d="M931.5,-100276.46C931.5,-100276.46 931.5,-100215.09 931.5,-100215.09"/>
<polygon fill="black" stroke="black" points="935,-100215.09 931.5,-100205.09 928,-100215.09 935,-100215.09"/>
</g>
<!-- layer28_silu_3&#45;&gt;layer28_mul_3 -->
<g id="edge932" class="edge">
<title>layer28_silu_3&#45;&gt;layer28_mul_3</title>
<path fill="none" stroke="black" d="M1148.5,-100276.46C1148.5,-100276.46 1148.5,-100215.09 1148.5,-100215.09"/>
<polygon fill="black" stroke="black" points="1152,-100215.09 1148.5,-100205.09 1145,-100215.09 1152,-100215.09"/>
</g>
<!-- layer28_ffn_down_2 -->
<g id="node733" class="node">
<title>layer28_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="966.5,-100064.71 794.5,-100064.71 794.5,-99996.71 966.5,-99996.71 966.5,-100064.71"/>
<text text-anchor="middle" x="880.5" y="-100049.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="880.5" y="-100034.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="880.5" y="-100019.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="880.5" y="-100004.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer28_mul_2&#45;&gt;layer28_ffn_down_2 -->
<g id="edge934" class="edge">
<title>layer28_mul_2&#45;&gt;layer28_ffn_down_2</title>
<path fill="none" stroke="black" d="M880.5,-100136.46C880.5,-100136.46 880.5,-100075.09 880.5,-100075.09"/>
<polygon fill="black" stroke="black" points="884,-100075.09 880.5,-100065.09 877,-100075.09 884,-100075.09"/>
</g>
<!-- layer28_ffn_down_3 -->
<g id="node734" class="node">
<title>layer28_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1176.5,-100064.71 1004.5,-100064.71 1004.5,-99996.71 1176.5,-99996.71 1176.5,-100064.71"/>
<text text-anchor="middle" x="1090.5" y="-100049.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1090.5" y="-100034.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1090.5" y="-100019.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1090.5" y="-100004.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer28_mul_3&#45;&gt;layer28_ffn_down_3 -->
<g id="edge935" class="edge">
<title>layer28_mul_3&#45;&gt;layer28_ffn_down_3</title>
<path fill="none" stroke="black" d="M1090.5,-100136.46C1090.5,-100136.46 1090.5,-100075.09 1090.5,-100075.09"/>
<polygon fill="black" stroke="black" points="1094,-100075.09 1090.5,-100065.09 1087,-100075.09 1094,-100075.09"/>
</g>
<!-- layer28_ffn_ar -->
<g id="node735" class="node">
<title>layer28_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="984.5" cy="-99876.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="984.5" y="-99895.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="984.5" y="-99880.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="984.5" y="-99865.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="984.5" y="-99850.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer28_ffn_down_2&#45;&gt;layer28_ffn_ar -->
<g id="edge936" class="edge">
<title>layer28_ffn_down_2&#45;&gt;layer28_ffn_ar</title>
<path fill="none" stroke="black" d="M914.69,-99996.51C914.69,-99996.51 914.69,-99926.17 914.69,-99926.17"/>
<polygon fill="black" stroke="black" points="918.19,-99926.17 914.69,-99916.17 911.19,-99926.17 918.19,-99926.17"/>
</g>
<!-- layer28_ffn_down_3&#45;&gt;layer28_ffn_ar -->
<g id="edge937" class="edge">
<title>layer28_ffn_down_3&#45;&gt;layer28_ffn_ar</title>
<path fill="none" stroke="black" d="M1055.31,-99996.51C1055.31,-99996.51 1055.31,-99925.89 1055.31,-99925.89"/>
<polygon fill="black" stroke="black" points="1058.81,-99925.89 1055.31,-99915.89 1051.81,-99925.89 1058.81,-99925.89"/>
</g>
<!-- layer29_norm_2 -->
<g id="node736" class="node">
<title>layer29_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="966.5,-99756.54 794.5,-99756.54 794.5,-99688.54 966.5,-99688.54 966.5,-99756.54"/>
<text text-anchor="middle" x="880.5" y="-99741.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="880.5" y="-99726.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="880.5" y="-99711.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="880.5" y="-99696.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer28_ffn_ar&#45;&gt;layer29_norm_2 -->
<g id="edge938" class="edge">
<title>layer28_ffn_ar&#45;&gt;layer29_norm_2</title>
<path fill="none" stroke="black" d="M914.69,-99836.95C914.69,-99836.95 914.69,-99766.6 914.69,-99766.6"/>
<polygon fill="black" stroke="black" points="918.19,-99766.6 914.69,-99756.6 911.19,-99766.6 918.19,-99766.6"/>
</g>
<!-- layer29_norm_3 -->
<g id="node737" class="node">
<title>layer29_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1176.5,-99756.54 1004.5,-99756.54 1004.5,-99688.54 1176.5,-99688.54 1176.5,-99756.54"/>
<text text-anchor="middle" x="1090.5" y="-99741.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1090.5" y="-99726.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1090.5" y="-99711.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1090.5" y="-99696.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer28_ffn_ar&#45;&gt;layer29_norm_3 -->
<g id="edge939" class="edge">
<title>layer28_ffn_ar&#45;&gt;layer29_norm_3</title>
<path fill="none" stroke="black" d="M1055.31,-99837.35C1055.31,-99837.35 1055.31,-99766.77 1055.31,-99766.77"/>
<polygon fill="black" stroke="black" points="1058.81,-99766.77 1055.31,-99756.77 1051.81,-99766.77 1058.81,-99766.77"/>
</g>
<!-- layer29_qkv_2 -->
<g id="node738" class="node">
<title>layer29_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="967,-99616.54 786,-99616.54 786,-99548.54 967,-99548.54 967,-99616.54"/>
<text text-anchor="middle" x="876.5" y="-99601.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="876.5" y="-99586.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="876.5" y="-99571.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="876.5" y="-99556.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer29_norm_2&#45;&gt;layer29_qkv_2 -->
<g id="edge940" class="edge">
<title>layer29_norm_2&#45;&gt;layer29_qkv_2</title>
<path fill="none" stroke="black" d="M880.5,-99688.3C880.5,-99688.3 880.5,-99626.92 880.5,-99626.92"/>
<polygon fill="black" stroke="black" points="884,-99626.92 880.5,-99616.92 877,-99626.92 884,-99626.92"/>
</g>
<!-- layer29_qkv_3 -->
<g id="node739" class="node">
<title>layer29_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1184,-99616.54 1003,-99616.54 1003,-99548.54 1184,-99548.54 1184,-99616.54"/>
<text text-anchor="middle" x="1093.5" y="-99601.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1093.5" y="-99586.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1093.5" y="-99571.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1093.5" y="-99556.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer29_norm_3&#45;&gt;layer29_qkv_3 -->
<g id="edge941" class="edge">
<title>layer29_norm_3&#45;&gt;layer29_qkv_3</title>
<path fill="none" stroke="black" d="M1090.5,-99688.3C1090.5,-99688.3 1090.5,-99626.92 1090.5,-99626.92"/>
<polygon fill="black" stroke="black" points="1094,-99626.92 1090.5,-99616.92 1087,-99626.92 1094,-99626.92"/>
</g>
<!-- layer29_qkv_ar -->
<g id="node740" class="node">
<title>layer29_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="984.5" cy="-99428.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="984.5" y="-99447.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="984.5" y="-99432.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="984.5" y="-99417.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="984.5" y="-99402.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer29_qkv_2&#45;&gt;layer29_qkv_ar -->
<g id="edge942" class="edge">
<title>layer29_qkv_2&#45;&gt;layer29_qkv_ar</title>
<path fill="none" stroke="black" d="M911.76,-99548.35C911.76,-99548.35 911.76,-99478.28 911.76,-99478.28"/>
<polygon fill="black" stroke="black" points="915.26,-99478.28 911.76,-99468.28 908.26,-99478.28 915.26,-99478.28"/>
</g>
<!-- layer29_qkv_3&#45;&gt;layer29_qkv_ar -->
<g id="edge943" class="edge">
<title>layer29_qkv_3&#45;&gt;layer29_qkv_ar</title>
<path fill="none" stroke="black" d="M1057.74,-99548.35C1057.74,-99548.35 1057.74,-99478 1057.74,-99478"/>
<polygon fill="black" stroke="black" points="1061.24,-99478 1057.74,-99468 1054.24,-99478 1061.24,-99478"/>
</g>
<!-- layer29_attn_2 -->
<g id="node741" class="node">
<title>layer29_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="966.5,-99308.38 794.5,-99308.38 794.5,-99240.38 966.5,-99240.38 966.5,-99308.38"/>
<text text-anchor="middle" x="880.5" y="-99293.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="880.5" y="-99278.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="880.5" y="-99263.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="880.5" y="-99248.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer29_qkv_ar&#45;&gt;layer29_attn_2 -->
<g id="edge944" class="edge">
<title>layer29_qkv_ar&#45;&gt;layer29_attn_2</title>
<path fill="none" stroke="black" d="M911.51,-99388.78C911.51,-99388.78 911.51,-99318.43 911.51,-99318.43"/>
<polygon fill="black" stroke="black" points="915.01,-99318.43 911.51,-99308.43 908.01,-99318.43 915.01,-99318.43"/>
</g>
<!-- layer29_attn_3 -->
<g id="node742" class="node">
<title>layer29_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1174.5,-99308.38 1002.5,-99308.38 1002.5,-99240.38 1174.5,-99240.38 1174.5,-99308.38"/>
<text text-anchor="middle" x="1088.5" y="-99293.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1088.5" y="-99278.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1088.5" y="-99263.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1088.5" y="-99248.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer29_qkv_ar&#45;&gt;layer29_attn_3 -->
<g id="edge945" class="edge">
<title>layer29_qkv_ar&#45;&gt;layer29_attn_3</title>
<path fill="none" stroke="black" d="M1057.49,-99388.78C1057.49,-99388.78 1057.49,-99318.43 1057.49,-99318.43"/>
<polygon fill="black" stroke="black" points="1060.99,-99318.43 1057.49,-99308.43 1053.99,-99318.43 1060.99,-99318.43"/>
</g>
<!-- layer29_attn_out_2 -->
<g id="node743" class="node">
<title>layer29_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="966.5,-99168.38 794.5,-99168.38 794.5,-99100.38 966.5,-99100.38 966.5,-99168.38"/>
<text text-anchor="middle" x="880.5" y="-99153.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="880.5" y="-99138.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="880.5" y="-99123.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="880.5" y="-99108.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer29_attn_2&#45;&gt;layer29_attn_out_2 -->
<g id="edge946" class="edge">
<title>layer29_attn_2&#45;&gt;layer29_attn_out_2</title>
<path fill="none" stroke="black" d="M880.5,-99240.13C880.5,-99240.13 880.5,-99178.76 880.5,-99178.76"/>
<polygon fill="black" stroke="black" points="884,-99178.76 880.5,-99168.76 877,-99178.76 884,-99178.76"/>
</g>
<!-- layer29_attn_out_3 -->
<g id="node744" class="node">
<title>layer29_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1174.5,-99168.38 1002.5,-99168.38 1002.5,-99100.38 1174.5,-99100.38 1174.5,-99168.38"/>
<text text-anchor="middle" x="1088.5" y="-99153.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1088.5" y="-99138.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1088.5" y="-99123.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1088.5" y="-99108.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer29_attn_3&#45;&gt;layer29_attn_out_3 -->
<g id="edge947" class="edge">
<title>layer29_attn_3&#45;&gt;layer29_attn_out_3</title>
<path fill="none" stroke="black" d="M1088.5,-99240.13C1088.5,-99240.13 1088.5,-99178.76 1088.5,-99178.76"/>
<polygon fill="black" stroke="black" points="1092,-99178.76 1088.5,-99168.76 1085,-99178.76 1092,-99178.76"/>
</g>
<!-- layer29_attn_ar -->
<g id="node745" class="node">
<title>layer29_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="984.5" cy="-98980.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="984.5" y="-98999.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="984.5" y="-98984.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="984.5" y="-98969.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="984.5" y="-98954.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer29_attn_out_2&#45;&gt;layer29_attn_ar -->
<g id="edge948" class="edge">
<title>layer29_attn_out_2&#45;&gt;layer29_attn_ar</title>
<path fill="none" stroke="black" d="M914.69,-99100.18C914.69,-99100.18 914.69,-99029.84 914.69,-99029.84"/>
<polygon fill="black" stroke="black" points="918.19,-99029.84 914.69,-99019.84 911.19,-99029.84 918.19,-99029.84"/>
</g>
<!-- layer29_attn_out_3&#45;&gt;layer29_attn_ar -->
<g id="edge949" class="edge">
<title>layer29_attn_out_3&#45;&gt;layer29_attn_ar</title>
<path fill="none" stroke="black" d="M1054.31,-99100.18C1054.31,-99100.18 1054.31,-99029.84 1054.31,-99029.84"/>
<polygon fill="black" stroke="black" points="1057.81,-99029.84 1054.31,-99019.84 1050.81,-99029.84 1057.81,-99029.84"/>
</g>
<!-- layer29_ffn_norm_2 -->
<g id="node746" class="node">
<title>layer29_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="962.5,-98860.21 790.5,-98860.21 790.5,-98792.21 962.5,-98792.21 962.5,-98860.21"/>
<text text-anchor="middle" x="876.5" y="-98845.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="876.5" y="-98830.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="876.5" y="-98815.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="876.5" y="-98800.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer29_attn_ar&#45;&gt;layer29_ffn_norm_2 -->
<g id="edge950" class="edge">
<title>layer29_attn_ar&#45;&gt;layer29_ffn_norm_2</title>
<path fill="none" stroke="black" d="M912.69,-98941.41C912.69,-98941.41 912.69,-98870.36 912.69,-98870.36"/>
<polygon fill="black" stroke="black" points="916.19,-98870.36 912.69,-98860.36 909.19,-98870.36 916.19,-98870.36"/>
</g>
<!-- layer29_ffn_norm_3 -->
<g id="node747" class="node">
<title>layer29_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1179.5,-98860.21 1007.5,-98860.21 1007.5,-98792.21 1179.5,-98792.21 1179.5,-98860.21"/>
<text text-anchor="middle" x="1093.5" y="-98845.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1093.5" y="-98830.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1093.5" y="-98815.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1093.5" y="-98800.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer29_attn_ar&#45;&gt;layer29_ffn_norm_3 -->
<g id="edge951" class="edge">
<title>layer29_attn_ar&#45;&gt;layer29_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1056.81,-98941.41C1056.81,-98941.41 1056.81,-98870.36 1056.81,-98870.36"/>
<polygon fill="black" stroke="black" points="1060.31,-98870.36 1056.81,-98860.36 1053.31,-98870.36 1060.31,-98870.36"/>
</g>
<!-- layer29_ffn_gate_2 -->
<g id="node748" class="node">
<title>layer29_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="967,-98720.21 786,-98720.21 786,-98652.21 967,-98652.21 967,-98720.21"/>
<text text-anchor="middle" x="876.5" y="-98705.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="876.5" y="-98690.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="876.5" y="-98675.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="876.5" y="-98660.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_ffn_norm_2&#45;&gt;layer29_ffn_gate_2 -->
<g id="edge952" class="edge">
<title>layer29_ffn_norm_2&#45;&gt;layer29_ffn_gate_2</title>
<path fill="none" stroke="black" d="M876.5,-98791.96C876.5,-98791.96 876.5,-98730.59 876.5,-98730.59"/>
<polygon fill="black" stroke="black" points="880,-98730.59 876.5,-98720.59 873,-98730.59 880,-98730.59"/>
</g>
<!-- layer29_ffn_up_2 -->
<g id="node750" class="node">
<title>layer29_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="750,-98720.21 569,-98720.21 569,-98652.21 750,-98652.21 750,-98720.21"/>
<text text-anchor="middle" x="659.5" y="-98705.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="659.5" y="-98690.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="659.5" y="-98675.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="659.5" y="-98660.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_ffn_norm_2&#45;&gt;layer29_ffn_up_2 -->
<g id="edge954" class="edge">
<title>layer29_ffn_norm_2&#45;&gt;layer29_ffn_up_2</title>
<path fill="none" stroke="black" d="M790.31,-98826C750.86,-98826 712.76,-98826 712.76,-98826 712.76,-98826 712.76,-98730.41 712.76,-98730.41"/>
<polygon fill="black" stroke="black" points="716.26,-98730.41 712.76,-98720.41 709.26,-98730.41 716.26,-98730.41"/>
</g>
<!-- layer29_ffn_gate_3 -->
<g id="node749" class="node">
<title>layer29_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1401,-98720.21 1220,-98720.21 1220,-98652.21 1401,-98652.21 1401,-98720.21"/>
<text text-anchor="middle" x="1310.5" y="-98705.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1310.5" y="-98690.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1310.5" y="-98675.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1310.5" y="-98660.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_ffn_norm_3&#45;&gt;layer29_ffn_gate_3 -->
<g id="edge953" class="edge">
<title>layer29_ffn_norm_3&#45;&gt;layer29_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1179.56,-98826C1218.95,-98826 1257,-98826 1257,-98826 1257,-98826 1257,-98730.41 1257,-98730.41"/>
<polygon fill="black" stroke="black" points="1260.5,-98730.41 1257,-98720.41 1253.5,-98730.41 1260.5,-98730.41"/>
</g>
<!-- layer29_ffn_up_3 -->
<g id="node751" class="node">
<title>layer29_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1184,-98720.21 1003,-98720.21 1003,-98652.21 1184,-98652.21 1184,-98720.21"/>
<text text-anchor="middle" x="1093.5" y="-98705.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1093.5" y="-98690.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1093.5" y="-98675.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1093.5" y="-98660.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_ffn_norm_3&#45;&gt;layer29_ffn_up_3 -->
<g id="edge955" class="edge">
<title>layer29_ffn_norm_3&#45;&gt;layer29_ffn_up_3</title>
<path fill="none" stroke="black" d="M1093.5,-98791.96C1093.5,-98791.96 1093.5,-98730.59 1093.5,-98730.59"/>
<polygon fill="black" stroke="black" points="1097,-98730.59 1093.5,-98720.59 1090,-98730.59 1097,-98730.59"/>
</g>
<!-- layer29_gate_ar -->
<g id="node752" class="node">
<title>layer29_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1184.5" cy="-98532.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1184.5" y="-98550.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1184.5" y="-98535.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1184.5" y="-98520.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1184.5" y="-98505.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer29_ffn_gate_2&#45;&gt;layer29_gate_ar -->
<g id="edge956" class="edge">
<title>layer29_ffn_gate_2&#45;&gt;layer29_gate_ar</title>
<path fill="none" stroke="black" d="M967.08,-98686C977.79,-98686 985,-98686 985,-98686 985,-98686 985,-98548 985,-98548 985,-98548 1053.56,-98548 1053.56,-98548"/>
<polygon fill="black" stroke="black" points="1053.56,-98551.5 1063.56,-98548 1053.56,-98544.5 1053.56,-98551.5"/>
</g>
<!-- layer29_ffn_gate_3&#45;&gt;layer29_gate_ar -->
<g id="edge957" class="edge">
<title>layer29_ffn_gate_3&#45;&gt;layer29_gate_ar</title>
<path fill="none" stroke="black" d="M1266.24,-98652.01C1266.24,-98652.01 1266.24,-98579.19 1266.24,-98579.19"/>
<polygon fill="black" stroke="black" points="1269.74,-98579.19 1266.24,-98569.19 1262.74,-98579.19 1269.74,-98579.19"/>
</g>
<!-- layer29_up_ar -->
<g id="node753" class="node">
<title>layer29_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="838.5" cy="-98532.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="838.5" y="-98550.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="838.5" y="-98535.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="838.5" y="-98520.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="838.5" y="-98505.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer29_ffn_up_2&#45;&gt;layer29_up_ar -->
<g id="edge958" class="edge">
<title>layer29_ffn_up_2&#45;&gt;layer29_up_ar</title>
<path fill="none" stroke="black" d="M730.26,-98652.01C730.26,-98652.01 730.26,-98568.09 730.26,-98568.09"/>
<polygon fill="black" stroke="black" points="733.76,-98568.09 730.26,-98558.09 726.76,-98568.09 733.76,-98568.09"/>
</g>
<!-- layer29_ffn_up_3&#45;&gt;layer29_up_ar -->
<g id="edge959" class="edge">
<title>layer29_ffn_up_3&#45;&gt;layer29_up_ar</title>
<path fill="none" stroke="black" d="M1029.76,-98652.17C1029.76,-98602.5 1029.76,-98516 1029.76,-98516 1029.76,-98516 969.08,-98516 969.08,-98516"/>
<polygon fill="black" stroke="black" points="969.08,-98512.5 959.08,-98516 969.08,-98519.5 969.08,-98512.5"/>
</g>
<!-- layer29_silu_2 -->
<g id="node754" class="node">
<title>layer29_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1112,-98412.04 931,-98412.04 931,-98344.04 1112,-98344.04 1112,-98412.04"/>
<text text-anchor="middle" x="1021.5" y="-98396.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1021.5" y="-98381.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1021.5" y="-98366.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1021.5" y="-98351.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_gate_ar&#45;&gt;layer29_silu_2 -->
<g id="edge960" class="edge">
<title>layer29_gate_ar&#45;&gt;layer29_silu_2</title>
<path fill="none" stroke="black" d="M1084.26,-98502.05C1084.26,-98502.05 1084.26,-98422.07 1084.26,-98422.07"/>
<polygon fill="black" stroke="black" points="1087.76,-98422.07 1084.26,-98412.07 1080.76,-98422.07 1087.76,-98422.07"/>
</g>
<!-- layer29_silu_3 -->
<g id="node755" class="node">
<title>layer29_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1329,-98412.04 1148,-98412.04 1148,-98344.04 1329,-98344.04 1329,-98412.04"/>
<text text-anchor="middle" x="1238.5" y="-98396.84" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1238.5" y="-98381.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1238.5" y="-98366.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1238.5" y="-98351.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_gate_ar&#45;&gt;layer29_silu_3 -->
<g id="edge961" class="edge">
<title>layer29_gate_ar&#45;&gt;layer29_silu_3</title>
<path fill="none" stroke="black" d="M1230.24,-98487.15C1230.24,-98487.15 1230.24,-98422.05 1230.24,-98422.05"/>
<polygon fill="black" stroke="black" points="1233.74,-98422.05 1230.24,-98412.05 1226.74,-98422.05 1233.74,-98422.05"/>
</g>
<!-- layer29_mul_2 -->
<g id="node756" class="node">
<title>layer29_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1002,-98272.04 821,-98272.04 821,-98204.04 1002,-98204.04 1002,-98272.04"/>
<text text-anchor="middle" x="911.5" y="-98256.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="911.5" y="-98241.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="911.5" y="-98226.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="911.5" y="-98211.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_up_ar&#45;&gt;layer29_mul_2 -->
<g id="edge963" class="edge">
<title>layer29_up_ar&#45;&gt;layer29_mul_2</title>
<path fill="none" stroke="black" d="M876,-98485.85C876,-98485.85 876,-98282.13 876,-98282.13"/>
<polygon fill="black" stroke="black" points="879.5,-98282.13 876,-98272.13 872.5,-98282.13 879.5,-98282.13"/>
</g>
<!-- layer29_mul_3 -->
<g id="node757" class="node">
<title>layer29_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1219,-98272.04 1038,-98272.04 1038,-98204.04 1219,-98204.04 1219,-98272.04"/>
<text text-anchor="middle" x="1128.5" y="-98256.84" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1128.5" y="-98241.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1128.5" y="-98226.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1128.5" y="-98211.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer29_up_ar&#45;&gt;layer29_mul_3 -->
<g id="edge965" class="edge">
<title>layer29_up_ar&#45;&gt;layer29_mul_3</title>
<path fill="none" stroke="black" d="M948.74,-98507.34C948.74,-98482.53 948.74,-98448 948.74,-98448 948.74,-98448 1130,-98448 1130,-98448 1130,-98448 1130,-98282.24 1130,-98282.24"/>
<polygon fill="black" stroke="black" points="1133.5,-98282.24 1130,-98272.24 1126.5,-98282.24 1133.5,-98282.24"/>
</g>
<!-- layer29_silu_2&#45;&gt;layer29_mul_2 -->
<g id="edge962" class="edge">
<title>layer29_silu_2&#45;&gt;layer29_mul_2</title>
<path fill="none" stroke="black" d="M966.5,-98343.8C966.5,-98343.8 966.5,-98282.42 966.5,-98282.42"/>
<polygon fill="black" stroke="black" points="970,-98282.42 966.5,-98272.42 963,-98282.42 970,-98282.42"/>
</g>
<!-- layer29_silu_3&#45;&gt;layer29_mul_3 -->
<g id="edge964" class="edge">
<title>layer29_silu_3&#45;&gt;layer29_mul_3</title>
<path fill="none" stroke="black" d="M1183.5,-98343.8C1183.5,-98343.8 1183.5,-98282.42 1183.5,-98282.42"/>
<polygon fill="black" stroke="black" points="1187,-98282.42 1183.5,-98272.42 1180,-98282.42 1187,-98282.42"/>
</g>
<!-- layer29_ffn_down_2 -->
<g id="node758" class="node">
<title>layer29_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1001.5,-98132.04 829.5,-98132.04 829.5,-98064.04 1001.5,-98064.04 1001.5,-98132.04"/>
<text text-anchor="middle" x="915.5" y="-98116.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="915.5" y="-98101.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="915.5" y="-98086.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="915.5" y="-98071.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer29_mul_2&#45;&gt;layer29_ffn_down_2 -->
<g id="edge966" class="edge">
<title>layer29_mul_2&#45;&gt;layer29_ffn_down_2</title>
<path fill="none" stroke="black" d="M915.5,-98203.8C915.5,-98203.8 915.5,-98142.42 915.5,-98142.42"/>
<polygon fill="black" stroke="black" points="919,-98142.42 915.5,-98132.42 912,-98142.42 919,-98142.42"/>
</g>
<!-- layer29_ffn_down_3 -->
<g id="node759" class="node">
<title>layer29_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1211.5,-98132.04 1039.5,-98132.04 1039.5,-98064.04 1211.5,-98064.04 1211.5,-98132.04"/>
<text text-anchor="middle" x="1125.5" y="-98116.84" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1125.5" y="-98101.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1125.5" y="-98086.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1125.5" y="-98071.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer29_mul_3&#45;&gt;layer29_ffn_down_3 -->
<g id="edge967" class="edge">
<title>layer29_mul_3&#45;&gt;layer29_ffn_down_3</title>
<path fill="none" stroke="black" d="M1125.5,-98203.8C1125.5,-98203.8 1125.5,-98142.42 1125.5,-98142.42"/>
<polygon fill="black" stroke="black" points="1129,-98142.42 1125.5,-98132.42 1122,-98142.42 1129,-98142.42"/>
</g>
<!-- layer29_ffn_ar -->
<g id="node760" class="node">
<title>layer29_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1019.5" cy="-97943.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1019.5" y="-97962.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1019.5" y="-97947.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1019.5" y="-97932.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1019.5" y="-97917.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer29_ffn_down_2&#45;&gt;layer29_ffn_ar -->
<g id="edge968" class="edge">
<title>layer29_ffn_down_2&#45;&gt;layer29_ffn_ar</title>
<path fill="none" stroke="black" d="M949.69,-98063.85C949.69,-98063.85 949.69,-97993.5 949.69,-97993.5"/>
<polygon fill="black" stroke="black" points="953.19,-97993.5 949.69,-97983.5 946.19,-97993.5 953.19,-97993.5"/>
</g>
<!-- layer29_ffn_down_3&#45;&gt;layer29_ffn_ar -->
<g id="edge969" class="edge">
<title>layer29_ffn_down_3&#45;&gt;layer29_ffn_ar</title>
<path fill="none" stroke="black" d="M1090.31,-98063.85C1090.31,-98063.85 1090.31,-97993.23 1090.31,-97993.23"/>
<polygon fill="black" stroke="black" points="1093.81,-97993.23 1090.31,-97983.23 1086.81,-97993.23 1093.81,-97993.23"/>
</g>
<!-- layer30_norm_2 -->
<g id="node761" class="node">
<title>layer30_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1001.5,-97823.88 829.5,-97823.88 829.5,-97755.88 1001.5,-97755.88 1001.5,-97823.88"/>
<text text-anchor="middle" x="915.5" y="-97808.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="915.5" y="-97793.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="915.5" y="-97778.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="915.5" y="-97763.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer29_ffn_ar&#45;&gt;layer30_norm_2 -->
<g id="edge970" class="edge">
<title>layer29_ffn_ar&#45;&gt;layer30_norm_2</title>
<path fill="none" stroke="black" d="M949.69,-97904.28C949.69,-97904.28 949.69,-97833.93 949.69,-97833.93"/>
<polygon fill="black" stroke="black" points="953.19,-97833.93 949.69,-97823.93 946.19,-97833.93 953.19,-97833.93"/>
</g>
<!-- layer30_norm_3 -->
<g id="node762" class="node">
<title>layer30_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1211.5,-97823.88 1039.5,-97823.88 1039.5,-97755.88 1211.5,-97755.88 1211.5,-97823.88"/>
<text text-anchor="middle" x="1125.5" y="-97808.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1125.5" y="-97793.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1125.5" y="-97778.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1125.5" y="-97763.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer29_ffn_ar&#45;&gt;layer30_norm_3 -->
<g id="edge971" class="edge">
<title>layer29_ffn_ar&#45;&gt;layer30_norm_3</title>
<path fill="none" stroke="black" d="M1090.31,-97904.68C1090.31,-97904.68 1090.31,-97834.11 1090.31,-97834.11"/>
<polygon fill="black" stroke="black" points="1093.81,-97834.11 1090.31,-97824.11 1086.81,-97834.11 1093.81,-97834.11"/>
</g>
<!-- layer30_qkv_2 -->
<g id="node763" class="node">
<title>layer30_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1002,-97683.88 821,-97683.88 821,-97615.88 1002,-97615.88 1002,-97683.88"/>
<text text-anchor="middle" x="911.5" y="-97668.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="911.5" y="-97653.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="911.5" y="-97638.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="911.5" y="-97623.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer30_norm_2&#45;&gt;layer30_qkv_2 -->
<g id="edge972" class="edge">
<title>layer30_norm_2&#45;&gt;layer30_qkv_2</title>
<path fill="none" stroke="black" d="M915.5,-97755.63C915.5,-97755.63 915.5,-97694.26 915.5,-97694.26"/>
<polygon fill="black" stroke="black" points="919,-97694.26 915.5,-97684.26 912,-97694.26 919,-97694.26"/>
</g>
<!-- layer30_qkv_3 -->
<g id="node764" class="node">
<title>layer30_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1219,-97683.88 1038,-97683.88 1038,-97615.88 1219,-97615.88 1219,-97683.88"/>
<text text-anchor="middle" x="1128.5" y="-97668.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1128.5" y="-97653.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1128.5" y="-97638.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1128.5" y="-97623.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer30_norm_3&#45;&gt;layer30_qkv_3 -->
<g id="edge973" class="edge">
<title>layer30_norm_3&#45;&gt;layer30_qkv_3</title>
<path fill="none" stroke="black" d="M1125.5,-97755.63C1125.5,-97755.63 1125.5,-97694.26 1125.5,-97694.26"/>
<polygon fill="black" stroke="black" points="1129,-97694.26 1125.5,-97684.26 1122,-97694.26 1129,-97694.26"/>
</g>
<!-- layer30_qkv_ar -->
<g id="node765" class="node">
<title>layer30_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1019.5" cy="-97495.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1019.5" y="-97514.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1019.5" y="-97499.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1019.5" y="-97484.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1019.5" y="-97469.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer30_qkv_2&#45;&gt;layer30_qkv_ar -->
<g id="edge974" class="edge">
<title>layer30_qkv_2&#45;&gt;layer30_qkv_ar</title>
<path fill="none" stroke="black" d="M946.76,-97615.68C946.76,-97615.68 946.76,-97545.62 946.76,-97545.62"/>
<polygon fill="black" stroke="black" points="950.26,-97545.62 946.76,-97535.62 943.26,-97545.62 950.26,-97545.62"/>
</g>
<!-- layer30_qkv_3&#45;&gt;layer30_qkv_ar -->
<g id="edge975" class="edge">
<title>layer30_qkv_3&#45;&gt;layer30_qkv_ar</title>
<path fill="none" stroke="black" d="M1092.74,-97615.68C1092.74,-97615.68 1092.74,-97545.34 1092.74,-97545.34"/>
<polygon fill="black" stroke="black" points="1096.24,-97545.34 1092.74,-97535.34 1089.24,-97545.34 1096.24,-97545.34"/>
</g>
<!-- layer30_attn_2 -->
<g id="node766" class="node">
<title>layer30_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1001.5,-97375.71 829.5,-97375.71 829.5,-97307.71 1001.5,-97307.71 1001.5,-97375.71"/>
<text text-anchor="middle" x="915.5" y="-97360.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="915.5" y="-97345.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="915.5" y="-97330.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="915.5" y="-97315.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer30_qkv_ar&#45;&gt;layer30_attn_2 -->
<g id="edge976" class="edge">
<title>layer30_qkv_ar&#45;&gt;layer30_attn_2</title>
<path fill="none" stroke="black" d="M946.51,-97456.11C946.51,-97456.11 946.51,-97385.77 946.51,-97385.77"/>
<polygon fill="black" stroke="black" points="950.01,-97385.77 946.51,-97375.77 943.01,-97385.77 950.01,-97385.77"/>
</g>
<!-- layer30_attn_3 -->
<g id="node767" class="node">
<title>layer30_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1209.5,-97375.71 1037.5,-97375.71 1037.5,-97307.71 1209.5,-97307.71 1209.5,-97375.71"/>
<text text-anchor="middle" x="1123.5" y="-97360.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1123.5" y="-97345.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1123.5" y="-97330.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1123.5" y="-97315.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer30_qkv_ar&#45;&gt;layer30_attn_3 -->
<g id="edge977" class="edge">
<title>layer30_qkv_ar&#45;&gt;layer30_attn_3</title>
<path fill="none" stroke="black" d="M1092.49,-97456.11C1092.49,-97456.11 1092.49,-97385.77 1092.49,-97385.77"/>
<polygon fill="black" stroke="black" points="1095.99,-97385.77 1092.49,-97375.77 1088.99,-97385.77 1095.99,-97385.77"/>
</g>
<!-- layer30_attn_out_2 -->
<g id="node768" class="node">
<title>layer30_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1001.5,-97235.71 829.5,-97235.71 829.5,-97167.71 1001.5,-97167.71 1001.5,-97235.71"/>
<text text-anchor="middle" x="915.5" y="-97220.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="915.5" y="-97205.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="915.5" y="-97190.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="915.5" y="-97175.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer30_attn_2&#45;&gt;layer30_attn_out_2 -->
<g id="edge978" class="edge">
<title>layer30_attn_2&#45;&gt;layer30_attn_out_2</title>
<path fill="none" stroke="black" d="M915.5,-97307.46C915.5,-97307.46 915.5,-97246.09 915.5,-97246.09"/>
<polygon fill="black" stroke="black" points="919,-97246.09 915.5,-97236.09 912,-97246.09 919,-97246.09"/>
</g>
<!-- layer30_attn_out_3 -->
<g id="node769" class="node">
<title>layer30_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1209.5,-97235.71 1037.5,-97235.71 1037.5,-97167.71 1209.5,-97167.71 1209.5,-97235.71"/>
<text text-anchor="middle" x="1123.5" y="-97220.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1123.5" y="-97205.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1123.5" y="-97190.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1123.5" y="-97175.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer30_attn_3&#45;&gt;layer30_attn_out_3 -->
<g id="edge979" class="edge">
<title>layer30_attn_3&#45;&gt;layer30_attn_out_3</title>
<path fill="none" stroke="black" d="M1123.5,-97307.46C1123.5,-97307.46 1123.5,-97246.09 1123.5,-97246.09"/>
<polygon fill="black" stroke="black" points="1127,-97246.09 1123.5,-97236.09 1120,-97246.09 1127,-97246.09"/>
</g>
<!-- layer30_attn_ar -->
<g id="node770" class="node">
<title>layer30_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1019.5" cy="-97047.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1019.5" y="-97066.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1019.5" y="-97051.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1019.5" y="-97036.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1019.5" y="-97021.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer30_attn_out_2&#45;&gt;layer30_attn_ar -->
<g id="edge980" class="edge">
<title>layer30_attn_out_2&#45;&gt;layer30_attn_ar</title>
<path fill="none" stroke="black" d="M949.69,-97167.51C949.69,-97167.51 949.69,-97097.17 949.69,-97097.17"/>
<polygon fill="black" stroke="black" points="953.19,-97097.17 949.69,-97087.17 946.19,-97097.17 953.19,-97097.17"/>
</g>
<!-- layer30_attn_out_3&#45;&gt;layer30_attn_ar -->
<g id="edge981" class="edge">
<title>layer30_attn_out_3&#45;&gt;layer30_attn_ar</title>
<path fill="none" stroke="black" d="M1089.31,-97167.51C1089.31,-97167.51 1089.31,-97097.17 1089.31,-97097.17"/>
<polygon fill="black" stroke="black" points="1092.81,-97097.17 1089.31,-97087.17 1085.81,-97097.17 1092.81,-97097.17"/>
</g>
<!-- layer30_ffn_norm_2 -->
<g id="node771" class="node">
<title>layer30_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="997.5,-96927.54 825.5,-96927.54 825.5,-96859.54 997.5,-96859.54 997.5,-96927.54"/>
<text text-anchor="middle" x="911.5" y="-96912.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="911.5" y="-96897.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="911.5" y="-96882.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="911.5" y="-96867.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer30_attn_ar&#45;&gt;layer30_ffn_norm_2 -->
<g id="edge982" class="edge">
<title>layer30_attn_ar&#45;&gt;layer30_ffn_norm_2</title>
<path fill="none" stroke="black" d="M947.69,-97008.75C947.69,-97008.75 947.69,-96937.69 947.69,-96937.69"/>
<polygon fill="black" stroke="black" points="951.19,-96937.69 947.69,-96927.69 944.19,-96937.69 951.19,-96937.69"/>
</g>
<!-- layer30_ffn_norm_3 -->
<g id="node772" class="node">
<title>layer30_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1214.5,-96927.54 1042.5,-96927.54 1042.5,-96859.54 1214.5,-96859.54 1214.5,-96927.54"/>
<text text-anchor="middle" x="1128.5" y="-96912.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1128.5" y="-96897.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1128.5" y="-96882.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1128.5" y="-96867.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer30_attn_ar&#45;&gt;layer30_ffn_norm_3 -->
<g id="edge983" class="edge">
<title>layer30_attn_ar&#45;&gt;layer30_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1091.81,-97008.75C1091.81,-97008.75 1091.81,-96937.69 1091.81,-96937.69"/>
<polygon fill="black" stroke="black" points="1095.31,-96937.69 1091.81,-96927.69 1088.31,-96937.69 1095.31,-96937.69"/>
</g>
<!-- layer30_ffn_gate_2 -->
<g id="node773" class="node">
<title>layer30_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1002,-96787.54 821,-96787.54 821,-96719.54 1002,-96719.54 1002,-96787.54"/>
<text text-anchor="middle" x="911.5" y="-96772.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="911.5" y="-96757.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="911.5" y="-96742.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="911.5" y="-96727.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_ffn_norm_2&#45;&gt;layer30_ffn_gate_2 -->
<g id="edge984" class="edge">
<title>layer30_ffn_norm_2&#45;&gt;layer30_ffn_gate_2</title>
<path fill="none" stroke="black" d="M911.5,-96859.3C911.5,-96859.3 911.5,-96797.92 911.5,-96797.92"/>
<polygon fill="black" stroke="black" points="915,-96797.92 911.5,-96787.92 908,-96797.92 915,-96797.92"/>
</g>
<!-- layer30_ffn_up_2 -->
<g id="node775" class="node">
<title>layer30_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="785,-96787.54 604,-96787.54 604,-96719.54 785,-96719.54 785,-96787.54"/>
<text text-anchor="middle" x="694.5" y="-96772.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="694.5" y="-96757.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="694.5" y="-96742.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="694.5" y="-96727.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_ffn_norm_2&#45;&gt;layer30_ffn_up_2 -->
<g id="edge986" class="edge">
<title>layer30_ffn_norm_2&#45;&gt;layer30_ffn_up_2</title>
<path fill="none" stroke="black" d="M825.31,-96893C785.86,-96893 747.76,-96893 747.76,-96893 747.76,-96893 747.76,-96797.66 747.76,-96797.66"/>
<polygon fill="black" stroke="black" points="751.26,-96797.66 747.76,-96787.66 744.26,-96797.66 751.26,-96797.66"/>
</g>
<!-- layer30_ffn_gate_3 -->
<g id="node774" class="node">
<title>layer30_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1436,-96787.54 1255,-96787.54 1255,-96719.54 1436,-96719.54 1436,-96787.54"/>
<text text-anchor="middle" x="1345.5" y="-96772.34" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1345.5" y="-96757.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1345.5" y="-96742.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1345.5" y="-96727.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_ffn_norm_3&#45;&gt;layer30_ffn_gate_3 -->
<g id="edge985" class="edge">
<title>layer30_ffn_norm_3&#45;&gt;layer30_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1214.56,-96893C1253.95,-96893 1292,-96893 1292,-96893 1292,-96893 1292,-96797.66 1292,-96797.66"/>
<polygon fill="black" stroke="black" points="1295.5,-96797.66 1292,-96787.66 1288.5,-96797.66 1295.5,-96797.66"/>
</g>
<!-- layer30_ffn_up_3 -->
<g id="node776" class="node">
<title>layer30_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1219,-96787.54 1038,-96787.54 1038,-96719.54 1219,-96719.54 1219,-96787.54"/>
<text text-anchor="middle" x="1128.5" y="-96772.34" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1128.5" y="-96757.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1128.5" y="-96742.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1128.5" y="-96727.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_ffn_norm_3&#45;&gt;layer30_ffn_up_3 -->
<g id="edge987" class="edge">
<title>layer30_ffn_norm_3&#45;&gt;layer30_ffn_up_3</title>
<path fill="none" stroke="black" d="M1128.5,-96859.3C1128.5,-96859.3 1128.5,-96797.92 1128.5,-96797.92"/>
<polygon fill="black" stroke="black" points="1132,-96797.92 1128.5,-96787.92 1125,-96797.92 1132,-96797.92"/>
</g>
<!-- layer30_gate_ar -->
<g id="node777" class="node">
<title>layer30_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1219.5" cy="-96599.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1219.5" y="-96618.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1219.5" y="-96603.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1219.5" y="-96588.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1219.5" y="-96573.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer30_ffn_gate_2&#45;&gt;layer30_gate_ar -->
<g id="edge988" class="edge">
<title>layer30_ffn_gate_2&#45;&gt;layer30_gate_ar</title>
<path fill="none" stroke="black" d="M1002.08,-96753C1012.79,-96753 1020,-96753 1020,-96753 1020,-96753 1020,-96615 1020,-96615 1020,-96615 1088.28,-96615 1088.28,-96615"/>
<polygon fill="black" stroke="black" points="1088.28,-96618.5 1098.28,-96615 1088.28,-96611.5 1088.28,-96618.5"/>
</g>
<!-- layer30_ffn_gate_3&#45;&gt;layer30_gate_ar -->
<g id="edge989" class="edge">
<title>layer30_ffn_gate_3&#45;&gt;layer30_gate_ar</title>
<path fill="none" stroke="black" d="M1301.24,-96719.35C1301.24,-96719.35 1301.24,-96646.52 1301.24,-96646.52"/>
<polygon fill="black" stroke="black" points="1304.74,-96646.52 1301.24,-96636.52 1297.74,-96646.52 1304.74,-96646.52"/>
</g>
<!-- layer30_up_ar -->
<g id="node778" class="node">
<title>layer30_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="873.5" cy="-96599.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="873.5" y="-96618.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="873.5" y="-96603.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="873.5" y="-96588.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="873.5" y="-96573.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer30_ffn_up_2&#45;&gt;layer30_up_ar -->
<g id="edge990" class="edge">
<title>layer30_ffn_up_2&#45;&gt;layer30_up_ar</title>
<path fill="none" stroke="black" d="M765.26,-96719.35C765.26,-96719.35 765.26,-96635.42 765.26,-96635.42"/>
<polygon fill="black" stroke="black" points="768.76,-96635.42 765.26,-96625.42 761.76,-96635.42 768.76,-96635.42"/>
</g>
<!-- layer30_ffn_up_3&#45;&gt;layer30_up_ar -->
<g id="edge991" class="edge">
<title>layer30_ffn_up_3&#45;&gt;layer30_up_ar</title>
<path fill="none" stroke="black" d="M1064.76,-96719.44C1064.76,-96669.67 1064.76,-96583 1064.76,-96583 1064.76,-96583 1003.81,-96583 1003.81,-96583"/>
<polygon fill="black" stroke="black" points="1003.81,-96579.5 993.81,-96583 1003.81,-96586.5 1003.81,-96579.5"/>
</g>
<!-- layer30_silu_2 -->
<g id="node779" class="node">
<title>layer30_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1147,-96479.38 966,-96479.38 966,-96411.38 1147,-96411.38 1147,-96479.38"/>
<text text-anchor="middle" x="1056.5" y="-96464.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1056.5" y="-96449.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1056.5" y="-96434.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1056.5" y="-96419.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_gate_ar&#45;&gt;layer30_silu_2 -->
<g id="edge992" class="edge">
<title>layer30_gate_ar&#45;&gt;layer30_silu_2</title>
<path fill="none" stroke="black" d="M1119.26,-96569.39C1119.26,-96569.39 1119.26,-96489.4 1119.26,-96489.4"/>
<polygon fill="black" stroke="black" points="1122.76,-96489.4 1119.26,-96479.4 1115.76,-96489.4 1122.76,-96489.4"/>
</g>
<!-- layer30_silu_3 -->
<g id="node780" class="node">
<title>layer30_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1364,-96479.38 1183,-96479.38 1183,-96411.38 1364,-96411.38 1364,-96479.38"/>
<text text-anchor="middle" x="1273.5" y="-96464.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1273.5" y="-96449.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1273.5" y="-96434.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1273.5" y="-96419.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_gate_ar&#45;&gt;layer30_silu_3 -->
<g id="edge993" class="edge">
<title>layer30_gate_ar&#45;&gt;layer30_silu_3</title>
<path fill="none" stroke="black" d="M1265.24,-96554.48C1265.24,-96554.48 1265.24,-96489.38 1265.24,-96489.38"/>
<polygon fill="black" stroke="black" points="1268.74,-96489.38 1265.24,-96479.38 1261.74,-96489.38 1268.74,-96489.38"/>
</g>
<!-- layer30_mul_2 -->
<g id="node781" class="node">
<title>layer30_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1037,-96339.38 856,-96339.38 856,-96271.38 1037,-96271.38 1037,-96339.38"/>
<text text-anchor="middle" x="946.5" y="-96324.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="946.5" y="-96309.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="946.5" y="-96294.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="946.5" y="-96279.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_up_ar&#45;&gt;layer30_mul_2 -->
<g id="edge995" class="edge">
<title>layer30_up_ar&#45;&gt;layer30_mul_2</title>
<path fill="none" stroke="black" d="M911,-96553.19C911,-96553.19 911,-96349.46 911,-96349.46"/>
<polygon fill="black" stroke="black" points="914.5,-96349.46 911,-96339.46 907.5,-96349.46 914.5,-96349.46"/>
</g>
<!-- layer30_mul_3 -->
<g id="node782" class="node">
<title>layer30_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1254,-96339.38 1073,-96339.38 1073,-96271.38 1254,-96271.38 1254,-96339.38"/>
<text text-anchor="middle" x="1163.5" y="-96324.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1163.5" y="-96309.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1163.5" y="-96294.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1163.5" y="-96279.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer30_up_ar&#45;&gt;layer30_mul_3 -->
<g id="edge997" class="edge">
<title>layer30_up_ar&#45;&gt;layer30_mul_3</title>
<path fill="none" stroke="black" d="M983.74,-96575.03C983.74,-96550.09 983.74,-96515 983.74,-96515 983.74,-96515 1165,-96515 1165,-96515 1165,-96515 1165,-96349.52 1165,-96349.52"/>
<polygon fill="black" stroke="black" points="1168.5,-96349.52 1165,-96339.52 1161.5,-96349.52 1168.5,-96349.52"/>
</g>
<!-- layer30_silu_2&#45;&gt;layer30_mul_2 -->
<g id="edge994" class="edge">
<title>layer30_silu_2&#45;&gt;layer30_mul_2</title>
<path fill="none" stroke="black" d="M1001.5,-96411.13C1001.5,-96411.13 1001.5,-96349.76 1001.5,-96349.76"/>
<polygon fill="black" stroke="black" points="1005,-96349.76 1001.5,-96339.76 998,-96349.76 1005,-96349.76"/>
</g>
<!-- layer30_silu_3&#45;&gt;layer30_mul_3 -->
<g id="edge996" class="edge">
<title>layer30_silu_3&#45;&gt;layer30_mul_3</title>
<path fill="none" stroke="black" d="M1218.5,-96411.13C1218.5,-96411.13 1218.5,-96349.76 1218.5,-96349.76"/>
<polygon fill="black" stroke="black" points="1222,-96349.76 1218.5,-96339.76 1215,-96349.76 1222,-96349.76"/>
</g>
<!-- layer30_ffn_down_2 -->
<g id="node783" class="node">
<title>layer30_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1036.5,-96199.38 864.5,-96199.38 864.5,-96131.38 1036.5,-96131.38 1036.5,-96199.38"/>
<text text-anchor="middle" x="950.5" y="-96184.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="950.5" y="-96169.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="950.5" y="-96154.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="950.5" y="-96139.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer30_mul_2&#45;&gt;layer30_ffn_down_2 -->
<g id="edge998" class="edge">
<title>layer30_mul_2&#45;&gt;layer30_ffn_down_2</title>
<path fill="none" stroke="black" d="M950.5,-96271.13C950.5,-96271.13 950.5,-96209.76 950.5,-96209.76"/>
<polygon fill="black" stroke="black" points="954,-96209.76 950.5,-96199.76 947,-96209.76 954,-96209.76"/>
</g>
<!-- layer30_ffn_down_3 -->
<g id="node784" class="node">
<title>layer30_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1246.5,-96199.38 1074.5,-96199.38 1074.5,-96131.38 1246.5,-96131.38 1246.5,-96199.38"/>
<text text-anchor="middle" x="1160.5" y="-96184.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1160.5" y="-96169.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1160.5" y="-96154.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1160.5" y="-96139.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer30_mul_3&#45;&gt;layer30_ffn_down_3 -->
<g id="edge999" class="edge">
<title>layer30_mul_3&#45;&gt;layer30_ffn_down_3</title>
<path fill="none" stroke="black" d="M1160.5,-96271.13C1160.5,-96271.13 1160.5,-96209.76 1160.5,-96209.76"/>
<polygon fill="black" stroke="black" points="1164,-96209.76 1160.5,-96199.76 1157,-96209.76 1164,-96209.76"/>
</g>
<!-- layer30_ffn_ar -->
<g id="node785" class="node">
<title>layer30_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1054.5" cy="-96011.29" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1054.5" y="-96030.09" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1054.5" y="-96015.09" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1054.5" y="-96000.09" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1054.5" y="-95985.09" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer30_ffn_down_2&#45;&gt;layer30_ffn_ar -->
<g id="edge1000" class="edge">
<title>layer30_ffn_down_2&#45;&gt;layer30_ffn_ar</title>
<path fill="none" stroke="black" d="M984.69,-96131.18C984.69,-96131.18 984.69,-96060.84 984.69,-96060.84"/>
<polygon fill="black" stroke="black" points="988.19,-96060.84 984.69,-96050.84 981.19,-96060.84 988.19,-96060.84"/>
</g>
<!-- layer30_ffn_down_3&#45;&gt;layer30_ffn_ar -->
<g id="edge1001" class="edge">
<title>layer30_ffn_down_3&#45;&gt;layer30_ffn_ar</title>
<path fill="none" stroke="black" d="M1125.31,-96131.18C1125.31,-96131.18 1125.31,-96060.56 1125.31,-96060.56"/>
<polygon fill="black" stroke="black" points="1128.81,-96060.56 1125.31,-96050.56 1121.81,-96060.56 1128.81,-96060.56"/>
</g>
<!-- layer31_norm_2 -->
<g id="node786" class="node">
<title>layer31_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1036.5,-95891.21 864.5,-95891.21 864.5,-95823.21 1036.5,-95823.21 1036.5,-95891.21"/>
<text text-anchor="middle" x="950.5" y="-95876.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="950.5" y="-95861.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="950.5" y="-95846.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="950.5" y="-95831.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer30_ffn_ar&#45;&gt;layer31_norm_2 -->
<g id="edge1002" class="edge">
<title>layer30_ffn_ar&#45;&gt;layer31_norm_2</title>
<path fill="none" stroke="black" d="M984.69,-95971.61C984.69,-95971.61 984.69,-95901.27 984.69,-95901.27"/>
<polygon fill="black" stroke="black" points="988.19,-95901.27 984.69,-95891.27 981.19,-95901.27 988.19,-95901.27"/>
</g>
<!-- layer31_norm_3 -->
<g id="node787" class="node">
<title>layer31_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1246.5,-95891.21 1074.5,-95891.21 1074.5,-95823.21 1246.5,-95823.21 1246.5,-95891.21"/>
<text text-anchor="middle" x="1160.5" y="-95876.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1160.5" y="-95861.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1160.5" y="-95846.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1160.5" y="-95831.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer30_ffn_ar&#45;&gt;layer31_norm_3 -->
<g id="edge1003" class="edge">
<title>layer30_ffn_ar&#45;&gt;layer31_norm_3</title>
<path fill="none" stroke="black" d="M1125.31,-95972.01C1125.31,-95972.01 1125.31,-95901.44 1125.31,-95901.44"/>
<polygon fill="black" stroke="black" points="1128.81,-95901.44 1125.31,-95891.44 1121.81,-95901.44 1128.81,-95901.44"/>
</g>
<!-- layer31_qkv_2 -->
<g id="node788" class="node">
<title>layer31_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1037,-95751.21 856,-95751.21 856,-95683.21 1037,-95683.21 1037,-95751.21"/>
<text text-anchor="middle" x="946.5" y="-95736.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="946.5" y="-95721.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="946.5" y="-95706.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="946.5" y="-95691.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer31_norm_2&#45;&gt;layer31_qkv_2 -->
<g id="edge1004" class="edge">
<title>layer31_norm_2&#45;&gt;layer31_qkv_2</title>
<path fill="none" stroke="black" d="M950.5,-95822.96C950.5,-95822.96 950.5,-95761.59 950.5,-95761.59"/>
<polygon fill="black" stroke="black" points="954,-95761.59 950.5,-95751.59 947,-95761.59 954,-95761.59"/>
</g>
<!-- layer31_qkv_3 -->
<g id="node789" class="node">
<title>layer31_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1254,-95751.21 1073,-95751.21 1073,-95683.21 1254,-95683.21 1254,-95751.21"/>
<text text-anchor="middle" x="1163.5" y="-95736.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1163.5" y="-95721.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1163.5" y="-95706.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1163.5" y="-95691.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer31_norm_3&#45;&gt;layer31_qkv_3 -->
<g id="edge1005" class="edge">
<title>layer31_norm_3&#45;&gt;layer31_qkv_3</title>
<path fill="none" stroke="black" d="M1160.5,-95822.96C1160.5,-95822.96 1160.5,-95761.59 1160.5,-95761.59"/>
<polygon fill="black" stroke="black" points="1164,-95761.59 1160.5,-95751.59 1157,-95761.59 1164,-95761.59"/>
</g>
<!-- layer31_qkv_ar -->
<g id="node790" class="node">
<title>layer31_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1054.5" cy="-95563.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1054.5" y="-95581.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1054.5" y="-95566.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1054.5" y="-95551.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1054.5" y="-95536.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer31_qkv_2&#45;&gt;layer31_qkv_ar -->
<g id="edge1006" class="edge">
<title>layer31_qkv_2&#45;&gt;layer31_qkv_ar</title>
<path fill="none" stroke="black" d="M981.76,-95683.02C981.76,-95683.02 981.76,-95612.95 981.76,-95612.95"/>
<polygon fill="black" stroke="black" points="985.26,-95612.95 981.76,-95602.95 978.26,-95612.95 985.26,-95612.95"/>
</g>
<!-- layer31_qkv_3&#45;&gt;layer31_qkv_ar -->
<g id="edge1007" class="edge">
<title>layer31_qkv_3&#45;&gt;layer31_qkv_ar</title>
<path fill="none" stroke="black" d="M1127.74,-95683.02C1127.74,-95683.02 1127.74,-95612.67 1127.74,-95612.67"/>
<polygon fill="black" stroke="black" points="1131.24,-95612.67 1127.74,-95602.67 1124.24,-95612.67 1131.24,-95612.67"/>
</g>
<!-- layer31_attn_2 -->
<g id="node791" class="node">
<title>layer31_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1036.5,-95443.04 864.5,-95443.04 864.5,-95375.04 1036.5,-95375.04 1036.5,-95443.04"/>
<text text-anchor="middle" x="950.5" y="-95427.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="950.5" y="-95412.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="950.5" y="-95397.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="950.5" y="-95382.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer31_qkv_ar&#45;&gt;layer31_attn_2 -->
<g id="edge1008" class="edge">
<title>layer31_qkv_ar&#45;&gt;layer31_attn_2</title>
<path fill="none" stroke="black" d="M981.51,-95523.45C981.51,-95523.45 981.51,-95453.1 981.51,-95453.1"/>
<polygon fill="black" stroke="black" points="985.01,-95453.1 981.51,-95443.1 978.01,-95453.1 985.01,-95453.1"/>
</g>
<!-- layer31_attn_3 -->
<g id="node792" class="node">
<title>layer31_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1244.5,-95443.04 1072.5,-95443.04 1072.5,-95375.04 1244.5,-95375.04 1244.5,-95443.04"/>
<text text-anchor="middle" x="1158.5" y="-95427.84" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1158.5" y="-95412.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1158.5" y="-95397.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1158.5" y="-95382.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer31_qkv_ar&#45;&gt;layer31_attn_3 -->
<g id="edge1009" class="edge">
<title>layer31_qkv_ar&#45;&gt;layer31_attn_3</title>
<path fill="none" stroke="black" d="M1127.49,-95523.45C1127.49,-95523.45 1127.49,-95453.1 1127.49,-95453.1"/>
<polygon fill="black" stroke="black" points="1130.99,-95453.1 1127.49,-95443.1 1123.99,-95453.1 1130.99,-95453.1"/>
</g>
<!-- layer31_attn_out_2 -->
<g id="node793" class="node">
<title>layer31_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1036.5,-95303.04 864.5,-95303.04 864.5,-95235.04 1036.5,-95235.04 1036.5,-95303.04"/>
<text text-anchor="middle" x="950.5" y="-95287.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="950.5" y="-95272.84" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="950.5" y="-95257.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="950.5" y="-95242.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer31_attn_2&#45;&gt;layer31_attn_out_2 -->
<g id="edge1010" class="edge">
<title>layer31_attn_2&#45;&gt;layer31_attn_out_2</title>
<path fill="none" stroke="black" d="M950.5,-95374.8C950.5,-95374.8 950.5,-95313.42 950.5,-95313.42"/>
<polygon fill="black" stroke="black" points="954,-95313.42 950.5,-95303.42 947,-95313.42 954,-95313.42"/>
</g>
<!-- layer31_attn_out_3 -->
<g id="node794" class="node">
<title>layer31_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1244.5,-95303.04 1072.5,-95303.04 1072.5,-95235.04 1244.5,-95235.04 1244.5,-95303.04"/>
<text text-anchor="middle" x="1158.5" y="-95287.84" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1158.5" y="-95272.84" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1158.5" y="-95257.84" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1158.5" y="-95242.84" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer31_attn_3&#45;&gt;layer31_attn_out_3 -->
<g id="edge1011" class="edge">
<title>layer31_attn_3&#45;&gt;layer31_attn_out_3</title>
<path fill="none" stroke="black" d="M1158.5,-95374.8C1158.5,-95374.8 1158.5,-95313.42 1158.5,-95313.42"/>
<polygon fill="black" stroke="black" points="1162,-95313.42 1158.5,-95303.42 1155,-95313.42 1162,-95313.42"/>
</g>
<!-- layer31_attn_ar -->
<g id="node795" class="node">
<title>layer31_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1054.5" cy="-95114.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1054.5" y="-95133.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1054.5" y="-95118.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1054.5" y="-95103.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1054.5" y="-95088.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer31_attn_out_2&#45;&gt;layer31_attn_ar -->
<g id="edge1012" class="edge">
<title>layer31_attn_out_2&#45;&gt;layer31_attn_ar</title>
<path fill="none" stroke="black" d="M984.69,-95234.85C984.69,-95234.85 984.69,-95164.5 984.69,-95164.5"/>
<polygon fill="black" stroke="black" points="988.19,-95164.5 984.69,-95154.5 981.19,-95164.5 988.19,-95164.5"/>
</g>
<!-- layer31_attn_out_3&#45;&gt;layer31_attn_ar -->
<g id="edge1013" class="edge">
<title>layer31_attn_out_3&#45;&gt;layer31_attn_ar</title>
<path fill="none" stroke="black" d="M1124.31,-95234.85C1124.31,-95234.85 1124.31,-95164.5 1124.31,-95164.5"/>
<polygon fill="black" stroke="black" points="1127.81,-95164.5 1124.31,-95154.5 1120.81,-95164.5 1127.81,-95164.5"/>
</g>
<!-- layer31_ffn_norm_2 -->
<g id="node796" class="node">
<title>layer31_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1032.5,-94994.88 860.5,-94994.88 860.5,-94926.88 1032.5,-94926.88 1032.5,-94994.88"/>
<text text-anchor="middle" x="946.5" y="-94979.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="946.5" y="-94964.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="946.5" y="-94949.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="946.5" y="-94934.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer31_attn_ar&#45;&gt;layer31_ffn_norm_2 -->
<g id="edge1014" class="edge">
<title>layer31_attn_ar&#45;&gt;layer31_ffn_norm_2</title>
<path fill="none" stroke="black" d="M982.69,-95076.08C982.69,-95076.08 982.69,-95005.03 982.69,-95005.03"/>
<polygon fill="black" stroke="black" points="986.19,-95005.03 982.69,-94995.03 979.19,-95005.03 986.19,-95005.03"/>
</g>
<!-- layer31_ffn_norm_3 -->
<g id="node797" class="node">
<title>layer31_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1249.5,-94994.88 1077.5,-94994.88 1077.5,-94926.88 1249.5,-94926.88 1249.5,-94994.88"/>
<text text-anchor="middle" x="1163.5" y="-94979.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1163.5" y="-94964.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1163.5" y="-94949.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1163.5" y="-94934.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer31_attn_ar&#45;&gt;layer31_ffn_norm_3 -->
<g id="edge1015" class="edge">
<title>layer31_attn_ar&#45;&gt;layer31_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1126.81,-95076.08C1126.81,-95076.08 1126.81,-95005.03 1126.81,-95005.03"/>
<polygon fill="black" stroke="black" points="1130.31,-95005.03 1126.81,-94995.03 1123.31,-95005.03 1130.31,-95005.03"/>
</g>
<!-- layer31_ffn_gate_2 -->
<g id="node798" class="node">
<title>layer31_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1037,-94854.88 856,-94854.88 856,-94786.88 1037,-94786.88 1037,-94854.88"/>
<text text-anchor="middle" x="946.5" y="-94839.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="946.5" y="-94824.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="946.5" y="-94809.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="946.5" y="-94794.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_ffn_norm_2&#45;&gt;layer31_ffn_gate_2 -->
<g id="edge1016" class="edge">
<title>layer31_ffn_norm_2&#45;&gt;layer31_ffn_gate_2</title>
<path fill="none" stroke="black" d="M946.5,-94926.63C946.5,-94926.63 946.5,-94865.26 946.5,-94865.26"/>
<polygon fill="black" stroke="black" points="950,-94865.26 946.5,-94855.26 943,-94865.26 950,-94865.26"/>
</g>
<!-- layer31_ffn_up_2 -->
<g id="node800" class="node">
<title>layer31_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="820,-94854.88 639,-94854.88 639,-94786.88 820,-94786.88 820,-94854.88"/>
<text text-anchor="middle" x="729.5" y="-94839.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="729.5" y="-94824.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="729.5" y="-94809.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="729.5" y="-94794.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_ffn_norm_2&#45;&gt;layer31_ffn_up_2 -->
<g id="edge1018" class="edge">
<title>layer31_ffn_norm_2&#45;&gt;layer31_ffn_up_2</title>
<path fill="none" stroke="black" d="M860.31,-94960C820.86,-94960 782.76,-94960 782.76,-94960 782.76,-94960 782.76,-94864.91 782.76,-94864.91"/>
<polygon fill="black" stroke="black" points="786.26,-94864.91 782.76,-94854.91 779.26,-94864.91 786.26,-94864.91"/>
</g>
<!-- layer31_ffn_gate_3 -->
<g id="node799" class="node">
<title>layer31_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1471,-94854.88 1290,-94854.88 1290,-94786.88 1471,-94786.88 1471,-94854.88"/>
<text text-anchor="middle" x="1380.5" y="-94839.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1380.5" y="-94824.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1380.5" y="-94809.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1380.5" y="-94794.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_ffn_norm_3&#45;&gt;layer31_ffn_gate_3 -->
<g id="edge1017" class="edge">
<title>layer31_ffn_norm_3&#45;&gt;layer31_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1249.56,-94960C1288.95,-94960 1327,-94960 1327,-94960 1327,-94960 1327,-94864.91 1327,-94864.91"/>
<polygon fill="black" stroke="black" points="1330.5,-94864.91 1327,-94854.91 1323.5,-94864.91 1330.5,-94864.91"/>
</g>
<!-- layer31_ffn_up_3 -->
<g id="node801" class="node">
<title>layer31_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1254,-94854.88 1073,-94854.88 1073,-94786.88 1254,-94786.88 1254,-94854.88"/>
<text text-anchor="middle" x="1163.5" y="-94839.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1163.5" y="-94824.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1163.5" y="-94809.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1163.5" y="-94794.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_ffn_norm_3&#45;&gt;layer31_ffn_up_3 -->
<g id="edge1019" class="edge">
<title>layer31_ffn_norm_3&#45;&gt;layer31_ffn_up_3</title>
<path fill="none" stroke="black" d="M1163.5,-94926.63C1163.5,-94926.63 1163.5,-94865.26 1163.5,-94865.26"/>
<polygon fill="black" stroke="black" points="1167,-94865.26 1163.5,-94855.26 1160,-94865.26 1167,-94865.26"/>
</g>
<!-- layer31_gate_ar -->
<g id="node802" class="node">
<title>layer31_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1254.5" cy="-94666.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1254.5" y="-94685.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1254.5" y="-94670.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1254.5" y="-94655.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1254.5" y="-94640.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer31_ffn_gate_2&#45;&gt;layer31_gate_ar -->
<g id="edge1020" class="edge">
<title>layer31_ffn_gate_2&#45;&gt;layer31_gate_ar</title>
<path fill="none" stroke="black" d="M1037.08,-94820C1047.79,-94820 1055,-94820 1055,-94820 1055,-94820 1055,-94682 1055,-94682 1055,-94682 1122.99,-94682 1122.99,-94682"/>
<polygon fill="black" stroke="black" points="1122.99,-94685.5 1132.99,-94682 1122.99,-94678.5 1122.99,-94685.5"/>
</g>
<!-- layer31_ffn_gate_3&#45;&gt;layer31_gate_ar -->
<g id="edge1021" class="edge">
<title>layer31_ffn_gate_3&#45;&gt;layer31_gate_ar</title>
<path fill="none" stroke="black" d="M1336.24,-94786.68C1336.24,-94786.68 1336.24,-94713.86 1336.24,-94713.86"/>
<polygon fill="black" stroke="black" points="1339.74,-94713.86 1336.24,-94703.86 1332.74,-94713.86 1339.74,-94713.86"/>
</g>
<!-- layer31_up_ar -->
<g id="node803" class="node">
<title>layer31_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="908.5" cy="-94666.79" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="908.5" y="-94685.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="908.5" y="-94670.59" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="908.5" y="-94655.59" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="908.5" y="-94640.59" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer31_ffn_up_2&#45;&gt;layer31_up_ar -->
<g id="edge1022" class="edge">
<title>layer31_ffn_up_2&#45;&gt;layer31_up_ar</title>
<path fill="none" stroke="black" d="M800.26,-94786.68C800.26,-94786.68 800.26,-94702.76 800.26,-94702.76"/>
<polygon fill="black" stroke="black" points="803.76,-94702.76 800.26,-94692.76 796.76,-94702.76 803.76,-94702.76"/>
</g>
<!-- layer31_ffn_up_3&#45;&gt;layer31_up_ar -->
<g id="edge1023" class="edge">
<title>layer31_ffn_up_3&#45;&gt;layer31_up_ar</title>
<path fill="none" stroke="black" d="M1099.76,-94786.71C1099.76,-94736.84 1099.76,-94650 1099.76,-94650 1099.76,-94650 1038.54,-94650 1038.54,-94650"/>
<polygon fill="black" stroke="black" points="1038.54,-94646.5 1028.54,-94650 1038.54,-94653.5 1038.54,-94646.5"/>
</g>
<!-- layer31_silu_2 -->
<g id="node804" class="node">
<title>layer31_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1182,-94546.71 1001,-94546.71 1001,-94478.71 1182,-94478.71 1182,-94546.71"/>
<text text-anchor="middle" x="1091.5" y="-94531.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1091.5" y="-94516.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1091.5" y="-94501.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1091.5" y="-94486.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_gate_ar&#45;&gt;layer31_silu_2 -->
<g id="edge1024" class="edge">
<title>layer31_gate_ar&#45;&gt;layer31_silu_2</title>
<path fill="none" stroke="black" d="M1154.26,-94636.72C1154.26,-94636.72 1154.26,-94556.73 1154.26,-94556.73"/>
<polygon fill="black" stroke="black" points="1157.76,-94556.73 1154.26,-94546.73 1150.76,-94556.73 1157.76,-94556.73"/>
</g>
<!-- layer31_silu_3 -->
<g id="node805" class="node">
<title>layer31_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1399,-94546.71 1218,-94546.71 1218,-94478.71 1399,-94478.71 1399,-94546.71"/>
<text text-anchor="middle" x="1308.5" y="-94531.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1308.5" y="-94516.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1308.5" y="-94501.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1308.5" y="-94486.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_gate_ar&#45;&gt;layer31_silu_3 -->
<g id="edge1025" class="edge">
<title>layer31_gate_ar&#45;&gt;layer31_silu_3</title>
<path fill="none" stroke="black" d="M1300.24,-94621.81C1300.24,-94621.81 1300.24,-94556.72 1300.24,-94556.72"/>
<polygon fill="black" stroke="black" points="1303.74,-94556.72 1300.24,-94546.72 1296.74,-94556.72 1303.74,-94556.72"/>
</g>
<!-- layer31_mul_2 -->
<g id="node806" class="node">
<title>layer31_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1072,-94406.71 891,-94406.71 891,-94338.71 1072,-94338.71 1072,-94406.71"/>
<text text-anchor="middle" x="981.5" y="-94391.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="981.5" y="-94376.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="981.5" y="-94361.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="981.5" y="-94346.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_up_ar&#45;&gt;layer31_mul_2 -->
<g id="edge1027" class="edge">
<title>layer31_up_ar&#45;&gt;layer31_mul_2</title>
<path fill="none" stroke="black" d="M946,-94620.52C946,-94620.52 946,-94416.8 946,-94416.8"/>
<polygon fill="black" stroke="black" points="949.5,-94416.8 946,-94406.8 942.5,-94416.8 949.5,-94416.8"/>
</g>
<!-- layer31_mul_3 -->
<g id="node807" class="node">
<title>layer31_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1289,-94406.71 1108,-94406.71 1108,-94338.71 1289,-94338.71 1289,-94406.71"/>
<text text-anchor="middle" x="1198.5" y="-94391.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1198.5" y="-94376.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1198.5" y="-94361.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1198.5" y="-94346.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer31_up_ar&#45;&gt;layer31_mul_3 -->
<g id="edge1029" class="edge">
<title>layer31_up_ar&#45;&gt;layer31_mul_3</title>
<path fill="none" stroke="black" d="M1018.74,-94642.27C1018.74,-94617.23 1018.74,-94582 1018.74,-94582 1018.74,-94582 1200,-94582 1200,-94582 1200,-94582 1200,-94416.8 1200,-94416.8"/>
<polygon fill="black" stroke="black" points="1203.5,-94416.8 1200,-94406.8 1196.5,-94416.8 1203.5,-94416.8"/>
</g>
<!-- layer31_silu_2&#45;&gt;layer31_mul_2 -->
<g id="edge1026" class="edge">
<title>layer31_silu_2&#45;&gt;layer31_mul_2</title>
<path fill="none" stroke="black" d="M1036.5,-94478.46C1036.5,-94478.46 1036.5,-94417.09 1036.5,-94417.09"/>
<polygon fill="black" stroke="black" points="1040,-94417.09 1036.5,-94407.09 1033,-94417.09 1040,-94417.09"/>
</g>
<!-- layer31_silu_3&#45;&gt;layer31_mul_3 -->
<g id="edge1028" class="edge">
<title>layer31_silu_3&#45;&gt;layer31_mul_3</title>
<path fill="none" stroke="black" d="M1253.5,-94478.46C1253.5,-94478.46 1253.5,-94417.09 1253.5,-94417.09"/>
<polygon fill="black" stroke="black" points="1257,-94417.09 1253.5,-94407.09 1250,-94417.09 1257,-94417.09"/>
</g>
<!-- layer31_ffn_down_2 -->
<g id="node808" class="node">
<title>layer31_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1071.5,-94266.71 899.5,-94266.71 899.5,-94198.71 1071.5,-94198.71 1071.5,-94266.71"/>
<text text-anchor="middle" x="985.5" y="-94251.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="985.5" y="-94236.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="985.5" y="-94221.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="985.5" y="-94206.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer31_mul_2&#45;&gt;layer31_ffn_down_2 -->
<g id="edge1030" class="edge">
<title>layer31_mul_2&#45;&gt;layer31_ffn_down_2</title>
<path fill="none" stroke="black" d="M985.5,-94338.46C985.5,-94338.46 985.5,-94277.09 985.5,-94277.09"/>
<polygon fill="black" stroke="black" points="989,-94277.09 985.5,-94267.09 982,-94277.09 989,-94277.09"/>
</g>
<!-- layer31_ffn_down_3 -->
<g id="node809" class="node">
<title>layer31_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1281.5,-94266.71 1109.5,-94266.71 1109.5,-94198.71 1281.5,-94198.71 1281.5,-94266.71"/>
<text text-anchor="middle" x="1195.5" y="-94251.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1195.5" y="-94236.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1195.5" y="-94221.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1195.5" y="-94206.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer31_mul_3&#45;&gt;layer31_ffn_down_3 -->
<g id="edge1031" class="edge">
<title>layer31_mul_3&#45;&gt;layer31_ffn_down_3</title>
<path fill="none" stroke="black" d="M1195.5,-94338.46C1195.5,-94338.46 1195.5,-94277.09 1195.5,-94277.09"/>
<polygon fill="black" stroke="black" points="1199,-94277.09 1195.5,-94267.09 1192,-94277.09 1199,-94277.09"/>
</g>
<!-- layer31_ffn_ar -->
<g id="node810" class="node">
<title>layer31_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1089.5" cy="-94078.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1089.5" y="-94097.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1089.5" y="-94082.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1089.5" y="-94067.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1089.5" y="-94052.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer31_ffn_down_2&#45;&gt;layer31_ffn_ar -->
<g id="edge1032" class="edge">
<title>layer31_ffn_down_2&#45;&gt;layer31_ffn_ar</title>
<path fill="none" stroke="black" d="M1019.69,-94198.52C1019.69,-94198.52 1019.69,-94128.17 1019.69,-94128.17"/>
<polygon fill="black" stroke="black" points="1023.19,-94128.17 1019.69,-94118.17 1016.19,-94128.17 1023.19,-94128.17"/>
</g>
<!-- layer31_ffn_down_3&#45;&gt;layer31_ffn_ar -->
<g id="edge1033" class="edge">
<title>layer31_ffn_down_3&#45;&gt;layer31_ffn_ar</title>
<path fill="none" stroke="black" d="M1160.31,-94198.52C1160.31,-94198.52 1160.31,-94127.89 1160.31,-94127.89"/>
<polygon fill="black" stroke="black" points="1163.81,-94127.89 1160.31,-94117.89 1156.81,-94127.89 1163.81,-94127.89"/>
</g>
<!-- layer32_norm_2 -->
<g id="node811" class="node">
<title>layer32_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1071.5,-93958.54 899.5,-93958.54 899.5,-93890.54 1071.5,-93890.54 1071.5,-93958.54"/>
<text text-anchor="middle" x="985.5" y="-93943.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="985.5" y="-93928.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="985.5" y="-93913.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="985.5" y="-93898.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer31_ffn_ar&#45;&gt;layer32_norm_2 -->
<g id="edge1034" class="edge">
<title>layer31_ffn_ar&#45;&gt;layer32_norm_2</title>
<path fill="none" stroke="black" d="M1019.69,-94038.95C1019.69,-94038.95 1019.69,-93968.6 1019.69,-93968.6"/>
<polygon fill="black" stroke="black" points="1023.19,-93968.6 1019.69,-93958.6 1016.19,-93968.6 1023.19,-93968.6"/>
</g>
<!-- layer32_norm_3 -->
<g id="node812" class="node">
<title>layer32_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1281.5,-93958.54 1109.5,-93958.54 1109.5,-93890.54 1281.5,-93890.54 1281.5,-93958.54"/>
<text text-anchor="middle" x="1195.5" y="-93943.34" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1195.5" y="-93928.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1195.5" y="-93913.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1195.5" y="-93898.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer31_ffn_ar&#45;&gt;layer32_norm_3 -->
<g id="edge1035" class="edge">
<title>layer31_ffn_ar&#45;&gt;layer32_norm_3</title>
<path fill="none" stroke="black" d="M1160.31,-94039.35C1160.31,-94039.35 1160.31,-93968.78 1160.31,-93968.78"/>
<polygon fill="black" stroke="black" points="1163.81,-93968.78 1160.31,-93958.78 1156.81,-93968.78 1163.81,-93968.78"/>
</g>
<!-- layer32_qkv_2 -->
<g id="node813" class="node">
<title>layer32_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1072,-93818.54 891,-93818.54 891,-93750.54 1072,-93750.54 1072,-93818.54"/>
<text text-anchor="middle" x="981.5" y="-93803.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="981.5" y="-93788.34" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="981.5" y="-93773.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="981.5" y="-93758.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer32_norm_2&#45;&gt;layer32_qkv_2 -->
<g id="edge1036" class="edge">
<title>layer32_norm_2&#45;&gt;layer32_qkv_2</title>
<path fill="none" stroke="black" d="M985.5,-93890.3C985.5,-93890.3 985.5,-93828.92 985.5,-93828.92"/>
<polygon fill="black" stroke="black" points="989,-93828.92 985.5,-93818.92 982,-93828.92 989,-93828.92"/>
</g>
<!-- layer32_qkv_3 -->
<g id="node814" class="node">
<title>layer32_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1289,-93818.54 1108,-93818.54 1108,-93750.54 1289,-93750.54 1289,-93818.54"/>
<text text-anchor="middle" x="1198.5" y="-93803.34" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1198.5" y="-93788.34" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1198.5" y="-93773.34" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1198.5" y="-93758.34" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer32_norm_3&#45;&gt;layer32_qkv_3 -->
<g id="edge1037" class="edge">
<title>layer32_norm_3&#45;&gt;layer32_qkv_3</title>
<path fill="none" stroke="black" d="M1195.5,-93890.3C1195.5,-93890.3 1195.5,-93828.92 1195.5,-93828.92"/>
<polygon fill="black" stroke="black" points="1199,-93828.92 1195.5,-93818.92 1192,-93828.92 1199,-93828.92"/>
</g>
<!-- layer32_qkv_ar -->
<g id="node815" class="node">
<title>layer32_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1089.5" cy="-93630.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1089.5" y="-93649.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1089.5" y="-93634.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1089.5" y="-93619.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1089.5" y="-93604.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer32_qkv_2&#45;&gt;layer32_qkv_ar -->
<g id="edge1038" class="edge">
<title>layer32_qkv_2&#45;&gt;layer32_qkv_ar</title>
<path fill="none" stroke="black" d="M1016.76,-93750.35C1016.76,-93750.35 1016.76,-93680.28 1016.76,-93680.28"/>
<polygon fill="black" stroke="black" points="1020.26,-93680.28 1016.76,-93670.28 1013.26,-93680.28 1020.26,-93680.28"/>
</g>
<!-- layer32_qkv_3&#45;&gt;layer32_qkv_ar -->
<g id="edge1039" class="edge">
<title>layer32_qkv_3&#45;&gt;layer32_qkv_ar</title>
<path fill="none" stroke="black" d="M1162.74,-93750.35C1162.74,-93750.35 1162.74,-93680 1162.74,-93680"/>
<polygon fill="black" stroke="black" points="1166.24,-93680 1162.74,-93670 1159.24,-93680 1166.24,-93680"/>
</g>
<!-- layer32_attn_2 -->
<g id="node816" class="node">
<title>layer32_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1071.5,-93510.38 899.5,-93510.38 899.5,-93442.38 1071.5,-93442.38 1071.5,-93510.38"/>
<text text-anchor="middle" x="985.5" y="-93495.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="985.5" y="-93480.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="985.5" y="-93465.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="985.5" y="-93450.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer32_qkv_ar&#45;&gt;layer32_attn_2 -->
<g id="edge1040" class="edge">
<title>layer32_qkv_ar&#45;&gt;layer32_attn_2</title>
<path fill="none" stroke="black" d="M1016.51,-93590.78C1016.51,-93590.78 1016.51,-93520.44 1016.51,-93520.44"/>
<polygon fill="black" stroke="black" points="1020.01,-93520.44 1016.51,-93510.44 1013.01,-93520.44 1020.01,-93520.44"/>
</g>
<!-- layer32_attn_3 -->
<g id="node817" class="node">
<title>layer32_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1279.5,-93510.38 1107.5,-93510.38 1107.5,-93442.38 1279.5,-93442.38 1279.5,-93510.38"/>
<text text-anchor="middle" x="1193.5" y="-93495.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1193.5" y="-93480.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1193.5" y="-93465.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1193.5" y="-93450.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer32_qkv_ar&#45;&gt;layer32_attn_3 -->
<g id="edge1041" class="edge">
<title>layer32_qkv_ar&#45;&gt;layer32_attn_3</title>
<path fill="none" stroke="black" d="M1162.49,-93590.78C1162.49,-93590.78 1162.49,-93520.44 1162.49,-93520.44"/>
<polygon fill="black" stroke="black" points="1165.99,-93520.44 1162.49,-93510.44 1158.99,-93520.44 1165.99,-93520.44"/>
</g>
<!-- layer32_attn_out_2 -->
<g id="node818" class="node">
<title>layer32_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1071.5,-93370.38 899.5,-93370.38 899.5,-93302.38 1071.5,-93302.38 1071.5,-93370.38"/>
<text text-anchor="middle" x="985.5" y="-93355.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="985.5" y="-93340.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="985.5" y="-93325.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="985.5" y="-93310.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer32_attn_2&#45;&gt;layer32_attn_out_2 -->
<g id="edge1042" class="edge">
<title>layer32_attn_2&#45;&gt;layer32_attn_out_2</title>
<path fill="none" stroke="black" d="M985.5,-93442.13C985.5,-93442.13 985.5,-93380.76 985.5,-93380.76"/>
<polygon fill="black" stroke="black" points="989,-93380.76 985.5,-93370.76 982,-93380.76 989,-93380.76"/>
</g>
<!-- layer32_attn_out_3 -->
<g id="node819" class="node">
<title>layer32_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1279.5,-93370.38 1107.5,-93370.38 1107.5,-93302.38 1279.5,-93302.38 1279.5,-93370.38"/>
<text text-anchor="middle" x="1193.5" y="-93355.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1193.5" y="-93340.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1193.5" y="-93325.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1193.5" y="-93310.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer32_attn_3&#45;&gt;layer32_attn_out_3 -->
<g id="edge1043" class="edge">
<title>layer32_attn_3&#45;&gt;layer32_attn_out_3</title>
<path fill="none" stroke="black" d="M1193.5,-93442.13C1193.5,-93442.13 1193.5,-93380.76 1193.5,-93380.76"/>
<polygon fill="black" stroke="black" points="1197,-93380.76 1193.5,-93370.76 1190,-93380.76 1197,-93380.76"/>
</g>
<!-- layer32_attn_ar -->
<g id="node820" class="node">
<title>layer32_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1089.5" cy="-93182.3" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1089.5" y="-93201.1" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1089.5" y="-93186.1" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1089.5" y="-93171.1" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1089.5" y="-93156.1" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer32_attn_out_2&#45;&gt;layer32_attn_ar -->
<g id="edge1044" class="edge">
<title>layer32_attn_out_2&#45;&gt;layer32_attn_ar</title>
<path fill="none" stroke="black" d="M1019.69,-93302.18C1019.69,-93302.18 1019.69,-93231.84 1019.69,-93231.84"/>
<polygon fill="black" stroke="black" points="1023.19,-93231.84 1019.69,-93221.84 1016.19,-93231.84 1023.19,-93231.84"/>
</g>
<!-- layer32_attn_out_3&#45;&gt;layer32_attn_ar -->
<g id="edge1045" class="edge">
<title>layer32_attn_out_3&#45;&gt;layer32_attn_ar</title>
<path fill="none" stroke="black" d="M1159.31,-93302.18C1159.31,-93302.18 1159.31,-93231.84 1159.31,-93231.84"/>
<polygon fill="black" stroke="black" points="1162.81,-93231.84 1159.31,-93221.84 1155.81,-93231.84 1162.81,-93231.84"/>
</g>
<!-- layer32_ffn_norm_2 -->
<g id="node821" class="node">
<title>layer32_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1067.5,-93062.21 895.5,-93062.21 895.5,-92994.21 1067.5,-92994.21 1067.5,-93062.21"/>
<text text-anchor="middle" x="981.5" y="-93047.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="981.5" y="-93032.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="981.5" y="-93017.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="981.5" y="-93002.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer32_attn_ar&#45;&gt;layer32_ffn_norm_2 -->
<g id="edge1046" class="edge">
<title>layer32_attn_ar&#45;&gt;layer32_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1017.69,-93143.41C1017.69,-93143.41 1017.69,-93072.36 1017.69,-93072.36"/>
<polygon fill="black" stroke="black" points="1021.19,-93072.36 1017.69,-93062.36 1014.19,-93072.36 1021.19,-93072.36"/>
</g>
<!-- layer32_ffn_norm_3 -->
<g id="node822" class="node">
<title>layer32_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1284.5,-93062.21 1112.5,-93062.21 1112.5,-92994.21 1284.5,-92994.21 1284.5,-93062.21"/>
<text text-anchor="middle" x="1198.5" y="-93047.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1198.5" y="-93032.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1198.5" y="-93017.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1198.5" y="-93002.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer32_attn_ar&#45;&gt;layer32_ffn_norm_3 -->
<g id="edge1047" class="edge">
<title>layer32_attn_ar&#45;&gt;layer32_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1161.81,-93143.41C1161.81,-93143.41 1161.81,-93072.36 1161.81,-93072.36"/>
<polygon fill="black" stroke="black" points="1165.31,-93072.36 1161.81,-93062.36 1158.31,-93072.36 1165.31,-93072.36"/>
</g>
<!-- layer32_ffn_gate_2 -->
<g id="node823" class="node">
<title>layer32_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1072,-92922.21 891,-92922.21 891,-92854.21 1072,-92854.21 1072,-92922.21"/>
<text text-anchor="middle" x="981.5" y="-92907.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="981.5" y="-92892.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="981.5" y="-92877.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="981.5" y="-92862.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_ffn_norm_2&#45;&gt;layer32_ffn_gate_2 -->
<g id="edge1048" class="edge">
<title>layer32_ffn_norm_2&#45;&gt;layer32_ffn_gate_2</title>
<path fill="none" stroke="black" d="M981.5,-92993.96C981.5,-92993.96 981.5,-92932.59 981.5,-92932.59"/>
<polygon fill="black" stroke="black" points="985,-92932.59 981.5,-92922.59 978,-92932.59 985,-92932.59"/>
</g>
<!-- layer32_ffn_up_2 -->
<g id="node825" class="node">
<title>layer32_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="855,-92922.21 674,-92922.21 674,-92854.21 855,-92854.21 855,-92922.21"/>
<text text-anchor="middle" x="764.5" y="-92907.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="764.5" y="-92892.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="764.5" y="-92877.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="764.5" y="-92862.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_ffn_norm_2&#45;&gt;layer32_ffn_up_2 -->
<g id="edge1050" class="edge">
<title>layer32_ffn_norm_2&#45;&gt;layer32_ffn_up_2</title>
<path fill="none" stroke="black" d="M895.31,-93028C855.86,-93028 817.76,-93028 817.76,-93028 817.76,-93028 817.76,-92932.41 817.76,-92932.41"/>
<polygon fill="black" stroke="black" points="821.26,-92932.41 817.76,-92922.41 814.26,-92932.41 821.26,-92932.41"/>
</g>
<!-- layer32_ffn_gate_3 -->
<g id="node824" class="node">
<title>layer32_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1506,-92922.21 1325,-92922.21 1325,-92854.21 1506,-92854.21 1506,-92922.21"/>
<text text-anchor="middle" x="1415.5" y="-92907.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1415.5" y="-92892.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1415.5" y="-92877.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1415.5" y="-92862.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_ffn_norm_3&#45;&gt;layer32_ffn_gate_3 -->
<g id="edge1049" class="edge">
<title>layer32_ffn_norm_3&#45;&gt;layer32_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1284.56,-93028C1323.95,-93028 1362,-93028 1362,-93028 1362,-93028 1362,-92932.41 1362,-92932.41"/>
<polygon fill="black" stroke="black" points="1365.5,-92932.41 1362,-92922.41 1358.5,-92932.41 1365.5,-92932.41"/>
</g>
<!-- layer32_ffn_up_3 -->
<g id="node826" class="node">
<title>layer32_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1289,-92922.21 1108,-92922.21 1108,-92854.21 1289,-92854.21 1289,-92922.21"/>
<text text-anchor="middle" x="1198.5" y="-92907.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1198.5" y="-92892.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1198.5" y="-92877.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1198.5" y="-92862.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_ffn_norm_3&#45;&gt;layer32_ffn_up_3 -->
<g id="edge1051" class="edge">
<title>layer32_ffn_norm_3&#45;&gt;layer32_ffn_up_3</title>
<path fill="none" stroke="black" d="M1198.5,-92993.96C1198.5,-92993.96 1198.5,-92932.59 1198.5,-92932.59"/>
<polygon fill="black" stroke="black" points="1202,-92932.59 1198.5,-92922.59 1195,-92932.59 1202,-92932.59"/>
</g>
<!-- layer32_gate_ar -->
<g id="node827" class="node">
<title>layer32_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1289.5" cy="-92734.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1289.5" y="-92752.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1289.5" y="-92737.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1289.5" y="-92722.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1289.5" y="-92707.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer32_ffn_gate_2&#45;&gt;layer32_gate_ar -->
<g id="edge1052" class="edge">
<title>layer32_ffn_gate_2&#45;&gt;layer32_gate_ar</title>
<path fill="none" stroke="black" d="M1072.08,-92888C1082.79,-92888 1090,-92888 1090,-92888 1090,-92888 1090,-92750 1090,-92750 1090,-92750 1158.56,-92750 1158.56,-92750"/>
<polygon fill="black" stroke="black" points="1158.56,-92753.5 1168.56,-92750 1158.56,-92746.5 1158.56,-92753.5"/>
</g>
<!-- layer32_ffn_gate_3&#45;&gt;layer32_gate_ar -->
<g id="edge1053" class="edge">
<title>layer32_ffn_gate_3&#45;&gt;layer32_gate_ar</title>
<path fill="none" stroke="black" d="M1371.24,-92854.02C1371.24,-92854.02 1371.24,-92781.19 1371.24,-92781.19"/>
<polygon fill="black" stroke="black" points="1374.74,-92781.19 1371.24,-92771.19 1367.74,-92781.19 1374.74,-92781.19"/>
</g>
<!-- layer32_up_ar -->
<g id="node828" class="node">
<title>layer32_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="943.5" cy="-92734.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="943.5" y="-92752.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="943.5" y="-92737.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="943.5" y="-92722.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="943.5" y="-92707.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer32_ffn_up_2&#45;&gt;layer32_up_ar -->
<g id="edge1054" class="edge">
<title>layer32_ffn_up_2&#45;&gt;layer32_up_ar</title>
<path fill="none" stroke="black" d="M835.26,-92854.02C835.26,-92854.02 835.26,-92770.09 835.26,-92770.09"/>
<polygon fill="black" stroke="black" points="838.76,-92770.09 835.26,-92760.09 831.76,-92770.09 838.76,-92770.09"/>
</g>
<!-- layer32_ffn_up_3&#45;&gt;layer32_up_ar -->
<g id="edge1055" class="edge">
<title>layer32_ffn_up_3&#45;&gt;layer32_up_ar</title>
<path fill="none" stroke="black" d="M1134.76,-92854.18C1134.76,-92804.5 1134.76,-92718 1134.76,-92718 1134.76,-92718 1074.08,-92718 1074.08,-92718"/>
<polygon fill="black" stroke="black" points="1074.08,-92714.5 1064.08,-92718 1074.08,-92721.5 1074.08,-92714.5"/>
</g>
<!-- layer32_silu_2 -->
<g id="node829" class="node">
<title>layer32_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1217,-92614.05 1036,-92614.05 1036,-92546.05 1217,-92546.05 1217,-92614.05"/>
<text text-anchor="middle" x="1126.5" y="-92598.85" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1126.5" y="-92583.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1126.5" y="-92568.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1126.5" y="-92553.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_gate_ar&#45;&gt;layer32_silu_2 -->
<g id="edge1056" class="edge">
<title>layer32_gate_ar&#45;&gt;layer32_silu_2</title>
<path fill="none" stroke="black" d="M1189.26,-92704.05C1189.26,-92704.05 1189.26,-92624.07 1189.26,-92624.07"/>
<polygon fill="black" stroke="black" points="1192.76,-92624.07 1189.26,-92614.07 1185.76,-92624.07 1192.76,-92624.07"/>
</g>
<!-- layer32_silu_3 -->
<g id="node830" class="node">
<title>layer32_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1434,-92614.05 1253,-92614.05 1253,-92546.05 1434,-92546.05 1434,-92614.05"/>
<text text-anchor="middle" x="1343.5" y="-92598.85" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1343.5" y="-92583.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1343.5" y="-92568.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1343.5" y="-92553.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_gate_ar&#45;&gt;layer32_silu_3 -->
<g id="edge1057" class="edge">
<title>layer32_gate_ar&#45;&gt;layer32_silu_3</title>
<path fill="none" stroke="black" d="M1335.24,-92689.15C1335.24,-92689.15 1335.24,-92624.05 1335.24,-92624.05"/>
<polygon fill="black" stroke="black" points="1338.74,-92624.05 1335.24,-92614.05 1331.74,-92624.05 1338.74,-92624.05"/>
</g>
<!-- layer32_mul_2 -->
<g id="node831" class="node">
<title>layer32_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1107,-92474.05 926,-92474.05 926,-92406.05 1107,-92406.05 1107,-92474.05"/>
<text text-anchor="middle" x="1016.5" y="-92458.85" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1016.5" y="-92443.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1016.5" y="-92428.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1016.5" y="-92413.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_up_ar&#45;&gt;layer32_mul_2 -->
<g id="edge1059" class="edge">
<title>layer32_up_ar&#45;&gt;layer32_mul_2</title>
<path fill="none" stroke="black" d="M981,-92687.85C981,-92687.85 981,-92484.13 981,-92484.13"/>
<polygon fill="black" stroke="black" points="984.5,-92484.13 981,-92474.13 977.5,-92484.13 984.5,-92484.13"/>
</g>
<!-- layer32_mul_3 -->
<g id="node832" class="node">
<title>layer32_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1324,-92474.05 1143,-92474.05 1143,-92406.05 1324,-92406.05 1324,-92474.05"/>
<text text-anchor="middle" x="1233.5" y="-92458.85" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1233.5" y="-92443.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1233.5" y="-92428.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1233.5" y="-92413.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer32_up_ar&#45;&gt;layer32_mul_3 -->
<g id="edge1061" class="edge">
<title>layer32_up_ar&#45;&gt;layer32_mul_3</title>
<path fill="none" stroke="black" d="M1053.74,-92709.34C1053.74,-92684.53 1053.74,-92650 1053.74,-92650 1053.74,-92650 1235,-92650 1235,-92650 1235,-92650 1235,-92484.25 1235,-92484.25"/>
<polygon fill="black" stroke="black" points="1238.5,-92484.25 1235,-92474.25 1231.5,-92484.25 1238.5,-92484.25"/>
</g>
<!-- layer32_silu_2&#45;&gt;layer32_mul_2 -->
<g id="edge1058" class="edge">
<title>layer32_silu_2&#45;&gt;layer32_mul_2</title>
<path fill="none" stroke="black" d="M1071.5,-92545.8C1071.5,-92545.8 1071.5,-92484.42 1071.5,-92484.42"/>
<polygon fill="black" stroke="black" points="1075,-92484.42 1071.5,-92474.42 1068,-92484.42 1075,-92484.42"/>
</g>
<!-- layer32_silu_3&#45;&gt;layer32_mul_3 -->
<g id="edge1060" class="edge">
<title>layer32_silu_3&#45;&gt;layer32_mul_3</title>
<path fill="none" stroke="black" d="M1288.5,-92545.8C1288.5,-92545.8 1288.5,-92484.42 1288.5,-92484.42"/>
<polygon fill="black" stroke="black" points="1292,-92484.42 1288.5,-92474.42 1285,-92484.42 1292,-92484.42"/>
</g>
<!-- layer32_ffn_down_2 -->
<g id="node833" class="node">
<title>layer32_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1106.5,-92334.05 934.5,-92334.05 934.5,-92266.05 1106.5,-92266.05 1106.5,-92334.05"/>
<text text-anchor="middle" x="1020.5" y="-92318.85" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1020.5" y="-92303.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1020.5" y="-92288.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1020.5" y="-92273.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer32_mul_2&#45;&gt;layer32_ffn_down_2 -->
<g id="edge1062" class="edge">
<title>layer32_mul_2&#45;&gt;layer32_ffn_down_2</title>
<path fill="none" stroke="black" d="M1020.5,-92405.8C1020.5,-92405.8 1020.5,-92344.42 1020.5,-92344.42"/>
<polygon fill="black" stroke="black" points="1024,-92344.42 1020.5,-92334.42 1017,-92344.42 1024,-92344.42"/>
</g>
<!-- layer32_ffn_down_3 -->
<g id="node834" class="node">
<title>layer32_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1316.5,-92334.05 1144.5,-92334.05 1144.5,-92266.05 1316.5,-92266.05 1316.5,-92334.05"/>
<text text-anchor="middle" x="1230.5" y="-92318.85" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1230.5" y="-92303.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1230.5" y="-92288.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1230.5" y="-92273.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer32_mul_3&#45;&gt;layer32_ffn_down_3 -->
<g id="edge1063" class="edge">
<title>layer32_mul_3&#45;&gt;layer32_ffn_down_3</title>
<path fill="none" stroke="black" d="M1230.5,-92405.8C1230.5,-92405.8 1230.5,-92344.42 1230.5,-92344.42"/>
<polygon fill="black" stroke="black" points="1234,-92344.42 1230.5,-92334.42 1227,-92344.42 1234,-92344.42"/>
</g>
<!-- layer32_ffn_ar -->
<g id="node835" class="node">
<title>layer32_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1124.5" cy="-92145.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1124.5" y="-92164.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1124.5" y="-92149.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1124.5" y="-92134.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1124.5" y="-92119.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer32_ffn_down_2&#45;&gt;layer32_ffn_ar -->
<g id="edge1064" class="edge">
<title>layer32_ffn_down_2&#45;&gt;layer32_ffn_ar</title>
<path fill="none" stroke="black" d="M1054.69,-92265.85C1054.69,-92265.85 1054.69,-92195.5 1054.69,-92195.5"/>
<polygon fill="black" stroke="black" points="1058.19,-92195.5 1054.69,-92185.5 1051.19,-92195.5 1058.19,-92195.5"/>
</g>
<!-- layer32_ffn_down_3&#45;&gt;layer32_ffn_ar -->
<g id="edge1065" class="edge">
<title>layer32_ffn_down_3&#45;&gt;layer32_ffn_ar</title>
<path fill="none" stroke="black" d="M1195.31,-92265.85C1195.31,-92265.85 1195.31,-92195.23 1195.31,-92195.23"/>
<polygon fill="black" stroke="black" points="1198.81,-92195.23 1195.31,-92185.23 1191.81,-92195.23 1198.81,-92195.23"/>
</g>
<!-- layer33_norm_2 -->
<g id="node836" class="node">
<title>layer33_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1106.5,-92025.88 934.5,-92025.88 934.5,-91957.88 1106.5,-91957.88 1106.5,-92025.88"/>
<text text-anchor="middle" x="1020.5" y="-92010.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1020.5" y="-91995.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1020.5" y="-91980.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1020.5" y="-91965.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer32_ffn_ar&#45;&gt;layer33_norm_2 -->
<g id="edge1066" class="edge">
<title>layer32_ffn_ar&#45;&gt;layer33_norm_2</title>
<path fill="none" stroke="black" d="M1054.69,-92106.28C1054.69,-92106.28 1054.69,-92035.94 1054.69,-92035.94"/>
<polygon fill="black" stroke="black" points="1058.19,-92035.94 1054.69,-92025.94 1051.19,-92035.94 1058.19,-92035.94"/>
</g>
<!-- layer33_norm_3 -->
<g id="node837" class="node">
<title>layer33_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1316.5,-92025.88 1144.5,-92025.88 1144.5,-91957.88 1316.5,-91957.88 1316.5,-92025.88"/>
<text text-anchor="middle" x="1230.5" y="-92010.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1230.5" y="-91995.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1230.5" y="-91980.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1230.5" y="-91965.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer32_ffn_ar&#45;&gt;layer33_norm_3 -->
<g id="edge1067" class="edge">
<title>layer32_ffn_ar&#45;&gt;layer33_norm_3</title>
<path fill="none" stroke="black" d="M1195.31,-92106.68C1195.31,-92106.68 1195.31,-92036.11 1195.31,-92036.11"/>
<polygon fill="black" stroke="black" points="1198.81,-92036.11 1195.31,-92026.11 1191.81,-92036.11 1198.81,-92036.11"/>
</g>
<!-- layer33_qkv_2 -->
<g id="node838" class="node">
<title>layer33_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1107,-91885.88 926,-91885.88 926,-91817.88 1107,-91817.88 1107,-91885.88"/>
<text text-anchor="middle" x="1016.5" y="-91870.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1016.5" y="-91855.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1016.5" y="-91840.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-91825.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer33_norm_2&#45;&gt;layer33_qkv_2 -->
<g id="edge1068" class="edge">
<title>layer33_norm_2&#45;&gt;layer33_qkv_2</title>
<path fill="none" stroke="black" d="M1020.5,-91957.63C1020.5,-91957.63 1020.5,-91896.26 1020.5,-91896.26"/>
<polygon fill="black" stroke="black" points="1024,-91896.26 1020.5,-91886.26 1017,-91896.26 1024,-91896.26"/>
</g>
<!-- layer33_qkv_3 -->
<g id="node839" class="node">
<title>layer33_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1324,-91885.88 1143,-91885.88 1143,-91817.88 1324,-91817.88 1324,-91885.88"/>
<text text-anchor="middle" x="1233.5" y="-91870.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1233.5" y="-91855.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1233.5" y="-91840.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-91825.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer33_norm_3&#45;&gt;layer33_qkv_3 -->
<g id="edge1069" class="edge">
<title>layer33_norm_3&#45;&gt;layer33_qkv_3</title>
<path fill="none" stroke="black" d="M1230.5,-91957.63C1230.5,-91957.63 1230.5,-91896.26 1230.5,-91896.26"/>
<polygon fill="black" stroke="black" points="1234,-91896.26 1230.5,-91886.26 1227,-91896.26 1234,-91896.26"/>
</g>
<!-- layer33_qkv_ar -->
<g id="node840" class="node">
<title>layer33_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1124.5" cy="-91697.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1124.5" y="-91716.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1124.5" y="-91701.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1124.5" y="-91686.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1124.5" y="-91671.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer33_qkv_2&#45;&gt;layer33_qkv_ar -->
<g id="edge1070" class="edge">
<title>layer33_qkv_2&#45;&gt;layer33_qkv_ar</title>
<path fill="none" stroke="black" d="M1051.76,-91817.68C1051.76,-91817.68 1051.76,-91747.62 1051.76,-91747.62"/>
<polygon fill="black" stroke="black" points="1055.26,-91747.62 1051.76,-91737.62 1048.26,-91747.62 1055.26,-91747.62"/>
</g>
<!-- layer33_qkv_3&#45;&gt;layer33_qkv_ar -->
<g id="edge1071" class="edge">
<title>layer33_qkv_3&#45;&gt;layer33_qkv_ar</title>
<path fill="none" stroke="black" d="M1197.74,-91817.68C1197.74,-91817.68 1197.74,-91747.34 1197.74,-91747.34"/>
<polygon fill="black" stroke="black" points="1201.24,-91747.34 1197.74,-91737.34 1194.24,-91747.34 1201.24,-91747.34"/>
</g>
<!-- layer33_attn_2 -->
<g id="node841" class="node">
<title>layer33_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1106.5,-91577.71 934.5,-91577.71 934.5,-91509.71 1106.5,-91509.71 1106.5,-91577.71"/>
<text text-anchor="middle" x="1020.5" y="-91562.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1020.5" y="-91547.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1020.5" y="-91532.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1020.5" y="-91517.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer33_qkv_ar&#45;&gt;layer33_attn_2 -->
<g id="edge1072" class="edge">
<title>layer33_qkv_ar&#45;&gt;layer33_attn_2</title>
<path fill="none" stroke="black" d="M1051.51,-91658.12C1051.51,-91658.12 1051.51,-91587.77 1051.51,-91587.77"/>
<polygon fill="black" stroke="black" points="1055.01,-91587.77 1051.51,-91577.77 1048.01,-91587.77 1055.01,-91587.77"/>
</g>
<!-- layer33_attn_3 -->
<g id="node842" class="node">
<title>layer33_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1314.5,-91577.71 1142.5,-91577.71 1142.5,-91509.71 1314.5,-91509.71 1314.5,-91577.71"/>
<text text-anchor="middle" x="1228.5" y="-91562.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1228.5" y="-91547.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1228.5" y="-91532.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1228.5" y="-91517.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer33_qkv_ar&#45;&gt;layer33_attn_3 -->
<g id="edge1073" class="edge">
<title>layer33_qkv_ar&#45;&gt;layer33_attn_3</title>
<path fill="none" stroke="black" d="M1197.49,-91658.12C1197.49,-91658.12 1197.49,-91587.77 1197.49,-91587.77"/>
<polygon fill="black" stroke="black" points="1200.99,-91587.77 1197.49,-91577.77 1193.99,-91587.77 1200.99,-91587.77"/>
</g>
<!-- layer33_attn_out_2 -->
<g id="node843" class="node">
<title>layer33_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1106.5,-91437.71 934.5,-91437.71 934.5,-91369.71 1106.5,-91369.71 1106.5,-91437.71"/>
<text text-anchor="middle" x="1020.5" y="-91422.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1020.5" y="-91407.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1020.5" y="-91392.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1020.5" y="-91377.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer33_attn_2&#45;&gt;layer33_attn_out_2 -->
<g id="edge1074" class="edge">
<title>layer33_attn_2&#45;&gt;layer33_attn_out_2</title>
<path fill="none" stroke="black" d="M1020.5,-91509.46C1020.5,-91509.46 1020.5,-91448.09 1020.5,-91448.09"/>
<polygon fill="black" stroke="black" points="1024,-91448.09 1020.5,-91438.09 1017,-91448.09 1024,-91448.09"/>
</g>
<!-- layer33_attn_out_3 -->
<g id="node844" class="node">
<title>layer33_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1314.5,-91437.71 1142.5,-91437.71 1142.5,-91369.71 1314.5,-91369.71 1314.5,-91437.71"/>
<text text-anchor="middle" x="1228.5" y="-91422.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1228.5" y="-91407.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1228.5" y="-91392.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1228.5" y="-91377.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer33_attn_3&#45;&gt;layer33_attn_out_3 -->
<g id="edge1075" class="edge">
<title>layer33_attn_3&#45;&gt;layer33_attn_out_3</title>
<path fill="none" stroke="black" d="M1228.5,-91509.46C1228.5,-91509.46 1228.5,-91448.09 1228.5,-91448.09"/>
<polygon fill="black" stroke="black" points="1232,-91448.09 1228.5,-91438.09 1225,-91448.09 1232,-91448.09"/>
</g>
<!-- layer33_attn_ar -->
<g id="node845" class="node">
<title>layer33_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1124.5" cy="-91249.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1124.5" y="-91268.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1124.5" y="-91253.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1124.5" y="-91238.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1124.5" y="-91223.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer33_attn_out_2&#45;&gt;layer33_attn_ar -->
<g id="edge1076" class="edge">
<title>layer33_attn_out_2&#45;&gt;layer33_attn_ar</title>
<path fill="none" stroke="black" d="M1054.69,-91369.52C1054.69,-91369.52 1054.69,-91299.17 1054.69,-91299.17"/>
<polygon fill="black" stroke="black" points="1058.19,-91299.17 1054.69,-91289.17 1051.19,-91299.17 1058.19,-91299.17"/>
</g>
<!-- layer33_attn_out_3&#45;&gt;layer33_attn_ar -->
<g id="edge1077" class="edge">
<title>layer33_attn_out_3&#45;&gt;layer33_attn_ar</title>
<path fill="none" stroke="black" d="M1194.31,-91369.52C1194.31,-91369.52 1194.31,-91299.17 1194.31,-91299.17"/>
<polygon fill="black" stroke="black" points="1197.81,-91299.17 1194.31,-91289.17 1190.81,-91299.17 1197.81,-91299.17"/>
</g>
<!-- layer33_ffn_norm_2 -->
<g id="node846" class="node">
<title>layer33_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1102.5,-91129.55 930.5,-91129.55 930.5,-91061.55 1102.5,-91061.55 1102.5,-91129.55"/>
<text text-anchor="middle" x="1016.5" y="-91114.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1016.5" y="-91099.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1016.5" y="-91084.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-91069.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer33_attn_ar&#45;&gt;layer33_ffn_norm_2 -->
<g id="edge1078" class="edge">
<title>layer33_attn_ar&#45;&gt;layer33_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1052.69,-91210.75C1052.69,-91210.75 1052.69,-91139.69 1052.69,-91139.69"/>
<polygon fill="black" stroke="black" points="1056.19,-91139.69 1052.69,-91129.69 1049.19,-91139.69 1056.19,-91139.69"/>
</g>
<!-- layer33_ffn_norm_3 -->
<g id="node847" class="node">
<title>layer33_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1319.5,-91129.55 1147.5,-91129.55 1147.5,-91061.55 1319.5,-91061.55 1319.5,-91129.55"/>
<text text-anchor="middle" x="1233.5" y="-91114.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1233.5" y="-91099.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1233.5" y="-91084.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-91069.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer33_attn_ar&#45;&gt;layer33_ffn_norm_3 -->
<g id="edge1079" class="edge">
<title>layer33_attn_ar&#45;&gt;layer33_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1196.81,-91210.75C1196.81,-91210.75 1196.81,-91139.69 1196.81,-91139.69"/>
<polygon fill="black" stroke="black" points="1200.31,-91139.69 1196.81,-91129.69 1193.31,-91139.69 1200.31,-91139.69"/>
</g>
<!-- layer33_ffn_gate_2 -->
<g id="node848" class="node">
<title>layer33_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1107,-90989.55 926,-90989.55 926,-90921.55 1107,-90921.55 1107,-90989.55"/>
<text text-anchor="middle" x="1016.5" y="-90974.35" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1016.5" y="-90959.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1016.5" y="-90944.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-90929.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_ffn_norm_2&#45;&gt;layer33_ffn_gate_2 -->
<g id="edge1080" class="edge">
<title>layer33_ffn_norm_2&#45;&gt;layer33_ffn_gate_2</title>
<path fill="none" stroke="black" d="M1016.5,-91061.3C1016.5,-91061.3 1016.5,-90999.93 1016.5,-90999.93"/>
<polygon fill="black" stroke="black" points="1020,-90999.93 1016.5,-90989.93 1013,-90999.93 1020,-90999.93"/>
</g>
<!-- layer33_ffn_up_2 -->
<g id="node850" class="node">
<title>layer33_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="890,-90989.55 709,-90989.55 709,-90921.55 890,-90921.55 890,-90989.55"/>
<text text-anchor="middle" x="799.5" y="-90974.35" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="799.5" y="-90959.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="799.5" y="-90944.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="799.5" y="-90929.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_ffn_norm_2&#45;&gt;layer33_ffn_up_2 -->
<g id="edge1082" class="edge">
<title>layer33_ffn_norm_2&#45;&gt;layer33_ffn_up_2</title>
<path fill="none" stroke="black" d="M930.31,-91095C890.86,-91095 852.76,-91095 852.76,-91095 852.76,-91095 852.76,-90999.66 852.76,-90999.66"/>
<polygon fill="black" stroke="black" points="856.26,-90999.66 852.76,-90989.66 849.26,-90999.66 856.26,-90999.66"/>
</g>
<!-- layer33_ffn_gate_3 -->
<g id="node849" class="node">
<title>layer33_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1541,-90989.55 1360,-90989.55 1360,-90921.55 1541,-90921.55 1541,-90989.55"/>
<text text-anchor="middle" x="1450.5" y="-90974.35" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1450.5" y="-90959.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1450.5" y="-90944.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1450.5" y="-90929.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_ffn_norm_3&#45;&gt;layer33_ffn_gate_3 -->
<g id="edge1081" class="edge">
<title>layer33_ffn_norm_3&#45;&gt;layer33_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1319.56,-91095C1358.95,-91095 1397,-91095 1397,-91095 1397,-91095 1397,-90999.66 1397,-90999.66"/>
<polygon fill="black" stroke="black" points="1400.5,-90999.66 1397,-90989.66 1393.5,-90999.66 1400.5,-90999.66"/>
</g>
<!-- layer33_ffn_up_3 -->
<g id="node851" class="node">
<title>layer33_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1324,-90989.55 1143,-90989.55 1143,-90921.55 1324,-90921.55 1324,-90989.55"/>
<text text-anchor="middle" x="1233.5" y="-90974.35" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1233.5" y="-90959.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1233.5" y="-90944.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-90929.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_ffn_norm_3&#45;&gt;layer33_ffn_up_3 -->
<g id="edge1083" class="edge">
<title>layer33_ffn_norm_3&#45;&gt;layer33_ffn_up_3</title>
<path fill="none" stroke="black" d="M1233.5,-91061.3C1233.5,-91061.3 1233.5,-90999.93 1233.5,-90999.93"/>
<polygon fill="black" stroke="black" points="1237,-90999.93 1233.5,-90989.93 1230,-90999.93 1237,-90999.93"/>
</g>
<!-- layer33_gate_ar -->
<g id="node852" class="node">
<title>layer33_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1324.5" cy="-90801.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1324.5" y="-90820.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1324.5" y="-90805.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1324.5" y="-90790.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1324.5" y="-90775.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer33_ffn_gate_2&#45;&gt;layer33_gate_ar -->
<g id="edge1084" class="edge">
<title>layer33_ffn_gate_2&#45;&gt;layer33_gate_ar</title>
<path fill="none" stroke="black" d="M1107.08,-90955C1117.79,-90955 1125,-90955 1125,-90955 1125,-90955 1125,-90817 1125,-90817 1125,-90817 1193.28,-90817 1193.28,-90817"/>
<polygon fill="black" stroke="black" points="1193.28,-90820.5 1203.28,-90817 1193.28,-90813.5 1193.28,-90820.5"/>
</g>
<!-- layer33_ffn_gate_3&#45;&gt;layer33_gate_ar -->
<g id="edge1085" class="edge">
<title>layer33_ffn_gate_3&#45;&gt;layer33_gate_ar</title>
<path fill="none" stroke="black" d="M1406.24,-90921.35C1406.24,-90921.35 1406.24,-90848.53 1406.24,-90848.53"/>
<polygon fill="black" stroke="black" points="1409.74,-90848.53 1406.24,-90838.53 1402.74,-90848.53 1409.74,-90848.53"/>
</g>
<!-- layer33_up_ar -->
<g id="node853" class="node">
<title>layer33_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="978.5" cy="-90801.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="978.5" y="-90820.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="978.5" y="-90805.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="978.5" y="-90790.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="978.5" y="-90775.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer33_ffn_up_2&#45;&gt;layer33_up_ar -->
<g id="edge1086" class="edge">
<title>layer33_ffn_up_2&#45;&gt;layer33_up_ar</title>
<path fill="none" stroke="black" d="M870.26,-90921.35C870.26,-90921.35 870.26,-90837.43 870.26,-90837.43"/>
<polygon fill="black" stroke="black" points="873.76,-90837.43 870.26,-90827.43 866.76,-90837.43 873.76,-90837.43"/>
</g>
<!-- layer33_ffn_up_3&#45;&gt;layer33_up_ar -->
<g id="edge1087" class="edge">
<title>layer33_ffn_up_3&#45;&gt;layer33_up_ar</title>
<path fill="none" stroke="black" d="M1169.76,-90921.44C1169.76,-90871.67 1169.76,-90785 1169.76,-90785 1169.76,-90785 1108.81,-90785 1108.81,-90785"/>
<polygon fill="black" stroke="black" points="1108.81,-90781.5 1098.81,-90785 1108.81,-90788.5 1108.81,-90781.5"/>
</g>
<!-- layer33_silu_2 -->
<g id="node854" class="node">
<title>layer33_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1252,-90681.38 1071,-90681.38 1071,-90613.38 1252,-90613.38 1252,-90681.38"/>
<text text-anchor="middle" x="1161.5" y="-90666.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1161.5" y="-90651.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1161.5" y="-90636.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1161.5" y="-90621.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_gate_ar&#45;&gt;layer33_silu_2 -->
<g id="edge1088" class="edge">
<title>layer33_gate_ar&#45;&gt;layer33_silu_2</title>
<path fill="none" stroke="black" d="M1224.26,-90771.39C1224.26,-90771.39 1224.26,-90691.4 1224.26,-90691.4"/>
<polygon fill="black" stroke="black" points="1227.76,-90691.4 1224.26,-90681.4 1220.76,-90691.4 1227.76,-90691.4"/>
</g>
<!-- layer33_silu_3 -->
<g id="node855" class="node">
<title>layer33_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1469,-90681.38 1288,-90681.38 1288,-90613.38 1469,-90613.38 1469,-90681.38"/>
<text text-anchor="middle" x="1378.5" y="-90666.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1378.5" y="-90651.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1378.5" y="-90636.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1378.5" y="-90621.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_gate_ar&#45;&gt;layer33_silu_3 -->
<g id="edge1089" class="edge">
<title>layer33_gate_ar&#45;&gt;layer33_silu_3</title>
<path fill="none" stroke="black" d="M1370.24,-90756.48C1370.24,-90756.48 1370.24,-90691.39 1370.24,-90691.39"/>
<polygon fill="black" stroke="black" points="1373.74,-90691.39 1370.24,-90681.39 1366.74,-90691.39 1373.74,-90691.39"/>
</g>
<!-- layer33_mul_2 -->
<g id="node856" class="node">
<title>layer33_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1142,-90541.38 961,-90541.38 961,-90473.38 1142,-90473.38 1142,-90541.38"/>
<text text-anchor="middle" x="1051.5" y="-90526.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1051.5" y="-90511.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1051.5" y="-90496.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1051.5" y="-90481.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_up_ar&#45;&gt;layer33_mul_2 -->
<g id="edge1091" class="edge">
<title>layer33_up_ar&#45;&gt;layer33_mul_2</title>
<path fill="none" stroke="black" d="M1016,-90755.19C1016,-90755.19 1016,-90551.46 1016,-90551.46"/>
<polygon fill="black" stroke="black" points="1019.5,-90551.46 1016,-90541.46 1012.5,-90551.46 1019.5,-90551.46"/>
</g>
<!-- layer33_mul_3 -->
<g id="node857" class="node">
<title>layer33_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1359,-90541.38 1178,-90541.38 1178,-90473.38 1359,-90473.38 1359,-90541.38"/>
<text text-anchor="middle" x="1268.5" y="-90526.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1268.5" y="-90511.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1268.5" y="-90496.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1268.5" y="-90481.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer33_up_ar&#45;&gt;layer33_mul_3 -->
<g id="edge1093" class="edge">
<title>layer33_up_ar&#45;&gt;layer33_mul_3</title>
<path fill="none" stroke="black" d="M1088.74,-90777.03C1088.74,-90752.09 1088.74,-90717 1088.74,-90717 1088.74,-90717 1270,-90717 1270,-90717 1270,-90717 1270,-90551.53 1270,-90551.53"/>
<polygon fill="black" stroke="black" points="1273.5,-90551.53 1270,-90541.53 1266.5,-90551.53 1273.5,-90551.53"/>
</g>
<!-- layer33_silu_2&#45;&gt;layer33_mul_2 -->
<g id="edge1090" class="edge">
<title>layer33_silu_2&#45;&gt;layer33_mul_2</title>
<path fill="none" stroke="black" d="M1106.5,-90613.13C1106.5,-90613.13 1106.5,-90551.76 1106.5,-90551.76"/>
<polygon fill="black" stroke="black" points="1110,-90551.76 1106.5,-90541.76 1103,-90551.76 1110,-90551.76"/>
</g>
<!-- layer33_silu_3&#45;&gt;layer33_mul_3 -->
<g id="edge1092" class="edge">
<title>layer33_silu_3&#45;&gt;layer33_mul_3</title>
<path fill="none" stroke="black" d="M1323.5,-90613.13C1323.5,-90613.13 1323.5,-90551.76 1323.5,-90551.76"/>
<polygon fill="black" stroke="black" points="1327,-90551.76 1323.5,-90541.76 1320,-90551.76 1327,-90551.76"/>
</g>
<!-- layer33_ffn_down_2 -->
<g id="node858" class="node">
<title>layer33_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1141.5,-90401.38 969.5,-90401.38 969.5,-90333.38 1141.5,-90333.38 1141.5,-90401.38"/>
<text text-anchor="middle" x="1055.5" y="-90386.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1055.5" y="-90371.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1055.5" y="-90356.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1055.5" y="-90341.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer33_mul_2&#45;&gt;layer33_ffn_down_2 -->
<g id="edge1094" class="edge">
<title>layer33_mul_2&#45;&gt;layer33_ffn_down_2</title>
<path fill="none" stroke="black" d="M1055.5,-90473.13C1055.5,-90473.13 1055.5,-90411.76 1055.5,-90411.76"/>
<polygon fill="black" stroke="black" points="1059,-90411.76 1055.5,-90401.76 1052,-90411.76 1059,-90411.76"/>
</g>
<!-- layer33_ffn_down_3 -->
<g id="node859" class="node">
<title>layer33_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1351.5,-90401.38 1179.5,-90401.38 1179.5,-90333.38 1351.5,-90333.38 1351.5,-90401.38"/>
<text text-anchor="middle" x="1265.5" y="-90386.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1265.5" y="-90371.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1265.5" y="-90356.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1265.5" y="-90341.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer33_mul_3&#45;&gt;layer33_ffn_down_3 -->
<g id="edge1095" class="edge">
<title>layer33_mul_3&#45;&gt;layer33_ffn_down_3</title>
<path fill="none" stroke="black" d="M1265.5,-90473.13C1265.5,-90473.13 1265.5,-90411.76 1265.5,-90411.76"/>
<polygon fill="black" stroke="black" points="1269,-90411.76 1265.5,-90401.76 1262,-90411.76 1269,-90411.76"/>
</g>
<!-- layer33_ffn_ar -->
<g id="node860" class="node">
<title>layer33_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1159.5" cy="-90213.3" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1159.5" y="-90232.1" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1159.5" y="-90217.1" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1159.5" y="-90202.1" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1159.5" y="-90187.1" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer33_ffn_down_2&#45;&gt;layer33_ffn_ar -->
<g id="edge1096" class="edge">
<title>layer33_ffn_down_2&#45;&gt;layer33_ffn_ar</title>
<path fill="none" stroke="black" d="M1089.69,-90333.18C1089.69,-90333.18 1089.69,-90262.84 1089.69,-90262.84"/>
<polygon fill="black" stroke="black" points="1093.19,-90262.84 1089.69,-90252.84 1086.19,-90262.84 1093.19,-90262.84"/>
</g>
<!-- layer33_ffn_down_3&#45;&gt;layer33_ffn_ar -->
<g id="edge1097" class="edge">
<title>layer33_ffn_down_3&#45;&gt;layer33_ffn_ar</title>
<path fill="none" stroke="black" d="M1230.31,-90333.18C1230.31,-90333.18 1230.31,-90262.56 1230.31,-90262.56"/>
<polygon fill="black" stroke="black" points="1233.81,-90262.56 1230.31,-90252.56 1226.81,-90262.56 1233.81,-90262.56"/>
</g>
<!-- layer34_norm_2 -->
<g id="node861" class="node">
<title>layer34_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1141.5,-90093.21 969.5,-90093.21 969.5,-90025.21 1141.5,-90025.21 1141.5,-90093.21"/>
<text text-anchor="middle" x="1055.5" y="-90078.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1055.5" y="-90063.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1055.5" y="-90048.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1055.5" y="-90033.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer33_ffn_ar&#45;&gt;layer34_norm_2 -->
<g id="edge1098" class="edge">
<title>layer33_ffn_ar&#45;&gt;layer34_norm_2</title>
<path fill="none" stroke="black" d="M1089.69,-90173.62C1089.69,-90173.62 1089.69,-90103.27 1089.69,-90103.27"/>
<polygon fill="black" stroke="black" points="1093.19,-90103.27 1089.69,-90093.27 1086.19,-90103.27 1093.19,-90103.27"/>
</g>
<!-- layer34_norm_3 -->
<g id="node862" class="node">
<title>layer34_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1351.5,-90093.21 1179.5,-90093.21 1179.5,-90025.21 1351.5,-90025.21 1351.5,-90093.21"/>
<text text-anchor="middle" x="1265.5" y="-90078.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1265.5" y="-90063.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1265.5" y="-90048.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1265.5" y="-90033.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer33_ffn_ar&#45;&gt;layer34_norm_3 -->
<g id="edge1099" class="edge">
<title>layer33_ffn_ar&#45;&gt;layer34_norm_3</title>
<path fill="none" stroke="black" d="M1230.31,-90174.02C1230.31,-90174.02 1230.31,-90103.44 1230.31,-90103.44"/>
<polygon fill="black" stroke="black" points="1233.81,-90103.44 1230.31,-90093.44 1226.81,-90103.44 1233.81,-90103.44"/>
</g>
<!-- layer34_qkv_2 -->
<g id="node863" class="node">
<title>layer34_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1142,-89953.21 961,-89953.21 961,-89885.21 1142,-89885.21 1142,-89953.21"/>
<text text-anchor="middle" x="1051.5" y="-89938.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1051.5" y="-89923.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1051.5" y="-89908.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-89893.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer34_norm_2&#45;&gt;layer34_qkv_2 -->
<g id="edge1100" class="edge">
<title>layer34_norm_2&#45;&gt;layer34_qkv_2</title>
<path fill="none" stroke="black" d="M1055.5,-90024.96C1055.5,-90024.96 1055.5,-89963.59 1055.5,-89963.59"/>
<polygon fill="black" stroke="black" points="1059,-89963.59 1055.5,-89953.59 1052,-89963.59 1059,-89963.59"/>
</g>
<!-- layer34_qkv_3 -->
<g id="node864" class="node">
<title>layer34_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1359,-89953.21 1178,-89953.21 1178,-89885.21 1359,-89885.21 1359,-89953.21"/>
<text text-anchor="middle" x="1268.5" y="-89938.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1268.5" y="-89923.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1268.5" y="-89908.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-89893.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer34_norm_3&#45;&gt;layer34_qkv_3 -->
<g id="edge1101" class="edge">
<title>layer34_norm_3&#45;&gt;layer34_qkv_3</title>
<path fill="none" stroke="black" d="M1265.5,-90024.96C1265.5,-90024.96 1265.5,-89963.59 1265.5,-89963.59"/>
<polygon fill="black" stroke="black" points="1269,-89963.59 1265.5,-89953.59 1262,-89963.59 1269,-89963.59"/>
</g>
<!-- layer34_qkv_ar -->
<g id="node865" class="node">
<title>layer34_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1159.5" cy="-89765.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1159.5" y="-89783.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1159.5" y="-89768.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1159.5" y="-89753.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1159.5" y="-89738.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer34_qkv_2&#45;&gt;layer34_qkv_ar -->
<g id="edge1102" class="edge">
<title>layer34_qkv_2&#45;&gt;layer34_qkv_ar</title>
<path fill="none" stroke="black" d="M1086.76,-89885.02C1086.76,-89885.02 1086.76,-89814.95 1086.76,-89814.95"/>
<polygon fill="black" stroke="black" points="1090.26,-89814.95 1086.76,-89804.95 1083.26,-89814.95 1090.26,-89814.95"/>
</g>
<!-- layer34_qkv_3&#45;&gt;layer34_qkv_ar -->
<g id="edge1103" class="edge">
<title>layer34_qkv_3&#45;&gt;layer34_qkv_ar</title>
<path fill="none" stroke="black" d="M1232.74,-89885.02C1232.74,-89885.02 1232.74,-89814.67 1232.74,-89814.67"/>
<polygon fill="black" stroke="black" points="1236.24,-89814.67 1232.74,-89804.67 1229.24,-89814.67 1236.24,-89814.67"/>
</g>
<!-- layer34_attn_2 -->
<g id="node866" class="node">
<title>layer34_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1141.5,-89645.05 969.5,-89645.05 969.5,-89577.05 1141.5,-89577.05 1141.5,-89645.05"/>
<text text-anchor="middle" x="1055.5" y="-89629.85" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1055.5" y="-89614.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1055.5" y="-89599.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1055.5" y="-89584.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer34_qkv_ar&#45;&gt;layer34_attn_2 -->
<g id="edge1104" class="edge">
<title>layer34_qkv_ar&#45;&gt;layer34_attn_2</title>
<path fill="none" stroke="black" d="M1086.51,-89725.45C1086.51,-89725.45 1086.51,-89655.1 1086.51,-89655.1"/>
<polygon fill="black" stroke="black" points="1090.01,-89655.1 1086.51,-89645.1 1083.01,-89655.1 1090.01,-89655.1"/>
</g>
<!-- layer34_attn_3 -->
<g id="node867" class="node">
<title>layer34_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1349.5,-89645.05 1177.5,-89645.05 1177.5,-89577.05 1349.5,-89577.05 1349.5,-89645.05"/>
<text text-anchor="middle" x="1263.5" y="-89629.85" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1263.5" y="-89614.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1263.5" y="-89599.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1263.5" y="-89584.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer34_qkv_ar&#45;&gt;layer34_attn_3 -->
<g id="edge1105" class="edge">
<title>layer34_qkv_ar&#45;&gt;layer34_attn_3</title>
<path fill="none" stroke="black" d="M1232.49,-89725.45C1232.49,-89725.45 1232.49,-89655.1 1232.49,-89655.1"/>
<polygon fill="black" stroke="black" points="1235.99,-89655.1 1232.49,-89645.1 1228.99,-89655.1 1235.99,-89655.1"/>
</g>
<!-- layer34_attn_out_2 -->
<g id="node868" class="node">
<title>layer34_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1141.5,-89505.05 969.5,-89505.05 969.5,-89437.05 1141.5,-89437.05 1141.5,-89505.05"/>
<text text-anchor="middle" x="1055.5" y="-89489.85" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1055.5" y="-89474.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1055.5" y="-89459.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1055.5" y="-89444.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer34_attn_2&#45;&gt;layer34_attn_out_2 -->
<g id="edge1106" class="edge">
<title>layer34_attn_2&#45;&gt;layer34_attn_out_2</title>
<path fill="none" stroke="black" d="M1055.5,-89576.8C1055.5,-89576.8 1055.5,-89515.43 1055.5,-89515.43"/>
<polygon fill="black" stroke="black" points="1059,-89515.43 1055.5,-89505.43 1052,-89515.43 1059,-89515.43"/>
</g>
<!-- layer34_attn_out_3 -->
<g id="node869" class="node">
<title>layer34_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1349.5,-89505.05 1177.5,-89505.05 1177.5,-89437.05 1349.5,-89437.05 1349.5,-89505.05"/>
<text text-anchor="middle" x="1263.5" y="-89489.85" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1263.5" y="-89474.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1263.5" y="-89459.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1263.5" y="-89444.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer34_attn_3&#45;&gt;layer34_attn_out_3 -->
<g id="edge1107" class="edge">
<title>layer34_attn_3&#45;&gt;layer34_attn_out_3</title>
<path fill="none" stroke="black" d="M1263.5,-89576.8C1263.5,-89576.8 1263.5,-89515.43 1263.5,-89515.43"/>
<polygon fill="black" stroke="black" points="1267,-89515.43 1263.5,-89505.43 1260,-89515.43 1267,-89515.43"/>
</g>
<!-- layer34_attn_ar -->
<g id="node870" class="node">
<title>layer34_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1159.5" cy="-89316.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1159.5" y="-89335.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1159.5" y="-89320.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1159.5" y="-89305.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1159.5" y="-89290.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer34_attn_out_2&#45;&gt;layer34_attn_ar -->
<g id="edge1108" class="edge">
<title>layer34_attn_out_2&#45;&gt;layer34_attn_ar</title>
<path fill="none" stroke="black" d="M1089.69,-89436.85C1089.69,-89436.85 1089.69,-89366.51 1089.69,-89366.51"/>
<polygon fill="black" stroke="black" points="1093.19,-89366.51 1089.69,-89356.51 1086.19,-89366.51 1093.19,-89366.51"/>
</g>
<!-- layer34_attn_out_3&#45;&gt;layer34_attn_ar -->
<g id="edge1109" class="edge">
<title>layer34_attn_out_3&#45;&gt;layer34_attn_ar</title>
<path fill="none" stroke="black" d="M1229.31,-89436.85C1229.31,-89436.85 1229.31,-89366.51 1229.31,-89366.51"/>
<polygon fill="black" stroke="black" points="1232.81,-89366.51 1229.31,-89356.51 1225.81,-89366.51 1232.81,-89366.51"/>
</g>
<!-- layer34_ffn_norm_2 -->
<g id="node871" class="node">
<title>layer34_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1137.5,-89196.88 965.5,-89196.88 965.5,-89128.88 1137.5,-89128.88 1137.5,-89196.88"/>
<text text-anchor="middle" x="1051.5" y="-89181.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1051.5" y="-89166.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1051.5" y="-89151.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-89136.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer34_attn_ar&#45;&gt;layer34_ffn_norm_2 -->
<g id="edge1110" class="edge">
<title>layer34_attn_ar&#45;&gt;layer34_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1087.69,-89278.08C1087.69,-89278.08 1087.69,-89207.03 1087.69,-89207.03"/>
<polygon fill="black" stroke="black" points="1091.19,-89207.03 1087.69,-89197.03 1084.19,-89207.03 1091.19,-89207.03"/>
</g>
<!-- layer34_ffn_norm_3 -->
<g id="node872" class="node">
<title>layer34_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1354.5,-89196.88 1182.5,-89196.88 1182.5,-89128.88 1354.5,-89128.88 1354.5,-89196.88"/>
<text text-anchor="middle" x="1268.5" y="-89181.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1268.5" y="-89166.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1268.5" y="-89151.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-89136.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer34_attn_ar&#45;&gt;layer34_ffn_norm_3 -->
<g id="edge1111" class="edge">
<title>layer34_attn_ar&#45;&gt;layer34_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1231.81,-89278.08C1231.81,-89278.08 1231.81,-89207.03 1231.81,-89207.03"/>
<polygon fill="black" stroke="black" points="1235.31,-89207.03 1231.81,-89197.03 1228.31,-89207.03 1235.31,-89207.03"/>
</g>
<!-- layer34_ffn_gate_2 -->
<g id="node873" class="node">
<title>layer34_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1142,-89056.88 961,-89056.88 961,-88988.88 1142,-88988.88 1142,-89056.88"/>
<text text-anchor="middle" x="1051.5" y="-89041.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1051.5" y="-89026.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1051.5" y="-89011.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-88996.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_ffn_norm_2&#45;&gt;layer34_ffn_gate_2 -->
<g id="edge1112" class="edge">
<title>layer34_ffn_norm_2&#45;&gt;layer34_ffn_gate_2</title>
<path fill="none" stroke="black" d="M1051.5,-89128.63C1051.5,-89128.63 1051.5,-89067.26 1051.5,-89067.26"/>
<polygon fill="black" stroke="black" points="1055,-89067.26 1051.5,-89057.26 1048,-89067.26 1055,-89067.26"/>
</g>
<!-- layer34_ffn_up_2 -->
<g id="node875" class="node">
<title>layer34_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="925,-89056.88 744,-89056.88 744,-88988.88 925,-88988.88 925,-89056.88"/>
<text text-anchor="middle" x="834.5" y="-89041.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="834.5" y="-89026.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="834.5" y="-89011.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="834.5" y="-88996.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_ffn_norm_2&#45;&gt;layer34_ffn_up_2 -->
<g id="edge1114" class="edge">
<title>layer34_ffn_norm_2&#45;&gt;layer34_ffn_up_2</title>
<path fill="none" stroke="black" d="M965.31,-89162C925.86,-89162 887.76,-89162 887.76,-89162 887.76,-89162 887.76,-89066.91 887.76,-89066.91"/>
<polygon fill="black" stroke="black" points="891.26,-89066.91 887.76,-89056.91 884.26,-89066.91 891.26,-89066.91"/>
</g>
<!-- layer34_ffn_gate_3 -->
<g id="node874" class="node">
<title>layer34_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1576,-89056.88 1395,-89056.88 1395,-88988.88 1576,-88988.88 1576,-89056.88"/>
<text text-anchor="middle" x="1485.5" y="-89041.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1485.5" y="-89026.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1485.5" y="-89011.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1485.5" y="-88996.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_ffn_norm_3&#45;&gt;layer34_ffn_gate_3 -->
<g id="edge1113" class="edge">
<title>layer34_ffn_norm_3&#45;&gt;layer34_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1354.56,-89162C1393.95,-89162 1432,-89162 1432,-89162 1432,-89162 1432,-89066.91 1432,-89066.91"/>
<polygon fill="black" stroke="black" points="1435.5,-89066.91 1432,-89056.91 1428.5,-89066.91 1435.5,-89066.91"/>
</g>
<!-- layer34_ffn_up_3 -->
<g id="node876" class="node">
<title>layer34_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1359,-89056.88 1178,-89056.88 1178,-88988.88 1359,-88988.88 1359,-89056.88"/>
<text text-anchor="middle" x="1268.5" y="-89041.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1268.5" y="-89026.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1268.5" y="-89011.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-88996.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_ffn_norm_3&#45;&gt;layer34_ffn_up_3 -->
<g id="edge1115" class="edge">
<title>layer34_ffn_norm_3&#45;&gt;layer34_ffn_up_3</title>
<path fill="none" stroke="black" d="M1268.5,-89128.63C1268.5,-89128.63 1268.5,-89067.26 1268.5,-89067.26"/>
<polygon fill="black" stroke="black" points="1272,-89067.26 1268.5,-89057.26 1265,-89067.26 1272,-89067.26"/>
</g>
<!-- layer34_gate_ar -->
<g id="node877" class="node">
<title>layer34_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1359.5" cy="-88868.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1359.5" y="-88887.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1359.5" y="-88872.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1359.5" y="-88857.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1359.5" y="-88842.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer34_ffn_gate_2&#45;&gt;layer34_gate_ar -->
<g id="edge1116" class="edge">
<title>layer34_ffn_gate_2&#45;&gt;layer34_gate_ar</title>
<path fill="none" stroke="black" d="M1142.08,-89022C1152.79,-89022 1160,-89022 1160,-89022 1160,-89022 1160,-88884 1160,-88884 1160,-88884 1227.99,-88884 1227.99,-88884"/>
<polygon fill="black" stroke="black" points="1227.99,-88887.5 1237.99,-88884 1227.99,-88880.5 1227.99,-88887.5"/>
</g>
<!-- layer34_ffn_gate_3&#45;&gt;layer34_gate_ar -->
<g id="edge1117" class="edge">
<title>layer34_ffn_gate_3&#45;&gt;layer34_gate_ar</title>
<path fill="none" stroke="black" d="M1441.24,-88988.68C1441.24,-88988.68 1441.24,-88915.86 1441.24,-88915.86"/>
<polygon fill="black" stroke="black" points="1444.74,-88915.86 1441.24,-88905.86 1437.74,-88915.86 1444.74,-88915.86"/>
</g>
<!-- layer34_up_ar -->
<g id="node878" class="node">
<title>layer34_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1013.5" cy="-88868.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1013.5" y="-88887.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1013.5" y="-88872.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1013.5" y="-88857.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1013.5" y="-88842.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer34_ffn_up_2&#45;&gt;layer34_up_ar -->
<g id="edge1118" class="edge">
<title>layer34_ffn_up_2&#45;&gt;layer34_up_ar</title>
<path fill="none" stroke="black" d="M905.26,-88988.68C905.26,-88988.68 905.26,-88904.76 905.26,-88904.76"/>
<polygon fill="black" stroke="black" points="908.76,-88904.76 905.26,-88894.76 901.76,-88904.76 908.76,-88904.76"/>
</g>
<!-- layer34_ffn_up_3&#45;&gt;layer34_up_ar -->
<g id="edge1119" class="edge">
<title>layer34_ffn_up_3&#45;&gt;layer34_up_ar</title>
<path fill="none" stroke="black" d="M1204.76,-88988.71C1204.76,-88938.84 1204.76,-88852 1204.76,-88852 1204.76,-88852 1143.54,-88852 1143.54,-88852"/>
<polygon fill="black" stroke="black" points="1143.54,-88848.5 1133.54,-88852 1143.54,-88855.5 1143.54,-88848.5"/>
</g>
<!-- layer34_silu_2 -->
<g id="node879" class="node">
<title>layer34_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1287,-88748.71 1106,-88748.71 1106,-88680.71 1287,-88680.71 1287,-88748.71"/>
<text text-anchor="middle" x="1196.5" y="-88733.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1196.5" y="-88718.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1196.5" y="-88703.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1196.5" y="-88688.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_gate_ar&#45;&gt;layer34_silu_2 -->
<g id="edge1120" class="edge">
<title>layer34_gate_ar&#45;&gt;layer34_silu_2</title>
<path fill="none" stroke="black" d="M1259.26,-88838.72C1259.26,-88838.72 1259.26,-88758.74 1259.26,-88758.74"/>
<polygon fill="black" stroke="black" points="1262.76,-88758.74 1259.26,-88748.74 1255.76,-88758.74 1262.76,-88758.74"/>
</g>
<!-- layer34_silu_3 -->
<g id="node880" class="node">
<title>layer34_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1504,-88748.71 1323,-88748.71 1323,-88680.71 1504,-88680.71 1504,-88748.71"/>
<text text-anchor="middle" x="1413.5" y="-88733.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1413.5" y="-88718.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1413.5" y="-88703.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1413.5" y="-88688.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_gate_ar&#45;&gt;layer34_silu_3 -->
<g id="edge1121" class="edge">
<title>layer34_gate_ar&#45;&gt;layer34_silu_3</title>
<path fill="none" stroke="black" d="M1405.24,-88823.82C1405.24,-88823.82 1405.24,-88758.72 1405.24,-88758.72"/>
<polygon fill="black" stroke="black" points="1408.74,-88758.72 1405.24,-88748.72 1401.74,-88758.72 1408.74,-88758.72"/>
</g>
<!-- layer34_mul_2 -->
<g id="node881" class="node">
<title>layer34_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1177,-88608.71 996,-88608.71 996,-88540.71 1177,-88540.71 1177,-88608.71"/>
<text text-anchor="middle" x="1086.5" y="-88593.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1086.5" y="-88578.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1086.5" y="-88563.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1086.5" y="-88548.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_up_ar&#45;&gt;layer34_mul_2 -->
<g id="edge1123" class="edge">
<title>layer34_up_ar&#45;&gt;layer34_mul_2</title>
<path fill="none" stroke="black" d="M1051,-88822.52C1051,-88822.52 1051,-88618.8 1051,-88618.8"/>
<polygon fill="black" stroke="black" points="1054.5,-88618.8 1051,-88608.8 1047.5,-88618.8 1054.5,-88618.8"/>
</g>
<!-- layer34_mul_3 -->
<g id="node882" class="node">
<title>layer34_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1394,-88608.71 1213,-88608.71 1213,-88540.71 1394,-88540.71 1394,-88608.71"/>
<text text-anchor="middle" x="1303.5" y="-88593.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1303.5" y="-88578.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1303.5" y="-88563.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1303.5" y="-88548.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer34_up_ar&#45;&gt;layer34_mul_3 -->
<g id="edge1125" class="edge">
<title>layer34_up_ar&#45;&gt;layer34_mul_3</title>
<path fill="none" stroke="black" d="M1123.74,-88844.27C1123.74,-88819.23 1123.74,-88784 1123.74,-88784 1123.74,-88784 1305,-88784 1305,-88784 1305,-88784 1305,-88618.8 1305,-88618.8"/>
<polygon fill="black" stroke="black" points="1308.5,-88618.8 1305,-88608.8 1301.5,-88618.8 1308.5,-88618.8"/>
</g>
<!-- layer34_silu_2&#45;&gt;layer34_mul_2 -->
<g id="edge1122" class="edge">
<title>layer34_silu_2&#45;&gt;layer34_mul_2</title>
<path fill="none" stroke="black" d="M1141.5,-88680.47C1141.5,-88680.47 1141.5,-88619.09 1141.5,-88619.09"/>
<polygon fill="black" stroke="black" points="1145,-88619.09 1141.5,-88609.09 1138,-88619.09 1145,-88619.09"/>
</g>
<!-- layer34_silu_3&#45;&gt;layer34_mul_3 -->
<g id="edge1124" class="edge">
<title>layer34_silu_3&#45;&gt;layer34_mul_3</title>
<path fill="none" stroke="black" d="M1358.5,-88680.47C1358.5,-88680.47 1358.5,-88619.09 1358.5,-88619.09"/>
<polygon fill="black" stroke="black" points="1362,-88619.09 1358.5,-88609.09 1355,-88619.09 1362,-88619.09"/>
</g>
<!-- layer34_ffn_down_2 -->
<g id="node883" class="node">
<title>layer34_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1176.5,-88468.71 1004.5,-88468.71 1004.5,-88400.71 1176.5,-88400.71 1176.5,-88468.71"/>
<text text-anchor="middle" x="1090.5" y="-88453.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1090.5" y="-88438.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1090.5" y="-88423.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1090.5" y="-88408.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer34_mul_2&#45;&gt;layer34_ffn_down_2 -->
<g id="edge1126" class="edge">
<title>layer34_mul_2&#45;&gt;layer34_ffn_down_2</title>
<path fill="none" stroke="black" d="M1090.5,-88540.47C1090.5,-88540.47 1090.5,-88479.09 1090.5,-88479.09"/>
<polygon fill="black" stroke="black" points="1094,-88479.09 1090.5,-88469.09 1087,-88479.09 1094,-88479.09"/>
</g>
<!-- layer34_ffn_down_3 -->
<g id="node884" class="node">
<title>layer34_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1386.5,-88468.71 1214.5,-88468.71 1214.5,-88400.71 1386.5,-88400.71 1386.5,-88468.71"/>
<text text-anchor="middle" x="1300.5" y="-88453.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1300.5" y="-88438.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1300.5" y="-88423.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1300.5" y="-88408.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer34_mul_3&#45;&gt;layer34_ffn_down_3 -->
<g id="edge1127" class="edge">
<title>layer34_mul_3&#45;&gt;layer34_ffn_down_3</title>
<path fill="none" stroke="black" d="M1300.5,-88540.47C1300.5,-88540.47 1300.5,-88479.09 1300.5,-88479.09"/>
<polygon fill="black" stroke="black" points="1304,-88479.09 1300.5,-88469.09 1297,-88479.09 1304,-88479.09"/>
</g>
<!-- layer34_ffn_ar -->
<g id="node885" class="node">
<title>layer34_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1194.5" cy="-88280.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1194.5" y="-88299.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1194.5" y="-88284.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1194.5" y="-88269.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1194.5" y="-88254.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer34_ffn_down_2&#45;&gt;layer34_ffn_ar -->
<g id="edge1128" class="edge">
<title>layer34_ffn_down_2&#45;&gt;layer34_ffn_ar</title>
<path fill="none" stroke="black" d="M1124.69,-88400.52C1124.69,-88400.52 1124.69,-88330.17 1124.69,-88330.17"/>
<polygon fill="black" stroke="black" points="1128.19,-88330.17 1124.69,-88320.17 1121.19,-88330.17 1128.19,-88330.17"/>
</g>
<!-- layer34_ffn_down_3&#45;&gt;layer34_ffn_ar -->
<g id="edge1129" class="edge">
<title>layer34_ffn_down_3&#45;&gt;layer34_ffn_ar</title>
<path fill="none" stroke="black" d="M1265.31,-88400.52C1265.31,-88400.52 1265.31,-88329.89 1265.31,-88329.89"/>
<polygon fill="black" stroke="black" points="1268.81,-88329.89 1265.31,-88319.89 1261.81,-88329.89 1268.81,-88329.89"/>
</g>
<!-- layer35_norm_2 -->
<g id="node886" class="node">
<title>layer35_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1176.5,-88160.55 1004.5,-88160.55 1004.5,-88092.55 1176.5,-88092.55 1176.5,-88160.55"/>
<text text-anchor="middle" x="1090.5" y="-88145.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1090.5" y="-88130.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1090.5" y="-88115.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1090.5" y="-88100.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer34_ffn_ar&#45;&gt;layer35_norm_2 -->
<g id="edge1130" class="edge">
<title>layer34_ffn_ar&#45;&gt;layer35_norm_2</title>
<path fill="none" stroke="black" d="M1124.69,-88240.95C1124.69,-88240.95 1124.69,-88170.6 1124.69,-88170.6"/>
<polygon fill="black" stroke="black" points="1128.19,-88170.6 1124.69,-88160.6 1121.19,-88170.6 1128.19,-88170.6"/>
</g>
<!-- layer35_norm_3 -->
<g id="node887" class="node">
<title>layer35_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1386.5,-88160.55 1214.5,-88160.55 1214.5,-88092.55 1386.5,-88092.55 1386.5,-88160.55"/>
<text text-anchor="middle" x="1300.5" y="-88145.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1300.5" y="-88130.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1300.5" y="-88115.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1300.5" y="-88100.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer34_ffn_ar&#45;&gt;layer35_norm_3 -->
<g id="edge1131" class="edge">
<title>layer34_ffn_ar&#45;&gt;layer35_norm_3</title>
<path fill="none" stroke="black" d="M1265.31,-88241.35C1265.31,-88241.35 1265.31,-88170.78 1265.31,-88170.78"/>
<polygon fill="black" stroke="black" points="1268.81,-88170.78 1265.31,-88160.78 1261.81,-88170.78 1268.81,-88170.78"/>
</g>
<!-- layer35_qkv_2 -->
<g id="node888" class="node">
<title>layer35_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1177,-88020.55 996,-88020.55 996,-87952.55 1177,-87952.55 1177,-88020.55"/>
<text text-anchor="middle" x="1086.5" y="-88005.35" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1086.5" y="-87990.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1086.5" y="-87975.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1086.5" y="-87960.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer35_norm_2&#45;&gt;layer35_qkv_2 -->
<g id="edge1132" class="edge">
<title>layer35_norm_2&#45;&gt;layer35_qkv_2</title>
<path fill="none" stroke="black" d="M1090.5,-88092.3C1090.5,-88092.3 1090.5,-88030.93 1090.5,-88030.93"/>
<polygon fill="black" stroke="black" points="1094,-88030.93 1090.5,-88020.93 1087,-88030.93 1094,-88030.93"/>
</g>
<!-- layer35_qkv_3 -->
<g id="node889" class="node">
<title>layer35_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1394,-88020.55 1213,-88020.55 1213,-87952.55 1394,-87952.55 1394,-88020.55"/>
<text text-anchor="middle" x="1303.5" y="-88005.35" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1303.5" y="-87990.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1303.5" y="-87975.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1303.5" y="-87960.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer35_norm_3&#45;&gt;layer35_qkv_3 -->
<g id="edge1133" class="edge">
<title>layer35_norm_3&#45;&gt;layer35_qkv_3</title>
<path fill="none" stroke="black" d="M1300.5,-88092.3C1300.5,-88092.3 1300.5,-88030.93 1300.5,-88030.93"/>
<polygon fill="black" stroke="black" points="1304,-88030.93 1300.5,-88020.93 1297,-88030.93 1304,-88030.93"/>
</g>
<!-- layer35_qkv_ar -->
<g id="node890" class="node">
<title>layer35_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1194.5" cy="-87832.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1194.5" y="-87851.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1194.5" y="-87836.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1194.5" y="-87821.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1194.5" y="-87806.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer35_qkv_2&#45;&gt;layer35_qkv_ar -->
<g id="edge1134" class="edge">
<title>layer35_qkv_2&#45;&gt;layer35_qkv_ar</title>
<path fill="none" stroke="black" d="M1121.76,-87952.35C1121.76,-87952.35 1121.76,-87882.28 1121.76,-87882.28"/>
<polygon fill="black" stroke="black" points="1125.26,-87882.28 1121.76,-87872.28 1118.26,-87882.28 1125.26,-87882.28"/>
</g>
<!-- layer35_qkv_3&#45;&gt;layer35_qkv_ar -->
<g id="edge1135" class="edge">
<title>layer35_qkv_3&#45;&gt;layer35_qkv_ar</title>
<path fill="none" stroke="black" d="M1267.74,-87952.35C1267.74,-87952.35 1267.74,-87882.01 1267.74,-87882.01"/>
<polygon fill="black" stroke="black" points="1271.24,-87882.01 1267.74,-87872.01 1264.24,-87882.01 1271.24,-87882.01"/>
</g>
<!-- layer35_attn_2 -->
<g id="node891" class="node">
<title>layer35_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1176.5,-87712.38 1004.5,-87712.38 1004.5,-87644.38 1176.5,-87644.38 1176.5,-87712.38"/>
<text text-anchor="middle" x="1090.5" y="-87697.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1090.5" y="-87682.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1090.5" y="-87667.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1090.5" y="-87652.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer35_qkv_ar&#45;&gt;layer35_attn_2 -->
<g id="edge1136" class="edge">
<title>layer35_qkv_ar&#45;&gt;layer35_attn_2</title>
<path fill="none" stroke="black" d="M1121.51,-87792.78C1121.51,-87792.78 1121.51,-87722.44 1121.51,-87722.44"/>
<polygon fill="black" stroke="black" points="1125.01,-87722.44 1121.51,-87712.44 1118.01,-87722.44 1125.01,-87722.44"/>
</g>
<!-- layer35_attn_3 -->
<g id="node892" class="node">
<title>layer35_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1384.5,-87712.38 1212.5,-87712.38 1212.5,-87644.38 1384.5,-87644.38 1384.5,-87712.38"/>
<text text-anchor="middle" x="1298.5" y="-87697.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1298.5" y="-87682.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1298.5" y="-87667.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1298.5" y="-87652.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer35_qkv_ar&#45;&gt;layer35_attn_3 -->
<g id="edge1137" class="edge">
<title>layer35_qkv_ar&#45;&gt;layer35_attn_3</title>
<path fill="none" stroke="black" d="M1267.49,-87792.78C1267.49,-87792.78 1267.49,-87722.44 1267.49,-87722.44"/>
<polygon fill="black" stroke="black" points="1270.99,-87722.44 1267.49,-87712.44 1263.99,-87722.44 1270.99,-87722.44"/>
</g>
<!-- layer35_attn_out_2 -->
<g id="node893" class="node">
<title>layer35_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1176.5,-87572.38 1004.5,-87572.38 1004.5,-87504.38 1176.5,-87504.38 1176.5,-87572.38"/>
<text text-anchor="middle" x="1090.5" y="-87557.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1090.5" y="-87542.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1090.5" y="-87527.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1090.5" y="-87512.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer35_attn_2&#45;&gt;layer35_attn_out_2 -->
<g id="edge1138" class="edge">
<title>layer35_attn_2&#45;&gt;layer35_attn_out_2</title>
<path fill="none" stroke="black" d="M1090.5,-87644.13C1090.5,-87644.13 1090.5,-87582.76 1090.5,-87582.76"/>
<polygon fill="black" stroke="black" points="1094,-87582.76 1090.5,-87572.76 1087,-87582.76 1094,-87582.76"/>
</g>
<!-- layer35_attn_out_3 -->
<g id="node894" class="node">
<title>layer35_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1384.5,-87572.38 1212.5,-87572.38 1212.5,-87504.38 1384.5,-87504.38 1384.5,-87572.38"/>
<text text-anchor="middle" x="1298.5" y="-87557.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1298.5" y="-87542.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1298.5" y="-87527.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1298.5" y="-87512.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer35_attn_3&#45;&gt;layer35_attn_out_3 -->
<g id="edge1139" class="edge">
<title>layer35_attn_3&#45;&gt;layer35_attn_out_3</title>
<path fill="none" stroke="black" d="M1298.5,-87644.13C1298.5,-87644.13 1298.5,-87582.76 1298.5,-87582.76"/>
<polygon fill="black" stroke="black" points="1302,-87582.76 1298.5,-87572.76 1295,-87582.76 1302,-87582.76"/>
</g>
<!-- layer35_attn_ar -->
<g id="node895" class="node">
<title>layer35_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1194.5" cy="-87384.3" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1194.5" y="-87403.1" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1194.5" y="-87388.1" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1194.5" y="-87373.1" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1194.5" y="-87358.1" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer35_attn_out_2&#45;&gt;layer35_attn_ar -->
<g id="edge1140" class="edge">
<title>layer35_attn_out_2&#45;&gt;layer35_attn_ar</title>
<path fill="none" stroke="black" d="M1124.69,-87504.18C1124.69,-87504.18 1124.69,-87433.84 1124.69,-87433.84"/>
<polygon fill="black" stroke="black" points="1128.19,-87433.84 1124.69,-87423.84 1121.19,-87433.84 1128.19,-87433.84"/>
</g>
<!-- layer35_attn_out_3&#45;&gt;layer35_attn_ar -->
<g id="edge1141" class="edge">
<title>layer35_attn_out_3&#45;&gt;layer35_attn_ar</title>
<path fill="none" stroke="black" d="M1264.31,-87504.18C1264.31,-87504.18 1264.31,-87433.84 1264.31,-87433.84"/>
<polygon fill="black" stroke="black" points="1267.81,-87433.84 1264.31,-87423.84 1260.81,-87433.84 1267.81,-87433.84"/>
</g>
<!-- layer35_ffn_norm_2 -->
<g id="node896" class="node">
<title>layer35_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1172.5,-87264.21 1000.5,-87264.21 1000.5,-87196.21 1172.5,-87196.21 1172.5,-87264.21"/>
<text text-anchor="middle" x="1086.5" y="-87249.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1086.5" y="-87234.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1086.5" y="-87219.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1086.5" y="-87204.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer35_attn_ar&#45;&gt;layer35_ffn_norm_2 -->
<g id="edge1142" class="edge">
<title>layer35_attn_ar&#45;&gt;layer35_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1122.69,-87345.42C1122.69,-87345.42 1122.69,-87274.36 1122.69,-87274.36"/>
<polygon fill="black" stroke="black" points="1126.19,-87274.36 1122.69,-87264.36 1119.19,-87274.36 1126.19,-87274.36"/>
</g>
<!-- layer35_ffn_norm_3 -->
<g id="node897" class="node">
<title>layer35_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1389.5,-87264.21 1217.5,-87264.21 1217.5,-87196.21 1389.5,-87196.21 1389.5,-87264.21"/>
<text text-anchor="middle" x="1303.5" y="-87249.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1303.5" y="-87234.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1303.5" y="-87219.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1303.5" y="-87204.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer35_attn_ar&#45;&gt;layer35_ffn_norm_3 -->
<g id="edge1143" class="edge">
<title>layer35_attn_ar&#45;&gt;layer35_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1266.81,-87345.42C1266.81,-87345.42 1266.81,-87274.36 1266.81,-87274.36"/>
<polygon fill="black" stroke="black" points="1270.31,-87274.36 1266.81,-87264.36 1263.31,-87274.36 1270.31,-87274.36"/>
</g>
<!-- layer35_ffn_gate_2 -->
<g id="node898" class="node">
<title>layer35_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1177,-87124.21 996,-87124.21 996,-87056.21 1177,-87056.21 1177,-87124.21"/>
<text text-anchor="middle" x="1086.5" y="-87109.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1086.5" y="-87094.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1086.5" y="-87079.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1086.5" y="-87064.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_ffn_norm_2&#45;&gt;layer35_ffn_gate_2 -->
<g id="edge1144" class="edge">
<title>layer35_ffn_norm_2&#45;&gt;layer35_ffn_gate_2</title>
<path fill="none" stroke="black" d="M1086.5,-87195.97C1086.5,-87195.97 1086.5,-87134.59 1086.5,-87134.59"/>
<polygon fill="black" stroke="black" points="1090,-87134.59 1086.5,-87124.59 1083,-87134.59 1090,-87134.59"/>
</g>
<!-- layer35_ffn_up_2 -->
<g id="node900" class="node">
<title>layer35_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="960,-87124.21 779,-87124.21 779,-87056.21 960,-87056.21 960,-87124.21"/>
<text text-anchor="middle" x="869.5" y="-87109.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="869.5" y="-87094.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="869.5" y="-87079.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="869.5" y="-87064.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_ffn_norm_2&#45;&gt;layer35_ffn_up_2 -->
<g id="edge1146" class="edge">
<title>layer35_ffn_norm_2&#45;&gt;layer35_ffn_up_2</title>
<path fill="none" stroke="black" d="M1000.31,-87230C960.86,-87230 922.76,-87230 922.76,-87230 922.76,-87230 922.76,-87134.41 922.76,-87134.41"/>
<polygon fill="black" stroke="black" points="926.26,-87134.41 922.76,-87124.41 919.26,-87134.41 926.26,-87134.41"/>
</g>
<!-- layer35_ffn_gate_3 -->
<g id="node899" class="node">
<title>layer35_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1611,-87124.21 1430,-87124.21 1430,-87056.21 1611,-87056.21 1611,-87124.21"/>
<text text-anchor="middle" x="1520.5" y="-87109.01" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1520.5" y="-87094.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1520.5" y="-87079.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1520.5" y="-87064.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_ffn_norm_3&#45;&gt;layer35_ffn_gate_3 -->
<g id="edge1145" class="edge">
<title>layer35_ffn_norm_3&#45;&gt;layer35_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1389.56,-87230C1428.95,-87230 1467,-87230 1467,-87230 1467,-87230 1467,-87134.41 1467,-87134.41"/>
<polygon fill="black" stroke="black" points="1470.5,-87134.41 1467,-87124.41 1463.5,-87134.41 1470.5,-87134.41"/>
</g>
<!-- layer35_ffn_up_3 -->
<g id="node901" class="node">
<title>layer35_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1394,-87124.21 1213,-87124.21 1213,-87056.21 1394,-87056.21 1394,-87124.21"/>
<text text-anchor="middle" x="1303.5" y="-87109.01" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1303.5" y="-87094.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1303.5" y="-87079.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1303.5" y="-87064.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_ffn_norm_3&#45;&gt;layer35_ffn_up_3 -->
<g id="edge1147" class="edge">
<title>layer35_ffn_norm_3&#45;&gt;layer35_ffn_up_3</title>
<path fill="none" stroke="black" d="M1303.5,-87195.97C1303.5,-87195.97 1303.5,-87134.59 1303.5,-87134.59"/>
<polygon fill="black" stroke="black" points="1307,-87134.59 1303.5,-87124.59 1300,-87134.59 1307,-87134.59"/>
</g>
<!-- layer35_gate_ar -->
<g id="node902" class="node">
<title>layer35_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1394.5" cy="-86936.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1394.5" y="-86954.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1394.5" y="-86939.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1394.5" y="-86924.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1394.5" y="-86909.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer35_ffn_gate_2&#45;&gt;layer35_gate_ar -->
<g id="edge1148" class="edge">
<title>layer35_ffn_gate_2&#45;&gt;layer35_gate_ar</title>
<path fill="none" stroke="black" d="M1177.08,-87090C1187.79,-87090 1195,-87090 1195,-87090 1195,-87090 1195,-86952 1195,-86952 1195,-86952 1263.56,-86952 1263.56,-86952"/>
<polygon fill="black" stroke="black" points="1263.56,-86955.5 1273.56,-86952 1263.56,-86948.5 1263.56,-86955.5"/>
</g>
<!-- layer35_ffn_gate_3&#45;&gt;layer35_gate_ar -->
<g id="edge1149" class="edge">
<title>layer35_ffn_gate_3&#45;&gt;layer35_gate_ar</title>
<path fill="none" stroke="black" d="M1476.24,-87056.02C1476.24,-87056.02 1476.24,-86983.19 1476.24,-86983.19"/>
<polygon fill="black" stroke="black" points="1479.74,-86983.19 1476.24,-86973.19 1472.74,-86983.19 1479.74,-86983.19"/>
</g>
<!-- layer35_up_ar -->
<g id="node903" class="node">
<title>layer35_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1048.5" cy="-86936.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1048.5" y="-86954.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1048.5" y="-86939.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1048.5" y="-86924.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1048.5" y="-86909.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer35_ffn_up_2&#45;&gt;layer35_up_ar -->
<g id="edge1150" class="edge">
<title>layer35_ffn_up_2&#45;&gt;layer35_up_ar</title>
<path fill="none" stroke="black" d="M940.26,-87056.02C940.26,-87056.02 940.26,-86972.09 940.26,-86972.09"/>
<polygon fill="black" stroke="black" points="943.76,-86972.09 940.26,-86962.09 936.76,-86972.09 943.76,-86972.09"/>
</g>
<!-- layer35_ffn_up_3&#45;&gt;layer35_up_ar -->
<g id="edge1151" class="edge">
<title>layer35_ffn_up_3&#45;&gt;layer35_up_ar</title>
<path fill="none" stroke="black" d="M1239.76,-87056.18C1239.76,-87006.5 1239.76,-86920 1239.76,-86920 1239.76,-86920 1179.08,-86920 1179.08,-86920"/>
<polygon fill="black" stroke="black" points="1179.08,-86916.5 1169.08,-86920 1179.08,-86923.5 1179.08,-86916.5"/>
</g>
<!-- layer35_silu_2 -->
<g id="node904" class="node">
<title>layer35_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1322,-86816.05 1141,-86816.05 1141,-86748.05 1322,-86748.05 1322,-86816.05"/>
<text text-anchor="middle" x="1231.5" y="-86800.85" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1231.5" y="-86785.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1231.5" y="-86770.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1231.5" y="-86755.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_gate_ar&#45;&gt;layer35_silu_2 -->
<g id="edge1152" class="edge">
<title>layer35_gate_ar&#45;&gt;layer35_silu_2</title>
<path fill="none" stroke="black" d="M1294.26,-86906.06C1294.26,-86906.06 1294.26,-86826.07 1294.26,-86826.07"/>
<polygon fill="black" stroke="black" points="1297.76,-86826.07 1294.26,-86816.07 1290.76,-86826.07 1297.76,-86826.07"/>
</g>
<!-- layer35_silu_3 -->
<g id="node905" class="node">
<title>layer35_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1539,-86816.05 1358,-86816.05 1358,-86748.05 1539,-86748.05 1539,-86816.05"/>
<text text-anchor="middle" x="1448.5" y="-86800.85" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1448.5" y="-86785.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1448.5" y="-86770.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1448.5" y="-86755.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_gate_ar&#45;&gt;layer35_silu_3 -->
<g id="edge1153" class="edge">
<title>layer35_gate_ar&#45;&gt;layer35_silu_3</title>
<path fill="none" stroke="black" d="M1440.24,-86891.15C1440.24,-86891.15 1440.24,-86826.05 1440.24,-86826.05"/>
<polygon fill="black" stroke="black" points="1443.74,-86826.05 1440.24,-86816.05 1436.74,-86826.05 1443.74,-86826.05"/>
</g>
<!-- layer35_mul_2 -->
<g id="node906" class="node">
<title>layer35_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1212,-86676.05 1031,-86676.05 1031,-86608.05 1212,-86608.05 1212,-86676.05"/>
<text text-anchor="middle" x="1121.5" y="-86660.85" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1121.5" y="-86645.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1121.5" y="-86630.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1121.5" y="-86615.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_up_ar&#45;&gt;layer35_mul_2 -->
<g id="edge1155" class="edge">
<title>layer35_up_ar&#45;&gt;layer35_mul_2</title>
<path fill="none" stroke="black" d="M1086,-86889.86C1086,-86889.86 1086,-86686.13 1086,-86686.13"/>
<polygon fill="black" stroke="black" points="1089.5,-86686.13 1086,-86676.13 1082.5,-86686.13 1089.5,-86686.13"/>
</g>
<!-- layer35_mul_3 -->
<g id="node907" class="node">
<title>layer35_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1429,-86676.05 1248,-86676.05 1248,-86608.05 1429,-86608.05 1429,-86676.05"/>
<text text-anchor="middle" x="1338.5" y="-86660.85" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1338.5" y="-86645.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1338.5" y="-86630.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1338.5" y="-86615.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer35_up_ar&#45;&gt;layer35_mul_3 -->
<g id="edge1157" class="edge">
<title>layer35_up_ar&#45;&gt;layer35_mul_3</title>
<path fill="none" stroke="black" d="M1158.74,-86911.34C1158.74,-86886.53 1158.74,-86852 1158.74,-86852 1158.74,-86852 1340,-86852 1340,-86852 1340,-86852 1340,-86686.25 1340,-86686.25"/>
<polygon fill="black" stroke="black" points="1343.5,-86686.25 1340,-86676.25 1336.5,-86686.25 1343.5,-86686.25"/>
</g>
<!-- layer35_silu_2&#45;&gt;layer35_mul_2 -->
<g id="edge1154" class="edge">
<title>layer35_silu_2&#45;&gt;layer35_mul_2</title>
<path fill="none" stroke="black" d="M1176.5,-86747.8C1176.5,-86747.8 1176.5,-86686.43 1176.5,-86686.43"/>
<polygon fill="black" stroke="black" points="1180,-86686.43 1176.5,-86676.43 1173,-86686.43 1180,-86686.43"/>
</g>
<!-- layer35_silu_3&#45;&gt;layer35_mul_3 -->
<g id="edge1156" class="edge">
<title>layer35_silu_3&#45;&gt;layer35_mul_3</title>
<path fill="none" stroke="black" d="M1393.5,-86747.8C1393.5,-86747.8 1393.5,-86686.43 1393.5,-86686.43"/>
<polygon fill="black" stroke="black" points="1397,-86686.43 1393.5,-86676.43 1390,-86686.43 1397,-86686.43"/>
</g>
<!-- layer35_ffn_down_2 -->
<g id="node908" class="node">
<title>layer35_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1211.5,-86536.05 1039.5,-86536.05 1039.5,-86468.05 1211.5,-86468.05 1211.5,-86536.05"/>
<text text-anchor="middle" x="1125.5" y="-86520.85" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1125.5" y="-86505.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1125.5" y="-86490.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1125.5" y="-86475.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer35_mul_2&#45;&gt;layer35_ffn_down_2 -->
<g id="edge1158" class="edge">
<title>layer35_mul_2&#45;&gt;layer35_ffn_down_2</title>
<path fill="none" stroke="black" d="M1125.5,-86607.8C1125.5,-86607.8 1125.5,-86546.43 1125.5,-86546.43"/>
<polygon fill="black" stroke="black" points="1129,-86546.43 1125.5,-86536.43 1122,-86546.43 1129,-86546.43"/>
</g>
<!-- layer35_ffn_down_3 -->
<g id="node909" class="node">
<title>layer35_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1421.5,-86536.05 1249.5,-86536.05 1249.5,-86468.05 1421.5,-86468.05 1421.5,-86536.05"/>
<text text-anchor="middle" x="1335.5" y="-86520.85" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1335.5" y="-86505.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1335.5" y="-86490.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1335.5" y="-86475.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer35_mul_3&#45;&gt;layer35_ffn_down_3 -->
<g id="edge1159" class="edge">
<title>layer35_mul_3&#45;&gt;layer35_ffn_down_3</title>
<path fill="none" stroke="black" d="M1335.5,-86607.8C1335.5,-86607.8 1335.5,-86546.43 1335.5,-86546.43"/>
<polygon fill="black" stroke="black" points="1339,-86546.43 1335.5,-86536.43 1332,-86546.43 1339,-86546.43"/>
</g>
<!-- layer35_ffn_ar -->
<g id="node910" class="node">
<title>layer35_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1229.5" cy="-86347.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1229.5" y="-86366.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1229.5" y="-86351.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1229.5" y="-86336.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1229.5" y="-86321.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer35_ffn_down_2&#45;&gt;layer35_ffn_ar -->
<g id="edge1160" class="edge">
<title>layer35_ffn_down_2&#45;&gt;layer35_ffn_ar</title>
<path fill="none" stroke="black" d="M1159.69,-86467.85C1159.69,-86467.85 1159.69,-86397.51 1159.69,-86397.51"/>
<polygon fill="black" stroke="black" points="1163.19,-86397.51 1159.69,-86387.51 1156.19,-86397.51 1163.19,-86397.51"/>
</g>
<!-- layer35_ffn_down_3&#45;&gt;layer35_ffn_ar -->
<g id="edge1161" class="edge">
<title>layer35_ffn_down_3&#45;&gt;layer35_ffn_ar</title>
<path fill="none" stroke="black" d="M1300.31,-86467.85C1300.31,-86467.85 1300.31,-86397.23 1300.31,-86397.23"/>
<polygon fill="black" stroke="black" points="1303.81,-86397.23 1300.31,-86387.23 1296.81,-86397.23 1303.81,-86397.23"/>
</g>
<!-- layer36_norm_2 -->
<g id="node911" class="node">
<title>layer36_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1211.5,-86227.88 1039.5,-86227.88 1039.5,-86159.88 1211.5,-86159.88 1211.5,-86227.88"/>
<text text-anchor="middle" x="1125.5" y="-86212.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1125.5" y="-86197.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1125.5" y="-86182.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1125.5" y="-86167.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer35_ffn_ar&#45;&gt;layer36_norm_2 -->
<g id="edge1162" class="edge">
<title>layer35_ffn_ar&#45;&gt;layer36_norm_2</title>
<path fill="none" stroke="black" d="M1159.69,-86308.28C1159.69,-86308.28 1159.69,-86237.94 1159.69,-86237.94"/>
<polygon fill="black" stroke="black" points="1163.19,-86237.94 1159.69,-86227.94 1156.19,-86237.94 1163.19,-86237.94"/>
</g>
<!-- layer36_norm_3 -->
<g id="node912" class="node">
<title>layer36_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1421.5,-86227.88 1249.5,-86227.88 1249.5,-86159.88 1421.5,-86159.88 1421.5,-86227.88"/>
<text text-anchor="middle" x="1335.5" y="-86212.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1335.5" y="-86197.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1335.5" y="-86182.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1335.5" y="-86167.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer35_ffn_ar&#45;&gt;layer36_norm_3 -->
<g id="edge1163" class="edge">
<title>layer35_ffn_ar&#45;&gt;layer36_norm_3</title>
<path fill="none" stroke="black" d="M1300.31,-86308.68C1300.31,-86308.68 1300.31,-86238.11 1300.31,-86238.11"/>
<polygon fill="black" stroke="black" points="1303.81,-86238.11 1300.31,-86228.11 1296.81,-86238.11 1303.81,-86238.11"/>
</g>
<!-- layer36_qkv_2 -->
<g id="node913" class="node">
<title>layer36_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1212,-86087.88 1031,-86087.88 1031,-86019.88 1212,-86019.88 1212,-86087.88"/>
<text text-anchor="middle" x="1121.5" y="-86072.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1121.5" y="-86057.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1121.5" y="-86042.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1121.5" y="-86027.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer36_norm_2&#45;&gt;layer36_qkv_2 -->
<g id="edge1164" class="edge">
<title>layer36_norm_2&#45;&gt;layer36_qkv_2</title>
<path fill="none" stroke="black" d="M1125.5,-86159.63C1125.5,-86159.63 1125.5,-86098.26 1125.5,-86098.26"/>
<polygon fill="black" stroke="black" points="1129,-86098.26 1125.5,-86088.26 1122,-86098.26 1129,-86098.26"/>
</g>
<!-- layer36_qkv_3 -->
<g id="node914" class="node">
<title>layer36_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1429,-86087.88 1248,-86087.88 1248,-86019.88 1429,-86019.88 1429,-86087.88"/>
<text text-anchor="middle" x="1338.5" y="-86072.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1338.5" y="-86057.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1338.5" y="-86042.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1338.5" y="-86027.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer36_norm_3&#45;&gt;layer36_qkv_3 -->
<g id="edge1165" class="edge">
<title>layer36_norm_3&#45;&gt;layer36_qkv_3</title>
<path fill="none" stroke="black" d="M1335.5,-86159.63C1335.5,-86159.63 1335.5,-86098.26 1335.5,-86098.26"/>
<polygon fill="black" stroke="black" points="1339,-86098.26 1335.5,-86088.26 1332,-86098.26 1339,-86098.26"/>
</g>
<!-- layer36_qkv_ar -->
<g id="node915" class="node">
<title>layer36_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1229.5" cy="-85899.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1229.5" y="-85918.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1229.5" y="-85903.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1229.5" y="-85888.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1229.5" y="-85873.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer36_qkv_2&#45;&gt;layer36_qkv_ar -->
<g id="edge1166" class="edge">
<title>layer36_qkv_2&#45;&gt;layer36_qkv_ar</title>
<path fill="none" stroke="black" d="M1156.76,-86019.68C1156.76,-86019.68 1156.76,-85949.62 1156.76,-85949.62"/>
<polygon fill="black" stroke="black" points="1160.26,-85949.62 1156.76,-85939.62 1153.26,-85949.62 1160.26,-85949.62"/>
</g>
<!-- layer36_qkv_3&#45;&gt;layer36_qkv_ar -->
<g id="edge1167" class="edge">
<title>layer36_qkv_3&#45;&gt;layer36_qkv_ar</title>
<path fill="none" stroke="black" d="M1302.74,-86019.68C1302.74,-86019.68 1302.74,-85949.34 1302.74,-85949.34"/>
<polygon fill="black" stroke="black" points="1306.24,-85949.34 1302.74,-85939.34 1299.24,-85949.34 1306.24,-85949.34"/>
</g>
<!-- layer36_attn_2 -->
<g id="node916" class="node">
<title>layer36_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1211.5,-85779.71 1039.5,-85779.71 1039.5,-85711.71 1211.5,-85711.71 1211.5,-85779.71"/>
<text text-anchor="middle" x="1125.5" y="-85764.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1125.5" y="-85749.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1125.5" y="-85734.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1125.5" y="-85719.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer36_qkv_ar&#45;&gt;layer36_attn_2 -->
<g id="edge1168" class="edge">
<title>layer36_qkv_ar&#45;&gt;layer36_attn_2</title>
<path fill="none" stroke="black" d="M1156.51,-85860.12C1156.51,-85860.12 1156.51,-85789.77 1156.51,-85789.77"/>
<polygon fill="black" stroke="black" points="1160.01,-85789.77 1156.51,-85779.77 1153.01,-85789.77 1160.01,-85789.77"/>
</g>
<!-- layer36_attn_3 -->
<g id="node917" class="node">
<title>layer36_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1419.5,-85779.71 1247.5,-85779.71 1247.5,-85711.71 1419.5,-85711.71 1419.5,-85779.71"/>
<text text-anchor="middle" x="1333.5" y="-85764.51" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1333.5" y="-85749.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1333.5" y="-85734.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1333.5" y="-85719.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer36_qkv_ar&#45;&gt;layer36_attn_3 -->
<g id="edge1169" class="edge">
<title>layer36_qkv_ar&#45;&gt;layer36_attn_3</title>
<path fill="none" stroke="black" d="M1302.49,-85860.12C1302.49,-85860.12 1302.49,-85789.77 1302.49,-85789.77"/>
<polygon fill="black" stroke="black" points="1305.99,-85789.77 1302.49,-85779.77 1298.99,-85789.77 1305.99,-85789.77"/>
</g>
<!-- layer36_attn_out_2 -->
<g id="node918" class="node">
<title>layer36_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1211.5,-85639.71 1039.5,-85639.71 1039.5,-85571.71 1211.5,-85571.71 1211.5,-85639.71"/>
<text text-anchor="middle" x="1125.5" y="-85624.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1125.5" y="-85609.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1125.5" y="-85594.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1125.5" y="-85579.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer36_attn_2&#45;&gt;layer36_attn_out_2 -->
<g id="edge1170" class="edge">
<title>layer36_attn_2&#45;&gt;layer36_attn_out_2</title>
<path fill="none" stroke="black" d="M1125.5,-85711.47C1125.5,-85711.47 1125.5,-85650.09 1125.5,-85650.09"/>
<polygon fill="black" stroke="black" points="1129,-85650.09 1125.5,-85640.09 1122,-85650.09 1129,-85650.09"/>
</g>
<!-- layer36_attn_out_3 -->
<g id="node919" class="node">
<title>layer36_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1419.5,-85639.71 1247.5,-85639.71 1247.5,-85571.71 1419.5,-85571.71 1419.5,-85639.71"/>
<text text-anchor="middle" x="1333.5" y="-85624.51" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1333.5" y="-85609.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1333.5" y="-85594.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1333.5" y="-85579.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer36_attn_3&#45;&gt;layer36_attn_out_3 -->
<g id="edge1171" class="edge">
<title>layer36_attn_3&#45;&gt;layer36_attn_out_3</title>
<path fill="none" stroke="black" d="M1333.5,-85711.47C1333.5,-85711.47 1333.5,-85650.09 1333.5,-85650.09"/>
<polygon fill="black" stroke="black" points="1337,-85650.09 1333.5,-85640.09 1330,-85650.09 1337,-85650.09"/>
</g>
<!-- layer36_attn_ar -->
<g id="node920" class="node">
<title>layer36_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1229.5" cy="-85451.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1229.5" y="-85470.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1229.5" y="-85455.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1229.5" y="-85440.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1229.5" y="-85425.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer36_attn_out_2&#45;&gt;layer36_attn_ar -->
<g id="edge1172" class="edge">
<title>layer36_attn_out_2&#45;&gt;layer36_attn_ar</title>
<path fill="none" stroke="black" d="M1159.69,-85571.52C1159.69,-85571.52 1159.69,-85501.17 1159.69,-85501.17"/>
<polygon fill="black" stroke="black" points="1163.19,-85501.17 1159.69,-85491.17 1156.19,-85501.17 1163.19,-85501.17"/>
</g>
<!-- layer36_attn_out_3&#45;&gt;layer36_attn_ar -->
<g id="edge1173" class="edge">
<title>layer36_attn_out_3&#45;&gt;layer36_attn_ar</title>
<path fill="none" stroke="black" d="M1299.31,-85571.52C1299.31,-85571.52 1299.31,-85501.17 1299.31,-85501.17"/>
<polygon fill="black" stroke="black" points="1302.81,-85501.17 1299.31,-85491.17 1295.81,-85501.17 1302.81,-85501.17"/>
</g>
<!-- layer36_ffn_norm_2 -->
<g id="node921" class="node">
<title>layer36_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1207.5,-85331.55 1035.5,-85331.55 1035.5,-85263.55 1207.5,-85263.55 1207.5,-85331.55"/>
<text text-anchor="middle" x="1121.5" y="-85316.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1121.5" y="-85301.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1121.5" y="-85286.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1121.5" y="-85271.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer36_attn_ar&#45;&gt;layer36_ffn_norm_2 -->
<g id="edge1174" class="edge">
<title>layer36_attn_ar&#45;&gt;layer36_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1157.69,-85412.75C1157.69,-85412.75 1157.69,-85341.7 1157.69,-85341.7"/>
<polygon fill="black" stroke="black" points="1161.19,-85341.7 1157.69,-85331.7 1154.19,-85341.7 1161.19,-85341.7"/>
</g>
<!-- layer36_ffn_norm_3 -->
<g id="node922" class="node">
<title>layer36_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1424.5,-85331.55 1252.5,-85331.55 1252.5,-85263.55 1424.5,-85263.55 1424.5,-85331.55"/>
<text text-anchor="middle" x="1338.5" y="-85316.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1338.5" y="-85301.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1338.5" y="-85286.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1338.5" y="-85271.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer36_attn_ar&#45;&gt;layer36_ffn_norm_3 -->
<g id="edge1175" class="edge">
<title>layer36_attn_ar&#45;&gt;layer36_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1301.81,-85412.75C1301.81,-85412.75 1301.81,-85341.7 1301.81,-85341.7"/>
<polygon fill="black" stroke="black" points="1305.31,-85341.7 1301.81,-85331.7 1298.31,-85341.7 1305.31,-85341.7"/>
</g>
<!-- layer36_ffn_gate_2 -->
<g id="node923" class="node">
<title>layer36_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1212,-85191.55 1031,-85191.55 1031,-85123.55 1212,-85123.55 1212,-85191.55"/>
<text text-anchor="middle" x="1121.5" y="-85176.35" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1121.5" y="-85161.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1121.5" y="-85146.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1121.5" y="-85131.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_ffn_norm_2&#45;&gt;layer36_ffn_gate_2 -->
<g id="edge1176" class="edge">
<title>layer36_ffn_norm_2&#45;&gt;layer36_ffn_gate_2</title>
<path fill="none" stroke="black" d="M1121.5,-85263.3C1121.5,-85263.3 1121.5,-85201.93 1121.5,-85201.93"/>
<polygon fill="black" stroke="black" points="1125,-85201.93 1121.5,-85191.93 1118,-85201.93 1125,-85201.93"/>
</g>
<!-- layer36_ffn_up_2 -->
<g id="node925" class="node">
<title>layer36_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="995,-85191.55 814,-85191.55 814,-85123.55 995,-85123.55 995,-85191.55"/>
<text text-anchor="middle" x="904.5" y="-85176.35" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="904.5" y="-85161.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="904.5" y="-85146.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="904.5" y="-85131.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_ffn_norm_2&#45;&gt;layer36_ffn_up_2 -->
<g id="edge1178" class="edge">
<title>layer36_ffn_norm_2&#45;&gt;layer36_ffn_up_2</title>
<path fill="none" stroke="black" d="M1035.31,-85297C995.86,-85297 957.76,-85297 957.76,-85297 957.76,-85297 957.76,-85201.66 957.76,-85201.66"/>
<polygon fill="black" stroke="black" points="961.26,-85201.66 957.76,-85191.66 954.26,-85201.66 961.26,-85201.66"/>
</g>
<!-- layer36_ffn_gate_3 -->
<g id="node924" class="node">
<title>layer36_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1646,-85191.55 1465,-85191.55 1465,-85123.55 1646,-85123.55 1646,-85191.55"/>
<text text-anchor="middle" x="1555.5" y="-85176.35" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1555.5" y="-85161.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1555.5" y="-85146.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1555.5" y="-85131.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_ffn_norm_3&#45;&gt;layer36_ffn_gate_3 -->
<g id="edge1177" class="edge">
<title>layer36_ffn_norm_3&#45;&gt;layer36_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1424.56,-85297C1463.95,-85297 1502,-85297 1502,-85297 1502,-85297 1502,-85201.66 1502,-85201.66"/>
<polygon fill="black" stroke="black" points="1505.5,-85201.66 1502,-85191.66 1498.5,-85201.66 1505.5,-85201.66"/>
</g>
<!-- layer36_ffn_up_3 -->
<g id="node926" class="node">
<title>layer36_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1429,-85191.55 1248,-85191.55 1248,-85123.55 1429,-85123.55 1429,-85191.55"/>
<text text-anchor="middle" x="1338.5" y="-85176.35" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1338.5" y="-85161.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1338.5" y="-85146.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1338.5" y="-85131.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_ffn_norm_3&#45;&gt;layer36_ffn_up_3 -->
<g id="edge1179" class="edge">
<title>layer36_ffn_norm_3&#45;&gt;layer36_ffn_up_3</title>
<path fill="none" stroke="black" d="M1338.5,-85263.3C1338.5,-85263.3 1338.5,-85201.93 1338.5,-85201.93"/>
<polygon fill="black" stroke="black" points="1342,-85201.93 1338.5,-85191.93 1335,-85201.93 1342,-85201.93"/>
</g>
<!-- layer36_gate_ar -->
<g id="node927" class="node">
<title>layer36_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1429.5" cy="-85003.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1429.5" y="-85022.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1429.5" y="-85007.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1429.5" y="-84992.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1429.5" y="-84977.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer36_ffn_gate_2&#45;&gt;layer36_gate_ar -->
<g id="edge1180" class="edge">
<title>layer36_ffn_gate_2&#45;&gt;layer36_gate_ar</title>
<path fill="none" stroke="black" d="M1212.08,-85157C1222.79,-85157 1230,-85157 1230,-85157 1230,-85157 1230,-85019 1230,-85019 1230,-85019 1298.28,-85019 1298.28,-85019"/>
<polygon fill="black" stroke="black" points="1298.28,-85022.5 1308.28,-85019 1298.28,-85015.5 1298.28,-85022.5"/>
</g>
<!-- layer36_ffn_gate_3&#45;&gt;layer36_gate_ar -->
<g id="edge1181" class="edge">
<title>layer36_ffn_gate_3&#45;&gt;layer36_gate_ar</title>
<path fill="none" stroke="black" d="M1511.24,-85123.35C1511.24,-85123.35 1511.24,-85050.53 1511.24,-85050.53"/>
<polygon fill="black" stroke="black" points="1514.74,-85050.53 1511.24,-85040.53 1507.74,-85050.53 1514.74,-85050.53"/>
</g>
<!-- layer36_up_ar -->
<g id="node928" class="node">
<title>layer36_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1083.5" cy="-85003.46" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1083.5" y="-85022.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1083.5" y="-85007.26" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1083.5" y="-84992.26" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1083.5" y="-84977.26" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer36_ffn_up_2&#45;&gt;layer36_up_ar -->
<g id="edge1182" class="edge">
<title>layer36_ffn_up_2&#45;&gt;layer36_up_ar</title>
<path fill="none" stroke="black" d="M975.26,-85123.35C975.26,-85123.35 975.26,-85039.43 975.26,-85039.43"/>
<polygon fill="black" stroke="black" points="978.76,-85039.43 975.26,-85029.43 971.76,-85039.43 978.76,-85039.43"/>
</g>
<!-- layer36_ffn_up_3&#45;&gt;layer36_up_ar -->
<g id="edge1183" class="edge">
<title>layer36_ffn_up_3&#45;&gt;layer36_up_ar</title>
<path fill="none" stroke="black" d="M1274.76,-85123.44C1274.76,-85073.67 1274.76,-84987 1274.76,-84987 1274.76,-84987 1213.81,-84987 1213.81,-84987"/>
<polygon fill="black" stroke="black" points="1213.81,-84983.5 1203.81,-84987 1213.81,-84990.5 1213.81,-84983.5"/>
</g>
<!-- layer36_silu_2 -->
<g id="node929" class="node">
<title>layer36_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1357,-84883.38 1176,-84883.38 1176,-84815.38 1357,-84815.38 1357,-84883.38"/>
<text text-anchor="middle" x="1266.5" y="-84868.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1266.5" y="-84853.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1266.5" y="-84838.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1266.5" y="-84823.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_gate_ar&#45;&gt;layer36_silu_2 -->
<g id="edge1184" class="edge">
<title>layer36_gate_ar&#45;&gt;layer36_silu_2</title>
<path fill="none" stroke="black" d="M1329.26,-84973.39C1329.26,-84973.39 1329.26,-84893.4 1329.26,-84893.4"/>
<polygon fill="black" stroke="black" points="1332.76,-84893.4 1329.26,-84883.4 1325.76,-84893.4 1332.76,-84893.4"/>
</g>
<!-- layer36_silu_3 -->
<g id="node930" class="node">
<title>layer36_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1574,-84883.38 1393,-84883.38 1393,-84815.38 1574,-84815.38 1574,-84883.38"/>
<text text-anchor="middle" x="1483.5" y="-84868.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1483.5" y="-84853.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1483.5" y="-84838.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1483.5" y="-84823.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_gate_ar&#45;&gt;layer36_silu_3 -->
<g id="edge1185" class="edge">
<title>layer36_gate_ar&#45;&gt;layer36_silu_3</title>
<path fill="none" stroke="black" d="M1475.24,-84958.48C1475.24,-84958.48 1475.24,-84893.39 1475.24,-84893.39"/>
<polygon fill="black" stroke="black" points="1478.74,-84893.39 1475.24,-84883.39 1471.74,-84893.39 1478.74,-84893.39"/>
</g>
<!-- layer36_mul_2 -->
<g id="node931" class="node">
<title>layer36_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1247,-84743.38 1066,-84743.38 1066,-84675.38 1247,-84675.38 1247,-84743.38"/>
<text text-anchor="middle" x="1156.5" y="-84728.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1156.5" y="-84713.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1156.5" y="-84698.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1156.5" y="-84683.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_up_ar&#45;&gt;layer36_mul_2 -->
<g id="edge1187" class="edge">
<title>layer36_up_ar&#45;&gt;layer36_mul_2</title>
<path fill="none" stroke="black" d="M1121,-84957.19C1121,-84957.19 1121,-84753.47 1121,-84753.47"/>
<polygon fill="black" stroke="black" points="1124.5,-84753.47 1121,-84743.47 1117.5,-84753.47 1124.5,-84753.47"/>
</g>
<!-- layer36_mul_3 -->
<g id="node932" class="node">
<title>layer36_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1464,-84743.38 1283,-84743.38 1283,-84675.38 1464,-84675.38 1464,-84743.38"/>
<text text-anchor="middle" x="1373.5" y="-84728.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1373.5" y="-84713.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1373.5" y="-84698.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1373.5" y="-84683.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer36_up_ar&#45;&gt;layer36_mul_3 -->
<g id="edge1189" class="edge">
<title>layer36_up_ar&#45;&gt;layer36_mul_3</title>
<path fill="none" stroke="black" d="M1193.74,-84979.03C1193.74,-84954.09 1193.74,-84919 1193.74,-84919 1193.74,-84919 1375,-84919 1375,-84919 1375,-84919 1375,-84753.53 1375,-84753.53"/>
<polygon fill="black" stroke="black" points="1378.5,-84753.53 1375,-84743.53 1371.5,-84753.53 1378.5,-84753.53"/>
</g>
<!-- layer36_silu_2&#45;&gt;layer36_mul_2 -->
<g id="edge1186" class="edge">
<title>layer36_silu_2&#45;&gt;layer36_mul_2</title>
<path fill="none" stroke="black" d="M1211.5,-84815.13C1211.5,-84815.13 1211.5,-84753.76 1211.5,-84753.76"/>
<polygon fill="black" stroke="black" points="1215,-84753.76 1211.5,-84743.76 1208,-84753.76 1215,-84753.76"/>
</g>
<!-- layer36_silu_3&#45;&gt;layer36_mul_3 -->
<g id="edge1188" class="edge">
<title>layer36_silu_3&#45;&gt;layer36_mul_3</title>
<path fill="none" stroke="black" d="M1428.5,-84815.13C1428.5,-84815.13 1428.5,-84753.76 1428.5,-84753.76"/>
<polygon fill="black" stroke="black" points="1432,-84753.76 1428.5,-84743.76 1425,-84753.76 1432,-84753.76"/>
</g>
<!-- layer36_ffn_down_2 -->
<g id="node933" class="node">
<title>layer36_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1246.5,-84603.38 1074.5,-84603.38 1074.5,-84535.38 1246.5,-84535.38 1246.5,-84603.38"/>
<text text-anchor="middle" x="1160.5" y="-84588.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1160.5" y="-84573.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1160.5" y="-84558.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1160.5" y="-84543.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer36_mul_2&#45;&gt;layer36_ffn_down_2 -->
<g id="edge1190" class="edge">
<title>layer36_mul_2&#45;&gt;layer36_ffn_down_2</title>
<path fill="none" stroke="black" d="M1160.5,-84675.13C1160.5,-84675.13 1160.5,-84613.76 1160.5,-84613.76"/>
<polygon fill="black" stroke="black" points="1164,-84613.76 1160.5,-84603.76 1157,-84613.76 1164,-84613.76"/>
</g>
<!-- layer36_ffn_down_3 -->
<g id="node934" class="node">
<title>layer36_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1456.5,-84603.38 1284.5,-84603.38 1284.5,-84535.38 1456.5,-84535.38 1456.5,-84603.38"/>
<text text-anchor="middle" x="1370.5" y="-84588.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1370.5" y="-84573.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1370.5" y="-84558.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1370.5" y="-84543.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer36_mul_3&#45;&gt;layer36_ffn_down_3 -->
<g id="edge1191" class="edge">
<title>layer36_mul_3&#45;&gt;layer36_ffn_down_3</title>
<path fill="none" stroke="black" d="M1370.5,-84675.13C1370.5,-84675.13 1370.5,-84613.76 1370.5,-84613.76"/>
<polygon fill="black" stroke="black" points="1374,-84613.76 1370.5,-84603.76 1367,-84613.76 1374,-84613.76"/>
</g>
<!-- layer36_ffn_ar -->
<g id="node935" class="node">
<title>layer36_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1264.5" cy="-84415.3" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1264.5" y="-84434.1" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1264.5" y="-84419.1" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1264.5" y="-84404.1" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1264.5" y="-84389.1" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer36_ffn_down_2&#45;&gt;layer36_ffn_ar -->
<g id="edge1192" class="edge">
<title>layer36_ffn_down_2&#45;&gt;layer36_ffn_ar</title>
<path fill="none" stroke="black" d="M1194.69,-84535.19C1194.69,-84535.19 1194.69,-84464.84 1194.69,-84464.84"/>
<polygon fill="black" stroke="black" points="1198.19,-84464.84 1194.69,-84454.84 1191.19,-84464.84 1198.19,-84464.84"/>
</g>
<!-- layer36_ffn_down_3&#45;&gt;layer36_ffn_ar -->
<g id="edge1193" class="edge">
<title>layer36_ffn_down_3&#45;&gt;layer36_ffn_ar</title>
<path fill="none" stroke="black" d="M1335.31,-84535.19C1335.31,-84535.19 1335.31,-84464.56 1335.31,-84464.56"/>
<polygon fill="black" stroke="black" points="1338.81,-84464.56 1335.31,-84454.56 1331.81,-84464.56 1338.81,-84464.56"/>
</g>
<!-- layer37_norm_2 -->
<g id="node936" class="node">
<title>layer37_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1246.5,-84295.21 1074.5,-84295.21 1074.5,-84227.21 1246.5,-84227.21 1246.5,-84295.21"/>
<text text-anchor="middle" x="1160.5" y="-84280.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1160.5" y="-84265.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1160.5" y="-84250.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1160.5" y="-84235.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer36_ffn_ar&#45;&gt;layer37_norm_2 -->
<g id="edge1194" class="edge">
<title>layer36_ffn_ar&#45;&gt;layer37_norm_2</title>
<path fill="none" stroke="black" d="M1194.69,-84375.62C1194.69,-84375.62 1194.69,-84305.27 1194.69,-84305.27"/>
<polygon fill="black" stroke="black" points="1198.19,-84305.27 1194.69,-84295.27 1191.19,-84305.27 1198.19,-84305.27"/>
</g>
<!-- layer37_norm_3 -->
<g id="node937" class="node">
<title>layer37_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1456.5,-84295.21 1284.5,-84295.21 1284.5,-84227.21 1456.5,-84227.21 1456.5,-84295.21"/>
<text text-anchor="middle" x="1370.5" y="-84280.01" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1370.5" y="-84265.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1370.5" y="-84250.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1370.5" y="-84235.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer36_ffn_ar&#45;&gt;layer37_norm_3 -->
<g id="edge1195" class="edge">
<title>layer36_ffn_ar&#45;&gt;layer37_norm_3</title>
<path fill="none" stroke="black" d="M1335.31,-84376.02C1335.31,-84376.02 1335.31,-84305.45 1335.31,-84305.45"/>
<polygon fill="black" stroke="black" points="1338.81,-84305.45 1335.31,-84295.45 1331.81,-84305.45 1338.81,-84305.45"/>
</g>
<!-- layer37_qkv_2 -->
<g id="node938" class="node">
<title>layer37_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1247,-84155.21 1066,-84155.21 1066,-84087.21 1247,-84087.21 1247,-84155.21"/>
<text text-anchor="middle" x="1156.5" y="-84140.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1156.5" y="-84125.01" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1156.5" y="-84110.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1156.5" y="-84095.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer37_norm_2&#45;&gt;layer37_qkv_2 -->
<g id="edge1196" class="edge">
<title>layer37_norm_2&#45;&gt;layer37_qkv_2</title>
<path fill="none" stroke="black" d="M1160.5,-84226.97C1160.5,-84226.97 1160.5,-84165.59 1160.5,-84165.59"/>
<polygon fill="black" stroke="black" points="1164,-84165.59 1160.5,-84155.59 1157,-84165.59 1164,-84165.59"/>
</g>
<!-- layer37_qkv_3 -->
<g id="node939" class="node">
<title>layer37_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1464,-84155.21 1283,-84155.21 1283,-84087.21 1464,-84087.21 1464,-84155.21"/>
<text text-anchor="middle" x="1373.5" y="-84140.01" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1373.5" y="-84125.01" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1373.5" y="-84110.01" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1373.5" y="-84095.01" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer37_norm_3&#45;&gt;layer37_qkv_3 -->
<g id="edge1197" class="edge">
<title>layer37_norm_3&#45;&gt;layer37_qkv_3</title>
<path fill="none" stroke="black" d="M1370.5,-84226.97C1370.5,-84226.97 1370.5,-84165.59 1370.5,-84165.59"/>
<polygon fill="black" stroke="black" points="1374,-84165.59 1370.5,-84155.59 1367,-84165.59 1374,-84165.59"/>
</g>
<!-- layer37_qkv_ar -->
<g id="node940" class="node">
<title>layer37_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1264.5" cy="-83967.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1264.5" y="-83985.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1264.5" y="-83970.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1264.5" y="-83955.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1264.5" y="-83940.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer37_qkv_2&#45;&gt;layer37_qkv_ar -->
<g id="edge1198" class="edge">
<title>layer37_qkv_2&#45;&gt;layer37_qkv_ar</title>
<path fill="none" stroke="black" d="M1191.76,-84087.02C1191.76,-84087.02 1191.76,-84016.95 1191.76,-84016.95"/>
<polygon fill="black" stroke="black" points="1195.26,-84016.95 1191.76,-84006.95 1188.26,-84016.95 1195.26,-84016.95"/>
</g>
<!-- layer37_qkv_3&#45;&gt;layer37_qkv_ar -->
<g id="edge1199" class="edge">
<title>layer37_qkv_3&#45;&gt;layer37_qkv_ar</title>
<path fill="none" stroke="black" d="M1337.74,-84087.02C1337.74,-84087.02 1337.74,-84016.67 1337.74,-84016.67"/>
<polygon fill="black" stroke="black" points="1341.24,-84016.67 1337.74,-84006.67 1334.24,-84016.67 1341.24,-84016.67"/>
</g>
<!-- layer37_attn_2 -->
<g id="node941" class="node">
<title>layer37_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1246.5,-83847.05 1074.5,-83847.05 1074.5,-83779.05 1246.5,-83779.05 1246.5,-83847.05"/>
<text text-anchor="middle" x="1160.5" y="-83831.85" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1160.5" y="-83816.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1160.5" y="-83801.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1160.5" y="-83786.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer37_qkv_ar&#45;&gt;layer37_attn_2 -->
<g id="edge1200" class="edge">
<title>layer37_qkv_ar&#45;&gt;layer37_attn_2</title>
<path fill="none" stroke="black" d="M1191.51,-83927.45C1191.51,-83927.45 1191.51,-83857.11 1191.51,-83857.11"/>
<polygon fill="black" stroke="black" points="1195.01,-83857.11 1191.51,-83847.11 1188.01,-83857.11 1195.01,-83857.11"/>
</g>
<!-- layer37_attn_3 -->
<g id="node942" class="node">
<title>layer37_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1454.5,-83847.05 1282.5,-83847.05 1282.5,-83779.05 1454.5,-83779.05 1454.5,-83847.05"/>
<text text-anchor="middle" x="1368.5" y="-83831.85" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1368.5" y="-83816.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1368.5" y="-83801.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1368.5" y="-83786.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer37_qkv_ar&#45;&gt;layer37_attn_3 -->
<g id="edge1201" class="edge">
<title>layer37_qkv_ar&#45;&gt;layer37_attn_3</title>
<path fill="none" stroke="black" d="M1337.49,-83927.45C1337.49,-83927.45 1337.49,-83857.11 1337.49,-83857.11"/>
<polygon fill="black" stroke="black" points="1340.99,-83857.11 1337.49,-83847.11 1333.99,-83857.11 1340.99,-83857.11"/>
</g>
<!-- layer37_attn_out_2 -->
<g id="node943" class="node">
<title>layer37_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1246.5,-83707.05 1074.5,-83707.05 1074.5,-83639.05 1246.5,-83639.05 1246.5,-83707.05"/>
<text text-anchor="middle" x="1160.5" y="-83691.85" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1160.5" y="-83676.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1160.5" y="-83661.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1160.5" y="-83646.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer37_attn_2&#45;&gt;layer37_attn_out_2 -->
<g id="edge1202" class="edge">
<title>layer37_attn_2&#45;&gt;layer37_attn_out_2</title>
<path fill="none" stroke="black" d="M1160.5,-83778.8C1160.5,-83778.8 1160.5,-83717.43 1160.5,-83717.43"/>
<polygon fill="black" stroke="black" points="1164,-83717.43 1160.5,-83707.43 1157,-83717.43 1164,-83717.43"/>
</g>
<!-- layer37_attn_out_3 -->
<g id="node944" class="node">
<title>layer37_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1454.5,-83707.05 1282.5,-83707.05 1282.5,-83639.05 1454.5,-83639.05 1454.5,-83707.05"/>
<text text-anchor="middle" x="1368.5" y="-83691.85" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1368.5" y="-83676.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1368.5" y="-83661.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1368.5" y="-83646.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer37_attn_3&#45;&gt;layer37_attn_out_3 -->
<g id="edge1203" class="edge">
<title>layer37_attn_3&#45;&gt;layer37_attn_out_3</title>
<path fill="none" stroke="black" d="M1368.5,-83778.8C1368.5,-83778.8 1368.5,-83717.43 1368.5,-83717.43"/>
<polygon fill="black" stroke="black" points="1372,-83717.43 1368.5,-83707.43 1365,-83717.43 1372,-83717.43"/>
</g>
<!-- layer37_attn_ar -->
<g id="node945" class="node">
<title>layer37_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1264.5" cy="-83518.96" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1264.5" y="-83537.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1264.5" y="-83522.76" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1264.5" y="-83507.76" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1264.5" y="-83492.76" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer37_attn_out_2&#45;&gt;layer37_attn_ar -->
<g id="edge1204" class="edge">
<title>layer37_attn_out_2&#45;&gt;layer37_attn_ar</title>
<path fill="none" stroke="black" d="M1194.69,-83638.85C1194.69,-83638.85 1194.69,-83568.51 1194.69,-83568.51"/>
<polygon fill="black" stroke="black" points="1198.19,-83568.51 1194.69,-83558.51 1191.19,-83568.51 1198.19,-83568.51"/>
</g>
<!-- layer37_attn_out_3&#45;&gt;layer37_attn_ar -->
<g id="edge1205" class="edge">
<title>layer37_attn_out_3&#45;&gt;layer37_attn_ar</title>
<path fill="none" stroke="black" d="M1334.31,-83638.85C1334.31,-83638.85 1334.31,-83568.51 1334.31,-83568.51"/>
<polygon fill="black" stroke="black" points="1337.81,-83568.51 1334.31,-83558.51 1330.81,-83568.51 1337.81,-83568.51"/>
</g>
<!-- layer37_ffn_norm_2 -->
<g id="node946" class="node">
<title>layer37_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1242.5,-83398.88 1070.5,-83398.88 1070.5,-83330.88 1242.5,-83330.88 1242.5,-83398.88"/>
<text text-anchor="middle" x="1156.5" y="-83383.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1156.5" y="-83368.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1156.5" y="-83353.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1156.5" y="-83338.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer37_attn_ar&#45;&gt;layer37_ffn_norm_2 -->
<g id="edge1206" class="edge">
<title>layer37_attn_ar&#45;&gt;layer37_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1192.69,-83480.08C1192.69,-83480.08 1192.69,-83409.03 1192.69,-83409.03"/>
<polygon fill="black" stroke="black" points="1196.19,-83409.03 1192.69,-83399.03 1189.19,-83409.03 1196.19,-83409.03"/>
</g>
<!-- layer37_ffn_norm_3 -->
<g id="node947" class="node">
<title>layer37_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1459.5,-83398.88 1287.5,-83398.88 1287.5,-83330.88 1459.5,-83330.88 1459.5,-83398.88"/>
<text text-anchor="middle" x="1373.5" y="-83383.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1373.5" y="-83368.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1373.5" y="-83353.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1373.5" y="-83338.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer37_attn_ar&#45;&gt;layer37_ffn_norm_3 -->
<g id="edge1207" class="edge">
<title>layer37_attn_ar&#45;&gt;layer37_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1336.81,-83480.08C1336.81,-83480.08 1336.81,-83409.03 1336.81,-83409.03"/>
<polygon fill="black" stroke="black" points="1340.31,-83409.03 1336.81,-83399.03 1333.31,-83409.03 1340.31,-83409.03"/>
</g>
<!-- layer37_ffn_gate_2 -->
<g id="node948" class="node">
<title>layer37_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1247,-83258.88 1066,-83258.88 1066,-83190.88 1247,-83190.88 1247,-83258.88"/>
<text text-anchor="middle" x="1156.5" y="-83243.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1156.5" y="-83228.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1156.5" y="-83213.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1156.5" y="-83198.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_ffn_norm_2&#45;&gt;layer37_ffn_gate_2 -->
<g id="edge1208" class="edge">
<title>layer37_ffn_norm_2&#45;&gt;layer37_ffn_gate_2</title>
<path fill="none" stroke="black" d="M1156.5,-83330.63C1156.5,-83330.63 1156.5,-83269.26 1156.5,-83269.26"/>
<polygon fill="black" stroke="black" points="1160,-83269.26 1156.5,-83259.26 1153,-83269.26 1160,-83269.26"/>
</g>
<!-- layer37_ffn_up_2 -->
<g id="node950" class="node">
<title>layer37_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1030,-83258.88 849,-83258.88 849,-83190.88 1030,-83190.88 1030,-83258.88"/>
<text text-anchor="middle" x="939.5" y="-83243.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="939.5" y="-83228.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="939.5" y="-83213.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="939.5" y="-83198.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_ffn_norm_2&#45;&gt;layer37_ffn_up_2 -->
<g id="edge1210" class="edge">
<title>layer37_ffn_norm_2&#45;&gt;layer37_ffn_up_2</title>
<path fill="none" stroke="black" d="M1070.31,-83364C1030.86,-83364 992.76,-83364 992.76,-83364 992.76,-83364 992.76,-83268.91 992.76,-83268.91"/>
<polygon fill="black" stroke="black" points="996.26,-83268.91 992.76,-83258.91 989.26,-83268.91 996.26,-83268.91"/>
</g>
<!-- layer37_ffn_gate_3 -->
<g id="node949" class="node">
<title>layer37_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1681,-83258.88 1500,-83258.88 1500,-83190.88 1681,-83190.88 1681,-83258.88"/>
<text text-anchor="middle" x="1590.5" y="-83243.68" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1590.5" y="-83228.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1590.5" y="-83213.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1590.5" y="-83198.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_ffn_norm_3&#45;&gt;layer37_ffn_gate_3 -->
<g id="edge1209" class="edge">
<title>layer37_ffn_norm_3&#45;&gt;layer37_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1459.56,-83364C1498.95,-83364 1537,-83364 1537,-83364 1537,-83364 1537,-83268.91 1537,-83268.91"/>
<polygon fill="black" stroke="black" points="1540.5,-83268.91 1537,-83258.91 1533.5,-83268.91 1540.5,-83268.91"/>
</g>
<!-- layer37_ffn_up_3 -->
<g id="node951" class="node">
<title>layer37_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1464,-83258.88 1283,-83258.88 1283,-83190.88 1464,-83190.88 1464,-83258.88"/>
<text text-anchor="middle" x="1373.5" y="-83243.68" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1373.5" y="-83228.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1373.5" y="-83213.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1373.5" y="-83198.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_ffn_norm_3&#45;&gt;layer37_ffn_up_3 -->
<g id="edge1211" class="edge">
<title>layer37_ffn_norm_3&#45;&gt;layer37_ffn_up_3</title>
<path fill="none" stroke="black" d="M1373.5,-83330.63C1373.5,-83330.63 1373.5,-83269.26 1373.5,-83269.26"/>
<polygon fill="black" stroke="black" points="1377,-83269.26 1373.5,-83259.26 1370,-83269.26 1377,-83269.26"/>
</g>
<!-- layer37_gate_ar -->
<g id="node952" class="node">
<title>layer37_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1407.5" cy="-83070.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1407.5" y="-83089.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1407.5" y="-83074.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1407.5" y="-83059.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1407.5" y="-83044.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer37_ffn_gate_2&#45;&gt;layer37_gate_ar -->
<g id="edge1212" class="edge">
<title>layer37_ffn_gate_2&#45;&gt;layer37_gate_ar</title>
<path fill="none" stroke="black" d="M1218.24,-83190.71C1218.24,-83140.84 1218.24,-83054 1218.24,-83054 1218.24,-83054 1277.37,-83054 1277.37,-83054"/>
<polygon fill="black" stroke="black" points="1277.37,-83057.5 1287.37,-83054 1277.37,-83050.5 1277.37,-83057.5"/>
</g>
<!-- layer37_ffn_gate_3&#45;&gt;layer37_gate_ar -->
<g id="edge1213" class="edge">
<title>layer37_ffn_gate_3&#45;&gt;layer37_gate_ar</title>
<path fill="none" stroke="black" d="M1517.74,-83190.69C1517.74,-83190.69 1517.74,-83105.32 1517.74,-83105.32"/>
<polygon fill="black" stroke="black" points="1521.24,-83105.32 1517.74,-83095.32 1514.24,-83105.32 1521.24,-83105.32"/>
</g>
<!-- layer37_up_ar -->
<g id="node953" class="node">
<title>layer37_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1061.5" cy="-83070.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1061.5" y="-83089.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1061.5" y="-83074.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1061.5" y="-83059.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1061.5" y="-83044.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer37_ffn_up_2&#45;&gt;layer37_up_ar -->
<g id="edge1214" class="edge">
<title>layer37_ffn_up_2&#45;&gt;layer37_up_ar</title>
<path fill="none" stroke="black" d="M981.76,-83190.69C981.76,-83190.69 981.76,-83118.41 981.76,-83118.41"/>
<polygon fill="black" stroke="black" points="985.26,-83118.41 981.76,-83108.41 978.26,-83118.41 985.26,-83118.41"/>
</g>
<!-- layer37_ffn_up_3&#45;&gt;layer37_up_ar -->
<g id="edge1215" class="edge">
<title>layer37_ffn_up_3&#45;&gt;layer37_up_ar</title>
<path fill="none" stroke="black" d="M1282.97,-83224C1271.27,-83224 1263.26,-83224 1263.26,-83224 1263.26,-83224 1263.26,-83086 1263.26,-83086 1263.26,-83086 1192.94,-83086 1192.94,-83086"/>
<polygon fill="black" stroke="black" points="1192.94,-83082.5 1182.94,-83086 1192.94,-83089.5 1192.94,-83082.5"/>
</g>
<!-- layer37_silu_2 -->
<g id="node954" class="node">
<title>layer37_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1335,-82950.71 1154,-82950.71 1154,-82882.71 1335,-82882.71 1335,-82950.71"/>
<text text-anchor="middle" x="1244.5" y="-82935.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1244.5" y="-82920.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1244.5" y="-82905.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1244.5" y="-82890.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_gate_ar&#45;&gt;layer37_silu_2 -->
<g id="edge1216" class="edge">
<title>layer37_gate_ar&#45;&gt;layer37_silu_2</title>
<path fill="none" stroke="black" d="M1307.26,-83040.72C1307.26,-83040.72 1307.26,-82960.74 1307.26,-82960.74"/>
<polygon fill="black" stroke="black" points="1310.76,-82960.74 1307.26,-82950.74 1303.76,-82960.74 1310.76,-82960.74"/>
</g>
<!-- layer37_silu_3 -->
<g id="node955" class="node">
<title>layer37_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1552,-82950.71 1371,-82950.71 1371,-82882.71 1552,-82882.71 1552,-82950.71"/>
<text text-anchor="middle" x="1461.5" y="-82935.51" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1461.5" y="-82920.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1461.5" y="-82905.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1461.5" y="-82890.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_gate_ar&#45;&gt;layer37_silu_3 -->
<g id="edge1217" class="edge">
<title>layer37_gate_ar&#45;&gt;layer37_silu_3</title>
<path fill="none" stroke="black" d="M1453.24,-83025.82C1453.24,-83025.82 1453.24,-82960.72 1453.24,-82960.72"/>
<polygon fill="black" stroke="black" points="1456.74,-82960.72 1453.24,-82950.72 1449.74,-82960.72 1456.74,-82960.72"/>
</g>
<!-- layer37_mul_2 -->
<g id="node956" class="node">
<title>layer37_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1194,-82810.71 1013,-82810.71 1013,-82742.71 1194,-82742.71 1194,-82810.71"/>
<text text-anchor="middle" x="1103.5" y="-82795.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1103.5" y="-82780.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1103.5" y="-82765.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1103.5" y="-82750.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_up_ar&#45;&gt;layer37_mul_2 -->
<g id="edge1219" class="edge">
<title>layer37_up_ar&#45;&gt;layer37_mul_2</title>
<path fill="none" stroke="black" d="M1083.5,-83023.22C1083.5,-83023.22 1083.5,-82820.9 1083.5,-82820.9"/>
<polygon fill="black" stroke="black" points="1087,-82820.9 1083.5,-82810.9 1080,-82820.9 1087,-82820.9"/>
</g>
<!-- layer37_mul_3 -->
<g id="node957" class="node">
<title>layer37_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1411,-82810.71 1230,-82810.71 1230,-82742.71 1411,-82742.71 1411,-82810.71"/>
<text text-anchor="middle" x="1320.5" y="-82795.51" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1320.5" y="-82780.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1320.5" y="-82765.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1320.5" y="-82750.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer37_up_ar&#45;&gt;layer37_mul_3 -->
<g id="edge1221" class="edge">
<title>layer37_up_ar&#45;&gt;layer37_mul_3</title>
<path fill="none" stroke="black" d="M1171.74,-83046.27C1171.74,-83021.23 1171.74,-82986 1171.74,-82986 1171.74,-82986 1353,-82986 1353,-82986 1353,-82986 1353,-82820.81 1353,-82820.81"/>
<polygon fill="black" stroke="black" points="1356.5,-82820.81 1353,-82810.81 1349.5,-82820.81 1356.5,-82820.81"/>
</g>
<!-- layer37_silu_2&#45;&gt;layer37_mul_2 -->
<g id="edge1218" class="edge">
<title>layer37_silu_2&#45;&gt;layer37_mul_2</title>
<path fill="none" stroke="black" d="M1174,-82882.47C1174,-82882.47 1174,-82821.09 1174,-82821.09"/>
<polygon fill="black" stroke="black" points="1177.5,-82821.09 1174,-82811.09 1170.5,-82821.09 1177.5,-82821.09"/>
</g>
<!-- layer37_silu_3&#45;&gt;layer37_mul_3 -->
<g id="edge1220" class="edge">
<title>layer37_silu_3&#45;&gt;layer37_mul_3</title>
<path fill="none" stroke="black" d="M1391,-82882.47C1391,-82882.47 1391,-82821.09 1391,-82821.09"/>
<polygon fill="black" stroke="black" points="1394.5,-82821.09 1391,-82811.09 1387.5,-82821.09 1394.5,-82821.09"/>
</g>
<!-- layer37_ffn_down_2 -->
<g id="node958" class="node">
<title>layer37_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1193.5,-82670.71 1021.5,-82670.71 1021.5,-82602.71 1193.5,-82602.71 1193.5,-82670.71"/>
<text text-anchor="middle" x="1107.5" y="-82655.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1107.5" y="-82640.51" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1107.5" y="-82625.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1107.5" y="-82610.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer37_mul_2&#45;&gt;layer37_ffn_down_2 -->
<g id="edge1222" class="edge">
<title>layer37_mul_2&#45;&gt;layer37_ffn_down_2</title>
<path fill="none" stroke="black" d="M1107.5,-82742.47C1107.5,-82742.47 1107.5,-82681.09 1107.5,-82681.09"/>
<polygon fill="black" stroke="black" points="1111,-82681.09 1107.5,-82671.09 1104,-82681.09 1111,-82681.09"/>
</g>
<!-- layer37_ffn_down_3 -->
<g id="node959" class="node">
<title>layer37_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1403.5,-82670.71 1231.5,-82670.71 1231.5,-82602.71 1403.5,-82602.71 1403.5,-82670.71"/>
<text text-anchor="middle" x="1317.5" y="-82655.51" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1317.5" y="-82640.51" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1317.5" y="-82625.51" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1317.5" y="-82610.51" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer37_mul_3&#45;&gt;layer37_ffn_down_3 -->
<g id="edge1223" class="edge">
<title>layer37_mul_3&#45;&gt;layer37_ffn_down_3</title>
<path fill="none" stroke="black" d="M1317.5,-82742.47C1317.5,-82742.47 1317.5,-82681.09 1317.5,-82681.09"/>
<polygon fill="black" stroke="black" points="1321,-82681.09 1317.5,-82671.09 1314,-82681.09 1321,-82681.09"/>
</g>
<!-- layer37_ffn_ar -->
<g id="node960" class="node">
<title>layer37_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1145.5" cy="-82482.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1145.5" y="-82501.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1145.5" y="-82486.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1145.5" y="-82471.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1145.5" y="-82456.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer37_ffn_down_2&#45;&gt;layer37_ffn_ar -->
<g id="edge1224" class="edge">
<title>layer37_ffn_down_2&#45;&gt;layer37_ffn_ar</title>
<path fill="none" stroke="black" d="M1108.69,-82602.52C1108.69,-82602.52 1108.69,-82538.72 1108.69,-82538.72"/>
<polygon fill="black" stroke="black" points="1112.19,-82538.71 1108.69,-82528.72 1105.19,-82538.72 1112.19,-82538.71"/>
</g>
<!-- layer37_ffn_down_3&#45;&gt;layer37_ffn_ar -->
<g id="edge1225" class="edge">
<title>layer37_ffn_down_3&#45;&gt;layer37_ffn_ar</title>
<path fill="none" stroke="black" d="M1249.31,-82602.52C1249.31,-82602.52 1249.31,-82518.11 1249.31,-82518.11"/>
<polygon fill="black" stroke="black" points="1252.81,-82518.11 1249.31,-82508.11 1245.81,-82518.11 1252.81,-82518.11"/>
</g>
<!-- layer38_norm_2 -->
<g id="node961" class="node">
<title>layer38_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1127.5,-82362.55 955.5,-82362.55 955.5,-82294.55 1127.5,-82294.55 1127.5,-82362.55"/>
<text text-anchor="middle" x="1041.5" y="-82347.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1041.5" y="-82332.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1041.5" y="-82317.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1041.5" y="-82302.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer37_ffn_ar&#45;&gt;layer38_norm_2 -->
<g id="edge1226" class="edge">
<title>layer37_ffn_ar&#45;&gt;layer38_norm_2</title>
<path fill="none" stroke="black" d="M1075.69,-82442.95C1075.69,-82442.95 1075.69,-82372.61 1075.69,-82372.61"/>
<polygon fill="black" stroke="black" points="1079.19,-82372.61 1075.69,-82362.61 1072.19,-82372.61 1079.19,-82372.61"/>
</g>
<!-- layer38_norm_3 -->
<g id="node962" class="node">
<title>layer38_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1337.5,-82362.55 1165.5,-82362.55 1165.5,-82294.55 1337.5,-82294.55 1337.5,-82362.55"/>
<text text-anchor="middle" x="1251.5" y="-82347.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1251.5" y="-82332.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1251.5" y="-82317.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1251.5" y="-82302.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer37_ffn_ar&#45;&gt;layer38_norm_3 -->
<g id="edge1227" class="edge">
<title>layer37_ffn_ar&#45;&gt;layer38_norm_3</title>
<path fill="none" stroke="black" d="M1216.31,-82443.35C1216.31,-82443.35 1216.31,-82372.78 1216.31,-82372.78"/>
<polygon fill="black" stroke="black" points="1219.81,-82372.78 1216.31,-82362.78 1212.81,-82372.78 1219.81,-82372.78"/>
</g>
<!-- layer38_qkv_2 -->
<g id="node963" class="node">
<title>layer38_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1128,-82222.55 947,-82222.55 947,-82154.55 1128,-82154.55 1128,-82222.55"/>
<text text-anchor="middle" x="1037.5" y="-82207.35" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1037.5" y="-82192.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1037.5" y="-82177.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1037.5" y="-82162.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer38_norm_2&#45;&gt;layer38_qkv_2 -->
<g id="edge1228" class="edge">
<title>layer38_norm_2&#45;&gt;layer38_qkv_2</title>
<path fill="none" stroke="black" d="M1041.5,-82294.3C1041.5,-82294.3 1041.5,-82232.93 1041.5,-82232.93"/>
<polygon fill="black" stroke="black" points="1045,-82232.93 1041.5,-82222.93 1038,-82232.93 1045,-82232.93"/>
</g>
<!-- layer38_qkv_3 -->
<g id="node964" class="node">
<title>layer38_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1345,-82222.55 1164,-82222.55 1164,-82154.55 1345,-82154.55 1345,-82222.55"/>
<text text-anchor="middle" x="1254.5" y="-82207.35" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1254.5" y="-82192.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1254.5" y="-82177.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1254.5" y="-82162.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer38_norm_3&#45;&gt;layer38_qkv_3 -->
<g id="edge1229" class="edge">
<title>layer38_norm_3&#45;&gt;layer38_qkv_3</title>
<path fill="none" stroke="black" d="M1251.5,-82294.3C1251.5,-82294.3 1251.5,-82232.93 1251.5,-82232.93"/>
<polygon fill="black" stroke="black" points="1255,-82232.93 1251.5,-82222.93 1248,-82232.93 1255,-82232.93"/>
</g>
<!-- layer38_qkv_ar -->
<g id="node965" class="node">
<title>layer38_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1110.5" cy="-82034.47" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1110.5" y="-82053.27" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1110.5" y="-82038.27" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1110.5" y="-82023.27" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1110.5" y="-82008.27" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer38_qkv_2&#45;&gt;layer38_qkv_ar -->
<g id="edge1230" class="edge">
<title>layer38_qkv_2&#45;&gt;layer38_qkv_ar</title>
<path fill="none" stroke="black" d="M1055.26,-82154.35C1055.26,-82154.35 1055.26,-82087.96 1055.26,-82087.96"/>
<polygon fill="black" stroke="black" points="1058.76,-82087.96 1055.26,-82077.96 1051.76,-82087.96 1058.76,-82087.96"/>
</g>
<!-- layer38_qkv_3&#45;&gt;layer38_qkv_ar -->
<g id="edge1231" class="edge">
<title>layer38_qkv_3&#45;&gt;layer38_qkv_ar</title>
<path fill="none" stroke="black" d="M1201.24,-82154.35C1201.24,-82154.35 1201.24,-82078.57 1201.24,-82078.57"/>
<polygon fill="black" stroke="black" points="1204.74,-82078.57 1201.24,-82068.57 1197.74,-82078.57 1204.74,-82078.57"/>
</g>
<!-- layer38_attn_2 -->
<g id="node966" class="node">
<title>layer38_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1092.5,-81914.38 920.5,-81914.38 920.5,-81846.38 1092.5,-81846.38 1092.5,-81914.38"/>
<text text-anchor="middle" x="1006.5" y="-81899.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1006.5" y="-81884.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1006.5" y="-81869.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1006.5" y="-81854.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer38_qkv_ar&#45;&gt;layer38_attn_2 -->
<g id="edge1232" class="edge">
<title>layer38_qkv_ar&#45;&gt;layer38_attn_2</title>
<path fill="none" stroke="black" d="M1037.51,-81994.78C1037.51,-81994.78 1037.51,-81924.44 1037.51,-81924.44"/>
<polygon fill="black" stroke="black" points="1041.01,-81924.44 1037.51,-81914.44 1034.01,-81924.44 1041.01,-81924.44"/>
</g>
<!-- layer38_attn_3 -->
<g id="node967" class="node">
<title>layer38_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1300.5,-81914.38 1128.5,-81914.38 1128.5,-81846.38 1300.5,-81846.38 1300.5,-81914.38"/>
<text text-anchor="middle" x="1214.5" y="-81899.18" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1214.5" y="-81884.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1214.5" y="-81869.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1214.5" y="-81854.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer38_qkv_ar&#45;&gt;layer38_attn_3 -->
<g id="edge1233" class="edge">
<title>layer38_qkv_ar&#45;&gt;layer38_attn_3</title>
<path fill="none" stroke="black" d="M1183.49,-81994.78C1183.49,-81994.78 1183.49,-81924.44 1183.49,-81924.44"/>
<polygon fill="black" stroke="black" points="1186.99,-81924.44 1183.49,-81914.44 1179.99,-81924.44 1186.99,-81924.44"/>
</g>
<!-- layer38_attn_out_2 -->
<g id="node968" class="node">
<title>layer38_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1092.5,-81774.38 920.5,-81774.38 920.5,-81706.38 1092.5,-81706.38 1092.5,-81774.38"/>
<text text-anchor="middle" x="1006.5" y="-81759.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1006.5" y="-81744.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1006.5" y="-81729.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1006.5" y="-81714.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer38_attn_2&#45;&gt;layer38_attn_out_2 -->
<g id="edge1234" class="edge">
<title>layer38_attn_2&#45;&gt;layer38_attn_out_2</title>
<path fill="none" stroke="black" d="M1006.5,-81846.13C1006.5,-81846.13 1006.5,-81784.76 1006.5,-81784.76"/>
<polygon fill="black" stroke="black" points="1010,-81784.76 1006.5,-81774.76 1003,-81784.76 1010,-81784.76"/>
</g>
<!-- layer38_attn_out_3 -->
<g id="node969" class="node">
<title>layer38_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1300.5,-81774.38 1128.5,-81774.38 1128.5,-81706.38 1300.5,-81706.38 1300.5,-81774.38"/>
<text text-anchor="middle" x="1214.5" y="-81759.18" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1214.5" y="-81744.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1214.5" y="-81729.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1214.5" y="-81714.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer38_attn_3&#45;&gt;layer38_attn_out_3 -->
<g id="edge1235" class="edge">
<title>layer38_attn_3&#45;&gt;layer38_attn_out_3</title>
<path fill="none" stroke="black" d="M1214.5,-81846.13C1214.5,-81846.13 1214.5,-81784.76 1214.5,-81784.76"/>
<polygon fill="black" stroke="black" points="1218,-81784.76 1214.5,-81774.76 1211,-81784.76 1218,-81784.76"/>
</g>
<!-- layer38_attn_ar -->
<g id="node970" class="node">
<title>layer38_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1094.5" cy="-81586.3" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1094.5" y="-81605.1" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1094.5" y="-81590.1" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1094.5" y="-81575.1" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1094.5" y="-81560.1" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer38_attn_out_2&#45;&gt;layer38_attn_ar -->
<g id="edge1236" class="edge">
<title>layer38_attn_out_2&#45;&gt;layer38_attn_ar</title>
<path fill="none" stroke="black" d="M1032.69,-81706.19C1032.69,-81706.19 1032.69,-81637.8 1032.69,-81637.8"/>
<polygon fill="black" stroke="black" points="1036.19,-81637.8 1032.69,-81627.8 1029.19,-81637.8 1036.19,-81637.8"/>
</g>
<!-- layer38_attn_out_3&#45;&gt;layer38_attn_ar -->
<g id="edge1237" class="edge">
<title>layer38_attn_out_3&#45;&gt;layer38_attn_ar</title>
<path fill="none" stroke="black" d="M1172.31,-81706.19C1172.31,-81706.19 1172.31,-81633.36 1172.31,-81633.36"/>
<polygon fill="black" stroke="black" points="1175.81,-81633.36 1172.31,-81623.36 1168.81,-81633.36 1175.81,-81633.36"/>
</g>
<!-- layer38_ffn_norm_2 -->
<g id="node971" class="node">
<title>layer38_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1072.5,-81466.22 900.5,-81466.22 900.5,-81398.22 1072.5,-81398.22 1072.5,-81466.22"/>
<text text-anchor="middle" x="986.5" y="-81451.02" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="986.5" y="-81436.02" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="986.5" y="-81421.02" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="986.5" y="-81406.02" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer38_attn_ar&#45;&gt;layer38_ffn_norm_2 -->
<g id="edge1238" class="edge">
<title>layer38_attn_ar&#45;&gt;layer38_ffn_norm_2</title>
<path fill="none" stroke="black" d="M1022.69,-81547.42C1022.69,-81547.42 1022.69,-81476.36 1022.69,-81476.36"/>
<polygon fill="black" stroke="black" points="1026.19,-81476.36 1022.69,-81466.36 1019.19,-81476.36 1026.19,-81476.36"/>
</g>
<!-- layer38_ffn_norm_3 -->
<g id="node972" class="node">
<title>layer38_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1289.5,-81466.22 1117.5,-81466.22 1117.5,-81398.22 1289.5,-81398.22 1289.5,-81466.22"/>
<text text-anchor="middle" x="1203.5" y="-81451.02" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1203.5" y="-81436.02" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1203.5" y="-81421.02" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1203.5" y="-81406.02" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer38_attn_ar&#45;&gt;layer38_ffn_norm_3 -->
<g id="edge1239" class="edge">
<title>layer38_attn_ar&#45;&gt;layer38_ffn_norm_3</title>
<path fill="none" stroke="black" d="M1166.81,-81547.42C1166.81,-81547.42 1166.81,-81476.36 1166.81,-81476.36"/>
<polygon fill="black" stroke="black" points="1170.31,-81476.36 1166.81,-81466.36 1163.31,-81476.36 1170.31,-81476.36"/>
</g>
<!-- layer38_ffn_gate_2 -->
<g id="node973" class="node">
<title>layer38_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1077,-81326.22 896,-81326.22 896,-81258.22 1077,-81258.22 1077,-81326.22"/>
<text text-anchor="middle" x="986.5" y="-81311.02" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="986.5" y="-81296.02" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="986.5" y="-81281.02" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="986.5" y="-81266.02" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_ffn_norm_2&#45;&gt;layer38_ffn_gate_2 -->
<g id="edge1240" class="edge">
<title>layer38_ffn_norm_2&#45;&gt;layer38_ffn_gate_2</title>
<path fill="none" stroke="black" d="M986.5,-81397.97C986.5,-81397.97 986.5,-81336.59 986.5,-81336.59"/>
<polygon fill="black" stroke="black" points="990,-81336.59 986.5,-81326.59 983,-81336.59 990,-81336.59"/>
</g>
<!-- layer38_ffn_up_2 -->
<g id="node975" class="node">
<title>layer38_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="860,-81326.22 679,-81326.22 679,-81258.22 860,-81258.22 860,-81326.22"/>
<text text-anchor="middle" x="769.5" y="-81311.02" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="769.5" y="-81296.02" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="769.5" y="-81281.02" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="769.5" y="-81266.02" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_ffn_norm_2&#45;&gt;layer38_ffn_up_2 -->
<g id="edge1242" class="edge">
<title>layer38_ffn_norm_2&#45;&gt;layer38_ffn_up_2</title>
<path fill="none" stroke="black" d="M900.3,-81432C875.25,-81432 854.5,-81432 854.5,-81432 854.5,-81432 854.5,-81336.41 854.5,-81336.41"/>
<polygon fill="black" stroke="black" points="858,-81336.41 854.5,-81326.41 851,-81336.41 858,-81336.41"/>
</g>
<!-- layer38_ffn_gate_3 -->
<g id="node974" class="node">
<title>layer38_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1511,-81326.22 1330,-81326.22 1330,-81258.22 1511,-81258.22 1511,-81326.22"/>
<text text-anchor="middle" x="1420.5" y="-81311.02" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1420.5" y="-81296.02" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1420.5" y="-81281.02" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1420.5" y="-81266.02" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_ffn_norm_3&#45;&gt;layer38_ffn_gate_3 -->
<g id="edge1241" class="edge">
<title>layer38_ffn_norm_3&#45;&gt;layer38_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1289.5,-81432C1315.6,-81432 1337.5,-81432 1337.5,-81432 1337.5,-81432 1337.5,-81336.41 1337.5,-81336.41"/>
<polygon fill="black" stroke="black" points="1341,-81336.41 1337.5,-81326.41 1334,-81336.41 1341,-81336.41"/>
</g>
<!-- layer38_ffn_up_3 -->
<g id="node976" class="node">
<title>layer38_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1294,-81326.22 1113,-81326.22 1113,-81258.22 1294,-81258.22 1294,-81326.22"/>
<text text-anchor="middle" x="1203.5" y="-81311.02" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1203.5" y="-81296.02" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1203.5" y="-81281.02" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1203.5" y="-81266.02" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_ffn_norm_3&#45;&gt;layer38_ffn_up_3 -->
<g id="edge1243" class="edge">
<title>layer38_ffn_norm_3&#45;&gt;layer38_ffn_up_3</title>
<path fill="none" stroke="black" d="M1203.5,-81397.97C1203.5,-81397.97 1203.5,-81336.59 1203.5,-81336.59"/>
<polygon fill="black" stroke="black" points="1207,-81336.59 1203.5,-81326.59 1200,-81336.59 1207,-81336.59"/>
</g>
<!-- layer38_gate_ar -->
<g id="node977" class="node">
<title>layer38_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1213.5" cy="-81138.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1213.5" y="-81156.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1213.5" y="-81141.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="1213.5" y="-81126.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1213.5" y="-81111.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer38_ffn_gate_2&#45;&gt;layer38_gate_ar -->
<g id="edge1244" class="edge">
<title>layer38_ffn_gate_2&#45;&gt;layer38_gate_ar</title>
<path fill="none" stroke="black" d="M1077.25,-81280C1090.21,-81280 1099.26,-81280 1099.26,-81280 1099.26,-81280 1099.26,-81169.99 1099.26,-81169.99"/>
<polygon fill="black" stroke="black" points="1102.76,-81169.99 1099.26,-81159.99 1095.76,-81169.99 1102.76,-81169.99"/>
</g>
<!-- layer38_ffn_gate_3&#45;&gt;layer38_gate_ar -->
<g id="edge1245" class="edge">
<title>layer38_ffn_gate_3&#45;&gt;layer38_gate_ar</title>
<path fill="none" stroke="black" d="M1335.74,-81258.02C1335.74,-81258.02 1335.74,-81162.72 1335.74,-81162.72"/>
<polygon fill="black" stroke="black" points="1339.24,-81162.72 1335.74,-81152.72 1332.24,-81162.72 1339.24,-81162.72"/>
</g>
<!-- layer38_up_ar -->
<g id="node978" class="node">
<title>layer38_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="867.5" cy="-81138.13" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="867.5" y="-81156.93" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="867.5" y="-81141.93" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="867.5" y="-81126.93" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="867.5" y="-81111.93" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer38_ffn_up_2&#45;&gt;layer38_up_ar -->
<g id="edge1246" class="edge">
<title>layer38_ffn_up_2&#45;&gt;layer38_up_ar</title>
<path fill="none" stroke="black" d="M799.76,-81258.02C799.76,-81258.02 799.76,-81189.07 799.76,-81189.07"/>
<polygon fill="black" stroke="black" points="803.26,-81189.07 799.76,-81179.07 796.26,-81189.07 803.26,-81189.07"/>
</g>
<!-- layer38_ffn_up_3&#45;&gt;layer38_up_ar -->
<g id="edge1247" class="edge">
<title>layer38_ffn_up_3&#45;&gt;layer38_up_ar</title>
<path fill="none" stroke="black" d="M1112.74,-81303C1094.73,-81303 1081.26,-81303 1081.26,-81303 1081.26,-81303 1081.26,-81138 1081.26,-81138 1081.26,-81138 1005.55,-81138 1005.55,-81138"/>
<polygon fill="black" stroke="black" points="1005.55,-81134.5 995.55,-81138 1005.55,-81141.5 1005.55,-81134.5"/>
</g>
<!-- layer38_silu_2 -->
<g id="node979" class="node">
<title>layer38_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1141,-81018.05 960,-81018.05 960,-80950.05 1141,-80950.05 1141,-81018.05"/>
<text text-anchor="middle" x="1050.5" y="-81002.85" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1050.5" y="-80987.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="1050.5" y="-80972.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1050.5" y="-80957.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_gate_ar&#45;&gt;layer38_silu_2 -->
<g id="edge1248" class="edge">
<title>layer38_gate_ar&#45;&gt;layer38_silu_2</title>
<path fill="none" stroke="black" d="M1113.26,-81108.06C1113.26,-81108.06 1113.26,-81028.07 1113.26,-81028.07"/>
<polygon fill="black" stroke="black" points="1116.76,-81028.07 1113.26,-81018.07 1109.76,-81028.07 1116.76,-81028.07"/>
</g>
<!-- layer38_silu_3 -->
<g id="node980" class="node">
<title>layer38_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1358,-81018.05 1177,-81018.05 1177,-80950.05 1358,-80950.05 1358,-81018.05"/>
<text text-anchor="middle" x="1267.5" y="-81002.85" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1267.5" y="-80987.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1267.5" y="-80972.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1267.5" y="-80957.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_gate_ar&#45;&gt;layer38_silu_3 -->
<g id="edge1249" class="edge">
<title>layer38_gate_ar&#45;&gt;layer38_silu_3</title>
<path fill="none" stroke="black" d="M1259.24,-81093.15C1259.24,-81093.15 1259.24,-81028.06 1259.24,-81028.06"/>
<polygon fill="black" stroke="black" points="1262.74,-81028.06 1259.24,-81018.06 1255.74,-81028.06 1262.74,-81028.06"/>
</g>
<!-- layer38_mul_2 -->
<g id="node981" class="node">
<title>layer38_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="989,-80878.05 808,-80878.05 808,-80810.05 989,-80810.05 989,-80878.05"/>
<text text-anchor="middle" x="898.5" y="-80862.85" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="898.5" y="-80847.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="898.5" y="-80832.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="898.5" y="-80817.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_up_ar&#45;&gt;layer38_mul_2 -->
<g id="edge1251" class="edge">
<title>layer38_up_ar&#45;&gt;layer38_mul_2</title>
<path fill="none" stroke="black" d="M884,-81090.23C884,-81090.23 884,-80888.15 884,-80888.15"/>
<polygon fill="black" stroke="black" points="887.5,-80888.15 884,-80878.15 880.5,-80888.15 887.5,-80888.15"/>
</g>
<!-- layer38_mul_3 -->
<g id="node982" class="node">
<title>layer38_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1206,-80878.05 1025,-80878.05 1025,-80810.05 1206,-80810.05 1206,-80878.05"/>
<text text-anchor="middle" x="1115.5" y="-80862.85" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1115.5" y="-80847.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1115.5" y="-80832.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1115.5" y="-80817.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer38_up_ar&#45;&gt;layer38_mul_3 -->
<g id="edge1253" class="edge">
<title>layer38_up_ar&#45;&gt;layer38_mul_3</title>
<path fill="none" stroke="black" d="M977.74,-81113.34C977.74,-81088.53 977.74,-81054 977.74,-81054 977.74,-81054 1159,-81054 1159,-81054 1159,-81054 1159,-80888.25 1159,-80888.25"/>
<polygon fill="black" stroke="black" points="1162.5,-80888.25 1159,-80878.25 1155.5,-80888.25 1162.5,-80888.25"/>
</g>
<!-- layer38_silu_2&#45;&gt;layer38_mul_2 -->
<g id="edge1250" class="edge">
<title>layer38_silu_2&#45;&gt;layer38_mul_2</title>
<path fill="none" stroke="black" d="M974.5,-80949.8C974.5,-80949.8 974.5,-80888.43 974.5,-80888.43"/>
<polygon fill="black" stroke="black" points="978,-80888.43 974.5,-80878.43 971,-80888.43 978,-80888.43"/>
</g>
<!-- layer38_silu_3&#45;&gt;layer38_mul_3 -->
<g id="edge1252" class="edge">
<title>layer38_silu_3&#45;&gt;layer38_mul_3</title>
<path fill="none" stroke="black" d="M1191.5,-80949.8C1191.5,-80949.8 1191.5,-80888.43 1191.5,-80888.43"/>
<polygon fill="black" stroke="black" points="1195,-80888.43 1191.5,-80878.43 1188,-80888.43 1195,-80888.43"/>
</g>
<!-- layer38_ffn_down_2 -->
<g id="node983" class="node">
<title>layer38_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="988.5,-80738.05 816.5,-80738.05 816.5,-80670.05 988.5,-80670.05 988.5,-80738.05"/>
<text text-anchor="middle" x="902.5" y="-80722.85" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="902.5" y="-80707.85" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="902.5" y="-80692.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="902.5" y="-80677.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer38_mul_2&#45;&gt;layer38_ffn_down_2 -->
<g id="edge1254" class="edge">
<title>layer38_mul_2&#45;&gt;layer38_ffn_down_2</title>
<path fill="none" stroke="black" d="M902.5,-80809.8C902.5,-80809.8 902.5,-80748.43 902.5,-80748.43"/>
<polygon fill="black" stroke="black" points="906,-80748.43 902.5,-80738.43 899,-80748.43 906,-80748.43"/>
</g>
<!-- layer38_ffn_down_3 -->
<g id="node984" class="node">
<title>layer38_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1198.5,-80738.05 1026.5,-80738.05 1026.5,-80670.05 1198.5,-80670.05 1198.5,-80738.05"/>
<text text-anchor="middle" x="1112.5" y="-80722.85" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1112.5" y="-80707.85" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1112.5" y="-80692.85" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1112.5" y="-80677.85" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer38_mul_3&#45;&gt;layer38_ffn_down_3 -->
<g id="edge1255" class="edge">
<title>layer38_mul_3&#45;&gt;layer38_ffn_down_3</title>
<path fill="none" stroke="black" d="M1112.5,-80809.8C1112.5,-80809.8 1112.5,-80748.43 1112.5,-80748.43"/>
<polygon fill="black" stroke="black" points="1116,-80748.43 1112.5,-80738.43 1109,-80748.43 1116,-80748.43"/>
</g>
<!-- layer38_ffn_ar -->
<g id="node985" class="node">
<title>layer38_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="934.5" cy="-80549.97" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="934.5" y="-80568.77" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="934.5" y="-80553.77" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="934.5" y="-80538.77" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="934.5" y="-80523.77" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer38_ffn_down_2&#45;&gt;layer38_ffn_ar -->
<g id="edge1256" class="edge">
<title>layer38_ffn_down_2&#45;&gt;layer38_ffn_ar</title>
<path fill="none" stroke="black" d="M902.5,-80669.85C902.5,-80669.85 902.5,-80606.63 902.5,-80606.63"/>
<polygon fill="black" stroke="black" points="906,-80606.63 902.5,-80596.63 899,-80606.63 906,-80606.63"/>
</g>
<!-- layer38_ffn_down_3&#45;&gt;layer38_ffn_ar -->
<g id="edge1257" class="edge">
<title>layer38_ffn_down_3&#45;&gt;layer38_ffn_ar</title>
<path fill="none" stroke="black" d="M1041.31,-80669.85C1041.31,-80669.85 1041.31,-80583.09 1041.31,-80583.09"/>
<polygon fill="black" stroke="black" points="1044.81,-80583.09 1041.31,-80573.09 1037.81,-80583.09 1044.81,-80583.09"/>
</g>
<!-- layer39_norm_2 -->
<g id="node986" class="node">
<title>layer39_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="916.5,-80429.88 744.5,-80429.88 744.5,-80361.88 916.5,-80361.88 916.5,-80429.88"/>
<text text-anchor="middle" x="830.5" y="-80414.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="830.5" y="-80399.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="830.5" y="-80384.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="830.5" y="-80369.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer38_ffn_ar&#45;&gt;layer39_norm_2 -->
<g id="edge1258" class="edge">
<title>layer38_ffn_ar&#45;&gt;layer39_norm_2</title>
<path fill="none" stroke="black" d="M864.69,-80510.29C864.69,-80510.29 864.69,-80439.94 864.69,-80439.94"/>
<polygon fill="black" stroke="black" points="868.19,-80439.94 864.69,-80429.94 861.19,-80439.94 868.19,-80439.94"/>
</g>
<!-- layer39_norm_3 -->
<g id="node987" class="node">
<title>layer39_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1126.5,-80429.88 954.5,-80429.88 954.5,-80361.88 1126.5,-80361.88 1126.5,-80429.88"/>
<text text-anchor="middle" x="1040.5" y="-80414.68" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1040.5" y="-80399.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1040.5" y="-80384.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1040.5" y="-80369.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer38_ffn_ar&#45;&gt;layer39_norm_3 -->
<g id="edge1259" class="edge">
<title>layer38_ffn_ar&#45;&gt;layer39_norm_3</title>
<path fill="none" stroke="black" d="M1005.31,-80510.69C1005.31,-80510.69 1005.31,-80440.11 1005.31,-80440.11"/>
<polygon fill="black" stroke="black" points="1008.81,-80440.11 1005.31,-80430.11 1001.81,-80440.11 1008.81,-80440.11"/>
</g>
<!-- layer39_qkv_2 -->
<g id="node988" class="node">
<title>layer39_qkv_2</title>
<polygon fill="#e6ffe6" stroke="black" points="917,-80289.88 736,-80289.88 736,-80221.88 917,-80221.88 917,-80289.88"/>
<text text-anchor="middle" x="826.5" y="-80274.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="826.5" y="-80259.68" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="826.5" y="-80244.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="826.5" y="-80229.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer39_norm_2&#45;&gt;layer39_qkv_2 -->
<g id="edge1260" class="edge">
<title>layer39_norm_2&#45;&gt;layer39_qkv_2</title>
<path fill="none" stroke="black" d="M830.5,-80361.63C830.5,-80361.63 830.5,-80300.26 830.5,-80300.26"/>
<polygon fill="black" stroke="black" points="834,-80300.26 830.5,-80290.26 827,-80300.26 834,-80300.26"/>
</g>
<!-- layer39_qkv_3 -->
<g id="node989" class="node">
<title>layer39_qkv_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1134,-80289.88 953,-80289.88 953,-80221.88 1134,-80221.88 1134,-80289.88"/>
<text text-anchor="middle" x="1043.5" y="-80274.68" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1043.5" y="-80259.68" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1043.5" y="-80244.68" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1043.5" y="-80229.68" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer39_norm_3&#45;&gt;layer39_qkv_3 -->
<g id="edge1261" class="edge">
<title>layer39_norm_3&#45;&gt;layer39_qkv_3</title>
<path fill="none" stroke="black" d="M1040.5,-80361.63C1040.5,-80361.63 1040.5,-80300.26 1040.5,-80300.26"/>
<polygon fill="black" stroke="black" points="1044,-80300.26 1040.5,-80290.26 1037,-80300.26 1044,-80300.26"/>
</g>
<!-- layer39_qkv_ar -->
<g id="node990" class="node">
<title>layer39_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="896.5" cy="-80101.8" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="896.5" y="-80120.6" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="896.5" y="-80105.6" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="896.5" y="-80090.6" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="896.5" y="-80075.6" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer39_qkv_2&#45;&gt;layer39_qkv_ar -->
<g id="edge1262" class="edge">
<title>layer39_qkv_2&#45;&gt;layer39_qkv_ar</title>
<path fill="none" stroke="black" d="M842.76,-80221.69C842.76,-80221.69 842.76,-80155.58 842.76,-80155.58"/>
<polygon fill="black" stroke="black" points="846.26,-80155.58 842.76,-80145.58 839.26,-80155.58 846.26,-80155.58"/>
</g>
<!-- layer39_qkv_3&#45;&gt;layer39_qkv_ar -->
<g id="edge1263" class="edge">
<title>layer39_qkv_3&#45;&gt;layer39_qkv_ar</title>
<path fill="none" stroke="black" d="M988.74,-80221.69C988.74,-80221.69 988.74,-80145.37 988.74,-80145.37"/>
<polygon fill="black" stroke="black" points="992.24,-80145.37 988.74,-80135.37 985.24,-80145.37 992.24,-80145.37"/>
</g>
<!-- layer39_attn_2 -->
<g id="node991" class="node">
<title>layer39_attn_2</title>
<polygon fill="#e6ffe6" stroke="black" points="878.5,-79981.72 706.5,-79981.72 706.5,-79913.72 878.5,-79913.72 878.5,-79981.72"/>
<text text-anchor="middle" x="792.5" y="-79966.52" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="792.5" y="-79951.52" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="792.5" y="-79936.52" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="792.5" y="-79921.52" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer39_qkv_ar&#45;&gt;layer39_attn_2 -->
<g id="edge1264" class="edge">
<title>layer39_qkv_ar&#45;&gt;layer39_attn_2</title>
<path fill="none" stroke="black" d="M823.51,-80062.12C823.51,-80062.12 823.51,-79991.77 823.51,-79991.77"/>
<polygon fill="black" stroke="black" points="827.01,-79991.77 823.51,-79981.77 820.01,-79991.77 827.01,-79991.77"/>
</g>
<!-- layer39_attn_3 -->
<g id="node992" class="node">
<title>layer39_attn_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1086.5,-79981.72 914.5,-79981.72 914.5,-79913.72 1086.5,-79913.72 1086.5,-79981.72"/>
<text text-anchor="middle" x="1000.5" y="-79966.52" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1000.5" y="-79951.52" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1000.5" y="-79936.52" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1000.5" y="-79921.52" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer39_qkv_ar&#45;&gt;layer39_attn_3 -->
<g id="edge1265" class="edge">
<title>layer39_qkv_ar&#45;&gt;layer39_attn_3</title>
<path fill="none" stroke="black" d="M969.49,-80062.12C969.49,-80062.12 969.49,-79991.77 969.49,-79991.77"/>
<polygon fill="black" stroke="black" points="972.99,-79991.77 969.49,-79981.77 965.99,-79991.77 972.99,-79991.77"/>
</g>
<!-- layer39_attn_out_2 -->
<g id="node993" class="node">
<title>layer39_attn_out_2</title>
<polygon fill="#e6ffe6" stroke="black" points="878.5,-79841.72 706.5,-79841.72 706.5,-79773.72 878.5,-79773.72 878.5,-79841.72"/>
<text text-anchor="middle" x="792.5" y="-79826.52" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="792.5" y="-79811.52" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="792.5" y="-79796.52" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="792.5" y="-79781.52" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer39_attn_2&#45;&gt;layer39_attn_out_2 -->
<g id="edge1266" class="edge">
<title>layer39_attn_2&#45;&gt;layer39_attn_out_2</title>
<path fill="none" stroke="black" d="M792.5,-79913.47C792.5,-79913.47 792.5,-79852.1 792.5,-79852.1"/>
<polygon fill="black" stroke="black" points="796,-79852.1 792.5,-79842.1 789,-79852.1 796,-79852.1"/>
</g>
<!-- layer39_attn_out_3 -->
<g id="node994" class="node">
<title>layer39_attn_out_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1086.5,-79841.72 914.5,-79841.72 914.5,-79773.72 1086.5,-79773.72 1086.5,-79841.72"/>
<text text-anchor="middle" x="1000.5" y="-79826.52" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1000.5" y="-79811.52" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1000.5" y="-79796.52" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1000.5" y="-79781.52" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer39_attn_3&#45;&gt;layer39_attn_out_3 -->
<g id="edge1267" class="edge">
<title>layer39_attn_3&#45;&gt;layer39_attn_out_3</title>
<path fill="none" stroke="black" d="M1000.5,-79913.47C1000.5,-79913.47 1000.5,-79852.1 1000.5,-79852.1"/>
<polygon fill="black" stroke="black" points="1004,-79852.1 1000.5,-79842.1 997,-79852.1 1004,-79852.1"/>
</g>
<!-- layer39_attn_ar -->
<g id="node995" class="node">
<title>layer39_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="879.5" cy="-79653.63" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="879.5" y="-79672.43" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="879.5" y="-79657.43" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="879.5" y="-79642.43" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="879.5" y="-79627.43" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer39_attn_out_2&#45;&gt;layer39_attn_ar -->
<g id="edge1268" class="edge">
<title>layer39_attn_out_2&#45;&gt;layer39_attn_ar</title>
<path fill="none" stroke="black" d="M818.19,-79773.52C818.19,-79773.52 818.19,-79705.42 818.19,-79705.42"/>
<polygon fill="black" stroke="black" points="821.69,-79705.42 818.19,-79695.42 814.69,-79705.42 821.69,-79705.42"/>
</g>
<!-- layer39_attn_out_3&#45;&gt;layer39_attn_ar -->
<g id="edge1269" class="edge">
<title>layer39_attn_out_3&#45;&gt;layer39_attn_ar</title>
<path fill="none" stroke="black" d="M957.81,-79773.52C957.81,-79773.52 957.81,-79700.42 957.81,-79700.42"/>
<polygon fill="black" stroke="black" points="961.31,-79700.42 957.81,-79690.42 954.31,-79700.42 961.31,-79700.42"/>
</g>
<!-- layer39_ffn_norm_2 -->
<g id="node996" class="node">
<title>layer39_ffn_norm_2</title>
<polygon fill="#e6ffe6" stroke="black" points="857.5,-79533.55 685.5,-79533.55 685.5,-79465.55 857.5,-79465.55 857.5,-79533.55"/>
<text text-anchor="middle" x="771.5" y="-79518.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="771.5" y="-79503.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="771.5" y="-79488.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="771.5" y="-79473.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer39_attn_ar&#45;&gt;layer39_ffn_norm_2 -->
<g id="edge1270" class="edge">
<title>layer39_attn_ar&#45;&gt;layer39_ffn_norm_2</title>
<path fill="none" stroke="black" d="M807.69,-79614.75C807.69,-79614.75 807.69,-79543.7 807.69,-79543.7"/>
<polygon fill="black" stroke="black" points="811.19,-79543.7 807.69,-79533.7 804.19,-79543.7 811.19,-79543.7"/>
</g>
<!-- layer39_ffn_norm_3 -->
<g id="node997" class="node">
<title>layer39_ffn_norm_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1074.5,-79533.55 902.5,-79533.55 902.5,-79465.55 1074.5,-79465.55 1074.5,-79533.55"/>
<text text-anchor="middle" x="988.5" y="-79518.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="988.5" y="-79503.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="988.5" y="-79488.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-79473.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer39_attn_ar&#45;&gt;layer39_ffn_norm_3 -->
<g id="edge1271" class="edge">
<title>layer39_attn_ar&#45;&gt;layer39_ffn_norm_3</title>
<path fill="none" stroke="black" d="M951.81,-79614.75C951.81,-79614.75 951.81,-79543.7 951.81,-79543.7"/>
<polygon fill="black" stroke="black" points="955.31,-79543.7 951.81,-79533.7 948.31,-79543.7 955.31,-79543.7"/>
</g>
<!-- layer39_ffn_gate_2 -->
<g id="node998" class="node">
<title>layer39_ffn_gate_2</title>
<polygon fill="#e6ffe6" stroke="black" points="862,-79393.55 681,-79393.55 681,-79325.55 862,-79325.55 862,-79393.55"/>
<text text-anchor="middle" x="771.5" y="-79378.35" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="771.5" y="-79363.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="771.5" y="-79348.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="771.5" y="-79333.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_ffn_norm_2&#45;&gt;layer39_ffn_gate_2 -->
<g id="edge1272" class="edge">
<title>layer39_ffn_norm_2&#45;&gt;layer39_ffn_gate_2</title>
<path fill="none" stroke="black" d="M771.5,-79465.3C771.5,-79465.3 771.5,-79403.93 771.5,-79403.93"/>
<polygon fill="black" stroke="black" points="775,-79403.93 771.5,-79393.93 768,-79403.93 775,-79403.93"/>
</g>
<!-- layer39_ffn_up_2 -->
<g id="node1000" class="node">
<title>layer39_ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="645,-79393.55 464,-79393.55 464,-79325.55 645,-79325.55 645,-79393.55"/>
<text text-anchor="middle" x="554.5" y="-79378.35" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="554.5" y="-79363.35" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="554.5" y="-79348.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="554.5" y="-79333.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_ffn_norm_2&#45;&gt;layer39_ffn_up_2 -->
<g id="edge1274" class="edge">
<title>layer39_ffn_norm_2&#45;&gt;layer39_ffn_up_2</title>
<path fill="none" stroke="black" d="M685.11,-79499C651.77,-79499 621.5,-79499 621.5,-79499 621.5,-79499 621.5,-79403.66 621.5,-79403.66"/>
<polygon fill="black" stroke="black" points="625,-79403.66 621.5,-79393.66 618,-79403.66 625,-79403.66"/>
</g>
<!-- layer39_ffn_gate_3 -->
<g id="node999" class="node">
<title>layer39_ffn_gate_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1296,-79393.55 1115,-79393.55 1115,-79325.55 1296,-79325.55 1296,-79393.55"/>
<text text-anchor="middle" x="1205.5" y="-79378.35" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1205.5" y="-79363.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1205.5" y="-79348.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1205.5" y="-79333.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_ffn_norm_3&#45;&gt;layer39_ffn_gate_3 -->
<g id="edge1273" class="edge">
<title>layer39_ffn_norm_3&#45;&gt;layer39_ffn_gate_3</title>
<path fill="none" stroke="black" d="M1074.63,-79499C1101.62,-79499 1124.5,-79499 1124.5,-79499 1124.5,-79499 1124.5,-79403.66 1124.5,-79403.66"/>
<polygon fill="black" stroke="black" points="1128,-79403.66 1124.5,-79393.66 1121,-79403.66 1128,-79403.66"/>
</g>
<!-- layer39_ffn_up_3 -->
<g id="node1001" class="node">
<title>layer39_ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1079,-79393.55 898,-79393.55 898,-79325.55 1079,-79325.55 1079,-79393.55"/>
<text text-anchor="middle" x="988.5" y="-79378.35" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="988.5" y="-79363.35" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="988.5" y="-79348.35" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="988.5" y="-79333.35" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_ffn_norm_3&#45;&gt;layer39_ffn_up_3 -->
<g id="edge1275" class="edge">
<title>layer39_ffn_norm_3&#45;&gt;layer39_ffn_up_3</title>
<path fill="none" stroke="black" d="M988.5,-79465.3C988.5,-79465.3 988.5,-79403.93 988.5,-79403.93"/>
<polygon fill="black" stroke="black" points="992,-79403.93 988.5,-79393.93 985,-79403.93 992,-79403.93"/>
</g>
<!-- layer39_gate_ar -->
<g id="node1002" class="node">
<title>layer39_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="997.5" cy="-79205.47" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="997.5" y="-79224.27" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="997.5" y="-79209.27" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="997.5" y="-79194.27" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="997.5" y="-79179.27" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer39_ffn_gate_2&#45;&gt;layer39_gate_ar -->
<g id="edge1276" class="edge">
<title>layer39_ffn_gate_2&#45;&gt;layer39_gate_ar</title>
<path fill="none" stroke="black" d="M862.11,-79348C874.88,-79348 883.76,-79348 883.76,-79348 883.76,-79348 883.76,-79237.74 883.76,-79237.74"/>
<polygon fill="black" stroke="black" points="887.26,-79237.74 883.76,-79227.74 880.26,-79237.74 887.26,-79237.74"/>
</g>
<!-- layer39_ffn_gate_3&#45;&gt;layer39_gate_ar -->
<g id="edge1277" class="edge">
<title>layer39_ffn_gate_3&#45;&gt;layer39_gate_ar</title>
<path fill="none" stroke="black" d="M1120.24,-79325.35C1120.24,-79325.35 1120.24,-79229.29 1120.24,-79229.29"/>
<polygon fill="black" stroke="black" points="1123.74,-79229.29 1120.24,-79219.29 1116.74,-79229.29 1123.74,-79229.29"/>
</g>
<!-- layer39_up_ar -->
<g id="node1003" class="node">
<title>layer39_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="651.5" cy="-79205.47" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="651.5" y="-79224.27" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="651.5" y="-79209.27" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="651.5" y="-79194.27" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="651.5" y="-79179.27" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer39_ffn_up_2&#45;&gt;layer39_up_ar -->
<g id="edge1278" class="edge">
<title>layer39_ffn_up_2&#45;&gt;layer39_up_ar</title>
<path fill="none" stroke="black" d="M584.26,-79325.35C584.26,-79325.35 584.26,-79256.41 584.26,-79256.41"/>
<polygon fill="black" stroke="black" points="587.76,-79256.41 584.26,-79246.41 580.76,-79256.41 587.76,-79256.41"/>
</g>
<!-- layer39_ffn_up_3&#45;&gt;layer39_up_ar -->
<g id="edge1279" class="edge">
<title>layer39_ffn_up_3&#45;&gt;layer39_up_ar</title>
<path fill="none" stroke="black" d="M897.69,-79370C879.45,-79370 865.76,-79370 865.76,-79370 865.76,-79370 865.76,-79205 865.76,-79205 865.76,-79205 789.54,-79205 789.54,-79205"/>
<polygon fill="black" stroke="black" points="789.54,-79201.5 779.54,-79205 789.54,-79208.5 789.54,-79201.5"/>
</g>
<!-- layer39_silu_2 -->
<g id="node1004" class="node">
<title>layer39_silu_2</title>
<polygon fill="#e6ffe6" stroke="black" points="925,-79085.38 744,-79085.38 744,-79017.38 925,-79017.38 925,-79085.38"/>
<text text-anchor="middle" x="834.5" y="-79070.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="834.5" y="-79055.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="834.5" y="-79040.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="834.5" y="-79025.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_gate_ar&#45;&gt;layer39_silu_2 -->
<g id="edge1280" class="edge">
<title>layer39_gate_ar&#45;&gt;layer39_silu_2</title>
<path fill="none" stroke="black" d="M897.26,-79175.39C897.26,-79175.39 897.26,-79095.4 897.26,-79095.4"/>
<polygon fill="black" stroke="black" points="900.76,-79095.4 897.26,-79085.4 893.76,-79095.4 900.76,-79095.4"/>
</g>
<!-- layer39_silu_3 -->
<g id="node1005" class="node">
<title>layer39_silu_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1142,-79085.38 961,-79085.38 961,-79017.38 1142,-79017.38 1142,-79085.38"/>
<text text-anchor="middle" x="1051.5" y="-79070.18" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1051.5" y="-79055.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="1051.5" y="-79040.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1051.5" y="-79025.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_gate_ar&#45;&gt;layer39_silu_3 -->
<g id="edge1281" class="edge">
<title>layer39_gate_ar&#45;&gt;layer39_silu_3</title>
<path fill="none" stroke="black" d="M1043.24,-79160.48C1043.24,-79160.48 1043.24,-79095.39 1043.24,-79095.39"/>
<polygon fill="black" stroke="black" points="1046.74,-79095.39 1043.24,-79085.39 1039.74,-79095.39 1046.74,-79095.39"/>
</g>
<!-- layer39_mul_2 -->
<g id="node1006" class="node">
<title>layer39_mul_2</title>
<polygon fill="#e6ffe6" stroke="black" points="772,-78945.38 591,-78945.38 591,-78877.38 772,-78877.38 772,-78945.38"/>
<text text-anchor="middle" x="681.5" y="-78930.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="681.5" y="-78915.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="681.5" y="-78900.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="681.5" y="-78885.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_up_ar&#45;&gt;layer39_mul_2 -->
<g id="edge1283" class="edge">
<title>layer39_up_ar&#45;&gt;layer39_mul_2</title>
<path fill="none" stroke="black" d="M667.5,-79157.56C667.5,-79157.56 667.5,-78955.49 667.5,-78955.49"/>
<polygon fill="black" stroke="black" points="671,-78955.49 667.5,-78945.49 664,-78955.49 671,-78955.49"/>
</g>
<!-- layer39_mul_3 -->
<g id="node1007" class="node">
<title>layer39_mul_3</title>
<polygon fill="#e6ffe6" stroke="black" points="989,-78945.38 808,-78945.38 808,-78877.38 989,-78877.38 989,-78945.38"/>
<text text-anchor="middle" x="898.5" y="-78930.18" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="898.5" y="-78915.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="898.5" y="-78900.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="898.5" y="-78885.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer39_up_ar&#45;&gt;layer39_mul_3 -->
<g id="edge1285" class="edge">
<title>layer39_up_ar&#45;&gt;layer39_mul_3</title>
<path fill="none" stroke="black" d="M761.74,-79181.03C761.74,-79156.09 761.74,-79121 761.74,-79121 761.74,-79121 943,-79121 943,-79121 943,-79121 943,-78955.53 943,-78955.53"/>
<polygon fill="black" stroke="black" points="946.5,-78955.53 943,-78945.53 939.5,-78955.53 946.5,-78955.53"/>
</g>
<!-- layer39_silu_2&#45;&gt;layer39_mul_2 -->
<g id="edge1282" class="edge">
<title>layer39_silu_2&#45;&gt;layer39_mul_2</title>
<path fill="none" stroke="black" d="M758,-79017.13C758,-79017.13 758,-78955.76 758,-78955.76"/>
<polygon fill="black" stroke="black" points="761.5,-78955.76 758,-78945.76 754.5,-78955.76 761.5,-78955.76"/>
</g>
<!-- layer39_silu_3&#45;&gt;layer39_mul_3 -->
<g id="edge1284" class="edge">
<title>layer39_silu_3&#45;&gt;layer39_mul_3</title>
<path fill="none" stroke="black" d="M975,-79017.13C975,-79017.13 975,-78955.76 975,-78955.76"/>
<polygon fill="black" stroke="black" points="978.5,-78955.76 975,-78945.76 971.5,-78955.76 978.5,-78955.76"/>
</g>
<!-- layer39_ffn_down_2 -->
<g id="node1008" class="node">
<title>layer39_ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="771.5,-78805.38 599.5,-78805.38 599.5,-78737.38 771.5,-78737.38 771.5,-78805.38"/>
<text text-anchor="middle" x="685.5" y="-78790.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="685.5" y="-78775.18" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="685.5" y="-78760.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="685.5" y="-78745.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer39_mul_2&#45;&gt;layer39_ffn_down_2 -->
<g id="edge1286" class="edge">
<title>layer39_mul_2&#45;&gt;layer39_ffn_down_2</title>
<path fill="none" stroke="black" d="M685.5,-78877.13C685.5,-78877.13 685.5,-78815.76 685.5,-78815.76"/>
<polygon fill="black" stroke="black" points="689,-78815.76 685.5,-78805.76 682,-78815.76 689,-78815.76"/>
</g>
<!-- layer39_ffn_down_3 -->
<g id="node1009" class="node">
<title>layer39_ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="981.5,-78805.38 809.5,-78805.38 809.5,-78737.38 981.5,-78737.38 981.5,-78805.38"/>
<text text-anchor="middle" x="895.5" y="-78790.18" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="895.5" y="-78775.18" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="895.5" y="-78760.18" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="895.5" y="-78745.18" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer39_mul_3&#45;&gt;layer39_ffn_down_3 -->
<g id="edge1287" class="edge">
<title>layer39_mul_3&#45;&gt;layer39_ffn_down_3</title>
<path fill="none" stroke="black" d="M895.5,-78877.13C895.5,-78877.13 895.5,-78815.76 895.5,-78815.76"/>
<polygon fill="black" stroke="black" points="899,-78815.76 895.5,-78805.76 892,-78815.76 899,-78815.76"/>
</g>
<!-- layer39_ffn_ar -->
<g id="node1010" class="node">
<title>layer39_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="717.5" cy="-78617.3" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="717.5" y="-78636.1" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="717.5" y="-78621.1" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
<text text-anchor="middle" x="717.5" y="-78606.1" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="717.5" y="-78591.1" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer39_ffn_down_2&#45;&gt;layer39_ffn_ar -->
<g id="edge1288" class="edge">
<title>layer39_ffn_down_2&#45;&gt;layer39_ffn_ar</title>
<path fill="none" stroke="black" d="M685.5,-78737.19C685.5,-78737.19 685.5,-78673.96 685.5,-78673.96"/>
<polygon fill="black" stroke="black" points="689,-78673.96 685.5,-78663.96 682,-78673.96 689,-78673.96"/>
</g>
<!-- layer39_ffn_down_3&#45;&gt;layer39_ffn_ar -->
<g id="edge1289" class="edge">
<title>layer39_ffn_down_3&#45;&gt;layer39_ffn_ar</title>
<path fill="none" stroke="black" d="M824.31,-78737.19C824.31,-78737.19 824.31,-78650.42 824.31,-78650.42"/>
<polygon fill="black" stroke="black" points="827.81,-78650.42 824.31,-78640.42 820.81,-78650.42 827.81,-78650.42"/>
</g>
<!-- pp_send_1_2 -->
<g id="node1011" class="node">
<title>pp_send_1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="717.5" cy="-78459.74" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="717.5" y="-78471.04" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="717.5" y="-78456.04" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="717.5" y="-78441.04" font-family="Times,serif" font-size="14.00">GPU:[3][4]</text>
</g>
<!-- layer39_ffn_ar&#45;&gt;pp_send_1_2 -->
<g id="edge1292" class="edge">
<title>layer39_ffn_ar&#45;&gt;pp_send_1_2</title>
<path fill="none" stroke="black" d="M717.5,-78569.17C717.5,-78569.17 717.5,-78507.33 717.5,-78507.33"/>
<polygon fill="black" stroke="black" points="721,-78507.33 717.5,-78497.33 714,-78507.33 721,-78507.33"/>
</g>
<!-- split_stage2 -->
<g id="node1012" class="node">
<title>split_stage2</title>
<polygon fill="lightyellow" stroke="black" points="1067.85,-78350.26 510.52,-78350.26 367.15,-78274.26 924.48,-78274.26 1067.85,-78350.26"/>
<text text-anchor="middle" x="717.5" y="-78316.06" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="717.5" y="-78301.06" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=4096]</text>
</g>
<!-- pp_send_1_2&#45;&gt;split_stage2 -->
<g id="edge1293" class="edge">
<title>pp_send_1_2&#45;&gt;split_stage2</title>
<path fill="none" stroke="black" d="M717.5,-78422.14C717.5,-78422.14 717.5,-78360.3 717.5,-78360.3"/>
<polygon fill="black" stroke="black" points="721,-78360.3 717.5,-78350.3 714,-78360.3 721,-78360.3"/>
</g>
<!-- layer40_embed_4 -->
<g id="node1013" class="node">
<title>layer40_embed_4</title>
<polygon fill="#e6e6ff" stroke="black" points="699.5,-78202.26 527.5,-78202.26 527.5,-78134.26 699.5,-78134.26 699.5,-78202.26"/>
<text text-anchor="middle" x="613.5" y="-78187.06" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="613.5" y="-78172.06" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="613.5" y="-78157.06" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="613.5" y="-78142.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage2&#45;&gt;layer40_embed_4 -->
<g id="edge1294" class="edge">
<title>split_stage2&#45;&gt;layer40_embed_4</title>
<path fill="none" stroke="black" d="M613.5,-78274.05C613.5,-78274.05 613.5,-78212.71 613.5,-78212.71"/>
<polygon fill="black" stroke="black" points="617,-78212.71 613.5,-78202.71 610,-78212.71 617,-78212.71"/>
</g>
<!-- layer40_embed_5 -->
<g id="node1014" class="node">
<title>layer40_embed_5</title>
<polygon fill="#e6e6ff" stroke="black" points="907.5,-78202.26 735.5,-78202.26 735.5,-78134.26 907.5,-78134.26 907.5,-78202.26"/>
<text text-anchor="middle" x="821.5" y="-78187.06" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="821.5" y="-78172.06" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="821.5" y="-78157.06" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="821.5" y="-78142.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage2&#45;&gt;layer40_embed_5 -->
<g id="edge1295" class="edge">
<title>split_stage2&#45;&gt;layer40_embed_5</title>
<path fill="none" stroke="black" d="M821.5,-78274.05C821.5,-78274.05 821.5,-78212.71 821.5,-78212.71"/>
<polygon fill="black" stroke="black" points="825,-78212.71 821.5,-78202.71 818,-78212.71 825,-78212.71"/>
</g>
<!-- embed_ag_stage2 -->
<g id="node1017" class="node">
<title>embed_ag_stage2</title>
<ellipse fill="lightblue" stroke="black" cx="717.5" cy="-78014.18" rx="124.4" ry="48.17"/>
<text text-anchor="middle" x="717.5" y="-78032.98" font-family="Times,serif" font-size="14.00">All&#45;Gather Embedding</text>
<text text-anchor="middle" x="717.5" y="-78017.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="717.5" y="-78002.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="717.5" y="-77987.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_embed_4&#45;&gt;embed_ag_stage2 -->
<g id="edge1936" class="edge">
<title>layer40_embed_4&#45;&gt;embed_ag_stage2</title>
<path fill="none" stroke="black" d="M646.27,-78134.07C646.27,-78134.07 646.27,-78063.72 646.27,-78063.72"/>
<polygon fill="black" stroke="black" points="649.77,-78063.72 646.27,-78053.72 642.77,-78063.72 649.77,-78063.72"/>
</g>
<!-- layer40_embed_5&#45;&gt;embed_ag_stage2 -->
<g id="edge1937" class="edge">
<title>layer40_embed_5&#45;&gt;embed_ag_stage2</title>
<path fill="none" stroke="black" d="M788.73,-78134.07C788.73,-78134.07 788.73,-78063.72 788.73,-78063.72"/>
<polygon fill="black" stroke="black" points="792.23,-78063.72 788.73,-78053.72 785.23,-78063.72 792.23,-78063.72"/>
</g>
<!-- layer40_norm_4 -->
<g id="node1015" class="node">
<title>layer40_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="698.5,-77894.1 526.5,-77894.1 526.5,-77826.1 698.5,-77826.1 698.5,-77894.1"/>
<text text-anchor="middle" x="612.5" y="-77878.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="612.5" y="-77863.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="612.5" y="-77848.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="612.5" y="-77833.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_qkv_4 -->
<g id="node1018" class="node">
<title>layer40_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="699,-77754.1 518,-77754.1 518,-77686.1 699,-77686.1 699,-77754.1"/>
<text text-anchor="middle" x="608.5" y="-77738.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="608.5" y="-77723.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="608.5" y="-77708.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="608.5" y="-77693.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer40_norm_4&#45;&gt;layer40_qkv_4 -->
<g id="edge1298" class="edge">
<title>layer40_norm_4&#45;&gt;layer40_qkv_4</title>
<path fill="none" stroke="black" d="M612.5,-77825.85C612.5,-77825.85 612.5,-77764.48 612.5,-77764.48"/>
<polygon fill="black" stroke="black" points="616,-77764.48 612.5,-77754.48 609,-77764.48 616,-77764.48"/>
</g>
<!-- layer40_norm_5 -->
<g id="node1016" class="node">
<title>layer40_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="908.5,-77894.1 736.5,-77894.1 736.5,-77826.1 908.5,-77826.1 908.5,-77894.1"/>
<text text-anchor="middle" x="822.5" y="-77878.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="822.5" y="-77863.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="822.5" y="-77848.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="822.5" y="-77833.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_qkv_5 -->
<g id="node1019" class="node">
<title>layer40_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="916,-77754.1 735,-77754.1 735,-77686.1 916,-77686.1 916,-77754.1"/>
<text text-anchor="middle" x="825.5" y="-77738.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="825.5" y="-77723.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="825.5" y="-77708.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="825.5" y="-77693.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer40_norm_5&#45;&gt;layer40_qkv_5 -->
<g id="edge1299" class="edge">
<title>layer40_norm_5&#45;&gt;layer40_qkv_5</title>
<path fill="none" stroke="black" d="M822.5,-77825.85C822.5,-77825.85 822.5,-77764.48 822.5,-77764.48"/>
<polygon fill="black" stroke="black" points="826,-77764.48 822.5,-77754.48 819,-77764.48 826,-77764.48"/>
</g>
<!-- embed_ag_stage2&#45;&gt;layer40_norm_4 -->
<g id="edge1296" class="edge">
<title>embed_ag_stage2&#45;&gt;layer40_norm_4</title>
<path fill="none" stroke="black" d="M645.77,-77974.5C645.77,-77974.5 645.77,-77904.15 645.77,-77904.15"/>
<polygon fill="black" stroke="black" points="649.27,-77904.15 645.77,-77894.15 642.27,-77904.15 649.27,-77904.15"/>
</g>
<!-- embed_ag_stage2&#45;&gt;layer40_norm_5 -->
<g id="edge1297" class="edge">
<title>embed_ag_stage2&#45;&gt;layer40_norm_5</title>
<path fill="none" stroke="black" d="M789.23,-77974.5C789.23,-77974.5 789.23,-77904.15 789.23,-77904.15"/>
<polygon fill="black" stroke="black" points="792.73,-77904.15 789.23,-77894.15 785.73,-77904.15 792.73,-77904.15"/>
</g>
<!-- layer40_qkv_ar -->
<g id="node1020" class="node">
<title>layer40_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="717.5" cy="-77566.01" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="717.5" y="-77584.81" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="717.5" y="-77569.81" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="717.5" y="-77554.81" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="717.5" y="-77539.81" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer40_qkv_4&#45;&gt;layer40_qkv_ar -->
<g id="edge1300" class="edge">
<title>layer40_qkv_4&#45;&gt;layer40_qkv_ar</title>
<path fill="none" stroke="black" d="M644.26,-77685.9C644.26,-77685.9 644.26,-77615.56 644.26,-77615.56"/>
<polygon fill="black" stroke="black" points="647.76,-77615.56 644.26,-77605.56 640.76,-77615.56 647.76,-77615.56"/>
</g>
<!-- layer40_qkv_5&#45;&gt;layer40_qkv_ar -->
<g id="edge1301" class="edge">
<title>layer40_qkv_5&#45;&gt;layer40_qkv_ar</title>
<path fill="none" stroke="black" d="M790.24,-77685.9C790.24,-77685.9 790.24,-77615.83 790.24,-77615.83"/>
<polygon fill="black" stroke="black" points="793.74,-77615.83 790.24,-77605.83 786.74,-77615.83 793.74,-77615.83"/>
</g>
<!-- layer40_attn_4 -->
<g id="node1021" class="node">
<title>layer40_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="699.5,-77445.93 527.5,-77445.93 527.5,-77377.93 699.5,-77377.93 699.5,-77445.93"/>
<text text-anchor="middle" x="613.5" y="-77430.73" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="613.5" y="-77415.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="613.5" y="-77400.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="613.5" y="-77385.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer40_qkv_ar&#45;&gt;layer40_attn_4 -->
<g id="edge1302" class="edge">
<title>layer40_qkv_ar&#45;&gt;layer40_attn_4</title>
<path fill="none" stroke="black" d="M644.51,-77526.33C644.51,-77526.33 644.51,-77455.99 644.51,-77455.99"/>
<polygon fill="black" stroke="black" points="648.01,-77455.99 644.51,-77445.99 641.01,-77455.99 648.01,-77455.99"/>
</g>
<!-- layer40_attn_5 -->
<g id="node1022" class="node">
<title>layer40_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="907.5,-77445.93 735.5,-77445.93 735.5,-77377.93 907.5,-77377.93 907.5,-77445.93"/>
<text text-anchor="middle" x="821.5" y="-77430.73" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="821.5" y="-77415.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="821.5" y="-77400.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="821.5" y="-77385.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer40_qkv_ar&#45;&gt;layer40_attn_5 -->
<g id="edge1303" class="edge">
<title>layer40_qkv_ar&#45;&gt;layer40_attn_5</title>
<path fill="none" stroke="black" d="M790.49,-77526.33C790.49,-77526.33 790.49,-77455.99 790.49,-77455.99"/>
<polygon fill="black" stroke="black" points="793.99,-77455.99 790.49,-77445.99 786.99,-77455.99 793.99,-77455.99"/>
</g>
<!-- layer40_attn_out_4 -->
<g id="node1023" class="node">
<title>layer40_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="699.5,-77305.93 527.5,-77305.93 527.5,-77237.93 699.5,-77237.93 699.5,-77305.93"/>
<text text-anchor="middle" x="613.5" y="-77290.73" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="613.5" y="-77275.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="613.5" y="-77260.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="613.5" y="-77245.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer40_attn_4&#45;&gt;layer40_attn_out_4 -->
<g id="edge1304" class="edge">
<title>layer40_attn_4&#45;&gt;layer40_attn_out_4</title>
<path fill="none" stroke="black" d="M613.5,-77377.68C613.5,-77377.68 613.5,-77316.31 613.5,-77316.31"/>
<polygon fill="black" stroke="black" points="617,-77316.31 613.5,-77306.31 610,-77316.31 617,-77316.31"/>
</g>
<!-- layer40_attn_out_5 -->
<g id="node1024" class="node">
<title>layer40_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="907.5,-77305.93 735.5,-77305.93 735.5,-77237.93 907.5,-77237.93 907.5,-77305.93"/>
<text text-anchor="middle" x="821.5" y="-77290.73" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="821.5" y="-77275.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="821.5" y="-77260.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="821.5" y="-77245.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer40_attn_5&#45;&gt;layer40_attn_out_5 -->
<g id="edge1305" class="edge">
<title>layer40_attn_5&#45;&gt;layer40_attn_out_5</title>
<path fill="none" stroke="black" d="M821.5,-77377.68C821.5,-77377.68 821.5,-77316.31 821.5,-77316.31"/>
<polygon fill="black" stroke="black" points="825,-77316.31 821.5,-77306.31 818,-77316.31 825,-77316.31"/>
</g>
<!-- layer40_attn_ar -->
<g id="node1025" class="node">
<title>layer40_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="717.5" cy="-77117.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="717.5" y="-77136.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="717.5" y="-77121.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="717.5" y="-77106.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="717.5" y="-77091.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_attn_out_4&#45;&gt;layer40_attn_ar -->
<g id="edge1306" class="edge">
<title>layer40_attn_out_4&#45;&gt;layer40_attn_ar</title>
<path fill="none" stroke="black" d="M647.69,-77237.73C647.69,-77237.73 647.69,-77167.39 647.69,-77167.39"/>
<polygon fill="black" stroke="black" points="651.19,-77167.39 647.69,-77157.39 644.19,-77167.39 651.19,-77167.39"/>
</g>
<!-- layer40_attn_out_5&#45;&gt;layer40_attn_ar -->
<g id="edge1307" class="edge">
<title>layer40_attn_out_5&#45;&gt;layer40_attn_ar</title>
<path fill="none" stroke="black" d="M787.31,-77237.73C787.31,-77237.73 787.31,-77167.39 787.31,-77167.39"/>
<polygon fill="black" stroke="black" points="790.81,-77167.39 787.31,-77157.39 783.81,-77167.39 790.81,-77167.39"/>
</g>
<!-- layer40_ffn_norm_4 -->
<g id="node1026" class="node">
<title>layer40_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="695.5,-76997.76 523.5,-76997.76 523.5,-76929.76 695.5,-76929.76 695.5,-76997.76"/>
<text text-anchor="middle" x="609.5" y="-76982.56" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="609.5" y="-76967.56" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="609.5" y="-76952.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="609.5" y="-76937.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_attn_ar&#45;&gt;layer40_ffn_norm_4 -->
<g id="edge1308" class="edge">
<title>layer40_attn_ar&#45;&gt;layer40_ffn_norm_4</title>
<path fill="none" stroke="black" d="M645.69,-77078.96C645.69,-77078.96 645.69,-77007.91 645.69,-77007.91"/>
<polygon fill="black" stroke="black" points="649.19,-77007.91 645.69,-76997.91 642.19,-77007.91 649.19,-77007.91"/>
</g>
<!-- layer40_ffn_norm_5 -->
<g id="node1027" class="node">
<title>layer40_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="912.5,-76997.76 740.5,-76997.76 740.5,-76929.76 912.5,-76929.76 912.5,-76997.76"/>
<text text-anchor="middle" x="826.5" y="-76982.56" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="826.5" y="-76967.56" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="826.5" y="-76952.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="826.5" y="-76937.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_attn_ar&#45;&gt;layer40_ffn_norm_5 -->
<g id="edge1309" class="edge">
<title>layer40_attn_ar&#45;&gt;layer40_ffn_norm_5</title>
<path fill="none" stroke="black" d="M789.81,-77078.96C789.81,-77078.96 789.81,-77007.91 789.81,-77007.91"/>
<polygon fill="black" stroke="black" points="793.31,-77007.91 789.81,-76997.91 786.31,-77007.91 793.31,-77007.91"/>
</g>
<!-- layer40_ffn_gate_4 -->
<g id="node1028" class="node">
<title>layer40_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="700,-76857.76 519,-76857.76 519,-76789.76 700,-76789.76 700,-76857.76"/>
<text text-anchor="middle" x="609.5" y="-76842.56" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="609.5" y="-76827.56" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="609.5" y="-76812.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="609.5" y="-76797.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_ffn_norm_4&#45;&gt;layer40_ffn_gate_4 -->
<g id="edge1310" class="edge">
<title>layer40_ffn_norm_4&#45;&gt;layer40_ffn_gate_4</title>
<path fill="none" stroke="black" d="M609.5,-76929.52C609.5,-76929.52 609.5,-76868.14 609.5,-76868.14"/>
<polygon fill="black" stroke="black" points="613,-76868.14 609.5,-76858.14 606,-76868.14 613,-76868.14"/>
</g>
<!-- layer40_ffn_up_4 -->
<g id="node1030" class="node">
<title>layer40_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="483,-76857.76 302,-76857.76 302,-76789.76 483,-76789.76 483,-76857.76"/>
<text text-anchor="middle" x="392.5" y="-76842.56" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="392.5" y="-76827.56" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="392.5" y="-76812.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="392.5" y="-76797.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_ffn_norm_4&#45;&gt;layer40_ffn_up_4 -->
<g id="edge1312" class="edge">
<title>layer40_ffn_norm_4&#45;&gt;layer40_ffn_up_4</title>
<path fill="none" stroke="black" d="M523.48,-76963C475.39,-76963 425.04,-76963 425.04,-76963 425.04,-76963 425.04,-76867.82 425.04,-76867.82"/>
<polygon fill="black" stroke="black" points="428.54,-76867.82 425.04,-76857.82 421.54,-76867.82 428.54,-76867.82"/>
</g>
<!-- layer40_ffn_gate_5 -->
<g id="node1029" class="node">
<title>layer40_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1134,-76857.76 953,-76857.76 953,-76789.76 1134,-76789.76 1134,-76857.76"/>
<text text-anchor="middle" x="1043.5" y="-76842.56" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1043.5" y="-76827.56" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1043.5" y="-76812.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1043.5" y="-76797.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_ffn_norm_5&#45;&gt;layer40_ffn_gate_5 -->
<g id="edge1311" class="edge">
<title>layer40_ffn_norm_5&#45;&gt;layer40_ffn_gate_5</title>
<path fill="none" stroke="black" d="M912.56,-76963C960.43,-76963 1010.46,-76963 1010.46,-76963 1010.46,-76963 1010.46,-76867.82 1010.46,-76867.82"/>
<polygon fill="black" stroke="black" points="1013.96,-76867.82 1010.46,-76857.82 1006.96,-76867.82 1013.96,-76867.82"/>
</g>
<!-- layer40_ffn_up_5 -->
<g id="node1031" class="node">
<title>layer40_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="917,-76857.76 736,-76857.76 736,-76789.76 917,-76789.76 917,-76857.76"/>
<text text-anchor="middle" x="826.5" y="-76842.56" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="826.5" y="-76827.56" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="826.5" y="-76812.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="826.5" y="-76797.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_ffn_norm_5&#45;&gt;layer40_ffn_up_5 -->
<g id="edge1313" class="edge">
<title>layer40_ffn_norm_5&#45;&gt;layer40_ffn_up_5</title>
<path fill="none" stroke="black" d="M826.5,-76929.52C826.5,-76929.52 826.5,-76868.14 826.5,-76868.14"/>
<polygon fill="black" stroke="black" points="830,-76868.14 826.5,-76858.14 823,-76868.14 830,-76868.14"/>
</g>
<!-- layer40_gate_ar -->
<g id="node1032" class="node">
<title>layer40_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="864.5" cy="-76669.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="864.5" y="-76688.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="864.5" y="-76673.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="864.5" y="-76658.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="864.5" y="-76643.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer40_ffn_gate_4&#45;&gt;layer40_gate_ar -->
<g id="edge1314" class="edge">
<title>layer40_ffn_gate_4&#45;&gt;layer40_gate_ar</title>
<path fill="none" stroke="black" d="M673.24,-76789.62C673.24,-76739.78 673.24,-76653 673.24,-76653 673.24,-76653 734.46,-76653 734.46,-76653"/>
<polygon fill="black" stroke="black" points="734.46,-76656.5 744.46,-76653 734.46,-76649.5 734.46,-76656.5"/>
</g>
<!-- layer40_ffn_gate_5&#45;&gt;layer40_gate_ar -->
<g id="edge1315" class="edge">
<title>layer40_ffn_gate_5&#45;&gt;layer40_gate_ar</title>
<path fill="none" stroke="black" d="M972.74,-76789.57C972.74,-76789.57 972.74,-76705.64 972.74,-76705.64"/>
<polygon fill="black" stroke="black" points="976.24,-76705.64 972.74,-76695.64 969.24,-76705.64 976.24,-76705.64"/>
</g>
<!-- layer40_up_ar -->
<g id="node1033" class="node">
<title>layer40_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="518.5" cy="-76669.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="518.5" y="-76688.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="518.5" y="-76673.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="518.5" y="-76658.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="518.5" y="-76643.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer40_ffn_up_4&#45;&gt;layer40_up_ar -->
<g id="edge1316" class="edge">
<title>layer40_ffn_up_4&#45;&gt;layer40_up_ar</title>
<path fill="none" stroke="black" d="M436.76,-76789.57C436.76,-76789.57 436.76,-76716.74 436.76,-76716.74"/>
<polygon fill="black" stroke="black" points="440.26,-76716.74 436.76,-76706.74 433.26,-76716.74 440.26,-76716.74"/>
</g>
<!-- layer40_ffn_up_5&#45;&gt;layer40_up_ar -->
<g id="edge1317" class="edge">
<title>layer40_ffn_up_5&#45;&gt;layer40_up_ar</title>
<path fill="none" stroke="black" d="M735.92,-76823C725.21,-76823 718,-76823 718,-76823 718,-76823 718,-76685 718,-76685 718,-76685 650.01,-76685 650.01,-76685"/>
<polygon fill="black" stroke="black" points="650.01,-76681.5 640.01,-76685 650.01,-76688.5 650.01,-76681.5"/>
</g>
<!-- layer40_silu_4 -->
<g id="node1034" class="node">
<title>layer40_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="792,-76549.6 611,-76549.6 611,-76481.6 792,-76481.6 792,-76549.6"/>
<text text-anchor="middle" x="701.5" y="-76534.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="701.5" y="-76519.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="701.5" y="-76504.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="701.5" y="-76489.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_gate_ar&#45;&gt;layer40_silu_4 -->
<g id="edge1318" class="edge">
<title>layer40_gate_ar&#45;&gt;layer40_silu_4</title>
<path fill="none" stroke="black" d="M764.26,-76639.61C764.26,-76639.61 764.26,-76559.62 764.26,-76559.62"/>
<polygon fill="black" stroke="black" points="767.76,-76559.62 764.26,-76549.62 760.76,-76559.62 767.76,-76559.62"/>
</g>
<!-- layer40_silu_5 -->
<g id="node1035" class="node">
<title>layer40_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1009,-76549.6 828,-76549.6 828,-76481.6 1009,-76481.6 1009,-76549.6"/>
<text text-anchor="middle" x="918.5" y="-76534.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="918.5" y="-76519.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="918.5" y="-76504.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="918.5" y="-76489.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_gate_ar&#45;&gt;layer40_silu_5 -->
<g id="edge1319" class="edge">
<title>layer40_gate_ar&#45;&gt;layer40_silu_5</title>
<path fill="none" stroke="black" d="M910.24,-76624.7C910.24,-76624.7 910.24,-76559.6 910.24,-76559.6"/>
<polygon fill="black" stroke="black" points="913.74,-76559.6 910.24,-76549.6 906.74,-76559.6 913.74,-76559.6"/>
</g>
<!-- layer40_mul_4 -->
<g id="node1036" class="node">
<title>layer40_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="682,-76409.6 501,-76409.6 501,-76341.6 682,-76341.6 682,-76409.6"/>
<text text-anchor="middle" x="591.5" y="-76394.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="591.5" y="-76379.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="591.5" y="-76364.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="591.5" y="-76349.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_up_ar&#45;&gt;layer40_mul_4 -->
<g id="edge1321" class="edge">
<title>layer40_up_ar&#45;&gt;layer40_mul_4</title>
<path fill="none" stroke="black" d="M556,-76623.41C556,-76623.41 556,-76419.68 556,-76419.68"/>
<polygon fill="black" stroke="black" points="559.5,-76419.68 556,-76409.68 552.5,-76419.68 559.5,-76419.68"/>
</g>
<!-- layer40_mul_5 -->
<g id="node1037" class="node">
<title>layer40_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="899,-76409.6 718,-76409.6 718,-76341.6 899,-76341.6 899,-76409.6"/>
<text text-anchor="middle" x="808.5" y="-76394.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="808.5" y="-76379.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="808.5" y="-76364.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="808.5" y="-76349.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer40_up_ar&#45;&gt;layer40_mul_5 -->
<g id="edge1323" class="edge">
<title>layer40_up_ar&#45;&gt;layer40_mul_5</title>
<path fill="none" stroke="black" d="M628.74,-76645.19C628.74,-76620.18 628.74,-76585 628.74,-76585 628.74,-76585 810,-76585 810,-76585 810,-76585 810,-76419.71 810,-76419.71"/>
<polygon fill="black" stroke="black" points="813.5,-76419.71 810,-76409.71 806.5,-76419.71 813.5,-76419.71"/>
</g>
<!-- layer40_silu_4&#45;&gt;layer40_mul_4 -->
<g id="edge1320" class="edge">
<title>layer40_silu_4&#45;&gt;layer40_mul_4</title>
<path fill="none" stroke="black" d="M646.5,-76481.35C646.5,-76481.35 646.5,-76419.98 646.5,-76419.98"/>
<polygon fill="black" stroke="black" points="650,-76419.98 646.5,-76409.98 643,-76419.98 650,-76419.98"/>
</g>
<!-- layer40_silu_5&#45;&gt;layer40_mul_5 -->
<g id="edge1322" class="edge">
<title>layer40_silu_5&#45;&gt;layer40_mul_5</title>
<path fill="none" stroke="black" d="M863.5,-76481.35C863.5,-76481.35 863.5,-76419.98 863.5,-76419.98"/>
<polygon fill="black" stroke="black" points="867,-76419.98 863.5,-76409.98 860,-76419.98 867,-76419.98"/>
</g>
<!-- layer40_ffn_down_4 -->
<g id="node1038" class="node">
<title>layer40_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="680.5,-76269.6 508.5,-76269.6 508.5,-76201.6 680.5,-76201.6 680.5,-76269.6"/>
<text text-anchor="middle" x="594.5" y="-76254.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="594.5" y="-76239.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="594.5" y="-76224.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="594.5" y="-76209.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer40_mul_4&#45;&gt;layer40_ffn_down_4 -->
<g id="edge1324" class="edge">
<title>layer40_mul_4&#45;&gt;layer40_ffn_down_4</title>
<path fill="none" stroke="black" d="M594.5,-76341.35C594.5,-76341.35 594.5,-76279.98 594.5,-76279.98"/>
<polygon fill="black" stroke="black" points="598,-76279.98 594.5,-76269.98 591,-76279.98 598,-76279.98"/>
</g>
<!-- layer40_ffn_down_5 -->
<g id="node1039" class="node">
<title>layer40_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="890.5,-76269.6 718.5,-76269.6 718.5,-76201.6 890.5,-76201.6 890.5,-76269.6"/>
<text text-anchor="middle" x="804.5" y="-76254.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="804.5" y="-76239.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="804.5" y="-76224.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="804.5" y="-76209.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer40_mul_5&#45;&gt;layer40_ffn_down_5 -->
<g id="edge1325" class="edge">
<title>layer40_mul_5&#45;&gt;layer40_ffn_down_5</title>
<path fill="none" stroke="black" d="M804.5,-76341.35C804.5,-76341.35 804.5,-76279.98 804.5,-76279.98"/>
<polygon fill="black" stroke="black" points="808,-76279.98 804.5,-76269.98 801,-76279.98 808,-76279.98"/>
</g>
<!-- layer40_ffn_ar -->
<g id="node1040" class="node">
<title>layer40_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="698.5" cy="-76081.51" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="698.5" y="-76100.31" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="698.5" y="-76085.31" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="698.5" y="-76070.31" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="698.5" y="-76055.31" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_ffn_down_4&#45;&gt;layer40_ffn_ar -->
<g id="edge1326" class="edge">
<title>layer40_ffn_down_4&#45;&gt;layer40_ffn_ar</title>
<path fill="none" stroke="black" d="M628.69,-76201.4C628.69,-76201.4 628.69,-76131.06 628.69,-76131.06"/>
<polygon fill="black" stroke="black" points="632.19,-76131.06 628.69,-76121.06 625.19,-76131.06 632.19,-76131.06"/>
</g>
<!-- layer40_ffn_down_5&#45;&gt;layer40_ffn_ar -->
<g id="edge1327" class="edge">
<title>layer40_ffn_down_5&#45;&gt;layer40_ffn_ar</title>
<path fill="none" stroke="black" d="M769.31,-76201.4C769.31,-76201.4 769.31,-76130.78 769.31,-76130.78"/>
<polygon fill="black" stroke="black" points="772.81,-76130.78 769.31,-76120.78 765.81,-76130.78 772.81,-76130.78"/>
</g>
<!-- layer41_norm_4 -->
<g id="node1041" class="node">
<title>layer41_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="680.5,-75961.43 508.5,-75961.43 508.5,-75893.43 680.5,-75893.43 680.5,-75961.43"/>
<text text-anchor="middle" x="594.5" y="-75946.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="594.5" y="-75931.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="594.5" y="-75916.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="594.5" y="-75901.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_ffn_ar&#45;&gt;layer41_norm_4 -->
<g id="edge1328" class="edge">
<title>layer40_ffn_ar&#45;&gt;layer41_norm_4</title>
<path fill="none" stroke="black" d="M628.69,-76041.83C628.69,-76041.83 628.69,-75971.49 628.69,-75971.49"/>
<polygon fill="black" stroke="black" points="632.19,-75971.49 628.69,-75961.49 625.19,-75971.49 632.19,-75971.49"/>
</g>
<!-- layer41_norm_5 -->
<g id="node1042" class="node">
<title>layer41_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="890.5,-75961.43 718.5,-75961.43 718.5,-75893.43 890.5,-75893.43 890.5,-75961.43"/>
<text text-anchor="middle" x="804.5" y="-75946.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="804.5" y="-75931.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="804.5" y="-75916.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="804.5" y="-75901.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer40_ffn_ar&#45;&gt;layer41_norm_5 -->
<g id="edge1329" class="edge">
<title>layer40_ffn_ar&#45;&gt;layer41_norm_5</title>
<path fill="none" stroke="black" d="M769.31,-76042.23C769.31,-76042.23 769.31,-75971.66 769.31,-75971.66"/>
<polygon fill="black" stroke="black" points="772.81,-75971.66 769.31,-75961.66 765.81,-75971.66 772.81,-75971.66"/>
</g>
<!-- layer41_qkv_4 -->
<g id="node1043" class="node">
<title>layer41_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="681,-75821.43 500,-75821.43 500,-75753.43 681,-75753.43 681,-75821.43"/>
<text text-anchor="middle" x="590.5" y="-75806.23" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="590.5" y="-75791.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="590.5" y="-75776.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="590.5" y="-75761.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer41_norm_4&#45;&gt;layer41_qkv_4 -->
<g id="edge1330" class="edge">
<title>layer41_norm_4&#45;&gt;layer41_qkv_4</title>
<path fill="none" stroke="black" d="M594.5,-75893.18C594.5,-75893.18 594.5,-75831.81 594.5,-75831.81"/>
<polygon fill="black" stroke="black" points="598,-75831.81 594.5,-75821.81 591,-75831.81 598,-75831.81"/>
</g>
<!-- layer41_qkv_5 -->
<g id="node1044" class="node">
<title>layer41_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="898,-75821.43 717,-75821.43 717,-75753.43 898,-75753.43 898,-75821.43"/>
<text text-anchor="middle" x="807.5" y="-75806.23" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="807.5" y="-75791.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="807.5" y="-75776.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="807.5" y="-75761.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer41_norm_5&#45;&gt;layer41_qkv_5 -->
<g id="edge1331" class="edge">
<title>layer41_norm_5&#45;&gt;layer41_qkv_5</title>
<path fill="none" stroke="black" d="M804.5,-75893.18C804.5,-75893.18 804.5,-75831.81 804.5,-75831.81"/>
<polygon fill="black" stroke="black" points="808,-75831.81 804.5,-75821.81 801,-75831.81 808,-75831.81"/>
</g>
<!-- layer41_qkv_ar -->
<g id="node1045" class="node">
<title>layer41_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="698.5" cy="-75633.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="698.5" y="-75652.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="698.5" y="-75637.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="698.5" y="-75622.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="698.5" y="-75607.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer41_qkv_4&#45;&gt;layer41_qkv_ar -->
<g id="edge1332" class="edge">
<title>layer41_qkv_4&#45;&gt;layer41_qkv_ar</title>
<path fill="none" stroke="black" d="M625.76,-75753.23C625.76,-75753.23 625.76,-75683.17 625.76,-75683.17"/>
<polygon fill="black" stroke="black" points="629.26,-75683.17 625.76,-75673.17 622.26,-75683.17 629.26,-75683.17"/>
</g>
<!-- layer41_qkv_5&#45;&gt;layer41_qkv_ar -->
<g id="edge1333" class="edge">
<title>layer41_qkv_5&#45;&gt;layer41_qkv_ar</title>
<path fill="none" stroke="black" d="M771.74,-75753.23C771.74,-75753.23 771.74,-75682.89 771.74,-75682.89"/>
<polygon fill="black" stroke="black" points="775.24,-75682.89 771.74,-75672.89 768.24,-75682.89 775.24,-75682.89"/>
</g>
<!-- layer41_attn_4 -->
<g id="node1046" class="node">
<title>layer41_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="680.5,-75513.26 508.5,-75513.26 508.5,-75445.26 680.5,-75445.26 680.5,-75513.26"/>
<text text-anchor="middle" x="594.5" y="-75498.06" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="594.5" y="-75483.06" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="594.5" y="-75468.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="594.5" y="-75453.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer41_qkv_ar&#45;&gt;layer41_attn_4 -->
<g id="edge1334" class="edge">
<title>layer41_qkv_ar&#45;&gt;layer41_attn_4</title>
<path fill="none" stroke="black" d="M625.51,-75593.67C625.51,-75593.67 625.51,-75523.32 625.51,-75523.32"/>
<polygon fill="black" stroke="black" points="629.01,-75523.32 625.51,-75513.32 622.01,-75523.32 629.01,-75523.32"/>
</g>
<!-- layer41_attn_5 -->
<g id="node1047" class="node">
<title>layer41_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="888.5,-75513.26 716.5,-75513.26 716.5,-75445.26 888.5,-75445.26 888.5,-75513.26"/>
<text text-anchor="middle" x="802.5" y="-75498.06" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="802.5" y="-75483.06" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="802.5" y="-75468.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="802.5" y="-75453.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer41_qkv_ar&#45;&gt;layer41_attn_5 -->
<g id="edge1335" class="edge">
<title>layer41_qkv_ar&#45;&gt;layer41_attn_5</title>
<path fill="none" stroke="black" d="M771.49,-75593.67C771.49,-75593.67 771.49,-75523.32 771.49,-75523.32"/>
<polygon fill="black" stroke="black" points="774.99,-75523.32 771.49,-75513.32 767.99,-75523.32 774.99,-75523.32"/>
</g>
<!-- layer41_attn_out_4 -->
<g id="node1048" class="node">
<title>layer41_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="680.5,-75373.26 508.5,-75373.26 508.5,-75305.26 680.5,-75305.26 680.5,-75373.26"/>
<text text-anchor="middle" x="594.5" y="-75358.06" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="594.5" y="-75343.06" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="594.5" y="-75328.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="594.5" y="-75313.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer41_attn_4&#45;&gt;layer41_attn_out_4 -->
<g id="edge1336" class="edge">
<title>layer41_attn_4&#45;&gt;layer41_attn_out_4</title>
<path fill="none" stroke="black" d="M594.5,-75445.02C594.5,-75445.02 594.5,-75383.64 594.5,-75383.64"/>
<polygon fill="black" stroke="black" points="598,-75383.64 594.5,-75373.64 591,-75383.64 598,-75383.64"/>
</g>
<!-- layer41_attn_out_5 -->
<g id="node1049" class="node">
<title>layer41_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="888.5,-75373.26 716.5,-75373.26 716.5,-75305.26 888.5,-75305.26 888.5,-75373.26"/>
<text text-anchor="middle" x="802.5" y="-75358.06" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="802.5" y="-75343.06" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="802.5" y="-75328.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="802.5" y="-75313.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer41_attn_5&#45;&gt;layer41_attn_out_5 -->
<g id="edge1337" class="edge">
<title>layer41_attn_5&#45;&gt;layer41_attn_out_5</title>
<path fill="none" stroke="black" d="M802.5,-75445.02C802.5,-75445.02 802.5,-75383.64 802.5,-75383.64"/>
<polygon fill="black" stroke="black" points="806,-75383.64 802.5,-75373.64 799,-75383.64 806,-75383.64"/>
</g>
<!-- layer41_attn_ar -->
<g id="node1050" class="node">
<title>layer41_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="698.5" cy="-75185.18" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="698.5" y="-75203.98" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="698.5" y="-75188.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="698.5" y="-75173.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="698.5" y="-75158.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer41_attn_out_4&#45;&gt;layer41_attn_ar -->
<g id="edge1338" class="edge">
<title>layer41_attn_out_4&#45;&gt;layer41_attn_ar</title>
<path fill="none" stroke="black" d="M628.69,-75305.07C628.69,-75305.07 628.69,-75234.72 628.69,-75234.72"/>
<polygon fill="black" stroke="black" points="632.19,-75234.72 628.69,-75224.72 625.19,-75234.72 632.19,-75234.72"/>
</g>
<!-- layer41_attn_out_5&#45;&gt;layer41_attn_ar -->
<g id="edge1339" class="edge">
<title>layer41_attn_out_5&#45;&gt;layer41_attn_ar</title>
<path fill="none" stroke="black" d="M768.31,-75305.07C768.31,-75305.07 768.31,-75234.72 768.31,-75234.72"/>
<polygon fill="black" stroke="black" points="771.81,-75234.72 768.31,-75224.72 764.81,-75234.72 771.81,-75234.72"/>
</g>
<!-- layer41_ffn_norm_4 -->
<g id="node1051" class="node">
<title>layer41_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="676.5,-75065.1 504.5,-75065.1 504.5,-74997.1 676.5,-74997.1 676.5,-75065.1"/>
<text text-anchor="middle" x="590.5" y="-75049.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="590.5" y="-75034.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="590.5" y="-75019.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="590.5" y="-75004.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer41_attn_ar&#45;&gt;layer41_ffn_norm_4 -->
<g id="edge1340" class="edge">
<title>layer41_attn_ar&#45;&gt;layer41_ffn_norm_4</title>
<path fill="none" stroke="black" d="M626.69,-75146.3C626.69,-75146.3 626.69,-75075.25 626.69,-75075.25"/>
<polygon fill="black" stroke="black" points="630.19,-75075.25 626.69,-75065.25 623.19,-75075.25 630.19,-75075.25"/>
</g>
<!-- layer41_ffn_norm_5 -->
<g id="node1052" class="node">
<title>layer41_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="893.5,-75065.1 721.5,-75065.1 721.5,-74997.1 893.5,-74997.1 893.5,-75065.1"/>
<text text-anchor="middle" x="807.5" y="-75049.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="807.5" y="-75034.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="807.5" y="-75019.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="807.5" y="-75004.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer41_attn_ar&#45;&gt;layer41_ffn_norm_5 -->
<g id="edge1341" class="edge">
<title>layer41_attn_ar&#45;&gt;layer41_ffn_norm_5</title>
<path fill="none" stroke="black" d="M770.81,-75146.3C770.81,-75146.3 770.81,-75075.25 770.81,-75075.25"/>
<polygon fill="black" stroke="black" points="774.31,-75075.25 770.81,-75065.25 767.31,-75075.25 774.31,-75075.25"/>
</g>
<!-- layer41_ffn_gate_4 -->
<g id="node1053" class="node">
<title>layer41_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="681,-74925.1 500,-74925.1 500,-74857.1 681,-74857.1 681,-74925.1"/>
<text text-anchor="middle" x="590.5" y="-74909.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="590.5" y="-74894.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="590.5" y="-74879.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="590.5" y="-74864.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_ffn_norm_4&#45;&gt;layer41_ffn_gate_4 -->
<g id="edge1342" class="edge">
<title>layer41_ffn_norm_4&#45;&gt;layer41_ffn_gate_4</title>
<path fill="none" stroke="black" d="M590.5,-74996.85C590.5,-74996.85 590.5,-74935.48 590.5,-74935.48"/>
<polygon fill="black" stroke="black" points="594,-74935.48 590.5,-74925.48 587,-74935.48 594,-74935.48"/>
</g>
<!-- layer41_ffn_up_4 -->
<g id="node1055" class="node">
<title>layer41_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="464,-74925.1 283,-74925.1 283,-74857.1 464,-74857.1 464,-74925.1"/>
<text text-anchor="middle" x="373.5" y="-74909.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="373.5" y="-74894.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="373.5" y="-74879.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="373.5" y="-74864.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_ffn_norm_4&#45;&gt;layer41_ffn_up_4 -->
<g id="edge1344" class="edge">
<title>layer41_ffn_norm_4&#45;&gt;layer41_ffn_up_4</title>
<path fill="none" stroke="black" d="M504.1,-75031C464.94,-75031 427.26,-75031 427.26,-75031 427.26,-75031 427.26,-74935.32 427.26,-74935.32"/>
<polygon fill="black" stroke="black" points="430.76,-74935.32 427.26,-74925.32 423.76,-74935.32 430.76,-74935.32"/>
</g>
<!-- layer41_ffn_gate_5 -->
<g id="node1054" class="node">
<title>layer41_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1115,-74925.1 934,-74925.1 934,-74857.1 1115,-74857.1 1115,-74925.1"/>
<text text-anchor="middle" x="1024.5" y="-74909.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1024.5" y="-74894.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1024.5" y="-74879.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1024.5" y="-74864.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_ffn_norm_5&#45;&gt;layer41_ffn_gate_5 -->
<g id="edge1343" class="edge">
<title>layer41_ffn_norm_5&#45;&gt;layer41_ffn_gate_5</title>
<path fill="none" stroke="black" d="M893.82,-75031C933.33,-75031 971.5,-75031 971.5,-75031 971.5,-75031 971.5,-74935.32 971.5,-74935.32"/>
<polygon fill="black" stroke="black" points="975,-74935.32 971.5,-74925.32 968,-74935.32 975,-74935.32"/>
</g>
<!-- layer41_ffn_up_5 -->
<g id="node1056" class="node">
<title>layer41_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="898,-74925.1 717,-74925.1 717,-74857.1 898,-74857.1 898,-74925.1"/>
<text text-anchor="middle" x="807.5" y="-74909.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="807.5" y="-74894.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="807.5" y="-74879.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="807.5" y="-74864.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_ffn_norm_5&#45;&gt;layer41_ffn_up_5 -->
<g id="edge1345" class="edge">
<title>layer41_ffn_norm_5&#45;&gt;layer41_ffn_up_5</title>
<path fill="none" stroke="black" d="M807.5,-74996.85C807.5,-74996.85 807.5,-74935.48 807.5,-74935.48"/>
<polygon fill="black" stroke="black" points="811,-74935.48 807.5,-74925.48 804,-74935.48 811,-74935.48"/>
</g>
<!-- layer41_gate_ar -->
<g id="node1057" class="node">
<title>layer41_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="898.5" cy="-74737.01" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="898.5" y="-74755.81" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="898.5" y="-74740.81" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="898.5" y="-74725.81" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="898.5" y="-74710.81" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer41_ffn_gate_4&#45;&gt;layer41_gate_ar -->
<g id="edge1346" class="edge">
<title>layer41_ffn_gate_4&#45;&gt;layer41_gate_ar</title>
<path fill="none" stroke="black" d="M681.08,-74891C691.79,-74891 699,-74891 699,-74891 699,-74891 699,-74753 699,-74753 699,-74753 767.56,-74753 767.56,-74753"/>
<polygon fill="black" stroke="black" points="767.56,-74756.5 777.56,-74753 767.56,-74749.5 767.56,-74756.5"/>
</g>
<!-- layer41_ffn_gate_5&#45;&gt;layer41_gate_ar -->
<g id="edge1347" class="edge">
<title>layer41_ffn_gate_5&#45;&gt;layer41_gate_ar</title>
<path fill="none" stroke="black" d="M980.24,-74856.9C980.24,-74856.9 980.24,-74784.08 980.24,-74784.08"/>
<polygon fill="black" stroke="black" points="983.74,-74784.08 980.24,-74774.08 976.74,-74784.08 983.74,-74784.08"/>
</g>
<!-- layer41_up_ar -->
<g id="node1058" class="node">
<title>layer41_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="552.5" cy="-74737.01" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="552.5" y="-74755.81" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="552.5" y="-74740.81" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="552.5" y="-74725.81" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="552.5" y="-74710.81" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer41_ffn_up_4&#45;&gt;layer41_up_ar -->
<g id="edge1348" class="edge">
<title>layer41_ffn_up_4&#45;&gt;layer41_up_ar</title>
<path fill="none" stroke="black" d="M444.26,-74856.9C444.26,-74856.9 444.26,-74772.98 444.26,-74772.98"/>
<polygon fill="black" stroke="black" points="447.76,-74772.98 444.26,-74762.98 440.76,-74772.98 447.76,-74772.98"/>
</g>
<!-- layer41_ffn_up_5&#45;&gt;layer41_up_ar -->
<g id="edge1349" class="edge">
<title>layer41_ffn_up_5&#45;&gt;layer41_up_ar</title>
<path fill="none" stroke="black" d="M743.76,-74856.88C743.76,-74806.95 743.76,-74720 743.76,-74720 743.76,-74720 682.27,-74720 682.27,-74720"/>
<polygon fill="black" stroke="black" points="682.27,-74716.5 672.27,-74720 682.27,-74723.5 682.27,-74716.5"/>
</g>
<!-- layer41_silu_4 -->
<g id="node1059" class="node">
<title>layer41_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="826,-74616.93 645,-74616.93 645,-74548.93 826,-74548.93 826,-74616.93"/>
<text text-anchor="middle" x="735.5" y="-74601.73" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="735.5" y="-74586.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="735.5" y="-74571.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="735.5" y="-74556.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_gate_ar&#45;&gt;layer41_silu_4 -->
<g id="edge1350" class="edge">
<title>layer41_gate_ar&#45;&gt;layer41_silu_4</title>
<path fill="none" stroke="black" d="M798.26,-74706.94C798.26,-74706.94 798.26,-74626.95 798.26,-74626.95"/>
<polygon fill="black" stroke="black" points="801.76,-74626.95 798.26,-74616.95 794.76,-74626.95 801.76,-74626.95"/>
</g>
<!-- layer41_silu_5 -->
<g id="node1060" class="node">
<title>layer41_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1043,-74616.93 862,-74616.93 862,-74548.93 1043,-74548.93 1043,-74616.93"/>
<text text-anchor="middle" x="952.5" y="-74601.73" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="952.5" y="-74586.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="952.5" y="-74571.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="952.5" y="-74556.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_gate_ar&#45;&gt;layer41_silu_5 -->
<g id="edge1351" class="edge">
<title>layer41_gate_ar&#45;&gt;layer41_silu_5</title>
<path fill="none" stroke="black" d="M944.24,-74692.03C944.24,-74692.03 944.24,-74626.94 944.24,-74626.94"/>
<polygon fill="black" stroke="black" points="947.74,-74626.94 944.24,-74616.94 940.74,-74626.94 947.74,-74626.94"/>
</g>
<!-- layer41_mul_4 -->
<g id="node1061" class="node">
<title>layer41_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="716,-74476.93 535,-74476.93 535,-74408.93 716,-74408.93 716,-74476.93"/>
<text text-anchor="middle" x="625.5" y="-74461.73" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="625.5" y="-74446.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="625.5" y="-74431.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="625.5" y="-74416.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_up_ar&#45;&gt;layer41_mul_4 -->
<g id="edge1353" class="edge">
<title>layer41_up_ar&#45;&gt;layer41_mul_4</title>
<path fill="none" stroke="black" d="M590,-74690.74C590,-74690.74 590,-74487.02 590,-74487.02"/>
<polygon fill="black" stroke="black" points="593.5,-74487.02 590,-74477.02 586.5,-74487.02 593.5,-74487.02"/>
</g>
<!-- layer41_mul_5 -->
<g id="node1062" class="node">
<title>layer41_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="933,-74476.93 752,-74476.93 752,-74408.93 933,-74408.93 933,-74476.93"/>
<text text-anchor="middle" x="842.5" y="-74461.73" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="842.5" y="-74446.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="842.5" y="-74431.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="842.5" y="-74416.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer41_up_ar&#45;&gt;layer41_mul_5 -->
<g id="edge1355" class="edge">
<title>layer41_up_ar&#45;&gt;layer41_mul_5</title>
<path fill="none" stroke="black" d="M662.74,-74712.42C662.74,-74687.32 662.74,-74652 662.74,-74652 662.74,-74652 844,-74652 844,-74652 844,-74652 844,-74486.99 844,-74486.99"/>
<polygon fill="black" stroke="black" points="847.5,-74486.99 844,-74476.99 840.5,-74486.99 847.5,-74486.99"/>
</g>
<!-- layer41_silu_4&#45;&gt;layer41_mul_4 -->
<g id="edge1352" class="edge">
<title>layer41_silu_4&#45;&gt;layer41_mul_4</title>
<path fill="none" stroke="black" d="M680.5,-74548.68C680.5,-74548.68 680.5,-74487.31 680.5,-74487.31"/>
<polygon fill="black" stroke="black" points="684,-74487.31 680.5,-74477.31 677,-74487.31 684,-74487.31"/>
</g>
<!-- layer41_silu_5&#45;&gt;layer41_mul_5 -->
<g id="edge1354" class="edge">
<title>layer41_silu_5&#45;&gt;layer41_mul_5</title>
<path fill="none" stroke="black" d="M897.5,-74548.68C897.5,-74548.68 897.5,-74487.31 897.5,-74487.31"/>
<polygon fill="black" stroke="black" points="901,-74487.31 897.5,-74477.31 894,-74487.31 901,-74487.31"/>
</g>
<!-- layer41_ffn_down_4 -->
<g id="node1063" class="node">
<title>layer41_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="714.5,-74336.93 542.5,-74336.93 542.5,-74268.93 714.5,-74268.93 714.5,-74336.93"/>
<text text-anchor="middle" x="628.5" y="-74321.73" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="628.5" y="-74306.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="628.5" y="-74291.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="628.5" y="-74276.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer41_mul_4&#45;&gt;layer41_ffn_down_4 -->
<g id="edge1356" class="edge">
<title>layer41_mul_4&#45;&gt;layer41_ffn_down_4</title>
<path fill="none" stroke="black" d="M628.5,-74408.68C628.5,-74408.68 628.5,-74347.31 628.5,-74347.31"/>
<polygon fill="black" stroke="black" points="632,-74347.31 628.5,-74337.31 625,-74347.31 632,-74347.31"/>
</g>
<!-- layer41_ffn_down_5 -->
<g id="node1064" class="node">
<title>layer41_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="924.5,-74336.93 752.5,-74336.93 752.5,-74268.93 924.5,-74268.93 924.5,-74336.93"/>
<text text-anchor="middle" x="838.5" y="-74321.73" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="838.5" y="-74306.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="838.5" y="-74291.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="838.5" y="-74276.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer41_mul_5&#45;&gt;layer41_ffn_down_5 -->
<g id="edge1357" class="edge">
<title>layer41_mul_5&#45;&gt;layer41_ffn_down_5</title>
<path fill="none" stroke="black" d="M838.5,-74408.68C838.5,-74408.68 838.5,-74347.31 838.5,-74347.31"/>
<polygon fill="black" stroke="black" points="842,-74347.31 838.5,-74337.31 835,-74347.31 842,-74347.31"/>
</g>
<!-- layer41_ffn_ar -->
<g id="node1065" class="node">
<title>layer41_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="732.5" cy="-74148.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="732.5" y="-74167.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="732.5" y="-74152.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="732.5" y="-74137.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="732.5" y="-74122.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer41_ffn_down_4&#45;&gt;layer41_ffn_ar -->
<g id="edge1358" class="edge">
<title>layer41_ffn_down_4&#45;&gt;layer41_ffn_ar</title>
<path fill="none" stroke="black" d="M662.69,-74268.73C662.69,-74268.73 662.69,-74198.39 662.69,-74198.39"/>
<polygon fill="black" stroke="black" points="666.19,-74198.39 662.69,-74188.39 659.19,-74198.39 666.19,-74198.39"/>
</g>
<!-- layer41_ffn_down_5&#45;&gt;layer41_ffn_ar -->
<g id="edge1359" class="edge">
<title>layer41_ffn_down_5&#45;&gt;layer41_ffn_ar</title>
<path fill="none" stroke="black" d="M803.31,-74268.73C803.31,-74268.73 803.31,-74198.11 803.31,-74198.11"/>
<polygon fill="black" stroke="black" points="806.81,-74198.11 803.31,-74188.11 799.81,-74198.11 806.81,-74198.11"/>
</g>
<!-- layer42_norm_4 -->
<g id="node1066" class="node">
<title>layer42_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="714.5,-74028.76 542.5,-74028.76 542.5,-73960.76 714.5,-73960.76 714.5,-74028.76"/>
<text text-anchor="middle" x="628.5" y="-74013.56" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="628.5" y="-73998.56" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="628.5" y="-73983.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="628.5" y="-73968.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer41_ffn_ar&#45;&gt;layer42_norm_4 -->
<g id="edge1360" class="edge">
<title>layer41_ffn_ar&#45;&gt;layer42_norm_4</title>
<path fill="none" stroke="black" d="M662.69,-74109.17C662.69,-74109.17 662.69,-74038.82 662.69,-74038.82"/>
<polygon fill="black" stroke="black" points="666.19,-74038.82 662.69,-74028.82 659.19,-74038.82 666.19,-74038.82"/>
</g>
<!-- layer42_norm_5 -->
<g id="node1067" class="node">
<title>layer42_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="924.5,-74028.76 752.5,-74028.76 752.5,-73960.76 924.5,-73960.76 924.5,-74028.76"/>
<text text-anchor="middle" x="838.5" y="-74013.56" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="838.5" y="-73998.56" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="838.5" y="-73983.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="838.5" y="-73968.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer41_ffn_ar&#45;&gt;layer42_norm_5 -->
<g id="edge1361" class="edge">
<title>layer41_ffn_ar&#45;&gt;layer42_norm_5</title>
<path fill="none" stroke="black" d="M803.31,-74109.57C803.31,-74109.57 803.31,-74039 803.31,-74039"/>
<polygon fill="black" stroke="black" points="806.81,-74039 803.31,-74029 799.81,-74039 806.81,-74039"/>
</g>
<!-- layer42_qkv_4 -->
<g id="node1068" class="node">
<title>layer42_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="715,-73888.76 534,-73888.76 534,-73820.76 715,-73820.76 715,-73888.76"/>
<text text-anchor="middle" x="624.5" y="-73873.56" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="624.5" y="-73858.56" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="624.5" y="-73843.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="624.5" y="-73828.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer42_norm_4&#45;&gt;layer42_qkv_4 -->
<g id="edge1362" class="edge">
<title>layer42_norm_4&#45;&gt;layer42_qkv_4</title>
<path fill="none" stroke="black" d="M628.5,-73960.52C628.5,-73960.52 628.5,-73899.14 628.5,-73899.14"/>
<polygon fill="black" stroke="black" points="632,-73899.14 628.5,-73889.14 625,-73899.14 632,-73899.14"/>
</g>
<!-- layer42_qkv_5 -->
<g id="node1069" class="node">
<title>layer42_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="932,-73888.76 751,-73888.76 751,-73820.76 932,-73820.76 932,-73888.76"/>
<text text-anchor="middle" x="841.5" y="-73873.56" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="841.5" y="-73858.56" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="841.5" y="-73843.56" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="841.5" y="-73828.56" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer42_norm_5&#45;&gt;layer42_qkv_5 -->
<g id="edge1363" class="edge">
<title>layer42_norm_5&#45;&gt;layer42_qkv_5</title>
<path fill="none" stroke="black" d="M838.5,-73960.52C838.5,-73960.52 838.5,-73899.14 838.5,-73899.14"/>
<polygon fill="black" stroke="black" points="842,-73899.14 838.5,-73889.14 835,-73899.14 842,-73899.14"/>
</g>
<!-- layer42_qkv_ar -->
<g id="node1070" class="node">
<title>layer42_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="732.5" cy="-73700.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="732.5" y="-73719.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="732.5" y="-73704.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="732.5" y="-73689.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="732.5" y="-73674.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer42_qkv_4&#45;&gt;layer42_qkv_ar -->
<g id="edge1364" class="edge">
<title>layer42_qkv_4&#45;&gt;layer42_qkv_ar</title>
<path fill="none" stroke="black" d="M659.76,-73820.57C659.76,-73820.57 659.76,-73750.5 659.76,-73750.5"/>
<polygon fill="black" stroke="black" points="663.26,-73750.5 659.76,-73740.5 656.26,-73750.5 663.26,-73750.5"/>
</g>
<!-- layer42_qkv_5&#45;&gt;layer42_qkv_ar -->
<g id="edge1365" class="edge">
<title>layer42_qkv_5&#45;&gt;layer42_qkv_ar</title>
<path fill="none" stroke="black" d="M805.74,-73820.57C805.74,-73820.57 805.74,-73750.22 805.74,-73750.22"/>
<polygon fill="black" stroke="black" points="809.24,-73750.22 805.74,-73740.22 802.24,-73750.22 809.24,-73750.22"/>
</g>
<!-- layer42_attn_4 -->
<g id="node1071" class="node">
<title>layer42_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="714.5,-73580.6 542.5,-73580.6 542.5,-73512.6 714.5,-73512.6 714.5,-73580.6"/>
<text text-anchor="middle" x="628.5" y="-73565.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="628.5" y="-73550.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="628.5" y="-73535.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="628.5" y="-73520.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer42_qkv_ar&#45;&gt;layer42_attn_4 -->
<g id="edge1366" class="edge">
<title>layer42_qkv_ar&#45;&gt;layer42_attn_4</title>
<path fill="none" stroke="black" d="M659.51,-73661C659.51,-73661 659.51,-73590.65 659.51,-73590.65"/>
<polygon fill="black" stroke="black" points="663.01,-73590.65 659.51,-73580.65 656.01,-73590.65 663.01,-73590.65"/>
</g>
<!-- layer42_attn_5 -->
<g id="node1072" class="node">
<title>layer42_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="922.5,-73580.6 750.5,-73580.6 750.5,-73512.6 922.5,-73512.6 922.5,-73580.6"/>
<text text-anchor="middle" x="836.5" y="-73565.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="836.5" y="-73550.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="836.5" y="-73535.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="836.5" y="-73520.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer42_qkv_ar&#45;&gt;layer42_attn_5 -->
<g id="edge1367" class="edge">
<title>layer42_qkv_ar&#45;&gt;layer42_attn_5</title>
<path fill="none" stroke="black" d="M805.49,-73661C805.49,-73661 805.49,-73590.65 805.49,-73590.65"/>
<polygon fill="black" stroke="black" points="808.99,-73590.65 805.49,-73580.65 801.99,-73590.65 808.99,-73590.65"/>
</g>
<!-- layer42_attn_out_4 -->
<g id="node1073" class="node">
<title>layer42_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="714.5,-73440.6 542.5,-73440.6 542.5,-73372.6 714.5,-73372.6 714.5,-73440.6"/>
<text text-anchor="middle" x="628.5" y="-73425.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="628.5" y="-73410.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="628.5" y="-73395.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="628.5" y="-73380.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer42_attn_4&#45;&gt;layer42_attn_out_4 -->
<g id="edge1368" class="edge">
<title>layer42_attn_4&#45;&gt;layer42_attn_out_4</title>
<path fill="none" stroke="black" d="M628.5,-73512.35C628.5,-73512.35 628.5,-73450.98 628.5,-73450.98"/>
<polygon fill="black" stroke="black" points="632,-73450.98 628.5,-73440.98 625,-73450.98 632,-73450.98"/>
</g>
<!-- layer42_attn_out_5 -->
<g id="node1074" class="node">
<title>layer42_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="922.5,-73440.6 750.5,-73440.6 750.5,-73372.6 922.5,-73372.6 922.5,-73440.6"/>
<text text-anchor="middle" x="836.5" y="-73425.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="836.5" y="-73410.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="836.5" y="-73395.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="836.5" y="-73380.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer42_attn_5&#45;&gt;layer42_attn_out_5 -->
<g id="edge1369" class="edge">
<title>layer42_attn_5&#45;&gt;layer42_attn_out_5</title>
<path fill="none" stroke="black" d="M836.5,-73512.35C836.5,-73512.35 836.5,-73450.98 836.5,-73450.98"/>
<polygon fill="black" stroke="black" points="840,-73450.98 836.5,-73440.98 833,-73450.98 840,-73450.98"/>
</g>
<!-- layer42_attn_ar -->
<g id="node1075" class="node">
<title>layer42_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="732.5" cy="-73252.51" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="732.5" y="-73271.31" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="732.5" y="-73256.31" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="732.5" y="-73241.31" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="732.5" y="-73226.31" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer42_attn_out_4&#45;&gt;layer42_attn_ar -->
<g id="edge1370" class="edge">
<title>layer42_attn_out_4&#45;&gt;layer42_attn_ar</title>
<path fill="none" stroke="black" d="M662.69,-73372.4C662.69,-73372.4 662.69,-73302.06 662.69,-73302.06"/>
<polygon fill="black" stroke="black" points="666.19,-73302.06 662.69,-73292.06 659.19,-73302.06 666.19,-73302.06"/>
</g>
<!-- layer42_attn_out_5&#45;&gt;layer42_attn_ar -->
<g id="edge1371" class="edge">
<title>layer42_attn_out_5&#45;&gt;layer42_attn_ar</title>
<path fill="none" stroke="black" d="M802.31,-73372.4C802.31,-73372.4 802.31,-73302.06 802.31,-73302.06"/>
<polygon fill="black" stroke="black" points="805.81,-73302.06 802.31,-73292.06 798.81,-73302.06 805.81,-73302.06"/>
</g>
<!-- layer42_ffn_norm_4 -->
<g id="node1076" class="node">
<title>layer42_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="710.5,-73132.43 538.5,-73132.43 538.5,-73064.43 710.5,-73064.43 710.5,-73132.43"/>
<text text-anchor="middle" x="624.5" y="-73117.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="624.5" y="-73102.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="624.5" y="-73087.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="624.5" y="-73072.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer42_attn_ar&#45;&gt;layer42_ffn_norm_4 -->
<g id="edge1372" class="edge">
<title>layer42_attn_ar&#45;&gt;layer42_ffn_norm_4</title>
<path fill="none" stroke="black" d="M660.69,-73213.63C660.69,-73213.63 660.69,-73142.58 660.69,-73142.58"/>
<polygon fill="black" stroke="black" points="664.19,-73142.58 660.69,-73132.58 657.19,-73142.58 664.19,-73142.58"/>
</g>
<!-- layer42_ffn_norm_5 -->
<g id="node1077" class="node">
<title>layer42_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="927.5,-73132.43 755.5,-73132.43 755.5,-73064.43 927.5,-73064.43 927.5,-73132.43"/>
<text text-anchor="middle" x="841.5" y="-73117.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="841.5" y="-73102.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="841.5" y="-73087.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="841.5" y="-73072.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer42_attn_ar&#45;&gt;layer42_ffn_norm_5 -->
<g id="edge1373" class="edge">
<title>layer42_attn_ar&#45;&gt;layer42_ffn_norm_5</title>
<path fill="none" stroke="black" d="M804.81,-73213.63C804.81,-73213.63 804.81,-73142.58 804.81,-73142.58"/>
<polygon fill="black" stroke="black" points="808.31,-73142.58 804.81,-73132.58 801.31,-73142.58 808.31,-73142.58"/>
</g>
<!-- layer42_ffn_gate_4 -->
<g id="node1078" class="node">
<title>layer42_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="715,-72992.43 534,-72992.43 534,-72924.43 715,-72924.43 715,-72992.43"/>
<text text-anchor="middle" x="624.5" y="-72977.23" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="624.5" y="-72962.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="624.5" y="-72947.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="624.5" y="-72932.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_ffn_norm_4&#45;&gt;layer42_ffn_gate_4 -->
<g id="edge1374" class="edge">
<title>layer42_ffn_norm_4&#45;&gt;layer42_ffn_gate_4</title>
<path fill="none" stroke="black" d="M624.5,-73064.18C624.5,-73064.18 624.5,-73002.81 624.5,-73002.81"/>
<polygon fill="black" stroke="black" points="628,-73002.81 624.5,-72992.81 621,-73002.81 628,-73002.81"/>
</g>
<!-- layer42_ffn_up_4 -->
<g id="node1080" class="node">
<title>layer42_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="498,-72992.43 317,-72992.43 317,-72924.43 498,-72924.43 498,-72992.43"/>
<text text-anchor="middle" x="407.5" y="-72977.23" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="407.5" y="-72962.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="407.5" y="-72947.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="407.5" y="-72932.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_ffn_norm_4&#45;&gt;layer42_ffn_up_4 -->
<g id="edge1376" class="edge">
<title>layer42_ffn_norm_4&#45;&gt;layer42_ffn_up_4</title>
<path fill="none" stroke="black" d="M538.1,-73098C498.94,-73098 461.26,-73098 461.26,-73098 461.26,-73098 461.26,-73002.57 461.26,-73002.57"/>
<polygon fill="black" stroke="black" points="464.76,-73002.57 461.26,-72992.57 457.76,-73002.57 464.76,-73002.57"/>
</g>
<!-- layer42_ffn_gate_5 -->
<g id="node1079" class="node">
<title>layer42_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1149,-72992.43 968,-72992.43 968,-72924.43 1149,-72924.43 1149,-72992.43"/>
<text text-anchor="middle" x="1058.5" y="-72977.23" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1058.5" y="-72962.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1058.5" y="-72947.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1058.5" y="-72932.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_ffn_norm_5&#45;&gt;layer42_ffn_gate_5 -->
<g id="edge1375" class="edge">
<title>layer42_ffn_norm_5&#45;&gt;layer42_ffn_gate_5</title>
<path fill="none" stroke="black" d="M927.82,-73098C967.33,-73098 1005.5,-73098 1005.5,-73098 1005.5,-73098 1005.5,-73002.57 1005.5,-73002.57"/>
<polygon fill="black" stroke="black" points="1009,-73002.57 1005.5,-72992.57 1002,-73002.57 1009,-73002.57"/>
</g>
<!-- layer42_ffn_up_5 -->
<g id="node1081" class="node">
<title>layer42_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="932,-72992.43 751,-72992.43 751,-72924.43 932,-72924.43 932,-72992.43"/>
<text text-anchor="middle" x="841.5" y="-72977.23" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="841.5" y="-72962.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="841.5" y="-72947.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="841.5" y="-72932.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_ffn_norm_5&#45;&gt;layer42_ffn_up_5 -->
<g id="edge1377" class="edge">
<title>layer42_ffn_norm_5&#45;&gt;layer42_ffn_up_5</title>
<path fill="none" stroke="black" d="M841.5,-73064.18C841.5,-73064.18 841.5,-73002.81 841.5,-73002.81"/>
<polygon fill="black" stroke="black" points="845,-73002.81 841.5,-72992.81 838,-73002.81 845,-73002.81"/>
</g>
<!-- layer42_gate_ar -->
<g id="node1082" class="node">
<title>layer42_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="932.5" cy="-72804.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="932.5" y="-72823.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="932.5" y="-72808.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="932.5" y="-72793.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="932.5" y="-72778.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer42_ffn_gate_4&#45;&gt;layer42_gate_ar -->
<g id="edge1378" class="edge">
<title>layer42_ffn_gate_4&#45;&gt;layer42_gate_ar</title>
<path fill="none" stroke="black" d="M715.08,-72958C725.79,-72958 733,-72958 733,-72958 733,-72958 733,-72820 733,-72820 733,-72820 801.28,-72820 801.28,-72820"/>
<polygon fill="black" stroke="black" points="801.28,-72823.5 811.28,-72820 801.28,-72816.5 801.28,-72823.5"/>
</g>
<!-- layer42_ffn_gate_5&#45;&gt;layer42_gate_ar -->
<g id="edge1379" class="edge">
<title>layer42_ffn_gate_5&#45;&gt;layer42_gate_ar</title>
<path fill="none" stroke="black" d="M1014.24,-72924.24C1014.24,-72924.24 1014.24,-72851.41 1014.24,-72851.41"/>
<polygon fill="black" stroke="black" points="1017.74,-72851.41 1014.24,-72841.41 1010.74,-72851.41 1017.74,-72851.41"/>
</g>
<!-- layer42_up_ar -->
<g id="node1083" class="node">
<title>layer42_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="586.5" cy="-72804.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="586.5" y="-72823.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="586.5" y="-72808.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="586.5" y="-72793.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="586.5" y="-72778.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer42_ffn_up_4&#45;&gt;layer42_up_ar -->
<g id="edge1380" class="edge">
<title>layer42_ffn_up_4&#45;&gt;layer42_up_ar</title>
<path fill="none" stroke="black" d="M478.26,-72924.24C478.26,-72924.24 478.26,-72840.31 478.26,-72840.31"/>
<polygon fill="black" stroke="black" points="481.76,-72840.31 478.26,-72830.31 474.76,-72840.31 481.76,-72840.31"/>
</g>
<!-- layer42_ffn_up_5&#45;&gt;layer42_up_ar -->
<g id="edge1381" class="edge">
<title>layer42_ffn_up_5&#45;&gt;layer42_up_ar</title>
<path fill="none" stroke="black" d="M777.76,-72924.35C777.76,-72874.62 777.76,-72788 777.76,-72788 777.76,-72788 717.08,-72788 717.08,-72788"/>
<polygon fill="black" stroke="black" points="717.08,-72784.5 707.08,-72788 717.08,-72791.5 717.08,-72784.5"/>
</g>
<!-- layer42_silu_4 -->
<g id="node1084" class="node">
<title>layer42_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="860,-72684.26 679,-72684.26 679,-72616.26 860,-72616.26 860,-72684.26"/>
<text text-anchor="middle" x="769.5" y="-72669.06" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="769.5" y="-72654.06" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="769.5" y="-72639.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="769.5" y="-72624.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_gate_ar&#45;&gt;layer42_silu_4 -->
<g id="edge1382" class="edge">
<title>layer42_gate_ar&#45;&gt;layer42_silu_4</title>
<path fill="none" stroke="black" d="M832.26,-72774.27C832.26,-72774.27 832.26,-72694.29 832.26,-72694.29"/>
<polygon fill="black" stroke="black" points="835.76,-72694.29 832.26,-72684.29 828.76,-72694.29 835.76,-72694.29"/>
</g>
<!-- layer42_silu_5 -->
<g id="node1085" class="node">
<title>layer42_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1077,-72684.26 896,-72684.26 896,-72616.26 1077,-72616.26 1077,-72684.26"/>
<text text-anchor="middle" x="986.5" y="-72669.06" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="986.5" y="-72654.06" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="986.5" y="-72639.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="986.5" y="-72624.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_gate_ar&#45;&gt;layer42_silu_5 -->
<g id="edge1383" class="edge">
<title>layer42_gate_ar&#45;&gt;layer42_silu_5</title>
<path fill="none" stroke="black" d="M978.24,-72759.37C978.24,-72759.37 978.24,-72694.27 978.24,-72694.27"/>
<polygon fill="black" stroke="black" points="981.74,-72694.27 978.24,-72684.27 974.74,-72694.27 981.74,-72694.27"/>
</g>
<!-- layer42_mul_4 -->
<g id="node1086" class="node">
<title>layer42_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="750,-72544.26 569,-72544.26 569,-72476.26 750,-72476.26 750,-72544.26"/>
<text text-anchor="middle" x="659.5" y="-72529.06" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="659.5" y="-72514.06" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="659.5" y="-72499.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="659.5" y="-72484.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_up_ar&#45;&gt;layer42_mul_4 -->
<g id="edge1385" class="edge">
<title>layer42_up_ar&#45;&gt;layer42_mul_4</title>
<path fill="none" stroke="black" d="M624,-72758.07C624,-72758.07 624,-72554.35 624,-72554.35"/>
<polygon fill="black" stroke="black" points="627.5,-72554.35 624,-72544.35 620.5,-72554.35 627.5,-72554.35"/>
</g>
<!-- layer42_mul_5 -->
<g id="node1087" class="node">
<title>layer42_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="967,-72544.26 786,-72544.26 786,-72476.26 967,-72476.26 967,-72544.26"/>
<text text-anchor="middle" x="876.5" y="-72529.06" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="876.5" y="-72514.06" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="876.5" y="-72499.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="876.5" y="-72484.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer42_up_ar&#45;&gt;layer42_mul_5 -->
<g id="edge1387" class="edge">
<title>layer42_up_ar&#45;&gt;layer42_mul_5</title>
<path fill="none" stroke="black" d="M696.74,-72779.5C696.74,-72754.62 696.74,-72720 696.74,-72720 696.74,-72720 878,-72720 878,-72720 878,-72720 878,-72554.43 878,-72554.43"/>
<polygon fill="black" stroke="black" points="881.5,-72554.43 878,-72544.43 874.5,-72554.43 881.5,-72554.43"/>
</g>
<!-- layer42_silu_4&#45;&gt;layer42_mul_4 -->
<g id="edge1384" class="edge">
<title>layer42_silu_4&#45;&gt;layer42_mul_4</title>
<path fill="none" stroke="black" d="M714.5,-72616.02C714.5,-72616.02 714.5,-72554.64 714.5,-72554.64"/>
<polygon fill="black" stroke="black" points="718,-72554.64 714.5,-72544.64 711,-72554.64 718,-72554.64"/>
</g>
<!-- layer42_silu_5&#45;&gt;layer42_mul_5 -->
<g id="edge1386" class="edge">
<title>layer42_silu_5&#45;&gt;layer42_mul_5</title>
<path fill="none" stroke="black" d="M931.5,-72616.02C931.5,-72616.02 931.5,-72554.64 931.5,-72554.64"/>
<polygon fill="black" stroke="black" points="935,-72554.64 931.5,-72544.64 928,-72554.64 935,-72554.64"/>
</g>
<!-- layer42_ffn_down_4 -->
<g id="node1088" class="node">
<title>layer42_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="749.5,-72404.26 577.5,-72404.26 577.5,-72336.26 749.5,-72336.26 749.5,-72404.26"/>
<text text-anchor="middle" x="663.5" y="-72389.06" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="663.5" y="-72374.06" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="663.5" y="-72359.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="663.5" y="-72344.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer42_mul_4&#45;&gt;layer42_ffn_down_4 -->
<g id="edge1388" class="edge">
<title>layer42_mul_4&#45;&gt;layer42_ffn_down_4</title>
<path fill="none" stroke="black" d="M663.5,-72476.02C663.5,-72476.02 663.5,-72414.64 663.5,-72414.64"/>
<polygon fill="black" stroke="black" points="667,-72414.64 663.5,-72404.64 660,-72414.64 667,-72414.64"/>
</g>
<!-- layer42_ffn_down_5 -->
<g id="node1089" class="node">
<title>layer42_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="959.5,-72404.26 787.5,-72404.26 787.5,-72336.26 959.5,-72336.26 959.5,-72404.26"/>
<text text-anchor="middle" x="873.5" y="-72389.06" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="873.5" y="-72374.06" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="873.5" y="-72359.06" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="873.5" y="-72344.06" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer42_mul_5&#45;&gt;layer42_ffn_down_5 -->
<g id="edge1389" class="edge">
<title>layer42_mul_5&#45;&gt;layer42_ffn_down_5</title>
<path fill="none" stroke="black" d="M873.5,-72476.02C873.5,-72476.02 873.5,-72414.64 873.5,-72414.64"/>
<polygon fill="black" stroke="black" points="877,-72414.64 873.5,-72404.64 870,-72414.64 877,-72414.64"/>
</g>
<!-- layer42_ffn_ar -->
<g id="node1090" class="node">
<title>layer42_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="767.5" cy="-72216.18" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="767.5" y="-72234.98" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="767.5" y="-72219.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="767.5" y="-72204.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="767.5" y="-72189.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer42_ffn_down_4&#45;&gt;layer42_ffn_ar -->
<g id="edge1390" class="edge">
<title>layer42_ffn_down_4&#45;&gt;layer42_ffn_ar</title>
<path fill="none" stroke="black" d="M697.69,-72336.07C697.69,-72336.07 697.69,-72265.72 697.69,-72265.72"/>
<polygon fill="black" stroke="black" points="701.19,-72265.72 697.69,-72255.72 694.19,-72265.72 701.19,-72265.72"/>
</g>
<!-- layer42_ffn_down_5&#45;&gt;layer42_ffn_ar -->
<g id="edge1391" class="edge">
<title>layer42_ffn_down_5&#45;&gt;layer42_ffn_ar</title>
<path fill="none" stroke="black" d="M838.31,-72336.07C838.31,-72336.07 838.31,-72265.45 838.31,-72265.45"/>
<polygon fill="black" stroke="black" points="841.81,-72265.45 838.31,-72255.45 834.81,-72265.45 841.81,-72265.45"/>
</g>
<!-- layer43_norm_4 -->
<g id="node1091" class="node">
<title>layer43_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="749.5,-72096.1 577.5,-72096.1 577.5,-72028.1 749.5,-72028.1 749.5,-72096.1"/>
<text text-anchor="middle" x="663.5" y="-72080.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="663.5" y="-72065.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="663.5" y="-72050.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="663.5" y="-72035.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer42_ffn_ar&#45;&gt;layer43_norm_4 -->
<g id="edge1392" class="edge">
<title>layer42_ffn_ar&#45;&gt;layer43_norm_4</title>
<path fill="none" stroke="black" d="M697.69,-72176.5C697.69,-72176.5 697.69,-72106.16 697.69,-72106.16"/>
<polygon fill="black" stroke="black" points="701.19,-72106.16 697.69,-72096.16 694.19,-72106.16 701.19,-72106.16"/>
</g>
<!-- layer43_norm_5 -->
<g id="node1092" class="node">
<title>layer43_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="959.5,-72096.1 787.5,-72096.1 787.5,-72028.1 959.5,-72028.1 959.5,-72096.1"/>
<text text-anchor="middle" x="873.5" y="-72080.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="873.5" y="-72065.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="873.5" y="-72050.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="873.5" y="-72035.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer42_ffn_ar&#45;&gt;layer43_norm_5 -->
<g id="edge1393" class="edge">
<title>layer42_ffn_ar&#45;&gt;layer43_norm_5</title>
<path fill="none" stroke="black" d="M838.31,-72176.9C838.31,-72176.9 838.31,-72106.33 838.31,-72106.33"/>
<polygon fill="black" stroke="black" points="841.81,-72106.33 838.31,-72096.33 834.81,-72106.33 841.81,-72106.33"/>
</g>
<!-- layer43_qkv_4 -->
<g id="node1093" class="node">
<title>layer43_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="750,-71956.1 569,-71956.1 569,-71888.1 750,-71888.1 750,-71956.1"/>
<text text-anchor="middle" x="659.5" y="-71940.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="659.5" y="-71925.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="659.5" y="-71910.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="659.5" y="-71895.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer43_norm_4&#45;&gt;layer43_qkv_4 -->
<g id="edge1394" class="edge">
<title>layer43_norm_4&#45;&gt;layer43_qkv_4</title>
<path fill="none" stroke="black" d="M663.5,-72027.85C663.5,-72027.85 663.5,-71966.48 663.5,-71966.48"/>
<polygon fill="black" stroke="black" points="667,-71966.48 663.5,-71956.48 660,-71966.48 667,-71966.48"/>
</g>
<!-- layer43_qkv_5 -->
<g id="node1094" class="node">
<title>layer43_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="967,-71956.1 786,-71956.1 786,-71888.1 967,-71888.1 967,-71956.1"/>
<text text-anchor="middle" x="876.5" y="-71940.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="876.5" y="-71925.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="876.5" y="-71910.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="876.5" y="-71895.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer43_norm_5&#45;&gt;layer43_qkv_5 -->
<g id="edge1395" class="edge">
<title>layer43_norm_5&#45;&gt;layer43_qkv_5</title>
<path fill="none" stroke="black" d="M873.5,-72027.85C873.5,-72027.85 873.5,-71966.48 873.5,-71966.48"/>
<polygon fill="black" stroke="black" points="877,-71966.48 873.5,-71956.48 870,-71966.48 877,-71966.48"/>
</g>
<!-- layer43_qkv_ar -->
<g id="node1095" class="node">
<title>layer43_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="768.5" cy="-71768.01" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="768.5" y="-71786.81" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="768.5" y="-71771.81" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="768.5" y="-71756.81" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="768.5" y="-71741.81" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer43_qkv_4&#45;&gt;layer43_qkv_ar -->
<g id="edge1396" class="edge">
<title>layer43_qkv_4&#45;&gt;layer43_qkv_ar</title>
<path fill="none" stroke="black" d="M695.26,-71887.9C695.26,-71887.9 695.26,-71817.56 695.26,-71817.56"/>
<polygon fill="black" stroke="black" points="698.76,-71817.56 695.26,-71807.56 691.76,-71817.56 698.76,-71817.56"/>
</g>
<!-- layer43_qkv_5&#45;&gt;layer43_qkv_ar -->
<g id="edge1397" class="edge">
<title>layer43_qkv_5&#45;&gt;layer43_qkv_ar</title>
<path fill="none" stroke="black" d="M841.24,-71887.9C841.24,-71887.9 841.24,-71817.84 841.24,-71817.84"/>
<polygon fill="black" stroke="black" points="844.74,-71817.84 841.24,-71807.84 837.74,-71817.84 844.74,-71817.84"/>
</g>
<!-- layer43_attn_4 -->
<g id="node1096" class="node">
<title>layer43_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="750.5,-71647.93 578.5,-71647.93 578.5,-71579.93 750.5,-71579.93 750.5,-71647.93"/>
<text text-anchor="middle" x="664.5" y="-71632.73" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="664.5" y="-71617.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="664.5" y="-71602.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="664.5" y="-71587.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer43_qkv_ar&#45;&gt;layer43_attn_4 -->
<g id="edge1398" class="edge">
<title>layer43_qkv_ar&#45;&gt;layer43_attn_4</title>
<path fill="none" stroke="black" d="M695.51,-71728.33C695.51,-71728.33 695.51,-71657.99 695.51,-71657.99"/>
<polygon fill="black" stroke="black" points="699.01,-71657.99 695.51,-71647.99 692.01,-71657.99 699.01,-71657.99"/>
</g>
<!-- layer43_attn_5 -->
<g id="node1097" class="node">
<title>layer43_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="958.5,-71647.93 786.5,-71647.93 786.5,-71579.93 958.5,-71579.93 958.5,-71647.93"/>
<text text-anchor="middle" x="872.5" y="-71632.73" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="872.5" y="-71617.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="872.5" y="-71602.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="872.5" y="-71587.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer43_qkv_ar&#45;&gt;layer43_attn_5 -->
<g id="edge1399" class="edge">
<title>layer43_qkv_ar&#45;&gt;layer43_attn_5</title>
<path fill="none" stroke="black" d="M841.49,-71728.33C841.49,-71728.33 841.49,-71657.99 841.49,-71657.99"/>
<polygon fill="black" stroke="black" points="844.99,-71657.99 841.49,-71647.99 837.99,-71657.99 844.99,-71657.99"/>
</g>
<!-- layer43_attn_out_4 -->
<g id="node1098" class="node">
<title>layer43_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="750.5,-71507.93 578.5,-71507.93 578.5,-71439.93 750.5,-71439.93 750.5,-71507.93"/>
<text text-anchor="middle" x="664.5" y="-71492.73" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="664.5" y="-71477.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="664.5" y="-71462.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="664.5" y="-71447.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer43_attn_4&#45;&gt;layer43_attn_out_4 -->
<g id="edge1400" class="edge">
<title>layer43_attn_4&#45;&gt;layer43_attn_out_4</title>
<path fill="none" stroke="black" d="M664.5,-71579.68C664.5,-71579.68 664.5,-71518.31 664.5,-71518.31"/>
<polygon fill="black" stroke="black" points="668,-71518.31 664.5,-71508.31 661,-71518.31 668,-71518.31"/>
</g>
<!-- layer43_attn_out_5 -->
<g id="node1099" class="node">
<title>layer43_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="958.5,-71507.93 786.5,-71507.93 786.5,-71439.93 958.5,-71439.93 958.5,-71507.93"/>
<text text-anchor="middle" x="872.5" y="-71492.73" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="872.5" y="-71477.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="872.5" y="-71462.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="872.5" y="-71447.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer43_attn_5&#45;&gt;layer43_attn_out_5 -->
<g id="edge1401" class="edge">
<title>layer43_attn_5&#45;&gt;layer43_attn_out_5</title>
<path fill="none" stroke="black" d="M872.5,-71579.68C872.5,-71579.68 872.5,-71518.31 872.5,-71518.31"/>
<polygon fill="black" stroke="black" points="876,-71518.31 872.5,-71508.31 869,-71518.31 876,-71518.31"/>
</g>
<!-- layer43_attn_ar -->
<g id="node1100" class="node">
<title>layer43_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="768.5" cy="-71319.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="768.5" y="-71338.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="768.5" y="-71323.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="768.5" y="-71308.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="768.5" y="-71293.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer43_attn_out_4&#45;&gt;layer43_attn_ar -->
<g id="edge1402" class="edge">
<title>layer43_attn_out_4&#45;&gt;layer43_attn_ar</title>
<path fill="none" stroke="black" d="M698.69,-71439.74C698.69,-71439.74 698.69,-71369.39 698.69,-71369.39"/>
<polygon fill="black" stroke="black" points="702.19,-71369.39 698.69,-71359.39 695.19,-71369.39 702.19,-71369.39"/>
</g>
<!-- layer43_attn_out_5&#45;&gt;layer43_attn_ar -->
<g id="edge1403" class="edge">
<title>layer43_attn_out_5&#45;&gt;layer43_attn_ar</title>
<path fill="none" stroke="black" d="M838.31,-71439.74C838.31,-71439.74 838.31,-71369.39 838.31,-71369.39"/>
<polygon fill="black" stroke="black" points="841.81,-71369.39 838.31,-71359.39 834.81,-71369.39 841.81,-71369.39"/>
</g>
<!-- layer43_ffn_norm_4 -->
<g id="node1101" class="node">
<title>layer43_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="746.5,-71199.77 574.5,-71199.77 574.5,-71131.77 746.5,-71131.77 746.5,-71199.77"/>
<text text-anchor="middle" x="660.5" y="-71184.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="660.5" y="-71169.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="660.5" y="-71154.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="660.5" y="-71139.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer43_attn_ar&#45;&gt;layer43_ffn_norm_4 -->
<g id="edge1404" class="edge">
<title>layer43_attn_ar&#45;&gt;layer43_ffn_norm_4</title>
<path fill="none" stroke="black" d="M696.69,-71280.97C696.69,-71280.97 696.69,-71209.91 696.69,-71209.91"/>
<polygon fill="black" stroke="black" points="700.19,-71209.91 696.69,-71199.91 693.19,-71209.91 700.19,-71209.91"/>
</g>
<!-- layer43_ffn_norm_5 -->
<g id="node1102" class="node">
<title>layer43_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="963.5,-71199.77 791.5,-71199.77 791.5,-71131.77 963.5,-71131.77 963.5,-71199.77"/>
<text text-anchor="middle" x="877.5" y="-71184.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="877.5" y="-71169.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="877.5" y="-71154.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="877.5" y="-71139.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer43_attn_ar&#45;&gt;layer43_ffn_norm_5 -->
<g id="edge1405" class="edge">
<title>layer43_attn_ar&#45;&gt;layer43_ffn_norm_5</title>
<path fill="none" stroke="black" d="M840.81,-71280.97C840.81,-71280.97 840.81,-71209.91 840.81,-71209.91"/>
<polygon fill="black" stroke="black" points="844.31,-71209.91 840.81,-71199.91 837.31,-71209.91 844.31,-71209.91"/>
</g>
<!-- layer43_ffn_gate_4 -->
<g id="node1103" class="node">
<title>layer43_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="751,-71059.77 570,-71059.77 570,-70991.77 751,-70991.77 751,-71059.77"/>
<text text-anchor="middle" x="660.5" y="-71044.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="660.5" y="-71029.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="660.5" y="-71014.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="660.5" y="-70999.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_ffn_norm_4&#45;&gt;layer43_ffn_gate_4 -->
<g id="edge1406" class="edge">
<title>layer43_ffn_norm_4&#45;&gt;layer43_ffn_gate_4</title>
<path fill="none" stroke="black" d="M660.5,-71131.52C660.5,-71131.52 660.5,-71070.14 660.5,-71070.14"/>
<polygon fill="black" stroke="black" points="664,-71070.14 660.5,-71060.14 657,-71070.14 664,-71070.14"/>
</g>
<!-- layer43_ffn_up_4 -->
<g id="node1105" class="node">
<title>layer43_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="534,-71059.77 353,-71059.77 353,-70991.77 534,-70991.77 534,-71059.77"/>
<text text-anchor="middle" x="443.5" y="-71044.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="443.5" y="-71029.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="443.5" y="-71014.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="443.5" y="-70999.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_ffn_norm_4&#45;&gt;layer43_ffn_up_4 -->
<g id="edge1408" class="edge">
<title>layer43_ffn_norm_4&#45;&gt;layer43_ffn_up_4</title>
<path fill="none" stroke="black" d="M574.05,-71165C534.48,-71165 496.26,-71165 496.26,-71165 496.26,-71165 496.26,-71069.83 496.26,-71069.83"/>
<polygon fill="black" stroke="black" points="499.76,-71069.83 496.26,-71059.83 492.76,-71069.83 499.76,-71069.83"/>
</g>
<!-- layer43_ffn_gate_5 -->
<g id="node1104" class="node">
<title>layer43_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1185,-71059.77 1004,-71059.77 1004,-70991.77 1185,-70991.77 1185,-71059.77"/>
<text text-anchor="middle" x="1094.5" y="-71044.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1094.5" y="-71029.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1094.5" y="-71014.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1094.5" y="-70999.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_ffn_norm_5&#45;&gt;layer43_ffn_gate_5 -->
<g id="edge1407" class="edge">
<title>layer43_ffn_norm_5&#45;&gt;layer43_ffn_gate_5</title>
<path fill="none" stroke="black" d="M963.77,-71165C1002.87,-71165 1040.5,-71165 1040.5,-71165 1040.5,-71165 1040.5,-71069.83 1040.5,-71069.83"/>
<polygon fill="black" stroke="black" points="1044,-71069.83 1040.5,-71059.83 1037,-71069.83 1044,-71069.83"/>
</g>
<!-- layer43_ffn_up_5 -->
<g id="node1106" class="node">
<title>layer43_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="968,-71059.77 787,-71059.77 787,-70991.77 968,-70991.77 968,-71059.77"/>
<text text-anchor="middle" x="877.5" y="-71044.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="877.5" y="-71029.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="877.5" y="-71014.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="877.5" y="-70999.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_ffn_norm_5&#45;&gt;layer43_ffn_up_5 -->
<g id="edge1409" class="edge">
<title>layer43_ffn_norm_5&#45;&gt;layer43_ffn_up_5</title>
<path fill="none" stroke="black" d="M877.5,-71131.52C877.5,-71131.52 877.5,-71070.14 877.5,-71070.14"/>
<polygon fill="black" stroke="black" points="881,-71070.14 877.5,-71060.14 874,-71070.14 881,-71070.14"/>
</g>
<!-- layer43_gate_ar -->
<g id="node1107" class="node">
<title>layer43_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="968.5" cy="-70871.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="968.5" y="-70890.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="968.5" y="-70875.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="968.5" y="-70860.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="968.5" y="-70845.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer43_ffn_gate_4&#45;&gt;layer43_gate_ar -->
<g id="edge1410" class="edge">
<title>layer43_ffn_gate_4&#45;&gt;layer43_gate_ar</title>
<path fill="none" stroke="black" d="M751.08,-71025C761.79,-71025 769,-71025 769,-71025 769,-71025 769,-70887 769,-70887 769,-70887 836.99,-70887 836.99,-70887"/>
<polygon fill="black" stroke="black" points="836.99,-70890.5 846.99,-70887 836.99,-70883.5 836.99,-70890.5"/>
</g>
<!-- layer43_ffn_gate_5&#45;&gt;layer43_gate_ar -->
<g id="edge1411" class="edge">
<title>layer43_ffn_gate_5&#45;&gt;layer43_gate_ar</title>
<path fill="none" stroke="black" d="M1050.24,-70991.57C1050.24,-70991.57 1050.24,-70918.74 1050.24,-70918.74"/>
<polygon fill="black" stroke="black" points="1053.74,-70918.74 1050.24,-70908.74 1046.74,-70918.74 1053.74,-70918.74"/>
</g>
<!-- layer43_up_ar -->
<g id="node1108" class="node">
<title>layer43_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="622.5" cy="-70871.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="622.5" y="-70890.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="622.5" y="-70875.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="622.5" y="-70860.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="622.5" y="-70845.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer43_ffn_up_4&#45;&gt;layer43_up_ar -->
<g id="edge1412" class="edge">
<title>layer43_ffn_up_4&#45;&gt;layer43_up_ar</title>
<path fill="none" stroke="black" d="M514.26,-70991.57C514.26,-70991.57 514.26,-70907.65 514.26,-70907.65"/>
<polygon fill="black" stroke="black" points="517.76,-70907.65 514.26,-70897.65 510.76,-70907.65 517.76,-70907.65"/>
</g>
<!-- layer43_ffn_up_5&#45;&gt;layer43_up_ar -->
<g id="edge1413" class="edge">
<title>layer43_ffn_up_5&#45;&gt;layer43_up_ar</title>
<path fill="none" stroke="black" d="M813.76,-70991.62C813.76,-70941.79 813.76,-70855 813.76,-70855 813.76,-70855 752.54,-70855 752.54,-70855"/>
<polygon fill="black" stroke="black" points="752.54,-70851.5 742.54,-70855 752.54,-70858.5 752.54,-70851.5"/>
</g>
<!-- layer43_silu_4 -->
<g id="node1109" class="node">
<title>layer43_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="896,-70751.6 715,-70751.6 715,-70683.6 896,-70683.6 896,-70751.6"/>
<text text-anchor="middle" x="805.5" y="-70736.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="805.5" y="-70721.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="805.5" y="-70706.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="805.5" y="-70691.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_gate_ar&#45;&gt;layer43_silu_4 -->
<g id="edge1414" class="edge">
<title>layer43_gate_ar&#45;&gt;layer43_silu_4</title>
<path fill="none" stroke="black" d="M868.26,-70841.61C868.26,-70841.61 868.26,-70761.62 868.26,-70761.62"/>
<polygon fill="black" stroke="black" points="871.76,-70761.62 868.26,-70751.62 864.76,-70761.62 871.76,-70761.62"/>
</g>
<!-- layer43_silu_5 -->
<g id="node1110" class="node">
<title>layer43_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1113,-70751.6 932,-70751.6 932,-70683.6 1113,-70683.6 1113,-70751.6"/>
<text text-anchor="middle" x="1022.5" y="-70736.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1022.5" y="-70721.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1022.5" y="-70706.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1022.5" y="-70691.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_gate_ar&#45;&gt;layer43_silu_5 -->
<g id="edge1415" class="edge">
<title>layer43_gate_ar&#45;&gt;layer43_silu_5</title>
<path fill="none" stroke="black" d="M1014.24,-70826.7C1014.24,-70826.7 1014.24,-70761.61 1014.24,-70761.61"/>
<polygon fill="black" stroke="black" points="1017.74,-70761.61 1014.24,-70751.61 1010.74,-70761.61 1017.74,-70761.61"/>
</g>
<!-- layer43_mul_4 -->
<g id="node1111" class="node">
<title>layer43_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="786,-70611.6 605,-70611.6 605,-70543.6 786,-70543.6 786,-70611.6"/>
<text text-anchor="middle" x="695.5" y="-70596.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="695.5" y="-70581.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="695.5" y="-70566.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="695.5" y="-70551.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_up_ar&#45;&gt;layer43_mul_4 -->
<g id="edge1417" class="edge">
<title>layer43_up_ar&#45;&gt;layer43_mul_4</title>
<path fill="none" stroke="black" d="M660,-70825.41C660,-70825.41 660,-70621.68 660,-70621.68"/>
<polygon fill="black" stroke="black" points="663.5,-70621.68 660,-70611.68 656.5,-70621.68 663.5,-70621.68"/>
</g>
<!-- layer43_mul_5 -->
<g id="node1112" class="node">
<title>layer43_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1003,-70611.6 822,-70611.6 822,-70543.6 1003,-70543.6 1003,-70611.6"/>
<text text-anchor="middle" x="912.5" y="-70596.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="912.5" y="-70581.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="912.5" y="-70566.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="912.5" y="-70551.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer43_up_ar&#45;&gt;layer43_mul_5 -->
<g id="edge1419" class="edge">
<title>layer43_up_ar&#45;&gt;layer43_mul_5</title>
<path fill="none" stroke="black" d="M732.74,-70847.19C732.74,-70822.18 732.74,-70787 732.74,-70787 732.74,-70787 914,-70787 914,-70787 914,-70787 914,-70621.71 914,-70621.71"/>
<polygon fill="black" stroke="black" points="917.5,-70621.71 914,-70611.71 910.5,-70621.71 917.5,-70621.71"/>
</g>
<!-- layer43_silu_4&#45;&gt;layer43_mul_4 -->
<g id="edge1416" class="edge">
<title>layer43_silu_4&#45;&gt;layer43_mul_4</title>
<path fill="none" stroke="black" d="M750.5,-70683.35C750.5,-70683.35 750.5,-70621.98 750.5,-70621.98"/>
<polygon fill="black" stroke="black" points="754,-70621.98 750.5,-70611.98 747,-70621.98 754,-70621.98"/>
</g>
<!-- layer43_silu_5&#45;&gt;layer43_mul_5 -->
<g id="edge1418" class="edge">
<title>layer43_silu_5&#45;&gt;layer43_mul_5</title>
<path fill="none" stroke="black" d="M967.5,-70683.35C967.5,-70683.35 967.5,-70621.98 967.5,-70621.98"/>
<polygon fill="black" stroke="black" points="971,-70621.98 967.5,-70611.98 964,-70621.98 971,-70621.98"/>
</g>
<!-- layer43_ffn_down_4 -->
<g id="node1113" class="node">
<title>layer43_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="785.5,-70471.6 613.5,-70471.6 613.5,-70403.6 785.5,-70403.6 785.5,-70471.6"/>
<text text-anchor="middle" x="699.5" y="-70456.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="699.5" y="-70441.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="699.5" y="-70426.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="699.5" y="-70411.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer43_mul_4&#45;&gt;layer43_ffn_down_4 -->
<g id="edge1420" class="edge">
<title>layer43_mul_4&#45;&gt;layer43_ffn_down_4</title>
<path fill="none" stroke="black" d="M699.5,-70543.35C699.5,-70543.35 699.5,-70481.98 699.5,-70481.98"/>
<polygon fill="black" stroke="black" points="703,-70481.98 699.5,-70471.98 696,-70481.98 703,-70481.98"/>
</g>
<!-- layer43_ffn_down_5 -->
<g id="node1114" class="node">
<title>layer43_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="995.5,-70471.6 823.5,-70471.6 823.5,-70403.6 995.5,-70403.6 995.5,-70471.6"/>
<text text-anchor="middle" x="909.5" y="-70456.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="909.5" y="-70441.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="909.5" y="-70426.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="909.5" y="-70411.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer43_mul_5&#45;&gt;layer43_ffn_down_5 -->
<g id="edge1421" class="edge">
<title>layer43_mul_5&#45;&gt;layer43_ffn_down_5</title>
<path fill="none" stroke="black" d="M909.5,-70543.35C909.5,-70543.35 909.5,-70481.98 909.5,-70481.98"/>
<polygon fill="black" stroke="black" points="913,-70481.98 909.5,-70471.98 906,-70481.98 913,-70481.98"/>
</g>
<!-- layer43_ffn_ar -->
<g id="node1115" class="node">
<title>layer43_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="803.5" cy="-70283.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="803.5" y="-70302.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="803.5" y="-70287.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="803.5" y="-70272.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="803.5" y="-70257.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer43_ffn_down_4&#45;&gt;layer43_ffn_ar -->
<g id="edge1422" class="edge">
<title>layer43_ffn_down_4&#45;&gt;layer43_ffn_ar</title>
<path fill="none" stroke="black" d="M733.69,-70403.4C733.69,-70403.4 733.69,-70333.06 733.69,-70333.06"/>
<polygon fill="black" stroke="black" points="737.19,-70333.06 733.69,-70323.06 730.19,-70333.06 737.19,-70333.06"/>
</g>
<!-- layer43_ffn_down_5&#45;&gt;layer43_ffn_ar -->
<g id="edge1423" class="edge">
<title>layer43_ffn_down_5&#45;&gt;layer43_ffn_ar</title>
<path fill="none" stroke="black" d="M874.31,-70403.4C874.31,-70403.4 874.31,-70332.78 874.31,-70332.78"/>
<polygon fill="black" stroke="black" points="877.81,-70332.78 874.31,-70322.78 870.81,-70332.78 877.81,-70332.78"/>
</g>
<!-- layer44_norm_4 -->
<g id="node1116" class="node">
<title>layer44_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="785.5,-70163.43 613.5,-70163.43 613.5,-70095.43 785.5,-70095.43 785.5,-70163.43"/>
<text text-anchor="middle" x="699.5" y="-70148.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="699.5" y="-70133.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="699.5" y="-70118.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="699.5" y="-70103.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer43_ffn_ar&#45;&gt;layer44_norm_4 -->
<g id="edge1424" class="edge">
<title>layer43_ffn_ar&#45;&gt;layer44_norm_4</title>
<path fill="none" stroke="black" d="M733.69,-70243.84C733.69,-70243.84 733.69,-70173.49 733.69,-70173.49"/>
<polygon fill="black" stroke="black" points="737.19,-70173.49 733.69,-70163.49 730.19,-70173.49 737.19,-70173.49"/>
</g>
<!-- layer44_norm_5 -->
<g id="node1117" class="node">
<title>layer44_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="995.5,-70163.43 823.5,-70163.43 823.5,-70095.43 995.5,-70095.43 995.5,-70163.43"/>
<text text-anchor="middle" x="909.5" y="-70148.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="909.5" y="-70133.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="909.5" y="-70118.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="909.5" y="-70103.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer43_ffn_ar&#45;&gt;layer44_norm_5 -->
<g id="edge1425" class="edge">
<title>layer43_ffn_ar&#45;&gt;layer44_norm_5</title>
<path fill="none" stroke="black" d="M874.31,-70244.23C874.31,-70244.23 874.31,-70173.66 874.31,-70173.66"/>
<polygon fill="black" stroke="black" points="877.81,-70173.66 874.31,-70163.66 870.81,-70173.66 877.81,-70173.66"/>
</g>
<!-- layer44_qkv_4 -->
<g id="node1118" class="node">
<title>layer44_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="786,-70023.43 605,-70023.43 605,-69955.43 786,-69955.43 786,-70023.43"/>
<text text-anchor="middle" x="695.5" y="-70008.23" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="695.5" y="-69993.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="695.5" y="-69978.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="695.5" y="-69963.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer44_norm_4&#45;&gt;layer44_qkv_4 -->
<g id="edge1426" class="edge">
<title>layer44_norm_4&#45;&gt;layer44_qkv_4</title>
<path fill="none" stroke="black" d="M699.5,-70095.18C699.5,-70095.18 699.5,-70033.81 699.5,-70033.81"/>
<polygon fill="black" stroke="black" points="703,-70033.81 699.5,-70023.81 696,-70033.81 703,-70033.81"/>
</g>
<!-- layer44_qkv_5 -->
<g id="node1119" class="node">
<title>layer44_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1003,-70023.43 822,-70023.43 822,-69955.43 1003,-69955.43 1003,-70023.43"/>
<text text-anchor="middle" x="912.5" y="-70008.23" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="912.5" y="-69993.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="912.5" y="-69978.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="912.5" y="-69963.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer44_norm_5&#45;&gt;layer44_qkv_5 -->
<g id="edge1427" class="edge">
<title>layer44_norm_5&#45;&gt;layer44_qkv_5</title>
<path fill="none" stroke="black" d="M909.5,-70095.18C909.5,-70095.18 909.5,-70033.81 909.5,-70033.81"/>
<polygon fill="black" stroke="black" points="913,-70033.81 909.5,-70023.81 906,-70033.81 913,-70033.81"/>
</g>
<!-- layer44_qkv_ar -->
<g id="node1120" class="node">
<title>layer44_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="803.5" cy="-69835.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="803.5" y="-69854.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="803.5" y="-69839.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="803.5" y="-69824.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="803.5" y="-69809.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer44_qkv_4&#45;&gt;layer44_qkv_ar -->
<g id="edge1428" class="edge">
<title>layer44_qkv_4&#45;&gt;layer44_qkv_ar</title>
<path fill="none" stroke="black" d="M730.76,-69955.24C730.76,-69955.24 730.76,-69885.17 730.76,-69885.17"/>
<polygon fill="black" stroke="black" points="734.26,-69885.17 730.76,-69875.17 727.26,-69885.17 734.26,-69885.17"/>
</g>
<!-- layer44_qkv_5&#45;&gt;layer44_qkv_ar -->
<g id="edge1429" class="edge">
<title>layer44_qkv_5&#45;&gt;layer44_qkv_ar</title>
<path fill="none" stroke="black" d="M876.74,-69955.24C876.74,-69955.24 876.74,-69884.89 876.74,-69884.89"/>
<polygon fill="black" stroke="black" points="880.24,-69884.89 876.74,-69874.89 873.24,-69884.89 880.24,-69884.89"/>
</g>
<!-- layer44_attn_4 -->
<g id="node1121" class="node">
<title>layer44_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="785.5,-69715.27 613.5,-69715.27 613.5,-69647.27 785.5,-69647.27 785.5,-69715.27"/>
<text text-anchor="middle" x="699.5" y="-69700.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="699.5" y="-69685.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="699.5" y="-69670.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="699.5" y="-69655.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer44_qkv_ar&#45;&gt;layer44_attn_4 -->
<g id="edge1430" class="edge">
<title>layer44_qkv_ar&#45;&gt;layer44_attn_4</title>
<path fill="none" stroke="black" d="M730.51,-69795.67C730.51,-69795.67 730.51,-69725.32 730.51,-69725.32"/>
<polygon fill="black" stroke="black" points="734.01,-69725.32 730.51,-69715.32 727.01,-69725.32 734.01,-69725.32"/>
</g>
<!-- layer44_attn_5 -->
<g id="node1122" class="node">
<title>layer44_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="993.5,-69715.27 821.5,-69715.27 821.5,-69647.27 993.5,-69647.27 993.5,-69715.27"/>
<text text-anchor="middle" x="907.5" y="-69700.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="907.5" y="-69685.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="907.5" y="-69670.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="907.5" y="-69655.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer44_qkv_ar&#45;&gt;layer44_attn_5 -->
<g id="edge1431" class="edge">
<title>layer44_qkv_ar&#45;&gt;layer44_attn_5</title>
<path fill="none" stroke="black" d="M876.49,-69795.67C876.49,-69795.67 876.49,-69725.32 876.49,-69725.32"/>
<polygon fill="black" stroke="black" points="879.99,-69725.32 876.49,-69715.32 872.99,-69725.32 879.99,-69725.32"/>
</g>
<!-- layer44_attn_out_4 -->
<g id="node1123" class="node">
<title>layer44_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="785.5,-69575.27 613.5,-69575.27 613.5,-69507.27 785.5,-69507.27 785.5,-69575.27"/>
<text text-anchor="middle" x="699.5" y="-69560.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="699.5" y="-69545.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="699.5" y="-69530.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="699.5" y="-69515.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer44_attn_4&#45;&gt;layer44_attn_out_4 -->
<g id="edge1432" class="edge">
<title>layer44_attn_4&#45;&gt;layer44_attn_out_4</title>
<path fill="none" stroke="black" d="M699.5,-69647.02C699.5,-69647.02 699.5,-69585.65 699.5,-69585.65"/>
<polygon fill="black" stroke="black" points="703,-69585.65 699.5,-69575.65 696,-69585.65 703,-69585.65"/>
</g>
<!-- layer44_attn_out_5 -->
<g id="node1124" class="node">
<title>layer44_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="993.5,-69575.27 821.5,-69575.27 821.5,-69507.27 993.5,-69507.27 993.5,-69575.27"/>
<text text-anchor="middle" x="907.5" y="-69560.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="907.5" y="-69545.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="907.5" y="-69530.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="907.5" y="-69515.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer44_attn_5&#45;&gt;layer44_attn_out_5 -->
<g id="edge1433" class="edge">
<title>layer44_attn_5&#45;&gt;layer44_attn_out_5</title>
<path fill="none" stroke="black" d="M907.5,-69647.02C907.5,-69647.02 907.5,-69585.65 907.5,-69585.65"/>
<polygon fill="black" stroke="black" points="911,-69585.65 907.5,-69575.65 904,-69585.65 911,-69585.65"/>
</g>
<!-- layer44_attn_ar -->
<g id="node1125" class="node">
<title>layer44_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="803.5" cy="-69387.18" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="803.5" y="-69405.98" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="803.5" y="-69390.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="803.5" y="-69375.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="803.5" y="-69360.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer44_attn_out_4&#45;&gt;layer44_attn_ar -->
<g id="edge1434" class="edge">
<title>layer44_attn_out_4&#45;&gt;layer44_attn_ar</title>
<path fill="none" stroke="black" d="M733.69,-69507.07C733.69,-69507.07 733.69,-69436.72 733.69,-69436.72"/>
<polygon fill="black" stroke="black" points="737.19,-69436.72 733.69,-69426.72 730.19,-69436.73 737.19,-69436.72"/>
</g>
<!-- layer44_attn_out_5&#45;&gt;layer44_attn_ar -->
<g id="edge1435" class="edge">
<title>layer44_attn_out_5&#45;&gt;layer44_attn_ar</title>
<path fill="none" stroke="black" d="M873.31,-69507.07C873.31,-69507.07 873.31,-69436.72 873.31,-69436.72"/>
<polygon fill="black" stroke="black" points="876.81,-69436.72 873.31,-69426.72 869.81,-69436.73 876.81,-69436.72"/>
</g>
<!-- layer44_ffn_norm_4 -->
<g id="node1126" class="node">
<title>layer44_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="781.5,-69267.1 609.5,-69267.1 609.5,-69199.1 781.5,-69199.1 781.5,-69267.1"/>
<text text-anchor="middle" x="695.5" y="-69251.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="695.5" y="-69236.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="695.5" y="-69221.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="695.5" y="-69206.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer44_attn_ar&#45;&gt;layer44_ffn_norm_4 -->
<g id="edge1436" class="edge">
<title>layer44_attn_ar&#45;&gt;layer44_ffn_norm_4</title>
<path fill="none" stroke="black" d="M731.69,-69348.3C731.69,-69348.3 731.69,-69277.25 731.69,-69277.25"/>
<polygon fill="black" stroke="black" points="735.19,-69277.25 731.69,-69267.25 728.19,-69277.25 735.19,-69277.25"/>
</g>
<!-- layer44_ffn_norm_5 -->
<g id="node1127" class="node">
<title>layer44_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="998.5,-69267.1 826.5,-69267.1 826.5,-69199.1 998.5,-69199.1 998.5,-69267.1"/>
<text text-anchor="middle" x="912.5" y="-69251.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="912.5" y="-69236.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="912.5" y="-69221.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="912.5" y="-69206.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer44_attn_ar&#45;&gt;layer44_ffn_norm_5 -->
<g id="edge1437" class="edge">
<title>layer44_attn_ar&#45;&gt;layer44_ffn_norm_5</title>
<path fill="none" stroke="black" d="M875.81,-69348.3C875.81,-69348.3 875.81,-69277.25 875.81,-69277.25"/>
<polygon fill="black" stroke="black" points="879.31,-69277.25 875.81,-69267.25 872.31,-69277.25 879.31,-69277.25"/>
</g>
<!-- layer44_ffn_gate_4 -->
<g id="node1128" class="node">
<title>layer44_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="786,-69127.1 605,-69127.1 605,-69059.1 786,-69059.1 786,-69127.1"/>
<text text-anchor="middle" x="695.5" y="-69111.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="695.5" y="-69096.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="695.5" y="-69081.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="695.5" y="-69066.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_ffn_norm_4&#45;&gt;layer44_ffn_gate_4 -->
<g id="edge1438" class="edge">
<title>layer44_ffn_norm_4&#45;&gt;layer44_ffn_gate_4</title>
<path fill="none" stroke="black" d="M695.5,-69198.85C695.5,-69198.85 695.5,-69137.48 695.5,-69137.48"/>
<polygon fill="black" stroke="black" points="699,-69137.48 695.5,-69127.48 692,-69137.48 699,-69137.48"/>
</g>
<!-- layer44_ffn_up_4 -->
<g id="node1130" class="node">
<title>layer44_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="569,-69127.1 388,-69127.1 388,-69059.1 569,-69059.1 569,-69127.1"/>
<text text-anchor="middle" x="478.5" y="-69111.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="478.5" y="-69096.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="478.5" y="-69081.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="478.5" y="-69066.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_ffn_norm_4&#45;&gt;layer44_ffn_up_4 -->
<g id="edge1440" class="edge">
<title>layer44_ffn_norm_4&#45;&gt;layer44_ffn_up_4</title>
<path fill="none" stroke="black" d="M609.31,-69233C569.86,-69233 531.76,-69233 531.76,-69233 531.76,-69233 531.76,-69137.32 531.76,-69137.32"/>
<polygon fill="black" stroke="black" points="535.26,-69137.32 531.76,-69127.32 528.26,-69137.32 535.26,-69137.32"/>
</g>
<!-- layer44_ffn_gate_5 -->
<g id="node1129" class="node">
<title>layer44_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1220,-69127.1 1039,-69127.1 1039,-69059.1 1220,-69059.1 1220,-69127.1"/>
<text text-anchor="middle" x="1129.5" y="-69111.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1129.5" y="-69096.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1129.5" y="-69081.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1129.5" y="-69066.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_ffn_norm_5&#45;&gt;layer44_ffn_gate_5 -->
<g id="edge1439" class="edge">
<title>layer44_ffn_norm_5&#45;&gt;layer44_ffn_gate_5</title>
<path fill="none" stroke="black" d="M998.56,-69233C1037.95,-69233 1076,-69233 1076,-69233 1076,-69233 1076,-69137.32 1076,-69137.32"/>
<polygon fill="black" stroke="black" points="1079.5,-69137.32 1076,-69127.32 1072.5,-69137.32 1079.5,-69137.32"/>
</g>
<!-- layer44_ffn_up_5 -->
<g id="node1131" class="node">
<title>layer44_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1003,-69127.1 822,-69127.1 822,-69059.1 1003,-69059.1 1003,-69127.1"/>
<text text-anchor="middle" x="912.5" y="-69111.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="912.5" y="-69096.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="912.5" y="-69081.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="912.5" y="-69066.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_ffn_norm_5&#45;&gt;layer44_ffn_up_5 -->
<g id="edge1441" class="edge">
<title>layer44_ffn_norm_5&#45;&gt;layer44_ffn_up_5</title>
<path fill="none" stroke="black" d="M912.5,-69198.85C912.5,-69198.85 912.5,-69137.48 912.5,-69137.48"/>
<polygon fill="black" stroke="black" points="916,-69137.48 912.5,-69127.48 909,-69137.48 916,-69137.48"/>
</g>
<!-- layer44_gate_ar -->
<g id="node1132" class="node">
<title>layer44_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1003.5" cy="-68939.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1003.5" y="-68957.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1003.5" y="-68942.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1003.5" y="-68927.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1003.5" y="-68912.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer44_ffn_gate_4&#45;&gt;layer44_gate_ar -->
<g id="edge1442" class="edge">
<title>layer44_ffn_gate_4&#45;&gt;layer44_gate_ar</title>
<path fill="none" stroke="black" d="M786.08,-69093C796.79,-69093 804,-69093 804,-69093 804,-69093 804,-68955 804,-68955 804,-68955 872.56,-68955 872.56,-68955"/>
<polygon fill="black" stroke="black" points="872.56,-68958.5 882.56,-68955 872.56,-68951.5 872.56,-68958.5"/>
</g>
<!-- layer44_ffn_gate_5&#45;&gt;layer44_gate_ar -->
<g id="edge1443" class="edge">
<title>layer44_ffn_gate_5&#45;&gt;layer44_gate_ar</title>
<path fill="none" stroke="black" d="M1085.24,-69058.9C1085.24,-69058.9 1085.24,-68986.08 1085.24,-68986.08"/>
<polygon fill="black" stroke="black" points="1088.74,-68986.08 1085.24,-68976.08 1081.74,-68986.08 1088.74,-68986.08"/>
</g>
<!-- layer44_up_ar -->
<g id="node1133" class="node">
<title>layer44_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="657.5" cy="-68939.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="657.5" y="-68957.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="657.5" y="-68942.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="657.5" y="-68927.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="657.5" y="-68912.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer44_ffn_up_4&#45;&gt;layer44_up_ar -->
<g id="edge1444" class="edge">
<title>layer44_ffn_up_4&#45;&gt;layer44_up_ar</title>
<path fill="none" stroke="black" d="M549.26,-69058.9C549.26,-69058.9 549.26,-68974.98 549.26,-68974.98"/>
<polygon fill="black" stroke="black" points="552.76,-68974.98 549.26,-68964.98 545.76,-68974.98 552.76,-68974.98"/>
</g>
<!-- layer44_ffn_up_5&#45;&gt;layer44_up_ar -->
<g id="edge1445" class="edge">
<title>layer44_ffn_up_5&#45;&gt;layer44_up_ar</title>
<path fill="none" stroke="black" d="M848.76,-69058.89C848.76,-69008.95 848.76,-68922 848.76,-68922 848.76,-68922 787.27,-68922 787.27,-68922"/>
<polygon fill="black" stroke="black" points="787.27,-68918.5 777.27,-68922 787.27,-68925.5 787.27,-68918.5"/>
</g>
<!-- layer44_silu_4 -->
<g id="node1134" class="node">
<title>layer44_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="931,-68818.93 750,-68818.93 750,-68750.93 931,-68750.93 931,-68818.93"/>
<text text-anchor="middle" x="840.5" y="-68803.73" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="840.5" y="-68788.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="840.5" y="-68773.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="840.5" y="-68758.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_gate_ar&#45;&gt;layer44_silu_4 -->
<g id="edge1446" class="edge">
<title>layer44_gate_ar&#45;&gt;layer44_silu_4</title>
<path fill="none" stroke="black" d="M903.26,-68908.94C903.26,-68908.94 903.26,-68828.95 903.26,-68828.95"/>
<polygon fill="black" stroke="black" points="906.76,-68828.95 903.26,-68818.95 899.76,-68828.95 906.76,-68828.95"/>
</g>
<!-- layer44_silu_5 -->
<g id="node1135" class="node">
<title>layer44_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1148,-68818.93 967,-68818.93 967,-68750.93 1148,-68750.93 1148,-68818.93"/>
<text text-anchor="middle" x="1057.5" y="-68803.73" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1057.5" y="-68788.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1057.5" y="-68773.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1057.5" y="-68758.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_gate_ar&#45;&gt;layer44_silu_5 -->
<g id="edge1447" class="edge">
<title>layer44_gate_ar&#45;&gt;layer44_silu_5</title>
<path fill="none" stroke="black" d="M1049.24,-68894.03C1049.24,-68894.03 1049.24,-68828.94 1049.24,-68828.94"/>
<polygon fill="black" stroke="black" points="1052.74,-68828.94 1049.24,-68818.94 1045.74,-68828.94 1052.74,-68828.94"/>
</g>
<!-- layer44_mul_4 -->
<g id="node1136" class="node">
<title>layer44_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="821,-68678.93 640,-68678.93 640,-68610.93 821,-68610.93 821,-68678.93"/>
<text text-anchor="middle" x="730.5" y="-68663.73" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="730.5" y="-68648.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="730.5" y="-68633.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="730.5" y="-68618.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_up_ar&#45;&gt;layer44_mul_4 -->
<g id="edge1449" class="edge">
<title>layer44_up_ar&#45;&gt;layer44_mul_4</title>
<path fill="none" stroke="black" d="M695,-68892.74C695,-68892.74 695,-68689.02 695,-68689.02"/>
<polygon fill="black" stroke="black" points="698.5,-68689.02 695,-68679.02 691.5,-68689.02 698.5,-68689.02"/>
</g>
<!-- layer44_mul_5 -->
<g id="node1137" class="node">
<title>layer44_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1038,-68678.93 857,-68678.93 857,-68610.93 1038,-68610.93 1038,-68678.93"/>
<text text-anchor="middle" x="947.5" y="-68663.73" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="947.5" y="-68648.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="947.5" y="-68633.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="947.5" y="-68618.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer44_up_ar&#45;&gt;layer44_mul_5 -->
<g id="edge1451" class="edge">
<title>layer44_up_ar&#45;&gt;layer44_mul_5</title>
<path fill="none" stroke="black" d="M767.74,-68914.43C767.74,-68889.32 767.74,-68854 767.74,-68854 767.74,-68854 949,-68854 949,-68854 949,-68854 949,-68688.99 949,-68688.99"/>
<polygon fill="black" stroke="black" points="952.5,-68688.99 949,-68678.99 945.5,-68688.99 952.5,-68688.99"/>
</g>
<!-- layer44_silu_4&#45;&gt;layer44_mul_4 -->
<g id="edge1448" class="edge">
<title>layer44_silu_4&#45;&gt;layer44_mul_4</title>
<path fill="none" stroke="black" d="M785.5,-68750.68C785.5,-68750.68 785.5,-68689.31 785.5,-68689.31"/>
<polygon fill="black" stroke="black" points="789,-68689.31 785.5,-68679.31 782,-68689.31 789,-68689.31"/>
</g>
<!-- layer44_silu_5&#45;&gt;layer44_mul_5 -->
<g id="edge1450" class="edge">
<title>layer44_silu_5&#45;&gt;layer44_mul_5</title>
<path fill="none" stroke="black" d="M1002.5,-68750.68C1002.5,-68750.68 1002.5,-68689.31 1002.5,-68689.31"/>
<polygon fill="black" stroke="black" points="1006,-68689.31 1002.5,-68679.31 999,-68689.31 1006,-68689.31"/>
</g>
<!-- layer44_ffn_down_4 -->
<g id="node1138" class="node">
<title>layer44_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="820.5,-68538.93 648.5,-68538.93 648.5,-68470.93 820.5,-68470.93 820.5,-68538.93"/>
<text text-anchor="middle" x="734.5" y="-68523.73" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="734.5" y="-68508.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="734.5" y="-68493.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="734.5" y="-68478.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer44_mul_4&#45;&gt;layer44_ffn_down_4 -->
<g id="edge1452" class="edge">
<title>layer44_mul_4&#45;&gt;layer44_ffn_down_4</title>
<path fill="none" stroke="black" d="M734.5,-68610.68C734.5,-68610.68 734.5,-68549.31 734.5,-68549.31"/>
<polygon fill="black" stroke="black" points="738,-68549.31 734.5,-68539.31 731,-68549.31 738,-68549.31"/>
</g>
<!-- layer44_ffn_down_5 -->
<g id="node1139" class="node">
<title>layer44_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1030.5,-68538.93 858.5,-68538.93 858.5,-68470.93 1030.5,-68470.93 1030.5,-68538.93"/>
<text text-anchor="middle" x="944.5" y="-68523.73" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="944.5" y="-68508.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="944.5" y="-68493.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="944.5" y="-68478.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer44_mul_5&#45;&gt;layer44_ffn_down_5 -->
<g id="edge1453" class="edge">
<title>layer44_mul_5&#45;&gt;layer44_ffn_down_5</title>
<path fill="none" stroke="black" d="M944.5,-68610.68C944.5,-68610.68 944.5,-68549.31 944.5,-68549.31"/>
<polygon fill="black" stroke="black" points="948,-68549.31 944.5,-68539.31 941,-68549.31 948,-68549.31"/>
</g>
<!-- layer44_ffn_ar -->
<g id="node1140" class="node">
<title>layer44_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="838.5" cy="-68350.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="838.5" y="-68369.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="838.5" y="-68354.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="838.5" y="-68339.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="838.5" y="-68324.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer44_ffn_down_4&#45;&gt;layer44_ffn_ar -->
<g id="edge1454" class="edge">
<title>layer44_ffn_down_4&#45;&gt;layer44_ffn_ar</title>
<path fill="none" stroke="black" d="M768.69,-68470.74C768.69,-68470.74 768.69,-68400.39 768.69,-68400.39"/>
<polygon fill="black" stroke="black" points="772.19,-68400.39 768.69,-68390.39 765.19,-68400.39 772.19,-68400.39"/>
</g>
<!-- layer44_ffn_down_5&#45;&gt;layer44_ffn_ar -->
<g id="edge1455" class="edge">
<title>layer44_ffn_down_5&#45;&gt;layer44_ffn_ar</title>
<path fill="none" stroke="black" d="M909.31,-68470.74C909.31,-68470.74 909.31,-68400.11 909.31,-68400.11"/>
<polygon fill="black" stroke="black" points="912.81,-68400.11 909.31,-68390.11 905.81,-68400.11 912.81,-68400.11"/>
</g>
<!-- layer45_norm_4 -->
<g id="node1141" class="node">
<title>layer45_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="820.5,-68230.77 648.5,-68230.77 648.5,-68162.77 820.5,-68162.77 820.5,-68230.77"/>
<text text-anchor="middle" x="734.5" y="-68215.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="734.5" y="-68200.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="734.5" y="-68185.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="734.5" y="-68170.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer44_ffn_ar&#45;&gt;layer45_norm_4 -->
<g id="edge1456" class="edge">
<title>layer44_ffn_ar&#45;&gt;layer45_norm_4</title>
<path fill="none" stroke="black" d="M768.69,-68311.17C768.69,-68311.17 768.69,-68240.82 768.69,-68240.82"/>
<polygon fill="black" stroke="black" points="772.19,-68240.82 768.69,-68230.82 765.19,-68240.82 772.19,-68240.82"/>
</g>
<!-- layer45_norm_5 -->
<g id="node1142" class="node">
<title>layer45_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1030.5,-68230.77 858.5,-68230.77 858.5,-68162.77 1030.5,-68162.77 1030.5,-68230.77"/>
<text text-anchor="middle" x="944.5" y="-68215.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="944.5" y="-68200.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="944.5" y="-68185.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="944.5" y="-68170.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer44_ffn_ar&#45;&gt;layer45_norm_5 -->
<g id="edge1457" class="edge">
<title>layer44_ffn_ar&#45;&gt;layer45_norm_5</title>
<path fill="none" stroke="black" d="M909.31,-68311.57C909.31,-68311.57 909.31,-68241 909.31,-68241"/>
<polygon fill="black" stroke="black" points="912.81,-68241 909.31,-68231 905.81,-68241 912.81,-68241"/>
</g>
<!-- layer45_qkv_4 -->
<g id="node1143" class="node">
<title>layer45_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="821,-68090.77 640,-68090.77 640,-68022.77 821,-68022.77 821,-68090.77"/>
<text text-anchor="middle" x="730.5" y="-68075.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="730.5" y="-68060.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="730.5" y="-68045.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="730.5" y="-68030.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer45_norm_4&#45;&gt;layer45_qkv_4 -->
<g id="edge1458" class="edge">
<title>layer45_norm_4&#45;&gt;layer45_qkv_4</title>
<path fill="none" stroke="black" d="M734.5,-68162.52C734.5,-68162.52 734.5,-68101.15 734.5,-68101.15"/>
<polygon fill="black" stroke="black" points="738,-68101.15 734.5,-68091.15 731,-68101.15 738,-68101.15"/>
</g>
<!-- layer45_qkv_5 -->
<g id="node1144" class="node">
<title>layer45_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1038,-68090.77 857,-68090.77 857,-68022.77 1038,-68022.77 1038,-68090.77"/>
<text text-anchor="middle" x="947.5" y="-68075.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="947.5" y="-68060.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="947.5" y="-68045.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="947.5" y="-68030.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer45_norm_5&#45;&gt;layer45_qkv_5 -->
<g id="edge1459" class="edge">
<title>layer45_norm_5&#45;&gt;layer45_qkv_5</title>
<path fill="none" stroke="black" d="M944.5,-68162.52C944.5,-68162.52 944.5,-68101.15 944.5,-68101.15"/>
<polygon fill="black" stroke="black" points="948,-68101.15 944.5,-68091.15 941,-68101.15 948,-68101.15"/>
</g>
<!-- layer45_qkv_ar -->
<g id="node1145" class="node">
<title>layer45_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="838.5" cy="-67902.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="838.5" y="-67921.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="838.5" y="-67906.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="838.5" y="-67891.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="838.5" y="-67876.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer45_qkv_4&#45;&gt;layer45_qkv_ar -->
<g id="edge1460" class="edge">
<title>layer45_qkv_4&#45;&gt;layer45_qkv_ar</title>
<path fill="none" stroke="black" d="M765.76,-68022.57C765.76,-68022.57 765.76,-67952.5 765.76,-67952.5"/>
<polygon fill="black" stroke="black" points="769.26,-67952.5 765.76,-67942.5 762.26,-67952.5 769.26,-67952.5"/>
</g>
<!-- layer45_qkv_5&#45;&gt;layer45_qkv_ar -->
<g id="edge1461" class="edge">
<title>layer45_qkv_5&#45;&gt;layer45_qkv_ar</title>
<path fill="none" stroke="black" d="M911.74,-68022.57C911.74,-68022.57 911.74,-67952.23 911.74,-67952.23"/>
<polygon fill="black" stroke="black" points="915.24,-67952.23 911.74,-67942.23 908.24,-67952.23 915.24,-67952.23"/>
</g>
<!-- layer45_attn_4 -->
<g id="node1146" class="node">
<title>layer45_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="820.5,-67782.6 648.5,-67782.6 648.5,-67714.6 820.5,-67714.6 820.5,-67782.6"/>
<text text-anchor="middle" x="734.5" y="-67767.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="734.5" y="-67752.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="734.5" y="-67737.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="734.5" y="-67722.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer45_qkv_ar&#45;&gt;layer45_attn_4 -->
<g id="edge1462" class="edge">
<title>layer45_qkv_ar&#45;&gt;layer45_attn_4</title>
<path fill="none" stroke="black" d="M765.51,-67863C765.51,-67863 765.51,-67792.66 765.51,-67792.66"/>
<polygon fill="black" stroke="black" points="769.01,-67792.66 765.51,-67782.66 762.01,-67792.66 769.01,-67792.66"/>
</g>
<!-- layer45_attn_5 -->
<g id="node1147" class="node">
<title>layer45_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1028.5,-67782.6 856.5,-67782.6 856.5,-67714.6 1028.5,-67714.6 1028.5,-67782.6"/>
<text text-anchor="middle" x="942.5" y="-67767.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="942.5" y="-67752.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="942.5" y="-67737.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="942.5" y="-67722.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer45_qkv_ar&#45;&gt;layer45_attn_5 -->
<g id="edge1463" class="edge">
<title>layer45_qkv_ar&#45;&gt;layer45_attn_5</title>
<path fill="none" stroke="black" d="M911.49,-67863C911.49,-67863 911.49,-67792.66 911.49,-67792.66"/>
<polygon fill="black" stroke="black" points="914.99,-67792.66 911.49,-67782.66 907.99,-67792.66 914.99,-67792.66"/>
</g>
<!-- layer45_attn_out_4 -->
<g id="node1148" class="node">
<title>layer45_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="820.5,-67642.6 648.5,-67642.6 648.5,-67574.6 820.5,-67574.6 820.5,-67642.6"/>
<text text-anchor="middle" x="734.5" y="-67627.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="734.5" y="-67612.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="734.5" y="-67597.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="734.5" y="-67582.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer45_attn_4&#45;&gt;layer45_attn_out_4 -->
<g id="edge1464" class="edge">
<title>layer45_attn_4&#45;&gt;layer45_attn_out_4</title>
<path fill="none" stroke="black" d="M734.5,-67714.35C734.5,-67714.35 734.5,-67652.98 734.5,-67652.98"/>
<polygon fill="black" stroke="black" points="738,-67652.98 734.5,-67642.98 731,-67652.98 738,-67652.98"/>
</g>
<!-- layer45_attn_out_5 -->
<g id="node1149" class="node">
<title>layer45_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1028.5,-67642.6 856.5,-67642.6 856.5,-67574.6 1028.5,-67574.6 1028.5,-67642.6"/>
<text text-anchor="middle" x="942.5" y="-67627.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="942.5" y="-67612.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="942.5" y="-67597.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="942.5" y="-67582.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer45_attn_5&#45;&gt;layer45_attn_out_5 -->
<g id="edge1465" class="edge">
<title>layer45_attn_5&#45;&gt;layer45_attn_out_5</title>
<path fill="none" stroke="black" d="M942.5,-67714.35C942.5,-67714.35 942.5,-67652.98 942.5,-67652.98"/>
<polygon fill="black" stroke="black" points="946,-67652.98 942.5,-67642.98 939,-67652.98 946,-67652.98"/>
</g>
<!-- layer45_attn_ar -->
<g id="node1150" class="node">
<title>layer45_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="838.5" cy="-67454.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="838.5" y="-67473.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="838.5" y="-67458.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="838.5" y="-67443.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="838.5" y="-67428.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer45_attn_out_4&#45;&gt;layer45_attn_ar -->
<g id="edge1466" class="edge">
<title>layer45_attn_out_4&#45;&gt;layer45_attn_ar</title>
<path fill="none" stroke="black" d="M768.69,-67574.4C768.69,-67574.4 768.69,-67504.06 768.69,-67504.06"/>
<polygon fill="black" stroke="black" points="772.19,-67504.06 768.69,-67494.06 765.19,-67504.06 772.19,-67504.06"/>
</g>
<!-- layer45_attn_out_5&#45;&gt;layer45_attn_ar -->
<g id="edge1467" class="edge">
<title>layer45_attn_out_5&#45;&gt;layer45_attn_ar</title>
<path fill="none" stroke="black" d="M908.31,-67574.4C908.31,-67574.4 908.31,-67504.06 908.31,-67504.06"/>
<polygon fill="black" stroke="black" points="911.81,-67504.06 908.31,-67494.06 904.81,-67504.06 911.81,-67504.06"/>
</g>
<!-- layer45_ffn_norm_4 -->
<g id="node1151" class="node">
<title>layer45_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="816.5,-67334.43 644.5,-67334.43 644.5,-67266.43 816.5,-67266.43 816.5,-67334.43"/>
<text text-anchor="middle" x="730.5" y="-67319.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="730.5" y="-67304.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="730.5" y="-67289.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="730.5" y="-67274.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer45_attn_ar&#45;&gt;layer45_ffn_norm_4 -->
<g id="edge1468" class="edge">
<title>layer45_attn_ar&#45;&gt;layer45_ffn_norm_4</title>
<path fill="none" stroke="black" d="M766.69,-67415.63C766.69,-67415.63 766.69,-67344.58 766.69,-67344.58"/>
<polygon fill="black" stroke="black" points="770.19,-67344.58 766.69,-67334.58 763.19,-67344.58 770.19,-67344.58"/>
</g>
<!-- layer45_ffn_norm_5 -->
<g id="node1152" class="node">
<title>layer45_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1033.5,-67334.43 861.5,-67334.43 861.5,-67266.43 1033.5,-67266.43 1033.5,-67334.43"/>
<text text-anchor="middle" x="947.5" y="-67319.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="947.5" y="-67304.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="947.5" y="-67289.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="947.5" y="-67274.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer45_attn_ar&#45;&gt;layer45_ffn_norm_5 -->
<g id="edge1469" class="edge">
<title>layer45_attn_ar&#45;&gt;layer45_ffn_norm_5</title>
<path fill="none" stroke="black" d="M910.81,-67415.63C910.81,-67415.63 910.81,-67344.58 910.81,-67344.58"/>
<polygon fill="black" stroke="black" points="914.31,-67344.58 910.81,-67334.58 907.31,-67344.58 914.31,-67344.58"/>
</g>
<!-- layer45_ffn_gate_4 -->
<g id="node1153" class="node">
<title>layer45_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="821,-67194.43 640,-67194.43 640,-67126.43 821,-67126.43 821,-67194.43"/>
<text text-anchor="middle" x="730.5" y="-67179.23" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="730.5" y="-67164.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="730.5" y="-67149.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="730.5" y="-67134.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_ffn_norm_4&#45;&gt;layer45_ffn_gate_4 -->
<g id="edge1470" class="edge">
<title>layer45_ffn_norm_4&#45;&gt;layer45_ffn_gate_4</title>
<path fill="none" stroke="black" d="M730.5,-67266.19C730.5,-67266.19 730.5,-67204.81 730.5,-67204.81"/>
<polygon fill="black" stroke="black" points="734,-67204.81 730.5,-67194.81 727,-67204.81 734,-67204.81"/>
</g>
<!-- layer45_ffn_up_4 -->
<g id="node1155" class="node">
<title>layer45_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="604,-67194.43 423,-67194.43 423,-67126.43 604,-67126.43 604,-67194.43"/>
<text text-anchor="middle" x="513.5" y="-67179.23" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="513.5" y="-67164.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="513.5" y="-67149.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="513.5" y="-67134.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_ffn_norm_4&#45;&gt;layer45_ffn_up_4 -->
<g id="edge1472" class="edge">
<title>layer45_ffn_norm_4&#45;&gt;layer45_ffn_up_4</title>
<path fill="none" stroke="black" d="M644.31,-67300C604.86,-67300 566.76,-67300 566.76,-67300 566.76,-67300 566.76,-67204.57 566.76,-67204.57"/>
<polygon fill="black" stroke="black" points="570.26,-67204.57 566.76,-67194.57 563.26,-67204.57 570.26,-67204.57"/>
</g>
<!-- layer45_ffn_gate_5 -->
<g id="node1154" class="node">
<title>layer45_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1255,-67194.43 1074,-67194.43 1074,-67126.43 1255,-67126.43 1255,-67194.43"/>
<text text-anchor="middle" x="1164.5" y="-67179.23" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1164.5" y="-67164.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1164.5" y="-67149.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1164.5" y="-67134.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_ffn_norm_5&#45;&gt;layer45_ffn_gate_5 -->
<g id="edge1471" class="edge">
<title>layer45_ffn_norm_5&#45;&gt;layer45_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1033.56,-67300C1072.95,-67300 1111,-67300 1111,-67300 1111,-67300 1111,-67204.57 1111,-67204.57"/>
<polygon fill="black" stroke="black" points="1114.5,-67204.57 1111,-67194.57 1107.5,-67204.57 1114.5,-67204.57"/>
</g>
<!-- layer45_ffn_up_5 -->
<g id="node1156" class="node">
<title>layer45_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1038,-67194.43 857,-67194.43 857,-67126.43 1038,-67126.43 1038,-67194.43"/>
<text text-anchor="middle" x="947.5" y="-67179.23" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="947.5" y="-67164.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="947.5" y="-67149.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="947.5" y="-67134.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_ffn_norm_5&#45;&gt;layer45_ffn_up_5 -->
<g id="edge1473" class="edge">
<title>layer45_ffn_norm_5&#45;&gt;layer45_ffn_up_5</title>
<path fill="none" stroke="black" d="M947.5,-67266.19C947.5,-67266.19 947.5,-67204.81 947.5,-67204.81"/>
<polygon fill="black" stroke="black" points="951,-67204.81 947.5,-67194.81 944,-67204.81 951,-67204.81"/>
</g>
<!-- layer45_gate_ar -->
<g id="node1157" class="node">
<title>layer45_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1038.5" cy="-67006.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1038.5" y="-67025.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1038.5" y="-67010.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1038.5" y="-66995.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1038.5" y="-66980.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer45_ffn_gate_4&#45;&gt;layer45_gate_ar -->
<g id="edge1474" class="edge">
<title>layer45_ffn_gate_4&#45;&gt;layer45_gate_ar</title>
<path fill="none" stroke="black" d="M821.08,-67160C831.79,-67160 839,-67160 839,-67160 839,-67160 839,-67022 839,-67022 839,-67022 907.28,-67022 907.28,-67022"/>
<polygon fill="black" stroke="black" points="907.28,-67025.5 917.28,-67022 907.28,-67018.5 907.28,-67025.5"/>
</g>
<!-- layer45_ffn_gate_5&#45;&gt;layer45_gate_ar -->
<g id="edge1475" class="edge">
<title>layer45_ffn_gate_5&#45;&gt;layer45_gate_ar</title>
<path fill="none" stroke="black" d="M1120.24,-67126.24C1120.24,-67126.24 1120.24,-67053.41 1120.24,-67053.41"/>
<polygon fill="black" stroke="black" points="1123.74,-67053.41 1120.24,-67043.41 1116.74,-67053.41 1123.74,-67053.41"/>
</g>
<!-- layer45_up_ar -->
<g id="node1158" class="node">
<title>layer45_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="692.5" cy="-67006.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="692.5" y="-67025.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="692.5" y="-67010.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="692.5" y="-66995.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="692.5" y="-66980.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer45_ffn_up_4&#45;&gt;layer45_up_ar -->
<g id="edge1476" class="edge">
<title>layer45_ffn_up_4&#45;&gt;layer45_up_ar</title>
<path fill="none" stroke="black" d="M584.26,-67126.24C584.26,-67126.24 584.26,-67042.31 584.26,-67042.31"/>
<polygon fill="black" stroke="black" points="587.76,-67042.31 584.26,-67032.31 580.76,-67042.31 587.76,-67042.31"/>
</g>
<!-- layer45_ffn_up_5&#45;&gt;layer45_up_ar -->
<g id="edge1477" class="edge">
<title>layer45_ffn_up_5&#45;&gt;layer45_up_ar</title>
<path fill="none" stroke="black" d="M883.76,-67126.35C883.76,-67076.62 883.76,-66990 883.76,-66990 883.76,-66990 823.08,-66990 823.08,-66990"/>
<polygon fill="black" stroke="black" points="823.08,-66986.5 813.08,-66990 823.08,-66993.5 823.08,-66986.5"/>
</g>
<!-- layer45_silu_4 -->
<g id="node1159" class="node">
<title>layer45_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="966,-66886.27 785,-66886.27 785,-66818.27 966,-66818.27 966,-66886.27"/>
<text text-anchor="middle" x="875.5" y="-66871.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="875.5" y="-66856.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="875.5" y="-66841.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="875.5" y="-66826.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_gate_ar&#45;&gt;layer45_silu_4 -->
<g id="edge1478" class="edge">
<title>layer45_gate_ar&#45;&gt;layer45_silu_4</title>
<path fill="none" stroke="black" d="M938.26,-66976.28C938.26,-66976.28 938.26,-66896.29 938.26,-66896.29"/>
<polygon fill="black" stroke="black" points="941.76,-66896.29 938.26,-66886.29 934.76,-66896.29 941.76,-66896.29"/>
</g>
<!-- layer45_silu_5 -->
<g id="node1160" class="node">
<title>layer45_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1183,-66886.27 1002,-66886.27 1002,-66818.27 1183,-66818.27 1183,-66886.27"/>
<text text-anchor="middle" x="1092.5" y="-66871.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1092.5" y="-66856.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1092.5" y="-66841.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1092.5" y="-66826.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_gate_ar&#45;&gt;layer45_silu_5 -->
<g id="edge1479" class="edge">
<title>layer45_gate_ar&#45;&gt;layer45_silu_5</title>
<path fill="none" stroke="black" d="M1084.24,-66961.37C1084.24,-66961.37 1084.24,-66896.27 1084.24,-66896.27"/>
<polygon fill="black" stroke="black" points="1087.74,-66896.27 1084.24,-66886.27 1080.74,-66896.27 1087.74,-66896.27"/>
</g>
<!-- layer45_mul_4 -->
<g id="node1161" class="node">
<title>layer45_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="856,-66746.27 675,-66746.27 675,-66678.27 856,-66678.27 856,-66746.27"/>
<text text-anchor="middle" x="765.5" y="-66731.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="765.5" y="-66716.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="765.5" y="-66701.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="765.5" y="-66686.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_up_ar&#45;&gt;layer45_mul_4 -->
<g id="edge1481" class="edge">
<title>layer45_up_ar&#45;&gt;layer45_mul_4</title>
<path fill="none" stroke="black" d="M730,-66960.08C730,-66960.08 730,-66756.35 730,-66756.35"/>
<polygon fill="black" stroke="black" points="733.5,-66756.35 730,-66746.35 726.5,-66756.35 733.5,-66756.35"/>
</g>
<!-- layer45_mul_5 -->
<g id="node1162" class="node">
<title>layer45_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1073,-66746.27 892,-66746.27 892,-66678.27 1073,-66678.27 1073,-66746.27"/>
<text text-anchor="middle" x="982.5" y="-66731.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="982.5" y="-66716.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="982.5" y="-66701.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="982.5" y="-66686.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer45_up_ar&#45;&gt;layer45_mul_5 -->
<g id="edge1483" class="edge">
<title>layer45_up_ar&#45;&gt;layer45_mul_5</title>
<path fill="none" stroke="black" d="M802.74,-66981.5C802.74,-66956.62 802.74,-66922 802.74,-66922 802.74,-66922 984,-66922 984,-66922 984,-66922 984,-66756.43 984,-66756.43"/>
<polygon fill="black" stroke="black" points="987.5,-66756.43 984,-66746.43 980.5,-66756.43 987.5,-66756.43"/>
</g>
<!-- layer45_silu_4&#45;&gt;layer45_mul_4 -->
<g id="edge1480" class="edge">
<title>layer45_silu_4&#45;&gt;layer45_mul_4</title>
<path fill="none" stroke="black" d="M820.5,-66818.02C820.5,-66818.02 820.5,-66756.65 820.5,-66756.65"/>
<polygon fill="black" stroke="black" points="824,-66756.65 820.5,-66746.65 817,-66756.65 824,-66756.65"/>
</g>
<!-- layer45_silu_5&#45;&gt;layer45_mul_5 -->
<g id="edge1482" class="edge">
<title>layer45_silu_5&#45;&gt;layer45_mul_5</title>
<path fill="none" stroke="black" d="M1037.5,-66818.02C1037.5,-66818.02 1037.5,-66756.65 1037.5,-66756.65"/>
<polygon fill="black" stroke="black" points="1041,-66756.65 1037.5,-66746.65 1034,-66756.65 1041,-66756.65"/>
</g>
<!-- layer45_ffn_down_4 -->
<g id="node1163" class="node">
<title>layer45_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="855.5,-66606.27 683.5,-66606.27 683.5,-66538.27 855.5,-66538.27 855.5,-66606.27"/>
<text text-anchor="middle" x="769.5" y="-66591.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="769.5" y="-66576.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="769.5" y="-66561.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="769.5" y="-66546.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer45_mul_4&#45;&gt;layer45_ffn_down_4 -->
<g id="edge1484" class="edge">
<title>layer45_mul_4&#45;&gt;layer45_ffn_down_4</title>
<path fill="none" stroke="black" d="M769.5,-66678.02C769.5,-66678.02 769.5,-66616.65 769.5,-66616.65"/>
<polygon fill="black" stroke="black" points="773,-66616.65 769.5,-66606.65 766,-66616.65 773,-66616.65"/>
</g>
<!-- layer45_ffn_down_5 -->
<g id="node1164" class="node">
<title>layer45_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1065.5,-66606.27 893.5,-66606.27 893.5,-66538.27 1065.5,-66538.27 1065.5,-66606.27"/>
<text text-anchor="middle" x="979.5" y="-66591.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="979.5" y="-66576.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="979.5" y="-66561.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="979.5" y="-66546.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer45_mul_5&#45;&gt;layer45_ffn_down_5 -->
<g id="edge1485" class="edge">
<title>layer45_mul_5&#45;&gt;layer45_ffn_down_5</title>
<path fill="none" stroke="black" d="M979.5,-66678.02C979.5,-66678.02 979.5,-66616.65 979.5,-66616.65"/>
<polygon fill="black" stroke="black" points="983,-66616.65 979.5,-66606.65 976,-66616.65 983,-66616.65"/>
</g>
<!-- layer45_ffn_ar -->
<g id="node1165" class="node">
<title>layer45_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="873.5" cy="-66418.18" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="873.5" y="-66436.98" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="873.5" y="-66421.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="873.5" y="-66406.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="873.5" y="-66391.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer45_ffn_down_4&#45;&gt;layer45_ffn_ar -->
<g id="edge1486" class="edge">
<title>layer45_ffn_down_4&#45;&gt;layer45_ffn_ar</title>
<path fill="none" stroke="black" d="M803.69,-66538.07C803.69,-66538.07 803.69,-66467.73 803.69,-66467.73"/>
<polygon fill="black" stroke="black" points="807.19,-66467.73 803.69,-66457.73 800.19,-66467.73 807.19,-66467.73"/>
</g>
<!-- layer45_ffn_down_5&#45;&gt;layer45_ffn_ar -->
<g id="edge1487" class="edge">
<title>layer45_ffn_down_5&#45;&gt;layer45_ffn_ar</title>
<path fill="none" stroke="black" d="M944.31,-66538.07C944.31,-66538.07 944.31,-66467.45 944.31,-66467.45"/>
<polygon fill="black" stroke="black" points="947.81,-66467.45 944.31,-66457.45 940.81,-66467.45 947.81,-66467.45"/>
</g>
<!-- layer46_norm_4 -->
<g id="node1166" class="node">
<title>layer46_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="855.5,-66298.1 683.5,-66298.1 683.5,-66230.1 855.5,-66230.1 855.5,-66298.1"/>
<text text-anchor="middle" x="769.5" y="-66282.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="769.5" y="-66267.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="769.5" y="-66252.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="769.5" y="-66237.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer45_ffn_ar&#45;&gt;layer46_norm_4 -->
<g id="edge1488" class="edge">
<title>layer45_ffn_ar&#45;&gt;layer46_norm_4</title>
<path fill="none" stroke="black" d="M803.69,-66378.5C803.69,-66378.5 803.69,-66308.16 803.69,-66308.16"/>
<polygon fill="black" stroke="black" points="807.19,-66308.16 803.69,-66298.16 800.19,-66308.16 807.19,-66308.16"/>
</g>
<!-- layer46_norm_5 -->
<g id="node1167" class="node">
<title>layer46_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1065.5,-66298.1 893.5,-66298.1 893.5,-66230.1 1065.5,-66230.1 1065.5,-66298.1"/>
<text text-anchor="middle" x="979.5" y="-66282.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="979.5" y="-66267.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="979.5" y="-66252.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="979.5" y="-66237.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer45_ffn_ar&#45;&gt;layer46_norm_5 -->
<g id="edge1489" class="edge">
<title>layer45_ffn_ar&#45;&gt;layer46_norm_5</title>
<path fill="none" stroke="black" d="M944.31,-66378.9C944.31,-66378.9 944.31,-66308.33 944.31,-66308.33"/>
<polygon fill="black" stroke="black" points="947.81,-66308.33 944.31,-66298.33 940.81,-66308.33 947.81,-66308.33"/>
</g>
<!-- layer46_qkv_4 -->
<g id="node1168" class="node">
<title>layer46_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="856,-66158.1 675,-66158.1 675,-66090.1 856,-66090.1 856,-66158.1"/>
<text text-anchor="middle" x="765.5" y="-66142.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="765.5" y="-66127.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="765.5" y="-66112.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="765.5" y="-66097.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer46_norm_4&#45;&gt;layer46_qkv_4 -->
<g id="edge1490" class="edge">
<title>layer46_norm_4&#45;&gt;layer46_qkv_4</title>
<path fill="none" stroke="black" d="M769.5,-66229.85C769.5,-66229.85 769.5,-66168.48 769.5,-66168.48"/>
<polygon fill="black" stroke="black" points="773,-66168.48 769.5,-66158.48 766,-66168.48 773,-66168.48"/>
</g>
<!-- layer46_qkv_5 -->
<g id="node1169" class="node">
<title>layer46_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1073,-66158.1 892,-66158.1 892,-66090.1 1073,-66090.1 1073,-66158.1"/>
<text text-anchor="middle" x="982.5" y="-66142.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="982.5" y="-66127.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="982.5" y="-66112.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="982.5" y="-66097.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer46_norm_5&#45;&gt;layer46_qkv_5 -->
<g id="edge1491" class="edge">
<title>layer46_norm_5&#45;&gt;layer46_qkv_5</title>
<path fill="none" stroke="black" d="M979.5,-66229.85C979.5,-66229.85 979.5,-66168.48 979.5,-66168.48"/>
<polygon fill="black" stroke="black" points="983,-66168.48 979.5,-66158.48 976,-66168.48 983,-66168.48"/>
</g>
<!-- layer46_qkv_ar -->
<g id="node1170" class="node">
<title>layer46_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="873.5" cy="-65970.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="873.5" y="-65988.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="873.5" y="-65973.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="873.5" y="-65958.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="873.5" y="-65943.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer46_qkv_4&#45;&gt;layer46_qkv_ar -->
<g id="edge1492" class="edge">
<title>layer46_qkv_4&#45;&gt;layer46_qkv_ar</title>
<path fill="none" stroke="black" d="M800.76,-66089.9C800.76,-66089.9 800.76,-66019.84 800.76,-66019.84"/>
<polygon fill="black" stroke="black" points="804.26,-66019.84 800.76,-66009.84 797.26,-66019.84 804.26,-66019.84"/>
</g>
<!-- layer46_qkv_5&#45;&gt;layer46_qkv_ar -->
<g id="edge1493" class="edge">
<title>layer46_qkv_5&#45;&gt;layer46_qkv_ar</title>
<path fill="none" stroke="black" d="M946.74,-66089.9C946.74,-66089.9 946.74,-66019.56 946.74,-66019.56"/>
<polygon fill="black" stroke="black" points="950.24,-66019.56 946.74,-66009.56 943.24,-66019.56 950.24,-66019.56"/>
</g>
<!-- layer46_attn_4 -->
<g id="node1171" class="node">
<title>layer46_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="855.5,-65849.93 683.5,-65849.93 683.5,-65781.93 855.5,-65781.93 855.5,-65849.93"/>
<text text-anchor="middle" x="769.5" y="-65834.73" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="769.5" y="-65819.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="769.5" y="-65804.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="769.5" y="-65789.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer46_qkv_ar&#45;&gt;layer46_attn_4 -->
<g id="edge1494" class="edge">
<title>layer46_qkv_ar&#45;&gt;layer46_attn_4</title>
<path fill="none" stroke="black" d="M800.51,-65930.34C800.51,-65930.34 800.51,-65859.99 800.51,-65859.99"/>
<polygon fill="black" stroke="black" points="804.01,-65859.99 800.51,-65849.99 797.01,-65859.99 804.01,-65859.99"/>
</g>
<!-- layer46_attn_5 -->
<g id="node1172" class="node">
<title>layer46_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1063.5,-65849.93 891.5,-65849.93 891.5,-65781.93 1063.5,-65781.93 1063.5,-65849.93"/>
<text text-anchor="middle" x="977.5" y="-65834.73" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="977.5" y="-65819.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="977.5" y="-65804.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="977.5" y="-65789.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer46_qkv_ar&#45;&gt;layer46_attn_5 -->
<g id="edge1495" class="edge">
<title>layer46_qkv_ar&#45;&gt;layer46_attn_5</title>
<path fill="none" stroke="black" d="M946.49,-65930.34C946.49,-65930.34 946.49,-65859.99 946.49,-65859.99"/>
<polygon fill="black" stroke="black" points="949.99,-65859.99 946.49,-65849.99 942.99,-65859.99 949.99,-65859.99"/>
</g>
<!-- layer46_attn_out_4 -->
<g id="node1173" class="node">
<title>layer46_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="855.5,-65709.93 683.5,-65709.93 683.5,-65641.93 855.5,-65641.93 855.5,-65709.93"/>
<text text-anchor="middle" x="769.5" y="-65694.73" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="769.5" y="-65679.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="769.5" y="-65664.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="769.5" y="-65649.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer46_attn_4&#45;&gt;layer46_attn_out_4 -->
<g id="edge1496" class="edge">
<title>layer46_attn_4&#45;&gt;layer46_attn_out_4</title>
<path fill="none" stroke="black" d="M769.5,-65781.69C769.5,-65781.69 769.5,-65720.31 769.5,-65720.31"/>
<polygon fill="black" stroke="black" points="773,-65720.31 769.5,-65710.31 766,-65720.31 773,-65720.31"/>
</g>
<!-- layer46_attn_out_5 -->
<g id="node1174" class="node">
<title>layer46_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1063.5,-65709.93 891.5,-65709.93 891.5,-65641.93 1063.5,-65641.93 1063.5,-65709.93"/>
<text text-anchor="middle" x="977.5" y="-65694.73" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="977.5" y="-65679.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="977.5" y="-65664.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="977.5" y="-65649.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer46_attn_5&#45;&gt;layer46_attn_out_5 -->
<g id="edge1497" class="edge">
<title>layer46_attn_5&#45;&gt;layer46_attn_out_5</title>
<path fill="none" stroke="black" d="M977.5,-65781.69C977.5,-65781.69 977.5,-65720.31 977.5,-65720.31"/>
<polygon fill="black" stroke="black" points="981,-65720.31 977.5,-65710.31 974,-65720.31 981,-65720.31"/>
</g>
<!-- layer46_attn_ar -->
<g id="node1175" class="node">
<title>layer46_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="873.5" cy="-65521.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="873.5" y="-65540.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="873.5" y="-65525.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="873.5" y="-65510.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="873.5" y="-65495.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer46_attn_out_4&#45;&gt;layer46_attn_ar -->
<g id="edge1498" class="edge">
<title>layer46_attn_out_4&#45;&gt;layer46_attn_ar</title>
<path fill="none" stroke="black" d="M803.69,-65641.74C803.69,-65641.74 803.69,-65571.39 803.69,-65571.39"/>
<polygon fill="black" stroke="black" points="807.19,-65571.39 803.69,-65561.39 800.19,-65571.39 807.19,-65571.39"/>
</g>
<!-- layer46_attn_out_5&#45;&gt;layer46_attn_ar -->
<g id="edge1499" class="edge">
<title>layer46_attn_out_5&#45;&gt;layer46_attn_ar</title>
<path fill="none" stroke="black" d="M943.31,-65641.74C943.31,-65641.74 943.31,-65571.39 943.31,-65571.39"/>
<polygon fill="black" stroke="black" points="946.81,-65571.39 943.31,-65561.39 939.81,-65571.39 946.81,-65571.39"/>
</g>
<!-- layer46_ffn_norm_4 -->
<g id="node1176" class="node">
<title>layer46_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="851.5,-65401.77 679.5,-65401.77 679.5,-65333.77 851.5,-65333.77 851.5,-65401.77"/>
<text text-anchor="middle" x="765.5" y="-65386.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="765.5" y="-65371.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="765.5" y="-65356.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="765.5" y="-65341.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer46_attn_ar&#45;&gt;layer46_ffn_norm_4 -->
<g id="edge1500" class="edge">
<title>layer46_attn_ar&#45;&gt;layer46_ffn_norm_4</title>
<path fill="none" stroke="black" d="M801.69,-65482.97C801.69,-65482.97 801.69,-65411.92 801.69,-65411.92"/>
<polygon fill="black" stroke="black" points="805.19,-65411.92 801.69,-65401.92 798.19,-65411.92 805.19,-65411.92"/>
</g>
<!-- layer46_ffn_norm_5 -->
<g id="node1177" class="node">
<title>layer46_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1068.5,-65401.77 896.5,-65401.77 896.5,-65333.77 1068.5,-65333.77 1068.5,-65401.77"/>
<text text-anchor="middle" x="982.5" y="-65386.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="982.5" y="-65371.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="982.5" y="-65356.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="982.5" y="-65341.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer46_attn_ar&#45;&gt;layer46_ffn_norm_5 -->
<g id="edge1501" class="edge">
<title>layer46_attn_ar&#45;&gt;layer46_ffn_norm_5</title>
<path fill="none" stroke="black" d="M945.81,-65482.97C945.81,-65482.97 945.81,-65411.92 945.81,-65411.92"/>
<polygon fill="black" stroke="black" points="949.31,-65411.92 945.81,-65401.92 942.31,-65411.92 949.31,-65411.92"/>
</g>
<!-- layer46_ffn_gate_4 -->
<g id="node1178" class="node">
<title>layer46_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="856,-65261.77 675,-65261.77 675,-65193.77 856,-65193.77 856,-65261.77"/>
<text text-anchor="middle" x="765.5" y="-65246.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="765.5" y="-65231.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="765.5" y="-65216.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="765.5" y="-65201.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_ffn_norm_4&#45;&gt;layer46_ffn_gate_4 -->
<g id="edge1502" class="edge">
<title>layer46_ffn_norm_4&#45;&gt;layer46_ffn_gate_4</title>
<path fill="none" stroke="black" d="M765.5,-65333.52C765.5,-65333.52 765.5,-65272.15 765.5,-65272.15"/>
<polygon fill="black" stroke="black" points="769,-65272.15 765.5,-65262.15 762,-65272.15 769,-65272.15"/>
</g>
<!-- layer46_ffn_up_4 -->
<g id="node1180" class="node">
<title>layer46_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="639,-65261.77 458,-65261.77 458,-65193.77 639,-65193.77 639,-65261.77"/>
<text text-anchor="middle" x="548.5" y="-65246.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="548.5" y="-65231.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="548.5" y="-65216.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="548.5" y="-65201.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_ffn_norm_4&#45;&gt;layer46_ffn_up_4 -->
<g id="edge1504" class="edge">
<title>layer46_ffn_norm_4&#45;&gt;layer46_ffn_up_4</title>
<path fill="none" stroke="black" d="M679.31,-65367C639.86,-65367 601.76,-65367 601.76,-65367 601.76,-65367 601.76,-65271.83 601.76,-65271.83"/>
<polygon fill="black" stroke="black" points="605.26,-65271.83 601.76,-65261.83 598.26,-65271.83 605.26,-65271.83"/>
</g>
<!-- layer46_ffn_gate_5 -->
<g id="node1179" class="node">
<title>layer46_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1290,-65261.77 1109,-65261.77 1109,-65193.77 1290,-65193.77 1290,-65261.77"/>
<text text-anchor="middle" x="1199.5" y="-65246.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1199.5" y="-65231.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1199.5" y="-65216.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1199.5" y="-65201.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_ffn_norm_5&#45;&gt;layer46_ffn_gate_5 -->
<g id="edge1503" class="edge">
<title>layer46_ffn_norm_5&#45;&gt;layer46_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1068.56,-65367C1107.95,-65367 1146,-65367 1146,-65367 1146,-65367 1146,-65271.83 1146,-65271.83"/>
<polygon fill="black" stroke="black" points="1149.5,-65271.83 1146,-65261.83 1142.5,-65271.83 1149.5,-65271.83"/>
</g>
<!-- layer46_ffn_up_5 -->
<g id="node1181" class="node">
<title>layer46_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1073,-65261.77 892,-65261.77 892,-65193.77 1073,-65193.77 1073,-65261.77"/>
<text text-anchor="middle" x="982.5" y="-65246.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="982.5" y="-65231.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="982.5" y="-65216.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="982.5" y="-65201.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_ffn_norm_5&#45;&gt;layer46_ffn_up_5 -->
<g id="edge1505" class="edge">
<title>layer46_ffn_norm_5&#45;&gt;layer46_ffn_up_5</title>
<path fill="none" stroke="black" d="M982.5,-65333.52C982.5,-65333.52 982.5,-65272.15 982.5,-65272.15"/>
<polygon fill="black" stroke="black" points="986,-65272.15 982.5,-65262.15 979,-65272.15 986,-65272.15"/>
</g>
<!-- layer46_gate_ar -->
<g id="node1182" class="node">
<title>layer46_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1073.5" cy="-65073.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1073.5" y="-65092.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1073.5" y="-65077.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1073.5" y="-65062.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1073.5" y="-65047.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer46_ffn_gate_4&#45;&gt;layer46_gate_ar -->
<g id="edge1506" class="edge">
<title>layer46_ffn_gate_4&#45;&gt;layer46_gate_ar</title>
<path fill="none" stroke="black" d="M856.08,-65227C866.79,-65227 874,-65227 874,-65227 874,-65227 874,-65089 874,-65089 874,-65089 941.99,-65089 941.99,-65089"/>
<polygon fill="black" stroke="black" points="941.99,-65092.5 951.99,-65089 941.99,-65085.5 941.99,-65092.5"/>
</g>
<!-- layer46_ffn_gate_5&#45;&gt;layer46_gate_ar -->
<g id="edge1507" class="edge">
<title>layer46_ffn_gate_5&#45;&gt;layer46_gate_ar</title>
<path fill="none" stroke="black" d="M1155.24,-65193.57C1155.24,-65193.57 1155.24,-65120.75 1155.24,-65120.75"/>
<polygon fill="black" stroke="black" points="1158.74,-65120.75 1155.24,-65110.75 1151.74,-65120.75 1158.74,-65120.75"/>
</g>
<!-- layer46_up_ar -->
<g id="node1183" class="node">
<title>layer46_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="727.5" cy="-65073.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="727.5" y="-65092.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="727.5" y="-65077.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="727.5" y="-65062.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="727.5" y="-65047.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer46_ffn_up_4&#45;&gt;layer46_up_ar -->
<g id="edge1508" class="edge">
<title>layer46_ffn_up_4&#45;&gt;layer46_up_ar</title>
<path fill="none" stroke="black" d="M619.26,-65193.57C619.26,-65193.57 619.26,-65109.65 619.26,-65109.65"/>
<polygon fill="black" stroke="black" points="622.76,-65109.65 619.26,-65099.65 615.76,-65109.65 622.76,-65109.65"/>
</g>
<!-- layer46_ffn_up_5&#45;&gt;layer46_up_ar -->
<g id="edge1509" class="edge">
<title>layer46_ffn_up_5&#45;&gt;layer46_up_ar</title>
<path fill="none" stroke="black" d="M918.76,-65193.62C918.76,-65143.79 918.76,-65057 918.76,-65057 918.76,-65057 857.54,-65057 857.54,-65057"/>
<polygon fill="black" stroke="black" points="857.54,-65053.5 847.54,-65057 857.54,-65060.5 857.54,-65053.5"/>
</g>
<!-- layer46_silu_4 -->
<g id="node1184" class="node">
<title>layer46_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1001,-64953.6 820,-64953.6 820,-64885.6 1001,-64885.6 1001,-64953.6"/>
<text text-anchor="middle" x="910.5" y="-64938.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="910.5" y="-64923.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="910.5" y="-64908.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="910.5" y="-64893.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_gate_ar&#45;&gt;layer46_silu_4 -->
<g id="edge1510" class="edge">
<title>layer46_gate_ar&#45;&gt;layer46_silu_4</title>
<path fill="none" stroke="black" d="M973.26,-65043.61C973.26,-65043.61 973.26,-64963.62 973.26,-64963.62"/>
<polygon fill="black" stroke="black" points="976.76,-64963.62 973.26,-64953.62 969.76,-64963.62 976.76,-64963.62"/>
</g>
<!-- layer46_silu_5 -->
<g id="node1185" class="node">
<title>layer46_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1218,-64953.6 1037,-64953.6 1037,-64885.6 1218,-64885.6 1218,-64953.6"/>
<text text-anchor="middle" x="1127.5" y="-64938.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1127.5" y="-64923.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1127.5" y="-64908.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1127.5" y="-64893.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_gate_ar&#45;&gt;layer46_silu_5 -->
<g id="edge1511" class="edge">
<title>layer46_gate_ar&#45;&gt;layer46_silu_5</title>
<path fill="none" stroke="black" d="M1119.24,-65028.7C1119.24,-65028.7 1119.24,-64963.61 1119.24,-64963.61"/>
<polygon fill="black" stroke="black" points="1122.74,-64963.61 1119.24,-64953.61 1115.74,-64963.61 1122.74,-64963.61"/>
</g>
<!-- layer46_mul_4 -->
<g id="node1186" class="node">
<title>layer46_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="891,-64813.6 710,-64813.6 710,-64745.6 891,-64745.6 891,-64813.6"/>
<text text-anchor="middle" x="800.5" y="-64798.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="800.5" y="-64783.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="800.5" y="-64768.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="800.5" y="-64753.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_up_ar&#45;&gt;layer46_mul_4 -->
<g id="edge1513" class="edge">
<title>layer46_up_ar&#45;&gt;layer46_mul_4</title>
<path fill="none" stroke="black" d="M765,-65027.41C765,-65027.41 765,-64823.69 765,-64823.69"/>
<polygon fill="black" stroke="black" points="768.5,-64823.69 765,-64813.69 761.5,-64823.69 768.5,-64823.69"/>
</g>
<!-- layer46_mul_5 -->
<g id="node1187" class="node">
<title>layer46_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1108,-64813.6 927,-64813.6 927,-64745.6 1108,-64745.6 1108,-64813.6"/>
<text text-anchor="middle" x="1017.5" y="-64798.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1017.5" y="-64783.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1017.5" y="-64768.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1017.5" y="-64753.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer46_up_ar&#45;&gt;layer46_mul_5 -->
<g id="edge1515" class="edge">
<title>layer46_up_ar&#45;&gt;layer46_mul_5</title>
<path fill="none" stroke="black" d="M837.74,-65049.19C837.74,-65024.18 837.74,-64989 837.74,-64989 837.74,-64989 1019,-64989 1019,-64989 1019,-64989 1019,-64823.71 1019,-64823.71"/>
<polygon fill="black" stroke="black" points="1022.5,-64823.71 1019,-64813.71 1015.5,-64823.71 1022.5,-64823.71"/>
</g>
<!-- layer46_silu_4&#45;&gt;layer46_mul_4 -->
<g id="edge1512" class="edge">
<title>layer46_silu_4&#45;&gt;layer46_mul_4</title>
<path fill="none" stroke="black" d="M855.5,-64885.35C855.5,-64885.35 855.5,-64823.98 855.5,-64823.98"/>
<polygon fill="black" stroke="black" points="859,-64823.98 855.5,-64813.98 852,-64823.98 859,-64823.98"/>
</g>
<!-- layer46_silu_5&#45;&gt;layer46_mul_5 -->
<g id="edge1514" class="edge">
<title>layer46_silu_5&#45;&gt;layer46_mul_5</title>
<path fill="none" stroke="black" d="M1072.5,-64885.35C1072.5,-64885.35 1072.5,-64823.98 1072.5,-64823.98"/>
<polygon fill="black" stroke="black" points="1076,-64823.98 1072.5,-64813.98 1069,-64823.98 1076,-64823.98"/>
</g>
<!-- layer46_ffn_down_4 -->
<g id="node1188" class="node">
<title>layer46_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="889.5,-64673.6 717.5,-64673.6 717.5,-64605.6 889.5,-64605.6 889.5,-64673.6"/>
<text text-anchor="middle" x="803.5" y="-64658.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="803.5" y="-64643.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="803.5" y="-64628.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="803.5" y="-64613.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer46_mul_4&#45;&gt;layer46_ffn_down_4 -->
<g id="edge1516" class="edge">
<title>layer46_mul_4&#45;&gt;layer46_ffn_down_4</title>
<path fill="none" stroke="black" d="M803.5,-64745.35C803.5,-64745.35 803.5,-64683.98 803.5,-64683.98"/>
<polygon fill="black" stroke="black" points="807,-64683.98 803.5,-64673.98 800,-64683.98 807,-64683.98"/>
</g>
<!-- layer46_ffn_down_5 -->
<g id="node1189" class="node">
<title>layer46_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1099.5,-64673.6 927.5,-64673.6 927.5,-64605.6 1099.5,-64605.6 1099.5,-64673.6"/>
<text text-anchor="middle" x="1013.5" y="-64658.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1013.5" y="-64643.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1013.5" y="-64628.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1013.5" y="-64613.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer46_mul_5&#45;&gt;layer46_ffn_down_5 -->
<g id="edge1517" class="edge">
<title>layer46_mul_5&#45;&gt;layer46_ffn_down_5</title>
<path fill="none" stroke="black" d="M1013.5,-64745.35C1013.5,-64745.35 1013.5,-64683.98 1013.5,-64683.98"/>
<polygon fill="black" stroke="black" points="1017,-64683.98 1013.5,-64673.98 1010,-64683.98 1017,-64683.98"/>
</g>
<!-- layer46_ffn_ar -->
<g id="node1190" class="node">
<title>layer46_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="907.5" cy="-64485.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="907.5" y="-64504.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="907.5" y="-64489.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="907.5" y="-64474.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="907.5" y="-64459.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer46_ffn_down_4&#45;&gt;layer46_ffn_ar -->
<g id="edge1518" class="edge">
<title>layer46_ffn_down_4&#45;&gt;layer46_ffn_ar</title>
<path fill="none" stroke="black" d="M837.69,-64605.4C837.69,-64605.4 837.69,-64535.06 837.69,-64535.06"/>
<polygon fill="black" stroke="black" points="841.19,-64535.06 837.69,-64525.06 834.19,-64535.06 841.19,-64535.06"/>
</g>
<!-- layer46_ffn_down_5&#45;&gt;layer46_ffn_ar -->
<g id="edge1519" class="edge">
<title>layer46_ffn_down_5&#45;&gt;layer46_ffn_ar</title>
<path fill="none" stroke="black" d="M978.31,-64605.4C978.31,-64605.4 978.31,-64534.78 978.31,-64534.78"/>
<polygon fill="black" stroke="black" points="981.81,-64534.78 978.31,-64524.78 974.81,-64534.78 981.81,-64534.78"/>
</g>
<!-- layer47_norm_4 -->
<g id="node1191" class="node">
<title>layer47_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="889.5,-64365.43 717.5,-64365.43 717.5,-64297.43 889.5,-64297.43 889.5,-64365.43"/>
<text text-anchor="middle" x="803.5" y="-64350.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="803.5" y="-64335.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="803.5" y="-64320.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="803.5" y="-64305.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer46_ffn_ar&#45;&gt;layer47_norm_4 -->
<g id="edge1520" class="edge">
<title>layer46_ffn_ar&#45;&gt;layer47_norm_4</title>
<path fill="none" stroke="black" d="M837.69,-64445.84C837.69,-64445.84 837.69,-64375.49 837.69,-64375.49"/>
<polygon fill="black" stroke="black" points="841.19,-64375.49 837.69,-64365.49 834.19,-64375.49 841.19,-64375.49"/>
</g>
<!-- layer47_norm_5 -->
<g id="node1192" class="node">
<title>layer47_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1099.5,-64365.43 927.5,-64365.43 927.5,-64297.43 1099.5,-64297.43 1099.5,-64365.43"/>
<text text-anchor="middle" x="1013.5" y="-64350.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1013.5" y="-64335.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1013.5" y="-64320.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1013.5" y="-64305.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer46_ffn_ar&#45;&gt;layer47_norm_5 -->
<g id="edge1521" class="edge">
<title>layer46_ffn_ar&#45;&gt;layer47_norm_5</title>
<path fill="none" stroke="black" d="M978.31,-64446.24C978.31,-64446.24 978.31,-64375.67 978.31,-64375.67"/>
<polygon fill="black" stroke="black" points="981.81,-64375.66 978.31,-64365.67 974.81,-64375.67 981.81,-64375.66"/>
</g>
<!-- layer47_qkv_4 -->
<g id="node1193" class="node">
<title>layer47_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="890,-64225.43 709,-64225.43 709,-64157.43 890,-64157.43 890,-64225.43"/>
<text text-anchor="middle" x="799.5" y="-64210.23" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="799.5" y="-64195.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="799.5" y="-64180.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="799.5" y="-64165.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer47_norm_4&#45;&gt;layer47_qkv_4 -->
<g id="edge1522" class="edge">
<title>layer47_norm_4&#45;&gt;layer47_qkv_4</title>
<path fill="none" stroke="black" d="M803.5,-64297.19C803.5,-64297.19 803.5,-64235.81 803.5,-64235.81"/>
<polygon fill="black" stroke="black" points="807,-64235.81 803.5,-64225.81 800,-64235.81 807,-64235.81"/>
</g>
<!-- layer47_qkv_5 -->
<g id="node1194" class="node">
<title>layer47_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1107,-64225.43 926,-64225.43 926,-64157.43 1107,-64157.43 1107,-64225.43"/>
<text text-anchor="middle" x="1016.5" y="-64210.23" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1016.5" y="-64195.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1016.5" y="-64180.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-64165.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer47_norm_5&#45;&gt;layer47_qkv_5 -->
<g id="edge1523" class="edge">
<title>layer47_norm_5&#45;&gt;layer47_qkv_5</title>
<path fill="none" stroke="black" d="M1013.5,-64297.19C1013.5,-64297.19 1013.5,-64235.81 1013.5,-64235.81"/>
<polygon fill="black" stroke="black" points="1017,-64235.81 1013.5,-64225.81 1010,-64235.81 1017,-64235.81"/>
</g>
<!-- layer47_qkv_ar -->
<g id="node1195" class="node">
<title>layer47_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="907.5" cy="-64037.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="907.5" y="-64056.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="907.5" y="-64041.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="907.5" y="-64026.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="907.5" y="-64011.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer47_qkv_4&#45;&gt;layer47_qkv_ar -->
<g id="edge1524" class="edge">
<title>layer47_qkv_4&#45;&gt;layer47_qkv_ar</title>
<path fill="none" stroke="black" d="M834.76,-64157.24C834.76,-64157.24 834.76,-64087.17 834.76,-64087.17"/>
<polygon fill="black" stroke="black" points="838.26,-64087.17 834.76,-64077.17 831.26,-64087.17 838.26,-64087.17"/>
</g>
<!-- layer47_qkv_5&#45;&gt;layer47_qkv_ar -->
<g id="edge1525" class="edge">
<title>layer47_qkv_5&#45;&gt;layer47_qkv_ar</title>
<path fill="none" stroke="black" d="M980.74,-64157.24C980.74,-64157.24 980.74,-64086.89 980.74,-64086.89"/>
<polygon fill="black" stroke="black" points="984.24,-64086.89 980.74,-64076.89 977.24,-64086.89 984.24,-64086.89"/>
</g>
<!-- layer47_attn_4 -->
<g id="node1196" class="node">
<title>layer47_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="889.5,-63917.27 717.5,-63917.27 717.5,-63849.27 889.5,-63849.27 889.5,-63917.27"/>
<text text-anchor="middle" x="803.5" y="-63902.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="803.5" y="-63887.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="803.5" y="-63872.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="803.5" y="-63857.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer47_qkv_ar&#45;&gt;layer47_attn_4 -->
<g id="edge1526" class="edge">
<title>layer47_qkv_ar&#45;&gt;layer47_attn_4</title>
<path fill="none" stroke="black" d="M834.51,-63997.67C834.51,-63997.67 834.51,-63927.32 834.51,-63927.32"/>
<polygon fill="black" stroke="black" points="838.01,-63927.32 834.51,-63917.32 831.01,-63927.32 838.01,-63927.32"/>
</g>
<!-- layer47_attn_5 -->
<g id="node1197" class="node">
<title>layer47_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1097.5,-63917.27 925.5,-63917.27 925.5,-63849.27 1097.5,-63849.27 1097.5,-63917.27"/>
<text text-anchor="middle" x="1011.5" y="-63902.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1011.5" y="-63887.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1011.5" y="-63872.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1011.5" y="-63857.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer47_qkv_ar&#45;&gt;layer47_attn_5 -->
<g id="edge1527" class="edge">
<title>layer47_qkv_ar&#45;&gt;layer47_attn_5</title>
<path fill="none" stroke="black" d="M980.49,-63997.67C980.49,-63997.67 980.49,-63927.32 980.49,-63927.32"/>
<polygon fill="black" stroke="black" points="983.99,-63927.32 980.49,-63917.32 976.99,-63927.32 983.99,-63927.32"/>
</g>
<!-- layer47_attn_out_4 -->
<g id="node1198" class="node">
<title>layer47_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="889.5,-63777.27 717.5,-63777.27 717.5,-63709.27 889.5,-63709.27 889.5,-63777.27"/>
<text text-anchor="middle" x="803.5" y="-63762.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="803.5" y="-63747.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="803.5" y="-63732.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="803.5" y="-63717.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer47_attn_4&#45;&gt;layer47_attn_out_4 -->
<g id="edge1528" class="edge">
<title>layer47_attn_4&#45;&gt;layer47_attn_out_4</title>
<path fill="none" stroke="black" d="M803.5,-63849.02C803.5,-63849.02 803.5,-63787.65 803.5,-63787.65"/>
<polygon fill="black" stroke="black" points="807,-63787.65 803.5,-63777.65 800,-63787.65 807,-63787.65"/>
</g>
<!-- layer47_attn_out_5 -->
<g id="node1199" class="node">
<title>layer47_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1097.5,-63777.27 925.5,-63777.27 925.5,-63709.27 1097.5,-63709.27 1097.5,-63777.27"/>
<text text-anchor="middle" x="1011.5" y="-63762.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1011.5" y="-63747.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1011.5" y="-63732.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1011.5" y="-63717.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer47_attn_5&#45;&gt;layer47_attn_out_5 -->
<g id="edge1529" class="edge">
<title>layer47_attn_5&#45;&gt;layer47_attn_out_5</title>
<path fill="none" stroke="black" d="M1011.5,-63849.02C1011.5,-63849.02 1011.5,-63787.65 1011.5,-63787.65"/>
<polygon fill="black" stroke="black" points="1015,-63787.65 1011.5,-63777.65 1008,-63787.65 1015,-63787.65"/>
</g>
<!-- layer47_attn_ar -->
<g id="node1200" class="node">
<title>layer47_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="907.5" cy="-63589.18" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="907.5" y="-63607.98" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="907.5" y="-63592.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="907.5" y="-63577.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="907.5" y="-63562.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer47_attn_out_4&#45;&gt;layer47_attn_ar -->
<g id="edge1530" class="edge">
<title>layer47_attn_out_4&#45;&gt;layer47_attn_ar</title>
<path fill="none" stroke="black" d="M837.69,-63709.07C837.69,-63709.07 837.69,-63638.73 837.69,-63638.73"/>
<polygon fill="black" stroke="black" points="841.19,-63638.73 837.69,-63628.73 834.19,-63638.73 841.19,-63638.73"/>
</g>
<!-- layer47_attn_out_5&#45;&gt;layer47_attn_ar -->
<g id="edge1531" class="edge">
<title>layer47_attn_out_5&#45;&gt;layer47_attn_ar</title>
<path fill="none" stroke="black" d="M977.31,-63709.07C977.31,-63709.07 977.31,-63638.73 977.31,-63638.73"/>
<polygon fill="black" stroke="black" points="980.81,-63638.73 977.31,-63628.73 973.81,-63638.73 980.81,-63638.73"/>
</g>
<!-- layer47_ffn_norm_4 -->
<g id="node1201" class="node">
<title>layer47_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="885.5,-63469.1 713.5,-63469.1 713.5,-63401.1 885.5,-63401.1 885.5,-63469.1"/>
<text text-anchor="middle" x="799.5" y="-63453.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="799.5" y="-63438.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="799.5" y="-63423.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="799.5" y="-63408.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer47_attn_ar&#45;&gt;layer47_ffn_norm_4 -->
<g id="edge1532" class="edge">
<title>layer47_attn_ar&#45;&gt;layer47_ffn_norm_4</title>
<path fill="none" stroke="black" d="M835.69,-63550.3C835.69,-63550.3 835.69,-63479.25 835.69,-63479.25"/>
<polygon fill="black" stroke="black" points="839.19,-63479.25 835.69,-63469.25 832.19,-63479.25 839.19,-63479.25"/>
</g>
<!-- layer47_ffn_norm_5 -->
<g id="node1202" class="node">
<title>layer47_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1102.5,-63469.1 930.5,-63469.1 930.5,-63401.1 1102.5,-63401.1 1102.5,-63469.1"/>
<text text-anchor="middle" x="1016.5" y="-63453.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1016.5" y="-63438.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1016.5" y="-63423.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-63408.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer47_attn_ar&#45;&gt;layer47_ffn_norm_5 -->
<g id="edge1533" class="edge">
<title>layer47_attn_ar&#45;&gt;layer47_ffn_norm_5</title>
<path fill="none" stroke="black" d="M979.81,-63550.3C979.81,-63550.3 979.81,-63479.25 979.81,-63479.25"/>
<polygon fill="black" stroke="black" points="983.31,-63479.25 979.81,-63469.25 976.31,-63479.25 983.31,-63479.25"/>
</g>
<!-- layer47_ffn_gate_4 -->
<g id="node1203" class="node">
<title>layer47_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="890,-63329.1 709,-63329.1 709,-63261.1 890,-63261.1 890,-63329.1"/>
<text text-anchor="middle" x="799.5" y="-63313.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="799.5" y="-63298.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="799.5" y="-63283.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="799.5" y="-63268.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_ffn_norm_4&#45;&gt;layer47_ffn_gate_4 -->
<g id="edge1534" class="edge">
<title>layer47_ffn_norm_4&#45;&gt;layer47_ffn_gate_4</title>
<path fill="none" stroke="black" d="M799.5,-63400.85C799.5,-63400.85 799.5,-63339.48 799.5,-63339.48"/>
<polygon fill="black" stroke="black" points="803,-63339.48 799.5,-63329.48 796,-63339.48 803,-63339.48"/>
</g>
<!-- layer47_ffn_up_4 -->
<g id="node1205" class="node">
<title>layer47_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="673,-63329.1 492,-63329.1 492,-63261.1 673,-63261.1 673,-63329.1"/>
<text text-anchor="middle" x="582.5" y="-63313.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="582.5" y="-63298.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="582.5" y="-63283.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="582.5" y="-63268.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_ffn_norm_4&#45;&gt;layer47_ffn_up_4 -->
<g id="edge1536" class="edge">
<title>layer47_ffn_norm_4&#45;&gt;layer47_ffn_up_4</title>
<path fill="none" stroke="black" d="M713.1,-63435C673.94,-63435 636.26,-63435 636.26,-63435 636.26,-63435 636.26,-63339.32 636.26,-63339.32"/>
<polygon fill="black" stroke="black" points="639.76,-63339.32 636.26,-63329.32 632.76,-63339.32 639.76,-63339.32"/>
</g>
<!-- layer47_ffn_gate_5 -->
<g id="node1204" class="node">
<title>layer47_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1324,-63329.1 1143,-63329.1 1143,-63261.1 1324,-63261.1 1324,-63329.1"/>
<text text-anchor="middle" x="1233.5" y="-63313.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1233.5" y="-63298.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1233.5" y="-63283.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1233.5" y="-63268.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_ffn_norm_5&#45;&gt;layer47_ffn_gate_5 -->
<g id="edge1535" class="edge">
<title>layer47_ffn_norm_5&#45;&gt;layer47_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1102.82,-63435C1142.33,-63435 1180.5,-63435 1180.5,-63435 1180.5,-63435 1180.5,-63339.32 1180.5,-63339.32"/>
<polygon fill="black" stroke="black" points="1184,-63339.32 1180.5,-63329.32 1177,-63339.32 1184,-63339.32"/>
</g>
<!-- layer47_ffn_up_5 -->
<g id="node1206" class="node">
<title>layer47_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1107,-63329.1 926,-63329.1 926,-63261.1 1107,-63261.1 1107,-63329.1"/>
<text text-anchor="middle" x="1016.5" y="-63313.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1016.5" y="-63298.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1016.5" y="-63283.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1016.5" y="-63268.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_ffn_norm_5&#45;&gt;layer47_ffn_up_5 -->
<g id="edge1537" class="edge">
<title>layer47_ffn_norm_5&#45;&gt;layer47_ffn_up_5</title>
<path fill="none" stroke="black" d="M1016.5,-63400.85C1016.5,-63400.85 1016.5,-63339.48 1016.5,-63339.48"/>
<polygon fill="black" stroke="black" points="1020,-63339.48 1016.5,-63329.48 1013,-63339.48 1020,-63339.48"/>
</g>
<!-- layer47_gate_ar -->
<g id="node1207" class="node">
<title>layer47_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1107.5" cy="-63141.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1107.5" y="-63159.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1107.5" y="-63144.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1107.5" y="-63129.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1107.5" y="-63114.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer47_ffn_gate_4&#45;&gt;layer47_gate_ar -->
<g id="edge1538" class="edge">
<title>layer47_ffn_gate_4&#45;&gt;layer47_gate_ar</title>
<path fill="none" stroke="black" d="M890.08,-63295C900.79,-63295 908,-63295 908,-63295 908,-63295 908,-63157 908,-63157 908,-63157 976.56,-63157 976.56,-63157"/>
<polygon fill="black" stroke="black" points="976.56,-63160.5 986.56,-63157 976.56,-63153.5 976.56,-63160.5"/>
</g>
<!-- layer47_ffn_gate_5&#45;&gt;layer47_gate_ar -->
<g id="edge1539" class="edge">
<title>layer47_ffn_gate_5&#45;&gt;layer47_gate_ar</title>
<path fill="none" stroke="black" d="M1189.24,-63260.9C1189.24,-63260.9 1189.24,-63188.08 1189.24,-63188.08"/>
<polygon fill="black" stroke="black" points="1192.74,-63188.08 1189.24,-63178.08 1185.74,-63188.08 1192.74,-63188.08"/>
</g>
<!-- layer47_up_ar -->
<g id="node1208" class="node">
<title>layer47_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="761.5" cy="-63141.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="761.5" y="-63159.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="761.5" y="-63144.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="761.5" y="-63129.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="761.5" y="-63114.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer47_ffn_up_4&#45;&gt;layer47_up_ar -->
<g id="edge1540" class="edge">
<title>layer47_ffn_up_4&#45;&gt;layer47_up_ar</title>
<path fill="none" stroke="black" d="M653.26,-63260.9C653.26,-63260.9 653.26,-63176.98 653.26,-63176.98"/>
<polygon fill="black" stroke="black" points="656.76,-63176.98 653.26,-63166.98 649.76,-63176.98 656.76,-63176.98"/>
</g>
<!-- layer47_ffn_up_5&#45;&gt;layer47_up_ar -->
<g id="edge1541" class="edge">
<title>layer47_ffn_up_5&#45;&gt;layer47_up_ar</title>
<path fill="none" stroke="black" d="M952.76,-63260.89C952.76,-63210.96 952.76,-63124 952.76,-63124 952.76,-63124 891.27,-63124 891.27,-63124"/>
<polygon fill="black" stroke="black" points="891.27,-63120.5 881.27,-63124 891.27,-63127.5 891.27,-63120.5"/>
</g>
<!-- layer47_silu_4 -->
<g id="node1209" class="node">
<title>layer47_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1035,-63020.93 854,-63020.93 854,-62952.93 1035,-62952.93 1035,-63020.93"/>
<text text-anchor="middle" x="944.5" y="-63005.73" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="944.5" y="-62990.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="944.5" y="-62975.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="944.5" y="-62960.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_gate_ar&#45;&gt;layer47_silu_4 -->
<g id="edge1542" class="edge">
<title>layer47_gate_ar&#45;&gt;layer47_silu_4</title>
<path fill="none" stroke="black" d="M1007.26,-63110.94C1007.26,-63110.94 1007.26,-63030.96 1007.26,-63030.96"/>
<polygon fill="black" stroke="black" points="1010.76,-63030.96 1007.26,-63020.96 1003.76,-63030.96 1010.76,-63030.96"/>
</g>
<!-- layer47_silu_5 -->
<g id="node1210" class="node">
<title>layer47_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1252,-63020.93 1071,-63020.93 1071,-62952.93 1252,-62952.93 1252,-63020.93"/>
<text text-anchor="middle" x="1161.5" y="-63005.73" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1161.5" y="-62990.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1161.5" y="-62975.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1161.5" y="-62960.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_gate_ar&#45;&gt;layer47_silu_5 -->
<g id="edge1543" class="edge">
<title>layer47_gate_ar&#45;&gt;layer47_silu_5</title>
<path fill="none" stroke="black" d="M1153.24,-63096.04C1153.24,-63096.04 1153.24,-63030.94 1153.24,-63030.94"/>
<polygon fill="black" stroke="black" points="1156.74,-63030.94 1153.24,-63020.94 1149.74,-63030.94 1156.74,-63030.94"/>
</g>
<!-- layer47_mul_4 -->
<g id="node1211" class="node">
<title>layer47_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="925,-62880.93 744,-62880.93 744,-62812.93 925,-62812.93 925,-62880.93"/>
<text text-anchor="middle" x="834.5" y="-62865.73" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="834.5" y="-62850.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="834.5" y="-62835.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="834.5" y="-62820.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_up_ar&#45;&gt;layer47_mul_4 -->
<g id="edge1545" class="edge">
<title>layer47_up_ar&#45;&gt;layer47_mul_4</title>
<path fill="none" stroke="black" d="M799,-63094.74C799,-63094.74 799,-62891.02 799,-62891.02"/>
<polygon fill="black" stroke="black" points="802.5,-62891.02 799,-62881.02 795.5,-62891.02 802.5,-62891.02"/>
</g>
<!-- layer47_mul_5 -->
<g id="node1212" class="node">
<title>layer47_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1142,-62880.93 961,-62880.93 961,-62812.93 1142,-62812.93 1142,-62880.93"/>
<text text-anchor="middle" x="1051.5" y="-62865.73" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1051.5" y="-62850.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1051.5" y="-62835.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1051.5" y="-62820.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer47_up_ar&#45;&gt;layer47_mul_5 -->
<g id="edge1547" class="edge">
<title>layer47_up_ar&#45;&gt;layer47_mul_5</title>
<path fill="none" stroke="black" d="M871.74,-63116.43C871.74,-63091.32 871.74,-63056 871.74,-63056 871.74,-63056 1053,-63056 1053,-63056 1053,-63056 1053,-62890.99 1053,-62890.99"/>
<polygon fill="black" stroke="black" points="1056.5,-62890.99 1053,-62880.99 1049.5,-62890.99 1056.5,-62890.99"/>
</g>
<!-- layer47_silu_4&#45;&gt;layer47_mul_4 -->
<g id="edge1544" class="edge">
<title>layer47_silu_4&#45;&gt;layer47_mul_4</title>
<path fill="none" stroke="black" d="M889.5,-62952.69C889.5,-62952.69 889.5,-62891.31 889.5,-62891.31"/>
<polygon fill="black" stroke="black" points="893,-62891.31 889.5,-62881.31 886,-62891.31 893,-62891.31"/>
</g>
<!-- layer47_silu_5&#45;&gt;layer47_mul_5 -->
<g id="edge1546" class="edge">
<title>layer47_silu_5&#45;&gt;layer47_mul_5</title>
<path fill="none" stroke="black" d="M1106.5,-62952.69C1106.5,-62952.69 1106.5,-62891.31 1106.5,-62891.31"/>
<polygon fill="black" stroke="black" points="1110,-62891.31 1106.5,-62881.31 1103,-62891.31 1110,-62891.31"/>
</g>
<!-- layer47_ffn_down_4 -->
<g id="node1213" class="node">
<title>layer47_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="924.5,-62740.93 752.5,-62740.93 752.5,-62672.93 924.5,-62672.93 924.5,-62740.93"/>
<text text-anchor="middle" x="838.5" y="-62725.73" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="838.5" y="-62710.73" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="838.5" y="-62695.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="838.5" y="-62680.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer47_mul_4&#45;&gt;layer47_ffn_down_4 -->
<g id="edge1548" class="edge">
<title>layer47_mul_4&#45;&gt;layer47_ffn_down_4</title>
<path fill="none" stroke="black" d="M838.5,-62812.69C838.5,-62812.69 838.5,-62751.31 838.5,-62751.31"/>
<polygon fill="black" stroke="black" points="842,-62751.31 838.5,-62741.31 835,-62751.31 842,-62751.31"/>
</g>
<!-- layer47_ffn_down_5 -->
<g id="node1214" class="node">
<title>layer47_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1134.5,-62740.93 962.5,-62740.93 962.5,-62672.93 1134.5,-62672.93 1134.5,-62740.93"/>
<text text-anchor="middle" x="1048.5" y="-62725.73" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1048.5" y="-62710.73" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1048.5" y="-62695.73" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1048.5" y="-62680.73" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer47_mul_5&#45;&gt;layer47_ffn_down_5 -->
<g id="edge1549" class="edge">
<title>layer47_mul_5&#45;&gt;layer47_ffn_down_5</title>
<path fill="none" stroke="black" d="M1048.5,-62812.69C1048.5,-62812.69 1048.5,-62751.31 1048.5,-62751.31"/>
<polygon fill="black" stroke="black" points="1052,-62751.31 1048.5,-62741.31 1045,-62751.31 1052,-62751.31"/>
</g>
<!-- layer47_ffn_ar -->
<g id="node1215" class="node">
<title>layer47_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="942.5" cy="-62552.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="942.5" y="-62571.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="942.5" y="-62556.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="942.5" y="-62541.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="942.5" y="-62526.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer47_ffn_down_4&#45;&gt;layer47_ffn_ar -->
<g id="edge1550" class="edge">
<title>layer47_ffn_down_4&#45;&gt;layer47_ffn_ar</title>
<path fill="none" stroke="black" d="M872.69,-62672.74C872.69,-62672.74 872.69,-62602.39 872.69,-62602.39"/>
<polygon fill="black" stroke="black" points="876.19,-62602.39 872.69,-62592.39 869.19,-62602.39 876.19,-62602.39"/>
</g>
<!-- layer47_ffn_down_5&#45;&gt;layer47_ffn_ar -->
<g id="edge1551" class="edge">
<title>layer47_ffn_down_5&#45;&gt;layer47_ffn_ar</title>
<path fill="none" stroke="black" d="M1013.31,-62672.74C1013.31,-62672.74 1013.31,-62602.12 1013.31,-62602.12"/>
<polygon fill="black" stroke="black" points="1016.81,-62602.12 1013.31,-62592.12 1009.81,-62602.12 1016.81,-62602.12"/>
</g>
<!-- layer48_norm_4 -->
<g id="node1216" class="node">
<title>layer48_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="924.5,-62432.77 752.5,-62432.77 752.5,-62364.77 924.5,-62364.77 924.5,-62432.77"/>
<text text-anchor="middle" x="838.5" y="-62417.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="838.5" y="-62402.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="838.5" y="-62387.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="838.5" y="-62372.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer47_ffn_ar&#45;&gt;layer48_norm_4 -->
<g id="edge1552" class="edge">
<title>layer47_ffn_ar&#45;&gt;layer48_norm_4</title>
<path fill="none" stroke="black" d="M872.69,-62513.17C872.69,-62513.17 872.69,-62442.82 872.69,-62442.82"/>
<polygon fill="black" stroke="black" points="876.19,-62442.82 872.69,-62432.82 869.19,-62442.82 876.19,-62442.82"/>
</g>
<!-- layer48_norm_5 -->
<g id="node1217" class="node">
<title>layer48_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1134.5,-62432.77 962.5,-62432.77 962.5,-62364.77 1134.5,-62364.77 1134.5,-62432.77"/>
<text text-anchor="middle" x="1048.5" y="-62417.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1048.5" y="-62402.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1048.5" y="-62387.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1048.5" y="-62372.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer47_ffn_ar&#45;&gt;layer48_norm_5 -->
<g id="edge1553" class="edge">
<title>layer47_ffn_ar&#45;&gt;layer48_norm_5</title>
<path fill="none" stroke="black" d="M1013.31,-62513.57C1013.31,-62513.57 1013.31,-62443 1013.31,-62443"/>
<polygon fill="black" stroke="black" points="1016.81,-62443 1013.31,-62433 1009.81,-62443 1016.81,-62443"/>
</g>
<!-- layer48_qkv_4 -->
<g id="node1218" class="node">
<title>layer48_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="925,-62292.77 744,-62292.77 744,-62224.77 925,-62224.77 925,-62292.77"/>
<text text-anchor="middle" x="834.5" y="-62277.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="834.5" y="-62262.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="834.5" y="-62247.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="834.5" y="-62232.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer48_norm_4&#45;&gt;layer48_qkv_4 -->
<g id="edge1554" class="edge">
<title>layer48_norm_4&#45;&gt;layer48_qkv_4</title>
<path fill="none" stroke="black" d="M838.5,-62364.52C838.5,-62364.52 838.5,-62303.15 838.5,-62303.15"/>
<polygon fill="black" stroke="black" points="842,-62303.15 838.5,-62293.15 835,-62303.15 842,-62303.15"/>
</g>
<!-- layer48_qkv_5 -->
<g id="node1219" class="node">
<title>layer48_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1142,-62292.77 961,-62292.77 961,-62224.77 1142,-62224.77 1142,-62292.77"/>
<text text-anchor="middle" x="1051.5" y="-62277.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1051.5" y="-62262.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1051.5" y="-62247.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-62232.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer48_norm_5&#45;&gt;layer48_qkv_5 -->
<g id="edge1555" class="edge">
<title>layer48_norm_5&#45;&gt;layer48_qkv_5</title>
<path fill="none" stroke="black" d="M1048.5,-62364.52C1048.5,-62364.52 1048.5,-62303.15 1048.5,-62303.15"/>
<polygon fill="black" stroke="black" points="1052,-62303.15 1048.5,-62293.15 1045,-62303.15 1052,-62303.15"/>
</g>
<!-- layer48_qkv_ar -->
<g id="node1220" class="node">
<title>layer48_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="942.5" cy="-62104.68" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="942.5" y="-62123.48" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="942.5" y="-62108.48" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="942.5" y="-62093.48" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="942.5" y="-62078.48" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer48_qkv_4&#45;&gt;layer48_qkv_ar -->
<g id="edge1556" class="edge">
<title>layer48_qkv_4&#45;&gt;layer48_qkv_ar</title>
<path fill="none" stroke="black" d="M869.76,-62224.57C869.76,-62224.57 869.76,-62154.51 869.76,-62154.51"/>
<polygon fill="black" stroke="black" points="873.26,-62154.51 869.76,-62144.51 866.26,-62154.51 873.26,-62154.51"/>
</g>
<!-- layer48_qkv_5&#45;&gt;layer48_qkv_ar -->
<g id="edge1557" class="edge">
<title>layer48_qkv_5&#45;&gt;layer48_qkv_ar</title>
<path fill="none" stroke="black" d="M1015.74,-62224.57C1015.74,-62224.57 1015.74,-62154.23 1015.74,-62154.23"/>
<polygon fill="black" stroke="black" points="1019.24,-62154.23 1015.74,-62144.23 1012.24,-62154.23 1019.24,-62154.23"/>
</g>
<!-- layer48_attn_4 -->
<g id="node1221" class="node">
<title>layer48_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="924.5,-61984.6 752.5,-61984.6 752.5,-61916.6 924.5,-61916.6 924.5,-61984.6"/>
<text text-anchor="middle" x="838.5" y="-61969.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="838.5" y="-61954.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="838.5" y="-61939.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="838.5" y="-61924.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer48_qkv_ar&#45;&gt;layer48_attn_4 -->
<g id="edge1558" class="edge">
<title>layer48_qkv_ar&#45;&gt;layer48_attn_4</title>
<path fill="none" stroke="black" d="M869.51,-62065C869.51,-62065 869.51,-61994.66 869.51,-61994.66"/>
<polygon fill="black" stroke="black" points="873.01,-61994.66 869.51,-61984.66 866.01,-61994.66 873.01,-61994.66"/>
</g>
<!-- layer48_attn_5 -->
<g id="node1222" class="node">
<title>layer48_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1132.5,-61984.6 960.5,-61984.6 960.5,-61916.6 1132.5,-61916.6 1132.5,-61984.6"/>
<text text-anchor="middle" x="1046.5" y="-61969.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1046.5" y="-61954.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1046.5" y="-61939.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1046.5" y="-61924.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer48_qkv_ar&#45;&gt;layer48_attn_5 -->
<g id="edge1559" class="edge">
<title>layer48_qkv_ar&#45;&gt;layer48_attn_5</title>
<path fill="none" stroke="black" d="M1015.49,-62065C1015.49,-62065 1015.49,-61994.66 1015.49,-61994.66"/>
<polygon fill="black" stroke="black" points="1018.99,-61994.66 1015.49,-61984.66 1011.99,-61994.66 1018.99,-61994.66"/>
</g>
<!-- layer48_attn_out_4 -->
<g id="node1223" class="node">
<title>layer48_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="924.5,-61844.6 752.5,-61844.6 752.5,-61776.6 924.5,-61776.6 924.5,-61844.6"/>
<text text-anchor="middle" x="838.5" y="-61829.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="838.5" y="-61814.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="838.5" y="-61799.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="838.5" y="-61784.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer48_attn_4&#45;&gt;layer48_attn_out_4 -->
<g id="edge1560" class="edge">
<title>layer48_attn_4&#45;&gt;layer48_attn_out_4</title>
<path fill="none" stroke="black" d="M838.5,-61916.35C838.5,-61916.35 838.5,-61854.98 838.5,-61854.98"/>
<polygon fill="black" stroke="black" points="842,-61854.98 838.5,-61844.98 835,-61854.98 842,-61854.98"/>
</g>
<!-- layer48_attn_out_5 -->
<g id="node1224" class="node">
<title>layer48_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1132.5,-61844.6 960.5,-61844.6 960.5,-61776.6 1132.5,-61776.6 1132.5,-61844.6"/>
<text text-anchor="middle" x="1046.5" y="-61829.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1046.5" y="-61814.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1046.5" y="-61799.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1046.5" y="-61784.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer48_attn_5&#45;&gt;layer48_attn_out_5 -->
<g id="edge1561" class="edge">
<title>layer48_attn_5&#45;&gt;layer48_attn_out_5</title>
<path fill="none" stroke="black" d="M1046.5,-61916.35C1046.5,-61916.35 1046.5,-61854.98 1046.5,-61854.98"/>
<polygon fill="black" stroke="black" points="1050,-61854.98 1046.5,-61844.98 1043,-61854.98 1050,-61854.98"/>
</g>
<!-- layer48_attn_ar -->
<g id="node1225" class="node">
<title>layer48_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="942.5" cy="-61656.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="942.5" y="-61675.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="942.5" y="-61660.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="942.5" y="-61645.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="942.5" y="-61630.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer48_attn_out_4&#45;&gt;layer48_attn_ar -->
<g id="edge1562" class="edge">
<title>layer48_attn_out_4&#45;&gt;layer48_attn_ar</title>
<path fill="none" stroke="black" d="M872.69,-61776.41C872.69,-61776.41 872.69,-61706.06 872.69,-61706.06"/>
<polygon fill="black" stroke="black" points="876.19,-61706.06 872.69,-61696.06 869.19,-61706.06 876.19,-61706.06"/>
</g>
<!-- layer48_attn_out_5&#45;&gt;layer48_attn_ar -->
<g id="edge1563" class="edge">
<title>layer48_attn_out_5&#45;&gt;layer48_attn_ar</title>
<path fill="none" stroke="black" d="M1012.31,-61776.41C1012.31,-61776.41 1012.31,-61706.06 1012.31,-61706.06"/>
<polygon fill="black" stroke="black" points="1015.81,-61706.06 1012.31,-61696.06 1008.81,-61706.06 1015.81,-61706.06"/>
</g>
<!-- layer48_ffn_norm_4 -->
<g id="node1226" class="node">
<title>layer48_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="920.5,-61536.43 748.5,-61536.43 748.5,-61468.43 920.5,-61468.43 920.5,-61536.43"/>
<text text-anchor="middle" x="834.5" y="-61521.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="834.5" y="-61506.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="834.5" y="-61491.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="834.5" y="-61476.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer48_attn_ar&#45;&gt;layer48_ffn_norm_4 -->
<g id="edge1564" class="edge">
<title>layer48_attn_ar&#45;&gt;layer48_ffn_norm_4</title>
<path fill="none" stroke="black" d="M870.69,-61617.64C870.69,-61617.64 870.69,-61546.58 870.69,-61546.58"/>
<polygon fill="black" stroke="black" points="874.19,-61546.58 870.69,-61536.58 867.19,-61546.58 874.19,-61546.58"/>
</g>
<!-- layer48_ffn_norm_5 -->
<g id="node1227" class="node">
<title>layer48_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1137.5,-61536.43 965.5,-61536.43 965.5,-61468.43 1137.5,-61468.43 1137.5,-61536.43"/>
<text text-anchor="middle" x="1051.5" y="-61521.23" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1051.5" y="-61506.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1051.5" y="-61491.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-61476.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer48_attn_ar&#45;&gt;layer48_ffn_norm_5 -->
<g id="edge1565" class="edge">
<title>layer48_attn_ar&#45;&gt;layer48_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1014.81,-61617.64C1014.81,-61617.64 1014.81,-61546.58 1014.81,-61546.58"/>
<polygon fill="black" stroke="black" points="1018.31,-61546.58 1014.81,-61536.58 1011.31,-61546.58 1018.31,-61546.58"/>
</g>
<!-- layer48_ffn_gate_4 -->
<g id="node1228" class="node">
<title>layer48_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="925,-61396.43 744,-61396.43 744,-61328.43 925,-61328.43 925,-61396.43"/>
<text text-anchor="middle" x="834.5" y="-61381.23" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="834.5" y="-61366.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="834.5" y="-61351.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="834.5" y="-61336.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_ffn_norm_4&#45;&gt;layer48_ffn_gate_4 -->
<g id="edge1566" class="edge">
<title>layer48_ffn_norm_4&#45;&gt;layer48_ffn_gate_4</title>
<path fill="none" stroke="black" d="M834.5,-61468.19C834.5,-61468.19 834.5,-61406.81 834.5,-61406.81"/>
<polygon fill="black" stroke="black" points="838,-61406.81 834.5,-61396.81 831,-61406.81 838,-61406.81"/>
</g>
<!-- layer48_ffn_up_4 -->
<g id="node1230" class="node">
<title>layer48_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="708,-61396.43 527,-61396.43 527,-61328.43 708,-61328.43 708,-61396.43"/>
<text text-anchor="middle" x="617.5" y="-61381.23" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="617.5" y="-61366.23" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="617.5" y="-61351.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="617.5" y="-61336.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_ffn_norm_4&#45;&gt;layer48_ffn_up_4 -->
<g id="edge1568" class="edge">
<title>layer48_ffn_norm_4&#45;&gt;layer48_ffn_up_4</title>
<path fill="none" stroke="black" d="M748.31,-61502C708.86,-61502 670.76,-61502 670.76,-61502 670.76,-61502 670.76,-61406.58 670.76,-61406.58"/>
<polygon fill="black" stroke="black" points="674.26,-61406.58 670.76,-61396.58 667.26,-61406.58 674.26,-61406.58"/>
</g>
<!-- layer48_ffn_gate_5 -->
<g id="node1229" class="node">
<title>layer48_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1359,-61396.43 1178,-61396.43 1178,-61328.43 1359,-61328.43 1359,-61396.43"/>
<text text-anchor="middle" x="1268.5" y="-61381.23" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1268.5" y="-61366.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1268.5" y="-61351.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1268.5" y="-61336.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_ffn_norm_5&#45;&gt;layer48_ffn_gate_5 -->
<g id="edge1567" class="edge">
<title>layer48_ffn_norm_5&#45;&gt;layer48_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1137.56,-61502C1176.95,-61502 1215,-61502 1215,-61502 1215,-61502 1215,-61406.58 1215,-61406.58"/>
<polygon fill="black" stroke="black" points="1218.5,-61406.58 1215,-61396.58 1211.5,-61406.58 1218.5,-61406.58"/>
</g>
<!-- layer48_ffn_up_5 -->
<g id="node1231" class="node">
<title>layer48_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1142,-61396.43 961,-61396.43 961,-61328.43 1142,-61328.43 1142,-61396.43"/>
<text text-anchor="middle" x="1051.5" y="-61381.23" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1051.5" y="-61366.23" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1051.5" y="-61351.23" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1051.5" y="-61336.23" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_ffn_norm_5&#45;&gt;layer48_ffn_up_5 -->
<g id="edge1569" class="edge">
<title>layer48_ffn_norm_5&#45;&gt;layer48_ffn_up_5</title>
<path fill="none" stroke="black" d="M1051.5,-61468.19C1051.5,-61468.19 1051.5,-61406.81 1051.5,-61406.81"/>
<polygon fill="black" stroke="black" points="1055,-61406.81 1051.5,-61396.81 1048,-61406.81 1055,-61406.81"/>
</g>
<!-- layer48_gate_ar -->
<g id="node1232" class="node">
<title>layer48_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1142.5" cy="-61208.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1142.5" y="-61227.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1142.5" y="-61212.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1142.5" y="-61197.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1142.5" y="-61182.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer48_ffn_gate_4&#45;&gt;layer48_gate_ar -->
<g id="edge1570" class="edge">
<title>layer48_ffn_gate_4&#45;&gt;layer48_gate_ar</title>
<path fill="none" stroke="black" d="M925.08,-61362C935.79,-61362 943,-61362 943,-61362 943,-61362 943,-61224 943,-61224 943,-61224 1011.28,-61224 1011.28,-61224"/>
<polygon fill="black" stroke="black" points="1011.28,-61227.5 1021.28,-61224 1011.28,-61220.5 1011.28,-61227.5"/>
</g>
<!-- layer48_ffn_gate_5&#45;&gt;layer48_gate_ar -->
<g id="edge1571" class="edge">
<title>layer48_ffn_gate_5&#45;&gt;layer48_gate_ar</title>
<path fill="none" stroke="black" d="M1224.24,-61328.24C1224.24,-61328.24 1224.24,-61255.41 1224.24,-61255.41"/>
<polygon fill="black" stroke="black" points="1227.74,-61255.41 1224.24,-61245.41 1220.74,-61255.41 1227.74,-61255.41"/>
</g>
<!-- layer48_up_ar -->
<g id="node1233" class="node">
<title>layer48_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="796.5" cy="-61208.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="796.5" y="-61227.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="796.5" y="-61212.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="796.5" y="-61197.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="796.5" y="-61182.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer48_ffn_up_4&#45;&gt;layer48_up_ar -->
<g id="edge1572" class="edge">
<title>layer48_ffn_up_4&#45;&gt;layer48_up_ar</title>
<path fill="none" stroke="black" d="M688.26,-61328.24C688.26,-61328.24 688.26,-61244.32 688.26,-61244.32"/>
<polygon fill="black" stroke="black" points="691.76,-61244.32 688.26,-61234.32 684.76,-61244.32 691.76,-61244.32"/>
</g>
<!-- layer48_ffn_up_5&#45;&gt;layer48_up_ar -->
<g id="edge1573" class="edge">
<title>layer48_ffn_up_5&#45;&gt;layer48_up_ar</title>
<path fill="none" stroke="black" d="M987.76,-61328.35C987.76,-61278.62 987.76,-61192 987.76,-61192 987.76,-61192 927.08,-61192 927.08,-61192"/>
<polygon fill="black" stroke="black" points="927.08,-61188.5 917.08,-61192 927.08,-61195.5 927.08,-61188.5"/>
</g>
<!-- layer48_silu_4 -->
<g id="node1234" class="node">
<title>layer48_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1070,-61088.27 889,-61088.27 889,-61020.27 1070,-61020.27 1070,-61088.27"/>
<text text-anchor="middle" x="979.5" y="-61073.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="979.5" y="-61058.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="979.5" y="-61043.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="979.5" y="-61028.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_gate_ar&#45;&gt;layer48_silu_4 -->
<g id="edge1574" class="edge">
<title>layer48_gate_ar&#45;&gt;layer48_silu_4</title>
<path fill="none" stroke="black" d="M1042.26,-61178.28C1042.26,-61178.28 1042.26,-61098.29 1042.26,-61098.29"/>
<polygon fill="black" stroke="black" points="1045.76,-61098.29 1042.26,-61088.29 1038.76,-61098.29 1045.76,-61098.29"/>
</g>
<!-- layer48_silu_5 -->
<g id="node1235" class="node">
<title>layer48_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1287,-61088.27 1106,-61088.27 1106,-61020.27 1287,-61020.27 1287,-61088.27"/>
<text text-anchor="middle" x="1196.5" y="-61073.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1196.5" y="-61058.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1196.5" y="-61043.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1196.5" y="-61028.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_gate_ar&#45;&gt;layer48_silu_5 -->
<g id="edge1575" class="edge">
<title>layer48_gate_ar&#45;&gt;layer48_silu_5</title>
<path fill="none" stroke="black" d="M1188.24,-61163.37C1188.24,-61163.37 1188.24,-61098.27 1188.24,-61098.27"/>
<polygon fill="black" stroke="black" points="1191.74,-61098.27 1188.24,-61088.27 1184.74,-61098.27 1191.74,-61098.27"/>
</g>
<!-- layer48_mul_4 -->
<g id="node1236" class="node">
<title>layer48_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="960,-60948.27 779,-60948.27 779,-60880.27 960,-60880.27 960,-60948.27"/>
<text text-anchor="middle" x="869.5" y="-60933.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="869.5" y="-60918.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="869.5" y="-60903.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="869.5" y="-60888.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_up_ar&#45;&gt;layer48_mul_4 -->
<g id="edge1577" class="edge">
<title>layer48_up_ar&#45;&gt;layer48_mul_4</title>
<path fill="none" stroke="black" d="M834,-61162.08C834,-61162.08 834,-60958.35 834,-60958.35"/>
<polygon fill="black" stroke="black" points="837.5,-60958.35 834,-60948.35 830.5,-60958.35 837.5,-60958.35"/>
</g>
<!-- layer48_mul_5 -->
<g id="node1237" class="node">
<title>layer48_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1177,-60948.27 996,-60948.27 996,-60880.27 1177,-60880.27 1177,-60948.27"/>
<text text-anchor="middle" x="1086.5" y="-60933.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1086.5" y="-60918.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1086.5" y="-60903.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1086.5" y="-60888.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer48_up_ar&#45;&gt;layer48_mul_5 -->
<g id="edge1579" class="edge">
<title>layer48_up_ar&#45;&gt;layer48_mul_5</title>
<path fill="none" stroke="black" d="M906.74,-61183.5C906.74,-61158.62 906.74,-61124 906.74,-61124 906.74,-61124 1088,-61124 1088,-61124 1088,-61124 1088,-60958.43 1088,-60958.43"/>
<polygon fill="black" stroke="black" points="1091.5,-60958.43 1088,-60948.43 1084.5,-60958.43 1091.5,-60958.43"/>
</g>
<!-- layer48_silu_4&#45;&gt;layer48_mul_4 -->
<g id="edge1576" class="edge">
<title>layer48_silu_4&#45;&gt;layer48_mul_4</title>
<path fill="none" stroke="black" d="M924.5,-61020.02C924.5,-61020.02 924.5,-60958.65 924.5,-60958.65"/>
<polygon fill="black" stroke="black" points="928,-60958.65 924.5,-60948.65 921,-60958.65 928,-60958.65"/>
</g>
<!-- layer48_silu_5&#45;&gt;layer48_mul_5 -->
<g id="edge1578" class="edge">
<title>layer48_silu_5&#45;&gt;layer48_mul_5</title>
<path fill="none" stroke="black" d="M1141.5,-61020.02C1141.5,-61020.02 1141.5,-60958.65 1141.5,-60958.65"/>
<polygon fill="black" stroke="black" points="1145,-60958.65 1141.5,-60948.65 1138,-60958.65 1145,-60958.65"/>
</g>
<!-- layer48_ffn_down_4 -->
<g id="node1238" class="node">
<title>layer48_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="959.5,-60808.27 787.5,-60808.27 787.5,-60740.27 959.5,-60740.27 959.5,-60808.27"/>
<text text-anchor="middle" x="873.5" y="-60793.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="873.5" y="-60778.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="873.5" y="-60763.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="873.5" y="-60748.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer48_mul_4&#45;&gt;layer48_ffn_down_4 -->
<g id="edge1580" class="edge">
<title>layer48_mul_4&#45;&gt;layer48_ffn_down_4</title>
<path fill="none" stroke="black" d="M873.5,-60880.02C873.5,-60880.02 873.5,-60818.65 873.5,-60818.65"/>
<polygon fill="black" stroke="black" points="877,-60818.65 873.5,-60808.65 870,-60818.65 877,-60818.65"/>
</g>
<!-- layer48_ffn_down_5 -->
<g id="node1239" class="node">
<title>layer48_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1169.5,-60808.27 997.5,-60808.27 997.5,-60740.27 1169.5,-60740.27 1169.5,-60808.27"/>
<text text-anchor="middle" x="1083.5" y="-60793.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1083.5" y="-60778.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1083.5" y="-60763.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1083.5" y="-60748.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer48_mul_5&#45;&gt;layer48_ffn_down_5 -->
<g id="edge1581" class="edge">
<title>layer48_mul_5&#45;&gt;layer48_ffn_down_5</title>
<path fill="none" stroke="black" d="M1083.5,-60880.02C1083.5,-60880.02 1083.5,-60818.65 1083.5,-60818.65"/>
<polygon fill="black" stroke="black" points="1087,-60818.65 1083.5,-60808.65 1080,-60818.65 1087,-60818.65"/>
</g>
<!-- layer48_ffn_ar -->
<g id="node1240" class="node">
<title>layer48_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="977.5" cy="-60620.18" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="977.5" y="-60638.98" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="977.5" y="-60623.98" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="977.5" y="-60608.98" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="977.5" y="-60593.98" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer48_ffn_down_4&#45;&gt;layer48_ffn_ar -->
<g id="edge1582" class="edge">
<title>layer48_ffn_down_4&#45;&gt;layer48_ffn_ar</title>
<path fill="none" stroke="black" d="M907.69,-60740.07C907.69,-60740.07 907.69,-60669.73 907.69,-60669.73"/>
<polygon fill="black" stroke="black" points="911.19,-60669.73 907.69,-60659.73 904.19,-60669.73 911.19,-60669.73"/>
</g>
<!-- layer48_ffn_down_5&#45;&gt;layer48_ffn_ar -->
<g id="edge1583" class="edge">
<title>layer48_ffn_down_5&#45;&gt;layer48_ffn_ar</title>
<path fill="none" stroke="black" d="M1048.31,-60740.07C1048.31,-60740.07 1048.31,-60669.45 1048.31,-60669.45"/>
<polygon fill="black" stroke="black" points="1051.81,-60669.45 1048.31,-60659.45 1044.81,-60669.45 1051.81,-60669.45"/>
</g>
<!-- layer49_norm_4 -->
<g id="node1241" class="node">
<title>layer49_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="959.5,-60500.1 787.5,-60500.1 787.5,-60432.1 959.5,-60432.1 959.5,-60500.1"/>
<text text-anchor="middle" x="873.5" y="-60484.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="873.5" y="-60469.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="873.5" y="-60454.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="873.5" y="-60439.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer48_ffn_ar&#45;&gt;layer49_norm_4 -->
<g id="edge1584" class="edge">
<title>layer48_ffn_ar&#45;&gt;layer49_norm_4</title>
<path fill="none" stroke="black" d="M907.69,-60580.5C907.69,-60580.5 907.69,-60510.16 907.69,-60510.16"/>
<polygon fill="black" stroke="black" points="911.19,-60510.16 907.69,-60500.16 904.19,-60510.16 911.19,-60510.16"/>
</g>
<!-- layer49_norm_5 -->
<g id="node1242" class="node">
<title>layer49_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1169.5,-60500.1 997.5,-60500.1 997.5,-60432.1 1169.5,-60432.1 1169.5,-60500.1"/>
<text text-anchor="middle" x="1083.5" y="-60484.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1083.5" y="-60469.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1083.5" y="-60454.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1083.5" y="-60439.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer48_ffn_ar&#45;&gt;layer49_norm_5 -->
<g id="edge1585" class="edge">
<title>layer48_ffn_ar&#45;&gt;layer49_norm_5</title>
<path fill="none" stroke="black" d="M1048.31,-60580.9C1048.31,-60580.9 1048.31,-60510.33 1048.31,-60510.33"/>
<polygon fill="black" stroke="black" points="1051.81,-60510.33 1048.31,-60500.33 1044.81,-60510.33 1051.81,-60510.33"/>
</g>
<!-- layer49_qkv_4 -->
<g id="node1243" class="node">
<title>layer49_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="960,-60360.1 779,-60360.1 779,-60292.1 960,-60292.1 960,-60360.1"/>
<text text-anchor="middle" x="869.5" y="-60344.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="869.5" y="-60329.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="869.5" y="-60314.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="869.5" y="-60299.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer49_norm_4&#45;&gt;layer49_qkv_4 -->
<g id="edge1586" class="edge">
<title>layer49_norm_4&#45;&gt;layer49_qkv_4</title>
<path fill="none" stroke="black" d="M873.5,-60431.85C873.5,-60431.85 873.5,-60370.48 873.5,-60370.48"/>
<polygon fill="black" stroke="black" points="877,-60370.48 873.5,-60360.48 870,-60370.48 877,-60370.48"/>
</g>
<!-- layer49_qkv_5 -->
<g id="node1244" class="node">
<title>layer49_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1177,-60360.1 996,-60360.1 996,-60292.1 1177,-60292.1 1177,-60360.1"/>
<text text-anchor="middle" x="1086.5" y="-60344.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1086.5" y="-60329.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1086.5" y="-60314.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1086.5" y="-60299.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer49_norm_5&#45;&gt;layer49_qkv_5 -->
<g id="edge1587" class="edge">
<title>layer49_norm_5&#45;&gt;layer49_qkv_5</title>
<path fill="none" stroke="black" d="M1083.5,-60431.85C1083.5,-60431.85 1083.5,-60370.48 1083.5,-60370.48"/>
<polygon fill="black" stroke="black" points="1087,-60370.48 1083.5,-60360.48 1080,-60370.48 1087,-60370.48"/>
</g>
<!-- layer49_qkv_ar -->
<g id="node1245" class="node">
<title>layer49_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="977.5" cy="-60172.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="977.5" y="-60190.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="977.5" y="-60175.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="977.5" y="-60160.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="977.5" y="-60145.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer49_qkv_4&#45;&gt;layer49_qkv_ar -->
<g id="edge1588" class="edge">
<title>layer49_qkv_4&#45;&gt;layer49_qkv_ar</title>
<path fill="none" stroke="black" d="M904.76,-60291.91C904.76,-60291.91 904.76,-60221.84 904.76,-60221.84"/>
<polygon fill="black" stroke="black" points="908.26,-60221.84 904.76,-60211.84 901.26,-60221.84 908.26,-60221.84"/>
</g>
<!-- layer49_qkv_5&#45;&gt;layer49_qkv_ar -->
<g id="edge1589" class="edge">
<title>layer49_qkv_5&#45;&gt;layer49_qkv_ar</title>
<path fill="none" stroke="black" d="M1050.74,-60291.91C1050.74,-60291.91 1050.74,-60221.56 1050.74,-60221.56"/>
<polygon fill="black" stroke="black" points="1054.24,-60221.56 1050.74,-60211.56 1047.24,-60221.56 1054.24,-60221.56"/>
</g>
<!-- layer49_attn_4 -->
<g id="node1246" class="node">
<title>layer49_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="959.5,-60051.94 787.5,-60051.94 787.5,-59983.94 959.5,-59983.94 959.5,-60051.94"/>
<text text-anchor="middle" x="873.5" y="-60036.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="873.5" y="-60021.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="873.5" y="-60006.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="873.5" y="-59991.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer49_qkv_ar&#45;&gt;layer49_attn_4 -->
<g id="edge1590" class="edge">
<title>layer49_qkv_ar&#45;&gt;layer49_attn_4</title>
<path fill="none" stroke="black" d="M904.51,-60132.34C904.51,-60132.34 904.51,-60061.99 904.51,-60061.99"/>
<polygon fill="black" stroke="black" points="908.01,-60061.99 904.51,-60051.99 901.01,-60061.99 908.01,-60061.99"/>
</g>
<!-- layer49_attn_5 -->
<g id="node1247" class="node">
<title>layer49_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1167.5,-60051.94 995.5,-60051.94 995.5,-59983.94 1167.5,-59983.94 1167.5,-60051.94"/>
<text text-anchor="middle" x="1081.5" y="-60036.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1081.5" y="-60021.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1081.5" y="-60006.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1081.5" y="-59991.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer49_qkv_ar&#45;&gt;layer49_attn_5 -->
<g id="edge1591" class="edge">
<title>layer49_qkv_ar&#45;&gt;layer49_attn_5</title>
<path fill="none" stroke="black" d="M1050.49,-60132.34C1050.49,-60132.34 1050.49,-60061.99 1050.49,-60061.99"/>
<polygon fill="black" stroke="black" points="1053.99,-60061.99 1050.49,-60051.99 1046.99,-60061.99 1053.99,-60061.99"/>
</g>
<!-- layer49_attn_out_4 -->
<g id="node1248" class="node">
<title>layer49_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="959.5,-59911.94 787.5,-59911.94 787.5,-59843.94 959.5,-59843.94 959.5,-59911.94"/>
<text text-anchor="middle" x="873.5" y="-59896.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="873.5" y="-59881.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="873.5" y="-59866.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="873.5" y="-59851.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer49_attn_4&#45;&gt;layer49_attn_out_4 -->
<g id="edge1592" class="edge">
<title>layer49_attn_4&#45;&gt;layer49_attn_out_4</title>
<path fill="none" stroke="black" d="M873.5,-59983.69C873.5,-59983.69 873.5,-59922.31 873.5,-59922.31"/>
<polygon fill="black" stroke="black" points="877,-59922.31 873.5,-59912.31 870,-59922.31 877,-59922.31"/>
</g>
<!-- layer49_attn_out_5 -->
<g id="node1249" class="node">
<title>layer49_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1167.5,-59911.94 995.5,-59911.94 995.5,-59843.94 1167.5,-59843.94 1167.5,-59911.94"/>
<text text-anchor="middle" x="1081.5" y="-59896.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1081.5" y="-59881.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1081.5" y="-59866.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1081.5" y="-59851.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer49_attn_5&#45;&gt;layer49_attn_out_5 -->
<g id="edge1593" class="edge">
<title>layer49_attn_5&#45;&gt;layer49_attn_out_5</title>
<path fill="none" stroke="black" d="M1081.5,-59983.69C1081.5,-59983.69 1081.5,-59922.31 1081.5,-59922.31"/>
<polygon fill="black" stroke="black" points="1085,-59922.31 1081.5,-59912.31 1078,-59922.31 1085,-59922.31"/>
</g>
<!-- layer49_attn_ar -->
<g id="node1250" class="node">
<title>layer49_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="977.5" cy="-59723.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="977.5" y="-59742.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="977.5" y="-59727.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="977.5" y="-59712.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="977.5" y="-59697.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer49_attn_out_4&#45;&gt;layer49_attn_ar -->
<g id="edge1594" class="edge">
<title>layer49_attn_out_4&#45;&gt;layer49_attn_ar</title>
<path fill="none" stroke="black" d="M907.69,-59843.74C907.69,-59843.74 907.69,-59773.39 907.69,-59773.39"/>
<polygon fill="black" stroke="black" points="911.19,-59773.39 907.69,-59763.39 904.19,-59773.39 911.19,-59773.39"/>
</g>
<!-- layer49_attn_out_5&#45;&gt;layer49_attn_ar -->
<g id="edge1595" class="edge">
<title>layer49_attn_out_5&#45;&gt;layer49_attn_ar</title>
<path fill="none" stroke="black" d="M1047.31,-59843.74C1047.31,-59843.74 1047.31,-59773.39 1047.31,-59773.39"/>
<polygon fill="black" stroke="black" points="1050.81,-59773.39 1047.31,-59763.39 1043.81,-59773.39 1050.81,-59773.39"/>
</g>
<!-- layer49_ffn_norm_4 -->
<g id="node1251" class="node">
<title>layer49_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="955.5,-59603.77 783.5,-59603.77 783.5,-59535.77 955.5,-59535.77 955.5,-59603.77"/>
<text text-anchor="middle" x="869.5" y="-59588.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="869.5" y="-59573.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="869.5" y="-59558.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="869.5" y="-59543.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer49_attn_ar&#45;&gt;layer49_ffn_norm_4 -->
<g id="edge1596" class="edge">
<title>layer49_attn_ar&#45;&gt;layer49_ffn_norm_4</title>
<path fill="none" stroke="black" d="M905.69,-59684.97C905.69,-59684.97 905.69,-59613.92 905.69,-59613.92"/>
<polygon fill="black" stroke="black" points="909.19,-59613.92 905.69,-59603.92 902.19,-59613.92 909.19,-59613.92"/>
</g>
<!-- layer49_ffn_norm_5 -->
<g id="node1252" class="node">
<title>layer49_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1172.5,-59603.77 1000.5,-59603.77 1000.5,-59535.77 1172.5,-59535.77 1172.5,-59603.77"/>
<text text-anchor="middle" x="1086.5" y="-59588.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1086.5" y="-59573.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1086.5" y="-59558.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1086.5" y="-59543.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer49_attn_ar&#45;&gt;layer49_ffn_norm_5 -->
<g id="edge1597" class="edge">
<title>layer49_attn_ar&#45;&gt;layer49_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1049.81,-59684.97C1049.81,-59684.97 1049.81,-59613.92 1049.81,-59613.92"/>
<polygon fill="black" stroke="black" points="1053.31,-59613.92 1049.81,-59603.92 1046.31,-59613.92 1053.31,-59613.92"/>
</g>
<!-- layer49_ffn_gate_4 -->
<g id="node1253" class="node">
<title>layer49_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="960,-59463.77 779,-59463.77 779,-59395.77 960,-59395.77 960,-59463.77"/>
<text text-anchor="middle" x="869.5" y="-59448.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="869.5" y="-59433.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="869.5" y="-59418.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="869.5" y="-59403.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_ffn_norm_4&#45;&gt;layer49_ffn_gate_4 -->
<g id="edge1598" class="edge">
<title>layer49_ffn_norm_4&#45;&gt;layer49_ffn_gate_4</title>
<path fill="none" stroke="black" d="M869.5,-59535.52C869.5,-59535.52 869.5,-59474.15 869.5,-59474.15"/>
<polygon fill="black" stroke="black" points="873,-59474.15 869.5,-59464.15 866,-59474.15 873,-59474.15"/>
</g>
<!-- layer49_ffn_up_4 -->
<g id="node1255" class="node">
<title>layer49_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="743,-59463.77 562,-59463.77 562,-59395.77 743,-59395.77 743,-59463.77"/>
<text text-anchor="middle" x="652.5" y="-59448.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="652.5" y="-59433.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="652.5" y="-59418.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="652.5" y="-59403.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_ffn_norm_4&#45;&gt;layer49_ffn_up_4 -->
<g id="edge1600" class="edge">
<title>layer49_ffn_norm_4&#45;&gt;layer49_ffn_up_4</title>
<path fill="none" stroke="black" d="M783.31,-59569C743.86,-59569 705.76,-59569 705.76,-59569 705.76,-59569 705.76,-59473.83 705.76,-59473.83"/>
<polygon fill="black" stroke="black" points="709.26,-59473.83 705.76,-59463.83 702.26,-59473.83 709.26,-59473.83"/>
</g>
<!-- layer49_ffn_gate_5 -->
<g id="node1254" class="node">
<title>layer49_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1394,-59463.77 1213,-59463.77 1213,-59395.77 1394,-59395.77 1394,-59463.77"/>
<text text-anchor="middle" x="1303.5" y="-59448.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1303.5" y="-59433.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1303.5" y="-59418.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1303.5" y="-59403.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_ffn_norm_5&#45;&gt;layer49_ffn_gate_5 -->
<g id="edge1599" class="edge">
<title>layer49_ffn_norm_5&#45;&gt;layer49_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1172.56,-59569C1211.95,-59569 1250,-59569 1250,-59569 1250,-59569 1250,-59473.83 1250,-59473.83"/>
<polygon fill="black" stroke="black" points="1253.5,-59473.83 1250,-59463.83 1246.5,-59473.83 1253.5,-59473.83"/>
</g>
<!-- layer49_ffn_up_5 -->
<g id="node1256" class="node">
<title>layer49_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1177,-59463.77 996,-59463.77 996,-59395.77 1177,-59395.77 1177,-59463.77"/>
<text text-anchor="middle" x="1086.5" y="-59448.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1086.5" y="-59433.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1086.5" y="-59418.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1086.5" y="-59403.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_ffn_norm_5&#45;&gt;layer49_ffn_up_5 -->
<g id="edge1601" class="edge">
<title>layer49_ffn_norm_5&#45;&gt;layer49_ffn_up_5</title>
<path fill="none" stroke="black" d="M1086.5,-59535.52C1086.5,-59535.52 1086.5,-59474.15 1086.5,-59474.15"/>
<polygon fill="black" stroke="black" points="1090,-59474.15 1086.5,-59464.15 1083,-59474.15 1090,-59474.15"/>
</g>
<!-- layer49_gate_ar -->
<g id="node1257" class="node">
<title>layer49_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1177.5" cy="-59275.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1177.5" y="-59294.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1177.5" y="-59279.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1177.5" y="-59264.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1177.5" y="-59249.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer49_ffn_gate_4&#45;&gt;layer49_gate_ar -->
<g id="edge1602" class="edge">
<title>layer49_ffn_gate_4&#45;&gt;layer49_gate_ar</title>
<path fill="none" stroke="black" d="M960.08,-59429C970.79,-59429 978,-59429 978,-59429 978,-59429 978,-59291 978,-59291 978,-59291 1045.99,-59291 1045.99,-59291"/>
<polygon fill="black" stroke="black" points="1045.99,-59294.5 1055.99,-59291 1045.99,-59287.5 1045.99,-59294.5"/>
</g>
<!-- layer49_ffn_gate_5&#45;&gt;layer49_gate_ar -->
<g id="edge1603" class="edge">
<title>layer49_ffn_gate_5&#45;&gt;layer49_gate_ar</title>
<path fill="none" stroke="black" d="M1259.24,-59395.57C1259.24,-59395.57 1259.24,-59322.75 1259.24,-59322.75"/>
<polygon fill="black" stroke="black" points="1262.74,-59322.75 1259.24,-59312.75 1255.74,-59322.75 1262.74,-59322.75"/>
</g>
<!-- layer49_up_ar -->
<g id="node1258" class="node">
<title>layer49_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="831.5" cy="-59275.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="831.5" y="-59294.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="831.5" y="-59279.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="831.5" y="-59264.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="831.5" y="-59249.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer49_ffn_up_4&#45;&gt;layer49_up_ar -->
<g id="edge1604" class="edge">
<title>layer49_ffn_up_4&#45;&gt;layer49_up_ar</title>
<path fill="none" stroke="black" d="M723.26,-59395.57C723.26,-59395.57 723.26,-59311.65 723.26,-59311.65"/>
<polygon fill="black" stroke="black" points="726.76,-59311.65 723.26,-59301.65 719.76,-59311.65 726.76,-59311.65"/>
</g>
<!-- layer49_ffn_up_5&#45;&gt;layer49_up_ar -->
<g id="edge1605" class="edge">
<title>layer49_ffn_up_5&#45;&gt;layer49_up_ar</title>
<path fill="none" stroke="black" d="M1022.76,-59395.62C1022.76,-59345.79 1022.76,-59259 1022.76,-59259 1022.76,-59259 961.54,-59259 961.54,-59259"/>
<polygon fill="black" stroke="black" points="961.54,-59255.5 951.54,-59259 961.54,-59262.5 961.54,-59255.5"/>
</g>
<!-- layer49_silu_4 -->
<g id="node1259" class="node">
<title>layer49_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1105,-59155.6 924,-59155.6 924,-59087.6 1105,-59087.6 1105,-59155.6"/>
<text text-anchor="middle" x="1014.5" y="-59140.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1014.5" y="-59125.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1014.5" y="-59110.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1014.5" y="-59095.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_gate_ar&#45;&gt;layer49_silu_4 -->
<g id="edge1606" class="edge">
<title>layer49_gate_ar&#45;&gt;layer49_silu_4</title>
<path fill="none" stroke="black" d="M1077.26,-59245.61C1077.26,-59245.61 1077.26,-59165.62 1077.26,-59165.62"/>
<polygon fill="black" stroke="black" points="1080.76,-59165.62 1077.26,-59155.62 1073.76,-59165.62 1080.76,-59165.62"/>
</g>
<!-- layer49_silu_5 -->
<g id="node1260" class="node">
<title>layer49_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1322,-59155.6 1141,-59155.6 1141,-59087.6 1322,-59087.6 1322,-59155.6"/>
<text text-anchor="middle" x="1231.5" y="-59140.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1231.5" y="-59125.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1231.5" y="-59110.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1231.5" y="-59095.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_gate_ar&#45;&gt;layer49_silu_5 -->
<g id="edge1607" class="edge">
<title>layer49_gate_ar&#45;&gt;layer49_silu_5</title>
<path fill="none" stroke="black" d="M1223.24,-59230.7C1223.24,-59230.7 1223.24,-59165.61 1223.24,-59165.61"/>
<polygon fill="black" stroke="black" points="1226.74,-59165.61 1223.24,-59155.61 1219.74,-59165.61 1226.74,-59165.61"/>
</g>
<!-- layer49_mul_4 -->
<g id="node1261" class="node">
<title>layer49_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="995,-59015.6 814,-59015.6 814,-58947.6 995,-58947.6 995,-59015.6"/>
<text text-anchor="middle" x="904.5" y="-59000.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="904.5" y="-58985.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="904.5" y="-58970.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="904.5" y="-58955.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_up_ar&#45;&gt;layer49_mul_4 -->
<g id="edge1609" class="edge">
<title>layer49_up_ar&#45;&gt;layer49_mul_4</title>
<path fill="none" stroke="black" d="M869,-59229.41C869,-59229.41 869,-59025.69 869,-59025.69"/>
<polygon fill="black" stroke="black" points="872.5,-59025.69 869,-59015.69 865.5,-59025.69 872.5,-59025.69"/>
</g>
<!-- layer49_mul_5 -->
<g id="node1262" class="node">
<title>layer49_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1212,-59015.6 1031,-59015.6 1031,-58947.6 1212,-58947.6 1212,-59015.6"/>
<text text-anchor="middle" x="1121.5" y="-59000.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1121.5" y="-58985.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1121.5" y="-58970.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1121.5" y="-58955.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer49_up_ar&#45;&gt;layer49_mul_5 -->
<g id="edge1611" class="edge">
<title>layer49_up_ar&#45;&gt;layer49_mul_5</title>
<path fill="none" stroke="black" d="M941.74,-59251.19C941.74,-59226.18 941.74,-59191 941.74,-59191 941.74,-59191 1123,-59191 1123,-59191 1123,-59191 1123,-59025.71 1123,-59025.71"/>
<polygon fill="black" stroke="black" points="1126.5,-59025.71 1123,-59015.71 1119.5,-59025.71 1126.5,-59025.71"/>
</g>
<!-- layer49_silu_4&#45;&gt;layer49_mul_4 -->
<g id="edge1608" class="edge">
<title>layer49_silu_4&#45;&gt;layer49_mul_4</title>
<path fill="none" stroke="black" d="M959.5,-59087.35C959.5,-59087.35 959.5,-59025.98 959.5,-59025.98"/>
<polygon fill="black" stroke="black" points="963,-59025.98 959.5,-59015.98 956,-59025.98 963,-59025.98"/>
</g>
<!-- layer49_silu_5&#45;&gt;layer49_mul_5 -->
<g id="edge1610" class="edge">
<title>layer49_silu_5&#45;&gt;layer49_mul_5</title>
<path fill="none" stroke="black" d="M1176.5,-59087.35C1176.5,-59087.35 1176.5,-59025.98 1176.5,-59025.98"/>
<polygon fill="black" stroke="black" points="1180,-59025.98 1176.5,-59015.98 1173,-59025.98 1180,-59025.98"/>
</g>
<!-- layer49_ffn_down_4 -->
<g id="node1263" class="node">
<title>layer49_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="994.5,-58875.6 822.5,-58875.6 822.5,-58807.6 994.5,-58807.6 994.5,-58875.6"/>
<text text-anchor="middle" x="908.5" y="-58860.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="908.5" y="-58845.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="908.5" y="-58830.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="908.5" y="-58815.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer49_mul_4&#45;&gt;layer49_ffn_down_4 -->
<g id="edge1612" class="edge">
<title>layer49_mul_4&#45;&gt;layer49_ffn_down_4</title>
<path fill="none" stroke="black" d="M908.5,-58947.35C908.5,-58947.35 908.5,-58885.98 908.5,-58885.98"/>
<polygon fill="black" stroke="black" points="912,-58885.98 908.5,-58875.98 905,-58885.98 912,-58885.98"/>
</g>
<!-- layer49_ffn_down_5 -->
<g id="node1264" class="node">
<title>layer49_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1204.5,-58875.6 1032.5,-58875.6 1032.5,-58807.6 1204.5,-58807.6 1204.5,-58875.6"/>
<text text-anchor="middle" x="1118.5" y="-58860.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1118.5" y="-58845.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1118.5" y="-58830.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1118.5" y="-58815.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer49_mul_5&#45;&gt;layer49_ffn_down_5 -->
<g id="edge1613" class="edge">
<title>layer49_mul_5&#45;&gt;layer49_ffn_down_5</title>
<path fill="none" stroke="black" d="M1118.5,-58947.35C1118.5,-58947.35 1118.5,-58885.98 1118.5,-58885.98"/>
<polygon fill="black" stroke="black" points="1122,-58885.98 1118.5,-58875.98 1115,-58885.98 1122,-58885.98"/>
</g>
<!-- layer49_ffn_ar -->
<g id="node1265" class="node">
<title>layer49_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1012.5" cy="-58687.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1012.5" y="-58706.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1012.5" y="-58691.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1012.5" y="-58676.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1012.5" y="-58661.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer49_ffn_down_4&#45;&gt;layer49_ffn_ar -->
<g id="edge1614" class="edge">
<title>layer49_ffn_down_4&#45;&gt;layer49_ffn_ar</title>
<path fill="none" stroke="black" d="M942.69,-58807.41C942.69,-58807.41 942.69,-58737.06 942.69,-58737.06"/>
<polygon fill="black" stroke="black" points="946.19,-58737.06 942.69,-58727.06 939.19,-58737.06 946.19,-58737.06"/>
</g>
<!-- layer49_ffn_down_5&#45;&gt;layer49_ffn_ar -->
<g id="edge1615" class="edge">
<title>layer49_ffn_down_5&#45;&gt;layer49_ffn_ar</title>
<path fill="none" stroke="black" d="M1083.31,-58807.41C1083.31,-58807.41 1083.31,-58736.78 1083.31,-58736.78"/>
<polygon fill="black" stroke="black" points="1086.81,-58736.78 1083.31,-58726.78 1079.81,-58736.78 1086.81,-58736.78"/>
</g>
<!-- layer50_norm_4 -->
<g id="node1266" class="node">
<title>layer50_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="994.5,-58567.44 822.5,-58567.44 822.5,-58499.44 994.5,-58499.44 994.5,-58567.44"/>
<text text-anchor="middle" x="908.5" y="-58552.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="908.5" y="-58537.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="908.5" y="-58522.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="908.5" y="-58507.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer49_ffn_ar&#45;&gt;layer50_norm_4 -->
<g id="edge1616" class="edge">
<title>layer49_ffn_ar&#45;&gt;layer50_norm_4</title>
<path fill="none" stroke="black" d="M942.69,-58647.84C942.69,-58647.84 942.69,-58577.49 942.69,-58577.49"/>
<polygon fill="black" stroke="black" points="946.19,-58577.49 942.69,-58567.49 939.19,-58577.49 946.19,-58577.49"/>
</g>
<!-- layer50_norm_5 -->
<g id="node1267" class="node">
<title>layer50_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1204.5,-58567.44 1032.5,-58567.44 1032.5,-58499.44 1204.5,-58499.44 1204.5,-58567.44"/>
<text text-anchor="middle" x="1118.5" y="-58552.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1118.5" y="-58537.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1118.5" y="-58522.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1118.5" y="-58507.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer49_ffn_ar&#45;&gt;layer50_norm_5 -->
<g id="edge1617" class="edge">
<title>layer49_ffn_ar&#45;&gt;layer50_norm_5</title>
<path fill="none" stroke="black" d="M1083.31,-58648.24C1083.31,-58648.24 1083.31,-58577.67 1083.31,-58577.67"/>
<polygon fill="black" stroke="black" points="1086.81,-58577.67 1083.31,-58567.67 1079.81,-58577.67 1086.81,-58577.67"/>
</g>
<!-- layer50_qkv_4 -->
<g id="node1268" class="node">
<title>layer50_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="995,-58427.44 814,-58427.44 814,-58359.44 995,-58359.44 995,-58427.44"/>
<text text-anchor="middle" x="904.5" y="-58412.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="904.5" y="-58397.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="904.5" y="-58382.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="904.5" y="-58367.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer50_norm_4&#45;&gt;layer50_qkv_4 -->
<g id="edge1618" class="edge">
<title>layer50_norm_4&#45;&gt;layer50_qkv_4</title>
<path fill="none" stroke="black" d="M908.5,-58499.19C908.5,-58499.19 908.5,-58437.82 908.5,-58437.82"/>
<polygon fill="black" stroke="black" points="912,-58437.82 908.5,-58427.82 905,-58437.82 912,-58437.82"/>
</g>
<!-- layer50_qkv_5 -->
<g id="node1269" class="node">
<title>layer50_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1212,-58427.44 1031,-58427.44 1031,-58359.44 1212,-58359.44 1212,-58427.44"/>
<text text-anchor="middle" x="1121.5" y="-58412.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1121.5" y="-58397.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1121.5" y="-58382.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1121.5" y="-58367.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer50_norm_5&#45;&gt;layer50_qkv_5 -->
<g id="edge1619" class="edge">
<title>layer50_norm_5&#45;&gt;layer50_qkv_5</title>
<path fill="none" stroke="black" d="M1118.5,-58499.19C1118.5,-58499.19 1118.5,-58437.82 1118.5,-58437.82"/>
<polygon fill="black" stroke="black" points="1122,-58437.82 1118.5,-58427.82 1115,-58437.82 1122,-58437.82"/>
</g>
<!-- layer50_qkv_ar -->
<g id="node1270" class="node">
<title>layer50_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1012.5" cy="-58239.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1012.5" y="-58258.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1012.5" y="-58243.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1012.5" y="-58228.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1012.5" y="-58213.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer50_qkv_4&#45;&gt;layer50_qkv_ar -->
<g id="edge1620" class="edge">
<title>layer50_qkv_4&#45;&gt;layer50_qkv_ar</title>
<path fill="none" stroke="black" d="M939.76,-58359.24C939.76,-58359.24 939.76,-58289.17 939.76,-58289.17"/>
<polygon fill="black" stroke="black" points="943.26,-58289.17 939.76,-58279.17 936.26,-58289.17 943.26,-58289.17"/>
</g>
<!-- layer50_qkv_5&#45;&gt;layer50_qkv_ar -->
<g id="edge1621" class="edge">
<title>layer50_qkv_5&#45;&gt;layer50_qkv_ar</title>
<path fill="none" stroke="black" d="M1085.74,-58359.24C1085.74,-58359.24 1085.74,-58288.89 1085.74,-58288.89"/>
<polygon fill="black" stroke="black" points="1089.24,-58288.89 1085.74,-58278.89 1082.24,-58288.9 1089.24,-58288.89"/>
</g>
<!-- layer50_attn_4 -->
<g id="node1271" class="node">
<title>layer50_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="994.5,-58119.27 822.5,-58119.27 822.5,-58051.27 994.5,-58051.27 994.5,-58119.27"/>
<text text-anchor="middle" x="908.5" y="-58104.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="908.5" y="-58089.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="908.5" y="-58074.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="908.5" y="-58059.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer50_qkv_ar&#45;&gt;layer50_attn_4 -->
<g id="edge1622" class="edge">
<title>layer50_qkv_ar&#45;&gt;layer50_attn_4</title>
<path fill="none" stroke="black" d="M939.51,-58199.67C939.51,-58199.67 939.51,-58129.33 939.51,-58129.33"/>
<polygon fill="black" stroke="black" points="943.01,-58129.33 939.51,-58119.33 936.01,-58129.33 943.01,-58129.33"/>
</g>
<!-- layer50_attn_5 -->
<g id="node1272" class="node">
<title>layer50_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1202.5,-58119.27 1030.5,-58119.27 1030.5,-58051.27 1202.5,-58051.27 1202.5,-58119.27"/>
<text text-anchor="middle" x="1116.5" y="-58104.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1116.5" y="-58089.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1116.5" y="-58074.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1116.5" y="-58059.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer50_qkv_ar&#45;&gt;layer50_attn_5 -->
<g id="edge1623" class="edge">
<title>layer50_qkv_ar&#45;&gt;layer50_attn_5</title>
<path fill="none" stroke="black" d="M1085.49,-58199.67C1085.49,-58199.67 1085.49,-58129.33 1085.49,-58129.33"/>
<polygon fill="black" stroke="black" points="1088.99,-58129.33 1085.49,-58119.33 1081.99,-58129.33 1088.99,-58129.33"/>
</g>
<!-- layer50_attn_out_4 -->
<g id="node1273" class="node">
<title>layer50_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="994.5,-57979.27 822.5,-57979.27 822.5,-57911.27 994.5,-57911.27 994.5,-57979.27"/>
<text text-anchor="middle" x="908.5" y="-57964.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="908.5" y="-57949.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="908.5" y="-57934.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="908.5" y="-57919.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer50_attn_4&#45;&gt;layer50_attn_out_4 -->
<g id="edge1624" class="edge">
<title>layer50_attn_4&#45;&gt;layer50_attn_out_4</title>
<path fill="none" stroke="black" d="M908.5,-58051.02C908.5,-58051.02 908.5,-57989.65 908.5,-57989.65"/>
<polygon fill="black" stroke="black" points="912,-57989.65 908.5,-57979.65 905,-57989.65 912,-57989.65"/>
</g>
<!-- layer50_attn_out_5 -->
<g id="node1274" class="node">
<title>layer50_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1202.5,-57979.27 1030.5,-57979.27 1030.5,-57911.27 1202.5,-57911.27 1202.5,-57979.27"/>
<text text-anchor="middle" x="1116.5" y="-57964.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1116.5" y="-57949.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1116.5" y="-57934.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1116.5" y="-57919.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer50_attn_5&#45;&gt;layer50_attn_out_5 -->
<g id="edge1625" class="edge">
<title>layer50_attn_5&#45;&gt;layer50_attn_out_5</title>
<path fill="none" stroke="black" d="M1116.5,-58051.02C1116.5,-58051.02 1116.5,-57989.65 1116.5,-57989.65"/>
<polygon fill="black" stroke="black" points="1120,-57989.65 1116.5,-57979.65 1113,-57989.65 1120,-57989.65"/>
</g>
<!-- layer50_attn_ar -->
<g id="node1275" class="node">
<title>layer50_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1012.5" cy="-57791.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1012.5" y="-57809.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1012.5" y="-57794.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1012.5" y="-57779.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1012.5" y="-57764.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer50_attn_out_4&#45;&gt;layer50_attn_ar -->
<g id="edge1626" class="edge">
<title>layer50_attn_out_4&#45;&gt;layer50_attn_ar</title>
<path fill="none" stroke="black" d="M942.69,-57911.07C942.69,-57911.07 942.69,-57840.73 942.69,-57840.73"/>
<polygon fill="black" stroke="black" points="946.19,-57840.73 942.69,-57830.73 939.19,-57840.73 946.19,-57840.73"/>
</g>
<!-- layer50_attn_out_5&#45;&gt;layer50_attn_ar -->
<g id="edge1627" class="edge">
<title>layer50_attn_out_5&#45;&gt;layer50_attn_ar</title>
<path fill="none" stroke="black" d="M1082.31,-57911.07C1082.31,-57911.07 1082.31,-57840.73 1082.31,-57840.73"/>
<polygon fill="black" stroke="black" points="1085.81,-57840.73 1082.31,-57830.73 1078.81,-57840.73 1085.81,-57840.73"/>
</g>
<!-- layer50_ffn_norm_4 -->
<g id="node1276" class="node">
<title>layer50_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="990.5,-57671.1 818.5,-57671.1 818.5,-57603.1 990.5,-57603.1 990.5,-57671.1"/>
<text text-anchor="middle" x="904.5" y="-57655.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="904.5" y="-57640.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="904.5" y="-57625.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="904.5" y="-57610.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer50_attn_ar&#45;&gt;layer50_ffn_norm_4 -->
<g id="edge1628" class="edge">
<title>layer50_attn_ar&#45;&gt;layer50_ffn_norm_4</title>
<path fill="none" stroke="black" d="M940.69,-57752.3C940.69,-57752.3 940.69,-57681.25 940.69,-57681.25"/>
<polygon fill="black" stroke="black" points="944.19,-57681.25 940.69,-57671.25 937.19,-57681.25 944.19,-57681.25"/>
</g>
<!-- layer50_ffn_norm_5 -->
<g id="node1277" class="node">
<title>layer50_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1207.5,-57671.1 1035.5,-57671.1 1035.5,-57603.1 1207.5,-57603.1 1207.5,-57671.1"/>
<text text-anchor="middle" x="1121.5" y="-57655.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1121.5" y="-57640.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1121.5" y="-57625.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1121.5" y="-57610.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer50_attn_ar&#45;&gt;layer50_ffn_norm_5 -->
<g id="edge1629" class="edge">
<title>layer50_attn_ar&#45;&gt;layer50_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1084.81,-57752.3C1084.81,-57752.3 1084.81,-57681.25 1084.81,-57681.25"/>
<polygon fill="black" stroke="black" points="1088.31,-57681.25 1084.81,-57671.25 1081.31,-57681.25 1088.31,-57681.25"/>
</g>
<!-- layer50_ffn_gate_4 -->
<g id="node1278" class="node">
<title>layer50_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="995,-57531.1 814,-57531.1 814,-57463.1 995,-57463.1 995,-57531.1"/>
<text text-anchor="middle" x="904.5" y="-57515.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="904.5" y="-57500.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="904.5" y="-57485.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="904.5" y="-57470.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_ffn_norm_4&#45;&gt;layer50_ffn_gate_4 -->
<g id="edge1630" class="edge">
<title>layer50_ffn_norm_4&#45;&gt;layer50_ffn_gate_4</title>
<path fill="none" stroke="black" d="M904.5,-57602.85C904.5,-57602.85 904.5,-57541.48 904.5,-57541.48"/>
<polygon fill="black" stroke="black" points="908,-57541.48 904.5,-57531.48 901,-57541.48 908,-57541.48"/>
</g>
<!-- layer50_ffn_up_4 -->
<g id="node1280" class="node">
<title>layer50_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="778,-57531.1 597,-57531.1 597,-57463.1 778,-57463.1 778,-57531.1"/>
<text text-anchor="middle" x="687.5" y="-57515.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="687.5" y="-57500.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="687.5" y="-57485.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="687.5" y="-57470.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_ffn_norm_4&#45;&gt;layer50_ffn_up_4 -->
<g id="edge1632" class="edge">
<title>layer50_ffn_norm_4&#45;&gt;layer50_ffn_up_4</title>
<path fill="none" stroke="black" d="M818.31,-57637C778.86,-57637 740.76,-57637 740.76,-57637 740.76,-57637 740.76,-57541.33 740.76,-57541.33"/>
<polygon fill="black" stroke="black" points="744.26,-57541.33 740.76,-57531.33 737.26,-57541.33 744.26,-57541.33"/>
</g>
<!-- layer50_ffn_gate_5 -->
<g id="node1279" class="node">
<title>layer50_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1429,-57531.1 1248,-57531.1 1248,-57463.1 1429,-57463.1 1429,-57531.1"/>
<text text-anchor="middle" x="1338.5" y="-57515.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1338.5" y="-57500.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1338.5" y="-57485.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1338.5" y="-57470.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_ffn_norm_5&#45;&gt;layer50_ffn_gate_5 -->
<g id="edge1631" class="edge">
<title>layer50_ffn_norm_5&#45;&gt;layer50_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1207.56,-57637C1246.95,-57637 1285,-57637 1285,-57637 1285,-57637 1285,-57541.33 1285,-57541.33"/>
<polygon fill="black" stroke="black" points="1288.5,-57541.33 1285,-57531.33 1281.5,-57541.33 1288.5,-57541.33"/>
</g>
<!-- layer50_ffn_up_5 -->
<g id="node1281" class="node">
<title>layer50_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1212,-57531.1 1031,-57531.1 1031,-57463.1 1212,-57463.1 1212,-57531.1"/>
<text text-anchor="middle" x="1121.5" y="-57515.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1121.5" y="-57500.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1121.5" y="-57485.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1121.5" y="-57470.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_ffn_norm_5&#45;&gt;layer50_ffn_up_5 -->
<g id="edge1633" class="edge">
<title>layer50_ffn_norm_5&#45;&gt;layer50_ffn_up_5</title>
<path fill="none" stroke="black" d="M1121.5,-57602.85C1121.5,-57602.85 1121.5,-57541.48 1121.5,-57541.48"/>
<polygon fill="black" stroke="black" points="1125,-57541.48 1121.5,-57531.48 1118,-57541.48 1125,-57541.48"/>
</g>
<!-- layer50_gate_ar -->
<g id="node1282" class="node">
<title>layer50_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1212.5" cy="-57343.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1212.5" y="-57361.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1212.5" y="-57346.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1212.5" y="-57331.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1212.5" y="-57316.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer50_ffn_gate_4&#45;&gt;layer50_gate_ar -->
<g id="edge1634" class="edge">
<title>layer50_ffn_gate_4&#45;&gt;layer50_gate_ar</title>
<path fill="none" stroke="black" d="M995.08,-57497C1005.79,-57497 1013,-57497 1013,-57497 1013,-57497 1013,-57359 1013,-57359 1013,-57359 1081.56,-57359 1081.56,-57359"/>
<polygon fill="black" stroke="black" points="1081.56,-57362.5 1091.56,-57359 1081.56,-57355.5 1081.56,-57362.5"/>
</g>
<!-- layer50_ffn_gate_5&#45;&gt;layer50_gate_ar -->
<g id="edge1635" class="edge">
<title>layer50_ffn_gate_5&#45;&gt;layer50_gate_ar</title>
<path fill="none" stroke="black" d="M1294.24,-57462.91C1294.24,-57462.91 1294.24,-57390.08 1294.24,-57390.08"/>
<polygon fill="black" stroke="black" points="1297.74,-57390.08 1294.24,-57380.08 1290.74,-57390.08 1297.74,-57390.08"/>
</g>
<!-- layer50_up_ar -->
<g id="node1283" class="node">
<title>layer50_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="866.5" cy="-57343.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="866.5" y="-57361.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="866.5" y="-57346.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="866.5" y="-57331.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="866.5" y="-57316.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer50_ffn_up_4&#45;&gt;layer50_up_ar -->
<g id="edge1636" class="edge">
<title>layer50_ffn_up_4&#45;&gt;layer50_up_ar</title>
<path fill="none" stroke="black" d="M758.26,-57462.91C758.26,-57462.91 758.26,-57378.98 758.26,-57378.98"/>
<polygon fill="black" stroke="black" points="761.76,-57378.98 758.26,-57368.98 754.76,-57378.98 761.76,-57378.98"/>
</g>
<!-- layer50_ffn_up_5&#45;&gt;layer50_up_ar -->
<g id="edge1637" class="edge">
<title>layer50_ffn_up_5&#45;&gt;layer50_up_ar</title>
<path fill="none" stroke="black" d="M1057.76,-57462.89C1057.76,-57412.96 1057.76,-57326 1057.76,-57326 1057.76,-57326 996.27,-57326 996.27,-57326"/>
<polygon fill="black" stroke="black" points="996.27,-57322.5 986.27,-57326 996.27,-57329.5 996.27,-57322.5"/>
</g>
<!-- layer50_silu_4 -->
<g id="node1284" class="node">
<title>layer50_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1140,-57222.94 959,-57222.94 959,-57154.94 1140,-57154.94 1140,-57222.94"/>
<text text-anchor="middle" x="1049.5" y="-57207.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1049.5" y="-57192.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1049.5" y="-57177.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1049.5" y="-57162.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_gate_ar&#45;&gt;layer50_silu_4 -->
<g id="edge1638" class="edge">
<title>layer50_gate_ar&#45;&gt;layer50_silu_4</title>
<path fill="none" stroke="black" d="M1112.26,-57312.94C1112.26,-57312.94 1112.26,-57232.96 1112.26,-57232.96"/>
<polygon fill="black" stroke="black" points="1115.76,-57232.96 1112.26,-57222.96 1108.76,-57232.96 1115.76,-57232.96"/>
</g>
<!-- layer50_silu_5 -->
<g id="node1285" class="node">
<title>layer50_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1357,-57222.94 1176,-57222.94 1176,-57154.94 1357,-57154.94 1357,-57222.94"/>
<text text-anchor="middle" x="1266.5" y="-57207.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1266.5" y="-57192.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1266.5" y="-57177.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1266.5" y="-57162.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_gate_ar&#45;&gt;layer50_silu_5 -->
<g id="edge1639" class="edge">
<title>layer50_gate_ar&#45;&gt;layer50_silu_5</title>
<path fill="none" stroke="black" d="M1258.24,-57298.04C1258.24,-57298.04 1258.24,-57232.94 1258.24,-57232.94"/>
<polygon fill="black" stroke="black" points="1261.74,-57232.94 1258.24,-57222.94 1254.74,-57232.94 1261.74,-57232.94"/>
</g>
<!-- layer50_mul_4 -->
<g id="node1286" class="node">
<title>layer50_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1030,-57082.94 849,-57082.94 849,-57014.94 1030,-57014.94 1030,-57082.94"/>
<text text-anchor="middle" x="939.5" y="-57067.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="939.5" y="-57052.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="939.5" y="-57037.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="939.5" y="-57022.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_up_ar&#45;&gt;layer50_mul_4 -->
<g id="edge1641" class="edge">
<title>layer50_up_ar&#45;&gt;layer50_mul_4</title>
<path fill="none" stroke="black" d="M904,-57296.75C904,-57296.75 904,-57093.02 904,-57093.02"/>
<polygon fill="black" stroke="black" points="907.5,-57093.02 904,-57083.02 900.5,-57093.02 907.5,-57093.02"/>
</g>
<!-- layer50_mul_5 -->
<g id="node1287" class="node">
<title>layer50_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1247,-57082.94 1066,-57082.94 1066,-57014.94 1247,-57014.94 1247,-57082.94"/>
<text text-anchor="middle" x="1156.5" y="-57067.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1156.5" y="-57052.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1156.5" y="-57037.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1156.5" y="-57022.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer50_up_ar&#45;&gt;layer50_mul_5 -->
<g id="edge1643" class="edge">
<title>layer50_up_ar&#45;&gt;layer50_mul_5</title>
<path fill="none" stroke="black" d="M976.74,-57318.43C976.74,-57293.32 976.74,-57258 976.74,-57258 976.74,-57258 1158,-57258 1158,-57258 1158,-57258 1158,-57092.99 1158,-57092.99"/>
<polygon fill="black" stroke="black" points="1161.5,-57092.99 1158,-57082.99 1154.5,-57092.99 1161.5,-57092.99"/>
</g>
<!-- layer50_silu_4&#45;&gt;layer50_mul_4 -->
<g id="edge1640" class="edge">
<title>layer50_silu_4&#45;&gt;layer50_mul_4</title>
<path fill="none" stroke="black" d="M994.5,-57154.69C994.5,-57154.69 994.5,-57093.32 994.5,-57093.32"/>
<polygon fill="black" stroke="black" points="998,-57093.32 994.5,-57083.32 991,-57093.32 998,-57093.32"/>
</g>
<!-- layer50_silu_5&#45;&gt;layer50_mul_5 -->
<g id="edge1642" class="edge">
<title>layer50_silu_5&#45;&gt;layer50_mul_5</title>
<path fill="none" stroke="black" d="M1211.5,-57154.69C1211.5,-57154.69 1211.5,-57093.32 1211.5,-57093.32"/>
<polygon fill="black" stroke="black" points="1215,-57093.32 1211.5,-57083.32 1208,-57093.32 1215,-57093.32"/>
</g>
<!-- layer50_ffn_down_4 -->
<g id="node1288" class="node">
<title>layer50_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1029.5,-56942.94 857.5,-56942.94 857.5,-56874.94 1029.5,-56874.94 1029.5,-56942.94"/>
<text text-anchor="middle" x="943.5" y="-56927.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="943.5" y="-56912.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="943.5" y="-56897.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="943.5" y="-56882.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer50_mul_4&#45;&gt;layer50_ffn_down_4 -->
<g id="edge1644" class="edge">
<title>layer50_mul_4&#45;&gt;layer50_ffn_down_4</title>
<path fill="none" stroke="black" d="M943.5,-57014.69C943.5,-57014.69 943.5,-56953.32 943.5,-56953.32"/>
<polygon fill="black" stroke="black" points="947,-56953.32 943.5,-56943.32 940,-56953.32 947,-56953.32"/>
</g>
<!-- layer50_ffn_down_5 -->
<g id="node1289" class="node">
<title>layer50_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1239.5,-56942.94 1067.5,-56942.94 1067.5,-56874.94 1239.5,-56874.94 1239.5,-56942.94"/>
<text text-anchor="middle" x="1153.5" y="-56927.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1153.5" y="-56912.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1153.5" y="-56897.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1153.5" y="-56882.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer50_mul_5&#45;&gt;layer50_ffn_down_5 -->
<g id="edge1645" class="edge">
<title>layer50_mul_5&#45;&gt;layer50_ffn_down_5</title>
<path fill="none" stroke="black" d="M1153.5,-57014.69C1153.5,-57014.69 1153.5,-56953.32 1153.5,-56953.32"/>
<polygon fill="black" stroke="black" points="1157,-56953.32 1153.5,-56943.32 1150,-56953.32 1157,-56953.32"/>
</g>
<!-- layer50_ffn_ar -->
<g id="node1290" class="node">
<title>layer50_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1047.5" cy="-56754.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1047.5" y="-56773.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1047.5" y="-56758.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1047.5" y="-56743.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1047.5" y="-56728.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer50_ffn_down_4&#45;&gt;layer50_ffn_ar -->
<g id="edge1646" class="edge">
<title>layer50_ffn_down_4&#45;&gt;layer50_ffn_ar</title>
<path fill="none" stroke="black" d="M977.69,-56874.74C977.69,-56874.74 977.69,-56804.4 977.69,-56804.4"/>
<polygon fill="black" stroke="black" points="981.19,-56804.4 977.69,-56794.4 974.19,-56804.4 981.19,-56804.4"/>
</g>
<!-- layer50_ffn_down_5&#45;&gt;layer50_ffn_ar -->
<g id="edge1647" class="edge">
<title>layer50_ffn_down_5&#45;&gt;layer50_ffn_ar</title>
<path fill="none" stroke="black" d="M1118.31,-56874.74C1118.31,-56874.74 1118.31,-56804.12 1118.31,-56804.12"/>
<polygon fill="black" stroke="black" points="1121.81,-56804.12 1118.31,-56794.12 1114.81,-56804.12 1121.81,-56804.12"/>
</g>
<!-- layer51_norm_4 -->
<g id="node1291" class="node">
<title>layer51_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1029.5,-56634.77 857.5,-56634.77 857.5,-56566.77 1029.5,-56566.77 1029.5,-56634.77"/>
<text text-anchor="middle" x="943.5" y="-56619.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="943.5" y="-56604.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="943.5" y="-56589.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="943.5" y="-56574.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer50_ffn_ar&#45;&gt;layer51_norm_4 -->
<g id="edge1648" class="edge">
<title>layer50_ffn_ar&#45;&gt;layer51_norm_4</title>
<path fill="none" stroke="black" d="M977.69,-56715.17C977.69,-56715.17 977.69,-56644.83 977.69,-56644.83"/>
<polygon fill="black" stroke="black" points="981.19,-56644.83 977.69,-56634.83 974.19,-56644.83 981.19,-56644.83"/>
</g>
<!-- layer51_norm_5 -->
<g id="node1292" class="node">
<title>layer51_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1239.5,-56634.77 1067.5,-56634.77 1067.5,-56566.77 1239.5,-56566.77 1239.5,-56634.77"/>
<text text-anchor="middle" x="1153.5" y="-56619.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1153.5" y="-56604.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1153.5" y="-56589.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1153.5" y="-56574.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer50_ffn_ar&#45;&gt;layer51_norm_5 -->
<g id="edge1649" class="edge">
<title>layer50_ffn_ar&#45;&gt;layer51_norm_5</title>
<path fill="none" stroke="black" d="M1118.31,-56715.57C1118.31,-56715.57 1118.31,-56645 1118.31,-56645"/>
<polygon fill="black" stroke="black" points="1121.81,-56645 1118.31,-56635 1114.81,-56645 1121.81,-56645"/>
</g>
<!-- layer51_qkv_4 -->
<g id="node1293" class="node">
<title>layer51_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1030,-56494.77 849,-56494.77 849,-56426.77 1030,-56426.77 1030,-56494.77"/>
<text text-anchor="middle" x="939.5" y="-56479.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="939.5" y="-56464.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="939.5" y="-56449.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="939.5" y="-56434.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer51_norm_4&#45;&gt;layer51_qkv_4 -->
<g id="edge1650" class="edge">
<title>layer51_norm_4&#45;&gt;layer51_qkv_4</title>
<path fill="none" stroke="black" d="M943.5,-56566.52C943.5,-56566.52 943.5,-56505.15 943.5,-56505.15"/>
<polygon fill="black" stroke="black" points="947,-56505.15 943.5,-56495.15 940,-56505.15 947,-56505.15"/>
</g>
<!-- layer51_qkv_5 -->
<g id="node1294" class="node">
<title>layer51_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1247,-56494.77 1066,-56494.77 1066,-56426.77 1247,-56426.77 1247,-56494.77"/>
<text text-anchor="middle" x="1156.5" y="-56479.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1156.5" y="-56464.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1156.5" y="-56449.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1156.5" y="-56434.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer51_norm_5&#45;&gt;layer51_qkv_5 -->
<g id="edge1651" class="edge">
<title>layer51_norm_5&#45;&gt;layer51_qkv_5</title>
<path fill="none" stroke="black" d="M1153.5,-56566.52C1153.5,-56566.52 1153.5,-56505.15 1153.5,-56505.15"/>
<polygon fill="black" stroke="black" points="1157,-56505.15 1153.5,-56495.15 1150,-56505.15 1157,-56505.15"/>
</g>
<!-- layer51_qkv_ar -->
<g id="node1295" class="node">
<title>layer51_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1047.5" cy="-56306.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1047.5" y="-56325.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1047.5" y="-56310.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1047.5" y="-56295.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1047.5" y="-56280.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer51_qkv_4&#45;&gt;layer51_qkv_ar -->
<g id="edge1652" class="edge">
<title>layer51_qkv_4&#45;&gt;layer51_qkv_ar</title>
<path fill="none" stroke="black" d="M974.76,-56426.57C974.76,-56426.57 974.76,-56356.51 974.76,-56356.51"/>
<polygon fill="black" stroke="black" points="978.26,-56356.51 974.76,-56346.51 971.26,-56356.51 978.26,-56356.51"/>
</g>
<!-- layer51_qkv_5&#45;&gt;layer51_qkv_ar -->
<g id="edge1653" class="edge">
<title>layer51_qkv_5&#45;&gt;layer51_qkv_ar</title>
<path fill="none" stroke="black" d="M1120.74,-56426.57C1120.74,-56426.57 1120.74,-56356.23 1120.74,-56356.23"/>
<polygon fill="black" stroke="black" points="1124.24,-56356.23 1120.74,-56346.23 1117.24,-56356.23 1124.24,-56356.23"/>
</g>
<!-- layer51_attn_4 -->
<g id="node1296" class="node">
<title>layer51_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1029.5,-56186.6 857.5,-56186.6 857.5,-56118.6 1029.5,-56118.6 1029.5,-56186.6"/>
<text text-anchor="middle" x="943.5" y="-56171.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="943.5" y="-56156.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="943.5" y="-56141.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="943.5" y="-56126.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer51_qkv_ar&#45;&gt;layer51_attn_4 -->
<g id="edge1654" class="edge">
<title>layer51_qkv_ar&#45;&gt;layer51_attn_4</title>
<path fill="none" stroke="black" d="M974.51,-56267.01C974.51,-56267.01 974.51,-56196.66 974.51,-56196.66"/>
<polygon fill="black" stroke="black" points="978.01,-56196.66 974.51,-56186.66 971.01,-56196.66 978.01,-56196.66"/>
</g>
<!-- layer51_attn_5 -->
<g id="node1297" class="node">
<title>layer51_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1237.5,-56186.6 1065.5,-56186.6 1065.5,-56118.6 1237.5,-56118.6 1237.5,-56186.6"/>
<text text-anchor="middle" x="1151.5" y="-56171.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1151.5" y="-56156.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1151.5" y="-56141.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1151.5" y="-56126.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer51_qkv_ar&#45;&gt;layer51_attn_5 -->
<g id="edge1655" class="edge">
<title>layer51_qkv_ar&#45;&gt;layer51_attn_5</title>
<path fill="none" stroke="black" d="M1120.49,-56267.01C1120.49,-56267.01 1120.49,-56196.66 1120.49,-56196.66"/>
<polygon fill="black" stroke="black" points="1123.99,-56196.66 1120.49,-56186.66 1116.99,-56196.66 1123.99,-56196.66"/>
</g>
<!-- layer51_attn_out_4 -->
<g id="node1298" class="node">
<title>layer51_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1029.5,-56046.6 857.5,-56046.6 857.5,-55978.6 1029.5,-55978.6 1029.5,-56046.6"/>
<text text-anchor="middle" x="943.5" y="-56031.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="943.5" y="-56016.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="943.5" y="-56001.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="943.5" y="-55986.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer51_attn_4&#45;&gt;layer51_attn_out_4 -->
<g id="edge1656" class="edge">
<title>layer51_attn_4&#45;&gt;layer51_attn_out_4</title>
<path fill="none" stroke="black" d="M943.5,-56118.36C943.5,-56118.36 943.5,-56056.98 943.5,-56056.98"/>
<polygon fill="black" stroke="black" points="947,-56056.98 943.5,-56046.98 940,-56056.98 947,-56056.98"/>
</g>
<!-- layer51_attn_out_5 -->
<g id="node1299" class="node">
<title>layer51_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1237.5,-56046.6 1065.5,-56046.6 1065.5,-55978.6 1237.5,-55978.6 1237.5,-56046.6"/>
<text text-anchor="middle" x="1151.5" y="-56031.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1151.5" y="-56016.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1151.5" y="-56001.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1151.5" y="-55986.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer51_attn_5&#45;&gt;layer51_attn_out_5 -->
<g id="edge1657" class="edge">
<title>layer51_attn_5&#45;&gt;layer51_attn_out_5</title>
<path fill="none" stroke="black" d="M1151.5,-56118.36C1151.5,-56118.36 1151.5,-56056.98 1151.5,-56056.98"/>
<polygon fill="black" stroke="black" points="1155,-56056.98 1151.5,-56046.98 1148,-56056.98 1155,-56056.98"/>
</g>
<!-- layer51_attn_ar -->
<g id="node1300" class="node">
<title>layer51_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1047.5" cy="-55858.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1047.5" y="-55877.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1047.5" y="-55862.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1047.5" y="-55847.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1047.5" y="-55832.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer51_attn_out_4&#45;&gt;layer51_attn_ar -->
<g id="edge1658" class="edge">
<title>layer51_attn_out_4&#45;&gt;layer51_attn_ar</title>
<path fill="none" stroke="black" d="M977.69,-55978.41C977.69,-55978.41 977.69,-55908.06 977.69,-55908.06"/>
<polygon fill="black" stroke="black" points="981.19,-55908.06 977.69,-55898.06 974.19,-55908.06 981.19,-55908.06"/>
</g>
<!-- layer51_attn_out_5&#45;&gt;layer51_attn_ar -->
<g id="edge1659" class="edge">
<title>layer51_attn_out_5&#45;&gt;layer51_attn_ar</title>
<path fill="none" stroke="black" d="M1117.31,-55978.41C1117.31,-55978.41 1117.31,-55908.06 1117.31,-55908.06"/>
<polygon fill="black" stroke="black" points="1120.81,-55908.06 1117.31,-55898.06 1113.81,-55908.06 1120.81,-55908.06"/>
</g>
<!-- layer51_ffn_norm_4 -->
<g id="node1301" class="node">
<title>layer51_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1025.5,-55738.44 853.5,-55738.44 853.5,-55670.44 1025.5,-55670.44 1025.5,-55738.44"/>
<text text-anchor="middle" x="939.5" y="-55723.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="939.5" y="-55708.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="939.5" y="-55693.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="939.5" y="-55678.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer51_attn_ar&#45;&gt;layer51_ffn_norm_4 -->
<g id="edge1660" class="edge">
<title>layer51_attn_ar&#45;&gt;layer51_ffn_norm_4</title>
<path fill="none" stroke="black" d="M975.69,-55819.64C975.69,-55819.64 975.69,-55748.58 975.69,-55748.58"/>
<polygon fill="black" stroke="black" points="979.19,-55748.58 975.69,-55738.58 972.19,-55748.58 979.19,-55748.58"/>
</g>
<!-- layer51_ffn_norm_5 -->
<g id="node1302" class="node">
<title>layer51_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1242.5,-55738.44 1070.5,-55738.44 1070.5,-55670.44 1242.5,-55670.44 1242.5,-55738.44"/>
<text text-anchor="middle" x="1156.5" y="-55723.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1156.5" y="-55708.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1156.5" y="-55693.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1156.5" y="-55678.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer51_attn_ar&#45;&gt;layer51_ffn_norm_5 -->
<g id="edge1661" class="edge">
<title>layer51_attn_ar&#45;&gt;layer51_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1119.81,-55819.64C1119.81,-55819.64 1119.81,-55748.58 1119.81,-55748.58"/>
<polygon fill="black" stroke="black" points="1123.31,-55748.58 1119.81,-55738.58 1116.31,-55748.58 1123.31,-55748.58"/>
</g>
<!-- layer51_ffn_gate_4 -->
<g id="node1303" class="node">
<title>layer51_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1030,-55598.44 849,-55598.44 849,-55530.44 1030,-55530.44 1030,-55598.44"/>
<text text-anchor="middle" x="939.5" y="-55583.24" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="939.5" y="-55568.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="939.5" y="-55553.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="939.5" y="-55538.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_ffn_norm_4&#45;&gt;layer51_ffn_gate_4 -->
<g id="edge1662" class="edge">
<title>layer51_ffn_norm_4&#45;&gt;layer51_ffn_gate_4</title>
<path fill="none" stroke="black" d="M939.5,-55670.19C939.5,-55670.19 939.5,-55608.82 939.5,-55608.82"/>
<polygon fill="black" stroke="black" points="943,-55608.82 939.5,-55598.82 936,-55608.82 943,-55608.82"/>
</g>
<!-- layer51_ffn_up_4 -->
<g id="node1305" class="node">
<title>layer51_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="813,-55598.44 632,-55598.44 632,-55530.44 813,-55530.44 813,-55598.44"/>
<text text-anchor="middle" x="722.5" y="-55583.24" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="722.5" y="-55568.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="722.5" y="-55553.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="722.5" y="-55538.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_ffn_norm_4&#45;&gt;layer51_ffn_up_4 -->
<g id="edge1664" class="edge">
<title>layer51_ffn_norm_4&#45;&gt;layer51_ffn_up_4</title>
<path fill="none" stroke="black" d="M853.31,-55704C813.86,-55704 775.76,-55704 775.76,-55704 775.76,-55704 775.76,-55608.58 775.76,-55608.58"/>
<polygon fill="black" stroke="black" points="779.26,-55608.58 775.76,-55598.58 772.26,-55608.58 779.26,-55608.58"/>
</g>
<!-- layer51_ffn_gate_5 -->
<g id="node1304" class="node">
<title>layer51_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1464,-55598.44 1283,-55598.44 1283,-55530.44 1464,-55530.44 1464,-55598.44"/>
<text text-anchor="middle" x="1373.5" y="-55583.24" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1373.5" y="-55568.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1373.5" y="-55553.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1373.5" y="-55538.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_ffn_norm_5&#45;&gt;layer51_ffn_gate_5 -->
<g id="edge1663" class="edge">
<title>layer51_ffn_norm_5&#45;&gt;layer51_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1242.56,-55704C1281.95,-55704 1320,-55704 1320,-55704 1320,-55704 1320,-55608.58 1320,-55608.58"/>
<polygon fill="black" stroke="black" points="1323.5,-55608.58 1320,-55598.58 1316.5,-55608.58 1323.5,-55608.58"/>
</g>
<!-- layer51_ffn_up_5 -->
<g id="node1306" class="node">
<title>layer51_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1247,-55598.44 1066,-55598.44 1066,-55530.44 1247,-55530.44 1247,-55598.44"/>
<text text-anchor="middle" x="1156.5" y="-55583.24" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1156.5" y="-55568.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1156.5" y="-55553.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1156.5" y="-55538.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_ffn_norm_5&#45;&gt;layer51_ffn_up_5 -->
<g id="edge1665" class="edge">
<title>layer51_ffn_norm_5&#45;&gt;layer51_ffn_up_5</title>
<path fill="none" stroke="black" d="M1156.5,-55670.19C1156.5,-55670.19 1156.5,-55608.82 1156.5,-55608.82"/>
<polygon fill="black" stroke="black" points="1160,-55608.82 1156.5,-55598.82 1153,-55608.82 1160,-55608.82"/>
</g>
<!-- layer51_gate_ar -->
<g id="node1307" class="node">
<title>layer51_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1247.5" cy="-55410.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1247.5" y="-55429.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1247.5" y="-55414.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1247.5" y="-55399.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1247.5" y="-55384.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer51_ffn_gate_4&#45;&gt;layer51_gate_ar -->
<g id="edge1666" class="edge">
<title>layer51_ffn_gate_4&#45;&gt;layer51_gate_ar</title>
<path fill="none" stroke="black" d="M1030.08,-55564C1040.79,-55564 1048,-55564 1048,-55564 1048,-55564 1048,-55426 1048,-55426 1048,-55426 1116.28,-55426 1116.28,-55426"/>
<polygon fill="black" stroke="black" points="1116.28,-55429.5 1126.28,-55426 1116.28,-55422.5 1116.28,-55429.5"/>
</g>
<!-- layer51_ffn_gate_5&#45;&gt;layer51_gate_ar -->
<g id="edge1667" class="edge">
<title>layer51_ffn_gate_5&#45;&gt;layer51_gate_ar</title>
<path fill="none" stroke="black" d="M1329.24,-55530.24C1329.24,-55530.24 1329.24,-55457.42 1329.24,-55457.42"/>
<polygon fill="black" stroke="black" points="1332.74,-55457.42 1329.24,-55447.42 1325.74,-55457.42 1332.74,-55457.42"/>
</g>
<!-- layer51_up_ar -->
<g id="node1308" class="node">
<title>layer51_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="901.5" cy="-55410.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="901.5" y="-55429.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="901.5" y="-55414.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="901.5" y="-55399.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="901.5" y="-55384.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer51_ffn_up_4&#45;&gt;layer51_up_ar -->
<g id="edge1668" class="edge">
<title>layer51_ffn_up_4&#45;&gt;layer51_up_ar</title>
<path fill="none" stroke="black" d="M793.26,-55530.24C793.26,-55530.24 793.26,-55446.32 793.26,-55446.32"/>
<polygon fill="black" stroke="black" points="796.76,-55446.32 793.26,-55436.32 789.76,-55446.32 796.76,-55446.32"/>
</g>
<!-- layer51_ffn_up_5&#45;&gt;layer51_up_ar -->
<g id="edge1669" class="edge">
<title>layer51_ffn_up_5&#45;&gt;layer51_up_ar</title>
<path fill="none" stroke="black" d="M1092.76,-55530.36C1092.76,-55480.62 1092.76,-55394 1092.76,-55394 1092.76,-55394 1032.08,-55394 1032.08,-55394"/>
<polygon fill="black" stroke="black" points="1032.08,-55390.5 1022.08,-55394 1032.08,-55397.5 1032.08,-55390.5"/>
</g>
<!-- layer51_silu_4 -->
<g id="node1309" class="node">
<title>layer51_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1175,-55290.27 994,-55290.27 994,-55222.27 1175,-55222.27 1175,-55290.27"/>
<text text-anchor="middle" x="1084.5" y="-55275.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1084.5" y="-55260.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1084.5" y="-55245.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1084.5" y="-55230.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_gate_ar&#45;&gt;layer51_silu_4 -->
<g id="edge1670" class="edge">
<title>layer51_gate_ar&#45;&gt;layer51_silu_4</title>
<path fill="none" stroke="black" d="M1147.26,-55380.28C1147.26,-55380.28 1147.26,-55300.29 1147.26,-55300.29"/>
<polygon fill="black" stroke="black" points="1150.76,-55300.29 1147.26,-55290.29 1143.76,-55300.29 1150.76,-55300.29"/>
</g>
<!-- layer51_silu_5 -->
<g id="node1310" class="node">
<title>layer51_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1392,-55290.27 1211,-55290.27 1211,-55222.27 1392,-55222.27 1392,-55290.27"/>
<text text-anchor="middle" x="1301.5" y="-55275.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1301.5" y="-55260.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1301.5" y="-55245.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1301.5" y="-55230.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_gate_ar&#45;&gt;layer51_silu_5 -->
<g id="edge1671" class="edge">
<title>layer51_gate_ar&#45;&gt;layer51_silu_5</title>
<path fill="none" stroke="black" d="M1293.24,-55365.37C1293.24,-55365.37 1293.24,-55300.28 1293.24,-55300.28"/>
<polygon fill="black" stroke="black" points="1296.74,-55300.28 1293.24,-55290.28 1289.74,-55300.28 1296.74,-55300.28"/>
</g>
<!-- layer51_mul_4 -->
<g id="node1311" class="node">
<title>layer51_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1065,-55150.27 884,-55150.27 884,-55082.27 1065,-55082.27 1065,-55150.27"/>
<text text-anchor="middle" x="974.5" y="-55135.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="974.5" y="-55120.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="974.5" y="-55105.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="974.5" y="-55090.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_up_ar&#45;&gt;layer51_mul_4 -->
<g id="edge1673" class="edge">
<title>layer51_up_ar&#45;&gt;layer51_mul_4</title>
<path fill="none" stroke="black" d="M939,-55364.08C939,-55364.08 939,-55160.35 939,-55160.35"/>
<polygon fill="black" stroke="black" points="942.5,-55160.35 939,-55150.35 935.5,-55160.35 942.5,-55160.35"/>
</g>
<!-- layer51_mul_5 -->
<g id="node1312" class="node">
<title>layer51_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1282,-55150.27 1101,-55150.27 1101,-55082.27 1282,-55082.27 1282,-55150.27"/>
<text text-anchor="middle" x="1191.5" y="-55135.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1191.5" y="-55120.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1191.5" y="-55105.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1191.5" y="-55090.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer51_up_ar&#45;&gt;layer51_mul_5 -->
<g id="edge1675" class="edge">
<title>layer51_up_ar&#45;&gt;layer51_mul_5</title>
<path fill="none" stroke="black" d="M1011.74,-55385.5C1011.74,-55360.62 1011.74,-55326 1011.74,-55326 1011.74,-55326 1193,-55326 1193,-55326 1193,-55326 1193,-55160.43 1193,-55160.43"/>
<polygon fill="black" stroke="black" points="1196.5,-55160.43 1193,-55150.43 1189.5,-55160.43 1196.5,-55160.43"/>
</g>
<!-- layer51_silu_4&#45;&gt;layer51_mul_4 -->
<g id="edge1672" class="edge">
<title>layer51_silu_4&#45;&gt;layer51_mul_4</title>
<path fill="none" stroke="black" d="M1029.5,-55222.02C1029.5,-55222.02 1029.5,-55160.65 1029.5,-55160.65"/>
<polygon fill="black" stroke="black" points="1033,-55160.65 1029.5,-55150.65 1026,-55160.65 1033,-55160.65"/>
</g>
<!-- layer51_silu_5&#45;&gt;layer51_mul_5 -->
<g id="edge1674" class="edge">
<title>layer51_silu_5&#45;&gt;layer51_mul_5</title>
<path fill="none" stroke="black" d="M1246.5,-55222.02C1246.5,-55222.02 1246.5,-55160.65 1246.5,-55160.65"/>
<polygon fill="black" stroke="black" points="1250,-55160.65 1246.5,-55150.65 1243,-55160.65 1250,-55160.65"/>
</g>
<!-- layer51_ffn_down_4 -->
<g id="node1313" class="node">
<title>layer51_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1064.5,-55010.27 892.5,-55010.27 892.5,-54942.27 1064.5,-54942.27 1064.5,-55010.27"/>
<text text-anchor="middle" x="978.5" y="-54995.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="978.5" y="-54980.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="978.5" y="-54965.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="978.5" y="-54950.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer51_mul_4&#45;&gt;layer51_ffn_down_4 -->
<g id="edge1676" class="edge">
<title>layer51_mul_4&#45;&gt;layer51_ffn_down_4</title>
<path fill="none" stroke="black" d="M978.5,-55082.02C978.5,-55082.02 978.5,-55020.65 978.5,-55020.65"/>
<polygon fill="black" stroke="black" points="982,-55020.65 978.5,-55010.65 975,-55020.65 982,-55020.65"/>
</g>
<!-- layer51_ffn_down_5 -->
<g id="node1314" class="node">
<title>layer51_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1274.5,-55010.27 1102.5,-55010.27 1102.5,-54942.27 1274.5,-54942.27 1274.5,-55010.27"/>
<text text-anchor="middle" x="1188.5" y="-54995.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1188.5" y="-54980.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1188.5" y="-54965.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1188.5" y="-54950.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer51_mul_5&#45;&gt;layer51_ffn_down_5 -->
<g id="edge1677" class="edge">
<title>layer51_mul_5&#45;&gt;layer51_ffn_down_5</title>
<path fill="none" stroke="black" d="M1188.5,-55082.02C1188.5,-55082.02 1188.5,-55020.65 1188.5,-55020.65"/>
<polygon fill="black" stroke="black" points="1192,-55020.65 1188.5,-55010.65 1185,-55020.65 1192,-55020.65"/>
</g>
<!-- layer51_ffn_ar -->
<g id="node1315" class="node">
<title>layer51_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1082.5" cy="-54822.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1082.5" y="-54840.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1082.5" y="-54825.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1082.5" y="-54810.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1082.5" y="-54795.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer51_ffn_down_4&#45;&gt;layer51_ffn_ar -->
<g id="edge1678" class="edge">
<title>layer51_ffn_down_4&#45;&gt;layer51_ffn_ar</title>
<path fill="none" stroke="black" d="M1012.69,-54942.07C1012.69,-54942.07 1012.69,-54871.73 1012.69,-54871.73"/>
<polygon fill="black" stroke="black" points="1016.19,-54871.73 1012.69,-54861.73 1009.19,-54871.73 1016.19,-54871.73"/>
</g>
<!-- layer51_ffn_down_5&#45;&gt;layer51_ffn_ar -->
<g id="edge1679" class="edge">
<title>layer51_ffn_down_5&#45;&gt;layer51_ffn_ar</title>
<path fill="none" stroke="black" d="M1153.31,-54942.07C1153.31,-54942.07 1153.31,-54871.45 1153.31,-54871.45"/>
<polygon fill="black" stroke="black" points="1156.81,-54871.45 1153.31,-54861.45 1149.81,-54871.45 1156.81,-54871.45"/>
</g>
<!-- layer52_norm_4 -->
<g id="node1316" class="node">
<title>layer52_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1064.5,-54702.1 892.5,-54702.1 892.5,-54634.1 1064.5,-54634.1 1064.5,-54702.1"/>
<text text-anchor="middle" x="978.5" y="-54686.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="978.5" y="-54671.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="978.5" y="-54656.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="978.5" y="-54641.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer51_ffn_ar&#45;&gt;layer52_norm_4 -->
<g id="edge1680" class="edge">
<title>layer51_ffn_ar&#45;&gt;layer52_norm_4</title>
<path fill="none" stroke="black" d="M1012.69,-54782.51C1012.69,-54782.51 1012.69,-54712.16 1012.69,-54712.16"/>
<polygon fill="black" stroke="black" points="1016.19,-54712.16 1012.69,-54702.16 1009.19,-54712.16 1016.19,-54712.16"/>
</g>
<!-- layer52_norm_5 -->
<g id="node1317" class="node">
<title>layer52_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1274.5,-54702.1 1102.5,-54702.1 1102.5,-54634.1 1274.5,-54634.1 1274.5,-54702.1"/>
<text text-anchor="middle" x="1188.5" y="-54686.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1188.5" y="-54671.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1188.5" y="-54656.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1188.5" y="-54641.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer51_ffn_ar&#45;&gt;layer52_norm_5 -->
<g id="edge1681" class="edge">
<title>layer51_ffn_ar&#45;&gt;layer52_norm_5</title>
<path fill="none" stroke="black" d="M1153.31,-54782.91C1153.31,-54782.91 1153.31,-54712.33 1153.31,-54712.33"/>
<polygon fill="black" stroke="black" points="1156.81,-54712.33 1153.31,-54702.33 1149.81,-54712.33 1156.81,-54712.33"/>
</g>
<!-- layer52_qkv_4 -->
<g id="node1318" class="node">
<title>layer52_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1065,-54562.1 884,-54562.1 884,-54494.1 1065,-54494.1 1065,-54562.1"/>
<text text-anchor="middle" x="974.5" y="-54546.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="974.5" y="-54531.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="974.5" y="-54516.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="974.5" y="-54501.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer52_norm_4&#45;&gt;layer52_qkv_4 -->
<g id="edge1682" class="edge">
<title>layer52_norm_4&#45;&gt;layer52_qkv_4</title>
<path fill="none" stroke="black" d="M978.5,-54633.86C978.5,-54633.86 978.5,-54572.48 978.5,-54572.48"/>
<polygon fill="black" stroke="black" points="982,-54572.48 978.5,-54562.48 975,-54572.48 982,-54572.48"/>
</g>
<!-- layer52_qkv_5 -->
<g id="node1319" class="node">
<title>layer52_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1282,-54562.1 1101,-54562.1 1101,-54494.1 1282,-54494.1 1282,-54562.1"/>
<text text-anchor="middle" x="1191.5" y="-54546.9" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1191.5" y="-54531.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1191.5" y="-54516.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1191.5" y="-54501.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer52_norm_5&#45;&gt;layer52_qkv_5 -->
<g id="edge1683" class="edge">
<title>layer52_norm_5&#45;&gt;layer52_qkv_5</title>
<path fill="none" stroke="black" d="M1188.5,-54633.86C1188.5,-54633.86 1188.5,-54572.48 1188.5,-54572.48"/>
<polygon fill="black" stroke="black" points="1192,-54572.48 1188.5,-54562.48 1185,-54572.48 1192,-54572.48"/>
</g>
<!-- layer52_qkv_ar -->
<g id="node1320" class="node">
<title>layer52_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1082.5" cy="-54374.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1082.5" y="-54392.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1082.5" y="-54377.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1082.5" y="-54362.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1082.5" y="-54347.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer52_qkv_4&#45;&gt;layer52_qkv_ar -->
<g id="edge1684" class="edge">
<title>layer52_qkv_4&#45;&gt;layer52_qkv_ar</title>
<path fill="none" stroke="black" d="M1009.76,-54493.91C1009.76,-54493.91 1009.76,-54423.84 1009.76,-54423.84"/>
<polygon fill="black" stroke="black" points="1013.26,-54423.84 1009.76,-54413.84 1006.26,-54423.84 1013.26,-54423.84"/>
</g>
<!-- layer52_qkv_5&#45;&gt;layer52_qkv_ar -->
<g id="edge1685" class="edge">
<title>layer52_qkv_5&#45;&gt;layer52_qkv_ar</title>
<path fill="none" stroke="black" d="M1155.74,-54493.91C1155.74,-54493.91 1155.74,-54423.56 1155.74,-54423.56"/>
<polygon fill="black" stroke="black" points="1159.24,-54423.56 1155.74,-54413.56 1152.24,-54423.56 1159.24,-54423.56"/>
</g>
<!-- layer52_attn_4 -->
<g id="node1321" class="node">
<title>layer52_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1064.5,-54253.94 892.5,-54253.94 892.5,-54185.94 1064.5,-54185.94 1064.5,-54253.94"/>
<text text-anchor="middle" x="978.5" y="-54238.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="978.5" y="-54223.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="978.5" y="-54208.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="978.5" y="-54193.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer52_qkv_ar&#45;&gt;layer52_attn_4 -->
<g id="edge1686" class="edge">
<title>layer52_qkv_ar&#45;&gt;layer52_attn_4</title>
<path fill="none" stroke="black" d="M1009.51,-54334.34C1009.51,-54334.34 1009.51,-54263.99 1009.51,-54263.99"/>
<polygon fill="black" stroke="black" points="1013.01,-54263.99 1009.51,-54253.99 1006.01,-54263.99 1013.01,-54263.99"/>
</g>
<!-- layer52_attn_5 -->
<g id="node1322" class="node">
<title>layer52_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1272.5,-54253.94 1100.5,-54253.94 1100.5,-54185.94 1272.5,-54185.94 1272.5,-54253.94"/>
<text text-anchor="middle" x="1186.5" y="-54238.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1186.5" y="-54223.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1186.5" y="-54208.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1186.5" y="-54193.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer52_qkv_ar&#45;&gt;layer52_attn_5 -->
<g id="edge1687" class="edge">
<title>layer52_qkv_ar&#45;&gt;layer52_attn_5</title>
<path fill="none" stroke="black" d="M1155.49,-54334.34C1155.49,-54334.34 1155.49,-54263.99 1155.49,-54263.99"/>
<polygon fill="black" stroke="black" points="1158.99,-54263.99 1155.49,-54253.99 1151.99,-54263.99 1158.99,-54263.99"/>
</g>
<!-- layer52_attn_out_4 -->
<g id="node1323" class="node">
<title>layer52_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1064.5,-54113.94 892.5,-54113.94 892.5,-54045.94 1064.5,-54045.94 1064.5,-54113.94"/>
<text text-anchor="middle" x="978.5" y="-54098.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="978.5" y="-54083.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="978.5" y="-54068.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="978.5" y="-54053.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer52_attn_4&#45;&gt;layer52_attn_out_4 -->
<g id="edge1688" class="edge">
<title>layer52_attn_4&#45;&gt;layer52_attn_out_4</title>
<path fill="none" stroke="black" d="M978.5,-54185.69C978.5,-54185.69 978.5,-54124.32 978.5,-54124.32"/>
<polygon fill="black" stroke="black" points="982,-54124.32 978.5,-54114.32 975,-54124.32 982,-54124.32"/>
</g>
<!-- layer52_attn_out_5 -->
<g id="node1324" class="node">
<title>layer52_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1272.5,-54113.94 1100.5,-54113.94 1100.5,-54045.94 1272.5,-54045.94 1272.5,-54113.94"/>
<text text-anchor="middle" x="1186.5" y="-54098.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1186.5" y="-54083.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1186.5" y="-54068.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1186.5" y="-54053.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer52_attn_5&#45;&gt;layer52_attn_out_5 -->
<g id="edge1689" class="edge">
<title>layer52_attn_5&#45;&gt;layer52_attn_out_5</title>
<path fill="none" stroke="black" d="M1186.5,-54185.69C1186.5,-54185.69 1186.5,-54124.32 1186.5,-54124.32"/>
<polygon fill="black" stroke="black" points="1190,-54124.32 1186.5,-54114.32 1183,-54124.32 1190,-54124.32"/>
</g>
<!-- layer52_attn_ar -->
<g id="node1325" class="node">
<title>layer52_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1082.5" cy="-53925.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1082.5" y="-53944.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1082.5" y="-53929.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1082.5" y="-53914.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1082.5" y="-53899.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer52_attn_out_4&#45;&gt;layer52_attn_ar -->
<g id="edge1690" class="edge">
<title>layer52_attn_out_4&#45;&gt;layer52_attn_ar</title>
<path fill="none" stroke="black" d="M1012.69,-54045.74C1012.69,-54045.74 1012.69,-53975.4 1012.69,-53975.4"/>
<polygon fill="black" stroke="black" points="1016.19,-53975.4 1012.69,-53965.4 1009.19,-53975.4 1016.19,-53975.4"/>
</g>
<!-- layer52_attn_out_5&#45;&gt;layer52_attn_ar -->
<g id="edge1691" class="edge">
<title>layer52_attn_out_5&#45;&gt;layer52_attn_ar</title>
<path fill="none" stroke="black" d="M1152.31,-54045.74C1152.31,-54045.74 1152.31,-53975.4 1152.31,-53975.4"/>
<polygon fill="black" stroke="black" points="1155.81,-53975.4 1152.31,-53965.4 1148.81,-53975.4 1155.81,-53975.4"/>
</g>
<!-- layer52_ffn_norm_4 -->
<g id="node1326" class="node">
<title>layer52_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1060.5,-53805.77 888.5,-53805.77 888.5,-53737.77 1060.5,-53737.77 1060.5,-53805.77"/>
<text text-anchor="middle" x="974.5" y="-53790.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="974.5" y="-53775.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="974.5" y="-53760.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="974.5" y="-53745.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer52_attn_ar&#45;&gt;layer52_ffn_norm_4 -->
<g id="edge1692" class="edge">
<title>layer52_attn_ar&#45;&gt;layer52_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1010.69,-53886.97C1010.69,-53886.97 1010.69,-53815.92 1010.69,-53815.92"/>
<polygon fill="black" stroke="black" points="1014.19,-53815.92 1010.69,-53805.92 1007.19,-53815.92 1014.19,-53815.92"/>
</g>
<!-- layer52_ffn_norm_5 -->
<g id="node1327" class="node">
<title>layer52_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1277.5,-53805.77 1105.5,-53805.77 1105.5,-53737.77 1277.5,-53737.77 1277.5,-53805.77"/>
<text text-anchor="middle" x="1191.5" y="-53790.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1191.5" y="-53775.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1191.5" y="-53760.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1191.5" y="-53745.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer52_attn_ar&#45;&gt;layer52_ffn_norm_5 -->
<g id="edge1693" class="edge">
<title>layer52_attn_ar&#45;&gt;layer52_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1154.81,-53886.97C1154.81,-53886.97 1154.81,-53815.92 1154.81,-53815.92"/>
<polygon fill="black" stroke="black" points="1158.31,-53815.92 1154.81,-53805.92 1151.31,-53815.92 1158.31,-53815.92"/>
</g>
<!-- layer52_ffn_gate_4 -->
<g id="node1328" class="node">
<title>layer52_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1065,-53665.77 884,-53665.77 884,-53597.77 1065,-53597.77 1065,-53665.77"/>
<text text-anchor="middle" x="974.5" y="-53650.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="974.5" y="-53635.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="974.5" y="-53620.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="974.5" y="-53605.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_ffn_norm_4&#45;&gt;layer52_ffn_gate_4 -->
<g id="edge1694" class="edge">
<title>layer52_ffn_norm_4&#45;&gt;layer52_ffn_gate_4</title>
<path fill="none" stroke="black" d="M974.5,-53737.52C974.5,-53737.52 974.5,-53676.15 974.5,-53676.15"/>
<polygon fill="black" stroke="black" points="978,-53676.15 974.5,-53666.15 971,-53676.15 978,-53676.15"/>
</g>
<!-- layer52_ffn_up_4 -->
<g id="node1330" class="node">
<title>layer52_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="848,-53665.77 667,-53665.77 667,-53597.77 848,-53597.77 848,-53665.77"/>
<text text-anchor="middle" x="757.5" y="-53650.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="757.5" y="-53635.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="757.5" y="-53620.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="757.5" y="-53605.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_ffn_norm_4&#45;&gt;layer52_ffn_up_4 -->
<g id="edge1696" class="edge">
<title>layer52_ffn_norm_4&#45;&gt;layer52_ffn_up_4</title>
<path fill="none" stroke="black" d="M888.31,-53771C848.86,-53771 810.76,-53771 810.76,-53771 810.76,-53771 810.76,-53675.83 810.76,-53675.83"/>
<polygon fill="black" stroke="black" points="814.26,-53675.83 810.76,-53665.83 807.26,-53675.83 814.26,-53675.83"/>
</g>
<!-- layer52_ffn_gate_5 -->
<g id="node1329" class="node">
<title>layer52_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1499,-53665.77 1318,-53665.77 1318,-53597.77 1499,-53597.77 1499,-53665.77"/>
<text text-anchor="middle" x="1408.5" y="-53650.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1408.5" y="-53635.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1408.5" y="-53620.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1408.5" y="-53605.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_ffn_norm_5&#45;&gt;layer52_ffn_gate_5 -->
<g id="edge1695" class="edge">
<title>layer52_ffn_norm_5&#45;&gt;layer52_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1277.56,-53771C1316.95,-53771 1355,-53771 1355,-53771 1355,-53771 1355,-53675.83 1355,-53675.83"/>
<polygon fill="black" stroke="black" points="1358.5,-53675.83 1355,-53665.83 1351.5,-53675.83 1358.5,-53675.83"/>
</g>
<!-- layer52_ffn_up_5 -->
<g id="node1331" class="node">
<title>layer52_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1282,-53665.77 1101,-53665.77 1101,-53597.77 1282,-53597.77 1282,-53665.77"/>
<text text-anchor="middle" x="1191.5" y="-53650.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1191.5" y="-53635.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1191.5" y="-53620.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1191.5" y="-53605.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_ffn_norm_5&#45;&gt;layer52_ffn_up_5 -->
<g id="edge1697" class="edge">
<title>layer52_ffn_norm_5&#45;&gt;layer52_ffn_up_5</title>
<path fill="none" stroke="black" d="M1191.5,-53737.52C1191.5,-53737.52 1191.5,-53676.15 1191.5,-53676.15"/>
<polygon fill="black" stroke="black" points="1195,-53676.15 1191.5,-53666.15 1188,-53676.15 1195,-53676.15"/>
</g>
<!-- layer52_gate_ar -->
<g id="node1332" class="node">
<title>layer52_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1282.5" cy="-53477.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1282.5" y="-53496.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1282.5" y="-53481.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1282.5" y="-53466.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1282.5" y="-53451.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer52_ffn_gate_4&#45;&gt;layer52_gate_ar -->
<g id="edge1698" class="edge">
<title>layer52_ffn_gate_4&#45;&gt;layer52_gate_ar</title>
<path fill="none" stroke="black" d="M1065.08,-53631C1075.79,-53631 1083,-53631 1083,-53631 1083,-53631 1083,-53493 1083,-53493 1083,-53493 1150.99,-53493 1150.99,-53493"/>
<polygon fill="black" stroke="black" points="1150.99,-53496.5 1160.99,-53493 1150.99,-53489.5 1150.99,-53496.5"/>
</g>
<!-- layer52_ffn_gate_5&#45;&gt;layer52_gate_ar -->
<g id="edge1699" class="edge">
<title>layer52_ffn_gate_5&#45;&gt;layer52_gate_ar</title>
<path fill="none" stroke="black" d="M1364.24,-53597.57C1364.24,-53597.57 1364.24,-53524.75 1364.24,-53524.75"/>
<polygon fill="black" stroke="black" points="1367.74,-53524.75 1364.24,-53514.75 1360.74,-53524.75 1367.74,-53524.75"/>
</g>
<!-- layer52_up_ar -->
<g id="node1333" class="node">
<title>layer52_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="936.5" cy="-53477.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="936.5" y="-53496.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="936.5" y="-53481.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="936.5" y="-53466.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="936.5" y="-53451.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer52_ffn_up_4&#45;&gt;layer52_up_ar -->
<g id="edge1700" class="edge">
<title>layer52_ffn_up_4&#45;&gt;layer52_up_ar</title>
<path fill="none" stroke="black" d="M828.26,-53597.57C828.26,-53597.57 828.26,-53513.65 828.26,-53513.65"/>
<polygon fill="black" stroke="black" points="831.76,-53513.65 828.26,-53503.65 824.76,-53513.65 831.76,-53513.65"/>
</g>
<!-- layer52_ffn_up_5&#45;&gt;layer52_up_ar -->
<g id="edge1701" class="edge">
<title>layer52_ffn_up_5&#45;&gt;layer52_up_ar</title>
<path fill="none" stroke="black" d="M1127.76,-53597.62C1127.76,-53547.79 1127.76,-53461 1127.76,-53461 1127.76,-53461 1066.54,-53461 1066.54,-53461"/>
<polygon fill="black" stroke="black" points="1066.54,-53457.5 1056.54,-53461 1066.54,-53464.5 1066.54,-53457.5"/>
</g>
<!-- layer52_silu_4 -->
<g id="node1334" class="node">
<title>layer52_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1210,-53357.6 1029,-53357.6 1029,-53289.6 1210,-53289.6 1210,-53357.6"/>
<text text-anchor="middle" x="1119.5" y="-53342.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1119.5" y="-53327.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1119.5" y="-53312.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1119.5" y="-53297.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_gate_ar&#45;&gt;layer52_silu_4 -->
<g id="edge1702" class="edge">
<title>layer52_gate_ar&#45;&gt;layer52_silu_4</title>
<path fill="none" stroke="black" d="M1182.26,-53447.61C1182.26,-53447.61 1182.26,-53367.63 1182.26,-53367.63"/>
<polygon fill="black" stroke="black" points="1185.76,-53367.63 1182.26,-53357.63 1178.76,-53367.63 1185.76,-53367.63"/>
</g>
<!-- layer52_silu_5 -->
<g id="node1335" class="node">
<title>layer52_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1427,-53357.6 1246,-53357.6 1246,-53289.6 1427,-53289.6 1427,-53357.6"/>
<text text-anchor="middle" x="1336.5" y="-53342.4" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1336.5" y="-53327.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1336.5" y="-53312.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1336.5" y="-53297.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_gate_ar&#45;&gt;layer52_silu_5 -->
<g id="edge1703" class="edge">
<title>layer52_gate_ar&#45;&gt;layer52_silu_5</title>
<path fill="none" stroke="black" d="M1328.24,-53432.71C1328.24,-53432.71 1328.24,-53367.61 1328.24,-53367.61"/>
<polygon fill="black" stroke="black" points="1331.74,-53367.61 1328.24,-53357.61 1324.74,-53367.61 1331.74,-53367.61"/>
</g>
<!-- layer52_mul_4 -->
<g id="node1336" class="node">
<title>layer52_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1100,-53217.6 919,-53217.6 919,-53149.6 1100,-53149.6 1100,-53217.6"/>
<text text-anchor="middle" x="1009.5" y="-53202.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1009.5" y="-53187.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1009.5" y="-53172.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1009.5" y="-53157.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_up_ar&#45;&gt;layer52_mul_4 -->
<g id="edge1705" class="edge">
<title>layer52_up_ar&#45;&gt;layer52_mul_4</title>
<path fill="none" stroke="black" d="M974,-53431.41C974,-53431.41 974,-53227.69 974,-53227.69"/>
<polygon fill="black" stroke="black" points="977.5,-53227.69 974,-53217.69 970.5,-53227.69 977.5,-53227.69"/>
</g>
<!-- layer52_mul_5 -->
<g id="node1337" class="node">
<title>layer52_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1317,-53217.6 1136,-53217.6 1136,-53149.6 1317,-53149.6 1317,-53217.6"/>
<text text-anchor="middle" x="1226.5" y="-53202.4" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1226.5" y="-53187.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1226.5" y="-53172.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1226.5" y="-53157.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer52_up_ar&#45;&gt;layer52_mul_5 -->
<g id="edge1707" class="edge">
<title>layer52_up_ar&#45;&gt;layer52_mul_5</title>
<path fill="none" stroke="black" d="M1046.74,-53453.19C1046.74,-53428.18 1046.74,-53393 1046.74,-53393 1046.74,-53393 1228,-53393 1228,-53393 1228,-53393 1228,-53227.71 1228,-53227.71"/>
<polygon fill="black" stroke="black" points="1231.5,-53227.71 1228,-53217.71 1224.5,-53227.71 1231.5,-53227.71"/>
</g>
<!-- layer52_silu_4&#45;&gt;layer52_mul_4 -->
<g id="edge1704" class="edge">
<title>layer52_silu_4&#45;&gt;layer52_mul_4</title>
<path fill="none" stroke="black" d="M1064.5,-53289.36C1064.5,-53289.36 1064.5,-53227.98 1064.5,-53227.98"/>
<polygon fill="black" stroke="black" points="1068,-53227.98 1064.5,-53217.98 1061,-53227.98 1068,-53227.98"/>
</g>
<!-- layer52_silu_5&#45;&gt;layer52_mul_5 -->
<g id="edge1706" class="edge">
<title>layer52_silu_5&#45;&gt;layer52_mul_5</title>
<path fill="none" stroke="black" d="M1281.5,-53289.36C1281.5,-53289.36 1281.5,-53227.98 1281.5,-53227.98"/>
<polygon fill="black" stroke="black" points="1285,-53227.98 1281.5,-53217.98 1278,-53227.98 1285,-53227.98"/>
</g>
<!-- layer52_ffn_down_4 -->
<g id="node1338" class="node">
<title>layer52_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1099.5,-53077.6 927.5,-53077.6 927.5,-53009.6 1099.5,-53009.6 1099.5,-53077.6"/>
<text text-anchor="middle" x="1013.5" y="-53062.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1013.5" y="-53047.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1013.5" y="-53032.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1013.5" y="-53017.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer52_mul_4&#45;&gt;layer52_ffn_down_4 -->
<g id="edge1708" class="edge">
<title>layer52_mul_4&#45;&gt;layer52_ffn_down_4</title>
<path fill="none" stroke="black" d="M1013.5,-53149.36C1013.5,-53149.36 1013.5,-53087.98 1013.5,-53087.98"/>
<polygon fill="black" stroke="black" points="1017,-53087.98 1013.5,-53077.98 1010,-53087.98 1017,-53087.98"/>
</g>
<!-- layer52_ffn_down_5 -->
<g id="node1339" class="node">
<title>layer52_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1309.5,-53077.6 1137.5,-53077.6 1137.5,-53009.6 1309.5,-53009.6 1309.5,-53077.6"/>
<text text-anchor="middle" x="1223.5" y="-53062.4" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1223.5" y="-53047.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1223.5" y="-53032.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1223.5" y="-53017.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer52_mul_5&#45;&gt;layer52_ffn_down_5 -->
<g id="edge1709" class="edge">
<title>layer52_mul_5&#45;&gt;layer52_ffn_down_5</title>
<path fill="none" stroke="black" d="M1223.5,-53149.36C1223.5,-53149.36 1223.5,-53087.98 1223.5,-53087.98"/>
<polygon fill="black" stroke="black" points="1227,-53087.98 1223.5,-53077.98 1220,-53087.98 1227,-53087.98"/>
</g>
<!-- layer52_ffn_ar -->
<g id="node1340" class="node">
<title>layer52_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1117.5" cy="-52889.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1117.5" y="-52908.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1117.5" y="-52893.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1117.5" y="-52878.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1117.5" y="-52863.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer52_ffn_down_4&#45;&gt;layer52_ffn_ar -->
<g id="edge1710" class="edge">
<title>layer52_ffn_down_4&#45;&gt;layer52_ffn_ar</title>
<path fill="none" stroke="black" d="M1047.69,-53009.41C1047.69,-53009.41 1047.69,-52939.06 1047.69,-52939.06"/>
<polygon fill="black" stroke="black" points="1051.19,-52939.06 1047.69,-52929.06 1044.19,-52939.06 1051.19,-52939.06"/>
</g>
<!-- layer52_ffn_down_5&#45;&gt;layer52_ffn_ar -->
<g id="edge1711" class="edge">
<title>layer52_ffn_down_5&#45;&gt;layer52_ffn_ar</title>
<path fill="none" stroke="black" d="M1188.31,-53009.41C1188.31,-53009.41 1188.31,-52938.79 1188.31,-52938.79"/>
<polygon fill="black" stroke="black" points="1191.81,-52938.79 1188.31,-52928.79 1184.81,-52938.79 1191.81,-52938.79"/>
</g>
<!-- layer53_norm_4 -->
<g id="node1341" class="node">
<title>layer53_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1099.5,-52769.44 927.5,-52769.44 927.5,-52701.44 1099.5,-52701.44 1099.5,-52769.44"/>
<text text-anchor="middle" x="1013.5" y="-52754.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1013.5" y="-52739.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1013.5" y="-52724.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1013.5" y="-52709.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer52_ffn_ar&#45;&gt;layer53_norm_4 -->
<g id="edge1712" class="edge">
<title>layer52_ffn_ar&#45;&gt;layer53_norm_4</title>
<path fill="none" stroke="black" d="M1047.69,-52849.84C1047.69,-52849.84 1047.69,-52779.49 1047.69,-52779.49"/>
<polygon fill="black" stroke="black" points="1051.19,-52779.49 1047.69,-52769.49 1044.19,-52779.49 1051.19,-52779.49"/>
</g>
<!-- layer53_norm_5 -->
<g id="node1342" class="node">
<title>layer53_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1309.5,-52769.44 1137.5,-52769.44 1137.5,-52701.44 1309.5,-52701.44 1309.5,-52769.44"/>
<text text-anchor="middle" x="1223.5" y="-52754.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1223.5" y="-52739.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1223.5" y="-52724.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1223.5" y="-52709.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer52_ffn_ar&#45;&gt;layer53_norm_5 -->
<g id="edge1713" class="edge">
<title>layer52_ffn_ar&#45;&gt;layer53_norm_5</title>
<path fill="none" stroke="black" d="M1188.31,-52850.24C1188.31,-52850.24 1188.31,-52779.67 1188.31,-52779.67"/>
<polygon fill="black" stroke="black" points="1191.81,-52779.67 1188.31,-52769.67 1184.81,-52779.67 1191.81,-52779.67"/>
</g>
<!-- layer53_qkv_4 -->
<g id="node1343" class="node">
<title>layer53_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1100,-52629.44 919,-52629.44 919,-52561.44 1100,-52561.44 1100,-52629.44"/>
<text text-anchor="middle" x="1009.5" y="-52614.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1009.5" y="-52599.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1009.5" y="-52584.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1009.5" y="-52569.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer53_norm_4&#45;&gt;layer53_qkv_4 -->
<g id="edge1714" class="edge">
<title>layer53_norm_4&#45;&gt;layer53_qkv_4</title>
<path fill="none" stroke="black" d="M1013.5,-52701.19C1013.5,-52701.19 1013.5,-52639.82 1013.5,-52639.82"/>
<polygon fill="black" stroke="black" points="1017,-52639.82 1013.5,-52629.82 1010,-52639.82 1017,-52639.82"/>
</g>
<!-- layer53_qkv_5 -->
<g id="node1344" class="node">
<title>layer53_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1317,-52629.44 1136,-52629.44 1136,-52561.44 1317,-52561.44 1317,-52629.44"/>
<text text-anchor="middle" x="1226.5" y="-52614.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1226.5" y="-52599.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1226.5" y="-52584.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1226.5" y="-52569.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer53_norm_5&#45;&gt;layer53_qkv_5 -->
<g id="edge1715" class="edge">
<title>layer53_norm_5&#45;&gt;layer53_qkv_5</title>
<path fill="none" stroke="black" d="M1223.5,-52701.19C1223.5,-52701.19 1223.5,-52639.82 1223.5,-52639.82"/>
<polygon fill="black" stroke="black" points="1227,-52639.82 1223.5,-52629.82 1220,-52639.82 1227,-52639.82"/>
</g>
<!-- layer53_qkv_ar -->
<g id="node1345" class="node">
<title>layer53_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1117.5" cy="-52441.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1117.5" y="-52460.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1117.5" y="-52445.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1117.5" y="-52430.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1117.5" y="-52415.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer53_qkv_4&#45;&gt;layer53_qkv_ar -->
<g id="edge1716" class="edge">
<title>layer53_qkv_4&#45;&gt;layer53_qkv_ar</title>
<path fill="none" stroke="black" d="M1044.76,-52561.24C1044.76,-52561.24 1044.76,-52491.18 1044.76,-52491.18"/>
<polygon fill="black" stroke="black" points="1048.26,-52491.18 1044.76,-52481.18 1041.26,-52491.18 1048.26,-52491.18"/>
</g>
<!-- layer53_qkv_5&#45;&gt;layer53_qkv_ar -->
<g id="edge1717" class="edge">
<title>layer53_qkv_5&#45;&gt;layer53_qkv_ar</title>
<path fill="none" stroke="black" d="M1190.74,-52561.24C1190.74,-52561.24 1190.74,-52490.9 1190.74,-52490.9"/>
<polygon fill="black" stroke="black" points="1194.24,-52490.9 1190.74,-52480.9 1187.24,-52490.9 1194.24,-52490.9"/>
</g>
<!-- layer53_attn_4 -->
<g id="node1346" class="node">
<title>layer53_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1099.5,-52321.27 927.5,-52321.27 927.5,-52253.27 1099.5,-52253.27 1099.5,-52321.27"/>
<text text-anchor="middle" x="1013.5" y="-52306.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1013.5" y="-52291.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1013.5" y="-52276.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1013.5" y="-52261.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer53_qkv_ar&#45;&gt;layer53_attn_4 -->
<g id="edge1718" class="edge">
<title>layer53_qkv_ar&#45;&gt;layer53_attn_4</title>
<path fill="none" stroke="black" d="M1044.51,-52401.67C1044.51,-52401.67 1044.51,-52331.33 1044.51,-52331.33"/>
<polygon fill="black" stroke="black" points="1048.01,-52331.33 1044.51,-52321.33 1041.01,-52331.33 1048.01,-52331.33"/>
</g>
<!-- layer53_attn_5 -->
<g id="node1347" class="node">
<title>layer53_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1307.5,-52321.27 1135.5,-52321.27 1135.5,-52253.27 1307.5,-52253.27 1307.5,-52321.27"/>
<text text-anchor="middle" x="1221.5" y="-52306.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1221.5" y="-52291.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1221.5" y="-52276.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1221.5" y="-52261.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer53_qkv_ar&#45;&gt;layer53_attn_5 -->
<g id="edge1719" class="edge">
<title>layer53_qkv_ar&#45;&gt;layer53_attn_5</title>
<path fill="none" stroke="black" d="M1190.49,-52401.67C1190.49,-52401.67 1190.49,-52331.33 1190.49,-52331.33"/>
<polygon fill="black" stroke="black" points="1193.99,-52331.33 1190.49,-52321.33 1186.99,-52331.33 1193.99,-52331.33"/>
</g>
<!-- layer53_attn_out_4 -->
<g id="node1348" class="node">
<title>layer53_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1099.5,-52181.27 927.5,-52181.27 927.5,-52113.27 1099.5,-52113.27 1099.5,-52181.27"/>
<text text-anchor="middle" x="1013.5" y="-52166.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1013.5" y="-52151.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1013.5" y="-52136.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1013.5" y="-52121.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer53_attn_4&#45;&gt;layer53_attn_out_4 -->
<g id="edge1720" class="edge">
<title>layer53_attn_4&#45;&gt;layer53_attn_out_4</title>
<path fill="none" stroke="black" d="M1013.5,-52253.02C1013.5,-52253.02 1013.5,-52191.65 1013.5,-52191.65"/>
<polygon fill="black" stroke="black" points="1017,-52191.65 1013.5,-52181.65 1010,-52191.65 1017,-52191.65"/>
</g>
<!-- layer53_attn_out_5 -->
<g id="node1349" class="node">
<title>layer53_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1307.5,-52181.27 1135.5,-52181.27 1135.5,-52113.27 1307.5,-52113.27 1307.5,-52181.27"/>
<text text-anchor="middle" x="1221.5" y="-52166.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1221.5" y="-52151.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1221.5" y="-52136.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1221.5" y="-52121.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer53_attn_5&#45;&gt;layer53_attn_out_5 -->
<g id="edge1721" class="edge">
<title>layer53_attn_5&#45;&gt;layer53_attn_out_5</title>
<path fill="none" stroke="black" d="M1221.5,-52253.02C1221.5,-52253.02 1221.5,-52191.65 1221.5,-52191.65"/>
<polygon fill="black" stroke="black" points="1225,-52191.65 1221.5,-52181.65 1218,-52191.65 1225,-52191.65"/>
</g>
<!-- layer53_attn_ar -->
<g id="node1350" class="node">
<title>layer53_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1117.5" cy="-51993.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1117.5" y="-52011.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1117.5" y="-51996.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1117.5" y="-51981.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1117.5" y="-51966.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer53_attn_out_4&#45;&gt;layer53_attn_ar -->
<g id="edge1722" class="edge">
<title>layer53_attn_out_4&#45;&gt;layer53_attn_ar</title>
<path fill="none" stroke="black" d="M1047.69,-52113.07C1047.69,-52113.07 1047.69,-52042.73 1047.69,-52042.73"/>
<polygon fill="black" stroke="black" points="1051.19,-52042.73 1047.69,-52032.73 1044.19,-52042.73 1051.19,-52042.73"/>
</g>
<!-- layer53_attn_out_5&#45;&gt;layer53_attn_ar -->
<g id="edge1723" class="edge">
<title>layer53_attn_out_5&#45;&gt;layer53_attn_ar</title>
<path fill="none" stroke="black" d="M1187.31,-52113.07C1187.31,-52113.07 1187.31,-52042.73 1187.31,-52042.73"/>
<polygon fill="black" stroke="black" points="1190.81,-52042.73 1187.31,-52032.73 1183.81,-52042.73 1190.81,-52042.73"/>
</g>
<!-- layer53_ffn_norm_4 -->
<g id="node1351" class="node">
<title>layer53_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1095.5,-51873.1 923.5,-51873.1 923.5,-51805.1 1095.5,-51805.1 1095.5,-51873.1"/>
<text text-anchor="middle" x="1009.5" y="-51857.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1009.5" y="-51842.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1009.5" y="-51827.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1009.5" y="-51812.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer53_attn_ar&#45;&gt;layer53_ffn_norm_4 -->
<g id="edge1724" class="edge">
<title>layer53_attn_ar&#45;&gt;layer53_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1045.69,-51954.31C1045.69,-51954.31 1045.69,-51883.25 1045.69,-51883.25"/>
<polygon fill="black" stroke="black" points="1049.19,-51883.25 1045.69,-51873.25 1042.19,-51883.25 1049.19,-51883.25"/>
</g>
<!-- layer53_ffn_norm_5 -->
<g id="node1352" class="node">
<title>layer53_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1312.5,-51873.1 1140.5,-51873.1 1140.5,-51805.1 1312.5,-51805.1 1312.5,-51873.1"/>
<text text-anchor="middle" x="1226.5" y="-51857.9" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1226.5" y="-51842.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1226.5" y="-51827.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1226.5" y="-51812.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer53_attn_ar&#45;&gt;layer53_ffn_norm_5 -->
<g id="edge1725" class="edge">
<title>layer53_attn_ar&#45;&gt;layer53_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1189.81,-51954.31C1189.81,-51954.31 1189.81,-51883.25 1189.81,-51883.25"/>
<polygon fill="black" stroke="black" points="1193.31,-51883.25 1189.81,-51873.25 1186.31,-51883.25 1193.31,-51883.25"/>
</g>
<!-- layer53_ffn_gate_4 -->
<g id="node1353" class="node">
<title>layer53_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1100,-51733.1 919,-51733.1 919,-51665.1 1100,-51665.1 1100,-51733.1"/>
<text text-anchor="middle" x="1009.5" y="-51717.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1009.5" y="-51702.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1009.5" y="-51687.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1009.5" y="-51672.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_ffn_norm_4&#45;&gt;layer53_ffn_gate_4 -->
<g id="edge1726" class="edge">
<title>layer53_ffn_norm_4&#45;&gt;layer53_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1009.5,-51804.86C1009.5,-51804.86 1009.5,-51743.48 1009.5,-51743.48"/>
<polygon fill="black" stroke="black" points="1013,-51743.48 1009.5,-51733.48 1006,-51743.48 1013,-51743.48"/>
</g>
<!-- layer53_ffn_up_4 -->
<g id="node1355" class="node">
<title>layer53_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="883,-51733.1 702,-51733.1 702,-51665.1 883,-51665.1 883,-51733.1"/>
<text text-anchor="middle" x="792.5" y="-51717.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="792.5" y="-51702.9" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="792.5" y="-51687.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="792.5" y="-51672.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_ffn_norm_4&#45;&gt;layer53_ffn_up_4 -->
<g id="edge1728" class="edge">
<title>layer53_ffn_norm_4&#45;&gt;layer53_ffn_up_4</title>
<path fill="none" stroke="black" d="M923.31,-51839C883.86,-51839 845.76,-51839 845.76,-51839 845.76,-51839 845.76,-51743.33 845.76,-51743.33"/>
<polygon fill="black" stroke="black" points="849.26,-51743.33 845.76,-51733.33 842.26,-51743.33 849.26,-51743.33"/>
</g>
<!-- layer53_ffn_gate_5 -->
<g id="node1354" class="node">
<title>layer53_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1534,-51733.1 1353,-51733.1 1353,-51665.1 1534,-51665.1 1534,-51733.1"/>
<text text-anchor="middle" x="1443.5" y="-51717.9" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1443.5" y="-51702.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1443.5" y="-51687.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1443.5" y="-51672.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_ffn_norm_5&#45;&gt;layer53_ffn_gate_5 -->
<g id="edge1727" class="edge">
<title>layer53_ffn_norm_5&#45;&gt;layer53_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1312.56,-51839C1351.95,-51839 1390,-51839 1390,-51839 1390,-51839 1390,-51743.33 1390,-51743.33"/>
<polygon fill="black" stroke="black" points="1393.5,-51743.33 1390,-51733.33 1386.5,-51743.33 1393.5,-51743.33"/>
</g>
<!-- layer53_ffn_up_5 -->
<g id="node1356" class="node">
<title>layer53_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1317,-51733.1 1136,-51733.1 1136,-51665.1 1317,-51665.1 1317,-51733.1"/>
<text text-anchor="middle" x="1226.5" y="-51717.9" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1226.5" y="-51702.9" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1226.5" y="-51687.9" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1226.5" y="-51672.9" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_ffn_norm_5&#45;&gt;layer53_ffn_up_5 -->
<g id="edge1729" class="edge">
<title>layer53_ffn_norm_5&#45;&gt;layer53_ffn_up_5</title>
<path fill="none" stroke="black" d="M1226.5,-51804.86C1226.5,-51804.86 1226.5,-51743.48 1226.5,-51743.48"/>
<polygon fill="black" stroke="black" points="1230,-51743.48 1226.5,-51733.48 1223,-51743.48 1230,-51743.48"/>
</g>
<!-- layer53_gate_ar -->
<g id="node1357" class="node">
<title>layer53_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1317.5" cy="-51545.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1317.5" y="-51563.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1317.5" y="-51548.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1317.5" y="-51533.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1317.5" y="-51518.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer53_ffn_gate_4&#45;&gt;layer53_gate_ar -->
<g id="edge1730" class="edge">
<title>layer53_ffn_gate_4&#45;&gt;layer53_gate_ar</title>
<path fill="none" stroke="black" d="M1100.08,-51699C1110.79,-51699 1118,-51699 1118,-51699 1118,-51699 1118,-51561 1118,-51561 1118,-51561 1186.56,-51561 1186.56,-51561"/>
<polygon fill="black" stroke="black" points="1186.56,-51564.5 1196.56,-51561 1186.56,-51557.5 1186.56,-51564.5"/>
</g>
<!-- layer53_ffn_gate_5&#45;&gt;layer53_gate_ar -->
<g id="edge1731" class="edge">
<title>layer53_ffn_gate_5&#45;&gt;layer53_gate_ar</title>
<path fill="none" stroke="black" d="M1399.24,-51664.91C1399.24,-51664.91 1399.24,-51592.08 1399.24,-51592.08"/>
<polygon fill="black" stroke="black" points="1402.74,-51592.08 1399.24,-51582.08 1395.74,-51592.08 1402.74,-51592.08"/>
</g>
<!-- layer53_up_ar -->
<g id="node1358" class="node">
<title>layer53_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="971.5" cy="-51545.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="971.5" y="-51563.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="971.5" y="-51548.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="971.5" y="-51533.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="971.5" y="-51518.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer53_ffn_up_4&#45;&gt;layer53_up_ar -->
<g id="edge1732" class="edge">
<title>layer53_ffn_up_4&#45;&gt;layer53_up_ar</title>
<path fill="none" stroke="black" d="M863.26,-51664.91C863.26,-51664.91 863.26,-51580.98 863.26,-51580.98"/>
<polygon fill="black" stroke="black" points="866.76,-51580.98 863.26,-51570.98 859.76,-51580.98 866.76,-51580.98"/>
</g>
<!-- layer53_ffn_up_5&#45;&gt;layer53_up_ar -->
<g id="edge1733" class="edge">
<title>layer53_ffn_up_5&#45;&gt;layer53_up_ar</title>
<path fill="none" stroke="black" d="M1162.76,-51664.89C1162.76,-51614.96 1162.76,-51528 1162.76,-51528 1162.76,-51528 1101.27,-51528 1101.27,-51528"/>
<polygon fill="black" stroke="black" points="1101.27,-51524.5 1091.27,-51528 1101.27,-51531.5 1101.27,-51524.5"/>
</g>
<!-- layer53_silu_4 -->
<g id="node1359" class="node">
<title>layer53_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1245,-51424.94 1064,-51424.94 1064,-51356.94 1245,-51356.94 1245,-51424.94"/>
<text text-anchor="middle" x="1154.5" y="-51409.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1154.5" y="-51394.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1154.5" y="-51379.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1154.5" y="-51364.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_gate_ar&#45;&gt;layer53_silu_4 -->
<g id="edge1734" class="edge">
<title>layer53_gate_ar&#45;&gt;layer53_silu_4</title>
<path fill="none" stroke="black" d="M1217.26,-51514.95C1217.26,-51514.95 1217.26,-51434.96 1217.26,-51434.96"/>
<polygon fill="black" stroke="black" points="1220.76,-51434.96 1217.26,-51424.96 1213.76,-51434.96 1220.76,-51434.96"/>
</g>
<!-- layer53_silu_5 -->
<g id="node1360" class="node">
<title>layer53_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1462,-51424.94 1281,-51424.94 1281,-51356.94 1462,-51356.94 1462,-51424.94"/>
<text text-anchor="middle" x="1371.5" y="-51409.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1371.5" y="-51394.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1371.5" y="-51379.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1371.5" y="-51364.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_gate_ar&#45;&gt;layer53_silu_5 -->
<g id="edge1735" class="edge">
<title>layer53_gate_ar&#45;&gt;layer53_silu_5</title>
<path fill="none" stroke="black" d="M1363.24,-51500.04C1363.24,-51500.04 1363.24,-51434.94 1363.24,-51434.94"/>
<polygon fill="black" stroke="black" points="1366.74,-51434.94 1363.24,-51424.94 1359.74,-51434.94 1366.74,-51434.94"/>
</g>
<!-- layer53_mul_4 -->
<g id="node1361" class="node">
<title>layer53_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1135,-51284.94 954,-51284.94 954,-51216.94 1135,-51216.94 1135,-51284.94"/>
<text text-anchor="middle" x="1044.5" y="-51269.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1044.5" y="-51254.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1044.5" y="-51239.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1044.5" y="-51224.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_up_ar&#45;&gt;layer53_mul_4 -->
<g id="edge1737" class="edge">
<title>layer53_up_ar&#45;&gt;layer53_mul_4</title>
<path fill="none" stroke="black" d="M1009,-51498.75C1009,-51498.75 1009,-51295.02 1009,-51295.02"/>
<polygon fill="black" stroke="black" points="1012.5,-51295.02 1009,-51285.02 1005.5,-51295.02 1012.5,-51295.02"/>
</g>
<!-- layer53_mul_5 -->
<g id="node1362" class="node">
<title>layer53_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1352,-51284.94 1171,-51284.94 1171,-51216.94 1352,-51216.94 1352,-51284.94"/>
<text text-anchor="middle" x="1261.5" y="-51269.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1261.5" y="-51254.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1261.5" y="-51239.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1261.5" y="-51224.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer53_up_ar&#45;&gt;layer53_mul_5 -->
<g id="edge1739" class="edge">
<title>layer53_up_ar&#45;&gt;layer53_mul_5</title>
<path fill="none" stroke="black" d="M1081.74,-51520.43C1081.74,-51495.32 1081.74,-51460 1081.74,-51460 1081.74,-51460 1263,-51460 1263,-51460 1263,-51460 1263,-51294.99 1263,-51294.99"/>
<polygon fill="black" stroke="black" points="1266.5,-51294.99 1263,-51284.99 1259.5,-51294.99 1266.5,-51294.99"/>
</g>
<!-- layer53_silu_4&#45;&gt;layer53_mul_4 -->
<g id="edge1736" class="edge">
<title>layer53_silu_4&#45;&gt;layer53_mul_4</title>
<path fill="none" stroke="black" d="M1099.5,-51356.69C1099.5,-51356.69 1099.5,-51295.32 1099.5,-51295.32"/>
<polygon fill="black" stroke="black" points="1103,-51295.32 1099.5,-51285.32 1096,-51295.32 1103,-51295.32"/>
</g>
<!-- layer53_silu_5&#45;&gt;layer53_mul_5 -->
<g id="edge1738" class="edge">
<title>layer53_silu_5&#45;&gt;layer53_mul_5</title>
<path fill="none" stroke="black" d="M1316.5,-51356.69C1316.5,-51356.69 1316.5,-51295.32 1316.5,-51295.32"/>
<polygon fill="black" stroke="black" points="1320,-51295.32 1316.5,-51285.32 1313,-51295.32 1320,-51295.32"/>
</g>
<!-- layer53_ffn_down_4 -->
<g id="node1363" class="node">
<title>layer53_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1134.5,-51144.94 962.5,-51144.94 962.5,-51076.94 1134.5,-51076.94 1134.5,-51144.94"/>
<text text-anchor="middle" x="1048.5" y="-51129.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1048.5" y="-51114.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1048.5" y="-51099.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1048.5" y="-51084.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer53_mul_4&#45;&gt;layer53_ffn_down_4 -->
<g id="edge1740" class="edge">
<title>layer53_mul_4&#45;&gt;layer53_ffn_down_4</title>
<path fill="none" stroke="black" d="M1048.5,-51216.69C1048.5,-51216.69 1048.5,-51155.32 1048.5,-51155.32"/>
<polygon fill="black" stroke="black" points="1052,-51155.32 1048.5,-51145.32 1045,-51155.32 1052,-51155.32"/>
</g>
<!-- layer53_ffn_down_5 -->
<g id="node1364" class="node">
<title>layer53_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1344.5,-51144.94 1172.5,-51144.94 1172.5,-51076.94 1344.5,-51076.94 1344.5,-51144.94"/>
<text text-anchor="middle" x="1258.5" y="-51129.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1258.5" y="-51114.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1258.5" y="-51099.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1258.5" y="-51084.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer53_mul_5&#45;&gt;layer53_ffn_down_5 -->
<g id="edge1741" class="edge">
<title>layer53_mul_5&#45;&gt;layer53_ffn_down_5</title>
<path fill="none" stroke="black" d="M1258.5,-51216.69C1258.5,-51216.69 1258.5,-51155.32 1258.5,-51155.32"/>
<polygon fill="black" stroke="black" points="1262,-51155.32 1258.5,-51145.32 1255,-51155.32 1262,-51155.32"/>
</g>
<!-- layer53_ffn_ar -->
<g id="node1365" class="node">
<title>layer53_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1152.5" cy="-50956.85" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1152.5" y="-50975.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1152.5" y="-50960.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1152.5" y="-50945.65" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1152.5" y="-50930.65" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer53_ffn_down_4&#45;&gt;layer53_ffn_ar -->
<g id="edge1742" class="edge">
<title>layer53_ffn_down_4&#45;&gt;layer53_ffn_ar</title>
<path fill="none" stroke="black" d="M1082.69,-51076.74C1082.69,-51076.74 1082.69,-51006.4 1082.69,-51006.4"/>
<polygon fill="black" stroke="black" points="1086.19,-51006.4 1082.69,-50996.4 1079.19,-51006.4 1086.19,-51006.4"/>
</g>
<!-- layer53_ffn_down_5&#45;&gt;layer53_ffn_ar -->
<g id="edge1743" class="edge">
<title>layer53_ffn_down_5&#45;&gt;layer53_ffn_ar</title>
<path fill="none" stroke="black" d="M1223.31,-51076.74C1223.31,-51076.74 1223.31,-51006.12 1223.31,-51006.12"/>
<polygon fill="black" stroke="black" points="1226.81,-51006.12 1223.31,-50996.12 1219.81,-51006.12 1226.81,-51006.12"/>
</g>
<!-- layer54_norm_4 -->
<g id="node1366" class="node">
<title>layer54_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1134.5,-50836.77 962.5,-50836.77 962.5,-50768.77 1134.5,-50768.77 1134.5,-50836.77"/>
<text text-anchor="middle" x="1048.5" y="-50821.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1048.5" y="-50806.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1048.5" y="-50791.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1048.5" y="-50776.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer53_ffn_ar&#45;&gt;layer54_norm_4 -->
<g id="edge1744" class="edge">
<title>layer53_ffn_ar&#45;&gt;layer54_norm_4</title>
<path fill="none" stroke="black" d="M1082.69,-50917.17C1082.69,-50917.17 1082.69,-50846.83 1082.69,-50846.83"/>
<polygon fill="black" stroke="black" points="1086.19,-50846.83 1082.69,-50836.83 1079.19,-50846.83 1086.19,-50846.83"/>
</g>
<!-- layer54_norm_5 -->
<g id="node1367" class="node">
<title>layer54_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1344.5,-50836.77 1172.5,-50836.77 1172.5,-50768.77 1344.5,-50768.77 1344.5,-50836.77"/>
<text text-anchor="middle" x="1258.5" y="-50821.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1258.5" y="-50806.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1258.5" y="-50791.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1258.5" y="-50776.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer53_ffn_ar&#45;&gt;layer54_norm_5 -->
<g id="edge1745" class="edge">
<title>layer53_ffn_ar&#45;&gt;layer54_norm_5</title>
<path fill="none" stroke="black" d="M1223.31,-50917.57C1223.31,-50917.57 1223.31,-50847 1223.31,-50847"/>
<polygon fill="black" stroke="black" points="1226.81,-50847 1223.31,-50837 1219.81,-50847 1226.81,-50847"/>
</g>
<!-- layer54_qkv_4 -->
<g id="node1368" class="node">
<title>layer54_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1135,-50696.77 954,-50696.77 954,-50628.77 1135,-50628.77 1135,-50696.77"/>
<text text-anchor="middle" x="1044.5" y="-50681.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1044.5" y="-50666.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1044.5" y="-50651.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1044.5" y="-50636.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer54_norm_4&#45;&gt;layer54_qkv_4 -->
<g id="edge1746" class="edge">
<title>layer54_norm_4&#45;&gt;layer54_qkv_4</title>
<path fill="none" stroke="black" d="M1048.5,-50768.52C1048.5,-50768.52 1048.5,-50707.15 1048.5,-50707.15"/>
<polygon fill="black" stroke="black" points="1052,-50707.15 1048.5,-50697.15 1045,-50707.15 1052,-50707.15"/>
</g>
<!-- layer54_qkv_5 -->
<g id="node1369" class="node">
<title>layer54_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1352,-50696.77 1171,-50696.77 1171,-50628.77 1352,-50628.77 1352,-50696.77"/>
<text text-anchor="middle" x="1261.5" y="-50681.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1261.5" y="-50666.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1261.5" y="-50651.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1261.5" y="-50636.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer54_norm_5&#45;&gt;layer54_qkv_5 -->
<g id="edge1747" class="edge">
<title>layer54_norm_5&#45;&gt;layer54_qkv_5</title>
<path fill="none" stroke="black" d="M1258.5,-50768.52C1258.5,-50768.52 1258.5,-50707.15 1258.5,-50707.15"/>
<polygon fill="black" stroke="black" points="1262,-50707.15 1258.5,-50697.15 1255,-50707.15 1262,-50707.15"/>
</g>
<!-- layer54_qkv_ar -->
<g id="node1370" class="node">
<title>layer54_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1152.5" cy="-50508.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1152.5" y="-50527.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1152.5" y="-50512.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1152.5" y="-50497.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1152.5" y="-50482.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer54_qkv_4&#45;&gt;layer54_qkv_ar -->
<g id="edge1748" class="edge">
<title>layer54_qkv_4&#45;&gt;layer54_qkv_ar</title>
<path fill="none" stroke="black" d="M1079.76,-50628.58C1079.76,-50628.58 1079.76,-50558.51 1079.76,-50558.51"/>
<polygon fill="black" stroke="black" points="1083.26,-50558.51 1079.76,-50548.51 1076.26,-50558.51 1083.26,-50558.51"/>
</g>
<!-- layer54_qkv_5&#45;&gt;layer54_qkv_ar -->
<g id="edge1749" class="edge">
<title>layer54_qkv_5&#45;&gt;layer54_qkv_ar</title>
<path fill="none" stroke="black" d="M1225.74,-50628.58C1225.74,-50628.58 1225.74,-50558.23 1225.74,-50558.23"/>
<polygon fill="black" stroke="black" points="1229.24,-50558.23 1225.74,-50548.23 1222.24,-50558.23 1229.24,-50558.23"/>
</g>
<!-- layer54_attn_4 -->
<g id="node1371" class="node">
<title>layer54_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1134.5,-50388.6 962.5,-50388.6 962.5,-50320.6 1134.5,-50320.6 1134.5,-50388.6"/>
<text text-anchor="middle" x="1048.5" y="-50373.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1048.5" y="-50358.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1048.5" y="-50343.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1048.5" y="-50328.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer54_qkv_ar&#45;&gt;layer54_attn_4 -->
<g id="edge1750" class="edge">
<title>layer54_qkv_ar&#45;&gt;layer54_attn_4</title>
<path fill="none" stroke="black" d="M1079.51,-50469.01C1079.51,-50469.01 1079.51,-50398.66 1079.51,-50398.66"/>
<polygon fill="black" stroke="black" points="1083.01,-50398.66 1079.51,-50388.66 1076.01,-50398.66 1083.01,-50398.66"/>
</g>
<!-- layer54_attn_5 -->
<g id="node1372" class="node">
<title>layer54_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1342.5,-50388.6 1170.5,-50388.6 1170.5,-50320.6 1342.5,-50320.6 1342.5,-50388.6"/>
<text text-anchor="middle" x="1256.5" y="-50373.4" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1256.5" y="-50358.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1256.5" y="-50343.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1256.5" y="-50328.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer54_qkv_ar&#45;&gt;layer54_attn_5 -->
<g id="edge1751" class="edge">
<title>layer54_qkv_ar&#45;&gt;layer54_attn_5</title>
<path fill="none" stroke="black" d="M1225.49,-50469.01C1225.49,-50469.01 1225.49,-50398.66 1225.49,-50398.66"/>
<polygon fill="black" stroke="black" points="1228.99,-50398.66 1225.49,-50388.66 1221.99,-50398.66 1228.99,-50398.66"/>
</g>
<!-- layer54_attn_out_4 -->
<g id="node1373" class="node">
<title>layer54_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1134.5,-50248.6 962.5,-50248.6 962.5,-50180.6 1134.5,-50180.6 1134.5,-50248.6"/>
<text text-anchor="middle" x="1048.5" y="-50233.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1048.5" y="-50218.4" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1048.5" y="-50203.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1048.5" y="-50188.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer54_attn_4&#45;&gt;layer54_attn_out_4 -->
<g id="edge1752" class="edge">
<title>layer54_attn_4&#45;&gt;layer54_attn_out_4</title>
<path fill="none" stroke="black" d="M1048.5,-50320.36C1048.5,-50320.36 1048.5,-50258.98 1048.5,-50258.98"/>
<polygon fill="black" stroke="black" points="1052,-50258.98 1048.5,-50248.98 1045,-50258.98 1052,-50258.98"/>
</g>
<!-- layer54_attn_out_5 -->
<g id="node1374" class="node">
<title>layer54_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1342.5,-50248.6 1170.5,-50248.6 1170.5,-50180.6 1342.5,-50180.6 1342.5,-50248.6"/>
<text text-anchor="middle" x="1256.5" y="-50233.4" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1256.5" y="-50218.4" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1256.5" y="-50203.4" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1256.5" y="-50188.4" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer54_attn_5&#45;&gt;layer54_attn_out_5 -->
<g id="edge1753" class="edge">
<title>layer54_attn_5&#45;&gt;layer54_attn_out_5</title>
<path fill="none" stroke="black" d="M1256.5,-50320.36C1256.5,-50320.36 1256.5,-50258.98 1256.5,-50258.98"/>
<polygon fill="black" stroke="black" points="1260,-50258.98 1256.5,-50248.98 1253,-50258.98 1260,-50258.98"/>
</g>
<!-- layer54_attn_ar -->
<g id="node1375" class="node">
<title>layer54_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1152.5" cy="-50060.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1152.5" y="-50079.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1152.5" y="-50064.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1152.5" y="-50049.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1152.5" y="-50034.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer54_attn_out_4&#45;&gt;layer54_attn_ar -->
<g id="edge1754" class="edge">
<title>layer54_attn_out_4&#45;&gt;layer54_attn_ar</title>
<path fill="none" stroke="black" d="M1082.69,-50180.41C1082.69,-50180.41 1082.69,-50110.06 1082.69,-50110.06"/>
<polygon fill="black" stroke="black" points="1086.19,-50110.06 1082.69,-50100.06 1079.19,-50110.06 1086.19,-50110.06"/>
</g>
<!-- layer54_attn_out_5&#45;&gt;layer54_attn_ar -->
<g id="edge1755" class="edge">
<title>layer54_attn_out_5&#45;&gt;layer54_attn_ar</title>
<path fill="none" stroke="black" d="M1222.31,-50180.41C1222.31,-50180.41 1222.31,-50110.06 1222.31,-50110.06"/>
<polygon fill="black" stroke="black" points="1225.81,-50110.06 1222.31,-50100.06 1218.81,-50110.06 1225.81,-50110.06"/>
</g>
<!-- layer54_ffn_norm_4 -->
<g id="node1376" class="node">
<title>layer54_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1130.5,-49940.44 958.5,-49940.44 958.5,-49872.44 1130.5,-49872.44 1130.5,-49940.44"/>
<text text-anchor="middle" x="1044.5" y="-49925.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1044.5" y="-49910.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1044.5" y="-49895.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1044.5" y="-49880.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer54_attn_ar&#45;&gt;layer54_ffn_norm_4 -->
<g id="edge1756" class="edge">
<title>layer54_attn_ar&#45;&gt;layer54_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1080.69,-50021.64C1080.69,-50021.64 1080.69,-49950.59 1080.69,-49950.59"/>
<polygon fill="black" stroke="black" points="1084.19,-49950.59 1080.69,-49940.59 1077.19,-49950.59 1084.19,-49950.59"/>
</g>
<!-- layer54_ffn_norm_5 -->
<g id="node1377" class="node">
<title>layer54_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1347.5,-49940.44 1175.5,-49940.44 1175.5,-49872.44 1347.5,-49872.44 1347.5,-49940.44"/>
<text text-anchor="middle" x="1261.5" y="-49925.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1261.5" y="-49910.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1261.5" y="-49895.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1261.5" y="-49880.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer54_attn_ar&#45;&gt;layer54_ffn_norm_5 -->
<g id="edge1757" class="edge">
<title>layer54_attn_ar&#45;&gt;layer54_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1224.81,-50021.64C1224.81,-50021.64 1224.81,-49950.59 1224.81,-49950.59"/>
<polygon fill="black" stroke="black" points="1228.31,-49950.59 1224.81,-49940.59 1221.31,-49950.59 1228.31,-49950.59"/>
</g>
<!-- layer54_ffn_gate_4 -->
<g id="node1378" class="node">
<title>layer54_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1135,-49800.44 954,-49800.44 954,-49732.44 1135,-49732.44 1135,-49800.44"/>
<text text-anchor="middle" x="1044.5" y="-49785.24" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1044.5" y="-49770.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1044.5" y="-49755.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1044.5" y="-49740.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_ffn_norm_4&#45;&gt;layer54_ffn_gate_4 -->
<g id="edge1758" class="edge">
<title>layer54_ffn_norm_4&#45;&gt;layer54_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1044.5,-49872.19C1044.5,-49872.19 1044.5,-49810.82 1044.5,-49810.82"/>
<polygon fill="black" stroke="black" points="1048,-49810.82 1044.5,-49800.82 1041,-49810.82 1048,-49810.82"/>
</g>
<!-- layer54_ffn_up_4 -->
<g id="node1380" class="node">
<title>layer54_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="918,-49800.44 737,-49800.44 737,-49732.44 918,-49732.44 918,-49800.44"/>
<text text-anchor="middle" x="827.5" y="-49785.24" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="827.5" y="-49770.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="827.5" y="-49755.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="827.5" y="-49740.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_ffn_norm_4&#45;&gt;layer54_ffn_up_4 -->
<g id="edge1760" class="edge">
<title>layer54_ffn_norm_4&#45;&gt;layer54_ffn_up_4</title>
<path fill="none" stroke="black" d="M958.31,-49906C918.86,-49906 880.76,-49906 880.76,-49906 880.76,-49906 880.76,-49810.58 880.76,-49810.58"/>
<polygon fill="black" stroke="black" points="884.26,-49810.58 880.76,-49800.58 877.26,-49810.58 884.26,-49810.58"/>
</g>
<!-- layer54_ffn_gate_5 -->
<g id="node1379" class="node">
<title>layer54_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1569,-49800.44 1388,-49800.44 1388,-49732.44 1569,-49732.44 1569,-49800.44"/>
<text text-anchor="middle" x="1478.5" y="-49785.24" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1478.5" y="-49770.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1478.5" y="-49755.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1478.5" y="-49740.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_ffn_norm_5&#45;&gt;layer54_ffn_gate_5 -->
<g id="edge1759" class="edge">
<title>layer54_ffn_norm_5&#45;&gt;layer54_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1347.56,-49906C1386.95,-49906 1425,-49906 1425,-49906 1425,-49906 1425,-49810.58 1425,-49810.58"/>
<polygon fill="black" stroke="black" points="1428.5,-49810.58 1425,-49800.58 1421.5,-49810.58 1428.5,-49810.58"/>
</g>
<!-- layer54_ffn_up_5 -->
<g id="node1381" class="node">
<title>layer54_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1352,-49800.44 1171,-49800.44 1171,-49732.44 1352,-49732.44 1352,-49800.44"/>
<text text-anchor="middle" x="1261.5" y="-49785.24" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1261.5" y="-49770.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1261.5" y="-49755.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1261.5" y="-49740.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_ffn_norm_5&#45;&gt;layer54_ffn_up_5 -->
<g id="edge1761" class="edge">
<title>layer54_ffn_norm_5&#45;&gt;layer54_ffn_up_5</title>
<path fill="none" stroke="black" d="M1261.5,-49872.19C1261.5,-49872.19 1261.5,-49810.82 1261.5,-49810.82"/>
<polygon fill="black" stroke="black" points="1265,-49810.82 1261.5,-49800.82 1258,-49810.82 1265,-49810.82"/>
</g>
<!-- layer54_gate_ar -->
<g id="node1382" class="node">
<title>layer54_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1352.5" cy="-49612.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1352.5" y="-49631.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1352.5" y="-49616.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1352.5" y="-49601.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1352.5" y="-49586.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer54_ffn_gate_4&#45;&gt;layer54_gate_ar -->
<g id="edge1762" class="edge">
<title>layer54_ffn_gate_4&#45;&gt;layer54_gate_ar</title>
<path fill="none" stroke="black" d="M1135.08,-49766C1145.79,-49766 1153,-49766 1153,-49766 1153,-49766 1153,-49628 1153,-49628 1153,-49628 1221.28,-49628 1221.28,-49628"/>
<polygon fill="black" stroke="black" points="1221.28,-49631.5 1231.28,-49628 1221.28,-49624.5 1221.28,-49631.5"/>
</g>
<!-- layer54_ffn_gate_5&#45;&gt;layer54_gate_ar -->
<g id="edge1763" class="edge">
<title>layer54_ffn_gate_5&#45;&gt;layer54_gate_ar</title>
<path fill="none" stroke="black" d="M1434.24,-49732.24C1434.24,-49732.24 1434.24,-49659.42 1434.24,-49659.42"/>
<polygon fill="black" stroke="black" points="1437.74,-49659.42 1434.24,-49649.42 1430.74,-49659.42 1437.74,-49659.42"/>
</g>
<!-- layer54_up_ar -->
<g id="node1383" class="node">
<title>layer54_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1006.5" cy="-49612.35" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1006.5" y="-49631.15" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1006.5" y="-49616.15" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1006.5" y="-49601.15" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1006.5" y="-49586.15" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer54_ffn_up_4&#45;&gt;layer54_up_ar -->
<g id="edge1764" class="edge">
<title>layer54_ffn_up_4&#45;&gt;layer54_up_ar</title>
<path fill="none" stroke="black" d="M898.26,-49732.24C898.26,-49732.24 898.26,-49648.32 898.26,-49648.32"/>
<polygon fill="black" stroke="black" points="901.76,-49648.32 898.26,-49638.32 894.76,-49648.32 901.76,-49648.32"/>
</g>
<!-- layer54_ffn_up_5&#45;&gt;layer54_up_ar -->
<g id="edge1765" class="edge">
<title>layer54_ffn_up_5&#45;&gt;layer54_up_ar</title>
<path fill="none" stroke="black" d="M1197.76,-49732.36C1197.76,-49682.62 1197.76,-49596 1197.76,-49596 1197.76,-49596 1137.08,-49596 1137.08,-49596"/>
<polygon fill="black" stroke="black" points="1137.08,-49592.5 1127.08,-49596 1137.08,-49599.5 1137.08,-49592.5"/>
</g>
<!-- layer54_silu_4 -->
<g id="node1384" class="node">
<title>layer54_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1280,-49492.27 1099,-49492.27 1099,-49424.27 1280,-49424.27 1280,-49492.27"/>
<text text-anchor="middle" x="1189.5" y="-49477.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1189.5" y="-49462.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1189.5" y="-49447.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1189.5" y="-49432.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_gate_ar&#45;&gt;layer54_silu_4 -->
<g id="edge1766" class="edge">
<title>layer54_gate_ar&#45;&gt;layer54_silu_4</title>
<path fill="none" stroke="black" d="M1252.26,-49582.28C1252.26,-49582.28 1252.26,-49502.29 1252.26,-49502.29"/>
<polygon fill="black" stroke="black" points="1255.76,-49502.29 1252.26,-49492.29 1248.76,-49502.29 1255.76,-49502.29"/>
</g>
<!-- layer54_silu_5 -->
<g id="node1385" class="node">
<title>layer54_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1497,-49492.27 1316,-49492.27 1316,-49424.27 1497,-49424.27 1497,-49492.27"/>
<text text-anchor="middle" x="1406.5" y="-49477.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1406.5" y="-49462.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1406.5" y="-49447.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1406.5" y="-49432.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_gate_ar&#45;&gt;layer54_silu_5 -->
<g id="edge1767" class="edge">
<title>layer54_gate_ar&#45;&gt;layer54_silu_5</title>
<path fill="none" stroke="black" d="M1398.24,-49567.37C1398.24,-49567.37 1398.24,-49502.28 1398.24,-49502.28"/>
<polygon fill="black" stroke="black" points="1401.74,-49502.28 1398.24,-49492.28 1394.74,-49502.28 1401.74,-49502.28"/>
</g>
<!-- layer54_mul_4 -->
<g id="node1386" class="node">
<title>layer54_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1170,-49352.27 989,-49352.27 989,-49284.27 1170,-49284.27 1170,-49352.27"/>
<text text-anchor="middle" x="1079.5" y="-49337.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1079.5" y="-49322.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1079.5" y="-49307.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1079.5" y="-49292.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_up_ar&#45;&gt;layer54_mul_4 -->
<g id="edge1769" class="edge">
<title>layer54_up_ar&#45;&gt;layer54_mul_4</title>
<path fill="none" stroke="black" d="M1044,-49566.08C1044,-49566.08 1044,-49362.36 1044,-49362.36"/>
<polygon fill="black" stroke="black" points="1047.5,-49362.36 1044,-49352.36 1040.5,-49362.36 1047.5,-49362.36"/>
</g>
<!-- layer54_mul_5 -->
<g id="node1387" class="node">
<title>layer54_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1387,-49352.27 1206,-49352.27 1206,-49284.27 1387,-49284.27 1387,-49352.27"/>
<text text-anchor="middle" x="1296.5" y="-49337.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1296.5" y="-49322.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1296.5" y="-49307.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1296.5" y="-49292.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer54_up_ar&#45;&gt;layer54_mul_5 -->
<g id="edge1771" class="edge">
<title>layer54_up_ar&#45;&gt;layer54_mul_5</title>
<path fill="none" stroke="black" d="M1116.74,-49587.5C1116.74,-49562.62 1116.74,-49528 1116.74,-49528 1116.74,-49528 1298,-49528 1298,-49528 1298,-49528 1298,-49362.43 1298,-49362.43"/>
<polygon fill="black" stroke="black" points="1301.5,-49362.43 1298,-49352.43 1294.5,-49362.43 1301.5,-49362.43"/>
</g>
<!-- layer54_silu_4&#45;&gt;layer54_mul_4 -->
<g id="edge1768" class="edge">
<title>layer54_silu_4&#45;&gt;layer54_mul_4</title>
<path fill="none" stroke="black" d="M1134.5,-49424.02C1134.5,-49424.02 1134.5,-49362.65 1134.5,-49362.65"/>
<polygon fill="black" stroke="black" points="1138,-49362.65 1134.5,-49352.65 1131,-49362.65 1138,-49362.65"/>
</g>
<!-- layer54_silu_5&#45;&gt;layer54_mul_5 -->
<g id="edge1770" class="edge">
<title>layer54_silu_5&#45;&gt;layer54_mul_5</title>
<path fill="none" stroke="black" d="M1351.5,-49424.02C1351.5,-49424.02 1351.5,-49362.65 1351.5,-49362.65"/>
<polygon fill="black" stroke="black" points="1355,-49362.65 1351.5,-49352.65 1348,-49362.65 1355,-49362.65"/>
</g>
<!-- layer54_ffn_down_4 -->
<g id="node1388" class="node">
<title>layer54_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1169.5,-49212.27 997.5,-49212.27 997.5,-49144.27 1169.5,-49144.27 1169.5,-49212.27"/>
<text text-anchor="middle" x="1083.5" y="-49197.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1083.5" y="-49182.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1083.5" y="-49167.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1083.5" y="-49152.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer54_mul_4&#45;&gt;layer54_ffn_down_4 -->
<g id="edge1772" class="edge">
<title>layer54_mul_4&#45;&gt;layer54_ffn_down_4</title>
<path fill="none" stroke="black" d="M1083.5,-49284.02C1083.5,-49284.02 1083.5,-49222.65 1083.5,-49222.65"/>
<polygon fill="black" stroke="black" points="1087,-49222.65 1083.5,-49212.65 1080,-49222.65 1087,-49222.65"/>
</g>
<!-- layer54_ffn_down_5 -->
<g id="node1389" class="node">
<title>layer54_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1379.5,-49212.27 1207.5,-49212.27 1207.5,-49144.27 1379.5,-49144.27 1379.5,-49212.27"/>
<text text-anchor="middle" x="1293.5" y="-49197.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1293.5" y="-49182.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1293.5" y="-49167.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1293.5" y="-49152.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer54_mul_5&#45;&gt;layer54_ffn_down_5 -->
<g id="edge1773" class="edge">
<title>layer54_mul_5&#45;&gt;layer54_ffn_down_5</title>
<path fill="none" stroke="black" d="M1293.5,-49284.02C1293.5,-49284.02 1293.5,-49222.65 1293.5,-49222.65"/>
<polygon fill="black" stroke="black" points="1297,-49222.65 1293.5,-49212.65 1290,-49222.65 1297,-49222.65"/>
</g>
<!-- layer54_ffn_ar -->
<g id="node1390" class="node">
<title>layer54_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1187.5" cy="-49024.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1187.5" y="-49042.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1187.5" y="-49027.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1187.5" y="-49012.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1187.5" y="-48997.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer54_ffn_down_4&#45;&gt;layer54_ffn_ar -->
<g id="edge1774" class="edge">
<title>layer54_ffn_down_4&#45;&gt;layer54_ffn_ar</title>
<path fill="none" stroke="black" d="M1117.69,-49144.08C1117.69,-49144.08 1117.69,-49073.73 1117.69,-49073.73"/>
<polygon fill="black" stroke="black" points="1121.19,-49073.73 1117.69,-49063.73 1114.19,-49073.73 1121.19,-49073.73"/>
</g>
<!-- layer54_ffn_down_5&#45;&gt;layer54_ffn_ar -->
<g id="edge1775" class="edge">
<title>layer54_ffn_down_5&#45;&gt;layer54_ffn_ar</title>
<path fill="none" stroke="black" d="M1258.31,-49144.08C1258.31,-49144.08 1258.31,-49073.45 1258.31,-49073.45"/>
<polygon fill="black" stroke="black" points="1261.81,-49073.45 1258.31,-49063.45 1254.81,-49073.45 1261.81,-49073.45"/>
</g>
<!-- layer55_norm_4 -->
<g id="node1391" class="node">
<title>layer55_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1169.5,-48904.11 997.5,-48904.11 997.5,-48836.11 1169.5,-48836.11 1169.5,-48904.11"/>
<text text-anchor="middle" x="1083.5" y="-48888.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1083.5" y="-48873.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1083.5" y="-48858.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1083.5" y="-48843.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer54_ffn_ar&#45;&gt;layer55_norm_4 -->
<g id="edge1776" class="edge">
<title>layer54_ffn_ar&#45;&gt;layer55_norm_4</title>
<path fill="none" stroke="black" d="M1117.69,-48984.51C1117.69,-48984.51 1117.69,-48914.16 1117.69,-48914.16"/>
<polygon fill="black" stroke="black" points="1121.19,-48914.16 1117.69,-48904.16 1114.19,-48914.16 1121.19,-48914.16"/>
</g>
<!-- layer55_norm_5 -->
<g id="node1392" class="node">
<title>layer55_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1379.5,-48904.11 1207.5,-48904.11 1207.5,-48836.11 1379.5,-48836.11 1379.5,-48904.11"/>
<text text-anchor="middle" x="1293.5" y="-48888.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1293.5" y="-48873.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1293.5" y="-48858.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1293.5" y="-48843.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer54_ffn_ar&#45;&gt;layer55_norm_5 -->
<g id="edge1777" class="edge">
<title>layer54_ffn_ar&#45;&gt;layer55_norm_5</title>
<path fill="none" stroke="black" d="M1258.31,-48984.91C1258.31,-48984.91 1258.31,-48914.34 1258.31,-48914.34"/>
<polygon fill="black" stroke="black" points="1261.81,-48914.34 1258.31,-48904.34 1254.81,-48914.34 1261.81,-48914.34"/>
</g>
<!-- layer55_qkv_4 -->
<g id="node1393" class="node">
<title>layer55_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1170,-48764.11 989,-48764.11 989,-48696.11 1170,-48696.11 1170,-48764.11"/>
<text text-anchor="middle" x="1079.5" y="-48748.91" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1079.5" y="-48733.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1079.5" y="-48718.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1079.5" y="-48703.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer55_norm_4&#45;&gt;layer55_qkv_4 -->
<g id="edge1778" class="edge">
<title>layer55_norm_4&#45;&gt;layer55_qkv_4</title>
<path fill="none" stroke="black" d="M1083.5,-48835.86C1083.5,-48835.86 1083.5,-48774.48 1083.5,-48774.48"/>
<polygon fill="black" stroke="black" points="1087,-48774.48 1083.5,-48764.48 1080,-48774.48 1087,-48774.48"/>
</g>
<!-- layer55_qkv_5 -->
<g id="node1394" class="node">
<title>layer55_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1387,-48764.11 1206,-48764.11 1206,-48696.11 1387,-48696.11 1387,-48764.11"/>
<text text-anchor="middle" x="1296.5" y="-48748.91" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1296.5" y="-48733.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1296.5" y="-48718.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1296.5" y="-48703.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer55_norm_5&#45;&gt;layer55_qkv_5 -->
<g id="edge1779" class="edge">
<title>layer55_norm_5&#45;&gt;layer55_qkv_5</title>
<path fill="none" stroke="black" d="M1293.5,-48835.86C1293.5,-48835.86 1293.5,-48774.48 1293.5,-48774.48"/>
<polygon fill="black" stroke="black" points="1297,-48774.48 1293.5,-48764.48 1290,-48774.48 1297,-48774.48"/>
</g>
<!-- layer55_qkv_ar -->
<g id="node1395" class="node">
<title>layer55_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1187.5" cy="-48576.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1187.5" y="-48594.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1187.5" y="-48579.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1187.5" y="-48564.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1187.5" y="-48549.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer55_qkv_4&#45;&gt;layer55_qkv_ar -->
<g id="edge1780" class="edge">
<title>layer55_qkv_4&#45;&gt;layer55_qkv_ar</title>
<path fill="none" stroke="black" d="M1114.76,-48695.91C1114.76,-48695.91 1114.76,-48625.84 1114.76,-48625.84"/>
<polygon fill="black" stroke="black" points="1118.26,-48625.84 1114.76,-48615.84 1111.26,-48625.84 1118.26,-48625.84"/>
</g>
<!-- layer55_qkv_5&#45;&gt;layer55_qkv_ar -->
<g id="edge1781" class="edge">
<title>layer55_qkv_5&#45;&gt;layer55_qkv_ar</title>
<path fill="none" stroke="black" d="M1260.74,-48695.91C1260.74,-48695.91 1260.74,-48625.56 1260.74,-48625.56"/>
<polygon fill="black" stroke="black" points="1264.24,-48625.56 1260.74,-48615.56 1257.24,-48625.56 1264.24,-48625.56"/>
</g>
<!-- layer55_attn_4 -->
<g id="node1396" class="node">
<title>layer55_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1169.5,-48455.94 997.5,-48455.94 997.5,-48387.94 1169.5,-48387.94 1169.5,-48455.94"/>
<text text-anchor="middle" x="1083.5" y="-48440.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1083.5" y="-48425.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1083.5" y="-48410.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1083.5" y="-48395.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer55_qkv_ar&#45;&gt;layer55_attn_4 -->
<g id="edge1782" class="edge">
<title>layer55_qkv_ar&#45;&gt;layer55_attn_4</title>
<path fill="none" stroke="black" d="M1114.51,-48536.34C1114.51,-48536.34 1114.51,-48466 1114.51,-48466"/>
<polygon fill="black" stroke="black" points="1118.01,-48466 1114.51,-48456 1111.01,-48466 1118.01,-48466"/>
</g>
<!-- layer55_attn_5 -->
<g id="node1397" class="node">
<title>layer55_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1377.5,-48455.94 1205.5,-48455.94 1205.5,-48387.94 1377.5,-48387.94 1377.5,-48455.94"/>
<text text-anchor="middle" x="1291.5" y="-48440.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1291.5" y="-48425.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1291.5" y="-48410.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1291.5" y="-48395.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer55_qkv_ar&#45;&gt;layer55_attn_5 -->
<g id="edge1783" class="edge">
<title>layer55_qkv_ar&#45;&gt;layer55_attn_5</title>
<path fill="none" stroke="black" d="M1260.49,-48536.34C1260.49,-48536.34 1260.49,-48466 1260.49,-48466"/>
<polygon fill="black" stroke="black" points="1263.99,-48466 1260.49,-48456 1256.99,-48466 1263.99,-48466"/>
</g>
<!-- layer55_attn_out_4 -->
<g id="node1398" class="node">
<title>layer55_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1169.5,-48315.94 997.5,-48315.94 997.5,-48247.94 1169.5,-48247.94 1169.5,-48315.94"/>
<text text-anchor="middle" x="1083.5" y="-48300.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1083.5" y="-48285.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1083.5" y="-48270.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1083.5" y="-48255.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer55_attn_4&#45;&gt;layer55_attn_out_4 -->
<g id="edge1784" class="edge">
<title>layer55_attn_4&#45;&gt;layer55_attn_out_4</title>
<path fill="none" stroke="black" d="M1083.5,-48387.69C1083.5,-48387.69 1083.5,-48326.32 1083.5,-48326.32"/>
<polygon fill="black" stroke="black" points="1087,-48326.32 1083.5,-48316.32 1080,-48326.32 1087,-48326.32"/>
</g>
<!-- layer55_attn_out_5 -->
<g id="node1399" class="node">
<title>layer55_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1377.5,-48315.94 1205.5,-48315.94 1205.5,-48247.94 1377.5,-48247.94 1377.5,-48315.94"/>
<text text-anchor="middle" x="1291.5" y="-48300.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1291.5" y="-48285.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1291.5" y="-48270.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1291.5" y="-48255.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer55_attn_5&#45;&gt;layer55_attn_out_5 -->
<g id="edge1785" class="edge">
<title>layer55_attn_5&#45;&gt;layer55_attn_out_5</title>
<path fill="none" stroke="black" d="M1291.5,-48387.69C1291.5,-48387.69 1291.5,-48326.32 1291.5,-48326.32"/>
<polygon fill="black" stroke="black" points="1295,-48326.32 1291.5,-48316.32 1288,-48326.32 1295,-48326.32"/>
</g>
<!-- layer55_attn_ar -->
<g id="node1400" class="node">
<title>layer55_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1187.5" cy="-48127.86" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1187.5" y="-48146.66" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1187.5" y="-48131.66" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1187.5" y="-48116.66" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1187.5" y="-48101.66" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer55_attn_out_4&#45;&gt;layer55_attn_ar -->
<g id="edge1786" class="edge">
<title>layer55_attn_out_4&#45;&gt;layer55_attn_ar</title>
<path fill="none" stroke="black" d="M1117.69,-48247.74C1117.69,-48247.74 1117.69,-48177.4 1117.69,-48177.4"/>
<polygon fill="black" stroke="black" points="1121.19,-48177.4 1117.69,-48167.4 1114.19,-48177.4 1121.19,-48177.4"/>
</g>
<!-- layer55_attn_out_5&#45;&gt;layer55_attn_ar -->
<g id="edge1787" class="edge">
<title>layer55_attn_out_5&#45;&gt;layer55_attn_ar</title>
<path fill="none" stroke="black" d="M1257.31,-48247.74C1257.31,-48247.74 1257.31,-48177.4 1257.31,-48177.4"/>
<polygon fill="black" stroke="black" points="1260.81,-48177.4 1257.31,-48167.4 1253.81,-48177.4 1260.81,-48177.4"/>
</g>
<!-- layer55_ffn_norm_4 -->
<g id="node1401" class="node">
<title>layer55_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1165.5,-48007.77 993.5,-48007.77 993.5,-47939.77 1165.5,-47939.77 1165.5,-48007.77"/>
<text text-anchor="middle" x="1079.5" y="-47992.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1079.5" y="-47977.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1079.5" y="-47962.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1079.5" y="-47947.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer55_attn_ar&#45;&gt;layer55_ffn_norm_4 -->
<g id="edge1788" class="edge">
<title>layer55_attn_ar&#45;&gt;layer55_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1115.69,-48088.97C1115.69,-48088.97 1115.69,-48017.92 1115.69,-48017.92"/>
<polygon fill="black" stroke="black" points="1119.19,-48017.92 1115.69,-48007.92 1112.19,-48017.92 1119.19,-48017.92"/>
</g>
<!-- layer55_ffn_norm_5 -->
<g id="node1402" class="node">
<title>layer55_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1382.5,-48007.77 1210.5,-48007.77 1210.5,-47939.77 1382.5,-47939.77 1382.5,-48007.77"/>
<text text-anchor="middle" x="1296.5" y="-47992.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1296.5" y="-47977.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1296.5" y="-47962.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1296.5" y="-47947.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer55_attn_ar&#45;&gt;layer55_ffn_norm_5 -->
<g id="edge1789" class="edge">
<title>layer55_attn_ar&#45;&gt;layer55_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1259.81,-48088.97C1259.81,-48088.97 1259.81,-48017.92 1259.81,-48017.92"/>
<polygon fill="black" stroke="black" points="1263.31,-48017.92 1259.81,-48007.92 1256.31,-48017.92 1263.31,-48017.92"/>
</g>
<!-- layer55_ffn_gate_4 -->
<g id="node1403" class="node">
<title>layer55_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1170,-47867.77 989,-47867.77 989,-47799.77 1170,-47799.77 1170,-47867.77"/>
<text text-anchor="middle" x="1079.5" y="-47852.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1079.5" y="-47837.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1079.5" y="-47822.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1079.5" y="-47807.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_ffn_norm_4&#45;&gt;layer55_ffn_gate_4 -->
<g id="edge1790" class="edge">
<title>layer55_ffn_norm_4&#45;&gt;layer55_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1079.5,-47939.52C1079.5,-47939.52 1079.5,-47878.15 1079.5,-47878.15"/>
<polygon fill="black" stroke="black" points="1083,-47878.15 1079.5,-47868.15 1076,-47878.15 1083,-47878.15"/>
</g>
<!-- layer55_ffn_up_4 -->
<g id="node1405" class="node">
<title>layer55_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="953,-47867.77 772,-47867.77 772,-47799.77 953,-47799.77 953,-47867.77"/>
<text text-anchor="middle" x="862.5" y="-47852.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="862.5" y="-47837.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="862.5" y="-47822.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="862.5" y="-47807.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_ffn_norm_4&#45;&gt;layer55_ffn_up_4 -->
<g id="edge1792" class="edge">
<title>layer55_ffn_norm_4&#45;&gt;layer55_ffn_up_4</title>
<path fill="none" stroke="black" d="M993.31,-47973C953.86,-47973 915.76,-47973 915.76,-47973 915.76,-47973 915.76,-47877.83 915.76,-47877.83"/>
<polygon fill="black" stroke="black" points="919.26,-47877.83 915.76,-47867.83 912.26,-47877.83 919.26,-47877.83"/>
</g>
<!-- layer55_ffn_gate_5 -->
<g id="node1404" class="node">
<title>layer55_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1604,-47867.77 1423,-47867.77 1423,-47799.77 1604,-47799.77 1604,-47867.77"/>
<text text-anchor="middle" x="1513.5" y="-47852.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1513.5" y="-47837.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1513.5" y="-47822.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1513.5" y="-47807.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_ffn_norm_5&#45;&gt;layer55_ffn_gate_5 -->
<g id="edge1791" class="edge">
<title>layer55_ffn_norm_5&#45;&gt;layer55_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1382.56,-47973C1421.95,-47973 1460,-47973 1460,-47973 1460,-47973 1460,-47877.83 1460,-47877.83"/>
<polygon fill="black" stroke="black" points="1463.5,-47877.83 1460,-47867.83 1456.5,-47877.83 1463.5,-47877.83"/>
</g>
<!-- layer55_ffn_up_5 -->
<g id="node1406" class="node">
<title>layer55_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1387,-47867.77 1206,-47867.77 1206,-47799.77 1387,-47799.77 1387,-47867.77"/>
<text text-anchor="middle" x="1296.5" y="-47852.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1296.5" y="-47837.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1296.5" y="-47822.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1296.5" y="-47807.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_ffn_norm_5&#45;&gt;layer55_ffn_up_5 -->
<g id="edge1793" class="edge">
<title>layer55_ffn_norm_5&#45;&gt;layer55_ffn_up_5</title>
<path fill="none" stroke="black" d="M1296.5,-47939.52C1296.5,-47939.52 1296.5,-47878.15 1296.5,-47878.15"/>
<polygon fill="black" stroke="black" points="1300,-47878.15 1296.5,-47868.15 1293,-47878.15 1300,-47878.15"/>
</g>
<!-- layer55_gate_ar -->
<g id="node1407" class="node">
<title>layer55_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1387.5" cy="-47679.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1387.5" y="-47698.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1387.5" y="-47683.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1387.5" y="-47668.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1387.5" y="-47653.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer55_ffn_gate_4&#45;&gt;layer55_gate_ar -->
<g id="edge1794" class="edge">
<title>layer55_ffn_gate_4&#45;&gt;layer55_gate_ar</title>
<path fill="none" stroke="black" d="M1170.08,-47833C1180.79,-47833 1188,-47833 1188,-47833 1188,-47833 1188,-47695 1188,-47695 1188,-47695 1255.99,-47695 1255.99,-47695"/>
<polygon fill="black" stroke="black" points="1255.99,-47698.5 1265.99,-47695 1255.99,-47691.5 1255.99,-47698.5"/>
</g>
<!-- layer55_ffn_gate_5&#45;&gt;layer55_gate_ar -->
<g id="edge1795" class="edge">
<title>layer55_ffn_gate_5&#45;&gt;layer55_gate_ar</title>
<path fill="none" stroke="black" d="M1469.24,-47799.58C1469.24,-47799.58 1469.24,-47726.75 1469.24,-47726.75"/>
<polygon fill="black" stroke="black" points="1472.74,-47726.75 1469.24,-47716.75 1465.74,-47726.75 1472.74,-47726.75"/>
</g>
<!-- layer55_up_ar -->
<g id="node1408" class="node">
<title>layer55_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1041.5" cy="-47679.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1041.5" y="-47698.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1041.5" y="-47683.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1041.5" y="-47668.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1041.5" y="-47653.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer55_ffn_up_4&#45;&gt;layer55_up_ar -->
<g id="edge1796" class="edge">
<title>layer55_ffn_up_4&#45;&gt;layer55_up_ar</title>
<path fill="none" stroke="black" d="M933.26,-47799.58C933.26,-47799.58 933.26,-47715.65 933.26,-47715.65"/>
<polygon fill="black" stroke="black" points="936.76,-47715.65 933.26,-47705.65 929.76,-47715.65 936.76,-47715.65"/>
</g>
<!-- layer55_ffn_up_5&#45;&gt;layer55_up_ar -->
<g id="edge1797" class="edge">
<title>layer55_ffn_up_5&#45;&gt;layer55_up_ar</title>
<path fill="none" stroke="black" d="M1232.76,-47799.62C1232.76,-47749.79 1232.76,-47663 1232.76,-47663 1232.76,-47663 1171.54,-47663 1171.54,-47663"/>
<polygon fill="black" stroke="black" points="1171.54,-47659.5 1161.54,-47663 1171.54,-47666.5 1171.54,-47659.5"/>
</g>
<!-- layer55_silu_4 -->
<g id="node1409" class="node">
<title>layer55_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1315,-47559.61 1134,-47559.61 1134,-47491.61 1315,-47491.61 1315,-47559.61"/>
<text text-anchor="middle" x="1224.5" y="-47544.41" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1224.5" y="-47529.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1224.5" y="-47514.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1224.5" y="-47499.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_gate_ar&#45;&gt;layer55_silu_4 -->
<g id="edge1798" class="edge">
<title>layer55_gate_ar&#45;&gt;layer55_silu_4</title>
<path fill="none" stroke="black" d="M1287.26,-47649.61C1287.26,-47649.61 1287.26,-47569.63 1287.26,-47569.63"/>
<polygon fill="black" stroke="black" points="1290.76,-47569.63 1287.26,-47559.63 1283.76,-47569.63 1290.76,-47569.63"/>
</g>
<!-- layer55_silu_5 -->
<g id="node1410" class="node">
<title>layer55_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1532,-47559.61 1351,-47559.61 1351,-47491.61 1532,-47491.61 1532,-47559.61"/>
<text text-anchor="middle" x="1441.5" y="-47544.41" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1441.5" y="-47529.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1441.5" y="-47514.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1441.5" y="-47499.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_gate_ar&#45;&gt;layer55_silu_5 -->
<g id="edge1799" class="edge">
<title>layer55_gate_ar&#45;&gt;layer55_silu_5</title>
<path fill="none" stroke="black" d="M1433.24,-47634.71C1433.24,-47634.71 1433.24,-47569.61 1433.24,-47569.61"/>
<polygon fill="black" stroke="black" points="1436.74,-47569.61 1433.24,-47559.61 1429.74,-47569.61 1436.74,-47569.61"/>
</g>
<!-- layer55_mul_4 -->
<g id="node1411" class="node">
<title>layer55_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1205,-47419.61 1024,-47419.61 1024,-47351.61 1205,-47351.61 1205,-47419.61"/>
<text text-anchor="middle" x="1114.5" y="-47404.41" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1114.5" y="-47389.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1114.5" y="-47374.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1114.5" y="-47359.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_up_ar&#45;&gt;layer55_mul_4 -->
<g id="edge1801" class="edge">
<title>layer55_up_ar&#45;&gt;layer55_mul_4</title>
<path fill="none" stroke="black" d="M1079,-47633.41C1079,-47633.41 1079,-47429.69 1079,-47429.69"/>
<polygon fill="black" stroke="black" points="1082.5,-47429.69 1079,-47419.69 1075.5,-47429.69 1082.5,-47429.69"/>
</g>
<!-- layer55_mul_5 -->
<g id="node1412" class="node">
<title>layer55_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1422,-47419.61 1241,-47419.61 1241,-47351.61 1422,-47351.61 1422,-47419.61"/>
<text text-anchor="middle" x="1331.5" y="-47404.41" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1331.5" y="-47389.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1331.5" y="-47374.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1331.5" y="-47359.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer55_up_ar&#45;&gt;layer55_mul_5 -->
<g id="edge1803" class="edge">
<title>layer55_up_ar&#45;&gt;layer55_mul_5</title>
<path fill="none" stroke="black" d="M1151.74,-47655.19C1151.74,-47630.18 1151.74,-47595 1151.74,-47595 1151.74,-47595 1333,-47595 1333,-47595 1333,-47595 1333,-47429.71 1333,-47429.71"/>
<polygon fill="black" stroke="black" points="1336.5,-47429.71 1333,-47419.71 1329.5,-47429.71 1336.5,-47429.71"/>
</g>
<!-- layer55_silu_4&#45;&gt;layer55_mul_4 -->
<g id="edge1800" class="edge">
<title>layer55_silu_4&#45;&gt;layer55_mul_4</title>
<path fill="none" stroke="black" d="M1169.5,-47491.36C1169.5,-47491.36 1169.5,-47429.99 1169.5,-47429.99"/>
<polygon fill="black" stroke="black" points="1173,-47429.99 1169.5,-47419.99 1166,-47429.99 1173,-47429.99"/>
</g>
<!-- layer55_silu_5&#45;&gt;layer55_mul_5 -->
<g id="edge1802" class="edge">
<title>layer55_silu_5&#45;&gt;layer55_mul_5</title>
<path fill="none" stroke="black" d="M1386.5,-47491.36C1386.5,-47491.36 1386.5,-47429.99 1386.5,-47429.99"/>
<polygon fill="black" stroke="black" points="1390,-47429.99 1386.5,-47419.99 1383,-47429.99 1390,-47429.99"/>
</g>
<!-- layer55_ffn_down_4 -->
<g id="node1413" class="node">
<title>layer55_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1204.5,-47279.61 1032.5,-47279.61 1032.5,-47211.61 1204.5,-47211.61 1204.5,-47279.61"/>
<text text-anchor="middle" x="1118.5" y="-47264.41" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1118.5" y="-47249.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1118.5" y="-47234.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1118.5" y="-47219.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer55_mul_4&#45;&gt;layer55_ffn_down_4 -->
<g id="edge1804" class="edge">
<title>layer55_mul_4&#45;&gt;layer55_ffn_down_4</title>
<path fill="none" stroke="black" d="M1118.5,-47351.36C1118.5,-47351.36 1118.5,-47289.99 1118.5,-47289.99"/>
<polygon fill="black" stroke="black" points="1122,-47289.99 1118.5,-47279.99 1115,-47289.99 1122,-47289.99"/>
</g>
<!-- layer55_ffn_down_5 -->
<g id="node1414" class="node">
<title>layer55_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1414.5,-47279.61 1242.5,-47279.61 1242.5,-47211.61 1414.5,-47211.61 1414.5,-47279.61"/>
<text text-anchor="middle" x="1328.5" y="-47264.41" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1328.5" y="-47249.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1328.5" y="-47234.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1328.5" y="-47219.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer55_mul_5&#45;&gt;layer55_ffn_down_5 -->
<g id="edge1805" class="edge">
<title>layer55_mul_5&#45;&gt;layer55_ffn_down_5</title>
<path fill="none" stroke="black" d="M1328.5,-47351.36C1328.5,-47351.36 1328.5,-47289.99 1328.5,-47289.99"/>
<polygon fill="black" stroke="black" points="1332,-47289.99 1328.5,-47279.99 1325,-47289.99 1332,-47289.99"/>
</g>
<!-- layer55_ffn_ar -->
<g id="node1415" class="node">
<title>layer55_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1222.5" cy="-47091.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1222.5" y="-47110.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1222.5" y="-47095.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1222.5" y="-47080.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1222.5" y="-47065.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer55_ffn_down_4&#45;&gt;layer55_ffn_ar -->
<g id="edge1806" class="edge">
<title>layer55_ffn_down_4&#45;&gt;layer55_ffn_ar</title>
<path fill="none" stroke="black" d="M1152.69,-47211.41C1152.69,-47211.41 1152.69,-47141.06 1152.69,-47141.06"/>
<polygon fill="black" stroke="black" points="1156.19,-47141.06 1152.69,-47131.06 1149.19,-47141.06 1156.19,-47141.06"/>
</g>
<!-- layer55_ffn_down_5&#45;&gt;layer55_ffn_ar -->
<g id="edge1807" class="edge">
<title>layer55_ffn_down_5&#45;&gt;layer55_ffn_ar</title>
<path fill="none" stroke="black" d="M1293.31,-47211.41C1293.31,-47211.41 1293.31,-47140.79 1293.31,-47140.79"/>
<polygon fill="black" stroke="black" points="1296.81,-47140.79 1293.31,-47130.79 1289.81,-47140.79 1296.81,-47140.79"/>
</g>
<!-- layer56_norm_4 -->
<g id="node1416" class="node">
<title>layer56_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1204.5,-46971.44 1032.5,-46971.44 1032.5,-46903.44 1204.5,-46903.44 1204.5,-46971.44"/>
<text text-anchor="middle" x="1118.5" y="-46956.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1118.5" y="-46941.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1118.5" y="-46926.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1118.5" y="-46911.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer55_ffn_ar&#45;&gt;layer56_norm_4 -->
<g id="edge1808" class="edge">
<title>layer55_ffn_ar&#45;&gt;layer56_norm_4</title>
<path fill="none" stroke="black" d="M1152.69,-47051.84C1152.69,-47051.84 1152.69,-46981.5 1152.69,-46981.5"/>
<polygon fill="black" stroke="black" points="1156.19,-46981.5 1152.69,-46971.5 1149.19,-46981.5 1156.19,-46981.5"/>
</g>
<!-- layer56_norm_5 -->
<g id="node1417" class="node">
<title>layer56_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1414.5,-46971.44 1242.5,-46971.44 1242.5,-46903.44 1414.5,-46903.44 1414.5,-46971.44"/>
<text text-anchor="middle" x="1328.5" y="-46956.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1328.5" y="-46941.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1328.5" y="-46926.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1328.5" y="-46911.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer55_ffn_ar&#45;&gt;layer56_norm_5 -->
<g id="edge1809" class="edge">
<title>layer55_ffn_ar&#45;&gt;layer56_norm_5</title>
<path fill="none" stroke="black" d="M1293.31,-47052.24C1293.31,-47052.24 1293.31,-46981.67 1293.31,-46981.67"/>
<polygon fill="black" stroke="black" points="1296.81,-46981.67 1293.31,-46971.67 1289.81,-46981.67 1296.81,-46981.67"/>
</g>
<!-- layer56_qkv_4 -->
<g id="node1418" class="node">
<title>layer56_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1205,-46831.44 1024,-46831.44 1024,-46763.44 1205,-46763.44 1205,-46831.44"/>
<text text-anchor="middle" x="1114.5" y="-46816.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1114.5" y="-46801.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1114.5" y="-46786.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1114.5" y="-46771.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer56_norm_4&#45;&gt;layer56_qkv_4 -->
<g id="edge1810" class="edge">
<title>layer56_norm_4&#45;&gt;layer56_qkv_4</title>
<path fill="none" stroke="black" d="M1118.5,-46903.19C1118.5,-46903.19 1118.5,-46841.82 1118.5,-46841.82"/>
<polygon fill="black" stroke="black" points="1122,-46841.82 1118.5,-46831.82 1115,-46841.82 1122,-46841.82"/>
</g>
<!-- layer56_qkv_5 -->
<g id="node1419" class="node">
<title>layer56_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1422,-46831.44 1241,-46831.44 1241,-46763.44 1422,-46763.44 1422,-46831.44"/>
<text text-anchor="middle" x="1331.5" y="-46816.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1331.5" y="-46801.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1331.5" y="-46786.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1331.5" y="-46771.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer56_norm_5&#45;&gt;layer56_qkv_5 -->
<g id="edge1811" class="edge">
<title>layer56_norm_5&#45;&gt;layer56_qkv_5</title>
<path fill="none" stroke="black" d="M1328.5,-46903.19C1328.5,-46903.19 1328.5,-46841.82 1328.5,-46841.82"/>
<polygon fill="black" stroke="black" points="1332,-46841.82 1328.5,-46831.82 1325,-46841.82 1332,-46841.82"/>
</g>
<!-- layer56_qkv_ar -->
<g id="node1420" class="node">
<title>layer56_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1222.5" cy="-46643.36" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1222.5" y="-46662.16" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1222.5" y="-46647.16" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1222.5" y="-46632.16" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1222.5" y="-46617.16" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer56_qkv_4&#45;&gt;layer56_qkv_ar -->
<g id="edge1812" class="edge">
<title>layer56_qkv_4&#45;&gt;layer56_qkv_ar</title>
<path fill="none" stroke="black" d="M1149.76,-46763.24C1149.76,-46763.24 1149.76,-46693.18 1149.76,-46693.18"/>
<polygon fill="black" stroke="black" points="1153.26,-46693.18 1149.76,-46683.18 1146.26,-46693.18 1153.26,-46693.18"/>
</g>
<!-- layer56_qkv_5&#45;&gt;layer56_qkv_ar -->
<g id="edge1813" class="edge">
<title>layer56_qkv_5&#45;&gt;layer56_qkv_ar</title>
<path fill="none" stroke="black" d="M1295.74,-46763.24C1295.74,-46763.24 1295.74,-46692.9 1295.74,-46692.9"/>
<polygon fill="black" stroke="black" points="1299.24,-46692.9 1295.74,-46682.9 1292.24,-46692.9 1299.24,-46692.9"/>
</g>
<!-- layer56_attn_4 -->
<g id="node1421" class="node">
<title>layer56_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1204.5,-46523.27 1032.5,-46523.27 1032.5,-46455.27 1204.5,-46455.27 1204.5,-46523.27"/>
<text text-anchor="middle" x="1118.5" y="-46508.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1118.5" y="-46493.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1118.5" y="-46478.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1118.5" y="-46463.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer56_qkv_ar&#45;&gt;layer56_attn_4 -->
<g id="edge1814" class="edge">
<title>layer56_qkv_ar&#45;&gt;layer56_attn_4</title>
<path fill="none" stroke="black" d="M1149.51,-46603.68C1149.51,-46603.68 1149.51,-46533.33 1149.51,-46533.33"/>
<polygon fill="black" stroke="black" points="1153.01,-46533.33 1149.51,-46523.33 1146.01,-46533.33 1153.01,-46533.33"/>
</g>
<!-- layer56_attn_5 -->
<g id="node1422" class="node">
<title>layer56_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1412.5,-46523.27 1240.5,-46523.27 1240.5,-46455.27 1412.5,-46455.27 1412.5,-46523.27"/>
<text text-anchor="middle" x="1326.5" y="-46508.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1326.5" y="-46493.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1326.5" y="-46478.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1326.5" y="-46463.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer56_qkv_ar&#45;&gt;layer56_attn_5 -->
<g id="edge1815" class="edge">
<title>layer56_qkv_ar&#45;&gt;layer56_attn_5</title>
<path fill="none" stroke="black" d="M1295.49,-46603.68C1295.49,-46603.68 1295.49,-46533.33 1295.49,-46533.33"/>
<polygon fill="black" stroke="black" points="1298.99,-46533.33 1295.49,-46523.33 1291.99,-46533.33 1298.99,-46533.33"/>
</g>
<!-- layer56_attn_out_4 -->
<g id="node1423" class="node">
<title>layer56_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1204.5,-46383.27 1032.5,-46383.27 1032.5,-46315.27 1204.5,-46315.27 1204.5,-46383.27"/>
<text text-anchor="middle" x="1118.5" y="-46368.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1118.5" y="-46353.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1118.5" y="-46338.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1118.5" y="-46323.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer56_attn_4&#45;&gt;layer56_attn_out_4 -->
<g id="edge1816" class="edge">
<title>layer56_attn_4&#45;&gt;layer56_attn_out_4</title>
<path fill="none" stroke="black" d="M1118.5,-46455.02C1118.5,-46455.02 1118.5,-46393.65 1118.5,-46393.65"/>
<polygon fill="black" stroke="black" points="1122,-46393.65 1118.5,-46383.65 1115,-46393.65 1122,-46393.65"/>
</g>
<!-- layer56_attn_out_5 -->
<g id="node1424" class="node">
<title>layer56_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1412.5,-46383.27 1240.5,-46383.27 1240.5,-46315.27 1412.5,-46315.27 1412.5,-46383.27"/>
<text text-anchor="middle" x="1326.5" y="-46368.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1326.5" y="-46353.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1326.5" y="-46338.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1326.5" y="-46323.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer56_attn_5&#45;&gt;layer56_attn_out_5 -->
<g id="edge1817" class="edge">
<title>layer56_attn_5&#45;&gt;layer56_attn_out_5</title>
<path fill="none" stroke="black" d="M1326.5,-46455.02C1326.5,-46455.02 1326.5,-46393.65 1326.5,-46393.65"/>
<polygon fill="black" stroke="black" points="1330,-46393.65 1326.5,-46383.65 1323,-46393.65 1330,-46393.65"/>
</g>
<!-- layer56_attn_ar -->
<g id="node1425" class="node">
<title>layer56_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1222.5" cy="-46195.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1222.5" y="-46213.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1222.5" y="-46198.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1222.5" y="-46183.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1222.5" y="-46168.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer56_attn_out_4&#45;&gt;layer56_attn_ar -->
<g id="edge1818" class="edge">
<title>layer56_attn_out_4&#45;&gt;layer56_attn_ar</title>
<path fill="none" stroke="black" d="M1152.69,-46315.08C1152.69,-46315.08 1152.69,-46244.73 1152.69,-46244.73"/>
<polygon fill="black" stroke="black" points="1156.19,-46244.73 1152.69,-46234.73 1149.19,-46244.73 1156.19,-46244.73"/>
</g>
<!-- layer56_attn_out_5&#45;&gt;layer56_attn_ar -->
<g id="edge1819" class="edge">
<title>layer56_attn_out_5&#45;&gt;layer56_attn_ar</title>
<path fill="none" stroke="black" d="M1292.31,-46315.08C1292.31,-46315.08 1292.31,-46244.73 1292.31,-46244.73"/>
<polygon fill="black" stroke="black" points="1295.81,-46244.73 1292.31,-46234.73 1288.81,-46244.73 1295.81,-46244.73"/>
</g>
<!-- layer56_ffn_norm_4 -->
<g id="node1426" class="node">
<title>layer56_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1200.5,-46075.11 1028.5,-46075.11 1028.5,-46007.11 1200.5,-46007.11 1200.5,-46075.11"/>
<text text-anchor="middle" x="1114.5" y="-46059.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1114.5" y="-46044.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1114.5" y="-46029.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1114.5" y="-46014.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer56_attn_ar&#45;&gt;layer56_ffn_norm_4 -->
<g id="edge1820" class="edge">
<title>layer56_attn_ar&#45;&gt;layer56_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1150.69,-46156.31C1150.69,-46156.31 1150.69,-46085.25 1150.69,-46085.25"/>
<polygon fill="black" stroke="black" points="1154.19,-46085.25 1150.69,-46075.25 1147.19,-46085.25 1154.19,-46085.25"/>
</g>
<!-- layer56_ffn_norm_5 -->
<g id="node1427" class="node">
<title>layer56_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1417.5,-46075.11 1245.5,-46075.11 1245.5,-46007.11 1417.5,-46007.11 1417.5,-46075.11"/>
<text text-anchor="middle" x="1331.5" y="-46059.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1331.5" y="-46044.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1331.5" y="-46029.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1331.5" y="-46014.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer56_attn_ar&#45;&gt;layer56_ffn_norm_5 -->
<g id="edge1821" class="edge">
<title>layer56_attn_ar&#45;&gt;layer56_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1294.81,-46156.31C1294.81,-46156.31 1294.81,-46085.25 1294.81,-46085.25"/>
<polygon fill="black" stroke="black" points="1298.31,-46085.25 1294.81,-46075.25 1291.31,-46085.25 1298.31,-46085.25"/>
</g>
<!-- layer56_ffn_gate_4 -->
<g id="node1428" class="node">
<title>layer56_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1205,-45935.11 1024,-45935.11 1024,-45867.11 1205,-45867.11 1205,-45935.11"/>
<text text-anchor="middle" x="1114.5" y="-45919.91" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1114.5" y="-45904.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1114.5" y="-45889.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1114.5" y="-45874.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_ffn_norm_4&#45;&gt;layer56_ffn_gate_4 -->
<g id="edge1822" class="edge">
<title>layer56_ffn_norm_4&#45;&gt;layer56_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1114.5,-46006.86C1114.5,-46006.86 1114.5,-45945.49 1114.5,-45945.49"/>
<polygon fill="black" stroke="black" points="1118,-45945.49 1114.5,-45935.49 1111,-45945.49 1118,-45945.49"/>
</g>
<!-- layer56_ffn_up_4 -->
<g id="node1430" class="node">
<title>layer56_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="988,-45935.11 807,-45935.11 807,-45867.11 988,-45867.11 988,-45935.11"/>
<text text-anchor="middle" x="897.5" y="-45919.91" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="897.5" y="-45904.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="897.5" y="-45889.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="897.5" y="-45874.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_ffn_norm_4&#45;&gt;layer56_ffn_up_4 -->
<g id="edge1824" class="edge">
<title>layer56_ffn_norm_4&#45;&gt;layer56_ffn_up_4</title>
<path fill="none" stroke="black" d="M1028.31,-46041C988.86,-46041 950.76,-46041 950.76,-46041 950.76,-46041 950.76,-45945.33 950.76,-45945.33"/>
<polygon fill="black" stroke="black" points="954.26,-45945.33 950.76,-45935.33 947.26,-45945.33 954.26,-45945.33"/>
</g>
<!-- layer56_ffn_gate_5 -->
<g id="node1429" class="node">
<title>layer56_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1639,-45935.11 1458,-45935.11 1458,-45867.11 1639,-45867.11 1639,-45935.11"/>
<text text-anchor="middle" x="1548.5" y="-45919.91" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1548.5" y="-45904.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1548.5" y="-45889.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1548.5" y="-45874.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_ffn_norm_5&#45;&gt;layer56_ffn_gate_5 -->
<g id="edge1823" class="edge">
<title>layer56_ffn_norm_5&#45;&gt;layer56_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1417.56,-46041C1456.95,-46041 1495,-46041 1495,-46041 1495,-46041 1495,-45945.33 1495,-45945.33"/>
<polygon fill="black" stroke="black" points="1498.5,-45945.33 1495,-45935.33 1491.5,-45945.33 1498.5,-45945.33"/>
</g>
<!-- layer56_ffn_up_5 -->
<g id="node1431" class="node">
<title>layer56_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1422,-45935.11 1241,-45935.11 1241,-45867.11 1422,-45867.11 1422,-45935.11"/>
<text text-anchor="middle" x="1331.5" y="-45919.91" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1331.5" y="-45904.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1331.5" y="-45889.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1331.5" y="-45874.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_ffn_norm_5&#45;&gt;layer56_ffn_up_5 -->
<g id="edge1825" class="edge">
<title>layer56_ffn_norm_5&#45;&gt;layer56_ffn_up_5</title>
<path fill="none" stroke="black" d="M1331.5,-46006.86C1331.5,-46006.86 1331.5,-45945.49 1331.5,-45945.49"/>
<polygon fill="black" stroke="black" points="1335,-45945.49 1331.5,-45935.49 1328,-45945.49 1335,-45945.49"/>
</g>
<!-- layer56_gate_ar -->
<g id="node1432" class="node">
<title>layer56_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1422.5" cy="-45747.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1422.5" y="-45765.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1422.5" y="-45750.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1422.5" y="-45735.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1422.5" y="-45720.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer56_ffn_gate_4&#45;&gt;layer56_gate_ar -->
<g id="edge1826" class="edge">
<title>layer56_ffn_gate_4&#45;&gt;layer56_gate_ar</title>
<path fill="none" stroke="black" d="M1205.08,-45901C1215.79,-45901 1223,-45901 1223,-45901 1223,-45901 1223,-45763 1223,-45763 1223,-45763 1291.56,-45763 1291.56,-45763"/>
<polygon fill="black" stroke="black" points="1291.56,-45766.5 1301.56,-45763 1291.56,-45759.5 1291.56,-45766.5"/>
</g>
<!-- layer56_ffn_gate_5&#45;&gt;layer56_gate_ar -->
<g id="edge1827" class="edge">
<title>layer56_ffn_gate_5&#45;&gt;layer56_gate_ar</title>
<path fill="none" stroke="black" d="M1504.24,-45866.91C1504.24,-45866.91 1504.24,-45794.09 1504.24,-45794.09"/>
<polygon fill="black" stroke="black" points="1507.74,-45794.09 1504.24,-45784.09 1500.74,-45794.09 1507.74,-45794.09"/>
</g>
<!-- layer56_up_ar -->
<g id="node1433" class="node">
<title>layer56_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1076.5" cy="-45747.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1076.5" y="-45765.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1076.5" y="-45750.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1076.5" y="-45735.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1076.5" y="-45720.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer56_ffn_up_4&#45;&gt;layer56_up_ar -->
<g id="edge1828" class="edge">
<title>layer56_ffn_up_4&#45;&gt;layer56_up_ar</title>
<path fill="none" stroke="black" d="M968.26,-45866.91C968.26,-45866.91 968.26,-45782.99 968.26,-45782.99"/>
<polygon fill="black" stroke="black" points="971.76,-45782.99 968.26,-45772.99 964.76,-45782.99 971.76,-45782.99"/>
</g>
<!-- layer56_ffn_up_5&#45;&gt;layer56_up_ar -->
<g id="edge1829" class="edge">
<title>layer56_ffn_up_5&#45;&gt;layer56_up_ar</title>
<path fill="none" stroke="black" d="M1267.76,-45866.89C1267.76,-45816.96 1267.76,-45730 1267.76,-45730 1267.76,-45730 1206.27,-45730 1206.27,-45730"/>
<polygon fill="black" stroke="black" points="1206.27,-45726.5 1196.27,-45730 1206.27,-45733.5 1206.27,-45726.5"/>
</g>
<!-- layer56_silu_4 -->
<g id="node1434" class="node">
<title>layer56_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1350,-45626.94 1169,-45626.94 1169,-45558.94 1350,-45558.94 1350,-45626.94"/>
<text text-anchor="middle" x="1259.5" y="-45611.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1259.5" y="-45596.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1259.5" y="-45581.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1259.5" y="-45566.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_gate_ar&#45;&gt;layer56_silu_4 -->
<g id="edge1830" class="edge">
<title>layer56_gate_ar&#45;&gt;layer56_silu_4</title>
<path fill="none" stroke="black" d="M1322.26,-45716.95C1322.26,-45716.95 1322.26,-45636.96 1322.26,-45636.96"/>
<polygon fill="black" stroke="black" points="1325.76,-45636.96 1322.26,-45626.96 1318.76,-45636.96 1325.76,-45636.96"/>
</g>
<!-- layer56_silu_5 -->
<g id="node1435" class="node">
<title>layer56_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1567,-45626.94 1386,-45626.94 1386,-45558.94 1567,-45558.94 1567,-45626.94"/>
<text text-anchor="middle" x="1476.5" y="-45611.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1476.5" y="-45596.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1476.5" y="-45581.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1476.5" y="-45566.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_gate_ar&#45;&gt;layer56_silu_5 -->
<g id="edge1831" class="edge">
<title>layer56_gate_ar&#45;&gt;layer56_silu_5</title>
<path fill="none" stroke="black" d="M1468.24,-45702.04C1468.24,-45702.04 1468.24,-45636.95 1468.24,-45636.95"/>
<polygon fill="black" stroke="black" points="1471.74,-45636.95 1468.24,-45626.95 1464.74,-45636.95 1471.74,-45636.95"/>
</g>
<!-- layer56_mul_4 -->
<g id="node1436" class="node">
<title>layer56_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1240,-45486.94 1059,-45486.94 1059,-45418.94 1240,-45418.94 1240,-45486.94"/>
<text text-anchor="middle" x="1149.5" y="-45471.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1149.5" y="-45456.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1149.5" y="-45441.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1149.5" y="-45426.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_up_ar&#45;&gt;layer56_mul_4 -->
<g id="edge1833" class="edge">
<title>layer56_up_ar&#45;&gt;layer56_mul_4</title>
<path fill="none" stroke="black" d="M1114,-45700.75C1114,-45700.75 1114,-45497.02 1114,-45497.02"/>
<polygon fill="black" stroke="black" points="1117.5,-45497.02 1114,-45487.02 1110.5,-45497.02 1117.5,-45497.02"/>
</g>
<!-- layer56_mul_5 -->
<g id="node1437" class="node">
<title>layer56_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1457,-45486.94 1276,-45486.94 1276,-45418.94 1457,-45418.94 1457,-45486.94"/>
<text text-anchor="middle" x="1366.5" y="-45471.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1366.5" y="-45456.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1366.5" y="-45441.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1366.5" y="-45426.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer56_up_ar&#45;&gt;layer56_mul_5 -->
<g id="edge1835" class="edge">
<title>layer56_up_ar&#45;&gt;layer56_mul_5</title>
<path fill="none" stroke="black" d="M1186.74,-45722.43C1186.74,-45697.32 1186.74,-45662 1186.74,-45662 1186.74,-45662 1368,-45662 1368,-45662 1368,-45662 1368,-45496.99 1368,-45496.99"/>
<polygon fill="black" stroke="black" points="1371.5,-45496.99 1368,-45486.99 1364.5,-45496.99 1371.5,-45496.99"/>
</g>
<!-- layer56_silu_4&#45;&gt;layer56_mul_4 -->
<g id="edge1832" class="edge">
<title>layer56_silu_4&#45;&gt;layer56_mul_4</title>
<path fill="none" stroke="black" d="M1204.5,-45558.69C1204.5,-45558.69 1204.5,-45497.32 1204.5,-45497.32"/>
<polygon fill="black" stroke="black" points="1208,-45497.32 1204.5,-45487.32 1201,-45497.32 1208,-45497.32"/>
</g>
<!-- layer56_silu_5&#45;&gt;layer56_mul_5 -->
<g id="edge1834" class="edge">
<title>layer56_silu_5&#45;&gt;layer56_mul_5</title>
<path fill="none" stroke="black" d="M1421.5,-45558.69C1421.5,-45558.69 1421.5,-45497.32 1421.5,-45497.32"/>
<polygon fill="black" stroke="black" points="1425,-45497.32 1421.5,-45487.32 1418,-45497.32 1425,-45497.32"/>
</g>
<!-- layer56_ffn_down_4 -->
<g id="node1438" class="node">
<title>layer56_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1239.5,-45346.94 1067.5,-45346.94 1067.5,-45278.94 1239.5,-45278.94 1239.5,-45346.94"/>
<text text-anchor="middle" x="1153.5" y="-45331.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1153.5" y="-45316.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1153.5" y="-45301.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1153.5" y="-45286.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer56_mul_4&#45;&gt;layer56_ffn_down_4 -->
<g id="edge1836" class="edge">
<title>layer56_mul_4&#45;&gt;layer56_ffn_down_4</title>
<path fill="none" stroke="black" d="M1153.5,-45418.69C1153.5,-45418.69 1153.5,-45357.32 1153.5,-45357.32"/>
<polygon fill="black" stroke="black" points="1157,-45357.32 1153.5,-45347.32 1150,-45357.32 1157,-45357.32"/>
</g>
<!-- layer56_ffn_down_5 -->
<g id="node1439" class="node">
<title>layer56_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1449.5,-45346.94 1277.5,-45346.94 1277.5,-45278.94 1449.5,-45278.94 1449.5,-45346.94"/>
<text text-anchor="middle" x="1363.5" y="-45331.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1363.5" y="-45316.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1363.5" y="-45301.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1363.5" y="-45286.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer56_mul_5&#45;&gt;layer56_ffn_down_5 -->
<g id="edge1837" class="edge">
<title>layer56_mul_5&#45;&gt;layer56_ffn_down_5</title>
<path fill="none" stroke="black" d="M1363.5,-45418.69C1363.5,-45418.69 1363.5,-45357.32 1363.5,-45357.32"/>
<polygon fill="black" stroke="black" points="1367,-45357.32 1363.5,-45347.32 1360,-45357.32 1367,-45357.32"/>
</g>
<!-- layer56_ffn_ar -->
<g id="node1440" class="node">
<title>layer56_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1257.5" cy="-45158.86" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1257.5" y="-45177.66" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1257.5" y="-45162.66" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1257.5" y="-45147.66" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1257.5" y="-45132.66" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer56_ffn_down_4&#45;&gt;layer56_ffn_ar -->
<g id="edge1838" class="edge">
<title>layer56_ffn_down_4&#45;&gt;layer56_ffn_ar</title>
<path fill="none" stroke="black" d="M1187.69,-45278.74C1187.69,-45278.74 1187.69,-45208.4 1187.69,-45208.4"/>
<polygon fill="black" stroke="black" points="1191.19,-45208.4 1187.69,-45198.4 1184.19,-45208.4 1191.19,-45208.4"/>
</g>
<!-- layer56_ffn_down_5&#45;&gt;layer56_ffn_ar -->
<g id="edge1839" class="edge">
<title>layer56_ffn_down_5&#45;&gt;layer56_ffn_ar</title>
<path fill="none" stroke="black" d="M1328.31,-45278.74C1328.31,-45278.74 1328.31,-45208.12 1328.31,-45208.12"/>
<polygon fill="black" stroke="black" points="1331.81,-45208.12 1328.31,-45198.12 1324.81,-45208.12 1331.81,-45208.12"/>
</g>
<!-- layer57_norm_4 -->
<g id="node1441" class="node">
<title>layer57_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1239.5,-45038.77 1067.5,-45038.77 1067.5,-44970.77 1239.5,-44970.77 1239.5,-45038.77"/>
<text text-anchor="middle" x="1153.5" y="-45023.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1153.5" y="-45008.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1153.5" y="-44993.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1153.5" y="-44978.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer56_ffn_ar&#45;&gt;layer57_norm_4 -->
<g id="edge1840" class="edge">
<title>layer56_ffn_ar&#45;&gt;layer57_norm_4</title>
<path fill="none" stroke="black" d="M1187.69,-45119.18C1187.69,-45119.18 1187.69,-45048.83 1187.69,-45048.83"/>
<polygon fill="black" stroke="black" points="1191.19,-45048.83 1187.69,-45038.83 1184.19,-45048.83 1191.19,-45048.83"/>
</g>
<!-- layer57_norm_5 -->
<g id="node1442" class="node">
<title>layer57_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1449.5,-45038.77 1277.5,-45038.77 1277.5,-44970.77 1449.5,-44970.77 1449.5,-45038.77"/>
<text text-anchor="middle" x="1363.5" y="-45023.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1363.5" y="-45008.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1363.5" y="-44993.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1363.5" y="-44978.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer56_ffn_ar&#45;&gt;layer57_norm_5 -->
<g id="edge1841" class="edge">
<title>layer56_ffn_ar&#45;&gt;layer57_norm_5</title>
<path fill="none" stroke="black" d="M1328.31,-45119.58C1328.31,-45119.58 1328.31,-45049 1328.31,-45049"/>
<polygon fill="black" stroke="black" points="1331.81,-45049 1328.31,-45039 1324.81,-45049 1331.81,-45049"/>
</g>
<!-- layer57_qkv_4 -->
<g id="node1443" class="node">
<title>layer57_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1240,-44898.77 1059,-44898.77 1059,-44830.77 1240,-44830.77 1240,-44898.77"/>
<text text-anchor="middle" x="1149.5" y="-44883.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1149.5" y="-44868.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1149.5" y="-44853.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1149.5" y="-44838.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer57_norm_4&#45;&gt;layer57_qkv_4 -->
<g id="edge1842" class="edge">
<title>layer57_norm_4&#45;&gt;layer57_qkv_4</title>
<path fill="none" stroke="black" d="M1153.5,-44970.53C1153.5,-44970.53 1153.5,-44909.15 1153.5,-44909.15"/>
<polygon fill="black" stroke="black" points="1157,-44909.15 1153.5,-44899.15 1150,-44909.15 1157,-44909.15"/>
</g>
<!-- layer57_qkv_5 -->
<g id="node1444" class="node">
<title>layer57_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1457,-44898.77 1276,-44898.77 1276,-44830.77 1457,-44830.77 1457,-44898.77"/>
<text text-anchor="middle" x="1366.5" y="-44883.57" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1366.5" y="-44868.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1366.5" y="-44853.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1366.5" y="-44838.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer57_norm_5&#45;&gt;layer57_qkv_5 -->
<g id="edge1843" class="edge">
<title>layer57_norm_5&#45;&gt;layer57_qkv_5</title>
<path fill="none" stroke="black" d="M1363.5,-44970.53C1363.5,-44970.53 1363.5,-44909.15 1363.5,-44909.15"/>
<polygon fill="black" stroke="black" points="1367,-44909.15 1363.5,-44899.15 1360,-44909.15 1367,-44909.15"/>
</g>
<!-- layer57_qkv_ar -->
<g id="node1445" class="node">
<title>layer57_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1257.5" cy="-44710.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1257.5" y="-44729.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1257.5" y="-44714.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1257.5" y="-44699.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1257.5" y="-44684.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer57_qkv_4&#45;&gt;layer57_qkv_ar -->
<g id="edge1844" class="edge">
<title>layer57_qkv_4&#45;&gt;layer57_qkv_ar</title>
<path fill="none" stroke="black" d="M1184.76,-44830.58C1184.76,-44830.58 1184.76,-44760.51 1184.76,-44760.51"/>
<polygon fill="black" stroke="black" points="1188.26,-44760.51 1184.76,-44750.51 1181.26,-44760.51 1188.26,-44760.51"/>
</g>
<!-- layer57_qkv_5&#45;&gt;layer57_qkv_ar -->
<g id="edge1845" class="edge">
<title>layer57_qkv_5&#45;&gt;layer57_qkv_ar</title>
<path fill="none" stroke="black" d="M1330.74,-44830.58C1330.74,-44830.58 1330.74,-44760.23 1330.74,-44760.23"/>
<polygon fill="black" stroke="black" points="1334.24,-44760.23 1330.74,-44750.23 1327.24,-44760.23 1334.24,-44760.23"/>
</g>
<!-- layer57_attn_4 -->
<g id="node1446" class="node">
<title>layer57_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1239.5,-44590.61 1067.5,-44590.61 1067.5,-44522.61 1239.5,-44522.61 1239.5,-44590.61"/>
<text text-anchor="middle" x="1153.5" y="-44575.41" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1153.5" y="-44560.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1153.5" y="-44545.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1153.5" y="-44530.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer57_qkv_ar&#45;&gt;layer57_attn_4 -->
<g id="edge1846" class="edge">
<title>layer57_qkv_ar&#45;&gt;layer57_attn_4</title>
<path fill="none" stroke="black" d="M1184.51,-44671.01C1184.51,-44671.01 1184.51,-44600.66 1184.51,-44600.66"/>
<polygon fill="black" stroke="black" points="1188.01,-44600.66 1184.51,-44590.66 1181.01,-44600.66 1188.01,-44600.66"/>
</g>
<!-- layer57_attn_5 -->
<g id="node1447" class="node">
<title>layer57_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1447.5,-44590.61 1275.5,-44590.61 1275.5,-44522.61 1447.5,-44522.61 1447.5,-44590.61"/>
<text text-anchor="middle" x="1361.5" y="-44575.41" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1361.5" y="-44560.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1361.5" y="-44545.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1361.5" y="-44530.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer57_qkv_ar&#45;&gt;layer57_attn_5 -->
<g id="edge1847" class="edge">
<title>layer57_qkv_ar&#45;&gt;layer57_attn_5</title>
<path fill="none" stroke="black" d="M1330.49,-44671.01C1330.49,-44671.01 1330.49,-44600.66 1330.49,-44600.66"/>
<polygon fill="black" stroke="black" points="1333.99,-44600.66 1330.49,-44590.66 1326.99,-44600.66 1333.99,-44600.66"/>
</g>
<!-- layer57_attn_out_4 -->
<g id="node1448" class="node">
<title>layer57_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1239.5,-44450.61 1067.5,-44450.61 1067.5,-44382.61 1239.5,-44382.61 1239.5,-44450.61"/>
<text text-anchor="middle" x="1153.5" y="-44435.41" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1153.5" y="-44420.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1153.5" y="-44405.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1153.5" y="-44390.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer57_attn_4&#45;&gt;layer57_attn_out_4 -->
<g id="edge1848" class="edge">
<title>layer57_attn_4&#45;&gt;layer57_attn_out_4</title>
<path fill="none" stroke="black" d="M1153.5,-44522.36C1153.5,-44522.36 1153.5,-44460.99 1153.5,-44460.99"/>
<polygon fill="black" stroke="black" points="1157,-44460.99 1153.5,-44450.99 1150,-44460.99 1157,-44460.99"/>
</g>
<!-- layer57_attn_out_5 -->
<g id="node1449" class="node">
<title>layer57_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1447.5,-44450.61 1275.5,-44450.61 1275.5,-44382.61 1447.5,-44382.61 1447.5,-44450.61"/>
<text text-anchor="middle" x="1361.5" y="-44435.41" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1361.5" y="-44420.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1361.5" y="-44405.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1361.5" y="-44390.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer57_attn_5&#45;&gt;layer57_attn_out_5 -->
<g id="edge1849" class="edge">
<title>layer57_attn_5&#45;&gt;layer57_attn_out_5</title>
<path fill="none" stroke="black" d="M1361.5,-44522.36C1361.5,-44522.36 1361.5,-44460.99 1361.5,-44460.99"/>
<polygon fill="black" stroke="black" points="1365,-44460.99 1361.5,-44450.99 1358,-44460.99 1365,-44460.99"/>
</g>
<!-- layer57_attn_ar -->
<g id="node1450" class="node">
<title>layer57_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1257.5" cy="-44262.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1257.5" y="-44281.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1257.5" y="-44266.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1257.5" y="-44251.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1257.5" y="-44236.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer57_attn_out_4&#45;&gt;layer57_attn_ar -->
<g id="edge1850" class="edge">
<title>layer57_attn_out_4&#45;&gt;layer57_attn_ar</title>
<path fill="none" stroke="black" d="M1187.69,-44382.41C1187.69,-44382.41 1187.69,-44312.07 1187.69,-44312.07"/>
<polygon fill="black" stroke="black" points="1191.19,-44312.07 1187.69,-44302.07 1184.19,-44312.07 1191.19,-44312.07"/>
</g>
<!-- layer57_attn_out_5&#45;&gt;layer57_attn_ar -->
<g id="edge1851" class="edge">
<title>layer57_attn_out_5&#45;&gt;layer57_attn_ar</title>
<path fill="none" stroke="black" d="M1327.31,-44382.41C1327.31,-44382.41 1327.31,-44312.07 1327.31,-44312.07"/>
<polygon fill="black" stroke="black" points="1330.81,-44312.07 1327.31,-44302.07 1323.81,-44312.07 1330.81,-44312.07"/>
</g>
<!-- layer57_ffn_norm_4 -->
<g id="node1451" class="node">
<title>layer57_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1235.5,-44142.44 1063.5,-44142.44 1063.5,-44074.44 1235.5,-44074.44 1235.5,-44142.44"/>
<text text-anchor="middle" x="1149.5" y="-44127.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1149.5" y="-44112.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1149.5" y="-44097.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1149.5" y="-44082.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer57_attn_ar&#45;&gt;layer57_ffn_norm_4 -->
<g id="edge1852" class="edge">
<title>layer57_attn_ar&#45;&gt;layer57_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1185.69,-44223.64C1185.69,-44223.64 1185.69,-44152.59 1185.69,-44152.59"/>
<polygon fill="black" stroke="black" points="1189.19,-44152.59 1185.69,-44142.59 1182.19,-44152.59 1189.19,-44152.59"/>
</g>
<!-- layer57_ffn_norm_5 -->
<g id="node1452" class="node">
<title>layer57_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1452.5,-44142.44 1280.5,-44142.44 1280.5,-44074.44 1452.5,-44074.44 1452.5,-44142.44"/>
<text text-anchor="middle" x="1366.5" y="-44127.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1366.5" y="-44112.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1366.5" y="-44097.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1366.5" y="-44082.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer57_attn_ar&#45;&gt;layer57_ffn_norm_5 -->
<g id="edge1853" class="edge">
<title>layer57_attn_ar&#45;&gt;layer57_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1329.81,-44223.64C1329.81,-44223.64 1329.81,-44152.59 1329.81,-44152.59"/>
<polygon fill="black" stroke="black" points="1333.31,-44152.59 1329.81,-44142.59 1326.31,-44152.59 1333.31,-44152.59"/>
</g>
<!-- layer57_ffn_gate_4 -->
<g id="node1453" class="node">
<title>layer57_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1240,-44002.44 1059,-44002.44 1059,-43934.44 1240,-43934.44 1240,-44002.44"/>
<text text-anchor="middle" x="1149.5" y="-43987.24" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1149.5" y="-43972.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1149.5" y="-43957.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1149.5" y="-43942.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_ffn_norm_4&#45;&gt;layer57_ffn_gate_4 -->
<g id="edge1854" class="edge">
<title>layer57_ffn_norm_4&#45;&gt;layer57_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1149.5,-44074.19C1149.5,-44074.19 1149.5,-44012.82 1149.5,-44012.82"/>
<polygon fill="black" stroke="black" points="1153,-44012.82 1149.5,-44002.82 1146,-44012.82 1153,-44012.82"/>
</g>
<!-- layer57_ffn_up_4 -->
<g id="node1455" class="node">
<title>layer57_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1023,-44002.44 842,-44002.44 842,-43934.44 1023,-43934.44 1023,-44002.44"/>
<text text-anchor="middle" x="932.5" y="-43987.24" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="932.5" y="-43972.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="932.5" y="-43957.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="932.5" y="-43942.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_ffn_norm_4&#45;&gt;layer57_ffn_up_4 -->
<g id="edge1856" class="edge">
<title>layer57_ffn_norm_4&#45;&gt;layer57_ffn_up_4</title>
<path fill="none" stroke="black" d="M1063.31,-44108C1023.86,-44108 985.76,-44108 985.76,-44108 985.76,-44108 985.76,-44012.58 985.76,-44012.58"/>
<polygon fill="black" stroke="black" points="989.26,-44012.58 985.76,-44002.58 982.26,-44012.58 989.26,-44012.58"/>
</g>
<!-- layer57_ffn_gate_5 -->
<g id="node1454" class="node">
<title>layer57_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1674,-44002.44 1493,-44002.44 1493,-43934.44 1674,-43934.44 1674,-44002.44"/>
<text text-anchor="middle" x="1583.5" y="-43987.24" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1583.5" y="-43972.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1583.5" y="-43957.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1583.5" y="-43942.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_ffn_norm_5&#45;&gt;layer57_ffn_gate_5 -->
<g id="edge1855" class="edge">
<title>layer57_ffn_norm_5&#45;&gt;layer57_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1452.56,-44108C1491.95,-44108 1530,-44108 1530,-44108 1530,-44108 1530,-44012.58 1530,-44012.58"/>
<polygon fill="black" stroke="black" points="1533.5,-44012.58 1530,-44002.58 1526.5,-44012.58 1533.5,-44012.58"/>
</g>
<!-- layer57_ffn_up_5 -->
<g id="node1456" class="node">
<title>layer57_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1457,-44002.44 1276,-44002.44 1276,-43934.44 1457,-43934.44 1457,-44002.44"/>
<text text-anchor="middle" x="1366.5" y="-43987.24" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1366.5" y="-43972.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1366.5" y="-43957.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1366.5" y="-43942.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_ffn_norm_5&#45;&gt;layer57_ffn_up_5 -->
<g id="edge1857" class="edge">
<title>layer57_ffn_norm_5&#45;&gt;layer57_ffn_up_5</title>
<path fill="none" stroke="black" d="M1366.5,-44074.19C1366.5,-44074.19 1366.5,-44012.82 1366.5,-44012.82"/>
<polygon fill="black" stroke="black" points="1370,-44012.82 1366.5,-44002.82 1363,-44012.82 1370,-44012.82"/>
</g>
<!-- layer57_gate_ar -->
<g id="node1457" class="node">
<title>layer57_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1457.5" cy="-43814.36" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1457.5" y="-43833.16" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1457.5" y="-43818.16" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1457.5" y="-43803.16" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1457.5" y="-43788.16" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer57_ffn_gate_4&#45;&gt;layer57_gate_ar -->
<g id="edge1858" class="edge">
<title>layer57_ffn_gate_4&#45;&gt;layer57_gate_ar</title>
<path fill="none" stroke="black" d="M1240.08,-43968C1250.79,-43968 1258,-43968 1258,-43968 1258,-43968 1258,-43830 1258,-43830 1258,-43830 1326.28,-43830 1326.28,-43830"/>
<polygon fill="black" stroke="black" points="1326.28,-43833.5 1336.28,-43830 1326.28,-43826.5 1326.28,-43833.5"/>
</g>
<!-- layer57_ffn_gate_5&#45;&gt;layer57_gate_ar -->
<g id="edge1859" class="edge">
<title>layer57_ffn_gate_5&#45;&gt;layer57_gate_ar</title>
<path fill="none" stroke="black" d="M1539.24,-43934.24C1539.24,-43934.24 1539.24,-43861.42 1539.24,-43861.42"/>
<polygon fill="black" stroke="black" points="1542.74,-43861.42 1539.24,-43851.42 1535.74,-43861.42 1542.74,-43861.42"/>
</g>
<!-- layer57_up_ar -->
<g id="node1458" class="node">
<title>layer57_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1111.5" cy="-43814.36" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1111.5" y="-43833.16" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1111.5" y="-43818.16" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1111.5" y="-43803.16" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1111.5" y="-43788.16" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer57_ffn_up_4&#45;&gt;layer57_up_ar -->
<g id="edge1860" class="edge">
<title>layer57_ffn_up_4&#45;&gt;layer57_up_ar</title>
<path fill="none" stroke="black" d="M1003.26,-43934.24C1003.26,-43934.24 1003.26,-43850.32 1003.26,-43850.32"/>
<polygon fill="black" stroke="black" points="1006.76,-43850.32 1003.26,-43840.32 999.76,-43850.32 1006.76,-43850.32"/>
</g>
<!-- layer57_ffn_up_5&#45;&gt;layer57_up_ar -->
<g id="edge1861" class="edge">
<title>layer57_ffn_up_5&#45;&gt;layer57_up_ar</title>
<path fill="none" stroke="black" d="M1302.76,-43934.36C1302.76,-43884.62 1302.76,-43798 1302.76,-43798 1302.76,-43798 1242.08,-43798 1242.08,-43798"/>
<polygon fill="black" stroke="black" points="1242.08,-43794.5 1232.08,-43798 1242.08,-43801.5 1242.08,-43794.5"/>
</g>
<!-- layer57_silu_4 -->
<g id="node1459" class="node">
<title>layer57_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1385,-43694.27 1204,-43694.27 1204,-43626.27 1385,-43626.27 1385,-43694.27"/>
<text text-anchor="middle" x="1294.5" y="-43679.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1294.5" y="-43664.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1294.5" y="-43649.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1294.5" y="-43634.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_gate_ar&#45;&gt;layer57_silu_4 -->
<g id="edge1862" class="edge">
<title>layer57_gate_ar&#45;&gt;layer57_silu_4</title>
<path fill="none" stroke="black" d="M1357.26,-43784.28C1357.26,-43784.28 1357.26,-43704.3 1357.26,-43704.3"/>
<polygon fill="black" stroke="black" points="1360.76,-43704.3 1357.26,-43694.3 1353.76,-43704.3 1360.76,-43704.3"/>
</g>
<!-- layer57_silu_5 -->
<g id="node1460" class="node">
<title>layer57_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1602,-43694.27 1421,-43694.27 1421,-43626.27 1602,-43626.27 1602,-43694.27"/>
<text text-anchor="middle" x="1511.5" y="-43679.07" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1511.5" y="-43664.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1511.5" y="-43649.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1511.5" y="-43634.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_gate_ar&#45;&gt;layer57_silu_5 -->
<g id="edge1863" class="edge">
<title>layer57_gate_ar&#45;&gt;layer57_silu_5</title>
<path fill="none" stroke="black" d="M1503.24,-43769.38C1503.24,-43769.38 1503.24,-43704.28 1503.24,-43704.28"/>
<polygon fill="black" stroke="black" points="1506.74,-43704.28 1503.24,-43694.28 1499.74,-43704.28 1506.74,-43704.28"/>
</g>
<!-- layer57_mul_4 -->
<g id="node1461" class="node">
<title>layer57_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1275,-43554.27 1094,-43554.27 1094,-43486.27 1275,-43486.27 1275,-43554.27"/>
<text text-anchor="middle" x="1184.5" y="-43539.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1184.5" y="-43524.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1184.5" y="-43509.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1184.5" y="-43494.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_up_ar&#45;&gt;layer57_mul_4 -->
<g id="edge1865" class="edge">
<title>layer57_up_ar&#45;&gt;layer57_mul_4</title>
<path fill="none" stroke="black" d="M1149,-43768.08C1149,-43768.08 1149,-43564.36 1149,-43564.36"/>
<polygon fill="black" stroke="black" points="1152.5,-43564.36 1149,-43554.36 1145.5,-43564.36 1152.5,-43564.36"/>
</g>
<!-- layer57_mul_5 -->
<g id="node1462" class="node">
<title>layer57_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1492,-43554.27 1311,-43554.27 1311,-43486.27 1492,-43486.27 1492,-43554.27"/>
<text text-anchor="middle" x="1401.5" y="-43539.07" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1401.5" y="-43524.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1401.5" y="-43509.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1401.5" y="-43494.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer57_up_ar&#45;&gt;layer57_mul_5 -->
<g id="edge1867" class="edge">
<title>layer57_up_ar&#45;&gt;layer57_mul_5</title>
<path fill="none" stroke="black" d="M1221.74,-43789.5C1221.74,-43764.62 1221.74,-43730 1221.74,-43730 1221.74,-43730 1403,-43730 1403,-43730 1403,-43730 1403,-43564.44 1403,-43564.44"/>
<polygon fill="black" stroke="black" points="1406.5,-43564.44 1403,-43554.44 1399.5,-43564.44 1406.5,-43564.44"/>
</g>
<!-- layer57_silu_4&#45;&gt;layer57_mul_4 -->
<g id="edge1864" class="edge">
<title>layer57_silu_4&#45;&gt;layer57_mul_4</title>
<path fill="none" stroke="black" d="M1239.5,-43626.03C1239.5,-43626.03 1239.5,-43564.65 1239.5,-43564.65"/>
<polygon fill="black" stroke="black" points="1243,-43564.65 1239.5,-43554.65 1236,-43564.65 1243,-43564.65"/>
</g>
<!-- layer57_silu_5&#45;&gt;layer57_mul_5 -->
<g id="edge1866" class="edge">
<title>layer57_silu_5&#45;&gt;layer57_mul_5</title>
<path fill="none" stroke="black" d="M1456.5,-43626.03C1456.5,-43626.03 1456.5,-43564.65 1456.5,-43564.65"/>
<polygon fill="black" stroke="black" points="1460,-43564.65 1456.5,-43554.65 1453,-43564.65 1460,-43564.65"/>
</g>
<!-- layer57_ffn_down_4 -->
<g id="node1463" class="node">
<title>layer57_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1274.5,-43414.27 1102.5,-43414.27 1102.5,-43346.27 1274.5,-43346.27 1274.5,-43414.27"/>
<text text-anchor="middle" x="1188.5" y="-43399.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1188.5" y="-43384.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1188.5" y="-43369.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1188.5" y="-43354.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer57_mul_4&#45;&gt;layer57_ffn_down_4 -->
<g id="edge1868" class="edge">
<title>layer57_mul_4&#45;&gt;layer57_ffn_down_4</title>
<path fill="none" stroke="black" d="M1188.5,-43486.03C1188.5,-43486.03 1188.5,-43424.65 1188.5,-43424.65"/>
<polygon fill="black" stroke="black" points="1192,-43424.65 1188.5,-43414.65 1185,-43424.65 1192,-43424.65"/>
</g>
<!-- layer57_ffn_down_5 -->
<g id="node1464" class="node">
<title>layer57_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1484.5,-43414.27 1312.5,-43414.27 1312.5,-43346.27 1484.5,-43346.27 1484.5,-43414.27"/>
<text text-anchor="middle" x="1398.5" y="-43399.07" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1398.5" y="-43384.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1398.5" y="-43369.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1398.5" y="-43354.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer57_mul_5&#45;&gt;layer57_ffn_down_5 -->
<g id="edge1869" class="edge">
<title>layer57_mul_5&#45;&gt;layer57_ffn_down_5</title>
<path fill="none" stroke="black" d="M1398.5,-43486.03C1398.5,-43486.03 1398.5,-43424.65 1398.5,-43424.65"/>
<polygon fill="black" stroke="black" points="1402,-43424.65 1398.5,-43414.65 1395,-43424.65 1402,-43424.65"/>
</g>
<!-- layer57_ffn_ar -->
<g id="node1465" class="node">
<title>layer57_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1292.5" cy="-43226.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1292.5" y="-43244.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1292.5" y="-43229.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1292.5" y="-43214.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1292.5" y="-43199.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer57_ffn_down_4&#45;&gt;layer57_ffn_ar -->
<g id="edge1870" class="edge">
<title>layer57_ffn_down_4&#45;&gt;layer57_ffn_ar</title>
<path fill="none" stroke="black" d="M1222.69,-43346.08C1222.69,-43346.08 1222.69,-43275.73 1222.69,-43275.73"/>
<polygon fill="black" stroke="black" points="1226.19,-43275.73 1222.69,-43265.73 1219.19,-43275.73 1226.19,-43275.73"/>
</g>
<!-- layer57_ffn_down_5&#45;&gt;layer57_ffn_ar -->
<g id="edge1871" class="edge">
<title>layer57_ffn_down_5&#45;&gt;layer57_ffn_ar</title>
<path fill="none" stroke="black" d="M1363.31,-43346.08C1363.31,-43346.08 1363.31,-43275.45 1363.31,-43275.45"/>
<polygon fill="black" stroke="black" points="1366.81,-43275.45 1363.31,-43265.45 1359.81,-43275.45 1366.81,-43275.45"/>
</g>
<!-- layer58_norm_4 -->
<g id="node1466" class="node">
<title>layer58_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1274.5,-43106.11 1102.5,-43106.11 1102.5,-43038.11 1274.5,-43038.11 1274.5,-43106.11"/>
<text text-anchor="middle" x="1188.5" y="-43090.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1188.5" y="-43075.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1188.5" y="-43060.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1188.5" y="-43045.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer57_ffn_ar&#45;&gt;layer58_norm_4 -->
<g id="edge1872" class="edge">
<title>layer57_ffn_ar&#45;&gt;layer58_norm_4</title>
<path fill="none" stroke="black" d="M1222.69,-43186.51C1222.69,-43186.51 1222.69,-43116.16 1222.69,-43116.16"/>
<polygon fill="black" stroke="black" points="1226.19,-43116.16 1222.69,-43106.16 1219.19,-43116.16 1226.19,-43116.16"/>
</g>
<!-- layer58_norm_5 -->
<g id="node1467" class="node">
<title>layer58_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1484.5,-43106.11 1312.5,-43106.11 1312.5,-43038.11 1484.5,-43038.11 1484.5,-43106.11"/>
<text text-anchor="middle" x="1398.5" y="-43090.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1398.5" y="-43075.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1398.5" y="-43060.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1398.5" y="-43045.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer57_ffn_ar&#45;&gt;layer58_norm_5 -->
<g id="edge1873" class="edge">
<title>layer57_ffn_ar&#45;&gt;layer58_norm_5</title>
<path fill="none" stroke="black" d="M1363.31,-43186.91C1363.31,-43186.91 1363.31,-43116.34 1363.31,-43116.34"/>
<polygon fill="black" stroke="black" points="1366.81,-43116.34 1363.31,-43106.34 1359.81,-43116.34 1366.81,-43116.34"/>
</g>
<!-- layer58_qkv_4 -->
<g id="node1468" class="node">
<title>layer58_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1275,-42966.11 1094,-42966.11 1094,-42898.11 1275,-42898.11 1275,-42966.11"/>
<text text-anchor="middle" x="1184.5" y="-42950.91" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1184.5" y="-42935.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1184.5" y="-42920.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1184.5" y="-42905.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer58_norm_4&#45;&gt;layer58_qkv_4 -->
<g id="edge1874" class="edge">
<title>layer58_norm_4&#45;&gt;layer58_qkv_4</title>
<path fill="none" stroke="black" d="M1188.5,-43037.86C1188.5,-43037.86 1188.5,-42976.49 1188.5,-42976.49"/>
<polygon fill="black" stroke="black" points="1192,-42976.49 1188.5,-42966.49 1185,-42976.49 1192,-42976.49"/>
</g>
<!-- layer58_qkv_5 -->
<g id="node1469" class="node">
<title>layer58_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1492,-42966.11 1311,-42966.11 1311,-42898.11 1492,-42898.11 1492,-42966.11"/>
<text text-anchor="middle" x="1401.5" y="-42950.91" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1401.5" y="-42935.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1401.5" y="-42920.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1401.5" y="-42905.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer58_norm_5&#45;&gt;layer58_qkv_5 -->
<g id="edge1875" class="edge">
<title>layer58_norm_5&#45;&gt;layer58_qkv_5</title>
<path fill="none" stroke="black" d="M1398.5,-43037.86C1398.5,-43037.86 1398.5,-42976.49 1398.5,-42976.49"/>
<polygon fill="black" stroke="black" points="1402,-42976.49 1398.5,-42966.49 1395,-42976.49 1402,-42976.49"/>
</g>
<!-- layer58_qkv_ar -->
<g id="node1470" class="node">
<title>layer58_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1292.5" cy="-42778.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1292.5" y="-42796.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1292.5" y="-42781.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1292.5" y="-42766.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1292.5" y="-42751.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer58_qkv_4&#45;&gt;layer58_qkv_ar -->
<g id="edge1876" class="edge">
<title>layer58_qkv_4&#45;&gt;layer58_qkv_ar</title>
<path fill="none" stroke="black" d="M1219.76,-42897.91C1219.76,-42897.91 1219.76,-42827.84 1219.76,-42827.84"/>
<polygon fill="black" stroke="black" points="1223.26,-42827.84 1219.76,-42817.84 1216.26,-42827.84 1223.26,-42827.84"/>
</g>
<!-- layer58_qkv_5&#45;&gt;layer58_qkv_ar -->
<g id="edge1877" class="edge">
<title>layer58_qkv_5&#45;&gt;layer58_qkv_ar</title>
<path fill="none" stroke="black" d="M1365.74,-42897.91C1365.74,-42897.91 1365.74,-42827.57 1365.74,-42827.57"/>
<polygon fill="black" stroke="black" points="1369.24,-42827.57 1365.74,-42817.57 1362.24,-42827.57 1369.24,-42827.57"/>
</g>
<!-- layer58_attn_4 -->
<g id="node1471" class="node">
<title>layer58_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1274.5,-42657.94 1102.5,-42657.94 1102.5,-42589.94 1274.5,-42589.94 1274.5,-42657.94"/>
<text text-anchor="middle" x="1188.5" y="-42642.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1188.5" y="-42627.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1188.5" y="-42612.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1188.5" y="-42597.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer58_qkv_ar&#45;&gt;layer58_attn_4 -->
<g id="edge1878" class="edge">
<title>layer58_qkv_ar&#45;&gt;layer58_attn_4</title>
<path fill="none" stroke="black" d="M1219.51,-42738.34C1219.51,-42738.34 1219.51,-42668 1219.51,-42668"/>
<polygon fill="black" stroke="black" points="1223.01,-42668 1219.51,-42658 1216.01,-42668 1223.01,-42668"/>
</g>
<!-- layer58_attn_5 -->
<g id="node1472" class="node">
<title>layer58_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1482.5,-42657.94 1310.5,-42657.94 1310.5,-42589.94 1482.5,-42589.94 1482.5,-42657.94"/>
<text text-anchor="middle" x="1396.5" y="-42642.74" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1396.5" y="-42627.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1396.5" y="-42612.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1396.5" y="-42597.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer58_qkv_ar&#45;&gt;layer58_attn_5 -->
<g id="edge1879" class="edge">
<title>layer58_qkv_ar&#45;&gt;layer58_attn_5</title>
<path fill="none" stroke="black" d="M1365.49,-42738.34C1365.49,-42738.34 1365.49,-42668 1365.49,-42668"/>
<polygon fill="black" stroke="black" points="1368.99,-42668 1365.49,-42658 1361.99,-42668 1368.99,-42668"/>
</g>
<!-- layer58_attn_out_4 -->
<g id="node1473" class="node">
<title>layer58_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1274.5,-42517.94 1102.5,-42517.94 1102.5,-42449.94 1274.5,-42449.94 1274.5,-42517.94"/>
<text text-anchor="middle" x="1188.5" y="-42502.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1188.5" y="-42487.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1188.5" y="-42472.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1188.5" y="-42457.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer58_attn_4&#45;&gt;layer58_attn_out_4 -->
<g id="edge1880" class="edge">
<title>layer58_attn_4&#45;&gt;layer58_attn_out_4</title>
<path fill="none" stroke="black" d="M1188.5,-42589.69C1188.5,-42589.69 1188.5,-42528.32 1188.5,-42528.32"/>
<polygon fill="black" stroke="black" points="1192,-42528.32 1188.5,-42518.32 1185,-42528.32 1192,-42528.32"/>
</g>
<!-- layer58_attn_out_5 -->
<g id="node1474" class="node">
<title>layer58_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1482.5,-42517.94 1310.5,-42517.94 1310.5,-42449.94 1482.5,-42449.94 1482.5,-42517.94"/>
<text text-anchor="middle" x="1396.5" y="-42502.74" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1396.5" y="-42487.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1396.5" y="-42472.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1396.5" y="-42457.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer58_attn_5&#45;&gt;layer58_attn_out_5 -->
<g id="edge1881" class="edge">
<title>layer58_attn_5&#45;&gt;layer58_attn_out_5</title>
<path fill="none" stroke="black" d="M1396.5,-42589.69C1396.5,-42589.69 1396.5,-42528.32 1396.5,-42528.32"/>
<polygon fill="black" stroke="black" points="1400,-42528.32 1396.5,-42518.32 1393,-42528.32 1400,-42528.32"/>
</g>
<!-- layer58_attn_ar -->
<g id="node1475" class="node">
<title>layer58_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1292.5" cy="-42329.86" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1292.5" y="-42348.66" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1292.5" y="-42333.66" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1292.5" y="-42318.66" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1292.5" y="-42303.66" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer58_attn_out_4&#45;&gt;layer58_attn_ar -->
<g id="edge1882" class="edge">
<title>layer58_attn_out_4&#45;&gt;layer58_attn_ar</title>
<path fill="none" stroke="black" d="M1222.69,-42449.74C1222.69,-42449.74 1222.69,-42379.4 1222.69,-42379.4"/>
<polygon fill="black" stroke="black" points="1226.19,-42379.4 1222.69,-42369.4 1219.19,-42379.4 1226.19,-42379.4"/>
</g>
<!-- layer58_attn_out_5&#45;&gt;layer58_attn_ar -->
<g id="edge1883" class="edge">
<title>layer58_attn_out_5&#45;&gt;layer58_attn_ar</title>
<path fill="none" stroke="black" d="M1362.31,-42449.74C1362.31,-42449.74 1362.31,-42379.4 1362.31,-42379.4"/>
<polygon fill="black" stroke="black" points="1365.81,-42379.4 1362.31,-42369.4 1358.81,-42379.4 1365.81,-42379.4"/>
</g>
<!-- layer58_ffn_norm_4 -->
<g id="node1476" class="node">
<title>layer58_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1270.5,-42209.77 1098.5,-42209.77 1098.5,-42141.77 1270.5,-42141.77 1270.5,-42209.77"/>
<text text-anchor="middle" x="1184.5" y="-42194.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1184.5" y="-42179.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1184.5" y="-42164.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1184.5" y="-42149.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer58_attn_ar&#45;&gt;layer58_ffn_norm_4 -->
<g id="edge1884" class="edge">
<title>layer58_attn_ar&#45;&gt;layer58_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1220.69,-42290.98C1220.69,-42290.98 1220.69,-42219.92 1220.69,-42219.92"/>
<polygon fill="black" stroke="black" points="1224.19,-42219.92 1220.69,-42209.92 1217.19,-42219.92 1224.19,-42219.92"/>
</g>
<!-- layer58_ffn_norm_5 -->
<g id="node1477" class="node">
<title>layer58_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1487.5,-42209.77 1315.5,-42209.77 1315.5,-42141.77 1487.5,-42141.77 1487.5,-42209.77"/>
<text text-anchor="middle" x="1401.5" y="-42194.57" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1401.5" y="-42179.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1401.5" y="-42164.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1401.5" y="-42149.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer58_attn_ar&#45;&gt;layer58_ffn_norm_5 -->
<g id="edge1885" class="edge">
<title>layer58_attn_ar&#45;&gt;layer58_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1364.81,-42290.98C1364.81,-42290.98 1364.81,-42219.92 1364.81,-42219.92"/>
<polygon fill="black" stroke="black" points="1368.31,-42219.92 1364.81,-42209.92 1361.31,-42219.92 1368.31,-42219.92"/>
</g>
<!-- layer58_ffn_gate_4 -->
<g id="node1478" class="node">
<title>layer58_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1275,-42069.77 1094,-42069.77 1094,-42001.77 1275,-42001.77 1275,-42069.77"/>
<text text-anchor="middle" x="1184.5" y="-42054.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1184.5" y="-42039.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1184.5" y="-42024.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1184.5" y="-42009.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_ffn_norm_4&#45;&gt;layer58_ffn_gate_4 -->
<g id="edge1886" class="edge">
<title>layer58_ffn_norm_4&#45;&gt;layer58_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1184.5,-42141.53C1184.5,-42141.53 1184.5,-42080.15 1184.5,-42080.15"/>
<polygon fill="black" stroke="black" points="1188,-42080.15 1184.5,-42070.15 1181,-42080.15 1188,-42080.15"/>
</g>
<!-- layer58_ffn_up_4 -->
<g id="node1480" class="node">
<title>layer58_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1058,-42069.77 877,-42069.77 877,-42001.77 1058,-42001.77 1058,-42069.77"/>
<text text-anchor="middle" x="967.5" y="-42054.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="967.5" y="-42039.57" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="967.5" y="-42024.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="967.5" y="-42009.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_ffn_norm_4&#45;&gt;layer58_ffn_up_4 -->
<g id="edge1888" class="edge">
<title>layer58_ffn_norm_4&#45;&gt;layer58_ffn_up_4</title>
<path fill="none" stroke="black" d="M1098.31,-42175C1058.86,-42175 1020.76,-42175 1020.76,-42175 1020.76,-42175 1020.76,-42079.83 1020.76,-42079.83"/>
<polygon fill="black" stroke="black" points="1024.26,-42079.83 1020.76,-42069.83 1017.26,-42079.83 1024.26,-42079.83"/>
</g>
<!-- layer58_ffn_gate_5 -->
<g id="node1479" class="node">
<title>layer58_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1709,-42069.77 1528,-42069.77 1528,-42001.77 1709,-42001.77 1709,-42069.77"/>
<text text-anchor="middle" x="1618.5" y="-42054.57" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1618.5" y="-42039.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1618.5" y="-42024.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1618.5" y="-42009.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_ffn_norm_5&#45;&gt;layer58_ffn_gate_5 -->
<g id="edge1887" class="edge">
<title>layer58_ffn_norm_5&#45;&gt;layer58_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1487.56,-42175C1526.95,-42175 1565,-42175 1565,-42175 1565,-42175 1565,-42079.83 1565,-42079.83"/>
<polygon fill="black" stroke="black" points="1568.5,-42079.83 1565,-42069.83 1561.5,-42079.83 1568.5,-42079.83"/>
</g>
<!-- layer58_ffn_up_5 -->
<g id="node1481" class="node">
<title>layer58_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1492,-42069.77 1311,-42069.77 1311,-42001.77 1492,-42001.77 1492,-42069.77"/>
<text text-anchor="middle" x="1401.5" y="-42054.57" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1401.5" y="-42039.57" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1401.5" y="-42024.57" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1401.5" y="-42009.57" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_ffn_norm_5&#45;&gt;layer58_ffn_up_5 -->
<g id="edge1889" class="edge">
<title>layer58_ffn_norm_5&#45;&gt;layer58_ffn_up_5</title>
<path fill="none" stroke="black" d="M1401.5,-42141.53C1401.5,-42141.53 1401.5,-42080.15 1401.5,-42080.15"/>
<polygon fill="black" stroke="black" points="1405,-42080.15 1401.5,-42070.15 1398,-42080.15 1405,-42080.15"/>
</g>
<!-- layer58_gate_ar -->
<g id="node1482" class="node">
<title>layer58_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1450.5" cy="-41881.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1450.5" y="-41900.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1450.5" y="-41885.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1450.5" y="-41870.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1450.5" y="-41855.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer58_ffn_gate_4&#45;&gt;layer58_gate_ar -->
<g id="edge1890" class="edge">
<title>layer58_ffn_gate_4&#45;&gt;layer58_gate_ar</title>
<path fill="none" stroke="black" d="M1253.74,-42001.63C1253.74,-41951.79 1253.74,-41865 1253.74,-41865 1253.74,-41865 1320.38,-41865 1320.38,-41865"/>
<polygon fill="black" stroke="black" points="1320.38,-41868.5 1330.38,-41865 1320.38,-41861.5 1320.38,-41868.5"/>
</g>
<!-- layer58_ffn_gate_5&#45;&gt;layer58_gate_ar -->
<g id="edge1891" class="edge">
<title>layer58_ffn_gate_5&#45;&gt;layer58_gate_ar</title>
<path fill="none" stroke="black" d="M1553.24,-42001.58C1553.24,-42001.58 1553.24,-41920.36 1553.24,-41920.36"/>
<polygon fill="black" stroke="black" points="1556.74,-41920.36 1553.24,-41910.36 1549.74,-41920.36 1556.74,-41920.36"/>
</g>
<!-- layer58_up_ar -->
<g id="node1483" class="node">
<title>layer58_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1104.5" cy="-41881.69" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1104.5" y="-41900.49" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="1104.5" y="-41885.49" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1104.5" y="-41870.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1104.5" y="-41855.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer58_ffn_up_4&#45;&gt;layer58_up_ar -->
<g id="edge1892" class="edge">
<title>layer58_ffn_up_4&#45;&gt;layer58_up_ar</title>
<path fill="none" stroke="black" d="M1017.26,-42001.58C1017.26,-42001.58 1017.26,-41927.13 1017.26,-41927.13"/>
<polygon fill="black" stroke="black" points="1020.76,-41927.13 1017.26,-41917.13 1013.76,-41927.13 1020.76,-41927.13"/>
</g>
<!-- layer58_ffn_up_5&#45;&gt;layer58_up_ar -->
<g id="edge1893" class="edge">
<title>layer58_ffn_up_5&#45;&gt;layer58_up_ar</title>
<path fill="none" stroke="black" d="M1316.76,-42001.47C1316.76,-41960.38 1316.76,-41897 1316.76,-41897 1316.76,-41897 1236.13,-41897 1236.13,-41897"/>
<polygon fill="black" stroke="black" points="1236.13,-41893.5 1226.13,-41897 1236.13,-41900.5 1236.13,-41893.5"/>
</g>
<!-- layer58_silu_4 -->
<g id="node1484" class="node">
<title>layer58_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1378,-41761.61 1197,-41761.61 1197,-41693.61 1378,-41693.61 1378,-41761.61"/>
<text text-anchor="middle" x="1287.5" y="-41746.41" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1287.5" y="-41731.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1287.5" y="-41716.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1287.5" y="-41701.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_gate_ar&#45;&gt;layer58_silu_4 -->
<g id="edge1894" class="edge">
<title>layer58_gate_ar&#45;&gt;layer58_silu_4</title>
<path fill="none" stroke="black" d="M1350.26,-41851.62C1350.26,-41851.62 1350.26,-41771.63 1350.26,-41771.63"/>
<polygon fill="black" stroke="black" points="1353.76,-41771.63 1350.26,-41761.63 1346.76,-41771.63 1353.76,-41771.63"/>
</g>
<!-- layer58_silu_5 -->
<g id="node1485" class="node">
<title>layer58_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1595,-41761.61 1414,-41761.61 1414,-41693.61 1595,-41693.61 1595,-41761.61"/>
<text text-anchor="middle" x="1504.5" y="-41746.41" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1504.5" y="-41731.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1504.5" y="-41716.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1504.5" y="-41701.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_gate_ar&#45;&gt;layer58_silu_5 -->
<g id="edge1895" class="edge">
<title>layer58_gate_ar&#45;&gt;layer58_silu_5</title>
<path fill="none" stroke="black" d="M1496.24,-41836.71C1496.24,-41836.71 1496.24,-41771.61 1496.24,-41771.61"/>
<polygon fill="black" stroke="black" points="1499.74,-41771.61 1496.24,-41761.61 1492.74,-41771.61 1499.74,-41771.61"/>
</g>
<!-- layer58_mul_4 -->
<g id="node1486" class="node">
<title>layer58_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1245,-41621.61 1064,-41621.61 1064,-41553.61 1245,-41553.61 1245,-41621.61"/>
<text text-anchor="middle" x="1154.5" y="-41606.41" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1154.5" y="-41591.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1154.5" y="-41576.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1154.5" y="-41561.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_up_ar&#45;&gt;layer58_mul_4 -->
<g id="edge1897" class="edge">
<title>layer58_up_ar&#45;&gt;layer58_mul_4</title>
<path fill="none" stroke="black" d="M1130.5,-41834.44C1130.5,-41834.44 1130.5,-41631.88 1130.5,-41631.88"/>
<polygon fill="black" stroke="black" points="1134,-41631.88 1130.5,-41621.88 1127,-41631.88 1134,-41631.88"/>
</g>
<!-- layer58_mul_5 -->
<g id="node1487" class="node">
<title>layer58_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1462,-41621.61 1281,-41621.61 1281,-41553.61 1462,-41553.61 1462,-41621.61"/>
<text text-anchor="middle" x="1371.5" y="-41606.41" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1371.5" y="-41591.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1371.5" y="-41576.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1371.5" y="-41561.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer58_up_ar&#45;&gt;layer58_mul_5 -->
<g id="edge1899" class="edge">
<title>layer58_up_ar&#45;&gt;layer58_mul_5</title>
<path fill="none" stroke="black" d="M1214.74,-41857.19C1214.74,-41832.18 1214.74,-41797 1214.74,-41797 1214.74,-41797 1396,-41797 1396,-41797 1396,-41797 1396,-41631.72 1396,-41631.72"/>
<polygon fill="black" stroke="black" points="1399.5,-41631.72 1396,-41621.72 1392.5,-41631.72 1399.5,-41631.72"/>
</g>
<!-- layer58_silu_4&#45;&gt;layer58_mul_4 -->
<g id="edge1896" class="edge">
<title>layer58_silu_4&#45;&gt;layer58_mul_4</title>
<path fill="none" stroke="black" d="M1221,-41693.36C1221,-41693.36 1221,-41631.99 1221,-41631.99"/>
<polygon fill="black" stroke="black" points="1224.5,-41631.99 1221,-41621.99 1217.5,-41631.99 1224.5,-41631.99"/>
</g>
<!-- layer58_silu_5&#45;&gt;layer58_mul_5 -->
<g id="edge1898" class="edge">
<title>layer58_silu_5&#45;&gt;layer58_mul_5</title>
<path fill="none" stroke="black" d="M1438,-41693.36C1438,-41693.36 1438,-41631.99 1438,-41631.99"/>
<polygon fill="black" stroke="black" points="1441.5,-41631.99 1438,-41621.99 1434.5,-41631.99 1441.5,-41631.99"/>
</g>
<!-- layer58_ffn_down_4 -->
<g id="node1488" class="node">
<title>layer58_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1244.5,-41481.61 1072.5,-41481.61 1072.5,-41413.61 1244.5,-41413.61 1244.5,-41481.61"/>
<text text-anchor="middle" x="1158.5" y="-41466.41" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1158.5" y="-41451.41" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1158.5" y="-41436.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1158.5" y="-41421.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer58_mul_4&#45;&gt;layer58_ffn_down_4 -->
<g id="edge1900" class="edge">
<title>layer58_mul_4&#45;&gt;layer58_ffn_down_4</title>
<path fill="none" stroke="black" d="M1158.5,-41553.36C1158.5,-41553.36 1158.5,-41491.99 1158.5,-41491.99"/>
<polygon fill="black" stroke="black" points="1162,-41491.99 1158.5,-41481.99 1155,-41491.99 1162,-41491.99"/>
</g>
<!-- layer58_ffn_down_5 -->
<g id="node1489" class="node">
<title>layer58_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1454.5,-41481.61 1282.5,-41481.61 1282.5,-41413.61 1454.5,-41413.61 1454.5,-41481.61"/>
<text text-anchor="middle" x="1368.5" y="-41466.41" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1368.5" y="-41451.41" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1368.5" y="-41436.41" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1368.5" y="-41421.41" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer58_mul_5&#45;&gt;layer58_ffn_down_5 -->
<g id="edge1901" class="edge">
<title>layer58_mul_5&#45;&gt;layer58_ffn_down_5</title>
<path fill="none" stroke="black" d="M1368.5,-41553.36C1368.5,-41553.36 1368.5,-41491.99 1368.5,-41491.99"/>
<polygon fill="black" stroke="black" points="1372,-41491.99 1368.5,-41481.99 1365,-41491.99 1372,-41491.99"/>
</g>
<!-- layer58_ffn_ar -->
<g id="node1490" class="node">
<title>layer58_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1199.5" cy="-41293.52" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1199.5" y="-41312.32" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1199.5" y="-41297.32" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1199.5" y="-41282.32" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1199.5" y="-41267.32" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer58_ffn_down_4&#45;&gt;layer58_ffn_ar -->
<g id="edge1902" class="edge">
<title>layer58_ffn_down_4&#45;&gt;layer58_ffn_ar</title>
<path fill="none" stroke="black" d="M1161.19,-41413.41C1161.19,-41413.41 1161.19,-41349.32 1161.19,-41349.32"/>
<polygon fill="black" stroke="black" points="1164.69,-41349.32 1161.19,-41339.32 1157.69,-41349.32 1164.69,-41349.32"/>
</g>
<!-- layer58_ffn_down_5&#45;&gt;layer58_ffn_ar -->
<g id="edge1903" class="edge">
<title>layer58_ffn_down_5&#45;&gt;layer58_ffn_ar</title>
<path fill="none" stroke="black" d="M1301.81,-41413.41C1301.81,-41413.41 1301.81,-41329.97 1301.81,-41329.97"/>
<polygon fill="black" stroke="black" points="1305.31,-41329.97 1301.81,-41319.97 1298.31,-41329.97 1305.31,-41329.97"/>
</g>
<!-- layer59_norm_4 -->
<g id="node1491" class="node">
<title>layer59_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1181.5,-41173.44 1009.5,-41173.44 1009.5,-41105.44 1181.5,-41105.44 1181.5,-41173.44"/>
<text text-anchor="middle" x="1095.5" y="-41158.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1095.5" y="-41143.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1095.5" y="-41128.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1095.5" y="-41113.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer58_ffn_ar&#45;&gt;layer59_norm_4 -->
<g id="edge1904" class="edge">
<title>layer58_ffn_ar&#45;&gt;layer59_norm_4</title>
<path fill="none" stroke="black" d="M1129.69,-41253.84C1129.69,-41253.84 1129.69,-41183.5 1129.69,-41183.5"/>
<polygon fill="black" stroke="black" points="1133.19,-41183.5 1129.69,-41173.5 1126.19,-41183.5 1133.19,-41183.5"/>
</g>
<!-- layer59_norm_5 -->
<g id="node1492" class="node">
<title>layer59_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1391.5,-41173.44 1219.5,-41173.44 1219.5,-41105.44 1391.5,-41105.44 1391.5,-41173.44"/>
<text text-anchor="middle" x="1305.5" y="-41158.24" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1305.5" y="-41143.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1305.5" y="-41128.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1305.5" y="-41113.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer58_ffn_ar&#45;&gt;layer59_norm_5 -->
<g id="edge1905" class="edge">
<title>layer58_ffn_ar&#45;&gt;layer59_norm_5</title>
<path fill="none" stroke="black" d="M1270.31,-41254.24C1270.31,-41254.24 1270.31,-41183.67 1270.31,-41183.67"/>
<polygon fill="black" stroke="black" points="1273.81,-41183.67 1270.31,-41173.67 1266.81,-41183.67 1273.81,-41183.67"/>
</g>
<!-- layer59_qkv_4 -->
<g id="node1493" class="node">
<title>layer59_qkv_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1182,-41033.44 1001,-41033.44 1001,-40965.44 1182,-40965.44 1182,-41033.44"/>
<text text-anchor="middle" x="1091.5" y="-41018.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1091.5" y="-41003.24" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1091.5" y="-40988.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1091.5" y="-40973.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer59_norm_4&#45;&gt;layer59_qkv_4 -->
<g id="edge1906" class="edge">
<title>layer59_norm_4&#45;&gt;layer59_qkv_4</title>
<path fill="none" stroke="black" d="M1095.5,-41105.19C1095.5,-41105.19 1095.5,-41043.82 1095.5,-41043.82"/>
<polygon fill="black" stroke="black" points="1099,-41043.82 1095.5,-41033.82 1092,-41043.82 1099,-41043.82"/>
</g>
<!-- layer59_qkv_5 -->
<g id="node1494" class="node">
<title>layer59_qkv_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1399,-41033.44 1218,-41033.44 1218,-40965.44 1399,-40965.44 1399,-41033.44"/>
<text text-anchor="middle" x="1308.5" y="-41018.24" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1308.5" y="-41003.24" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1308.5" y="-40988.24" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1308.5" y="-40973.24" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer59_norm_5&#45;&gt;layer59_qkv_5 -->
<g id="edge1907" class="edge">
<title>layer59_norm_5&#45;&gt;layer59_qkv_5</title>
<path fill="none" stroke="black" d="M1305.5,-41105.19C1305.5,-41105.19 1305.5,-41043.82 1305.5,-41043.82"/>
<polygon fill="black" stroke="black" points="1309,-41043.82 1305.5,-41033.82 1302,-41043.82 1309,-41043.82"/>
</g>
<!-- layer59_qkv_ar -->
<g id="node1495" class="node">
<title>layer59_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1166.5" cy="-40845.36" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1166.5" y="-40864.16" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1166.5" y="-40849.16" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1166.5" y="-40834.16" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1166.5" y="-40819.16" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer59_qkv_4&#45;&gt;layer59_qkv_ar -->
<g id="edge1908" class="edge">
<title>layer59_qkv_4&#45;&gt;layer59_qkv_ar</title>
<path fill="none" stroke="black" d="M1110.26,-40965.24C1110.26,-40965.24 1110.26,-40898.56 1110.26,-40898.56"/>
<polygon fill="black" stroke="black" points="1113.76,-40898.56 1110.26,-40888.56 1106.76,-40898.56 1113.76,-40898.56"/>
</g>
<!-- layer59_qkv_5&#45;&gt;layer59_qkv_ar -->
<g id="edge1909" class="edge">
<title>layer59_qkv_5&#45;&gt;layer59_qkv_ar</title>
<path fill="none" stroke="black" d="M1256.24,-40965.24C1256.24,-40965.24 1256.24,-40889.72 1256.24,-40889.72"/>
<polygon fill="black" stroke="black" points="1259.74,-40889.72 1256.24,-40879.72 1252.74,-40889.72 1259.74,-40889.72"/>
</g>
<!-- layer59_attn_4 -->
<g id="node1496" class="node">
<title>layer59_attn_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1148.5,-40725.27 976.5,-40725.27 976.5,-40657.27 1148.5,-40657.27 1148.5,-40725.27"/>
<text text-anchor="middle" x="1062.5" y="-40710.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1062.5" y="-40695.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1062.5" y="-40680.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1062.5" y="-40665.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer59_qkv_ar&#45;&gt;layer59_attn_4 -->
<g id="edge1910" class="edge">
<title>layer59_qkv_ar&#45;&gt;layer59_attn_4</title>
<path fill="none" stroke="black" d="M1093.51,-40805.68C1093.51,-40805.68 1093.51,-40735.33 1093.51,-40735.33"/>
<polygon fill="black" stroke="black" points="1097.01,-40735.33 1093.51,-40725.33 1090.01,-40735.33 1097.01,-40735.33"/>
</g>
<!-- layer59_attn_5 -->
<g id="node1497" class="node">
<title>layer59_attn_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1356.5,-40725.27 1184.5,-40725.27 1184.5,-40657.27 1356.5,-40657.27 1356.5,-40725.27"/>
<text text-anchor="middle" x="1270.5" y="-40710.07" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1270.5" y="-40695.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1270.5" y="-40680.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1270.5" y="-40665.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer59_qkv_ar&#45;&gt;layer59_attn_5 -->
<g id="edge1911" class="edge">
<title>layer59_qkv_ar&#45;&gt;layer59_attn_5</title>
<path fill="none" stroke="black" d="M1239.49,-40805.68C1239.49,-40805.68 1239.49,-40735.33 1239.49,-40735.33"/>
<polygon fill="black" stroke="black" points="1242.99,-40735.33 1239.49,-40725.33 1235.99,-40735.33 1242.99,-40735.33"/>
</g>
<!-- layer59_attn_out_4 -->
<g id="node1498" class="node">
<title>layer59_attn_out_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1148.5,-40585.27 976.5,-40585.27 976.5,-40517.27 1148.5,-40517.27 1148.5,-40585.27"/>
<text text-anchor="middle" x="1062.5" y="-40570.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1062.5" y="-40555.07" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1062.5" y="-40540.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1062.5" y="-40525.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer59_attn_4&#45;&gt;layer59_attn_out_4 -->
<g id="edge1912" class="edge">
<title>layer59_attn_4&#45;&gt;layer59_attn_out_4</title>
<path fill="none" stroke="black" d="M1062.5,-40657.03C1062.5,-40657.03 1062.5,-40595.65 1062.5,-40595.65"/>
<polygon fill="black" stroke="black" points="1066,-40595.65 1062.5,-40585.65 1059,-40595.65 1066,-40595.65"/>
</g>
<!-- layer59_attn_out_5 -->
<g id="node1499" class="node">
<title>layer59_attn_out_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1356.5,-40585.27 1184.5,-40585.27 1184.5,-40517.27 1356.5,-40517.27 1356.5,-40585.27"/>
<text text-anchor="middle" x="1270.5" y="-40570.07" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1270.5" y="-40555.07" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1270.5" y="-40540.07" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1270.5" y="-40525.07" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer59_attn_5&#45;&gt;layer59_attn_out_5 -->
<g id="edge1913" class="edge">
<title>layer59_attn_5&#45;&gt;layer59_attn_out_5</title>
<path fill="none" stroke="black" d="M1270.5,-40657.03C1270.5,-40657.03 1270.5,-40595.65 1270.5,-40595.65"/>
<polygon fill="black" stroke="black" points="1274,-40595.65 1270.5,-40585.65 1267,-40595.65 1274,-40595.65"/>
</g>
<!-- layer59_attn_ar -->
<g id="node1500" class="node">
<title>layer59_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1151.5" cy="-40397.19" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1151.5" y="-40415.99" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1151.5" y="-40400.99" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1151.5" y="-40385.99" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1151.5" y="-40370.99" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer59_attn_out_4&#45;&gt;layer59_attn_ar -->
<g id="edge1914" class="edge">
<title>layer59_attn_out_4&#45;&gt;layer59_attn_ar</title>
<path fill="none" stroke="black" d="M1089.19,-40517.08C1089.19,-40517.08 1089.19,-40448.69 1089.19,-40448.69"/>
<polygon fill="black" stroke="black" points="1092.69,-40448.69 1089.19,-40438.69 1085.69,-40448.69 1092.69,-40448.69"/>
</g>
<!-- layer59_attn_out_5&#45;&gt;layer59_attn_ar -->
<g id="edge1915" class="edge">
<title>layer59_attn_out_5&#45;&gt;layer59_attn_ar</title>
<path fill="none" stroke="black" d="M1228.81,-40517.08C1228.81,-40517.08 1228.81,-40444.53 1228.81,-40444.53"/>
<polygon fill="black" stroke="black" points="1232.31,-40444.53 1228.81,-40434.53 1225.31,-40444.53 1232.31,-40444.53"/>
</g>
<!-- layer59_ffn_norm_4 -->
<g id="node1501" class="node">
<title>layer59_ffn_norm_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1129.5,-40277.11 957.5,-40277.11 957.5,-40209.11 1129.5,-40209.11 1129.5,-40277.11"/>
<text text-anchor="middle" x="1043.5" y="-40261.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1043.5" y="-40246.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1043.5" y="-40231.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1043.5" y="-40216.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer59_attn_ar&#45;&gt;layer59_ffn_norm_4 -->
<g id="edge1916" class="edge">
<title>layer59_attn_ar&#45;&gt;layer59_ffn_norm_4</title>
<path fill="none" stroke="black" d="M1079.69,-40358.31C1079.69,-40358.31 1079.69,-40287.26 1079.69,-40287.26"/>
<polygon fill="black" stroke="black" points="1083.19,-40287.26 1079.69,-40277.26 1076.19,-40287.26 1083.19,-40287.26"/>
</g>
<!-- layer59_ffn_norm_5 -->
<g id="node1502" class="node">
<title>layer59_ffn_norm_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1346.5,-40277.11 1174.5,-40277.11 1174.5,-40209.11 1346.5,-40209.11 1346.5,-40277.11"/>
<text text-anchor="middle" x="1260.5" y="-40261.91" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1260.5" y="-40246.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1260.5" y="-40231.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1260.5" y="-40216.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer59_attn_ar&#45;&gt;layer59_ffn_norm_5 -->
<g id="edge1917" class="edge">
<title>layer59_attn_ar&#45;&gt;layer59_ffn_norm_5</title>
<path fill="none" stroke="black" d="M1223.81,-40358.31C1223.81,-40358.31 1223.81,-40287.26 1223.81,-40287.26"/>
<polygon fill="black" stroke="black" points="1227.31,-40287.26 1223.81,-40277.26 1220.31,-40287.26 1227.31,-40287.26"/>
</g>
<!-- layer59_ffn_gate_4 -->
<g id="node1503" class="node">
<title>layer59_ffn_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1134,-40137.11 953,-40137.11 953,-40069.11 1134,-40069.11 1134,-40137.11"/>
<text text-anchor="middle" x="1043.5" y="-40121.91" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1043.5" y="-40106.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1043.5" y="-40091.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1043.5" y="-40076.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_ffn_norm_4&#45;&gt;layer59_ffn_gate_4 -->
<g id="edge1918" class="edge">
<title>layer59_ffn_norm_4&#45;&gt;layer59_ffn_gate_4</title>
<path fill="none" stroke="black" d="M1043.5,-40208.86C1043.5,-40208.86 1043.5,-40147.49 1043.5,-40147.49"/>
<polygon fill="black" stroke="black" points="1047,-40147.49 1043.5,-40137.49 1040,-40147.49 1047,-40147.49"/>
</g>
<!-- layer59_ffn_up_4 -->
<g id="node1505" class="node">
<title>layer59_ffn_up_4</title>
<polygon fill="#e6e6ff" stroke="black" points="917,-40137.11 736,-40137.11 736,-40069.11 917,-40069.11 917,-40137.11"/>
<text text-anchor="middle" x="826.5" y="-40121.91" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="826.5" y="-40106.91" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="826.5" y="-40091.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="826.5" y="-40076.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_ffn_norm_4&#45;&gt;layer59_ffn_up_4 -->
<g id="edge1920" class="edge">
<title>layer59_ffn_norm_4&#45;&gt;layer59_ffn_up_4</title>
<path fill="none" stroke="black" d="M957.43,-40243C925.54,-40243 897,-40243 897,-40243 897,-40243 897,-40147.33 897,-40147.33"/>
<polygon fill="black" stroke="black" points="900.5,-40147.33 897,-40137.33 893.5,-40147.33 900.5,-40147.33"/>
</g>
<!-- layer59_ffn_gate_5 -->
<g id="node1504" class="node">
<title>layer59_ffn_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1568,-40137.11 1387,-40137.11 1387,-40069.11 1568,-40069.11 1568,-40137.11"/>
<text text-anchor="middle" x="1477.5" y="-40121.91" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1477.5" y="-40106.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1477.5" y="-40091.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1477.5" y="-40076.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_ffn_norm_5&#45;&gt;layer59_ffn_gate_5 -->
<g id="edge1919" class="edge">
<title>layer59_ffn_norm_5&#45;&gt;layer59_ffn_gate_5</title>
<path fill="none" stroke="black" d="M1346.66,-40243C1371.97,-40243 1393,-40243 1393,-40243 1393,-40243 1393,-40147.33 1393,-40147.33"/>
<polygon fill="black" stroke="black" points="1396.5,-40147.33 1393,-40137.33 1389.5,-40147.33 1396.5,-40147.33"/>
</g>
<!-- layer59_ffn_up_5 -->
<g id="node1506" class="node">
<title>layer59_ffn_up_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1351,-40137.11 1170,-40137.11 1170,-40069.11 1351,-40069.11 1351,-40137.11"/>
<text text-anchor="middle" x="1260.5" y="-40121.91" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1260.5" y="-40106.91" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1260.5" y="-40091.91" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1260.5" y="-40076.91" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_ffn_norm_5&#45;&gt;layer59_ffn_up_5 -->
<g id="edge1921" class="edge">
<title>layer59_ffn_norm_5&#45;&gt;layer59_ffn_up_5</title>
<path fill="none" stroke="black" d="M1260.5,-40208.86C1260.5,-40208.86 1260.5,-40147.49 1260.5,-40147.49"/>
<polygon fill="black" stroke="black" points="1264,-40147.49 1260.5,-40137.49 1257,-40147.49 1264,-40147.49"/>
</g>
<!-- layer59_gate_ar -->
<g id="node1507" class="node">
<title>layer59_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1271.5" cy="-39949.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1271.5" y="-39967.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1271.5" y="-39952.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="1271.5" y="-39937.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1271.5" y="-39922.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer59_ffn_gate_4&#45;&gt;layer59_gate_ar -->
<g id="edge1922" class="edge">
<title>layer59_ffn_gate_4&#45;&gt;layer59_gate_ar</title>
<path fill="none" stroke="black" d="M1134.11,-40091C1147.42,-40091 1156.76,-40091 1156.76,-40091 1156.76,-40091 1156.76,-39980.59 1156.76,-39980.59"/>
<polygon fill="black" stroke="black" points="1160.26,-39980.59 1156.76,-39970.59 1153.26,-39980.59 1160.26,-39980.59"/>
</g>
<!-- layer59_ffn_gate_5&#45;&gt;layer59_gate_ar -->
<g id="edge1923" class="edge">
<title>layer59_ffn_gate_5&#45;&gt;layer59_gate_ar</title>
<path fill="none" stroke="black" d="M1393.24,-40068.91C1393.24,-40068.91 1393.24,-39974 1393.24,-39974"/>
<polygon fill="black" stroke="black" points="1396.74,-39974 1393.24,-39964 1389.74,-39974 1396.74,-39974"/>
</g>
<!-- layer59_up_ar -->
<g id="node1508" class="node">
<title>layer59_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="925.5" cy="-39949.02" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="925.5" y="-39967.82" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="925.5" y="-39952.82" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="925.5" y="-39937.82" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="925.5" y="-39922.82" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer59_ffn_up_4&#45;&gt;layer59_up_ar -->
<g id="edge1924" class="edge">
<title>layer59_ffn_up_4&#45;&gt;layer59_up_ar</title>
<path fill="none" stroke="black" d="M857.26,-40068.91C857.26,-40068.91 857.26,-39999.97 857.26,-39999.97"/>
<polygon fill="black" stroke="black" points="860.76,-39999.97 857.26,-39989.97 853.76,-39999.97 860.76,-39999.97"/>
</g>
<!-- layer59_ffn_up_5&#45;&gt;layer59_up_ar -->
<g id="edge1925" class="edge">
<title>layer59_ffn_up_5&#45;&gt;layer59_up_ar</title>
<path fill="none" stroke="black" d="M1169.79,-40114C1152.02,-40114 1138.76,-40114 1138.76,-40114 1138.76,-40114 1138.76,-39949 1138.76,-39949 1138.76,-39949 1063.55,-39949 1063.55,-39949"/>
<polygon fill="black" stroke="black" points="1063.55,-39945.5 1053.55,-39949 1063.55,-39952.5 1063.55,-39945.5"/>
</g>
<!-- layer59_silu_4 -->
<g id="node1509" class="node">
<title>layer59_silu_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1199,-39828.94 1018,-39828.94 1018,-39760.94 1199,-39760.94 1199,-39828.94"/>
<text text-anchor="middle" x="1108.5" y="-39813.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1108.5" y="-39798.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="1108.5" y="-39783.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1108.5" y="-39768.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_gate_ar&#45;&gt;layer59_silu_4 -->
<g id="edge1926" class="edge">
<title>layer59_gate_ar&#45;&gt;layer59_silu_4</title>
<path fill="none" stroke="black" d="M1171.26,-39918.95C1171.26,-39918.95 1171.26,-39838.96 1171.26,-39838.96"/>
<polygon fill="black" stroke="black" points="1174.76,-39838.96 1171.26,-39828.96 1167.76,-39838.96 1174.76,-39838.96"/>
</g>
<!-- layer59_silu_5 -->
<g id="node1510" class="node">
<title>layer59_silu_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1416,-39828.94 1235,-39828.94 1235,-39760.94 1416,-39760.94 1416,-39828.94"/>
<text text-anchor="middle" x="1325.5" y="-39813.74" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1325.5" y="-39798.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1325.5" y="-39783.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1325.5" y="-39768.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_gate_ar&#45;&gt;layer59_silu_5 -->
<g id="edge1927" class="edge">
<title>layer59_gate_ar&#45;&gt;layer59_silu_5</title>
<path fill="none" stroke="black" d="M1317.24,-39904.04C1317.24,-39904.04 1317.24,-39838.95 1317.24,-39838.95"/>
<polygon fill="black" stroke="black" points="1320.74,-39838.95 1317.24,-39828.95 1313.74,-39838.95 1320.74,-39838.95"/>
</g>
<!-- layer59_mul_4 -->
<g id="node1511" class="node">
<title>layer59_mul_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1047,-39688.94 866,-39688.94 866,-39620.94 1047,-39620.94 1047,-39688.94"/>
<text text-anchor="middle" x="956.5" y="-39673.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="956.5" y="-39658.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="956.5" y="-39643.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="956.5" y="-39628.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_up_ar&#45;&gt;layer59_mul_4 -->
<g id="edge1929" class="edge">
<title>layer59_up_ar&#45;&gt;layer59_mul_4</title>
<path fill="none" stroke="black" d="M942,-39901.12C942,-39901.12 942,-39699.05 942,-39699.05"/>
<polygon fill="black" stroke="black" points="945.5,-39699.05 942,-39689.05 938.5,-39699.05 945.5,-39699.05"/>
</g>
<!-- layer59_mul_5 -->
<g id="node1512" class="node">
<title>layer59_mul_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1264,-39688.94 1083,-39688.94 1083,-39620.94 1264,-39620.94 1264,-39688.94"/>
<text text-anchor="middle" x="1173.5" y="-39673.74" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1173.5" y="-39658.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1173.5" y="-39643.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1173.5" y="-39628.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer59_up_ar&#45;&gt;layer59_mul_5 -->
<g id="edge1931" class="edge">
<title>layer59_up_ar&#45;&gt;layer59_mul_5</title>
<path fill="none" stroke="black" d="M1035.74,-39924.43C1035.74,-39899.32 1035.74,-39864 1035.74,-39864 1035.74,-39864 1217,-39864 1217,-39864 1217,-39864 1217,-39699 1217,-39699"/>
<polygon fill="black" stroke="black" points="1220.5,-39699 1217,-39689 1213.5,-39699 1220.5,-39699"/>
</g>
<!-- layer59_silu_4&#45;&gt;layer59_mul_4 -->
<g id="edge1928" class="edge">
<title>layer59_silu_4&#45;&gt;layer59_mul_4</title>
<path fill="none" stroke="black" d="M1032.5,-39760.69C1032.5,-39760.69 1032.5,-39699.32 1032.5,-39699.32"/>
<polygon fill="black" stroke="black" points="1036,-39699.32 1032.5,-39689.32 1029,-39699.32 1036,-39699.32"/>
</g>
<!-- layer59_silu_5&#45;&gt;layer59_mul_5 -->
<g id="edge1930" class="edge">
<title>layer59_silu_5&#45;&gt;layer59_mul_5</title>
<path fill="none" stroke="black" d="M1249.5,-39760.69C1249.5,-39760.69 1249.5,-39699.32 1249.5,-39699.32"/>
<polygon fill="black" stroke="black" points="1253,-39699.32 1249.5,-39689.32 1246,-39699.32 1253,-39699.32"/>
</g>
<!-- layer59_ffn_down_4 -->
<g id="node1513" class="node">
<title>layer59_ffn_down_4</title>
<polygon fill="#e6e6ff" stroke="black" points="1046.5,-39548.94 874.5,-39548.94 874.5,-39480.94 1046.5,-39480.94 1046.5,-39548.94"/>
<text text-anchor="middle" x="960.5" y="-39533.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="960.5" y="-39518.74" font-family="Times,serif" font-size="14.00">GPU:4</text>
<text text-anchor="middle" x="960.5" y="-39503.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="960.5" y="-39488.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer59_mul_4&#45;&gt;layer59_ffn_down_4 -->
<g id="edge1932" class="edge">
<title>layer59_mul_4&#45;&gt;layer59_ffn_down_4</title>
<path fill="none" stroke="black" d="M960.5,-39620.69C960.5,-39620.69 960.5,-39559.32 960.5,-39559.32"/>
<polygon fill="black" stroke="black" points="964,-39559.32 960.5,-39549.32 957,-39559.32 964,-39559.32"/>
</g>
<!-- layer59_ffn_down_5 -->
<g id="node1514" class="node">
<title>layer59_ffn_down_5</title>
<polygon fill="#e6e6ff" stroke="black" points="1256.5,-39548.94 1084.5,-39548.94 1084.5,-39480.94 1256.5,-39480.94 1256.5,-39548.94"/>
<text text-anchor="middle" x="1170.5" y="-39533.74" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1170.5" y="-39518.74" font-family="Times,serif" font-size="14.00">GPU:5</text>
<text text-anchor="middle" x="1170.5" y="-39503.74" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1170.5" y="-39488.74" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer59_mul_5&#45;&gt;layer59_ffn_down_5 -->
<g id="edge1933" class="edge">
<title>layer59_mul_5&#45;&gt;layer59_ffn_down_5</title>
<path fill="none" stroke="black" d="M1170.5,-39620.69C1170.5,-39620.69 1170.5,-39559.32 1170.5,-39559.32"/>
<polygon fill="black" stroke="black" points="1174,-39559.32 1170.5,-39549.32 1167,-39559.32 1174,-39559.32"/>
</g>
<!-- layer59_ffn_ar -->
<g id="node1515" class="node">
<title>layer59_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="992.5" cy="-39360.86" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="992.5" y="-39379.66" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="992.5" y="-39364.66" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
<text text-anchor="middle" x="992.5" y="-39349.66" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="992.5" y="-39334.66" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer59_ffn_down_4&#45;&gt;layer59_ffn_ar -->
<g id="edge1934" class="edge">
<title>layer59_ffn_down_4&#45;&gt;layer59_ffn_ar</title>
<path fill="none" stroke="black" d="M960.5,-39480.75C960.5,-39480.75 960.5,-39417.52 960.5,-39417.52"/>
<polygon fill="black" stroke="black" points="964,-39417.52 960.5,-39407.52 957,-39417.52 964,-39417.52"/>
</g>
<!-- layer59_ffn_down_5&#45;&gt;layer59_ffn_ar -->
<g id="edge1935" class="edge">
<title>layer59_ffn_down_5&#45;&gt;layer59_ffn_ar</title>
<path fill="none" stroke="black" d="M1099.31,-39480.75C1099.31,-39480.75 1099.31,-39393.98 1099.31,-39393.98"/>
<polygon fill="black" stroke="black" points="1102.81,-39393.98 1099.31,-39383.98 1095.81,-39393.98 1102.81,-39393.98"/>
</g>
<!-- pp_send_2_3 -->
<g id="node1516" class="node">
<title>pp_send_2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="992.5" cy="-39203.3" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="992.5" y="-39214.6" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="992.5" y="-39199.6" font-family="Times,serif" font-size="14.00">Stage 23</text>
<text text-anchor="middle" x="992.5" y="-39184.6" font-family="Times,serif" font-size="14.00">GPU:[5][6]</text>
</g>
<!-- layer59_ffn_ar&#45;&gt;pp_send_2_3 -->
<g id="edge1938" class="edge">
<title>layer59_ffn_ar&#45;&gt;pp_send_2_3</title>
<path fill="none" stroke="black" d="M992.5,-39312.73C992.5,-39312.73 992.5,-39250.89 992.5,-39250.89"/>
<polygon fill="black" stroke="black" points="996,-39250.89 992.5,-39240.89 989,-39250.89 996,-39250.89"/>
</g>
<!-- split_stage3 -->
<g id="node1517" class="node">
<title>split_stage3</title>
<polygon fill="lightyellow" stroke="black" points="870.85,-39093.82 313.52,-39093.82 170.15,-39017.82 727.48,-39017.82 870.85,-39093.82"/>
<text text-anchor="middle" x="520.5" y="-39059.62" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="520.5" y="-39044.62" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=4096]</text>
</g>
<!-- pp_send_2_3&#45;&gt;split_stage3 -->
<g id="edge1939" class="edge">
<title>pp_send_2_3&#45;&gt;split_stage3</title>
<path fill="none" stroke="black" d="M910.72,-39203C871.01,-39203 831.76,-39203 831.76,-39203 831.76,-39203 831.76,-39104.11 831.76,-39104.11"/>
<polygon fill="black" stroke="black" points="835.26,-39104.11 831.76,-39094.11 828.26,-39104.11 835.26,-39104.11"/>
</g>
<!-- output_norm_0 -->
<g id="node2021" class="node">
<title>output_norm_0</title>
<polygon fill="#fff0e6" stroke="black" points="1286.5,-39089.82 1114.5,-39089.82 1114.5,-39021.82 1286.5,-39021.82 1286.5,-39089.82"/>
<text text-anchor="middle" x="1200.5" y="-39074.62" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1200.5" y="-39059.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1200.5" y="-39044.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1200.5" y="-39029.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- pp_send_2_3&#45;&gt;output_norm_0 -->
<g id="edge2584" class="edge">
<title>pp_send_2_3&#45;&gt;output_norm_0</title>
<path fill="none" stroke="black" d="M1074.07,-39203C1126.74,-39203 1185.5,-39203 1185.5,-39203 1185.5,-39203 1185.5,-39099.96 1185.5,-39099.96"/>
<polygon fill="black" stroke="black" points="1189,-39099.96 1185.5,-39089.96 1182,-39099.96 1189,-39099.96"/>
</g>
<!-- output_norm_1 -->
<g id="node2022" class="node">
<title>output_norm_1</title>
<polygon fill="#fff0e6" stroke="black" points="1078.5,-39089.82 906.5,-39089.82 906.5,-39021.82 1078.5,-39021.82 1078.5,-39089.82"/>
<text text-anchor="middle" x="992.5" y="-39074.62" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="992.5" y="-39059.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="992.5" y="-39044.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="992.5" y="-39029.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- pp_send_2_3&#45;&gt;output_norm_1 -->
<g id="edge2585" class="edge">
<title>pp_send_2_3&#45;&gt;output_norm_1</title>
<path fill="none" stroke="black" d="M992.5,-39165.7C992.5,-39165.7 992.5,-39100.32 992.5,-39100.32"/>
<polygon fill="black" stroke="black" points="996,-39100.32 992.5,-39090.32 989,-39100.32 996,-39100.32"/>
</g>
<!-- layer60_embed_6 -->
<g id="node1518" class="node">
<title>layer60_embed_6</title>
<polygon fill="#fff0e6" stroke="black" points="434.5,-38931.74 262.5,-38931.74 262.5,-38863.74 434.5,-38863.74 434.5,-38931.74"/>
<text text-anchor="middle" x="348.5" y="-38916.54" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="348.5" y="-38901.54" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="348.5" y="-38886.54" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="348.5" y="-38871.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage3&#45;&gt;layer60_embed_6 -->
<g id="edge1940" class="edge">
<title>split_stage3&#45;&gt;layer60_embed_6</title>
<path fill="none" stroke="black" d="M348.5,-39017.55C348.5,-39017.55 348.5,-38941.89 348.5,-38941.89"/>
<polygon fill="black" stroke="black" points="352,-38941.89 348.5,-38931.89 345,-38941.89 352,-38941.89"/>
</g>
<!-- layer60_embed_7 -->
<g id="node1519" class="node">
<title>layer60_embed_7</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-38931.74 470.5,-38931.74 470.5,-38863.74 642.5,-38863.74 642.5,-38931.74"/>
<text text-anchor="middle" x="556.5" y="-38916.54" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="556.5" y="-38901.54" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="556.5" y="-38886.54" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="556.5" y="-38871.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- split_stage3&#45;&gt;layer60_embed_7 -->
<g id="edge1941" class="edge">
<title>split_stage3&#45;&gt;layer60_embed_7</title>
<path fill="none" stroke="black" d="M556.5,-39017.55C556.5,-39017.55 556.5,-38941.89 556.5,-38941.89"/>
<polygon fill="black" stroke="black" points="560,-38941.89 556.5,-38931.89 553,-38941.89 560,-38941.89"/>
</g>
<!-- embed_ag_stage3 -->
<g id="node1522" class="node">
<title>embed_ag_stage3</title>
<ellipse fill="lightblue" stroke="black" cx="416.5" cy="-38729.57" rx="124.4" ry="48.17"/>
<text text-anchor="middle" x="416.5" y="-38748.37" font-family="Times,serif" font-size="14.00">All&#45;Gather Embedding</text>
<text text-anchor="middle" x="416.5" y="-38733.37" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="416.5" y="-38718.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="416.5" y="-38703.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_embed_6&#45;&gt;embed_ag_stage3 -->
<g id="edge2582" class="edge">
<title>layer60_embed_6&#45;&gt;embed_ag_stage3</title>
<path fill="none" stroke="black" d="M363.27,-38863.71C363.27,-38863.71 363.27,-38783.15 363.27,-38783.15"/>
<polygon fill="black" stroke="black" points="366.77,-38783.15 363.27,-38773.15 359.77,-38783.15 366.77,-38783.15"/>
</g>
<!-- layer60_embed_7&#45;&gt;embed_ag_stage3 -->
<g id="edge2583" class="edge">
<title>layer60_embed_7&#45;&gt;embed_ag_stage3</title>
<path fill="none" stroke="black" d="M505.73,-38863.71C505.73,-38863.71 505.73,-38773.26 505.73,-38773.26"/>
<polygon fill="black" stroke="black" points="509.23,-38773.26 505.73,-38763.26 502.23,-38773.26 509.23,-38773.26"/>
</g>
<!-- layer60_norm_6 -->
<g id="node1520" class="node">
<title>layer60_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="397.5,-38595.41 225.5,-38595.41 225.5,-38527.41 397.5,-38527.41 397.5,-38595.41"/>
<text text-anchor="middle" x="311.5" y="-38580.21" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="311.5" y="-38565.21" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="311.5" y="-38550.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="311.5" y="-38535.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_qkv_6 -->
<g id="node1523" class="node">
<title>layer60_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="398,-38441.32 217,-38441.32 217,-38373.32 398,-38373.32 398,-38441.32"/>
<text text-anchor="middle" x="307.5" y="-38426.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="307.5" y="-38411.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="307.5" y="-38396.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="307.5" y="-38381.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer60_norm_6&#45;&gt;layer60_qkv_6 -->
<g id="edge1944" class="edge">
<title>layer60_norm_6&#45;&gt;layer60_qkv_6</title>
<path fill="none" stroke="black" d="M311.5,-38527.21C311.5,-38527.21 311.5,-38451.42 311.5,-38451.42"/>
<polygon fill="black" stroke="black" points="315,-38451.42 311.5,-38441.42 308,-38451.42 315,-38451.42"/>
</g>
<!-- layer60_norm_7 -->
<g id="node1521" class="node">
<title>layer60_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="608.5,-38595.41 436.5,-38595.41 436.5,-38527.41 608.5,-38527.41 608.5,-38595.41"/>
<text text-anchor="middle" x="522.5" y="-38580.21" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="522.5" y="-38565.21" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="522.5" y="-38550.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="522.5" y="-38535.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_qkv_7 -->
<g id="node1524" class="node">
<title>layer60_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="615,-38441.32 434,-38441.32 434,-38373.32 615,-38373.32 615,-38441.32"/>
<text text-anchor="middle" x="524.5" y="-38426.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="524.5" y="-38411.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="524.5" y="-38396.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="524.5" y="-38381.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer60_norm_7&#45;&gt;layer60_qkv_7 -->
<g id="edge1945" class="edge">
<title>layer60_norm_7&#45;&gt;layer60_qkv_7</title>
<path fill="none" stroke="black" d="M522.5,-38527.21C522.5,-38527.21 522.5,-38451.42 522.5,-38451.42"/>
<polygon fill="black" stroke="black" points="526,-38451.42 522.5,-38441.42 519,-38451.42 526,-38451.42"/>
</g>
<!-- embed_ag_stage3&#45;&gt;layer60_norm_6 -->
<g id="edge1942" class="edge">
<title>embed_ag_stage3&#45;&gt;layer60_norm_6</title>
<path fill="none" stroke="black" d="M344.77,-38690.14C344.77,-38690.14 344.77,-38605.47 344.77,-38605.47"/>
<polygon fill="black" stroke="black" points="348.27,-38605.47 344.77,-38595.47 341.27,-38605.47 348.27,-38605.47"/>
</g>
<!-- embed_ag_stage3&#45;&gt;layer60_norm_7 -->
<g id="edge1943" class="edge">
<title>embed_ag_stage3&#45;&gt;layer60_norm_7</title>
<path fill="none" stroke="black" d="M488.73,-38690.14C488.73,-38690.14 488.73,-38605.47 488.73,-38605.47"/>
<polygon fill="black" stroke="black" points="492.23,-38605.47 488.73,-38595.47 485.23,-38605.47 492.23,-38605.47"/>
</g>
<!-- layer60_qkv_ar -->
<g id="node1525" class="node">
<title>layer60_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="415.5" cy="-38253.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="415.5" y="-38272.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="415.5" y="-38257.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="415.5" y="-38242.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="415.5" y="-38227.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer60_qkv_6&#45;&gt;layer60_qkv_ar -->
<g id="edge1946" class="edge">
<title>layer60_qkv_6&#45;&gt;layer60_qkv_ar</title>
<path fill="none" stroke="black" d="M342.76,-38373.13C342.76,-38373.13 342.76,-38303.06 342.76,-38303.06"/>
<polygon fill="black" stroke="black" points="346.26,-38303.06 342.76,-38293.06 339.26,-38303.06 346.26,-38303.06"/>
</g>
<!-- layer60_qkv_7&#45;&gt;layer60_qkv_ar -->
<g id="edge1947" class="edge">
<title>layer60_qkv_7&#45;&gt;layer60_qkv_ar</title>
<path fill="none" stroke="black" d="M488.74,-38373.13C488.74,-38373.13 488.74,-38302.78 488.74,-38302.78"/>
<polygon fill="black" stroke="black" points="492.24,-38302.78 488.74,-38292.78 485.24,-38302.78 492.24,-38302.78"/>
</g>
<!-- layer60_attn_6 -->
<g id="node1526" class="node">
<title>layer60_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="397.5,-38133.16 225.5,-38133.16 225.5,-38065.16 397.5,-38065.16 397.5,-38133.16"/>
<text text-anchor="middle" x="311.5" y="-38117.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="311.5" y="-38102.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="311.5" y="-38087.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="311.5" y="-38072.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer60_qkv_ar&#45;&gt;layer60_attn_6 -->
<g id="edge1948" class="edge">
<title>layer60_qkv_ar&#45;&gt;layer60_attn_6</title>
<path fill="none" stroke="black" d="M342.51,-38213.56C342.51,-38213.56 342.51,-38143.21 342.51,-38143.21"/>
<polygon fill="black" stroke="black" points="346.01,-38143.21 342.51,-38133.21 339.01,-38143.21 346.01,-38143.21"/>
</g>
<!-- layer60_attn_7 -->
<g id="node1527" class="node">
<title>layer60_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="605.5,-38133.16 433.5,-38133.16 433.5,-38065.16 605.5,-38065.16 605.5,-38133.16"/>
<text text-anchor="middle" x="519.5" y="-38117.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="519.5" y="-38102.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="519.5" y="-38087.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="519.5" y="-38072.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer60_qkv_ar&#45;&gt;layer60_attn_7 -->
<g id="edge1949" class="edge">
<title>layer60_qkv_ar&#45;&gt;layer60_attn_7</title>
<path fill="none" stroke="black" d="M488.49,-38213.56C488.49,-38213.56 488.49,-38143.21 488.49,-38143.21"/>
<polygon fill="black" stroke="black" points="491.99,-38143.21 488.49,-38133.21 484.99,-38143.21 491.99,-38143.21"/>
</g>
<!-- layer60_attn_out_6 -->
<g id="node1528" class="node">
<title>layer60_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="397.5,-37993.16 225.5,-37993.16 225.5,-37925.16 397.5,-37925.16 397.5,-37993.16"/>
<text text-anchor="middle" x="311.5" y="-37977.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="311.5" y="-37962.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="311.5" y="-37947.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="311.5" y="-37932.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer60_attn_6&#45;&gt;layer60_attn_out_6 -->
<g id="edge1950" class="edge">
<title>layer60_attn_6&#45;&gt;layer60_attn_out_6</title>
<path fill="none" stroke="black" d="M311.5,-38064.91C311.5,-38064.91 311.5,-38003.53 311.5,-38003.53"/>
<polygon fill="black" stroke="black" points="315,-38003.53 311.5,-37993.53 308,-38003.53 315,-38003.53"/>
</g>
<!-- layer60_attn_out_7 -->
<g id="node1529" class="node">
<title>layer60_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="605.5,-37993.16 433.5,-37993.16 433.5,-37925.16 605.5,-37925.16 605.5,-37993.16"/>
<text text-anchor="middle" x="519.5" y="-37977.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="519.5" y="-37962.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="519.5" y="-37947.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="519.5" y="-37932.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer60_attn_7&#45;&gt;layer60_attn_out_7 -->
<g id="edge1951" class="edge">
<title>layer60_attn_7&#45;&gt;layer60_attn_out_7</title>
<path fill="none" stroke="black" d="M519.5,-38064.91C519.5,-38064.91 519.5,-38003.53 519.5,-38003.53"/>
<polygon fill="black" stroke="black" points="523,-38003.53 519.5,-37993.53 516,-38003.53 523,-38003.53"/>
</g>
<!-- layer60_attn_ar -->
<g id="node1530" class="node">
<title>layer60_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="415.5" cy="-37805.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="415.5" y="-37823.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="415.5" y="-37808.87" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="415.5" y="-37793.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="415.5" y="-37778.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_attn_out_6&#45;&gt;layer60_attn_ar -->
<g id="edge1952" class="edge">
<title>layer60_attn_out_6&#45;&gt;layer60_attn_ar</title>
<path fill="none" stroke="black" d="M345.69,-37924.96C345.69,-37924.96 345.69,-37854.61 345.69,-37854.61"/>
<polygon fill="black" stroke="black" points="349.19,-37854.61 345.69,-37844.61 342.19,-37854.61 349.19,-37854.61"/>
</g>
<!-- layer60_attn_out_7&#45;&gt;layer60_attn_ar -->
<g id="edge1953" class="edge">
<title>layer60_attn_out_7&#45;&gt;layer60_attn_ar</title>
<path fill="none" stroke="black" d="M485.31,-37924.96C485.31,-37924.96 485.31,-37854.61 485.31,-37854.61"/>
<polygon fill="black" stroke="black" points="488.81,-37854.61 485.31,-37844.61 481.81,-37854.61 488.81,-37854.61"/>
</g>
<!-- layer60_ffn_norm_6 -->
<g id="node1531" class="node">
<title>layer60_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="393.5,-37684.99 221.5,-37684.99 221.5,-37616.99 393.5,-37616.99 393.5,-37684.99"/>
<text text-anchor="middle" x="307.5" y="-37669.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="307.5" y="-37654.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="307.5" y="-37639.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="307.5" y="-37624.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_attn_ar&#45;&gt;layer60_ffn_norm_6 -->
<g id="edge1954" class="edge">
<title>layer60_attn_ar&#45;&gt;layer60_ffn_norm_6</title>
<path fill="none" stroke="black" d="M343.69,-37766.19C343.69,-37766.19 343.69,-37695.14 343.69,-37695.14"/>
<polygon fill="black" stroke="black" points="347.19,-37695.14 343.69,-37685.14 340.19,-37695.14 347.19,-37695.14"/>
</g>
<!-- layer60_ffn_norm_7 -->
<g id="node1532" class="node">
<title>layer60_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="610.5,-37684.99 438.5,-37684.99 438.5,-37616.99 610.5,-37616.99 610.5,-37684.99"/>
<text text-anchor="middle" x="524.5" y="-37669.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="524.5" y="-37654.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="524.5" y="-37639.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="524.5" y="-37624.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_attn_ar&#45;&gt;layer60_ffn_norm_7 -->
<g id="edge1955" class="edge">
<title>layer60_attn_ar&#45;&gt;layer60_ffn_norm_7</title>
<path fill="none" stroke="black" d="M487.81,-37766.19C487.81,-37766.19 487.81,-37695.14 487.81,-37695.14"/>
<polygon fill="black" stroke="black" points="491.31,-37695.14 487.81,-37685.14 484.31,-37695.14 491.31,-37695.14"/>
</g>
<!-- layer60_ffn_gate_6 -->
<g id="node1533" class="node">
<title>layer60_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="398,-37544.99 217,-37544.99 217,-37476.99 398,-37476.99 398,-37544.99"/>
<text text-anchor="middle" x="307.5" y="-37529.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="307.5" y="-37514.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="307.5" y="-37499.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="307.5" y="-37484.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_ffn_norm_6&#45;&gt;layer60_ffn_gate_6 -->
<g id="edge1956" class="edge">
<title>layer60_ffn_norm_6&#45;&gt;layer60_ffn_gate_6</title>
<path fill="none" stroke="black" d="M307.5,-37616.74C307.5,-37616.74 307.5,-37555.37 307.5,-37555.37"/>
<polygon fill="black" stroke="black" points="311,-37555.37 307.5,-37545.37 304,-37555.37 311,-37555.37"/>
</g>
<!-- layer60_ffn_up_6 -->
<g id="node1535" class="node">
<title>layer60_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="181,-37544.99 0,-37544.99 0,-37476.99 181,-37476.99 181,-37544.99"/>
<text text-anchor="middle" x="90.5" y="-37529.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="90.5" y="-37514.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="90.5" y="-37499.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="90.5" y="-37484.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_ffn_norm_6&#45;&gt;layer60_ffn_up_6 -->
<g id="edge1958" class="edge">
<title>layer60_ffn_norm_6&#45;&gt;layer60_ffn_up_6</title>
<path fill="none" stroke="black" d="M221.32,-37650C196.28,-37650 175.54,-37650 175.54,-37650 175.54,-37650 175.54,-37554.99 175.54,-37554.99"/>
<polygon fill="black" stroke="black" points="179.04,-37554.99 175.54,-37544.99 172.04,-37554.99 179.04,-37554.99"/>
</g>
<!-- layer60_ffn_gate_7 -->
<g id="node1534" class="node">
<title>layer60_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="832,-37544.99 651,-37544.99 651,-37476.99 832,-37476.99 832,-37544.99"/>
<text text-anchor="middle" x="741.5" y="-37529.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="741.5" y="-37514.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="741.5" y="-37499.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="741.5" y="-37484.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_ffn_norm_7&#45;&gt;layer60_ffn_gate_7 -->
<g id="edge1957" class="edge">
<title>layer60_ffn_norm_7&#45;&gt;layer60_ffn_gate_7</title>
<path fill="none" stroke="black" d="M610.58,-37650C671.16,-37650 741.5,-37650 741.5,-37650 741.5,-37650 741.5,-37554.99 741.5,-37554.99"/>
<polygon fill="black" stroke="black" points="745,-37554.99 741.5,-37544.99 738,-37554.99 745,-37554.99"/>
</g>
<!-- layer60_ffn_up_7 -->
<g id="node1536" class="node">
<title>layer60_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="615,-37544.99 434,-37544.99 434,-37476.99 615,-37476.99 615,-37544.99"/>
<text text-anchor="middle" x="524.5" y="-37529.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="524.5" y="-37514.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="524.5" y="-37499.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="524.5" y="-37484.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_ffn_norm_7&#45;&gt;layer60_ffn_up_7 -->
<g id="edge1959" class="edge">
<title>layer60_ffn_norm_7&#45;&gt;layer60_ffn_up_7</title>
<path fill="none" stroke="black" d="M524.5,-37616.74C524.5,-37616.74 524.5,-37555.37 524.5,-37555.37"/>
<polygon fill="black" stroke="black" points="528,-37555.37 524.5,-37545.37 521,-37555.37 528,-37555.37"/>
</g>
<!-- layer60_gate_ar -->
<g id="node1537" class="node">
<title>layer60_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="615.5" cy="-37356.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="615.5" y="-37375.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="615.5" y="-37360.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="615.5" y="-37345.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="615.5" y="-37330.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer60_ffn_gate_6&#45;&gt;layer60_gate_ar -->
<g id="edge1960" class="edge">
<title>layer60_ffn_gate_6&#45;&gt;layer60_gate_ar</title>
<path fill="none" stroke="black" d="M398.08,-37510C408.79,-37510 416,-37510 416,-37510 416,-37510 416,-37372 416,-37372 416,-37372 483.7,-37372 483.7,-37372"/>
<polygon fill="black" stroke="black" points="483.7,-37375.5 493.7,-37372 483.7,-37368.5 483.7,-37375.5"/>
</g>
<!-- layer60_ffn_gate_7&#45;&gt;layer60_gate_ar -->
<g id="edge1961" class="edge">
<title>layer60_ffn_gate_7&#45;&gt;layer60_gate_ar</title>
<path fill="none" stroke="black" d="M697.24,-37476.79C697.24,-37476.79 697.24,-37403.97 697.24,-37403.97"/>
<polygon fill="black" stroke="black" points="700.74,-37403.97 697.24,-37393.97 693.74,-37403.97 700.74,-37403.97"/>
</g>
<!-- layer60_up_ar -->
<g id="node1538" class="node">
<title>layer60_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="269.5" cy="-37356.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="269.5" y="-37375.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="269.5" y="-37360.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="269.5" y="-37345.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="269.5" y="-37330.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer60_ffn_up_6&#45;&gt;layer60_up_ar -->
<g id="edge1962" class="edge">
<title>layer60_ffn_up_6&#45;&gt;layer60_up_ar</title>
<path fill="none" stroke="black" d="M161.26,-37476.79C161.26,-37476.79 161.26,-37392.87 161.26,-37392.87"/>
<polygon fill="black" stroke="black" points="164.76,-37392.87 161.26,-37382.87 157.76,-37392.87 164.76,-37392.87"/>
</g>
<!-- layer60_ffn_up_7&#45;&gt;layer60_up_ar -->
<g id="edge1963" class="edge">
<title>layer60_ffn_up_7&#45;&gt;layer60_up_ar</title>
<path fill="none" stroke="black" d="M460.76,-37476.8C460.76,-37426.9 460.76,-37340 460.76,-37340 460.76,-37340 399.54,-37340 399.54,-37340"/>
<polygon fill="black" stroke="black" points="399.54,-37336.5 389.54,-37340 399.54,-37343.5 399.54,-37336.5"/>
</g>
<!-- layer60_silu_6 -->
<g id="node1539" class="node">
<title>layer60_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="543,-37236.82 362,-37236.82 362,-37168.82 543,-37168.82 543,-37236.82"/>
<text text-anchor="middle" x="452.5" y="-37221.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="452.5" y="-37206.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="452.5" y="-37191.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="452.5" y="-37176.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_gate_ar&#45;&gt;layer60_silu_6 -->
<g id="edge1964" class="edge">
<title>layer60_gate_ar&#45;&gt;layer60_silu_6</title>
<path fill="none" stroke="black" d="M515.26,-37326.83C515.26,-37326.83 515.26,-37246.84 515.26,-37246.84"/>
<polygon fill="black" stroke="black" points="518.76,-37246.84 515.26,-37236.84 511.76,-37246.84 518.76,-37246.84"/>
</g>
<!-- layer60_silu_7 -->
<g id="node1540" class="node">
<title>layer60_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="760,-37236.82 579,-37236.82 579,-37168.82 760,-37168.82 760,-37236.82"/>
<text text-anchor="middle" x="669.5" y="-37221.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="669.5" y="-37206.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="669.5" y="-37191.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="669.5" y="-37176.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_gate_ar&#45;&gt;layer60_silu_7 -->
<g id="edge1965" class="edge">
<title>layer60_gate_ar&#45;&gt;layer60_silu_7</title>
<path fill="none" stroke="black" d="M661.24,-37311.92C661.24,-37311.92 661.24,-37246.83 661.24,-37246.83"/>
<polygon fill="black" stroke="black" points="664.74,-37246.83 661.24,-37236.83 657.74,-37246.83 664.74,-37246.83"/>
</g>
<!-- layer60_mul_6 -->
<g id="node1541" class="node">
<title>layer60_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="433,-37096.82 252,-37096.82 252,-37028.82 433,-37028.82 433,-37096.82"/>
<text text-anchor="middle" x="342.5" y="-37081.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="342.5" y="-37066.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="342.5" y="-37051.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="342.5" y="-37036.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_up_ar&#45;&gt;layer60_mul_6 -->
<g id="edge1967" class="edge">
<title>layer60_up_ar&#45;&gt;layer60_mul_6</title>
<path fill="none" stroke="black" d="M307,-37310.63C307,-37310.63 307,-37106.91 307,-37106.91"/>
<polygon fill="black" stroke="black" points="310.5,-37106.91 307,-37096.91 303.5,-37106.91 310.5,-37106.91"/>
</g>
<!-- layer60_mul_7 -->
<g id="node1542" class="node">
<title>layer60_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="650,-37096.82 469,-37096.82 469,-37028.82 650,-37028.82 650,-37096.82"/>
<text text-anchor="middle" x="559.5" y="-37081.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="559.5" y="-37066.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="559.5" y="-37051.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="559.5" y="-37036.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer60_up_ar&#45;&gt;layer60_mul_7 -->
<g id="edge1969" class="edge">
<title>layer60_up_ar&#45;&gt;layer60_mul_7</title>
<path fill="none" stroke="black" d="M379.74,-37332.35C379.74,-37307.27 379.74,-37272 379.74,-37272 379.74,-37272 561,-37272 561,-37272 561,-37272 561,-37106.9 561,-37106.9"/>
<polygon fill="black" stroke="black" points="564.5,-37106.9 561,-37096.9 557.5,-37106.9 564.5,-37106.9"/>
</g>
<!-- layer60_silu_6&#45;&gt;layer60_mul_6 -->
<g id="edge1966" class="edge">
<title>layer60_silu_6&#45;&gt;layer60_mul_6</title>
<path fill="none" stroke="black" d="M397.5,-37168.57C397.5,-37168.57 397.5,-37107.2 397.5,-37107.2"/>
<polygon fill="black" stroke="black" points="401,-37107.2 397.5,-37097.2 394,-37107.2 401,-37107.2"/>
</g>
<!-- layer60_silu_7&#45;&gt;layer60_mul_7 -->
<g id="edge1968" class="edge">
<title>layer60_silu_7&#45;&gt;layer60_mul_7</title>
<path fill="none" stroke="black" d="M614.5,-37168.57C614.5,-37168.57 614.5,-37107.2 614.5,-37107.2"/>
<polygon fill="black" stroke="black" points="618,-37107.2 614.5,-37097.2 611,-37107.2 618,-37107.2"/>
</g>
<!-- layer60_ffn_down_6 -->
<g id="node1543" class="node">
<title>layer60_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="432.5,-36956.82 260.5,-36956.82 260.5,-36888.82 432.5,-36888.82 432.5,-36956.82"/>
<text text-anchor="middle" x="346.5" y="-36941.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="346.5" y="-36926.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="346.5" y="-36911.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="346.5" y="-36896.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer60_mul_6&#45;&gt;layer60_ffn_down_6 -->
<g id="edge1970" class="edge">
<title>layer60_mul_6&#45;&gt;layer60_ffn_down_6</title>
<path fill="none" stroke="black" d="M346.5,-37028.57C346.5,-37028.57 346.5,-36967.2 346.5,-36967.2"/>
<polygon fill="black" stroke="black" points="350,-36967.2 346.5,-36957.2 343,-36967.2 350,-36967.2"/>
</g>
<!-- layer60_ffn_down_7 -->
<g id="node1544" class="node">
<title>layer60_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-36956.82 470.5,-36956.82 470.5,-36888.82 642.5,-36888.82 642.5,-36956.82"/>
<text text-anchor="middle" x="556.5" y="-36941.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="556.5" y="-36926.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="556.5" y="-36911.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="556.5" y="-36896.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer60_mul_7&#45;&gt;layer60_ffn_down_7 -->
<g id="edge1971" class="edge">
<title>layer60_mul_7&#45;&gt;layer60_ffn_down_7</title>
<path fill="none" stroke="black" d="M556.5,-37028.57C556.5,-37028.57 556.5,-36967.2 556.5,-36967.2"/>
<polygon fill="black" stroke="black" points="560,-36967.2 556.5,-36957.2 553,-36967.2 560,-36967.2"/>
</g>
<!-- layer60_ffn_ar -->
<g id="node1545" class="node">
<title>layer60_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="450.5" cy="-36768.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="450.5" y="-36787.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="450.5" y="-36772.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="450.5" y="-36757.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="450.5" y="-36742.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_ffn_down_6&#45;&gt;layer60_ffn_ar -->
<g id="edge1972" class="edge">
<title>layer60_ffn_down_6&#45;&gt;layer60_ffn_ar</title>
<path fill="none" stroke="black" d="M380.69,-36888.63C380.69,-36888.63 380.69,-36818.28 380.69,-36818.28"/>
<polygon fill="black" stroke="black" points="384.19,-36818.28 380.69,-36808.28 377.19,-36818.28 384.19,-36818.28"/>
</g>
<!-- layer60_ffn_down_7&#45;&gt;layer60_ffn_ar -->
<g id="edge1973" class="edge">
<title>layer60_ffn_down_7&#45;&gt;layer60_ffn_ar</title>
<path fill="none" stroke="black" d="M521.31,-36888.63C521.31,-36888.63 521.31,-36818 521.31,-36818"/>
<polygon fill="black" stroke="black" points="524.81,-36818 521.31,-36808 517.81,-36818 524.81,-36818"/>
</g>
<!-- layer61_norm_6 -->
<g id="node1546" class="node">
<title>layer61_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="432.5,-36648.66 260.5,-36648.66 260.5,-36580.66 432.5,-36580.66 432.5,-36648.66"/>
<text text-anchor="middle" x="346.5" y="-36633.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="346.5" y="-36618.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="346.5" y="-36603.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="346.5" y="-36588.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_ffn_ar&#45;&gt;layer61_norm_6 -->
<g id="edge1974" class="edge">
<title>layer60_ffn_ar&#45;&gt;layer61_norm_6</title>
<path fill="none" stroke="black" d="M380.69,-36729.06C380.69,-36729.06 380.69,-36658.71 380.69,-36658.71"/>
<polygon fill="black" stroke="black" points="384.19,-36658.71 380.69,-36648.71 377.19,-36658.71 384.19,-36658.71"/>
</g>
<!-- layer61_norm_7 -->
<g id="node1547" class="node">
<title>layer61_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-36648.66 470.5,-36648.66 470.5,-36580.66 642.5,-36580.66 642.5,-36648.66"/>
<text text-anchor="middle" x="556.5" y="-36633.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="556.5" y="-36618.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="556.5" y="-36603.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="556.5" y="-36588.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer60_ffn_ar&#45;&gt;layer61_norm_7 -->
<g id="edge1975" class="edge">
<title>layer60_ffn_ar&#45;&gt;layer61_norm_7</title>
<path fill="none" stroke="black" d="M521.31,-36729.46C521.31,-36729.46 521.31,-36658.89 521.31,-36658.89"/>
<polygon fill="black" stroke="black" points="524.81,-36658.89 521.31,-36648.89 517.81,-36658.89 524.81,-36658.89"/>
</g>
<!-- layer61_qkv_6 -->
<g id="node1548" class="node">
<title>layer61_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="433,-36508.66 252,-36508.66 252,-36440.66 433,-36440.66 433,-36508.66"/>
<text text-anchor="middle" x="342.5" y="-36493.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="342.5" y="-36478.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="342.5" y="-36463.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="342.5" y="-36448.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer61_norm_6&#45;&gt;layer61_qkv_6 -->
<g id="edge1976" class="edge">
<title>layer61_norm_6&#45;&gt;layer61_qkv_6</title>
<path fill="none" stroke="black" d="M346.5,-36580.41C346.5,-36580.41 346.5,-36519.04 346.5,-36519.04"/>
<polygon fill="black" stroke="black" points="350,-36519.04 346.5,-36509.04 343,-36519.04 350,-36519.04"/>
</g>
<!-- layer61_qkv_7 -->
<g id="node1549" class="node">
<title>layer61_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="650,-36508.66 469,-36508.66 469,-36440.66 650,-36440.66 650,-36508.66"/>
<text text-anchor="middle" x="559.5" y="-36493.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="559.5" y="-36478.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="559.5" y="-36463.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="559.5" y="-36448.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer61_norm_7&#45;&gt;layer61_qkv_7 -->
<g id="edge1977" class="edge">
<title>layer61_norm_7&#45;&gt;layer61_qkv_7</title>
<path fill="none" stroke="black" d="M556.5,-36580.41C556.5,-36580.41 556.5,-36519.04 556.5,-36519.04"/>
<polygon fill="black" stroke="black" points="560,-36519.04 556.5,-36509.04 553,-36519.04 560,-36519.04"/>
</g>
<!-- layer61_qkv_ar -->
<g id="node1550" class="node">
<title>layer61_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="450.5" cy="-36320.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="450.5" y="-36339.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="450.5" y="-36324.37" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="450.5" y="-36309.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="450.5" y="-36294.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer61_qkv_6&#45;&gt;layer61_qkv_ar -->
<g id="edge1978" class="edge">
<title>layer61_qkv_6&#45;&gt;layer61_qkv_ar</title>
<path fill="none" stroke="black" d="M377.76,-36440.46C377.76,-36440.46 377.76,-36370.39 377.76,-36370.39"/>
<polygon fill="black" stroke="black" points="381.26,-36370.39 377.76,-36360.39 374.26,-36370.39 381.26,-36370.39"/>
</g>
<!-- layer61_qkv_7&#45;&gt;layer61_qkv_ar -->
<g id="edge1979" class="edge">
<title>layer61_qkv_7&#45;&gt;layer61_qkv_ar</title>
<path fill="none" stroke="black" d="M523.74,-36440.46C523.74,-36440.46 523.74,-36370.12 523.74,-36370.12"/>
<polygon fill="black" stroke="black" points="527.24,-36370.12 523.74,-36360.12 520.24,-36370.12 527.24,-36370.12"/>
</g>
<!-- layer61_attn_6 -->
<g id="node1551" class="node">
<title>layer61_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="432.5,-36200.49 260.5,-36200.49 260.5,-36132.49 432.5,-36132.49 432.5,-36200.49"/>
<text text-anchor="middle" x="346.5" y="-36185.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="346.5" y="-36170.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="346.5" y="-36155.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="346.5" y="-36140.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer61_qkv_ar&#45;&gt;layer61_attn_6 -->
<g id="edge1980" class="edge">
<title>layer61_qkv_ar&#45;&gt;layer61_attn_6</title>
<path fill="none" stroke="black" d="M377.51,-36280.89C377.51,-36280.89 377.51,-36210.55 377.51,-36210.55"/>
<polygon fill="black" stroke="black" points="381.01,-36210.55 377.51,-36200.55 374.01,-36210.55 381.01,-36210.55"/>
</g>
<!-- layer61_attn_7 -->
<g id="node1552" class="node">
<title>layer61_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="640.5,-36200.49 468.5,-36200.49 468.5,-36132.49 640.5,-36132.49 640.5,-36200.49"/>
<text text-anchor="middle" x="554.5" y="-36185.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="554.5" y="-36170.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="554.5" y="-36155.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="554.5" y="-36140.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer61_qkv_ar&#45;&gt;layer61_attn_7 -->
<g id="edge1981" class="edge">
<title>layer61_qkv_ar&#45;&gt;layer61_attn_7</title>
<path fill="none" stroke="black" d="M523.49,-36280.89C523.49,-36280.89 523.49,-36210.55 523.49,-36210.55"/>
<polygon fill="black" stroke="black" points="526.99,-36210.55 523.49,-36200.55 519.99,-36210.55 526.99,-36210.55"/>
</g>
<!-- layer61_attn_out_6 -->
<g id="node1553" class="node">
<title>layer61_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="432.5,-36060.49 260.5,-36060.49 260.5,-35992.49 432.5,-35992.49 432.5,-36060.49"/>
<text text-anchor="middle" x="346.5" y="-36045.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="346.5" y="-36030.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="346.5" y="-36015.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="346.5" y="-36000.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer61_attn_6&#45;&gt;layer61_attn_out_6 -->
<g id="edge1982" class="edge">
<title>layer61_attn_6&#45;&gt;layer61_attn_out_6</title>
<path fill="none" stroke="black" d="M346.5,-36132.24C346.5,-36132.24 346.5,-36070.87 346.5,-36070.87"/>
<polygon fill="black" stroke="black" points="350,-36070.87 346.5,-36060.87 343,-36070.87 350,-36070.87"/>
</g>
<!-- layer61_attn_out_7 -->
<g id="node1554" class="node">
<title>layer61_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="640.5,-36060.49 468.5,-36060.49 468.5,-35992.49 640.5,-35992.49 640.5,-36060.49"/>
<text text-anchor="middle" x="554.5" y="-36045.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="554.5" y="-36030.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="554.5" y="-36015.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="554.5" y="-36000.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer61_attn_7&#45;&gt;layer61_attn_out_7 -->
<g id="edge1983" class="edge">
<title>layer61_attn_7&#45;&gt;layer61_attn_out_7</title>
<path fill="none" stroke="black" d="M554.5,-36132.24C554.5,-36132.24 554.5,-36070.87 554.5,-36070.87"/>
<polygon fill="black" stroke="black" points="558,-36070.87 554.5,-36060.87 551,-36070.87 558,-36070.87"/>
</g>
<!-- layer61_attn_ar -->
<g id="node1555" class="node">
<title>layer61_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="450.5" cy="-35872.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="450.5" y="-35891.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="450.5" y="-35876.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="450.5" y="-35861.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="450.5" y="-35846.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer61_attn_out_6&#45;&gt;layer61_attn_ar -->
<g id="edge1984" class="edge">
<title>layer61_attn_out_6&#45;&gt;layer61_attn_ar</title>
<path fill="none" stroke="black" d="M380.69,-35992.29C380.69,-35992.29 380.69,-35921.95 380.69,-35921.95"/>
<polygon fill="black" stroke="black" points="384.19,-35921.95 380.69,-35911.95 377.19,-35921.95 384.19,-35921.95"/>
</g>
<!-- layer61_attn_out_7&#45;&gt;layer61_attn_ar -->
<g id="edge1985" class="edge">
<title>layer61_attn_out_7&#45;&gt;layer61_attn_ar</title>
<path fill="none" stroke="black" d="M520.31,-35992.29C520.31,-35992.29 520.31,-35921.95 520.31,-35921.95"/>
<polygon fill="black" stroke="black" points="523.81,-35921.95 520.31,-35911.95 516.81,-35921.95 523.81,-35921.95"/>
</g>
<!-- layer61_ffn_norm_6 -->
<g id="node1556" class="node">
<title>layer61_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="428.5,-35752.32 256.5,-35752.32 256.5,-35684.32 428.5,-35684.32 428.5,-35752.32"/>
<text text-anchor="middle" x="342.5" y="-35737.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="342.5" y="-35722.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="342.5" y="-35707.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="342.5" y="-35692.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer61_attn_ar&#45;&gt;layer61_ffn_norm_6 -->
<g id="edge1986" class="edge">
<title>layer61_attn_ar&#45;&gt;layer61_ffn_norm_6</title>
<path fill="none" stroke="black" d="M378.69,-35833.52C378.69,-35833.52 378.69,-35762.47 378.69,-35762.47"/>
<polygon fill="black" stroke="black" points="382.19,-35762.47 378.69,-35752.47 375.19,-35762.47 382.19,-35762.47"/>
</g>
<!-- layer61_ffn_norm_7 -->
<g id="node1557" class="node">
<title>layer61_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="645.5,-35752.32 473.5,-35752.32 473.5,-35684.32 645.5,-35684.32 645.5,-35752.32"/>
<text text-anchor="middle" x="559.5" y="-35737.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="559.5" y="-35722.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="559.5" y="-35707.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="559.5" y="-35692.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer61_attn_ar&#45;&gt;layer61_ffn_norm_7 -->
<g id="edge1987" class="edge">
<title>layer61_attn_ar&#45;&gt;layer61_ffn_norm_7</title>
<path fill="none" stroke="black" d="M522.81,-35833.52C522.81,-35833.52 522.81,-35762.47 522.81,-35762.47"/>
<polygon fill="black" stroke="black" points="526.31,-35762.47 522.81,-35752.47 519.31,-35762.47 526.31,-35762.47"/>
</g>
<!-- layer61_ffn_gate_6 -->
<g id="node1558" class="node">
<title>layer61_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="433,-35612.32 252,-35612.32 252,-35544.32 433,-35544.32 433,-35612.32"/>
<text text-anchor="middle" x="342.5" y="-35597.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="342.5" y="-35582.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="342.5" y="-35567.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="342.5" y="-35552.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_ffn_norm_6&#45;&gt;layer61_ffn_gate_6 -->
<g id="edge1988" class="edge">
<title>layer61_ffn_norm_6&#45;&gt;layer61_ffn_gate_6</title>
<path fill="none" stroke="black" d="M342.5,-35684.07C342.5,-35684.07 342.5,-35622.7 342.5,-35622.7"/>
<polygon fill="black" stroke="black" points="346,-35622.7 342.5,-35612.7 339,-35622.7 346,-35622.7"/>
</g>
<!-- layer61_ffn_up_6 -->
<g id="node1560" class="node">
<title>layer61_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="216,-35612.32 35,-35612.32 35,-35544.32 216,-35544.32 216,-35612.32"/>
<text text-anchor="middle" x="125.5" y="-35597.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="125.5" y="-35582.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="125.5" y="-35567.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="125.5" y="-35552.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_ffn_norm_6&#45;&gt;layer61_ffn_up_6 -->
<g id="edge1990" class="edge">
<title>layer61_ffn_norm_6&#45;&gt;layer61_ffn_up_6</title>
<path fill="none" stroke="black" d="M256.31,-35718C216.86,-35718 178.76,-35718 178.76,-35718 178.76,-35718 178.76,-35622.49 178.76,-35622.49"/>
<polygon fill="black" stroke="black" points="182.26,-35622.49 178.76,-35612.49 175.26,-35622.49 182.26,-35622.49"/>
</g>
<!-- layer61_ffn_gate_7 -->
<g id="node1559" class="node">
<title>layer61_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="867,-35612.32 686,-35612.32 686,-35544.32 867,-35544.32 867,-35612.32"/>
<text text-anchor="middle" x="776.5" y="-35597.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="776.5" y="-35582.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="776.5" y="-35567.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="776.5" y="-35552.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_ffn_norm_7&#45;&gt;layer61_ffn_gate_7 -->
<g id="edge1989" class="edge">
<title>layer61_ffn_norm_7&#45;&gt;layer61_ffn_gate_7</title>
<path fill="none" stroke="black" d="M645.56,-35718C684.95,-35718 723,-35718 723,-35718 723,-35718 723,-35622.49 723,-35622.49"/>
<polygon fill="black" stroke="black" points="726.5,-35622.49 723,-35612.49 719.5,-35622.49 726.5,-35622.49"/>
</g>
<!-- layer61_ffn_up_7 -->
<g id="node1561" class="node">
<title>layer61_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="650,-35612.32 469,-35612.32 469,-35544.32 650,-35544.32 650,-35612.32"/>
<text text-anchor="middle" x="559.5" y="-35597.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="559.5" y="-35582.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="559.5" y="-35567.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="559.5" y="-35552.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_ffn_norm_7&#45;&gt;layer61_ffn_up_7 -->
<g id="edge1991" class="edge">
<title>layer61_ffn_norm_7&#45;&gt;layer61_ffn_up_7</title>
<path fill="none" stroke="black" d="M559.5,-35684.07C559.5,-35684.07 559.5,-35622.7 559.5,-35622.7"/>
<polygon fill="black" stroke="black" points="563,-35622.7 559.5,-35612.7 556,-35622.7 563,-35622.7"/>
</g>
<!-- layer61_gate_ar -->
<g id="node1562" class="node">
<title>layer61_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="650.5" cy="-35424.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="650.5" y="-35443.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="650.5" y="-35428.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="650.5" y="-35413.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="650.5" y="-35398.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer61_ffn_gate_6&#45;&gt;layer61_gate_ar -->
<g id="edge1992" class="edge">
<title>layer61_ffn_gate_6&#45;&gt;layer61_gate_ar</title>
<path fill="none" stroke="black" d="M433.08,-35578C443.79,-35578 451,-35578 451,-35578 451,-35578 451,-35440 451,-35440 451,-35440 519.56,-35440 519.56,-35440"/>
<polygon fill="black" stroke="black" points="519.56,-35443.5 529.56,-35440 519.56,-35436.5 519.56,-35443.5"/>
</g>
<!-- layer61_ffn_gate_7&#45;&gt;layer61_gate_ar -->
<g id="edge1993" class="edge">
<title>layer61_ffn_gate_7&#45;&gt;layer61_gate_ar</title>
<path fill="none" stroke="black" d="M732.24,-35544.13C732.24,-35544.13 732.24,-35471.3 732.24,-35471.3"/>
<polygon fill="black" stroke="black" points="735.74,-35471.3 732.24,-35461.3 728.74,-35471.3 735.74,-35471.3"/>
</g>
<!-- layer61_up_ar -->
<g id="node1563" class="node">
<title>layer61_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="304.5" cy="-35424.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="304.5" y="-35443.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="304.5" y="-35428.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="304.5" y="-35413.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="304.5" y="-35398.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer61_ffn_up_6&#45;&gt;layer61_up_ar -->
<g id="edge1994" class="edge">
<title>layer61_ffn_up_6&#45;&gt;layer61_up_ar</title>
<path fill="none" stroke="black" d="M196.26,-35544.13C196.26,-35544.13 196.26,-35460.2 196.26,-35460.2"/>
<polygon fill="black" stroke="black" points="199.76,-35460.2 196.26,-35450.2 192.76,-35460.2 199.76,-35460.2"/>
</g>
<!-- layer61_ffn_up_7&#45;&gt;layer61_up_ar -->
<g id="edge1995" class="edge">
<title>layer61_ffn_up_7&#45;&gt;layer61_up_ar</title>
<path fill="none" stroke="black" d="M495.76,-35544.26C495.76,-35494.56 495.76,-35408 495.76,-35408 495.76,-35408 435.08,-35408 435.08,-35408"/>
<polygon fill="black" stroke="black" points="435.08,-35404.5 425.08,-35408 435.08,-35411.5 435.08,-35404.5"/>
</g>
<!-- layer61_silu_6 -->
<g id="node1564" class="node">
<title>layer61_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="578,-35304.16 397,-35304.16 397,-35236.16 578,-35236.16 578,-35304.16"/>
<text text-anchor="middle" x="487.5" y="-35288.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="487.5" y="-35273.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="487.5" y="-35258.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="487.5" y="-35243.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_gate_ar&#45;&gt;layer61_silu_6 -->
<g id="edge1996" class="edge">
<title>layer61_gate_ar&#45;&gt;layer61_silu_6</title>
<path fill="none" stroke="black" d="M550.26,-35394.16C550.26,-35394.16 550.26,-35314.18 550.26,-35314.18"/>
<polygon fill="black" stroke="black" points="553.76,-35314.18 550.26,-35304.18 546.76,-35314.18 553.76,-35314.18"/>
</g>
<!-- layer61_silu_7 -->
<g id="node1565" class="node">
<title>layer61_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="795,-35304.16 614,-35304.16 614,-35236.16 795,-35236.16 795,-35304.16"/>
<text text-anchor="middle" x="704.5" y="-35288.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="704.5" y="-35273.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="704.5" y="-35258.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="704.5" y="-35243.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_gate_ar&#45;&gt;layer61_silu_7 -->
<g id="edge1997" class="edge">
<title>layer61_gate_ar&#45;&gt;layer61_silu_7</title>
<path fill="none" stroke="black" d="M696.24,-35379.26C696.24,-35379.26 696.24,-35314.16 696.24,-35314.16"/>
<polygon fill="black" stroke="black" points="699.74,-35314.16 696.24,-35304.16 692.74,-35314.16 699.74,-35314.16"/>
</g>
<!-- layer61_mul_6 -->
<g id="node1566" class="node">
<title>layer61_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="468,-35164.16 287,-35164.16 287,-35096.16 468,-35096.16 468,-35164.16"/>
<text text-anchor="middle" x="377.5" y="-35148.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="377.5" y="-35133.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="377.5" y="-35118.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="377.5" y="-35103.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_up_ar&#45;&gt;layer61_mul_6 -->
<g id="edge1999" class="edge">
<title>layer61_up_ar&#45;&gt;layer61_mul_6</title>
<path fill="none" stroke="black" d="M342,-35377.97C342,-35377.97 342,-35174.24 342,-35174.24"/>
<polygon fill="black" stroke="black" points="345.5,-35174.24 342,-35164.24 338.5,-35174.24 345.5,-35174.24"/>
</g>
<!-- layer61_mul_7 -->
<g id="node1567" class="node">
<title>layer61_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="685,-35164.16 504,-35164.16 504,-35096.16 685,-35096.16 685,-35164.16"/>
<text text-anchor="middle" x="594.5" y="-35148.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="594.5" y="-35133.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="594.5" y="-35118.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="594.5" y="-35103.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer61_up_ar&#45;&gt;layer61_mul_7 -->
<g id="edge2001" class="edge">
<title>layer61_up_ar&#45;&gt;layer61_mul_7</title>
<path fill="none" stroke="black" d="M414.74,-35399.42C414.74,-35374.57 414.74,-35340 414.74,-35340 414.74,-35340 596,-35340 596,-35340 596,-35340 596,-35174.34 596,-35174.34"/>
<polygon fill="black" stroke="black" points="599.5,-35174.34 596,-35164.34 592.5,-35174.34 599.5,-35174.34"/>
</g>
<!-- layer61_silu_6&#45;&gt;layer61_mul_6 -->
<g id="edge1998" class="edge">
<title>layer61_silu_6&#45;&gt;layer61_mul_6</title>
<path fill="none" stroke="black" d="M432.5,-35235.91C432.5,-35235.91 432.5,-35174.54 432.5,-35174.54"/>
<polygon fill="black" stroke="black" points="436,-35174.54 432.5,-35164.54 429,-35174.54 436,-35174.54"/>
</g>
<!-- layer61_silu_7&#45;&gt;layer61_mul_7 -->
<g id="edge2000" class="edge">
<title>layer61_silu_7&#45;&gt;layer61_mul_7</title>
<path fill="none" stroke="black" d="M649.5,-35235.91C649.5,-35235.91 649.5,-35174.54 649.5,-35174.54"/>
<polygon fill="black" stroke="black" points="653,-35174.54 649.5,-35164.54 646,-35174.54 653,-35174.54"/>
</g>
<!-- layer61_ffn_down_6 -->
<g id="node1568" class="node">
<title>layer61_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="467.5,-35024.16 295.5,-35024.16 295.5,-34956.16 467.5,-34956.16 467.5,-35024.16"/>
<text text-anchor="middle" x="381.5" y="-35008.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="381.5" y="-34993.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="381.5" y="-34978.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="381.5" y="-34963.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer61_mul_6&#45;&gt;layer61_ffn_down_6 -->
<g id="edge2002" class="edge">
<title>layer61_mul_6&#45;&gt;layer61_ffn_down_6</title>
<path fill="none" stroke="black" d="M381.5,-35095.91C381.5,-35095.91 381.5,-35034.54 381.5,-35034.54"/>
<polygon fill="black" stroke="black" points="385,-35034.54 381.5,-35024.54 378,-35034.54 385,-35034.54"/>
</g>
<!-- layer61_ffn_down_7 -->
<g id="node1569" class="node">
<title>layer61_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="677.5,-35024.16 505.5,-35024.16 505.5,-34956.16 677.5,-34956.16 677.5,-35024.16"/>
<text text-anchor="middle" x="591.5" y="-35008.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="591.5" y="-34993.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="591.5" y="-34978.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="591.5" y="-34963.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer61_mul_7&#45;&gt;layer61_ffn_down_7 -->
<g id="edge2003" class="edge">
<title>layer61_mul_7&#45;&gt;layer61_ffn_down_7</title>
<path fill="none" stroke="black" d="M591.5,-35095.91C591.5,-35095.91 591.5,-35034.54 591.5,-35034.54"/>
<polygon fill="black" stroke="black" points="595,-35034.54 591.5,-35024.54 588,-35034.54 595,-35034.54"/>
</g>
<!-- layer61_ffn_ar -->
<g id="node1570" class="node">
<title>layer61_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="485.5" cy="-34836.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="485.5" y="-34854.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="485.5" y="-34839.87" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="485.5" y="-34824.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="485.5" y="-34809.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer61_ffn_down_6&#45;&gt;layer61_ffn_ar -->
<g id="edge2004" class="edge">
<title>layer61_ffn_down_6&#45;&gt;layer61_ffn_ar</title>
<path fill="none" stroke="black" d="M415.69,-34955.96C415.69,-34955.96 415.69,-34885.62 415.69,-34885.62"/>
<polygon fill="black" stroke="black" points="419.19,-34885.62 415.69,-34875.62 412.19,-34885.62 419.19,-34885.62"/>
</g>
<!-- layer61_ffn_down_7&#45;&gt;layer61_ffn_ar -->
<g id="edge2005" class="edge">
<title>layer61_ffn_down_7&#45;&gt;layer61_ffn_ar</title>
<path fill="none" stroke="black" d="M556.31,-34955.96C556.31,-34955.96 556.31,-34885.34 556.31,-34885.34"/>
<polygon fill="black" stroke="black" points="559.81,-34885.34 556.31,-34875.34 552.81,-34885.34 559.81,-34885.34"/>
</g>
<!-- layer62_norm_6 -->
<g id="node1571" class="node">
<title>layer62_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="467.5,-34715.99 295.5,-34715.99 295.5,-34647.99 467.5,-34647.99 467.5,-34715.99"/>
<text text-anchor="middle" x="381.5" y="-34700.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="381.5" y="-34685.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="381.5" y="-34670.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="381.5" y="-34655.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer61_ffn_ar&#45;&gt;layer62_norm_6 -->
<g id="edge2006" class="edge">
<title>layer61_ffn_ar&#45;&gt;layer62_norm_6</title>
<path fill="none" stroke="black" d="M415.69,-34796.39C415.69,-34796.39 415.69,-34726.05 415.69,-34726.05"/>
<polygon fill="black" stroke="black" points="419.19,-34726.05 415.69,-34716.05 412.19,-34726.05 419.19,-34726.05"/>
</g>
<!-- layer62_norm_7 -->
<g id="node1572" class="node">
<title>layer62_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="677.5,-34715.99 505.5,-34715.99 505.5,-34647.99 677.5,-34647.99 677.5,-34715.99"/>
<text text-anchor="middle" x="591.5" y="-34700.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="591.5" y="-34685.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="591.5" y="-34670.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="591.5" y="-34655.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer61_ffn_ar&#45;&gt;layer62_norm_7 -->
<g id="edge2007" class="edge">
<title>layer61_ffn_ar&#45;&gt;layer62_norm_7</title>
<path fill="none" stroke="black" d="M556.31,-34796.79C556.31,-34796.79 556.31,-34726.22 556.31,-34726.22"/>
<polygon fill="black" stroke="black" points="559.81,-34726.22 556.31,-34716.22 552.81,-34726.22 559.81,-34726.22"/>
</g>
<!-- layer62_qkv_6 -->
<g id="node1573" class="node">
<title>layer62_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="468,-34575.99 287,-34575.99 287,-34507.99 468,-34507.99 468,-34575.99"/>
<text text-anchor="middle" x="377.5" y="-34560.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="377.5" y="-34545.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="377.5" y="-34530.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="377.5" y="-34515.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer62_norm_6&#45;&gt;layer62_qkv_6 -->
<g id="edge2008" class="edge">
<title>layer62_norm_6&#45;&gt;layer62_qkv_6</title>
<path fill="none" stroke="black" d="M381.5,-34647.74C381.5,-34647.74 381.5,-34586.37 381.5,-34586.37"/>
<polygon fill="black" stroke="black" points="385,-34586.37 381.5,-34576.37 378,-34586.37 385,-34586.37"/>
</g>
<!-- layer62_qkv_7 -->
<g id="node1574" class="node">
<title>layer62_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="685,-34575.99 504,-34575.99 504,-34507.99 685,-34507.99 685,-34575.99"/>
<text text-anchor="middle" x="594.5" y="-34560.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="594.5" y="-34545.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="594.5" y="-34530.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="594.5" y="-34515.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer62_norm_7&#45;&gt;layer62_qkv_7 -->
<g id="edge2009" class="edge">
<title>layer62_norm_7&#45;&gt;layer62_qkv_7</title>
<path fill="none" stroke="black" d="M591.5,-34647.74C591.5,-34647.74 591.5,-34586.37 591.5,-34586.37"/>
<polygon fill="black" stroke="black" points="595,-34586.37 591.5,-34576.37 588,-34586.37 595,-34586.37"/>
</g>
<!-- layer62_qkv_ar -->
<g id="node1575" class="node">
<title>layer62_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="485.5" cy="-34387.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="485.5" y="-34406.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="485.5" y="-34391.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="485.5" y="-34376.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="485.5" y="-34361.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer62_qkv_6&#45;&gt;layer62_qkv_ar -->
<g id="edge2010" class="edge">
<title>layer62_qkv_6&#45;&gt;layer62_qkv_ar</title>
<path fill="none" stroke="black" d="M412.76,-34507.79C412.76,-34507.79 412.76,-34437.73 412.76,-34437.73"/>
<polygon fill="black" stroke="black" points="416.26,-34437.73 412.76,-34427.73 409.26,-34437.73 416.26,-34437.73"/>
</g>
<!-- layer62_qkv_7&#45;&gt;layer62_qkv_ar -->
<g id="edge2011" class="edge">
<title>layer62_qkv_7&#45;&gt;layer62_qkv_ar</title>
<path fill="none" stroke="black" d="M558.74,-34507.79C558.74,-34507.79 558.74,-34437.45 558.74,-34437.45"/>
<polygon fill="black" stroke="black" points="562.24,-34437.45 558.74,-34427.45 555.24,-34437.45 562.24,-34437.45"/>
</g>
<!-- layer62_attn_6 -->
<g id="node1576" class="node">
<title>layer62_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="467.5,-34267.82 295.5,-34267.82 295.5,-34199.82 467.5,-34199.82 467.5,-34267.82"/>
<text text-anchor="middle" x="381.5" y="-34252.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="381.5" y="-34237.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="381.5" y="-34222.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="381.5" y="-34207.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer62_qkv_ar&#45;&gt;layer62_attn_6 -->
<g id="edge2012" class="edge">
<title>layer62_qkv_ar&#45;&gt;layer62_attn_6</title>
<path fill="none" stroke="black" d="M412.51,-34348.23C412.51,-34348.23 412.51,-34277.88 412.51,-34277.88"/>
<polygon fill="black" stroke="black" points="416.01,-34277.88 412.51,-34267.88 409.01,-34277.88 416.01,-34277.88"/>
</g>
<!-- layer62_attn_7 -->
<g id="node1577" class="node">
<title>layer62_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="675.5,-34267.82 503.5,-34267.82 503.5,-34199.82 675.5,-34199.82 675.5,-34267.82"/>
<text text-anchor="middle" x="589.5" y="-34252.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="589.5" y="-34237.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="589.5" y="-34222.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="589.5" y="-34207.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer62_qkv_ar&#45;&gt;layer62_attn_7 -->
<g id="edge2013" class="edge">
<title>layer62_qkv_ar&#45;&gt;layer62_attn_7</title>
<path fill="none" stroke="black" d="M558.49,-34348.23C558.49,-34348.23 558.49,-34277.88 558.49,-34277.88"/>
<polygon fill="black" stroke="black" points="561.99,-34277.88 558.49,-34267.88 554.99,-34277.88 561.99,-34277.88"/>
</g>
<!-- layer62_attn_out_6 -->
<g id="node1578" class="node">
<title>layer62_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="467.5,-34127.82 295.5,-34127.82 295.5,-34059.82 467.5,-34059.82 467.5,-34127.82"/>
<text text-anchor="middle" x="381.5" y="-34112.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="381.5" y="-34097.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="381.5" y="-34082.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="381.5" y="-34067.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer62_attn_6&#45;&gt;layer62_attn_out_6 -->
<g id="edge2014" class="edge">
<title>layer62_attn_6&#45;&gt;layer62_attn_out_6</title>
<path fill="none" stroke="black" d="M381.5,-34199.58C381.5,-34199.58 381.5,-34138.2 381.5,-34138.2"/>
<polygon fill="black" stroke="black" points="385,-34138.2 381.5,-34128.2 378,-34138.2 385,-34138.2"/>
</g>
<!-- layer62_attn_out_7 -->
<g id="node1579" class="node">
<title>layer62_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="675.5,-34127.82 503.5,-34127.82 503.5,-34059.82 675.5,-34059.82 675.5,-34127.82"/>
<text text-anchor="middle" x="589.5" y="-34112.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="589.5" y="-34097.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="589.5" y="-34082.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="589.5" y="-34067.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer62_attn_7&#45;&gt;layer62_attn_out_7 -->
<g id="edge2015" class="edge">
<title>layer62_attn_7&#45;&gt;layer62_attn_out_7</title>
<path fill="none" stroke="black" d="M589.5,-34199.58C589.5,-34199.58 589.5,-34138.2 589.5,-34138.2"/>
<polygon fill="black" stroke="black" points="593,-34138.2 589.5,-34128.2 586,-34138.2 593,-34138.2"/>
</g>
<!-- layer62_attn_ar -->
<g id="node1580" class="node">
<title>layer62_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="485.5" cy="-33939.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="485.5" y="-33958.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="485.5" y="-33943.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="485.5" y="-33928.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="485.5" y="-33913.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer62_attn_out_6&#45;&gt;layer62_attn_ar -->
<g id="edge2016" class="edge">
<title>layer62_attn_out_6&#45;&gt;layer62_attn_ar</title>
<path fill="none" stroke="black" d="M415.69,-34059.63C415.69,-34059.63 415.69,-33989.28 415.69,-33989.28"/>
<polygon fill="black" stroke="black" points="419.19,-33989.28 415.69,-33979.28 412.19,-33989.28 419.19,-33989.28"/>
</g>
<!-- layer62_attn_out_7&#45;&gt;layer62_attn_ar -->
<g id="edge2017" class="edge">
<title>layer62_attn_out_7&#45;&gt;layer62_attn_ar</title>
<path fill="none" stroke="black" d="M555.31,-34059.63C555.31,-34059.63 555.31,-33989.28 555.31,-33989.28"/>
<polygon fill="black" stroke="black" points="558.81,-33989.28 555.31,-33979.28 551.81,-33989.28 558.81,-33989.28"/>
</g>
<!-- layer62_ffn_norm_6 -->
<g id="node1581" class="node">
<title>layer62_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="463.5,-33819.66 291.5,-33819.66 291.5,-33751.66 463.5,-33751.66 463.5,-33819.66"/>
<text text-anchor="middle" x="377.5" y="-33804.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="377.5" y="-33789.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="377.5" y="-33774.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="377.5" y="-33759.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer62_attn_ar&#45;&gt;layer62_ffn_norm_6 -->
<g id="edge2018" class="edge">
<title>layer62_attn_ar&#45;&gt;layer62_ffn_norm_6</title>
<path fill="none" stroke="black" d="M413.69,-33900.86C413.69,-33900.86 413.69,-33829.8 413.69,-33829.8"/>
<polygon fill="black" stroke="black" points="417.19,-33829.8 413.69,-33819.8 410.19,-33829.8 417.19,-33829.8"/>
</g>
<!-- layer62_ffn_norm_7 -->
<g id="node1582" class="node">
<title>layer62_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="680.5,-33819.66 508.5,-33819.66 508.5,-33751.66 680.5,-33751.66 680.5,-33819.66"/>
<text text-anchor="middle" x="594.5" y="-33804.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="594.5" y="-33789.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="594.5" y="-33774.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="594.5" y="-33759.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer62_attn_ar&#45;&gt;layer62_ffn_norm_7 -->
<g id="edge2019" class="edge">
<title>layer62_attn_ar&#45;&gt;layer62_ffn_norm_7</title>
<path fill="none" stroke="black" d="M557.81,-33900.86C557.81,-33900.86 557.81,-33829.8 557.81,-33829.8"/>
<polygon fill="black" stroke="black" points="561.31,-33829.8 557.81,-33819.8 554.31,-33829.8 561.31,-33829.8"/>
</g>
<!-- layer62_ffn_gate_6 -->
<g id="node1583" class="node">
<title>layer62_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="468,-33679.66 287,-33679.66 287,-33611.66 468,-33611.66 468,-33679.66"/>
<text text-anchor="middle" x="377.5" y="-33664.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="377.5" y="-33649.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="377.5" y="-33634.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="377.5" y="-33619.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_ffn_norm_6&#45;&gt;layer62_ffn_gate_6 -->
<g id="edge2020" class="edge">
<title>layer62_ffn_norm_6&#45;&gt;layer62_ffn_gate_6</title>
<path fill="none" stroke="black" d="M377.5,-33751.41C377.5,-33751.41 377.5,-33690.04 377.5,-33690.04"/>
<polygon fill="black" stroke="black" points="381,-33690.04 377.5,-33680.04 374,-33690.04 381,-33690.04"/>
</g>
<!-- layer62_ffn_up_6 -->
<g id="node1585" class="node">
<title>layer62_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="251,-33679.66 70,-33679.66 70,-33611.66 251,-33611.66 251,-33679.66"/>
<text text-anchor="middle" x="160.5" y="-33664.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="160.5" y="-33649.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="160.5" y="-33634.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="160.5" y="-33619.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_ffn_norm_6&#45;&gt;layer62_ffn_up_6 -->
<g id="edge2022" class="edge">
<title>layer62_ffn_norm_6&#45;&gt;layer62_ffn_up_6</title>
<path fill="none" stroke="black" d="M291.31,-33785C251.86,-33785 213.76,-33785 213.76,-33785 213.76,-33785 213.76,-33689.74 213.76,-33689.74"/>
<polygon fill="black" stroke="black" points="217.26,-33689.74 213.76,-33679.74 210.26,-33689.74 217.26,-33689.74"/>
</g>
<!-- layer62_ffn_gate_7 -->
<g id="node1584" class="node">
<title>layer62_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="902,-33679.66 721,-33679.66 721,-33611.66 902,-33611.66 902,-33679.66"/>
<text text-anchor="middle" x="811.5" y="-33664.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="811.5" y="-33649.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="811.5" y="-33634.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="811.5" y="-33619.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_ffn_norm_7&#45;&gt;layer62_ffn_gate_7 -->
<g id="edge2021" class="edge">
<title>layer62_ffn_norm_7&#45;&gt;layer62_ffn_gate_7</title>
<path fill="none" stroke="black" d="M680.56,-33785C719.95,-33785 758,-33785 758,-33785 758,-33785 758,-33689.74 758,-33689.74"/>
<polygon fill="black" stroke="black" points="761.5,-33689.74 758,-33679.74 754.5,-33689.74 761.5,-33689.74"/>
</g>
<!-- layer62_ffn_up_7 -->
<g id="node1586" class="node">
<title>layer62_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="685,-33679.66 504,-33679.66 504,-33611.66 685,-33611.66 685,-33679.66"/>
<text text-anchor="middle" x="594.5" y="-33664.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="594.5" y="-33649.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="594.5" y="-33634.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="594.5" y="-33619.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_ffn_norm_7&#45;&gt;layer62_ffn_up_7 -->
<g id="edge2023" class="edge">
<title>layer62_ffn_norm_7&#45;&gt;layer62_ffn_up_7</title>
<path fill="none" stroke="black" d="M594.5,-33751.41C594.5,-33751.41 594.5,-33690.04 594.5,-33690.04"/>
<polygon fill="black" stroke="black" points="598,-33690.04 594.5,-33680.04 591,-33690.04 598,-33690.04"/>
</g>
<!-- layer62_gate_ar -->
<g id="node1587" class="node">
<title>layer62_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="685.5" cy="-33491.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="685.5" y="-33510.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="685.5" y="-33495.37" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="685.5" y="-33480.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="685.5" y="-33465.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer62_ffn_gate_6&#45;&gt;layer62_gate_ar -->
<g id="edge2024" class="edge">
<title>layer62_ffn_gate_6&#45;&gt;layer62_gate_ar</title>
<path fill="none" stroke="black" d="M468.08,-33645C478.79,-33645 486,-33645 486,-33645 486,-33645 486,-33507 486,-33507 486,-33507 554.28,-33507 554.28,-33507"/>
<polygon fill="black" stroke="black" points="554.28,-33510.5 564.28,-33507 554.28,-33503.5 554.28,-33510.5"/>
</g>
<!-- layer62_ffn_gate_7&#45;&gt;layer62_gate_ar -->
<g id="edge2025" class="edge">
<title>layer62_ffn_gate_7&#45;&gt;layer62_gate_ar</title>
<path fill="none" stroke="black" d="M767.24,-33611.46C767.24,-33611.46 767.24,-33538.64 767.24,-33538.64"/>
<polygon fill="black" stroke="black" points="770.74,-33538.64 767.24,-33528.64 763.74,-33538.64 770.74,-33538.64"/>
</g>
<!-- layer62_up_ar -->
<g id="node1588" class="node">
<title>layer62_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="339.5" cy="-33491.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="339.5" y="-33510.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="339.5" y="-33495.37" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="339.5" y="-33480.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="339.5" y="-33465.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer62_ffn_up_6&#45;&gt;layer62_up_ar -->
<g id="edge2026" class="edge">
<title>layer62_ffn_up_6&#45;&gt;layer62_up_ar</title>
<path fill="none" stroke="black" d="M231.26,-33611.46C231.26,-33611.46 231.26,-33527.54 231.26,-33527.54"/>
<polygon fill="black" stroke="black" points="234.76,-33527.54 231.26,-33517.54 227.76,-33527.54 234.76,-33527.54"/>
</g>
<!-- layer62_ffn_up_7&#45;&gt;layer62_up_ar -->
<g id="edge2027" class="edge">
<title>layer62_ffn_up_7&#45;&gt;layer62_up_ar</title>
<path fill="none" stroke="black" d="M530.76,-33611.53C530.76,-33561.73 530.76,-33475 530.76,-33475 530.76,-33475 469.81,-33475 469.81,-33475"/>
<polygon fill="black" stroke="black" points="469.81,-33471.5 459.81,-33475 469.81,-33478.5 469.81,-33471.5"/>
</g>
<!-- layer62_silu_6 -->
<g id="node1589" class="node">
<title>layer62_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="613,-33371.49 432,-33371.49 432,-33303.49 613,-33303.49 613,-33371.49"/>
<text text-anchor="middle" x="522.5" y="-33356.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="522.5" y="-33341.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="522.5" y="-33326.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="522.5" y="-33311.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_gate_ar&#45;&gt;layer62_silu_6 -->
<g id="edge2028" class="edge">
<title>layer62_gate_ar&#45;&gt;layer62_silu_6</title>
<path fill="none" stroke="black" d="M585.26,-33461.5C585.26,-33461.5 585.26,-33381.51 585.26,-33381.51"/>
<polygon fill="black" stroke="black" points="588.76,-33381.51 585.26,-33371.51 581.76,-33381.51 588.76,-33381.51"/>
</g>
<!-- layer62_silu_7 -->
<g id="node1590" class="node">
<title>layer62_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="830,-33371.49 649,-33371.49 649,-33303.49 830,-33303.49 830,-33371.49"/>
<text text-anchor="middle" x="739.5" y="-33356.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="739.5" y="-33341.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="739.5" y="-33326.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="739.5" y="-33311.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_gate_ar&#45;&gt;layer62_silu_7 -->
<g id="edge2029" class="edge">
<title>layer62_gate_ar&#45;&gt;layer62_silu_7</title>
<path fill="none" stroke="black" d="M731.24,-33446.59C731.24,-33446.59 731.24,-33381.5 731.24,-33381.5"/>
<polygon fill="black" stroke="black" points="734.74,-33381.5 731.24,-33371.5 727.74,-33381.5 734.74,-33381.5"/>
</g>
<!-- layer62_mul_6 -->
<g id="node1591" class="node">
<title>layer62_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="503,-33231.49 322,-33231.49 322,-33163.49 503,-33163.49 503,-33231.49"/>
<text text-anchor="middle" x="412.5" y="-33216.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="412.5" y="-33201.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="412.5" y="-33186.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="412.5" y="-33171.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_up_ar&#45;&gt;layer62_mul_6 -->
<g id="edge2031" class="edge">
<title>layer62_up_ar&#45;&gt;layer62_mul_6</title>
<path fill="none" stroke="black" d="M377,-33445.3C377,-33445.3 377,-33241.57 377,-33241.57"/>
<polygon fill="black" stroke="black" points="380.5,-33241.57 377,-33231.57 373.5,-33241.57 380.5,-33241.57"/>
</g>
<!-- layer62_mul_7 -->
<g id="node1592" class="node">
<title>layer62_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="720,-33231.49 539,-33231.49 539,-33163.49 720,-33163.49 720,-33231.49"/>
<text text-anchor="middle" x="629.5" y="-33216.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="629.5" y="-33201.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="629.5" y="-33186.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="629.5" y="-33171.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer62_up_ar&#45;&gt;layer62_mul_7 -->
<g id="edge2033" class="edge">
<title>layer62_up_ar&#45;&gt;layer62_mul_7</title>
<path fill="none" stroke="black" d="M449.74,-33467.11C449.74,-33442.13 449.74,-33407 449.74,-33407 449.74,-33407 631,-33407 631,-33407 631,-33407 631,-33241.62 631,-33241.62"/>
<polygon fill="black" stroke="black" points="634.5,-33241.62 631,-33231.62 627.5,-33241.62 634.5,-33241.62"/>
</g>
<!-- layer62_silu_6&#45;&gt;layer62_mul_6 -->
<g id="edge2030" class="edge">
<title>layer62_silu_6&#45;&gt;layer62_mul_6</title>
<path fill="none" stroke="black" d="M467.5,-33303.24C467.5,-33303.24 467.5,-33241.87 467.5,-33241.87"/>
<polygon fill="black" stroke="black" points="471,-33241.87 467.5,-33231.87 464,-33241.87 471,-33241.87"/>
</g>
<!-- layer62_silu_7&#45;&gt;layer62_mul_7 -->
<g id="edge2032" class="edge">
<title>layer62_silu_7&#45;&gt;layer62_mul_7</title>
<path fill="none" stroke="black" d="M684.5,-33303.24C684.5,-33303.24 684.5,-33241.87 684.5,-33241.87"/>
<polygon fill="black" stroke="black" points="688,-33241.87 684.5,-33231.87 681,-33241.87 688,-33241.87"/>
</g>
<!-- layer62_ffn_down_6 -->
<g id="node1593" class="node">
<title>layer62_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="502.5,-33091.49 330.5,-33091.49 330.5,-33023.49 502.5,-33023.49 502.5,-33091.49"/>
<text text-anchor="middle" x="416.5" y="-33076.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="416.5" y="-33061.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="416.5" y="-33046.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="416.5" y="-33031.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer62_mul_6&#45;&gt;layer62_ffn_down_6 -->
<g id="edge2034" class="edge">
<title>layer62_mul_6&#45;&gt;layer62_ffn_down_6</title>
<path fill="none" stroke="black" d="M416.5,-33163.24C416.5,-33163.24 416.5,-33101.87 416.5,-33101.87"/>
<polygon fill="black" stroke="black" points="420,-33101.87 416.5,-33091.87 413,-33101.87 420,-33101.87"/>
</g>
<!-- layer62_ffn_down_7 -->
<g id="node1594" class="node">
<title>layer62_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="712.5,-33091.49 540.5,-33091.49 540.5,-33023.49 712.5,-33023.49 712.5,-33091.49"/>
<text text-anchor="middle" x="626.5" y="-33076.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="626.5" y="-33061.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="626.5" y="-33046.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="626.5" y="-33031.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer62_mul_7&#45;&gt;layer62_ffn_down_7 -->
<g id="edge2035" class="edge">
<title>layer62_mul_7&#45;&gt;layer62_ffn_down_7</title>
<path fill="none" stroke="black" d="M626.5,-33163.24C626.5,-33163.24 626.5,-33101.87 626.5,-33101.87"/>
<polygon fill="black" stroke="black" points="630,-33101.87 626.5,-33091.87 623,-33101.87 630,-33101.87"/>
</g>
<!-- layer62_ffn_ar -->
<g id="node1595" class="node">
<title>layer62_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="520.5" cy="-32903.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="520.5" y="-32922.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="520.5" y="-32907.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="520.5" y="-32892.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="520.5" y="-32877.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer62_ffn_down_6&#45;&gt;layer62_ffn_ar -->
<g id="edge2036" class="edge">
<title>layer62_ffn_down_6&#45;&gt;layer62_ffn_ar</title>
<path fill="none" stroke="black" d="M450.69,-33023.29C450.69,-33023.29 450.69,-32952.95 450.69,-32952.95"/>
<polygon fill="black" stroke="black" points="454.19,-32952.95 450.69,-32942.95 447.19,-32952.95 454.19,-32952.95"/>
</g>
<!-- layer62_ffn_down_7&#45;&gt;layer62_ffn_ar -->
<g id="edge2037" class="edge">
<title>layer62_ffn_down_7&#45;&gt;layer62_ffn_ar</title>
<path fill="none" stroke="black" d="M591.31,-33023.29C591.31,-33023.29 591.31,-32952.67 591.31,-32952.67"/>
<polygon fill="black" stroke="black" points="594.81,-32952.67 591.31,-32942.67 587.81,-32952.67 594.81,-32952.67"/>
</g>
<!-- layer63_norm_6 -->
<g id="node1596" class="node">
<title>layer63_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="502.5,-32783.32 330.5,-32783.32 330.5,-32715.32 502.5,-32715.32 502.5,-32783.32"/>
<text text-anchor="middle" x="416.5" y="-32768.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="416.5" y="-32753.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="416.5" y="-32738.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="416.5" y="-32723.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer62_ffn_ar&#45;&gt;layer63_norm_6 -->
<g id="edge2038" class="edge">
<title>layer62_ffn_ar&#45;&gt;layer63_norm_6</title>
<path fill="none" stroke="black" d="M450.69,-32863.73C450.69,-32863.73 450.69,-32793.38 450.69,-32793.38"/>
<polygon fill="black" stroke="black" points="454.19,-32793.38 450.69,-32783.38 447.19,-32793.38 454.19,-32793.38"/>
</g>
<!-- layer63_norm_7 -->
<g id="node1597" class="node">
<title>layer63_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="712.5,-32783.32 540.5,-32783.32 540.5,-32715.32 712.5,-32715.32 712.5,-32783.32"/>
<text text-anchor="middle" x="626.5" y="-32768.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="626.5" y="-32753.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="626.5" y="-32738.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="626.5" y="-32723.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer62_ffn_ar&#45;&gt;layer63_norm_7 -->
<g id="edge2039" class="edge">
<title>layer62_ffn_ar&#45;&gt;layer63_norm_7</title>
<path fill="none" stroke="black" d="M591.31,-32864.13C591.31,-32864.13 591.31,-32793.55 591.31,-32793.55"/>
<polygon fill="black" stroke="black" points="594.81,-32793.55 591.31,-32783.55 587.81,-32793.55 594.81,-32793.55"/>
</g>
<!-- layer63_qkv_6 -->
<g id="node1598" class="node">
<title>layer63_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="503,-32643.32 322,-32643.32 322,-32575.32 503,-32575.32 503,-32643.32"/>
<text text-anchor="middle" x="412.5" y="-32628.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="412.5" y="-32613.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="412.5" y="-32598.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="412.5" y="-32583.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer63_norm_6&#45;&gt;layer63_qkv_6 -->
<g id="edge2040" class="edge">
<title>layer63_norm_6&#45;&gt;layer63_qkv_6</title>
<path fill="none" stroke="black" d="M416.5,-32715.08C416.5,-32715.08 416.5,-32653.7 416.5,-32653.7"/>
<polygon fill="black" stroke="black" points="420,-32653.7 416.5,-32643.7 413,-32653.7 420,-32653.7"/>
</g>
<!-- layer63_qkv_7 -->
<g id="node1599" class="node">
<title>layer63_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="720,-32643.32 539,-32643.32 539,-32575.32 720,-32575.32 720,-32643.32"/>
<text text-anchor="middle" x="629.5" y="-32628.12" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="629.5" y="-32613.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="629.5" y="-32598.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="629.5" y="-32583.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer63_norm_7&#45;&gt;layer63_qkv_7 -->
<g id="edge2041" class="edge">
<title>layer63_norm_7&#45;&gt;layer63_qkv_7</title>
<path fill="none" stroke="black" d="M626.5,-32715.08C626.5,-32715.08 626.5,-32653.7 626.5,-32653.7"/>
<polygon fill="black" stroke="black" points="630,-32653.7 626.5,-32643.7 623,-32653.7 630,-32653.7"/>
</g>
<!-- layer63_qkv_ar -->
<g id="node1600" class="node">
<title>layer63_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="520.5" cy="-32455.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="520.5" y="-32474.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="520.5" y="-32459.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="520.5" y="-32444.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="520.5" y="-32429.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer63_qkv_6&#45;&gt;layer63_qkv_ar -->
<g id="edge2042" class="edge">
<title>layer63_qkv_6&#45;&gt;layer63_qkv_ar</title>
<path fill="none" stroke="black" d="M447.76,-32575.13C447.76,-32575.13 447.76,-32505.06 447.76,-32505.06"/>
<polygon fill="black" stroke="black" points="451.26,-32505.06 447.76,-32495.06 444.26,-32505.06 451.26,-32505.06"/>
</g>
<!-- layer63_qkv_7&#45;&gt;layer63_qkv_ar -->
<g id="edge2043" class="edge">
<title>layer63_qkv_7&#45;&gt;layer63_qkv_ar</title>
<path fill="none" stroke="black" d="M593.74,-32575.13C593.74,-32575.13 593.74,-32504.78 593.74,-32504.78"/>
<polygon fill="black" stroke="black" points="597.24,-32504.78 593.74,-32494.78 590.24,-32504.78 597.24,-32504.78"/>
</g>
<!-- layer63_attn_6 -->
<g id="node1601" class="node">
<title>layer63_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="502.5,-32335.16 330.5,-32335.16 330.5,-32267.16 502.5,-32267.16 502.5,-32335.16"/>
<text text-anchor="middle" x="416.5" y="-32319.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="416.5" y="-32304.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="416.5" y="-32289.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="416.5" y="-32274.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer63_qkv_ar&#45;&gt;layer63_attn_6 -->
<g id="edge2044" class="edge">
<title>layer63_qkv_ar&#45;&gt;layer63_attn_6</title>
<path fill="none" stroke="black" d="M447.51,-32415.56C447.51,-32415.56 447.51,-32345.21 447.51,-32345.21"/>
<polygon fill="black" stroke="black" points="451.01,-32345.21 447.51,-32335.21 444.01,-32345.21 451.01,-32345.21"/>
</g>
<!-- layer63_attn_7 -->
<g id="node1602" class="node">
<title>layer63_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="710.5,-32335.16 538.5,-32335.16 538.5,-32267.16 710.5,-32267.16 710.5,-32335.16"/>
<text text-anchor="middle" x="624.5" y="-32319.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="624.5" y="-32304.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="624.5" y="-32289.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="624.5" y="-32274.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer63_qkv_ar&#45;&gt;layer63_attn_7 -->
<g id="edge2045" class="edge">
<title>layer63_qkv_ar&#45;&gt;layer63_attn_7</title>
<path fill="none" stroke="black" d="M593.49,-32415.56C593.49,-32415.56 593.49,-32345.21 593.49,-32345.21"/>
<polygon fill="black" stroke="black" points="596.99,-32345.21 593.49,-32335.21 589.99,-32345.21 596.99,-32345.21"/>
</g>
<!-- layer63_attn_out_6 -->
<g id="node1603" class="node">
<title>layer63_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="502.5,-32195.16 330.5,-32195.16 330.5,-32127.16 502.5,-32127.16 502.5,-32195.16"/>
<text text-anchor="middle" x="416.5" y="-32179.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="416.5" y="-32164.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="416.5" y="-32149.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="416.5" y="-32134.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer63_attn_6&#45;&gt;layer63_attn_out_6 -->
<g id="edge2046" class="edge">
<title>layer63_attn_6&#45;&gt;layer63_attn_out_6</title>
<path fill="none" stroke="black" d="M416.5,-32266.91C416.5,-32266.91 416.5,-32205.54 416.5,-32205.54"/>
<polygon fill="black" stroke="black" points="420,-32205.54 416.5,-32195.54 413,-32205.54 420,-32205.54"/>
</g>
<!-- layer63_attn_out_7 -->
<g id="node1604" class="node">
<title>layer63_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="710.5,-32195.16 538.5,-32195.16 538.5,-32127.16 710.5,-32127.16 710.5,-32195.16"/>
<text text-anchor="middle" x="624.5" y="-32179.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="624.5" y="-32164.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="624.5" y="-32149.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="624.5" y="-32134.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer63_attn_7&#45;&gt;layer63_attn_out_7 -->
<g id="edge2047" class="edge">
<title>layer63_attn_7&#45;&gt;layer63_attn_out_7</title>
<path fill="none" stroke="black" d="M624.5,-32266.91C624.5,-32266.91 624.5,-32205.54 624.5,-32205.54"/>
<polygon fill="black" stroke="black" points="628,-32205.54 624.5,-32195.54 621,-32205.54 628,-32205.54"/>
</g>
<!-- layer63_attn_ar -->
<g id="node1605" class="node">
<title>layer63_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="520.5" cy="-32007.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="520.5" y="-32025.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="520.5" y="-32010.87" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="520.5" y="-31995.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="520.5" y="-31980.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer63_attn_out_6&#45;&gt;layer63_attn_ar -->
<g id="edge2048" class="edge">
<title>layer63_attn_out_6&#45;&gt;layer63_attn_ar</title>
<path fill="none" stroke="black" d="M450.69,-32126.96C450.69,-32126.96 450.69,-32056.62 450.69,-32056.62"/>
<polygon fill="black" stroke="black" points="454.19,-32056.62 450.69,-32046.62 447.19,-32056.62 454.19,-32056.62"/>
</g>
<!-- layer63_attn_out_7&#45;&gt;layer63_attn_ar -->
<g id="edge2049" class="edge">
<title>layer63_attn_out_7&#45;&gt;layer63_attn_ar</title>
<path fill="none" stroke="black" d="M590.31,-32126.96C590.31,-32126.96 590.31,-32056.62 590.31,-32056.62"/>
<polygon fill="black" stroke="black" points="593.81,-32056.62 590.31,-32046.62 586.81,-32056.62 593.81,-32056.62"/>
</g>
<!-- layer63_ffn_norm_6 -->
<g id="node1606" class="node">
<title>layer63_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="498.5,-31886.99 326.5,-31886.99 326.5,-31818.99 498.5,-31818.99 498.5,-31886.99"/>
<text text-anchor="middle" x="412.5" y="-31871.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="412.5" y="-31856.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="412.5" y="-31841.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="412.5" y="-31826.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer63_attn_ar&#45;&gt;layer63_ffn_norm_6 -->
<g id="edge2050" class="edge">
<title>layer63_attn_ar&#45;&gt;layer63_ffn_norm_6</title>
<path fill="none" stroke="black" d="M448.69,-31968.19C448.69,-31968.19 448.69,-31897.14 448.69,-31897.14"/>
<polygon fill="black" stroke="black" points="452.19,-31897.14 448.69,-31887.14 445.19,-31897.14 452.19,-31897.14"/>
</g>
<!-- layer63_ffn_norm_7 -->
<g id="node1607" class="node">
<title>layer63_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="715.5,-31886.99 543.5,-31886.99 543.5,-31818.99 715.5,-31818.99 715.5,-31886.99"/>
<text text-anchor="middle" x="629.5" y="-31871.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="629.5" y="-31856.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="629.5" y="-31841.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="629.5" y="-31826.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer63_attn_ar&#45;&gt;layer63_ffn_norm_7 -->
<g id="edge2051" class="edge">
<title>layer63_attn_ar&#45;&gt;layer63_ffn_norm_7</title>
<path fill="none" stroke="black" d="M592.81,-31968.19C592.81,-31968.19 592.81,-31897.14 592.81,-31897.14"/>
<polygon fill="black" stroke="black" points="596.31,-31897.14 592.81,-31887.14 589.31,-31897.14 596.31,-31897.14"/>
</g>
<!-- layer63_ffn_gate_6 -->
<g id="node1608" class="node">
<title>layer63_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="503,-31746.99 322,-31746.99 322,-31678.99 503,-31678.99 503,-31746.99"/>
<text text-anchor="middle" x="412.5" y="-31731.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="412.5" y="-31716.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="412.5" y="-31701.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="412.5" y="-31686.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_ffn_norm_6&#45;&gt;layer63_ffn_gate_6 -->
<g id="edge2052" class="edge">
<title>layer63_ffn_norm_6&#45;&gt;layer63_ffn_gate_6</title>
<path fill="none" stroke="black" d="M412.5,-31818.74C412.5,-31818.74 412.5,-31757.37 412.5,-31757.37"/>
<polygon fill="black" stroke="black" points="416,-31757.37 412.5,-31747.37 409,-31757.37 416,-31757.37"/>
</g>
<!-- layer63_ffn_up_6 -->
<g id="node1610" class="node">
<title>layer63_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="286,-31746.99 105,-31746.99 105,-31678.99 286,-31678.99 286,-31746.99"/>
<text text-anchor="middle" x="195.5" y="-31731.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="195.5" y="-31716.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="195.5" y="-31701.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="195.5" y="-31686.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_ffn_norm_6&#45;&gt;layer63_ffn_up_6 -->
<g id="edge2054" class="edge">
<title>layer63_ffn_norm_6&#45;&gt;layer63_ffn_up_6</title>
<path fill="none" stroke="black" d="M326.31,-31852C286.86,-31852 248.76,-31852 248.76,-31852 248.76,-31852 248.76,-31757 248.76,-31757"/>
<polygon fill="black" stroke="black" points="252.26,-31757 248.76,-31747 245.26,-31757 252.26,-31757"/>
</g>
<!-- layer63_ffn_gate_7 -->
<g id="node1609" class="node">
<title>layer63_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="937,-31746.99 756,-31746.99 756,-31678.99 937,-31678.99 937,-31746.99"/>
<text text-anchor="middle" x="846.5" y="-31731.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="846.5" y="-31716.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="846.5" y="-31701.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="846.5" y="-31686.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_ffn_norm_7&#45;&gt;layer63_ffn_gate_7 -->
<g id="edge2053" class="edge">
<title>layer63_ffn_norm_7&#45;&gt;layer63_ffn_gate_7</title>
<path fill="none" stroke="black" d="M715.56,-31852C754.95,-31852 793,-31852 793,-31852 793,-31852 793,-31757 793,-31757"/>
<polygon fill="black" stroke="black" points="796.5,-31757 793,-31747 789.5,-31757 796.5,-31757"/>
</g>
<!-- layer63_ffn_up_7 -->
<g id="node1611" class="node">
<title>layer63_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="720,-31746.99 539,-31746.99 539,-31678.99 720,-31678.99 720,-31746.99"/>
<text text-anchor="middle" x="629.5" y="-31731.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="629.5" y="-31716.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="629.5" y="-31701.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="629.5" y="-31686.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_ffn_norm_7&#45;&gt;layer63_ffn_up_7 -->
<g id="edge2055" class="edge">
<title>layer63_ffn_norm_7&#45;&gt;layer63_ffn_up_7</title>
<path fill="none" stroke="black" d="M629.5,-31818.74C629.5,-31818.74 629.5,-31757.37 629.5,-31757.37"/>
<polygon fill="black" stroke="black" points="633,-31757.37 629.5,-31747.37 626,-31757.37 633,-31757.37"/>
</g>
<!-- layer63_gate_ar -->
<g id="node1612" class="node">
<title>layer63_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="720.5" cy="-31558.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="720.5" y="-31577.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="720.5" y="-31562.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="720.5" y="-31547.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="720.5" y="-31532.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer63_ffn_gate_6&#45;&gt;layer63_gate_ar -->
<g id="edge2056" class="edge">
<title>layer63_ffn_gate_6&#45;&gt;layer63_gate_ar</title>
<path fill="none" stroke="black" d="M503.08,-31712C513.79,-31712 521,-31712 521,-31712 521,-31712 521,-31574 521,-31574 521,-31574 588.7,-31574 588.7,-31574"/>
<polygon fill="black" stroke="black" points="588.7,-31577.5 598.7,-31574 588.7,-31570.5 588.7,-31577.5"/>
</g>
<!-- layer63_ffn_gate_7&#45;&gt;layer63_gate_ar -->
<g id="edge2057" class="edge">
<title>layer63_ffn_gate_7&#45;&gt;layer63_gate_ar</title>
<path fill="none" stroke="black" d="M802.24,-31678.79C802.24,-31678.79 802.24,-31605.97 802.24,-31605.97"/>
<polygon fill="black" stroke="black" points="805.74,-31605.97 802.24,-31595.97 798.74,-31605.97 805.74,-31605.97"/>
</g>
<!-- layer63_up_ar -->
<g id="node1613" class="node">
<title>layer63_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="374.5" cy="-31558.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="374.5" y="-31577.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="374.5" y="-31562.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="374.5" y="-31547.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="374.5" y="-31532.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer63_ffn_up_6&#45;&gt;layer63_up_ar -->
<g id="edge2058" class="edge">
<title>layer63_ffn_up_6&#45;&gt;layer63_up_ar</title>
<path fill="none" stroke="black" d="M266.26,-31678.79C266.26,-31678.79 266.26,-31594.87 266.26,-31594.87"/>
<polygon fill="black" stroke="black" points="269.76,-31594.87 266.26,-31584.87 262.76,-31594.87 269.76,-31594.87"/>
</g>
<!-- layer63_ffn_up_7&#45;&gt;layer63_up_ar -->
<g id="edge2059" class="edge">
<title>layer63_ffn_up_7&#45;&gt;layer63_up_ar</title>
<path fill="none" stroke="black" d="M565.76,-31678.8C565.76,-31628.9 565.76,-31542 565.76,-31542 565.76,-31542 504.54,-31542 504.54,-31542"/>
<polygon fill="black" stroke="black" points="504.54,-31538.5 494.54,-31542 504.54,-31545.5 504.54,-31538.5"/>
</g>
<!-- layer63_silu_6 -->
<g id="node1614" class="node">
<title>layer63_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="648,-31438.82 467,-31438.82 467,-31370.82 648,-31370.82 648,-31438.82"/>
<text text-anchor="middle" x="557.5" y="-31423.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="557.5" y="-31408.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="557.5" y="-31393.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="557.5" y="-31378.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_gate_ar&#45;&gt;layer63_silu_6 -->
<g id="edge2060" class="edge">
<title>layer63_gate_ar&#45;&gt;layer63_silu_6</title>
<path fill="none" stroke="black" d="M620.26,-31528.83C620.26,-31528.83 620.26,-31448.85 620.26,-31448.85"/>
<polygon fill="black" stroke="black" points="623.76,-31448.85 620.26,-31438.85 616.76,-31448.85 623.76,-31448.85"/>
</g>
<!-- layer63_silu_7 -->
<g id="node1615" class="node">
<title>layer63_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="865,-31438.82 684,-31438.82 684,-31370.82 865,-31370.82 865,-31438.82"/>
<text text-anchor="middle" x="774.5" y="-31423.62" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="774.5" y="-31408.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="774.5" y="-31393.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="774.5" y="-31378.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_gate_ar&#45;&gt;layer63_silu_7 -->
<g id="edge2061" class="edge">
<title>layer63_gate_ar&#45;&gt;layer63_silu_7</title>
<path fill="none" stroke="black" d="M766.24,-31513.93C766.24,-31513.93 766.24,-31448.83 766.24,-31448.83"/>
<polygon fill="black" stroke="black" points="769.74,-31448.83 766.24,-31438.83 762.74,-31448.83 769.74,-31448.83"/>
</g>
<!-- layer63_mul_6 -->
<g id="node1616" class="node">
<title>layer63_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="538,-31298.82 357,-31298.82 357,-31230.82 538,-31230.82 538,-31298.82"/>
<text text-anchor="middle" x="447.5" y="-31283.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="447.5" y="-31268.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="447.5" y="-31253.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="447.5" y="-31238.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_up_ar&#45;&gt;layer63_mul_6 -->
<g id="edge2063" class="edge">
<title>layer63_up_ar&#45;&gt;layer63_mul_6</title>
<path fill="none" stroke="black" d="M412,-31512.63C412,-31512.63 412,-31308.91 412,-31308.91"/>
<polygon fill="black" stroke="black" points="415.5,-31308.91 412,-31298.91 408.5,-31308.91 415.5,-31308.91"/>
</g>
<!-- layer63_mul_7 -->
<g id="node1617" class="node">
<title>layer63_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="755,-31298.82 574,-31298.82 574,-31230.82 755,-31230.82 755,-31298.82"/>
<text text-anchor="middle" x="664.5" y="-31283.62" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="664.5" y="-31268.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="664.5" y="-31253.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="664.5" y="-31238.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer63_up_ar&#45;&gt;layer63_mul_7 -->
<g id="edge2065" class="edge">
<title>layer63_up_ar&#45;&gt;layer63_mul_7</title>
<path fill="none" stroke="black" d="M484.74,-31534.35C484.74,-31509.27 484.74,-31474 484.74,-31474 484.74,-31474 666,-31474 666,-31474 666,-31474 666,-31308.9 666,-31308.9"/>
<polygon fill="black" stroke="black" points="669.5,-31308.9 666,-31298.9 662.5,-31308.9 669.5,-31308.9"/>
</g>
<!-- layer63_silu_6&#45;&gt;layer63_mul_6 -->
<g id="edge2062" class="edge">
<title>layer63_silu_6&#45;&gt;layer63_mul_6</title>
<path fill="none" stroke="black" d="M502.5,-31370.58C502.5,-31370.58 502.5,-31309.2 502.5,-31309.2"/>
<polygon fill="black" stroke="black" points="506,-31309.2 502.5,-31299.2 499,-31309.2 506,-31309.2"/>
</g>
<!-- layer63_silu_7&#45;&gt;layer63_mul_7 -->
<g id="edge2064" class="edge">
<title>layer63_silu_7&#45;&gt;layer63_mul_7</title>
<path fill="none" stroke="black" d="M719.5,-31370.58C719.5,-31370.58 719.5,-31309.2 719.5,-31309.2"/>
<polygon fill="black" stroke="black" points="723,-31309.2 719.5,-31299.2 716,-31309.2 723,-31309.2"/>
</g>
<!-- layer63_ffn_down_6 -->
<g id="node1618" class="node">
<title>layer63_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="537.5,-31158.82 365.5,-31158.82 365.5,-31090.82 537.5,-31090.82 537.5,-31158.82"/>
<text text-anchor="middle" x="451.5" y="-31143.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="451.5" y="-31128.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="451.5" y="-31113.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="451.5" y="-31098.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer63_mul_6&#45;&gt;layer63_ffn_down_6 -->
<g id="edge2066" class="edge">
<title>layer63_mul_6&#45;&gt;layer63_ffn_down_6</title>
<path fill="none" stroke="black" d="M451.5,-31230.58C451.5,-31230.58 451.5,-31169.2 451.5,-31169.2"/>
<polygon fill="black" stroke="black" points="455,-31169.2 451.5,-31159.2 448,-31169.2 455,-31169.2"/>
</g>
<!-- layer63_ffn_down_7 -->
<g id="node1619" class="node">
<title>layer63_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="747.5,-31158.82 575.5,-31158.82 575.5,-31090.82 747.5,-31090.82 747.5,-31158.82"/>
<text text-anchor="middle" x="661.5" y="-31143.62" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="661.5" y="-31128.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="661.5" y="-31113.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="661.5" y="-31098.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer63_mul_7&#45;&gt;layer63_ffn_down_7 -->
<g id="edge2067" class="edge">
<title>layer63_mul_7&#45;&gt;layer63_ffn_down_7</title>
<path fill="none" stroke="black" d="M661.5,-31230.58C661.5,-31230.58 661.5,-31169.2 661.5,-31169.2"/>
<polygon fill="black" stroke="black" points="665,-31169.2 661.5,-31159.2 658,-31169.2 665,-31169.2"/>
</g>
<!-- layer63_ffn_ar -->
<g id="node1620" class="node">
<title>layer63_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="555.5" cy="-30970.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="555.5" y="-30989.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="555.5" y="-30974.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="555.5" y="-30959.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="555.5" y="-30944.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer63_ffn_down_6&#45;&gt;layer63_ffn_ar -->
<g id="edge2068" class="edge">
<title>layer63_ffn_down_6&#45;&gt;layer63_ffn_ar</title>
<path fill="none" stroke="black" d="M485.69,-31090.63C485.69,-31090.63 485.69,-31020.28 485.69,-31020.28"/>
<polygon fill="black" stroke="black" points="489.19,-31020.28 485.69,-31010.28 482.19,-31020.28 489.19,-31020.28"/>
</g>
<!-- layer63_ffn_down_7&#45;&gt;layer63_ffn_ar -->
<g id="edge2069" class="edge">
<title>layer63_ffn_down_7&#45;&gt;layer63_ffn_ar</title>
<path fill="none" stroke="black" d="M626.31,-31090.63C626.31,-31090.63 626.31,-31020.01 626.31,-31020.01"/>
<polygon fill="black" stroke="black" points="629.81,-31020.01 626.31,-31010.01 622.81,-31020.01 629.81,-31020.01"/>
</g>
<!-- layer64_norm_6 -->
<g id="node1621" class="node">
<title>layer64_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="537.5,-30850.66 365.5,-30850.66 365.5,-30782.66 537.5,-30782.66 537.5,-30850.66"/>
<text text-anchor="middle" x="451.5" y="-30835.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="451.5" y="-30820.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="451.5" y="-30805.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="451.5" y="-30790.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer63_ffn_ar&#45;&gt;layer64_norm_6 -->
<g id="edge2070" class="edge">
<title>layer63_ffn_ar&#45;&gt;layer64_norm_6</title>
<path fill="none" stroke="black" d="M485.69,-30931.06C485.69,-30931.06 485.69,-30860.71 485.69,-30860.71"/>
<polygon fill="black" stroke="black" points="489.19,-30860.71 485.69,-30850.71 482.19,-30860.71 489.19,-30860.71"/>
</g>
<!-- layer64_norm_7 -->
<g id="node1622" class="node">
<title>layer64_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="747.5,-30850.66 575.5,-30850.66 575.5,-30782.66 747.5,-30782.66 747.5,-30850.66"/>
<text text-anchor="middle" x="661.5" y="-30835.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="661.5" y="-30820.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="661.5" y="-30805.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="661.5" y="-30790.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer63_ffn_ar&#45;&gt;layer64_norm_7 -->
<g id="edge2071" class="edge">
<title>layer63_ffn_ar&#45;&gt;layer64_norm_7</title>
<path fill="none" stroke="black" d="M626.31,-30931.46C626.31,-30931.46 626.31,-30860.89 626.31,-30860.89"/>
<polygon fill="black" stroke="black" points="629.81,-30860.89 626.31,-30850.89 622.81,-30860.89 629.81,-30860.89"/>
</g>
<!-- layer64_qkv_6 -->
<g id="node1623" class="node">
<title>layer64_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="538,-30710.66 357,-30710.66 357,-30642.66 538,-30642.66 538,-30710.66"/>
<text text-anchor="middle" x="447.5" y="-30695.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="447.5" y="-30680.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="447.5" y="-30665.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="447.5" y="-30650.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer64_norm_6&#45;&gt;layer64_qkv_6 -->
<g id="edge2072" class="edge">
<title>layer64_norm_6&#45;&gt;layer64_qkv_6</title>
<path fill="none" stroke="black" d="M451.5,-30782.41C451.5,-30782.41 451.5,-30721.04 451.5,-30721.04"/>
<polygon fill="black" stroke="black" points="455,-30721.04 451.5,-30711.04 448,-30721.04 455,-30721.04"/>
</g>
<!-- layer64_qkv_7 -->
<g id="node1624" class="node">
<title>layer64_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="755,-30710.66 574,-30710.66 574,-30642.66 755,-30642.66 755,-30710.66"/>
<text text-anchor="middle" x="664.5" y="-30695.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="664.5" y="-30680.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="664.5" y="-30665.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="664.5" y="-30650.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer64_norm_7&#45;&gt;layer64_qkv_7 -->
<g id="edge2073" class="edge">
<title>layer64_norm_7&#45;&gt;layer64_qkv_7</title>
<path fill="none" stroke="black" d="M661.5,-30782.41C661.5,-30782.41 661.5,-30721.04 661.5,-30721.04"/>
<polygon fill="black" stroke="black" points="665,-30721.04 661.5,-30711.04 658,-30721.04 665,-30721.04"/>
</g>
<!-- layer64_qkv_ar -->
<g id="node1625" class="node">
<title>layer64_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="555.5" cy="-30522.57" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="555.5" y="-30541.37" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="555.5" y="-30526.37" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="555.5" y="-30511.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="555.5" y="-30496.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer64_qkv_6&#45;&gt;layer64_qkv_ar -->
<g id="edge2074" class="edge">
<title>layer64_qkv_6&#45;&gt;layer64_qkv_ar</title>
<path fill="none" stroke="black" d="M482.76,-30642.46C482.76,-30642.46 482.76,-30572.4 482.76,-30572.4"/>
<polygon fill="black" stroke="black" points="486.26,-30572.4 482.76,-30562.4 479.26,-30572.4 486.26,-30572.4"/>
</g>
<!-- layer64_qkv_7&#45;&gt;layer64_qkv_ar -->
<g id="edge2075" class="edge">
<title>layer64_qkv_7&#45;&gt;layer64_qkv_ar</title>
<path fill="none" stroke="black" d="M628.74,-30642.46C628.74,-30642.46 628.74,-30572.12 628.74,-30572.12"/>
<polygon fill="black" stroke="black" points="632.24,-30572.12 628.74,-30562.12 625.24,-30572.12 632.24,-30572.12"/>
</g>
<!-- layer64_attn_6 -->
<g id="node1626" class="node">
<title>layer64_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="537.5,-30402.49 365.5,-30402.49 365.5,-30334.49 537.5,-30334.49 537.5,-30402.49"/>
<text text-anchor="middle" x="451.5" y="-30387.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="451.5" y="-30372.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="451.5" y="-30357.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="451.5" y="-30342.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer64_qkv_ar&#45;&gt;layer64_attn_6 -->
<g id="edge2076" class="edge">
<title>layer64_qkv_ar&#45;&gt;layer64_attn_6</title>
<path fill="none" stroke="black" d="M482.51,-30482.89C482.51,-30482.89 482.51,-30412.55 482.51,-30412.55"/>
<polygon fill="black" stroke="black" points="486.01,-30412.55 482.51,-30402.55 479.01,-30412.55 486.01,-30412.55"/>
</g>
<!-- layer64_attn_7 -->
<g id="node1627" class="node">
<title>layer64_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="745.5,-30402.49 573.5,-30402.49 573.5,-30334.49 745.5,-30334.49 745.5,-30402.49"/>
<text text-anchor="middle" x="659.5" y="-30387.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="659.5" y="-30372.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="659.5" y="-30357.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="659.5" y="-30342.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer64_qkv_ar&#45;&gt;layer64_attn_7 -->
<g id="edge2077" class="edge">
<title>layer64_qkv_ar&#45;&gt;layer64_attn_7</title>
<path fill="none" stroke="black" d="M628.49,-30482.89C628.49,-30482.89 628.49,-30412.55 628.49,-30412.55"/>
<polygon fill="black" stroke="black" points="631.99,-30412.55 628.49,-30402.55 624.99,-30412.55 631.99,-30412.55"/>
</g>
<!-- layer64_attn_out_6 -->
<g id="node1628" class="node">
<title>layer64_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="537.5,-30262.49 365.5,-30262.49 365.5,-30194.49 537.5,-30194.49 537.5,-30262.49"/>
<text text-anchor="middle" x="451.5" y="-30247.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="451.5" y="-30232.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="451.5" y="-30217.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="451.5" y="-30202.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer64_attn_6&#45;&gt;layer64_attn_out_6 -->
<g id="edge2078" class="edge">
<title>layer64_attn_6&#45;&gt;layer64_attn_out_6</title>
<path fill="none" stroke="black" d="M451.5,-30334.24C451.5,-30334.24 451.5,-30272.87 451.5,-30272.87"/>
<polygon fill="black" stroke="black" points="455,-30272.87 451.5,-30262.87 448,-30272.87 455,-30272.87"/>
</g>
<!-- layer64_attn_out_7 -->
<g id="node1629" class="node">
<title>layer64_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="745.5,-30262.49 573.5,-30262.49 573.5,-30194.49 745.5,-30194.49 745.5,-30262.49"/>
<text text-anchor="middle" x="659.5" y="-30247.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="659.5" y="-30232.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="659.5" y="-30217.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="659.5" y="-30202.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer64_attn_7&#45;&gt;layer64_attn_out_7 -->
<g id="edge2079" class="edge">
<title>layer64_attn_7&#45;&gt;layer64_attn_out_7</title>
<path fill="none" stroke="black" d="M659.5,-30334.24C659.5,-30334.24 659.5,-30272.87 659.5,-30272.87"/>
<polygon fill="black" stroke="black" points="663,-30272.87 659.5,-30262.87 656,-30272.87 663,-30272.87"/>
</g>
<!-- layer64_attn_ar -->
<g id="node1630" class="node">
<title>layer64_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="555.5" cy="-30074.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="555.5" y="-30093.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="555.5" y="-30078.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="555.5" y="-30063.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="555.5" y="-30048.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer64_attn_out_6&#45;&gt;layer64_attn_ar -->
<g id="edge2080" class="edge">
<title>layer64_attn_out_6&#45;&gt;layer64_attn_ar</title>
<path fill="none" stroke="black" d="M485.69,-30194.29C485.69,-30194.29 485.69,-30123.95 485.69,-30123.95"/>
<polygon fill="black" stroke="black" points="489.19,-30123.95 485.69,-30113.95 482.19,-30123.95 489.19,-30123.95"/>
</g>
<!-- layer64_attn_out_7&#45;&gt;layer64_attn_ar -->
<g id="edge2081" class="edge">
<title>layer64_attn_out_7&#45;&gt;layer64_attn_ar</title>
<path fill="none" stroke="black" d="M625.31,-30194.29C625.31,-30194.29 625.31,-30123.95 625.31,-30123.95"/>
<polygon fill="black" stroke="black" points="628.81,-30123.95 625.31,-30113.95 621.81,-30123.95 628.81,-30123.95"/>
</g>
<!-- layer64_ffn_norm_6 -->
<g id="node1631" class="node">
<title>layer64_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="533.5,-29954.32 361.5,-29954.32 361.5,-29886.32 533.5,-29886.32 533.5,-29954.32"/>
<text text-anchor="middle" x="447.5" y="-29939.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="447.5" y="-29924.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="447.5" y="-29909.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="447.5" y="-29894.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer64_attn_ar&#45;&gt;layer64_ffn_norm_6 -->
<g id="edge2082" class="edge">
<title>layer64_attn_ar&#45;&gt;layer64_ffn_norm_6</title>
<path fill="none" stroke="black" d="M483.69,-30035.53C483.69,-30035.53 483.69,-29964.47 483.69,-29964.47"/>
<polygon fill="black" stroke="black" points="487.19,-29964.47 483.69,-29954.47 480.19,-29964.47 487.19,-29964.47"/>
</g>
<!-- layer64_ffn_norm_7 -->
<g id="node1632" class="node">
<title>layer64_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="750.5,-29954.32 578.5,-29954.32 578.5,-29886.32 750.5,-29886.32 750.5,-29954.32"/>
<text text-anchor="middle" x="664.5" y="-29939.12" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="664.5" y="-29924.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="664.5" y="-29909.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="664.5" y="-29894.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer64_attn_ar&#45;&gt;layer64_ffn_norm_7 -->
<g id="edge2083" class="edge">
<title>layer64_attn_ar&#45;&gt;layer64_ffn_norm_7</title>
<path fill="none" stroke="black" d="M627.81,-30035.53C627.81,-30035.53 627.81,-29964.47 627.81,-29964.47"/>
<polygon fill="black" stroke="black" points="631.31,-29964.47 627.81,-29954.47 624.31,-29964.47 631.31,-29964.47"/>
</g>
<!-- layer64_ffn_gate_6 -->
<g id="node1633" class="node">
<title>layer64_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="538,-29814.32 357,-29814.32 357,-29746.32 538,-29746.32 538,-29814.32"/>
<text text-anchor="middle" x="447.5" y="-29799.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="447.5" y="-29784.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="447.5" y="-29769.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="447.5" y="-29754.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_ffn_norm_6&#45;&gt;layer64_ffn_gate_6 -->
<g id="edge2084" class="edge">
<title>layer64_ffn_norm_6&#45;&gt;layer64_ffn_gate_6</title>
<path fill="none" stroke="black" d="M447.5,-29886.08C447.5,-29886.08 447.5,-29824.7 447.5,-29824.7"/>
<polygon fill="black" stroke="black" points="451,-29824.7 447.5,-29814.7 444,-29824.7 451,-29824.7"/>
</g>
<!-- layer64_ffn_up_6 -->
<g id="node1635" class="node">
<title>layer64_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="321,-29814.32 140,-29814.32 140,-29746.32 321,-29746.32 321,-29814.32"/>
<text text-anchor="middle" x="230.5" y="-29799.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="230.5" y="-29784.12" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="230.5" y="-29769.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="230.5" y="-29754.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_ffn_norm_6&#45;&gt;layer64_ffn_up_6 -->
<g id="edge2086" class="edge">
<title>layer64_ffn_norm_6&#45;&gt;layer64_ffn_up_6</title>
<path fill="none" stroke="black" d="M361.31,-29920C321.86,-29920 283.76,-29920 283.76,-29920 283.76,-29920 283.76,-29824.49 283.76,-29824.49"/>
<polygon fill="black" stroke="black" points="287.26,-29824.49 283.76,-29814.49 280.26,-29824.49 287.26,-29824.49"/>
</g>
<!-- layer64_ffn_gate_7 -->
<g id="node1634" class="node">
<title>layer64_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="972,-29814.32 791,-29814.32 791,-29746.32 972,-29746.32 972,-29814.32"/>
<text text-anchor="middle" x="881.5" y="-29799.12" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="881.5" y="-29784.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="881.5" y="-29769.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="881.5" y="-29754.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_ffn_norm_7&#45;&gt;layer64_ffn_gate_7 -->
<g id="edge2085" class="edge">
<title>layer64_ffn_norm_7&#45;&gt;layer64_ffn_gate_7</title>
<path fill="none" stroke="black" d="M750.56,-29920C789.95,-29920 828,-29920 828,-29920 828,-29920 828,-29824.49 828,-29824.49"/>
<polygon fill="black" stroke="black" points="831.5,-29824.49 828,-29814.49 824.5,-29824.49 831.5,-29824.49"/>
</g>
<!-- layer64_ffn_up_7 -->
<g id="node1636" class="node">
<title>layer64_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="755,-29814.32 574,-29814.32 574,-29746.32 755,-29746.32 755,-29814.32"/>
<text text-anchor="middle" x="664.5" y="-29799.12" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="664.5" y="-29784.12" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="664.5" y="-29769.12" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="664.5" y="-29754.12" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_ffn_norm_7&#45;&gt;layer64_ffn_up_7 -->
<g id="edge2087" class="edge">
<title>layer64_ffn_norm_7&#45;&gt;layer64_ffn_up_7</title>
<path fill="none" stroke="black" d="M664.5,-29886.08C664.5,-29886.08 664.5,-29824.7 664.5,-29824.7"/>
<polygon fill="black" stroke="black" points="668,-29824.7 664.5,-29814.7 661,-29824.7 668,-29824.7"/>
</g>
<!-- layer64_gate_ar -->
<g id="node1637" class="node">
<title>layer64_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="755.5" cy="-29626.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="755.5" y="-29645.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="755.5" y="-29630.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="755.5" y="-29615.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="755.5" y="-29600.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer64_ffn_gate_6&#45;&gt;layer64_gate_ar -->
<g id="edge2088" class="edge">
<title>layer64_ffn_gate_6&#45;&gt;layer64_gate_ar</title>
<path fill="none" stroke="black" d="M538.08,-29780C548.79,-29780 556,-29780 556,-29780 556,-29780 556,-29642 556,-29642 556,-29642 624.56,-29642 624.56,-29642"/>
<polygon fill="black" stroke="black" points="624.56,-29645.5 634.56,-29642 624.56,-29638.5 624.56,-29645.5"/>
</g>
<!-- layer64_ffn_gate_7&#45;&gt;layer64_gate_ar -->
<g id="edge2089" class="edge">
<title>layer64_ffn_gate_7&#45;&gt;layer64_gate_ar</title>
<path fill="none" stroke="black" d="M837.24,-29746.13C837.24,-29746.13 837.24,-29673.3 837.24,-29673.3"/>
<polygon fill="black" stroke="black" points="840.74,-29673.3 837.24,-29663.3 833.74,-29673.3 840.74,-29673.3"/>
</g>
<!-- layer64_up_ar -->
<g id="node1638" class="node">
<title>layer64_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="409.5" cy="-29626.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="409.5" y="-29645.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="409.5" y="-29630.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="409.5" y="-29615.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="409.5" y="-29600.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer64_ffn_up_6&#45;&gt;layer64_up_ar -->
<g id="edge2090" class="edge">
<title>layer64_ffn_up_6&#45;&gt;layer64_up_ar</title>
<path fill="none" stroke="black" d="M301.26,-29746.13C301.26,-29746.13 301.26,-29662.21 301.26,-29662.21"/>
<polygon fill="black" stroke="black" points="304.76,-29662.2 301.26,-29652.21 297.76,-29662.21 304.76,-29662.2"/>
</g>
<!-- layer64_ffn_up_7&#45;&gt;layer64_up_ar -->
<g id="edge2091" class="edge">
<title>layer64_ffn_up_7&#45;&gt;layer64_up_ar</title>
<path fill="none" stroke="black" d="M600.76,-29746.27C600.76,-29696.56 600.76,-29610 600.76,-29610 600.76,-29610 540.08,-29610 540.08,-29610"/>
<polygon fill="black" stroke="black" points="540.08,-29606.5 530.08,-29610 540.08,-29613.5 540.08,-29606.5"/>
</g>
<!-- layer64_silu_6 -->
<g id="node1639" class="node">
<title>layer64_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="683,-29506.16 502,-29506.16 502,-29438.16 683,-29438.16 683,-29506.16"/>
<text text-anchor="middle" x="592.5" y="-29490.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="592.5" y="-29475.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="592.5" y="-29460.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="592.5" y="-29445.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_gate_ar&#45;&gt;layer64_silu_6 -->
<g id="edge2092" class="edge">
<title>layer64_gate_ar&#45;&gt;layer64_silu_6</title>
<path fill="none" stroke="black" d="M655.26,-29596.17C655.26,-29596.17 655.26,-29516.18 655.26,-29516.18"/>
<polygon fill="black" stroke="black" points="658.76,-29516.18 655.26,-29506.18 651.76,-29516.18 658.76,-29516.18"/>
</g>
<!-- layer64_silu_7 -->
<g id="node1640" class="node">
<title>layer64_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="900,-29506.16 719,-29506.16 719,-29438.16 900,-29438.16 900,-29506.16"/>
<text text-anchor="middle" x="809.5" y="-29490.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="809.5" y="-29475.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="809.5" y="-29460.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="809.5" y="-29445.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_gate_ar&#45;&gt;layer64_silu_7 -->
<g id="edge2093" class="edge">
<title>layer64_gate_ar&#45;&gt;layer64_silu_7</title>
<path fill="none" stroke="black" d="M801.24,-29581.26C801.24,-29581.26 801.24,-29516.16 801.24,-29516.16"/>
<polygon fill="black" stroke="black" points="804.74,-29516.16 801.24,-29506.16 797.74,-29516.16 804.74,-29516.16"/>
</g>
<!-- layer64_mul_6 -->
<g id="node1641" class="node">
<title>layer64_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="573,-29366.16 392,-29366.16 392,-29298.16 573,-29298.16 573,-29366.16"/>
<text text-anchor="middle" x="482.5" y="-29350.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="482.5" y="-29335.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="482.5" y="-29320.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="482.5" y="-29305.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_up_ar&#45;&gt;layer64_mul_6 -->
<g id="edge2095" class="edge">
<title>layer64_up_ar&#45;&gt;layer64_mul_6</title>
<path fill="none" stroke="black" d="M447,-29579.97C447,-29579.97 447,-29376.24 447,-29376.24"/>
<polygon fill="black" stroke="black" points="450.5,-29376.24 447,-29366.24 443.5,-29376.24 450.5,-29376.24"/>
</g>
<!-- layer64_mul_7 -->
<g id="node1642" class="node">
<title>layer64_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="790,-29366.16 609,-29366.16 609,-29298.16 790,-29298.16 790,-29366.16"/>
<text text-anchor="middle" x="699.5" y="-29350.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="699.5" y="-29335.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="699.5" y="-29320.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="699.5" y="-29305.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer64_up_ar&#45;&gt;layer64_mul_7 -->
<g id="edge2097" class="edge">
<title>layer64_up_ar&#45;&gt;layer64_mul_7</title>
<path fill="none" stroke="black" d="M519.74,-29601.42C519.74,-29576.57 519.74,-29542 519.74,-29542 519.74,-29542 701,-29542 701,-29542 701,-29542 701,-29376.34 701,-29376.34"/>
<polygon fill="black" stroke="black" points="704.5,-29376.34 701,-29366.34 697.5,-29376.34 704.5,-29376.34"/>
</g>
<!-- layer64_silu_6&#45;&gt;layer64_mul_6 -->
<g id="edge2094" class="edge">
<title>layer64_silu_6&#45;&gt;layer64_mul_6</title>
<path fill="none" stroke="black" d="M537.5,-29437.91C537.5,-29437.91 537.5,-29376.54 537.5,-29376.54"/>
<polygon fill="black" stroke="black" points="541,-29376.54 537.5,-29366.54 534,-29376.54 541,-29376.54"/>
</g>
<!-- layer64_silu_7&#45;&gt;layer64_mul_7 -->
<g id="edge2096" class="edge">
<title>layer64_silu_7&#45;&gt;layer64_mul_7</title>
<path fill="none" stroke="black" d="M754.5,-29437.91C754.5,-29437.91 754.5,-29376.54 754.5,-29376.54"/>
<polygon fill="black" stroke="black" points="758,-29376.54 754.5,-29366.54 751,-29376.54 758,-29376.54"/>
</g>
<!-- layer64_ffn_down_6 -->
<g id="node1643" class="node">
<title>layer64_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="572.5,-29226.16 400.5,-29226.16 400.5,-29158.16 572.5,-29158.16 572.5,-29226.16"/>
<text text-anchor="middle" x="486.5" y="-29210.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="486.5" y="-29195.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="486.5" y="-29180.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="486.5" y="-29165.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer64_mul_6&#45;&gt;layer64_ffn_down_6 -->
<g id="edge2098" class="edge">
<title>layer64_mul_6&#45;&gt;layer64_ffn_down_6</title>
<path fill="none" stroke="black" d="M486.5,-29297.91C486.5,-29297.91 486.5,-29236.54 486.5,-29236.54"/>
<polygon fill="black" stroke="black" points="490,-29236.54 486.5,-29226.54 483,-29236.54 490,-29236.54"/>
</g>
<!-- layer64_ffn_down_7 -->
<g id="node1644" class="node">
<title>layer64_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="782.5,-29226.16 610.5,-29226.16 610.5,-29158.16 782.5,-29158.16 782.5,-29226.16"/>
<text text-anchor="middle" x="696.5" y="-29210.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="696.5" y="-29195.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="696.5" y="-29180.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="696.5" y="-29165.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer64_mul_7&#45;&gt;layer64_ffn_down_7 -->
<g id="edge2099" class="edge">
<title>layer64_mul_7&#45;&gt;layer64_ffn_down_7</title>
<path fill="none" stroke="black" d="M696.5,-29297.91C696.5,-29297.91 696.5,-29236.54 696.5,-29236.54"/>
<polygon fill="black" stroke="black" points="700,-29236.54 696.5,-29226.54 693,-29236.54 700,-29236.54"/>
</g>
<!-- layer64_ffn_ar -->
<g id="node1645" class="node">
<title>layer64_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="590.5" cy="-29038.07" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="590.5" y="-29056.87" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="590.5" y="-29041.87" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="590.5" y="-29026.87" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="590.5" y="-29011.87" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer64_ffn_down_6&#45;&gt;layer64_ffn_ar -->
<g id="edge2100" class="edge">
<title>layer64_ffn_down_6&#45;&gt;layer64_ffn_ar</title>
<path fill="none" stroke="black" d="M520.69,-29157.96C520.69,-29157.96 520.69,-29087.62 520.69,-29087.62"/>
<polygon fill="black" stroke="black" points="524.19,-29087.62 520.69,-29077.62 517.19,-29087.62 524.19,-29087.62"/>
</g>
<!-- layer64_ffn_down_7&#45;&gt;layer64_ffn_ar -->
<g id="edge2101" class="edge">
<title>layer64_ffn_down_7&#45;&gt;layer64_ffn_ar</title>
<path fill="none" stroke="black" d="M661.31,-29157.96C661.31,-29157.96 661.31,-29087.34 661.31,-29087.34"/>
<polygon fill="black" stroke="black" points="664.81,-29087.34 661.31,-29077.34 657.81,-29087.34 664.81,-29087.34"/>
</g>
<!-- layer65_norm_6 -->
<g id="node1646" class="node">
<title>layer65_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="572.5,-28917.99 400.5,-28917.99 400.5,-28849.99 572.5,-28849.99 572.5,-28917.99"/>
<text text-anchor="middle" x="486.5" y="-28902.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="486.5" y="-28887.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="486.5" y="-28872.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="486.5" y="-28857.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer64_ffn_ar&#45;&gt;layer65_norm_6 -->
<g id="edge2102" class="edge">
<title>layer64_ffn_ar&#45;&gt;layer65_norm_6</title>
<path fill="none" stroke="black" d="M520.69,-28998.39C520.69,-28998.39 520.69,-28928.05 520.69,-28928.05"/>
<polygon fill="black" stroke="black" points="524.19,-28928.05 520.69,-28918.05 517.19,-28928.05 524.19,-28928.05"/>
</g>
<!-- layer65_norm_7 -->
<g id="node1647" class="node">
<title>layer65_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="782.5,-28917.99 610.5,-28917.99 610.5,-28849.99 782.5,-28849.99 782.5,-28917.99"/>
<text text-anchor="middle" x="696.5" y="-28902.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="696.5" y="-28887.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="696.5" y="-28872.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="696.5" y="-28857.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer64_ffn_ar&#45;&gt;layer65_norm_7 -->
<g id="edge2103" class="edge">
<title>layer64_ffn_ar&#45;&gt;layer65_norm_7</title>
<path fill="none" stroke="black" d="M661.31,-28998.79C661.31,-28998.79 661.31,-28928.22 661.31,-28928.22"/>
<polygon fill="black" stroke="black" points="664.81,-28928.22 661.31,-28918.22 657.81,-28928.22 664.81,-28928.22"/>
</g>
<!-- layer65_qkv_6 -->
<g id="node1648" class="node">
<title>layer65_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="573,-28777.99 392,-28777.99 392,-28709.99 573,-28709.99 573,-28777.99"/>
<text text-anchor="middle" x="482.5" y="-28762.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="482.5" y="-28747.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="482.5" y="-28732.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="482.5" y="-28717.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer65_norm_6&#45;&gt;layer65_qkv_6 -->
<g id="edge2104" class="edge">
<title>layer65_norm_6&#45;&gt;layer65_qkv_6</title>
<path fill="none" stroke="black" d="M486.5,-28849.74C486.5,-28849.74 486.5,-28788.37 486.5,-28788.37"/>
<polygon fill="black" stroke="black" points="490,-28788.37 486.5,-28778.37 483,-28788.37 490,-28788.37"/>
</g>
<!-- layer65_qkv_7 -->
<g id="node1649" class="node">
<title>layer65_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="790,-28777.99 609,-28777.99 609,-28709.99 790,-28709.99 790,-28777.99"/>
<text text-anchor="middle" x="699.5" y="-28762.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="699.5" y="-28747.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="699.5" y="-28732.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="699.5" y="-28717.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer65_norm_7&#45;&gt;layer65_qkv_7 -->
<g id="edge2105" class="edge">
<title>layer65_norm_7&#45;&gt;layer65_qkv_7</title>
<path fill="none" stroke="black" d="M696.5,-28849.74C696.5,-28849.74 696.5,-28788.37 696.5,-28788.37"/>
<polygon fill="black" stroke="black" points="700,-28788.37 696.5,-28778.37 693,-28788.37 700,-28788.37"/>
</g>
<!-- layer65_qkv_ar -->
<g id="node1650" class="node">
<title>layer65_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="590.5" cy="-28589.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="590.5" y="-28608.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="590.5" y="-28593.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="590.5" y="-28578.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="590.5" y="-28563.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer65_qkv_6&#45;&gt;layer65_qkv_ar -->
<g id="edge2106" class="edge">
<title>layer65_qkv_6&#45;&gt;layer65_qkv_ar</title>
<path fill="none" stroke="black" d="M517.76,-28709.8C517.76,-28709.8 517.76,-28639.73 517.76,-28639.73"/>
<polygon fill="black" stroke="black" points="521.26,-28639.73 517.76,-28629.73 514.26,-28639.73 521.26,-28639.73"/>
</g>
<!-- layer65_qkv_7&#45;&gt;layer65_qkv_ar -->
<g id="edge2107" class="edge">
<title>layer65_qkv_7&#45;&gt;layer65_qkv_ar</title>
<path fill="none" stroke="black" d="M663.74,-28709.8C663.74,-28709.8 663.74,-28639.45 663.74,-28639.45"/>
<polygon fill="black" stroke="black" points="667.24,-28639.45 663.74,-28629.45 660.24,-28639.45 667.24,-28639.45"/>
</g>
<!-- layer65_attn_6 -->
<g id="node1651" class="node">
<title>layer65_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="572.5,-28469.82 400.5,-28469.82 400.5,-28401.82 572.5,-28401.82 572.5,-28469.82"/>
<text text-anchor="middle" x="486.5" y="-28454.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="486.5" y="-28439.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="486.5" y="-28424.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="486.5" y="-28409.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer65_qkv_ar&#45;&gt;layer65_attn_6 -->
<g id="edge2108" class="edge">
<title>layer65_qkv_ar&#45;&gt;layer65_attn_6</title>
<path fill="none" stroke="black" d="M517.51,-28550.23C517.51,-28550.23 517.51,-28479.88 517.51,-28479.88"/>
<polygon fill="black" stroke="black" points="521.01,-28479.88 517.51,-28469.88 514.01,-28479.88 521.01,-28479.88"/>
</g>
<!-- layer65_attn_7 -->
<g id="node1652" class="node">
<title>layer65_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="780.5,-28469.82 608.5,-28469.82 608.5,-28401.82 780.5,-28401.82 780.5,-28469.82"/>
<text text-anchor="middle" x="694.5" y="-28454.62" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="694.5" y="-28439.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="694.5" y="-28424.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="694.5" y="-28409.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer65_qkv_ar&#45;&gt;layer65_attn_7 -->
<g id="edge2109" class="edge">
<title>layer65_qkv_ar&#45;&gt;layer65_attn_7</title>
<path fill="none" stroke="black" d="M663.49,-28550.23C663.49,-28550.23 663.49,-28479.88 663.49,-28479.88"/>
<polygon fill="black" stroke="black" points="666.99,-28479.88 663.49,-28469.88 659.99,-28479.88 666.99,-28479.88"/>
</g>
<!-- layer65_attn_out_6 -->
<g id="node1653" class="node">
<title>layer65_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="572.5,-28329.82 400.5,-28329.82 400.5,-28261.82 572.5,-28261.82 572.5,-28329.82"/>
<text text-anchor="middle" x="486.5" y="-28314.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="486.5" y="-28299.62" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="486.5" y="-28284.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="486.5" y="-28269.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer65_attn_6&#45;&gt;layer65_attn_out_6 -->
<g id="edge2110" class="edge">
<title>layer65_attn_6&#45;&gt;layer65_attn_out_6</title>
<path fill="none" stroke="black" d="M486.5,-28401.58C486.5,-28401.58 486.5,-28340.2 486.5,-28340.2"/>
<polygon fill="black" stroke="black" points="490,-28340.2 486.5,-28330.2 483,-28340.2 490,-28340.2"/>
</g>
<!-- layer65_attn_out_7 -->
<g id="node1654" class="node">
<title>layer65_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="780.5,-28329.82 608.5,-28329.82 608.5,-28261.82 780.5,-28261.82 780.5,-28329.82"/>
<text text-anchor="middle" x="694.5" y="-28314.62" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="694.5" y="-28299.62" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="694.5" y="-28284.62" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="694.5" y="-28269.62" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer65_attn_7&#45;&gt;layer65_attn_out_7 -->
<g id="edge2111" class="edge">
<title>layer65_attn_7&#45;&gt;layer65_attn_out_7</title>
<path fill="none" stroke="black" d="M694.5,-28401.58C694.5,-28401.58 694.5,-28340.2 694.5,-28340.2"/>
<polygon fill="black" stroke="black" points="698,-28340.2 694.5,-28330.2 691,-28340.2 698,-28340.2"/>
</g>
<!-- layer65_attn_ar -->
<g id="node1655" class="node">
<title>layer65_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="590.5" cy="-28141.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="590.5" y="-28160.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="590.5" y="-28145.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="590.5" y="-28130.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="590.5" y="-28115.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer65_attn_out_6&#45;&gt;layer65_attn_ar -->
<g id="edge2112" class="edge">
<title>layer65_attn_out_6&#45;&gt;layer65_attn_ar</title>
<path fill="none" stroke="black" d="M520.69,-28261.63C520.69,-28261.63 520.69,-28191.28 520.69,-28191.28"/>
<polygon fill="black" stroke="black" points="524.19,-28191.28 520.69,-28181.28 517.19,-28191.28 524.19,-28191.28"/>
</g>
<!-- layer65_attn_out_7&#45;&gt;layer65_attn_ar -->
<g id="edge2113" class="edge">
<title>layer65_attn_out_7&#45;&gt;layer65_attn_ar</title>
<path fill="none" stroke="black" d="M660.31,-28261.63C660.31,-28261.63 660.31,-28191.28 660.31,-28191.28"/>
<polygon fill="black" stroke="black" points="663.81,-28191.28 660.31,-28181.28 656.81,-28191.28 663.81,-28191.28"/>
</g>
<!-- layer65_ffn_norm_6 -->
<g id="node1656" class="node">
<title>layer65_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="568.5,-28021.66 396.5,-28021.66 396.5,-27953.66 568.5,-27953.66 568.5,-28021.66"/>
<text text-anchor="middle" x="482.5" y="-28006.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="482.5" y="-27991.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="482.5" y="-27976.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="482.5" y="-27961.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer65_attn_ar&#45;&gt;layer65_ffn_norm_6 -->
<g id="edge2114" class="edge">
<title>layer65_attn_ar&#45;&gt;layer65_ffn_norm_6</title>
<path fill="none" stroke="black" d="M518.69,-28102.86C518.69,-28102.86 518.69,-28031.81 518.69,-28031.81"/>
<polygon fill="black" stroke="black" points="522.19,-28031.81 518.69,-28021.81 515.19,-28031.81 522.19,-28031.81"/>
</g>
<!-- layer65_ffn_norm_7 -->
<g id="node1657" class="node">
<title>layer65_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="785.5,-28021.66 613.5,-28021.66 613.5,-27953.66 785.5,-27953.66 785.5,-28021.66"/>
<text text-anchor="middle" x="699.5" y="-28006.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="699.5" y="-27991.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="699.5" y="-27976.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="699.5" y="-27961.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer65_attn_ar&#45;&gt;layer65_ffn_norm_7 -->
<g id="edge2115" class="edge">
<title>layer65_attn_ar&#45;&gt;layer65_ffn_norm_7</title>
<path fill="none" stroke="black" d="M662.81,-28102.86C662.81,-28102.86 662.81,-28031.81 662.81,-28031.81"/>
<polygon fill="black" stroke="black" points="666.31,-28031.81 662.81,-28021.81 659.31,-28031.81 666.31,-28031.81"/>
</g>
<!-- layer65_ffn_gate_6 -->
<g id="node1658" class="node">
<title>layer65_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="573,-27881.66 392,-27881.66 392,-27813.66 573,-27813.66 573,-27881.66"/>
<text text-anchor="middle" x="482.5" y="-27866.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="482.5" y="-27851.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="482.5" y="-27836.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="482.5" y="-27821.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_ffn_norm_6&#45;&gt;layer65_ffn_gate_6 -->
<g id="edge2116" class="edge">
<title>layer65_ffn_norm_6&#45;&gt;layer65_ffn_gate_6</title>
<path fill="none" stroke="black" d="M482.5,-27953.41C482.5,-27953.41 482.5,-27892.04 482.5,-27892.04"/>
<polygon fill="black" stroke="black" points="486,-27892.04 482.5,-27882.04 479,-27892.04 486,-27892.04"/>
</g>
<!-- layer65_ffn_up_6 -->
<g id="node1660" class="node">
<title>layer65_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="356,-27881.66 175,-27881.66 175,-27813.66 356,-27813.66 356,-27881.66"/>
<text text-anchor="middle" x="265.5" y="-27866.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="265.5" y="-27851.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="265.5" y="-27836.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="265.5" y="-27821.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_ffn_norm_6&#45;&gt;layer65_ffn_up_6 -->
<g id="edge2118" class="edge">
<title>layer65_ffn_norm_6&#45;&gt;layer65_ffn_up_6</title>
<path fill="none" stroke="black" d="M396.31,-27987C356.86,-27987 318.76,-27987 318.76,-27987 318.76,-27987 318.76,-27891.75 318.76,-27891.75"/>
<polygon fill="black" stroke="black" points="322.26,-27891.75 318.76,-27881.75 315.26,-27891.75 322.26,-27891.75"/>
</g>
<!-- layer65_ffn_gate_7 -->
<g id="node1659" class="node">
<title>layer65_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1007,-27881.66 826,-27881.66 826,-27813.66 1007,-27813.66 1007,-27881.66"/>
<text text-anchor="middle" x="916.5" y="-27866.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="916.5" y="-27851.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="916.5" y="-27836.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="916.5" y="-27821.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_ffn_norm_7&#45;&gt;layer65_ffn_gate_7 -->
<g id="edge2117" class="edge">
<title>layer65_ffn_norm_7&#45;&gt;layer65_ffn_gate_7</title>
<path fill="none" stroke="black" d="M785.56,-27987C824.95,-27987 863,-27987 863,-27987 863,-27987 863,-27891.75 863,-27891.75"/>
<polygon fill="black" stroke="black" points="866.5,-27891.75 863,-27881.75 859.5,-27891.75 866.5,-27891.75"/>
</g>
<!-- layer65_ffn_up_7 -->
<g id="node1661" class="node">
<title>layer65_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="790,-27881.66 609,-27881.66 609,-27813.66 790,-27813.66 790,-27881.66"/>
<text text-anchor="middle" x="699.5" y="-27866.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="699.5" y="-27851.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="699.5" y="-27836.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="699.5" y="-27821.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_ffn_norm_7&#45;&gt;layer65_ffn_up_7 -->
<g id="edge2119" class="edge">
<title>layer65_ffn_norm_7&#45;&gt;layer65_ffn_up_7</title>
<path fill="none" stroke="black" d="M699.5,-27953.41C699.5,-27953.41 699.5,-27892.04 699.5,-27892.04"/>
<polygon fill="black" stroke="black" points="703,-27892.04 699.5,-27882.04 696,-27892.04 703,-27892.04"/>
</g>
<!-- layer65_gate_ar -->
<g id="node1662" class="node">
<title>layer65_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="790.5" cy="-27693.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="790.5" y="-27712.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="790.5" y="-27697.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="790.5" y="-27682.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="790.5" y="-27667.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer65_ffn_gate_6&#45;&gt;layer65_gate_ar -->
<g id="edge2120" class="edge">
<title>layer65_ffn_gate_6&#45;&gt;layer65_gate_ar</title>
<path fill="none" stroke="black" d="M573.08,-27847C583.79,-27847 591,-27847 591,-27847 591,-27847 591,-27709 591,-27709 591,-27709 659.28,-27709 659.28,-27709"/>
<polygon fill="black" stroke="black" points="659.28,-27712.5 669.28,-27709 659.28,-27705.5 659.28,-27712.5"/>
</g>
<!-- layer65_ffn_gate_7&#45;&gt;layer65_gate_ar -->
<g id="edge2121" class="edge">
<title>layer65_ffn_gate_7&#45;&gt;layer65_gate_ar</title>
<path fill="none" stroke="black" d="M872.24,-27813.46C872.24,-27813.46 872.24,-27740.64 872.24,-27740.64"/>
<polygon fill="black" stroke="black" points="875.74,-27740.64 872.24,-27730.64 868.74,-27740.64 875.74,-27740.64"/>
</g>
<!-- layer65_up_ar -->
<g id="node1663" class="node">
<title>layer65_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="444.5" cy="-27693.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="444.5" y="-27712.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="444.5" y="-27697.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="444.5" y="-27682.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="444.5" y="-27667.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer65_ffn_up_6&#45;&gt;layer65_up_ar -->
<g id="edge2122" class="edge">
<title>layer65_ffn_up_6&#45;&gt;layer65_up_ar</title>
<path fill="none" stroke="black" d="M336.26,-27813.46C336.26,-27813.46 336.26,-27729.54 336.26,-27729.54"/>
<polygon fill="black" stroke="black" points="339.76,-27729.54 336.26,-27719.54 332.76,-27729.54 339.76,-27729.54"/>
</g>
<!-- layer65_ffn_up_7&#45;&gt;layer65_up_ar -->
<g id="edge2123" class="edge">
<title>layer65_ffn_up_7&#45;&gt;layer65_up_ar</title>
<path fill="none" stroke="black" d="M635.76,-27813.53C635.76,-27763.73 635.76,-27677 635.76,-27677 635.76,-27677 574.81,-27677 574.81,-27677"/>
<polygon fill="black" stroke="black" points="574.81,-27673.5 564.81,-27677 574.81,-27680.5 574.81,-27673.5"/>
</g>
<!-- layer65_silu_6 -->
<g id="node1664" class="node">
<title>layer65_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="718,-27573.49 537,-27573.49 537,-27505.49 718,-27505.49 718,-27573.49"/>
<text text-anchor="middle" x="627.5" y="-27558.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="627.5" y="-27543.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="627.5" y="-27528.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="627.5" y="-27513.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_gate_ar&#45;&gt;layer65_silu_6 -->
<g id="edge2124" class="edge">
<title>layer65_gate_ar&#45;&gt;layer65_silu_6</title>
<path fill="none" stroke="black" d="M690.26,-27663.5C690.26,-27663.5 690.26,-27583.51 690.26,-27583.51"/>
<polygon fill="black" stroke="black" points="693.76,-27583.51 690.26,-27573.51 686.76,-27583.51 693.76,-27583.51"/>
</g>
<!-- layer65_silu_7 -->
<g id="node1665" class="node">
<title>layer65_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="935,-27573.49 754,-27573.49 754,-27505.49 935,-27505.49 935,-27573.49"/>
<text text-anchor="middle" x="844.5" y="-27558.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="844.5" y="-27543.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="844.5" y="-27528.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="844.5" y="-27513.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_gate_ar&#45;&gt;layer65_silu_7 -->
<g id="edge2125" class="edge">
<title>layer65_gate_ar&#45;&gt;layer65_silu_7</title>
<path fill="none" stroke="black" d="M836.24,-27648.59C836.24,-27648.59 836.24,-27583.5 836.24,-27583.5"/>
<polygon fill="black" stroke="black" points="839.74,-27583.5 836.24,-27573.5 832.74,-27583.5 839.74,-27583.5"/>
</g>
<!-- layer65_mul_6 -->
<g id="node1666" class="node">
<title>layer65_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="608,-27433.49 427,-27433.49 427,-27365.49 608,-27365.49 608,-27433.49"/>
<text text-anchor="middle" x="517.5" y="-27418.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="517.5" y="-27403.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="517.5" y="-27388.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="517.5" y="-27373.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_up_ar&#45;&gt;layer65_mul_6 -->
<g id="edge2127" class="edge">
<title>layer65_up_ar&#45;&gt;layer65_mul_6</title>
<path fill="none" stroke="black" d="M482,-27647.3C482,-27647.3 482,-27443.58 482,-27443.58"/>
<polygon fill="black" stroke="black" points="485.5,-27443.58 482,-27433.58 478.5,-27443.58 485.5,-27443.58"/>
</g>
<!-- layer65_mul_7 -->
<g id="node1667" class="node">
<title>layer65_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="825,-27433.49 644,-27433.49 644,-27365.49 825,-27365.49 825,-27433.49"/>
<text text-anchor="middle" x="734.5" y="-27418.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="734.5" y="-27403.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="734.5" y="-27388.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="734.5" y="-27373.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer65_up_ar&#45;&gt;layer65_mul_7 -->
<g id="edge2129" class="edge">
<title>layer65_up_ar&#45;&gt;layer65_mul_7</title>
<path fill="none" stroke="black" d="M554.74,-27669.11C554.74,-27644.13 554.74,-27609 554.74,-27609 554.74,-27609 736,-27609 736,-27609 736,-27609 736,-27443.62 736,-27443.62"/>
<polygon fill="black" stroke="black" points="739.5,-27443.62 736,-27433.62 732.5,-27443.62 739.5,-27443.62"/>
</g>
<!-- layer65_silu_6&#45;&gt;layer65_mul_6 -->
<g id="edge2126" class="edge">
<title>layer65_silu_6&#45;&gt;layer65_mul_6</title>
<path fill="none" stroke="black" d="M572.5,-27505.24C572.5,-27505.24 572.5,-27443.87 572.5,-27443.87"/>
<polygon fill="black" stroke="black" points="576,-27443.87 572.5,-27433.87 569,-27443.87 576,-27443.87"/>
</g>
<!-- layer65_silu_7&#45;&gt;layer65_mul_7 -->
<g id="edge2128" class="edge">
<title>layer65_silu_7&#45;&gt;layer65_mul_7</title>
<path fill="none" stroke="black" d="M789.5,-27505.24C789.5,-27505.24 789.5,-27443.87 789.5,-27443.87"/>
<polygon fill="black" stroke="black" points="793,-27443.87 789.5,-27433.87 786,-27443.87 793,-27443.87"/>
</g>
<!-- layer65_ffn_down_6 -->
<g id="node1668" class="node">
<title>layer65_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="607.5,-27293.49 435.5,-27293.49 435.5,-27225.49 607.5,-27225.49 607.5,-27293.49"/>
<text text-anchor="middle" x="521.5" y="-27278.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="521.5" y="-27263.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="521.5" y="-27248.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="521.5" y="-27233.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer65_mul_6&#45;&gt;layer65_ffn_down_6 -->
<g id="edge2130" class="edge">
<title>layer65_mul_6&#45;&gt;layer65_ffn_down_6</title>
<path fill="none" stroke="black" d="M521.5,-27365.24C521.5,-27365.24 521.5,-27303.87 521.5,-27303.87"/>
<polygon fill="black" stroke="black" points="525,-27303.87 521.5,-27293.87 518,-27303.87 525,-27303.87"/>
</g>
<!-- layer65_ffn_down_7 -->
<g id="node1669" class="node">
<title>layer65_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="817.5,-27293.49 645.5,-27293.49 645.5,-27225.49 817.5,-27225.49 817.5,-27293.49"/>
<text text-anchor="middle" x="731.5" y="-27278.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="731.5" y="-27263.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="731.5" y="-27248.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="731.5" y="-27233.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer65_mul_7&#45;&gt;layer65_ffn_down_7 -->
<g id="edge2131" class="edge">
<title>layer65_mul_7&#45;&gt;layer65_ffn_down_7</title>
<path fill="none" stroke="black" d="M731.5,-27365.24C731.5,-27365.24 731.5,-27303.87 731.5,-27303.87"/>
<polygon fill="black" stroke="black" points="735,-27303.87 731.5,-27293.87 728,-27303.87 735,-27303.87"/>
</g>
<!-- layer65_ffn_ar -->
<g id="node1670" class="node">
<title>layer65_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="625.5" cy="-27105.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="625.5" y="-27124.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="625.5" y="-27109.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="625.5" y="-27094.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="625.5" y="-27079.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer65_ffn_down_6&#45;&gt;layer65_ffn_ar -->
<g id="edge2132" class="edge">
<title>layer65_ffn_down_6&#45;&gt;layer65_ffn_ar</title>
<path fill="none" stroke="black" d="M555.69,-27225.3C555.69,-27225.3 555.69,-27154.95 555.69,-27154.95"/>
<polygon fill="black" stroke="black" points="559.19,-27154.95 555.69,-27144.95 552.19,-27154.95 559.19,-27154.95"/>
</g>
<!-- layer65_ffn_down_7&#45;&gt;layer65_ffn_ar -->
<g id="edge2133" class="edge">
<title>layer65_ffn_down_7&#45;&gt;layer65_ffn_ar</title>
<path fill="none" stroke="black" d="M696.31,-27225.3C696.31,-27225.3 696.31,-27154.67 696.31,-27154.67"/>
<polygon fill="black" stroke="black" points="699.81,-27154.67 696.31,-27144.67 692.81,-27154.67 699.81,-27154.67"/>
</g>
<!-- layer66_norm_6 -->
<g id="node1671" class="node">
<title>layer66_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="607.5,-26985.33 435.5,-26985.33 435.5,-26917.33 607.5,-26917.33 607.5,-26985.33"/>
<text text-anchor="middle" x="521.5" y="-26970.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="521.5" y="-26955.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="521.5" y="-26940.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="521.5" y="-26925.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer65_ffn_ar&#45;&gt;layer66_norm_6 -->
<g id="edge2134" class="edge">
<title>layer65_ffn_ar&#45;&gt;layer66_norm_6</title>
<path fill="none" stroke="black" d="M555.69,-27065.73C555.69,-27065.73 555.69,-26995.38 555.69,-26995.38"/>
<polygon fill="black" stroke="black" points="559.19,-26995.38 555.69,-26985.38 552.19,-26995.38 559.19,-26995.38"/>
</g>
<!-- layer66_norm_7 -->
<g id="node1672" class="node">
<title>layer66_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="817.5,-26985.33 645.5,-26985.33 645.5,-26917.33 817.5,-26917.33 817.5,-26985.33"/>
<text text-anchor="middle" x="731.5" y="-26970.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="731.5" y="-26955.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="731.5" y="-26940.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="731.5" y="-26925.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer65_ffn_ar&#45;&gt;layer66_norm_7 -->
<g id="edge2135" class="edge">
<title>layer65_ffn_ar&#45;&gt;layer66_norm_7</title>
<path fill="none" stroke="black" d="M696.31,-27066.13C696.31,-27066.13 696.31,-26995.56 696.31,-26995.56"/>
<polygon fill="black" stroke="black" points="699.81,-26995.56 696.31,-26985.56 692.81,-26995.56 699.81,-26995.56"/>
</g>
<!-- layer66_qkv_6 -->
<g id="node1673" class="node">
<title>layer66_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="608,-26845.33 427,-26845.33 427,-26777.33 608,-26777.33 608,-26845.33"/>
<text text-anchor="middle" x="517.5" y="-26830.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="517.5" y="-26815.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="517.5" y="-26800.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="517.5" y="-26785.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer66_norm_6&#45;&gt;layer66_qkv_6 -->
<g id="edge2136" class="edge">
<title>layer66_norm_6&#45;&gt;layer66_qkv_6</title>
<path fill="none" stroke="black" d="M521.5,-26917.08C521.5,-26917.08 521.5,-26855.7 521.5,-26855.7"/>
<polygon fill="black" stroke="black" points="525,-26855.7 521.5,-26845.7 518,-26855.7 525,-26855.7"/>
</g>
<!-- layer66_qkv_7 -->
<g id="node1674" class="node">
<title>layer66_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="825,-26845.33 644,-26845.33 644,-26777.33 825,-26777.33 825,-26845.33"/>
<text text-anchor="middle" x="734.5" y="-26830.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="734.5" y="-26815.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="734.5" y="-26800.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="734.5" y="-26785.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer66_norm_7&#45;&gt;layer66_qkv_7 -->
<g id="edge2137" class="edge">
<title>layer66_norm_7&#45;&gt;layer66_qkv_7</title>
<path fill="none" stroke="black" d="M731.5,-26917.08C731.5,-26917.08 731.5,-26855.7 731.5,-26855.7"/>
<polygon fill="black" stroke="black" points="735,-26855.7 731.5,-26845.7 728,-26855.7 735,-26855.7"/>
</g>
<!-- layer66_qkv_ar -->
<g id="node1675" class="node">
<title>layer66_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="625.5" cy="-26657.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="625.5" y="-26676.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="625.5" y="-26661.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="625.5" y="-26646.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="625.5" y="-26631.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer66_qkv_6&#45;&gt;layer66_qkv_ar -->
<g id="edge2138" class="edge">
<title>layer66_qkv_6&#45;&gt;layer66_qkv_ar</title>
<path fill="none" stroke="black" d="M552.76,-26777.13C552.76,-26777.13 552.76,-26707.06 552.76,-26707.06"/>
<polygon fill="black" stroke="black" points="556.26,-26707.06 552.76,-26697.06 549.26,-26707.06 556.26,-26707.06"/>
</g>
<!-- layer66_qkv_7&#45;&gt;layer66_qkv_ar -->
<g id="edge2139" class="edge">
<title>layer66_qkv_7&#45;&gt;layer66_qkv_ar</title>
<path fill="none" stroke="black" d="M698.74,-26777.13C698.74,-26777.13 698.74,-26706.78 698.74,-26706.78"/>
<polygon fill="black" stroke="black" points="702.24,-26706.78 698.74,-26696.78 695.24,-26706.78 702.24,-26706.78"/>
</g>
<!-- layer66_attn_6 -->
<g id="node1676" class="node">
<title>layer66_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="607.5,-26537.16 435.5,-26537.16 435.5,-26469.16 607.5,-26469.16 607.5,-26537.16"/>
<text text-anchor="middle" x="521.5" y="-26521.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="521.5" y="-26506.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="521.5" y="-26491.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="521.5" y="-26476.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer66_qkv_ar&#45;&gt;layer66_attn_6 -->
<g id="edge2140" class="edge">
<title>layer66_qkv_ar&#45;&gt;layer66_attn_6</title>
<path fill="none" stroke="black" d="M552.51,-26617.56C552.51,-26617.56 552.51,-26547.22 552.51,-26547.22"/>
<polygon fill="black" stroke="black" points="556.01,-26547.22 552.51,-26537.22 549.01,-26547.22 556.01,-26547.22"/>
</g>
<!-- layer66_attn_7 -->
<g id="node1677" class="node">
<title>layer66_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="815.5,-26537.16 643.5,-26537.16 643.5,-26469.16 815.5,-26469.16 815.5,-26537.16"/>
<text text-anchor="middle" x="729.5" y="-26521.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="729.5" y="-26506.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="729.5" y="-26491.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="729.5" y="-26476.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer66_qkv_ar&#45;&gt;layer66_attn_7 -->
<g id="edge2141" class="edge">
<title>layer66_qkv_ar&#45;&gt;layer66_attn_7</title>
<path fill="none" stroke="black" d="M698.49,-26617.56C698.49,-26617.56 698.49,-26547.22 698.49,-26547.22"/>
<polygon fill="black" stroke="black" points="701.99,-26547.22 698.49,-26537.22 694.99,-26547.22 701.99,-26547.22"/>
</g>
<!-- layer66_attn_out_6 -->
<g id="node1678" class="node">
<title>layer66_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="607.5,-26397.16 435.5,-26397.16 435.5,-26329.16 607.5,-26329.16 607.5,-26397.16"/>
<text text-anchor="middle" x="521.5" y="-26381.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="521.5" y="-26366.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="521.5" y="-26351.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="521.5" y="-26336.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer66_attn_6&#45;&gt;layer66_attn_out_6 -->
<g id="edge2142" class="edge">
<title>layer66_attn_6&#45;&gt;layer66_attn_out_6</title>
<path fill="none" stroke="black" d="M521.5,-26468.91C521.5,-26468.91 521.5,-26407.54 521.5,-26407.54"/>
<polygon fill="black" stroke="black" points="525,-26407.54 521.5,-26397.54 518,-26407.54 525,-26407.54"/>
</g>
<!-- layer66_attn_out_7 -->
<g id="node1679" class="node">
<title>layer66_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="815.5,-26397.16 643.5,-26397.16 643.5,-26329.16 815.5,-26329.16 815.5,-26397.16"/>
<text text-anchor="middle" x="729.5" y="-26381.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="729.5" y="-26366.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="729.5" y="-26351.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="729.5" y="-26336.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer66_attn_7&#45;&gt;layer66_attn_out_7 -->
<g id="edge2143" class="edge">
<title>layer66_attn_7&#45;&gt;layer66_attn_out_7</title>
<path fill="none" stroke="black" d="M729.5,-26468.91C729.5,-26468.91 729.5,-26407.54 729.5,-26407.54"/>
<polygon fill="black" stroke="black" points="733,-26407.54 729.5,-26397.54 726,-26407.54 733,-26407.54"/>
</g>
<!-- layer66_attn_ar -->
<g id="node1680" class="node">
<title>layer66_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="625.5" cy="-26209.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="625.5" y="-26227.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="625.5" y="-26212.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="625.5" y="-26197.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="625.5" y="-26182.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer66_attn_out_6&#45;&gt;layer66_attn_ar -->
<g id="edge2144" class="edge">
<title>layer66_attn_out_6&#45;&gt;layer66_attn_ar</title>
<path fill="none" stroke="black" d="M555.69,-26328.96C555.69,-26328.96 555.69,-26258.62 555.69,-26258.62"/>
<polygon fill="black" stroke="black" points="559.19,-26258.62 555.69,-26248.62 552.19,-26258.62 559.19,-26258.62"/>
</g>
<!-- layer66_attn_out_7&#45;&gt;layer66_attn_ar -->
<g id="edge2145" class="edge">
<title>layer66_attn_out_7&#45;&gt;layer66_attn_ar</title>
<path fill="none" stroke="black" d="M695.31,-26328.96C695.31,-26328.96 695.31,-26258.62 695.31,-26258.62"/>
<polygon fill="black" stroke="black" points="698.81,-26258.62 695.31,-26248.62 691.81,-26258.62 698.81,-26258.62"/>
</g>
<!-- layer66_ffn_norm_6 -->
<g id="node1681" class="node">
<title>layer66_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="603.5,-26088.99 431.5,-26088.99 431.5,-26020.99 603.5,-26020.99 603.5,-26088.99"/>
<text text-anchor="middle" x="517.5" y="-26073.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="517.5" y="-26058.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="517.5" y="-26043.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="517.5" y="-26028.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer66_attn_ar&#45;&gt;layer66_ffn_norm_6 -->
<g id="edge2146" class="edge">
<title>layer66_attn_ar&#45;&gt;layer66_ffn_norm_6</title>
<path fill="none" stroke="black" d="M553.69,-26170.19C553.69,-26170.19 553.69,-26099.14 553.69,-26099.14"/>
<polygon fill="black" stroke="black" points="557.19,-26099.14 553.69,-26089.14 550.19,-26099.14 557.19,-26099.14"/>
</g>
<!-- layer66_ffn_norm_7 -->
<g id="node1682" class="node">
<title>layer66_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="820.5,-26088.99 648.5,-26088.99 648.5,-26020.99 820.5,-26020.99 820.5,-26088.99"/>
<text text-anchor="middle" x="734.5" y="-26073.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="734.5" y="-26058.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="734.5" y="-26043.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="734.5" y="-26028.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer66_attn_ar&#45;&gt;layer66_ffn_norm_7 -->
<g id="edge2147" class="edge">
<title>layer66_attn_ar&#45;&gt;layer66_ffn_norm_7</title>
<path fill="none" stroke="black" d="M697.81,-26170.19C697.81,-26170.19 697.81,-26099.14 697.81,-26099.14"/>
<polygon fill="black" stroke="black" points="701.31,-26099.14 697.81,-26089.14 694.31,-26099.14 701.31,-26099.14"/>
</g>
<!-- layer66_ffn_gate_6 -->
<g id="node1683" class="node">
<title>layer66_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="608,-25948.99 427,-25948.99 427,-25880.99 608,-25880.99 608,-25948.99"/>
<text text-anchor="middle" x="517.5" y="-25933.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="517.5" y="-25918.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="517.5" y="-25903.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="517.5" y="-25888.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_ffn_norm_6&#45;&gt;layer66_ffn_gate_6 -->
<g id="edge2148" class="edge">
<title>layer66_ffn_norm_6&#45;&gt;layer66_ffn_gate_6</title>
<path fill="none" stroke="black" d="M517.5,-26020.74C517.5,-26020.74 517.5,-25959.37 517.5,-25959.37"/>
<polygon fill="black" stroke="black" points="521,-25959.37 517.5,-25949.37 514,-25959.37 521,-25959.37"/>
</g>
<!-- layer66_ffn_up_6 -->
<g id="node1685" class="node">
<title>layer66_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="391,-25948.99 210,-25948.99 210,-25880.99 391,-25880.99 391,-25948.99"/>
<text text-anchor="middle" x="300.5" y="-25933.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="300.5" y="-25918.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="300.5" y="-25903.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="300.5" y="-25888.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_ffn_norm_6&#45;&gt;layer66_ffn_up_6 -->
<g id="edge2150" class="edge">
<title>layer66_ffn_norm_6&#45;&gt;layer66_ffn_up_6</title>
<path fill="none" stroke="black" d="M431.31,-26054C391.86,-26054 353.76,-26054 353.76,-26054 353.76,-26054 353.76,-25959 353.76,-25959"/>
<polygon fill="black" stroke="black" points="357.26,-25959 353.76,-25949 350.26,-25959 357.26,-25959"/>
</g>
<!-- layer66_ffn_gate_7 -->
<g id="node1684" class="node">
<title>layer66_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1042,-25948.99 861,-25948.99 861,-25880.99 1042,-25880.99 1042,-25948.99"/>
<text text-anchor="middle" x="951.5" y="-25933.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="951.5" y="-25918.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="951.5" y="-25903.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="951.5" y="-25888.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_ffn_norm_7&#45;&gt;layer66_ffn_gate_7 -->
<g id="edge2149" class="edge">
<title>layer66_ffn_norm_7&#45;&gt;layer66_ffn_gate_7</title>
<path fill="none" stroke="black" d="M820.56,-26054C859.95,-26054 898,-26054 898,-26054 898,-26054 898,-25959 898,-25959"/>
<polygon fill="black" stroke="black" points="901.5,-25959 898,-25949 894.5,-25959 901.5,-25959"/>
</g>
<!-- layer66_ffn_up_7 -->
<g id="node1686" class="node">
<title>layer66_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="825,-25948.99 644,-25948.99 644,-25880.99 825,-25880.99 825,-25948.99"/>
<text text-anchor="middle" x="734.5" y="-25933.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="734.5" y="-25918.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="734.5" y="-25903.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="734.5" y="-25888.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_ffn_norm_7&#45;&gt;layer66_ffn_up_7 -->
<g id="edge2151" class="edge">
<title>layer66_ffn_norm_7&#45;&gt;layer66_ffn_up_7</title>
<path fill="none" stroke="black" d="M734.5,-26020.74C734.5,-26020.74 734.5,-25959.37 734.5,-25959.37"/>
<polygon fill="black" stroke="black" points="738,-25959.37 734.5,-25949.37 731,-25959.37 738,-25959.37"/>
</g>
<!-- layer66_gate_ar -->
<g id="node1687" class="node">
<title>layer66_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="825.5" cy="-25760.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="825.5" y="-25779.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="825.5" y="-25764.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="825.5" y="-25749.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="825.5" y="-25734.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer66_ffn_gate_6&#45;&gt;layer66_gate_ar -->
<g id="edge2152" class="edge">
<title>layer66_ffn_gate_6&#45;&gt;layer66_gate_ar</title>
<path fill="none" stroke="black" d="M608.08,-25914C618.79,-25914 626,-25914 626,-25914 626,-25914 626,-25776 626,-25776 626,-25776 693.7,-25776 693.7,-25776"/>
<polygon fill="black" stroke="black" points="693.7,-25779.5 703.7,-25776 693.7,-25772.5 693.7,-25779.5"/>
</g>
<!-- layer66_ffn_gate_7&#45;&gt;layer66_gate_ar -->
<g id="edge2153" class="edge">
<title>layer66_ffn_gate_7&#45;&gt;layer66_gate_ar</title>
<path fill="none" stroke="black" d="M907.24,-25880.8C907.24,-25880.8 907.24,-25807.97 907.24,-25807.97"/>
<polygon fill="black" stroke="black" points="910.74,-25807.97 907.24,-25797.97 903.74,-25807.97 910.74,-25807.97"/>
</g>
<!-- layer66_up_ar -->
<g id="node1688" class="node">
<title>layer66_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="479.5" cy="-25760.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="479.5" y="-25779.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="479.5" y="-25764.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="479.5" y="-25749.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="479.5" y="-25734.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer66_ffn_up_6&#45;&gt;layer66_up_ar -->
<g id="edge2154" class="edge">
<title>layer66_ffn_up_6&#45;&gt;layer66_up_ar</title>
<path fill="none" stroke="black" d="M371.26,-25880.8C371.26,-25880.8 371.26,-25796.87 371.26,-25796.87"/>
<polygon fill="black" stroke="black" points="374.76,-25796.87 371.26,-25786.87 367.76,-25796.87 374.76,-25796.87"/>
</g>
<!-- layer66_ffn_up_7&#45;&gt;layer66_up_ar -->
<g id="edge2155" class="edge">
<title>layer66_ffn_up_7&#45;&gt;layer66_up_ar</title>
<path fill="none" stroke="black" d="M670.76,-25880.8C670.76,-25830.9 670.76,-25744 670.76,-25744 670.76,-25744 609.54,-25744 609.54,-25744"/>
<polygon fill="black" stroke="black" points="609.54,-25740.5 599.54,-25744 609.54,-25747.5 609.54,-25740.5"/>
</g>
<!-- layer66_silu_6 -->
<g id="node1689" class="node">
<title>layer66_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="753,-25640.83 572,-25640.83 572,-25572.83 753,-25572.83 753,-25640.83"/>
<text text-anchor="middle" x="662.5" y="-25625.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="662.5" y="-25610.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="662.5" y="-25595.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="662.5" y="-25580.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_gate_ar&#45;&gt;layer66_silu_6 -->
<g id="edge2156" class="edge">
<title>layer66_gate_ar&#45;&gt;layer66_silu_6</title>
<path fill="none" stroke="black" d="M725.26,-25730.83C725.26,-25730.83 725.26,-25650.85 725.26,-25650.85"/>
<polygon fill="black" stroke="black" points="728.76,-25650.85 725.26,-25640.85 721.76,-25650.85 728.76,-25650.85"/>
</g>
<!-- layer66_silu_7 -->
<g id="node1690" class="node">
<title>layer66_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="970,-25640.83 789,-25640.83 789,-25572.83 970,-25572.83 970,-25640.83"/>
<text text-anchor="middle" x="879.5" y="-25625.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="879.5" y="-25610.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="879.5" y="-25595.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="879.5" y="-25580.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_gate_ar&#45;&gt;layer66_silu_7 -->
<g id="edge2157" class="edge">
<title>layer66_gate_ar&#45;&gt;layer66_silu_7</title>
<path fill="none" stroke="black" d="M871.24,-25715.93C871.24,-25715.93 871.24,-25650.83 871.24,-25650.83"/>
<polygon fill="black" stroke="black" points="874.74,-25650.83 871.24,-25640.83 867.74,-25650.83 874.74,-25650.83"/>
</g>
<!-- layer66_mul_6 -->
<g id="node1691" class="node">
<title>layer66_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="643,-25500.83 462,-25500.83 462,-25432.83 643,-25432.83 643,-25500.83"/>
<text text-anchor="middle" x="552.5" y="-25485.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="552.5" y="-25470.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="552.5" y="-25455.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="552.5" y="-25440.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_up_ar&#45;&gt;layer66_mul_6 -->
<g id="edge2159" class="edge">
<title>layer66_up_ar&#45;&gt;layer66_mul_6</title>
<path fill="none" stroke="black" d="M517,-25714.63C517,-25714.63 517,-25510.91 517,-25510.91"/>
<polygon fill="black" stroke="black" points="520.5,-25510.91 517,-25500.91 513.5,-25510.91 520.5,-25510.91"/>
</g>
<!-- layer66_mul_7 -->
<g id="node1692" class="node">
<title>layer66_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="860,-25500.83 679,-25500.83 679,-25432.83 860,-25432.83 860,-25500.83"/>
<text text-anchor="middle" x="769.5" y="-25485.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="769.5" y="-25470.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="769.5" y="-25455.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="769.5" y="-25440.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer66_up_ar&#45;&gt;layer66_mul_7 -->
<g id="edge2161" class="edge">
<title>layer66_up_ar&#45;&gt;layer66_mul_7</title>
<path fill="none" stroke="black" d="M589.74,-25736.35C589.74,-25711.27 589.74,-25676 589.74,-25676 589.74,-25676 771,-25676 771,-25676 771,-25676 771,-25510.9 771,-25510.9"/>
<polygon fill="black" stroke="black" points="774.5,-25510.9 771,-25500.9 767.5,-25510.9 774.5,-25510.9"/>
</g>
<!-- layer66_silu_6&#45;&gt;layer66_mul_6 -->
<g id="edge2158" class="edge">
<title>layer66_silu_6&#45;&gt;layer66_mul_6</title>
<path fill="none" stroke="black" d="M607.5,-25572.58C607.5,-25572.58 607.5,-25511.21 607.5,-25511.21"/>
<polygon fill="black" stroke="black" points="611,-25511.21 607.5,-25501.21 604,-25511.21 611,-25511.21"/>
</g>
<!-- layer66_silu_7&#45;&gt;layer66_mul_7 -->
<g id="edge2160" class="edge">
<title>layer66_silu_7&#45;&gt;layer66_mul_7</title>
<path fill="none" stroke="black" d="M824.5,-25572.58C824.5,-25572.58 824.5,-25511.21 824.5,-25511.21"/>
<polygon fill="black" stroke="black" points="828,-25511.21 824.5,-25501.21 821,-25511.21 828,-25511.21"/>
</g>
<!-- layer66_ffn_down_6 -->
<g id="node1693" class="node">
<title>layer66_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-25360.83 470.5,-25360.83 470.5,-25292.83 642.5,-25292.83 642.5,-25360.83"/>
<text text-anchor="middle" x="556.5" y="-25345.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="556.5" y="-25330.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="556.5" y="-25315.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="556.5" y="-25300.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer66_mul_6&#45;&gt;layer66_ffn_down_6 -->
<g id="edge2162" class="edge">
<title>layer66_mul_6&#45;&gt;layer66_ffn_down_6</title>
<path fill="none" stroke="black" d="M556.5,-25432.58C556.5,-25432.58 556.5,-25371.21 556.5,-25371.21"/>
<polygon fill="black" stroke="black" points="560,-25371.21 556.5,-25361.21 553,-25371.21 560,-25371.21"/>
</g>
<!-- layer66_ffn_down_7 -->
<g id="node1694" class="node">
<title>layer66_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="852.5,-25360.83 680.5,-25360.83 680.5,-25292.83 852.5,-25292.83 852.5,-25360.83"/>
<text text-anchor="middle" x="766.5" y="-25345.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="766.5" y="-25330.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="766.5" y="-25315.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="766.5" y="-25300.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer66_mul_7&#45;&gt;layer66_ffn_down_7 -->
<g id="edge2163" class="edge">
<title>layer66_mul_7&#45;&gt;layer66_ffn_down_7</title>
<path fill="none" stroke="black" d="M766.5,-25432.58C766.5,-25432.58 766.5,-25371.21 766.5,-25371.21"/>
<polygon fill="black" stroke="black" points="770,-25371.21 766.5,-25361.21 763,-25371.21 770,-25371.21"/>
</g>
<!-- layer66_ffn_ar -->
<g id="node1695" class="node">
<title>layer66_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="660.5" cy="-25172.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="660.5" y="-25191.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="660.5" y="-25176.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="660.5" y="-25161.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="660.5" y="-25146.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer66_ffn_down_6&#45;&gt;layer66_ffn_ar -->
<g id="edge2164" class="edge">
<title>layer66_ffn_down_6&#45;&gt;layer66_ffn_ar</title>
<path fill="none" stroke="black" d="M590.69,-25292.63C590.69,-25292.63 590.69,-25222.29 590.69,-25222.29"/>
<polygon fill="black" stroke="black" points="594.19,-25222.29 590.69,-25212.29 587.19,-25222.29 594.19,-25222.29"/>
</g>
<!-- layer66_ffn_down_7&#45;&gt;layer66_ffn_ar -->
<g id="edge2165" class="edge">
<title>layer66_ffn_down_7&#45;&gt;layer66_ffn_ar</title>
<path fill="none" stroke="black" d="M731.31,-25292.63C731.31,-25292.63 731.31,-25222.01 731.31,-25222.01"/>
<polygon fill="black" stroke="black" points="734.81,-25222.01 731.31,-25212.01 727.81,-25222.01 734.81,-25222.01"/>
</g>
<!-- layer67_norm_6 -->
<g id="node1696" class="node">
<title>layer67_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-25052.66 470.5,-25052.66 470.5,-24984.66 642.5,-24984.66 642.5,-25052.66"/>
<text text-anchor="middle" x="556.5" y="-25037.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="556.5" y="-25022.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="556.5" y="-25007.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="556.5" y="-24992.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer66_ffn_ar&#45;&gt;layer67_norm_6 -->
<g id="edge2166" class="edge">
<title>layer66_ffn_ar&#45;&gt;layer67_norm_6</title>
<path fill="none" stroke="black" d="M590.69,-25133.06C590.69,-25133.06 590.69,-25062.72 590.69,-25062.72"/>
<polygon fill="black" stroke="black" points="594.19,-25062.72 590.69,-25052.72 587.19,-25062.72 594.19,-25062.72"/>
</g>
<!-- layer67_norm_7 -->
<g id="node1697" class="node">
<title>layer67_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="852.5,-25052.66 680.5,-25052.66 680.5,-24984.66 852.5,-24984.66 852.5,-25052.66"/>
<text text-anchor="middle" x="766.5" y="-25037.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="766.5" y="-25022.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="766.5" y="-25007.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="766.5" y="-24992.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer66_ffn_ar&#45;&gt;layer67_norm_7 -->
<g id="edge2167" class="edge">
<title>layer66_ffn_ar&#45;&gt;layer67_norm_7</title>
<path fill="none" stroke="black" d="M731.31,-25133.46C731.31,-25133.46 731.31,-25062.89 731.31,-25062.89"/>
<polygon fill="black" stroke="black" points="734.81,-25062.89 731.31,-25052.89 727.81,-25062.89 734.81,-25062.89"/>
</g>
<!-- layer67_qkv_6 -->
<g id="node1698" class="node">
<title>layer67_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="643,-24912.66 462,-24912.66 462,-24844.66 643,-24844.66 643,-24912.66"/>
<text text-anchor="middle" x="552.5" y="-24897.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="552.5" y="-24882.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="552.5" y="-24867.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="552.5" y="-24852.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer67_norm_6&#45;&gt;layer67_qkv_6 -->
<g id="edge2168" class="edge">
<title>layer67_norm_6&#45;&gt;layer67_qkv_6</title>
<path fill="none" stroke="black" d="M556.5,-24984.41C556.5,-24984.41 556.5,-24923.04 556.5,-24923.04"/>
<polygon fill="black" stroke="black" points="560,-24923.04 556.5,-24913.04 553,-24923.04 560,-24923.04"/>
</g>
<!-- layer67_qkv_7 -->
<g id="node1699" class="node">
<title>layer67_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="860,-24912.66 679,-24912.66 679,-24844.66 860,-24844.66 860,-24912.66"/>
<text text-anchor="middle" x="769.5" y="-24897.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="769.5" y="-24882.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="769.5" y="-24867.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="769.5" y="-24852.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer67_norm_7&#45;&gt;layer67_qkv_7 -->
<g id="edge2169" class="edge">
<title>layer67_norm_7&#45;&gt;layer67_qkv_7</title>
<path fill="none" stroke="black" d="M766.5,-24984.41C766.5,-24984.41 766.5,-24923.04 766.5,-24923.04"/>
<polygon fill="black" stroke="black" points="770,-24923.04 766.5,-24913.04 763,-24923.04 770,-24923.04"/>
</g>
<!-- layer67_qkv_ar -->
<g id="node1700" class="node">
<title>layer67_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="660.5" cy="-24724.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="660.5" y="-24743.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="660.5" y="-24728.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="660.5" y="-24713.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="660.5" y="-24698.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer67_qkv_6&#45;&gt;layer67_qkv_ar -->
<g id="edge2170" class="edge">
<title>layer67_qkv_6&#45;&gt;layer67_qkv_ar</title>
<path fill="none" stroke="black" d="M587.76,-24844.46C587.76,-24844.46 587.76,-24774.4 587.76,-24774.4"/>
<polygon fill="black" stroke="black" points="591.26,-24774.4 587.76,-24764.4 584.26,-24774.4 591.26,-24774.4"/>
</g>
<!-- layer67_qkv_7&#45;&gt;layer67_qkv_ar -->
<g id="edge2171" class="edge">
<title>layer67_qkv_7&#45;&gt;layer67_qkv_ar</title>
<path fill="none" stroke="black" d="M733.74,-24844.46C733.74,-24844.46 733.74,-24774.12 733.74,-24774.12"/>
<polygon fill="black" stroke="black" points="737.24,-24774.12 733.74,-24764.12 730.24,-24774.12 737.24,-24774.12"/>
</g>
<!-- layer67_attn_6 -->
<g id="node1701" class="node">
<title>layer67_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-24604.49 470.5,-24604.49 470.5,-24536.49 642.5,-24536.49 642.5,-24604.49"/>
<text text-anchor="middle" x="556.5" y="-24589.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="556.5" y="-24574.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="556.5" y="-24559.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="556.5" y="-24544.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer67_qkv_ar&#45;&gt;layer67_attn_6 -->
<g id="edge2172" class="edge">
<title>layer67_qkv_ar&#45;&gt;layer67_attn_6</title>
<path fill="none" stroke="black" d="M587.51,-24684.9C587.51,-24684.9 587.51,-24614.55 587.51,-24614.55"/>
<polygon fill="black" stroke="black" points="591.01,-24614.55 587.51,-24604.55 584.01,-24614.55 591.01,-24614.55"/>
</g>
<!-- layer67_attn_7 -->
<g id="node1702" class="node">
<title>layer67_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="850.5,-24604.49 678.5,-24604.49 678.5,-24536.49 850.5,-24536.49 850.5,-24604.49"/>
<text text-anchor="middle" x="764.5" y="-24589.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="764.5" y="-24574.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="764.5" y="-24559.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="764.5" y="-24544.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer67_qkv_ar&#45;&gt;layer67_attn_7 -->
<g id="edge2173" class="edge">
<title>layer67_qkv_ar&#45;&gt;layer67_attn_7</title>
<path fill="none" stroke="black" d="M733.49,-24684.9C733.49,-24684.9 733.49,-24614.55 733.49,-24614.55"/>
<polygon fill="black" stroke="black" points="736.99,-24614.55 733.49,-24604.55 729.99,-24614.55 736.99,-24614.55"/>
</g>
<!-- layer67_attn_out_6 -->
<g id="node1703" class="node">
<title>layer67_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="642.5,-24464.49 470.5,-24464.49 470.5,-24396.49 642.5,-24396.49 642.5,-24464.49"/>
<text text-anchor="middle" x="556.5" y="-24449.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="556.5" y="-24434.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="556.5" y="-24419.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="556.5" y="-24404.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer67_attn_6&#45;&gt;layer67_attn_out_6 -->
<g id="edge2174" class="edge">
<title>layer67_attn_6&#45;&gt;layer67_attn_out_6</title>
<path fill="none" stroke="black" d="M556.5,-24536.24C556.5,-24536.24 556.5,-24474.87 556.5,-24474.87"/>
<polygon fill="black" stroke="black" points="560,-24474.87 556.5,-24464.87 553,-24474.87 560,-24474.87"/>
</g>
<!-- layer67_attn_out_7 -->
<g id="node1704" class="node">
<title>layer67_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="850.5,-24464.49 678.5,-24464.49 678.5,-24396.49 850.5,-24396.49 850.5,-24464.49"/>
<text text-anchor="middle" x="764.5" y="-24449.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="764.5" y="-24434.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="764.5" y="-24419.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="764.5" y="-24404.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer67_attn_7&#45;&gt;layer67_attn_out_7 -->
<g id="edge2175" class="edge">
<title>layer67_attn_7&#45;&gt;layer67_attn_out_7</title>
<path fill="none" stroke="black" d="M764.5,-24536.24C764.5,-24536.24 764.5,-24474.87 764.5,-24474.87"/>
<polygon fill="black" stroke="black" points="768,-24474.87 764.5,-24464.87 761,-24474.87 768,-24474.87"/>
</g>
<!-- layer67_attn_ar -->
<g id="node1705" class="node">
<title>layer67_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="660.5" cy="-24276.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="660.5" y="-24295.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="660.5" y="-24280.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="660.5" y="-24265.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="660.5" y="-24250.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer67_attn_out_6&#45;&gt;layer67_attn_ar -->
<g id="edge2176" class="edge">
<title>layer67_attn_out_6&#45;&gt;layer67_attn_ar</title>
<path fill="none" stroke="black" d="M590.69,-24396.3C590.69,-24396.3 590.69,-24325.95 590.69,-24325.95"/>
<polygon fill="black" stroke="black" points="594.19,-24325.95 590.69,-24315.95 587.19,-24325.95 594.19,-24325.95"/>
</g>
<!-- layer67_attn_out_7&#45;&gt;layer67_attn_ar -->
<g id="edge2177" class="edge">
<title>layer67_attn_out_7&#45;&gt;layer67_attn_ar</title>
<path fill="none" stroke="black" d="M730.31,-24396.3C730.31,-24396.3 730.31,-24325.95 730.31,-24325.95"/>
<polygon fill="black" stroke="black" points="733.81,-24325.95 730.31,-24315.95 726.81,-24325.95 733.81,-24325.95"/>
</g>
<!-- layer67_ffn_norm_6 -->
<g id="node1706" class="node">
<title>layer67_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="638.5,-24156.33 466.5,-24156.33 466.5,-24088.33 638.5,-24088.33 638.5,-24156.33"/>
<text text-anchor="middle" x="552.5" y="-24141.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="552.5" y="-24126.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="552.5" y="-24111.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="552.5" y="-24096.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer67_attn_ar&#45;&gt;layer67_ffn_norm_6 -->
<g id="edge2178" class="edge">
<title>layer67_attn_ar&#45;&gt;layer67_ffn_norm_6</title>
<path fill="none" stroke="black" d="M588.69,-24237.53C588.69,-24237.53 588.69,-24166.47 588.69,-24166.47"/>
<polygon fill="black" stroke="black" points="592.19,-24166.47 588.69,-24156.47 585.19,-24166.47 592.19,-24166.47"/>
</g>
<!-- layer67_ffn_norm_7 -->
<g id="node1707" class="node">
<title>layer67_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="855.5,-24156.33 683.5,-24156.33 683.5,-24088.33 855.5,-24088.33 855.5,-24156.33"/>
<text text-anchor="middle" x="769.5" y="-24141.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="769.5" y="-24126.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="769.5" y="-24111.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="769.5" y="-24096.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer67_attn_ar&#45;&gt;layer67_ffn_norm_7 -->
<g id="edge2179" class="edge">
<title>layer67_attn_ar&#45;&gt;layer67_ffn_norm_7</title>
<path fill="none" stroke="black" d="M732.81,-24237.53C732.81,-24237.53 732.81,-24166.47 732.81,-24166.47"/>
<polygon fill="black" stroke="black" points="736.31,-24166.47 732.81,-24156.47 729.31,-24166.47 736.31,-24166.47"/>
</g>
<!-- layer67_ffn_gate_6 -->
<g id="node1708" class="node">
<title>layer67_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="643,-24016.33 462,-24016.33 462,-23948.33 643,-23948.33 643,-24016.33"/>
<text text-anchor="middle" x="552.5" y="-24001.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="552.5" y="-23986.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="552.5" y="-23971.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="552.5" y="-23956.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_ffn_norm_6&#45;&gt;layer67_ffn_gate_6 -->
<g id="edge2180" class="edge">
<title>layer67_ffn_norm_6&#45;&gt;layer67_ffn_gate_6</title>
<path fill="none" stroke="black" d="M552.5,-24088.08C552.5,-24088.08 552.5,-24026.71 552.5,-24026.71"/>
<polygon fill="black" stroke="black" points="556,-24026.71 552.5,-24016.71 549,-24026.71 556,-24026.71"/>
</g>
<!-- layer67_ffn_up_6 -->
<g id="node1710" class="node">
<title>layer67_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="426,-24016.33 245,-24016.33 245,-23948.33 426,-23948.33 426,-24016.33"/>
<text text-anchor="middle" x="335.5" y="-24001.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="335.5" y="-23986.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="335.5" y="-23971.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="335.5" y="-23956.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_ffn_norm_6&#45;&gt;layer67_ffn_up_6 -->
<g id="edge2182" class="edge">
<title>layer67_ffn_norm_6&#45;&gt;layer67_ffn_up_6</title>
<path fill="none" stroke="black" d="M466.31,-24122C426.86,-24122 388.76,-24122 388.76,-24122 388.76,-24122 388.76,-24026.49 388.76,-24026.49"/>
<polygon fill="black" stroke="black" points="392.26,-24026.49 388.76,-24016.49 385.26,-24026.49 392.26,-24026.49"/>
</g>
<!-- layer67_ffn_gate_7 -->
<g id="node1709" class="node">
<title>layer67_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1077,-24016.33 896,-24016.33 896,-23948.33 1077,-23948.33 1077,-24016.33"/>
<text text-anchor="middle" x="986.5" y="-24001.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="986.5" y="-23986.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="986.5" y="-23971.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="986.5" y="-23956.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_ffn_norm_7&#45;&gt;layer67_ffn_gate_7 -->
<g id="edge2181" class="edge">
<title>layer67_ffn_norm_7&#45;&gt;layer67_ffn_gate_7</title>
<path fill="none" stroke="black" d="M855.56,-24122C894.95,-24122 933,-24122 933,-24122 933,-24122 933,-24026.49 933,-24026.49"/>
<polygon fill="black" stroke="black" points="936.5,-24026.49 933,-24016.49 929.5,-24026.49 936.5,-24026.49"/>
</g>
<!-- layer67_ffn_up_7 -->
<g id="node1711" class="node">
<title>layer67_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="860,-24016.33 679,-24016.33 679,-23948.33 860,-23948.33 860,-24016.33"/>
<text text-anchor="middle" x="769.5" y="-24001.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="769.5" y="-23986.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="769.5" y="-23971.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="769.5" y="-23956.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_ffn_norm_7&#45;&gt;layer67_ffn_up_7 -->
<g id="edge2183" class="edge">
<title>layer67_ffn_norm_7&#45;&gt;layer67_ffn_up_7</title>
<path fill="none" stroke="black" d="M769.5,-24088.08C769.5,-24088.08 769.5,-24026.71 769.5,-24026.71"/>
<polygon fill="black" stroke="black" points="773,-24026.71 769.5,-24016.71 766,-24026.71 773,-24026.71"/>
</g>
<!-- layer67_gate_ar -->
<g id="node1712" class="node">
<title>layer67_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="860.5" cy="-23828.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="860.5" y="-23847.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="860.5" y="-23832.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="860.5" y="-23817.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="860.5" y="-23802.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer67_ffn_gate_6&#45;&gt;layer67_gate_ar -->
<g id="edge2184" class="edge">
<title>layer67_ffn_gate_6&#45;&gt;layer67_gate_ar</title>
<path fill="none" stroke="black" d="M643.08,-23982C653.79,-23982 661,-23982 661,-23982 661,-23982 661,-23844 661,-23844 661,-23844 729.56,-23844 729.56,-23844"/>
<polygon fill="black" stroke="black" points="729.56,-23847.5 739.56,-23844 729.56,-23840.5 729.56,-23847.5"/>
</g>
<!-- layer67_ffn_gate_7&#45;&gt;layer67_gate_ar -->
<g id="edge2185" class="edge">
<title>layer67_ffn_gate_7&#45;&gt;layer67_gate_ar</title>
<path fill="none" stroke="black" d="M942.24,-23948.13C942.24,-23948.13 942.24,-23875.31 942.24,-23875.31"/>
<polygon fill="black" stroke="black" points="945.74,-23875.31 942.24,-23865.31 938.74,-23875.31 945.74,-23875.31"/>
</g>
<!-- layer67_up_ar -->
<g id="node1713" class="node">
<title>layer67_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="514.5" cy="-23828.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="514.5" y="-23847.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="514.5" y="-23832.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="514.5" y="-23817.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="514.5" y="-23802.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer67_ffn_up_6&#45;&gt;layer67_up_ar -->
<g id="edge2186" class="edge">
<title>layer67_ffn_up_6&#45;&gt;layer67_up_ar</title>
<path fill="none" stroke="black" d="M406.26,-23948.13C406.26,-23948.13 406.26,-23864.21 406.26,-23864.21"/>
<polygon fill="black" stroke="black" points="409.76,-23864.21 406.26,-23854.21 402.76,-23864.21 409.76,-23864.21"/>
</g>
<!-- layer67_ffn_up_7&#45;&gt;layer67_up_ar -->
<g id="edge2187" class="edge">
<title>layer67_ffn_up_7&#45;&gt;layer67_up_ar</title>
<path fill="none" stroke="black" d="M705.76,-23948.27C705.76,-23898.56 705.76,-23812 705.76,-23812 705.76,-23812 645.08,-23812 645.08,-23812"/>
<polygon fill="black" stroke="black" points="645.08,-23808.5 635.08,-23812 645.08,-23815.5 645.08,-23808.5"/>
</g>
<!-- layer67_silu_6 -->
<g id="node1714" class="node">
<title>layer67_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="788,-23708.16 607,-23708.16 607,-23640.16 788,-23640.16 788,-23708.16"/>
<text text-anchor="middle" x="697.5" y="-23692.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="697.5" y="-23677.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="697.5" y="-23662.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="697.5" y="-23647.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_gate_ar&#45;&gt;layer67_silu_6 -->
<g id="edge2188" class="edge">
<title>layer67_gate_ar&#45;&gt;layer67_silu_6</title>
<path fill="none" stroke="black" d="M760.26,-23798.17C760.26,-23798.17 760.26,-23718.18 760.26,-23718.18"/>
<polygon fill="black" stroke="black" points="763.76,-23718.18 760.26,-23708.18 756.76,-23718.18 763.76,-23718.18"/>
</g>
<!-- layer67_silu_7 -->
<g id="node1715" class="node">
<title>layer67_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1005,-23708.16 824,-23708.16 824,-23640.16 1005,-23640.16 1005,-23708.16"/>
<text text-anchor="middle" x="914.5" y="-23692.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="914.5" y="-23677.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="914.5" y="-23662.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="914.5" y="-23647.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_gate_ar&#45;&gt;layer67_silu_7 -->
<g id="edge2189" class="edge">
<title>layer67_gate_ar&#45;&gt;layer67_silu_7</title>
<path fill="none" stroke="black" d="M906.24,-23783.26C906.24,-23783.26 906.24,-23718.17 906.24,-23718.17"/>
<polygon fill="black" stroke="black" points="909.74,-23718.17 906.24,-23708.17 902.74,-23718.17 909.74,-23718.17"/>
</g>
<!-- layer67_mul_6 -->
<g id="node1716" class="node">
<title>layer67_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="678,-23568.16 497,-23568.16 497,-23500.16 678,-23500.16 678,-23568.16"/>
<text text-anchor="middle" x="587.5" y="-23552.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="587.5" y="-23537.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="587.5" y="-23522.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="587.5" y="-23507.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_up_ar&#45;&gt;layer67_mul_6 -->
<g id="edge2191" class="edge">
<title>layer67_up_ar&#45;&gt;layer67_mul_6</title>
<path fill="none" stroke="black" d="M552,-23781.97C552,-23781.97 552,-23578.24 552,-23578.24"/>
<polygon fill="black" stroke="black" points="555.5,-23578.24 552,-23568.24 548.5,-23578.24 555.5,-23578.24"/>
</g>
<!-- layer67_mul_7 -->
<g id="node1717" class="node">
<title>layer67_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="895,-23568.16 714,-23568.16 714,-23500.16 895,-23500.16 895,-23568.16"/>
<text text-anchor="middle" x="804.5" y="-23552.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="804.5" y="-23537.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="804.5" y="-23522.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="804.5" y="-23507.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer67_up_ar&#45;&gt;layer67_mul_7 -->
<g id="edge2193" class="edge">
<title>layer67_up_ar&#45;&gt;layer67_mul_7</title>
<path fill="none" stroke="black" d="M624.74,-23803.42C624.74,-23778.57 624.74,-23744 624.74,-23744 624.74,-23744 806,-23744 806,-23744 806,-23744 806,-23578.34 806,-23578.34"/>
<polygon fill="black" stroke="black" points="809.5,-23578.34 806,-23568.34 802.5,-23578.34 809.5,-23578.34"/>
</g>
<!-- layer67_silu_6&#45;&gt;layer67_mul_6 -->
<g id="edge2190" class="edge">
<title>layer67_silu_6&#45;&gt;layer67_mul_6</title>
<path fill="none" stroke="black" d="M642.5,-23639.91C642.5,-23639.91 642.5,-23578.54 642.5,-23578.54"/>
<polygon fill="black" stroke="black" points="646,-23578.54 642.5,-23568.54 639,-23578.54 646,-23578.54"/>
</g>
<!-- layer67_silu_7&#45;&gt;layer67_mul_7 -->
<g id="edge2192" class="edge">
<title>layer67_silu_7&#45;&gt;layer67_mul_7</title>
<path fill="none" stroke="black" d="M859.5,-23639.91C859.5,-23639.91 859.5,-23578.54 859.5,-23578.54"/>
<polygon fill="black" stroke="black" points="863,-23578.54 859.5,-23568.54 856,-23578.54 863,-23578.54"/>
</g>
<!-- layer67_ffn_down_6 -->
<g id="node1718" class="node">
<title>layer67_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="677.5,-23428.16 505.5,-23428.16 505.5,-23360.16 677.5,-23360.16 677.5,-23428.16"/>
<text text-anchor="middle" x="591.5" y="-23412.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="591.5" y="-23397.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="591.5" y="-23382.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="591.5" y="-23367.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer67_mul_6&#45;&gt;layer67_ffn_down_6 -->
<g id="edge2194" class="edge">
<title>layer67_mul_6&#45;&gt;layer67_ffn_down_6</title>
<path fill="none" stroke="black" d="M591.5,-23499.91C591.5,-23499.91 591.5,-23438.54 591.5,-23438.54"/>
<polygon fill="black" stroke="black" points="595,-23438.54 591.5,-23428.54 588,-23438.54 595,-23438.54"/>
</g>
<!-- layer67_ffn_down_7 -->
<g id="node1719" class="node">
<title>layer67_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="887.5,-23428.16 715.5,-23428.16 715.5,-23360.16 887.5,-23360.16 887.5,-23428.16"/>
<text text-anchor="middle" x="801.5" y="-23412.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="801.5" y="-23397.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="801.5" y="-23382.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="801.5" y="-23367.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer67_mul_7&#45;&gt;layer67_ffn_down_7 -->
<g id="edge2195" class="edge">
<title>layer67_mul_7&#45;&gt;layer67_ffn_down_7</title>
<path fill="none" stroke="black" d="M801.5,-23499.91C801.5,-23499.91 801.5,-23438.54 801.5,-23438.54"/>
<polygon fill="black" stroke="black" points="805,-23438.54 801.5,-23428.54 798,-23438.54 805,-23438.54"/>
</g>
<!-- layer67_ffn_ar -->
<g id="node1720" class="node">
<title>layer67_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="695.5" cy="-23240.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="695.5" y="-23258.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="695.5" y="-23243.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="695.5" y="-23228.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="695.5" y="-23213.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer67_ffn_down_6&#45;&gt;layer67_ffn_ar -->
<g id="edge2196" class="edge">
<title>layer67_ffn_down_6&#45;&gt;layer67_ffn_ar</title>
<path fill="none" stroke="black" d="M625.69,-23359.96C625.69,-23359.96 625.69,-23289.62 625.69,-23289.62"/>
<polygon fill="black" stroke="black" points="629.19,-23289.62 625.69,-23279.62 622.19,-23289.62 629.19,-23289.62"/>
</g>
<!-- layer67_ffn_down_7&#45;&gt;layer67_ffn_ar -->
<g id="edge2197" class="edge">
<title>layer67_ffn_down_7&#45;&gt;layer67_ffn_ar</title>
<path fill="none" stroke="black" d="M766.31,-23359.96C766.31,-23359.96 766.31,-23289.34 766.31,-23289.34"/>
<polygon fill="black" stroke="black" points="769.81,-23289.34 766.31,-23279.34 762.81,-23289.34 769.81,-23289.34"/>
</g>
<!-- layer68_norm_6 -->
<g id="node1721" class="node">
<title>layer68_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="677.5,-23119.99 505.5,-23119.99 505.5,-23051.99 677.5,-23051.99 677.5,-23119.99"/>
<text text-anchor="middle" x="591.5" y="-23104.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="591.5" y="-23089.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="591.5" y="-23074.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="591.5" y="-23059.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer67_ffn_ar&#45;&gt;layer68_norm_6 -->
<g id="edge2198" class="edge">
<title>layer67_ffn_ar&#45;&gt;layer68_norm_6</title>
<path fill="none" stroke="black" d="M625.69,-23200.4C625.69,-23200.4 625.69,-23130.05 625.69,-23130.05"/>
<polygon fill="black" stroke="black" points="629.19,-23130.05 625.69,-23120.05 622.19,-23130.05 629.19,-23130.05"/>
</g>
<!-- layer68_norm_7 -->
<g id="node1722" class="node">
<title>layer68_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="887.5,-23119.99 715.5,-23119.99 715.5,-23051.99 887.5,-23051.99 887.5,-23119.99"/>
<text text-anchor="middle" x="801.5" y="-23104.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="801.5" y="-23089.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="801.5" y="-23074.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="801.5" y="-23059.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer67_ffn_ar&#45;&gt;layer68_norm_7 -->
<g id="edge2199" class="edge">
<title>layer67_ffn_ar&#45;&gt;layer68_norm_7</title>
<path fill="none" stroke="black" d="M766.31,-23200.8C766.31,-23200.8 766.31,-23130.22 766.31,-23130.22"/>
<polygon fill="black" stroke="black" points="769.81,-23130.22 766.31,-23120.22 762.81,-23130.22 769.81,-23130.22"/>
</g>
<!-- layer68_qkv_6 -->
<g id="node1723" class="node">
<title>layer68_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="678,-22979.99 497,-22979.99 497,-22911.99 678,-22911.99 678,-22979.99"/>
<text text-anchor="middle" x="587.5" y="-22964.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="587.5" y="-22949.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="587.5" y="-22934.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="587.5" y="-22919.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer68_norm_6&#45;&gt;layer68_qkv_6 -->
<g id="edge2200" class="edge">
<title>layer68_norm_6&#45;&gt;layer68_qkv_6</title>
<path fill="none" stroke="black" d="M591.5,-23051.75C591.5,-23051.75 591.5,-22990.37 591.5,-22990.37"/>
<polygon fill="black" stroke="black" points="595,-22990.37 591.5,-22980.37 588,-22990.37 595,-22990.37"/>
</g>
<!-- layer68_qkv_7 -->
<g id="node1724" class="node">
<title>layer68_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="895,-22979.99 714,-22979.99 714,-22911.99 895,-22911.99 895,-22979.99"/>
<text text-anchor="middle" x="804.5" y="-22964.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="804.5" y="-22949.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="804.5" y="-22934.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="804.5" y="-22919.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer68_norm_7&#45;&gt;layer68_qkv_7 -->
<g id="edge2201" class="edge">
<title>layer68_norm_7&#45;&gt;layer68_qkv_7</title>
<path fill="none" stroke="black" d="M801.5,-23051.75C801.5,-23051.75 801.5,-22990.37 801.5,-22990.37"/>
<polygon fill="black" stroke="black" points="805,-22990.37 801.5,-22980.37 798,-22990.37 805,-22990.37"/>
</g>
<!-- layer68_qkv_ar -->
<g id="node1725" class="node">
<title>layer68_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="695.5" cy="-22791.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="695.5" y="-22810.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="695.5" y="-22795.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="695.5" y="-22780.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="695.5" y="-22765.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer68_qkv_6&#45;&gt;layer68_qkv_ar -->
<g id="edge2202" class="edge">
<title>layer68_qkv_6&#45;&gt;layer68_qkv_ar</title>
<path fill="none" stroke="black" d="M622.76,-22911.8C622.76,-22911.8 622.76,-22841.73 622.76,-22841.73"/>
<polygon fill="black" stroke="black" points="626.26,-22841.73 622.76,-22831.73 619.26,-22841.73 626.26,-22841.73"/>
</g>
<!-- layer68_qkv_7&#45;&gt;layer68_qkv_ar -->
<g id="edge2203" class="edge">
<title>layer68_qkv_7&#45;&gt;layer68_qkv_ar</title>
<path fill="none" stroke="black" d="M768.74,-22911.8C768.74,-22911.8 768.74,-22841.45 768.74,-22841.45"/>
<polygon fill="black" stroke="black" points="772.24,-22841.45 768.74,-22831.45 765.24,-22841.45 772.24,-22841.45"/>
</g>
<!-- layer68_attn_6 -->
<g id="node1726" class="node">
<title>layer68_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="677.5,-22671.83 505.5,-22671.83 505.5,-22603.83 677.5,-22603.83 677.5,-22671.83"/>
<text text-anchor="middle" x="591.5" y="-22656.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="591.5" y="-22641.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="591.5" y="-22626.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="591.5" y="-22611.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer68_qkv_ar&#45;&gt;layer68_attn_6 -->
<g id="edge2204" class="edge">
<title>layer68_qkv_ar&#45;&gt;layer68_attn_6</title>
<path fill="none" stroke="black" d="M622.51,-22752.23C622.51,-22752.23 622.51,-22681.88 622.51,-22681.88"/>
<polygon fill="black" stroke="black" points="626.01,-22681.88 622.51,-22671.88 619.01,-22681.88 626.01,-22681.88"/>
</g>
<!-- layer68_attn_7 -->
<g id="node1727" class="node">
<title>layer68_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="885.5,-22671.83 713.5,-22671.83 713.5,-22603.83 885.5,-22603.83 885.5,-22671.83"/>
<text text-anchor="middle" x="799.5" y="-22656.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="799.5" y="-22641.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="799.5" y="-22626.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="799.5" y="-22611.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer68_qkv_ar&#45;&gt;layer68_attn_7 -->
<g id="edge2205" class="edge">
<title>layer68_qkv_ar&#45;&gt;layer68_attn_7</title>
<path fill="none" stroke="black" d="M768.49,-22752.23C768.49,-22752.23 768.49,-22681.88 768.49,-22681.88"/>
<polygon fill="black" stroke="black" points="771.99,-22681.88 768.49,-22671.88 764.99,-22681.88 771.99,-22681.88"/>
</g>
<!-- layer68_attn_out_6 -->
<g id="node1728" class="node">
<title>layer68_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="677.5,-22531.83 505.5,-22531.83 505.5,-22463.83 677.5,-22463.83 677.5,-22531.83"/>
<text text-anchor="middle" x="591.5" y="-22516.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="591.5" y="-22501.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="591.5" y="-22486.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="591.5" y="-22471.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer68_attn_6&#45;&gt;layer68_attn_out_6 -->
<g id="edge2206" class="edge">
<title>layer68_attn_6&#45;&gt;layer68_attn_out_6</title>
<path fill="none" stroke="black" d="M591.5,-22603.58C591.5,-22603.58 591.5,-22542.21 591.5,-22542.21"/>
<polygon fill="black" stroke="black" points="595,-22542.21 591.5,-22532.21 588,-22542.21 595,-22542.21"/>
</g>
<!-- layer68_attn_out_7 -->
<g id="node1729" class="node">
<title>layer68_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="885.5,-22531.83 713.5,-22531.83 713.5,-22463.83 885.5,-22463.83 885.5,-22531.83"/>
<text text-anchor="middle" x="799.5" y="-22516.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="799.5" y="-22501.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="799.5" y="-22486.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="799.5" y="-22471.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer68_attn_7&#45;&gt;layer68_attn_out_7 -->
<g id="edge2207" class="edge">
<title>layer68_attn_7&#45;&gt;layer68_attn_out_7</title>
<path fill="none" stroke="black" d="M799.5,-22603.58C799.5,-22603.58 799.5,-22542.21 799.5,-22542.21"/>
<polygon fill="black" stroke="black" points="803,-22542.21 799.5,-22532.21 796,-22542.21 803,-22542.21"/>
</g>
<!-- layer68_attn_ar -->
<g id="node1730" class="node">
<title>layer68_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="695.5" cy="-22343.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="695.5" y="-22362.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="695.5" y="-22347.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="695.5" y="-22332.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="695.5" y="-22317.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer68_attn_out_6&#45;&gt;layer68_attn_ar -->
<g id="edge2208" class="edge">
<title>layer68_attn_out_6&#45;&gt;layer68_attn_ar</title>
<path fill="none" stroke="black" d="M625.69,-22463.63C625.69,-22463.63 625.69,-22393.29 625.69,-22393.29"/>
<polygon fill="black" stroke="black" points="629.19,-22393.29 625.69,-22383.29 622.19,-22393.29 629.19,-22393.29"/>
</g>
<!-- layer68_attn_out_7&#45;&gt;layer68_attn_ar -->
<g id="edge2209" class="edge">
<title>layer68_attn_out_7&#45;&gt;layer68_attn_ar</title>
<path fill="none" stroke="black" d="M765.31,-22463.63C765.31,-22463.63 765.31,-22393.29 765.31,-22393.29"/>
<polygon fill="black" stroke="black" points="768.81,-22393.29 765.31,-22383.29 761.81,-22393.29 768.81,-22393.29"/>
</g>
<!-- layer68_ffn_norm_6 -->
<g id="node1731" class="node">
<title>layer68_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="673.5,-22223.66 501.5,-22223.66 501.5,-22155.66 673.5,-22155.66 673.5,-22223.66"/>
<text text-anchor="middle" x="587.5" y="-22208.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="587.5" y="-22193.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="587.5" y="-22178.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="587.5" y="-22163.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer68_attn_ar&#45;&gt;layer68_ffn_norm_6 -->
<g id="edge2210" class="edge">
<title>layer68_attn_ar&#45;&gt;layer68_ffn_norm_6</title>
<path fill="none" stroke="black" d="M623.69,-22304.86C623.69,-22304.86 623.69,-22233.81 623.69,-22233.81"/>
<polygon fill="black" stroke="black" points="627.19,-22233.81 623.69,-22223.81 620.19,-22233.81 627.19,-22233.81"/>
</g>
<!-- layer68_ffn_norm_7 -->
<g id="node1732" class="node">
<title>layer68_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="890.5,-22223.66 718.5,-22223.66 718.5,-22155.66 890.5,-22155.66 890.5,-22223.66"/>
<text text-anchor="middle" x="804.5" y="-22208.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="804.5" y="-22193.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="804.5" y="-22178.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="804.5" y="-22163.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer68_attn_ar&#45;&gt;layer68_ffn_norm_7 -->
<g id="edge2211" class="edge">
<title>layer68_attn_ar&#45;&gt;layer68_ffn_norm_7</title>
<path fill="none" stroke="black" d="M767.81,-22304.86C767.81,-22304.86 767.81,-22233.81 767.81,-22233.81"/>
<polygon fill="black" stroke="black" points="771.31,-22233.81 767.81,-22223.81 764.31,-22233.81 771.31,-22233.81"/>
</g>
<!-- layer68_ffn_gate_6 -->
<g id="node1733" class="node">
<title>layer68_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="678,-22083.66 497,-22083.66 497,-22015.66 678,-22015.66 678,-22083.66"/>
<text text-anchor="middle" x="587.5" y="-22068.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="587.5" y="-22053.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="587.5" y="-22038.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="587.5" y="-22023.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_ffn_norm_6&#45;&gt;layer68_ffn_gate_6 -->
<g id="edge2212" class="edge">
<title>layer68_ffn_norm_6&#45;&gt;layer68_ffn_gate_6</title>
<path fill="none" stroke="black" d="M587.5,-22155.41C587.5,-22155.41 587.5,-22094.04 587.5,-22094.04"/>
<polygon fill="black" stroke="black" points="591,-22094.04 587.5,-22084.04 584,-22094.04 591,-22094.04"/>
</g>
<!-- layer68_ffn_up_6 -->
<g id="node1735" class="node">
<title>layer68_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="461,-22083.66 280,-22083.66 280,-22015.66 461,-22015.66 461,-22083.66"/>
<text text-anchor="middle" x="370.5" y="-22068.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="370.5" y="-22053.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="370.5" y="-22038.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="370.5" y="-22023.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_ffn_norm_6&#45;&gt;layer68_ffn_up_6 -->
<g id="edge2214" class="edge">
<title>layer68_ffn_norm_6&#45;&gt;layer68_ffn_up_6</title>
<path fill="none" stroke="black" d="M501.31,-22189C461.86,-22189 423.76,-22189 423.76,-22189 423.76,-22189 423.76,-22093.75 423.76,-22093.75"/>
<polygon fill="black" stroke="black" points="427.26,-22093.75 423.76,-22083.75 420.26,-22093.75 427.26,-22093.75"/>
</g>
<!-- layer68_ffn_gate_7 -->
<g id="node1734" class="node">
<title>layer68_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1112,-22083.66 931,-22083.66 931,-22015.66 1112,-22015.66 1112,-22083.66"/>
<text text-anchor="middle" x="1021.5" y="-22068.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1021.5" y="-22053.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1021.5" y="-22038.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1021.5" y="-22023.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_ffn_norm_7&#45;&gt;layer68_ffn_gate_7 -->
<g id="edge2213" class="edge">
<title>layer68_ffn_norm_7&#45;&gt;layer68_ffn_gate_7</title>
<path fill="none" stroke="black" d="M890.56,-22189C929.95,-22189 968,-22189 968,-22189 968,-22189 968,-22093.75 968,-22093.75"/>
<polygon fill="black" stroke="black" points="971.5,-22093.75 968,-22083.75 964.5,-22093.75 971.5,-22093.75"/>
</g>
<!-- layer68_ffn_up_7 -->
<g id="node1736" class="node">
<title>layer68_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="895,-22083.66 714,-22083.66 714,-22015.66 895,-22015.66 895,-22083.66"/>
<text text-anchor="middle" x="804.5" y="-22068.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="804.5" y="-22053.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="804.5" y="-22038.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="804.5" y="-22023.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_ffn_norm_7&#45;&gt;layer68_ffn_up_7 -->
<g id="edge2215" class="edge">
<title>layer68_ffn_norm_7&#45;&gt;layer68_ffn_up_7</title>
<path fill="none" stroke="black" d="M804.5,-22155.41C804.5,-22155.41 804.5,-22094.04 804.5,-22094.04"/>
<polygon fill="black" stroke="black" points="808,-22094.04 804.5,-22084.04 801,-22094.04 808,-22094.04"/>
</g>
<!-- layer68_gate_ar -->
<g id="node1737" class="node">
<title>layer68_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="895.5" cy="-21895.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="895.5" y="-21914.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="895.5" y="-21899.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="895.5" y="-21884.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="895.5" y="-21869.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer68_ffn_gate_6&#45;&gt;layer68_gate_ar -->
<g id="edge2216" class="edge">
<title>layer68_ffn_gate_6&#45;&gt;layer68_gate_ar</title>
<path fill="none" stroke="black" d="M678.08,-22049C688.79,-22049 696,-22049 696,-22049 696,-22049 696,-21911 696,-21911 696,-21911 764.28,-21911 764.28,-21911"/>
<polygon fill="black" stroke="black" points="764.28,-21914.5 774.28,-21911 764.28,-21907.5 764.28,-21914.5"/>
</g>
<!-- layer68_ffn_gate_7&#45;&gt;layer68_gate_ar -->
<g id="edge2217" class="edge">
<title>layer68_ffn_gate_7&#45;&gt;layer68_gate_ar</title>
<path fill="none" stroke="black" d="M977.24,-22015.46C977.24,-22015.46 977.24,-21942.64 977.24,-21942.64"/>
<polygon fill="black" stroke="black" points="980.74,-21942.64 977.24,-21932.64 973.74,-21942.64 980.74,-21942.64"/>
</g>
<!-- layer68_up_ar -->
<g id="node1738" class="node">
<title>layer68_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="549.5" cy="-21895.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="549.5" y="-21914.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="549.5" y="-21899.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="549.5" y="-21884.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="549.5" y="-21869.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer68_ffn_up_6&#45;&gt;layer68_up_ar -->
<g id="edge2218" class="edge">
<title>layer68_ffn_up_6&#45;&gt;layer68_up_ar</title>
<path fill="none" stroke="black" d="M441.26,-22015.46C441.26,-22015.46 441.26,-21931.54 441.26,-21931.54"/>
<polygon fill="black" stroke="black" points="444.76,-21931.54 441.26,-21921.54 437.76,-21931.54 444.76,-21931.54"/>
</g>
<!-- layer68_ffn_up_7&#45;&gt;layer68_up_ar -->
<g id="edge2219" class="edge">
<title>layer68_ffn_up_7&#45;&gt;layer68_up_ar</title>
<path fill="none" stroke="black" d="M740.76,-22015.53C740.76,-21965.73 740.76,-21879 740.76,-21879 740.76,-21879 679.81,-21879 679.81,-21879"/>
<polygon fill="black" stroke="black" points="679.81,-21875.5 669.81,-21879 679.81,-21882.5 679.81,-21875.5"/>
</g>
<!-- layer68_silu_6 -->
<g id="node1739" class="node">
<title>layer68_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="823,-21775.49 642,-21775.49 642,-21707.49 823,-21707.49 823,-21775.49"/>
<text text-anchor="middle" x="732.5" y="-21760.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="732.5" y="-21745.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="732.5" y="-21730.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="732.5" y="-21715.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_gate_ar&#45;&gt;layer68_silu_6 -->
<g id="edge2220" class="edge">
<title>layer68_gate_ar&#45;&gt;layer68_silu_6</title>
<path fill="none" stroke="black" d="M795.26,-21865.5C795.26,-21865.5 795.26,-21785.52 795.26,-21785.52"/>
<polygon fill="black" stroke="black" points="798.76,-21785.52 795.26,-21775.52 791.76,-21785.52 798.76,-21785.52"/>
</g>
<!-- layer68_silu_7 -->
<g id="node1740" class="node">
<title>layer68_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1040,-21775.49 859,-21775.49 859,-21707.49 1040,-21707.49 1040,-21775.49"/>
<text text-anchor="middle" x="949.5" y="-21760.29" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="949.5" y="-21745.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="949.5" y="-21730.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="949.5" y="-21715.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_gate_ar&#45;&gt;layer68_silu_7 -->
<g id="edge2221" class="edge">
<title>layer68_gate_ar&#45;&gt;layer68_silu_7</title>
<path fill="none" stroke="black" d="M941.24,-21850.6C941.24,-21850.6 941.24,-21785.5 941.24,-21785.5"/>
<polygon fill="black" stroke="black" points="944.74,-21785.5 941.24,-21775.5 937.74,-21785.5 944.74,-21785.5"/>
</g>
<!-- layer68_mul_6 -->
<g id="node1741" class="node">
<title>layer68_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="713,-21635.49 532,-21635.49 532,-21567.49 713,-21567.49 713,-21635.49"/>
<text text-anchor="middle" x="622.5" y="-21620.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="622.5" y="-21605.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="622.5" y="-21590.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="622.5" y="-21575.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_up_ar&#45;&gt;layer68_mul_6 -->
<g id="edge2223" class="edge">
<title>layer68_up_ar&#45;&gt;layer68_mul_6</title>
<path fill="none" stroke="black" d="M587,-21849.3C587,-21849.3 587,-21645.58 587,-21645.58"/>
<polygon fill="black" stroke="black" points="590.5,-21645.58 587,-21635.58 583.5,-21645.58 590.5,-21645.58"/>
</g>
<!-- layer68_mul_7 -->
<g id="node1742" class="node">
<title>layer68_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="930,-21635.49 749,-21635.49 749,-21567.49 930,-21567.49 930,-21635.49"/>
<text text-anchor="middle" x="839.5" y="-21620.29" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="839.5" y="-21605.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="839.5" y="-21590.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="839.5" y="-21575.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer68_up_ar&#45;&gt;layer68_mul_7 -->
<g id="edge2225" class="edge">
<title>layer68_up_ar&#45;&gt;layer68_mul_7</title>
<path fill="none" stroke="black" d="M659.74,-21871.11C659.74,-21846.13 659.74,-21811 659.74,-21811 659.74,-21811 841,-21811 841,-21811 841,-21811 841,-21645.62 841,-21645.62"/>
<polygon fill="black" stroke="black" points="844.5,-21645.62 841,-21635.62 837.5,-21645.62 844.5,-21645.62"/>
</g>
<!-- layer68_silu_6&#45;&gt;layer68_mul_6 -->
<g id="edge2222" class="edge">
<title>layer68_silu_6&#45;&gt;layer68_mul_6</title>
<path fill="none" stroke="black" d="M677.5,-21707.25C677.5,-21707.25 677.5,-21645.87 677.5,-21645.87"/>
<polygon fill="black" stroke="black" points="681,-21645.87 677.5,-21635.87 674,-21645.87 681,-21645.87"/>
</g>
<!-- layer68_silu_7&#45;&gt;layer68_mul_7 -->
<g id="edge2224" class="edge">
<title>layer68_silu_7&#45;&gt;layer68_mul_7</title>
<path fill="none" stroke="black" d="M894.5,-21707.25C894.5,-21707.25 894.5,-21645.87 894.5,-21645.87"/>
<polygon fill="black" stroke="black" points="898,-21645.87 894.5,-21635.87 891,-21645.87 898,-21645.87"/>
</g>
<!-- layer68_ffn_down_6 -->
<g id="node1743" class="node">
<title>layer68_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="712.5,-21495.49 540.5,-21495.49 540.5,-21427.49 712.5,-21427.49 712.5,-21495.49"/>
<text text-anchor="middle" x="626.5" y="-21480.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="626.5" y="-21465.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="626.5" y="-21450.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="626.5" y="-21435.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer68_mul_6&#45;&gt;layer68_ffn_down_6 -->
<g id="edge2226" class="edge">
<title>layer68_mul_6&#45;&gt;layer68_ffn_down_6</title>
<path fill="none" stroke="black" d="M626.5,-21567.25C626.5,-21567.25 626.5,-21505.87 626.5,-21505.87"/>
<polygon fill="black" stroke="black" points="630,-21505.87 626.5,-21495.87 623,-21505.87 630,-21505.87"/>
</g>
<!-- layer68_ffn_down_7 -->
<g id="node1744" class="node">
<title>layer68_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="922.5,-21495.49 750.5,-21495.49 750.5,-21427.49 922.5,-21427.49 922.5,-21495.49"/>
<text text-anchor="middle" x="836.5" y="-21480.29" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="836.5" y="-21465.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="836.5" y="-21450.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="836.5" y="-21435.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer68_mul_7&#45;&gt;layer68_ffn_down_7 -->
<g id="edge2227" class="edge">
<title>layer68_mul_7&#45;&gt;layer68_ffn_down_7</title>
<path fill="none" stroke="black" d="M836.5,-21567.25C836.5,-21567.25 836.5,-21505.87 836.5,-21505.87"/>
<polygon fill="black" stroke="black" points="840,-21505.87 836.5,-21495.87 833,-21505.87 840,-21505.87"/>
</g>
<!-- layer68_ffn_ar -->
<g id="node1745" class="node">
<title>layer68_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="730.5" cy="-21307.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="730.5" y="-21326.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="730.5" y="-21311.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="730.5" y="-21296.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="730.5" y="-21281.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer68_ffn_down_6&#45;&gt;layer68_ffn_ar -->
<g id="edge2228" class="edge">
<title>layer68_ffn_down_6&#45;&gt;layer68_ffn_ar</title>
<path fill="none" stroke="black" d="M660.69,-21427.3C660.69,-21427.3 660.69,-21356.95 660.69,-21356.95"/>
<polygon fill="black" stroke="black" points="664.19,-21356.95 660.69,-21346.95 657.19,-21356.95 664.19,-21356.95"/>
</g>
<!-- layer68_ffn_down_7&#45;&gt;layer68_ffn_ar -->
<g id="edge2229" class="edge">
<title>layer68_ffn_down_7&#45;&gt;layer68_ffn_ar</title>
<path fill="none" stroke="black" d="M801.31,-21427.3C801.31,-21427.3 801.31,-21356.68 801.31,-21356.68"/>
<polygon fill="black" stroke="black" points="804.81,-21356.68 801.31,-21346.68 797.81,-21356.68 804.81,-21356.68"/>
</g>
<!-- layer69_norm_6 -->
<g id="node1746" class="node">
<title>layer69_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="712.5,-21187.33 540.5,-21187.33 540.5,-21119.33 712.5,-21119.33 712.5,-21187.33"/>
<text text-anchor="middle" x="626.5" y="-21172.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="626.5" y="-21157.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="626.5" y="-21142.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="626.5" y="-21127.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer68_ffn_ar&#45;&gt;layer69_norm_6 -->
<g id="edge2230" class="edge">
<title>layer68_ffn_ar&#45;&gt;layer69_norm_6</title>
<path fill="none" stroke="black" d="M660.69,-21267.73C660.69,-21267.73 660.69,-21197.38 660.69,-21197.38"/>
<polygon fill="black" stroke="black" points="664.19,-21197.38 660.69,-21187.38 657.19,-21197.38 664.19,-21197.38"/>
</g>
<!-- layer69_norm_7 -->
<g id="node1747" class="node">
<title>layer69_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="922.5,-21187.33 750.5,-21187.33 750.5,-21119.33 922.5,-21119.33 922.5,-21187.33"/>
<text text-anchor="middle" x="836.5" y="-21172.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="836.5" y="-21157.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="836.5" y="-21142.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="836.5" y="-21127.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer68_ffn_ar&#45;&gt;layer69_norm_7 -->
<g id="edge2231" class="edge">
<title>layer68_ffn_ar&#45;&gt;layer69_norm_7</title>
<path fill="none" stroke="black" d="M801.31,-21268.13C801.31,-21268.13 801.31,-21197.56 801.31,-21197.56"/>
<polygon fill="black" stroke="black" points="804.81,-21197.56 801.31,-21187.56 797.81,-21197.56 804.81,-21197.56"/>
</g>
<!-- layer69_qkv_6 -->
<g id="node1748" class="node">
<title>layer69_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="713,-21047.33 532,-21047.33 532,-20979.33 713,-20979.33 713,-21047.33"/>
<text text-anchor="middle" x="622.5" y="-21032.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="622.5" y="-21017.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="622.5" y="-21002.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="622.5" y="-20987.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer69_norm_6&#45;&gt;layer69_qkv_6 -->
<g id="edge2232" class="edge">
<title>layer69_norm_6&#45;&gt;layer69_qkv_6</title>
<path fill="none" stroke="black" d="M626.5,-21119.08C626.5,-21119.08 626.5,-21057.71 626.5,-21057.71"/>
<polygon fill="black" stroke="black" points="630,-21057.71 626.5,-21047.71 623,-21057.71 630,-21057.71"/>
</g>
<!-- layer69_qkv_7 -->
<g id="node1749" class="node">
<title>layer69_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="930,-21047.33 749,-21047.33 749,-20979.33 930,-20979.33 930,-21047.33"/>
<text text-anchor="middle" x="839.5" y="-21032.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="839.5" y="-21017.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="839.5" y="-21002.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="839.5" y="-20987.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer69_norm_7&#45;&gt;layer69_qkv_7 -->
<g id="edge2233" class="edge">
<title>layer69_norm_7&#45;&gt;layer69_qkv_7</title>
<path fill="none" stroke="black" d="M836.5,-21119.08C836.5,-21119.08 836.5,-21057.71 836.5,-21057.71"/>
<polygon fill="black" stroke="black" points="840,-21057.71 836.5,-21047.71 833,-21057.71 840,-21057.71"/>
</g>
<!-- layer69_qkv_ar -->
<g id="node1750" class="node">
<title>layer69_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="730.5" cy="-20859.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="730.5" y="-20878.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="730.5" y="-20863.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="730.5" y="-20848.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="730.5" y="-20833.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer69_qkv_6&#45;&gt;layer69_qkv_ar -->
<g id="edge2234" class="edge">
<title>layer69_qkv_6&#45;&gt;layer69_qkv_ar</title>
<path fill="none" stroke="black" d="M657.76,-20979.13C657.76,-20979.13 657.76,-20909.06 657.76,-20909.06"/>
<polygon fill="black" stroke="black" points="661.26,-20909.06 657.76,-20899.06 654.26,-20909.06 661.26,-20909.06"/>
</g>
<!-- layer69_qkv_7&#45;&gt;layer69_qkv_ar -->
<g id="edge2235" class="edge">
<title>layer69_qkv_7&#45;&gt;layer69_qkv_ar</title>
<path fill="none" stroke="black" d="M803.74,-20979.13C803.74,-20979.13 803.74,-20908.79 803.74,-20908.79"/>
<polygon fill="black" stroke="black" points="807.24,-20908.79 803.74,-20898.79 800.24,-20908.79 807.24,-20908.79"/>
</g>
<!-- layer69_attn_6 -->
<g id="node1751" class="node">
<title>layer69_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="712.5,-20739.16 540.5,-20739.16 540.5,-20671.16 712.5,-20671.16 712.5,-20739.16"/>
<text text-anchor="middle" x="626.5" y="-20723.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="626.5" y="-20708.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="626.5" y="-20693.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="626.5" y="-20678.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer69_qkv_ar&#45;&gt;layer69_attn_6 -->
<g id="edge2236" class="edge">
<title>layer69_qkv_ar&#45;&gt;layer69_attn_6</title>
<path fill="none" stroke="black" d="M657.51,-20819.56C657.51,-20819.56 657.51,-20749.22 657.51,-20749.22"/>
<polygon fill="black" stroke="black" points="661.01,-20749.22 657.51,-20739.22 654.01,-20749.22 661.01,-20749.22"/>
</g>
<!-- layer69_attn_7 -->
<g id="node1752" class="node">
<title>layer69_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="920.5,-20739.16 748.5,-20739.16 748.5,-20671.16 920.5,-20671.16 920.5,-20739.16"/>
<text text-anchor="middle" x="834.5" y="-20723.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="834.5" y="-20708.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="834.5" y="-20693.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="834.5" y="-20678.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer69_qkv_ar&#45;&gt;layer69_attn_7 -->
<g id="edge2237" class="edge">
<title>layer69_qkv_ar&#45;&gt;layer69_attn_7</title>
<path fill="none" stroke="black" d="M803.49,-20819.56C803.49,-20819.56 803.49,-20749.22 803.49,-20749.22"/>
<polygon fill="black" stroke="black" points="806.99,-20749.22 803.49,-20739.22 799.99,-20749.22 806.99,-20749.22"/>
</g>
<!-- layer69_attn_out_6 -->
<g id="node1753" class="node">
<title>layer69_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="712.5,-20599.16 540.5,-20599.16 540.5,-20531.16 712.5,-20531.16 712.5,-20599.16"/>
<text text-anchor="middle" x="626.5" y="-20583.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="626.5" y="-20568.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="626.5" y="-20553.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="626.5" y="-20538.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer69_attn_6&#45;&gt;layer69_attn_out_6 -->
<g id="edge2238" class="edge">
<title>layer69_attn_6&#45;&gt;layer69_attn_out_6</title>
<path fill="none" stroke="black" d="M626.5,-20670.91C626.5,-20670.91 626.5,-20609.54 626.5,-20609.54"/>
<polygon fill="black" stroke="black" points="630,-20609.54 626.5,-20599.54 623,-20609.54 630,-20609.54"/>
</g>
<!-- layer69_attn_out_7 -->
<g id="node1754" class="node">
<title>layer69_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="920.5,-20599.16 748.5,-20599.16 748.5,-20531.16 920.5,-20531.16 920.5,-20599.16"/>
<text text-anchor="middle" x="834.5" y="-20583.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="834.5" y="-20568.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="834.5" y="-20553.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="834.5" y="-20538.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer69_attn_7&#45;&gt;layer69_attn_out_7 -->
<g id="edge2239" class="edge">
<title>layer69_attn_7&#45;&gt;layer69_attn_out_7</title>
<path fill="none" stroke="black" d="M834.5,-20670.91C834.5,-20670.91 834.5,-20609.54 834.5,-20609.54"/>
<polygon fill="black" stroke="black" points="838,-20609.54 834.5,-20599.54 831,-20609.54 838,-20609.54"/>
</g>
<!-- layer69_attn_ar -->
<g id="node1755" class="node">
<title>layer69_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="730.5" cy="-20411.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="730.5" y="-20429.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="730.5" y="-20414.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="730.5" y="-20399.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="730.5" y="-20384.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer69_attn_out_6&#45;&gt;layer69_attn_ar -->
<g id="edge2240" class="edge">
<title>layer69_attn_out_6&#45;&gt;layer69_attn_ar</title>
<path fill="none" stroke="black" d="M660.69,-20530.96C660.69,-20530.96 660.69,-20460.62 660.69,-20460.62"/>
<polygon fill="black" stroke="black" points="664.19,-20460.62 660.69,-20450.62 657.19,-20460.62 664.19,-20460.62"/>
</g>
<!-- layer69_attn_out_7&#45;&gt;layer69_attn_ar -->
<g id="edge2241" class="edge">
<title>layer69_attn_out_7&#45;&gt;layer69_attn_ar</title>
<path fill="none" stroke="black" d="M800.31,-20530.96C800.31,-20530.96 800.31,-20460.62 800.31,-20460.62"/>
<polygon fill="black" stroke="black" points="803.81,-20460.62 800.31,-20450.62 796.81,-20460.62 803.81,-20460.62"/>
</g>
<!-- layer69_ffn_norm_6 -->
<g id="node1756" class="node">
<title>layer69_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="708.5,-20290.99 536.5,-20290.99 536.5,-20222.99 708.5,-20222.99 708.5,-20290.99"/>
<text text-anchor="middle" x="622.5" y="-20275.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="622.5" y="-20260.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="622.5" y="-20245.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="622.5" y="-20230.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer69_attn_ar&#45;&gt;layer69_ffn_norm_6 -->
<g id="edge2242" class="edge">
<title>layer69_attn_ar&#45;&gt;layer69_ffn_norm_6</title>
<path fill="none" stroke="black" d="M658.69,-20372.2C658.69,-20372.2 658.69,-20301.14 658.69,-20301.14"/>
<polygon fill="black" stroke="black" points="662.19,-20301.14 658.69,-20291.14 655.19,-20301.14 662.19,-20301.14"/>
</g>
<!-- layer69_ffn_norm_7 -->
<g id="node1757" class="node">
<title>layer69_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="925.5,-20290.99 753.5,-20290.99 753.5,-20222.99 925.5,-20222.99 925.5,-20290.99"/>
<text text-anchor="middle" x="839.5" y="-20275.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="839.5" y="-20260.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="839.5" y="-20245.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="839.5" y="-20230.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer69_attn_ar&#45;&gt;layer69_ffn_norm_7 -->
<g id="edge2243" class="edge">
<title>layer69_attn_ar&#45;&gt;layer69_ffn_norm_7</title>
<path fill="none" stroke="black" d="M802.81,-20372.2C802.81,-20372.2 802.81,-20301.14 802.81,-20301.14"/>
<polygon fill="black" stroke="black" points="806.31,-20301.14 802.81,-20291.14 799.31,-20301.14 806.31,-20301.14"/>
</g>
<!-- layer69_ffn_gate_6 -->
<g id="node1758" class="node">
<title>layer69_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="713,-20150.99 532,-20150.99 532,-20082.99 713,-20082.99 713,-20150.99"/>
<text text-anchor="middle" x="622.5" y="-20135.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="622.5" y="-20120.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="622.5" y="-20105.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="622.5" y="-20090.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_ffn_norm_6&#45;&gt;layer69_ffn_gate_6 -->
<g id="edge2244" class="edge">
<title>layer69_ffn_norm_6&#45;&gt;layer69_ffn_gate_6</title>
<path fill="none" stroke="black" d="M622.5,-20222.75C622.5,-20222.75 622.5,-20161.37 622.5,-20161.37"/>
<polygon fill="black" stroke="black" points="626,-20161.37 622.5,-20151.37 619,-20161.37 626,-20161.37"/>
</g>
<!-- layer69_ffn_up_6 -->
<g id="node1760" class="node">
<title>layer69_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="496,-20150.99 315,-20150.99 315,-20082.99 496,-20082.99 496,-20150.99"/>
<text text-anchor="middle" x="405.5" y="-20135.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="405.5" y="-20120.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="405.5" y="-20105.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="405.5" y="-20090.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_ffn_norm_6&#45;&gt;layer69_ffn_up_6 -->
<g id="edge2246" class="edge">
<title>layer69_ffn_norm_6&#45;&gt;layer69_ffn_up_6</title>
<path fill="none" stroke="black" d="M536.31,-20256C496.86,-20256 458.76,-20256 458.76,-20256 458.76,-20256 458.76,-20161 458.76,-20161"/>
<polygon fill="black" stroke="black" points="462.26,-20161 458.76,-20151 455.26,-20161 462.26,-20161"/>
</g>
<!-- layer69_ffn_gate_7 -->
<g id="node1759" class="node">
<title>layer69_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1147,-20150.99 966,-20150.99 966,-20082.99 1147,-20082.99 1147,-20150.99"/>
<text text-anchor="middle" x="1056.5" y="-20135.79" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1056.5" y="-20120.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1056.5" y="-20105.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1056.5" y="-20090.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_ffn_norm_7&#45;&gt;layer69_ffn_gate_7 -->
<g id="edge2245" class="edge">
<title>layer69_ffn_norm_7&#45;&gt;layer69_ffn_gate_7</title>
<path fill="none" stroke="black" d="M925.56,-20256C964.95,-20256 1003,-20256 1003,-20256 1003,-20256 1003,-20161 1003,-20161"/>
<polygon fill="black" stroke="black" points="1006.5,-20161 1003,-20151 999.5,-20161 1006.5,-20161"/>
</g>
<!-- layer69_ffn_up_7 -->
<g id="node1761" class="node">
<title>layer69_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="930,-20150.99 749,-20150.99 749,-20082.99 930,-20082.99 930,-20150.99"/>
<text text-anchor="middle" x="839.5" y="-20135.79" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="839.5" y="-20120.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="839.5" y="-20105.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="839.5" y="-20090.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_ffn_norm_7&#45;&gt;layer69_ffn_up_7 -->
<g id="edge2247" class="edge">
<title>layer69_ffn_norm_7&#45;&gt;layer69_ffn_up_7</title>
<path fill="none" stroke="black" d="M839.5,-20222.75C839.5,-20222.75 839.5,-20161.37 839.5,-20161.37"/>
<polygon fill="black" stroke="black" points="843,-20161.37 839.5,-20151.37 836,-20161.37 843,-20161.37"/>
</g>
<!-- layer69_gate_ar -->
<g id="node1762" class="node">
<title>layer69_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="930.5" cy="-19962.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="930.5" y="-19981.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="930.5" y="-19966.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="930.5" y="-19951.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="930.5" y="-19936.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer69_ffn_gate_6&#45;&gt;layer69_gate_ar -->
<g id="edge2248" class="edge">
<title>layer69_ffn_gate_6&#45;&gt;layer69_gate_ar</title>
<path fill="none" stroke="black" d="M713.08,-20116C723.79,-20116 731,-20116 731,-20116 731,-20116 731,-19978 731,-19978 731,-19978 798.7,-19978 798.7,-19978"/>
<polygon fill="black" stroke="black" points="798.7,-19981.5 808.7,-19978 798.7,-19974.5 798.7,-19981.5"/>
</g>
<!-- layer69_ffn_gate_7&#45;&gt;layer69_gate_ar -->
<g id="edge2249" class="edge">
<title>layer69_ffn_gate_7&#45;&gt;layer69_gate_ar</title>
<path fill="none" stroke="black" d="M1012.24,-20082.8C1012.24,-20082.8 1012.24,-20009.97 1012.24,-20009.97"/>
<polygon fill="black" stroke="black" points="1015.74,-20009.97 1012.24,-19999.97 1008.74,-20009.97 1015.74,-20009.97"/>
</g>
<!-- layer69_up_ar -->
<g id="node1763" class="node">
<title>layer69_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="584.5" cy="-19962.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="584.5" y="-19981.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="584.5" y="-19966.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="584.5" y="-19951.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="584.5" y="-19936.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer69_ffn_up_6&#45;&gt;layer69_up_ar -->
<g id="edge2250" class="edge">
<title>layer69_ffn_up_6&#45;&gt;layer69_up_ar</title>
<path fill="none" stroke="black" d="M476.26,-20082.8C476.26,-20082.8 476.26,-19998.87 476.26,-19998.87"/>
<polygon fill="black" stroke="black" points="479.76,-19998.87 476.26,-19988.87 472.76,-19998.87 479.76,-19998.87"/>
</g>
<!-- layer69_ffn_up_7&#45;&gt;layer69_up_ar -->
<g id="edge2251" class="edge">
<title>layer69_ffn_up_7&#45;&gt;layer69_up_ar</title>
<path fill="none" stroke="black" d="M775.76,-20082.8C775.76,-20032.9 775.76,-19946 775.76,-19946 775.76,-19946 714.54,-19946 714.54,-19946"/>
<polygon fill="black" stroke="black" points="714.54,-19942.5 704.54,-19946 714.54,-19949.5 714.54,-19942.5"/>
</g>
<!-- layer69_silu_6 -->
<g id="node1764" class="node">
<title>layer69_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="858,-19842.83 677,-19842.83 677,-19774.83 858,-19774.83 858,-19842.83"/>
<text text-anchor="middle" x="767.5" y="-19827.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="767.5" y="-19812.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="767.5" y="-19797.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="767.5" y="-19782.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_gate_ar&#45;&gt;layer69_silu_6 -->
<g id="edge2252" class="edge">
<title>layer69_gate_ar&#45;&gt;layer69_silu_6</title>
<path fill="none" stroke="black" d="M830.26,-19932.84C830.26,-19932.84 830.26,-19852.85 830.26,-19852.85"/>
<polygon fill="black" stroke="black" points="833.76,-19852.85 830.26,-19842.85 826.76,-19852.85 833.76,-19852.85"/>
</g>
<!-- layer69_silu_7 -->
<g id="node1765" class="node">
<title>layer69_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1075,-19842.83 894,-19842.83 894,-19774.83 1075,-19774.83 1075,-19842.83"/>
<text text-anchor="middle" x="984.5" y="-19827.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="984.5" y="-19812.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="984.5" y="-19797.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="984.5" y="-19782.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_gate_ar&#45;&gt;layer69_silu_7 -->
<g id="edge2253" class="edge">
<title>layer69_gate_ar&#45;&gt;layer69_silu_7</title>
<path fill="none" stroke="black" d="M976.24,-19917.93C976.24,-19917.93 976.24,-19852.83 976.24,-19852.83"/>
<polygon fill="black" stroke="black" points="979.74,-19852.83 976.24,-19842.83 972.74,-19852.83 979.74,-19852.83"/>
</g>
<!-- layer69_mul_6 -->
<g id="node1766" class="node">
<title>layer69_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="748,-19702.83 567,-19702.83 567,-19634.83 748,-19634.83 748,-19702.83"/>
<text text-anchor="middle" x="657.5" y="-19687.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="657.5" y="-19672.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="657.5" y="-19657.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="657.5" y="-19642.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_up_ar&#45;&gt;layer69_mul_6 -->
<g id="edge2255" class="edge">
<title>layer69_up_ar&#45;&gt;layer69_mul_6</title>
<path fill="none" stroke="black" d="M622,-19916.64C622,-19916.64 622,-19712.91 622,-19712.91"/>
<polygon fill="black" stroke="black" points="625.5,-19712.91 622,-19702.91 618.5,-19712.91 625.5,-19712.91"/>
</g>
<!-- layer69_mul_7 -->
<g id="node1767" class="node">
<title>layer69_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="965,-19702.83 784,-19702.83 784,-19634.83 965,-19634.83 965,-19702.83"/>
<text text-anchor="middle" x="874.5" y="-19687.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="874.5" y="-19672.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="874.5" y="-19657.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="874.5" y="-19642.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer69_up_ar&#45;&gt;layer69_mul_7 -->
<g id="edge2257" class="edge">
<title>layer69_up_ar&#45;&gt;layer69_mul_7</title>
<path fill="none" stroke="black" d="M694.74,-19938.35C694.74,-19913.27 694.74,-19878 694.74,-19878 694.74,-19878 876,-19878 876,-19878 876,-19878 876,-19712.9 876,-19712.9"/>
<polygon fill="black" stroke="black" points="879.5,-19712.9 876,-19702.9 872.5,-19712.9 879.5,-19712.9"/>
</g>
<!-- layer69_silu_6&#45;&gt;layer69_mul_6 -->
<g id="edge2254" class="edge">
<title>layer69_silu_6&#45;&gt;layer69_mul_6</title>
<path fill="none" stroke="black" d="M712.5,-19774.58C712.5,-19774.58 712.5,-19713.21 712.5,-19713.21"/>
<polygon fill="black" stroke="black" points="716,-19713.21 712.5,-19703.21 709,-19713.21 716,-19713.21"/>
</g>
<!-- layer69_silu_7&#45;&gt;layer69_mul_7 -->
<g id="edge2256" class="edge">
<title>layer69_silu_7&#45;&gt;layer69_mul_7</title>
<path fill="none" stroke="black" d="M929.5,-19774.58C929.5,-19774.58 929.5,-19713.21 929.5,-19713.21"/>
<polygon fill="black" stroke="black" points="933,-19713.21 929.5,-19703.21 926,-19713.21 933,-19713.21"/>
</g>
<!-- layer69_ffn_down_6 -->
<g id="node1768" class="node">
<title>layer69_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="747.5,-19562.83 575.5,-19562.83 575.5,-19494.83 747.5,-19494.83 747.5,-19562.83"/>
<text text-anchor="middle" x="661.5" y="-19547.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="661.5" y="-19532.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="661.5" y="-19517.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="661.5" y="-19502.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer69_mul_6&#45;&gt;layer69_ffn_down_6 -->
<g id="edge2258" class="edge">
<title>layer69_mul_6&#45;&gt;layer69_ffn_down_6</title>
<path fill="none" stroke="black" d="M661.5,-19634.58C661.5,-19634.58 661.5,-19573.21 661.5,-19573.21"/>
<polygon fill="black" stroke="black" points="665,-19573.21 661.5,-19563.21 658,-19573.21 665,-19573.21"/>
</g>
<!-- layer69_ffn_down_7 -->
<g id="node1769" class="node">
<title>layer69_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="957.5,-19562.83 785.5,-19562.83 785.5,-19494.83 957.5,-19494.83 957.5,-19562.83"/>
<text text-anchor="middle" x="871.5" y="-19547.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="871.5" y="-19532.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="871.5" y="-19517.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="871.5" y="-19502.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer69_mul_7&#45;&gt;layer69_ffn_down_7 -->
<g id="edge2259" class="edge">
<title>layer69_mul_7&#45;&gt;layer69_ffn_down_7</title>
<path fill="none" stroke="black" d="M871.5,-19634.58C871.5,-19634.58 871.5,-19573.21 871.5,-19573.21"/>
<polygon fill="black" stroke="black" points="875,-19573.21 871.5,-19563.21 868,-19573.21 875,-19573.21"/>
</g>
<!-- layer69_ffn_ar -->
<g id="node1770" class="node">
<title>layer69_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="765.5" cy="-19374.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="765.5" y="-19393.54" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="765.5" y="-19378.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="765.5" y="-19363.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="765.5" y="-19348.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer69_ffn_down_6&#45;&gt;layer69_ffn_ar -->
<g id="edge2260" class="edge">
<title>layer69_ffn_down_6&#45;&gt;layer69_ffn_ar</title>
<path fill="none" stroke="black" d="M695.69,-19494.63C695.69,-19494.63 695.69,-19424.29 695.69,-19424.29"/>
<polygon fill="black" stroke="black" points="699.19,-19424.29 695.69,-19414.29 692.19,-19424.29 699.19,-19424.29"/>
</g>
<!-- layer69_ffn_down_7&#45;&gt;layer69_ffn_ar -->
<g id="edge2261" class="edge">
<title>layer69_ffn_down_7&#45;&gt;layer69_ffn_ar</title>
<path fill="none" stroke="black" d="M836.31,-19494.63C836.31,-19494.63 836.31,-19424.01 836.31,-19424.01"/>
<polygon fill="black" stroke="black" points="839.81,-19424.01 836.31,-19414.01 832.81,-19424.01 839.81,-19424.01"/>
</g>
<!-- layer70_norm_6 -->
<g id="node1771" class="node">
<title>layer70_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="747.5,-19254.66 575.5,-19254.66 575.5,-19186.66 747.5,-19186.66 747.5,-19254.66"/>
<text text-anchor="middle" x="661.5" y="-19239.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="661.5" y="-19224.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="661.5" y="-19209.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="661.5" y="-19194.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer69_ffn_ar&#45;&gt;layer70_norm_6 -->
<g id="edge2262" class="edge">
<title>layer69_ffn_ar&#45;&gt;layer70_norm_6</title>
<path fill="none" stroke="black" d="M695.69,-19335.06C695.69,-19335.06 695.69,-19264.72 695.69,-19264.72"/>
<polygon fill="black" stroke="black" points="699.19,-19264.72 695.69,-19254.72 692.19,-19264.72 699.19,-19264.72"/>
</g>
<!-- layer70_norm_7 -->
<g id="node1772" class="node">
<title>layer70_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="957.5,-19254.66 785.5,-19254.66 785.5,-19186.66 957.5,-19186.66 957.5,-19254.66"/>
<text text-anchor="middle" x="871.5" y="-19239.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="871.5" y="-19224.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="871.5" y="-19209.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="871.5" y="-19194.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer69_ffn_ar&#45;&gt;layer70_norm_7 -->
<g id="edge2263" class="edge">
<title>layer69_ffn_ar&#45;&gt;layer70_norm_7</title>
<path fill="none" stroke="black" d="M836.31,-19335.46C836.31,-19335.46 836.31,-19264.89 836.31,-19264.89"/>
<polygon fill="black" stroke="black" points="839.81,-19264.89 836.31,-19254.89 832.81,-19264.89 839.81,-19264.89"/>
</g>
<!-- layer70_qkv_6 -->
<g id="node1773" class="node">
<title>layer70_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="748,-19114.66 567,-19114.66 567,-19046.66 748,-19046.66 748,-19114.66"/>
<text text-anchor="middle" x="657.5" y="-19099.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="657.5" y="-19084.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="657.5" y="-19069.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="657.5" y="-19054.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer70_norm_6&#45;&gt;layer70_qkv_6 -->
<g id="edge2264" class="edge">
<title>layer70_norm_6&#45;&gt;layer70_qkv_6</title>
<path fill="none" stroke="black" d="M661.5,-19186.41C661.5,-19186.41 661.5,-19125.04 661.5,-19125.04"/>
<polygon fill="black" stroke="black" points="665,-19125.04 661.5,-19115.04 658,-19125.04 665,-19125.04"/>
</g>
<!-- layer70_qkv_7 -->
<g id="node1774" class="node">
<title>layer70_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="965,-19114.66 784,-19114.66 784,-19046.66 965,-19046.66 965,-19114.66"/>
<text text-anchor="middle" x="874.5" y="-19099.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="874.5" y="-19084.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="874.5" y="-19069.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="874.5" y="-19054.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer70_norm_7&#45;&gt;layer70_qkv_7 -->
<g id="edge2265" class="edge">
<title>layer70_norm_7&#45;&gt;layer70_qkv_7</title>
<path fill="none" stroke="black" d="M871.5,-19186.41C871.5,-19186.41 871.5,-19125.04 871.5,-19125.04"/>
<polygon fill="black" stroke="black" points="875,-19125.04 871.5,-19115.04 868,-19125.04 875,-19125.04"/>
</g>
<!-- layer70_qkv_ar -->
<g id="node1775" class="node">
<title>layer70_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="765.5" cy="-18926.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="765.5" y="-18945.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="765.5" y="-18930.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="765.5" y="-18915.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="765.5" y="-18900.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer70_qkv_6&#45;&gt;layer70_qkv_ar -->
<g id="edge2266" class="edge">
<title>layer70_qkv_6&#45;&gt;layer70_qkv_ar</title>
<path fill="none" stroke="black" d="M692.76,-19046.46C692.76,-19046.46 692.76,-18976.4 692.76,-18976.4"/>
<polygon fill="black" stroke="black" points="696.26,-18976.4 692.76,-18966.4 689.26,-18976.4 696.26,-18976.4"/>
</g>
<!-- layer70_qkv_7&#45;&gt;layer70_qkv_ar -->
<g id="edge2267" class="edge">
<title>layer70_qkv_7&#45;&gt;layer70_qkv_ar</title>
<path fill="none" stroke="black" d="M838.74,-19046.46C838.74,-19046.46 838.74,-18976.12 838.74,-18976.12"/>
<polygon fill="black" stroke="black" points="842.24,-18976.12 838.74,-18966.12 835.24,-18976.12 842.24,-18976.12"/>
</g>
<!-- layer70_attn_6 -->
<g id="node1776" class="node">
<title>layer70_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="747.5,-18806.49 575.5,-18806.49 575.5,-18738.49 747.5,-18738.49 747.5,-18806.49"/>
<text text-anchor="middle" x="661.5" y="-18791.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="661.5" y="-18776.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="661.5" y="-18761.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="661.5" y="-18746.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer70_qkv_ar&#45;&gt;layer70_attn_6 -->
<g id="edge2268" class="edge">
<title>layer70_qkv_ar&#45;&gt;layer70_attn_6</title>
<path fill="none" stroke="black" d="M692.51,-18886.9C692.51,-18886.9 692.51,-18816.55 692.51,-18816.55"/>
<polygon fill="black" stroke="black" points="696.01,-18816.55 692.51,-18806.55 689.01,-18816.55 696.01,-18816.55"/>
</g>
<!-- layer70_attn_7 -->
<g id="node1777" class="node">
<title>layer70_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="955.5,-18806.49 783.5,-18806.49 783.5,-18738.49 955.5,-18738.49 955.5,-18806.49"/>
<text text-anchor="middle" x="869.5" y="-18791.29" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="869.5" y="-18776.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="869.5" y="-18761.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="869.5" y="-18746.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer70_qkv_ar&#45;&gt;layer70_attn_7 -->
<g id="edge2269" class="edge">
<title>layer70_qkv_ar&#45;&gt;layer70_attn_7</title>
<path fill="none" stroke="black" d="M838.49,-18886.9C838.49,-18886.9 838.49,-18816.55 838.49,-18816.55"/>
<polygon fill="black" stroke="black" points="841.99,-18816.55 838.49,-18806.55 834.99,-18816.55 841.99,-18816.55"/>
</g>
<!-- layer70_attn_out_6 -->
<g id="node1778" class="node">
<title>layer70_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="747.5,-18666.49 575.5,-18666.49 575.5,-18598.49 747.5,-18598.49 747.5,-18666.49"/>
<text text-anchor="middle" x="661.5" y="-18651.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="661.5" y="-18636.29" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="661.5" y="-18621.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="661.5" y="-18606.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer70_attn_6&#45;&gt;layer70_attn_out_6 -->
<g id="edge2270" class="edge">
<title>layer70_attn_6&#45;&gt;layer70_attn_out_6</title>
<path fill="none" stroke="black" d="M661.5,-18738.25C661.5,-18738.25 661.5,-18676.87 661.5,-18676.87"/>
<polygon fill="black" stroke="black" points="665,-18676.87 661.5,-18666.87 658,-18676.87 665,-18676.87"/>
</g>
<!-- layer70_attn_out_7 -->
<g id="node1779" class="node">
<title>layer70_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="955.5,-18666.49 783.5,-18666.49 783.5,-18598.49 955.5,-18598.49 955.5,-18666.49"/>
<text text-anchor="middle" x="869.5" y="-18651.29" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="869.5" y="-18636.29" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="869.5" y="-18621.29" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="869.5" y="-18606.29" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer70_attn_7&#45;&gt;layer70_attn_out_7 -->
<g id="edge2271" class="edge">
<title>layer70_attn_7&#45;&gt;layer70_attn_out_7</title>
<path fill="none" stroke="black" d="M869.5,-18738.25C869.5,-18738.25 869.5,-18676.87 869.5,-18676.87"/>
<polygon fill="black" stroke="black" points="873,-18676.87 869.5,-18666.87 866,-18676.87 873,-18676.87"/>
</g>
<!-- layer70_attn_ar -->
<g id="node1780" class="node">
<title>layer70_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="765.5" cy="-18478.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="765.5" y="-18497.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="765.5" y="-18482.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="765.5" y="-18467.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="765.5" y="-18452.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer70_attn_out_6&#45;&gt;layer70_attn_ar -->
<g id="edge2272" class="edge">
<title>layer70_attn_out_6&#45;&gt;layer70_attn_ar</title>
<path fill="none" stroke="black" d="M695.69,-18598.3C695.69,-18598.3 695.69,-18527.95 695.69,-18527.95"/>
<polygon fill="black" stroke="black" points="699.19,-18527.95 695.69,-18517.95 692.19,-18527.95 699.19,-18527.95"/>
</g>
<!-- layer70_attn_out_7&#45;&gt;layer70_attn_ar -->
<g id="edge2273" class="edge">
<title>layer70_attn_out_7&#45;&gt;layer70_attn_ar</title>
<path fill="none" stroke="black" d="M835.31,-18598.3C835.31,-18598.3 835.31,-18527.95 835.31,-18527.95"/>
<polygon fill="black" stroke="black" points="838.81,-18527.95 835.31,-18517.95 831.81,-18527.95 838.81,-18527.95"/>
</g>
<!-- layer70_ffn_norm_6 -->
<g id="node1781" class="node">
<title>layer70_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="743.5,-18358.33 571.5,-18358.33 571.5,-18290.33 743.5,-18290.33 743.5,-18358.33"/>
<text text-anchor="middle" x="657.5" y="-18343.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="657.5" y="-18328.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="657.5" y="-18313.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="657.5" y="-18298.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer70_attn_ar&#45;&gt;layer70_ffn_norm_6 -->
<g id="edge2274" class="edge">
<title>layer70_attn_ar&#45;&gt;layer70_ffn_norm_6</title>
<path fill="none" stroke="black" d="M693.69,-18439.53C693.69,-18439.53 693.69,-18368.48 693.69,-18368.48"/>
<polygon fill="black" stroke="black" points="697.19,-18368.48 693.69,-18358.48 690.19,-18368.48 697.19,-18368.48"/>
</g>
<!-- layer70_ffn_norm_7 -->
<g id="node1782" class="node">
<title>layer70_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="960.5,-18358.33 788.5,-18358.33 788.5,-18290.33 960.5,-18290.33 960.5,-18358.33"/>
<text text-anchor="middle" x="874.5" y="-18343.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="874.5" y="-18328.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="874.5" y="-18313.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="874.5" y="-18298.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer70_attn_ar&#45;&gt;layer70_ffn_norm_7 -->
<g id="edge2275" class="edge">
<title>layer70_attn_ar&#45;&gt;layer70_ffn_norm_7</title>
<path fill="none" stroke="black" d="M837.81,-18439.53C837.81,-18439.53 837.81,-18368.48 837.81,-18368.48"/>
<polygon fill="black" stroke="black" points="841.31,-18368.48 837.81,-18358.48 834.31,-18368.48 841.31,-18368.48"/>
</g>
<!-- layer70_ffn_gate_6 -->
<g id="node1783" class="node">
<title>layer70_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="748,-18218.33 567,-18218.33 567,-18150.33 748,-18150.33 748,-18218.33"/>
<text text-anchor="middle" x="657.5" y="-18203.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="657.5" y="-18188.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="657.5" y="-18173.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="657.5" y="-18158.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_ffn_norm_6&#45;&gt;layer70_ffn_gate_6 -->
<g id="edge2276" class="edge">
<title>layer70_ffn_norm_6&#45;&gt;layer70_ffn_gate_6</title>
<path fill="none" stroke="black" d="M657.5,-18290.08C657.5,-18290.08 657.5,-18228.71 657.5,-18228.71"/>
<polygon fill="black" stroke="black" points="661,-18228.71 657.5,-18218.71 654,-18228.71 661,-18228.71"/>
</g>
<!-- layer70_ffn_up_6 -->
<g id="node1785" class="node">
<title>layer70_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="531,-18218.33 350,-18218.33 350,-18150.33 531,-18150.33 531,-18218.33"/>
<text text-anchor="middle" x="440.5" y="-18203.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="440.5" y="-18188.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="440.5" y="-18173.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="440.5" y="-18158.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_ffn_norm_6&#45;&gt;layer70_ffn_up_6 -->
<g id="edge2278" class="edge">
<title>layer70_ffn_norm_6&#45;&gt;layer70_ffn_up_6</title>
<path fill="none" stroke="black" d="M571.31,-18324C531.86,-18324 493.76,-18324 493.76,-18324 493.76,-18324 493.76,-18228.5 493.76,-18228.5"/>
<polygon fill="black" stroke="black" points="497.26,-18228.5 493.76,-18218.5 490.26,-18228.5 497.26,-18228.5"/>
</g>
<!-- layer70_ffn_gate_7 -->
<g id="node1784" class="node">
<title>layer70_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1182,-18218.33 1001,-18218.33 1001,-18150.33 1182,-18150.33 1182,-18218.33"/>
<text text-anchor="middle" x="1091.5" y="-18203.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1091.5" y="-18188.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1091.5" y="-18173.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1091.5" y="-18158.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_ffn_norm_7&#45;&gt;layer70_ffn_gate_7 -->
<g id="edge2277" class="edge">
<title>layer70_ffn_norm_7&#45;&gt;layer70_ffn_gate_7</title>
<path fill="none" stroke="black" d="M960.56,-18324C999.95,-18324 1038,-18324 1038,-18324 1038,-18324 1038,-18228.5 1038,-18228.5"/>
<polygon fill="black" stroke="black" points="1041.5,-18228.5 1038,-18218.5 1034.5,-18228.5 1041.5,-18228.5"/>
</g>
<!-- layer70_ffn_up_7 -->
<g id="node1786" class="node">
<title>layer70_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="965,-18218.33 784,-18218.33 784,-18150.33 965,-18150.33 965,-18218.33"/>
<text text-anchor="middle" x="874.5" y="-18203.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="874.5" y="-18188.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="874.5" y="-18173.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="874.5" y="-18158.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_ffn_norm_7&#45;&gt;layer70_ffn_up_7 -->
<g id="edge2279" class="edge">
<title>layer70_ffn_norm_7&#45;&gt;layer70_ffn_up_7</title>
<path fill="none" stroke="black" d="M874.5,-18290.08C874.5,-18290.08 874.5,-18228.71 874.5,-18228.71"/>
<polygon fill="black" stroke="black" points="878,-18228.71 874.5,-18218.71 871,-18228.71 878,-18228.71"/>
</g>
<!-- layer70_gate_ar -->
<g id="node1787" class="node">
<title>layer70_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="965.5" cy="-18030.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="965.5" y="-18049.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="965.5" y="-18034.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="965.5" y="-18019.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="965.5" y="-18004.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer70_ffn_gate_6&#45;&gt;layer70_gate_ar -->
<g id="edge2280" class="edge">
<title>layer70_ffn_gate_6&#45;&gt;layer70_gate_ar</title>
<path fill="none" stroke="black" d="M748.08,-18184C758.79,-18184 766,-18184 766,-18184 766,-18184 766,-18046 766,-18046 766,-18046 834.56,-18046 834.56,-18046"/>
<polygon fill="black" stroke="black" points="834.56,-18049.5 844.56,-18046 834.56,-18042.5 834.56,-18049.5"/>
</g>
<!-- layer70_ffn_gate_7&#45;&gt;layer70_gate_ar -->
<g id="edge2281" class="edge">
<title>layer70_ffn_gate_7&#45;&gt;layer70_gate_ar</title>
<path fill="none" stroke="black" d="M1047.24,-18150.13C1047.24,-18150.13 1047.24,-18077.31 1047.24,-18077.31"/>
<polygon fill="black" stroke="black" points="1050.74,-18077.31 1047.24,-18067.31 1043.74,-18077.31 1050.74,-18077.31"/>
</g>
<!-- layer70_up_ar -->
<g id="node1788" class="node">
<title>layer70_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="619.5" cy="-18030.24" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="619.5" y="-18049.04" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="619.5" y="-18034.04" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="619.5" y="-18019.04" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="619.5" y="-18004.04" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer70_ffn_up_6&#45;&gt;layer70_up_ar -->
<g id="edge2282" class="edge">
<title>layer70_ffn_up_6&#45;&gt;layer70_up_ar</title>
<path fill="none" stroke="black" d="M511.26,-18150.13C511.26,-18150.13 511.26,-18066.21 511.26,-18066.21"/>
<polygon fill="black" stroke="black" points="514.76,-18066.21 511.26,-18056.21 507.76,-18066.21 514.76,-18066.21"/>
</g>
<!-- layer70_ffn_up_7&#45;&gt;layer70_up_ar -->
<g id="edge2283" class="edge">
<title>layer70_ffn_up_7&#45;&gt;layer70_up_ar</title>
<path fill="none" stroke="black" d="M810.76,-18150.27C810.76,-18100.56 810.76,-18014 810.76,-18014 810.76,-18014 750.08,-18014 750.08,-18014"/>
<polygon fill="black" stroke="black" points="750.08,-18010.5 740.08,-18014 750.08,-18017.5 750.08,-18010.5"/>
</g>
<!-- layer70_silu_6 -->
<g id="node1789" class="node">
<title>layer70_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="893,-17910.16 712,-17910.16 712,-17842.16 893,-17842.16 893,-17910.16"/>
<text text-anchor="middle" x="802.5" y="-17894.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="802.5" y="-17879.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="802.5" y="-17864.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="802.5" y="-17849.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_gate_ar&#45;&gt;layer70_silu_6 -->
<g id="edge2284" class="edge">
<title>layer70_gate_ar&#45;&gt;layer70_silu_6</title>
<path fill="none" stroke="black" d="M865.26,-18000.17C865.26,-18000.17 865.26,-17920.18 865.26,-17920.18"/>
<polygon fill="black" stroke="black" points="868.76,-17920.18 865.26,-17910.18 861.76,-17920.18 868.76,-17920.18"/>
</g>
<!-- layer70_silu_7 -->
<g id="node1790" class="node">
<title>layer70_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1110,-17910.16 929,-17910.16 929,-17842.16 1110,-17842.16 1110,-17910.16"/>
<text text-anchor="middle" x="1019.5" y="-17894.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1019.5" y="-17879.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1019.5" y="-17864.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1019.5" y="-17849.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_gate_ar&#45;&gt;layer70_silu_7 -->
<g id="edge2285" class="edge">
<title>layer70_gate_ar&#45;&gt;layer70_silu_7</title>
<path fill="none" stroke="black" d="M1011.24,-17985.26C1011.24,-17985.26 1011.24,-17920.17 1011.24,-17920.17"/>
<polygon fill="black" stroke="black" points="1014.74,-17920.17 1011.24,-17910.17 1007.74,-17920.17 1014.74,-17920.17"/>
</g>
<!-- layer70_mul_6 -->
<g id="node1791" class="node">
<title>layer70_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="783,-17770.16 602,-17770.16 602,-17702.16 783,-17702.16 783,-17770.16"/>
<text text-anchor="middle" x="692.5" y="-17754.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="692.5" y="-17739.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="692.5" y="-17724.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="692.5" y="-17709.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_up_ar&#45;&gt;layer70_mul_6 -->
<g id="edge2287" class="edge">
<title>layer70_up_ar&#45;&gt;layer70_mul_6</title>
<path fill="none" stroke="black" d="M657,-17983.97C657,-17983.97 657,-17780.25 657,-17780.25"/>
<polygon fill="black" stroke="black" points="660.5,-17780.25 657,-17770.25 653.5,-17780.25 660.5,-17780.25"/>
</g>
<!-- layer70_mul_7 -->
<g id="node1792" class="node">
<title>layer70_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1000,-17770.16 819,-17770.16 819,-17702.16 1000,-17702.16 1000,-17770.16"/>
<text text-anchor="middle" x="909.5" y="-17754.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="909.5" y="-17739.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="909.5" y="-17724.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="909.5" y="-17709.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer70_up_ar&#45;&gt;layer70_mul_7 -->
<g id="edge2289" class="edge">
<title>layer70_up_ar&#45;&gt;layer70_mul_7</title>
<path fill="none" stroke="black" d="M729.74,-18005.42C729.74,-17980.57 729.74,-17946 729.74,-17946 729.74,-17946 911,-17946 911,-17946 911,-17946 911,-17780.34 911,-17780.34"/>
<polygon fill="black" stroke="black" points="914.5,-17780.34 911,-17770.34 907.5,-17780.34 914.5,-17780.34"/>
</g>
<!-- layer70_silu_6&#45;&gt;layer70_mul_6 -->
<g id="edge2286" class="edge">
<title>layer70_silu_6&#45;&gt;layer70_mul_6</title>
<path fill="none" stroke="black" d="M747.5,-17841.91C747.5,-17841.91 747.5,-17780.54 747.5,-17780.54"/>
<polygon fill="black" stroke="black" points="751,-17780.54 747.5,-17770.54 744,-17780.54 751,-17780.54"/>
</g>
<!-- layer70_silu_7&#45;&gt;layer70_mul_7 -->
<g id="edge2288" class="edge">
<title>layer70_silu_7&#45;&gt;layer70_mul_7</title>
<path fill="none" stroke="black" d="M964.5,-17841.91C964.5,-17841.91 964.5,-17780.54 964.5,-17780.54"/>
<polygon fill="black" stroke="black" points="968,-17780.54 964.5,-17770.54 961,-17780.54 968,-17780.54"/>
</g>
<!-- layer70_ffn_down_6 -->
<g id="node1793" class="node">
<title>layer70_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="782.5,-17630.16 610.5,-17630.16 610.5,-17562.16 782.5,-17562.16 782.5,-17630.16"/>
<text text-anchor="middle" x="696.5" y="-17614.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="696.5" y="-17599.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="696.5" y="-17584.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="696.5" y="-17569.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer70_mul_6&#45;&gt;layer70_ffn_down_6 -->
<g id="edge2290" class="edge">
<title>layer70_mul_6&#45;&gt;layer70_ffn_down_6</title>
<path fill="none" stroke="black" d="M696.5,-17701.91C696.5,-17701.91 696.5,-17640.54 696.5,-17640.54"/>
<polygon fill="black" stroke="black" points="700,-17640.54 696.5,-17630.54 693,-17640.54 700,-17640.54"/>
</g>
<!-- layer70_ffn_down_7 -->
<g id="node1794" class="node">
<title>layer70_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="992.5,-17630.16 820.5,-17630.16 820.5,-17562.16 992.5,-17562.16 992.5,-17630.16"/>
<text text-anchor="middle" x="906.5" y="-17614.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="906.5" y="-17599.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="906.5" y="-17584.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="906.5" y="-17569.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer70_mul_7&#45;&gt;layer70_ffn_down_7 -->
<g id="edge2291" class="edge">
<title>layer70_mul_7&#45;&gt;layer70_ffn_down_7</title>
<path fill="none" stroke="black" d="M906.5,-17701.91C906.5,-17701.91 906.5,-17640.54 906.5,-17640.54"/>
<polygon fill="black" stroke="black" points="910,-17640.54 906.5,-17630.54 903,-17640.54 910,-17640.54"/>
</g>
<!-- layer70_ffn_ar -->
<g id="node1795" class="node">
<title>layer70_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="800.5" cy="-17442.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="800.5" y="-17460.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="800.5" y="-17445.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="800.5" y="-17430.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="800.5" y="-17415.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer70_ffn_down_6&#45;&gt;layer70_ffn_ar -->
<g id="edge2292" class="edge">
<title>layer70_ffn_down_6&#45;&gt;layer70_ffn_ar</title>
<path fill="none" stroke="black" d="M730.69,-17561.97C730.69,-17561.97 730.69,-17491.62 730.69,-17491.62"/>
<polygon fill="black" stroke="black" points="734.19,-17491.62 730.69,-17481.62 727.19,-17491.62 734.19,-17491.62"/>
</g>
<!-- layer70_ffn_down_7&#45;&gt;layer70_ffn_ar -->
<g id="edge2293" class="edge">
<title>layer70_ffn_down_7&#45;&gt;layer70_ffn_ar</title>
<path fill="none" stroke="black" d="M871.31,-17561.97C871.31,-17561.97 871.31,-17491.34 871.31,-17491.34"/>
<polygon fill="black" stroke="black" points="874.81,-17491.34 871.31,-17481.34 867.81,-17491.34 874.81,-17491.34"/>
</g>
<!-- layer71_norm_6 -->
<g id="node1796" class="node">
<title>layer71_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="782.5,-17321.99 610.5,-17321.99 610.5,-17253.99 782.5,-17253.99 782.5,-17321.99"/>
<text text-anchor="middle" x="696.5" y="-17306.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="696.5" y="-17291.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="696.5" y="-17276.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="696.5" y="-17261.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer70_ffn_ar&#45;&gt;layer71_norm_6 -->
<g id="edge2294" class="edge">
<title>layer70_ffn_ar&#45;&gt;layer71_norm_6</title>
<path fill="none" stroke="black" d="M730.69,-17402.4C730.69,-17402.4 730.69,-17332.05 730.69,-17332.05"/>
<polygon fill="black" stroke="black" points="734.19,-17332.05 730.69,-17322.05 727.19,-17332.05 734.19,-17332.05"/>
</g>
<!-- layer71_norm_7 -->
<g id="node1797" class="node">
<title>layer71_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="992.5,-17321.99 820.5,-17321.99 820.5,-17253.99 992.5,-17253.99 992.5,-17321.99"/>
<text text-anchor="middle" x="906.5" y="-17306.79" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="906.5" y="-17291.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="906.5" y="-17276.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="906.5" y="-17261.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer70_ffn_ar&#45;&gt;layer71_norm_7 -->
<g id="edge2295" class="edge">
<title>layer70_ffn_ar&#45;&gt;layer71_norm_7</title>
<path fill="none" stroke="black" d="M871.31,-17402.8C871.31,-17402.8 871.31,-17332.23 871.31,-17332.23"/>
<polygon fill="black" stroke="black" points="874.81,-17332.23 871.31,-17322.23 867.81,-17332.23 874.81,-17332.23"/>
</g>
<!-- layer71_qkv_6 -->
<g id="node1798" class="node">
<title>layer71_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="783,-17181.99 602,-17181.99 602,-17113.99 783,-17113.99 783,-17181.99"/>
<text text-anchor="middle" x="692.5" y="-17166.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="692.5" y="-17151.79" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="692.5" y="-17136.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="692.5" y="-17121.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer71_norm_6&#45;&gt;layer71_qkv_6 -->
<g id="edge2296" class="edge">
<title>layer71_norm_6&#45;&gt;layer71_qkv_6</title>
<path fill="none" stroke="black" d="M696.5,-17253.75C696.5,-17253.75 696.5,-17192.37 696.5,-17192.37"/>
<polygon fill="black" stroke="black" points="700,-17192.37 696.5,-17182.37 693,-17192.37 700,-17192.37"/>
</g>
<!-- layer71_qkv_7 -->
<g id="node1799" class="node">
<title>layer71_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1000,-17181.99 819,-17181.99 819,-17113.99 1000,-17113.99 1000,-17181.99"/>
<text text-anchor="middle" x="909.5" y="-17166.79" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="909.5" y="-17151.79" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="909.5" y="-17136.79" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="909.5" y="-17121.79" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer71_norm_7&#45;&gt;layer71_qkv_7 -->
<g id="edge2297" class="edge">
<title>layer71_norm_7&#45;&gt;layer71_qkv_7</title>
<path fill="none" stroke="black" d="M906.5,-17253.75C906.5,-17253.75 906.5,-17192.37 906.5,-17192.37"/>
<polygon fill="black" stroke="black" points="910,-17192.37 906.5,-17182.37 903,-17192.37 910,-17192.37"/>
</g>
<!-- layer71_qkv_ar -->
<g id="node1800" class="node">
<title>layer71_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="800.5" cy="-16993.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="800.5" y="-17012.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="800.5" y="-16997.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="800.5" y="-16982.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="800.5" y="-16967.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer71_qkv_6&#45;&gt;layer71_qkv_ar -->
<g id="edge2298" class="edge">
<title>layer71_qkv_6&#45;&gt;layer71_qkv_ar</title>
<path fill="none" stroke="black" d="M727.76,-17113.8C727.76,-17113.8 727.76,-17043.73 727.76,-17043.73"/>
<polygon fill="black" stroke="black" points="731.26,-17043.73 727.76,-17033.73 724.26,-17043.73 731.26,-17043.73"/>
</g>
<!-- layer71_qkv_7&#45;&gt;layer71_qkv_ar -->
<g id="edge2299" class="edge">
<title>layer71_qkv_7&#45;&gt;layer71_qkv_ar</title>
<path fill="none" stroke="black" d="M873.74,-17113.8C873.74,-17113.8 873.74,-17043.45 873.74,-17043.45"/>
<polygon fill="black" stroke="black" points="877.24,-17043.45 873.74,-17033.45 870.24,-17043.45 877.24,-17043.45"/>
</g>
<!-- layer71_attn_6 -->
<g id="node1801" class="node">
<title>layer71_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="782.5,-16873.83 610.5,-16873.83 610.5,-16805.83 782.5,-16805.83 782.5,-16873.83"/>
<text text-anchor="middle" x="696.5" y="-16858.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="696.5" y="-16843.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="696.5" y="-16828.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="696.5" y="-16813.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer71_qkv_ar&#45;&gt;layer71_attn_6 -->
<g id="edge2300" class="edge">
<title>layer71_qkv_ar&#45;&gt;layer71_attn_6</title>
<path fill="none" stroke="black" d="M727.51,-16954.23C727.51,-16954.23 727.51,-16883.89 727.51,-16883.89"/>
<polygon fill="black" stroke="black" points="731.01,-16883.89 727.51,-16873.89 724.01,-16883.89 731.01,-16883.89"/>
</g>
<!-- layer71_attn_7 -->
<g id="node1802" class="node">
<title>layer71_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="990.5,-16873.83 818.5,-16873.83 818.5,-16805.83 990.5,-16805.83 990.5,-16873.83"/>
<text text-anchor="middle" x="904.5" y="-16858.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="904.5" y="-16843.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="904.5" y="-16828.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="904.5" y="-16813.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer71_qkv_ar&#45;&gt;layer71_attn_7 -->
<g id="edge2301" class="edge">
<title>layer71_qkv_ar&#45;&gt;layer71_attn_7</title>
<path fill="none" stroke="black" d="M873.49,-16954.23C873.49,-16954.23 873.49,-16883.89 873.49,-16883.89"/>
<polygon fill="black" stroke="black" points="876.99,-16883.89 873.49,-16873.89 869.99,-16883.89 876.99,-16883.89"/>
</g>
<!-- layer71_attn_out_6 -->
<g id="node1803" class="node">
<title>layer71_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="782.5,-16733.83 610.5,-16733.83 610.5,-16665.83 782.5,-16665.83 782.5,-16733.83"/>
<text text-anchor="middle" x="696.5" y="-16718.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="696.5" y="-16703.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="696.5" y="-16688.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="696.5" y="-16673.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer71_attn_6&#45;&gt;layer71_attn_out_6 -->
<g id="edge2302" class="edge">
<title>layer71_attn_6&#45;&gt;layer71_attn_out_6</title>
<path fill="none" stroke="black" d="M696.5,-16805.58C696.5,-16805.58 696.5,-16744.21 696.5,-16744.21"/>
<polygon fill="black" stroke="black" points="700,-16744.21 696.5,-16734.21 693,-16744.21 700,-16744.21"/>
</g>
<!-- layer71_attn_out_7 -->
<g id="node1804" class="node">
<title>layer71_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="990.5,-16733.83 818.5,-16733.83 818.5,-16665.83 990.5,-16665.83 990.5,-16733.83"/>
<text text-anchor="middle" x="904.5" y="-16718.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="904.5" y="-16703.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="904.5" y="-16688.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="904.5" y="-16673.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer71_attn_7&#45;&gt;layer71_attn_out_7 -->
<g id="edge2303" class="edge">
<title>layer71_attn_7&#45;&gt;layer71_attn_out_7</title>
<path fill="none" stroke="black" d="M904.5,-16805.58C904.5,-16805.58 904.5,-16744.21 904.5,-16744.21"/>
<polygon fill="black" stroke="black" points="908,-16744.21 904.5,-16734.21 901,-16744.21 908,-16744.21"/>
</g>
<!-- layer71_attn_ar -->
<g id="node1805" class="node">
<title>layer71_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="800.5" cy="-16545.75" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="800.5" y="-16564.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="800.5" y="-16549.55" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="800.5" y="-16534.55" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="800.5" y="-16519.55" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer71_attn_out_6&#45;&gt;layer71_attn_ar -->
<g id="edge2304" class="edge">
<title>layer71_attn_out_6&#45;&gt;layer71_attn_ar</title>
<path fill="none" stroke="black" d="M730.69,-16665.63C730.69,-16665.63 730.69,-16595.29 730.69,-16595.29"/>
<polygon fill="black" stroke="black" points="734.19,-16595.29 730.69,-16585.29 727.19,-16595.29 734.19,-16595.29"/>
</g>
<!-- layer71_attn_out_7&#45;&gt;layer71_attn_ar -->
<g id="edge2305" class="edge">
<title>layer71_attn_out_7&#45;&gt;layer71_attn_ar</title>
<path fill="none" stroke="black" d="M870.31,-16665.63C870.31,-16665.63 870.31,-16595.29 870.31,-16595.29"/>
<polygon fill="black" stroke="black" points="873.81,-16595.29 870.31,-16585.29 866.81,-16595.29 873.81,-16595.29"/>
</g>
<!-- layer71_ffn_norm_6 -->
<g id="node1806" class="node">
<title>layer71_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="778.5,-16425.66 606.5,-16425.66 606.5,-16357.66 778.5,-16357.66 778.5,-16425.66"/>
<text text-anchor="middle" x="692.5" y="-16410.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="692.5" y="-16395.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="692.5" y="-16380.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="692.5" y="-16365.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer71_attn_ar&#45;&gt;layer71_ffn_norm_6 -->
<g id="edge2306" class="edge">
<title>layer71_attn_ar&#45;&gt;layer71_ffn_norm_6</title>
<path fill="none" stroke="black" d="M728.69,-16506.86C728.69,-16506.86 728.69,-16435.81 728.69,-16435.81"/>
<polygon fill="black" stroke="black" points="732.19,-16435.81 728.69,-16425.81 725.19,-16435.81 732.19,-16435.81"/>
</g>
<!-- layer71_ffn_norm_7 -->
<g id="node1807" class="node">
<title>layer71_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="995.5,-16425.66 823.5,-16425.66 823.5,-16357.66 995.5,-16357.66 995.5,-16425.66"/>
<text text-anchor="middle" x="909.5" y="-16410.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="909.5" y="-16395.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="909.5" y="-16380.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="909.5" y="-16365.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer71_attn_ar&#45;&gt;layer71_ffn_norm_7 -->
<g id="edge2307" class="edge">
<title>layer71_attn_ar&#45;&gt;layer71_ffn_norm_7</title>
<path fill="none" stroke="black" d="M872.81,-16506.86C872.81,-16506.86 872.81,-16435.81 872.81,-16435.81"/>
<polygon fill="black" stroke="black" points="876.31,-16435.81 872.81,-16425.81 869.31,-16435.81 876.31,-16435.81"/>
</g>
<!-- layer71_ffn_gate_6 -->
<g id="node1808" class="node">
<title>layer71_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="783,-16285.66 602,-16285.66 602,-16217.66 783,-16217.66 783,-16285.66"/>
<text text-anchor="middle" x="692.5" y="-16270.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="692.5" y="-16255.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="692.5" y="-16240.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="692.5" y="-16225.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_ffn_norm_6&#45;&gt;layer71_ffn_gate_6 -->
<g id="edge2308" class="edge">
<title>layer71_ffn_norm_6&#45;&gt;layer71_ffn_gate_6</title>
<path fill="none" stroke="black" d="M692.5,-16357.41C692.5,-16357.41 692.5,-16296.04 692.5,-16296.04"/>
<polygon fill="black" stroke="black" points="696,-16296.04 692.5,-16286.04 689,-16296.04 696,-16296.04"/>
</g>
<!-- layer71_ffn_up_6 -->
<g id="node1810" class="node">
<title>layer71_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="566,-16285.66 385,-16285.66 385,-16217.66 566,-16217.66 566,-16285.66"/>
<text text-anchor="middle" x="475.5" y="-16270.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="475.5" y="-16255.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="475.5" y="-16240.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="475.5" y="-16225.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_ffn_norm_6&#45;&gt;layer71_ffn_up_6 -->
<g id="edge2310" class="edge">
<title>layer71_ffn_norm_6&#45;&gt;layer71_ffn_up_6</title>
<path fill="none" stroke="black" d="M606.31,-16391C566.86,-16391 528.76,-16391 528.76,-16391 528.76,-16391 528.76,-16295.75 528.76,-16295.75"/>
<polygon fill="black" stroke="black" points="532.26,-16295.75 528.76,-16285.75 525.26,-16295.75 532.26,-16295.75"/>
</g>
<!-- layer71_ffn_gate_7 -->
<g id="node1809" class="node">
<title>layer71_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1217,-16285.66 1036,-16285.66 1036,-16217.66 1217,-16217.66 1217,-16285.66"/>
<text text-anchor="middle" x="1126.5" y="-16270.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1126.5" y="-16255.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1126.5" y="-16240.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1126.5" y="-16225.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_ffn_norm_7&#45;&gt;layer71_ffn_gate_7 -->
<g id="edge2309" class="edge">
<title>layer71_ffn_norm_7&#45;&gt;layer71_ffn_gate_7</title>
<path fill="none" stroke="black" d="M995.56,-16391C1034.95,-16391 1073,-16391 1073,-16391 1073,-16391 1073,-16295.75 1073,-16295.75"/>
<polygon fill="black" stroke="black" points="1076.5,-16295.75 1073,-16285.75 1069.5,-16295.75 1076.5,-16295.75"/>
</g>
<!-- layer71_ffn_up_7 -->
<g id="node1811" class="node">
<title>layer71_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1000,-16285.66 819,-16285.66 819,-16217.66 1000,-16217.66 1000,-16285.66"/>
<text text-anchor="middle" x="909.5" y="-16270.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="909.5" y="-16255.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="909.5" y="-16240.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="909.5" y="-16225.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_ffn_norm_7&#45;&gt;layer71_ffn_up_7 -->
<g id="edge2311" class="edge">
<title>layer71_ffn_norm_7&#45;&gt;layer71_ffn_up_7</title>
<path fill="none" stroke="black" d="M909.5,-16357.41C909.5,-16357.41 909.5,-16296.04 909.5,-16296.04"/>
<polygon fill="black" stroke="black" points="913,-16296.04 909.5,-16286.04 906,-16296.04 913,-16296.04"/>
</g>
<!-- layer71_gate_ar -->
<g id="node1812" class="node">
<title>layer71_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1000.5" cy="-16097.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1000.5" y="-16116.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1000.5" y="-16101.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1000.5" y="-16086.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1000.5" y="-16071.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer71_ffn_gate_6&#45;&gt;layer71_gate_ar -->
<g id="edge2312" class="edge">
<title>layer71_ffn_gate_6&#45;&gt;layer71_gate_ar</title>
<path fill="none" stroke="black" d="M783.08,-16251C793.79,-16251 801,-16251 801,-16251 801,-16251 801,-16113 801,-16113 801,-16113 868.99,-16113 868.99,-16113"/>
<polygon fill="black" stroke="black" points="868.99,-16116.5 878.99,-16113 868.99,-16109.5 868.99,-16116.5"/>
</g>
<!-- layer71_ffn_gate_7&#45;&gt;layer71_gate_ar -->
<g id="edge2313" class="edge">
<title>layer71_ffn_gate_7&#45;&gt;layer71_gate_ar</title>
<path fill="none" stroke="black" d="M1082.24,-16217.47C1082.24,-16217.47 1082.24,-16144.64 1082.24,-16144.64"/>
<polygon fill="black" stroke="black" points="1085.74,-16144.64 1082.24,-16134.64 1078.74,-16144.64 1085.74,-16144.64"/>
</g>
<!-- layer71_up_ar -->
<g id="node1813" class="node">
<title>layer71_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="654.5" cy="-16097.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="654.5" y="-16116.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="654.5" y="-16101.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="654.5" y="-16086.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="654.5" y="-16071.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer71_ffn_up_6&#45;&gt;layer71_up_ar -->
<g id="edge2314" class="edge">
<title>layer71_ffn_up_6&#45;&gt;layer71_up_ar</title>
<path fill="none" stroke="black" d="M546.26,-16217.47C546.26,-16217.47 546.26,-16133.54 546.26,-16133.54"/>
<polygon fill="black" stroke="black" points="549.76,-16133.54 546.26,-16123.54 542.76,-16133.54 549.76,-16133.54"/>
</g>
<!-- layer71_ffn_up_7&#45;&gt;layer71_up_ar -->
<g id="edge2315" class="edge">
<title>layer71_ffn_up_7&#45;&gt;layer71_up_ar</title>
<path fill="none" stroke="black" d="M845.76,-16217.54C845.76,-16167.73 845.76,-16081 845.76,-16081 845.76,-16081 784.81,-16081 784.81,-16081"/>
<polygon fill="black" stroke="black" points="784.81,-16077.5 774.81,-16081 784.81,-16084.5 784.81,-16077.5"/>
</g>
<!-- layer71_silu_6 -->
<g id="node1814" class="node">
<title>layer71_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="928,-15977.5 747,-15977.5 747,-15909.5 928,-15909.5 928,-15977.5"/>
<text text-anchor="middle" x="837.5" y="-15962.3" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="837.5" y="-15947.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="837.5" y="-15932.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="837.5" y="-15917.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_gate_ar&#45;&gt;layer71_silu_6 -->
<g id="edge2316" class="edge">
<title>layer71_gate_ar&#45;&gt;layer71_silu_6</title>
<path fill="none" stroke="black" d="M900.26,-16067.5C900.26,-16067.5 900.26,-15987.52 900.26,-15987.52"/>
<polygon fill="black" stroke="black" points="903.76,-15987.52 900.26,-15977.52 896.76,-15987.52 903.76,-15987.52"/>
</g>
<!-- layer71_silu_7 -->
<g id="node1815" class="node">
<title>layer71_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1145,-15977.5 964,-15977.5 964,-15909.5 1145,-15909.5 1145,-15977.5"/>
<text text-anchor="middle" x="1054.5" y="-15962.3" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1054.5" y="-15947.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1054.5" y="-15932.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1054.5" y="-15917.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_gate_ar&#45;&gt;layer71_silu_7 -->
<g id="edge2317" class="edge">
<title>layer71_gate_ar&#45;&gt;layer71_silu_7</title>
<path fill="none" stroke="black" d="M1046.24,-16052.6C1046.24,-16052.6 1046.24,-15987.5 1046.24,-15987.5"/>
<polygon fill="black" stroke="black" points="1049.74,-15987.5 1046.24,-15977.5 1042.74,-15987.5 1049.74,-15987.5"/>
</g>
<!-- layer71_mul_6 -->
<g id="node1816" class="node">
<title>layer71_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="818,-15837.5 637,-15837.5 637,-15769.5 818,-15769.5 818,-15837.5"/>
<text text-anchor="middle" x="727.5" y="-15822.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="727.5" y="-15807.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="727.5" y="-15792.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="727.5" y="-15777.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_up_ar&#45;&gt;layer71_mul_6 -->
<g id="edge2319" class="edge">
<title>layer71_up_ar&#45;&gt;layer71_mul_6</title>
<path fill="none" stroke="black" d="M692,-16051.3C692,-16051.3 692,-15847.58 692,-15847.58"/>
<polygon fill="black" stroke="black" points="695.5,-15847.58 692,-15837.58 688.5,-15847.58 695.5,-15847.58"/>
</g>
<!-- layer71_mul_7 -->
<g id="node1817" class="node">
<title>layer71_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1035,-15837.5 854,-15837.5 854,-15769.5 1035,-15769.5 1035,-15837.5"/>
<text text-anchor="middle" x="944.5" y="-15822.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="944.5" y="-15807.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="944.5" y="-15792.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="944.5" y="-15777.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer71_up_ar&#45;&gt;layer71_mul_7 -->
<g id="edge2321" class="edge">
<title>layer71_up_ar&#45;&gt;layer71_mul_7</title>
<path fill="none" stroke="black" d="M764.74,-16073.11C764.74,-16048.14 764.74,-16013 764.74,-16013 764.74,-16013 946,-16013 946,-16013 946,-16013 946,-15847.62 946,-15847.62"/>
<polygon fill="black" stroke="black" points="949.5,-15847.62 946,-15837.62 942.5,-15847.62 949.5,-15847.62"/>
</g>
<!-- layer71_silu_6&#45;&gt;layer71_mul_6 -->
<g id="edge2318" class="edge">
<title>layer71_silu_6&#45;&gt;layer71_mul_6</title>
<path fill="none" stroke="black" d="M782.5,-15909.25C782.5,-15909.25 782.5,-15847.87 782.5,-15847.87"/>
<polygon fill="black" stroke="black" points="786,-15847.87 782.5,-15837.87 779,-15847.87 786,-15847.87"/>
</g>
<!-- layer71_silu_7&#45;&gt;layer71_mul_7 -->
<g id="edge2320" class="edge">
<title>layer71_silu_7&#45;&gt;layer71_mul_7</title>
<path fill="none" stroke="black" d="M999.5,-15909.25C999.5,-15909.25 999.5,-15847.87 999.5,-15847.87"/>
<polygon fill="black" stroke="black" points="1003,-15847.87 999.5,-15837.87 996,-15847.87 1003,-15847.87"/>
</g>
<!-- layer71_ffn_down_6 -->
<g id="node1818" class="node">
<title>layer71_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="817.5,-15697.5 645.5,-15697.5 645.5,-15629.5 817.5,-15629.5 817.5,-15697.5"/>
<text text-anchor="middle" x="731.5" y="-15682.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="731.5" y="-15667.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="731.5" y="-15652.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="731.5" y="-15637.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer71_mul_6&#45;&gt;layer71_ffn_down_6 -->
<g id="edge2322" class="edge">
<title>layer71_mul_6&#45;&gt;layer71_ffn_down_6</title>
<path fill="none" stroke="black" d="M731.5,-15769.25C731.5,-15769.25 731.5,-15707.87 731.5,-15707.87"/>
<polygon fill="black" stroke="black" points="735,-15707.87 731.5,-15697.87 728,-15707.87 735,-15707.87"/>
</g>
<!-- layer71_ffn_down_7 -->
<g id="node1819" class="node">
<title>layer71_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1027.5,-15697.5 855.5,-15697.5 855.5,-15629.5 1027.5,-15629.5 1027.5,-15697.5"/>
<text text-anchor="middle" x="941.5" y="-15682.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="941.5" y="-15667.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="941.5" y="-15652.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="941.5" y="-15637.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer71_mul_7&#45;&gt;layer71_ffn_down_7 -->
<g id="edge2323" class="edge">
<title>layer71_mul_7&#45;&gt;layer71_ffn_down_7</title>
<path fill="none" stroke="black" d="M941.5,-15769.25C941.5,-15769.25 941.5,-15707.87 941.5,-15707.87"/>
<polygon fill="black" stroke="black" points="945,-15707.87 941.5,-15697.87 938,-15707.87 945,-15707.87"/>
</g>
<!-- layer71_ffn_ar -->
<g id="node1820" class="node">
<title>layer71_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="835.5" cy="-15509.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="835.5" y="-15528.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="835.5" y="-15513.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="835.5" y="-15498.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="835.5" y="-15483.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer71_ffn_down_6&#45;&gt;layer71_ffn_ar -->
<g id="edge2324" class="edge">
<title>layer71_ffn_down_6&#45;&gt;layer71_ffn_ar</title>
<path fill="none" stroke="black" d="M765.69,-15629.3C765.69,-15629.3 765.69,-15558.95 765.69,-15558.95"/>
<polygon fill="black" stroke="black" points="769.19,-15558.95 765.69,-15548.95 762.19,-15558.95 769.19,-15558.95"/>
</g>
<!-- layer71_ffn_down_7&#45;&gt;layer71_ffn_ar -->
<g id="edge2325" class="edge">
<title>layer71_ffn_down_7&#45;&gt;layer71_ffn_ar</title>
<path fill="none" stroke="black" d="M906.31,-15629.3C906.31,-15629.3 906.31,-15558.68 906.31,-15558.68"/>
<polygon fill="black" stroke="black" points="909.81,-15558.68 906.31,-15548.68 902.81,-15558.68 909.81,-15558.68"/>
</g>
<!-- layer72_norm_6 -->
<g id="node1821" class="node">
<title>layer72_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="817.5,-15389.33 645.5,-15389.33 645.5,-15321.33 817.5,-15321.33 817.5,-15389.33"/>
<text text-anchor="middle" x="731.5" y="-15374.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="731.5" y="-15359.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="731.5" y="-15344.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="731.5" y="-15329.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer71_ffn_ar&#45;&gt;layer72_norm_6 -->
<g id="edge2326" class="edge">
<title>layer71_ffn_ar&#45;&gt;layer72_norm_6</title>
<path fill="none" stroke="black" d="M765.69,-15469.73C765.69,-15469.73 765.69,-15399.39 765.69,-15399.39"/>
<polygon fill="black" stroke="black" points="769.19,-15399.39 765.69,-15389.39 762.19,-15399.39 769.19,-15399.39"/>
</g>
<!-- layer72_norm_7 -->
<g id="node1822" class="node">
<title>layer72_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1027.5,-15389.33 855.5,-15389.33 855.5,-15321.33 1027.5,-15321.33 1027.5,-15389.33"/>
<text text-anchor="middle" x="941.5" y="-15374.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="941.5" y="-15359.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="941.5" y="-15344.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="941.5" y="-15329.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer71_ffn_ar&#45;&gt;layer72_norm_7 -->
<g id="edge2327" class="edge">
<title>layer71_ffn_ar&#45;&gt;layer72_norm_7</title>
<path fill="none" stroke="black" d="M906.31,-15470.13C906.31,-15470.13 906.31,-15399.56 906.31,-15399.56"/>
<polygon fill="black" stroke="black" points="909.81,-15399.56 906.31,-15389.56 902.81,-15399.56 909.81,-15399.56"/>
</g>
<!-- layer72_qkv_6 -->
<g id="node1823" class="node">
<title>layer72_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="818,-15249.33 637,-15249.33 637,-15181.33 818,-15181.33 818,-15249.33"/>
<text text-anchor="middle" x="727.5" y="-15234.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="727.5" y="-15219.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="727.5" y="-15204.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="727.5" y="-15189.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer72_norm_6&#45;&gt;layer72_qkv_6 -->
<g id="edge2328" class="edge">
<title>layer72_norm_6&#45;&gt;layer72_qkv_6</title>
<path fill="none" stroke="black" d="M731.5,-15321.08C731.5,-15321.08 731.5,-15259.71 731.5,-15259.71"/>
<polygon fill="black" stroke="black" points="735,-15259.71 731.5,-15249.71 728,-15259.71 735,-15259.71"/>
</g>
<!-- layer72_qkv_7 -->
<g id="node1824" class="node">
<title>layer72_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1035,-15249.33 854,-15249.33 854,-15181.33 1035,-15181.33 1035,-15249.33"/>
<text text-anchor="middle" x="944.5" y="-15234.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="944.5" y="-15219.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="944.5" y="-15204.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="944.5" y="-15189.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer72_norm_7&#45;&gt;layer72_qkv_7 -->
<g id="edge2329" class="edge">
<title>layer72_norm_7&#45;&gt;layer72_qkv_7</title>
<path fill="none" stroke="black" d="M941.5,-15321.08C941.5,-15321.08 941.5,-15259.71 941.5,-15259.71"/>
<polygon fill="black" stroke="black" points="945,-15259.71 941.5,-15249.71 938,-15259.71 945,-15259.71"/>
</g>
<!-- layer72_qkv_ar -->
<g id="node1825" class="node">
<title>layer72_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="835.5" cy="-15061.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="835.5" y="-15080.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="835.5" y="-15065.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="835.5" y="-15050.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="835.5" y="-15035.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer72_qkv_6&#45;&gt;layer72_qkv_ar -->
<g id="edge2330" class="edge">
<title>layer72_qkv_6&#45;&gt;layer72_qkv_ar</title>
<path fill="none" stroke="black" d="M762.76,-15181.13C762.76,-15181.13 762.76,-15111.07 762.76,-15111.07"/>
<polygon fill="black" stroke="black" points="766.26,-15111.07 762.76,-15101.07 759.26,-15111.07 766.26,-15111.07"/>
</g>
<!-- layer72_qkv_7&#45;&gt;layer72_qkv_ar -->
<g id="edge2331" class="edge">
<title>layer72_qkv_7&#45;&gt;layer72_qkv_ar</title>
<path fill="none" stroke="black" d="M908.74,-15181.13C908.74,-15181.13 908.74,-15110.79 908.74,-15110.79"/>
<polygon fill="black" stroke="black" points="912.24,-15110.79 908.74,-15100.79 905.24,-15110.79 912.24,-15110.79"/>
</g>
<!-- layer72_attn_6 -->
<g id="node1826" class="node">
<title>layer72_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="817.5,-14941.16 645.5,-14941.16 645.5,-14873.16 817.5,-14873.16 817.5,-14941.16"/>
<text text-anchor="middle" x="731.5" y="-14925.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="731.5" y="-14910.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="731.5" y="-14895.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="731.5" y="-14880.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer72_qkv_ar&#45;&gt;layer72_attn_6 -->
<g id="edge2332" class="edge">
<title>layer72_qkv_ar&#45;&gt;layer72_attn_6</title>
<path fill="none" stroke="black" d="M762.51,-15021.57C762.51,-15021.57 762.51,-14951.22 762.51,-14951.22"/>
<polygon fill="black" stroke="black" points="766.01,-14951.22 762.51,-14941.22 759.01,-14951.22 766.01,-14951.22"/>
</g>
<!-- layer72_attn_7 -->
<g id="node1827" class="node">
<title>layer72_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1025.5,-14941.16 853.5,-14941.16 853.5,-14873.16 1025.5,-14873.16 1025.5,-14941.16"/>
<text text-anchor="middle" x="939.5" y="-14925.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="939.5" y="-14910.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="939.5" y="-14895.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="939.5" y="-14880.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer72_qkv_ar&#45;&gt;layer72_attn_7 -->
<g id="edge2333" class="edge">
<title>layer72_qkv_ar&#45;&gt;layer72_attn_7</title>
<path fill="none" stroke="black" d="M908.49,-15021.57C908.49,-15021.57 908.49,-14951.22 908.49,-14951.22"/>
<polygon fill="black" stroke="black" points="911.99,-14951.22 908.49,-14941.22 904.99,-14951.22 911.99,-14951.22"/>
</g>
<!-- layer72_attn_out_6 -->
<g id="node1828" class="node">
<title>layer72_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="817.5,-14801.16 645.5,-14801.16 645.5,-14733.16 817.5,-14733.16 817.5,-14801.16"/>
<text text-anchor="middle" x="731.5" y="-14785.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="731.5" y="-14770.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="731.5" y="-14755.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="731.5" y="-14740.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer72_attn_6&#45;&gt;layer72_attn_out_6 -->
<g id="edge2334" class="edge">
<title>layer72_attn_6&#45;&gt;layer72_attn_out_6</title>
<path fill="none" stroke="black" d="M731.5,-14872.91C731.5,-14872.91 731.5,-14811.54 731.5,-14811.54"/>
<polygon fill="black" stroke="black" points="735,-14811.54 731.5,-14801.54 728,-14811.54 735,-14811.54"/>
</g>
<!-- layer72_attn_out_7 -->
<g id="node1829" class="node">
<title>layer72_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1025.5,-14801.16 853.5,-14801.16 853.5,-14733.16 1025.5,-14733.16 1025.5,-14801.16"/>
<text text-anchor="middle" x="939.5" y="-14785.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="939.5" y="-14770.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="939.5" y="-14755.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="939.5" y="-14740.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer72_attn_7&#45;&gt;layer72_attn_out_7 -->
<g id="edge2335" class="edge">
<title>layer72_attn_7&#45;&gt;layer72_attn_out_7</title>
<path fill="none" stroke="black" d="M939.5,-14872.91C939.5,-14872.91 939.5,-14811.54 939.5,-14811.54"/>
<polygon fill="black" stroke="black" points="943,-14811.54 939.5,-14801.54 936,-14811.54 943,-14811.54"/>
</g>
<!-- layer72_attn_ar -->
<g id="node1830" class="node">
<title>layer72_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="835.5" cy="-14613.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="835.5" y="-14631.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="835.5" y="-14616.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="835.5" y="-14601.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="835.5" y="-14586.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer72_attn_out_6&#45;&gt;layer72_attn_ar -->
<g id="edge2336" class="edge">
<title>layer72_attn_out_6&#45;&gt;layer72_attn_ar</title>
<path fill="none" stroke="black" d="M765.69,-14732.97C765.69,-14732.97 765.69,-14662.62 765.69,-14662.62"/>
<polygon fill="black" stroke="black" points="769.19,-14662.62 765.69,-14652.62 762.19,-14662.62 769.19,-14662.62"/>
</g>
<!-- layer72_attn_out_7&#45;&gt;layer72_attn_ar -->
<g id="edge2337" class="edge">
<title>layer72_attn_out_7&#45;&gt;layer72_attn_ar</title>
<path fill="none" stroke="black" d="M905.31,-14732.97C905.31,-14732.97 905.31,-14662.62 905.31,-14662.62"/>
<polygon fill="black" stroke="black" points="908.81,-14662.62 905.31,-14652.62 901.81,-14662.62 908.81,-14662.62"/>
</g>
<!-- layer72_ffn_norm_6 -->
<g id="node1831" class="node">
<title>layer72_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="813.5,-14493 641.5,-14493 641.5,-14425 813.5,-14425 813.5,-14493"/>
<text text-anchor="middle" x="727.5" y="-14477.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="727.5" y="-14462.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="727.5" y="-14447.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="727.5" y="-14432.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer72_attn_ar&#45;&gt;layer72_ffn_norm_6 -->
<g id="edge2338" class="edge">
<title>layer72_attn_ar&#45;&gt;layer72_ffn_norm_6</title>
<path fill="none" stroke="black" d="M763.69,-14574.2C763.69,-14574.2 763.69,-14503.14 763.69,-14503.14"/>
<polygon fill="black" stroke="black" points="767.19,-14503.14 763.69,-14493.14 760.19,-14503.14 767.19,-14503.14"/>
</g>
<!-- layer72_ffn_norm_7 -->
<g id="node1832" class="node">
<title>layer72_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1030.5,-14493 858.5,-14493 858.5,-14425 1030.5,-14425 1030.5,-14493"/>
<text text-anchor="middle" x="944.5" y="-14477.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="944.5" y="-14462.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="944.5" y="-14447.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="944.5" y="-14432.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer72_attn_ar&#45;&gt;layer72_ffn_norm_7 -->
<g id="edge2339" class="edge">
<title>layer72_attn_ar&#45;&gt;layer72_ffn_norm_7</title>
<path fill="none" stroke="black" d="M907.81,-14574.2C907.81,-14574.2 907.81,-14503.14 907.81,-14503.14"/>
<polygon fill="black" stroke="black" points="911.31,-14503.14 907.81,-14493.14 904.31,-14503.14 911.31,-14503.14"/>
</g>
<!-- layer72_ffn_gate_6 -->
<g id="node1833" class="node">
<title>layer72_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="818,-14353 637,-14353 637,-14285 818,-14285 818,-14353"/>
<text text-anchor="middle" x="727.5" y="-14337.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="727.5" y="-14322.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="727.5" y="-14307.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="727.5" y="-14292.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_ffn_norm_6&#45;&gt;layer72_ffn_gate_6 -->
<g id="edge2340" class="edge">
<title>layer72_ffn_norm_6&#45;&gt;layer72_ffn_gate_6</title>
<path fill="none" stroke="black" d="M727.5,-14424.75C727.5,-14424.75 727.5,-14363.38 727.5,-14363.38"/>
<polygon fill="black" stroke="black" points="731,-14363.38 727.5,-14353.38 724,-14363.38 731,-14363.38"/>
</g>
<!-- layer72_ffn_up_6 -->
<g id="node1835" class="node">
<title>layer72_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="601,-14353 420,-14353 420,-14285 601,-14285 601,-14353"/>
<text text-anchor="middle" x="510.5" y="-14337.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="510.5" y="-14322.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="510.5" y="-14307.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="510.5" y="-14292.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_ffn_norm_6&#45;&gt;layer72_ffn_up_6 -->
<g id="edge2342" class="edge">
<title>layer72_ffn_norm_6&#45;&gt;layer72_ffn_up_6</title>
<path fill="none" stroke="black" d="M641.31,-14458C601.86,-14458 563.76,-14458 563.76,-14458 563.76,-14458 563.76,-14363 563.76,-14363"/>
<polygon fill="black" stroke="black" points="567.26,-14363 563.76,-14353 560.26,-14363 567.26,-14363"/>
</g>
<!-- layer72_ffn_gate_7 -->
<g id="node1834" class="node">
<title>layer72_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1252,-14353 1071,-14353 1071,-14285 1252,-14285 1252,-14353"/>
<text text-anchor="middle" x="1161.5" y="-14337.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1161.5" y="-14322.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1161.5" y="-14307.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1161.5" y="-14292.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_ffn_norm_7&#45;&gt;layer72_ffn_gate_7 -->
<g id="edge2341" class="edge">
<title>layer72_ffn_norm_7&#45;&gt;layer72_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1030.56,-14458C1069.95,-14458 1108,-14458 1108,-14458 1108,-14458 1108,-14363 1108,-14363"/>
<polygon fill="black" stroke="black" points="1111.5,-14363 1108,-14353 1104.5,-14363 1111.5,-14363"/>
</g>
<!-- layer72_ffn_up_7 -->
<g id="node1836" class="node">
<title>layer72_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1035,-14353 854,-14353 854,-14285 1035,-14285 1035,-14353"/>
<text text-anchor="middle" x="944.5" y="-14337.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="944.5" y="-14322.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="944.5" y="-14307.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="944.5" y="-14292.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_ffn_norm_7&#45;&gt;layer72_ffn_up_7 -->
<g id="edge2343" class="edge">
<title>layer72_ffn_norm_7&#45;&gt;layer72_ffn_up_7</title>
<path fill="none" stroke="black" d="M944.5,-14424.75C944.5,-14424.75 944.5,-14363.38 944.5,-14363.38"/>
<polygon fill="black" stroke="black" points="948,-14363.38 944.5,-14353.38 941,-14363.38 948,-14363.38"/>
</g>
<!-- layer72_gate_ar -->
<g id="node1837" class="node">
<title>layer72_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1035.5" cy="-14164.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1035.5" y="-14183.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1035.5" y="-14168.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1035.5" y="-14153.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1035.5" y="-14138.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer72_ffn_gate_6&#45;&gt;layer72_gate_ar -->
<g id="edge2344" class="edge">
<title>layer72_ffn_gate_6&#45;&gt;layer72_gate_ar</title>
<path fill="none" stroke="black" d="M818.08,-14318C828.79,-14318 836,-14318 836,-14318 836,-14318 836,-14180 836,-14180 836,-14180 903.7,-14180 903.7,-14180"/>
<polygon fill="black" stroke="black" points="903.7,-14183.5 913.7,-14180 903.7,-14176.5 903.7,-14183.5"/>
</g>
<!-- layer72_ffn_gate_7&#45;&gt;layer72_gate_ar -->
<g id="edge2345" class="edge">
<title>layer72_ffn_gate_7&#45;&gt;layer72_gate_ar</title>
<path fill="none" stroke="black" d="M1117.24,-14284.8C1117.24,-14284.8 1117.24,-14211.98 1117.24,-14211.98"/>
<polygon fill="black" stroke="black" points="1120.74,-14211.98 1117.24,-14201.98 1113.74,-14211.98 1120.74,-14211.98"/>
</g>
<!-- layer72_up_ar -->
<g id="node1838" class="node">
<title>layer72_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="689.5" cy="-14164.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="689.5" y="-14183.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="689.5" y="-14168.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="689.5" y="-14153.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="689.5" y="-14138.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer72_ffn_up_6&#45;&gt;layer72_up_ar -->
<g id="edge2346" class="edge">
<title>layer72_ffn_up_6&#45;&gt;layer72_up_ar</title>
<path fill="none" stroke="black" d="M581.26,-14284.8C581.26,-14284.8 581.26,-14200.88 581.26,-14200.88"/>
<polygon fill="black" stroke="black" points="584.76,-14200.88 581.26,-14190.88 577.76,-14200.88 584.76,-14200.88"/>
</g>
<!-- layer72_ffn_up_7&#45;&gt;layer72_up_ar -->
<g id="edge2347" class="edge">
<title>layer72_ffn_up_7&#45;&gt;layer72_up_ar</title>
<path fill="none" stroke="black" d="M880.76,-14284.8C880.76,-14234.9 880.76,-14148 880.76,-14148 880.76,-14148 819.54,-14148 819.54,-14148"/>
<polygon fill="black" stroke="black" points="819.54,-14144.5 809.54,-14148 819.54,-14151.5 819.54,-14144.5"/>
</g>
<!-- layer72_silu_6 -->
<g id="node1839" class="node">
<title>layer72_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="963,-14044.83 782,-14044.83 782,-13976.83 963,-13976.83 963,-14044.83"/>
<text text-anchor="middle" x="872.5" y="-14029.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="872.5" y="-14014.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="872.5" y="-13999.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="872.5" y="-13984.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_gate_ar&#45;&gt;layer72_silu_6 -->
<g id="edge2348" class="edge">
<title>layer72_gate_ar&#45;&gt;layer72_silu_6</title>
<path fill="none" stroke="black" d="M935.26,-14134.84C935.26,-14134.84 935.26,-14054.85 935.26,-14054.85"/>
<polygon fill="black" stroke="black" points="938.76,-14054.85 935.26,-14044.85 931.76,-14054.85 938.76,-14054.85"/>
</g>
<!-- layer72_silu_7 -->
<g id="node1840" class="node">
<title>layer72_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1180,-14044.83 999,-14044.83 999,-13976.83 1180,-13976.83 1180,-14044.83"/>
<text text-anchor="middle" x="1089.5" y="-14029.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1089.5" y="-14014.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1089.5" y="-13999.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1089.5" y="-13984.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_gate_ar&#45;&gt;layer72_silu_7 -->
<g id="edge2349" class="edge">
<title>layer72_gate_ar&#45;&gt;layer72_silu_7</title>
<path fill="none" stroke="black" d="M1081.24,-14119.93C1081.24,-14119.93 1081.24,-14054.84 1081.24,-14054.84"/>
<polygon fill="black" stroke="black" points="1084.74,-14054.84 1081.24,-14044.84 1077.74,-14054.84 1084.74,-14054.84"/>
</g>
<!-- layer72_mul_6 -->
<g id="node1841" class="node">
<title>layer72_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="853,-13904.83 672,-13904.83 672,-13836.83 853,-13836.83 853,-13904.83"/>
<text text-anchor="middle" x="762.5" y="-13889.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="762.5" y="-13874.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="762.5" y="-13859.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="762.5" y="-13844.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_up_ar&#45;&gt;layer72_mul_6 -->
<g id="edge2351" class="edge">
<title>layer72_up_ar&#45;&gt;layer72_mul_6</title>
<path fill="none" stroke="black" d="M727,-14118.64C727,-14118.64 727,-13914.91 727,-13914.91"/>
<polygon fill="black" stroke="black" points="730.5,-13914.91 727,-13904.91 723.5,-13914.91 730.5,-13914.91"/>
</g>
<!-- layer72_mul_7 -->
<g id="node1842" class="node">
<title>layer72_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1070,-13904.83 889,-13904.83 889,-13836.83 1070,-13836.83 1070,-13904.83"/>
<text text-anchor="middle" x="979.5" y="-13889.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="979.5" y="-13874.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="979.5" y="-13859.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="979.5" y="-13844.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer72_up_ar&#45;&gt;layer72_mul_7 -->
<g id="edge2353" class="edge">
<title>layer72_up_ar&#45;&gt;layer72_mul_7</title>
<path fill="none" stroke="black" d="M799.74,-14140.35C799.74,-14115.27 799.74,-14080 799.74,-14080 799.74,-14080 981,-14080 981,-14080 981,-14080 981,-13914.9 981,-13914.9"/>
<polygon fill="black" stroke="black" points="984.5,-13914.9 981,-13904.9 977.5,-13914.9 984.5,-13914.9"/>
</g>
<!-- layer72_silu_6&#45;&gt;layer72_mul_6 -->
<g id="edge2350" class="edge">
<title>layer72_silu_6&#45;&gt;layer72_mul_6</title>
<path fill="none" stroke="black" d="M817.5,-13976.58C817.5,-13976.58 817.5,-13915.21 817.5,-13915.21"/>
<polygon fill="black" stroke="black" points="821,-13915.21 817.5,-13905.21 814,-13915.21 821,-13915.21"/>
</g>
<!-- layer72_silu_7&#45;&gt;layer72_mul_7 -->
<g id="edge2352" class="edge">
<title>layer72_silu_7&#45;&gt;layer72_mul_7</title>
<path fill="none" stroke="black" d="M1034.5,-13976.58C1034.5,-13976.58 1034.5,-13915.21 1034.5,-13915.21"/>
<polygon fill="black" stroke="black" points="1038,-13915.21 1034.5,-13905.21 1031,-13915.21 1038,-13915.21"/>
</g>
<!-- layer72_ffn_down_6 -->
<g id="node1843" class="node">
<title>layer72_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="852.5,-13764.83 680.5,-13764.83 680.5,-13696.83 852.5,-13696.83 852.5,-13764.83"/>
<text text-anchor="middle" x="766.5" y="-13749.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="766.5" y="-13734.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="766.5" y="-13719.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="766.5" y="-13704.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer72_mul_6&#45;&gt;layer72_ffn_down_6 -->
<g id="edge2354" class="edge">
<title>layer72_mul_6&#45;&gt;layer72_ffn_down_6</title>
<path fill="none" stroke="black" d="M766.5,-13836.58C766.5,-13836.58 766.5,-13775.21 766.5,-13775.21"/>
<polygon fill="black" stroke="black" points="770,-13775.21 766.5,-13765.21 763,-13775.21 770,-13775.21"/>
</g>
<!-- layer72_ffn_down_7 -->
<g id="node1844" class="node">
<title>layer72_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1062.5,-13764.83 890.5,-13764.83 890.5,-13696.83 1062.5,-13696.83 1062.5,-13764.83"/>
<text text-anchor="middle" x="976.5" y="-13749.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="976.5" y="-13734.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="976.5" y="-13719.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="976.5" y="-13704.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer72_mul_7&#45;&gt;layer72_ffn_down_7 -->
<g id="edge2355" class="edge">
<title>layer72_mul_7&#45;&gt;layer72_ffn_down_7</title>
<path fill="none" stroke="black" d="M976.5,-13836.58C976.5,-13836.58 976.5,-13775.21 976.5,-13775.21"/>
<polygon fill="black" stroke="black" points="980,-13775.21 976.5,-13765.21 973,-13775.21 980,-13775.21"/>
</g>
<!-- layer72_ffn_ar -->
<g id="node1845" class="node">
<title>layer72_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="870.5" cy="-13576.75" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="870.5" y="-13595.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="870.5" y="-13580.55" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="870.5" y="-13565.55" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="870.5" y="-13550.55" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer72_ffn_down_6&#45;&gt;layer72_ffn_ar -->
<g id="edge2356" class="edge">
<title>layer72_ffn_down_6&#45;&gt;layer72_ffn_ar</title>
<path fill="none" stroke="black" d="M800.69,-13696.63C800.69,-13696.63 800.69,-13626.29 800.69,-13626.29"/>
<polygon fill="black" stroke="black" points="804.19,-13626.29 800.69,-13616.29 797.19,-13626.29 804.19,-13626.29"/>
</g>
<!-- layer72_ffn_down_7&#45;&gt;layer72_ffn_ar -->
<g id="edge2357" class="edge">
<title>layer72_ffn_down_7&#45;&gt;layer72_ffn_ar</title>
<path fill="none" stroke="black" d="M941.31,-13696.63C941.31,-13696.63 941.31,-13626.01 941.31,-13626.01"/>
<polygon fill="black" stroke="black" points="944.81,-13626.01 941.31,-13616.01 937.81,-13626.01 944.81,-13626.01"/>
</g>
<!-- layer73_norm_6 -->
<g id="node1846" class="node">
<title>layer73_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="852.5,-13456.66 680.5,-13456.66 680.5,-13388.66 852.5,-13388.66 852.5,-13456.66"/>
<text text-anchor="middle" x="766.5" y="-13441.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="766.5" y="-13426.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="766.5" y="-13411.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="766.5" y="-13396.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer72_ffn_ar&#45;&gt;layer73_norm_6 -->
<g id="edge2358" class="edge">
<title>layer72_ffn_ar&#45;&gt;layer73_norm_6</title>
<path fill="none" stroke="black" d="M800.69,-13537.07C800.69,-13537.07 800.69,-13466.72 800.69,-13466.72"/>
<polygon fill="black" stroke="black" points="804.19,-13466.72 800.69,-13456.72 797.19,-13466.72 804.19,-13466.72"/>
</g>
<!-- layer73_norm_7 -->
<g id="node1847" class="node">
<title>layer73_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1062.5,-13456.66 890.5,-13456.66 890.5,-13388.66 1062.5,-13388.66 1062.5,-13456.66"/>
<text text-anchor="middle" x="976.5" y="-13441.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="976.5" y="-13426.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="976.5" y="-13411.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="976.5" y="-13396.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer72_ffn_ar&#45;&gt;layer73_norm_7 -->
<g id="edge2359" class="edge">
<title>layer72_ffn_ar&#45;&gt;layer73_norm_7</title>
<path fill="none" stroke="black" d="M941.31,-13537.47C941.31,-13537.47 941.31,-13466.89 941.31,-13466.89"/>
<polygon fill="black" stroke="black" points="944.81,-13466.89 941.31,-13456.89 937.81,-13466.89 944.81,-13466.89"/>
</g>
<!-- layer73_qkv_6 -->
<g id="node1848" class="node">
<title>layer73_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="853,-13316.66 672,-13316.66 672,-13248.66 853,-13248.66 853,-13316.66"/>
<text text-anchor="middle" x="762.5" y="-13301.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="762.5" y="-13286.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="762.5" y="-13271.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="762.5" y="-13256.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer73_norm_6&#45;&gt;layer73_qkv_6 -->
<g id="edge2360" class="edge">
<title>layer73_norm_6&#45;&gt;layer73_qkv_6</title>
<path fill="none" stroke="black" d="M766.5,-13388.41C766.5,-13388.41 766.5,-13327.04 766.5,-13327.04"/>
<polygon fill="black" stroke="black" points="770,-13327.04 766.5,-13317.04 763,-13327.04 770,-13327.04"/>
</g>
<!-- layer73_qkv_7 -->
<g id="node1849" class="node">
<title>layer73_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1070,-13316.66 889,-13316.66 889,-13248.66 1070,-13248.66 1070,-13316.66"/>
<text text-anchor="middle" x="979.5" y="-13301.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="979.5" y="-13286.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="979.5" y="-13271.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="979.5" y="-13256.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer73_norm_7&#45;&gt;layer73_qkv_7 -->
<g id="edge2361" class="edge">
<title>layer73_norm_7&#45;&gt;layer73_qkv_7</title>
<path fill="none" stroke="black" d="M976.5,-13388.41C976.5,-13388.41 976.5,-13327.04 976.5,-13327.04"/>
<polygon fill="black" stroke="black" points="980,-13327.04 976.5,-13317.04 973,-13327.04 980,-13327.04"/>
</g>
<!-- layer73_qkv_ar -->
<g id="node1850" class="node">
<title>layer73_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="870.5" cy="-13128.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="870.5" y="-13147.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="870.5" y="-13132.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="870.5" y="-13117.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="870.5" y="-13102.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer73_qkv_6&#45;&gt;layer73_qkv_ar -->
<g id="edge2362" class="edge">
<title>layer73_qkv_6&#45;&gt;layer73_qkv_ar</title>
<path fill="none" stroke="black" d="M797.76,-13248.47C797.76,-13248.47 797.76,-13178.4 797.76,-13178.4"/>
<polygon fill="black" stroke="black" points="801.26,-13178.4 797.76,-13168.4 794.26,-13178.4 801.26,-13178.4"/>
</g>
<!-- layer73_qkv_7&#45;&gt;layer73_qkv_ar -->
<g id="edge2363" class="edge">
<title>layer73_qkv_7&#45;&gt;layer73_qkv_ar</title>
<path fill="none" stroke="black" d="M943.74,-13248.47C943.74,-13248.47 943.74,-13178.12 943.74,-13178.12"/>
<polygon fill="black" stroke="black" points="947.24,-13178.12 943.74,-13168.12 940.24,-13178.12 947.24,-13178.12"/>
</g>
<!-- layer73_attn_6 -->
<g id="node1851" class="node">
<title>layer73_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="852.5,-13008.5 680.5,-13008.5 680.5,-12940.5 852.5,-12940.5 852.5,-13008.5"/>
<text text-anchor="middle" x="766.5" y="-12993.3" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="766.5" y="-12978.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="766.5" y="-12963.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="766.5" y="-12948.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer73_qkv_ar&#45;&gt;layer73_attn_6 -->
<g id="edge2364" class="edge">
<title>layer73_qkv_ar&#45;&gt;layer73_attn_6</title>
<path fill="none" stroke="black" d="M797.51,-13088.9C797.51,-13088.9 797.51,-13018.55 797.51,-13018.55"/>
<polygon fill="black" stroke="black" points="801.01,-13018.55 797.51,-13008.55 794.01,-13018.55 801.01,-13018.55"/>
</g>
<!-- layer73_attn_7 -->
<g id="node1852" class="node">
<title>layer73_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1060.5,-13008.5 888.5,-13008.5 888.5,-12940.5 1060.5,-12940.5 1060.5,-13008.5"/>
<text text-anchor="middle" x="974.5" y="-12993.3" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="974.5" y="-12978.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="974.5" y="-12963.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="974.5" y="-12948.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer73_qkv_ar&#45;&gt;layer73_attn_7 -->
<g id="edge2365" class="edge">
<title>layer73_qkv_ar&#45;&gt;layer73_attn_7</title>
<path fill="none" stroke="black" d="M943.49,-13088.9C943.49,-13088.9 943.49,-13018.55 943.49,-13018.55"/>
<polygon fill="black" stroke="black" points="946.99,-13018.55 943.49,-13008.55 939.99,-13018.55 946.99,-13018.55"/>
</g>
<!-- layer73_attn_out_6 -->
<g id="node1853" class="node">
<title>layer73_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="852.5,-12868.5 680.5,-12868.5 680.5,-12800.5 852.5,-12800.5 852.5,-12868.5"/>
<text text-anchor="middle" x="766.5" y="-12853.3" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="766.5" y="-12838.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="766.5" y="-12823.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="766.5" y="-12808.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer73_attn_6&#45;&gt;layer73_attn_out_6 -->
<g id="edge2366" class="edge">
<title>layer73_attn_6&#45;&gt;layer73_attn_out_6</title>
<path fill="none" stroke="black" d="M766.5,-12940.25C766.5,-12940.25 766.5,-12878.88 766.5,-12878.88"/>
<polygon fill="black" stroke="black" points="770,-12878.88 766.5,-12868.88 763,-12878.88 770,-12878.88"/>
</g>
<!-- layer73_attn_out_7 -->
<g id="node1854" class="node">
<title>layer73_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1060.5,-12868.5 888.5,-12868.5 888.5,-12800.5 1060.5,-12800.5 1060.5,-12868.5"/>
<text text-anchor="middle" x="974.5" y="-12853.3" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="974.5" y="-12838.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="974.5" y="-12823.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="974.5" y="-12808.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer73_attn_7&#45;&gt;layer73_attn_out_7 -->
<g id="edge2367" class="edge">
<title>layer73_attn_7&#45;&gt;layer73_attn_out_7</title>
<path fill="none" stroke="black" d="M974.5,-12940.25C974.5,-12940.25 974.5,-12878.88 974.5,-12878.88"/>
<polygon fill="black" stroke="black" points="978,-12878.88 974.5,-12868.88 971,-12878.88 978,-12878.88"/>
</g>
<!-- layer73_attn_ar -->
<g id="node1855" class="node">
<title>layer73_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="870.5" cy="-12680.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="870.5" y="-12699.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="870.5" y="-12684.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="870.5" y="-12669.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="870.5" y="-12654.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer73_attn_out_6&#45;&gt;layer73_attn_ar -->
<g id="edge2368" class="edge">
<title>layer73_attn_out_6&#45;&gt;layer73_attn_ar</title>
<path fill="none" stroke="black" d="M800.69,-12800.3C800.69,-12800.3 800.69,-12729.96 800.69,-12729.96"/>
<polygon fill="black" stroke="black" points="804.19,-12729.96 800.69,-12719.96 797.19,-12729.96 804.19,-12729.96"/>
</g>
<!-- layer73_attn_out_7&#45;&gt;layer73_attn_ar -->
<g id="edge2369" class="edge">
<title>layer73_attn_out_7&#45;&gt;layer73_attn_ar</title>
<path fill="none" stroke="black" d="M940.31,-12800.3C940.31,-12800.3 940.31,-12729.96 940.31,-12729.96"/>
<polygon fill="black" stroke="black" points="943.81,-12729.96 940.31,-12719.96 936.81,-12729.96 943.81,-12729.96"/>
</g>
<!-- layer73_ffn_norm_6 -->
<g id="node1856" class="node">
<title>layer73_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="848.5,-12560.33 676.5,-12560.33 676.5,-12492.33 848.5,-12492.33 848.5,-12560.33"/>
<text text-anchor="middle" x="762.5" y="-12545.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="762.5" y="-12530.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="762.5" y="-12515.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="762.5" y="-12500.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer73_attn_ar&#45;&gt;layer73_ffn_norm_6 -->
<g id="edge2370" class="edge">
<title>layer73_attn_ar&#45;&gt;layer73_ffn_norm_6</title>
<path fill="none" stroke="black" d="M798.69,-12641.53C798.69,-12641.53 798.69,-12570.48 798.69,-12570.48"/>
<polygon fill="black" stroke="black" points="802.19,-12570.48 798.69,-12560.48 795.19,-12570.48 802.19,-12570.48"/>
</g>
<!-- layer73_ffn_norm_7 -->
<g id="node1857" class="node">
<title>layer73_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1065.5,-12560.33 893.5,-12560.33 893.5,-12492.33 1065.5,-12492.33 1065.5,-12560.33"/>
<text text-anchor="middle" x="979.5" y="-12545.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="979.5" y="-12530.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="979.5" y="-12515.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="979.5" y="-12500.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer73_attn_ar&#45;&gt;layer73_ffn_norm_7 -->
<g id="edge2371" class="edge">
<title>layer73_attn_ar&#45;&gt;layer73_ffn_norm_7</title>
<path fill="none" stroke="black" d="M942.81,-12641.53C942.81,-12641.53 942.81,-12570.48 942.81,-12570.48"/>
<polygon fill="black" stroke="black" points="946.31,-12570.48 942.81,-12560.48 939.31,-12570.48 946.31,-12570.48"/>
</g>
<!-- layer73_ffn_gate_6 -->
<g id="node1858" class="node">
<title>layer73_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="853,-12420.33 672,-12420.33 672,-12352.33 853,-12352.33 853,-12420.33"/>
<text text-anchor="middle" x="762.5" y="-12405.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="762.5" y="-12390.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="762.5" y="-12375.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="762.5" y="-12360.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_ffn_norm_6&#45;&gt;layer73_ffn_gate_6 -->
<g id="edge2372" class="edge">
<title>layer73_ffn_norm_6&#45;&gt;layer73_ffn_gate_6</title>
<path fill="none" stroke="black" d="M762.5,-12492.08C762.5,-12492.08 762.5,-12430.71 762.5,-12430.71"/>
<polygon fill="black" stroke="black" points="766,-12430.71 762.5,-12420.71 759,-12430.71 766,-12430.71"/>
</g>
<!-- layer73_ffn_up_6 -->
<g id="node1860" class="node">
<title>layer73_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="636,-12420.33 455,-12420.33 455,-12352.33 636,-12352.33 636,-12420.33"/>
<text text-anchor="middle" x="545.5" y="-12405.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="545.5" y="-12390.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="545.5" y="-12375.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="545.5" y="-12360.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_ffn_norm_6&#45;&gt;layer73_ffn_up_6 -->
<g id="edge2374" class="edge">
<title>layer73_ffn_norm_6&#45;&gt;layer73_ffn_up_6</title>
<path fill="none" stroke="black" d="M676.31,-12526C636.86,-12526 598.76,-12526 598.76,-12526 598.76,-12526 598.76,-12430.5 598.76,-12430.5"/>
<polygon fill="black" stroke="black" points="602.26,-12430.5 598.76,-12420.5 595.26,-12430.5 602.26,-12430.5"/>
</g>
<!-- layer73_ffn_gate_7 -->
<g id="node1859" class="node">
<title>layer73_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1287,-12420.33 1106,-12420.33 1106,-12352.33 1287,-12352.33 1287,-12420.33"/>
<text text-anchor="middle" x="1196.5" y="-12405.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1196.5" y="-12390.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1196.5" y="-12375.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1196.5" y="-12360.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_ffn_norm_7&#45;&gt;layer73_ffn_gate_7 -->
<g id="edge2373" class="edge">
<title>layer73_ffn_norm_7&#45;&gt;layer73_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1065.56,-12526C1104.95,-12526 1143,-12526 1143,-12526 1143,-12526 1143,-12430.5 1143,-12430.5"/>
<polygon fill="black" stroke="black" points="1146.5,-12430.5 1143,-12420.5 1139.5,-12430.5 1146.5,-12430.5"/>
</g>
<!-- layer73_ffn_up_7 -->
<g id="node1861" class="node">
<title>layer73_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1070,-12420.33 889,-12420.33 889,-12352.33 1070,-12352.33 1070,-12420.33"/>
<text text-anchor="middle" x="979.5" y="-12405.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="979.5" y="-12390.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="979.5" y="-12375.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="979.5" y="-12360.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_ffn_norm_7&#45;&gt;layer73_ffn_up_7 -->
<g id="edge2375" class="edge">
<title>layer73_ffn_norm_7&#45;&gt;layer73_ffn_up_7</title>
<path fill="none" stroke="black" d="M979.5,-12492.08C979.5,-12492.08 979.5,-12430.71 979.5,-12430.71"/>
<polygon fill="black" stroke="black" points="983,-12430.71 979.5,-12420.71 976,-12430.71 983,-12430.71"/>
</g>
<!-- layer73_gate_ar -->
<g id="node1862" class="node">
<title>layer73_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1070.5" cy="-12232.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1070.5" y="-12251.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1070.5" y="-12236.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1070.5" y="-12221.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1070.5" y="-12206.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer73_ffn_gate_6&#45;&gt;layer73_gate_ar -->
<g id="edge2376" class="edge">
<title>layer73_ffn_gate_6&#45;&gt;layer73_gate_ar</title>
<path fill="none" stroke="black" d="M853.08,-12386C863.79,-12386 871,-12386 871,-12386 871,-12386 871,-12248 871,-12248 871,-12248 939.56,-12248 939.56,-12248"/>
<polygon fill="black" stroke="black" points="939.56,-12251.5 949.56,-12248 939.56,-12244.5 939.56,-12251.5"/>
</g>
<!-- layer73_ffn_gate_7&#45;&gt;layer73_gate_ar -->
<g id="edge2377" class="edge">
<title>layer73_ffn_gate_7&#45;&gt;layer73_gate_ar</title>
<path fill="none" stroke="black" d="M1152.24,-12352.13C1152.24,-12352.13 1152.24,-12279.31 1152.24,-12279.31"/>
<polygon fill="black" stroke="black" points="1155.74,-12279.31 1152.24,-12269.31 1148.74,-12279.31 1155.74,-12279.31"/>
</g>
<!-- layer73_up_ar -->
<g id="node1863" class="node">
<title>layer73_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="724.5" cy="-12232.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="724.5" y="-12251.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="724.5" y="-12236.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="724.5" y="-12221.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="724.5" y="-12206.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer73_ffn_up_6&#45;&gt;layer73_up_ar -->
<g id="edge2378" class="edge">
<title>layer73_ffn_up_6&#45;&gt;layer73_up_ar</title>
<path fill="none" stroke="black" d="M616.26,-12352.13C616.26,-12352.13 616.26,-12268.21 616.26,-12268.21"/>
<polygon fill="black" stroke="black" points="619.76,-12268.21 616.26,-12258.21 612.76,-12268.21 619.76,-12268.21"/>
</g>
<!-- layer73_ffn_up_7&#45;&gt;layer73_up_ar -->
<g id="edge2379" class="edge">
<title>layer73_ffn_up_7&#45;&gt;layer73_up_ar</title>
<path fill="none" stroke="black" d="M915.76,-12352.27C915.76,-12302.56 915.76,-12216 915.76,-12216 915.76,-12216 855.08,-12216 855.08,-12216"/>
<polygon fill="black" stroke="black" points="855.08,-12212.5 845.08,-12216 855.08,-12219.5 855.08,-12212.5"/>
</g>
<!-- layer73_silu_6 -->
<g id="node1864" class="node">
<title>layer73_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="998,-12112.16 817,-12112.16 817,-12044.16 998,-12044.16 998,-12112.16"/>
<text text-anchor="middle" x="907.5" y="-12096.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="907.5" y="-12081.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="907.5" y="-12066.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="907.5" y="-12051.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_gate_ar&#45;&gt;layer73_silu_6 -->
<g id="edge2380" class="edge">
<title>layer73_gate_ar&#45;&gt;layer73_silu_6</title>
<path fill="none" stroke="black" d="M970.26,-12202.17C970.26,-12202.17 970.26,-12122.19 970.26,-12122.19"/>
<polygon fill="black" stroke="black" points="973.76,-12122.19 970.26,-12112.19 966.76,-12122.19 973.76,-12122.19"/>
</g>
<!-- layer73_silu_7 -->
<g id="node1865" class="node">
<title>layer73_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1215,-12112.16 1034,-12112.16 1034,-12044.16 1215,-12044.16 1215,-12112.16"/>
<text text-anchor="middle" x="1124.5" y="-12096.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1124.5" y="-12081.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1124.5" y="-12066.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1124.5" y="-12051.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_gate_ar&#45;&gt;layer73_silu_7 -->
<g id="edge2381" class="edge">
<title>layer73_gate_ar&#45;&gt;layer73_silu_7</title>
<path fill="none" stroke="black" d="M1116.24,-12187.26C1116.24,-12187.26 1116.24,-12122.17 1116.24,-12122.17"/>
<polygon fill="black" stroke="black" points="1119.74,-12122.17 1116.24,-12112.17 1112.74,-12122.17 1119.74,-12122.17"/>
</g>
<!-- layer73_mul_6 -->
<g id="node1866" class="node">
<title>layer73_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="888,-11972.16 707,-11972.16 707,-11904.16 888,-11904.16 888,-11972.16"/>
<text text-anchor="middle" x="797.5" y="-11956.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="797.5" y="-11941.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="797.5" y="-11926.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="797.5" y="-11911.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_up_ar&#45;&gt;layer73_mul_6 -->
<g id="edge2383" class="edge">
<title>layer73_up_ar&#45;&gt;layer73_mul_6</title>
<path fill="none" stroke="black" d="M762,-12185.97C762,-12185.97 762,-11982.25 762,-11982.25"/>
<polygon fill="black" stroke="black" points="765.5,-11982.25 762,-11972.25 758.5,-11982.25 765.5,-11982.25"/>
</g>
<!-- layer73_mul_7 -->
<g id="node1867" class="node">
<title>layer73_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1105,-11972.16 924,-11972.16 924,-11904.16 1105,-11904.16 1105,-11972.16"/>
<text text-anchor="middle" x="1014.5" y="-11956.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1014.5" y="-11941.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1014.5" y="-11926.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1014.5" y="-11911.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer73_up_ar&#45;&gt;layer73_mul_7 -->
<g id="edge2385" class="edge">
<title>layer73_up_ar&#45;&gt;layer73_mul_7</title>
<path fill="none" stroke="black" d="M834.74,-12207.43C834.74,-12182.57 834.74,-12148 834.74,-12148 834.74,-12148 1016,-12148 1016,-12148 1016,-12148 1016,-11982.34 1016,-11982.34"/>
<polygon fill="black" stroke="black" points="1019.5,-11982.34 1016,-11972.34 1012.5,-11982.34 1019.5,-11982.34"/>
</g>
<!-- layer73_silu_6&#45;&gt;layer73_mul_6 -->
<g id="edge2382" class="edge">
<title>layer73_silu_6&#45;&gt;layer73_mul_6</title>
<path fill="none" stroke="black" d="M852.5,-12043.92C852.5,-12043.92 852.5,-11982.54 852.5,-11982.54"/>
<polygon fill="black" stroke="black" points="856,-11982.54 852.5,-11972.54 849,-11982.54 856,-11982.54"/>
</g>
<!-- layer73_silu_7&#45;&gt;layer73_mul_7 -->
<g id="edge2384" class="edge">
<title>layer73_silu_7&#45;&gt;layer73_mul_7</title>
<path fill="none" stroke="black" d="M1069.5,-12043.92C1069.5,-12043.92 1069.5,-11982.54 1069.5,-11982.54"/>
<polygon fill="black" stroke="black" points="1073,-11982.54 1069.5,-11972.54 1066,-11982.54 1073,-11982.54"/>
</g>
<!-- layer73_ffn_down_6 -->
<g id="node1868" class="node">
<title>layer73_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="887.5,-11832.16 715.5,-11832.16 715.5,-11764.16 887.5,-11764.16 887.5,-11832.16"/>
<text text-anchor="middle" x="801.5" y="-11816.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="801.5" y="-11801.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="801.5" y="-11786.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="801.5" y="-11771.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer73_mul_6&#45;&gt;layer73_ffn_down_6 -->
<g id="edge2386" class="edge">
<title>layer73_mul_6&#45;&gt;layer73_ffn_down_6</title>
<path fill="none" stroke="black" d="M801.5,-11903.92C801.5,-11903.92 801.5,-11842.54 801.5,-11842.54"/>
<polygon fill="black" stroke="black" points="805,-11842.54 801.5,-11832.54 798,-11842.54 805,-11842.54"/>
</g>
<!-- layer73_ffn_down_7 -->
<g id="node1869" class="node">
<title>layer73_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1097.5,-11832.16 925.5,-11832.16 925.5,-11764.16 1097.5,-11764.16 1097.5,-11832.16"/>
<text text-anchor="middle" x="1011.5" y="-11816.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1011.5" y="-11801.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1011.5" y="-11786.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1011.5" y="-11771.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer73_mul_7&#45;&gt;layer73_ffn_down_7 -->
<g id="edge2387" class="edge">
<title>layer73_mul_7&#45;&gt;layer73_ffn_down_7</title>
<path fill="none" stroke="black" d="M1011.5,-11903.92C1011.5,-11903.92 1011.5,-11842.54 1011.5,-11842.54"/>
<polygon fill="black" stroke="black" points="1015,-11842.54 1011.5,-11832.54 1008,-11842.54 1015,-11842.54"/>
</g>
<!-- layer73_ffn_ar -->
<g id="node1870" class="node">
<title>layer73_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="905.5" cy="-11644.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="905.5" y="-11662.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="905.5" y="-11647.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="905.5" y="-11632.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="905.5" y="-11617.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer73_ffn_down_6&#45;&gt;layer73_ffn_ar -->
<g id="edge2388" class="edge">
<title>layer73_ffn_down_6&#45;&gt;layer73_ffn_ar</title>
<path fill="none" stroke="black" d="M835.69,-11763.97C835.69,-11763.97 835.69,-11693.62 835.69,-11693.62"/>
<polygon fill="black" stroke="black" points="839.19,-11693.62 835.69,-11683.62 832.19,-11693.62 839.19,-11693.62"/>
</g>
<!-- layer73_ffn_down_7&#45;&gt;layer73_ffn_ar -->
<g id="edge2389" class="edge">
<title>layer73_ffn_down_7&#45;&gt;layer73_ffn_ar</title>
<path fill="none" stroke="black" d="M976.31,-11763.97C976.31,-11763.97 976.31,-11693.34 976.31,-11693.34"/>
<polygon fill="black" stroke="black" points="979.81,-11693.34 976.31,-11683.34 972.81,-11693.34 979.81,-11693.34"/>
</g>
<!-- layer74_norm_6 -->
<g id="node1871" class="node">
<title>layer74_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="887.5,-11524 715.5,-11524 715.5,-11456 887.5,-11456 887.5,-11524"/>
<text text-anchor="middle" x="801.5" y="-11508.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="801.5" y="-11493.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="801.5" y="-11478.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="801.5" y="-11463.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer73_ffn_ar&#45;&gt;layer74_norm_6 -->
<g id="edge2390" class="edge">
<title>layer73_ffn_ar&#45;&gt;layer74_norm_6</title>
<path fill="none" stroke="black" d="M835.69,-11604.4C835.69,-11604.4 835.69,-11534.05 835.69,-11534.05"/>
<polygon fill="black" stroke="black" points="839.19,-11534.05 835.69,-11524.05 832.19,-11534.05 839.19,-11534.05"/>
</g>
<!-- layer74_norm_7 -->
<g id="node1872" class="node">
<title>layer74_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1097.5,-11524 925.5,-11524 925.5,-11456 1097.5,-11456 1097.5,-11524"/>
<text text-anchor="middle" x="1011.5" y="-11508.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1011.5" y="-11493.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1011.5" y="-11478.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1011.5" y="-11463.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer73_ffn_ar&#45;&gt;layer74_norm_7 -->
<g id="edge2391" class="edge">
<title>layer73_ffn_ar&#45;&gt;layer74_norm_7</title>
<path fill="none" stroke="black" d="M976.31,-11604.8C976.31,-11604.8 976.31,-11534.23 976.31,-11534.23"/>
<polygon fill="black" stroke="black" points="979.81,-11534.23 976.31,-11524.23 972.81,-11534.23 979.81,-11534.23"/>
</g>
<!-- layer74_qkv_6 -->
<g id="node1873" class="node">
<title>layer74_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="888,-11384 707,-11384 707,-11316 888,-11316 888,-11384"/>
<text text-anchor="middle" x="797.5" y="-11368.8" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="797.5" y="-11353.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="797.5" y="-11338.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="797.5" y="-11323.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer74_norm_6&#45;&gt;layer74_qkv_6 -->
<g id="edge2392" class="edge">
<title>layer74_norm_6&#45;&gt;layer74_qkv_6</title>
<path fill="none" stroke="black" d="M801.5,-11455.75C801.5,-11455.75 801.5,-11394.38 801.5,-11394.38"/>
<polygon fill="black" stroke="black" points="805,-11394.38 801.5,-11384.38 798,-11394.38 805,-11394.38"/>
</g>
<!-- layer74_qkv_7 -->
<g id="node1874" class="node">
<title>layer74_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1105,-11384 924,-11384 924,-11316 1105,-11316 1105,-11384"/>
<text text-anchor="middle" x="1014.5" y="-11368.8" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1014.5" y="-11353.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1014.5" y="-11338.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1014.5" y="-11323.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer74_norm_7&#45;&gt;layer74_qkv_7 -->
<g id="edge2393" class="edge">
<title>layer74_norm_7&#45;&gt;layer74_qkv_7</title>
<path fill="none" stroke="black" d="M1011.5,-11455.75C1011.5,-11455.75 1011.5,-11394.38 1011.5,-11394.38"/>
<polygon fill="black" stroke="black" points="1015,-11394.38 1011.5,-11384.38 1008,-11394.38 1015,-11394.38"/>
</g>
<!-- layer74_qkv_ar -->
<g id="node1875" class="node">
<title>layer74_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="905.5" cy="-11195.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="905.5" y="-11214.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="905.5" y="-11199.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="905.5" y="-11184.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="905.5" y="-11169.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer74_qkv_6&#45;&gt;layer74_qkv_ar -->
<g id="edge2394" class="edge">
<title>layer74_qkv_6&#45;&gt;layer74_qkv_ar</title>
<path fill="none" stroke="black" d="M832.76,-11315.8C832.76,-11315.8 832.76,-11245.73 832.76,-11245.73"/>
<polygon fill="black" stroke="black" points="836.26,-11245.73 832.76,-11235.73 829.26,-11245.73 836.26,-11245.73"/>
</g>
<!-- layer74_qkv_7&#45;&gt;layer74_qkv_ar -->
<g id="edge2395" class="edge">
<title>layer74_qkv_7&#45;&gt;layer74_qkv_ar</title>
<path fill="none" stroke="black" d="M978.74,-11315.8C978.74,-11315.8 978.74,-11245.46 978.74,-11245.46"/>
<polygon fill="black" stroke="black" points="982.24,-11245.46 978.74,-11235.46 975.24,-11245.46 982.24,-11245.46"/>
</g>
<!-- layer74_attn_6 -->
<g id="node1876" class="node">
<title>layer74_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="887.5,-11075.83 715.5,-11075.83 715.5,-11007.83 887.5,-11007.83 887.5,-11075.83"/>
<text text-anchor="middle" x="801.5" y="-11060.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="801.5" y="-11045.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="801.5" y="-11030.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="801.5" y="-11015.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer74_qkv_ar&#45;&gt;layer74_attn_6 -->
<g id="edge2396" class="edge">
<title>layer74_qkv_ar&#45;&gt;layer74_attn_6</title>
<path fill="none" stroke="black" d="M832.51,-11156.23C832.51,-11156.23 832.51,-11085.89 832.51,-11085.89"/>
<polygon fill="black" stroke="black" points="836.01,-11085.89 832.51,-11075.89 829.01,-11085.89 836.01,-11085.89"/>
</g>
<!-- layer74_attn_7 -->
<g id="node1877" class="node">
<title>layer74_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1095.5,-11075.83 923.5,-11075.83 923.5,-11007.83 1095.5,-11007.83 1095.5,-11075.83"/>
<text text-anchor="middle" x="1009.5" y="-11060.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1009.5" y="-11045.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1009.5" y="-11030.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1009.5" y="-11015.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer74_qkv_ar&#45;&gt;layer74_attn_7 -->
<g id="edge2397" class="edge">
<title>layer74_qkv_ar&#45;&gt;layer74_attn_7</title>
<path fill="none" stroke="black" d="M978.49,-11156.23C978.49,-11156.23 978.49,-11085.89 978.49,-11085.89"/>
<polygon fill="black" stroke="black" points="981.99,-11085.89 978.49,-11075.89 974.99,-11085.89 981.99,-11085.89"/>
</g>
<!-- layer74_attn_out_6 -->
<g id="node1878" class="node">
<title>layer74_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="887.5,-10935.83 715.5,-10935.83 715.5,-10867.83 887.5,-10867.83 887.5,-10935.83"/>
<text text-anchor="middle" x="801.5" y="-10920.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="801.5" y="-10905.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="801.5" y="-10890.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="801.5" y="-10875.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer74_attn_6&#45;&gt;layer74_attn_out_6 -->
<g id="edge2398" class="edge">
<title>layer74_attn_6&#45;&gt;layer74_attn_out_6</title>
<path fill="none" stroke="black" d="M801.5,-11007.58C801.5,-11007.58 801.5,-10946.21 801.5,-10946.21"/>
<polygon fill="black" stroke="black" points="805,-10946.21 801.5,-10936.21 798,-10946.21 805,-10946.21"/>
</g>
<!-- layer74_attn_out_7 -->
<g id="node1879" class="node">
<title>layer74_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1095.5,-10935.83 923.5,-10935.83 923.5,-10867.83 1095.5,-10867.83 1095.5,-10935.83"/>
<text text-anchor="middle" x="1009.5" y="-10920.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1009.5" y="-10905.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1009.5" y="-10890.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1009.5" y="-10875.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer74_attn_7&#45;&gt;layer74_attn_out_7 -->
<g id="edge2399" class="edge">
<title>layer74_attn_7&#45;&gt;layer74_attn_out_7</title>
<path fill="none" stroke="black" d="M1009.5,-11007.58C1009.5,-11007.58 1009.5,-10946.21 1009.5,-10946.21"/>
<polygon fill="black" stroke="black" points="1013,-10946.21 1009.5,-10936.21 1006,-10946.21 1013,-10946.21"/>
</g>
<!-- layer74_attn_ar -->
<g id="node1880" class="node">
<title>layer74_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="905.5" cy="-10747.75" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="905.5" y="-10766.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="905.5" y="-10751.55" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="905.5" y="-10736.55" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="905.5" y="-10721.55" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer74_attn_out_6&#45;&gt;layer74_attn_ar -->
<g id="edge2400" class="edge">
<title>layer74_attn_out_6&#45;&gt;layer74_attn_ar</title>
<path fill="none" stroke="black" d="M835.69,-10867.63C835.69,-10867.63 835.69,-10797.29 835.69,-10797.29"/>
<polygon fill="black" stroke="black" points="839.19,-10797.29 835.69,-10787.29 832.19,-10797.29 839.19,-10797.29"/>
</g>
<!-- layer74_attn_out_7&#45;&gt;layer74_attn_ar -->
<g id="edge2401" class="edge">
<title>layer74_attn_out_7&#45;&gt;layer74_attn_ar</title>
<path fill="none" stroke="black" d="M975.31,-10867.63C975.31,-10867.63 975.31,-10797.29 975.31,-10797.29"/>
<polygon fill="black" stroke="black" points="978.81,-10797.29 975.31,-10787.29 971.81,-10797.29 978.81,-10797.29"/>
</g>
<!-- layer74_ffn_norm_6 -->
<g id="node1881" class="node">
<title>layer74_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="883.5,-10627.66 711.5,-10627.66 711.5,-10559.66 883.5,-10559.66 883.5,-10627.66"/>
<text text-anchor="middle" x="797.5" y="-10612.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="797.5" y="-10597.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="797.5" y="-10582.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="797.5" y="-10567.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer74_attn_ar&#45;&gt;layer74_ffn_norm_6 -->
<g id="edge2402" class="edge">
<title>layer74_attn_ar&#45;&gt;layer74_ffn_norm_6</title>
<path fill="none" stroke="black" d="M833.69,-10708.87C833.69,-10708.87 833.69,-10637.81 833.69,-10637.81"/>
<polygon fill="black" stroke="black" points="837.19,-10637.81 833.69,-10627.81 830.19,-10637.81 837.19,-10637.81"/>
</g>
<!-- layer74_ffn_norm_7 -->
<g id="node1882" class="node">
<title>layer74_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1100.5,-10627.66 928.5,-10627.66 928.5,-10559.66 1100.5,-10559.66 1100.5,-10627.66"/>
<text text-anchor="middle" x="1014.5" y="-10612.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1014.5" y="-10597.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1014.5" y="-10582.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1014.5" y="-10567.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer74_attn_ar&#45;&gt;layer74_ffn_norm_7 -->
<g id="edge2403" class="edge">
<title>layer74_attn_ar&#45;&gt;layer74_ffn_norm_7</title>
<path fill="none" stroke="black" d="M977.81,-10708.87C977.81,-10708.87 977.81,-10637.81 977.81,-10637.81"/>
<polygon fill="black" stroke="black" points="981.31,-10637.81 977.81,-10627.81 974.31,-10637.81 981.31,-10637.81"/>
</g>
<!-- layer74_ffn_gate_6 -->
<g id="node1883" class="node">
<title>layer74_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="888,-10487.66 707,-10487.66 707,-10419.66 888,-10419.66 888,-10487.66"/>
<text text-anchor="middle" x="797.5" y="-10472.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="797.5" y="-10457.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="797.5" y="-10442.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="797.5" y="-10427.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_ffn_norm_6&#45;&gt;layer74_ffn_gate_6 -->
<g id="edge2404" class="edge">
<title>layer74_ffn_norm_6&#45;&gt;layer74_ffn_gate_6</title>
<path fill="none" stroke="black" d="M797.5,-10559.42C797.5,-10559.42 797.5,-10498.04 797.5,-10498.04"/>
<polygon fill="black" stroke="black" points="801,-10498.04 797.5,-10488.04 794,-10498.04 801,-10498.04"/>
</g>
<!-- layer74_ffn_up_6 -->
<g id="node1885" class="node">
<title>layer74_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="671,-10487.66 490,-10487.66 490,-10419.66 671,-10419.66 671,-10487.66"/>
<text text-anchor="middle" x="580.5" y="-10472.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="580.5" y="-10457.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="580.5" y="-10442.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="580.5" y="-10427.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_ffn_norm_6&#45;&gt;layer74_ffn_up_6 -->
<g id="edge2406" class="edge">
<title>layer74_ffn_norm_6&#45;&gt;layer74_ffn_up_6</title>
<path fill="none" stroke="black" d="M711.31,-10593C671.86,-10593 633.76,-10593 633.76,-10593 633.76,-10593 633.76,-10497.75 633.76,-10497.75"/>
<polygon fill="black" stroke="black" points="637.26,-10497.75 633.76,-10487.75 630.26,-10497.75 637.26,-10497.75"/>
</g>
<!-- layer74_ffn_gate_7 -->
<g id="node1884" class="node">
<title>layer74_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1322,-10487.66 1141,-10487.66 1141,-10419.66 1322,-10419.66 1322,-10487.66"/>
<text text-anchor="middle" x="1231.5" y="-10472.46" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1231.5" y="-10457.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1231.5" y="-10442.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1231.5" y="-10427.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_ffn_norm_7&#45;&gt;layer74_ffn_gate_7 -->
<g id="edge2405" class="edge">
<title>layer74_ffn_norm_7&#45;&gt;layer74_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1100.56,-10593C1139.95,-10593 1178,-10593 1178,-10593 1178,-10593 1178,-10497.75 1178,-10497.75"/>
<polygon fill="black" stroke="black" points="1181.5,-10497.75 1178,-10487.75 1174.5,-10497.75 1181.5,-10497.75"/>
</g>
<!-- layer74_ffn_up_7 -->
<g id="node1886" class="node">
<title>layer74_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1105,-10487.66 924,-10487.66 924,-10419.66 1105,-10419.66 1105,-10487.66"/>
<text text-anchor="middle" x="1014.5" y="-10472.46" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1014.5" y="-10457.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1014.5" y="-10442.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1014.5" y="-10427.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_ffn_norm_7&#45;&gt;layer74_ffn_up_7 -->
<g id="edge2407" class="edge">
<title>layer74_ffn_norm_7&#45;&gt;layer74_ffn_up_7</title>
<path fill="none" stroke="black" d="M1014.5,-10559.42C1014.5,-10559.42 1014.5,-10498.04 1014.5,-10498.04"/>
<polygon fill="black" stroke="black" points="1018,-10498.04 1014.5,-10488.04 1011,-10498.04 1018,-10498.04"/>
</g>
<!-- layer74_gate_ar -->
<g id="node1887" class="node">
<title>layer74_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1105.5" cy="-10299.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1105.5" y="-10318.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1105.5" y="-10303.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1105.5" y="-10288.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1105.5" y="-10273.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer74_ffn_gate_6&#45;&gt;layer74_gate_ar -->
<g id="edge2408" class="edge">
<title>layer74_ffn_gate_6&#45;&gt;layer74_gate_ar</title>
<path fill="none" stroke="black" d="M888.08,-10453C898.79,-10453 906,-10453 906,-10453 906,-10453 906,-10315 906,-10315 906,-10315 973.99,-10315 973.99,-10315"/>
<polygon fill="black" stroke="black" points="973.99,-10318.5 983.99,-10315 973.99,-10311.5 973.99,-10318.5"/>
</g>
<!-- layer74_ffn_gate_7&#45;&gt;layer74_gate_ar -->
<g id="edge2409" class="edge">
<title>layer74_ffn_gate_7&#45;&gt;layer74_gate_ar</title>
<path fill="none" stroke="black" d="M1187.24,-10419.47C1187.24,-10419.47 1187.24,-10346.64 1187.24,-10346.64"/>
<polygon fill="black" stroke="black" points="1190.74,-10346.64 1187.24,-10336.64 1183.74,-10346.64 1190.74,-10346.64"/>
</g>
<!-- layer74_up_ar -->
<g id="node1888" class="node">
<title>layer74_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="759.5" cy="-10299.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="759.5" y="-10318.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="759.5" y="-10303.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="759.5" y="-10288.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="759.5" y="-10273.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer74_ffn_up_6&#45;&gt;layer74_up_ar -->
<g id="edge2410" class="edge">
<title>layer74_ffn_up_6&#45;&gt;layer74_up_ar</title>
<path fill="none" stroke="black" d="M651.26,-10419.47C651.26,-10419.47 651.26,-10335.54 651.26,-10335.54"/>
<polygon fill="black" stroke="black" points="654.76,-10335.54 651.26,-10325.54 647.76,-10335.54 654.76,-10335.54"/>
</g>
<!-- layer74_ffn_up_7&#45;&gt;layer74_up_ar -->
<g id="edge2411" class="edge">
<title>layer74_ffn_up_7&#45;&gt;layer74_up_ar</title>
<path fill="none" stroke="black" d="M950.76,-10419.54C950.76,-10369.73 950.76,-10283 950.76,-10283 950.76,-10283 889.81,-10283 889.81,-10283"/>
<polygon fill="black" stroke="black" points="889.81,-10279.5 879.81,-10283 889.81,-10286.5 889.81,-10279.5"/>
</g>
<!-- layer74_silu_6 -->
<g id="node1889" class="node">
<title>layer74_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="1033,-10179.5 852,-10179.5 852,-10111.5 1033,-10111.5 1033,-10179.5"/>
<text text-anchor="middle" x="942.5" y="-10164.3" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="942.5" y="-10149.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="942.5" y="-10134.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="942.5" y="-10119.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_gate_ar&#45;&gt;layer74_silu_6 -->
<g id="edge2412" class="edge">
<title>layer74_gate_ar&#45;&gt;layer74_silu_6</title>
<path fill="none" stroke="black" d="M1005.26,-10269.51C1005.26,-10269.51 1005.26,-10189.52 1005.26,-10189.52"/>
<polygon fill="black" stroke="black" points="1008.76,-10189.52 1005.26,-10179.52 1001.76,-10189.52 1008.76,-10189.52"/>
</g>
<!-- layer74_silu_7 -->
<g id="node1890" class="node">
<title>layer74_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1250,-10179.5 1069,-10179.5 1069,-10111.5 1250,-10111.5 1250,-10179.5"/>
<text text-anchor="middle" x="1159.5" y="-10164.3" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1159.5" y="-10149.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1159.5" y="-10134.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1159.5" y="-10119.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_gate_ar&#45;&gt;layer74_silu_7 -->
<g id="edge2413" class="edge">
<title>layer74_gate_ar&#45;&gt;layer74_silu_7</title>
<path fill="none" stroke="black" d="M1151.24,-10254.6C1151.24,-10254.6 1151.24,-10189.5 1151.24,-10189.5"/>
<polygon fill="black" stroke="black" points="1154.74,-10189.5 1151.24,-10179.5 1147.74,-10189.5 1154.74,-10189.5"/>
</g>
<!-- layer74_mul_6 -->
<g id="node1891" class="node">
<title>layer74_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="923,-10039.5 742,-10039.5 742,-9971.5 923,-9971.5 923,-10039.5"/>
<text text-anchor="middle" x="832.5" y="-10024.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="832.5" y="-10009.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="832.5" y="-9994.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="832.5" y="-9979.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_up_ar&#45;&gt;layer74_mul_6 -->
<g id="edge2415" class="edge">
<title>layer74_up_ar&#45;&gt;layer74_mul_6</title>
<path fill="none" stroke="black" d="M797,-10253.31C797,-10253.31 797,-10049.58 797,-10049.58"/>
<polygon fill="black" stroke="black" points="800.5,-10049.58 797,-10039.58 793.5,-10049.58 800.5,-10049.58"/>
</g>
<!-- layer74_mul_7 -->
<g id="node1892" class="node">
<title>layer74_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1140,-10039.5 959,-10039.5 959,-9971.5 1140,-9971.5 1140,-10039.5"/>
<text text-anchor="middle" x="1049.5" y="-10024.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1049.5" y="-10009.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1049.5" y="-9994.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1049.5" y="-9979.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer74_up_ar&#45;&gt;layer74_mul_7 -->
<g id="edge2417" class="edge">
<title>layer74_up_ar&#45;&gt;layer74_mul_7</title>
<path fill="none" stroke="black" d="M869.74,-10275.12C869.74,-10250.14 869.74,-10215 869.74,-10215 869.74,-10215 1051,-10215 1051,-10215 1051,-10215 1051,-10049.62 1051,-10049.62"/>
<polygon fill="black" stroke="black" points="1054.5,-10049.62 1051,-10039.62 1047.5,-10049.62 1054.5,-10049.62"/>
</g>
<!-- layer74_silu_6&#45;&gt;layer74_mul_6 -->
<g id="edge2414" class="edge">
<title>layer74_silu_6&#45;&gt;layer74_mul_6</title>
<path fill="none" stroke="black" d="M887.5,-10111.25C887.5,-10111.25 887.5,-10049.88 887.5,-10049.88"/>
<polygon fill="black" stroke="black" points="891,-10049.88 887.5,-10039.88 884,-10049.88 891,-10049.88"/>
</g>
<!-- layer74_silu_7&#45;&gt;layer74_mul_7 -->
<g id="edge2416" class="edge">
<title>layer74_silu_7&#45;&gt;layer74_mul_7</title>
<path fill="none" stroke="black" d="M1104.5,-10111.25C1104.5,-10111.25 1104.5,-10049.88 1104.5,-10049.88"/>
<polygon fill="black" stroke="black" points="1108,-10049.88 1104.5,-10039.88 1101,-10049.88 1108,-10049.88"/>
</g>
<!-- layer74_ffn_down_6 -->
<g id="node1893" class="node">
<title>layer74_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="922.5,-9899.5 750.5,-9899.5 750.5,-9831.5 922.5,-9831.5 922.5,-9899.5"/>
<text text-anchor="middle" x="836.5" y="-9884.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="836.5" y="-9869.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="836.5" y="-9854.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="836.5" y="-9839.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer74_mul_6&#45;&gt;layer74_ffn_down_6 -->
<g id="edge2418" class="edge">
<title>layer74_mul_6&#45;&gt;layer74_ffn_down_6</title>
<path fill="none" stroke="black" d="M836.5,-9971.25C836.5,-9971.25 836.5,-9909.88 836.5,-9909.88"/>
<polygon fill="black" stroke="black" points="840,-9909.88 836.5,-9899.88 833,-9909.88 840,-9909.88"/>
</g>
<!-- layer74_ffn_down_7 -->
<g id="node1894" class="node">
<title>layer74_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1132.5,-9899.5 960.5,-9899.5 960.5,-9831.5 1132.5,-9831.5 1132.5,-9899.5"/>
<text text-anchor="middle" x="1046.5" y="-9884.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1046.5" y="-9869.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1046.5" y="-9854.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1046.5" y="-9839.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer74_mul_7&#45;&gt;layer74_ffn_down_7 -->
<g id="edge2419" class="edge">
<title>layer74_mul_7&#45;&gt;layer74_ffn_down_7</title>
<path fill="none" stroke="black" d="M1046.5,-9971.25C1046.5,-9971.25 1046.5,-9909.88 1046.5,-9909.88"/>
<polygon fill="black" stroke="black" points="1050,-9909.88 1046.5,-9899.88 1043,-9909.88 1050,-9909.88"/>
</g>
<!-- layer74_ffn_ar -->
<g id="node1895" class="node">
<title>layer74_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="940.5" cy="-9711.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="940.5" y="-9730.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="940.5" y="-9715.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="940.5" y="-9700.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="940.5" y="-9685.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer74_ffn_down_6&#45;&gt;layer74_ffn_ar -->
<g id="edge2420" class="edge">
<title>layer74_ffn_down_6&#45;&gt;layer74_ffn_ar</title>
<path fill="none" stroke="black" d="M870.69,-9831.3C870.69,-9831.3 870.69,-9760.96 870.69,-9760.96"/>
<polygon fill="black" stroke="black" points="874.19,-9760.96 870.69,-9750.96 867.19,-9760.96 874.19,-9760.96"/>
</g>
<!-- layer74_ffn_down_7&#45;&gt;layer74_ffn_ar -->
<g id="edge2421" class="edge">
<title>layer74_ffn_down_7&#45;&gt;layer74_ffn_ar</title>
<path fill="none" stroke="black" d="M1011.31,-9831.3C1011.31,-9831.3 1011.31,-9760.68 1011.31,-9760.68"/>
<polygon fill="black" stroke="black" points="1014.81,-9760.68 1011.31,-9750.68 1007.81,-9760.68 1014.81,-9760.68"/>
</g>
<!-- layer75_norm_6 -->
<g id="node1896" class="node">
<title>layer75_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="922.5,-9591.33 750.5,-9591.33 750.5,-9523.33 922.5,-9523.33 922.5,-9591.33"/>
<text text-anchor="middle" x="836.5" y="-9576.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="836.5" y="-9561.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="836.5" y="-9546.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="836.5" y="-9531.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer74_ffn_ar&#45;&gt;layer75_norm_6 -->
<g id="edge2422" class="edge">
<title>layer74_ffn_ar&#45;&gt;layer75_norm_6</title>
<path fill="none" stroke="black" d="M870.69,-9671.73C870.69,-9671.73 870.69,-9601.39 870.69,-9601.39"/>
<polygon fill="black" stroke="black" points="874.19,-9601.39 870.69,-9591.39 867.19,-9601.39 874.19,-9601.39"/>
</g>
<!-- layer75_norm_7 -->
<g id="node1897" class="node">
<title>layer75_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1132.5,-9591.33 960.5,-9591.33 960.5,-9523.33 1132.5,-9523.33 1132.5,-9591.33"/>
<text text-anchor="middle" x="1046.5" y="-9576.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1046.5" y="-9561.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1046.5" y="-9546.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1046.5" y="-9531.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer74_ffn_ar&#45;&gt;layer75_norm_7 -->
<g id="edge2423" class="edge">
<title>layer74_ffn_ar&#45;&gt;layer75_norm_7</title>
<path fill="none" stroke="black" d="M1011.31,-9672.13C1011.31,-9672.13 1011.31,-9601.56 1011.31,-9601.56"/>
<polygon fill="black" stroke="black" points="1014.81,-9601.56 1011.31,-9591.56 1007.81,-9601.56 1014.81,-9601.56"/>
</g>
<!-- layer75_qkv_6 -->
<g id="node1898" class="node">
<title>layer75_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="923,-9451.33 742,-9451.33 742,-9383.33 923,-9383.33 923,-9451.33"/>
<text text-anchor="middle" x="832.5" y="-9436.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="832.5" y="-9421.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="832.5" y="-9406.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="832.5" y="-9391.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer75_norm_6&#45;&gt;layer75_qkv_6 -->
<g id="edge2424" class="edge">
<title>layer75_norm_6&#45;&gt;layer75_qkv_6</title>
<path fill="none" stroke="black" d="M836.5,-9523.08C836.5,-9523.08 836.5,-9461.71 836.5,-9461.71"/>
<polygon fill="black" stroke="black" points="840,-9461.71 836.5,-9451.71 833,-9461.71 840,-9461.71"/>
</g>
<!-- layer75_qkv_7 -->
<g id="node1899" class="node">
<title>layer75_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1140,-9451.33 959,-9451.33 959,-9383.33 1140,-9383.33 1140,-9451.33"/>
<text text-anchor="middle" x="1049.5" y="-9436.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1049.5" y="-9421.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1049.5" y="-9406.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1049.5" y="-9391.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer75_norm_7&#45;&gt;layer75_qkv_7 -->
<g id="edge2425" class="edge">
<title>layer75_norm_7&#45;&gt;layer75_qkv_7</title>
<path fill="none" stroke="black" d="M1046.5,-9523.08C1046.5,-9523.08 1046.5,-9461.71 1046.5,-9461.71"/>
<polygon fill="black" stroke="black" points="1050,-9461.71 1046.5,-9451.71 1043,-9461.71 1050,-9461.71"/>
</g>
<!-- layer75_qkv_ar -->
<g id="node1900" class="node">
<title>layer75_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="940.5" cy="-9263.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="940.5" y="-9282.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="940.5" y="-9267.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="940.5" y="-9252.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="940.5" y="-9237.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer75_qkv_6&#45;&gt;layer75_qkv_ar -->
<g id="edge2426" class="edge">
<title>layer75_qkv_6&#45;&gt;layer75_qkv_ar</title>
<path fill="none" stroke="black" d="M867.76,-9383.13C867.76,-9383.13 867.76,-9313.07 867.76,-9313.07"/>
<polygon fill="black" stroke="black" points="871.26,-9313.07 867.76,-9303.07 864.26,-9313.07 871.26,-9313.07"/>
</g>
<!-- layer75_qkv_7&#45;&gt;layer75_qkv_ar -->
<g id="edge2427" class="edge">
<title>layer75_qkv_7&#45;&gt;layer75_qkv_ar</title>
<path fill="none" stroke="black" d="M1013.74,-9383.13C1013.74,-9383.13 1013.74,-9312.79 1013.74,-9312.79"/>
<polygon fill="black" stroke="black" points="1017.24,-9312.79 1013.74,-9302.79 1010.24,-9312.79 1017.24,-9312.79"/>
</g>
<!-- layer75_attn_6 -->
<g id="node1901" class="node">
<title>layer75_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="922.5,-9143.16 750.5,-9143.16 750.5,-9075.16 922.5,-9075.16 922.5,-9143.16"/>
<text text-anchor="middle" x="836.5" y="-9127.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="836.5" y="-9112.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="836.5" y="-9097.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="836.5" y="-9082.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer75_qkv_ar&#45;&gt;layer75_attn_6 -->
<g id="edge2428" class="edge">
<title>layer75_qkv_ar&#45;&gt;layer75_attn_6</title>
<path fill="none" stroke="black" d="M867.51,-9223.57C867.51,-9223.57 867.51,-9153.22 867.51,-9153.22"/>
<polygon fill="black" stroke="black" points="871.01,-9153.22 867.51,-9143.22 864.01,-9153.22 871.01,-9153.22"/>
</g>
<!-- layer75_attn_7 -->
<g id="node1902" class="node">
<title>layer75_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1130.5,-9143.16 958.5,-9143.16 958.5,-9075.16 1130.5,-9075.16 1130.5,-9143.16"/>
<text text-anchor="middle" x="1044.5" y="-9127.96" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1044.5" y="-9112.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1044.5" y="-9097.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1044.5" y="-9082.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer75_qkv_ar&#45;&gt;layer75_attn_7 -->
<g id="edge2429" class="edge">
<title>layer75_qkv_ar&#45;&gt;layer75_attn_7</title>
<path fill="none" stroke="black" d="M1013.49,-9223.57C1013.49,-9223.57 1013.49,-9153.22 1013.49,-9153.22"/>
<polygon fill="black" stroke="black" points="1016.99,-9153.22 1013.49,-9143.22 1009.99,-9153.22 1016.99,-9153.22"/>
</g>
<!-- layer75_attn_out_6 -->
<g id="node1903" class="node">
<title>layer75_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="922.5,-9003.16 750.5,-9003.16 750.5,-8935.16 922.5,-8935.16 922.5,-9003.16"/>
<text text-anchor="middle" x="836.5" y="-8987.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="836.5" y="-8972.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="836.5" y="-8957.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="836.5" y="-8942.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer75_attn_6&#45;&gt;layer75_attn_out_6 -->
<g id="edge2430" class="edge">
<title>layer75_attn_6&#45;&gt;layer75_attn_out_6</title>
<path fill="none" stroke="black" d="M836.5,-9074.92C836.5,-9074.92 836.5,-9013.54 836.5,-9013.54"/>
<polygon fill="black" stroke="black" points="840,-9013.54 836.5,-9003.54 833,-9013.54 840,-9013.54"/>
</g>
<!-- layer75_attn_out_7 -->
<g id="node1904" class="node">
<title>layer75_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1130.5,-9003.16 958.5,-9003.16 958.5,-8935.16 1130.5,-8935.16 1130.5,-9003.16"/>
<text text-anchor="middle" x="1044.5" y="-8987.96" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1044.5" y="-8972.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1044.5" y="-8957.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1044.5" y="-8942.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer75_attn_7&#45;&gt;layer75_attn_out_7 -->
<g id="edge2431" class="edge">
<title>layer75_attn_7&#45;&gt;layer75_attn_out_7</title>
<path fill="none" stroke="black" d="M1044.5,-9074.92C1044.5,-9074.92 1044.5,-9013.54 1044.5,-9013.54"/>
<polygon fill="black" stroke="black" points="1048,-9013.54 1044.5,-9003.54 1041,-9013.54 1048,-9013.54"/>
</g>
<!-- layer75_attn_ar -->
<g id="node1905" class="node">
<title>layer75_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="940.5" cy="-8815.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="940.5" y="-8833.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="940.5" y="-8818.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="940.5" y="-8803.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="940.5" y="-8788.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer75_attn_out_6&#45;&gt;layer75_attn_ar -->
<g id="edge2432" class="edge">
<title>layer75_attn_out_6&#45;&gt;layer75_attn_ar</title>
<path fill="none" stroke="black" d="M870.69,-8934.97C870.69,-8934.97 870.69,-8864.62 870.69,-8864.62"/>
<polygon fill="black" stroke="black" points="874.19,-8864.62 870.69,-8854.62 867.19,-8864.62 874.19,-8864.62"/>
</g>
<!-- layer75_attn_out_7&#45;&gt;layer75_attn_ar -->
<g id="edge2433" class="edge">
<title>layer75_attn_out_7&#45;&gt;layer75_attn_ar</title>
<path fill="none" stroke="black" d="M1010.31,-8934.97C1010.31,-8934.97 1010.31,-8864.62 1010.31,-8864.62"/>
<polygon fill="black" stroke="black" points="1013.81,-8864.62 1010.31,-8854.62 1006.81,-8864.62 1013.81,-8864.62"/>
</g>
<!-- layer75_ffn_norm_6 -->
<g id="node1906" class="node">
<title>layer75_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="918.5,-8695 746.5,-8695 746.5,-8627 918.5,-8627 918.5,-8695"/>
<text text-anchor="middle" x="832.5" y="-8679.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="832.5" y="-8664.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="832.5" y="-8649.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="832.5" y="-8634.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer75_attn_ar&#45;&gt;layer75_ffn_norm_6 -->
<g id="edge2434" class="edge">
<title>layer75_attn_ar&#45;&gt;layer75_ffn_norm_6</title>
<path fill="none" stroke="black" d="M868.69,-8776.2C868.69,-8776.2 868.69,-8705.15 868.69,-8705.15"/>
<polygon fill="black" stroke="black" points="872.19,-8705.15 868.69,-8695.15 865.19,-8705.15 872.19,-8705.15"/>
</g>
<!-- layer75_ffn_norm_7 -->
<g id="node1907" class="node">
<title>layer75_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1135.5,-8695 963.5,-8695 963.5,-8627 1135.5,-8627 1135.5,-8695"/>
<text text-anchor="middle" x="1049.5" y="-8679.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1049.5" y="-8664.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1049.5" y="-8649.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1049.5" y="-8634.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer75_attn_ar&#45;&gt;layer75_ffn_norm_7 -->
<g id="edge2435" class="edge">
<title>layer75_attn_ar&#45;&gt;layer75_ffn_norm_7</title>
<path fill="none" stroke="black" d="M1012.81,-8776.2C1012.81,-8776.2 1012.81,-8705.15 1012.81,-8705.15"/>
<polygon fill="black" stroke="black" points="1016.31,-8705.15 1012.81,-8695.15 1009.31,-8705.15 1016.31,-8705.15"/>
</g>
<!-- layer75_ffn_gate_6 -->
<g id="node1908" class="node">
<title>layer75_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="923,-8555 742,-8555 742,-8487 923,-8487 923,-8555"/>
<text text-anchor="middle" x="832.5" y="-8539.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="832.5" y="-8524.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="832.5" y="-8509.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="832.5" y="-8494.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_ffn_norm_6&#45;&gt;layer75_ffn_gate_6 -->
<g id="edge2436" class="edge">
<title>layer75_ffn_norm_6&#45;&gt;layer75_ffn_gate_6</title>
<path fill="none" stroke="black" d="M832.5,-8626.75C832.5,-8626.75 832.5,-8565.38 832.5,-8565.38"/>
<polygon fill="black" stroke="black" points="836,-8565.38 832.5,-8555.38 829,-8565.38 836,-8565.38"/>
</g>
<!-- layer75_ffn_up_6 -->
<g id="node1910" class="node">
<title>layer75_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="706,-8555 525,-8555 525,-8487 706,-8487 706,-8555"/>
<text text-anchor="middle" x="615.5" y="-8539.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="615.5" y="-8524.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="615.5" y="-8509.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="615.5" y="-8494.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_ffn_norm_6&#45;&gt;layer75_ffn_up_6 -->
<g id="edge2438" class="edge">
<title>layer75_ffn_norm_6&#45;&gt;layer75_ffn_up_6</title>
<path fill="none" stroke="black" d="M746.31,-8660C706.86,-8660 668.76,-8660 668.76,-8660 668.76,-8660 668.76,-8565 668.76,-8565"/>
<polygon fill="black" stroke="black" points="672.26,-8565 668.76,-8555 665.26,-8565 672.26,-8565"/>
</g>
<!-- layer75_ffn_gate_7 -->
<g id="node1909" class="node">
<title>layer75_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1357,-8555 1176,-8555 1176,-8487 1357,-8487 1357,-8555"/>
<text text-anchor="middle" x="1266.5" y="-8539.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1266.5" y="-8524.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1266.5" y="-8509.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1266.5" y="-8494.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_ffn_norm_7&#45;&gt;layer75_ffn_gate_7 -->
<g id="edge2437" class="edge">
<title>layer75_ffn_norm_7&#45;&gt;layer75_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1135.56,-8660C1174.95,-8660 1213,-8660 1213,-8660 1213,-8660 1213,-8565 1213,-8565"/>
<polygon fill="black" stroke="black" points="1216.5,-8565 1213,-8555 1209.5,-8565 1216.5,-8565"/>
</g>
<!-- layer75_ffn_up_7 -->
<g id="node1911" class="node">
<title>layer75_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1140,-8555 959,-8555 959,-8487 1140,-8487 1140,-8555"/>
<text text-anchor="middle" x="1049.5" y="-8539.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1049.5" y="-8524.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1049.5" y="-8509.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1049.5" y="-8494.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_ffn_norm_7&#45;&gt;layer75_ffn_up_7 -->
<g id="edge2439" class="edge">
<title>layer75_ffn_norm_7&#45;&gt;layer75_ffn_up_7</title>
<path fill="none" stroke="black" d="M1049.5,-8626.75C1049.5,-8626.75 1049.5,-8565.38 1049.5,-8565.38"/>
<polygon fill="black" stroke="black" points="1053,-8565.38 1049.5,-8555.38 1046,-8565.38 1053,-8565.38"/>
</g>
<!-- layer75_gate_ar -->
<g id="node1912" class="node">
<title>layer75_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1140.5" cy="-8366.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1140.5" y="-8385.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1140.5" y="-8370.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1140.5" y="-8355.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1140.5" y="-8340.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer75_ffn_gate_6&#45;&gt;layer75_gate_ar -->
<g id="edge2440" class="edge">
<title>layer75_ffn_gate_6&#45;&gt;layer75_gate_ar</title>
<path fill="none" stroke="black" d="M923.08,-8520C933.79,-8520 941,-8520 941,-8520 941,-8520 941,-8382 941,-8382 941,-8382 1008.7,-8382 1008.7,-8382"/>
<polygon fill="black" stroke="black" points="1008.7,-8385.5 1018.7,-8382 1008.7,-8378.5 1008.7,-8385.5"/>
</g>
<!-- layer75_ffn_gate_7&#45;&gt;layer75_gate_ar -->
<g id="edge2441" class="edge">
<title>layer75_ffn_gate_7&#45;&gt;layer75_gate_ar</title>
<path fill="none" stroke="black" d="M1222.24,-8486.8C1222.24,-8486.8 1222.24,-8413.98 1222.24,-8413.98"/>
<polygon fill="black" stroke="black" points="1225.74,-8413.98 1222.24,-8403.98 1218.74,-8413.98 1225.74,-8413.98"/>
</g>
<!-- layer75_up_ar -->
<g id="node1913" class="node">
<title>layer75_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="794.5" cy="-8366.91" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="794.5" y="-8385.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="794.5" y="-8370.71" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="794.5" y="-8355.71" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="794.5" y="-8340.71" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer75_ffn_up_6&#45;&gt;layer75_up_ar -->
<g id="edge2442" class="edge">
<title>layer75_ffn_up_6&#45;&gt;layer75_up_ar</title>
<path fill="none" stroke="black" d="M686.26,-8486.8C686.26,-8486.8 686.26,-8402.88 686.26,-8402.88"/>
<polygon fill="black" stroke="black" points="689.76,-8402.88 686.26,-8392.88 682.76,-8402.88 689.76,-8402.88"/>
</g>
<!-- layer75_ffn_up_7&#45;&gt;layer75_up_ar -->
<g id="edge2443" class="edge">
<title>layer75_ffn_up_7&#45;&gt;layer75_up_ar</title>
<path fill="none" stroke="black" d="M985.76,-8486.8C985.76,-8436.9 985.76,-8350 985.76,-8350 985.76,-8350 924.54,-8350 924.54,-8350"/>
<polygon fill="black" stroke="black" points="924.54,-8346.5 914.54,-8350 924.54,-8353.5 924.54,-8346.5"/>
</g>
<!-- layer75_silu_6 -->
<g id="node1914" class="node">
<title>layer75_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="1068,-8246.83 887,-8246.83 887,-8178.83 1068,-8178.83 1068,-8246.83"/>
<text text-anchor="middle" x="977.5" y="-8231.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="977.5" y="-8216.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="977.5" y="-8201.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="977.5" y="-8186.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_gate_ar&#45;&gt;layer75_silu_6 -->
<g id="edge2444" class="edge">
<title>layer75_gate_ar&#45;&gt;layer75_silu_6</title>
<path fill="none" stroke="black" d="M1040.26,-8336.84C1040.26,-8336.84 1040.26,-8256.85 1040.26,-8256.85"/>
<polygon fill="black" stroke="black" points="1043.76,-8256.85 1040.26,-8246.85 1036.76,-8256.85 1043.76,-8256.85"/>
</g>
<!-- layer75_silu_7 -->
<g id="node1915" class="node">
<title>layer75_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1285,-8246.83 1104,-8246.83 1104,-8178.83 1285,-8178.83 1285,-8246.83"/>
<text text-anchor="middle" x="1194.5" y="-8231.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1194.5" y="-8216.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1194.5" y="-8201.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1194.5" y="-8186.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_gate_ar&#45;&gt;layer75_silu_7 -->
<g id="edge2445" class="edge">
<title>layer75_gate_ar&#45;&gt;layer75_silu_7</title>
<path fill="none" stroke="black" d="M1186.24,-8321.93C1186.24,-8321.93 1186.24,-8256.84 1186.24,-8256.84"/>
<polygon fill="black" stroke="black" points="1189.74,-8256.84 1186.24,-8246.84 1182.74,-8256.84 1189.74,-8256.84"/>
</g>
<!-- layer75_mul_6 -->
<g id="node1916" class="node">
<title>layer75_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="958,-8106.83 777,-8106.83 777,-8038.83 958,-8038.83 958,-8106.83"/>
<text text-anchor="middle" x="867.5" y="-8091.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="867.5" y="-8076.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="867.5" y="-8061.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="867.5" y="-8046.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_up_ar&#45;&gt;layer75_mul_6 -->
<g id="edge2447" class="edge">
<title>layer75_up_ar&#45;&gt;layer75_mul_6</title>
<path fill="none" stroke="black" d="M832,-8320.64C832,-8320.64 832,-8116.92 832,-8116.92"/>
<polygon fill="black" stroke="black" points="835.5,-8116.92 832,-8106.92 828.5,-8116.92 835.5,-8116.92"/>
</g>
<!-- layer75_mul_7 -->
<g id="node1917" class="node">
<title>layer75_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1175,-8106.83 994,-8106.83 994,-8038.83 1175,-8038.83 1175,-8106.83"/>
<text text-anchor="middle" x="1084.5" y="-8091.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1084.5" y="-8076.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1084.5" y="-8061.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1084.5" y="-8046.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer75_up_ar&#45;&gt;layer75_mul_7 -->
<g id="edge2449" class="edge">
<title>layer75_up_ar&#45;&gt;layer75_mul_7</title>
<path fill="none" stroke="black" d="M904.74,-8342.35C904.74,-8317.28 904.74,-8282 904.74,-8282 904.74,-8282 1086,-8282 1086,-8282 1086,-8282 1086,-8116.9 1086,-8116.9"/>
<polygon fill="black" stroke="black" points="1089.5,-8116.9 1086,-8106.9 1082.5,-8116.9 1089.5,-8116.9"/>
</g>
<!-- layer75_silu_6&#45;&gt;layer75_mul_6 -->
<g id="edge2446" class="edge">
<title>layer75_silu_6&#45;&gt;layer75_mul_6</title>
<path fill="none" stroke="black" d="M922.5,-8178.58C922.5,-8178.58 922.5,-8117.21 922.5,-8117.21"/>
<polygon fill="black" stroke="black" points="926,-8117.21 922.5,-8107.21 919,-8117.21 926,-8117.21"/>
</g>
<!-- layer75_silu_7&#45;&gt;layer75_mul_7 -->
<g id="edge2448" class="edge">
<title>layer75_silu_7&#45;&gt;layer75_mul_7</title>
<path fill="none" stroke="black" d="M1139.5,-8178.58C1139.5,-8178.58 1139.5,-8117.21 1139.5,-8117.21"/>
<polygon fill="black" stroke="black" points="1143,-8117.21 1139.5,-8107.21 1136,-8117.21 1143,-8117.21"/>
</g>
<!-- layer75_ffn_down_6 -->
<g id="node1918" class="node">
<title>layer75_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="957.5,-7966.83 785.5,-7966.83 785.5,-7898.83 957.5,-7898.83 957.5,-7966.83"/>
<text text-anchor="middle" x="871.5" y="-7951.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="871.5" y="-7936.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="871.5" y="-7921.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="871.5" y="-7906.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer75_mul_6&#45;&gt;layer75_ffn_down_6 -->
<g id="edge2450" class="edge">
<title>layer75_mul_6&#45;&gt;layer75_ffn_down_6</title>
<path fill="none" stroke="black" d="M871.5,-8038.58C871.5,-8038.58 871.5,-7977.21 871.5,-7977.21"/>
<polygon fill="black" stroke="black" points="875,-7977.21 871.5,-7967.21 868,-7977.21 875,-7977.21"/>
</g>
<!-- layer75_ffn_down_7 -->
<g id="node1919" class="node">
<title>layer75_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1167.5,-7966.83 995.5,-7966.83 995.5,-7898.83 1167.5,-7898.83 1167.5,-7966.83"/>
<text text-anchor="middle" x="1081.5" y="-7951.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1081.5" y="-7936.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1081.5" y="-7921.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1081.5" y="-7906.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer75_mul_7&#45;&gt;layer75_ffn_down_7 -->
<g id="edge2451" class="edge">
<title>layer75_mul_7&#45;&gt;layer75_ffn_down_7</title>
<path fill="none" stroke="black" d="M1081.5,-8038.58C1081.5,-8038.58 1081.5,-7977.21 1081.5,-7977.21"/>
<polygon fill="black" stroke="black" points="1085,-7977.21 1081.5,-7967.21 1078,-7977.21 1085,-7977.21"/>
</g>
<!-- layer75_ffn_ar -->
<g id="node1920" class="node">
<title>layer75_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="975.5" cy="-7778.75" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="975.5" y="-7797.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="975.5" y="-7782.55" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="975.5" y="-7767.55" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="975.5" y="-7752.55" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer75_ffn_down_6&#45;&gt;layer75_ffn_ar -->
<g id="edge2452" class="edge">
<title>layer75_ffn_down_6&#45;&gt;layer75_ffn_ar</title>
<path fill="none" stroke="black" d="M905.69,-7898.63C905.69,-7898.63 905.69,-7828.29 905.69,-7828.29"/>
<polygon fill="black" stroke="black" points="909.19,-7828.29 905.69,-7818.29 902.19,-7828.29 909.19,-7828.29"/>
</g>
<!-- layer75_ffn_down_7&#45;&gt;layer75_ffn_ar -->
<g id="edge2453" class="edge">
<title>layer75_ffn_down_7&#45;&gt;layer75_ffn_ar</title>
<path fill="none" stroke="black" d="M1046.31,-7898.63C1046.31,-7898.63 1046.31,-7828.01 1046.31,-7828.01"/>
<polygon fill="black" stroke="black" points="1049.81,-7828.01 1046.31,-7818.01 1042.81,-7828.01 1049.81,-7828.01"/>
</g>
<!-- layer76_norm_6 -->
<g id="node1921" class="node">
<title>layer76_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="957.5,-7658.66 785.5,-7658.66 785.5,-7590.66 957.5,-7590.66 957.5,-7658.66"/>
<text text-anchor="middle" x="871.5" y="-7643.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="871.5" y="-7628.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="871.5" y="-7613.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="871.5" y="-7598.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer75_ffn_ar&#45;&gt;layer76_norm_6 -->
<g id="edge2454" class="edge">
<title>layer75_ffn_ar&#45;&gt;layer76_norm_6</title>
<path fill="none" stroke="black" d="M905.69,-7739.07C905.69,-7739.07 905.69,-7668.72 905.69,-7668.72"/>
<polygon fill="black" stroke="black" points="909.19,-7668.72 905.69,-7658.72 902.19,-7668.72 909.19,-7668.72"/>
</g>
<!-- layer76_norm_7 -->
<g id="node1922" class="node">
<title>layer76_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1167.5,-7658.66 995.5,-7658.66 995.5,-7590.66 1167.5,-7590.66 1167.5,-7658.66"/>
<text text-anchor="middle" x="1081.5" y="-7643.46" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1081.5" y="-7628.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1081.5" y="-7613.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1081.5" y="-7598.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer75_ffn_ar&#45;&gt;layer76_norm_7 -->
<g id="edge2455" class="edge">
<title>layer75_ffn_ar&#45;&gt;layer76_norm_7</title>
<path fill="none" stroke="black" d="M1046.31,-7739.47C1046.31,-7739.47 1046.31,-7668.9 1046.31,-7668.9"/>
<polygon fill="black" stroke="black" points="1049.81,-7668.9 1046.31,-7658.9 1042.81,-7668.9 1049.81,-7668.9"/>
</g>
<!-- layer76_qkv_6 -->
<g id="node1923" class="node">
<title>layer76_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="958,-7518.66 777,-7518.66 777,-7450.66 958,-7450.66 958,-7518.66"/>
<text text-anchor="middle" x="867.5" y="-7503.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="867.5" y="-7488.46" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="867.5" y="-7473.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="867.5" y="-7458.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer76_norm_6&#45;&gt;layer76_qkv_6 -->
<g id="edge2456" class="edge">
<title>layer76_norm_6&#45;&gt;layer76_qkv_6</title>
<path fill="none" stroke="black" d="M871.5,-7590.42C871.5,-7590.42 871.5,-7529.04 871.5,-7529.04"/>
<polygon fill="black" stroke="black" points="875,-7529.04 871.5,-7519.04 868,-7529.04 875,-7529.04"/>
</g>
<!-- layer76_qkv_7 -->
<g id="node1924" class="node">
<title>layer76_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1175,-7518.66 994,-7518.66 994,-7450.66 1175,-7450.66 1175,-7518.66"/>
<text text-anchor="middle" x="1084.5" y="-7503.46" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1084.5" y="-7488.46" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1084.5" y="-7473.46" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1084.5" y="-7458.46" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer76_norm_7&#45;&gt;layer76_qkv_7 -->
<g id="edge2457" class="edge">
<title>layer76_norm_7&#45;&gt;layer76_qkv_7</title>
<path fill="none" stroke="black" d="M1081.5,-7590.42C1081.5,-7590.42 1081.5,-7529.04 1081.5,-7529.04"/>
<polygon fill="black" stroke="black" points="1085,-7529.04 1081.5,-7519.04 1078,-7529.04 1085,-7529.04"/>
</g>
<!-- layer76_qkv_ar -->
<g id="node1925" class="node">
<title>layer76_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="975.5" cy="-7330.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="975.5" y="-7349.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="975.5" y="-7334.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="975.5" y="-7319.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="975.5" y="-7304.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer76_qkv_6&#45;&gt;layer76_qkv_ar -->
<g id="edge2458" class="edge">
<title>layer76_qkv_6&#45;&gt;layer76_qkv_ar</title>
<path fill="none" stroke="black" d="M902.76,-7450.47C902.76,-7450.47 902.76,-7380.4 902.76,-7380.4"/>
<polygon fill="black" stroke="black" points="906.26,-7380.4 902.76,-7370.4 899.26,-7380.4 906.26,-7380.4"/>
</g>
<!-- layer76_qkv_7&#45;&gt;layer76_qkv_ar -->
<g id="edge2459" class="edge">
<title>layer76_qkv_7&#45;&gt;layer76_qkv_ar</title>
<path fill="none" stroke="black" d="M1048.74,-7450.47C1048.74,-7450.47 1048.74,-7380.12 1048.74,-7380.12"/>
<polygon fill="black" stroke="black" points="1052.24,-7380.12 1048.74,-7370.12 1045.24,-7380.12 1052.24,-7380.12"/>
</g>
<!-- layer76_attn_6 -->
<g id="node1926" class="node">
<title>layer76_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="957.5,-7210.5 785.5,-7210.5 785.5,-7142.5 957.5,-7142.5 957.5,-7210.5"/>
<text text-anchor="middle" x="871.5" y="-7195.3" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="871.5" y="-7180.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="871.5" y="-7165.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="871.5" y="-7150.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer76_qkv_ar&#45;&gt;layer76_attn_6 -->
<g id="edge2460" class="edge">
<title>layer76_qkv_ar&#45;&gt;layer76_attn_6</title>
<path fill="none" stroke="black" d="M902.51,-7290.9C902.51,-7290.9 902.51,-7220.56 902.51,-7220.56"/>
<polygon fill="black" stroke="black" points="906.01,-7220.55 902.51,-7210.56 899.01,-7220.56 906.01,-7220.55"/>
</g>
<!-- layer76_attn_7 -->
<g id="node1927" class="node">
<title>layer76_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1165.5,-7210.5 993.5,-7210.5 993.5,-7142.5 1165.5,-7142.5 1165.5,-7210.5"/>
<text text-anchor="middle" x="1079.5" y="-7195.3" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1079.5" y="-7180.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1079.5" y="-7165.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1079.5" y="-7150.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer76_qkv_ar&#45;&gt;layer76_attn_7 -->
<g id="edge2461" class="edge">
<title>layer76_qkv_ar&#45;&gt;layer76_attn_7</title>
<path fill="none" stroke="black" d="M1048.49,-7290.9C1048.49,-7290.9 1048.49,-7220.56 1048.49,-7220.56"/>
<polygon fill="black" stroke="black" points="1051.99,-7220.55 1048.49,-7210.56 1044.99,-7220.56 1051.99,-7220.55"/>
</g>
<!-- layer76_attn_out_6 -->
<g id="node1928" class="node">
<title>layer76_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="957.5,-7070.5 785.5,-7070.5 785.5,-7002.5 957.5,-7002.5 957.5,-7070.5"/>
<text text-anchor="middle" x="871.5" y="-7055.3" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="871.5" y="-7040.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="871.5" y="-7025.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="871.5" y="-7010.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer76_attn_6&#45;&gt;layer76_attn_out_6 -->
<g id="edge2462" class="edge">
<title>layer76_attn_6&#45;&gt;layer76_attn_out_6</title>
<path fill="none" stroke="black" d="M871.5,-7142.25C871.5,-7142.25 871.5,-7080.88 871.5,-7080.88"/>
<polygon fill="black" stroke="black" points="875,-7080.88 871.5,-7070.88 868,-7080.88 875,-7080.88"/>
</g>
<!-- layer76_attn_out_7 -->
<g id="node1929" class="node">
<title>layer76_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1165.5,-7070.5 993.5,-7070.5 993.5,-7002.5 1165.5,-7002.5 1165.5,-7070.5"/>
<text text-anchor="middle" x="1079.5" y="-7055.3" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1079.5" y="-7040.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1079.5" y="-7025.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1079.5" y="-7010.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer76_attn_7&#45;&gt;layer76_attn_out_7 -->
<g id="edge2463" class="edge">
<title>layer76_attn_7&#45;&gt;layer76_attn_out_7</title>
<path fill="none" stroke="black" d="M1079.5,-7142.25C1079.5,-7142.25 1079.5,-7080.88 1079.5,-7080.88"/>
<polygon fill="black" stroke="black" points="1083,-7080.88 1079.5,-7070.88 1076,-7080.88 1083,-7080.88"/>
</g>
<!-- layer76_attn_ar -->
<g id="node1930" class="node">
<title>layer76_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="975.5" cy="-6882.41" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="975.5" y="-6901.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="975.5" y="-6886.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="975.5" y="-6871.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="975.5" y="-6856.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer76_attn_out_6&#45;&gt;layer76_attn_ar -->
<g id="edge2464" class="edge">
<title>layer76_attn_out_6&#45;&gt;layer76_attn_ar</title>
<path fill="none" stroke="black" d="M905.69,-7002.3C905.69,-7002.3 905.69,-6931.96 905.69,-6931.96"/>
<polygon fill="black" stroke="black" points="909.19,-6931.96 905.69,-6921.96 902.19,-6931.96 909.19,-6931.96"/>
</g>
<!-- layer76_attn_out_7&#45;&gt;layer76_attn_ar -->
<g id="edge2465" class="edge">
<title>layer76_attn_out_7&#45;&gt;layer76_attn_ar</title>
<path fill="none" stroke="black" d="M1045.31,-7002.3C1045.31,-7002.3 1045.31,-6931.96 1045.31,-6931.96"/>
<polygon fill="black" stroke="black" points="1048.81,-6931.96 1045.31,-6921.96 1041.81,-6931.96 1048.81,-6931.96"/>
</g>
<!-- layer76_ffn_norm_6 -->
<g id="node1931" class="node">
<title>layer76_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="953.5,-6762.33 781.5,-6762.33 781.5,-6694.33 953.5,-6694.33 953.5,-6762.33"/>
<text text-anchor="middle" x="867.5" y="-6747.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="867.5" y="-6732.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="867.5" y="-6717.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="867.5" y="-6702.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer76_attn_ar&#45;&gt;layer76_ffn_norm_6 -->
<g id="edge2466" class="edge">
<title>layer76_attn_ar&#45;&gt;layer76_ffn_norm_6</title>
<path fill="none" stroke="black" d="M903.69,-6843.53C903.69,-6843.53 903.69,-6772.48 903.69,-6772.48"/>
<polygon fill="black" stroke="black" points="907.19,-6772.48 903.69,-6762.48 900.19,-6772.48 907.19,-6772.48"/>
</g>
<!-- layer76_ffn_norm_7 -->
<g id="node1932" class="node">
<title>layer76_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1170.5,-6762.33 998.5,-6762.33 998.5,-6694.33 1170.5,-6694.33 1170.5,-6762.33"/>
<text text-anchor="middle" x="1084.5" y="-6747.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1084.5" y="-6732.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1084.5" y="-6717.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1084.5" y="-6702.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer76_attn_ar&#45;&gt;layer76_ffn_norm_7 -->
<g id="edge2467" class="edge">
<title>layer76_attn_ar&#45;&gt;layer76_ffn_norm_7</title>
<path fill="none" stroke="black" d="M1047.81,-6843.53C1047.81,-6843.53 1047.81,-6772.48 1047.81,-6772.48"/>
<polygon fill="black" stroke="black" points="1051.31,-6772.48 1047.81,-6762.48 1044.31,-6772.48 1051.31,-6772.48"/>
</g>
<!-- layer76_ffn_gate_6 -->
<g id="node1933" class="node">
<title>layer76_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="958,-6622.33 777,-6622.33 777,-6554.33 958,-6554.33 958,-6622.33"/>
<text text-anchor="middle" x="867.5" y="-6607.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="867.5" y="-6592.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="867.5" y="-6577.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="867.5" y="-6562.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_ffn_norm_6&#45;&gt;layer76_ffn_gate_6 -->
<g id="edge2468" class="edge">
<title>layer76_ffn_norm_6&#45;&gt;layer76_ffn_gate_6</title>
<path fill="none" stroke="black" d="M867.5,-6694.08C867.5,-6694.08 867.5,-6632.71 867.5,-6632.71"/>
<polygon fill="black" stroke="black" points="871,-6632.71 867.5,-6622.71 864,-6632.71 871,-6632.71"/>
</g>
<!-- layer76_ffn_up_6 -->
<g id="node1935" class="node">
<title>layer76_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="741,-6622.33 560,-6622.33 560,-6554.33 741,-6554.33 741,-6622.33"/>
<text text-anchor="middle" x="650.5" y="-6607.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="650.5" y="-6592.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="650.5" y="-6577.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="650.5" y="-6562.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_ffn_norm_6&#45;&gt;layer76_ffn_up_6 -->
<g id="edge2470" class="edge">
<title>layer76_ffn_norm_6&#45;&gt;layer76_ffn_up_6</title>
<path fill="none" stroke="black" d="M781.31,-6728C741.86,-6728 703.76,-6728 703.76,-6728 703.76,-6728 703.76,-6632.5 703.76,-6632.5"/>
<polygon fill="black" stroke="black" points="707.26,-6632.5 703.76,-6622.5 700.26,-6632.5 707.26,-6632.5"/>
</g>
<!-- layer76_ffn_gate_7 -->
<g id="node1934" class="node">
<title>layer76_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1392,-6622.33 1211,-6622.33 1211,-6554.33 1392,-6554.33 1392,-6622.33"/>
<text text-anchor="middle" x="1301.5" y="-6607.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1301.5" y="-6592.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1301.5" y="-6577.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1301.5" y="-6562.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_ffn_norm_7&#45;&gt;layer76_ffn_gate_7 -->
<g id="edge2469" class="edge">
<title>layer76_ffn_norm_7&#45;&gt;layer76_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1170.56,-6728C1209.95,-6728 1248,-6728 1248,-6728 1248,-6728 1248,-6632.5 1248,-6632.5"/>
<polygon fill="black" stroke="black" points="1251.5,-6632.5 1248,-6622.5 1244.5,-6632.5 1251.5,-6632.5"/>
</g>
<!-- layer76_ffn_up_7 -->
<g id="node1936" class="node">
<title>layer76_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1175,-6622.33 994,-6622.33 994,-6554.33 1175,-6554.33 1175,-6622.33"/>
<text text-anchor="middle" x="1084.5" y="-6607.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1084.5" y="-6592.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1084.5" y="-6577.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1084.5" y="-6562.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_ffn_norm_7&#45;&gt;layer76_ffn_up_7 -->
<g id="edge2471" class="edge">
<title>layer76_ffn_norm_7&#45;&gt;layer76_ffn_up_7</title>
<path fill="none" stroke="black" d="M1084.5,-6694.08C1084.5,-6694.08 1084.5,-6632.71 1084.5,-6632.71"/>
<polygon fill="black" stroke="black" points="1088,-6632.71 1084.5,-6622.71 1081,-6632.71 1088,-6632.71"/>
</g>
<!-- layer76_gate_ar -->
<g id="node1937" class="node">
<title>layer76_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1175.5" cy="-6434.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1175.5" y="-6453.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1175.5" y="-6438.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1175.5" y="-6423.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1175.5" y="-6408.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer76_ffn_gate_6&#45;&gt;layer76_gate_ar -->
<g id="edge2472" class="edge">
<title>layer76_ffn_gate_6&#45;&gt;layer76_gate_ar</title>
<path fill="none" stroke="black" d="M958.08,-6588C968.79,-6588 976,-6588 976,-6588 976,-6588 976,-6450 976,-6450 976,-6450 1044.56,-6450 1044.56,-6450"/>
<polygon fill="black" stroke="black" points="1044.56,-6453.5 1054.56,-6450 1044.56,-6446.5 1044.56,-6453.5"/>
</g>
<!-- layer76_ffn_gate_7&#45;&gt;layer76_gate_ar -->
<g id="edge2473" class="edge">
<title>layer76_ffn_gate_7&#45;&gt;layer76_gate_ar</title>
<path fill="none" stroke="black" d="M1257.24,-6554.14C1257.24,-6554.14 1257.24,-6481.31 1257.24,-6481.31"/>
<polygon fill="black" stroke="black" points="1260.74,-6481.31 1257.24,-6471.31 1253.74,-6481.31 1260.74,-6481.31"/>
</g>
<!-- layer76_up_ar -->
<g id="node1938" class="node">
<title>layer76_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="829.5" cy="-6434.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="829.5" y="-6453.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="829.5" y="-6438.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="829.5" y="-6423.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="829.5" y="-6408.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer76_ffn_up_6&#45;&gt;layer76_up_ar -->
<g id="edge2474" class="edge">
<title>layer76_ffn_up_6&#45;&gt;layer76_up_ar</title>
<path fill="none" stroke="black" d="M721.26,-6554.14C721.26,-6554.14 721.26,-6470.21 721.26,-6470.21"/>
<polygon fill="black" stroke="black" points="724.76,-6470.21 721.26,-6460.21 717.76,-6470.21 724.76,-6470.21"/>
</g>
<!-- layer76_ffn_up_7&#45;&gt;layer76_up_ar -->
<g id="edge2475" class="edge">
<title>layer76_ffn_up_7&#45;&gt;layer76_up_ar</title>
<path fill="none" stroke="black" d="M1020.76,-6554.27C1020.76,-6504.56 1020.76,-6418 1020.76,-6418 1020.76,-6418 960.08,-6418 960.08,-6418"/>
<polygon fill="black" stroke="black" points="960.08,-6414.5 950.08,-6418 960.08,-6421.5 960.08,-6414.5"/>
</g>
<!-- layer76_silu_6 -->
<g id="node1939" class="node">
<title>layer76_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="1103,-6314.16 922,-6314.16 922,-6246.16 1103,-6246.16 1103,-6314.16"/>
<text text-anchor="middle" x="1012.5" y="-6298.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1012.5" y="-6283.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1012.5" y="-6268.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1012.5" y="-6253.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_gate_ar&#45;&gt;layer76_silu_6 -->
<g id="edge2476" class="edge">
<title>layer76_gate_ar&#45;&gt;layer76_silu_6</title>
<path fill="none" stroke="black" d="M1075.26,-6404.17C1075.26,-6404.17 1075.26,-6324.19 1075.26,-6324.19"/>
<polygon fill="black" stroke="black" points="1078.76,-6324.19 1075.26,-6314.19 1071.76,-6324.19 1078.76,-6324.19"/>
</g>
<!-- layer76_silu_7 -->
<g id="node1940" class="node">
<title>layer76_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1320,-6314.16 1139,-6314.16 1139,-6246.16 1320,-6246.16 1320,-6314.16"/>
<text text-anchor="middle" x="1229.5" y="-6298.96" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1229.5" y="-6283.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1229.5" y="-6268.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1229.5" y="-6253.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_gate_ar&#45;&gt;layer76_silu_7 -->
<g id="edge2477" class="edge">
<title>layer76_gate_ar&#45;&gt;layer76_silu_7</title>
<path fill="none" stroke="black" d="M1221.24,-6389.27C1221.24,-6389.27 1221.24,-6324.17 1221.24,-6324.17"/>
<polygon fill="black" stroke="black" points="1224.74,-6324.17 1221.24,-6314.17 1217.74,-6324.17 1224.74,-6324.17"/>
</g>
<!-- layer76_mul_6 -->
<g id="node1941" class="node">
<title>layer76_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="993,-6174.16 812,-6174.16 812,-6106.16 993,-6106.16 993,-6174.16"/>
<text text-anchor="middle" x="902.5" y="-6158.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="902.5" y="-6143.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="902.5" y="-6128.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="902.5" y="-6113.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_up_ar&#45;&gt;layer76_mul_6 -->
<g id="edge2479" class="edge">
<title>layer76_up_ar&#45;&gt;layer76_mul_6</title>
<path fill="none" stroke="black" d="M867,-6387.97C867,-6387.97 867,-6184.25 867,-6184.25"/>
<polygon fill="black" stroke="black" points="870.5,-6184.25 867,-6174.25 863.5,-6184.25 870.5,-6184.25"/>
</g>
<!-- layer76_mul_7 -->
<g id="node1942" class="node">
<title>layer76_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1210,-6174.16 1029,-6174.16 1029,-6106.16 1210,-6106.16 1210,-6174.16"/>
<text text-anchor="middle" x="1119.5" y="-6158.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1119.5" y="-6143.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1119.5" y="-6128.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1119.5" y="-6113.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer76_up_ar&#45;&gt;layer76_mul_7 -->
<g id="edge2481" class="edge">
<title>layer76_up_ar&#45;&gt;layer76_mul_7</title>
<path fill="none" stroke="black" d="M939.74,-6409.43C939.74,-6384.58 939.74,-6350 939.74,-6350 939.74,-6350 1121,-6350 1121,-6350 1121,-6350 1121,-6184.35 1121,-6184.35"/>
<polygon fill="black" stroke="black" points="1124.5,-6184.35 1121,-6174.35 1117.5,-6184.35 1124.5,-6184.35"/>
</g>
<!-- layer76_silu_6&#45;&gt;layer76_mul_6 -->
<g id="edge2478" class="edge">
<title>layer76_silu_6&#45;&gt;layer76_mul_6</title>
<path fill="none" stroke="black" d="M957.5,-6245.92C957.5,-6245.92 957.5,-6184.54 957.5,-6184.54"/>
<polygon fill="black" stroke="black" points="961,-6184.54 957.5,-6174.54 954,-6184.54 961,-6184.54"/>
</g>
<!-- layer76_silu_7&#45;&gt;layer76_mul_7 -->
<g id="edge2480" class="edge">
<title>layer76_silu_7&#45;&gt;layer76_mul_7</title>
<path fill="none" stroke="black" d="M1174.5,-6245.92C1174.5,-6245.92 1174.5,-6184.54 1174.5,-6184.54"/>
<polygon fill="black" stroke="black" points="1178,-6184.54 1174.5,-6174.54 1171,-6184.54 1178,-6184.54"/>
</g>
<!-- layer76_ffn_down_6 -->
<g id="node1943" class="node">
<title>layer76_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="992.5,-6034.16 820.5,-6034.16 820.5,-5966.16 992.5,-5966.16 992.5,-6034.16"/>
<text text-anchor="middle" x="906.5" y="-6018.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="906.5" y="-6003.96" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="906.5" y="-5988.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="906.5" y="-5973.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer76_mul_6&#45;&gt;layer76_ffn_down_6 -->
<g id="edge2482" class="edge">
<title>layer76_mul_6&#45;&gt;layer76_ffn_down_6</title>
<path fill="none" stroke="black" d="M906.5,-6105.92C906.5,-6105.92 906.5,-6044.54 906.5,-6044.54"/>
<polygon fill="black" stroke="black" points="910,-6044.54 906.5,-6034.54 903,-6044.54 910,-6044.54"/>
</g>
<!-- layer76_ffn_down_7 -->
<g id="node1944" class="node">
<title>layer76_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1202.5,-6034.16 1030.5,-6034.16 1030.5,-5966.16 1202.5,-5966.16 1202.5,-6034.16"/>
<text text-anchor="middle" x="1116.5" y="-6018.96" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1116.5" y="-6003.96" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1116.5" y="-5988.96" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1116.5" y="-5973.96" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer76_mul_7&#45;&gt;layer76_ffn_down_7 -->
<g id="edge2483" class="edge">
<title>layer76_mul_7&#45;&gt;layer76_ffn_down_7</title>
<path fill="none" stroke="black" d="M1116.5,-6105.92C1116.5,-6105.92 1116.5,-6044.54 1116.5,-6044.54"/>
<polygon fill="black" stroke="black" points="1120,-6044.54 1116.5,-6034.54 1113,-6044.54 1120,-6044.54"/>
</g>
<!-- layer76_ffn_ar -->
<g id="node1945" class="node">
<title>layer76_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1010.5" cy="-5846.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1010.5" y="-5864.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1010.5" y="-5849.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1010.5" y="-5834.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1010.5" y="-5819.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer76_ffn_down_6&#45;&gt;layer76_ffn_ar -->
<g id="edge2484" class="edge">
<title>layer76_ffn_down_6&#45;&gt;layer76_ffn_ar</title>
<path fill="none" stroke="black" d="M940.69,-5965.97C940.69,-5965.97 940.69,-5895.62 940.69,-5895.62"/>
<polygon fill="black" stroke="black" points="944.19,-5895.62 940.69,-5885.62 937.19,-5895.62 944.19,-5895.62"/>
</g>
<!-- layer76_ffn_down_7&#45;&gt;layer76_ffn_ar -->
<g id="edge2485" class="edge">
<title>layer76_ffn_down_7&#45;&gt;layer76_ffn_ar</title>
<path fill="none" stroke="black" d="M1081.31,-5965.97C1081.31,-5965.97 1081.31,-5895.35 1081.31,-5895.35"/>
<polygon fill="black" stroke="black" points="1084.81,-5895.35 1081.31,-5885.35 1077.81,-5895.35 1084.81,-5895.35"/>
</g>
<!-- layer77_norm_6 -->
<g id="node1946" class="node">
<title>layer77_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="992.5,-5726 820.5,-5726 820.5,-5658 992.5,-5658 992.5,-5726"/>
<text text-anchor="middle" x="906.5" y="-5710.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="906.5" y="-5695.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="906.5" y="-5680.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="906.5" y="-5665.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer76_ffn_ar&#45;&gt;layer77_norm_6 -->
<g id="edge2486" class="edge">
<title>layer76_ffn_ar&#45;&gt;layer77_norm_6</title>
<path fill="none" stroke="black" d="M940.69,-5806.4C940.69,-5806.4 940.69,-5736.06 940.69,-5736.06"/>
<polygon fill="black" stroke="black" points="944.19,-5736.06 940.69,-5726.06 937.19,-5736.06 944.19,-5736.06"/>
</g>
<!-- layer77_norm_7 -->
<g id="node1947" class="node">
<title>layer77_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1202.5,-5726 1030.5,-5726 1030.5,-5658 1202.5,-5658 1202.5,-5726"/>
<text text-anchor="middle" x="1116.5" y="-5710.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1116.5" y="-5695.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1116.5" y="-5680.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1116.5" y="-5665.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer76_ffn_ar&#45;&gt;layer77_norm_7 -->
<g id="edge2487" class="edge">
<title>layer76_ffn_ar&#45;&gt;layer77_norm_7</title>
<path fill="none" stroke="black" d="M1081.31,-5806.8C1081.31,-5806.8 1081.31,-5736.23 1081.31,-5736.23"/>
<polygon fill="black" stroke="black" points="1084.81,-5736.23 1081.31,-5726.23 1077.81,-5736.23 1084.81,-5736.23"/>
</g>
<!-- layer77_qkv_6 -->
<g id="node1948" class="node">
<title>layer77_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="993,-5586 812,-5586 812,-5518 993,-5518 993,-5586"/>
<text text-anchor="middle" x="902.5" y="-5570.8" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="902.5" y="-5555.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="902.5" y="-5540.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="902.5" y="-5525.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer77_norm_6&#45;&gt;layer77_qkv_6 -->
<g id="edge2488" class="edge">
<title>layer77_norm_6&#45;&gt;layer77_qkv_6</title>
<path fill="none" stroke="black" d="M906.5,-5657.75C906.5,-5657.75 906.5,-5596.38 906.5,-5596.38"/>
<polygon fill="black" stroke="black" points="910,-5596.38 906.5,-5586.38 903,-5596.38 910,-5596.38"/>
</g>
<!-- layer77_qkv_7 -->
<g id="node1949" class="node">
<title>layer77_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1210,-5586 1029,-5586 1029,-5518 1210,-5518 1210,-5586"/>
<text text-anchor="middle" x="1119.5" y="-5570.8" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1119.5" y="-5555.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1119.5" y="-5540.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1119.5" y="-5525.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer77_norm_7&#45;&gt;layer77_qkv_7 -->
<g id="edge2489" class="edge">
<title>layer77_norm_7&#45;&gt;layer77_qkv_7</title>
<path fill="none" stroke="black" d="M1116.5,-5657.75C1116.5,-5657.75 1116.5,-5596.38 1116.5,-5596.38"/>
<polygon fill="black" stroke="black" points="1120,-5596.38 1116.5,-5586.38 1113,-5596.38 1120,-5596.38"/>
</g>
<!-- layer77_qkv_ar -->
<g id="node1950" class="node">
<title>layer77_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1010.5" cy="-5397.92" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1010.5" y="-5416.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1010.5" y="-5401.72" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1010.5" y="-5386.72" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1010.5" y="-5371.72" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer77_qkv_6&#45;&gt;layer77_qkv_ar -->
<g id="edge2490" class="edge">
<title>layer77_qkv_6&#45;&gt;layer77_qkv_ar</title>
<path fill="none" stroke="black" d="M937.76,-5517.8C937.76,-5517.8 937.76,-5447.74 937.76,-5447.74"/>
<polygon fill="black" stroke="black" points="941.26,-5447.74 937.76,-5437.74 934.26,-5447.74 941.26,-5447.74"/>
</g>
<!-- layer77_qkv_7&#45;&gt;layer77_qkv_ar -->
<g id="edge2491" class="edge">
<title>layer77_qkv_7&#45;&gt;layer77_qkv_ar</title>
<path fill="none" stroke="black" d="M1083.74,-5517.8C1083.74,-5517.8 1083.74,-5447.46 1083.74,-5447.46"/>
<polygon fill="black" stroke="black" points="1087.24,-5447.46 1083.74,-5437.46 1080.24,-5447.46 1087.24,-5447.46"/>
</g>
<!-- layer77_attn_6 -->
<g id="node1951" class="node">
<title>layer77_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="992.5,-5277.83 820.5,-5277.83 820.5,-5209.83 992.5,-5209.83 992.5,-5277.83"/>
<text text-anchor="middle" x="906.5" y="-5262.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="906.5" y="-5247.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="906.5" y="-5232.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="906.5" y="-5217.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer77_qkv_ar&#45;&gt;layer77_attn_6 -->
<g id="edge2492" class="edge">
<title>layer77_qkv_ar&#45;&gt;layer77_attn_6</title>
<path fill="none" stroke="black" d="M937.51,-5358.23C937.51,-5358.23 937.51,-5287.89 937.51,-5287.89"/>
<polygon fill="black" stroke="black" points="941.01,-5287.89 937.51,-5277.89 934.01,-5287.89 941.01,-5287.89"/>
</g>
<!-- layer77_attn_7 -->
<g id="node1952" class="node">
<title>layer77_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1200.5,-5277.83 1028.5,-5277.83 1028.5,-5209.83 1200.5,-5209.83 1200.5,-5277.83"/>
<text text-anchor="middle" x="1114.5" y="-5262.63" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1114.5" y="-5247.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1114.5" y="-5232.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1114.5" y="-5217.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer77_qkv_ar&#45;&gt;layer77_attn_7 -->
<g id="edge2493" class="edge">
<title>layer77_qkv_ar&#45;&gt;layer77_attn_7</title>
<path fill="none" stroke="black" d="M1083.49,-5358.23C1083.49,-5358.23 1083.49,-5287.89 1083.49,-5287.89"/>
<polygon fill="black" stroke="black" points="1086.99,-5287.89 1083.49,-5277.89 1079.99,-5287.89 1086.99,-5287.89"/>
</g>
<!-- layer77_attn_out_6 -->
<g id="node1953" class="node">
<title>layer77_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="992.5,-5137.83 820.5,-5137.83 820.5,-5069.83 992.5,-5069.83 992.5,-5137.83"/>
<text text-anchor="middle" x="906.5" y="-5122.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="906.5" y="-5107.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="906.5" y="-5092.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="906.5" y="-5077.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer77_attn_6&#45;&gt;layer77_attn_out_6 -->
<g id="edge2494" class="edge">
<title>layer77_attn_6&#45;&gt;layer77_attn_out_6</title>
<path fill="none" stroke="black" d="M906.5,-5209.58C906.5,-5209.58 906.5,-5148.21 906.5,-5148.21"/>
<polygon fill="black" stroke="black" points="910,-5148.21 906.5,-5138.21 903,-5148.21 910,-5148.21"/>
</g>
<!-- layer77_attn_out_7 -->
<g id="node1954" class="node">
<title>layer77_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1200.5,-5137.83 1028.5,-5137.83 1028.5,-5069.83 1200.5,-5069.83 1200.5,-5137.83"/>
<text text-anchor="middle" x="1114.5" y="-5122.63" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1114.5" y="-5107.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1114.5" y="-5092.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1114.5" y="-5077.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer77_attn_7&#45;&gt;layer77_attn_out_7 -->
<g id="edge2495" class="edge">
<title>layer77_attn_7&#45;&gt;layer77_attn_out_7</title>
<path fill="none" stroke="black" d="M1114.5,-5209.58C1114.5,-5209.58 1114.5,-5148.21 1114.5,-5148.21"/>
<polygon fill="black" stroke="black" points="1118,-5148.21 1114.5,-5138.21 1111,-5148.21 1118,-5148.21"/>
</g>
<!-- layer77_attn_ar -->
<g id="node1955" class="node">
<title>layer77_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1010.5" cy="-4949.75" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1010.5" y="-4968.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1010.5" y="-4953.55" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1010.5" y="-4938.55" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1010.5" y="-4923.55" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer77_attn_out_6&#45;&gt;layer77_attn_ar -->
<g id="edge2496" class="edge">
<title>layer77_attn_out_6&#45;&gt;layer77_attn_ar</title>
<path fill="none" stroke="black" d="M940.69,-5069.64C940.69,-5069.64 940.69,-4999.29 940.69,-4999.29"/>
<polygon fill="black" stroke="black" points="944.19,-4999.29 940.69,-4989.29 937.19,-4999.29 944.19,-4999.29"/>
</g>
<!-- layer77_attn_out_7&#45;&gt;layer77_attn_ar -->
<g id="edge2497" class="edge">
<title>layer77_attn_out_7&#45;&gt;layer77_attn_ar</title>
<path fill="none" stroke="black" d="M1080.31,-5069.64C1080.31,-5069.64 1080.31,-4999.29 1080.31,-4999.29"/>
<polygon fill="black" stroke="black" points="1083.81,-4999.29 1080.31,-4989.29 1076.81,-4999.29 1083.81,-4999.29"/>
</g>
<!-- layer77_ffn_norm_6 -->
<g id="node1956" class="node">
<title>layer77_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="988.5,-4829.67 816.5,-4829.67 816.5,-4761.67 988.5,-4761.67 988.5,-4829.67"/>
<text text-anchor="middle" x="902.5" y="-4814.47" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="902.5" y="-4799.47" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="902.5" y="-4784.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="902.5" y="-4769.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer77_attn_ar&#45;&gt;layer77_ffn_norm_6 -->
<g id="edge2498" class="edge">
<title>layer77_attn_ar&#45;&gt;layer77_ffn_norm_6</title>
<path fill="none" stroke="black" d="M938.69,-4910.87C938.69,-4910.87 938.69,-4839.81 938.69,-4839.81"/>
<polygon fill="black" stroke="black" points="942.19,-4839.81 938.69,-4829.81 935.19,-4839.81 942.19,-4839.81"/>
</g>
<!-- layer77_ffn_norm_7 -->
<g id="node1957" class="node">
<title>layer77_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1205.5,-4829.67 1033.5,-4829.67 1033.5,-4761.67 1205.5,-4761.67 1205.5,-4829.67"/>
<text text-anchor="middle" x="1119.5" y="-4814.47" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1119.5" y="-4799.47" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1119.5" y="-4784.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1119.5" y="-4769.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer77_attn_ar&#45;&gt;layer77_ffn_norm_7 -->
<g id="edge2499" class="edge">
<title>layer77_attn_ar&#45;&gt;layer77_ffn_norm_7</title>
<path fill="none" stroke="black" d="M1082.81,-4910.87C1082.81,-4910.87 1082.81,-4839.81 1082.81,-4839.81"/>
<polygon fill="black" stroke="black" points="1086.31,-4839.81 1082.81,-4829.81 1079.31,-4839.81 1086.31,-4839.81"/>
</g>
<!-- layer77_ffn_gate_6 -->
<g id="node1958" class="node">
<title>layer77_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="993,-4689.67 812,-4689.67 812,-4621.67 993,-4621.67 993,-4689.67"/>
<text text-anchor="middle" x="902.5" y="-4674.47" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="902.5" y="-4659.47" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="902.5" y="-4644.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="902.5" y="-4629.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_ffn_norm_6&#45;&gt;layer77_ffn_gate_6 -->
<g id="edge2500" class="edge">
<title>layer77_ffn_norm_6&#45;&gt;layer77_ffn_gate_6</title>
<path fill="none" stroke="black" d="M902.5,-4761.42C902.5,-4761.42 902.5,-4700.04 902.5,-4700.04"/>
<polygon fill="black" stroke="black" points="906,-4700.04 902.5,-4690.04 899,-4700.04 906,-4700.04"/>
</g>
<!-- layer77_ffn_up_6 -->
<g id="node1960" class="node">
<title>layer77_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="776,-4689.67 595,-4689.67 595,-4621.67 776,-4621.67 776,-4689.67"/>
<text text-anchor="middle" x="685.5" y="-4674.47" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="685.5" y="-4659.47" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="685.5" y="-4644.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="685.5" y="-4629.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_ffn_norm_6&#45;&gt;layer77_ffn_up_6 -->
<g id="edge2502" class="edge">
<title>layer77_ffn_norm_6&#45;&gt;layer77_ffn_up_6</title>
<path fill="none" stroke="black" d="M816.31,-4795C776.86,-4795 738.76,-4795 738.76,-4795 738.76,-4795 738.76,-4699.75 738.76,-4699.75"/>
<polygon fill="black" stroke="black" points="742.26,-4699.75 738.76,-4689.75 735.26,-4699.75 742.26,-4699.75"/>
</g>
<!-- layer77_ffn_gate_7 -->
<g id="node1959" class="node">
<title>layer77_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1427,-4689.67 1246,-4689.67 1246,-4621.67 1427,-4621.67 1427,-4689.67"/>
<text text-anchor="middle" x="1336.5" y="-4674.47" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1336.5" y="-4659.47" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1336.5" y="-4644.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1336.5" y="-4629.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_ffn_norm_7&#45;&gt;layer77_ffn_gate_7 -->
<g id="edge2501" class="edge">
<title>layer77_ffn_norm_7&#45;&gt;layer77_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1205.56,-4795C1244.95,-4795 1283,-4795 1283,-4795 1283,-4795 1283,-4699.75 1283,-4699.75"/>
<polygon fill="black" stroke="black" points="1286.5,-4699.75 1283,-4689.75 1279.5,-4699.75 1286.5,-4699.75"/>
</g>
<!-- layer77_ffn_up_7 -->
<g id="node1961" class="node">
<title>layer77_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1210,-4689.67 1029,-4689.67 1029,-4621.67 1210,-4621.67 1210,-4689.67"/>
<text text-anchor="middle" x="1119.5" y="-4674.47" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1119.5" y="-4659.47" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1119.5" y="-4644.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1119.5" y="-4629.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_ffn_norm_7&#45;&gt;layer77_ffn_up_7 -->
<g id="edge2503" class="edge">
<title>layer77_ffn_norm_7&#45;&gt;layer77_ffn_up_7</title>
<path fill="none" stroke="black" d="M1119.5,-4761.42C1119.5,-4761.42 1119.5,-4700.04 1119.5,-4700.04"/>
<polygon fill="black" stroke="black" points="1123,-4700.04 1119.5,-4690.04 1116,-4700.04 1123,-4700.04"/>
</g>
<!-- layer77_gate_ar -->
<g id="node1962" class="node">
<title>layer77_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1210.5" cy="-4501.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1210.5" y="-4520.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1210.5" y="-4505.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1210.5" y="-4490.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1210.5" y="-4475.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer77_ffn_gate_6&#45;&gt;layer77_gate_ar -->
<g id="edge2504" class="edge">
<title>layer77_ffn_gate_6&#45;&gt;layer77_gate_ar</title>
<path fill="none" stroke="black" d="M993.08,-4655C1003.79,-4655 1011,-4655 1011,-4655 1011,-4655 1011,-4517 1011,-4517 1011,-4517 1078.99,-4517 1078.99,-4517"/>
<polygon fill="black" stroke="black" points="1078.99,-4520.5 1088.99,-4517 1078.99,-4513.5 1078.99,-4520.5"/>
</g>
<!-- layer77_ffn_gate_7&#45;&gt;layer77_gate_ar -->
<g id="edge2505" class="edge">
<title>layer77_ffn_gate_7&#45;&gt;layer77_gate_ar</title>
<path fill="none" stroke="black" d="M1292.24,-4621.47C1292.24,-4621.47 1292.24,-4548.64 1292.24,-4548.64"/>
<polygon fill="black" stroke="black" points="1295.74,-4548.64 1292.24,-4538.64 1288.74,-4548.65 1295.74,-4548.64"/>
</g>
<!-- layer77_up_ar -->
<g id="node1963" class="node">
<title>layer77_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="864.5" cy="-4501.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="864.5" y="-4520.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="864.5" y="-4505.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="864.5" y="-4490.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="864.5" y="-4475.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer77_ffn_up_6&#45;&gt;layer77_up_ar -->
<g id="edge2506" class="edge">
<title>layer77_ffn_up_6&#45;&gt;layer77_up_ar</title>
<path fill="none" stroke="black" d="M756.26,-4621.47C756.26,-4621.47 756.26,-4537.55 756.26,-4537.55"/>
<polygon fill="black" stroke="black" points="759.76,-4537.55 756.26,-4527.55 752.76,-4537.55 759.76,-4537.55"/>
</g>
<!-- layer77_ffn_up_7&#45;&gt;layer77_up_ar -->
<g id="edge2507" class="edge">
<title>layer77_ffn_up_7&#45;&gt;layer77_up_ar</title>
<path fill="none" stroke="black" d="M1055.76,-4621.54C1055.76,-4571.73 1055.76,-4485 1055.76,-4485 1055.76,-4485 994.81,-4485 994.81,-4485"/>
<polygon fill="black" stroke="black" points="994.81,-4481.5 984.81,-4485 994.81,-4488.5 994.81,-4481.5"/>
</g>
<!-- layer77_silu_6 -->
<g id="node1964" class="node">
<title>layer77_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="1138,-4381.5 957,-4381.5 957,-4313.5 1138,-4313.5 1138,-4381.5"/>
<text text-anchor="middle" x="1047.5" y="-4366.3" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1047.5" y="-4351.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1047.5" y="-4336.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1047.5" y="-4321.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_gate_ar&#45;&gt;layer77_silu_6 -->
<g id="edge2508" class="edge">
<title>layer77_gate_ar&#45;&gt;layer77_silu_6</title>
<path fill="none" stroke="black" d="M1110.26,-4471.51C1110.26,-4471.51 1110.26,-4391.52 1110.26,-4391.52"/>
<polygon fill="black" stroke="black" points="1113.76,-4391.52 1110.26,-4381.52 1106.76,-4391.52 1113.76,-4391.52"/>
</g>
<!-- layer77_silu_7 -->
<g id="node1965" class="node">
<title>layer77_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1355,-4381.5 1174,-4381.5 1174,-4313.5 1355,-4313.5 1355,-4381.5"/>
<text text-anchor="middle" x="1264.5" y="-4366.3" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1264.5" y="-4351.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1264.5" y="-4336.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1264.5" y="-4321.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_gate_ar&#45;&gt;layer77_silu_7 -->
<g id="edge2509" class="edge">
<title>layer77_gate_ar&#45;&gt;layer77_silu_7</title>
<path fill="none" stroke="black" d="M1256.24,-4456.6C1256.24,-4456.6 1256.24,-4391.51 1256.24,-4391.51"/>
<polygon fill="black" stroke="black" points="1259.74,-4391.51 1256.24,-4381.51 1252.74,-4391.51 1259.74,-4391.51"/>
</g>
<!-- layer77_mul_6 -->
<g id="node1966" class="node">
<title>layer77_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="1028,-4241.5 847,-4241.5 847,-4173.5 1028,-4173.5 1028,-4241.5"/>
<text text-anchor="middle" x="937.5" y="-4226.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="937.5" y="-4211.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="937.5" y="-4196.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="937.5" y="-4181.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_up_ar&#45;&gt;layer77_mul_6 -->
<g id="edge2511" class="edge">
<title>layer77_up_ar&#45;&gt;layer77_mul_6</title>
<path fill="none" stroke="black" d="M902,-4455.31C902,-4455.31 902,-4251.58 902,-4251.58"/>
<polygon fill="black" stroke="black" points="905.5,-4251.58 902,-4241.58 898.5,-4251.58 905.5,-4251.58"/>
</g>
<!-- layer77_mul_7 -->
<g id="node1967" class="node">
<title>layer77_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1245,-4241.5 1064,-4241.5 1064,-4173.5 1245,-4173.5 1245,-4241.5"/>
<text text-anchor="middle" x="1154.5" y="-4226.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1154.5" y="-4211.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1154.5" y="-4196.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1154.5" y="-4181.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer77_up_ar&#45;&gt;layer77_mul_7 -->
<g id="edge2513" class="edge">
<title>layer77_up_ar&#45;&gt;layer77_mul_7</title>
<path fill="none" stroke="black" d="M974.74,-4477.12C974.74,-4452.14 974.74,-4417 974.74,-4417 974.74,-4417 1156,-4417 1156,-4417 1156,-4417 1156,-4251.62 1156,-4251.62"/>
<polygon fill="black" stroke="black" points="1159.5,-4251.62 1156,-4241.62 1152.5,-4251.63 1159.5,-4251.62"/>
</g>
<!-- layer77_silu_6&#45;&gt;layer77_mul_6 -->
<g id="edge2510" class="edge">
<title>layer77_silu_6&#45;&gt;layer77_mul_6</title>
<path fill="none" stroke="black" d="M992.5,-4313.25C992.5,-4313.25 992.5,-4251.88 992.5,-4251.88"/>
<polygon fill="black" stroke="black" points="996,-4251.88 992.5,-4241.88 989,-4251.88 996,-4251.88"/>
</g>
<!-- layer77_silu_7&#45;&gt;layer77_mul_7 -->
<g id="edge2512" class="edge">
<title>layer77_silu_7&#45;&gt;layer77_mul_7</title>
<path fill="none" stroke="black" d="M1209.5,-4313.25C1209.5,-4313.25 1209.5,-4251.88 1209.5,-4251.88"/>
<polygon fill="black" stroke="black" points="1213,-4251.88 1209.5,-4241.88 1206,-4251.88 1213,-4251.88"/>
</g>
<!-- layer77_ffn_down_6 -->
<g id="node1968" class="node">
<title>layer77_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="1027.5,-4101.5 855.5,-4101.5 855.5,-4033.5 1027.5,-4033.5 1027.5,-4101.5"/>
<text text-anchor="middle" x="941.5" y="-4086.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="941.5" y="-4071.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="941.5" y="-4056.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="941.5" y="-4041.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer77_mul_6&#45;&gt;layer77_ffn_down_6 -->
<g id="edge2514" class="edge">
<title>layer77_mul_6&#45;&gt;layer77_ffn_down_6</title>
<path fill="none" stroke="black" d="M941.5,-4173.25C941.5,-4173.25 941.5,-4111.88 941.5,-4111.88"/>
<polygon fill="black" stroke="black" points="945,-4111.88 941.5,-4101.88 938,-4111.88 945,-4111.88"/>
</g>
<!-- layer77_ffn_down_7 -->
<g id="node1969" class="node">
<title>layer77_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1237.5,-4101.5 1065.5,-4101.5 1065.5,-4033.5 1237.5,-4033.5 1237.5,-4101.5"/>
<text text-anchor="middle" x="1151.5" y="-4086.3" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1151.5" y="-4071.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1151.5" y="-4056.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1151.5" y="-4041.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer77_mul_7&#45;&gt;layer77_ffn_down_7 -->
<g id="edge2515" class="edge">
<title>layer77_mul_7&#45;&gt;layer77_ffn_down_7</title>
<path fill="none" stroke="black" d="M1151.5,-4173.25C1151.5,-4173.25 1151.5,-4111.88 1151.5,-4111.88"/>
<polygon fill="black" stroke="black" points="1155,-4111.88 1151.5,-4101.88 1148,-4111.88 1155,-4111.88"/>
</g>
<!-- layer77_ffn_ar -->
<g id="node1970" class="node">
<title>layer77_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1045.5" cy="-3913.42" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1045.5" y="-3932.22" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1045.5" y="-3917.22" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1045.5" y="-3902.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1045.5" y="-3887.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer77_ffn_down_6&#45;&gt;layer77_ffn_ar -->
<g id="edge2516" class="edge">
<title>layer77_ffn_down_6&#45;&gt;layer77_ffn_ar</title>
<path fill="none" stroke="black" d="M975.69,-4033.3C975.69,-4033.3 975.69,-3962.96 975.69,-3962.96"/>
<polygon fill="black" stroke="black" points="979.19,-3962.96 975.69,-3952.96 972.19,-3962.96 979.19,-3962.96"/>
</g>
<!-- layer77_ffn_down_7&#45;&gt;layer77_ffn_ar -->
<g id="edge2517" class="edge">
<title>layer77_ffn_down_7&#45;&gt;layer77_ffn_ar</title>
<path fill="none" stroke="black" d="M1116.31,-4033.3C1116.31,-4033.3 1116.31,-3962.68 1116.31,-3962.68"/>
<polygon fill="black" stroke="black" points="1119.81,-3962.68 1116.31,-3952.68 1112.81,-3962.68 1119.81,-3962.68"/>
</g>
<!-- layer78_norm_6 -->
<g id="node1971" class="node">
<title>layer78_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="1027.5,-3793.33 855.5,-3793.33 855.5,-3725.33 1027.5,-3725.33 1027.5,-3793.33"/>
<text text-anchor="middle" x="941.5" y="-3778.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="941.5" y="-3763.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="941.5" y="-3748.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="941.5" y="-3733.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer77_ffn_ar&#45;&gt;layer78_norm_6 -->
<g id="edge2518" class="edge">
<title>layer77_ffn_ar&#45;&gt;layer78_norm_6</title>
<path fill="none" stroke="black" d="M975.69,-3873.74C975.69,-3873.74 975.69,-3803.39 975.69,-3803.39"/>
<polygon fill="black" stroke="black" points="979.19,-3803.39 975.69,-3793.39 972.19,-3803.39 979.19,-3803.39"/>
</g>
<!-- layer78_norm_7 -->
<g id="node1972" class="node">
<title>layer78_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1237.5,-3793.33 1065.5,-3793.33 1065.5,-3725.33 1237.5,-3725.33 1237.5,-3793.33"/>
<text text-anchor="middle" x="1151.5" y="-3778.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1151.5" y="-3763.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1151.5" y="-3748.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1151.5" y="-3733.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer77_ffn_ar&#45;&gt;layer78_norm_7 -->
<g id="edge2519" class="edge">
<title>layer77_ffn_ar&#45;&gt;layer78_norm_7</title>
<path fill="none" stroke="black" d="M1116.31,-3874.14C1116.31,-3874.14 1116.31,-3803.56 1116.31,-3803.56"/>
<polygon fill="black" stroke="black" points="1119.81,-3803.56 1116.31,-3793.56 1112.81,-3803.56 1119.81,-3803.56"/>
</g>
<!-- layer78_qkv_6 -->
<g id="node1973" class="node">
<title>layer78_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="1028,-3653.33 847,-3653.33 847,-3585.33 1028,-3585.33 1028,-3653.33"/>
<text text-anchor="middle" x="937.5" y="-3638.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="937.5" y="-3623.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="937.5" y="-3608.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="937.5" y="-3593.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer78_norm_6&#45;&gt;layer78_qkv_6 -->
<g id="edge2520" class="edge">
<title>layer78_norm_6&#45;&gt;layer78_qkv_6</title>
<path fill="none" stroke="black" d="M941.5,-3725.08C941.5,-3725.08 941.5,-3663.71 941.5,-3663.71"/>
<polygon fill="black" stroke="black" points="945,-3663.71 941.5,-3653.71 938,-3663.71 945,-3663.71"/>
</g>
<!-- layer78_qkv_7 -->
<g id="node1974" class="node">
<title>layer78_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1245,-3653.33 1064,-3653.33 1064,-3585.33 1245,-3585.33 1245,-3653.33"/>
<text text-anchor="middle" x="1154.5" y="-3638.13" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1154.5" y="-3623.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1154.5" y="-3608.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1154.5" y="-3593.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer78_norm_7&#45;&gt;layer78_qkv_7 -->
<g id="edge2521" class="edge">
<title>layer78_norm_7&#45;&gt;layer78_qkv_7</title>
<path fill="none" stroke="black" d="M1151.5,-3725.08C1151.5,-3725.08 1151.5,-3663.71 1151.5,-3663.71"/>
<polygon fill="black" stroke="black" points="1155,-3663.71 1151.5,-3653.71 1148,-3663.71 1155,-3663.71"/>
</g>
<!-- layer78_qkv_ar -->
<g id="node1975" class="node">
<title>layer78_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1045.5" cy="-3465.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1045.5" y="-3484.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1045.5" y="-3469.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1045.5" y="-3454.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1045.5" y="-3439.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer78_qkv_6&#45;&gt;layer78_qkv_ar -->
<g id="edge2522" class="edge">
<title>layer78_qkv_6&#45;&gt;layer78_qkv_ar</title>
<path fill="none" stroke="black" d="M972.76,-3585.14C972.76,-3585.14 972.76,-3515.07 972.76,-3515.07"/>
<polygon fill="black" stroke="black" points="976.26,-3515.07 972.76,-3505.07 969.26,-3515.07 976.26,-3515.07"/>
</g>
<!-- layer78_qkv_7&#45;&gt;layer78_qkv_ar -->
<g id="edge2523" class="edge">
<title>layer78_qkv_7&#45;&gt;layer78_qkv_ar</title>
<path fill="none" stroke="black" d="M1118.74,-3585.14C1118.74,-3585.14 1118.74,-3514.79 1118.74,-3514.79"/>
<polygon fill="black" stroke="black" points="1122.24,-3514.79 1118.74,-3504.79 1115.24,-3514.79 1122.24,-3514.79"/>
</g>
<!-- layer78_attn_6 -->
<g id="node1976" class="node">
<title>layer78_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="1027.5,-3345.17 855.5,-3345.17 855.5,-3277.17 1027.5,-3277.17 1027.5,-3345.17"/>
<text text-anchor="middle" x="941.5" y="-3329.97" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="941.5" y="-3314.97" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="941.5" y="-3299.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="941.5" y="-3284.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer78_qkv_ar&#45;&gt;layer78_attn_6 -->
<g id="edge2524" class="edge">
<title>layer78_qkv_ar&#45;&gt;layer78_attn_6</title>
<path fill="none" stroke="black" d="M972.51,-3425.57C972.51,-3425.57 972.51,-3355.22 972.51,-3355.22"/>
<polygon fill="black" stroke="black" points="976.01,-3355.22 972.51,-3345.22 969.01,-3355.22 976.01,-3355.22"/>
</g>
<!-- layer78_attn_7 -->
<g id="node1977" class="node">
<title>layer78_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1235.5,-3345.17 1063.5,-3345.17 1063.5,-3277.17 1235.5,-3277.17 1235.5,-3345.17"/>
<text text-anchor="middle" x="1149.5" y="-3329.97" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1149.5" y="-3314.97" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1149.5" y="-3299.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1149.5" y="-3284.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer78_qkv_ar&#45;&gt;layer78_attn_7 -->
<g id="edge2525" class="edge">
<title>layer78_qkv_ar&#45;&gt;layer78_attn_7</title>
<path fill="none" stroke="black" d="M1118.49,-3425.57C1118.49,-3425.57 1118.49,-3355.22 1118.49,-3355.22"/>
<polygon fill="black" stroke="black" points="1121.99,-3355.22 1118.49,-3345.22 1114.99,-3355.22 1121.99,-3355.22"/>
</g>
<!-- layer78_attn_out_6 -->
<g id="node1978" class="node">
<title>layer78_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="1027.5,-3205.17 855.5,-3205.17 855.5,-3137.17 1027.5,-3137.17 1027.5,-3205.17"/>
<text text-anchor="middle" x="941.5" y="-3189.97" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="941.5" y="-3174.97" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="941.5" y="-3159.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="941.5" y="-3144.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer78_attn_6&#45;&gt;layer78_attn_out_6 -->
<g id="edge2526" class="edge">
<title>layer78_attn_6&#45;&gt;layer78_attn_out_6</title>
<path fill="none" stroke="black" d="M941.5,-3276.92C941.5,-3276.92 941.5,-3215.55 941.5,-3215.55"/>
<polygon fill="black" stroke="black" points="945,-3215.55 941.5,-3205.55 938,-3215.55 945,-3215.55"/>
</g>
<!-- layer78_attn_out_7 -->
<g id="node1979" class="node">
<title>layer78_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1235.5,-3205.17 1063.5,-3205.17 1063.5,-3137.17 1235.5,-3137.17 1235.5,-3205.17"/>
<text text-anchor="middle" x="1149.5" y="-3189.97" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1149.5" y="-3174.97" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1149.5" y="-3159.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1149.5" y="-3144.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer78_attn_7&#45;&gt;layer78_attn_out_7 -->
<g id="edge2527" class="edge">
<title>layer78_attn_7&#45;&gt;layer78_attn_out_7</title>
<path fill="none" stroke="black" d="M1149.5,-3276.92C1149.5,-3276.92 1149.5,-3215.55 1149.5,-3215.55"/>
<polygon fill="black" stroke="black" points="1153,-3215.55 1149.5,-3205.55 1146,-3215.55 1153,-3215.55"/>
</g>
<!-- layer78_attn_ar -->
<g id="node1980" class="node">
<title>layer78_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1045.5" cy="-3017.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1045.5" y="-3035.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1045.5" y="-3020.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1045.5" y="-3005.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1045.5" y="-2990.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer78_attn_out_6&#45;&gt;layer78_attn_ar -->
<g id="edge2528" class="edge">
<title>layer78_attn_out_6&#45;&gt;layer78_attn_ar</title>
<path fill="none" stroke="black" d="M975.69,-3136.97C975.69,-3136.97 975.69,-3066.63 975.69,-3066.63"/>
<polygon fill="black" stroke="black" points="979.19,-3066.63 975.69,-3056.63 972.19,-3066.63 979.19,-3066.63"/>
</g>
<!-- layer78_attn_out_7&#45;&gt;layer78_attn_ar -->
<g id="edge2529" class="edge">
<title>layer78_attn_out_7&#45;&gt;layer78_attn_ar</title>
<path fill="none" stroke="black" d="M1115.31,-3136.97C1115.31,-3136.97 1115.31,-3066.63 1115.31,-3066.63"/>
<polygon fill="black" stroke="black" points="1118.81,-3066.63 1115.31,-3056.63 1111.81,-3066.63 1118.81,-3066.63"/>
</g>
<!-- layer78_ffn_norm_6 -->
<g id="node1981" class="node">
<title>layer78_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="1023.5,-2897 851.5,-2897 851.5,-2829 1023.5,-2829 1023.5,-2897"/>
<text text-anchor="middle" x="937.5" y="-2881.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="937.5" y="-2866.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="937.5" y="-2851.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="937.5" y="-2836.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer78_attn_ar&#45;&gt;layer78_ffn_norm_6 -->
<g id="edge2530" class="edge">
<title>layer78_attn_ar&#45;&gt;layer78_ffn_norm_6</title>
<path fill="none" stroke="black" d="M973.69,-2978.2C973.69,-2978.2 973.69,-2907.15 973.69,-2907.15"/>
<polygon fill="black" stroke="black" points="977.19,-2907.15 973.69,-2897.15 970.19,-2907.15 977.19,-2907.15"/>
</g>
<!-- layer78_ffn_norm_7 -->
<g id="node1982" class="node">
<title>layer78_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1240.5,-2897 1068.5,-2897 1068.5,-2829 1240.5,-2829 1240.5,-2897"/>
<text text-anchor="middle" x="1154.5" y="-2881.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1154.5" y="-2866.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1154.5" y="-2851.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1154.5" y="-2836.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer78_attn_ar&#45;&gt;layer78_ffn_norm_7 -->
<g id="edge2531" class="edge">
<title>layer78_attn_ar&#45;&gt;layer78_ffn_norm_7</title>
<path fill="none" stroke="black" d="M1117.81,-2978.2C1117.81,-2978.2 1117.81,-2907.15 1117.81,-2907.15"/>
<polygon fill="black" stroke="black" points="1121.31,-2907.15 1117.81,-2897.15 1114.31,-2907.15 1121.31,-2907.15"/>
</g>
<!-- layer78_ffn_gate_6 -->
<g id="node1983" class="node">
<title>layer78_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="1028,-2757 847,-2757 847,-2689 1028,-2689 1028,-2757"/>
<text text-anchor="middle" x="937.5" y="-2741.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="937.5" y="-2726.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="937.5" y="-2711.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="937.5" y="-2696.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_ffn_norm_6&#45;&gt;layer78_ffn_gate_6 -->
<g id="edge2532" class="edge">
<title>layer78_ffn_norm_6&#45;&gt;layer78_ffn_gate_6</title>
<path fill="none" stroke="black" d="M937.5,-2828.75C937.5,-2828.75 937.5,-2767.38 937.5,-2767.38"/>
<polygon fill="black" stroke="black" points="941,-2767.38 937.5,-2757.38 934,-2767.38 941,-2767.38"/>
</g>
<!-- layer78_ffn_up_6 -->
<g id="node1985" class="node">
<title>layer78_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="811,-2757 630,-2757 630,-2689 811,-2689 811,-2757"/>
<text text-anchor="middle" x="720.5" y="-2741.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="720.5" y="-2726.8" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="720.5" y="-2711.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="720.5" y="-2696.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_ffn_norm_6&#45;&gt;layer78_ffn_up_6 -->
<g id="edge2534" class="edge">
<title>layer78_ffn_norm_6&#45;&gt;layer78_ffn_up_6</title>
<path fill="none" stroke="black" d="M851.31,-2862C811.86,-2862 773.76,-2862 773.76,-2862 773.76,-2862 773.76,-2767 773.76,-2767"/>
<polygon fill="black" stroke="black" points="777.26,-2767 773.76,-2757 770.26,-2767 777.26,-2767"/>
</g>
<!-- layer78_ffn_gate_7 -->
<g id="node1984" class="node">
<title>layer78_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1462,-2757 1281,-2757 1281,-2689 1462,-2689 1462,-2757"/>
<text text-anchor="middle" x="1371.5" y="-2741.8" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1371.5" y="-2726.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1371.5" y="-2711.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1371.5" y="-2696.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_ffn_norm_7&#45;&gt;layer78_ffn_gate_7 -->
<g id="edge2533" class="edge">
<title>layer78_ffn_norm_7&#45;&gt;layer78_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1240.56,-2862C1279.95,-2862 1318,-2862 1318,-2862 1318,-2862 1318,-2767 1318,-2767"/>
<polygon fill="black" stroke="black" points="1321.5,-2767 1318,-2757 1314.5,-2767 1321.5,-2767"/>
</g>
<!-- layer78_ffn_up_7 -->
<g id="node1986" class="node">
<title>layer78_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1245,-2757 1064,-2757 1064,-2689 1245,-2689 1245,-2757"/>
<text text-anchor="middle" x="1154.5" y="-2741.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1154.5" y="-2726.8" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1154.5" y="-2711.8" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1154.5" y="-2696.8" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_ffn_norm_7&#45;&gt;layer78_ffn_up_7 -->
<g id="edge2535" class="edge">
<title>layer78_ffn_norm_7&#45;&gt;layer78_ffn_up_7</title>
<path fill="none" stroke="black" d="M1154.5,-2828.75C1154.5,-2828.75 1154.5,-2767.38 1154.5,-2767.38"/>
<polygon fill="black" stroke="black" points="1158,-2767.38 1154.5,-2757.38 1151,-2767.38 1158,-2767.38"/>
</g>
<!-- layer78_gate_ar -->
<g id="node1987" class="node">
<title>layer78_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1245.5" cy="-2568.92" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1245.5" y="-2587.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1245.5" y="-2572.72" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1245.5" y="-2557.72" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1245.5" y="-2542.72" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer78_ffn_gate_6&#45;&gt;layer78_gate_ar -->
<g id="edge2536" class="edge">
<title>layer78_ffn_gate_6&#45;&gt;layer78_gate_ar</title>
<path fill="none" stroke="black" d="M1028.08,-2722C1038.79,-2722 1046,-2722 1046,-2722 1046,-2722 1046,-2584 1046,-2584 1046,-2584 1113.7,-2584 1113.7,-2584"/>
<polygon fill="black" stroke="black" points="1113.7,-2587.5 1123.7,-2584 1113.7,-2580.5 1113.7,-2587.5"/>
</g>
<!-- layer78_ffn_gate_7&#45;&gt;layer78_gate_ar -->
<g id="edge2537" class="edge">
<title>layer78_ffn_gate_7&#45;&gt;layer78_gate_ar</title>
<path fill="none" stroke="black" d="M1327.24,-2688.8C1327.24,-2688.8 1327.24,-2615.98 1327.24,-2615.98"/>
<polygon fill="black" stroke="black" points="1330.74,-2615.98 1327.24,-2605.98 1323.74,-2615.98 1330.74,-2615.98"/>
</g>
<!-- layer78_up_ar -->
<g id="node1988" class="node">
<title>layer78_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="899.5" cy="-2568.92" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="899.5" y="-2587.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="899.5" y="-2572.72" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="899.5" y="-2557.72" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="899.5" y="-2542.72" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer78_ffn_up_6&#45;&gt;layer78_up_ar -->
<g id="edge2538" class="edge">
<title>layer78_ffn_up_6&#45;&gt;layer78_up_ar</title>
<path fill="none" stroke="black" d="M791.26,-2688.8C791.26,-2688.8 791.26,-2604.88 791.26,-2604.88"/>
<polygon fill="black" stroke="black" points="794.76,-2604.88 791.26,-2594.88 787.76,-2604.88 794.76,-2604.88"/>
</g>
<!-- layer78_ffn_up_7&#45;&gt;layer78_up_ar -->
<g id="edge2539" class="edge">
<title>layer78_ffn_up_7&#45;&gt;layer78_up_ar</title>
<path fill="none" stroke="black" d="M1090.76,-2688.81C1090.76,-2638.9 1090.76,-2552 1090.76,-2552 1090.76,-2552 1029.54,-2552 1029.54,-2552"/>
<polygon fill="black" stroke="black" points="1029.54,-2548.5 1019.54,-2552 1029.54,-2555.5 1029.54,-2548.5"/>
</g>
<!-- layer78_silu_6 -->
<g id="node1989" class="node">
<title>layer78_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="1173,-2448.83 992,-2448.83 992,-2380.83 1173,-2380.83 1173,-2448.83"/>
<text text-anchor="middle" x="1082.5" y="-2433.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1082.5" y="-2418.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1082.5" y="-2403.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1082.5" y="-2388.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_gate_ar&#45;&gt;layer78_silu_6 -->
<g id="edge2540" class="edge">
<title>layer78_gate_ar&#45;&gt;layer78_silu_6</title>
<path fill="none" stroke="black" d="M1145.26,-2538.84C1145.26,-2538.84 1145.26,-2458.85 1145.26,-2458.85"/>
<polygon fill="black" stroke="black" points="1148.76,-2458.85 1145.26,-2448.85 1141.76,-2458.85 1148.76,-2458.85"/>
</g>
<!-- layer78_silu_7 -->
<g id="node1990" class="node">
<title>layer78_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1390,-2448.83 1209,-2448.83 1209,-2380.83 1390,-2380.83 1390,-2448.83"/>
<text text-anchor="middle" x="1299.5" y="-2433.63" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1299.5" y="-2418.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1299.5" y="-2403.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1299.5" y="-2388.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_gate_ar&#45;&gt;layer78_silu_7 -->
<g id="edge2541" class="edge">
<title>layer78_gate_ar&#45;&gt;layer78_silu_7</title>
<path fill="none" stroke="black" d="M1291.24,-2523.93C1291.24,-2523.93 1291.24,-2458.84 1291.24,-2458.84"/>
<polygon fill="black" stroke="black" points="1294.74,-2458.84 1291.24,-2448.84 1287.74,-2458.84 1294.74,-2458.84"/>
</g>
<!-- layer78_mul_6 -->
<g id="node1991" class="node">
<title>layer78_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="1063,-2308.83 882,-2308.83 882,-2240.83 1063,-2240.83 1063,-2308.83"/>
<text text-anchor="middle" x="972.5" y="-2293.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="972.5" y="-2278.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="972.5" y="-2263.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="972.5" y="-2248.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_up_ar&#45;&gt;layer78_mul_6 -->
<g id="edge2543" class="edge">
<title>layer78_up_ar&#45;&gt;layer78_mul_6</title>
<path fill="none" stroke="black" d="M937,-2522.64C937,-2522.64 937,-2318.92 937,-2318.92"/>
<polygon fill="black" stroke="black" points="940.5,-2318.92 937,-2308.92 933.5,-2318.92 940.5,-2318.92"/>
</g>
<!-- layer78_mul_7 -->
<g id="node1992" class="node">
<title>layer78_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1280,-2308.83 1099,-2308.83 1099,-2240.83 1280,-2240.83 1280,-2308.83"/>
<text text-anchor="middle" x="1189.5" y="-2293.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1189.5" y="-2278.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1189.5" y="-2263.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1189.5" y="-2248.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer78_up_ar&#45;&gt;layer78_mul_7 -->
<g id="edge2545" class="edge">
<title>layer78_up_ar&#45;&gt;layer78_mul_7</title>
<path fill="none" stroke="black" d="M1009.74,-2544.35C1009.74,-2519.28 1009.74,-2484 1009.74,-2484 1009.74,-2484 1191,-2484 1191,-2484 1191,-2484 1191,-2318.9 1191,-2318.9"/>
<polygon fill="black" stroke="black" points="1194.5,-2318.9 1191,-2308.9 1187.5,-2318.9 1194.5,-2318.9"/>
</g>
<!-- layer78_silu_6&#45;&gt;layer78_mul_6 -->
<g id="edge2542" class="edge">
<title>layer78_silu_6&#45;&gt;layer78_mul_6</title>
<path fill="none" stroke="black" d="M1027.5,-2380.58C1027.5,-2380.58 1027.5,-2319.21 1027.5,-2319.21"/>
<polygon fill="black" stroke="black" points="1031,-2319.21 1027.5,-2309.21 1024,-2319.21 1031,-2319.21"/>
</g>
<!-- layer78_silu_7&#45;&gt;layer78_mul_7 -->
<g id="edge2544" class="edge">
<title>layer78_silu_7&#45;&gt;layer78_mul_7</title>
<path fill="none" stroke="black" d="M1244.5,-2380.58C1244.5,-2380.58 1244.5,-2319.21 1244.5,-2319.21"/>
<polygon fill="black" stroke="black" points="1248,-2319.21 1244.5,-2309.21 1241,-2319.21 1248,-2319.21"/>
</g>
<!-- layer78_ffn_down_6 -->
<g id="node1993" class="node">
<title>layer78_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="1062.5,-2168.83 890.5,-2168.83 890.5,-2100.83 1062.5,-2100.83 1062.5,-2168.83"/>
<text text-anchor="middle" x="976.5" y="-2153.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="976.5" y="-2138.63" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="976.5" y="-2123.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="976.5" y="-2108.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer78_mul_6&#45;&gt;layer78_ffn_down_6 -->
<g id="edge2546" class="edge">
<title>layer78_mul_6&#45;&gt;layer78_ffn_down_6</title>
<path fill="none" stroke="black" d="M976.5,-2240.58C976.5,-2240.58 976.5,-2179.21 976.5,-2179.21"/>
<polygon fill="black" stroke="black" points="980,-2179.21 976.5,-2169.21 973,-2179.21 980,-2179.21"/>
</g>
<!-- layer78_ffn_down_7 -->
<g id="node1994" class="node">
<title>layer78_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1272.5,-2168.83 1100.5,-2168.83 1100.5,-2100.83 1272.5,-2100.83 1272.5,-2168.83"/>
<text text-anchor="middle" x="1186.5" y="-2153.63" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1186.5" y="-2138.63" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1186.5" y="-2123.63" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1186.5" y="-2108.63" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer78_mul_7&#45;&gt;layer78_ffn_down_7 -->
<g id="edge2547" class="edge">
<title>layer78_mul_7&#45;&gt;layer78_ffn_down_7</title>
<path fill="none" stroke="black" d="M1186.5,-2240.58C1186.5,-2240.58 1186.5,-2179.21 1186.5,-2179.21"/>
<polygon fill="black" stroke="black" points="1190,-2179.21 1186.5,-2169.21 1183,-2179.21 1190,-2179.21"/>
</g>
<!-- layer78_ffn_ar -->
<g id="node1995" class="node">
<title>layer78_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1080.5" cy="-1980.75" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1080.5" y="-1999.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1080.5" y="-1984.55" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1080.5" y="-1969.55" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1080.5" y="-1954.55" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer78_ffn_down_6&#45;&gt;layer78_ffn_ar -->
<g id="edge2548" class="edge">
<title>layer78_ffn_down_6&#45;&gt;layer78_ffn_ar</title>
<path fill="none" stroke="black" d="M1010.69,-2100.64C1010.69,-2100.64 1010.69,-2030.29 1010.69,-2030.29"/>
<polygon fill="black" stroke="black" points="1014.19,-2030.29 1010.69,-2020.29 1007.19,-2030.29 1014.19,-2030.29"/>
</g>
<!-- layer78_ffn_down_7&#45;&gt;layer78_ffn_ar -->
<g id="edge2549" class="edge">
<title>layer78_ffn_down_7&#45;&gt;layer78_ffn_ar</title>
<path fill="none" stroke="black" d="M1151.31,-2100.64C1151.31,-2100.64 1151.31,-2030.01 1151.31,-2030.01"/>
<polygon fill="black" stroke="black" points="1154.81,-2030.01 1151.31,-2020.01 1147.81,-2030.01 1154.81,-2030.01"/>
</g>
<!-- layer79_norm_6 -->
<g id="node1996" class="node">
<title>layer79_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="1062.5,-1860.67 890.5,-1860.67 890.5,-1792.67 1062.5,-1792.67 1062.5,-1860.67"/>
<text text-anchor="middle" x="976.5" y="-1845.47" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="976.5" y="-1830.47" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="976.5" y="-1815.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="976.5" y="-1800.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer78_ffn_ar&#45;&gt;layer79_norm_6 -->
<g id="edge2550" class="edge">
<title>layer78_ffn_ar&#45;&gt;layer79_norm_6</title>
<path fill="none" stroke="black" d="M1010.69,-1941.07C1010.69,-1941.07 1010.69,-1870.72 1010.69,-1870.72"/>
<polygon fill="black" stroke="black" points="1014.19,-1870.72 1010.69,-1860.72 1007.19,-1870.72 1014.19,-1870.72"/>
</g>
<!-- layer79_norm_7 -->
<g id="node1997" class="node">
<title>layer79_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1272.5,-1860.67 1100.5,-1860.67 1100.5,-1792.67 1272.5,-1792.67 1272.5,-1860.67"/>
<text text-anchor="middle" x="1186.5" y="-1845.47" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1186.5" y="-1830.47" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1186.5" y="-1815.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1186.5" y="-1800.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer78_ffn_ar&#45;&gt;layer79_norm_7 -->
<g id="edge2551" class="edge">
<title>layer78_ffn_ar&#45;&gt;layer79_norm_7</title>
<path fill="none" stroke="black" d="M1151.31,-1941.47C1151.31,-1941.47 1151.31,-1870.9 1151.31,-1870.9"/>
<polygon fill="black" stroke="black" points="1154.81,-1870.9 1151.31,-1860.9 1147.81,-1870.9 1154.81,-1870.9"/>
</g>
<!-- layer79_qkv_6 -->
<g id="node1998" class="node">
<title>layer79_qkv_6</title>
<polygon fill="#fff0e6" stroke="black" points="1063,-1720.67 882,-1720.67 882,-1652.67 1063,-1652.67 1063,-1720.67"/>
<text text-anchor="middle" x="972.5" y="-1705.47" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="972.5" y="-1690.47" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="972.5" y="-1675.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="972.5" y="-1660.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer79_norm_6&#45;&gt;layer79_qkv_6 -->
<g id="edge2552" class="edge">
<title>layer79_norm_6&#45;&gt;layer79_qkv_6</title>
<path fill="none" stroke="black" d="M976.5,-1792.42C976.5,-1792.42 976.5,-1731.05 976.5,-1731.05"/>
<polygon fill="black" stroke="black" points="980,-1731.05 976.5,-1721.05 973,-1731.05 980,-1731.05"/>
</g>
<!-- layer79_qkv_7 -->
<g id="node1999" class="node">
<title>layer79_qkv_7</title>
<polygon fill="#fff0e6" stroke="black" points="1280,-1720.67 1099,-1720.67 1099,-1652.67 1280,-1652.67 1280,-1720.67"/>
<text text-anchor="middle" x="1189.5" y="-1705.47" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1189.5" y="-1690.47" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1189.5" y="-1675.47" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1189.5" y="-1660.47" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer79_norm_7&#45;&gt;layer79_qkv_7 -->
<g id="edge2553" class="edge">
<title>layer79_norm_7&#45;&gt;layer79_qkv_7</title>
<path fill="none" stroke="black" d="M1186.5,-1792.42C1186.5,-1792.42 1186.5,-1731.05 1186.5,-1731.05"/>
<polygon fill="black" stroke="black" points="1190,-1731.05 1186.5,-1721.05 1183,-1731.05 1190,-1731.05"/>
</g>
<!-- layer79_qkv_ar -->
<g id="node2000" class="node">
<title>layer79_qkv_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1080.5" cy="-1532.58" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1080.5" y="-1551.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="1080.5" y="-1536.38" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1080.5" y="-1521.38" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1080.5" y="-1506.38" font-family="Times,serif" font-size="14.00">Output:[4,2048,24576]</text>
</g>
<!-- layer79_qkv_6&#45;&gt;layer79_qkv_ar -->
<g id="edge2554" class="edge">
<title>layer79_qkv_6&#45;&gt;layer79_qkv_ar</title>
<path fill="none" stroke="black" d="M1007.76,-1652.47C1007.76,-1652.47 1007.76,-1582.4 1007.76,-1582.4"/>
<polygon fill="black" stroke="black" points="1011.26,-1582.4 1007.76,-1572.4 1004.26,-1582.4 1011.26,-1582.4"/>
</g>
<!-- layer79_qkv_7&#45;&gt;layer79_qkv_ar -->
<g id="edge2555" class="edge">
<title>layer79_qkv_7&#45;&gt;layer79_qkv_ar</title>
<path fill="none" stroke="black" d="M1153.74,-1652.47C1153.74,-1652.47 1153.74,-1582.13 1153.74,-1582.13"/>
<polygon fill="black" stroke="black" points="1157.24,-1582.13 1153.74,-1572.13 1150.24,-1582.13 1157.24,-1582.13"/>
</g>
<!-- layer79_attn_6 -->
<g id="node2001" class="node">
<title>layer79_attn_6</title>
<polygon fill="#fff0e6" stroke="black" points="1062.5,-1412.5 890.5,-1412.5 890.5,-1344.5 1062.5,-1344.5 1062.5,-1412.5"/>
<text text-anchor="middle" x="976.5" y="-1397.3" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="976.5" y="-1382.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="976.5" y="-1367.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="976.5" y="-1352.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer79_qkv_ar&#45;&gt;layer79_attn_6 -->
<g id="edge2556" class="edge">
<title>layer79_qkv_ar&#45;&gt;layer79_attn_6</title>
<path fill="none" stroke="black" d="M1007.51,-1492.9C1007.51,-1492.9 1007.51,-1422.56 1007.51,-1422.56"/>
<polygon fill="black" stroke="black" points="1011.01,-1422.56 1007.51,-1412.56 1004.01,-1422.56 1011.01,-1422.56"/>
</g>
<!-- layer79_attn_7 -->
<g id="node2002" class="node">
<title>layer79_attn_7</title>
<polygon fill="#fff0e6" stroke="black" points="1270.5,-1412.5 1098.5,-1412.5 1098.5,-1344.5 1270.5,-1344.5 1270.5,-1412.5"/>
<text text-anchor="middle" x="1184.5" y="-1397.3" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1184.5" y="-1382.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1184.5" y="-1367.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,24576]</text>
<text text-anchor="middle" x="1184.5" y="-1352.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer79_qkv_ar&#45;&gt;layer79_attn_7 -->
<g id="edge2557" class="edge">
<title>layer79_qkv_ar&#45;&gt;layer79_attn_7</title>
<path fill="none" stroke="black" d="M1153.49,-1492.9C1153.49,-1492.9 1153.49,-1422.56 1153.49,-1422.56"/>
<polygon fill="black" stroke="black" points="1156.99,-1422.56 1153.49,-1412.56 1149.99,-1422.56 1156.99,-1422.56"/>
</g>
<!-- layer79_attn_out_6 -->
<g id="node2003" class="node">
<title>layer79_attn_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="1062.5,-1272.5 890.5,-1272.5 890.5,-1204.5 1062.5,-1204.5 1062.5,-1272.5"/>
<text text-anchor="middle" x="976.5" y="-1257.3" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="976.5" y="-1242.3" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="976.5" y="-1227.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="976.5" y="-1212.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer79_attn_6&#45;&gt;layer79_attn_out_6 -->
<g id="edge2558" class="edge">
<title>layer79_attn_6&#45;&gt;layer79_attn_out_6</title>
<path fill="none" stroke="black" d="M976.5,-1344.25C976.5,-1344.25 976.5,-1282.88 976.5,-1282.88"/>
<polygon fill="black" stroke="black" points="980,-1282.88 976.5,-1272.88 973,-1282.88 980,-1282.88"/>
</g>
<!-- layer79_attn_out_7 -->
<g id="node2004" class="node">
<title>layer79_attn_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="1270.5,-1272.5 1098.5,-1272.5 1098.5,-1204.5 1270.5,-1204.5 1270.5,-1272.5"/>
<text text-anchor="middle" x="1184.5" y="-1257.3" font-family="Times,serif" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="1184.5" y="-1242.3" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1184.5" y="-1227.3" font-family="Times,serif" font-size="14.00">Input:[4,2048,4096]</text>
<text text-anchor="middle" x="1184.5" y="-1212.3" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer79_attn_7&#45;&gt;layer79_attn_out_7 -->
<g id="edge2559" class="edge">
<title>layer79_attn_7&#45;&gt;layer79_attn_out_7</title>
<path fill="none" stroke="black" d="M1184.5,-1344.25C1184.5,-1344.25 1184.5,-1282.88 1184.5,-1282.88"/>
<polygon fill="black" stroke="black" points="1188,-1282.88 1184.5,-1272.88 1181,-1282.88 1188,-1282.88"/>
</g>
<!-- layer79_attn_ar -->
<g id="node2005" class="node">
<title>layer79_attn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1080.5" cy="-1084.42" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1080.5" y="-1103.22" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1080.5" y="-1088.22" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1080.5" y="-1073.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1080.5" y="-1058.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer79_attn_out_6&#45;&gt;layer79_attn_ar -->
<g id="edge2560" class="edge">
<title>layer79_attn_out_6&#45;&gt;layer79_attn_ar</title>
<path fill="none" stroke="black" d="M1010.69,-1204.3C1010.69,-1204.3 1010.69,-1133.96 1010.69,-1133.96"/>
<polygon fill="black" stroke="black" points="1014.19,-1133.96 1010.69,-1123.96 1007.19,-1133.96 1014.19,-1133.96"/>
</g>
<!-- layer79_attn_out_7&#45;&gt;layer79_attn_ar -->
<g id="edge2561" class="edge">
<title>layer79_attn_out_7&#45;&gt;layer79_attn_ar</title>
<path fill="none" stroke="black" d="M1150.31,-1204.3C1150.31,-1204.3 1150.31,-1133.96 1150.31,-1133.96"/>
<polygon fill="black" stroke="black" points="1153.81,-1133.96 1150.31,-1123.96 1146.81,-1133.96 1153.81,-1133.96"/>
</g>
<!-- layer79_ffn_norm_6 -->
<g id="node2006" class="node">
<title>layer79_ffn_norm_6</title>
<polygon fill="#fff0e6" stroke="black" points="1058.5,-964.33 886.5,-964.33 886.5,-896.33 1058.5,-896.33 1058.5,-964.33"/>
<text text-anchor="middle" x="972.5" y="-949.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="972.5" y="-934.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="972.5" y="-919.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="972.5" y="-904.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer79_attn_ar&#45;&gt;layer79_ffn_norm_6 -->
<g id="edge2562" class="edge">
<title>layer79_attn_ar&#45;&gt;layer79_ffn_norm_6</title>
<path fill="none" stroke="black" d="M1008.69,-1045.53C1008.69,-1045.53 1008.69,-974.48 1008.69,-974.48"/>
<polygon fill="black" stroke="black" points="1012.19,-974.48 1008.69,-964.48 1005.19,-974.48 1012.19,-974.48"/>
</g>
<!-- layer79_ffn_norm_7 -->
<g id="node2007" class="node">
<title>layer79_ffn_norm_7</title>
<polygon fill="#fff0e6" stroke="black" points="1275.5,-964.33 1103.5,-964.33 1103.5,-896.33 1275.5,-896.33 1275.5,-964.33"/>
<text text-anchor="middle" x="1189.5" y="-949.13" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="1189.5" y="-934.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1189.5" y="-919.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1189.5" y="-904.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer79_attn_ar&#45;&gt;layer79_ffn_norm_7 -->
<g id="edge2563" class="edge">
<title>layer79_attn_ar&#45;&gt;layer79_ffn_norm_7</title>
<path fill="none" stroke="black" d="M1152.81,-1045.53C1152.81,-1045.53 1152.81,-974.48 1152.81,-974.48"/>
<polygon fill="black" stroke="black" points="1156.31,-974.48 1152.81,-964.48 1149.31,-974.48 1156.31,-974.48"/>
</g>
<!-- layer79_ffn_gate_6 -->
<g id="node2008" class="node">
<title>layer79_ffn_gate_6</title>
<polygon fill="#fff0e6" stroke="black" points="1063,-824.33 882,-824.33 882,-756.33 1063,-756.33 1063,-824.33"/>
<text text-anchor="middle" x="972.5" y="-809.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="972.5" y="-794.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="972.5" y="-779.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="972.5" y="-764.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_ffn_norm_6&#45;&gt;layer79_ffn_gate_6 -->
<g id="edge2564" class="edge">
<title>layer79_ffn_norm_6&#45;&gt;layer79_ffn_gate_6</title>
<path fill="none" stroke="black" d="M972.5,-896.09C972.5,-896.09 972.5,-834.71 972.5,-834.71"/>
<polygon fill="black" stroke="black" points="976,-834.71 972.5,-824.71 969,-834.71 976,-834.71"/>
</g>
<!-- layer79_ffn_up_6 -->
<g id="node2010" class="node">
<title>layer79_ffn_up_6</title>
<polygon fill="#fff0e6" stroke="black" points="846,-824.33 665,-824.33 665,-756.33 846,-756.33 846,-824.33"/>
<text text-anchor="middle" x="755.5" y="-809.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="755.5" y="-794.13" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="755.5" y="-779.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="755.5" y="-764.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_ffn_norm_6&#45;&gt;layer79_ffn_up_6 -->
<g id="edge2566" class="edge">
<title>layer79_ffn_norm_6&#45;&gt;layer79_ffn_up_6</title>
<path fill="none" stroke="black" d="M886.31,-930C846.86,-930 808.76,-930 808.76,-930 808.76,-930 808.76,-834.5 808.76,-834.5"/>
<polygon fill="black" stroke="black" points="812.26,-834.5 808.76,-824.5 805.26,-834.5 812.26,-834.5"/>
</g>
<!-- layer79_ffn_gate_7 -->
<g id="node2009" class="node">
<title>layer79_ffn_gate_7</title>
<polygon fill="#fff0e6" stroke="black" points="1497,-824.33 1316,-824.33 1316,-756.33 1497,-756.33 1497,-824.33"/>
<text text-anchor="middle" x="1406.5" y="-809.13" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1406.5" y="-794.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1406.5" y="-779.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1406.5" y="-764.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_ffn_norm_7&#45;&gt;layer79_ffn_gate_7 -->
<g id="edge2565" class="edge">
<title>layer79_ffn_norm_7&#45;&gt;layer79_ffn_gate_7</title>
<path fill="none" stroke="black" d="M1275.56,-930C1314.95,-930 1353,-930 1353,-930 1353,-930 1353,-834.5 1353,-834.5"/>
<polygon fill="black" stroke="black" points="1356.5,-834.5 1353,-824.5 1349.5,-834.5 1356.5,-834.5"/>
</g>
<!-- layer79_ffn_up_7 -->
<g id="node2011" class="node">
<title>layer79_ffn_up_7</title>
<polygon fill="#fff0e6" stroke="black" points="1280,-824.33 1099,-824.33 1099,-756.33 1280,-756.33 1280,-824.33"/>
<text text-anchor="middle" x="1189.5" y="-809.13" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1189.5" y="-794.13" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1189.5" y="-779.13" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1189.5" y="-764.13" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_ffn_norm_7&#45;&gt;layer79_ffn_up_7 -->
<g id="edge2567" class="edge">
<title>layer79_ffn_norm_7&#45;&gt;layer79_ffn_up_7</title>
<path fill="none" stroke="black" d="M1189.5,-896.09C1189.5,-896.09 1189.5,-834.71 1189.5,-834.71"/>
<polygon fill="black" stroke="black" points="1193,-834.71 1189.5,-824.71 1186,-834.71 1193,-834.71"/>
</g>
<!-- layer79_gate_ar -->
<g id="node2012" class="node">
<title>layer79_gate_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1280.5" cy="-636.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="1280.5" y="-655.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Gate</text>
<text text-anchor="middle" x="1280.5" y="-640.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1280.5" y="-625.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1280.5" y="-610.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer79_ffn_gate_6&#45;&gt;layer79_gate_ar -->
<g id="edge2568" class="edge">
<title>layer79_ffn_gate_6&#45;&gt;layer79_gate_ar</title>
<path fill="none" stroke="black" d="M1063.08,-790C1073.79,-790 1081,-790 1081,-790 1081,-790 1081,-652 1081,-652 1081,-652 1149.56,-652 1149.56,-652"/>
<polygon fill="black" stroke="black" points="1149.56,-655.5 1159.56,-652 1149.56,-648.5 1149.56,-655.5"/>
</g>
<!-- layer79_ffn_gate_7&#45;&gt;layer79_gate_ar -->
<g id="edge2569" class="edge">
<title>layer79_ffn_gate_7&#45;&gt;layer79_gate_ar</title>
<path fill="none" stroke="black" d="M1362.24,-756.14C1362.24,-756.14 1362.24,-683.31 1362.24,-683.31"/>
<polygon fill="black" stroke="black" points="1365.74,-683.31 1362.24,-673.31 1358.74,-683.31 1365.74,-683.31"/>
</g>
<!-- layer79_up_ar -->
<g id="node2013" class="node">
<title>layer79_up_ar</title>
<ellipse fill="lightblue" stroke="black" cx="934.5" cy="-636.25" rx="127.97" ry="48.17"/>
<text text-anchor="middle" x="934.5" y="-655.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Up</text>
<text text-anchor="middle" x="934.5" y="-640.05" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="934.5" y="-625.05" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="934.5" y="-610.05" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer79_ffn_up_6&#45;&gt;layer79_up_ar -->
<g id="edge2570" class="edge">
<title>layer79_ffn_up_6&#45;&gt;layer79_up_ar</title>
<path fill="none" stroke="black" d="M826.26,-756.14C826.26,-756.14 826.26,-672.21 826.26,-672.21"/>
<polygon fill="black" stroke="black" points="829.76,-672.21 826.26,-662.21 822.76,-672.21 829.76,-672.21"/>
</g>
<!-- layer79_ffn_up_7&#45;&gt;layer79_up_ar -->
<g id="edge2571" class="edge">
<title>layer79_ffn_up_7&#45;&gt;layer79_up_ar</title>
<path fill="none" stroke="black" d="M1125.76,-756.27C1125.76,-706.57 1125.76,-620 1125.76,-620 1125.76,-620 1065.08,-620 1065.08,-620"/>
<polygon fill="black" stroke="black" points="1065.08,-616.5 1055.08,-620 1065.08,-623.5 1065.08,-616.5"/>
</g>
<!-- layer79_silu_6 -->
<g id="node2014" class="node">
<title>layer79_silu_6</title>
<polygon fill="#fff0e6" stroke="black" points="1208,-516.17 1027,-516.17 1027,-448.17 1208,-448.17 1208,-516.17"/>
<text text-anchor="middle" x="1117.5" y="-500.97" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1117.5" y="-485.97" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1117.5" y="-470.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1117.5" y="-455.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_gate_ar&#45;&gt;layer79_silu_6 -->
<g id="edge2572" class="edge">
<title>layer79_gate_ar&#45;&gt;layer79_silu_6</title>
<path fill="none" stroke="black" d="M1180.26,-606.18C1180.26,-606.18 1180.26,-526.19 1180.26,-526.19"/>
<polygon fill="black" stroke="black" points="1183.76,-526.19 1180.26,-516.19 1176.76,-526.19 1183.76,-526.19"/>
</g>
<!-- layer79_silu_7 -->
<g id="node2015" class="node">
<title>layer79_silu_7</title>
<polygon fill="#fff0e6" stroke="black" points="1425,-516.17 1244,-516.17 1244,-448.17 1425,-448.17 1425,-516.17"/>
<text text-anchor="middle" x="1334.5" y="-500.97" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1334.5" y="-485.97" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1334.5" y="-470.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1334.5" y="-455.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_gate_ar&#45;&gt;layer79_silu_7 -->
<g id="edge2573" class="edge">
<title>layer79_gate_ar&#45;&gt;layer79_silu_7</title>
<path fill="none" stroke="black" d="M1326.24,-591.27C1326.24,-591.27 1326.24,-526.17 1326.24,-526.17"/>
<polygon fill="black" stroke="black" points="1329.74,-526.17 1326.24,-516.17 1322.74,-526.17 1329.74,-526.17"/>
</g>
<!-- layer79_mul_6 -->
<g id="node2016" class="node">
<title>layer79_mul_6</title>
<polygon fill="#fff0e6" stroke="black" points="1098,-376.17 917,-376.17 917,-308.17 1098,-308.17 1098,-376.17"/>
<text text-anchor="middle" x="1007.5" y="-360.97" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1007.5" y="-345.97" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1007.5" y="-330.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1007.5" y="-315.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_up_ar&#45;&gt;layer79_mul_6 -->
<g id="edge2575" class="edge">
<title>layer79_up_ar&#45;&gt;layer79_mul_6</title>
<path fill="none" stroke="black" d="M972,-589.98C972,-589.98 972,-386.25 972,-386.25"/>
<polygon fill="black" stroke="black" points="975.5,-386.25 972,-376.25 968.5,-386.25 975.5,-386.25"/>
</g>
<!-- layer79_mul_7 -->
<g id="node2017" class="node">
<title>layer79_mul_7</title>
<polygon fill="#fff0e6" stroke="black" points="1315,-376.17 1134,-376.17 1134,-308.17 1315,-308.17 1315,-376.17"/>
<text text-anchor="middle" x="1224.5" y="-360.97" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="1224.5" y="-345.97" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1224.5" y="-330.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1224.5" y="-315.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,14336]</text>
</g>
<!-- layer79_up_ar&#45;&gt;layer79_mul_7 -->
<g id="edge2577" class="edge">
<title>layer79_up_ar&#45;&gt;layer79_mul_7</title>
<path fill="none" stroke="black" d="M1044.74,-611.43C1044.74,-586.58 1044.74,-552 1044.74,-552 1044.74,-552 1226,-552 1226,-552 1226,-552 1226,-386.35 1226,-386.35"/>
<polygon fill="black" stroke="black" points="1229.5,-386.35 1226,-376.35 1222.5,-386.35 1229.5,-386.35"/>
</g>
<!-- layer79_silu_6&#45;&gt;layer79_mul_6 -->
<g id="edge2574" class="edge">
<title>layer79_silu_6&#45;&gt;layer79_mul_6</title>
<path fill="none" stroke="black" d="M1062.5,-447.92C1062.5,-447.92 1062.5,-386.55 1062.5,-386.55"/>
<polygon fill="black" stroke="black" points="1066,-386.55 1062.5,-376.55 1059,-386.55 1066,-386.55"/>
</g>
<!-- layer79_silu_7&#45;&gt;layer79_mul_7 -->
<g id="edge2576" class="edge">
<title>layer79_silu_7&#45;&gt;layer79_mul_7</title>
<path fill="none" stroke="black" d="M1279.5,-447.92C1279.5,-447.92 1279.5,-386.55 1279.5,-386.55"/>
<polygon fill="black" stroke="black" points="1283,-386.55 1279.5,-376.55 1276,-386.55 1283,-386.55"/>
</g>
<!-- layer79_ffn_down_6 -->
<g id="node2018" class="node">
<title>layer79_ffn_down_6</title>
<polygon fill="#fff0e6" stroke="black" points="1097.5,-236.17 925.5,-236.17 925.5,-168.17 1097.5,-168.17 1097.5,-236.17"/>
<text text-anchor="middle" x="1011.5" y="-220.97" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1011.5" y="-205.97" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1011.5" y="-190.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1011.5" y="-175.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer79_mul_6&#45;&gt;layer79_ffn_down_6 -->
<g id="edge2578" class="edge">
<title>layer79_mul_6&#45;&gt;layer79_ffn_down_6</title>
<path fill="none" stroke="black" d="M1011.5,-307.92C1011.5,-307.92 1011.5,-246.55 1011.5,-246.55"/>
<polygon fill="black" stroke="black" points="1015,-246.55 1011.5,-236.55 1008,-246.55 1015,-246.55"/>
</g>
<!-- layer79_ffn_down_7 -->
<g id="node2019" class="node">
<title>layer79_ffn_down_7</title>
<polygon fill="#fff0e6" stroke="black" points="1307.5,-236.17 1135.5,-236.17 1135.5,-168.17 1307.5,-168.17 1307.5,-236.17"/>
<text text-anchor="middle" x="1221.5" y="-220.97" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1221.5" y="-205.97" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1221.5" y="-190.97" font-family="Times,serif" font-size="14.00">Input:[4,2048,14336]</text>
<text text-anchor="middle" x="1221.5" y="-175.97" font-family="Times,serif" font-size="14.00">Output:[4,2048,4096]</text>
</g>
<!-- layer79_mul_7&#45;&gt;layer79_ffn_down_7 -->
<g id="edge2579" class="edge">
<title>layer79_mul_7&#45;&gt;layer79_ffn_down_7</title>
<path fill="none" stroke="black" d="M1221.5,-307.92C1221.5,-307.92 1221.5,-246.55 1221.5,-246.55"/>
<polygon fill="black" stroke="black" points="1225,-246.55 1221.5,-236.55 1218,-246.55 1225,-246.55"/>
</g>
<!-- layer79_ffn_ar -->
<g id="node2020" class="node">
<title>layer79_ffn_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1115.5" cy="-48.08" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1115.5" y="-66.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce FFN</text>
<text text-anchor="middle" x="1115.5" y="-51.88" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1115.5" y="-36.88" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1115.5" y="-21.88" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer79_ffn_down_6&#45;&gt;layer79_ffn_ar -->
<g id="edge2580" class="edge">
<title>layer79_ffn_down_6&#45;&gt;layer79_ffn_ar</title>
<path fill="none" stroke="black" d="M1045.69,-167.97C1045.69,-167.97 1045.69,-97.63 1045.69,-97.63"/>
<polygon fill="black" stroke="black" points="1049.19,-97.63 1045.69,-87.63 1042.19,-97.63 1049.19,-97.63"/>
</g>
<!-- layer79_ffn_down_7&#45;&gt;layer79_ffn_ar -->
<g id="edge2581" class="edge">
<title>layer79_ffn_down_7&#45;&gt;layer79_ffn_ar</title>
<path fill="none" stroke="black" d="M1186.31,-167.97C1186.31,-167.97 1186.31,-97.35 1186.31,-97.35"/>
<polygon fill="black" stroke="black" points="1189.81,-97.35 1186.31,-87.35 1182.81,-97.35 1189.81,-97.35"/>
</g>
<!-- final_ag -->
<g id="node2023" class="node">
<title>final_ag</title>
<ellipse fill="lightblue" stroke="black" cx="1101.5" cy="-38897.74" rx="121.74" ry="48.17"/>
<text text-anchor="middle" x="1101.5" y="-38916.54" font-family="Times,serif" font-size="14.00">All&#45;Gather Final</text>
<text text-anchor="middle" x="1101.5" y="-38901.54" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1101.5" y="-38886.54" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1101.5" y="-38871.54" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- output_norm_0&#45;&gt;final_ag -->
<g id="edge2586" class="edge">
<title>output_norm_0&#45;&gt;final_ag</title>
<path fill="none" stroke="black" d="M1168.81,-39021.52C1168.81,-39021.52 1168.81,-38947.84 1168.81,-38947.84"/>
<polygon fill="black" stroke="black" points="1172.31,-38947.84 1168.81,-38937.84 1165.31,-38947.84 1172.31,-38947.84"/>
</g>
<!-- output_norm_1&#45;&gt;final_ag -->
<g id="edge2587" class="edge">
<title>output_norm_1&#45;&gt;final_ag</title>
<path fill="none" stroke="black" d="M1029.19,-39021.52C1029.19,-39021.52 1029.19,-38946.42 1029.19,-38946.42"/>
<polygon fill="black" stroke="black" points="1032.69,-38946.42 1029.19,-38936.42 1025.69,-38946.42 1032.69,-38946.42"/>
</g>
<!-- lm_head_0 -->
<g id="node2024" class="node">
<title>lm_head_0</title>
<polygon fill="#fff0e6" stroke="black" points="1130,-38763.57 949,-38763.57 949,-38695.57 1130,-38695.57 1130,-38763.57"/>
<text text-anchor="middle" x="1039.5" y="-38748.37" font-family="Times,serif" font-size="14.00">LM Head</text>
<text text-anchor="middle" x="1039.5" y="-38733.37" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="1039.5" y="-38718.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1039.5" y="-38703.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,64128]</text>
</g>
<!-- final_ag&#45;&gt;lm_head_0 -->
<g id="edge2588" class="edge">
<title>final_ag&#45;&gt;lm_head_0</title>
<path fill="none" stroke="black" d="M1054.94,-38853.11C1054.94,-38853.11 1054.94,-38773.73 1054.94,-38773.73"/>
<polygon fill="black" stroke="black" points="1058.44,-38773.73 1054.94,-38763.73 1051.44,-38773.73 1058.44,-38773.73"/>
</g>
<!-- lm_head_1 -->
<g id="node2025" class="node">
<title>lm_head_1</title>
<polygon fill="#fff0e6" stroke="black" points="1347,-38763.57 1166,-38763.57 1166,-38695.57 1347,-38695.57 1347,-38763.57"/>
<text text-anchor="middle" x="1256.5" y="-38748.37" font-family="Times,serif" font-size="14.00">LM Head</text>
<text text-anchor="middle" x="1256.5" y="-38733.37" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="1256.5" y="-38718.37" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1256.5" y="-38703.37" font-family="Times,serif" font-size="14.00">Output:[4,2048,64128]</text>
</g>
<!-- final_ag&#45;&gt;lm_head_1 -->
<g id="edge2589" class="edge">
<title>final_ag&#45;&gt;lm_head_1</title>
<path fill="none" stroke="black" d="M1194.56,-38866.5C1194.56,-38866.5 1194.56,-38773.82 1194.56,-38773.82"/>
<polygon fill="black" stroke="black" points="1198.06,-38773.82 1194.56,-38763.82 1191.06,-38773.82 1198.06,-38773.82"/>
</g>
<!-- final_ar -->
<g id="node2026" class="node">
<title>final_ar</title>
<ellipse fill="lightblue" stroke="black" cx="1147.5" cy="-38561.41" rx="134.2" ry="48.17"/>
<text text-anchor="middle" x="1147.5" y="-38580.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Logits</text>
<text text-anchor="middle" x="1147.5" y="-38565.21" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
<text text-anchor="middle" x="1147.5" y="-38550.21" font-family="Times,serif" font-size="14.00">Input:[4,2048,128256]</text>
<text text-anchor="middle" x="1147.5" y="-38535.21" font-family="Times,serif" font-size="14.00">Output:[4,2048,128256]</text>
</g>
<!-- lm_head_0&#45;&gt;final_ar -->
<g id="edge2590" class="edge">
<title>lm_head_0&#45;&gt;final_ar</title>
<path fill="none" stroke="black" d="M1071.57,-38695.54C1071.57,-38695.54 1071.57,-38611.3 1071.57,-38611.3"/>
<polygon fill="black" stroke="black" points="1075.07,-38611.3 1071.57,-38601.3 1068.07,-38611.3 1075.07,-38611.3"/>
</g>
<!-- lm_head_1&#45;&gt;final_ar -->
<g id="edge2591" class="edge">
<title>lm_head_1&#45;&gt;final_ar</title>
<path fill="none" stroke="black" d="M1223.93,-38695.54C1223.93,-38695.54 1223.93,-38611 1223.93,-38611"/>
<polygon fill="black" stroke="black" points="1227.43,-38611 1223.93,-38601 1220.43,-38611 1227.43,-38611"/>
</g>
<!-- output -->
<g id="node2027" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="1147.5" cy="-38407.32" rx="246.56" ry="26.74"/>
<text text-anchor="middle" x="1147.5" y="-38411.12" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1147.5" y="-38396.12" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, vocab=128256]</text>
</g>
<!-- final_ar&#45;&gt;output -->
<g id="edge2592" class="edge">
<title>final_ar&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1147.5,-38513.07C1147.5,-38513.07 1147.5,-38444.4 1147.5,-38444.4"/>
<polygon fill="black" stroke="black" points="1151,-38444.4 1147.5,-38434.4 1144,-38444.4 1151,-38444.4"/>
</g>
</g>
</svg>
