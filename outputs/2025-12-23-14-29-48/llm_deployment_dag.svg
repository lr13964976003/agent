<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="32pt"
 viewBox="0.00 0.00 1440.00 31.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.02 0.02) rotate(0) translate(4 1940.75)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1940.75 88274,-1940.75 88274,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightgray" stroke="black" d="M20,-1367.41C20,-1367.41 62101,-1367.41 62101,-1367.41 62107,-1367.41 62113,-1373.41 62113,-1379.41 62113,-1379.41 62113,-1845.01 62113,-1845.01 62113,-1851.01 62107,-1857.01 62101,-1857.01 62101,-1857.01 20,-1857.01 20,-1857.01 14,-1857.01 8,-1851.01 8,-1845.01 8,-1845.01 8,-1379.41 8,-1379.41 8,-1373.41 14,-1367.41 20,-1367.41"/>
<text text-anchor="middle" x="31060.5" y="-1841.81" font-family="Times,serif" font-size="14.00">Stage 0: GPUs [0,1]</text>
<text text-anchor="middle" x="31060.5" y="-1826.81" font-family="Times,serif" font-size="14.00">Layers 0&#45;19</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgray" stroke="black" d="M62133,-1321.89C62133,-1321.89 88250,-1321.89 88250,-1321.89 88256,-1321.89 88262,-1327.89 88262,-1333.89 88262,-1333.89 88262,-1529.89 88262,-1529.89 88262,-1535.89 88256,-1541.89 88250,-1541.89 88250,-1541.89 62133,-1541.89 62133,-1541.89 62127,-1541.89 62121,-1535.89 62121,-1529.89 62121,-1529.89 62121,-1333.89 62121,-1333.89 62121,-1327.89 62127,-1321.89 62133,-1321.89"/>
<text text-anchor="middle" x="75191.5" y="-1526.69" font-family="Times,serif" font-size="14.00">Stage 1: GPUs [2,3]</text>
<text text-anchor="middle" x="75191.5" y="-1511.69" font-family="Times,serif" font-size="14.00">Layers 20&#45;39</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="lightgray" stroke="black" d="M55347,-1006.77C55347,-1006.77 62263,-1006.77 62263,-1006.77 62269,-1006.77 62275,-1012.77 62275,-1018.77 62275,-1018.77 62275,-1144.93 62275,-1144.93 62275,-1150.93 62269,-1156.93 62263,-1156.93 62263,-1156.93 55347,-1156.93 55347,-1156.93 55341,-1156.93 55335,-1150.93 55335,-1144.93 55335,-1144.93 55335,-1018.77 55335,-1018.77 55335,-1012.77 55341,-1006.77 55347,-1006.77"/>
<text text-anchor="middle" x="58805" y="-1141.73" font-family="Times,serif" font-size="14.00">Stage 2: GPUs [4,5]</text>
<text text-anchor="middle" x="58805" y="-1126.73" font-family="Times,serif" font-size="14.00">Layers 40&#45;59</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="lightgray" stroke="black" d="M48561,-691.65C48561,-691.65 55477,-691.65 55477,-691.65 55483,-691.65 55489,-697.65 55489,-703.65 55489,-703.65 55489,-829.81 55489,-829.81 55489,-835.81 55483,-841.81 55477,-841.81 55477,-841.81 48561,-841.81 48561,-841.81 48555,-841.81 48549,-835.81 48549,-829.81 48549,-829.81 48549,-703.65 48549,-703.65 48549,-697.65 48555,-691.65 48561,-691.65"/>
<text text-anchor="middle" x="52019" y="-826.61" font-family="Times,serif" font-size="14.00">Stage 3: GPUs [6,7]</text>
<text text-anchor="middle" x="52019" y="-811.61" font-family="Times,serif" font-size="14.00">Layers 60&#45;79</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="366" cy="-1909.88" rx="239" ry="26.74"/>
<text text-anchor="middle" x="366" y="-1913.68" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="366" y="-1898.68" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=8192]</text>
</g>
<!-- split_0 -->
<g id="node2" class="node">
<title>split_0</title>
<polygon fill="lightyellow" stroke="black" points="716.35,-1800.92 159.02,-1800.92 15.65,-1724.92 572.98,-1724.92 716.35,-1800.92"/>
<text text-anchor="middle" x="366" y="-1766.72" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="366" y="-1751.72" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;split_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;split_0</title>
<path fill="none" stroke="black" d="M366,-1882.96C366,-1863.1 366,-1835.15 366,-1811.32"/>
<polygon fill="black" stroke="black" points="369.5,-1811.05 366,-1801.05 362.5,-1811.05 369.5,-1811.05"/>
</g>
<!-- layer0_embed_0 -->
<g id="node3" class="node">
<title>layer0_embed_0</title>
<polygon fill="#ffe6e6" stroke="black" points="348,-1639.36 176,-1639.36 176,-1571.36 348,-1571.36 348,-1639.36"/>
<text text-anchor="middle" x="262" y="-1624.16" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="262" y="-1609.16" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="262" y="-1594.16" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="262" y="-1579.16" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- split_0&#45;&gt;layer0_embed_0 -->
<g id="edge2" class="edge">
<title>split_0&#45;&gt;layer0_embed_0</title>
<path fill="none" stroke="black" d="M341.09,-1724.66C325.68,-1701.61 305.86,-1671.96 289.91,-1648.12"/>
<polygon fill="black" stroke="black" points="292.7,-1645.98 284.23,-1639.62 286.88,-1649.87 292.7,-1645.98"/>
</g>
<!-- layer0_embed_1 -->
<g id="node4" class="node">
<title>layer0_embed_1</title>
<polygon fill="#ffe6e6" stroke="black" points="556,-1639.36 384,-1639.36 384,-1571.36 556,-1571.36 556,-1639.36"/>
<text text-anchor="middle" x="470" y="-1624.16" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="470" y="-1609.16" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="470" y="-1594.16" font-family="Times,serif" font-size="14.00">Input:[4,2048]</text>
<text text-anchor="middle" x="470" y="-1579.16" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- split_0&#45;&gt;layer0_embed_1 -->
<g id="edge3" class="edge">
<title>split_0&#45;&gt;layer0_embed_1</title>
<path fill="none" stroke="black" d="M390.91,-1724.66C406.32,-1701.61 426.14,-1671.96 442.09,-1648.12"/>
<polygon fill="black" stroke="black" points="445.12,-1649.87 447.77,-1639.62 439.3,-1645.98 445.12,-1649.87"/>
</g>
<!-- embed_ag_0 -->
<g id="node5" class="node">
<title>embed_ag_0</title>
<ellipse fill="lightblue" stroke="black" cx="366" cy="-1412.89" rx="69.09" ry="37.45"/>
<text text-anchor="middle" x="366" y="-1424.19" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
<text text-anchor="middle" x="366" y="-1409.19" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="366" y="-1394.19" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer0_embed_0&#45;&gt;embed_ag_0 -->
<g id="edge4" class="edge">
<title>layer0_embed_0&#45;&gt;embed_ag_0</title>
<path fill="none" stroke="black" d="M280.12,-1571.18C297.26,-1539.78 323.12,-1492.42 341.98,-1457.87"/>
<polygon fill="black" stroke="black" points="345.14,-1459.39 346.86,-1448.94 339,-1456.04 345.14,-1459.39"/>
</g>
<!-- layer0_embed_1&#45;&gt;embed_ag_0 -->
<g id="edge5" class="edge">
<title>layer0_embed_1&#45;&gt;embed_ag_0</title>
<path fill="none" stroke="black" d="M451.88,-1571.18C434.74,-1539.78 408.88,-1492.42 390.02,-1457.87"/>
<polygon fill="black" stroke="black" points="393,-1456.04 385.14,-1448.94 386.86,-1459.39 393,-1456.04"/>
</g>
<!-- layer1_qkv_0 -->
<g id="node6" class="node">
<title>layer1_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="61923.5,-1804.42 61742.5,-1804.42 61742.5,-1721.42 61923.5,-1721.42 61923.5,-1804.42"/>
<text text-anchor="middle" x="61833" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="61833" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="61833" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="61833" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="61833" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer1_qkv_1 -->
<g id="node7" class="node">
<title>layer1_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="61706.5,-1804.42 61525.5,-1804.42 61525.5,-1721.42 61706.5,-1721.42 61706.5,-1804.42"/>
<text text-anchor="middle" x="61616" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="61616" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="61616" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="61616" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="61616" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_1_0 -->
<g id="node8" class="node">
<title>qkv_ar_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="61424" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="61424" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="61424" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="61424" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="61424" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer1_attn_0 -->
<g id="node9" class="node">
<title>layer1_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="61323,-1804.42 61151,-1804.42 61151,-1721.42 61323,-1721.42 61323,-1804.42"/>
<text text-anchor="middle" x="61237" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="61237" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="61237" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="61237" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="61237" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_attn_1 -->
<g id="node10" class="node">
<title>layer1_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="61115,-1804.42 60943,-1804.42 60943,-1721.42 61115,-1721.42 61115,-1804.42"/>
<text text-anchor="middle" x="61029" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="61029" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="61029" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="61029" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="61029" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_attn_out_0 -->
<g id="node11" class="node">
<title>layer1_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="60907,-1804.42 60735,-1804.42 60735,-1721.42 60907,-1721.42 60907,-1804.42"/>
<text text-anchor="middle" x="60821" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="60821" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="60821" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="60821" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="60821" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_attn_out_1 -->
<g id="node12" class="node">
<title>layer1_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="60699,-1804.42 60527,-1804.42 60527,-1721.42 60699,-1721.42 60699,-1804.42"/>
<text text-anchor="middle" x="60613" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="60613" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="60613" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="60613" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="60613" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_1_0 -->
<g id="node13" class="node">
<title>attn_out_ar_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="60426" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="60426" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60426" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60426" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="60426" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer1_ffn_gate_0 -->
<g id="node14" class="node">
<title>layer1_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="60324.5,-1804.42 60143.5,-1804.42 60143.5,-1721.42 60324.5,-1721.42 60324.5,-1804.42"/>
<text text-anchor="middle" x="60234" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="60234" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="60234" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="60234" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="60234" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer1_ffn_gate_1 -->
<g id="node15" class="node">
<title>layer1_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="60107.5,-1804.42 59926.5,-1804.42 59926.5,-1721.42 60107.5,-1721.42 60107.5,-1804.42"/>
<text text-anchor="middle" x="60017" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="60017" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="60017" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="60017" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="60017" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer1_ffn_up_0 -->
<g id="node16" class="node">
<title>layer1_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="59890.5,-1804.42 59709.5,-1804.42 59709.5,-1721.42 59890.5,-1721.42 59890.5,-1804.42"/>
<text text-anchor="middle" x="59800" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="59800" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="59800" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="59800" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="59800" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer1_ffn_up_1 -->
<g id="node17" class="node">
<title>layer1_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="59673.5,-1804.42 59492.5,-1804.42 59492.5,-1721.42 59673.5,-1721.42 59673.5,-1804.42"/>
<text text-anchor="middle" x="59583" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="59583" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="59583" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="59583" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="59583" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_1_0 -->
<g id="node18" class="node">
<title>ffn_ar_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="59391" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="59391" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59391" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="59391" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="59391" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer1_ffn_down_0 -->
<g id="node19" class="node">
<title>layer1_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="59290,-1804.42 59118,-1804.42 59118,-1721.42 59290,-1721.42 59290,-1804.42"/>
<text text-anchor="middle" x="59204" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="59204" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="59204" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="59204" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="59204" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer1_ffn_down_1 -->
<g id="node20" class="node">
<title>layer1_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="59082,-1804.42 58910,-1804.42 58910,-1721.42 59082,-1721.42 59082,-1804.42"/>
<text text-anchor="middle" x="58996" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="58996" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="58996" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="58996" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="58996" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_1_0 -->
<g id="node21" class="node">
<title>ffn_out_ar_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="58801" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="58801" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58801" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="58801" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="58801" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer2_qkv_0 -->
<g id="node22" class="node">
<title>layer2_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="58692.5,-1804.42 58511.5,-1804.42 58511.5,-1721.42 58692.5,-1721.42 58692.5,-1804.42"/>
<text text-anchor="middle" x="58602" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="58602" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="58602" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="58602" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="58602" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer2_qkv_1 -->
<g id="node23" class="node">
<title>layer2_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="58475.5,-1804.42 58294.5,-1804.42 58294.5,-1721.42 58475.5,-1721.42 58475.5,-1804.42"/>
<text text-anchor="middle" x="58385" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="58385" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="58385" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="58385" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="58385" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_2_0 -->
<g id="node24" class="node">
<title>qkv_ar_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="58193" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="58193" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58193" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="58193" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="58193" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer2_attn_0 -->
<g id="node25" class="node">
<title>layer2_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="58092,-1804.42 57920,-1804.42 57920,-1721.42 58092,-1721.42 58092,-1804.42"/>
<text text-anchor="middle" x="58006" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="58006" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="58006" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="58006" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="58006" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_attn_1 -->
<g id="node26" class="node">
<title>layer2_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="57884,-1804.42 57712,-1804.42 57712,-1721.42 57884,-1721.42 57884,-1804.42"/>
<text text-anchor="middle" x="57798" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="57798" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="57798" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="57798" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="57798" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_attn_out_0 -->
<g id="node27" class="node">
<title>layer2_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="57676,-1804.42 57504,-1804.42 57504,-1721.42 57676,-1721.42 57676,-1804.42"/>
<text text-anchor="middle" x="57590" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="57590" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="57590" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="57590" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="57590" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_attn_out_1 -->
<g id="node28" class="node">
<title>layer2_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="57468,-1804.42 57296,-1804.42 57296,-1721.42 57468,-1721.42 57468,-1804.42"/>
<text text-anchor="middle" x="57382" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="57382" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="57382" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="57382" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="57382" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_2_0 -->
<g id="node29" class="node">
<title>attn_out_ar_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="57195" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="57195" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="57195" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="57195" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="57195" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer2_ffn_gate_0 -->
<g id="node30" class="node">
<title>layer2_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="57093.5,-1804.42 56912.5,-1804.42 56912.5,-1721.42 57093.5,-1721.42 57093.5,-1804.42"/>
<text text-anchor="middle" x="57003" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="57003" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="57003" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="57003" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="57003" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer2_ffn_gate_1 -->
<g id="node31" class="node">
<title>layer2_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="56876.5,-1804.42 56695.5,-1804.42 56695.5,-1721.42 56876.5,-1721.42 56876.5,-1804.42"/>
<text text-anchor="middle" x="56786" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="56786" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="56786" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="56786" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="56786" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer2_ffn_up_0 -->
<g id="node32" class="node">
<title>layer2_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="56659.5,-1804.42 56478.5,-1804.42 56478.5,-1721.42 56659.5,-1721.42 56659.5,-1804.42"/>
<text text-anchor="middle" x="56569" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="56569" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="56569" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="56569" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="56569" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer2_ffn_up_1 -->
<g id="node33" class="node">
<title>layer2_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="56442.5,-1804.42 56261.5,-1804.42 56261.5,-1721.42 56442.5,-1721.42 56442.5,-1804.42"/>
<text text-anchor="middle" x="56352" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="56352" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="56352" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="56352" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="56352" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_2_0 -->
<g id="node34" class="node">
<title>ffn_ar_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="56160" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="56160" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56160" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="56160" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="56160" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer2_ffn_down_0 -->
<g id="node35" class="node">
<title>layer2_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="56059,-1804.42 55887,-1804.42 55887,-1721.42 56059,-1721.42 56059,-1804.42"/>
<text text-anchor="middle" x="55973" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="55973" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="55973" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="55973" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="55973" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer2_ffn_down_1 -->
<g id="node36" class="node">
<title>layer2_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="55851,-1804.42 55679,-1804.42 55679,-1721.42 55851,-1721.42 55851,-1804.42"/>
<text text-anchor="middle" x="55765" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="55765" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="55765" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="55765" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="55765" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_2_0 -->
<g id="node37" class="node">
<title>ffn_out_ar_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="55570" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="55570" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55570" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="55570" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="55570" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer3_qkv_0 -->
<g id="node38" class="node">
<title>layer3_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="55461.5,-1804.42 55280.5,-1804.42 55280.5,-1721.42 55461.5,-1721.42 55461.5,-1804.42"/>
<text text-anchor="middle" x="55371" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="55371" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="55371" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="55371" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="55371" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer3_qkv_1 -->
<g id="node39" class="node">
<title>layer3_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="55244.5,-1804.42 55063.5,-1804.42 55063.5,-1721.42 55244.5,-1721.42 55244.5,-1804.42"/>
<text text-anchor="middle" x="55154" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="55154" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="55154" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="55154" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="55154" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_3_0 -->
<g id="node40" class="node">
<title>qkv_ar_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="54962" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="54962" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54962" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="54962" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="54962" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer3_attn_0 -->
<g id="node41" class="node">
<title>layer3_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="54861,-1804.42 54689,-1804.42 54689,-1721.42 54861,-1721.42 54861,-1804.42"/>
<text text-anchor="middle" x="54775" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="54775" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="54775" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="54775" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="54775" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_attn_1 -->
<g id="node42" class="node">
<title>layer3_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="54653,-1804.42 54481,-1804.42 54481,-1721.42 54653,-1721.42 54653,-1804.42"/>
<text text-anchor="middle" x="54567" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="54567" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="54567" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="54567" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="54567" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_attn_out_0 -->
<g id="node43" class="node">
<title>layer3_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="54445,-1804.42 54273,-1804.42 54273,-1721.42 54445,-1721.42 54445,-1804.42"/>
<text text-anchor="middle" x="54359" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="54359" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="54359" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="54359" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="54359" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_attn_out_1 -->
<g id="node44" class="node">
<title>layer3_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="54237,-1804.42 54065,-1804.42 54065,-1721.42 54237,-1721.42 54237,-1804.42"/>
<text text-anchor="middle" x="54151" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="54151" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="54151" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="54151" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="54151" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_3_0 -->
<g id="node45" class="node">
<title>attn_out_ar_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="53964" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="53964" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="53964" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="53964" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="53964" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer3_ffn_gate_0 -->
<g id="node46" class="node">
<title>layer3_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="53862.5,-1804.42 53681.5,-1804.42 53681.5,-1721.42 53862.5,-1721.42 53862.5,-1804.42"/>
<text text-anchor="middle" x="53772" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="53772" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="53772" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="53772" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="53772" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer3_ffn_gate_1 -->
<g id="node47" class="node">
<title>layer3_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="53645.5,-1804.42 53464.5,-1804.42 53464.5,-1721.42 53645.5,-1721.42 53645.5,-1804.42"/>
<text text-anchor="middle" x="53555" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="53555" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="53555" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="53555" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="53555" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer3_ffn_up_0 -->
<g id="node48" class="node">
<title>layer3_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="53428.5,-1804.42 53247.5,-1804.42 53247.5,-1721.42 53428.5,-1721.42 53428.5,-1804.42"/>
<text text-anchor="middle" x="53338" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="53338" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="53338" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="53338" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="53338" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer3_ffn_up_1 -->
<g id="node49" class="node">
<title>layer3_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="53211.5,-1804.42 53030.5,-1804.42 53030.5,-1721.42 53211.5,-1721.42 53211.5,-1804.42"/>
<text text-anchor="middle" x="53121" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="53121" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="53121" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="53121" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="53121" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_3_0 -->
<g id="node50" class="node">
<title>ffn_ar_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="52929" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="52929" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52929" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="52929" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="52929" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer3_ffn_down_0 -->
<g id="node51" class="node">
<title>layer3_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="52828,-1804.42 52656,-1804.42 52656,-1721.42 52828,-1721.42 52828,-1804.42"/>
<text text-anchor="middle" x="52742" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="52742" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="52742" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="52742" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="52742" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer3_ffn_down_1 -->
<g id="node52" class="node">
<title>layer3_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="52620,-1804.42 52448,-1804.42 52448,-1721.42 52620,-1721.42 52620,-1804.42"/>
<text text-anchor="middle" x="52534" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="52534" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="52534" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="52534" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="52534" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_3_0 -->
<g id="node53" class="node">
<title>ffn_out_ar_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="52339" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="52339" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52339" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="52339" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="52339" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer4_qkv_0 -->
<g id="node54" class="node">
<title>layer4_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="52230.5,-1804.42 52049.5,-1804.42 52049.5,-1721.42 52230.5,-1721.42 52230.5,-1804.42"/>
<text text-anchor="middle" x="52140" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="52140" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="52140" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="52140" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="52140" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer4_qkv_1 -->
<g id="node55" class="node">
<title>layer4_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="52013.5,-1804.42 51832.5,-1804.42 51832.5,-1721.42 52013.5,-1721.42 52013.5,-1804.42"/>
<text text-anchor="middle" x="51923" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="51923" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="51923" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="51923" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="51923" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_4_0 -->
<g id="node56" class="node">
<title>qkv_ar_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="51731" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="51731" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51731" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="51731" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="51731" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer4_attn_0 -->
<g id="node57" class="node">
<title>layer4_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="51630,-1804.42 51458,-1804.42 51458,-1721.42 51630,-1721.42 51630,-1804.42"/>
<text text-anchor="middle" x="51544" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="51544" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="51544" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="51544" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="51544" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_attn_1 -->
<g id="node58" class="node">
<title>layer4_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="51422,-1804.42 51250,-1804.42 51250,-1721.42 51422,-1721.42 51422,-1804.42"/>
<text text-anchor="middle" x="51336" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="51336" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="51336" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="51336" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="51336" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_attn_out_0 -->
<g id="node59" class="node">
<title>layer4_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="51214,-1804.42 51042,-1804.42 51042,-1721.42 51214,-1721.42 51214,-1804.42"/>
<text text-anchor="middle" x="51128" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="51128" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="51128" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="51128" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="51128" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_attn_out_1 -->
<g id="node60" class="node">
<title>layer4_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="51006,-1804.42 50834,-1804.42 50834,-1721.42 51006,-1721.42 51006,-1804.42"/>
<text text-anchor="middle" x="50920" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="50920" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="50920" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="50920" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="50920" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_4_0 -->
<g id="node61" class="node">
<title>attn_out_ar_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="50733" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="50733" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50733" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="50733" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="50733" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer4_ffn_gate_0 -->
<g id="node62" class="node">
<title>layer4_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="50631.5,-1804.42 50450.5,-1804.42 50450.5,-1721.42 50631.5,-1721.42 50631.5,-1804.42"/>
<text text-anchor="middle" x="50541" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="50541" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="50541" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="50541" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="50541" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer4_ffn_gate_1 -->
<g id="node63" class="node">
<title>layer4_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="50414.5,-1804.42 50233.5,-1804.42 50233.5,-1721.42 50414.5,-1721.42 50414.5,-1804.42"/>
<text text-anchor="middle" x="50324" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="50324" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="50324" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="50324" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="50324" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer4_ffn_up_0 -->
<g id="node64" class="node">
<title>layer4_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="50197.5,-1804.42 50016.5,-1804.42 50016.5,-1721.42 50197.5,-1721.42 50197.5,-1804.42"/>
<text text-anchor="middle" x="50107" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="50107" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="50107" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="50107" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="50107" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer4_ffn_up_1 -->
<g id="node65" class="node">
<title>layer4_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="49980.5,-1804.42 49799.5,-1804.42 49799.5,-1721.42 49980.5,-1721.42 49980.5,-1804.42"/>
<text text-anchor="middle" x="49890" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="49890" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="49890" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="49890" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="49890" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_4_0 -->
<g id="node66" class="node">
<title>ffn_ar_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="49698" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="49698" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49698" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="49698" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="49698" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer4_ffn_down_0 -->
<g id="node67" class="node">
<title>layer4_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="49597,-1804.42 49425,-1804.42 49425,-1721.42 49597,-1721.42 49597,-1804.42"/>
<text text-anchor="middle" x="49511" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="49511" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="49511" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="49511" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="49511" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer4_ffn_down_1 -->
<g id="node68" class="node">
<title>layer4_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="49389,-1804.42 49217,-1804.42 49217,-1721.42 49389,-1721.42 49389,-1804.42"/>
<text text-anchor="middle" x="49303" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="49303" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="49303" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="49303" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="49303" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_4_0 -->
<g id="node69" class="node">
<title>ffn_out_ar_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="49108" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="49108" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49108" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="49108" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="49108" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer5_qkv_0 -->
<g id="node70" class="node">
<title>layer5_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="48999.5,-1804.42 48818.5,-1804.42 48818.5,-1721.42 48999.5,-1721.42 48999.5,-1804.42"/>
<text text-anchor="middle" x="48909" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="48909" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="48909" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="48909" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="48909" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer5_qkv_1 -->
<g id="node71" class="node">
<title>layer5_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="48782.5,-1804.42 48601.5,-1804.42 48601.5,-1721.42 48782.5,-1721.42 48782.5,-1804.42"/>
<text text-anchor="middle" x="48692" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="48692" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="48692" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="48692" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="48692" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_5_0 -->
<g id="node72" class="node">
<title>qkv_ar_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="48500" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="48500" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="48500" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="48500" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="48500" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer5_attn_0 -->
<g id="node73" class="node">
<title>layer5_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="48399,-1804.42 48227,-1804.42 48227,-1721.42 48399,-1721.42 48399,-1804.42"/>
<text text-anchor="middle" x="48313" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="48313" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="48313" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="48313" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="48313" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_attn_1 -->
<g id="node74" class="node">
<title>layer5_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="48191,-1804.42 48019,-1804.42 48019,-1721.42 48191,-1721.42 48191,-1804.42"/>
<text text-anchor="middle" x="48105" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="48105" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="48105" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="48105" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="48105" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_attn_out_0 -->
<g id="node75" class="node">
<title>layer5_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="47983,-1804.42 47811,-1804.42 47811,-1721.42 47983,-1721.42 47983,-1804.42"/>
<text text-anchor="middle" x="47897" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="47897" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="47897" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="47897" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="47897" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_attn_out_1 -->
<g id="node76" class="node">
<title>layer5_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="47775,-1804.42 47603,-1804.42 47603,-1721.42 47775,-1721.42 47775,-1804.42"/>
<text text-anchor="middle" x="47689" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="47689" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="47689" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="47689" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="47689" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_5_0 -->
<g id="node77" class="node">
<title>attn_out_ar_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="47502" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="47502" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="47502" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="47502" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="47502" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer5_ffn_gate_0 -->
<g id="node78" class="node">
<title>layer5_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="47400.5,-1804.42 47219.5,-1804.42 47219.5,-1721.42 47400.5,-1721.42 47400.5,-1804.42"/>
<text text-anchor="middle" x="47310" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="47310" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="47310" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="47310" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="47310" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer5_ffn_gate_1 -->
<g id="node79" class="node">
<title>layer5_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="47183.5,-1804.42 47002.5,-1804.42 47002.5,-1721.42 47183.5,-1721.42 47183.5,-1804.42"/>
<text text-anchor="middle" x="47093" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="47093" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="47093" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="47093" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="47093" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer5_ffn_up_0 -->
<g id="node80" class="node">
<title>layer5_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="46966.5,-1804.42 46785.5,-1804.42 46785.5,-1721.42 46966.5,-1721.42 46966.5,-1804.42"/>
<text text-anchor="middle" x="46876" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="46876" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="46876" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="46876" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="46876" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer5_ffn_up_1 -->
<g id="node81" class="node">
<title>layer5_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="46749.5,-1804.42 46568.5,-1804.42 46568.5,-1721.42 46749.5,-1721.42 46749.5,-1804.42"/>
<text text-anchor="middle" x="46659" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="46659" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="46659" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="46659" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="46659" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_5_0 -->
<g id="node82" class="node">
<title>ffn_ar_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="46467" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="46467" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="46467" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="46467" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="46467" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer5_ffn_down_0 -->
<g id="node83" class="node">
<title>layer5_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="46366,-1804.42 46194,-1804.42 46194,-1721.42 46366,-1721.42 46366,-1804.42"/>
<text text-anchor="middle" x="46280" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="46280" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="46280" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="46280" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="46280" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer5_ffn_down_1 -->
<g id="node84" class="node">
<title>layer5_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="46158,-1804.42 45986,-1804.42 45986,-1721.42 46158,-1721.42 46158,-1804.42"/>
<text text-anchor="middle" x="46072" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="46072" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="46072" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="46072" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="46072" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_5_0 -->
<g id="node85" class="node">
<title>ffn_out_ar_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="45877" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="45877" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="45877" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="45877" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="45877" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer6_qkv_0 -->
<g id="node86" class="node">
<title>layer6_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="45768.5,-1804.42 45587.5,-1804.42 45587.5,-1721.42 45768.5,-1721.42 45768.5,-1804.42"/>
<text text-anchor="middle" x="45678" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="45678" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="45678" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="45678" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="45678" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer6_qkv_1 -->
<g id="node87" class="node">
<title>layer6_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="45551.5,-1804.42 45370.5,-1804.42 45370.5,-1721.42 45551.5,-1721.42 45551.5,-1804.42"/>
<text text-anchor="middle" x="45461" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="45461" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="45461" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="45461" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="45461" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_6_0 -->
<g id="node88" class="node">
<title>qkv_ar_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="45269" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="45269" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="45269" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="45269" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="45269" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer6_attn_0 -->
<g id="node89" class="node">
<title>layer6_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="45168,-1804.42 44996,-1804.42 44996,-1721.42 45168,-1721.42 45168,-1804.42"/>
<text text-anchor="middle" x="45082" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="45082" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="45082" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="45082" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="45082" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_attn_1 -->
<g id="node90" class="node">
<title>layer6_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="44960,-1804.42 44788,-1804.42 44788,-1721.42 44960,-1721.42 44960,-1804.42"/>
<text text-anchor="middle" x="44874" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="44874" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="44874" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="44874" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="44874" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_attn_out_0 -->
<g id="node91" class="node">
<title>layer6_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="44752,-1804.42 44580,-1804.42 44580,-1721.42 44752,-1721.42 44752,-1804.42"/>
<text text-anchor="middle" x="44666" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="44666" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="44666" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="44666" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="44666" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_attn_out_1 -->
<g id="node92" class="node">
<title>layer6_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="44544,-1804.42 44372,-1804.42 44372,-1721.42 44544,-1721.42 44544,-1804.42"/>
<text text-anchor="middle" x="44458" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="44458" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="44458" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="44458" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="44458" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_6_0 -->
<g id="node93" class="node">
<title>attn_out_ar_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="44271" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="44271" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="44271" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="44271" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="44271" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer6_ffn_gate_0 -->
<g id="node94" class="node">
<title>layer6_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="44169.5,-1804.42 43988.5,-1804.42 43988.5,-1721.42 44169.5,-1721.42 44169.5,-1804.42"/>
<text text-anchor="middle" x="44079" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="44079" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="44079" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="44079" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="44079" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer6_ffn_gate_1 -->
<g id="node95" class="node">
<title>layer6_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="43952.5,-1804.42 43771.5,-1804.42 43771.5,-1721.42 43952.5,-1721.42 43952.5,-1804.42"/>
<text text-anchor="middle" x="43862" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="43862" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="43862" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="43862" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="43862" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer6_ffn_up_0 -->
<g id="node96" class="node">
<title>layer6_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="43735.5,-1804.42 43554.5,-1804.42 43554.5,-1721.42 43735.5,-1721.42 43735.5,-1804.42"/>
<text text-anchor="middle" x="43645" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="43645" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="43645" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="43645" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="43645" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer6_ffn_up_1 -->
<g id="node97" class="node">
<title>layer6_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="43518.5,-1804.42 43337.5,-1804.42 43337.5,-1721.42 43518.5,-1721.42 43518.5,-1804.42"/>
<text text-anchor="middle" x="43428" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="43428" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="43428" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="43428" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="43428" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_6_0 -->
<g id="node98" class="node">
<title>ffn_ar_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="43236" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="43236" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="43236" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="43236" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="43236" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer6_ffn_down_0 -->
<g id="node99" class="node">
<title>layer6_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="43135,-1804.42 42963,-1804.42 42963,-1721.42 43135,-1721.42 43135,-1804.42"/>
<text text-anchor="middle" x="43049" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="43049" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="43049" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="43049" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="43049" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer6_ffn_down_1 -->
<g id="node100" class="node">
<title>layer6_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="42927,-1804.42 42755,-1804.42 42755,-1721.42 42927,-1721.42 42927,-1804.42"/>
<text text-anchor="middle" x="42841" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="42841" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="42841" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="42841" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="42841" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_6_0 -->
<g id="node101" class="node">
<title>ffn_out_ar_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="42646" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="42646" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="42646" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="42646" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="42646" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer7_qkv_0 -->
<g id="node102" class="node">
<title>layer7_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="42537.5,-1804.42 42356.5,-1804.42 42356.5,-1721.42 42537.5,-1721.42 42537.5,-1804.42"/>
<text text-anchor="middle" x="42447" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="42447" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="42447" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="42447" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="42447" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer7_qkv_1 -->
<g id="node103" class="node">
<title>layer7_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="42320.5,-1804.42 42139.5,-1804.42 42139.5,-1721.42 42320.5,-1721.42 42320.5,-1804.42"/>
<text text-anchor="middle" x="42230" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="42230" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="42230" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="42230" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="42230" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_7_0 -->
<g id="node104" class="node">
<title>qkv_ar_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="42038" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="42038" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="42038" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="42038" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="42038" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer7_attn_0 -->
<g id="node105" class="node">
<title>layer7_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="41937,-1804.42 41765,-1804.42 41765,-1721.42 41937,-1721.42 41937,-1804.42"/>
<text text-anchor="middle" x="41851" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="41851" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="41851" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="41851" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="41851" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_attn_1 -->
<g id="node106" class="node">
<title>layer7_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="41729,-1804.42 41557,-1804.42 41557,-1721.42 41729,-1721.42 41729,-1804.42"/>
<text text-anchor="middle" x="41643" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="41643" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="41643" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="41643" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="41643" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_attn_out_0 -->
<g id="node107" class="node">
<title>layer7_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="41521,-1804.42 41349,-1804.42 41349,-1721.42 41521,-1721.42 41521,-1804.42"/>
<text text-anchor="middle" x="41435" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="41435" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="41435" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="41435" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="41435" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_attn_out_1 -->
<g id="node108" class="node">
<title>layer7_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="41313,-1804.42 41141,-1804.42 41141,-1721.42 41313,-1721.42 41313,-1804.42"/>
<text text-anchor="middle" x="41227" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="41227" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="41227" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="41227" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="41227" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_7_0 -->
<g id="node109" class="node">
<title>attn_out_ar_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="41040" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="41040" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="41040" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="41040" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="41040" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer7_ffn_gate_0 -->
<g id="node110" class="node">
<title>layer7_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="40938.5,-1804.42 40757.5,-1804.42 40757.5,-1721.42 40938.5,-1721.42 40938.5,-1804.42"/>
<text text-anchor="middle" x="40848" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="40848" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="40848" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="40848" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="40848" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer7_ffn_gate_1 -->
<g id="node111" class="node">
<title>layer7_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="40721.5,-1804.42 40540.5,-1804.42 40540.5,-1721.42 40721.5,-1721.42 40721.5,-1804.42"/>
<text text-anchor="middle" x="40631" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="40631" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="40631" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="40631" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="40631" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer7_ffn_up_0 -->
<g id="node112" class="node">
<title>layer7_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="40504.5,-1804.42 40323.5,-1804.42 40323.5,-1721.42 40504.5,-1721.42 40504.5,-1804.42"/>
<text text-anchor="middle" x="40414" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="40414" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="40414" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="40414" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="40414" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer7_ffn_up_1 -->
<g id="node113" class="node">
<title>layer7_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="40287.5,-1804.42 40106.5,-1804.42 40106.5,-1721.42 40287.5,-1721.42 40287.5,-1804.42"/>
<text text-anchor="middle" x="40197" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="40197" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="40197" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="40197" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="40197" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_7_0 -->
<g id="node114" class="node">
<title>ffn_ar_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="40005" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="40005" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="40005" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="40005" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="40005" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer7_ffn_down_0 -->
<g id="node115" class="node">
<title>layer7_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="39904,-1804.42 39732,-1804.42 39732,-1721.42 39904,-1721.42 39904,-1804.42"/>
<text text-anchor="middle" x="39818" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="39818" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="39818" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="39818" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="39818" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer7_ffn_down_1 -->
<g id="node116" class="node">
<title>layer7_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="39696,-1804.42 39524,-1804.42 39524,-1721.42 39696,-1721.42 39696,-1804.42"/>
<text text-anchor="middle" x="39610" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="39610" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="39610" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="39610" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="39610" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_7_0 -->
<g id="node117" class="node">
<title>ffn_out_ar_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="39415" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="39415" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="39415" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="39415" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="39415" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer8_qkv_0 -->
<g id="node118" class="node">
<title>layer8_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="39306.5,-1804.42 39125.5,-1804.42 39125.5,-1721.42 39306.5,-1721.42 39306.5,-1804.42"/>
<text text-anchor="middle" x="39216" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="39216" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="39216" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="39216" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="39216" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer8_qkv_1 -->
<g id="node119" class="node">
<title>layer8_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="39089.5,-1804.42 38908.5,-1804.42 38908.5,-1721.42 39089.5,-1721.42 39089.5,-1804.42"/>
<text text-anchor="middle" x="38999" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="38999" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="38999" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="38999" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="38999" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_8_0 -->
<g id="node120" class="node">
<title>qkv_ar_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="38807" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="38807" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="38807" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="38807" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="38807" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer8_attn_0 -->
<g id="node121" class="node">
<title>layer8_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="38706,-1804.42 38534,-1804.42 38534,-1721.42 38706,-1721.42 38706,-1804.42"/>
<text text-anchor="middle" x="38620" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="38620" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="38620" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="38620" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="38620" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_attn_1 -->
<g id="node122" class="node">
<title>layer8_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="38498,-1804.42 38326,-1804.42 38326,-1721.42 38498,-1721.42 38498,-1804.42"/>
<text text-anchor="middle" x="38412" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="38412" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="38412" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="38412" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="38412" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_attn_out_0 -->
<g id="node123" class="node">
<title>layer8_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="38290,-1804.42 38118,-1804.42 38118,-1721.42 38290,-1721.42 38290,-1804.42"/>
<text text-anchor="middle" x="38204" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="38204" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="38204" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="38204" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="38204" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_attn_out_1 -->
<g id="node124" class="node">
<title>layer8_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="38082,-1804.42 37910,-1804.42 37910,-1721.42 38082,-1721.42 38082,-1804.42"/>
<text text-anchor="middle" x="37996" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="37996" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="37996" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="37996" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="37996" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_8_0 -->
<g id="node125" class="node">
<title>attn_out_ar_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="37809" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="37809" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="37809" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="37809" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="37809" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer8_ffn_gate_0 -->
<g id="node126" class="node">
<title>layer8_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="37707.5,-1804.42 37526.5,-1804.42 37526.5,-1721.42 37707.5,-1721.42 37707.5,-1804.42"/>
<text text-anchor="middle" x="37617" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="37617" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="37617" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="37617" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="37617" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer8_ffn_gate_1 -->
<g id="node127" class="node">
<title>layer8_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="37490.5,-1804.42 37309.5,-1804.42 37309.5,-1721.42 37490.5,-1721.42 37490.5,-1804.42"/>
<text text-anchor="middle" x="37400" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="37400" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="37400" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="37400" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="37400" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer8_ffn_up_0 -->
<g id="node128" class="node">
<title>layer8_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="37273.5,-1804.42 37092.5,-1804.42 37092.5,-1721.42 37273.5,-1721.42 37273.5,-1804.42"/>
<text text-anchor="middle" x="37183" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="37183" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="37183" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="37183" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="37183" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer8_ffn_up_1 -->
<g id="node129" class="node">
<title>layer8_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="37056.5,-1804.42 36875.5,-1804.42 36875.5,-1721.42 37056.5,-1721.42 37056.5,-1804.42"/>
<text text-anchor="middle" x="36966" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="36966" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="36966" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="36966" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="36966" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_8_0 -->
<g id="node130" class="node">
<title>ffn_ar_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="36774" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="36774" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="36774" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="36774" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="36774" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer8_ffn_down_0 -->
<g id="node131" class="node">
<title>layer8_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="36673,-1804.42 36501,-1804.42 36501,-1721.42 36673,-1721.42 36673,-1804.42"/>
<text text-anchor="middle" x="36587" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="36587" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="36587" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="36587" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="36587" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer8_ffn_down_1 -->
<g id="node132" class="node">
<title>layer8_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="36465,-1804.42 36293,-1804.42 36293,-1721.42 36465,-1721.42 36465,-1804.42"/>
<text text-anchor="middle" x="36379" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="36379" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="36379" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="36379" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="36379" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_8_0 -->
<g id="node133" class="node">
<title>ffn_out_ar_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="36184" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="36184" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="36184" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="36184" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="36184" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer9_qkv_0 -->
<g id="node134" class="node">
<title>layer9_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="36075.5,-1804.42 35894.5,-1804.42 35894.5,-1721.42 36075.5,-1721.42 36075.5,-1804.42"/>
<text text-anchor="middle" x="35985" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="35985" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="35985" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="35985" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="35985" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer9_qkv_1 -->
<g id="node135" class="node">
<title>layer9_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="35858.5,-1804.42 35677.5,-1804.42 35677.5,-1721.42 35858.5,-1721.42 35858.5,-1804.42"/>
<text text-anchor="middle" x="35768" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="35768" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="35768" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="35768" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="35768" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_9_0 -->
<g id="node136" class="node">
<title>qkv_ar_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="35576" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="35576" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="35576" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="35576" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="35576" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer9_attn_0 -->
<g id="node137" class="node">
<title>layer9_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="35475,-1804.42 35303,-1804.42 35303,-1721.42 35475,-1721.42 35475,-1804.42"/>
<text text-anchor="middle" x="35389" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="35389" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="35389" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="35389" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="35389" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_attn_1 -->
<g id="node138" class="node">
<title>layer9_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="35267,-1804.42 35095,-1804.42 35095,-1721.42 35267,-1721.42 35267,-1804.42"/>
<text text-anchor="middle" x="35181" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="35181" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="35181" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="35181" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="35181" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_attn_out_0 -->
<g id="node139" class="node">
<title>layer9_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="35059,-1804.42 34887,-1804.42 34887,-1721.42 35059,-1721.42 35059,-1804.42"/>
<text text-anchor="middle" x="34973" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="34973" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="34973" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="34973" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="34973" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_attn_out_1 -->
<g id="node140" class="node">
<title>layer9_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="34851,-1804.42 34679,-1804.42 34679,-1721.42 34851,-1721.42 34851,-1804.42"/>
<text text-anchor="middle" x="34765" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="34765" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="34765" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="34765" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="34765" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_9_0 -->
<g id="node141" class="node">
<title>attn_out_ar_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="34578" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="34578" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="34578" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="34578" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="34578" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer9_ffn_gate_0 -->
<g id="node142" class="node">
<title>layer9_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="34476.5,-1804.42 34295.5,-1804.42 34295.5,-1721.42 34476.5,-1721.42 34476.5,-1804.42"/>
<text text-anchor="middle" x="34386" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="34386" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="34386" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="34386" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="34386" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer9_ffn_gate_1 -->
<g id="node143" class="node">
<title>layer9_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="34259.5,-1804.42 34078.5,-1804.42 34078.5,-1721.42 34259.5,-1721.42 34259.5,-1804.42"/>
<text text-anchor="middle" x="34169" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="34169" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="34169" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="34169" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="34169" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer9_ffn_up_0 -->
<g id="node144" class="node">
<title>layer9_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="34042.5,-1804.42 33861.5,-1804.42 33861.5,-1721.42 34042.5,-1721.42 34042.5,-1804.42"/>
<text text-anchor="middle" x="33952" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="33952" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="33952" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="33952" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="33952" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer9_ffn_up_1 -->
<g id="node145" class="node">
<title>layer9_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="33825.5,-1804.42 33644.5,-1804.42 33644.5,-1721.42 33825.5,-1721.42 33825.5,-1804.42"/>
<text text-anchor="middle" x="33735" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="33735" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="33735" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="33735" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="33735" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_9_0 -->
<g id="node146" class="node">
<title>ffn_ar_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="33543" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="33543" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="33543" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="33543" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="33543" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer9_ffn_down_0 -->
<g id="node147" class="node">
<title>layer9_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="33442,-1804.42 33270,-1804.42 33270,-1721.42 33442,-1721.42 33442,-1804.42"/>
<text text-anchor="middle" x="33356" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="33356" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="33356" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="33356" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="33356" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer9_ffn_down_1 -->
<g id="node148" class="node">
<title>layer9_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="33234,-1804.42 33062,-1804.42 33062,-1721.42 33234,-1721.42 33234,-1804.42"/>
<text text-anchor="middle" x="33148" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="33148" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="33148" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="33148" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="33148" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_9_0 -->
<g id="node149" class="node">
<title>ffn_out_ar_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="32953" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="32953" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="32953" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="32953" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="32953" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer10_qkv_0 -->
<g id="node150" class="node">
<title>layer10_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="32844.5,-1804.42 32663.5,-1804.42 32663.5,-1721.42 32844.5,-1721.42 32844.5,-1804.42"/>
<text text-anchor="middle" x="32754" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="32754" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="32754" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="32754" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="32754" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer10_qkv_1 -->
<g id="node151" class="node">
<title>layer10_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="32627.5,-1804.42 32446.5,-1804.42 32446.5,-1721.42 32627.5,-1721.42 32627.5,-1804.42"/>
<text text-anchor="middle" x="32537" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="32537" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="32537" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="32537" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="32537" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_10_0 -->
<g id="node152" class="node">
<title>qkv_ar_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="32345" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="32345" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="32345" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="32345" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="32345" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer10_attn_0 -->
<g id="node153" class="node">
<title>layer10_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="32244,-1804.42 32072,-1804.42 32072,-1721.42 32244,-1721.42 32244,-1804.42"/>
<text text-anchor="middle" x="32158" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="32158" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="32158" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="32158" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="32158" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_attn_1 -->
<g id="node154" class="node">
<title>layer10_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="32036,-1804.42 31864,-1804.42 31864,-1721.42 32036,-1721.42 32036,-1804.42"/>
<text text-anchor="middle" x="31950" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="31950" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="31950" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="31950" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="31950" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_attn_out_0 -->
<g id="node155" class="node">
<title>layer10_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="31828,-1804.42 31656,-1804.42 31656,-1721.42 31828,-1721.42 31828,-1804.42"/>
<text text-anchor="middle" x="31742" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="31742" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="31742" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="31742" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="31742" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_attn_out_1 -->
<g id="node156" class="node">
<title>layer10_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="31620,-1804.42 31448,-1804.42 31448,-1721.42 31620,-1721.42 31620,-1804.42"/>
<text text-anchor="middle" x="31534" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="31534" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="31534" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="31534" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="31534" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_10_0 -->
<g id="node157" class="node">
<title>attn_out_ar_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="31347" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="31347" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="31347" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="31347" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="31347" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer10_ffn_gate_0 -->
<g id="node158" class="node">
<title>layer10_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="31245.5,-1804.42 31064.5,-1804.42 31064.5,-1721.42 31245.5,-1721.42 31245.5,-1804.42"/>
<text text-anchor="middle" x="31155" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="31155" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="31155" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="31155" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="31155" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer10_ffn_gate_1 -->
<g id="node159" class="node">
<title>layer10_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="31028.5,-1804.42 30847.5,-1804.42 30847.5,-1721.42 31028.5,-1721.42 31028.5,-1804.42"/>
<text text-anchor="middle" x="30938" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="30938" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="30938" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="30938" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="30938" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer10_ffn_up_0 -->
<g id="node160" class="node">
<title>layer10_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="30811.5,-1804.42 30630.5,-1804.42 30630.5,-1721.42 30811.5,-1721.42 30811.5,-1804.42"/>
<text text-anchor="middle" x="30721" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="30721" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="30721" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="30721" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="30721" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer10_ffn_up_1 -->
<g id="node161" class="node">
<title>layer10_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="30594.5,-1804.42 30413.5,-1804.42 30413.5,-1721.42 30594.5,-1721.42 30594.5,-1804.42"/>
<text text-anchor="middle" x="30504" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="30504" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="30504" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="30504" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="30504" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_10_0 -->
<g id="node162" class="node">
<title>ffn_ar_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="30312" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="30312" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="30312" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="30312" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="30312" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer10_ffn_down_0 -->
<g id="node163" class="node">
<title>layer10_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="30211,-1804.42 30039,-1804.42 30039,-1721.42 30211,-1721.42 30211,-1804.42"/>
<text text-anchor="middle" x="30125" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="30125" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="30125" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="30125" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="30125" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer10_ffn_down_1 -->
<g id="node164" class="node">
<title>layer10_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="30003,-1804.42 29831,-1804.42 29831,-1721.42 30003,-1721.42 30003,-1804.42"/>
<text text-anchor="middle" x="29917" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="29917" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="29917" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="29917" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="29917" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_10_0 -->
<g id="node165" class="node">
<title>ffn_out_ar_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="29722" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="29722" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="29722" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="29722" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="29722" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer11_qkv_0 -->
<g id="node166" class="node">
<title>layer11_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="29613.5,-1804.42 29432.5,-1804.42 29432.5,-1721.42 29613.5,-1721.42 29613.5,-1804.42"/>
<text text-anchor="middle" x="29523" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="29523" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="29523" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="29523" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="29523" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer11_qkv_1 -->
<g id="node167" class="node">
<title>layer11_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="29396.5,-1804.42 29215.5,-1804.42 29215.5,-1721.42 29396.5,-1721.42 29396.5,-1804.42"/>
<text text-anchor="middle" x="29306" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="29306" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="29306" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="29306" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="29306" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_11_0 -->
<g id="node168" class="node">
<title>qkv_ar_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="29114" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="29114" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="29114" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="29114" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="29114" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer11_attn_0 -->
<g id="node169" class="node">
<title>layer11_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="29013,-1804.42 28841,-1804.42 28841,-1721.42 29013,-1721.42 29013,-1804.42"/>
<text text-anchor="middle" x="28927" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="28927" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="28927" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="28927" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="28927" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_attn_1 -->
<g id="node170" class="node">
<title>layer11_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="28805,-1804.42 28633,-1804.42 28633,-1721.42 28805,-1721.42 28805,-1804.42"/>
<text text-anchor="middle" x="28719" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="28719" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="28719" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="28719" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="28719" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_attn_out_0 -->
<g id="node171" class="node">
<title>layer11_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="28597,-1804.42 28425,-1804.42 28425,-1721.42 28597,-1721.42 28597,-1804.42"/>
<text text-anchor="middle" x="28511" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="28511" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="28511" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="28511" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="28511" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_attn_out_1 -->
<g id="node172" class="node">
<title>layer11_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="28389,-1804.42 28217,-1804.42 28217,-1721.42 28389,-1721.42 28389,-1804.42"/>
<text text-anchor="middle" x="28303" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="28303" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="28303" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="28303" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="28303" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_11_0 -->
<g id="node173" class="node">
<title>attn_out_ar_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="28116" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="28116" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28116" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="28116" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="28116" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer11_ffn_gate_0 -->
<g id="node174" class="node">
<title>layer11_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="28014.5,-1804.42 27833.5,-1804.42 27833.5,-1721.42 28014.5,-1721.42 28014.5,-1804.42"/>
<text text-anchor="middle" x="27924" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="27924" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="27924" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="27924" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="27924" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer11_ffn_gate_1 -->
<g id="node175" class="node">
<title>layer11_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="27797.5,-1804.42 27616.5,-1804.42 27616.5,-1721.42 27797.5,-1721.42 27797.5,-1804.42"/>
<text text-anchor="middle" x="27707" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="27707" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="27707" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="27707" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="27707" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer11_ffn_up_0 -->
<g id="node176" class="node">
<title>layer11_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="27580.5,-1804.42 27399.5,-1804.42 27399.5,-1721.42 27580.5,-1721.42 27580.5,-1804.42"/>
<text text-anchor="middle" x="27490" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="27490" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="27490" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="27490" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="27490" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer11_ffn_up_1 -->
<g id="node177" class="node">
<title>layer11_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="27363.5,-1804.42 27182.5,-1804.42 27182.5,-1721.42 27363.5,-1721.42 27363.5,-1804.42"/>
<text text-anchor="middle" x="27273" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="27273" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="27273" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="27273" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="27273" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_11_0 -->
<g id="node178" class="node">
<title>ffn_ar_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="27081" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="27081" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="27081" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="27081" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="27081" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer11_ffn_down_0 -->
<g id="node179" class="node">
<title>layer11_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="26980,-1804.42 26808,-1804.42 26808,-1721.42 26980,-1721.42 26980,-1804.42"/>
<text text-anchor="middle" x="26894" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="26894" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="26894" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="26894" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="26894" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer11_ffn_down_1 -->
<g id="node180" class="node">
<title>layer11_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="26772,-1804.42 26600,-1804.42 26600,-1721.42 26772,-1721.42 26772,-1804.42"/>
<text text-anchor="middle" x="26686" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="26686" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="26686" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="26686" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="26686" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_11_0 -->
<g id="node181" class="node">
<title>ffn_out_ar_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="26491" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="26491" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="26491" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="26491" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="26491" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer12_qkv_0 -->
<g id="node182" class="node">
<title>layer12_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="26382.5,-1804.42 26201.5,-1804.42 26201.5,-1721.42 26382.5,-1721.42 26382.5,-1804.42"/>
<text text-anchor="middle" x="26292" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26292" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="26292" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="26292" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="26292" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer12_qkv_1 -->
<g id="node183" class="node">
<title>layer12_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="26165.5,-1804.42 25984.5,-1804.42 25984.5,-1721.42 26165.5,-1721.42 26165.5,-1804.42"/>
<text text-anchor="middle" x="26075" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26075" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="26075" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="26075" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="26075" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_12_0 -->
<g id="node184" class="node">
<title>qkv_ar_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="25883" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="25883" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="25883" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="25883" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="25883" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer12_attn_0 -->
<g id="node185" class="node">
<title>layer12_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="25782,-1804.42 25610,-1804.42 25610,-1721.42 25782,-1721.42 25782,-1804.42"/>
<text text-anchor="middle" x="25696" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="25696" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="25696" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="25696" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="25696" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_attn_1 -->
<g id="node186" class="node">
<title>layer12_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="25574,-1804.42 25402,-1804.42 25402,-1721.42 25574,-1721.42 25574,-1804.42"/>
<text text-anchor="middle" x="25488" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="25488" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="25488" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="25488" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="25488" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_attn_out_0 -->
<g id="node187" class="node">
<title>layer12_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="25366,-1804.42 25194,-1804.42 25194,-1721.42 25366,-1721.42 25366,-1804.42"/>
<text text-anchor="middle" x="25280" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="25280" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="25280" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="25280" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="25280" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_attn_out_1 -->
<g id="node188" class="node">
<title>layer12_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="25158,-1804.42 24986,-1804.42 24986,-1721.42 25158,-1721.42 25158,-1804.42"/>
<text text-anchor="middle" x="25072" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="25072" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="25072" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="25072" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="25072" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_12_0 -->
<g id="node189" class="node">
<title>attn_out_ar_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="24885" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="24885" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="24885" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="24885" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="24885" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer12_ffn_gate_0 -->
<g id="node190" class="node">
<title>layer12_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="24783.5,-1804.42 24602.5,-1804.42 24602.5,-1721.42 24783.5,-1721.42 24783.5,-1804.42"/>
<text text-anchor="middle" x="24693" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="24693" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="24693" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="24693" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="24693" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer12_ffn_gate_1 -->
<g id="node191" class="node">
<title>layer12_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="24566.5,-1804.42 24385.5,-1804.42 24385.5,-1721.42 24566.5,-1721.42 24566.5,-1804.42"/>
<text text-anchor="middle" x="24476" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="24476" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="24476" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="24476" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="24476" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer12_ffn_up_0 -->
<g id="node192" class="node">
<title>layer12_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="24349.5,-1804.42 24168.5,-1804.42 24168.5,-1721.42 24349.5,-1721.42 24349.5,-1804.42"/>
<text text-anchor="middle" x="24259" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="24259" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="24259" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="24259" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="24259" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer12_ffn_up_1 -->
<g id="node193" class="node">
<title>layer12_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="24132.5,-1804.42 23951.5,-1804.42 23951.5,-1721.42 24132.5,-1721.42 24132.5,-1804.42"/>
<text text-anchor="middle" x="24042" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="24042" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="24042" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="24042" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="24042" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_12_0 -->
<g id="node194" class="node">
<title>ffn_ar_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="23850" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="23850" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="23850" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="23850" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="23850" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer12_ffn_down_0 -->
<g id="node195" class="node">
<title>layer12_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="23749,-1804.42 23577,-1804.42 23577,-1721.42 23749,-1721.42 23749,-1804.42"/>
<text text-anchor="middle" x="23663" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="23663" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="23663" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="23663" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="23663" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer12_ffn_down_1 -->
<g id="node196" class="node">
<title>layer12_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="23541,-1804.42 23369,-1804.42 23369,-1721.42 23541,-1721.42 23541,-1804.42"/>
<text text-anchor="middle" x="23455" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="23455" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="23455" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="23455" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="23455" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_12_0 -->
<g id="node197" class="node">
<title>ffn_out_ar_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="23260" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="23260" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="23260" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="23260" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="23260" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer13_qkv_0 -->
<g id="node198" class="node">
<title>layer13_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="23151.5,-1804.42 22970.5,-1804.42 22970.5,-1721.42 23151.5,-1721.42 23151.5,-1804.42"/>
<text text-anchor="middle" x="23061" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="23061" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="23061" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="23061" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="23061" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer13_qkv_1 -->
<g id="node199" class="node">
<title>layer13_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="22934.5,-1804.42 22753.5,-1804.42 22753.5,-1721.42 22934.5,-1721.42 22934.5,-1804.42"/>
<text text-anchor="middle" x="22844" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="22844" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="22844" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="22844" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="22844" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_13_0 -->
<g id="node200" class="node">
<title>qkv_ar_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="22652" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="22652" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="22652" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="22652" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="22652" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer13_attn_0 -->
<g id="node201" class="node">
<title>layer13_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="22551,-1804.42 22379,-1804.42 22379,-1721.42 22551,-1721.42 22551,-1804.42"/>
<text text-anchor="middle" x="22465" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="22465" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="22465" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="22465" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="22465" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_attn_1 -->
<g id="node202" class="node">
<title>layer13_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="22343,-1804.42 22171,-1804.42 22171,-1721.42 22343,-1721.42 22343,-1804.42"/>
<text text-anchor="middle" x="22257" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="22257" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="22257" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="22257" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="22257" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_attn_out_0 -->
<g id="node203" class="node">
<title>layer13_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="22135,-1804.42 21963,-1804.42 21963,-1721.42 22135,-1721.42 22135,-1804.42"/>
<text text-anchor="middle" x="22049" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="22049" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="22049" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="22049" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="22049" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_attn_out_1 -->
<g id="node204" class="node">
<title>layer13_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="21927,-1804.42 21755,-1804.42 21755,-1721.42 21927,-1721.42 21927,-1804.42"/>
<text text-anchor="middle" x="21841" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21841" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="21841" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="21841" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="21841" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_13_0 -->
<g id="node205" class="node">
<title>attn_out_ar_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="21654" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="21654" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="21654" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="21654" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="21654" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer13_ffn_gate_0 -->
<g id="node206" class="node">
<title>layer13_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="21552.5,-1804.42 21371.5,-1804.42 21371.5,-1721.42 21552.5,-1721.42 21552.5,-1804.42"/>
<text text-anchor="middle" x="21462" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="21462" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="21462" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="21462" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="21462" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer13_ffn_gate_1 -->
<g id="node207" class="node">
<title>layer13_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="21335.5,-1804.42 21154.5,-1804.42 21154.5,-1721.42 21335.5,-1721.42 21335.5,-1804.42"/>
<text text-anchor="middle" x="21245" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="21245" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="21245" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="21245" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="21245" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer13_ffn_up_0 -->
<g id="node208" class="node">
<title>layer13_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="21118.5,-1804.42 20937.5,-1804.42 20937.5,-1721.42 21118.5,-1721.42 21118.5,-1804.42"/>
<text text-anchor="middle" x="21028" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="21028" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="21028" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="21028" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="21028" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer13_ffn_up_1 -->
<g id="node209" class="node">
<title>layer13_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="20901.5,-1804.42 20720.5,-1804.42 20720.5,-1721.42 20901.5,-1721.42 20901.5,-1804.42"/>
<text text-anchor="middle" x="20811" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="20811" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="20811" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="20811" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="20811" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_13_0 -->
<g id="node210" class="node">
<title>ffn_ar_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="20619" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="20619" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20619" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="20619" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="20619" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer13_ffn_down_0 -->
<g id="node211" class="node">
<title>layer13_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="20518,-1804.42 20346,-1804.42 20346,-1721.42 20518,-1721.42 20518,-1804.42"/>
<text text-anchor="middle" x="20432" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="20432" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="20432" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="20432" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="20432" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer13_ffn_down_1 -->
<g id="node212" class="node">
<title>layer13_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="20310,-1804.42 20138,-1804.42 20138,-1721.42 20310,-1721.42 20310,-1804.42"/>
<text text-anchor="middle" x="20224" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="20224" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="20224" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="20224" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="20224" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_13_0 -->
<g id="node213" class="node">
<title>ffn_out_ar_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="20029" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="20029" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20029" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="20029" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="20029" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer14_qkv_0 -->
<g id="node214" class="node">
<title>layer14_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="19920.5,-1804.42 19739.5,-1804.42 19739.5,-1721.42 19920.5,-1721.42 19920.5,-1804.42"/>
<text text-anchor="middle" x="19830" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19830" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="19830" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="19830" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="19830" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer14_qkv_1 -->
<g id="node215" class="node">
<title>layer14_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="19703.5,-1804.42 19522.5,-1804.42 19522.5,-1721.42 19703.5,-1721.42 19703.5,-1804.42"/>
<text text-anchor="middle" x="19613" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19613" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="19613" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="19613" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="19613" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_14_0 -->
<g id="node216" class="node">
<title>qkv_ar_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="19421" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="19421" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="19421" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="19421" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="19421" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer14_attn_0 -->
<g id="node217" class="node">
<title>layer14_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="19320,-1804.42 19148,-1804.42 19148,-1721.42 19320,-1721.42 19320,-1804.42"/>
<text text-anchor="middle" x="19234" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="19234" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="19234" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="19234" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="19234" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_attn_1 -->
<g id="node218" class="node">
<title>layer14_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="19112,-1804.42 18940,-1804.42 18940,-1721.42 19112,-1721.42 19112,-1804.42"/>
<text text-anchor="middle" x="19026" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="19026" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="19026" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="19026" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="19026" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_attn_out_0 -->
<g id="node219" class="node">
<title>layer14_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="18904,-1804.42 18732,-1804.42 18732,-1721.42 18904,-1721.42 18904,-1804.42"/>
<text text-anchor="middle" x="18818" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18818" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="18818" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="18818" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="18818" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_attn_out_1 -->
<g id="node220" class="node">
<title>layer14_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="18696,-1804.42 18524,-1804.42 18524,-1721.42 18696,-1721.42 18696,-1804.42"/>
<text text-anchor="middle" x="18610" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18610" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="18610" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="18610" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="18610" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_14_0 -->
<g id="node221" class="node">
<title>attn_out_ar_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="18423" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="18423" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="18423" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="18423" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="18423" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer14_ffn_gate_0 -->
<g id="node222" class="node">
<title>layer14_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="18321.5,-1804.42 18140.5,-1804.42 18140.5,-1721.42 18321.5,-1721.42 18321.5,-1804.42"/>
<text text-anchor="middle" x="18231" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18231" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="18231" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="18231" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="18231" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer14_ffn_gate_1 -->
<g id="node223" class="node">
<title>layer14_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="18104.5,-1804.42 17923.5,-1804.42 17923.5,-1721.42 18104.5,-1721.42 18104.5,-1804.42"/>
<text text-anchor="middle" x="18014" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="18014" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="18014" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="18014" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="18014" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer14_ffn_up_0 -->
<g id="node224" class="node">
<title>layer14_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="17887.5,-1804.42 17706.5,-1804.42 17706.5,-1721.42 17887.5,-1721.42 17887.5,-1804.42"/>
<text text-anchor="middle" x="17797" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17797" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="17797" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="17797" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="17797" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer14_ffn_up_1 -->
<g id="node225" class="node">
<title>layer14_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="17670.5,-1804.42 17489.5,-1804.42 17489.5,-1721.42 17670.5,-1721.42 17670.5,-1804.42"/>
<text text-anchor="middle" x="17580" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="17580" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="17580" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="17580" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="17580" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_14_0 -->
<g id="node226" class="node">
<title>ffn_ar_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="17388" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="17388" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="17388" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="17388" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="17388" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer14_ffn_down_0 -->
<g id="node227" class="node">
<title>layer14_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="17287,-1804.42 17115,-1804.42 17115,-1721.42 17287,-1721.42 17287,-1804.42"/>
<text text-anchor="middle" x="17201" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="17201" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="17201" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="17201" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="17201" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer14_ffn_down_1 -->
<g id="node228" class="node">
<title>layer14_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="17079,-1804.42 16907,-1804.42 16907,-1721.42 17079,-1721.42 17079,-1804.42"/>
<text text-anchor="middle" x="16993" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="16993" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="16993" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="16993" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="16993" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_14_0 -->
<g id="node229" class="node">
<title>ffn_out_ar_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="16798" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="16798" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="16798" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="16798" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="16798" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer15_qkv_0 -->
<g id="node230" class="node">
<title>layer15_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="16689.5,-1804.42 16508.5,-1804.42 16508.5,-1721.42 16689.5,-1721.42 16689.5,-1804.42"/>
<text text-anchor="middle" x="16599" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="16599" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="16599" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="16599" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="16599" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer15_qkv_1 -->
<g id="node231" class="node">
<title>layer15_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="16472.5,-1804.42 16291.5,-1804.42 16291.5,-1721.42 16472.5,-1721.42 16472.5,-1804.42"/>
<text text-anchor="middle" x="16382" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="16382" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="16382" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="16382" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="16382" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_15_0 -->
<g id="node232" class="node">
<title>qkv_ar_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="16190" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="16190" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="16190" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="16190" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="16190" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer15_attn_0 -->
<g id="node233" class="node">
<title>layer15_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="16089,-1804.42 15917,-1804.42 15917,-1721.42 16089,-1721.42 16089,-1804.42"/>
<text text-anchor="middle" x="16003" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="16003" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="16003" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="16003" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="16003" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_attn_1 -->
<g id="node234" class="node">
<title>layer15_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="15881,-1804.42 15709,-1804.42 15709,-1721.42 15881,-1721.42 15881,-1804.42"/>
<text text-anchor="middle" x="15795" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="15795" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="15795" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="15795" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="15795" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_attn_out_0 -->
<g id="node235" class="node">
<title>layer15_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="15673,-1804.42 15501,-1804.42 15501,-1721.42 15673,-1721.42 15673,-1804.42"/>
<text text-anchor="middle" x="15587" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15587" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="15587" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="15587" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="15587" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_attn_out_1 -->
<g id="node236" class="node">
<title>layer15_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="15465,-1804.42 15293,-1804.42 15293,-1721.42 15465,-1721.42 15465,-1804.42"/>
<text text-anchor="middle" x="15379" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15379" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="15379" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="15379" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="15379" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_15_0 -->
<g id="node237" class="node">
<title>attn_out_ar_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="15192" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="15192" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="15192" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15192" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="15192" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer15_ffn_gate_0 -->
<g id="node238" class="node">
<title>layer15_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="15090.5,-1804.42 14909.5,-1804.42 14909.5,-1721.42 15090.5,-1721.42 15090.5,-1804.42"/>
<text text-anchor="middle" x="15000" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="15000" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="15000" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="15000" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="15000" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer15_ffn_gate_1 -->
<g id="node239" class="node">
<title>layer15_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="14873.5,-1804.42 14692.5,-1804.42 14692.5,-1721.42 14873.5,-1721.42 14873.5,-1804.42"/>
<text text-anchor="middle" x="14783" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="14783" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="14783" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="14783" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="14783" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer15_ffn_up_0 -->
<g id="node240" class="node">
<title>layer15_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="14656.5,-1804.42 14475.5,-1804.42 14475.5,-1721.42 14656.5,-1721.42 14656.5,-1804.42"/>
<text text-anchor="middle" x="14566" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14566" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="14566" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="14566" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="14566" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer15_ffn_up_1 -->
<g id="node241" class="node">
<title>layer15_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="14439.5,-1804.42 14258.5,-1804.42 14258.5,-1721.42 14439.5,-1721.42 14439.5,-1804.42"/>
<text text-anchor="middle" x="14349" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="14349" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="14349" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="14349" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="14349" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_15_0 -->
<g id="node242" class="node">
<title>ffn_ar_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="14157" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="14157" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14157" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="14157" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="14157" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer15_ffn_down_0 -->
<g id="node243" class="node">
<title>layer15_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="14056,-1804.42 13884,-1804.42 13884,-1721.42 14056,-1721.42 14056,-1804.42"/>
<text text-anchor="middle" x="13970" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13970" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="13970" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="13970" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="13970" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer15_ffn_down_1 -->
<g id="node244" class="node">
<title>layer15_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="13848,-1804.42 13676,-1804.42 13676,-1721.42 13848,-1721.42 13848,-1804.42"/>
<text text-anchor="middle" x="13762" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="13762" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="13762" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="13762" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="13762" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_15_0 -->
<g id="node245" class="node">
<title>ffn_out_ar_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="13567" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="13567" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="13567" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="13567" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="13567" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer16_qkv_0 -->
<g id="node246" class="node">
<title>layer16_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="13458.5,-1804.42 13277.5,-1804.42 13277.5,-1721.42 13458.5,-1721.42 13458.5,-1804.42"/>
<text text-anchor="middle" x="13368" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13368" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="13368" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="13368" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="13368" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer16_qkv_1 -->
<g id="node247" class="node">
<title>layer16_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="13241.5,-1804.42 13060.5,-1804.42 13060.5,-1721.42 13241.5,-1721.42 13241.5,-1804.42"/>
<text text-anchor="middle" x="13151" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13151" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="13151" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="13151" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="13151" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_16_0 -->
<g id="node248" class="node">
<title>qkv_ar_16_0</title>
<ellipse fill="lightblue" stroke="black" cx="12959" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="12959" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="12959" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="12959" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="12959" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer16_attn_0 -->
<g id="node249" class="node">
<title>layer16_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="12858,-1804.42 12686,-1804.42 12686,-1721.42 12858,-1721.42 12858,-1804.42"/>
<text text-anchor="middle" x="12772" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="12772" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="12772" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="12772" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="12772" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_attn_1 -->
<g id="node250" class="node">
<title>layer16_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="12650,-1804.42 12478,-1804.42 12478,-1721.42 12650,-1721.42 12650,-1804.42"/>
<text text-anchor="middle" x="12564" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="12564" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="12564" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="12564" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="12564" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_attn_out_0 -->
<g id="node251" class="node">
<title>layer16_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="12442,-1804.42 12270,-1804.42 12270,-1721.42 12442,-1721.42 12442,-1804.42"/>
<text text-anchor="middle" x="12356" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12356" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="12356" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="12356" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="12356" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_attn_out_1 -->
<g id="node252" class="node">
<title>layer16_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="12234,-1804.42 12062,-1804.42 12062,-1721.42 12234,-1721.42 12234,-1804.42"/>
<text text-anchor="middle" x="12148" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12148" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="12148" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="12148" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="12148" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_16_0 -->
<g id="node253" class="node">
<title>attn_out_ar_16_0</title>
<ellipse fill="lightblue" stroke="black" cx="11961" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="11961" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="11961" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11961" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="11961" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer16_ffn_gate_0 -->
<g id="node254" class="node">
<title>layer16_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="11859.5,-1804.42 11678.5,-1804.42 11678.5,-1721.42 11859.5,-1721.42 11859.5,-1804.42"/>
<text text-anchor="middle" x="11769" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11769" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="11769" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="11769" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="11769" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer16_ffn_gate_1 -->
<g id="node255" class="node">
<title>layer16_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="11642.5,-1804.42 11461.5,-1804.42 11461.5,-1721.42 11642.5,-1721.42 11642.5,-1804.42"/>
<text text-anchor="middle" x="11552" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="11552" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="11552" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="11552" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="11552" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer16_ffn_up_0 -->
<g id="node256" class="node">
<title>layer16_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="11425.5,-1804.42 11244.5,-1804.42 11244.5,-1721.42 11425.5,-1721.42 11425.5,-1804.42"/>
<text text-anchor="middle" x="11335" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11335" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="11335" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="11335" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="11335" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer16_ffn_up_1 -->
<g id="node257" class="node">
<title>layer16_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="11208.5,-1804.42 11027.5,-1804.42 11027.5,-1721.42 11208.5,-1721.42 11208.5,-1804.42"/>
<text text-anchor="middle" x="11118" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="11118" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="11118" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="11118" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="11118" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_16_0 -->
<g id="node258" class="node">
<title>ffn_ar_16_0</title>
<ellipse fill="lightblue" stroke="black" cx="10926" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="10926" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="10926" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="10926" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="10926" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer16_ffn_down_0 -->
<g id="node259" class="node">
<title>layer16_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="10825,-1804.42 10653,-1804.42 10653,-1721.42 10825,-1721.42 10825,-1804.42"/>
<text text-anchor="middle" x="10739" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10739" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="10739" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="10739" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="10739" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer16_ffn_down_1 -->
<g id="node260" class="node">
<title>layer16_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="10617,-1804.42 10445,-1804.42 10445,-1721.42 10617,-1721.42 10617,-1804.42"/>
<text text-anchor="middle" x="10531" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="10531" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="10531" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="10531" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="10531" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_16_0 -->
<g id="node261" class="node">
<title>ffn_out_ar_16_0</title>
<ellipse fill="lightblue" stroke="black" cx="10336" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="10336" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="10336" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="10336" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 16</text>
<text text-anchor="middle" x="10336" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer17_qkv_0 -->
<g id="node262" class="node">
<title>layer17_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="10227.5,-1804.42 10046.5,-1804.42 10046.5,-1721.42 10227.5,-1721.42 10227.5,-1804.42"/>
<text text-anchor="middle" x="10137" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="10137" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="10137" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="10137" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="10137" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer17_qkv_1 -->
<g id="node263" class="node">
<title>layer17_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="10010.5,-1804.42 9829.5,-1804.42 9829.5,-1721.42 10010.5,-1721.42 10010.5,-1804.42"/>
<text text-anchor="middle" x="9920" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="9920" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="9920" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="9920" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="9920" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_17_0 -->
<g id="node264" class="node">
<title>qkv_ar_17_0</title>
<ellipse fill="lightblue" stroke="black" cx="9728" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="9728" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9728" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="9728" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="9728" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer17_attn_0 -->
<g id="node265" class="node">
<title>layer17_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="9627,-1804.42 9455,-1804.42 9455,-1721.42 9627,-1721.42 9627,-1804.42"/>
<text text-anchor="middle" x="9541" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="9541" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="9541" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="9541" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="9541" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_attn_1 -->
<g id="node266" class="node">
<title>layer17_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="9419,-1804.42 9247,-1804.42 9247,-1721.42 9419,-1721.42 9419,-1804.42"/>
<text text-anchor="middle" x="9333" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="9333" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="9333" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="9333" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="9333" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_attn_out_0 -->
<g id="node267" class="node">
<title>layer17_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="9211,-1804.42 9039,-1804.42 9039,-1721.42 9211,-1721.42 9211,-1804.42"/>
<text text-anchor="middle" x="9125" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9125" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="9125" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="9125" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="9125" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_attn_out_1 -->
<g id="node268" class="node">
<title>layer17_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="9003,-1804.42 8831,-1804.42 8831,-1721.42 9003,-1721.42 9003,-1804.42"/>
<text text-anchor="middle" x="8917" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8917" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="8917" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="8917" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="8917" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_17_0 -->
<g id="node269" class="node">
<title>attn_out_ar_17_0</title>
<ellipse fill="lightblue" stroke="black" cx="8730" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="8730" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="8730" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8730" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="8730" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer17_ffn_gate_0 -->
<g id="node270" class="node">
<title>layer17_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="8628.5,-1804.42 8447.5,-1804.42 8447.5,-1721.42 8628.5,-1721.42 8628.5,-1804.42"/>
<text text-anchor="middle" x="8538" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8538" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="8538" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="8538" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="8538" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer17_ffn_gate_1 -->
<g id="node271" class="node">
<title>layer17_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="8411.5,-1804.42 8230.5,-1804.42 8230.5,-1721.42 8411.5,-1721.42 8411.5,-1804.42"/>
<text text-anchor="middle" x="8321" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="8321" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="8321" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="8321" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="8321" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer17_ffn_up_0 -->
<g id="node272" class="node">
<title>layer17_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="8194.5,-1804.42 8013.5,-1804.42 8013.5,-1721.42 8194.5,-1721.42 8194.5,-1804.42"/>
<text text-anchor="middle" x="8104" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8104" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="8104" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="8104" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="8104" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer17_ffn_up_1 -->
<g id="node273" class="node">
<title>layer17_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="7977.5,-1804.42 7796.5,-1804.42 7796.5,-1721.42 7977.5,-1721.42 7977.5,-1804.42"/>
<text text-anchor="middle" x="7887" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7887" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="7887" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="7887" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="7887" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_17_0 -->
<g id="node274" class="node">
<title>ffn_ar_17_0</title>
<ellipse fill="lightblue" stroke="black" cx="7695" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="7695" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7695" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="7695" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="7695" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer17_ffn_down_0 -->
<g id="node275" class="node">
<title>layer17_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="7594,-1804.42 7422,-1804.42 7422,-1721.42 7594,-1721.42 7594,-1804.42"/>
<text text-anchor="middle" x="7508" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7508" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="7508" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="7508" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="7508" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer17_ffn_down_1 -->
<g id="node276" class="node">
<title>layer17_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="7386,-1804.42 7214,-1804.42 7214,-1721.42 7386,-1721.42 7386,-1804.42"/>
<text text-anchor="middle" x="7300" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7300" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="7300" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="7300" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="7300" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_17_0 -->
<g id="node277" class="node">
<title>ffn_out_ar_17_0</title>
<ellipse fill="lightblue" stroke="black" cx="7105" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="7105" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7105" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="7105" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 17</text>
<text text-anchor="middle" x="7105" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer18_qkv_0 -->
<g id="node278" class="node">
<title>layer18_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="6996.5,-1804.42 6815.5,-1804.42 6815.5,-1721.42 6996.5,-1721.42 6996.5,-1804.42"/>
<text text-anchor="middle" x="6906" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6906" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="6906" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="6906" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="6906" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer18_qkv_1 -->
<g id="node279" class="node">
<title>layer18_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="6779.5,-1804.42 6598.5,-1804.42 6598.5,-1721.42 6779.5,-1721.42 6779.5,-1804.42"/>
<text text-anchor="middle" x="6689" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6689" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="6689" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="6689" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="6689" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_18_0 -->
<g id="node280" class="node">
<title>qkv_ar_18_0</title>
<ellipse fill="lightblue" stroke="black" cx="6497" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="6497" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6497" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="6497" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="6497" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer18_attn_0 -->
<g id="node281" class="node">
<title>layer18_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="6396,-1804.42 6224,-1804.42 6224,-1721.42 6396,-1721.42 6396,-1804.42"/>
<text text-anchor="middle" x="6310" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="6310" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="6310" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="6310" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="6310" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_attn_1 -->
<g id="node282" class="node">
<title>layer18_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="6188,-1804.42 6016,-1804.42 6016,-1721.42 6188,-1721.42 6188,-1804.42"/>
<text text-anchor="middle" x="6102" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="6102" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="6102" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="6102" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="6102" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_attn_out_0 -->
<g id="node283" class="node">
<title>layer18_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="5980,-1804.42 5808,-1804.42 5808,-1721.42 5980,-1721.42 5980,-1804.42"/>
<text text-anchor="middle" x="5894" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5894" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="5894" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="5894" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="5894" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_attn_out_1 -->
<g id="node284" class="node">
<title>layer18_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="5772,-1804.42 5600,-1804.42 5600,-1721.42 5772,-1721.42 5772,-1804.42"/>
<text text-anchor="middle" x="5686" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5686" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="5686" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="5686" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="5686" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_18_0 -->
<g id="node285" class="node">
<title>attn_out_ar_18_0</title>
<ellipse fill="lightblue" stroke="black" cx="5499" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="5499" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5499" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5499" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="5499" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer18_ffn_gate_0 -->
<g id="node286" class="node">
<title>layer18_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="5397.5,-1804.42 5216.5,-1804.42 5216.5,-1721.42 5397.5,-1721.42 5397.5,-1804.42"/>
<text text-anchor="middle" x="5307" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5307" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="5307" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="5307" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="5307" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer18_ffn_gate_1 -->
<g id="node287" class="node">
<title>layer18_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="5180.5,-1804.42 4999.5,-1804.42 4999.5,-1721.42 5180.5,-1721.42 5180.5,-1804.42"/>
<text text-anchor="middle" x="5090" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="5090" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="5090" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="5090" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="5090" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer18_ffn_up_0 -->
<g id="node288" class="node">
<title>layer18_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="4963.5,-1804.42 4782.5,-1804.42 4782.5,-1721.42 4963.5,-1721.42 4963.5,-1804.42"/>
<text text-anchor="middle" x="4873" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4873" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="4873" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="4873" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="4873" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer18_ffn_up_1 -->
<g id="node289" class="node">
<title>layer18_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="4746.5,-1804.42 4565.5,-1804.42 4565.5,-1721.42 4746.5,-1721.42 4746.5,-1804.42"/>
<text text-anchor="middle" x="4656" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4656" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="4656" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="4656" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="4656" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_18_0 -->
<g id="node290" class="node">
<title>ffn_ar_18_0</title>
<ellipse fill="lightblue" stroke="black" cx="4464" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="4464" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4464" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="4464" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="4464" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer18_ffn_down_0 -->
<g id="node291" class="node">
<title>layer18_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="4363,-1804.42 4191,-1804.42 4191,-1721.42 4363,-1721.42 4363,-1804.42"/>
<text text-anchor="middle" x="4277" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4277" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="4277" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="4277" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="4277" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer18_ffn_down_1 -->
<g id="node292" class="node">
<title>layer18_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="4155,-1804.42 3983,-1804.42 3983,-1721.42 4155,-1721.42 4155,-1804.42"/>
<text text-anchor="middle" x="4069" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4069" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="4069" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="4069" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="4069" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_18_0 -->
<g id="node293" class="node">
<title>ffn_out_ar_18_0</title>
<ellipse fill="lightblue" stroke="black" cx="3874" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="3874" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3874" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="3874" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 18</text>
<text text-anchor="middle" x="3874" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer19_qkv_0 -->
<g id="node294" class="node">
<title>layer19_qkv_0</title>
<polygon fill="#ffe6e6" stroke="black" points="3765.5,-1804.42 3584.5,-1804.42 3584.5,-1721.42 3765.5,-1721.42 3765.5,-1804.42"/>
<text text-anchor="middle" x="3675" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3675" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="3675" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="3675" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="3675" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer19_qkv_1 -->
<g id="node295" class="node">
<title>layer19_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="3548.5,-1804.42 3367.5,-1804.42 3367.5,-1721.42 3548.5,-1721.42 3548.5,-1804.42"/>
<text text-anchor="middle" x="3458" y="-1789.22" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="3458" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="3458" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="3458" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="3458" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_19_0 -->
<g id="node296" class="node">
<title>qkv_ar_19_0</title>
<ellipse fill="lightblue" stroke="black" cx="3266" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="3266" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3266" y="-1766.72" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="3266" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="3266" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer19_attn_0 -->
<g id="node297" class="node">
<title>layer19_attn_0</title>
<polygon fill="#ffe6e6" stroke="black" points="3165,-1804.42 2993,-1804.42 2993,-1721.42 3165,-1721.42 3165,-1804.42"/>
<text text-anchor="middle" x="3079" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3079" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="3079" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="3079" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="3079" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_attn_1 -->
<g id="node298" class="node">
<title>layer19_attn_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2957,-1804.42 2785,-1804.42 2785,-1721.42 2957,-1721.42 2957,-1804.42"/>
<text text-anchor="middle" x="2871" y="-1789.22" font-family="Times,serif" font-size="14.00">Self&#45;Attention</text>
<text text-anchor="middle" x="2871" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="2871" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="2871" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,12288]</text>
<text text-anchor="middle" x="2871" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_attn_out_0 -->
<g id="node299" class="node">
<title>layer19_attn_out_0</title>
<polygon fill="#ffe6e6" stroke="black" points="2749,-1804.42 2577,-1804.42 2577,-1721.42 2749,-1721.42 2749,-1804.42"/>
<text text-anchor="middle" x="2663" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2663" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="2663" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="2663" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="2663" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_attn_out_1 -->
<g id="node300" class="node">
<title>layer19_attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2541,-1804.42 2369,-1804.42 2369,-1721.42 2541,-1721.42 2541,-1804.42"/>
<text text-anchor="middle" x="2455" y="-1789.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2455" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="2455" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="2455" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="2455" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- attn_out_ar_19_0 -->
<g id="node301" class="node">
<title>attn_out_ar_19_0</title>
<ellipse fill="lightblue" stroke="black" cx="2268" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="2268" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2268" y="-1766.72" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2268" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="2268" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer19_ffn_gate_0 -->
<g id="node302" class="node">
<title>layer19_ffn_gate_0</title>
<polygon fill="#ffe6e6" stroke="black" points="2166.5,-1804.42 1985.5,-1804.42 1985.5,-1721.42 2166.5,-1721.42 2166.5,-1804.42"/>
<text text-anchor="middle" x="2076" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="2076" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="2076" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="2076" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="2076" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer19_ffn_gate_1 -->
<g id="node303" class="node">
<title>layer19_ffn_gate_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1949.5,-1804.42 1768.5,-1804.42 1768.5,-1721.42 1949.5,-1721.42 1949.5,-1804.42"/>
<text text-anchor="middle" x="1859" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Gate</text>
<text text-anchor="middle" x="1859" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="1859" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1859" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1859" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer19_ffn_up_0 -->
<g id="node304" class="node">
<title>layer19_ffn_up_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1732.5,-1804.42 1551.5,-1804.42 1551.5,-1721.42 1732.5,-1721.42 1732.5,-1804.42"/>
<text text-anchor="middle" x="1642" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1642" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="1642" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1642" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1642" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- layer19_ffn_up_1 -->
<g id="node305" class="node">
<title>layer19_ffn_up_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1515.5,-1804.42 1334.5,-1804.42 1334.5,-1721.42 1515.5,-1721.42 1515.5,-1804.42"/>
<text text-anchor="middle" x="1425" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1425" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="1425" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="1425" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="1425" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,28672]</text>
</g>
<!-- ffn_ar_19_0 -->
<g id="node306" class="node">
<title>ffn_ar_19_0</title>
<ellipse fill="lightblue" stroke="black" cx="1233" cy="-1762.92" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="1233" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1233" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="1233" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="1233" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- layer19_ffn_down_0 -->
<g id="node307" class="node">
<title>layer19_ffn_down_0</title>
<polygon fill="#ffe6e6" stroke="black" points="1132,-1804.42 960,-1804.42 960,-1721.42 1132,-1721.42 1132,-1804.42"/>
<text text-anchor="middle" x="1046" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1046" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="1046" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:0</text>
<text text-anchor="middle" x="1046" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="1046" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- layer19_ffn_down_1 -->
<g id="node308" class="node">
<title>layer19_ffn_down_1</title>
<polygon fill="#ffe6e6" stroke="black" points="924,-1804.42 752,-1804.42 752,-1721.42 924,-1721.42 924,-1804.42"/>
<text text-anchor="middle" x="838" y="-1789.22" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="838" y="-1774.22" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="838" y="-1759.22" font-family="Times,serif" font-size="14.00">GPU:1</text>
<text text-anchor="middle" x="838" y="-1744.22" font-family="Times,serif" font-size="14.00">Input:[4,2048,28672]</text>
<text text-anchor="middle" x="838" y="-1729.22" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_19_0 -->
<g id="node309" class="node">
<title>ffn_out_ar_19_0</title>
<ellipse fill="lightblue" stroke="black" cx="62032" cy="-1762.92" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="62032" y="-1781.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62032" y="-1766.72" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="62032" y="-1751.72" font-family="Times,serif" font-size="14.00">Layer 19</text>
<text text-anchor="middle" x="62032" y="-1736.72" font-family="Times,serif" font-size="14.00">GPU:[0,1]</text>
</g>
<!-- pp_send_0_1 -->
<g id="node510" class="node">
<title>pp_send_0_1</title>
<ellipse fill="lightcoral" stroke="black" cx="87752" cy="-1605.36" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="87752" y="-1616.66" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="87752" y="-1601.66" font-family="Times,serif" font-size="14.00">Stage 01</text>
<text text-anchor="middle" x="87752" y="-1586.66" font-family="Times,serif" font-size="14.00">GPU:[1][2]</text>
</g>
<!-- ffn_out_ar_19_0&#45;&gt;pp_send_0_1 -->
<g id="edge6" class="edge">
<title>ffn_out_ar_19_0&#45;&gt;pp_send_0_1</title>
<path fill="none" stroke="black" d="M62104.93,-1761.48C63551.34,-1752.73 86045.66,-1616.68 87660.61,-1606.92"/>
<polygon fill="black" stroke="black" points="87660.72,-1610.42 87670.69,-1606.85 87660.67,-1603.42 87660.72,-1610.42"/>
</g>
<!-- layer20_qkv_0 -->
<g id="node310" class="node">
<title>layer20_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="88253.8,-1495.89 87955.05,-1495.89 87878.2,-1329.89 88176.95,-1329.89 88253.8,-1495.89"/>
<text text-anchor="middle" x="88066" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="88066" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 20</text>
<text text-anchor="middle" x="88066" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="88066" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="88066" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer20_qkv_1 -->
<g id="node311" class="node">
<title>layer20_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="87842.5,-1454.39 87661.5,-1454.39 87661.5,-1371.39 87842.5,-1371.39 87842.5,-1454.39"/>
<text text-anchor="middle" x="87752" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="87752" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 20</text>
<text text-anchor="middle" x="87752" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="87752" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="87752" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_20_1 -->
<g id="node312" class="node">
<title>qkv_ar_20_1</title>
<ellipse fill="lightblue" stroke="black" cx="87560" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="87560" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="87560" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="87560" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 20</text>
<text text-anchor="middle" x="87560" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer20_attn_out_ar_1 -->
<g id="node313" class="node">
<title>layer20_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="87394" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="87394" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="87394" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="87394" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 20</text>
<text text-anchor="middle" x="87394" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_20_1 -->
<g id="node314" class="node">
<title>ffn_ar_20_1</title>
<ellipse fill="lightblue" stroke="black" cx="87228" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="87228" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="87228" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="87228" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 20</text>
<text text-anchor="middle" x="87228" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_20_1 -->
<g id="node315" class="node">
<title>ffn_out_ar_20_1</title>
<ellipse fill="lightblue" stroke="black" cx="87054" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="87054" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="87054" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="87054" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 20</text>
<text text-anchor="middle" x="87054" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer21_qkv_0 -->
<g id="node316" class="node">
<title>layer21_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="86945.8,-1495.89 86647.05,-1495.89 86570.2,-1329.89 86868.95,-1329.89 86945.8,-1495.89"/>
<text text-anchor="middle" x="86758" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="86758" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 21</text>
<text text-anchor="middle" x="86758" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="86758" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="86758" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer21_qkv_1 -->
<g id="node317" class="node">
<title>layer21_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="86534.5,-1454.39 86353.5,-1454.39 86353.5,-1371.39 86534.5,-1371.39 86534.5,-1454.39"/>
<text text-anchor="middle" x="86444" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="86444" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 21</text>
<text text-anchor="middle" x="86444" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="86444" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="86444" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_21_1 -->
<g id="node318" class="node">
<title>qkv_ar_21_1</title>
<ellipse fill="lightblue" stroke="black" cx="86252" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="86252" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="86252" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="86252" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 21</text>
<text text-anchor="middle" x="86252" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer21_attn_out_ar_1 -->
<g id="node319" class="node">
<title>layer21_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="86086" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="86086" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="86086" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="86086" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 21</text>
<text text-anchor="middle" x="86086" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_21_1 -->
<g id="node320" class="node">
<title>ffn_ar_21_1</title>
<ellipse fill="lightblue" stroke="black" cx="85920" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="85920" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="85920" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="85920" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 21</text>
<text text-anchor="middle" x="85920" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_21_1 -->
<g id="node321" class="node">
<title>ffn_out_ar_21_1</title>
<ellipse fill="lightblue" stroke="black" cx="85746" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="85746" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="85746" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="85746" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 21</text>
<text text-anchor="middle" x="85746" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer22_qkv_0 -->
<g id="node322" class="node">
<title>layer22_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="85637.8,-1495.89 85339.05,-1495.89 85262.2,-1329.89 85560.95,-1329.89 85637.8,-1495.89"/>
<text text-anchor="middle" x="85450" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="85450" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 22</text>
<text text-anchor="middle" x="85450" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="85450" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="85450" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer22_qkv_1 -->
<g id="node323" class="node">
<title>layer22_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="85226.5,-1454.39 85045.5,-1454.39 85045.5,-1371.39 85226.5,-1371.39 85226.5,-1454.39"/>
<text text-anchor="middle" x="85136" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="85136" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 22</text>
<text text-anchor="middle" x="85136" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="85136" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="85136" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_22_1 -->
<g id="node324" class="node">
<title>qkv_ar_22_1</title>
<ellipse fill="lightblue" stroke="black" cx="84944" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="84944" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="84944" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="84944" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 22</text>
<text text-anchor="middle" x="84944" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer22_attn_out_ar_1 -->
<g id="node325" class="node">
<title>layer22_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="84778" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="84778" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="84778" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="84778" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 22</text>
<text text-anchor="middle" x="84778" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_22_1 -->
<g id="node326" class="node">
<title>ffn_ar_22_1</title>
<ellipse fill="lightblue" stroke="black" cx="84612" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="84612" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="84612" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="84612" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 22</text>
<text text-anchor="middle" x="84612" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_22_1 -->
<g id="node327" class="node">
<title>ffn_out_ar_22_1</title>
<ellipse fill="lightblue" stroke="black" cx="84438" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="84438" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="84438" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="84438" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 22</text>
<text text-anchor="middle" x="84438" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer23_qkv_0 -->
<g id="node328" class="node">
<title>layer23_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="84329.8,-1495.89 84031.05,-1495.89 83954.2,-1329.89 84252.95,-1329.89 84329.8,-1495.89"/>
<text text-anchor="middle" x="84142" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="84142" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 23</text>
<text text-anchor="middle" x="84142" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="84142" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="84142" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer23_qkv_1 -->
<g id="node329" class="node">
<title>layer23_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="83918.5,-1454.39 83737.5,-1454.39 83737.5,-1371.39 83918.5,-1371.39 83918.5,-1454.39"/>
<text text-anchor="middle" x="83828" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="83828" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 23</text>
<text text-anchor="middle" x="83828" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="83828" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="83828" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_23_1 -->
<g id="node330" class="node">
<title>qkv_ar_23_1</title>
<ellipse fill="lightblue" stroke="black" cx="83636" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="83636" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="83636" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="83636" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 23</text>
<text text-anchor="middle" x="83636" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer23_attn_out_ar_1 -->
<g id="node331" class="node">
<title>layer23_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="83470" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="83470" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="83470" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="83470" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 23</text>
<text text-anchor="middle" x="83470" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_23_1 -->
<g id="node332" class="node">
<title>ffn_ar_23_1</title>
<ellipse fill="lightblue" stroke="black" cx="83304" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="83304" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="83304" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="83304" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 23</text>
<text text-anchor="middle" x="83304" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_23_1 -->
<g id="node333" class="node">
<title>ffn_out_ar_23_1</title>
<ellipse fill="lightblue" stroke="black" cx="83130" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="83130" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="83130" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="83130" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 23</text>
<text text-anchor="middle" x="83130" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer24_qkv_0 -->
<g id="node334" class="node">
<title>layer24_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="83021.8,-1495.89 82723.05,-1495.89 82646.2,-1329.89 82944.95,-1329.89 83021.8,-1495.89"/>
<text text-anchor="middle" x="82834" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="82834" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 24</text>
<text text-anchor="middle" x="82834" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="82834" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="82834" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer24_qkv_1 -->
<g id="node335" class="node">
<title>layer24_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="82610.5,-1454.39 82429.5,-1454.39 82429.5,-1371.39 82610.5,-1371.39 82610.5,-1454.39"/>
<text text-anchor="middle" x="82520" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="82520" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 24</text>
<text text-anchor="middle" x="82520" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="82520" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="82520" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_24_1 -->
<g id="node336" class="node">
<title>qkv_ar_24_1</title>
<ellipse fill="lightblue" stroke="black" cx="82328" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="82328" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="82328" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="82328" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 24</text>
<text text-anchor="middle" x="82328" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer24_attn_out_ar_1 -->
<g id="node337" class="node">
<title>layer24_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="82162" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="82162" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="82162" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="82162" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 24</text>
<text text-anchor="middle" x="82162" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_24_1 -->
<g id="node338" class="node">
<title>ffn_ar_24_1</title>
<ellipse fill="lightblue" stroke="black" cx="81996" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="81996" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="81996" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="81996" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 24</text>
<text text-anchor="middle" x="81996" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_24_1 -->
<g id="node339" class="node">
<title>ffn_out_ar_24_1</title>
<ellipse fill="lightblue" stroke="black" cx="81822" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="81822" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="81822" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="81822" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 24</text>
<text text-anchor="middle" x="81822" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer25_qkv_0 -->
<g id="node340" class="node">
<title>layer25_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="81713.8,-1495.89 81415.05,-1495.89 81338.2,-1329.89 81636.95,-1329.89 81713.8,-1495.89"/>
<text text-anchor="middle" x="81526" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="81526" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 25</text>
<text text-anchor="middle" x="81526" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="81526" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="81526" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer25_qkv_1 -->
<g id="node341" class="node">
<title>layer25_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="81302.5,-1454.39 81121.5,-1454.39 81121.5,-1371.39 81302.5,-1371.39 81302.5,-1454.39"/>
<text text-anchor="middle" x="81212" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="81212" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 25</text>
<text text-anchor="middle" x="81212" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="81212" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="81212" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_25_1 -->
<g id="node342" class="node">
<title>qkv_ar_25_1</title>
<ellipse fill="lightblue" stroke="black" cx="81020" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="81020" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="81020" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="81020" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 25</text>
<text text-anchor="middle" x="81020" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer25_attn_out_ar_1 -->
<g id="node343" class="node">
<title>layer25_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="80854" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="80854" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="80854" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="80854" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 25</text>
<text text-anchor="middle" x="80854" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_25_1 -->
<g id="node344" class="node">
<title>ffn_ar_25_1</title>
<ellipse fill="lightblue" stroke="black" cx="80688" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="80688" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="80688" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="80688" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 25</text>
<text text-anchor="middle" x="80688" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_25_1 -->
<g id="node345" class="node">
<title>ffn_out_ar_25_1</title>
<ellipse fill="lightblue" stroke="black" cx="80514" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="80514" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="80514" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="80514" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 25</text>
<text text-anchor="middle" x="80514" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer26_qkv_0 -->
<g id="node346" class="node">
<title>layer26_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="80405.8,-1495.89 80107.05,-1495.89 80030.2,-1329.89 80328.95,-1329.89 80405.8,-1495.89"/>
<text text-anchor="middle" x="80218" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="80218" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 26</text>
<text text-anchor="middle" x="80218" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="80218" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="80218" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer26_qkv_1 -->
<g id="node347" class="node">
<title>layer26_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="79994.5,-1454.39 79813.5,-1454.39 79813.5,-1371.39 79994.5,-1371.39 79994.5,-1454.39"/>
<text text-anchor="middle" x="79904" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="79904" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 26</text>
<text text-anchor="middle" x="79904" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="79904" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="79904" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_26_1 -->
<g id="node348" class="node">
<title>qkv_ar_26_1</title>
<ellipse fill="lightblue" stroke="black" cx="79712" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="79712" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="79712" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="79712" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 26</text>
<text text-anchor="middle" x="79712" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer26_attn_out_ar_1 -->
<g id="node349" class="node">
<title>layer26_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="79546" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="79546" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="79546" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="79546" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 26</text>
<text text-anchor="middle" x="79546" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_26_1 -->
<g id="node350" class="node">
<title>ffn_ar_26_1</title>
<ellipse fill="lightblue" stroke="black" cx="79380" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="79380" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="79380" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="79380" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 26</text>
<text text-anchor="middle" x="79380" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_26_1 -->
<g id="node351" class="node">
<title>ffn_out_ar_26_1</title>
<ellipse fill="lightblue" stroke="black" cx="79206" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="79206" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="79206" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="79206" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 26</text>
<text text-anchor="middle" x="79206" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer27_qkv_0 -->
<g id="node352" class="node">
<title>layer27_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="79097.8,-1495.89 78799.05,-1495.89 78722.2,-1329.89 79020.95,-1329.89 79097.8,-1495.89"/>
<text text-anchor="middle" x="78910" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="78910" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 27</text>
<text text-anchor="middle" x="78910" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="78910" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="78910" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer27_qkv_1 -->
<g id="node353" class="node">
<title>layer27_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="78686.5,-1454.39 78505.5,-1454.39 78505.5,-1371.39 78686.5,-1371.39 78686.5,-1454.39"/>
<text text-anchor="middle" x="78596" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="78596" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 27</text>
<text text-anchor="middle" x="78596" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="78596" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="78596" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_27_1 -->
<g id="node354" class="node">
<title>qkv_ar_27_1</title>
<ellipse fill="lightblue" stroke="black" cx="78404" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="78404" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="78404" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="78404" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 27</text>
<text text-anchor="middle" x="78404" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer27_attn_out_ar_1 -->
<g id="node355" class="node">
<title>layer27_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="78238" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="78238" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="78238" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="78238" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 27</text>
<text text-anchor="middle" x="78238" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_27_1 -->
<g id="node356" class="node">
<title>ffn_ar_27_1</title>
<ellipse fill="lightblue" stroke="black" cx="78072" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="78072" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="78072" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="78072" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 27</text>
<text text-anchor="middle" x="78072" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_27_1 -->
<g id="node357" class="node">
<title>ffn_out_ar_27_1</title>
<ellipse fill="lightblue" stroke="black" cx="77898" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="77898" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="77898" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="77898" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 27</text>
<text text-anchor="middle" x="77898" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer28_qkv_0 -->
<g id="node358" class="node">
<title>layer28_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="77789.8,-1495.89 77491.05,-1495.89 77414.2,-1329.89 77712.95,-1329.89 77789.8,-1495.89"/>
<text text-anchor="middle" x="77602" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="77602" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 28</text>
<text text-anchor="middle" x="77602" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="77602" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="77602" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer28_qkv_1 -->
<g id="node359" class="node">
<title>layer28_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="77378.5,-1454.39 77197.5,-1454.39 77197.5,-1371.39 77378.5,-1371.39 77378.5,-1454.39"/>
<text text-anchor="middle" x="77288" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="77288" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 28</text>
<text text-anchor="middle" x="77288" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="77288" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="77288" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_28_1 -->
<g id="node360" class="node">
<title>qkv_ar_28_1</title>
<ellipse fill="lightblue" stroke="black" cx="77096" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="77096" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="77096" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="77096" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 28</text>
<text text-anchor="middle" x="77096" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer28_attn_out_ar_1 -->
<g id="node361" class="node">
<title>layer28_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="76930" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="76930" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="76930" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="76930" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 28</text>
<text text-anchor="middle" x="76930" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_28_1 -->
<g id="node362" class="node">
<title>ffn_ar_28_1</title>
<ellipse fill="lightblue" stroke="black" cx="76764" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="76764" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="76764" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="76764" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 28</text>
<text text-anchor="middle" x="76764" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_28_1 -->
<g id="node363" class="node">
<title>ffn_out_ar_28_1</title>
<ellipse fill="lightblue" stroke="black" cx="76590" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="76590" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="76590" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="76590" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 28</text>
<text text-anchor="middle" x="76590" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer29_qkv_0 -->
<g id="node364" class="node">
<title>layer29_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="76481.8,-1495.89 76183.05,-1495.89 76106.2,-1329.89 76404.95,-1329.89 76481.8,-1495.89"/>
<text text-anchor="middle" x="76294" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="76294" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 29</text>
<text text-anchor="middle" x="76294" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="76294" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="76294" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer29_qkv_1 -->
<g id="node365" class="node">
<title>layer29_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="76070.5,-1454.39 75889.5,-1454.39 75889.5,-1371.39 76070.5,-1371.39 76070.5,-1454.39"/>
<text text-anchor="middle" x="75980" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="75980" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 29</text>
<text text-anchor="middle" x="75980" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="75980" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="75980" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_29_1 -->
<g id="node366" class="node">
<title>qkv_ar_29_1</title>
<ellipse fill="lightblue" stroke="black" cx="75788" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="75788" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="75788" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="75788" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 29</text>
<text text-anchor="middle" x="75788" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer29_attn_out_ar_1 -->
<g id="node367" class="node">
<title>layer29_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="75622" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="75622" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="75622" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="75622" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 29</text>
<text text-anchor="middle" x="75622" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_29_1 -->
<g id="node368" class="node">
<title>ffn_ar_29_1</title>
<ellipse fill="lightblue" stroke="black" cx="75456" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="75456" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="75456" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="75456" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 29</text>
<text text-anchor="middle" x="75456" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_29_1 -->
<g id="node369" class="node">
<title>ffn_out_ar_29_1</title>
<ellipse fill="lightblue" stroke="black" cx="75282" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="75282" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="75282" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="75282" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 29</text>
<text text-anchor="middle" x="75282" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer30_qkv_0 -->
<g id="node370" class="node">
<title>layer30_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="75173.8,-1495.89 74875.05,-1495.89 74798.2,-1329.89 75096.95,-1329.89 75173.8,-1495.89"/>
<text text-anchor="middle" x="74986" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="74986" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 30</text>
<text text-anchor="middle" x="74986" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="74986" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="74986" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer30_qkv_1 -->
<g id="node371" class="node">
<title>layer30_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="74762.5,-1454.39 74581.5,-1454.39 74581.5,-1371.39 74762.5,-1371.39 74762.5,-1454.39"/>
<text text-anchor="middle" x="74672" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="74672" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 30</text>
<text text-anchor="middle" x="74672" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="74672" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="74672" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_30_1 -->
<g id="node372" class="node">
<title>qkv_ar_30_1</title>
<ellipse fill="lightblue" stroke="black" cx="74480" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="74480" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="74480" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="74480" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 30</text>
<text text-anchor="middle" x="74480" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer30_attn_out_ar_1 -->
<g id="node373" class="node">
<title>layer30_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="74314" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="74314" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="74314" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="74314" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 30</text>
<text text-anchor="middle" x="74314" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_30_1 -->
<g id="node374" class="node">
<title>ffn_ar_30_1</title>
<ellipse fill="lightblue" stroke="black" cx="74148" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="74148" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="74148" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="74148" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 30</text>
<text text-anchor="middle" x="74148" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_30_1 -->
<g id="node375" class="node">
<title>ffn_out_ar_30_1</title>
<ellipse fill="lightblue" stroke="black" cx="73974" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="73974" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="73974" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="73974" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 30</text>
<text text-anchor="middle" x="73974" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer31_qkv_0 -->
<g id="node376" class="node">
<title>layer31_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="73865.8,-1495.89 73567.05,-1495.89 73490.2,-1329.89 73788.95,-1329.89 73865.8,-1495.89"/>
<text text-anchor="middle" x="73678" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="73678" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 31</text>
<text text-anchor="middle" x="73678" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="73678" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="73678" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer31_qkv_1 -->
<g id="node377" class="node">
<title>layer31_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="73454.5,-1454.39 73273.5,-1454.39 73273.5,-1371.39 73454.5,-1371.39 73454.5,-1454.39"/>
<text text-anchor="middle" x="73364" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="73364" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 31</text>
<text text-anchor="middle" x="73364" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="73364" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="73364" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_31_1 -->
<g id="node378" class="node">
<title>qkv_ar_31_1</title>
<ellipse fill="lightblue" stroke="black" cx="73172" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="73172" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="73172" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="73172" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 31</text>
<text text-anchor="middle" x="73172" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer31_attn_out_ar_1 -->
<g id="node379" class="node">
<title>layer31_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="73006" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="73006" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="73006" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="73006" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 31</text>
<text text-anchor="middle" x="73006" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_31_1 -->
<g id="node380" class="node">
<title>ffn_ar_31_1</title>
<ellipse fill="lightblue" stroke="black" cx="72840" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="72840" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="72840" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="72840" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 31</text>
<text text-anchor="middle" x="72840" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_31_1 -->
<g id="node381" class="node">
<title>ffn_out_ar_31_1</title>
<ellipse fill="lightblue" stroke="black" cx="72666" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="72666" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="72666" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="72666" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 31</text>
<text text-anchor="middle" x="72666" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer32_qkv_0 -->
<g id="node382" class="node">
<title>layer32_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="72557.8,-1495.89 72259.05,-1495.89 72182.2,-1329.89 72480.95,-1329.89 72557.8,-1495.89"/>
<text text-anchor="middle" x="72370" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="72370" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 32</text>
<text text-anchor="middle" x="72370" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="72370" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="72370" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer32_qkv_1 -->
<g id="node383" class="node">
<title>layer32_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="72146.5,-1454.39 71965.5,-1454.39 71965.5,-1371.39 72146.5,-1371.39 72146.5,-1454.39"/>
<text text-anchor="middle" x="72056" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="72056" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 32</text>
<text text-anchor="middle" x="72056" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="72056" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="72056" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_32_1 -->
<g id="node384" class="node">
<title>qkv_ar_32_1</title>
<ellipse fill="lightblue" stroke="black" cx="71864" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="71864" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="71864" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="71864" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 32</text>
<text text-anchor="middle" x="71864" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer32_attn_out_ar_1 -->
<g id="node385" class="node">
<title>layer32_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="71698" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="71698" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="71698" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="71698" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 32</text>
<text text-anchor="middle" x="71698" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_32_1 -->
<g id="node386" class="node">
<title>ffn_ar_32_1</title>
<ellipse fill="lightblue" stroke="black" cx="71532" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="71532" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="71532" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="71532" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 32</text>
<text text-anchor="middle" x="71532" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_32_1 -->
<g id="node387" class="node">
<title>ffn_out_ar_32_1</title>
<ellipse fill="lightblue" stroke="black" cx="71358" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="71358" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="71358" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="71358" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 32</text>
<text text-anchor="middle" x="71358" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer33_qkv_0 -->
<g id="node388" class="node">
<title>layer33_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="71249.8,-1495.89 70951.05,-1495.89 70874.2,-1329.89 71172.95,-1329.89 71249.8,-1495.89"/>
<text text-anchor="middle" x="71062" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="71062" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 33</text>
<text text-anchor="middle" x="71062" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="71062" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="71062" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer33_qkv_1 -->
<g id="node389" class="node">
<title>layer33_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="70838.5,-1454.39 70657.5,-1454.39 70657.5,-1371.39 70838.5,-1371.39 70838.5,-1454.39"/>
<text text-anchor="middle" x="70748" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="70748" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 33</text>
<text text-anchor="middle" x="70748" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="70748" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="70748" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_33_1 -->
<g id="node390" class="node">
<title>qkv_ar_33_1</title>
<ellipse fill="lightblue" stroke="black" cx="70556" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="70556" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="70556" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="70556" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 33</text>
<text text-anchor="middle" x="70556" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer33_attn_out_ar_1 -->
<g id="node391" class="node">
<title>layer33_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="70390" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="70390" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="70390" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="70390" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 33</text>
<text text-anchor="middle" x="70390" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_33_1 -->
<g id="node392" class="node">
<title>ffn_ar_33_1</title>
<ellipse fill="lightblue" stroke="black" cx="70224" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="70224" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="70224" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="70224" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 33</text>
<text text-anchor="middle" x="70224" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_33_1 -->
<g id="node393" class="node">
<title>ffn_out_ar_33_1</title>
<ellipse fill="lightblue" stroke="black" cx="70050" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="70050" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="70050" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="70050" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 33</text>
<text text-anchor="middle" x="70050" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer34_qkv_0 -->
<g id="node394" class="node">
<title>layer34_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="69941.8,-1495.89 69643.05,-1495.89 69566.2,-1329.89 69864.95,-1329.89 69941.8,-1495.89"/>
<text text-anchor="middle" x="69754" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="69754" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 34</text>
<text text-anchor="middle" x="69754" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="69754" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="69754" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer34_qkv_1 -->
<g id="node395" class="node">
<title>layer34_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="69530.5,-1454.39 69349.5,-1454.39 69349.5,-1371.39 69530.5,-1371.39 69530.5,-1454.39"/>
<text text-anchor="middle" x="69440" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="69440" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 34</text>
<text text-anchor="middle" x="69440" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="69440" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="69440" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_34_1 -->
<g id="node396" class="node">
<title>qkv_ar_34_1</title>
<ellipse fill="lightblue" stroke="black" cx="69248" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="69248" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="69248" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="69248" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 34</text>
<text text-anchor="middle" x="69248" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer34_attn_out_ar_1 -->
<g id="node397" class="node">
<title>layer34_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="69082" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="69082" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="69082" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="69082" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 34</text>
<text text-anchor="middle" x="69082" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_34_1 -->
<g id="node398" class="node">
<title>ffn_ar_34_1</title>
<ellipse fill="lightblue" stroke="black" cx="68916" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="68916" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="68916" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="68916" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 34</text>
<text text-anchor="middle" x="68916" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_34_1 -->
<g id="node399" class="node">
<title>ffn_out_ar_34_1</title>
<ellipse fill="lightblue" stroke="black" cx="68742" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="68742" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="68742" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="68742" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 34</text>
<text text-anchor="middle" x="68742" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer35_qkv_0 -->
<g id="node400" class="node">
<title>layer35_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="68633.8,-1495.89 68335.05,-1495.89 68258.2,-1329.89 68556.95,-1329.89 68633.8,-1495.89"/>
<text text-anchor="middle" x="68446" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="68446" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 35</text>
<text text-anchor="middle" x="68446" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="68446" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="68446" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer35_qkv_1 -->
<g id="node401" class="node">
<title>layer35_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="68222.5,-1454.39 68041.5,-1454.39 68041.5,-1371.39 68222.5,-1371.39 68222.5,-1454.39"/>
<text text-anchor="middle" x="68132" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="68132" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 35</text>
<text text-anchor="middle" x="68132" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="68132" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="68132" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_35_1 -->
<g id="node402" class="node">
<title>qkv_ar_35_1</title>
<ellipse fill="lightblue" stroke="black" cx="67940" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="67940" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="67940" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="67940" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 35</text>
<text text-anchor="middle" x="67940" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer35_attn_out_ar_1 -->
<g id="node403" class="node">
<title>layer35_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="67774" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="67774" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="67774" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="67774" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 35</text>
<text text-anchor="middle" x="67774" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_35_1 -->
<g id="node404" class="node">
<title>ffn_ar_35_1</title>
<ellipse fill="lightblue" stroke="black" cx="67608" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="67608" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="67608" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="67608" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 35</text>
<text text-anchor="middle" x="67608" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_35_1 -->
<g id="node405" class="node">
<title>ffn_out_ar_35_1</title>
<ellipse fill="lightblue" stroke="black" cx="67434" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="67434" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="67434" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="67434" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 35</text>
<text text-anchor="middle" x="67434" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer36_qkv_0 -->
<g id="node406" class="node">
<title>layer36_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="67325.8,-1495.89 67027.05,-1495.89 66950.2,-1329.89 67248.95,-1329.89 67325.8,-1495.89"/>
<text text-anchor="middle" x="67138" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="67138" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 36</text>
<text text-anchor="middle" x="67138" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="67138" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="67138" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer36_qkv_1 -->
<g id="node407" class="node">
<title>layer36_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="66914.5,-1454.39 66733.5,-1454.39 66733.5,-1371.39 66914.5,-1371.39 66914.5,-1454.39"/>
<text text-anchor="middle" x="66824" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="66824" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 36</text>
<text text-anchor="middle" x="66824" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="66824" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="66824" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_36_1 -->
<g id="node408" class="node">
<title>qkv_ar_36_1</title>
<ellipse fill="lightblue" stroke="black" cx="66632" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="66632" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="66632" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="66632" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 36</text>
<text text-anchor="middle" x="66632" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer36_attn_out_ar_1 -->
<g id="node409" class="node">
<title>layer36_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="66466" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="66466" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="66466" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="66466" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 36</text>
<text text-anchor="middle" x="66466" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_36_1 -->
<g id="node410" class="node">
<title>ffn_ar_36_1</title>
<ellipse fill="lightblue" stroke="black" cx="66300" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="66300" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="66300" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="66300" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 36</text>
<text text-anchor="middle" x="66300" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_36_1 -->
<g id="node411" class="node">
<title>ffn_out_ar_36_1</title>
<ellipse fill="lightblue" stroke="black" cx="66126" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="66126" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="66126" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="66126" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 36</text>
<text text-anchor="middle" x="66126" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer37_qkv_0 -->
<g id="node412" class="node">
<title>layer37_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="66017.8,-1495.89 65719.05,-1495.89 65642.2,-1329.89 65940.95,-1329.89 66017.8,-1495.89"/>
<text text-anchor="middle" x="65830" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="65830" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 37</text>
<text text-anchor="middle" x="65830" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="65830" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="65830" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer37_qkv_1 -->
<g id="node413" class="node">
<title>layer37_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="65606.5,-1454.39 65425.5,-1454.39 65425.5,-1371.39 65606.5,-1371.39 65606.5,-1454.39"/>
<text text-anchor="middle" x="65516" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="65516" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 37</text>
<text text-anchor="middle" x="65516" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="65516" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="65516" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_37_1 -->
<g id="node414" class="node">
<title>qkv_ar_37_1</title>
<ellipse fill="lightblue" stroke="black" cx="65324" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="65324" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="65324" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="65324" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 37</text>
<text text-anchor="middle" x="65324" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer37_attn_out_ar_1 -->
<g id="node415" class="node">
<title>layer37_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="65158" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="65158" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="65158" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="65158" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 37</text>
<text text-anchor="middle" x="65158" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_37_1 -->
<g id="node416" class="node">
<title>ffn_ar_37_1</title>
<ellipse fill="lightblue" stroke="black" cx="64992" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="64992" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="64992" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="64992" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 37</text>
<text text-anchor="middle" x="64992" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_37_1 -->
<g id="node417" class="node">
<title>ffn_out_ar_37_1</title>
<ellipse fill="lightblue" stroke="black" cx="64818" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="64818" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="64818" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="64818" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 37</text>
<text text-anchor="middle" x="64818" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer38_qkv_0 -->
<g id="node418" class="node">
<title>layer38_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="64709.8,-1495.89 64411.05,-1495.89 64334.2,-1329.89 64632.95,-1329.89 64709.8,-1495.89"/>
<text text-anchor="middle" x="64522" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="64522" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 38</text>
<text text-anchor="middle" x="64522" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="64522" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="64522" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer38_qkv_1 -->
<g id="node419" class="node">
<title>layer38_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="64298.5,-1454.39 64117.5,-1454.39 64117.5,-1371.39 64298.5,-1371.39 64298.5,-1454.39"/>
<text text-anchor="middle" x="64208" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="64208" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 38</text>
<text text-anchor="middle" x="64208" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="64208" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="64208" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_38_1 -->
<g id="node420" class="node">
<title>qkv_ar_38_1</title>
<ellipse fill="lightblue" stroke="black" cx="64016" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="64016" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="64016" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="64016" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 38</text>
<text text-anchor="middle" x="64016" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer38_attn_out_ar_1 -->
<g id="node421" class="node">
<title>layer38_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="63850" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="63850" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="63850" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="63850" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 38</text>
<text text-anchor="middle" x="63850" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_38_1 -->
<g id="node422" class="node">
<title>ffn_ar_38_1</title>
<ellipse fill="lightblue" stroke="black" cx="63684" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="63684" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="63684" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="63684" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 38</text>
<text text-anchor="middle" x="63684" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_38_1 -->
<g id="node423" class="node">
<title>ffn_out_ar_38_1</title>
<ellipse fill="lightblue" stroke="black" cx="63510" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="63510" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="63510" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="63510" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 38</text>
<text text-anchor="middle" x="63510" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer39_qkv_0 -->
<g id="node424" class="node">
<title>layer39_qkv_0</title>
<polygon fill="#e6f3ff" stroke="black" points="63401.8,-1495.89 63103.05,-1495.89 63026.2,-1329.89 63324.95,-1329.89 63401.8,-1495.89"/>
<text text-anchor="middle" x="63214" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="63214" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 39</text>
<text text-anchor="middle" x="63214" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:2</text>
<text text-anchor="middle" x="63214" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="63214" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- layer39_qkv_1 -->
<g id="node425" class="node">
<title>layer39_qkv_1</title>
<polygon fill="#e6f3ff" stroke="black" points="62990.5,-1454.39 62809.5,-1454.39 62809.5,-1371.39 62990.5,-1371.39 62990.5,-1454.39"/>
<text text-anchor="middle" x="62900" y="-1439.19" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="62900" y="-1424.19" font-family="Times,serif" font-size="14.00">Layer 39</text>
<text text-anchor="middle" x="62900" y="-1409.19" font-family="Times,serif" font-size="14.00">GPU:3</text>
<text text-anchor="middle" x="62900" y="-1394.19" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="62900" y="-1379.19" font-family="Times,serif" font-size="14.00">Output:[4,2048,12288]</text>
</g>
<!-- qkv_ar_39_1 -->
<g id="node426" class="node">
<title>qkv_ar_39_1</title>
<ellipse fill="lightblue" stroke="black" cx="62708" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="62708" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62708" y="-1416.69" font-family="Times,serif" font-size="14.00">QKV</text>
<text text-anchor="middle" x="62708" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 39</text>
<text text-anchor="middle" x="62708" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- layer39_attn_out_ar_1 -->
<g id="node427" class="node">
<title>layer39_attn_out_ar_1</title>
<ellipse fill="lightblue" stroke="black" cx="62542" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="62542" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62542" y="-1416.69" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="62542" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 39</text>
<text text-anchor="middle" x="62542" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_ar_39_1 -->
<g id="node428" class="node">
<title>ffn_ar_39_1</title>
<ellipse fill="lightblue" stroke="black" cx="62376" cy="-1412.89" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="62376" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62376" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="62376" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 39</text>
<text text-anchor="middle" x="62376" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- ffn_out_ar_39_1 -->
<g id="node429" class="node">
<title>ffn_out_ar_39_1</title>
<ellipse fill="lightblue" stroke="black" cx="62202" cy="-1412.89" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="62202" y="-1431.69" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62202" y="-1416.69" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="62202" y="-1401.69" font-family="Times,serif" font-size="14.00">Layer 39</text>
<text text-anchor="middle" x="62202" y="-1386.69" font-family="Times,serif" font-size="14.00">GPU:[2,3]</text>
</g>
<!-- pp_send_1_2 -->
<g id="node511" class="node">
<title>pp_send_1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="62202" cy="-1220.41" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="62202" y="-1231.71" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="62202" y="-1216.71" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="62202" y="-1201.71" font-family="Times,serif" font-size="14.00">GPU:[3][4]</text>
</g>
<!-- ffn_out_ar_39_1&#45;&gt;pp_send_1_2 -->
<g id="edge9" class="edge">
<title>ffn_out_ar_39_1&#45;&gt;pp_send_1_2</title>
<path fill="none" stroke="black" d="M62202,-1364.8C62202,-1335.34 62202,-1297.53 62202,-1268.13"/>
<polygon fill="black" stroke="black" points="62205.5,-1268.11 62202,-1258.11 62198.5,-1268.11 62205.5,-1268.11"/>
</g>
<!-- layer40_attn_out_ar_2 -->
<g id="node430" class="node">
<title>layer40_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="62202" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="62202" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62202" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="62202" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 40</text>
<text text-anchor="middle" x="62202" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_40_2 -->
<g id="node431" class="node">
<title>ffn_out_ar_40_2</title>
<ellipse fill="lightblue" stroke="black" cx="62028" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="62028" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="62028" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="62028" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 40</text>
<text text-anchor="middle" x="62028" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer41_attn_out_ar_2 -->
<g id="node432" class="node">
<title>layer41_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="61854" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="61854" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="61854" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="61854" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 41</text>
<text text-anchor="middle" x="61854" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_41_2 -->
<g id="node433" class="node">
<title>ffn_out_ar_41_2</title>
<ellipse fill="lightblue" stroke="black" cx="61680" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="61680" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="61680" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="61680" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 41</text>
<text text-anchor="middle" x="61680" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer42_attn_out_ar_2 -->
<g id="node434" class="node">
<title>layer42_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="61506" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="61506" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="61506" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="61506" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 42</text>
<text text-anchor="middle" x="61506" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_42_2 -->
<g id="node435" class="node">
<title>ffn_out_ar_42_2</title>
<ellipse fill="lightblue" stroke="black" cx="61332" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="61332" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="61332" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="61332" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 42</text>
<text text-anchor="middle" x="61332" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer43_attn_out_ar_2 -->
<g id="node436" class="node">
<title>layer43_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="61158" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="61158" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="61158" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="61158" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 43</text>
<text text-anchor="middle" x="61158" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_43_2 -->
<g id="node437" class="node">
<title>ffn_out_ar_43_2</title>
<ellipse fill="lightblue" stroke="black" cx="60984" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="60984" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60984" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="60984" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 43</text>
<text text-anchor="middle" x="60984" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer44_attn_out_ar_2 -->
<g id="node438" class="node">
<title>layer44_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="60810" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="60810" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60810" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60810" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 44</text>
<text text-anchor="middle" x="60810" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_44_2 -->
<g id="node439" class="node">
<title>ffn_out_ar_44_2</title>
<ellipse fill="lightblue" stroke="black" cx="60636" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="60636" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60636" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="60636" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 44</text>
<text text-anchor="middle" x="60636" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer45_attn_out_ar_2 -->
<g id="node440" class="node">
<title>layer45_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="60462" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="60462" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60462" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60462" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 45</text>
<text text-anchor="middle" x="60462" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_45_2 -->
<g id="node441" class="node">
<title>ffn_out_ar_45_2</title>
<ellipse fill="lightblue" stroke="black" cx="60288" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="60288" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60288" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="60288" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 45</text>
<text text-anchor="middle" x="60288" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer46_attn_out_ar_2 -->
<g id="node442" class="node">
<title>layer46_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="60114" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="60114" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="60114" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60114" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 46</text>
<text text-anchor="middle" x="60114" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_46_2 -->
<g id="node443" class="node">
<title>ffn_out_ar_46_2</title>
<ellipse fill="lightblue" stroke="black" cx="59940" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="59940" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59940" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="59940" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 46</text>
<text text-anchor="middle" x="59940" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer47_attn_out_ar_2 -->
<g id="node444" class="node">
<title>layer47_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="59766" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="59766" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59766" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="59766" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 47</text>
<text text-anchor="middle" x="59766" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_47_2 -->
<g id="node445" class="node">
<title>ffn_out_ar_47_2</title>
<ellipse fill="lightblue" stroke="black" cx="59592" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="59592" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59592" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="59592" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 47</text>
<text text-anchor="middle" x="59592" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer48_attn_out_ar_2 -->
<g id="node446" class="node">
<title>layer48_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="59418" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="59418" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59418" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="59418" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 48</text>
<text text-anchor="middle" x="59418" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_48_2 -->
<g id="node447" class="node">
<title>ffn_out_ar_48_2</title>
<ellipse fill="lightblue" stroke="black" cx="59244" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="59244" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59244" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="59244" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 48</text>
<text text-anchor="middle" x="59244" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer49_attn_out_ar_2 -->
<g id="node448" class="node">
<title>layer49_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="59070" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="59070" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="59070" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="59070" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 49</text>
<text text-anchor="middle" x="59070" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_49_2 -->
<g id="node449" class="node">
<title>ffn_out_ar_49_2</title>
<ellipse fill="lightblue" stroke="black" cx="58896" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="58896" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58896" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="58896" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 49</text>
<text text-anchor="middle" x="58896" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer50_attn_out_ar_2 -->
<g id="node450" class="node">
<title>layer50_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="58722" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="58722" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58722" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="58722" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 50</text>
<text text-anchor="middle" x="58722" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_50_2 -->
<g id="node451" class="node">
<title>ffn_out_ar_50_2</title>
<ellipse fill="lightblue" stroke="black" cx="58548" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="58548" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58548" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="58548" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 50</text>
<text text-anchor="middle" x="58548" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer51_attn_out_ar_2 -->
<g id="node452" class="node">
<title>layer51_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="58374" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="58374" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58374" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="58374" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 51</text>
<text text-anchor="middle" x="58374" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_51_2 -->
<g id="node453" class="node">
<title>ffn_out_ar_51_2</title>
<ellipse fill="lightblue" stroke="black" cx="58200" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="58200" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58200" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="58200" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 51</text>
<text text-anchor="middle" x="58200" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer52_attn_out_ar_2 -->
<g id="node454" class="node">
<title>layer52_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="58026" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="58026" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="58026" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="58026" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 52</text>
<text text-anchor="middle" x="58026" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_52_2 -->
<g id="node455" class="node">
<title>ffn_out_ar_52_2</title>
<ellipse fill="lightblue" stroke="black" cx="57852" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="57852" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="57852" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="57852" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 52</text>
<text text-anchor="middle" x="57852" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer53_attn_out_ar_2 -->
<g id="node456" class="node">
<title>layer53_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="57678" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="57678" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="57678" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="57678" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 53</text>
<text text-anchor="middle" x="57678" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_53_2 -->
<g id="node457" class="node">
<title>ffn_out_ar_53_2</title>
<ellipse fill="lightblue" stroke="black" cx="57504" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="57504" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="57504" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="57504" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 53</text>
<text text-anchor="middle" x="57504" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer54_attn_out_ar_2 -->
<g id="node458" class="node">
<title>layer54_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="57330" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="57330" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="57330" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="57330" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 54</text>
<text text-anchor="middle" x="57330" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_54_2 -->
<g id="node459" class="node">
<title>ffn_out_ar_54_2</title>
<ellipse fill="lightblue" stroke="black" cx="57156" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="57156" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="57156" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="57156" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 54</text>
<text text-anchor="middle" x="57156" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer55_attn_out_ar_2 -->
<g id="node460" class="node">
<title>layer55_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="56982" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="56982" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56982" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="56982" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 55</text>
<text text-anchor="middle" x="56982" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_55_2 -->
<g id="node461" class="node">
<title>ffn_out_ar_55_2</title>
<ellipse fill="lightblue" stroke="black" cx="56808" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="56808" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56808" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="56808" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 55</text>
<text text-anchor="middle" x="56808" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer56_attn_out_ar_2 -->
<g id="node462" class="node">
<title>layer56_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="56634" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="56634" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56634" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="56634" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 56</text>
<text text-anchor="middle" x="56634" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_56_2 -->
<g id="node463" class="node">
<title>ffn_out_ar_56_2</title>
<ellipse fill="lightblue" stroke="black" cx="56460" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="56460" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56460" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="56460" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 56</text>
<text text-anchor="middle" x="56460" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer57_attn_out_ar_2 -->
<g id="node464" class="node">
<title>layer57_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="56286" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="56286" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56286" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="56286" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 57</text>
<text text-anchor="middle" x="56286" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_57_2 -->
<g id="node465" class="node">
<title>ffn_out_ar_57_2</title>
<ellipse fill="lightblue" stroke="black" cx="56112" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="56112" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="56112" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="56112" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 57</text>
<text text-anchor="middle" x="56112" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer58_attn_out_ar_2 -->
<g id="node466" class="node">
<title>layer58_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="55938" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="55938" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55938" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="55938" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 58</text>
<text text-anchor="middle" x="55938" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_58_2 -->
<g id="node467" class="node">
<title>ffn_out_ar_58_2</title>
<ellipse fill="lightblue" stroke="black" cx="55764" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="55764" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55764" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="55764" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 58</text>
<text text-anchor="middle" x="55764" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- layer59_attn_out_ar_2 -->
<g id="node468" class="node">
<title>layer59_attn_out_ar_2</title>
<ellipse fill="lightblue" stroke="black" cx="55590" cy="-1062.85" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="55590" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55590" y="-1066.65" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="55590" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 59</text>
<text text-anchor="middle" x="55590" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- ffn_out_ar_59_2 -->
<g id="node469" class="node">
<title>ffn_out_ar_59_2</title>
<ellipse fill="lightblue" stroke="black" cx="55416" cy="-1062.85" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="55416" y="-1081.65" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55416" y="-1066.65" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="55416" y="-1051.65" font-family="Times,serif" font-size="14.00">Layer 59</text>
<text text-anchor="middle" x="55416" y="-1036.65" font-family="Times,serif" font-size="14.00">GPU:[4,5]</text>
</g>
<!-- pp_send_2_3 -->
<g id="node512" class="node">
<title>pp_send_2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="55416" cy="-905.29" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="55416" y="-916.59" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="55416" y="-901.59" font-family="Times,serif" font-size="14.00">Stage 23</text>
<text text-anchor="middle" x="55416" y="-886.59" font-family="Times,serif" font-size="14.00">GPU:[5][6]</text>
</g>
<!-- ffn_out_ar_59_2&#45;&gt;pp_send_2_3 -->
<g id="edge11" class="edge">
<title>ffn_out_ar_59_2&#45;&gt;pp_send_2_3</title>
<path fill="none" stroke="black" d="M55416,-1014.75C55416,-995.2 55416,-972.56 55416,-953.04"/>
<polygon fill="black" stroke="black" points="55419.5,-952.85 55416,-942.85 55412.5,-952.85 55419.5,-952.85"/>
</g>
<!-- layer60_attn_out_ar_3 -->
<g id="node470" class="node">
<title>layer60_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="55416" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="55416" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55416" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="55416" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 60</text>
<text text-anchor="middle" x="55416" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_60_3 -->
<g id="node471" class="node">
<title>ffn_out_ar_60_3</title>
<ellipse fill="lightblue" stroke="black" cx="55242" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="55242" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55242" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="55242" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 60</text>
<text text-anchor="middle" x="55242" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer61_attn_out_ar_3 -->
<g id="node472" class="node">
<title>layer61_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="55068" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="55068" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="55068" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="55068" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 61</text>
<text text-anchor="middle" x="55068" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_61_3 -->
<g id="node473" class="node">
<title>ffn_out_ar_61_3</title>
<ellipse fill="lightblue" stroke="black" cx="54894" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="54894" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54894" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="54894" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 61</text>
<text text-anchor="middle" x="54894" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer62_attn_out_ar_3 -->
<g id="node474" class="node">
<title>layer62_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="54720" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="54720" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54720" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="54720" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 62</text>
<text text-anchor="middle" x="54720" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_62_3 -->
<g id="node475" class="node">
<title>ffn_out_ar_62_3</title>
<ellipse fill="lightblue" stroke="black" cx="54546" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="54546" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54546" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="54546" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 62</text>
<text text-anchor="middle" x="54546" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer63_attn_out_ar_3 -->
<g id="node476" class="node">
<title>layer63_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="54372" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="54372" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54372" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="54372" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 63</text>
<text text-anchor="middle" x="54372" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_63_3 -->
<g id="node477" class="node">
<title>ffn_out_ar_63_3</title>
<ellipse fill="lightblue" stroke="black" cx="54198" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="54198" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54198" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="54198" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 63</text>
<text text-anchor="middle" x="54198" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer64_attn_out_ar_3 -->
<g id="node478" class="node">
<title>layer64_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="54024" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="54024" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="54024" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="54024" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 64</text>
<text text-anchor="middle" x="54024" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_64_3 -->
<g id="node479" class="node">
<title>ffn_out_ar_64_3</title>
<ellipse fill="lightblue" stroke="black" cx="53850" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="53850" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="53850" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="53850" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 64</text>
<text text-anchor="middle" x="53850" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer65_attn_out_ar_3 -->
<g id="node480" class="node">
<title>layer65_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="53676" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="53676" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="53676" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="53676" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 65</text>
<text text-anchor="middle" x="53676" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_65_3 -->
<g id="node481" class="node">
<title>ffn_out_ar_65_3</title>
<ellipse fill="lightblue" stroke="black" cx="53502" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="53502" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="53502" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="53502" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 65</text>
<text text-anchor="middle" x="53502" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer66_attn_out_ar_3 -->
<g id="node482" class="node">
<title>layer66_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="53328" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="53328" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="53328" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="53328" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 66</text>
<text text-anchor="middle" x="53328" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_66_3 -->
<g id="node483" class="node">
<title>ffn_out_ar_66_3</title>
<ellipse fill="lightblue" stroke="black" cx="53154" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="53154" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="53154" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="53154" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 66</text>
<text text-anchor="middle" x="53154" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer67_attn_out_ar_3 -->
<g id="node484" class="node">
<title>layer67_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="52980" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="52980" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52980" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52980" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 67</text>
<text text-anchor="middle" x="52980" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_67_3 -->
<g id="node485" class="node">
<title>ffn_out_ar_67_3</title>
<ellipse fill="lightblue" stroke="black" cx="52806" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="52806" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52806" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="52806" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 67</text>
<text text-anchor="middle" x="52806" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer68_attn_out_ar_3 -->
<g id="node486" class="node">
<title>layer68_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="52632" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="52632" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52632" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52632" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 68</text>
<text text-anchor="middle" x="52632" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_68_3 -->
<g id="node487" class="node">
<title>ffn_out_ar_68_3</title>
<ellipse fill="lightblue" stroke="black" cx="52458" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="52458" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52458" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="52458" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 68</text>
<text text-anchor="middle" x="52458" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer69_attn_out_ar_3 -->
<g id="node488" class="node">
<title>layer69_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="52284" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="52284" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52284" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52284" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 69</text>
<text text-anchor="middle" x="52284" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_69_3 -->
<g id="node489" class="node">
<title>ffn_out_ar_69_3</title>
<ellipse fill="lightblue" stroke="black" cx="52110" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="52110" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="52110" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="52110" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 69</text>
<text text-anchor="middle" x="52110" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer70_attn_out_ar_3 -->
<g id="node490" class="node">
<title>layer70_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="51936" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="51936" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51936" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="51936" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 70</text>
<text text-anchor="middle" x="51936" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_70_3 -->
<g id="node491" class="node">
<title>ffn_out_ar_70_3</title>
<ellipse fill="lightblue" stroke="black" cx="51762" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="51762" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51762" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="51762" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 70</text>
<text text-anchor="middle" x="51762" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer71_attn_out_ar_3 -->
<g id="node492" class="node">
<title>layer71_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="51588" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="51588" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51588" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="51588" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 71</text>
<text text-anchor="middle" x="51588" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_71_3 -->
<g id="node493" class="node">
<title>ffn_out_ar_71_3</title>
<ellipse fill="lightblue" stroke="black" cx="51414" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="51414" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51414" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="51414" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 71</text>
<text text-anchor="middle" x="51414" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer72_attn_out_ar_3 -->
<g id="node494" class="node">
<title>layer72_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="51240" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="51240" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51240" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="51240" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 72</text>
<text text-anchor="middle" x="51240" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_72_3 -->
<g id="node495" class="node">
<title>ffn_out_ar_72_3</title>
<ellipse fill="lightblue" stroke="black" cx="51066" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="51066" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="51066" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="51066" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 72</text>
<text text-anchor="middle" x="51066" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer73_attn_out_ar_3 -->
<g id="node496" class="node">
<title>layer73_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="50892" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="50892" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50892" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="50892" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 73</text>
<text text-anchor="middle" x="50892" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_73_3 -->
<g id="node497" class="node">
<title>ffn_out_ar_73_3</title>
<ellipse fill="lightblue" stroke="black" cx="50718" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="50718" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50718" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="50718" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 73</text>
<text text-anchor="middle" x="50718" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer74_attn_out_ar_3 -->
<g id="node498" class="node">
<title>layer74_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="50544" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="50544" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50544" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="50544" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 74</text>
<text text-anchor="middle" x="50544" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_74_3 -->
<g id="node499" class="node">
<title>ffn_out_ar_74_3</title>
<ellipse fill="lightblue" stroke="black" cx="50370" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="50370" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50370" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="50370" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 74</text>
<text text-anchor="middle" x="50370" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer75_attn_out_ar_3 -->
<g id="node500" class="node">
<title>layer75_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="50196" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="50196" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50196" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="50196" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 75</text>
<text text-anchor="middle" x="50196" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_75_3 -->
<g id="node501" class="node">
<title>ffn_out_ar_75_3</title>
<ellipse fill="lightblue" stroke="black" cx="50022" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="50022" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="50022" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="50022" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 75</text>
<text text-anchor="middle" x="50022" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer76_attn_out_ar_3 -->
<g id="node502" class="node">
<title>layer76_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="49848" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="49848" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49848" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="49848" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 76</text>
<text text-anchor="middle" x="49848" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_76_3 -->
<g id="node503" class="node">
<title>ffn_out_ar_76_3</title>
<ellipse fill="lightblue" stroke="black" cx="49674" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="49674" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49674" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="49674" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 76</text>
<text text-anchor="middle" x="49674" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer77_attn_out_ar_3 -->
<g id="node504" class="node">
<title>layer77_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="49500" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="49500" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49500" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="49500" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 77</text>
<text text-anchor="middle" x="49500" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_77_3 -->
<g id="node505" class="node">
<title>ffn_out_ar_77_3</title>
<ellipse fill="lightblue" stroke="black" cx="49326" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="49326" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49326" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="49326" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 77</text>
<text text-anchor="middle" x="49326" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer78_attn_out_ar_3 -->
<g id="node506" class="node">
<title>layer78_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="49152" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="49152" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="49152" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="49152" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 78</text>
<text text-anchor="middle" x="49152" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_78_3 -->
<g id="node507" class="node">
<title>ffn_out_ar_78_3</title>
<ellipse fill="lightblue" stroke="black" cx="48978" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="48978" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="48978" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="48978" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 78</text>
<text text-anchor="middle" x="48978" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- layer79_attn_out_ar_3 -->
<g id="node508" class="node">
<title>layer79_attn_out_ar_3</title>
<ellipse fill="lightblue" stroke="black" cx="48804" cy="-747.73" rx="65.11" ry="48.17"/>
<text text-anchor="middle" x="48804" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="48804" y="-751.53" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="48804" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 79</text>
<text text-anchor="middle" x="48804" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- ffn_out_ar_79_3 -->
<g id="node509" class="node">
<title>ffn_out_ar_79_3</title>
<ellipse fill="lightblue" stroke="black" cx="48630" cy="-747.73" rx="72.66" ry="48.17"/>
<text text-anchor="middle" x="48630" y="-766.53" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="48630" y="-751.53" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="48630" y="-736.53" font-family="Times,serif" font-size="14.00">Layer 79</text>
<text text-anchor="middle" x="48630" y="-721.53" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- output_norm_0 -->
<g id="node513" class="node">
<title>output_norm_0</title>
<polygon fill="#fff0e6" stroke="black" points="48612,-627.65 48440,-627.65 48440,-559.65 48612,-559.65 48612,-627.65"/>
<text text-anchor="middle" x="48526" y="-612.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="48526" y="-597.45" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="48526" y="-582.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="48526" y="-567.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_79_3&#45;&gt;output_norm_0 -->
<g id="edge13" class="edge">
<title>ffn_out_ar_79_3&#45;&gt;output_norm_0</title>
<path fill="none" stroke="black" d="M48600.48,-703.56C48586.01,-682.41 48568.68,-657.06 48554.38,-636.14"/>
<polygon fill="black" stroke="black" points="48557.18,-634.05 48548.65,-627.77 48551.41,-638 48557.18,-634.05"/>
</g>
<!-- output_norm_1 -->
<g id="node514" class="node">
<title>output_norm_1</title>
<polygon fill="#fff0e6" stroke="black" points="48820,-627.65 48648,-627.65 48648,-559.65 48820,-559.65 48820,-627.65"/>
<text text-anchor="middle" x="48734" y="-612.45" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="48734" y="-597.45" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="48734" y="-582.45" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="48734" y="-567.45" font-family="Times,serif" font-size="14.00">Output:[4,2048,8192]</text>
</g>
<!-- ffn_out_ar_79_3&#45;&gt;output_norm_1 -->
<g id="edge14" class="edge">
<title>ffn_out_ar_79_3&#45;&gt;output_norm_1</title>
<path fill="none" stroke="black" d="M48659.52,-703.56C48673.99,-682.41 48691.32,-657.06 48705.62,-636.14"/>
<polygon fill="black" stroke="black" points="48708.59,-638 48711.35,-627.77 48702.82,-634.05 48708.59,-638"/>
</g>
<!-- pp_send_0_1&#45;&gt;layer20_qkv_0 -->
<g id="edge7" class="edge">
<title>pp_send_0_1&#45;&gt;layer20_qkv_0</title>
<path fill="none" stroke="black" d="M87802.7,-1575.83C87821.14,-1565.31 87842.1,-1553.2 87861,-1541.89 87887.4,-1526.09 87915.49,-1508.84 87942.14,-1492.27"/>
<polygon fill="black" stroke="black" points="87944.1,-1495.17 87950.73,-1486.92 87940.39,-1489.23 87944.1,-1495.17"/>
</g>
<!-- pp_send_0_1&#45;&gt;layer20_qkv_1 -->
<g id="edge8" class="edge">
<title>pp_send_0_1&#45;&gt;layer20_qkv_1</title>
<path fill="none" stroke="black" d="M87752,-1567.64C87752,-1538.37 87752,-1497.07 87752,-1464.65"/>
<polygon fill="black" stroke="black" points="87755.5,-1464.46 87752,-1454.46 87748.5,-1464.46 87755.5,-1464.46"/>
</g>
<!-- pp_send_1_2&#45;&gt;layer40_attn_out_ar_2 -->
<g id="edge10" class="edge">
<title>pp_send_1_2&#45;&gt;layer40_attn_out_ar_2</title>
<path fill="none" stroke="black" d="M62202,-1182.54C62202,-1164.25 62202,-1141.74 62202,-1121.25"/>
<polygon fill="black" stroke="black" points="62205.5,-1121.07 62202,-1111.07 62198.5,-1121.07 62205.5,-1121.07"/>
</g>
<!-- pp_send_2_3&#45;&gt;layer60_attn_out_ar_3 -->
<g id="edge12" class="edge">
<title>pp_send_2_3&#45;&gt;layer60_attn_out_ar_3</title>
<path fill="none" stroke="black" d="M55416,-867.42C55416,-849.13 55416,-826.62 55416,-806.13"/>
<polygon fill="black" stroke="black" points="55419.5,-805.95 55416,-795.95 55412.5,-805.95 55419.5,-805.95"/>
</g>
<!-- final_ag -->
<g id="node515" class="node">
<title>final_ag</title>
<ellipse fill="lightblue" stroke="black" cx="48630" cy="-450.17" rx="75.82" ry="37.45"/>
<text text-anchor="middle" x="48630" y="-461.47" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
<text text-anchor="middle" x="48630" y="-446.47" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="48630" y="-431.47" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- output_norm_0&#45;&gt;final_ag -->
<g id="edge15" class="edge">
<title>output_norm_0&#45;&gt;final_ag</title>
<path fill="none" stroke="black" d="M48550.38,-559.48C48564.8,-539.87 48583.21,-514.83 48598.69,-493.76"/>
<polygon fill="black" stroke="black" points="48601.58,-495.74 48604.68,-485.61 48595.94,-491.59 48601.58,-495.74"/>
</g>
<!-- output_norm_1&#45;&gt;final_ag -->
<g id="edge16" class="edge">
<title>output_norm_1&#45;&gt;final_ag</title>
<path fill="none" stroke="black" d="M48709.62,-559.48C48695.2,-539.87 48676.79,-514.83 48661.31,-493.76"/>
<polygon fill="black" stroke="black" points="48664.06,-491.59 48655.32,-485.61 48658.42,-495.74 48664.06,-491.59"/>
</g>
<!-- lm_head_0 -->
<g id="node516" class="node">
<title>lm_head_0</title>
<polygon fill="#fff0e6" stroke="black" points="48612,-340.69 48422,-340.69 48422,-272.69 48612,-272.69 48612,-340.69"/>
<text text-anchor="middle" x="48517" y="-325.49" font-family="Times,serif" font-size="14.00">LM Head</text>
<text text-anchor="middle" x="48517" y="-310.49" font-family="Times,serif" font-size="14.00">GPU:6</text>
<text text-anchor="middle" x="48517" y="-295.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="48517" y="-280.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,128256]</text>
</g>
<!-- final_ag&#45;&gt;lm_head_0 -->
<g id="edge17" class="edge">
<title>final_ag&#45;&gt;lm_head_0</title>
<path fill="none" stroke="black" d="M48602.65,-414.92C48586.85,-395.14 48566.86,-370.12 48550.17,-349.22"/>
<polygon fill="black" stroke="black" points="48552.69,-346.77 48543.71,-341.14 48547.22,-351.14 48552.69,-346.77"/>
</g>
<!-- lm_head_1 -->
<g id="node517" class="node">
<title>lm_head_1</title>
<polygon fill="#fff0e6" stroke="black" points="48838,-340.69 48648,-340.69 48648,-272.69 48838,-272.69 48838,-340.69"/>
<text text-anchor="middle" x="48743" y="-325.49" font-family="Times,serif" font-size="14.00">LM Head</text>
<text text-anchor="middle" x="48743" y="-310.49" font-family="Times,serif" font-size="14.00">GPU:7</text>
<text text-anchor="middle" x="48743" y="-295.49" font-family="Times,serif" font-size="14.00">Input:[4,2048,8192]</text>
<text text-anchor="middle" x="48743" y="-280.49" font-family="Times,serif" font-size="14.00">Output:[4,2048,128256]</text>
</g>
<!-- final_ag&#45;&gt;lm_head_1 -->
<g id="edge18" class="edge">
<title>final_ag&#45;&gt;lm_head_1</title>
<path fill="none" stroke="black" d="M48657.35,-414.92C48673.15,-395.14 48693.14,-370.12 48709.83,-349.22"/>
<polygon fill="black" stroke="black" points="48712.78,-351.14 48716.29,-341.14 48707.31,-346.77 48712.78,-351.14"/>
</g>
<!-- final_ar -->
<g id="node518" class="node">
<title>final_ar</title>
<ellipse fill="lightblue" stroke="black" cx="48630" cy="-163.22" rx="65.11" ry="37.45"/>
<text text-anchor="middle" x="48630" y="-174.52" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="48630" y="-159.52" font-family="Times,serif" font-size="14.00">Logits</text>
<text text-anchor="middle" x="48630" y="-144.52" font-family="Times,serif" font-size="14.00">GPU:[6,7]</text>
</g>
<!-- lm_head_0&#45;&gt;final_ar -->
<g id="edge19" class="edge">
<title>lm_head_0&#45;&gt;final_ar</title>
<path fill="none" stroke="black" d="M48543.49,-272.52C48559.46,-252.54 48579.93,-226.91 48596.94,-205.6"/>
<polygon fill="black" stroke="black" points="48599.77,-207.67 48603.28,-197.67 48594.31,-203.3 48599.77,-207.67"/>
</g>
<!-- lm_head_1&#45;&gt;final_ar -->
<g id="edge20" class="edge">
<title>lm_head_1&#45;&gt;final_ar</title>
<path fill="none" stroke="black" d="M48716.51,-272.52C48700.54,-252.54 48680.07,-226.91 48663.06,-205.6"/>
<polygon fill="black" stroke="black" points="48665.69,-203.3 48656.72,-197.67 48660.23,-207.67 48665.69,-203.3"/>
</g>
<!-- output -->
<g id="node519" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="48630" cy="-26.87" rx="246.56" ry="26.74"/>
<text text-anchor="middle" x="48630" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="48630" y="-15.67" font-family="Times,serif" font-size="14.00">[batch_size=4, seq_len=2048, vocab=128256]</text>
</g>
<!-- final_ar&#45;&gt;output -->
<g id="edge21" class="edge">
<title>final_ar&#45;&gt;output</title>
<path fill="none" stroke="black" d="M48630,-125.51C48630,-106.36 48630,-83.04 48630,-63.98"/>
<polygon fill="black" stroke="black" points="48633.5,-63.89 48630,-53.89 48626.5,-63.89 48633.5,-63.89"/>
</g>
</g>
</svg>
