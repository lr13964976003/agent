// Complete LLM Deployment DAG - PP(4) x TP(2)
digraph {
	graph [nodesep=0.5 rankdir=TB ranksep=1.0 size="25,35" splines=ortho]
	node [fillcolor=lightblue shape=ellipse style=filled]
	input [label="Input\n[batch_size=4, seq_len=2048, hidden=8192]" fillcolor=white shape=ellipse]
	input -> split_stage0
	split_stage0 -> layer0_embed_0
	split_stage0 -> layer0_embed_1
	layer0_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	embed_ag_stage0 -> layer0_norm_0
	embed_ag_stage0 -> layer0_norm_1
	layer0_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_norm_0 -> layer0_qkv_0
	layer0_norm_1 -> layer0_qkv_1
	layer0_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer0_qkv_0 -> layer0_qkv_ar
	layer0_qkv_1 -> layer0_qkv_ar
	layer0_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_qkv_ar -> layer0_attn_0
	layer0_qkv_ar -> layer0_attn_1
	layer0_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_attn_0 -> layer0_attn_out_0
	layer0_attn_1 -> layer0_attn_out_1
	layer0_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer0_attn_out_0 -> layer0_attn_ar
	layer0_attn_out_1 -> layer0_attn_ar
	layer0_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_attn_ar -> layer0_ffn_norm_0
	layer0_attn_ar -> layer0_ffn_norm_1
	layer0_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_norm_0 -> layer0_ffn_gate_0
	layer0_ffn_norm_1 -> layer0_ffn_gate_1
	layer0_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_norm_0 -> layer0_ffn_up_0
	layer0_ffn_norm_1 -> layer0_ffn_up_1
	layer0_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer0_ffn_gate_0 -> layer0_gate_ar
	layer0_ffn_gate_1 -> layer0_gate_ar
	layer0_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer0_ffn_up_0 -> layer0_up_ar
	layer0_ffn_up_1 -> layer0_up_ar
	layer0_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_gate_ar -> layer0_silu_0
	layer0_gate_ar -> layer0_silu_1
	layer0_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_silu_0 -> layer0_mul_0
	layer0_up_ar -> layer0_mul_0
	layer0_silu_1 -> layer0_mul_1
	layer0_up_ar -> layer0_mul_1
	layer0_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_mul_0 -> layer0_ffn_down_0
	layer0_mul_1 -> layer0_ffn_down_1
	layer0_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer0_ffn_down_0 -> layer0_ffn_ar
	layer0_ffn_down_1 -> layer0_ffn_ar
	layer1_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer0_ffn_ar -> layer1_norm_0
	layer0_ffn_ar -> layer1_norm_1
	layer1_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_norm_0 -> layer1_qkv_0
	layer1_norm_1 -> layer1_qkv_1
	layer1_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer1_qkv_0 -> layer1_qkv_ar
	layer1_qkv_1 -> layer1_qkv_ar
	layer1_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_qkv_ar -> layer1_attn_0
	layer1_qkv_ar -> layer1_attn_1
	layer1_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_attn_0 -> layer1_attn_out_0
	layer1_attn_1 -> layer1_attn_out_1
	layer1_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer1_attn_out_0 -> layer1_attn_ar
	layer1_attn_out_1 -> layer1_attn_ar
	layer1_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_attn_ar -> layer1_ffn_norm_0
	layer1_attn_ar -> layer1_ffn_norm_1
	layer1_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_norm_0 -> layer1_ffn_gate_0
	layer1_ffn_norm_1 -> layer1_ffn_gate_1
	layer1_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_norm_0 -> layer1_ffn_up_0
	layer1_ffn_norm_1 -> layer1_ffn_up_1
	layer1_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer1_ffn_gate_0 -> layer1_gate_ar
	layer1_ffn_gate_1 -> layer1_gate_ar
	layer1_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer1_ffn_up_0 -> layer1_up_ar
	layer1_ffn_up_1 -> layer1_up_ar
	layer1_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_gate_ar -> layer1_silu_0
	layer1_gate_ar -> layer1_silu_1
	layer1_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_silu_0 -> layer1_mul_0
	layer1_up_ar -> layer1_mul_0
	layer1_silu_1 -> layer1_mul_1
	layer1_up_ar -> layer1_mul_1
	layer1_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_mul_0 -> layer1_ffn_down_0
	layer1_mul_1 -> layer1_ffn_down_1
	layer1_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer1_ffn_down_0 -> layer1_ffn_ar
	layer1_ffn_down_1 -> layer1_ffn_ar
	layer2_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer1_ffn_ar -> layer2_norm_0
	layer1_ffn_ar -> layer2_norm_1
	layer2_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_norm_0 -> layer2_qkv_0
	layer2_norm_1 -> layer2_qkv_1
	layer2_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer2_qkv_0 -> layer2_qkv_ar
	layer2_qkv_1 -> layer2_qkv_ar
	layer2_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_qkv_ar -> layer2_attn_0
	layer2_qkv_ar -> layer2_attn_1
	layer2_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_attn_0 -> layer2_attn_out_0
	layer2_attn_1 -> layer2_attn_out_1
	layer2_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer2_attn_out_0 -> layer2_attn_ar
	layer2_attn_out_1 -> layer2_attn_ar
	layer2_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_attn_ar -> layer2_ffn_norm_0
	layer2_attn_ar -> layer2_ffn_norm_1
	layer2_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_norm_0 -> layer2_ffn_gate_0
	layer2_ffn_norm_1 -> layer2_ffn_gate_1
	layer2_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_norm_0 -> layer2_ffn_up_0
	layer2_ffn_norm_1 -> layer2_ffn_up_1
	layer2_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer2_ffn_gate_0 -> layer2_gate_ar
	layer2_ffn_gate_1 -> layer2_gate_ar
	layer2_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer2_ffn_up_0 -> layer2_up_ar
	layer2_ffn_up_1 -> layer2_up_ar
	layer2_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_gate_ar -> layer2_silu_0
	layer2_gate_ar -> layer2_silu_1
	layer2_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_silu_0 -> layer2_mul_0
	layer2_up_ar -> layer2_mul_0
	layer2_silu_1 -> layer2_mul_1
	layer2_up_ar -> layer2_mul_1
	layer2_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_mul_0 -> layer2_ffn_down_0
	layer2_mul_1 -> layer2_ffn_down_1
	layer2_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer2_ffn_down_0 -> layer2_ffn_ar
	layer2_ffn_down_1 -> layer2_ffn_ar
	layer3_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer2_ffn_ar -> layer3_norm_0
	layer2_ffn_ar -> layer3_norm_1
	layer3_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_norm_0 -> layer3_qkv_0
	layer3_norm_1 -> layer3_qkv_1
	layer3_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer3_qkv_0 -> layer3_qkv_ar
	layer3_qkv_1 -> layer3_qkv_ar
	layer3_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_qkv_ar -> layer3_attn_0
	layer3_qkv_ar -> layer3_attn_1
	layer3_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_attn_0 -> layer3_attn_out_0
	layer3_attn_1 -> layer3_attn_out_1
	layer3_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer3_attn_out_0 -> layer3_attn_ar
	layer3_attn_out_1 -> layer3_attn_ar
	layer3_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_attn_ar -> layer3_ffn_norm_0
	layer3_attn_ar -> layer3_ffn_norm_1
	layer3_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_norm_0 -> layer3_ffn_gate_0
	layer3_ffn_norm_1 -> layer3_ffn_gate_1
	layer3_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_norm_0 -> layer3_ffn_up_0
	layer3_ffn_norm_1 -> layer3_ffn_up_1
	layer3_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer3_ffn_gate_0 -> layer3_gate_ar
	layer3_ffn_gate_1 -> layer3_gate_ar
	layer3_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer3_ffn_up_0 -> layer3_up_ar
	layer3_ffn_up_1 -> layer3_up_ar
	layer3_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_gate_ar -> layer3_silu_0
	layer3_gate_ar -> layer3_silu_1
	layer3_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_silu_0 -> layer3_mul_0
	layer3_up_ar -> layer3_mul_0
	layer3_silu_1 -> layer3_mul_1
	layer3_up_ar -> layer3_mul_1
	layer3_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_mul_0 -> layer3_ffn_down_0
	layer3_mul_1 -> layer3_ffn_down_1
	layer3_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer3_ffn_down_0 -> layer3_ffn_ar
	layer3_ffn_down_1 -> layer3_ffn_ar
	layer4_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer3_ffn_ar -> layer4_norm_0
	layer3_ffn_ar -> layer4_norm_1
	layer4_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_norm_0 -> layer4_qkv_0
	layer4_norm_1 -> layer4_qkv_1
	layer4_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer4_qkv_0 -> layer4_qkv_ar
	layer4_qkv_1 -> layer4_qkv_ar
	layer4_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_qkv_ar -> layer4_attn_0
	layer4_qkv_ar -> layer4_attn_1
	layer4_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_attn_0 -> layer4_attn_out_0
	layer4_attn_1 -> layer4_attn_out_1
	layer4_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer4_attn_out_0 -> layer4_attn_ar
	layer4_attn_out_1 -> layer4_attn_ar
	layer4_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_attn_ar -> layer4_ffn_norm_0
	layer4_attn_ar -> layer4_ffn_norm_1
	layer4_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_norm_0 -> layer4_ffn_gate_0
	layer4_ffn_norm_1 -> layer4_ffn_gate_1
	layer4_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_norm_0 -> layer4_ffn_up_0
	layer4_ffn_norm_1 -> layer4_ffn_up_1
	layer4_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer4_ffn_gate_0 -> layer4_gate_ar
	layer4_ffn_gate_1 -> layer4_gate_ar
	layer4_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer4_ffn_up_0 -> layer4_up_ar
	layer4_ffn_up_1 -> layer4_up_ar
	layer4_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_gate_ar -> layer4_silu_0
	layer4_gate_ar -> layer4_silu_1
	layer4_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_silu_0 -> layer4_mul_0
	layer4_up_ar -> layer4_mul_0
	layer4_silu_1 -> layer4_mul_1
	layer4_up_ar -> layer4_mul_1
	layer4_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_mul_0 -> layer4_ffn_down_0
	layer4_mul_1 -> layer4_ffn_down_1
	layer4_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer4_ffn_down_0 -> layer4_ffn_ar
	layer4_ffn_down_1 -> layer4_ffn_ar
	layer5_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer4_ffn_ar -> layer5_norm_0
	layer4_ffn_ar -> layer5_norm_1
	layer5_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_norm_0 -> layer5_qkv_0
	layer5_norm_1 -> layer5_qkv_1
	layer5_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer5_qkv_0 -> layer5_qkv_ar
	layer5_qkv_1 -> layer5_qkv_ar
	layer5_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_qkv_ar -> layer5_attn_0
	layer5_qkv_ar -> layer5_attn_1
	layer5_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_attn_0 -> layer5_attn_out_0
	layer5_attn_1 -> layer5_attn_out_1
	layer5_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer5_attn_out_0 -> layer5_attn_ar
	layer5_attn_out_1 -> layer5_attn_ar
	layer5_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_attn_ar -> layer5_ffn_norm_0
	layer5_attn_ar -> layer5_ffn_norm_1
	layer5_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_norm_0 -> layer5_ffn_gate_0
	layer5_ffn_norm_1 -> layer5_ffn_gate_1
	layer5_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_norm_0 -> layer5_ffn_up_0
	layer5_ffn_norm_1 -> layer5_ffn_up_1
	layer5_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer5_ffn_gate_0 -> layer5_gate_ar
	layer5_ffn_gate_1 -> layer5_gate_ar
	layer5_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer5_ffn_up_0 -> layer5_up_ar
	layer5_ffn_up_1 -> layer5_up_ar
	layer5_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_gate_ar -> layer5_silu_0
	layer5_gate_ar -> layer5_silu_1
	layer5_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_silu_0 -> layer5_mul_0
	layer5_up_ar -> layer5_mul_0
	layer5_silu_1 -> layer5_mul_1
	layer5_up_ar -> layer5_mul_1
	layer5_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_mul_0 -> layer5_ffn_down_0
	layer5_mul_1 -> layer5_ffn_down_1
	layer5_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer5_ffn_down_0 -> layer5_ffn_ar
	layer5_ffn_down_1 -> layer5_ffn_ar
	layer6_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer5_ffn_ar -> layer6_norm_0
	layer5_ffn_ar -> layer6_norm_1
	layer6_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_norm_0 -> layer6_qkv_0
	layer6_norm_1 -> layer6_qkv_1
	layer6_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer6_qkv_0 -> layer6_qkv_ar
	layer6_qkv_1 -> layer6_qkv_ar
	layer6_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_qkv_ar -> layer6_attn_0
	layer6_qkv_ar -> layer6_attn_1
	layer6_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_attn_0 -> layer6_attn_out_0
	layer6_attn_1 -> layer6_attn_out_1
	layer6_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer6_attn_out_0 -> layer6_attn_ar
	layer6_attn_out_1 -> layer6_attn_ar
	layer6_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_attn_ar -> layer6_ffn_norm_0
	layer6_attn_ar -> layer6_ffn_norm_1
	layer6_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_norm_0 -> layer6_ffn_gate_0
	layer6_ffn_norm_1 -> layer6_ffn_gate_1
	layer6_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_norm_0 -> layer6_ffn_up_0
	layer6_ffn_norm_1 -> layer6_ffn_up_1
	layer6_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer6_ffn_gate_0 -> layer6_gate_ar
	layer6_ffn_gate_1 -> layer6_gate_ar
	layer6_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer6_ffn_up_0 -> layer6_up_ar
	layer6_ffn_up_1 -> layer6_up_ar
	layer6_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_gate_ar -> layer6_silu_0
	layer6_gate_ar -> layer6_silu_1
	layer6_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_silu_0 -> layer6_mul_0
	layer6_up_ar -> layer6_mul_0
	layer6_silu_1 -> layer6_mul_1
	layer6_up_ar -> layer6_mul_1
	layer6_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_mul_0 -> layer6_ffn_down_0
	layer6_mul_1 -> layer6_ffn_down_1
	layer6_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer6_ffn_down_0 -> layer6_ffn_ar
	layer6_ffn_down_1 -> layer6_ffn_ar
	layer7_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer6_ffn_ar -> layer7_norm_0
	layer6_ffn_ar -> layer7_norm_1
	layer7_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_norm_0 -> layer7_qkv_0
	layer7_norm_1 -> layer7_qkv_1
	layer7_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer7_qkv_0 -> layer7_qkv_ar
	layer7_qkv_1 -> layer7_qkv_ar
	layer7_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_qkv_ar -> layer7_attn_0
	layer7_qkv_ar -> layer7_attn_1
	layer7_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_attn_0 -> layer7_attn_out_0
	layer7_attn_1 -> layer7_attn_out_1
	layer7_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer7_attn_out_0 -> layer7_attn_ar
	layer7_attn_out_1 -> layer7_attn_ar
	layer7_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_attn_ar -> layer7_ffn_norm_0
	layer7_attn_ar -> layer7_ffn_norm_1
	layer7_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_norm_0 -> layer7_ffn_gate_0
	layer7_ffn_norm_1 -> layer7_ffn_gate_1
	layer7_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_norm_0 -> layer7_ffn_up_0
	layer7_ffn_norm_1 -> layer7_ffn_up_1
	layer7_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer7_ffn_gate_0 -> layer7_gate_ar
	layer7_ffn_gate_1 -> layer7_gate_ar
	layer7_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer7_ffn_up_0 -> layer7_up_ar
	layer7_ffn_up_1 -> layer7_up_ar
	layer7_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_gate_ar -> layer7_silu_0
	layer7_gate_ar -> layer7_silu_1
	layer7_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_silu_0 -> layer7_mul_0
	layer7_up_ar -> layer7_mul_0
	layer7_silu_1 -> layer7_mul_1
	layer7_up_ar -> layer7_mul_1
	layer7_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_mul_0 -> layer7_ffn_down_0
	layer7_mul_1 -> layer7_ffn_down_1
	layer7_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer7_ffn_down_0 -> layer7_ffn_ar
	layer7_ffn_down_1 -> layer7_ffn_ar
	layer8_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer7_ffn_ar -> layer8_norm_0
	layer7_ffn_ar -> layer8_norm_1
	layer8_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_norm_0 -> layer8_qkv_0
	layer8_norm_1 -> layer8_qkv_1
	layer8_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer8_qkv_0 -> layer8_qkv_ar
	layer8_qkv_1 -> layer8_qkv_ar
	layer8_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_qkv_ar -> layer8_attn_0
	layer8_qkv_ar -> layer8_attn_1
	layer8_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_attn_0 -> layer8_attn_out_0
	layer8_attn_1 -> layer8_attn_out_1
	layer8_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer8_attn_out_0 -> layer8_attn_ar
	layer8_attn_out_1 -> layer8_attn_ar
	layer8_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_attn_ar -> layer8_ffn_norm_0
	layer8_attn_ar -> layer8_ffn_norm_1
	layer8_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_norm_0 -> layer8_ffn_gate_0
	layer8_ffn_norm_1 -> layer8_ffn_gate_1
	layer8_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_norm_0 -> layer8_ffn_up_0
	layer8_ffn_norm_1 -> layer8_ffn_up_1
	layer8_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer8_ffn_gate_0 -> layer8_gate_ar
	layer8_ffn_gate_1 -> layer8_gate_ar
	layer8_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer8_ffn_up_0 -> layer8_up_ar
	layer8_ffn_up_1 -> layer8_up_ar
	layer8_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_gate_ar -> layer8_silu_0
	layer8_gate_ar -> layer8_silu_1
	layer8_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_silu_0 -> layer8_mul_0
	layer8_up_ar -> layer8_mul_0
	layer8_silu_1 -> layer8_mul_1
	layer8_up_ar -> layer8_mul_1
	layer8_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_mul_0 -> layer8_ffn_down_0
	layer8_mul_1 -> layer8_ffn_down_1
	layer8_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer8_ffn_down_0 -> layer8_ffn_ar
	layer8_ffn_down_1 -> layer8_ffn_ar
	layer9_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer8_ffn_ar -> layer9_norm_0
	layer8_ffn_ar -> layer9_norm_1
	layer9_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_norm_0 -> layer9_qkv_0
	layer9_norm_1 -> layer9_qkv_1
	layer9_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer9_qkv_0 -> layer9_qkv_ar
	layer9_qkv_1 -> layer9_qkv_ar
	layer9_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_qkv_ar -> layer9_attn_0
	layer9_qkv_ar -> layer9_attn_1
	layer9_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_attn_0 -> layer9_attn_out_0
	layer9_attn_1 -> layer9_attn_out_1
	layer9_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer9_attn_out_0 -> layer9_attn_ar
	layer9_attn_out_1 -> layer9_attn_ar
	layer9_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_attn_ar -> layer9_ffn_norm_0
	layer9_attn_ar -> layer9_ffn_norm_1
	layer9_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_norm_0 -> layer9_ffn_gate_0
	layer9_ffn_norm_1 -> layer9_ffn_gate_1
	layer9_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_norm_0 -> layer9_ffn_up_0
	layer9_ffn_norm_1 -> layer9_ffn_up_1
	layer9_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer9_ffn_gate_0 -> layer9_gate_ar
	layer9_ffn_gate_1 -> layer9_gate_ar
	layer9_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer9_ffn_up_0 -> layer9_up_ar
	layer9_ffn_up_1 -> layer9_up_ar
	layer9_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_gate_ar -> layer9_silu_0
	layer9_gate_ar -> layer9_silu_1
	layer9_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_silu_0 -> layer9_mul_0
	layer9_up_ar -> layer9_mul_0
	layer9_silu_1 -> layer9_mul_1
	layer9_up_ar -> layer9_mul_1
	layer9_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_mul_0 -> layer9_ffn_down_0
	layer9_mul_1 -> layer9_ffn_down_1
	layer9_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer9_ffn_down_0 -> layer9_ffn_ar
	layer9_ffn_down_1 -> layer9_ffn_ar
	layer10_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer9_ffn_ar -> layer10_norm_0
	layer9_ffn_ar -> layer10_norm_1
	layer10_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_norm_0 -> layer10_qkv_0
	layer10_norm_1 -> layer10_qkv_1
	layer10_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer10_qkv_0 -> layer10_qkv_ar
	layer10_qkv_1 -> layer10_qkv_ar
	layer10_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_qkv_ar -> layer10_attn_0
	layer10_qkv_ar -> layer10_attn_1
	layer10_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_attn_0 -> layer10_attn_out_0
	layer10_attn_1 -> layer10_attn_out_1
	layer10_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer10_attn_out_0 -> layer10_attn_ar
	layer10_attn_out_1 -> layer10_attn_ar
	layer10_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_attn_ar -> layer10_ffn_norm_0
	layer10_attn_ar -> layer10_ffn_norm_1
	layer10_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_norm_0 -> layer10_ffn_gate_0
	layer10_ffn_norm_1 -> layer10_ffn_gate_1
	layer10_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_norm_0 -> layer10_ffn_up_0
	layer10_ffn_norm_1 -> layer10_ffn_up_1
	layer10_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer10_ffn_gate_0 -> layer10_gate_ar
	layer10_ffn_gate_1 -> layer10_gate_ar
	layer10_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer10_ffn_up_0 -> layer10_up_ar
	layer10_ffn_up_1 -> layer10_up_ar
	layer10_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_gate_ar -> layer10_silu_0
	layer10_gate_ar -> layer10_silu_1
	layer10_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_silu_0 -> layer10_mul_0
	layer10_up_ar -> layer10_mul_0
	layer10_silu_1 -> layer10_mul_1
	layer10_up_ar -> layer10_mul_1
	layer10_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_mul_0 -> layer10_ffn_down_0
	layer10_mul_1 -> layer10_ffn_down_1
	layer10_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer10_ffn_down_0 -> layer10_ffn_ar
	layer10_ffn_down_1 -> layer10_ffn_ar
	layer11_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer10_ffn_ar -> layer11_norm_0
	layer10_ffn_ar -> layer11_norm_1
	layer11_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_norm_0 -> layer11_qkv_0
	layer11_norm_1 -> layer11_qkv_1
	layer11_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer11_qkv_0 -> layer11_qkv_ar
	layer11_qkv_1 -> layer11_qkv_ar
	layer11_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_qkv_ar -> layer11_attn_0
	layer11_qkv_ar -> layer11_attn_1
	layer11_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_attn_0 -> layer11_attn_out_0
	layer11_attn_1 -> layer11_attn_out_1
	layer11_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer11_attn_out_0 -> layer11_attn_ar
	layer11_attn_out_1 -> layer11_attn_ar
	layer11_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_attn_ar -> layer11_ffn_norm_0
	layer11_attn_ar -> layer11_ffn_norm_1
	layer11_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_norm_0 -> layer11_ffn_gate_0
	layer11_ffn_norm_1 -> layer11_ffn_gate_1
	layer11_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_norm_0 -> layer11_ffn_up_0
	layer11_ffn_norm_1 -> layer11_ffn_up_1
	layer11_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer11_ffn_gate_0 -> layer11_gate_ar
	layer11_ffn_gate_1 -> layer11_gate_ar
	layer11_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer11_ffn_up_0 -> layer11_up_ar
	layer11_ffn_up_1 -> layer11_up_ar
	layer11_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_gate_ar -> layer11_silu_0
	layer11_gate_ar -> layer11_silu_1
	layer11_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_silu_0 -> layer11_mul_0
	layer11_up_ar -> layer11_mul_0
	layer11_silu_1 -> layer11_mul_1
	layer11_up_ar -> layer11_mul_1
	layer11_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_mul_0 -> layer11_ffn_down_0
	layer11_mul_1 -> layer11_ffn_down_1
	layer11_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer11_ffn_down_0 -> layer11_ffn_ar
	layer11_ffn_down_1 -> layer11_ffn_ar
	layer12_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer11_ffn_ar -> layer12_norm_0
	layer11_ffn_ar -> layer12_norm_1
	layer12_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_norm_0 -> layer12_qkv_0
	layer12_norm_1 -> layer12_qkv_1
	layer12_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer12_qkv_0 -> layer12_qkv_ar
	layer12_qkv_1 -> layer12_qkv_ar
	layer12_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_qkv_ar -> layer12_attn_0
	layer12_qkv_ar -> layer12_attn_1
	layer12_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_attn_0 -> layer12_attn_out_0
	layer12_attn_1 -> layer12_attn_out_1
	layer12_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer12_attn_out_0 -> layer12_attn_ar
	layer12_attn_out_1 -> layer12_attn_ar
	layer12_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_attn_ar -> layer12_ffn_norm_0
	layer12_attn_ar -> layer12_ffn_norm_1
	layer12_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_norm_0 -> layer12_ffn_gate_0
	layer12_ffn_norm_1 -> layer12_ffn_gate_1
	layer12_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_norm_0 -> layer12_ffn_up_0
	layer12_ffn_norm_1 -> layer12_ffn_up_1
	layer12_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer12_ffn_gate_0 -> layer12_gate_ar
	layer12_ffn_gate_1 -> layer12_gate_ar
	layer12_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer12_ffn_up_0 -> layer12_up_ar
	layer12_ffn_up_1 -> layer12_up_ar
	layer12_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_gate_ar -> layer12_silu_0
	layer12_gate_ar -> layer12_silu_1
	layer12_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_silu_0 -> layer12_mul_0
	layer12_up_ar -> layer12_mul_0
	layer12_silu_1 -> layer12_mul_1
	layer12_up_ar -> layer12_mul_1
	layer12_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_mul_0 -> layer12_ffn_down_0
	layer12_mul_1 -> layer12_ffn_down_1
	layer12_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer12_ffn_down_0 -> layer12_ffn_ar
	layer12_ffn_down_1 -> layer12_ffn_ar
	layer13_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer12_ffn_ar -> layer13_norm_0
	layer12_ffn_ar -> layer13_norm_1
	layer13_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_norm_0 -> layer13_qkv_0
	layer13_norm_1 -> layer13_qkv_1
	layer13_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer13_qkv_0 -> layer13_qkv_ar
	layer13_qkv_1 -> layer13_qkv_ar
	layer13_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_qkv_ar -> layer13_attn_0
	layer13_qkv_ar -> layer13_attn_1
	layer13_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_attn_0 -> layer13_attn_out_0
	layer13_attn_1 -> layer13_attn_out_1
	layer13_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer13_attn_out_0 -> layer13_attn_ar
	layer13_attn_out_1 -> layer13_attn_ar
	layer13_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_attn_ar -> layer13_ffn_norm_0
	layer13_attn_ar -> layer13_ffn_norm_1
	layer13_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_norm_0 -> layer13_ffn_gate_0
	layer13_ffn_norm_1 -> layer13_ffn_gate_1
	layer13_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_norm_0 -> layer13_ffn_up_0
	layer13_ffn_norm_1 -> layer13_ffn_up_1
	layer13_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer13_ffn_gate_0 -> layer13_gate_ar
	layer13_ffn_gate_1 -> layer13_gate_ar
	layer13_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer13_ffn_up_0 -> layer13_up_ar
	layer13_ffn_up_1 -> layer13_up_ar
	layer13_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_gate_ar -> layer13_silu_0
	layer13_gate_ar -> layer13_silu_1
	layer13_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_silu_0 -> layer13_mul_0
	layer13_up_ar -> layer13_mul_0
	layer13_silu_1 -> layer13_mul_1
	layer13_up_ar -> layer13_mul_1
	layer13_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_mul_0 -> layer13_ffn_down_0
	layer13_mul_1 -> layer13_ffn_down_1
	layer13_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer13_ffn_down_0 -> layer13_ffn_ar
	layer13_ffn_down_1 -> layer13_ffn_ar
	layer14_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer13_ffn_ar -> layer14_norm_0
	layer13_ffn_ar -> layer14_norm_1
	layer14_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_norm_0 -> layer14_qkv_0
	layer14_norm_1 -> layer14_qkv_1
	layer14_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer14_qkv_0 -> layer14_qkv_ar
	layer14_qkv_1 -> layer14_qkv_ar
	layer14_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_qkv_ar -> layer14_attn_0
	layer14_qkv_ar -> layer14_attn_1
	layer14_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_attn_0 -> layer14_attn_out_0
	layer14_attn_1 -> layer14_attn_out_1
	layer14_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer14_attn_out_0 -> layer14_attn_ar
	layer14_attn_out_1 -> layer14_attn_ar
	layer14_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_attn_ar -> layer14_ffn_norm_0
	layer14_attn_ar -> layer14_ffn_norm_1
	layer14_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_norm_0 -> layer14_ffn_gate_0
	layer14_ffn_norm_1 -> layer14_ffn_gate_1
	layer14_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_norm_0 -> layer14_ffn_up_0
	layer14_ffn_norm_1 -> layer14_ffn_up_1
	layer14_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer14_ffn_gate_0 -> layer14_gate_ar
	layer14_ffn_gate_1 -> layer14_gate_ar
	layer14_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer14_ffn_up_0 -> layer14_up_ar
	layer14_ffn_up_1 -> layer14_up_ar
	layer14_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_gate_ar -> layer14_silu_0
	layer14_gate_ar -> layer14_silu_1
	layer14_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_silu_0 -> layer14_mul_0
	layer14_up_ar -> layer14_mul_0
	layer14_silu_1 -> layer14_mul_1
	layer14_up_ar -> layer14_mul_1
	layer14_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_mul_0 -> layer14_ffn_down_0
	layer14_mul_1 -> layer14_ffn_down_1
	layer14_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer14_ffn_down_0 -> layer14_ffn_ar
	layer14_ffn_down_1 -> layer14_ffn_ar
	layer15_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer14_ffn_ar -> layer15_norm_0
	layer14_ffn_ar -> layer15_norm_1
	layer15_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_norm_0 -> layer15_qkv_0
	layer15_norm_1 -> layer15_qkv_1
	layer15_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer15_qkv_0 -> layer15_qkv_ar
	layer15_qkv_1 -> layer15_qkv_ar
	layer15_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_qkv_ar -> layer15_attn_0
	layer15_qkv_ar -> layer15_attn_1
	layer15_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_attn_0 -> layer15_attn_out_0
	layer15_attn_1 -> layer15_attn_out_1
	layer15_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer15_attn_out_0 -> layer15_attn_ar
	layer15_attn_out_1 -> layer15_attn_ar
	layer15_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_attn_ar -> layer15_ffn_norm_0
	layer15_attn_ar -> layer15_ffn_norm_1
	layer15_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_norm_0 -> layer15_ffn_gate_0
	layer15_ffn_norm_1 -> layer15_ffn_gate_1
	layer15_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_norm_0 -> layer15_ffn_up_0
	layer15_ffn_norm_1 -> layer15_ffn_up_1
	layer15_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer15_ffn_gate_0 -> layer15_gate_ar
	layer15_ffn_gate_1 -> layer15_gate_ar
	layer15_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer15_ffn_up_0 -> layer15_up_ar
	layer15_ffn_up_1 -> layer15_up_ar
	layer15_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_gate_ar -> layer15_silu_0
	layer15_gate_ar -> layer15_silu_1
	layer15_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_silu_0 -> layer15_mul_0
	layer15_up_ar -> layer15_mul_0
	layer15_silu_1 -> layer15_mul_1
	layer15_up_ar -> layer15_mul_1
	layer15_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_mul_0 -> layer15_ffn_down_0
	layer15_mul_1 -> layer15_ffn_down_1
	layer15_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer15_ffn_down_0 -> layer15_ffn_ar
	layer15_ffn_down_1 -> layer15_ffn_ar
	layer16_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer15_ffn_ar -> layer16_norm_0
	layer15_ffn_ar -> layer16_norm_1
	layer16_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_norm_0 -> layer16_qkv_0
	layer16_norm_1 -> layer16_qkv_1
	layer16_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer16_qkv_0 -> layer16_qkv_ar
	layer16_qkv_1 -> layer16_qkv_ar
	layer16_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_qkv_ar -> layer16_attn_0
	layer16_qkv_ar -> layer16_attn_1
	layer16_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_attn_0 -> layer16_attn_out_0
	layer16_attn_1 -> layer16_attn_out_1
	layer16_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer16_attn_out_0 -> layer16_attn_ar
	layer16_attn_out_1 -> layer16_attn_ar
	layer16_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_attn_ar -> layer16_ffn_norm_0
	layer16_attn_ar -> layer16_ffn_norm_1
	layer16_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_norm_0 -> layer16_ffn_gate_0
	layer16_ffn_norm_1 -> layer16_ffn_gate_1
	layer16_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_norm_0 -> layer16_ffn_up_0
	layer16_ffn_norm_1 -> layer16_ffn_up_1
	layer16_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer16_ffn_gate_0 -> layer16_gate_ar
	layer16_ffn_gate_1 -> layer16_gate_ar
	layer16_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer16_ffn_up_0 -> layer16_up_ar
	layer16_ffn_up_1 -> layer16_up_ar
	layer16_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_gate_ar -> layer16_silu_0
	layer16_gate_ar -> layer16_silu_1
	layer16_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_silu_0 -> layer16_mul_0
	layer16_up_ar -> layer16_mul_0
	layer16_silu_1 -> layer16_mul_1
	layer16_up_ar -> layer16_mul_1
	layer16_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_mul_0 -> layer16_ffn_down_0
	layer16_mul_1 -> layer16_ffn_down_1
	layer16_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer16_ffn_down_0 -> layer16_ffn_ar
	layer16_ffn_down_1 -> layer16_ffn_ar
	layer17_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer16_ffn_ar -> layer17_norm_0
	layer16_ffn_ar -> layer17_norm_1
	layer17_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_norm_0 -> layer17_qkv_0
	layer17_norm_1 -> layer17_qkv_1
	layer17_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer17_qkv_0 -> layer17_qkv_ar
	layer17_qkv_1 -> layer17_qkv_ar
	layer17_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_qkv_ar -> layer17_attn_0
	layer17_qkv_ar -> layer17_attn_1
	layer17_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_attn_0 -> layer17_attn_out_0
	layer17_attn_1 -> layer17_attn_out_1
	layer17_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer17_attn_out_0 -> layer17_attn_ar
	layer17_attn_out_1 -> layer17_attn_ar
	layer17_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_attn_ar -> layer17_ffn_norm_0
	layer17_attn_ar -> layer17_ffn_norm_1
	layer17_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_norm_0 -> layer17_ffn_gate_0
	layer17_ffn_norm_1 -> layer17_ffn_gate_1
	layer17_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_norm_0 -> layer17_ffn_up_0
	layer17_ffn_norm_1 -> layer17_ffn_up_1
	layer17_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer17_ffn_gate_0 -> layer17_gate_ar
	layer17_ffn_gate_1 -> layer17_gate_ar
	layer17_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer17_ffn_up_0 -> layer17_up_ar
	layer17_ffn_up_1 -> layer17_up_ar
	layer17_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_gate_ar -> layer17_silu_0
	layer17_gate_ar -> layer17_silu_1
	layer17_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_silu_0 -> layer17_mul_0
	layer17_up_ar -> layer17_mul_0
	layer17_silu_1 -> layer17_mul_1
	layer17_up_ar -> layer17_mul_1
	layer17_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_mul_0 -> layer17_ffn_down_0
	layer17_mul_1 -> layer17_ffn_down_1
	layer17_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer17_ffn_down_0 -> layer17_ffn_ar
	layer17_ffn_down_1 -> layer17_ffn_ar
	layer18_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer17_ffn_ar -> layer18_norm_0
	layer17_ffn_ar -> layer18_norm_1
	layer18_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_norm_0 -> layer18_qkv_0
	layer18_norm_1 -> layer18_qkv_1
	layer18_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer18_qkv_0 -> layer18_qkv_ar
	layer18_qkv_1 -> layer18_qkv_ar
	layer18_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_qkv_ar -> layer18_attn_0
	layer18_qkv_ar -> layer18_attn_1
	layer18_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_attn_0 -> layer18_attn_out_0
	layer18_attn_1 -> layer18_attn_out_1
	layer18_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer18_attn_out_0 -> layer18_attn_ar
	layer18_attn_out_1 -> layer18_attn_ar
	layer18_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_attn_ar -> layer18_ffn_norm_0
	layer18_attn_ar -> layer18_ffn_norm_1
	layer18_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_norm_0 -> layer18_ffn_gate_0
	layer18_ffn_norm_1 -> layer18_ffn_gate_1
	layer18_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_norm_0 -> layer18_ffn_up_0
	layer18_ffn_norm_1 -> layer18_ffn_up_1
	layer18_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer18_ffn_gate_0 -> layer18_gate_ar
	layer18_ffn_gate_1 -> layer18_gate_ar
	layer18_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer18_ffn_up_0 -> layer18_up_ar
	layer18_ffn_up_1 -> layer18_up_ar
	layer18_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_gate_ar -> layer18_silu_0
	layer18_gate_ar -> layer18_silu_1
	layer18_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_silu_0 -> layer18_mul_0
	layer18_up_ar -> layer18_mul_0
	layer18_silu_1 -> layer18_mul_1
	layer18_up_ar -> layer18_mul_1
	layer18_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_mul_0 -> layer18_ffn_down_0
	layer18_mul_1 -> layer18_ffn_down_1
	layer18_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer18_ffn_down_0 -> layer18_ffn_ar
	layer18_ffn_down_1 -> layer18_ffn_ar
	layer19_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer18_ffn_ar -> layer19_norm_0
	layer18_ffn_ar -> layer19_norm_1
	layer19_qkv_0 [label="QKV Linear\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_qkv_1 [label="QKV Linear\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_norm_0 -> layer19_qkv_0
	layer19_norm_1 -> layer19_qkv_1
	layer19_qkv_ar [label="All-Reduce QKV\nGPU:[0,1]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer19_qkv_0 -> layer19_qkv_ar
	layer19_qkv_1 -> layer19_qkv_ar
	layer19_attn_0 [label="Self-Attention\nGPU:0\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_attn_1 [label="Self-Attention\nGPU:1\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_qkv_ar -> layer19_attn_0
	layer19_qkv_ar -> layer19_attn_1
	layer19_attn_out_0 [label="Attention Output Proj\nGPU:0\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_attn_out_1 [label="Attention Output Proj\nGPU:1\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_attn_0 -> layer19_attn_out_0
	layer19_attn_1 -> layer19_attn_out_1
	layer19_attn_ar [label="All-Reduce Attention\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer19_attn_out_0 -> layer19_attn_ar
	layer19_attn_out_1 -> layer19_attn_ar
	layer19_ffn_norm_0 [label="RMSNorm\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_ffn_norm_1 [label="RMSNorm\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_attn_ar -> layer19_ffn_norm_0
	layer19_attn_ar -> layer19_ffn_norm_1
	layer19_ffn_gate_0 [label="FFN Gate\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_ffn_gate_1 [label="FFN Gate\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_ffn_norm_0 -> layer19_ffn_gate_0
	layer19_ffn_norm_1 -> layer19_ffn_gate_1
	layer19_ffn_up_0 [label="FFN Up\nGPU:0\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_ffn_up_1 [label="FFN Up\nGPU:1\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_ffn_norm_0 -> layer19_ffn_up_0
	layer19_ffn_norm_1 -> layer19_ffn_up_1
	layer19_gate_ar [label="All-Reduce Gate\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer19_ffn_gate_0 -> layer19_gate_ar
	layer19_ffn_gate_1 -> layer19_gate_ar
	layer19_up_ar [label="All-Reduce Up\nGPU:[0,1]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer19_ffn_up_0 -> layer19_up_ar
	layer19_ffn_up_1 -> layer19_up_ar
	layer19_silu_0 [label="SiLU Activation\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_silu_1 [label="SiLU Activation\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_gate_ar -> layer19_silu_0
	layer19_gate_ar -> layer19_silu_1
	layer19_mul_0 [label="Element-wise Mul\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_mul_1 [label="Element-wise Mul\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_silu_0 -> layer19_mul_0
	layer19_up_ar -> layer19_mul_0
	layer19_silu_1 -> layer19_mul_1
	layer19_up_ar -> layer19_mul_1
	layer19_ffn_down_0 [label="FFN Down\nGPU:0\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_ffn_down_1 [label="FFN Down\nGPU:1\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
	layer19_mul_0 -> layer19_ffn_down_0
	layer19_mul_1 -> layer19_ffn_down_1
	layer19_ffn_ar [label="All-Reduce FFN\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer19_ffn_down_0 -> layer19_ffn_ar
	layer19_ffn_down_1 -> layer19_ffn_ar
	subgraph cluster_stage0 {
		bgcolor=lightgray label="Stage 0: GPUs [0,1]\nLayers 0-19" style=rounded
		split_stage0 [label="Input Split\n[batch_size=4, seq_len=2048, hidden=4096]" fillcolor=lightyellow shape=parallelogram]
		layer0_embed_0 [label="Embedding\nGPU:0\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
		layer0_embed_1 [label="Embedding\nGPU:1\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#FFE6E6" shape=rectangle]
		embed_ag_stage0 [label="All-Gather Embedding\nGPU:[0,1]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
		layer0_embed_0 -> embed_ag_stage0
		layer0_embed_1 -> embed_ag_stage0
	}
	pp_send_0_1 [label="Pipeline Send\nStage 01\nGPU:[1][2]" fillcolor=lightcoral shape=ellipse]
	layer19_ffn_ar -> pp_send_0_1
	pp_send_0_1 -> split_stage1
	split_stage1 -> layer20_embed_2
	split_stage1 -> layer20_embed_3
	layer20_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	embed_ag_stage1 -> layer20_norm_2
	embed_ag_stage1 -> layer20_norm_3
	layer20_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_norm_2 -> layer20_qkv_2
	layer20_norm_3 -> layer20_qkv_3
	layer20_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer20_qkv_2 -> layer20_qkv_ar
	layer20_qkv_3 -> layer20_qkv_ar
	layer20_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_qkv_ar -> layer20_attn_2
	layer20_qkv_ar -> layer20_attn_3
	layer20_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_attn_2 -> layer20_attn_out_2
	layer20_attn_3 -> layer20_attn_out_3
	layer20_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer20_attn_out_2 -> layer20_attn_ar
	layer20_attn_out_3 -> layer20_attn_ar
	layer20_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_attn_ar -> layer20_ffn_norm_2
	layer20_attn_ar -> layer20_ffn_norm_3
	layer20_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_norm_2 -> layer20_ffn_gate_2
	layer20_ffn_norm_3 -> layer20_ffn_gate_3
	layer20_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_norm_2 -> layer20_ffn_up_2
	layer20_ffn_norm_3 -> layer20_ffn_up_3
	layer20_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer20_ffn_gate_2 -> layer20_gate_ar
	layer20_ffn_gate_3 -> layer20_gate_ar
	layer20_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer20_ffn_up_2 -> layer20_up_ar
	layer20_ffn_up_3 -> layer20_up_ar
	layer20_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_gate_ar -> layer20_silu_2
	layer20_gate_ar -> layer20_silu_3
	layer20_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_silu_2 -> layer20_mul_2
	layer20_up_ar -> layer20_mul_2
	layer20_silu_3 -> layer20_mul_3
	layer20_up_ar -> layer20_mul_3
	layer20_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_mul_2 -> layer20_ffn_down_2
	layer20_mul_3 -> layer20_ffn_down_3
	layer20_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer20_ffn_down_2 -> layer20_ffn_ar
	layer20_ffn_down_3 -> layer20_ffn_ar
	layer21_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer20_ffn_ar -> layer21_norm_2
	layer20_ffn_ar -> layer21_norm_3
	layer21_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_norm_2 -> layer21_qkv_2
	layer21_norm_3 -> layer21_qkv_3
	layer21_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer21_qkv_2 -> layer21_qkv_ar
	layer21_qkv_3 -> layer21_qkv_ar
	layer21_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_qkv_ar -> layer21_attn_2
	layer21_qkv_ar -> layer21_attn_3
	layer21_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_attn_2 -> layer21_attn_out_2
	layer21_attn_3 -> layer21_attn_out_3
	layer21_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer21_attn_out_2 -> layer21_attn_ar
	layer21_attn_out_3 -> layer21_attn_ar
	layer21_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_attn_ar -> layer21_ffn_norm_2
	layer21_attn_ar -> layer21_ffn_norm_3
	layer21_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_norm_2 -> layer21_ffn_gate_2
	layer21_ffn_norm_3 -> layer21_ffn_gate_3
	layer21_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_norm_2 -> layer21_ffn_up_2
	layer21_ffn_norm_3 -> layer21_ffn_up_3
	layer21_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer21_ffn_gate_2 -> layer21_gate_ar
	layer21_ffn_gate_3 -> layer21_gate_ar
	layer21_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer21_ffn_up_2 -> layer21_up_ar
	layer21_ffn_up_3 -> layer21_up_ar
	layer21_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_gate_ar -> layer21_silu_2
	layer21_gate_ar -> layer21_silu_3
	layer21_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_silu_2 -> layer21_mul_2
	layer21_up_ar -> layer21_mul_2
	layer21_silu_3 -> layer21_mul_3
	layer21_up_ar -> layer21_mul_3
	layer21_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_mul_2 -> layer21_ffn_down_2
	layer21_mul_3 -> layer21_ffn_down_3
	layer21_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer21_ffn_down_2 -> layer21_ffn_ar
	layer21_ffn_down_3 -> layer21_ffn_ar
	layer22_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer21_ffn_ar -> layer22_norm_2
	layer21_ffn_ar -> layer22_norm_3
	layer22_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_norm_2 -> layer22_qkv_2
	layer22_norm_3 -> layer22_qkv_3
	layer22_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer22_qkv_2 -> layer22_qkv_ar
	layer22_qkv_3 -> layer22_qkv_ar
	layer22_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_qkv_ar -> layer22_attn_2
	layer22_qkv_ar -> layer22_attn_3
	layer22_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_attn_2 -> layer22_attn_out_2
	layer22_attn_3 -> layer22_attn_out_3
	layer22_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer22_attn_out_2 -> layer22_attn_ar
	layer22_attn_out_3 -> layer22_attn_ar
	layer22_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_attn_ar -> layer22_ffn_norm_2
	layer22_attn_ar -> layer22_ffn_norm_3
	layer22_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_norm_2 -> layer22_ffn_gate_2
	layer22_ffn_norm_3 -> layer22_ffn_gate_3
	layer22_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_norm_2 -> layer22_ffn_up_2
	layer22_ffn_norm_3 -> layer22_ffn_up_3
	layer22_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer22_ffn_gate_2 -> layer22_gate_ar
	layer22_ffn_gate_3 -> layer22_gate_ar
	layer22_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer22_ffn_up_2 -> layer22_up_ar
	layer22_ffn_up_3 -> layer22_up_ar
	layer22_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_gate_ar -> layer22_silu_2
	layer22_gate_ar -> layer22_silu_3
	layer22_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_silu_2 -> layer22_mul_2
	layer22_up_ar -> layer22_mul_2
	layer22_silu_3 -> layer22_mul_3
	layer22_up_ar -> layer22_mul_3
	layer22_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_mul_2 -> layer22_ffn_down_2
	layer22_mul_3 -> layer22_ffn_down_3
	layer22_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer22_ffn_down_2 -> layer22_ffn_ar
	layer22_ffn_down_3 -> layer22_ffn_ar
	layer23_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer22_ffn_ar -> layer23_norm_2
	layer22_ffn_ar -> layer23_norm_3
	layer23_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_norm_2 -> layer23_qkv_2
	layer23_norm_3 -> layer23_qkv_3
	layer23_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer23_qkv_2 -> layer23_qkv_ar
	layer23_qkv_3 -> layer23_qkv_ar
	layer23_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_qkv_ar -> layer23_attn_2
	layer23_qkv_ar -> layer23_attn_3
	layer23_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_attn_2 -> layer23_attn_out_2
	layer23_attn_3 -> layer23_attn_out_3
	layer23_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer23_attn_out_2 -> layer23_attn_ar
	layer23_attn_out_3 -> layer23_attn_ar
	layer23_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_attn_ar -> layer23_ffn_norm_2
	layer23_attn_ar -> layer23_ffn_norm_3
	layer23_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_norm_2 -> layer23_ffn_gate_2
	layer23_ffn_norm_3 -> layer23_ffn_gate_3
	layer23_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_norm_2 -> layer23_ffn_up_2
	layer23_ffn_norm_3 -> layer23_ffn_up_3
	layer23_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer23_ffn_gate_2 -> layer23_gate_ar
	layer23_ffn_gate_3 -> layer23_gate_ar
	layer23_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer23_ffn_up_2 -> layer23_up_ar
	layer23_ffn_up_3 -> layer23_up_ar
	layer23_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_gate_ar -> layer23_silu_2
	layer23_gate_ar -> layer23_silu_3
	layer23_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_silu_2 -> layer23_mul_2
	layer23_up_ar -> layer23_mul_2
	layer23_silu_3 -> layer23_mul_3
	layer23_up_ar -> layer23_mul_3
	layer23_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_mul_2 -> layer23_ffn_down_2
	layer23_mul_3 -> layer23_ffn_down_3
	layer23_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer23_ffn_down_2 -> layer23_ffn_ar
	layer23_ffn_down_3 -> layer23_ffn_ar
	layer24_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer23_ffn_ar -> layer24_norm_2
	layer23_ffn_ar -> layer24_norm_3
	layer24_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_norm_2 -> layer24_qkv_2
	layer24_norm_3 -> layer24_qkv_3
	layer24_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer24_qkv_2 -> layer24_qkv_ar
	layer24_qkv_3 -> layer24_qkv_ar
	layer24_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_qkv_ar -> layer24_attn_2
	layer24_qkv_ar -> layer24_attn_3
	layer24_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_attn_2 -> layer24_attn_out_2
	layer24_attn_3 -> layer24_attn_out_3
	layer24_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer24_attn_out_2 -> layer24_attn_ar
	layer24_attn_out_3 -> layer24_attn_ar
	layer24_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_attn_ar -> layer24_ffn_norm_2
	layer24_attn_ar -> layer24_ffn_norm_3
	layer24_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_norm_2 -> layer24_ffn_gate_2
	layer24_ffn_norm_3 -> layer24_ffn_gate_3
	layer24_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_norm_2 -> layer24_ffn_up_2
	layer24_ffn_norm_3 -> layer24_ffn_up_3
	layer24_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer24_ffn_gate_2 -> layer24_gate_ar
	layer24_ffn_gate_3 -> layer24_gate_ar
	layer24_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer24_ffn_up_2 -> layer24_up_ar
	layer24_ffn_up_3 -> layer24_up_ar
	layer24_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_gate_ar -> layer24_silu_2
	layer24_gate_ar -> layer24_silu_3
	layer24_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_silu_2 -> layer24_mul_2
	layer24_up_ar -> layer24_mul_2
	layer24_silu_3 -> layer24_mul_3
	layer24_up_ar -> layer24_mul_3
	layer24_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_mul_2 -> layer24_ffn_down_2
	layer24_mul_3 -> layer24_ffn_down_3
	layer24_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer24_ffn_down_2 -> layer24_ffn_ar
	layer24_ffn_down_3 -> layer24_ffn_ar
	layer25_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer24_ffn_ar -> layer25_norm_2
	layer24_ffn_ar -> layer25_norm_3
	layer25_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_norm_2 -> layer25_qkv_2
	layer25_norm_3 -> layer25_qkv_3
	layer25_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer25_qkv_2 -> layer25_qkv_ar
	layer25_qkv_3 -> layer25_qkv_ar
	layer25_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_qkv_ar -> layer25_attn_2
	layer25_qkv_ar -> layer25_attn_3
	layer25_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_attn_2 -> layer25_attn_out_2
	layer25_attn_3 -> layer25_attn_out_3
	layer25_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer25_attn_out_2 -> layer25_attn_ar
	layer25_attn_out_3 -> layer25_attn_ar
	layer25_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_attn_ar -> layer25_ffn_norm_2
	layer25_attn_ar -> layer25_ffn_norm_3
	layer25_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_norm_2 -> layer25_ffn_gate_2
	layer25_ffn_norm_3 -> layer25_ffn_gate_3
	layer25_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_norm_2 -> layer25_ffn_up_2
	layer25_ffn_norm_3 -> layer25_ffn_up_3
	layer25_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer25_ffn_gate_2 -> layer25_gate_ar
	layer25_ffn_gate_3 -> layer25_gate_ar
	layer25_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer25_ffn_up_2 -> layer25_up_ar
	layer25_ffn_up_3 -> layer25_up_ar
	layer25_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_gate_ar -> layer25_silu_2
	layer25_gate_ar -> layer25_silu_3
	layer25_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_silu_2 -> layer25_mul_2
	layer25_up_ar -> layer25_mul_2
	layer25_silu_3 -> layer25_mul_3
	layer25_up_ar -> layer25_mul_3
	layer25_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_mul_2 -> layer25_ffn_down_2
	layer25_mul_3 -> layer25_ffn_down_3
	layer25_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer25_ffn_down_2 -> layer25_ffn_ar
	layer25_ffn_down_3 -> layer25_ffn_ar
	layer26_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer25_ffn_ar -> layer26_norm_2
	layer25_ffn_ar -> layer26_norm_3
	layer26_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_norm_2 -> layer26_qkv_2
	layer26_norm_3 -> layer26_qkv_3
	layer26_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer26_qkv_2 -> layer26_qkv_ar
	layer26_qkv_3 -> layer26_qkv_ar
	layer26_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_qkv_ar -> layer26_attn_2
	layer26_qkv_ar -> layer26_attn_3
	layer26_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_attn_2 -> layer26_attn_out_2
	layer26_attn_3 -> layer26_attn_out_3
	layer26_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer26_attn_out_2 -> layer26_attn_ar
	layer26_attn_out_3 -> layer26_attn_ar
	layer26_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_attn_ar -> layer26_ffn_norm_2
	layer26_attn_ar -> layer26_ffn_norm_3
	layer26_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_norm_2 -> layer26_ffn_gate_2
	layer26_ffn_norm_3 -> layer26_ffn_gate_3
	layer26_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_norm_2 -> layer26_ffn_up_2
	layer26_ffn_norm_3 -> layer26_ffn_up_3
	layer26_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer26_ffn_gate_2 -> layer26_gate_ar
	layer26_ffn_gate_3 -> layer26_gate_ar
	layer26_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer26_ffn_up_2 -> layer26_up_ar
	layer26_ffn_up_3 -> layer26_up_ar
	layer26_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_gate_ar -> layer26_silu_2
	layer26_gate_ar -> layer26_silu_3
	layer26_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_silu_2 -> layer26_mul_2
	layer26_up_ar -> layer26_mul_2
	layer26_silu_3 -> layer26_mul_3
	layer26_up_ar -> layer26_mul_3
	layer26_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_mul_2 -> layer26_ffn_down_2
	layer26_mul_3 -> layer26_ffn_down_3
	layer26_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer26_ffn_down_2 -> layer26_ffn_ar
	layer26_ffn_down_3 -> layer26_ffn_ar
	layer27_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer26_ffn_ar -> layer27_norm_2
	layer26_ffn_ar -> layer27_norm_3
	layer27_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_norm_2 -> layer27_qkv_2
	layer27_norm_3 -> layer27_qkv_3
	layer27_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer27_qkv_2 -> layer27_qkv_ar
	layer27_qkv_3 -> layer27_qkv_ar
	layer27_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_qkv_ar -> layer27_attn_2
	layer27_qkv_ar -> layer27_attn_3
	layer27_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_attn_2 -> layer27_attn_out_2
	layer27_attn_3 -> layer27_attn_out_3
	layer27_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer27_attn_out_2 -> layer27_attn_ar
	layer27_attn_out_3 -> layer27_attn_ar
	layer27_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_attn_ar -> layer27_ffn_norm_2
	layer27_attn_ar -> layer27_ffn_norm_3
	layer27_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_norm_2 -> layer27_ffn_gate_2
	layer27_ffn_norm_3 -> layer27_ffn_gate_3
	layer27_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_norm_2 -> layer27_ffn_up_2
	layer27_ffn_norm_3 -> layer27_ffn_up_3
	layer27_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer27_ffn_gate_2 -> layer27_gate_ar
	layer27_ffn_gate_3 -> layer27_gate_ar
	layer27_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer27_ffn_up_2 -> layer27_up_ar
	layer27_ffn_up_3 -> layer27_up_ar
	layer27_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_gate_ar -> layer27_silu_2
	layer27_gate_ar -> layer27_silu_3
	layer27_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_silu_2 -> layer27_mul_2
	layer27_up_ar -> layer27_mul_2
	layer27_silu_3 -> layer27_mul_3
	layer27_up_ar -> layer27_mul_3
	layer27_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_mul_2 -> layer27_ffn_down_2
	layer27_mul_3 -> layer27_ffn_down_3
	layer27_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer27_ffn_down_2 -> layer27_ffn_ar
	layer27_ffn_down_3 -> layer27_ffn_ar
	layer28_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer27_ffn_ar -> layer28_norm_2
	layer27_ffn_ar -> layer28_norm_3
	layer28_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_norm_2 -> layer28_qkv_2
	layer28_norm_3 -> layer28_qkv_3
	layer28_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer28_qkv_2 -> layer28_qkv_ar
	layer28_qkv_3 -> layer28_qkv_ar
	layer28_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_qkv_ar -> layer28_attn_2
	layer28_qkv_ar -> layer28_attn_3
	layer28_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_attn_2 -> layer28_attn_out_2
	layer28_attn_3 -> layer28_attn_out_3
	layer28_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer28_attn_out_2 -> layer28_attn_ar
	layer28_attn_out_3 -> layer28_attn_ar
	layer28_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_attn_ar -> layer28_ffn_norm_2
	layer28_attn_ar -> layer28_ffn_norm_3
	layer28_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_norm_2 -> layer28_ffn_gate_2
	layer28_ffn_norm_3 -> layer28_ffn_gate_3
	layer28_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_norm_2 -> layer28_ffn_up_2
	layer28_ffn_norm_3 -> layer28_ffn_up_3
	layer28_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer28_ffn_gate_2 -> layer28_gate_ar
	layer28_ffn_gate_3 -> layer28_gate_ar
	layer28_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer28_ffn_up_2 -> layer28_up_ar
	layer28_ffn_up_3 -> layer28_up_ar
	layer28_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_gate_ar -> layer28_silu_2
	layer28_gate_ar -> layer28_silu_3
	layer28_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_silu_2 -> layer28_mul_2
	layer28_up_ar -> layer28_mul_2
	layer28_silu_3 -> layer28_mul_3
	layer28_up_ar -> layer28_mul_3
	layer28_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_mul_2 -> layer28_ffn_down_2
	layer28_mul_3 -> layer28_ffn_down_3
	layer28_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer28_ffn_down_2 -> layer28_ffn_ar
	layer28_ffn_down_3 -> layer28_ffn_ar
	layer29_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer28_ffn_ar -> layer29_norm_2
	layer28_ffn_ar -> layer29_norm_3
	layer29_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_norm_2 -> layer29_qkv_2
	layer29_norm_3 -> layer29_qkv_3
	layer29_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer29_qkv_2 -> layer29_qkv_ar
	layer29_qkv_3 -> layer29_qkv_ar
	layer29_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_qkv_ar -> layer29_attn_2
	layer29_qkv_ar -> layer29_attn_3
	layer29_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_attn_2 -> layer29_attn_out_2
	layer29_attn_3 -> layer29_attn_out_3
	layer29_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer29_attn_out_2 -> layer29_attn_ar
	layer29_attn_out_3 -> layer29_attn_ar
	layer29_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_attn_ar -> layer29_ffn_norm_2
	layer29_attn_ar -> layer29_ffn_norm_3
	layer29_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_norm_2 -> layer29_ffn_gate_2
	layer29_ffn_norm_3 -> layer29_ffn_gate_3
	layer29_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_norm_2 -> layer29_ffn_up_2
	layer29_ffn_norm_3 -> layer29_ffn_up_3
	layer29_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer29_ffn_gate_2 -> layer29_gate_ar
	layer29_ffn_gate_3 -> layer29_gate_ar
	layer29_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer29_ffn_up_2 -> layer29_up_ar
	layer29_ffn_up_3 -> layer29_up_ar
	layer29_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_gate_ar -> layer29_silu_2
	layer29_gate_ar -> layer29_silu_3
	layer29_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_silu_2 -> layer29_mul_2
	layer29_up_ar -> layer29_mul_2
	layer29_silu_3 -> layer29_mul_3
	layer29_up_ar -> layer29_mul_3
	layer29_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_mul_2 -> layer29_ffn_down_2
	layer29_mul_3 -> layer29_ffn_down_3
	layer29_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer29_ffn_down_2 -> layer29_ffn_ar
	layer29_ffn_down_3 -> layer29_ffn_ar
	layer30_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer29_ffn_ar -> layer30_norm_2
	layer29_ffn_ar -> layer30_norm_3
	layer30_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_norm_2 -> layer30_qkv_2
	layer30_norm_3 -> layer30_qkv_3
	layer30_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer30_qkv_2 -> layer30_qkv_ar
	layer30_qkv_3 -> layer30_qkv_ar
	layer30_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_qkv_ar -> layer30_attn_2
	layer30_qkv_ar -> layer30_attn_3
	layer30_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_attn_2 -> layer30_attn_out_2
	layer30_attn_3 -> layer30_attn_out_3
	layer30_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer30_attn_out_2 -> layer30_attn_ar
	layer30_attn_out_3 -> layer30_attn_ar
	layer30_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_attn_ar -> layer30_ffn_norm_2
	layer30_attn_ar -> layer30_ffn_norm_3
	layer30_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_norm_2 -> layer30_ffn_gate_2
	layer30_ffn_norm_3 -> layer30_ffn_gate_3
	layer30_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_norm_2 -> layer30_ffn_up_2
	layer30_ffn_norm_3 -> layer30_ffn_up_3
	layer30_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer30_ffn_gate_2 -> layer30_gate_ar
	layer30_ffn_gate_3 -> layer30_gate_ar
	layer30_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer30_ffn_up_2 -> layer30_up_ar
	layer30_ffn_up_3 -> layer30_up_ar
	layer30_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_gate_ar -> layer30_silu_2
	layer30_gate_ar -> layer30_silu_3
	layer30_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_silu_2 -> layer30_mul_2
	layer30_up_ar -> layer30_mul_2
	layer30_silu_3 -> layer30_mul_3
	layer30_up_ar -> layer30_mul_3
	layer30_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_mul_2 -> layer30_ffn_down_2
	layer30_mul_3 -> layer30_ffn_down_3
	layer30_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer30_ffn_down_2 -> layer30_ffn_ar
	layer30_ffn_down_3 -> layer30_ffn_ar
	layer31_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer30_ffn_ar -> layer31_norm_2
	layer30_ffn_ar -> layer31_norm_3
	layer31_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_norm_2 -> layer31_qkv_2
	layer31_norm_3 -> layer31_qkv_3
	layer31_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer31_qkv_2 -> layer31_qkv_ar
	layer31_qkv_3 -> layer31_qkv_ar
	layer31_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_qkv_ar -> layer31_attn_2
	layer31_qkv_ar -> layer31_attn_3
	layer31_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_attn_2 -> layer31_attn_out_2
	layer31_attn_3 -> layer31_attn_out_3
	layer31_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer31_attn_out_2 -> layer31_attn_ar
	layer31_attn_out_3 -> layer31_attn_ar
	layer31_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_attn_ar -> layer31_ffn_norm_2
	layer31_attn_ar -> layer31_ffn_norm_3
	layer31_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_norm_2 -> layer31_ffn_gate_2
	layer31_ffn_norm_3 -> layer31_ffn_gate_3
	layer31_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_norm_2 -> layer31_ffn_up_2
	layer31_ffn_norm_3 -> layer31_ffn_up_3
	layer31_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer31_ffn_gate_2 -> layer31_gate_ar
	layer31_ffn_gate_3 -> layer31_gate_ar
	layer31_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer31_ffn_up_2 -> layer31_up_ar
	layer31_ffn_up_3 -> layer31_up_ar
	layer31_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_gate_ar -> layer31_silu_2
	layer31_gate_ar -> layer31_silu_3
	layer31_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_silu_2 -> layer31_mul_2
	layer31_up_ar -> layer31_mul_2
	layer31_silu_3 -> layer31_mul_3
	layer31_up_ar -> layer31_mul_3
	layer31_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_mul_2 -> layer31_ffn_down_2
	layer31_mul_3 -> layer31_ffn_down_3
	layer31_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer31_ffn_down_2 -> layer31_ffn_ar
	layer31_ffn_down_3 -> layer31_ffn_ar
	layer32_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer31_ffn_ar -> layer32_norm_2
	layer31_ffn_ar -> layer32_norm_3
	layer32_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_norm_2 -> layer32_qkv_2
	layer32_norm_3 -> layer32_qkv_3
	layer32_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer32_qkv_2 -> layer32_qkv_ar
	layer32_qkv_3 -> layer32_qkv_ar
	layer32_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_qkv_ar -> layer32_attn_2
	layer32_qkv_ar -> layer32_attn_3
	layer32_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_attn_2 -> layer32_attn_out_2
	layer32_attn_3 -> layer32_attn_out_3
	layer32_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer32_attn_out_2 -> layer32_attn_ar
	layer32_attn_out_3 -> layer32_attn_ar
	layer32_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_attn_ar -> layer32_ffn_norm_2
	layer32_attn_ar -> layer32_ffn_norm_3
	layer32_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_norm_2 -> layer32_ffn_gate_2
	layer32_ffn_norm_3 -> layer32_ffn_gate_3
	layer32_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_norm_2 -> layer32_ffn_up_2
	layer32_ffn_norm_3 -> layer32_ffn_up_3
	layer32_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer32_ffn_gate_2 -> layer32_gate_ar
	layer32_ffn_gate_3 -> layer32_gate_ar
	layer32_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer32_ffn_up_2 -> layer32_up_ar
	layer32_ffn_up_3 -> layer32_up_ar
	layer32_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_gate_ar -> layer32_silu_2
	layer32_gate_ar -> layer32_silu_3
	layer32_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_silu_2 -> layer32_mul_2
	layer32_up_ar -> layer32_mul_2
	layer32_silu_3 -> layer32_mul_3
	layer32_up_ar -> layer32_mul_3
	layer32_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_mul_2 -> layer32_ffn_down_2
	layer32_mul_3 -> layer32_ffn_down_3
	layer32_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer32_ffn_down_2 -> layer32_ffn_ar
	layer32_ffn_down_3 -> layer32_ffn_ar
	layer33_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer32_ffn_ar -> layer33_norm_2
	layer32_ffn_ar -> layer33_norm_3
	layer33_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_norm_2 -> layer33_qkv_2
	layer33_norm_3 -> layer33_qkv_3
	layer33_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer33_qkv_2 -> layer33_qkv_ar
	layer33_qkv_3 -> layer33_qkv_ar
	layer33_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_qkv_ar -> layer33_attn_2
	layer33_qkv_ar -> layer33_attn_3
	layer33_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_attn_2 -> layer33_attn_out_2
	layer33_attn_3 -> layer33_attn_out_3
	layer33_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer33_attn_out_2 -> layer33_attn_ar
	layer33_attn_out_3 -> layer33_attn_ar
	layer33_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_attn_ar -> layer33_ffn_norm_2
	layer33_attn_ar -> layer33_ffn_norm_3
	layer33_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_norm_2 -> layer33_ffn_gate_2
	layer33_ffn_norm_3 -> layer33_ffn_gate_3
	layer33_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_norm_2 -> layer33_ffn_up_2
	layer33_ffn_norm_3 -> layer33_ffn_up_3
	layer33_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer33_ffn_gate_2 -> layer33_gate_ar
	layer33_ffn_gate_3 -> layer33_gate_ar
	layer33_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer33_ffn_up_2 -> layer33_up_ar
	layer33_ffn_up_3 -> layer33_up_ar
	layer33_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_gate_ar -> layer33_silu_2
	layer33_gate_ar -> layer33_silu_3
	layer33_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_silu_2 -> layer33_mul_2
	layer33_up_ar -> layer33_mul_2
	layer33_silu_3 -> layer33_mul_3
	layer33_up_ar -> layer33_mul_3
	layer33_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_mul_2 -> layer33_ffn_down_2
	layer33_mul_3 -> layer33_ffn_down_3
	layer33_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer33_ffn_down_2 -> layer33_ffn_ar
	layer33_ffn_down_3 -> layer33_ffn_ar
	layer34_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer33_ffn_ar -> layer34_norm_2
	layer33_ffn_ar -> layer34_norm_3
	layer34_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_norm_2 -> layer34_qkv_2
	layer34_norm_3 -> layer34_qkv_3
	layer34_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer34_qkv_2 -> layer34_qkv_ar
	layer34_qkv_3 -> layer34_qkv_ar
	layer34_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_qkv_ar -> layer34_attn_2
	layer34_qkv_ar -> layer34_attn_3
	layer34_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_attn_2 -> layer34_attn_out_2
	layer34_attn_3 -> layer34_attn_out_3
	layer34_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer34_attn_out_2 -> layer34_attn_ar
	layer34_attn_out_3 -> layer34_attn_ar
	layer34_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_attn_ar -> layer34_ffn_norm_2
	layer34_attn_ar -> layer34_ffn_norm_3
	layer34_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_norm_2 -> layer34_ffn_gate_2
	layer34_ffn_norm_3 -> layer34_ffn_gate_3
	layer34_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_norm_2 -> layer34_ffn_up_2
	layer34_ffn_norm_3 -> layer34_ffn_up_3
	layer34_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer34_ffn_gate_2 -> layer34_gate_ar
	layer34_ffn_gate_3 -> layer34_gate_ar
	layer34_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer34_ffn_up_2 -> layer34_up_ar
	layer34_ffn_up_3 -> layer34_up_ar
	layer34_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_gate_ar -> layer34_silu_2
	layer34_gate_ar -> layer34_silu_3
	layer34_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_silu_2 -> layer34_mul_2
	layer34_up_ar -> layer34_mul_2
	layer34_silu_3 -> layer34_mul_3
	layer34_up_ar -> layer34_mul_3
	layer34_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_mul_2 -> layer34_ffn_down_2
	layer34_mul_3 -> layer34_ffn_down_3
	layer34_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer34_ffn_down_2 -> layer34_ffn_ar
	layer34_ffn_down_3 -> layer34_ffn_ar
	layer35_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer34_ffn_ar -> layer35_norm_2
	layer34_ffn_ar -> layer35_norm_3
	layer35_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_norm_2 -> layer35_qkv_2
	layer35_norm_3 -> layer35_qkv_3
	layer35_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer35_qkv_2 -> layer35_qkv_ar
	layer35_qkv_3 -> layer35_qkv_ar
	layer35_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_qkv_ar -> layer35_attn_2
	layer35_qkv_ar -> layer35_attn_3
	layer35_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_attn_2 -> layer35_attn_out_2
	layer35_attn_3 -> layer35_attn_out_3
	layer35_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer35_attn_out_2 -> layer35_attn_ar
	layer35_attn_out_3 -> layer35_attn_ar
	layer35_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_attn_ar -> layer35_ffn_norm_2
	layer35_attn_ar -> layer35_ffn_norm_3
	layer35_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_norm_2 -> layer35_ffn_gate_2
	layer35_ffn_norm_3 -> layer35_ffn_gate_3
	layer35_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_norm_2 -> layer35_ffn_up_2
	layer35_ffn_norm_3 -> layer35_ffn_up_3
	layer35_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer35_ffn_gate_2 -> layer35_gate_ar
	layer35_ffn_gate_3 -> layer35_gate_ar
	layer35_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer35_ffn_up_2 -> layer35_up_ar
	layer35_ffn_up_3 -> layer35_up_ar
	layer35_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_gate_ar -> layer35_silu_2
	layer35_gate_ar -> layer35_silu_3
	layer35_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_silu_2 -> layer35_mul_2
	layer35_up_ar -> layer35_mul_2
	layer35_silu_3 -> layer35_mul_3
	layer35_up_ar -> layer35_mul_3
	layer35_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_mul_2 -> layer35_ffn_down_2
	layer35_mul_3 -> layer35_ffn_down_3
	layer35_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer35_ffn_down_2 -> layer35_ffn_ar
	layer35_ffn_down_3 -> layer35_ffn_ar
	layer36_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer35_ffn_ar -> layer36_norm_2
	layer35_ffn_ar -> layer36_norm_3
	layer36_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_norm_2 -> layer36_qkv_2
	layer36_norm_3 -> layer36_qkv_3
	layer36_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer36_qkv_2 -> layer36_qkv_ar
	layer36_qkv_3 -> layer36_qkv_ar
	layer36_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_qkv_ar -> layer36_attn_2
	layer36_qkv_ar -> layer36_attn_3
	layer36_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_attn_2 -> layer36_attn_out_2
	layer36_attn_3 -> layer36_attn_out_3
	layer36_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer36_attn_out_2 -> layer36_attn_ar
	layer36_attn_out_3 -> layer36_attn_ar
	layer36_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_attn_ar -> layer36_ffn_norm_2
	layer36_attn_ar -> layer36_ffn_norm_3
	layer36_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_norm_2 -> layer36_ffn_gate_2
	layer36_ffn_norm_3 -> layer36_ffn_gate_3
	layer36_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_norm_2 -> layer36_ffn_up_2
	layer36_ffn_norm_3 -> layer36_ffn_up_3
	layer36_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer36_ffn_gate_2 -> layer36_gate_ar
	layer36_ffn_gate_3 -> layer36_gate_ar
	layer36_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer36_ffn_up_2 -> layer36_up_ar
	layer36_ffn_up_3 -> layer36_up_ar
	layer36_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_gate_ar -> layer36_silu_2
	layer36_gate_ar -> layer36_silu_3
	layer36_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_silu_2 -> layer36_mul_2
	layer36_up_ar -> layer36_mul_2
	layer36_silu_3 -> layer36_mul_3
	layer36_up_ar -> layer36_mul_3
	layer36_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_mul_2 -> layer36_ffn_down_2
	layer36_mul_3 -> layer36_ffn_down_3
	layer36_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer36_ffn_down_2 -> layer36_ffn_ar
	layer36_ffn_down_3 -> layer36_ffn_ar
	layer37_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer36_ffn_ar -> layer37_norm_2
	layer36_ffn_ar -> layer37_norm_3
	layer37_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_norm_2 -> layer37_qkv_2
	layer37_norm_3 -> layer37_qkv_3
	layer37_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer37_qkv_2 -> layer37_qkv_ar
	layer37_qkv_3 -> layer37_qkv_ar
	layer37_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_qkv_ar -> layer37_attn_2
	layer37_qkv_ar -> layer37_attn_3
	layer37_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_attn_2 -> layer37_attn_out_2
	layer37_attn_3 -> layer37_attn_out_3
	layer37_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer37_attn_out_2 -> layer37_attn_ar
	layer37_attn_out_3 -> layer37_attn_ar
	layer37_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_attn_ar -> layer37_ffn_norm_2
	layer37_attn_ar -> layer37_ffn_norm_3
	layer37_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_norm_2 -> layer37_ffn_gate_2
	layer37_ffn_norm_3 -> layer37_ffn_gate_3
	layer37_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_norm_2 -> layer37_ffn_up_2
	layer37_ffn_norm_3 -> layer37_ffn_up_3
	layer37_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer37_ffn_gate_2 -> layer37_gate_ar
	layer37_ffn_gate_3 -> layer37_gate_ar
	layer37_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer37_ffn_up_2 -> layer37_up_ar
	layer37_ffn_up_3 -> layer37_up_ar
	layer37_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_gate_ar -> layer37_silu_2
	layer37_gate_ar -> layer37_silu_3
	layer37_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_silu_2 -> layer37_mul_2
	layer37_up_ar -> layer37_mul_2
	layer37_silu_3 -> layer37_mul_3
	layer37_up_ar -> layer37_mul_3
	layer37_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_mul_2 -> layer37_ffn_down_2
	layer37_mul_3 -> layer37_ffn_down_3
	layer37_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer37_ffn_down_2 -> layer37_ffn_ar
	layer37_ffn_down_3 -> layer37_ffn_ar
	layer38_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer37_ffn_ar -> layer38_norm_2
	layer37_ffn_ar -> layer38_norm_3
	layer38_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_norm_2 -> layer38_qkv_2
	layer38_norm_3 -> layer38_qkv_3
	layer38_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer38_qkv_2 -> layer38_qkv_ar
	layer38_qkv_3 -> layer38_qkv_ar
	layer38_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_qkv_ar -> layer38_attn_2
	layer38_qkv_ar -> layer38_attn_3
	layer38_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_attn_2 -> layer38_attn_out_2
	layer38_attn_3 -> layer38_attn_out_3
	layer38_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer38_attn_out_2 -> layer38_attn_ar
	layer38_attn_out_3 -> layer38_attn_ar
	layer38_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_attn_ar -> layer38_ffn_norm_2
	layer38_attn_ar -> layer38_ffn_norm_3
	layer38_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_norm_2 -> layer38_ffn_gate_2
	layer38_ffn_norm_3 -> layer38_ffn_gate_3
	layer38_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_norm_2 -> layer38_ffn_up_2
	layer38_ffn_norm_3 -> layer38_ffn_up_3
	layer38_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer38_ffn_gate_2 -> layer38_gate_ar
	layer38_ffn_gate_3 -> layer38_gate_ar
	layer38_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer38_ffn_up_2 -> layer38_up_ar
	layer38_ffn_up_3 -> layer38_up_ar
	layer38_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_gate_ar -> layer38_silu_2
	layer38_gate_ar -> layer38_silu_3
	layer38_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_silu_2 -> layer38_mul_2
	layer38_up_ar -> layer38_mul_2
	layer38_silu_3 -> layer38_mul_3
	layer38_up_ar -> layer38_mul_3
	layer38_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_mul_2 -> layer38_ffn_down_2
	layer38_mul_3 -> layer38_ffn_down_3
	layer38_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer38_ffn_down_2 -> layer38_ffn_ar
	layer38_ffn_down_3 -> layer38_ffn_ar
	layer39_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer38_ffn_ar -> layer39_norm_2
	layer38_ffn_ar -> layer39_norm_3
	layer39_qkv_2 [label="QKV Linear\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_qkv_3 [label="QKV Linear\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_norm_2 -> layer39_qkv_2
	layer39_norm_3 -> layer39_qkv_3
	layer39_qkv_ar [label="All-Reduce QKV\nGPU:[2,3]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer39_qkv_2 -> layer39_qkv_ar
	layer39_qkv_3 -> layer39_qkv_ar
	layer39_attn_2 [label="Self-Attention\nGPU:2\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_attn_3 [label="Self-Attention\nGPU:3\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_qkv_ar -> layer39_attn_2
	layer39_qkv_ar -> layer39_attn_3
	layer39_attn_out_2 [label="Attention Output Proj\nGPU:2\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_attn_out_3 [label="Attention Output Proj\nGPU:3\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_attn_2 -> layer39_attn_out_2
	layer39_attn_3 -> layer39_attn_out_3
	layer39_attn_ar [label="All-Reduce Attention\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer39_attn_out_2 -> layer39_attn_ar
	layer39_attn_out_3 -> layer39_attn_ar
	layer39_ffn_norm_2 [label="RMSNorm\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_ffn_norm_3 [label="RMSNorm\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_attn_ar -> layer39_ffn_norm_2
	layer39_attn_ar -> layer39_ffn_norm_3
	layer39_ffn_gate_2 [label="FFN Gate\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_ffn_gate_3 [label="FFN Gate\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_ffn_norm_2 -> layer39_ffn_gate_2
	layer39_ffn_norm_3 -> layer39_ffn_gate_3
	layer39_ffn_up_2 [label="FFN Up\nGPU:2\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_ffn_up_3 [label="FFN Up\nGPU:3\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_ffn_norm_2 -> layer39_ffn_up_2
	layer39_ffn_norm_3 -> layer39_ffn_up_3
	layer39_gate_ar [label="All-Reduce Gate\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer39_ffn_gate_2 -> layer39_gate_ar
	layer39_ffn_gate_3 -> layer39_gate_ar
	layer39_up_ar [label="All-Reduce Up\nGPU:[2,3]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer39_ffn_up_2 -> layer39_up_ar
	layer39_ffn_up_3 -> layer39_up_ar
	layer39_silu_2 [label="SiLU Activation\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_silu_3 [label="SiLU Activation\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_gate_ar -> layer39_silu_2
	layer39_gate_ar -> layer39_silu_3
	layer39_mul_2 [label="Element-wise Mul\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_mul_3 [label="Element-wise Mul\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_silu_2 -> layer39_mul_2
	layer39_up_ar -> layer39_mul_2
	layer39_silu_3 -> layer39_mul_3
	layer39_up_ar -> layer39_mul_3
	layer39_ffn_down_2 [label="FFN Down\nGPU:2\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_ffn_down_3 [label="FFN Down\nGPU:3\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
	layer39_mul_2 -> layer39_ffn_down_2
	layer39_mul_3 -> layer39_ffn_down_3
	layer39_ffn_ar [label="All-Reduce FFN\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer39_ffn_down_2 -> layer39_ffn_ar
	layer39_ffn_down_3 -> layer39_ffn_ar
	subgraph cluster_stage1 {
		bgcolor=lightgray label="Stage 1: GPUs [2,3]\nLayers 20-39" style=rounded
		split_stage1 [label="Input Split\n[batch_size=4, seq_len=2048, hidden=4096]" fillcolor=lightyellow shape=parallelogram]
		layer20_embed_2 [label="Embedding\nGPU:2\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
		layer20_embed_3 [label="Embedding\nGPU:3\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#E6FFE6" shape=rectangle]
		embed_ag_stage1 [label="All-Gather Embedding\nGPU:[2,3]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
		layer20_embed_2 -> embed_ag_stage1
		layer20_embed_3 -> embed_ag_stage1
	}
	pp_send_1_2 [label="Pipeline Send\nStage 12\nGPU:[3][4]" fillcolor=lightcoral shape=ellipse]
	layer39_ffn_ar -> pp_send_1_2
	pp_send_1_2 -> split_stage2
	split_stage2 -> layer40_embed_4
	split_stage2 -> layer40_embed_5
	layer40_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	embed_ag_stage2 -> layer40_norm_4
	embed_ag_stage2 -> layer40_norm_5
	layer40_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_norm_4 -> layer40_qkv_4
	layer40_norm_5 -> layer40_qkv_5
	layer40_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer40_qkv_4 -> layer40_qkv_ar
	layer40_qkv_5 -> layer40_qkv_ar
	layer40_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_qkv_ar -> layer40_attn_4
	layer40_qkv_ar -> layer40_attn_5
	layer40_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_attn_4 -> layer40_attn_out_4
	layer40_attn_5 -> layer40_attn_out_5
	layer40_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer40_attn_out_4 -> layer40_attn_ar
	layer40_attn_out_5 -> layer40_attn_ar
	layer40_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_attn_ar -> layer40_ffn_norm_4
	layer40_attn_ar -> layer40_ffn_norm_5
	layer40_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_norm_4 -> layer40_ffn_gate_4
	layer40_ffn_norm_5 -> layer40_ffn_gate_5
	layer40_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_norm_4 -> layer40_ffn_up_4
	layer40_ffn_norm_5 -> layer40_ffn_up_5
	layer40_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer40_ffn_gate_4 -> layer40_gate_ar
	layer40_ffn_gate_5 -> layer40_gate_ar
	layer40_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer40_ffn_up_4 -> layer40_up_ar
	layer40_ffn_up_5 -> layer40_up_ar
	layer40_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_gate_ar -> layer40_silu_4
	layer40_gate_ar -> layer40_silu_5
	layer40_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_silu_4 -> layer40_mul_4
	layer40_up_ar -> layer40_mul_4
	layer40_silu_5 -> layer40_mul_5
	layer40_up_ar -> layer40_mul_5
	layer40_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_mul_4 -> layer40_ffn_down_4
	layer40_mul_5 -> layer40_ffn_down_5
	layer40_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer40_ffn_down_4 -> layer40_ffn_ar
	layer40_ffn_down_5 -> layer40_ffn_ar
	layer41_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer40_ffn_ar -> layer41_norm_4
	layer40_ffn_ar -> layer41_norm_5
	layer41_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_norm_4 -> layer41_qkv_4
	layer41_norm_5 -> layer41_qkv_5
	layer41_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer41_qkv_4 -> layer41_qkv_ar
	layer41_qkv_5 -> layer41_qkv_ar
	layer41_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_qkv_ar -> layer41_attn_4
	layer41_qkv_ar -> layer41_attn_5
	layer41_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_attn_4 -> layer41_attn_out_4
	layer41_attn_5 -> layer41_attn_out_5
	layer41_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer41_attn_out_4 -> layer41_attn_ar
	layer41_attn_out_5 -> layer41_attn_ar
	layer41_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_attn_ar -> layer41_ffn_norm_4
	layer41_attn_ar -> layer41_ffn_norm_5
	layer41_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_norm_4 -> layer41_ffn_gate_4
	layer41_ffn_norm_5 -> layer41_ffn_gate_5
	layer41_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_norm_4 -> layer41_ffn_up_4
	layer41_ffn_norm_5 -> layer41_ffn_up_5
	layer41_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer41_ffn_gate_4 -> layer41_gate_ar
	layer41_ffn_gate_5 -> layer41_gate_ar
	layer41_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer41_ffn_up_4 -> layer41_up_ar
	layer41_ffn_up_5 -> layer41_up_ar
	layer41_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_gate_ar -> layer41_silu_4
	layer41_gate_ar -> layer41_silu_5
	layer41_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_silu_4 -> layer41_mul_4
	layer41_up_ar -> layer41_mul_4
	layer41_silu_5 -> layer41_mul_5
	layer41_up_ar -> layer41_mul_5
	layer41_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_mul_4 -> layer41_ffn_down_4
	layer41_mul_5 -> layer41_ffn_down_5
	layer41_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer41_ffn_down_4 -> layer41_ffn_ar
	layer41_ffn_down_5 -> layer41_ffn_ar
	layer42_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer41_ffn_ar -> layer42_norm_4
	layer41_ffn_ar -> layer42_norm_5
	layer42_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_norm_4 -> layer42_qkv_4
	layer42_norm_5 -> layer42_qkv_5
	layer42_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer42_qkv_4 -> layer42_qkv_ar
	layer42_qkv_5 -> layer42_qkv_ar
	layer42_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_qkv_ar -> layer42_attn_4
	layer42_qkv_ar -> layer42_attn_5
	layer42_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_attn_4 -> layer42_attn_out_4
	layer42_attn_5 -> layer42_attn_out_5
	layer42_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer42_attn_out_4 -> layer42_attn_ar
	layer42_attn_out_5 -> layer42_attn_ar
	layer42_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_attn_ar -> layer42_ffn_norm_4
	layer42_attn_ar -> layer42_ffn_norm_5
	layer42_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_norm_4 -> layer42_ffn_gate_4
	layer42_ffn_norm_5 -> layer42_ffn_gate_5
	layer42_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_norm_4 -> layer42_ffn_up_4
	layer42_ffn_norm_5 -> layer42_ffn_up_5
	layer42_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer42_ffn_gate_4 -> layer42_gate_ar
	layer42_ffn_gate_5 -> layer42_gate_ar
	layer42_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer42_ffn_up_4 -> layer42_up_ar
	layer42_ffn_up_5 -> layer42_up_ar
	layer42_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_gate_ar -> layer42_silu_4
	layer42_gate_ar -> layer42_silu_5
	layer42_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_silu_4 -> layer42_mul_4
	layer42_up_ar -> layer42_mul_4
	layer42_silu_5 -> layer42_mul_5
	layer42_up_ar -> layer42_mul_5
	layer42_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_mul_4 -> layer42_ffn_down_4
	layer42_mul_5 -> layer42_ffn_down_5
	layer42_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer42_ffn_down_4 -> layer42_ffn_ar
	layer42_ffn_down_5 -> layer42_ffn_ar
	layer43_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer42_ffn_ar -> layer43_norm_4
	layer42_ffn_ar -> layer43_norm_5
	layer43_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_norm_4 -> layer43_qkv_4
	layer43_norm_5 -> layer43_qkv_5
	layer43_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer43_qkv_4 -> layer43_qkv_ar
	layer43_qkv_5 -> layer43_qkv_ar
	layer43_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_qkv_ar -> layer43_attn_4
	layer43_qkv_ar -> layer43_attn_5
	layer43_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_attn_4 -> layer43_attn_out_4
	layer43_attn_5 -> layer43_attn_out_5
	layer43_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer43_attn_out_4 -> layer43_attn_ar
	layer43_attn_out_5 -> layer43_attn_ar
	layer43_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_attn_ar -> layer43_ffn_norm_4
	layer43_attn_ar -> layer43_ffn_norm_5
	layer43_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_norm_4 -> layer43_ffn_gate_4
	layer43_ffn_norm_5 -> layer43_ffn_gate_5
	layer43_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_norm_4 -> layer43_ffn_up_4
	layer43_ffn_norm_5 -> layer43_ffn_up_5
	layer43_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer43_ffn_gate_4 -> layer43_gate_ar
	layer43_ffn_gate_5 -> layer43_gate_ar
	layer43_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer43_ffn_up_4 -> layer43_up_ar
	layer43_ffn_up_5 -> layer43_up_ar
	layer43_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_gate_ar -> layer43_silu_4
	layer43_gate_ar -> layer43_silu_5
	layer43_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_silu_4 -> layer43_mul_4
	layer43_up_ar -> layer43_mul_4
	layer43_silu_5 -> layer43_mul_5
	layer43_up_ar -> layer43_mul_5
	layer43_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_mul_4 -> layer43_ffn_down_4
	layer43_mul_5 -> layer43_ffn_down_5
	layer43_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer43_ffn_down_4 -> layer43_ffn_ar
	layer43_ffn_down_5 -> layer43_ffn_ar
	layer44_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer43_ffn_ar -> layer44_norm_4
	layer43_ffn_ar -> layer44_norm_5
	layer44_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_norm_4 -> layer44_qkv_4
	layer44_norm_5 -> layer44_qkv_5
	layer44_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer44_qkv_4 -> layer44_qkv_ar
	layer44_qkv_5 -> layer44_qkv_ar
	layer44_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_qkv_ar -> layer44_attn_4
	layer44_qkv_ar -> layer44_attn_5
	layer44_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_attn_4 -> layer44_attn_out_4
	layer44_attn_5 -> layer44_attn_out_5
	layer44_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer44_attn_out_4 -> layer44_attn_ar
	layer44_attn_out_5 -> layer44_attn_ar
	layer44_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_attn_ar -> layer44_ffn_norm_4
	layer44_attn_ar -> layer44_ffn_norm_5
	layer44_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_norm_4 -> layer44_ffn_gate_4
	layer44_ffn_norm_5 -> layer44_ffn_gate_5
	layer44_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_norm_4 -> layer44_ffn_up_4
	layer44_ffn_norm_5 -> layer44_ffn_up_5
	layer44_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer44_ffn_gate_4 -> layer44_gate_ar
	layer44_ffn_gate_5 -> layer44_gate_ar
	layer44_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer44_ffn_up_4 -> layer44_up_ar
	layer44_ffn_up_5 -> layer44_up_ar
	layer44_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_gate_ar -> layer44_silu_4
	layer44_gate_ar -> layer44_silu_5
	layer44_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_silu_4 -> layer44_mul_4
	layer44_up_ar -> layer44_mul_4
	layer44_silu_5 -> layer44_mul_5
	layer44_up_ar -> layer44_mul_5
	layer44_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_mul_4 -> layer44_ffn_down_4
	layer44_mul_5 -> layer44_ffn_down_5
	layer44_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer44_ffn_down_4 -> layer44_ffn_ar
	layer44_ffn_down_5 -> layer44_ffn_ar
	layer45_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer44_ffn_ar -> layer45_norm_4
	layer44_ffn_ar -> layer45_norm_5
	layer45_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_norm_4 -> layer45_qkv_4
	layer45_norm_5 -> layer45_qkv_5
	layer45_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer45_qkv_4 -> layer45_qkv_ar
	layer45_qkv_5 -> layer45_qkv_ar
	layer45_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_qkv_ar -> layer45_attn_4
	layer45_qkv_ar -> layer45_attn_5
	layer45_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_attn_4 -> layer45_attn_out_4
	layer45_attn_5 -> layer45_attn_out_5
	layer45_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer45_attn_out_4 -> layer45_attn_ar
	layer45_attn_out_5 -> layer45_attn_ar
	layer45_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_attn_ar -> layer45_ffn_norm_4
	layer45_attn_ar -> layer45_ffn_norm_5
	layer45_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_norm_4 -> layer45_ffn_gate_4
	layer45_ffn_norm_5 -> layer45_ffn_gate_5
	layer45_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_norm_4 -> layer45_ffn_up_4
	layer45_ffn_norm_5 -> layer45_ffn_up_5
	layer45_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer45_ffn_gate_4 -> layer45_gate_ar
	layer45_ffn_gate_5 -> layer45_gate_ar
	layer45_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer45_ffn_up_4 -> layer45_up_ar
	layer45_ffn_up_5 -> layer45_up_ar
	layer45_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_gate_ar -> layer45_silu_4
	layer45_gate_ar -> layer45_silu_5
	layer45_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_silu_4 -> layer45_mul_4
	layer45_up_ar -> layer45_mul_4
	layer45_silu_5 -> layer45_mul_5
	layer45_up_ar -> layer45_mul_5
	layer45_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_mul_4 -> layer45_ffn_down_4
	layer45_mul_5 -> layer45_ffn_down_5
	layer45_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer45_ffn_down_4 -> layer45_ffn_ar
	layer45_ffn_down_5 -> layer45_ffn_ar
	layer46_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer45_ffn_ar -> layer46_norm_4
	layer45_ffn_ar -> layer46_norm_5
	layer46_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_norm_4 -> layer46_qkv_4
	layer46_norm_5 -> layer46_qkv_5
	layer46_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer46_qkv_4 -> layer46_qkv_ar
	layer46_qkv_5 -> layer46_qkv_ar
	layer46_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_qkv_ar -> layer46_attn_4
	layer46_qkv_ar -> layer46_attn_5
	layer46_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_attn_4 -> layer46_attn_out_4
	layer46_attn_5 -> layer46_attn_out_5
	layer46_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer46_attn_out_4 -> layer46_attn_ar
	layer46_attn_out_5 -> layer46_attn_ar
	layer46_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_attn_ar -> layer46_ffn_norm_4
	layer46_attn_ar -> layer46_ffn_norm_5
	layer46_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_norm_4 -> layer46_ffn_gate_4
	layer46_ffn_norm_5 -> layer46_ffn_gate_5
	layer46_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_norm_4 -> layer46_ffn_up_4
	layer46_ffn_norm_5 -> layer46_ffn_up_5
	layer46_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer46_ffn_gate_4 -> layer46_gate_ar
	layer46_ffn_gate_5 -> layer46_gate_ar
	layer46_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer46_ffn_up_4 -> layer46_up_ar
	layer46_ffn_up_5 -> layer46_up_ar
	layer46_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_gate_ar -> layer46_silu_4
	layer46_gate_ar -> layer46_silu_5
	layer46_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_silu_4 -> layer46_mul_4
	layer46_up_ar -> layer46_mul_4
	layer46_silu_5 -> layer46_mul_5
	layer46_up_ar -> layer46_mul_5
	layer46_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_mul_4 -> layer46_ffn_down_4
	layer46_mul_5 -> layer46_ffn_down_5
	layer46_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer46_ffn_down_4 -> layer46_ffn_ar
	layer46_ffn_down_5 -> layer46_ffn_ar
	layer47_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer46_ffn_ar -> layer47_norm_4
	layer46_ffn_ar -> layer47_norm_5
	layer47_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_norm_4 -> layer47_qkv_4
	layer47_norm_5 -> layer47_qkv_5
	layer47_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer47_qkv_4 -> layer47_qkv_ar
	layer47_qkv_5 -> layer47_qkv_ar
	layer47_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_qkv_ar -> layer47_attn_4
	layer47_qkv_ar -> layer47_attn_5
	layer47_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_attn_4 -> layer47_attn_out_4
	layer47_attn_5 -> layer47_attn_out_5
	layer47_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer47_attn_out_4 -> layer47_attn_ar
	layer47_attn_out_5 -> layer47_attn_ar
	layer47_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_attn_ar -> layer47_ffn_norm_4
	layer47_attn_ar -> layer47_ffn_norm_5
	layer47_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_norm_4 -> layer47_ffn_gate_4
	layer47_ffn_norm_5 -> layer47_ffn_gate_5
	layer47_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_norm_4 -> layer47_ffn_up_4
	layer47_ffn_norm_5 -> layer47_ffn_up_5
	layer47_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer47_ffn_gate_4 -> layer47_gate_ar
	layer47_ffn_gate_5 -> layer47_gate_ar
	layer47_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer47_ffn_up_4 -> layer47_up_ar
	layer47_ffn_up_5 -> layer47_up_ar
	layer47_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_gate_ar -> layer47_silu_4
	layer47_gate_ar -> layer47_silu_5
	layer47_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_silu_4 -> layer47_mul_4
	layer47_up_ar -> layer47_mul_4
	layer47_silu_5 -> layer47_mul_5
	layer47_up_ar -> layer47_mul_5
	layer47_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_mul_4 -> layer47_ffn_down_4
	layer47_mul_5 -> layer47_ffn_down_5
	layer47_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer47_ffn_down_4 -> layer47_ffn_ar
	layer47_ffn_down_5 -> layer47_ffn_ar
	layer48_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer47_ffn_ar -> layer48_norm_4
	layer47_ffn_ar -> layer48_norm_5
	layer48_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_norm_4 -> layer48_qkv_4
	layer48_norm_5 -> layer48_qkv_5
	layer48_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer48_qkv_4 -> layer48_qkv_ar
	layer48_qkv_5 -> layer48_qkv_ar
	layer48_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_qkv_ar -> layer48_attn_4
	layer48_qkv_ar -> layer48_attn_5
	layer48_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_attn_4 -> layer48_attn_out_4
	layer48_attn_5 -> layer48_attn_out_5
	layer48_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer48_attn_out_4 -> layer48_attn_ar
	layer48_attn_out_5 -> layer48_attn_ar
	layer48_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_attn_ar -> layer48_ffn_norm_4
	layer48_attn_ar -> layer48_ffn_norm_5
	layer48_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_norm_4 -> layer48_ffn_gate_4
	layer48_ffn_norm_5 -> layer48_ffn_gate_5
	layer48_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_norm_4 -> layer48_ffn_up_4
	layer48_ffn_norm_5 -> layer48_ffn_up_5
	layer48_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer48_ffn_gate_4 -> layer48_gate_ar
	layer48_ffn_gate_5 -> layer48_gate_ar
	layer48_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer48_ffn_up_4 -> layer48_up_ar
	layer48_ffn_up_5 -> layer48_up_ar
	layer48_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_gate_ar -> layer48_silu_4
	layer48_gate_ar -> layer48_silu_5
	layer48_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_silu_4 -> layer48_mul_4
	layer48_up_ar -> layer48_mul_4
	layer48_silu_5 -> layer48_mul_5
	layer48_up_ar -> layer48_mul_5
	layer48_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_mul_4 -> layer48_ffn_down_4
	layer48_mul_5 -> layer48_ffn_down_5
	layer48_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer48_ffn_down_4 -> layer48_ffn_ar
	layer48_ffn_down_5 -> layer48_ffn_ar
	layer49_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer48_ffn_ar -> layer49_norm_4
	layer48_ffn_ar -> layer49_norm_5
	layer49_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_norm_4 -> layer49_qkv_4
	layer49_norm_5 -> layer49_qkv_5
	layer49_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer49_qkv_4 -> layer49_qkv_ar
	layer49_qkv_5 -> layer49_qkv_ar
	layer49_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_qkv_ar -> layer49_attn_4
	layer49_qkv_ar -> layer49_attn_5
	layer49_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_attn_4 -> layer49_attn_out_4
	layer49_attn_5 -> layer49_attn_out_5
	layer49_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer49_attn_out_4 -> layer49_attn_ar
	layer49_attn_out_5 -> layer49_attn_ar
	layer49_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_attn_ar -> layer49_ffn_norm_4
	layer49_attn_ar -> layer49_ffn_norm_5
	layer49_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_norm_4 -> layer49_ffn_gate_4
	layer49_ffn_norm_5 -> layer49_ffn_gate_5
	layer49_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_norm_4 -> layer49_ffn_up_4
	layer49_ffn_norm_5 -> layer49_ffn_up_5
	layer49_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer49_ffn_gate_4 -> layer49_gate_ar
	layer49_ffn_gate_5 -> layer49_gate_ar
	layer49_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer49_ffn_up_4 -> layer49_up_ar
	layer49_ffn_up_5 -> layer49_up_ar
	layer49_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_gate_ar -> layer49_silu_4
	layer49_gate_ar -> layer49_silu_5
	layer49_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_silu_4 -> layer49_mul_4
	layer49_up_ar -> layer49_mul_4
	layer49_silu_5 -> layer49_mul_5
	layer49_up_ar -> layer49_mul_5
	layer49_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_mul_4 -> layer49_ffn_down_4
	layer49_mul_5 -> layer49_ffn_down_5
	layer49_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer49_ffn_down_4 -> layer49_ffn_ar
	layer49_ffn_down_5 -> layer49_ffn_ar
	layer50_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer49_ffn_ar -> layer50_norm_4
	layer49_ffn_ar -> layer50_norm_5
	layer50_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_norm_4 -> layer50_qkv_4
	layer50_norm_5 -> layer50_qkv_5
	layer50_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer50_qkv_4 -> layer50_qkv_ar
	layer50_qkv_5 -> layer50_qkv_ar
	layer50_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_qkv_ar -> layer50_attn_4
	layer50_qkv_ar -> layer50_attn_5
	layer50_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_attn_4 -> layer50_attn_out_4
	layer50_attn_5 -> layer50_attn_out_5
	layer50_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer50_attn_out_4 -> layer50_attn_ar
	layer50_attn_out_5 -> layer50_attn_ar
	layer50_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_attn_ar -> layer50_ffn_norm_4
	layer50_attn_ar -> layer50_ffn_norm_5
	layer50_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_norm_4 -> layer50_ffn_gate_4
	layer50_ffn_norm_5 -> layer50_ffn_gate_5
	layer50_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_norm_4 -> layer50_ffn_up_4
	layer50_ffn_norm_5 -> layer50_ffn_up_5
	layer50_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer50_ffn_gate_4 -> layer50_gate_ar
	layer50_ffn_gate_5 -> layer50_gate_ar
	layer50_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer50_ffn_up_4 -> layer50_up_ar
	layer50_ffn_up_5 -> layer50_up_ar
	layer50_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_gate_ar -> layer50_silu_4
	layer50_gate_ar -> layer50_silu_5
	layer50_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_silu_4 -> layer50_mul_4
	layer50_up_ar -> layer50_mul_4
	layer50_silu_5 -> layer50_mul_5
	layer50_up_ar -> layer50_mul_5
	layer50_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_mul_4 -> layer50_ffn_down_4
	layer50_mul_5 -> layer50_ffn_down_5
	layer50_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer50_ffn_down_4 -> layer50_ffn_ar
	layer50_ffn_down_5 -> layer50_ffn_ar
	layer51_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer50_ffn_ar -> layer51_norm_4
	layer50_ffn_ar -> layer51_norm_5
	layer51_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_norm_4 -> layer51_qkv_4
	layer51_norm_5 -> layer51_qkv_5
	layer51_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer51_qkv_4 -> layer51_qkv_ar
	layer51_qkv_5 -> layer51_qkv_ar
	layer51_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_qkv_ar -> layer51_attn_4
	layer51_qkv_ar -> layer51_attn_5
	layer51_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_attn_4 -> layer51_attn_out_4
	layer51_attn_5 -> layer51_attn_out_5
	layer51_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer51_attn_out_4 -> layer51_attn_ar
	layer51_attn_out_5 -> layer51_attn_ar
	layer51_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_attn_ar -> layer51_ffn_norm_4
	layer51_attn_ar -> layer51_ffn_norm_5
	layer51_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_norm_4 -> layer51_ffn_gate_4
	layer51_ffn_norm_5 -> layer51_ffn_gate_5
	layer51_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_norm_4 -> layer51_ffn_up_4
	layer51_ffn_norm_5 -> layer51_ffn_up_5
	layer51_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer51_ffn_gate_4 -> layer51_gate_ar
	layer51_ffn_gate_5 -> layer51_gate_ar
	layer51_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer51_ffn_up_4 -> layer51_up_ar
	layer51_ffn_up_5 -> layer51_up_ar
	layer51_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_gate_ar -> layer51_silu_4
	layer51_gate_ar -> layer51_silu_5
	layer51_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_silu_4 -> layer51_mul_4
	layer51_up_ar -> layer51_mul_4
	layer51_silu_5 -> layer51_mul_5
	layer51_up_ar -> layer51_mul_5
	layer51_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_mul_4 -> layer51_ffn_down_4
	layer51_mul_5 -> layer51_ffn_down_5
	layer51_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer51_ffn_down_4 -> layer51_ffn_ar
	layer51_ffn_down_5 -> layer51_ffn_ar
	layer52_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer51_ffn_ar -> layer52_norm_4
	layer51_ffn_ar -> layer52_norm_5
	layer52_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_norm_4 -> layer52_qkv_4
	layer52_norm_5 -> layer52_qkv_5
	layer52_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer52_qkv_4 -> layer52_qkv_ar
	layer52_qkv_5 -> layer52_qkv_ar
	layer52_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_qkv_ar -> layer52_attn_4
	layer52_qkv_ar -> layer52_attn_5
	layer52_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_attn_4 -> layer52_attn_out_4
	layer52_attn_5 -> layer52_attn_out_5
	layer52_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer52_attn_out_4 -> layer52_attn_ar
	layer52_attn_out_5 -> layer52_attn_ar
	layer52_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_attn_ar -> layer52_ffn_norm_4
	layer52_attn_ar -> layer52_ffn_norm_5
	layer52_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_norm_4 -> layer52_ffn_gate_4
	layer52_ffn_norm_5 -> layer52_ffn_gate_5
	layer52_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_norm_4 -> layer52_ffn_up_4
	layer52_ffn_norm_5 -> layer52_ffn_up_5
	layer52_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer52_ffn_gate_4 -> layer52_gate_ar
	layer52_ffn_gate_5 -> layer52_gate_ar
	layer52_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer52_ffn_up_4 -> layer52_up_ar
	layer52_ffn_up_5 -> layer52_up_ar
	layer52_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_gate_ar -> layer52_silu_4
	layer52_gate_ar -> layer52_silu_5
	layer52_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_silu_4 -> layer52_mul_4
	layer52_up_ar -> layer52_mul_4
	layer52_silu_5 -> layer52_mul_5
	layer52_up_ar -> layer52_mul_5
	layer52_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_mul_4 -> layer52_ffn_down_4
	layer52_mul_5 -> layer52_ffn_down_5
	layer52_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer52_ffn_down_4 -> layer52_ffn_ar
	layer52_ffn_down_5 -> layer52_ffn_ar
	layer53_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer52_ffn_ar -> layer53_norm_4
	layer52_ffn_ar -> layer53_norm_5
	layer53_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_norm_4 -> layer53_qkv_4
	layer53_norm_5 -> layer53_qkv_5
	layer53_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer53_qkv_4 -> layer53_qkv_ar
	layer53_qkv_5 -> layer53_qkv_ar
	layer53_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_qkv_ar -> layer53_attn_4
	layer53_qkv_ar -> layer53_attn_5
	layer53_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_attn_4 -> layer53_attn_out_4
	layer53_attn_5 -> layer53_attn_out_5
	layer53_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer53_attn_out_4 -> layer53_attn_ar
	layer53_attn_out_5 -> layer53_attn_ar
	layer53_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_attn_ar -> layer53_ffn_norm_4
	layer53_attn_ar -> layer53_ffn_norm_5
	layer53_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_norm_4 -> layer53_ffn_gate_4
	layer53_ffn_norm_5 -> layer53_ffn_gate_5
	layer53_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_norm_4 -> layer53_ffn_up_4
	layer53_ffn_norm_5 -> layer53_ffn_up_5
	layer53_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer53_ffn_gate_4 -> layer53_gate_ar
	layer53_ffn_gate_5 -> layer53_gate_ar
	layer53_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer53_ffn_up_4 -> layer53_up_ar
	layer53_ffn_up_5 -> layer53_up_ar
	layer53_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_gate_ar -> layer53_silu_4
	layer53_gate_ar -> layer53_silu_5
	layer53_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_silu_4 -> layer53_mul_4
	layer53_up_ar -> layer53_mul_4
	layer53_silu_5 -> layer53_mul_5
	layer53_up_ar -> layer53_mul_5
	layer53_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_mul_4 -> layer53_ffn_down_4
	layer53_mul_5 -> layer53_ffn_down_5
	layer53_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer53_ffn_down_4 -> layer53_ffn_ar
	layer53_ffn_down_5 -> layer53_ffn_ar
	layer54_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer53_ffn_ar -> layer54_norm_4
	layer53_ffn_ar -> layer54_norm_5
	layer54_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_norm_4 -> layer54_qkv_4
	layer54_norm_5 -> layer54_qkv_5
	layer54_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer54_qkv_4 -> layer54_qkv_ar
	layer54_qkv_5 -> layer54_qkv_ar
	layer54_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_qkv_ar -> layer54_attn_4
	layer54_qkv_ar -> layer54_attn_5
	layer54_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_attn_4 -> layer54_attn_out_4
	layer54_attn_5 -> layer54_attn_out_5
	layer54_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer54_attn_out_4 -> layer54_attn_ar
	layer54_attn_out_5 -> layer54_attn_ar
	layer54_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_attn_ar -> layer54_ffn_norm_4
	layer54_attn_ar -> layer54_ffn_norm_5
	layer54_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_norm_4 -> layer54_ffn_gate_4
	layer54_ffn_norm_5 -> layer54_ffn_gate_5
	layer54_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_norm_4 -> layer54_ffn_up_4
	layer54_ffn_norm_5 -> layer54_ffn_up_5
	layer54_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer54_ffn_gate_4 -> layer54_gate_ar
	layer54_ffn_gate_5 -> layer54_gate_ar
	layer54_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer54_ffn_up_4 -> layer54_up_ar
	layer54_ffn_up_5 -> layer54_up_ar
	layer54_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_gate_ar -> layer54_silu_4
	layer54_gate_ar -> layer54_silu_5
	layer54_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_silu_4 -> layer54_mul_4
	layer54_up_ar -> layer54_mul_4
	layer54_silu_5 -> layer54_mul_5
	layer54_up_ar -> layer54_mul_5
	layer54_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_mul_4 -> layer54_ffn_down_4
	layer54_mul_5 -> layer54_ffn_down_5
	layer54_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer54_ffn_down_4 -> layer54_ffn_ar
	layer54_ffn_down_5 -> layer54_ffn_ar
	layer55_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer54_ffn_ar -> layer55_norm_4
	layer54_ffn_ar -> layer55_norm_5
	layer55_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_norm_4 -> layer55_qkv_4
	layer55_norm_5 -> layer55_qkv_5
	layer55_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer55_qkv_4 -> layer55_qkv_ar
	layer55_qkv_5 -> layer55_qkv_ar
	layer55_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_qkv_ar -> layer55_attn_4
	layer55_qkv_ar -> layer55_attn_5
	layer55_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_attn_4 -> layer55_attn_out_4
	layer55_attn_5 -> layer55_attn_out_5
	layer55_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer55_attn_out_4 -> layer55_attn_ar
	layer55_attn_out_5 -> layer55_attn_ar
	layer55_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_attn_ar -> layer55_ffn_norm_4
	layer55_attn_ar -> layer55_ffn_norm_5
	layer55_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_norm_4 -> layer55_ffn_gate_4
	layer55_ffn_norm_5 -> layer55_ffn_gate_5
	layer55_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_norm_4 -> layer55_ffn_up_4
	layer55_ffn_norm_5 -> layer55_ffn_up_5
	layer55_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer55_ffn_gate_4 -> layer55_gate_ar
	layer55_ffn_gate_5 -> layer55_gate_ar
	layer55_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer55_ffn_up_4 -> layer55_up_ar
	layer55_ffn_up_5 -> layer55_up_ar
	layer55_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_gate_ar -> layer55_silu_4
	layer55_gate_ar -> layer55_silu_5
	layer55_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_silu_4 -> layer55_mul_4
	layer55_up_ar -> layer55_mul_4
	layer55_silu_5 -> layer55_mul_5
	layer55_up_ar -> layer55_mul_5
	layer55_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_mul_4 -> layer55_ffn_down_4
	layer55_mul_5 -> layer55_ffn_down_5
	layer55_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer55_ffn_down_4 -> layer55_ffn_ar
	layer55_ffn_down_5 -> layer55_ffn_ar
	layer56_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer55_ffn_ar -> layer56_norm_4
	layer55_ffn_ar -> layer56_norm_5
	layer56_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_norm_4 -> layer56_qkv_4
	layer56_norm_5 -> layer56_qkv_5
	layer56_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer56_qkv_4 -> layer56_qkv_ar
	layer56_qkv_5 -> layer56_qkv_ar
	layer56_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_qkv_ar -> layer56_attn_4
	layer56_qkv_ar -> layer56_attn_5
	layer56_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_attn_4 -> layer56_attn_out_4
	layer56_attn_5 -> layer56_attn_out_5
	layer56_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer56_attn_out_4 -> layer56_attn_ar
	layer56_attn_out_5 -> layer56_attn_ar
	layer56_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_attn_ar -> layer56_ffn_norm_4
	layer56_attn_ar -> layer56_ffn_norm_5
	layer56_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_norm_4 -> layer56_ffn_gate_4
	layer56_ffn_norm_5 -> layer56_ffn_gate_5
	layer56_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_norm_4 -> layer56_ffn_up_4
	layer56_ffn_norm_5 -> layer56_ffn_up_5
	layer56_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer56_ffn_gate_4 -> layer56_gate_ar
	layer56_ffn_gate_5 -> layer56_gate_ar
	layer56_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer56_ffn_up_4 -> layer56_up_ar
	layer56_ffn_up_5 -> layer56_up_ar
	layer56_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_gate_ar -> layer56_silu_4
	layer56_gate_ar -> layer56_silu_5
	layer56_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_silu_4 -> layer56_mul_4
	layer56_up_ar -> layer56_mul_4
	layer56_silu_5 -> layer56_mul_5
	layer56_up_ar -> layer56_mul_5
	layer56_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_mul_4 -> layer56_ffn_down_4
	layer56_mul_5 -> layer56_ffn_down_5
	layer56_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer56_ffn_down_4 -> layer56_ffn_ar
	layer56_ffn_down_5 -> layer56_ffn_ar
	layer57_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer56_ffn_ar -> layer57_norm_4
	layer56_ffn_ar -> layer57_norm_5
	layer57_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_norm_4 -> layer57_qkv_4
	layer57_norm_5 -> layer57_qkv_5
	layer57_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer57_qkv_4 -> layer57_qkv_ar
	layer57_qkv_5 -> layer57_qkv_ar
	layer57_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_qkv_ar -> layer57_attn_4
	layer57_qkv_ar -> layer57_attn_5
	layer57_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_attn_4 -> layer57_attn_out_4
	layer57_attn_5 -> layer57_attn_out_5
	layer57_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer57_attn_out_4 -> layer57_attn_ar
	layer57_attn_out_5 -> layer57_attn_ar
	layer57_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_attn_ar -> layer57_ffn_norm_4
	layer57_attn_ar -> layer57_ffn_norm_5
	layer57_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_norm_4 -> layer57_ffn_gate_4
	layer57_ffn_norm_5 -> layer57_ffn_gate_5
	layer57_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_norm_4 -> layer57_ffn_up_4
	layer57_ffn_norm_5 -> layer57_ffn_up_5
	layer57_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer57_ffn_gate_4 -> layer57_gate_ar
	layer57_ffn_gate_5 -> layer57_gate_ar
	layer57_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer57_ffn_up_4 -> layer57_up_ar
	layer57_ffn_up_5 -> layer57_up_ar
	layer57_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_gate_ar -> layer57_silu_4
	layer57_gate_ar -> layer57_silu_5
	layer57_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_silu_4 -> layer57_mul_4
	layer57_up_ar -> layer57_mul_4
	layer57_silu_5 -> layer57_mul_5
	layer57_up_ar -> layer57_mul_5
	layer57_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_mul_4 -> layer57_ffn_down_4
	layer57_mul_5 -> layer57_ffn_down_5
	layer57_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer57_ffn_down_4 -> layer57_ffn_ar
	layer57_ffn_down_5 -> layer57_ffn_ar
	layer58_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer57_ffn_ar -> layer58_norm_4
	layer57_ffn_ar -> layer58_norm_5
	layer58_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_norm_4 -> layer58_qkv_4
	layer58_norm_5 -> layer58_qkv_5
	layer58_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer58_qkv_4 -> layer58_qkv_ar
	layer58_qkv_5 -> layer58_qkv_ar
	layer58_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_qkv_ar -> layer58_attn_4
	layer58_qkv_ar -> layer58_attn_5
	layer58_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_attn_4 -> layer58_attn_out_4
	layer58_attn_5 -> layer58_attn_out_5
	layer58_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer58_attn_out_4 -> layer58_attn_ar
	layer58_attn_out_5 -> layer58_attn_ar
	layer58_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_attn_ar -> layer58_ffn_norm_4
	layer58_attn_ar -> layer58_ffn_norm_5
	layer58_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_norm_4 -> layer58_ffn_gate_4
	layer58_ffn_norm_5 -> layer58_ffn_gate_5
	layer58_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_norm_4 -> layer58_ffn_up_4
	layer58_ffn_norm_5 -> layer58_ffn_up_5
	layer58_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer58_ffn_gate_4 -> layer58_gate_ar
	layer58_ffn_gate_5 -> layer58_gate_ar
	layer58_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer58_ffn_up_4 -> layer58_up_ar
	layer58_ffn_up_5 -> layer58_up_ar
	layer58_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_gate_ar -> layer58_silu_4
	layer58_gate_ar -> layer58_silu_5
	layer58_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_silu_4 -> layer58_mul_4
	layer58_up_ar -> layer58_mul_4
	layer58_silu_5 -> layer58_mul_5
	layer58_up_ar -> layer58_mul_5
	layer58_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_mul_4 -> layer58_ffn_down_4
	layer58_mul_5 -> layer58_ffn_down_5
	layer58_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer58_ffn_down_4 -> layer58_ffn_ar
	layer58_ffn_down_5 -> layer58_ffn_ar
	layer59_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer58_ffn_ar -> layer59_norm_4
	layer58_ffn_ar -> layer59_norm_5
	layer59_qkv_4 [label="QKV Linear\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_qkv_5 [label="QKV Linear\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_norm_4 -> layer59_qkv_4
	layer59_norm_5 -> layer59_qkv_5
	layer59_qkv_ar [label="All-Reduce QKV\nGPU:[4,5]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer59_qkv_4 -> layer59_qkv_ar
	layer59_qkv_5 -> layer59_qkv_ar
	layer59_attn_4 [label="Self-Attention\nGPU:4\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_attn_5 [label="Self-Attention\nGPU:5\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_qkv_ar -> layer59_attn_4
	layer59_qkv_ar -> layer59_attn_5
	layer59_attn_out_4 [label="Attention Output Proj\nGPU:4\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_attn_out_5 [label="Attention Output Proj\nGPU:5\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_attn_4 -> layer59_attn_out_4
	layer59_attn_5 -> layer59_attn_out_5
	layer59_attn_ar [label="All-Reduce Attention\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer59_attn_out_4 -> layer59_attn_ar
	layer59_attn_out_5 -> layer59_attn_ar
	layer59_ffn_norm_4 [label="RMSNorm\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_ffn_norm_5 [label="RMSNorm\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_attn_ar -> layer59_ffn_norm_4
	layer59_attn_ar -> layer59_ffn_norm_5
	layer59_ffn_gate_4 [label="FFN Gate\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_ffn_gate_5 [label="FFN Gate\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_ffn_norm_4 -> layer59_ffn_gate_4
	layer59_ffn_norm_5 -> layer59_ffn_gate_5
	layer59_ffn_up_4 [label="FFN Up\nGPU:4\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_ffn_up_5 [label="FFN Up\nGPU:5\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_ffn_norm_4 -> layer59_ffn_up_4
	layer59_ffn_norm_5 -> layer59_ffn_up_5
	layer59_gate_ar [label="All-Reduce Gate\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer59_ffn_gate_4 -> layer59_gate_ar
	layer59_ffn_gate_5 -> layer59_gate_ar
	layer59_up_ar [label="All-Reduce Up\nGPU:[4,5]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer59_ffn_up_4 -> layer59_up_ar
	layer59_ffn_up_5 -> layer59_up_ar
	layer59_silu_4 [label="SiLU Activation\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_silu_5 [label="SiLU Activation\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_gate_ar -> layer59_silu_4
	layer59_gate_ar -> layer59_silu_5
	layer59_mul_4 [label="Element-wise Mul\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_mul_5 [label="Element-wise Mul\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_silu_4 -> layer59_mul_4
	layer59_up_ar -> layer59_mul_4
	layer59_silu_5 -> layer59_mul_5
	layer59_up_ar -> layer59_mul_5
	layer59_ffn_down_4 [label="FFN Down\nGPU:4\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_ffn_down_5 [label="FFN Down\nGPU:5\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
	layer59_mul_4 -> layer59_ffn_down_4
	layer59_mul_5 -> layer59_ffn_down_5
	layer59_ffn_ar [label="All-Reduce FFN\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer59_ffn_down_4 -> layer59_ffn_ar
	layer59_ffn_down_5 -> layer59_ffn_ar
	subgraph cluster_stage2 {
		bgcolor=lightgray label="Stage 2: GPUs [4,5]\nLayers 40-59" style=rounded
		split_stage2 [label="Input Split\n[batch_size=4, seq_len=2048, hidden=4096]" fillcolor=lightyellow shape=parallelogram]
		layer40_embed_4 [label="Embedding\nGPU:4\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
		layer40_embed_5 [label="Embedding\nGPU:5\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#E6E6FF" shape=rectangle]
		embed_ag_stage2 [label="All-Gather Embedding\nGPU:[4,5]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
		layer40_embed_4 -> embed_ag_stage2
		layer40_embed_5 -> embed_ag_stage2
	}
	pp_send_2_3 [label="Pipeline Send\nStage 23\nGPU:[5][6]" fillcolor=lightcoral shape=ellipse]
	layer59_ffn_ar -> pp_send_2_3
	pp_send_2_3 -> split_stage3
	split_stage3 -> layer60_embed_6
	split_stage3 -> layer60_embed_7
	layer60_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	embed_ag_stage3 -> layer60_norm_6
	embed_ag_stage3 -> layer60_norm_7
	layer60_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_norm_6 -> layer60_qkv_6
	layer60_norm_7 -> layer60_qkv_7
	layer60_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer60_qkv_6 -> layer60_qkv_ar
	layer60_qkv_7 -> layer60_qkv_ar
	layer60_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_qkv_ar -> layer60_attn_6
	layer60_qkv_ar -> layer60_attn_7
	layer60_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_attn_6 -> layer60_attn_out_6
	layer60_attn_7 -> layer60_attn_out_7
	layer60_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer60_attn_out_6 -> layer60_attn_ar
	layer60_attn_out_7 -> layer60_attn_ar
	layer60_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_attn_ar -> layer60_ffn_norm_6
	layer60_attn_ar -> layer60_ffn_norm_7
	layer60_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_norm_6 -> layer60_ffn_gate_6
	layer60_ffn_norm_7 -> layer60_ffn_gate_7
	layer60_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_norm_6 -> layer60_ffn_up_6
	layer60_ffn_norm_7 -> layer60_ffn_up_7
	layer60_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer60_ffn_gate_6 -> layer60_gate_ar
	layer60_ffn_gate_7 -> layer60_gate_ar
	layer60_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer60_ffn_up_6 -> layer60_up_ar
	layer60_ffn_up_7 -> layer60_up_ar
	layer60_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_gate_ar -> layer60_silu_6
	layer60_gate_ar -> layer60_silu_7
	layer60_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_silu_6 -> layer60_mul_6
	layer60_up_ar -> layer60_mul_6
	layer60_silu_7 -> layer60_mul_7
	layer60_up_ar -> layer60_mul_7
	layer60_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_mul_6 -> layer60_ffn_down_6
	layer60_mul_7 -> layer60_ffn_down_7
	layer60_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer60_ffn_down_6 -> layer60_ffn_ar
	layer60_ffn_down_7 -> layer60_ffn_ar
	layer61_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer60_ffn_ar -> layer61_norm_6
	layer60_ffn_ar -> layer61_norm_7
	layer61_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_norm_6 -> layer61_qkv_6
	layer61_norm_7 -> layer61_qkv_7
	layer61_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer61_qkv_6 -> layer61_qkv_ar
	layer61_qkv_7 -> layer61_qkv_ar
	layer61_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_qkv_ar -> layer61_attn_6
	layer61_qkv_ar -> layer61_attn_7
	layer61_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_attn_6 -> layer61_attn_out_6
	layer61_attn_7 -> layer61_attn_out_7
	layer61_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer61_attn_out_6 -> layer61_attn_ar
	layer61_attn_out_7 -> layer61_attn_ar
	layer61_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_attn_ar -> layer61_ffn_norm_6
	layer61_attn_ar -> layer61_ffn_norm_7
	layer61_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_norm_6 -> layer61_ffn_gate_6
	layer61_ffn_norm_7 -> layer61_ffn_gate_7
	layer61_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_norm_6 -> layer61_ffn_up_6
	layer61_ffn_norm_7 -> layer61_ffn_up_7
	layer61_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer61_ffn_gate_6 -> layer61_gate_ar
	layer61_ffn_gate_7 -> layer61_gate_ar
	layer61_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer61_ffn_up_6 -> layer61_up_ar
	layer61_ffn_up_7 -> layer61_up_ar
	layer61_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_gate_ar -> layer61_silu_6
	layer61_gate_ar -> layer61_silu_7
	layer61_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_silu_6 -> layer61_mul_6
	layer61_up_ar -> layer61_mul_6
	layer61_silu_7 -> layer61_mul_7
	layer61_up_ar -> layer61_mul_7
	layer61_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_mul_6 -> layer61_ffn_down_6
	layer61_mul_7 -> layer61_ffn_down_7
	layer61_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer61_ffn_down_6 -> layer61_ffn_ar
	layer61_ffn_down_7 -> layer61_ffn_ar
	layer62_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer61_ffn_ar -> layer62_norm_6
	layer61_ffn_ar -> layer62_norm_7
	layer62_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_norm_6 -> layer62_qkv_6
	layer62_norm_7 -> layer62_qkv_7
	layer62_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer62_qkv_6 -> layer62_qkv_ar
	layer62_qkv_7 -> layer62_qkv_ar
	layer62_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_qkv_ar -> layer62_attn_6
	layer62_qkv_ar -> layer62_attn_7
	layer62_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_attn_6 -> layer62_attn_out_6
	layer62_attn_7 -> layer62_attn_out_7
	layer62_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer62_attn_out_6 -> layer62_attn_ar
	layer62_attn_out_7 -> layer62_attn_ar
	layer62_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_attn_ar -> layer62_ffn_norm_6
	layer62_attn_ar -> layer62_ffn_norm_7
	layer62_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_norm_6 -> layer62_ffn_gate_6
	layer62_ffn_norm_7 -> layer62_ffn_gate_7
	layer62_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_norm_6 -> layer62_ffn_up_6
	layer62_ffn_norm_7 -> layer62_ffn_up_7
	layer62_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer62_ffn_gate_6 -> layer62_gate_ar
	layer62_ffn_gate_7 -> layer62_gate_ar
	layer62_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer62_ffn_up_6 -> layer62_up_ar
	layer62_ffn_up_7 -> layer62_up_ar
	layer62_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_gate_ar -> layer62_silu_6
	layer62_gate_ar -> layer62_silu_7
	layer62_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_silu_6 -> layer62_mul_6
	layer62_up_ar -> layer62_mul_6
	layer62_silu_7 -> layer62_mul_7
	layer62_up_ar -> layer62_mul_7
	layer62_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_mul_6 -> layer62_ffn_down_6
	layer62_mul_7 -> layer62_ffn_down_7
	layer62_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer62_ffn_down_6 -> layer62_ffn_ar
	layer62_ffn_down_7 -> layer62_ffn_ar
	layer63_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer62_ffn_ar -> layer63_norm_6
	layer62_ffn_ar -> layer63_norm_7
	layer63_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_norm_6 -> layer63_qkv_6
	layer63_norm_7 -> layer63_qkv_7
	layer63_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer63_qkv_6 -> layer63_qkv_ar
	layer63_qkv_7 -> layer63_qkv_ar
	layer63_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_qkv_ar -> layer63_attn_6
	layer63_qkv_ar -> layer63_attn_7
	layer63_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_attn_6 -> layer63_attn_out_6
	layer63_attn_7 -> layer63_attn_out_7
	layer63_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer63_attn_out_6 -> layer63_attn_ar
	layer63_attn_out_7 -> layer63_attn_ar
	layer63_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_attn_ar -> layer63_ffn_norm_6
	layer63_attn_ar -> layer63_ffn_norm_7
	layer63_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_norm_6 -> layer63_ffn_gate_6
	layer63_ffn_norm_7 -> layer63_ffn_gate_7
	layer63_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_norm_6 -> layer63_ffn_up_6
	layer63_ffn_norm_7 -> layer63_ffn_up_7
	layer63_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer63_ffn_gate_6 -> layer63_gate_ar
	layer63_ffn_gate_7 -> layer63_gate_ar
	layer63_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer63_ffn_up_6 -> layer63_up_ar
	layer63_ffn_up_7 -> layer63_up_ar
	layer63_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_gate_ar -> layer63_silu_6
	layer63_gate_ar -> layer63_silu_7
	layer63_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_silu_6 -> layer63_mul_6
	layer63_up_ar -> layer63_mul_6
	layer63_silu_7 -> layer63_mul_7
	layer63_up_ar -> layer63_mul_7
	layer63_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_mul_6 -> layer63_ffn_down_6
	layer63_mul_7 -> layer63_ffn_down_7
	layer63_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer63_ffn_down_6 -> layer63_ffn_ar
	layer63_ffn_down_7 -> layer63_ffn_ar
	layer64_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer63_ffn_ar -> layer64_norm_6
	layer63_ffn_ar -> layer64_norm_7
	layer64_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_norm_6 -> layer64_qkv_6
	layer64_norm_7 -> layer64_qkv_7
	layer64_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer64_qkv_6 -> layer64_qkv_ar
	layer64_qkv_7 -> layer64_qkv_ar
	layer64_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_qkv_ar -> layer64_attn_6
	layer64_qkv_ar -> layer64_attn_7
	layer64_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_attn_6 -> layer64_attn_out_6
	layer64_attn_7 -> layer64_attn_out_7
	layer64_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer64_attn_out_6 -> layer64_attn_ar
	layer64_attn_out_7 -> layer64_attn_ar
	layer64_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_attn_ar -> layer64_ffn_norm_6
	layer64_attn_ar -> layer64_ffn_norm_7
	layer64_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_norm_6 -> layer64_ffn_gate_6
	layer64_ffn_norm_7 -> layer64_ffn_gate_7
	layer64_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_norm_6 -> layer64_ffn_up_6
	layer64_ffn_norm_7 -> layer64_ffn_up_7
	layer64_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer64_ffn_gate_6 -> layer64_gate_ar
	layer64_ffn_gate_7 -> layer64_gate_ar
	layer64_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer64_ffn_up_6 -> layer64_up_ar
	layer64_ffn_up_7 -> layer64_up_ar
	layer64_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_gate_ar -> layer64_silu_6
	layer64_gate_ar -> layer64_silu_7
	layer64_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_silu_6 -> layer64_mul_6
	layer64_up_ar -> layer64_mul_6
	layer64_silu_7 -> layer64_mul_7
	layer64_up_ar -> layer64_mul_7
	layer64_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_mul_6 -> layer64_ffn_down_6
	layer64_mul_7 -> layer64_ffn_down_7
	layer64_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer64_ffn_down_6 -> layer64_ffn_ar
	layer64_ffn_down_7 -> layer64_ffn_ar
	layer65_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer64_ffn_ar -> layer65_norm_6
	layer64_ffn_ar -> layer65_norm_7
	layer65_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_norm_6 -> layer65_qkv_6
	layer65_norm_7 -> layer65_qkv_7
	layer65_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer65_qkv_6 -> layer65_qkv_ar
	layer65_qkv_7 -> layer65_qkv_ar
	layer65_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_qkv_ar -> layer65_attn_6
	layer65_qkv_ar -> layer65_attn_7
	layer65_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_attn_6 -> layer65_attn_out_6
	layer65_attn_7 -> layer65_attn_out_7
	layer65_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer65_attn_out_6 -> layer65_attn_ar
	layer65_attn_out_7 -> layer65_attn_ar
	layer65_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_attn_ar -> layer65_ffn_norm_6
	layer65_attn_ar -> layer65_ffn_norm_7
	layer65_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_norm_6 -> layer65_ffn_gate_6
	layer65_ffn_norm_7 -> layer65_ffn_gate_7
	layer65_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_norm_6 -> layer65_ffn_up_6
	layer65_ffn_norm_7 -> layer65_ffn_up_7
	layer65_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer65_ffn_gate_6 -> layer65_gate_ar
	layer65_ffn_gate_7 -> layer65_gate_ar
	layer65_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer65_ffn_up_6 -> layer65_up_ar
	layer65_ffn_up_7 -> layer65_up_ar
	layer65_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_gate_ar -> layer65_silu_6
	layer65_gate_ar -> layer65_silu_7
	layer65_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_silu_6 -> layer65_mul_6
	layer65_up_ar -> layer65_mul_6
	layer65_silu_7 -> layer65_mul_7
	layer65_up_ar -> layer65_mul_7
	layer65_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_mul_6 -> layer65_ffn_down_6
	layer65_mul_7 -> layer65_ffn_down_7
	layer65_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer65_ffn_down_6 -> layer65_ffn_ar
	layer65_ffn_down_7 -> layer65_ffn_ar
	layer66_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer65_ffn_ar -> layer66_norm_6
	layer65_ffn_ar -> layer66_norm_7
	layer66_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_norm_6 -> layer66_qkv_6
	layer66_norm_7 -> layer66_qkv_7
	layer66_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer66_qkv_6 -> layer66_qkv_ar
	layer66_qkv_7 -> layer66_qkv_ar
	layer66_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_qkv_ar -> layer66_attn_6
	layer66_qkv_ar -> layer66_attn_7
	layer66_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_attn_6 -> layer66_attn_out_6
	layer66_attn_7 -> layer66_attn_out_7
	layer66_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer66_attn_out_6 -> layer66_attn_ar
	layer66_attn_out_7 -> layer66_attn_ar
	layer66_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_attn_ar -> layer66_ffn_norm_6
	layer66_attn_ar -> layer66_ffn_norm_7
	layer66_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_norm_6 -> layer66_ffn_gate_6
	layer66_ffn_norm_7 -> layer66_ffn_gate_7
	layer66_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_norm_6 -> layer66_ffn_up_6
	layer66_ffn_norm_7 -> layer66_ffn_up_7
	layer66_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer66_ffn_gate_6 -> layer66_gate_ar
	layer66_ffn_gate_7 -> layer66_gate_ar
	layer66_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer66_ffn_up_6 -> layer66_up_ar
	layer66_ffn_up_7 -> layer66_up_ar
	layer66_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_gate_ar -> layer66_silu_6
	layer66_gate_ar -> layer66_silu_7
	layer66_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_silu_6 -> layer66_mul_6
	layer66_up_ar -> layer66_mul_6
	layer66_silu_7 -> layer66_mul_7
	layer66_up_ar -> layer66_mul_7
	layer66_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_mul_6 -> layer66_ffn_down_6
	layer66_mul_7 -> layer66_ffn_down_7
	layer66_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer66_ffn_down_6 -> layer66_ffn_ar
	layer66_ffn_down_7 -> layer66_ffn_ar
	layer67_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer66_ffn_ar -> layer67_norm_6
	layer66_ffn_ar -> layer67_norm_7
	layer67_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_norm_6 -> layer67_qkv_6
	layer67_norm_7 -> layer67_qkv_7
	layer67_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer67_qkv_6 -> layer67_qkv_ar
	layer67_qkv_7 -> layer67_qkv_ar
	layer67_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_qkv_ar -> layer67_attn_6
	layer67_qkv_ar -> layer67_attn_7
	layer67_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_attn_6 -> layer67_attn_out_6
	layer67_attn_7 -> layer67_attn_out_7
	layer67_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer67_attn_out_6 -> layer67_attn_ar
	layer67_attn_out_7 -> layer67_attn_ar
	layer67_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_attn_ar -> layer67_ffn_norm_6
	layer67_attn_ar -> layer67_ffn_norm_7
	layer67_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_norm_6 -> layer67_ffn_gate_6
	layer67_ffn_norm_7 -> layer67_ffn_gate_7
	layer67_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_norm_6 -> layer67_ffn_up_6
	layer67_ffn_norm_7 -> layer67_ffn_up_7
	layer67_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer67_ffn_gate_6 -> layer67_gate_ar
	layer67_ffn_gate_7 -> layer67_gate_ar
	layer67_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer67_ffn_up_6 -> layer67_up_ar
	layer67_ffn_up_7 -> layer67_up_ar
	layer67_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_gate_ar -> layer67_silu_6
	layer67_gate_ar -> layer67_silu_7
	layer67_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_silu_6 -> layer67_mul_6
	layer67_up_ar -> layer67_mul_6
	layer67_silu_7 -> layer67_mul_7
	layer67_up_ar -> layer67_mul_7
	layer67_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_mul_6 -> layer67_ffn_down_6
	layer67_mul_7 -> layer67_ffn_down_7
	layer67_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer67_ffn_down_6 -> layer67_ffn_ar
	layer67_ffn_down_7 -> layer67_ffn_ar
	layer68_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer67_ffn_ar -> layer68_norm_6
	layer67_ffn_ar -> layer68_norm_7
	layer68_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_norm_6 -> layer68_qkv_6
	layer68_norm_7 -> layer68_qkv_7
	layer68_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer68_qkv_6 -> layer68_qkv_ar
	layer68_qkv_7 -> layer68_qkv_ar
	layer68_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_qkv_ar -> layer68_attn_6
	layer68_qkv_ar -> layer68_attn_7
	layer68_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_attn_6 -> layer68_attn_out_6
	layer68_attn_7 -> layer68_attn_out_7
	layer68_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer68_attn_out_6 -> layer68_attn_ar
	layer68_attn_out_7 -> layer68_attn_ar
	layer68_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_attn_ar -> layer68_ffn_norm_6
	layer68_attn_ar -> layer68_ffn_norm_7
	layer68_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_norm_6 -> layer68_ffn_gate_6
	layer68_ffn_norm_7 -> layer68_ffn_gate_7
	layer68_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_norm_6 -> layer68_ffn_up_6
	layer68_ffn_norm_7 -> layer68_ffn_up_7
	layer68_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer68_ffn_gate_6 -> layer68_gate_ar
	layer68_ffn_gate_7 -> layer68_gate_ar
	layer68_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer68_ffn_up_6 -> layer68_up_ar
	layer68_ffn_up_7 -> layer68_up_ar
	layer68_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_gate_ar -> layer68_silu_6
	layer68_gate_ar -> layer68_silu_7
	layer68_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_silu_6 -> layer68_mul_6
	layer68_up_ar -> layer68_mul_6
	layer68_silu_7 -> layer68_mul_7
	layer68_up_ar -> layer68_mul_7
	layer68_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_mul_6 -> layer68_ffn_down_6
	layer68_mul_7 -> layer68_ffn_down_7
	layer68_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer68_ffn_down_6 -> layer68_ffn_ar
	layer68_ffn_down_7 -> layer68_ffn_ar
	layer69_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer68_ffn_ar -> layer69_norm_6
	layer68_ffn_ar -> layer69_norm_7
	layer69_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_norm_6 -> layer69_qkv_6
	layer69_norm_7 -> layer69_qkv_7
	layer69_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer69_qkv_6 -> layer69_qkv_ar
	layer69_qkv_7 -> layer69_qkv_ar
	layer69_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_qkv_ar -> layer69_attn_6
	layer69_qkv_ar -> layer69_attn_7
	layer69_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_attn_6 -> layer69_attn_out_6
	layer69_attn_7 -> layer69_attn_out_7
	layer69_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer69_attn_out_6 -> layer69_attn_ar
	layer69_attn_out_7 -> layer69_attn_ar
	layer69_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_attn_ar -> layer69_ffn_norm_6
	layer69_attn_ar -> layer69_ffn_norm_7
	layer69_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_norm_6 -> layer69_ffn_gate_6
	layer69_ffn_norm_7 -> layer69_ffn_gate_7
	layer69_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_norm_6 -> layer69_ffn_up_6
	layer69_ffn_norm_7 -> layer69_ffn_up_7
	layer69_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer69_ffn_gate_6 -> layer69_gate_ar
	layer69_ffn_gate_7 -> layer69_gate_ar
	layer69_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer69_ffn_up_6 -> layer69_up_ar
	layer69_ffn_up_7 -> layer69_up_ar
	layer69_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_gate_ar -> layer69_silu_6
	layer69_gate_ar -> layer69_silu_7
	layer69_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_silu_6 -> layer69_mul_6
	layer69_up_ar -> layer69_mul_6
	layer69_silu_7 -> layer69_mul_7
	layer69_up_ar -> layer69_mul_7
	layer69_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_mul_6 -> layer69_ffn_down_6
	layer69_mul_7 -> layer69_ffn_down_7
	layer69_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer69_ffn_down_6 -> layer69_ffn_ar
	layer69_ffn_down_7 -> layer69_ffn_ar
	layer70_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer69_ffn_ar -> layer70_norm_6
	layer69_ffn_ar -> layer70_norm_7
	layer70_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_norm_6 -> layer70_qkv_6
	layer70_norm_7 -> layer70_qkv_7
	layer70_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer70_qkv_6 -> layer70_qkv_ar
	layer70_qkv_7 -> layer70_qkv_ar
	layer70_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_qkv_ar -> layer70_attn_6
	layer70_qkv_ar -> layer70_attn_7
	layer70_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_attn_6 -> layer70_attn_out_6
	layer70_attn_7 -> layer70_attn_out_7
	layer70_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer70_attn_out_6 -> layer70_attn_ar
	layer70_attn_out_7 -> layer70_attn_ar
	layer70_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_attn_ar -> layer70_ffn_norm_6
	layer70_attn_ar -> layer70_ffn_norm_7
	layer70_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_norm_6 -> layer70_ffn_gate_6
	layer70_ffn_norm_7 -> layer70_ffn_gate_7
	layer70_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_norm_6 -> layer70_ffn_up_6
	layer70_ffn_norm_7 -> layer70_ffn_up_7
	layer70_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer70_ffn_gate_6 -> layer70_gate_ar
	layer70_ffn_gate_7 -> layer70_gate_ar
	layer70_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer70_ffn_up_6 -> layer70_up_ar
	layer70_ffn_up_7 -> layer70_up_ar
	layer70_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_gate_ar -> layer70_silu_6
	layer70_gate_ar -> layer70_silu_7
	layer70_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_silu_6 -> layer70_mul_6
	layer70_up_ar -> layer70_mul_6
	layer70_silu_7 -> layer70_mul_7
	layer70_up_ar -> layer70_mul_7
	layer70_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_mul_6 -> layer70_ffn_down_6
	layer70_mul_7 -> layer70_ffn_down_7
	layer70_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer70_ffn_down_6 -> layer70_ffn_ar
	layer70_ffn_down_7 -> layer70_ffn_ar
	layer71_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer70_ffn_ar -> layer71_norm_6
	layer70_ffn_ar -> layer71_norm_7
	layer71_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_norm_6 -> layer71_qkv_6
	layer71_norm_7 -> layer71_qkv_7
	layer71_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer71_qkv_6 -> layer71_qkv_ar
	layer71_qkv_7 -> layer71_qkv_ar
	layer71_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_qkv_ar -> layer71_attn_6
	layer71_qkv_ar -> layer71_attn_7
	layer71_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_attn_6 -> layer71_attn_out_6
	layer71_attn_7 -> layer71_attn_out_7
	layer71_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer71_attn_out_6 -> layer71_attn_ar
	layer71_attn_out_7 -> layer71_attn_ar
	layer71_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_attn_ar -> layer71_ffn_norm_6
	layer71_attn_ar -> layer71_ffn_norm_7
	layer71_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_norm_6 -> layer71_ffn_gate_6
	layer71_ffn_norm_7 -> layer71_ffn_gate_7
	layer71_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_norm_6 -> layer71_ffn_up_6
	layer71_ffn_norm_7 -> layer71_ffn_up_7
	layer71_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer71_ffn_gate_6 -> layer71_gate_ar
	layer71_ffn_gate_7 -> layer71_gate_ar
	layer71_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer71_ffn_up_6 -> layer71_up_ar
	layer71_ffn_up_7 -> layer71_up_ar
	layer71_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_gate_ar -> layer71_silu_6
	layer71_gate_ar -> layer71_silu_7
	layer71_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_silu_6 -> layer71_mul_6
	layer71_up_ar -> layer71_mul_6
	layer71_silu_7 -> layer71_mul_7
	layer71_up_ar -> layer71_mul_7
	layer71_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_mul_6 -> layer71_ffn_down_6
	layer71_mul_7 -> layer71_ffn_down_7
	layer71_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer71_ffn_down_6 -> layer71_ffn_ar
	layer71_ffn_down_7 -> layer71_ffn_ar
	layer72_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer71_ffn_ar -> layer72_norm_6
	layer71_ffn_ar -> layer72_norm_7
	layer72_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_norm_6 -> layer72_qkv_6
	layer72_norm_7 -> layer72_qkv_7
	layer72_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer72_qkv_6 -> layer72_qkv_ar
	layer72_qkv_7 -> layer72_qkv_ar
	layer72_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_qkv_ar -> layer72_attn_6
	layer72_qkv_ar -> layer72_attn_7
	layer72_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_attn_6 -> layer72_attn_out_6
	layer72_attn_7 -> layer72_attn_out_7
	layer72_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer72_attn_out_6 -> layer72_attn_ar
	layer72_attn_out_7 -> layer72_attn_ar
	layer72_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_attn_ar -> layer72_ffn_norm_6
	layer72_attn_ar -> layer72_ffn_norm_7
	layer72_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_norm_6 -> layer72_ffn_gate_6
	layer72_ffn_norm_7 -> layer72_ffn_gate_7
	layer72_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_norm_6 -> layer72_ffn_up_6
	layer72_ffn_norm_7 -> layer72_ffn_up_7
	layer72_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer72_ffn_gate_6 -> layer72_gate_ar
	layer72_ffn_gate_7 -> layer72_gate_ar
	layer72_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer72_ffn_up_6 -> layer72_up_ar
	layer72_ffn_up_7 -> layer72_up_ar
	layer72_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_gate_ar -> layer72_silu_6
	layer72_gate_ar -> layer72_silu_7
	layer72_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_silu_6 -> layer72_mul_6
	layer72_up_ar -> layer72_mul_6
	layer72_silu_7 -> layer72_mul_7
	layer72_up_ar -> layer72_mul_7
	layer72_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_mul_6 -> layer72_ffn_down_6
	layer72_mul_7 -> layer72_ffn_down_7
	layer72_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer72_ffn_down_6 -> layer72_ffn_ar
	layer72_ffn_down_7 -> layer72_ffn_ar
	layer73_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer72_ffn_ar -> layer73_norm_6
	layer72_ffn_ar -> layer73_norm_7
	layer73_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_norm_6 -> layer73_qkv_6
	layer73_norm_7 -> layer73_qkv_7
	layer73_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer73_qkv_6 -> layer73_qkv_ar
	layer73_qkv_7 -> layer73_qkv_ar
	layer73_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_qkv_ar -> layer73_attn_6
	layer73_qkv_ar -> layer73_attn_7
	layer73_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_attn_6 -> layer73_attn_out_6
	layer73_attn_7 -> layer73_attn_out_7
	layer73_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer73_attn_out_6 -> layer73_attn_ar
	layer73_attn_out_7 -> layer73_attn_ar
	layer73_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_attn_ar -> layer73_ffn_norm_6
	layer73_attn_ar -> layer73_ffn_norm_7
	layer73_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_norm_6 -> layer73_ffn_gate_6
	layer73_ffn_norm_7 -> layer73_ffn_gate_7
	layer73_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_norm_6 -> layer73_ffn_up_6
	layer73_ffn_norm_7 -> layer73_ffn_up_7
	layer73_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer73_ffn_gate_6 -> layer73_gate_ar
	layer73_ffn_gate_7 -> layer73_gate_ar
	layer73_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer73_ffn_up_6 -> layer73_up_ar
	layer73_ffn_up_7 -> layer73_up_ar
	layer73_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_gate_ar -> layer73_silu_6
	layer73_gate_ar -> layer73_silu_7
	layer73_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_silu_6 -> layer73_mul_6
	layer73_up_ar -> layer73_mul_6
	layer73_silu_7 -> layer73_mul_7
	layer73_up_ar -> layer73_mul_7
	layer73_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_mul_6 -> layer73_ffn_down_6
	layer73_mul_7 -> layer73_ffn_down_7
	layer73_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer73_ffn_down_6 -> layer73_ffn_ar
	layer73_ffn_down_7 -> layer73_ffn_ar
	layer74_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer73_ffn_ar -> layer74_norm_6
	layer73_ffn_ar -> layer74_norm_7
	layer74_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_norm_6 -> layer74_qkv_6
	layer74_norm_7 -> layer74_qkv_7
	layer74_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer74_qkv_6 -> layer74_qkv_ar
	layer74_qkv_7 -> layer74_qkv_ar
	layer74_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_qkv_ar -> layer74_attn_6
	layer74_qkv_ar -> layer74_attn_7
	layer74_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_attn_6 -> layer74_attn_out_6
	layer74_attn_7 -> layer74_attn_out_7
	layer74_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer74_attn_out_6 -> layer74_attn_ar
	layer74_attn_out_7 -> layer74_attn_ar
	layer74_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_attn_ar -> layer74_ffn_norm_6
	layer74_attn_ar -> layer74_ffn_norm_7
	layer74_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_norm_6 -> layer74_ffn_gate_6
	layer74_ffn_norm_7 -> layer74_ffn_gate_7
	layer74_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_norm_6 -> layer74_ffn_up_6
	layer74_ffn_norm_7 -> layer74_ffn_up_7
	layer74_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer74_ffn_gate_6 -> layer74_gate_ar
	layer74_ffn_gate_7 -> layer74_gate_ar
	layer74_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer74_ffn_up_6 -> layer74_up_ar
	layer74_ffn_up_7 -> layer74_up_ar
	layer74_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_gate_ar -> layer74_silu_6
	layer74_gate_ar -> layer74_silu_7
	layer74_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_silu_6 -> layer74_mul_6
	layer74_up_ar -> layer74_mul_6
	layer74_silu_7 -> layer74_mul_7
	layer74_up_ar -> layer74_mul_7
	layer74_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_mul_6 -> layer74_ffn_down_6
	layer74_mul_7 -> layer74_ffn_down_7
	layer74_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer74_ffn_down_6 -> layer74_ffn_ar
	layer74_ffn_down_7 -> layer74_ffn_ar
	layer75_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer74_ffn_ar -> layer75_norm_6
	layer74_ffn_ar -> layer75_norm_7
	layer75_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_norm_6 -> layer75_qkv_6
	layer75_norm_7 -> layer75_qkv_7
	layer75_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer75_qkv_6 -> layer75_qkv_ar
	layer75_qkv_7 -> layer75_qkv_ar
	layer75_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_qkv_ar -> layer75_attn_6
	layer75_qkv_ar -> layer75_attn_7
	layer75_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_attn_6 -> layer75_attn_out_6
	layer75_attn_7 -> layer75_attn_out_7
	layer75_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer75_attn_out_6 -> layer75_attn_ar
	layer75_attn_out_7 -> layer75_attn_ar
	layer75_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_attn_ar -> layer75_ffn_norm_6
	layer75_attn_ar -> layer75_ffn_norm_7
	layer75_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_norm_6 -> layer75_ffn_gate_6
	layer75_ffn_norm_7 -> layer75_ffn_gate_7
	layer75_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_norm_6 -> layer75_ffn_up_6
	layer75_ffn_norm_7 -> layer75_ffn_up_7
	layer75_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer75_ffn_gate_6 -> layer75_gate_ar
	layer75_ffn_gate_7 -> layer75_gate_ar
	layer75_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer75_ffn_up_6 -> layer75_up_ar
	layer75_ffn_up_7 -> layer75_up_ar
	layer75_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_gate_ar -> layer75_silu_6
	layer75_gate_ar -> layer75_silu_7
	layer75_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_silu_6 -> layer75_mul_6
	layer75_up_ar -> layer75_mul_6
	layer75_silu_7 -> layer75_mul_7
	layer75_up_ar -> layer75_mul_7
	layer75_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_mul_6 -> layer75_ffn_down_6
	layer75_mul_7 -> layer75_ffn_down_7
	layer75_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer75_ffn_down_6 -> layer75_ffn_ar
	layer75_ffn_down_7 -> layer75_ffn_ar
	layer76_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer75_ffn_ar -> layer76_norm_6
	layer75_ffn_ar -> layer76_norm_7
	layer76_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_norm_6 -> layer76_qkv_6
	layer76_norm_7 -> layer76_qkv_7
	layer76_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer76_qkv_6 -> layer76_qkv_ar
	layer76_qkv_7 -> layer76_qkv_ar
	layer76_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_qkv_ar -> layer76_attn_6
	layer76_qkv_ar -> layer76_attn_7
	layer76_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_attn_6 -> layer76_attn_out_6
	layer76_attn_7 -> layer76_attn_out_7
	layer76_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer76_attn_out_6 -> layer76_attn_ar
	layer76_attn_out_7 -> layer76_attn_ar
	layer76_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_attn_ar -> layer76_ffn_norm_6
	layer76_attn_ar -> layer76_ffn_norm_7
	layer76_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_norm_6 -> layer76_ffn_gate_6
	layer76_ffn_norm_7 -> layer76_ffn_gate_7
	layer76_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_norm_6 -> layer76_ffn_up_6
	layer76_ffn_norm_7 -> layer76_ffn_up_7
	layer76_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer76_ffn_gate_6 -> layer76_gate_ar
	layer76_ffn_gate_7 -> layer76_gate_ar
	layer76_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer76_ffn_up_6 -> layer76_up_ar
	layer76_ffn_up_7 -> layer76_up_ar
	layer76_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_gate_ar -> layer76_silu_6
	layer76_gate_ar -> layer76_silu_7
	layer76_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_silu_6 -> layer76_mul_6
	layer76_up_ar -> layer76_mul_6
	layer76_silu_7 -> layer76_mul_7
	layer76_up_ar -> layer76_mul_7
	layer76_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_mul_6 -> layer76_ffn_down_6
	layer76_mul_7 -> layer76_ffn_down_7
	layer76_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer76_ffn_down_6 -> layer76_ffn_ar
	layer76_ffn_down_7 -> layer76_ffn_ar
	layer77_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer76_ffn_ar -> layer77_norm_6
	layer76_ffn_ar -> layer77_norm_7
	layer77_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_norm_6 -> layer77_qkv_6
	layer77_norm_7 -> layer77_qkv_7
	layer77_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer77_qkv_6 -> layer77_qkv_ar
	layer77_qkv_7 -> layer77_qkv_ar
	layer77_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_qkv_ar -> layer77_attn_6
	layer77_qkv_ar -> layer77_attn_7
	layer77_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_attn_6 -> layer77_attn_out_6
	layer77_attn_7 -> layer77_attn_out_7
	layer77_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer77_attn_out_6 -> layer77_attn_ar
	layer77_attn_out_7 -> layer77_attn_ar
	layer77_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_attn_ar -> layer77_ffn_norm_6
	layer77_attn_ar -> layer77_ffn_norm_7
	layer77_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_norm_6 -> layer77_ffn_gate_6
	layer77_ffn_norm_7 -> layer77_ffn_gate_7
	layer77_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_norm_6 -> layer77_ffn_up_6
	layer77_ffn_norm_7 -> layer77_ffn_up_7
	layer77_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer77_ffn_gate_6 -> layer77_gate_ar
	layer77_ffn_gate_7 -> layer77_gate_ar
	layer77_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer77_ffn_up_6 -> layer77_up_ar
	layer77_ffn_up_7 -> layer77_up_ar
	layer77_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_gate_ar -> layer77_silu_6
	layer77_gate_ar -> layer77_silu_7
	layer77_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_silu_6 -> layer77_mul_6
	layer77_up_ar -> layer77_mul_6
	layer77_silu_7 -> layer77_mul_7
	layer77_up_ar -> layer77_mul_7
	layer77_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_mul_6 -> layer77_ffn_down_6
	layer77_mul_7 -> layer77_ffn_down_7
	layer77_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer77_ffn_down_6 -> layer77_ffn_ar
	layer77_ffn_down_7 -> layer77_ffn_ar
	layer78_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer77_ffn_ar -> layer78_norm_6
	layer77_ffn_ar -> layer78_norm_7
	layer78_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_norm_6 -> layer78_qkv_6
	layer78_norm_7 -> layer78_qkv_7
	layer78_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer78_qkv_6 -> layer78_qkv_ar
	layer78_qkv_7 -> layer78_qkv_ar
	layer78_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_qkv_ar -> layer78_attn_6
	layer78_qkv_ar -> layer78_attn_7
	layer78_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_attn_6 -> layer78_attn_out_6
	layer78_attn_7 -> layer78_attn_out_7
	layer78_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer78_attn_out_6 -> layer78_attn_ar
	layer78_attn_out_7 -> layer78_attn_ar
	layer78_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_attn_ar -> layer78_ffn_norm_6
	layer78_attn_ar -> layer78_ffn_norm_7
	layer78_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_norm_6 -> layer78_ffn_gate_6
	layer78_ffn_norm_7 -> layer78_ffn_gate_7
	layer78_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_norm_6 -> layer78_ffn_up_6
	layer78_ffn_norm_7 -> layer78_ffn_up_7
	layer78_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer78_ffn_gate_6 -> layer78_gate_ar
	layer78_ffn_gate_7 -> layer78_gate_ar
	layer78_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer78_ffn_up_6 -> layer78_up_ar
	layer78_ffn_up_7 -> layer78_up_ar
	layer78_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_gate_ar -> layer78_silu_6
	layer78_gate_ar -> layer78_silu_7
	layer78_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_silu_6 -> layer78_mul_6
	layer78_up_ar -> layer78_mul_6
	layer78_silu_7 -> layer78_mul_7
	layer78_up_ar -> layer78_mul_7
	layer78_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_mul_6 -> layer78_ffn_down_6
	layer78_mul_7 -> layer78_ffn_down_7
	layer78_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer78_ffn_down_6 -> layer78_ffn_ar
	layer78_ffn_down_7 -> layer78_ffn_ar
	layer79_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer78_ffn_ar -> layer79_norm_6
	layer78_ffn_ar -> layer79_norm_7
	layer79_qkv_6 [label="QKV Linear\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_qkv_7 [label="QKV Linear\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,12288]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_norm_6 -> layer79_qkv_6
	layer79_norm_7 -> layer79_qkv_7
	layer79_qkv_ar [label="All-Reduce QKV\nGPU:[6,7]\nInput:[4,2048,24576]\nOutput:[4,2048,24576]" fillcolor=lightblue shape=ellipse]
	layer79_qkv_6 -> layer79_qkv_ar
	layer79_qkv_7 -> layer79_qkv_ar
	layer79_attn_6 [label="Self-Attention\nGPU:6\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_attn_7 [label="Self-Attention\nGPU:7\nInput:[4,2048,24576]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_qkv_ar -> layer79_attn_6
	layer79_qkv_ar -> layer79_attn_7
	layer79_attn_out_6 [label="Attention Output Proj\nGPU:6\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_attn_out_7 [label="Attention Output Proj\nGPU:7\nInput:[4,2048,4096]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_attn_6 -> layer79_attn_out_6
	layer79_attn_7 -> layer79_attn_out_7
	layer79_attn_ar [label="All-Reduce Attention\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer79_attn_out_6 -> layer79_attn_ar
	layer79_attn_out_7 -> layer79_attn_ar
	layer79_ffn_norm_6 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_ffn_norm_7 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_attn_ar -> layer79_ffn_norm_6
	layer79_attn_ar -> layer79_ffn_norm_7
	layer79_ffn_gate_6 [label="FFN Gate\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_ffn_gate_7 [label="FFN Gate\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_ffn_norm_6 -> layer79_ffn_gate_6
	layer79_ffn_norm_7 -> layer79_ffn_gate_7
	layer79_ffn_up_6 [label="FFN Up\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_ffn_up_7 [label="FFN Up\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_ffn_norm_6 -> layer79_ffn_up_6
	layer79_ffn_norm_7 -> layer79_ffn_up_7
	layer79_gate_ar [label="All-Reduce Gate\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer79_ffn_gate_6 -> layer79_gate_ar
	layer79_ffn_gate_7 -> layer79_gate_ar
	layer79_up_ar [label="All-Reduce Up\nGPU:[6,7]\nInput:[4,2048,28672]\nOutput:[4,2048,28672]" fillcolor=lightblue shape=ellipse]
	layer79_ffn_up_6 -> layer79_up_ar
	layer79_ffn_up_7 -> layer79_up_ar
	layer79_silu_6 [label="SiLU Activation\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_silu_7 [label="SiLU Activation\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_gate_ar -> layer79_silu_6
	layer79_gate_ar -> layer79_silu_7
	layer79_mul_6 [label="Element-wise Mul\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_mul_7 [label="Element-wise Mul\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,14336]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_silu_6 -> layer79_mul_6
	layer79_up_ar -> layer79_mul_6
	layer79_silu_7 -> layer79_mul_7
	layer79_up_ar -> layer79_mul_7
	layer79_ffn_down_6 [label="FFN Down\nGPU:6\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_ffn_down_7 [label="FFN Down\nGPU:7\nInput:[4,2048,14336]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
	layer79_mul_6 -> layer79_ffn_down_6
	layer79_mul_7 -> layer79_ffn_down_7
	layer79_ffn_ar [label="All-Reduce FFN\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
	layer79_ffn_down_6 -> layer79_ffn_ar
	layer79_ffn_down_7 -> layer79_ffn_ar
	subgraph cluster_stage3 {
		bgcolor=lightgray label="Stage 3: GPUs [6,7]\nLayers 60-79" style=rounded
		split_stage3 [label="Input Split\n[batch_size=4, seq_len=2048, hidden=4096]" fillcolor=lightyellow shape=parallelogram]
		layer60_embed_6 [label="Embedding\nGPU:6\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
		layer60_embed_7 [label="Embedding\nGPU:7\nInput:[4,2048]\nOutput:[4,2048,4096]" fillcolor="#FFF0E6" shape=rectangle]
		embed_ag_stage3 [label="All-Gather Embedding\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
		layer60_embed_6 -> embed_ag_stage3
		layer60_embed_7 -> embed_ag_stage3
	}
	pp_send_2_3 -> output_norm_0
	pp_send_2_3 -> output_norm_1
	subgraph output_processing {
		bgcolor=lightgray label="Final Output Processing" style=rounded
		output_norm_0 [label="RMSNorm\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
		output_norm_1 [label="RMSNorm\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor="#FFF0E6" shape=rectangle]
		final_ag [label="All-Gather Final\nGPU:[6,7]\nInput:[4,2048,8192]\nOutput:[4,2048,8192]" fillcolor=lightblue shape=ellipse]
		output_norm_0 -> final_ag
		output_norm_1 -> final_ag
		lm_head_0 [label="LM Head\nGPU:6\nInput:[4,2048,8192]\nOutput:[4,2048,64128]" fillcolor="#FFF0E6" shape=rectangle]
		lm_head_1 [label="LM Head\nGPU:7\nInput:[4,2048,8192]\nOutput:[4,2048,64128]" fillcolor="#FFF0E6" shape=rectangle]
		final_ag -> lm_head_0
		final_ag -> lm_head_1
		final_ar [label="All-Reduce Logits\nGPU:[6,7]\nInput:[4,2048,128256]\nOutput:[4,2048,128256]" fillcolor=lightblue shape=ellipse]
		lm_head_0 -> final_ar
		lm_head_1 -> final_ar
	}
	output [label="Output\n[batch_size=4, seq_len=2048, vocab=128256]" fillcolor=white shape=ellipse]
	final_ar -> output
}
