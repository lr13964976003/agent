<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: OptimalStrategy Pages: 1 -->
<svg width="1352pt" height="5214pt"
 viewBox="0.00 0.00 1352.00 5213.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5209.98)">
<title>OptimalStrategy</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5209.98 1348,-5209.98 1348,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="black" d="M20,-3885.6C20,-3885.6 1324,-3885.6 1324,-3885.6 1330,-3885.6 1336,-3891.6 1336,-3897.6 1336,-3897.6 1336,-5127.99 1336,-5127.99 1336,-5133.99 1330,-5139.99 1324,-5139.99 1324,-5139.99 20,-5139.99 20,-5139.99 14,-5139.99 8,-5133.99 8,-5127.99 8,-5127.99 8,-3897.6 8,-3897.6 8,-3891.6 14,-3885.6 20,-3885.6"/>
<text text-anchor="middle" x="672" y="-5124.79" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;3)</text>
<text text-anchor="middle" x="672" y="-5109.79" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;127</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0_attn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="576,-4640.57 576,-5093.99 761,-5093.99 761,-4640.57 576,-4640.57"/>
<text text-anchor="middle" x="668.5" y="-5078.79" font-family="Times,serif" font-size="14.00">Layer 0 Attention (TP4)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_moe</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-3893.6 16,-4607.57 1328,-4607.57 1328,-3893.6 16,-3893.6"/>
<text text-anchor="middle" x="672" y="-4592.37" font-family="Times,serif" font-size="14.00">Layer 0 MoE (EP32)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M280,-2623.21C280,-2623.21 1056,-2623.21 1056,-2623.21 1062,-2623.21 1068,-2629.21 1068,-2635.21 1068,-2635.21 1068,-3865.6 1068,-3865.6 1068,-3871.6 1062,-3877.6 1056,-3877.6 1056,-3877.6 280,-3877.6 280,-3877.6 274,-3877.6 268,-3871.6 268,-3865.6 268,-3865.6 268,-2635.21 268,-2635.21 268,-2629.21 274,-2623.21 280,-2623.21"/>
<text text-anchor="middle" x="668" y="-3862.4" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 4&#45;7)</text>
<text text-anchor="middle" x="668" y="-3847.4" font-family="Times,serif" font-size="14.00">GPUs: 128&#45;255</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer4_attn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="576,-3378.18 576,-3831.6 761,-3831.6 761,-3378.18 576,-3378.18"/>
<text text-anchor="middle" x="668.5" y="-3816.4" font-family="Times,serif" font-size="14.00">Layer 4 Attention (TP4)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer4_moe</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="276,-2631.21 276,-3345.18 1060,-3345.18 1060,-2631.21 276,-2631.21"/>
<text text-anchor="middle" x="668" y="-3329.98" font-family="Times,serif" font-size="14.00">Layer 4 MoE (EP32)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_stage2</title>
<path fill="none" stroke="black" d="M280,-1360.82C280,-1360.82 1056,-1360.82 1056,-1360.82 1062,-1360.82 1068,-1366.82 1068,-1372.82 1068,-1372.82 1068,-2603.21 1068,-2603.21 1068,-2609.21 1062,-2615.21 1056,-2615.21 1056,-2615.21 280,-2615.21 280,-2615.21 274,-2615.21 268,-2609.21 268,-2603.21 268,-2603.21 268,-1372.82 268,-1372.82 268,-1366.82 274,-1360.82 280,-1360.82"/>
<text text-anchor="middle" x="668" y="-2600.01" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (Layers 8&#45;11)</text>
<text text-anchor="middle" x="668" y="-2585.01" font-family="Times,serif" font-size="14.00">GPUs: 256&#45;383</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer8_attn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="576,-2115.78 576,-2569.21 761,-2569.21 761,-2115.78 576,-2115.78"/>
<text text-anchor="middle" x="668.5" y="-2554.01" font-family="Times,serif" font-size="14.00">Layer 8 Attention (TP4)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer8_moe</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="276,-1368.82 276,-2082.78 1060,-2082.78 1060,-1368.82 276,-1368.82"/>
<text text-anchor="middle" x="668" y="-2067.58" font-family="Times,serif" font-size="14.00">Layer 8 MoE (EP32)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_stage3</title>
<path fill="none" stroke="black" d="M280,-98.43C280,-98.43 1056,-98.43 1056,-98.43 1062,-98.43 1068,-104.43 1068,-110.43 1068,-110.43 1068,-1340.82 1068,-1340.82 1068,-1346.82 1062,-1352.82 1056,-1352.82 1056,-1352.82 280,-1352.82 280,-1352.82 274,-1352.82 268,-1346.82 268,-1340.82 268,-1340.82 268,-110.43 268,-110.43 268,-104.43 274,-98.43 280,-98.43"/>
<text text-anchor="middle" x="668" y="-1337.62" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (Layers 12&#45;15)</text>
<text text-anchor="middle" x="668" y="-1322.62" font-family="Times,serif" font-size="14.00">GPUs: 384&#45;511</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer12_attn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="571,-853.39 571,-1306.82 765,-1306.82 765,-853.39 571,-853.39"/>
<text text-anchor="middle" x="668" y="-1291.62" font-family="Times,serif" font-size="14.00">Layer 12 Attention (TP4)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer12_moe</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="276,-106.43 276,-820.39 1060,-820.39 1060,-106.43 276,-106.43"/>
<text text-anchor="middle" x="668" y="-805.19" font-family="Times,serif" font-size="14.00">Layer 12 MoE (EP32)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="668" cy="-5176.99" rx="101.23" ry="28.98"/>
<text text-anchor="middle" x="668" y="-5185.49" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="668" y="-5174.49" font-family="Arial" font-size="10.00">[BS=128, SL=1024, H=1024]</text>
<text text-anchor="middle" x="668" y="-5163.49" font-family="Arial" font-size="10.00">DP8: 16 seqs per GPU</text>
</g>
<!-- l0_attn_qkv -->
<g id="node2" class="node">
<title>l0_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="719.5,-5062.99 616.5,-5062.99 616.5,-5010.99 719.5,-5010.99 719.5,-5062.99"/>
<text text-anchor="middle" x="668" y="-5050.99" font-family="Arial" font-size="10.00">L0&#45;Attention&#45;QKV</text>
<text text-anchor="middle" x="668" y="-5039.99" font-family="Arial" font-size="10.00">TP4[0&#45;3]</text>
<text text-anchor="middle" x="668" y="-5028.99" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-5017.99" font-family="Arial" font-size="10.00">Out: [16,1024,3072]</text>
</g>
<!-- input&#45;&gt;l0_attn_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_attn_qkv</title>
<path fill="none" stroke="black" d="M668,-5147.73C668,-5126.26 668,-5096.59 668,-5073.51"/>
<polygon fill="black" stroke="black" points="671.5,-5073.43 668,-5063.43 664.5,-5073.43 671.5,-5073.43"/>
</g>
<!-- l0_attn_allreduce -->
<g id="node5" class="node">
<title>l0_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-4917.78" rx="82.96" ry="21.43"/>
<text text-anchor="middle" x="668" y="-4920.78" font-family="Arial" font-size="10.00">L0&#45;Attention&#45;AllReduce</text>
<text text-anchor="middle" x="668" y="-4909.78" font-family="Arial" font-size="10.00">TP4[0&#45;3]</text>
</g>
<!-- l0_attn_qkv&#45;&gt;l0_attn_allreduce -->
<g id="edge2" class="edge">
<title>l0_attn_qkv&#45;&gt;l0_attn_allreduce</title>
<path fill="none" stroke="black" d="M668,-5010.85C668,-4992.8 668,-4968.38 668,-4949.23"/>
<polygon fill="black" stroke="black" points="671.5,-4949.21 668,-4939.21 664.5,-4949.21 671.5,-4949.21"/>
</g>
<!-- l0_attn_score -->
<g id="node3" class="node">
<title>l0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="726,-4824.57 610,-4824.57 610,-4772.57 726,-4772.57 726,-4824.57"/>
<text text-anchor="middle" x="668" y="-4812.57" font-family="Arial" font-size="10.00">L0&#45;Attention&#45;Score</text>
<text text-anchor="middle" x="668" y="-4801.57" font-family="Arial" font-size="10.00">TP4[0&#45;3]</text>
<text text-anchor="middle" x="668" y="-4790.57" font-family="Arial" font-size="10.00">In: [16,16,1024,64]</text>
<text text-anchor="middle" x="668" y="-4779.57" font-family="Arial" font-size="10.00">Out: [16,16,1024,1024]</text>
</g>
<!-- l0_attn_out -->
<g id="node4" class="node">
<title>l0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="719.5,-4700.57 616.5,-4700.57 616.5,-4648.57 719.5,-4648.57 719.5,-4700.57"/>
<text text-anchor="middle" x="668" y="-4688.57" font-family="Arial" font-size="10.00">L0&#45;Attention&#45;Output</text>
<text text-anchor="middle" x="668" y="-4677.57" font-family="Arial" font-size="10.00">TP4[0&#45;3]</text>
<text text-anchor="middle" x="668" y="-4666.57" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-4655.57" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l0_attn_score&#45;&gt;l0_attn_out -->
<g id="edge4" class="edge">
<title>l0_attn_score&#45;&gt;l0_attn_out</title>
<path fill="none" stroke="black" d="M668,-4772.29C668,-4754.54 668,-4730.56 668,-4710.92"/>
<polygon fill="black" stroke="black" points="671.5,-4710.81 668,-4700.81 664.5,-4710.81 671.5,-4710.81"/>
</g>
<!-- l0_route -->
<g id="node6" class="node">
<title>l0_route</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-4576.57 605.04,-4576.57 561.43,-4472.57 730.96,-4472.57 774.57,-4576.57"/>
<text text-anchor="middle" x="668" y="-4538.57" font-family="Arial" font-size="10.00">L0&#45;Expert&#45;Routing</text>
<text text-anchor="middle" x="668" y="-4527.57" font-family="Arial" font-size="10.00">EP32[0&#45;31]</text>
<text text-anchor="middle" x="668" y="-4516.57" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-4505.57" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l0_attn_out&#45;&gt;l0_route -->
<g id="edge5" class="edge">
<title>l0_attn_out&#45;&gt;l0_route</title>
<path fill="none" stroke="black" d="M668,-4648.46C668,-4631.52 668,-4608.38 668,-4586.75"/>
<polygon fill="black" stroke="black" points="671.5,-4586.62 668,-4576.62 664.5,-4586.62 671.5,-4586.62"/>
</g>
<!-- l0_attn_allreduce&#45;&gt;l0_attn_score -->
<g id="edge3" class="edge">
<title>l0_attn_allreduce&#45;&gt;l0_attn_score</title>
<path fill="none" stroke="black" d="M668,-4896.36C668,-4879.38 668,-4854.83 668,-4834.7"/>
<polygon fill="black" stroke="black" points="671.5,-4834.64 668,-4824.64 664.5,-4834.64 671.5,-4834.64"/>
</g>
<!-- l0_dispatch -->
<g id="node7" class="node">
<title>l0_dispatch</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-4371.58" rx="71.34" ry="28.98"/>
<text text-anchor="middle" x="668" y="-4380.08" font-family="Arial" font-size="10.00">L0&#45;Expert&#45;Dispatch</text>
<text text-anchor="middle" x="668" y="-4369.08" font-family="Arial" font-size="10.00">EP32[0&#45;31]</text>
<text text-anchor="middle" x="668" y="-4358.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l0_route&#45;&gt;l0_dispatch -->
<g id="edge6" class="edge">
<title>l0_route&#45;&gt;l0_dispatch</title>
<path fill="none" stroke="black" d="M668,-4472.45C668,-4452.33 668,-4429.62 668,-4410.95"/>
<polygon fill="black" stroke="black" points="671.5,-4410.76 668,-4400.76 664.5,-4410.76 671.5,-4410.76"/>
</g>
<!-- l0_expert_0_1 -->
<g id="node8" class="node">
<title>l0_expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="122,-4270.58 24,-4270.58 24,-4207.58 122,-4207.58 122,-4270.58"/>
<text text-anchor="middle" x="73" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;0,1</text>
<text text-anchor="middle" x="73" y="-4247.58" font-family="Arial" font-size="10.00">EP32[0&#45;3]</text>
<text text-anchor="middle" x="73" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="73" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="73" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_0_1 -->
<g id="edge7" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_0_1</title>
<path fill="none" stroke="black" d="M599.62,-4362.95C497.71,-4350.41 300.74,-4321.57 140,-4270.58 137.26,-4269.72 134.48,-4268.76 131.7,-4267.75"/>
<polygon fill="black" stroke="black" points="132.83,-4264.43 122.24,-4264.1 130.3,-4270.96 132.83,-4264.43"/>
</g>
<!-- l0_expert_2_3 -->
<g id="node9" class="node">
<title>l0_expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="256,-4270.58 158,-4270.58 158,-4207.58 256,-4207.58 256,-4270.58"/>
<text text-anchor="middle" x="207" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;2,3</text>
<text text-anchor="middle" x="207" y="-4247.58" font-family="Arial" font-size="10.00">EP32[4&#45;7]</text>
<text text-anchor="middle" x="207" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="207" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="207" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_2_3 -->
<g id="edge8" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_2_3</title>
<path fill="none" stroke="black" d="M604.54,-4358.13C525.8,-4341.85 388.02,-4310.64 274,-4270.58 271.29,-4269.63 268.53,-4268.61 265.77,-4267.54"/>
<polygon fill="black" stroke="black" points="266.94,-4264.24 256.35,-4263.74 264.32,-4270.73 266.94,-4264.24"/>
</g>
<!-- l0_expert_4_5 -->
<g id="node10" class="node">
<title>l0_expert_4_5</title>
<polygon fill="lightblue" stroke="black" points="390,-4270.58 292,-4270.58 292,-4207.58 390,-4207.58 390,-4270.58"/>
<text text-anchor="middle" x="341" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;4,5</text>
<text text-anchor="middle" x="341" y="-4247.58" font-family="Arial" font-size="10.00">EP32[8&#45;11]</text>
<text text-anchor="middle" x="341" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="341" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="341" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_4_5 -->
<g id="edge9" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_4_5</title>
<path fill="none" stroke="black" d="M615.84,-4351.57C563.08,-4332.09 479.36,-4300.52 408,-4270.58 405.2,-4269.41 402.35,-4268.19 399.47,-4266.95"/>
<polygon fill="black" stroke="black" points="400.81,-4263.72 390.25,-4262.91 398,-4270.13 400.81,-4263.72"/>
</g>
<!-- l0_expert_6_7 -->
<g id="node11" class="node">
<title>l0_expert_6_7</title>
<polygon fill="lightblue" stroke="black" points="516,-4270.58 426,-4270.58 426,-4207.58 516,-4207.58 516,-4270.58"/>
<text text-anchor="middle" x="471" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;6,7</text>
<text text-anchor="middle" x="471" y="-4247.58" font-family="Arial" font-size="10.00">EP32[12&#45;15]</text>
<text text-anchor="middle" x="471" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="471" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="471" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1021024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_6_7 -->
<g id="edge10" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_6_7</title>
<path fill="none" stroke="black" d="M631.41,-4346.34C601.35,-4326.43 558.36,-4297.95 524.45,-4275.49"/>
<polygon fill="black" stroke="black" points="526.31,-4272.53 516.04,-4269.92 522.45,-4278.36 526.31,-4272.53"/>
</g>
<!-- l0_expert_8_9 -->
<g id="node12" class="node">
<title>l0_expert_8_9</title>
<polygon fill="lightblue" stroke="black" points="650,-4270.58 552,-4270.58 552,-4207.58 650,-4207.58 650,-4270.58"/>
<text text-anchor="middle" x="601" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;8,9</text>
<text text-anchor="middle" x="601" y="-4247.58" font-family="Arial" font-size="10.00">EP32[16&#45;19]</text>
<text text-anchor="middle" x="601" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="601" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="601" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_8_9 -->
<g id="edge11" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_8_9</title>
<path fill="none" stroke="black" d="M653.79,-4342.9C644.4,-4324.61 631.93,-4300.33 621.48,-4279.96"/>
<polygon fill="black" stroke="black" points="624.51,-4278.21 616.83,-4270.92 618.28,-4281.41 624.51,-4278.21"/>
</g>
<!-- l0_expert_10_11 -->
<g id="node13" class="node">
<title>l0_expert_10_11</title>
<polygon fill="lightblue" stroke="black" points="784,-4270.58 686,-4270.58 686,-4207.58 784,-4207.58 784,-4270.58"/>
<text text-anchor="middle" x="735" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;10,11</text>
<text text-anchor="middle" x="735" y="-4247.58" font-family="Arial" font-size="10.00">EP32[20&#45;23]</text>
<text text-anchor="middle" x="735" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="735" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="735" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_10_11 -->
<g id="edge12" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_10_11</title>
<path fill="none" stroke="black" d="M682.21,-4342.9C691.6,-4324.61 704.07,-4300.33 714.52,-4279.96"/>
<polygon fill="black" stroke="black" points="717.72,-4281.41 719.17,-4270.92 711.49,-4278.21 717.72,-4281.41"/>
</g>
<!-- l0_expert_12_13 -->
<g id="node14" class="node">
<title>l0_expert_12_13</title>
<polygon fill="lightblue" stroke="black" points="918,-4270.58 820,-4270.58 820,-4207.58 918,-4207.58 918,-4270.58"/>
<text text-anchor="middle" x="869" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;12,13</text>
<text text-anchor="middle" x="869" y="-4247.58" font-family="Arial" font-size="10.00">EP32[24&#45;27]</text>
<text text-anchor="middle" x="869" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="869" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="869" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_12_13 -->
<g id="edge13" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_12_13</title>
<path fill="none" stroke="black" d="M704.87,-4346.64C735.17,-4326.97 778.57,-4298.79 813.14,-4276.35"/>
<polygon fill="black" stroke="black" points="815.24,-4279.16 821.72,-4270.78 811.43,-4273.29 815.24,-4279.16"/>
</g>
<!-- l0_expert_14_15 -->
<g id="node15" class="node">
<title>l0_expert_14_15</title>
<polygon fill="lightblue" stroke="black" points="1052,-4270.58 954,-4270.58 954,-4207.58 1052,-4207.58 1052,-4270.58"/>
<text text-anchor="middle" x="1003" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;14,15</text>
<text text-anchor="middle" x="1003" y="-4247.58" font-family="Arial" font-size="10.00">EP32[28&#45;31]</text>
<text text-anchor="middle" x="1003" y="-4236.58" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="1003" y="-4225.58" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="1003" y="-4214.58" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_14_15 -->
<g id="edge14" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_14_15</title>
<path fill="none" stroke="black" d="M721.06,-4352.02C775.43,-4332.71 862.23,-4301.09 936,-4270.58 938.8,-4269.43 941.66,-4268.22 944.54,-4266.98"/>
<polygon fill="black" stroke="black" points="946,-4270.17 953.78,-4262.97 943.21,-4263.75 946,-4270.17"/>
</g>
<!-- l0_expert_16_23 -->
<g id="node16" class="node">
<title>l0_expert_16_23</title>
<polygon fill="lightblue" stroke="black" points="1186,-4270.58 1088,-4270.58 1088,-4207.58 1186,-4207.58 1186,-4270.58"/>
<text text-anchor="middle" x="1137" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;16&#45;23</text>
<text text-anchor="middle" x="1137" y="-4247.58" font-family="Arial" font-size="10.00">EP32[32&#45;63]</text>
<text text-anchor="middle" x="1137" y="-4236.58" font-family="Arial" font-size="10.00">(8 experts total)</text>
<text text-anchor="middle" x="1137" y="-4225.58" font-family="Arial" font-size="10.00">In: [4,1024,1024]</text>
<text text-anchor="middle" x="1137" y="-4214.58" font-family="Arial" font-size="10.00">Out: [4,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_16_23 -->
<g id="edge15" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_16_23</title>
<path fill="none" stroke="black" d="M732.06,-4358.43C812.29,-4342.36 953.37,-4311.25 1070,-4270.58 1072.72,-4269.64 1075.47,-4268.62 1078.24,-4267.56"/>
<polygon fill="black" stroke="black" points="1079.68,-4270.75 1087.66,-4263.77 1077.07,-4264.25 1079.68,-4270.75"/>
</g>
<!-- l0_expert_24_31 -->
<g id="node17" class="node">
<title>l0_expert_24_31</title>
<polygon fill="lightblue" stroke="black" points="1320,-4270.58 1222,-4270.58 1222,-4207.58 1320,-4207.58 1320,-4270.58"/>
<text text-anchor="middle" x="1271" y="-4258.58" font-family="Arial" font-size="10.00">L0&#45;Experts&#45;24&#45;31</text>
<text text-anchor="middle" x="1271" y="-4247.58" font-family="Arial" font-size="10.00">EP32[64&#45;95]</text>
<text text-anchor="middle" x="1271" y="-4236.58" font-family="Arial" font-size="10.00">(8 experts total)</text>
<text text-anchor="middle" x="1271" y="-4225.58" font-family="Arial" font-size="10.00">In: [4,1024,1024]</text>
<text text-anchor="middle" x="1271" y="-4214.58" font-family="Arial" font-size="10.00">Out: [4,1024,1024]</text>
</g>
<!-- l0_dispatch&#45;&gt;l0_expert_24_31 -->
<g id="edge16" class="edge">
<title>l0_dispatch&#45;&gt;l0_expert_24_31</title>
<path fill="none" stroke="black" d="M736.56,-4363.19C839.77,-4350.87 1040.39,-4322.24 1204,-4270.58 1206.74,-4269.72 1209.52,-4268.77 1212.31,-4267.76"/>
<polygon fill="black" stroke="black" points="1213.7,-4270.97 1221.77,-4264.11 1211.18,-4264.44 1213.7,-4270.97"/>
</g>
<!-- l0_combine -->
<g id="node18" class="node">
<title>l0_combine</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-4135.58 605.04,-4135.58 561.43,-4031.58 730.96,-4031.58 774.57,-4135.58"/>
<text text-anchor="middle" x="668" y="-4097.58" font-family="Arial" font-size="10.00">L0&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-4086.58" font-family="Arial" font-size="10.00">EP32[0&#45;31]</text>
<text text-anchor="middle" x="668" y="-4075.58" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-4064.58" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l0_expert_0_1&#45;&gt;l0_combine -->
<g id="edge17" class="edge">
<title>l0_expert_0_1&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122.32,-4214.31C128.21,-4211.87 134.19,-4209.56 140,-4207.58 290.62,-4156.32 472.56,-4119.13 578.77,-4099.77"/>
<polygon fill="black" stroke="black" points="579.59,-4103.18 588.81,-4097.96 578.34,-4096.29 579.59,-4103.18"/>
</g>
<!-- l0_expert_2_3&#45;&gt;l0_combine -->
<g id="edge18" class="edge">
<title>l0_expert_2_3&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256.1,-4214.89C262.08,-4212.32 268.15,-4209.82 274,-4207.58 378.32,-4167.74 501.63,-4130.82 582.16,-4108.04"/>
<polygon fill="black" stroke="black" points="583.57,-4111.28 592.25,-4105.19 581.68,-4104.54 583.57,-4111.28"/>
</g>
<!-- l0_expert_4_5&#45;&gt;l0_combine -->
<g id="edge19" class="edge">
<title>l0_expert_4_5&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390.31,-4214.94C442.66,-4190.36 526.22,-4151.14 588.02,-4122.13"/>
<polygon fill="black" stroke="black" points="589.79,-4125.17 597.35,-4117.75 586.81,-4118.83 589.79,-4125.17"/>
</g>
<!-- l0_expert_6_7&#45;&gt;l0_combine -->
<g id="edge20" class="edge">
<title>l0_expert_6_7&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M510.39,-4207.39C534.92,-4188.28 567.21,-4163.12 596.18,-4140.55"/>
<polygon fill="black" stroke="black" points="598.51,-4143.17 604.25,-4134.26 594.21,-4137.65 598.51,-4143.17"/>
</g>
<!-- l0_expert_8_9&#45;&gt;l0_combine -->
<g id="edge21" class="edge">
<title>l0_expert_8_9&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M614.4,-4207.39C622.18,-4189.56 632.26,-4166.46 641.58,-4145.11"/>
<polygon fill="black" stroke="black" points="644.86,-4146.34 645.66,-4135.78 638.45,-4143.54 644.86,-4146.34"/>
</g>
<!-- l0_expert_10_11&#45;&gt;l0_combine -->
<g id="edge22" class="edge">
<title>l0_expert_10_11&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M721.6,-4207.39C713.82,-4189.56 703.74,-4166.46 694.42,-4145.11"/>
<polygon fill="black" stroke="black" points="697.55,-4143.54 690.34,-4135.78 691.14,-4146.34 697.55,-4143.54"/>
</g>
<!-- l0_expert_12_13&#45;&gt;l0_combine -->
<g id="edge23" class="edge">
<title>l0_expert_12_13&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M828.81,-4207.39C804.3,-4188.68 772.21,-4164.17 743.14,-4141.97"/>
<polygon fill="black" stroke="black" points="745.1,-4139.06 735.03,-4135.78 740.86,-4144.63 745.1,-4139.06"/>
</g>
<!-- l0_expert_14_15&#45;&gt;l0_combine -->
<g id="edge24" class="edge">
<title>l0_expert_14_15&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M953.93,-4215.6C909.16,-4195.09 841.29,-4163.99 782.91,-4137.24"/>
<polygon fill="black" stroke="black" points="784.17,-4133.97 773.62,-4132.98 781.26,-4140.33 784.17,-4133.97"/>
</g>
<!-- l0_expert_16_23&#45;&gt;l0_combine -->
<g id="edge25" class="edge">
<title>l0_expert_16_23&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" d="M1087.91,-4214.86C1081.93,-4212.29 1075.86,-4209.8 1070,-4207.58 971.29,-4170.2 855.81,-4135.8 774.02,-4112.94"/>
<polygon fill="black" stroke="black" points="774.78,-4109.52 764.21,-4110.21 772.91,-4116.27 774.78,-4109.52"/>
</g>
<!-- l0_expert_24_31&#45;&gt;l0_combine -->
<g id="edge26" class="edge">
<title>l0_expert_24_31&#45;&gt;l0_combine</title>
<path fill="none" stroke="black" d="M1221.69,-4214.29C1215.8,-4211.85 1209.81,-4209.55 1204,-4207.58 1056.23,-4157.57 878.73,-4121.29 769.66,-4101.59"/>
<polygon fill="black" stroke="black" points="770.1,-4098.11 759.64,-4099.79 768.87,-4105 770.1,-4098.11"/>
</g>
<!-- l0_combine_alltoall -->
<g id="node19" class="node">
<title>l0_combine_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-3930.59" rx="71.34" ry="28.98"/>
<text text-anchor="middle" x="668" y="-3939.09" font-family="Arial" font-size="10.00">L0&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-3928.09" font-family="Arial" font-size="10.00">EP32[0&#45;31]</text>
<text text-anchor="middle" x="668" y="-3917.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l0_combine&#45;&gt;l0_combine_alltoall -->
<g id="edge27" class="edge">
<title>l0_combine&#45;&gt;l0_combine_alltoall</title>
<path fill="none" stroke="black" d="M668,-4031.47C668,-4011.35 668,-3988.64 668,-3969.97"/>
<polygon fill="black" stroke="black" points="671.5,-3969.77 668,-3959.77 664.5,-3969.77 671.5,-3969.77"/>
</g>
<!-- l4_attn_qkv -->
<g id="node20" class="node">
<title>l4_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="719.5,-3800.6 616.5,-3800.6 616.5,-3748.6 719.5,-3748.6 719.5,-3800.6"/>
<text text-anchor="middle" x="668" y="-3788.6" font-family="Arial" font-size="10.00">L4&#45;Attention&#45;QKV</text>
<text text-anchor="middle" x="668" y="-3777.6" font-family="Arial" font-size="10.00">TP4[128&#45;131]</text>
<text text-anchor="middle" x="668" y="-3766.6" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-3755.6" font-family="Arial" font-size="10.00">Out: [16,1024,3072]</text>
</g>
<!-- l0_combine_alltoall&#45;&gt;l4_attn_qkv -->
<g id="edge28" class="edge">
<title>l0_combine_alltoall&#45;&gt;l4_attn_qkv</title>
<path fill="none" stroke="black" d="M668,-3901.35C668,-3875.9 668,-3838.38 668,-3810.95"/>
<polygon fill="black" stroke="black" points="671.5,-3810.61 668,-3800.61 664.5,-3810.61 671.5,-3810.61"/>
</g>
<!-- l4_attn_allreduce -->
<g id="node23" class="node">
<title>l4_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-3655.39" rx="82.96" ry="21.43"/>
<text text-anchor="middle" x="668" y="-3658.39" font-family="Arial" font-size="10.00">L4&#45;Attention&#45;AllReduce</text>
<text text-anchor="middle" x="668" y="-3647.39" font-family="Arial" font-size="10.00">TP4[128&#45;131]</text>
</g>
<!-- l4_attn_qkv&#45;&gt;l4_attn_allreduce -->
<g id="edge29" class="edge">
<title>l4_attn_qkv&#45;&gt;l4_attn_allreduce</title>
<path fill="none" stroke="black" d="M668,-3748.46C668,-3730.41 668,-3705.99 668,-3686.84"/>
<polygon fill="black" stroke="black" points="671.5,-3686.81 668,-3676.81 664.5,-3686.81 671.5,-3686.81"/>
</g>
<!-- l4_attn_score -->
<g id="node21" class="node">
<title>l4_attn_score</title>
<polygon fill="lightblue" stroke="black" points="726,-3562.18 610,-3562.18 610,-3510.18 726,-3510.18 726,-3562.18"/>
<text text-anchor="middle" x="668" y="-3550.18" font-family="Arial" font-size="10.00">L4&#45;Attention&#45;Score</text>
<text text-anchor="middle" x="668" y="-3539.18" font-family="Arial" font-size="10.00">TP4[128&#45;131]</text>
<text text-anchor="middle" x="668" y="-3528.18" font-family="Arial" font-size="10.00">In: [16,16,1024,64]</text>
<text text-anchor="middle" x="668" y="-3517.18" font-family="Arial" font-size="10.00">Out: [16,16,1024,1024]</text>
</g>
<!-- l4_attn_out -->
<g id="node22" class="node">
<title>l4_attn_out</title>
<polygon fill="lightblue" stroke="black" points="719.5,-3438.18 616.5,-3438.18 616.5,-3386.18 719.5,-3386.18 719.5,-3438.18"/>
<text text-anchor="middle" x="668" y="-3426.18" font-family="Arial" font-size="10.00">L4&#45;Attention&#45;Output</text>
<text text-anchor="middle" x="668" y="-3415.18" font-family="Arial" font-size="10.00">TP4[128&#45;131]</text>
<text text-anchor="middle" x="668" y="-3404.18" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-3393.18" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l4_attn_score&#45;&gt;l4_attn_out -->
<g id="edge31" class="edge">
<title>l4_attn_score&#45;&gt;l4_attn_out</title>
<path fill="none" stroke="black" d="M668,-3509.9C668,-3492.15 668,-3468.17 668,-3448.53"/>
<polygon fill="black" stroke="black" points="671.5,-3448.42 668,-3438.42 664.5,-3448.42 671.5,-3448.42"/>
</g>
<!-- l4_route -->
<g id="node24" class="node">
<title>l4_route</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-3314.18 605.04,-3314.18 561.43,-3210.18 730.96,-3210.18 774.57,-3314.18"/>
<text text-anchor="middle" x="668" y="-3276.18" font-family="Arial" font-size="10.00">L4&#45;Expert&#45;Routing</text>
<text text-anchor="middle" x="668" y="-3265.18" font-family="Arial" font-size="10.00">EP32[128&#45;159]</text>
<text text-anchor="middle" x="668" y="-3254.18" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-3243.18" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l4_attn_out&#45;&gt;l4_route -->
<g id="edge32" class="edge">
<title>l4_attn_out&#45;&gt;l4_route</title>
<path fill="none" stroke="black" d="M668,-3386.07C668,-3369.13 668,-3345.99 668,-3324.36"/>
<polygon fill="black" stroke="black" points="671.5,-3324.23 668,-3314.23 664.5,-3324.23 671.5,-3324.23"/>
</g>
<!-- l4_attn_allreduce&#45;&gt;l4_attn_score -->
<g id="edge30" class="edge">
<title>l4_attn_allreduce&#45;&gt;l4_attn_score</title>
<path fill="none" stroke="black" d="M668,-3633.97C668,-3616.99 668,-3592.44 668,-3572.31"/>
<polygon fill="black" stroke="black" points="671.5,-3572.25 668,-3562.25 664.5,-3572.25 671.5,-3572.25"/>
</g>
<!-- l4_dispatch -->
<g id="node25" class="node">
<title>l4_dispatch</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-3109.18" rx="71.34" ry="28.98"/>
<text text-anchor="middle" x="668" y="-3117.68" font-family="Arial" font-size="10.00">L4&#45;Expert&#45;Dispatch</text>
<text text-anchor="middle" x="668" y="-3106.68" font-family="Arial" font-size="10.00">EP32[128&#45;159]</text>
<text text-anchor="middle" x="668" y="-3095.68" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l4_route&#45;&gt;l4_dispatch -->
<g id="edge33" class="edge">
<title>l4_route&#45;&gt;l4_dispatch</title>
<path fill="none" stroke="black" d="M668,-3210.06C668,-3189.94 668,-3167.23 668,-3148.56"/>
<polygon fill="black" stroke="black" points="671.5,-3148.36 668,-3138.36 664.5,-3148.36 671.5,-3148.36"/>
</g>
<!-- l4_expert_0_1 -->
<g id="node26" class="node">
<title>l4_expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="382,-3008.19 284,-3008.19 284,-2945.19 382,-2945.19 382,-3008.19"/>
<text text-anchor="middle" x="333" y="-2996.19" font-family="Arial" font-size="10.00">L4&#45;Experts&#45;0,1</text>
<text text-anchor="middle" x="333" y="-2985.19" font-family="Arial" font-size="10.00">EP32[128&#45;131]</text>
<text text-anchor="middle" x="333" y="-2974.19" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="333" y="-2963.19" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="333" y="-2952.19" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l4_dispatch&#45;&gt;l4_expert_0_1 -->
<g id="edge34" class="edge">
<title>l4_dispatch&#45;&gt;l4_expert_0_1</title>
<path fill="none" stroke="black" d="M614.94,-3089.63C560.57,-3070.32 473.77,-3038.7 400,-3008.19 397.2,-3007.03 394.34,-3005.83 391.46,-3004.59"/>
<polygon fill="black" stroke="black" points="392.79,-3001.36 382.22,-3000.57 390,-3007.77 392.79,-3001.36"/>
</g>
<!-- l4_expert_2_3 -->
<g id="node27" class="node">
<title>l4_expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="516,-3008.19 418,-3008.19 418,-2945.19 516,-2945.19 516,-3008.19"/>
<text text-anchor="middle" x="467" y="-2996.19" font-family="Arial" font-size="10.00">L4&#45;Experts&#45;2,3</text>
<text text-anchor="middle" x="467" y="-2985.19" font-family="Arial" font-size="10.00">EP32[132&#45;135]</text>
<text text-anchor="middle" x="467" y="-2974.19" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="467" y="-2963.19" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="467" y="-2952.19" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l4_dispatch&#45;&gt;l4_expert_2_3 -->
<g id="edge35" class="edge">
<title>l4_dispatch&#45;&gt;l4_expert_2_3</title>
<path fill="none" stroke="black" d="M631.13,-3084.25C600.83,-3064.58 557.43,-3036.4 522.86,-3013.96"/>
<polygon fill="black" stroke="black" points="524.57,-3010.9 514.28,-3008.39 520.76,-3016.77 524.57,-3010.9"/>
</g>
<!-- l4_expert_4_5 -->
<g id="node28" class="node">
<title>l4_expert_4_5</title>
<polygon fill="lightblue" stroke="black" points="650,-3008.19 552,-3008.19 552,-2945.19 650,-2945.19 650,-3008.19"/>
<text text-anchor="middle" x="601" y="-2996.19" font-family="Arial" font-size="10.00">L4&#45;Experts&#45;4,5</text>
<text text-anchor="middle" x="601" y="-2985.19" font-family="Arial" font-size="10.00">EP32[136&#45;139]</text>
<text text-anchor="middle" x="601" y="-2974.19" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="601" y="-2963.19" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="601" y="-2952.19" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l4_dispatch&#45;&gt;l4_expert_4_5 -->
<g id="edge36" class="edge">
<title>l4_dispatch&#45;&gt;l4_expert_4_5</title>
<path fill="none" stroke="black" d="M653.79,-3080.51C644.4,-3062.22 631.93,-3037.94 621.48,-3017.57"/>
<polygon fill="black" stroke="black" points="624.51,-3015.82 616.83,-3008.52 618.28,-3019.02 624.51,-3015.82"/>
</g>
<!-- l4_expert_6_7 -->
<g id="node29" class="node">
<title>l4_expert_6_7</title>
<polygon fill="lightblue" stroke="black" points="784,-3008.19 686,-3008.19 686,-2945.19 784,-2945.19 784,-3008.19"/>
<text text-anchor="middle" x="735" y="-2996.19" font-family="Arial" font-size="10.00">L4&#45;Experts&#45;6,7</text>
<text text-anchor="middle" x="735" y="-2985.19" font-family="Arial" font-size="10.00">EP32[140&#45;143]</text>
<text text-anchor="middle" x="735" y="-2974.19" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="735" y="-2963.19" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="735" y="-2952.19" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l4_dispatch&#45;&gt;l4_expert_6_7 -->
<g id="edge37" class="edge">
<title>l4_dispatch&#45;&gt;l4_expert_6_7</title>
<path fill="none" stroke="black" d="M682.21,-3080.51C691.6,-3062.22 704.07,-3037.94 714.52,-3017.57"/>
<polygon fill="black" stroke="black" points="717.72,-3019.02 719.17,-3008.52 711.49,-3015.82 717.72,-3019.02"/>
</g>
<!-- l4_expert_8_15 -->
<g id="node30" class="node">
<title>l4_expert_8_15</title>
<polygon fill="lightblue" stroke="black" points="918,-3008.19 820,-3008.19 820,-2945.19 918,-2945.19 918,-3008.19"/>
<text text-anchor="middle" x="869" y="-2996.19" font-family="Arial" font-size="10.00">L4&#45;Experts&#45;8&#45;15</text>
<text text-anchor="middle" x="869" y="-2985.19" font-family="Arial" font-size="10.00">EP32[144&#45;159]</text>
<text text-anchor="middle" x="869" y="-2974.19" font-family="Arial" font-size="10.00">(8 experts total)</text>
<text text-anchor="middle" x="869" y="-2963.19" font-family="Arial" font-size="10.00">In: [4,1024,1024]</text>
<text text-anchor="middle" x="869" y="-2952.19" font-family="Arial" font-size="10.00">Out: [4,1024,1024]</text>
</g>
<!-- l4_dispatch&#45;&gt;l4_expert_8_15 -->
<g id="edge38" class="edge">
<title>l4_dispatch&#45;&gt;l4_expert_8_15</title>
<path fill="none" stroke="black" d="M704.87,-3084.25C735.17,-3064.58 778.57,-3036.4 813.14,-3013.96"/>
<polygon fill="black" stroke="black" points="815.24,-3016.77 821.72,-3008.39 811.43,-3010.9 815.24,-3016.77"/>
</g>
<!-- l4_expert_16_31 -->
<g id="node31" class="node">
<title>l4_expert_16_31</title>
<polygon fill="lightblue" stroke="black" points="1052,-3008.19 954,-3008.19 954,-2945.19 1052,-2945.19 1052,-3008.19"/>
<text text-anchor="middle" x="1003" y="-2996.19" font-family="Arial" font-size="10.00">L4&#45;Experts&#45;16&#45;31</text>
<text text-anchor="middle" x="1003" y="-2985.19" font-family="Arial" font-size="10.00">EP32[160&#45;191]</text>
<text text-anchor="middle" x="1003" y="-2974.19" font-family="Arial" font-size="10.00">(16 experts total)</text>
<text text-anchor="middle" x="1003" y="-2963.19" font-family="Arial" font-size="10.00">In: [8,1024,1024]</text>
<text text-anchor="middle" x="1003" y="-2952.19" font-family="Arial" font-size="10.00">Out: [8,1024,1024]</text>
</g>
<!-- l4_dispatch&#45;&gt;l4_expert_16_31 -->
<g id="edge39" class="edge">
<title>l4_dispatch&#45;&gt;l4_expert_16_31</title>
<path fill="none" stroke="black" d="M721.06,-3089.63C775.43,-3070.32 862.23,-3038.7 936,-3008.19 938.8,-3007.03 941.66,-3005.83 944.54,-3004.59"/>
<polygon fill="black" stroke="black" points="946,-3007.77 953.78,-3000.57 943.21,-3001.36 946,-3007.77"/>
</g>
<!-- l4_combine -->
<g id="node32" class="node">
<title>l4_combine</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-2873.19 605.04,-2873.19 561.43,-2769.19 730.96,-2769.19 774.57,-2873.19"/>
<text text-anchor="middle" x="668" y="-2835.19" font-family="Arial" font-size="10.00">L4&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-2824.19" font-family="Arial" font-size="10.00">EP32[128&#45;159]</text>
<text text-anchor="middle" x="668" y="-2813.19" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-2802.19" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l4_expert_0_1&#45;&gt;l4_combine -->
<g id="edge40" class="edge">
<title>l4_expert_0_1&#45;&gt;l4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382.07,-2953.21C436.11,-2928.44 523.84,-2888.25 587.88,-2858.9"/>
<polygon fill="black" stroke="black" points="589.52,-2862 597.15,-2854.66 586.6,-2855.64 589.52,-2862"/>
</g>
<!-- l4_expert_2_3&#45;&gt;l4_combine -->
<g id="edge41" class="edge">
<title>l4_expert_2_3&#45;&gt;l4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.19,-2945C532.43,-2925.73 565.72,-2900.3 595.46,-2877.59"/>
<polygon fill="black" stroke="black" points="597.92,-2880.12 603.74,-2871.27 593.67,-2874.55 597.92,-2880.12"/>
</g>
<!-- l4_expert_4_5&#45;&gt;l4_combine -->
<g id="edge42" class="edge">
<title>l4_expert_4_5&#45;&gt;l4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M614.4,-2945C622.18,-2927.17 632.26,-2904.07 641.58,-2882.72"/>
<polygon fill="black" stroke="black" points="644.86,-2883.95 645.66,-2873.38 638.45,-2881.15 644.86,-2883.95"/>
</g>
<!-- l4_expert_6_7&#45;&gt;l4_combine -->
<g id="edge43" class="edge">
<title>l4_expert_6_7&#45;&gt;l4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M721.6,-2945C713.82,-2927.17 703.74,-2904.07 694.42,-2882.72"/>
<polygon fill="black" stroke="black" points="697.55,-2881.15 690.34,-2873.38 691.14,-2883.95 697.55,-2881.15"/>
</g>
<!-- l4_expert_8_15&#45;&gt;l4_combine -->
<g id="edge44" class="edge">
<title>l4_expert_8_15&#45;&gt;l4_combine</title>
<path fill="none" stroke="black" d="M828.81,-2945C804.3,-2926.29 772.21,-2901.78 743.14,-2879.58"/>
<polygon fill="black" stroke="black" points="745.1,-2876.67 735.03,-2873.38 740.86,-2882.24 745.1,-2876.67"/>
</g>
<!-- l4_expert_16_31&#45;&gt;l4_combine -->
<g id="edge45" class="edge">
<title>l4_expert_16_31&#45;&gt;l4_combine</title>
<path fill="none" stroke="black" d="M953.93,-2953.21C909.16,-2932.7 841.29,-2901.6 782.91,-2874.84"/>
<polygon fill="black" stroke="black" points="784.17,-2871.57 773.62,-2870.59 781.26,-2877.94 784.17,-2871.57"/>
</g>
<!-- l4_combine_alltoall -->
<g id="node33" class="node">
<title>l4_combine_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-2668.2" rx="71.34" ry="28.98"/>
<text text-anchor="middle" x="668" y="-2676.7" font-family="Arial" font-size="10.00">L4&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-2665.7" font-family="Arial" font-size="10.00">EP32[128&#45;159]</text>
<text text-anchor="middle" x="668" y="-2654.7" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l4_combine&#45;&gt;l4_combine_alltoall -->
<g id="edge46" class="edge">
<title>l4_combine&#45;&gt;l4_combine_alltoall</title>
<path fill="none" stroke="black" d="M668,-2769.07C668,-2748.96 668,-2726.25 668,-2707.58"/>
<polygon fill="black" stroke="black" points="671.5,-2707.38 668,-2697.38 664.5,-2707.38 671.5,-2707.38"/>
</g>
<!-- l8_attn_qkv -->
<g id="node34" class="node">
<title>l8_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="719.5,-2538.21 616.5,-2538.21 616.5,-2486.21 719.5,-2486.21 719.5,-2538.21"/>
<text text-anchor="middle" x="668" y="-2526.21" font-family="Arial" font-size="10.00">L8&#45;Attention&#45;QKV</text>
<text text-anchor="middle" x="668" y="-2515.21" font-family="Arial" font-size="10.00">TP4[256&#45;259]</text>
<text text-anchor="middle" x="668" y="-2504.21" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-2493.21" font-family="Arial" font-size="10.00">Out: [16,1024,3072]</text>
</g>
<!-- l4_combine_alltoall&#45;&gt;l8_attn_qkv -->
<g id="edge47" class="edge">
<title>l4_combine_alltoall&#45;&gt;l8_attn_qkv</title>
<path fill="none" stroke="black" d="M668,-2638.96C668,-2613.51 668,-2575.99 668,-2548.56"/>
<polygon fill="black" stroke="black" points="671.5,-2548.22 668,-2538.22 664.5,-2548.22 671.5,-2548.22"/>
</g>
<!-- l8_attn_allreduce -->
<g id="node37" class="node">
<title>l8_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-2393" rx="82.96" ry="21.43"/>
<text text-anchor="middle" x="668" y="-2396" font-family="Arial" font-size="10.00">L8&#45;Attention&#45;AllReduce</text>
<text text-anchor="middle" x="668" y="-2385" font-family="Arial" font-size="10.00">TP4[256&#45;259]</text>
</g>
<!-- l8_attn_qkv&#45;&gt;l8_attn_allreduce -->
<g id="edge48" class="edge">
<title>l8_attn_qkv&#45;&gt;l8_attn_allreduce</title>
<path fill="none" stroke="black" d="M668,-2486.07C668,-2468.02 668,-2443.6 668,-2424.45"/>
<polygon fill="black" stroke="black" points="671.5,-2424.42 668,-2414.42 664.5,-2424.42 671.5,-2424.42"/>
</g>
<!-- l8_attn_score -->
<g id="node35" class="node">
<title>l8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="726,-2299.78 610,-2299.78 610,-2247.78 726,-2247.78 726,-2299.78"/>
<text text-anchor="middle" x="668" y="-2287.78" font-family="Arial" font-size="10.00">L8&#45;Attention&#45;Score</text>
<text text-anchor="middle" x="668" y="-2276.78" font-family="Arial" font-size="10.00">TP4[256&#45;259]</text>
<text text-anchor="middle" x="668" y="-2265.78" font-family="Arial" font-size="10.00">In: [16,16,1024,64]</text>
<text text-anchor="middle" x="668" y="-2254.78" font-family="Arial" font-size="10.00">Out: [16,16,1024,1024]</text>
</g>
<!-- l8_attn_out -->
<g id="node36" class="node">
<title>l8_attn_out</title>
<polygon fill="lightblue" stroke="black" points="719.5,-2175.78 616.5,-2175.78 616.5,-2123.78 719.5,-2123.78 719.5,-2175.78"/>
<text text-anchor="middle" x="668" y="-2163.78" font-family="Arial" font-size="10.00">L8&#45;Attention&#45;Output</text>
<text text-anchor="middle" x="668" y="-2152.78" font-family="Arial" font-size="10.00">TP4[256&#45;259]</text>
<text text-anchor="middle" x="668" y="-2141.78" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-2130.78" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l8_attn_score&#45;&gt;l8_attn_out -->
<g id="edge50" class="edge">
<title>l8_attn_score&#45;&gt;l8_attn_out</title>
<path fill="none" stroke="black" d="M668,-2247.51C668,-2229.76 668,-2205.78 668,-2186.14"/>
<polygon fill="black" stroke="black" points="671.5,-2186.03 668,-2176.03 664.5,-2186.03 671.5,-2186.03"/>
</g>
<!-- l8_route -->
<g id="node38" class="node">
<title>l8_route</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-2051.78 605.04,-2051.78 561.43,-1947.78 730.96,-1947.78 774.57,-2051.78"/>
<text text-anchor="middle" x="668" y="-2013.78" font-family="Arial" font-size="10.00">L8&#45;Expert&#45;Routing</text>
<text text-anchor="middle" x="668" y="-2002.78" font-family="Arial" font-size="10.00">EP32[256&#45;287]</text>
<text text-anchor="middle" x="668" y="-1991.78" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-1980.78" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l8_attn_out&#45;&gt;l8_route -->
<g id="edge51" class="edge">
<title>l8_attn_out&#45;&gt;l8_route</title>
<path fill="none" stroke="black" d="M668,-2123.68C668,-2106.73 668,-2083.6 668,-2061.97"/>
<polygon fill="black" stroke="black" points="671.5,-2061.84 668,-2051.84 664.5,-2061.84 671.5,-2061.84"/>
</g>
<!-- l8_attn_allreduce&#45;&gt;l8_attn_score -->
<g id="edge49" class="edge">
<title>l8_attn_allreduce&#45;&gt;l8_attn_score</title>
<path fill="none" stroke="black" d="M668,-2371.58C668,-2354.6 668,-2330.05 668,-2309.92"/>
<polygon fill="black" stroke="black" points="671.5,-2309.86 668,-2299.86 664.5,-2309.86 671.5,-2309.86"/>
</g>
<!-- l8_dispatch -->
<g id="node39" class="node">
<title>l8_dispatch</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-1846.79" rx="71.34" ry="28.98"/>
<text text-anchor="middle" x="668" y="-1855.29" font-family="Arial" font-size="10.00">L8&#45;Expert&#45;Dispatch</text>
<text text-anchor="middle" x="668" y="-1844.29" font-family="Arial" font-size="10.00">EP32[256&#45;287]</text>
<text text-anchor="middle" x="668" y="-1833.29" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l8_route&#45;&gt;l8_dispatch -->
<g id="edge52" class="edge">
<title>l8_route&#45;&gt;l8_dispatch</title>
<path fill="none" stroke="black" d="M668,-1947.67C668,-1927.55 668,-1904.84 668,-1886.17"/>
<polygon fill="black" stroke="black" points="671.5,-1885.97 668,-1875.97 664.5,-1885.97 671.5,-1885.97"/>
</g>
<!-- l8_expert_0_1 -->
<g id="node40" class="node">
<title>l8_expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="382,-1745.8 284,-1745.8 284,-1682.8 382,-1682.8 382,-1745.8"/>
<text text-anchor="middle" x="333" y="-1733.8" font-family="Arial" font-size="10.00">L8&#45;Experts&#45;0,1</text>
<text text-anchor="middle" x="333" y="-1722.8" font-family="Arial" font-size="10.00">EP32[256&#45;259]</text>
<text text-anchor="middle" x="333" y="-1711.8" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="333" y="-1700.8" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="333" y="-1689.8" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l8_dispatch&#45;&gt;l8_expert_0_1 -->
<g id="edge53" class="edge">
<title>l8_dispatch&#45;&gt;l8_expert_0_1</title>
<path fill="none" stroke="black" d="M614.94,-1827.24C560.57,-1807.93 473.77,-1776.31 400,-1745.8 397.2,-1744.64 394.34,-1743.44 391.46,-1742.2"/>
<polygon fill="black" stroke="black" points="392.79,-1738.96 382.22,-1738.18 390,-1745.38 392.79,-1738.96"/>
</g>
<!-- l8_expert_2_3 -->
<g id="node41" class="node">
<title>l8_expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="516,-1745.8 418,-1745.8 418,-1682.8 516,-1682.8 516,-1745.8"/>
<text text-anchor="middle" x="467" y="-1733.8" font-family="Arial" font-size="10.00">L8&#45;Experts&#45;2,3</text>
<text text-anchor="middle" x="467" y="-1722.8" font-family="Arial" font-size="10.00">EP32[260&#45;263]</text>
<text text-anchor="middle" x="467" y="-1711.8" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="467" y="-1700.8" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="467" y="-1689.8" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l8_dispatch&#45;&gt;l8_expert_2_3 -->
<g id="edge54" class="edge">
<title>l8_dispatch&#45;&gt;l8_expert_2_3</title>
<path fill="none" stroke="black" d="M631.13,-1821.86C600.83,-1802.19 557.43,-1774.01 522.86,-1751.57"/>
<polygon fill="black" stroke="black" points="524.57,-1748.5 514.28,-1745.99 520.76,-1754.37 524.57,-1748.5"/>
</g>
<!-- l8_expert_4_5 -->
<g id="node42" class="node">
<title>l8_expert_4_5</title>
<polygon fill="lightblue" stroke="black" points="650,-1745.8 552,-1745.8 552,-1682.8 650,-1682.8 650,-1745.8"/>
<text text-anchor="middle" x="601" y="-1733.8" font-family="Arial" font-size="10.00">L8&#45;Experts&#45;4,5</text>
<text text-anchor="middle" x="601" y="-1722.8" font-family="Arial" font-size="10.00">EP32[264&#45;267]</text>
<text text-anchor="middle" x="601" y="-1711.8" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="601" y="-1700.8" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="601" y="-1689.8" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l8_dispatch&#45;&gt;l8_expert_4_5 -->
<g id="edge55" class="edge">
<title>l8_dispatch&#45;&gt;l8_expert_4_5</title>
<path fill="none" stroke="black" d="M653.79,-1818.12C644.4,-1799.82 631.93,-1775.55 621.48,-1755.18"/>
<polygon fill="black" stroke="black" points="624.51,-1753.43 616.83,-1746.13 618.28,-1756.63 624.51,-1753.43"/>
</g>
<!-- l8_expert_6_7 -->
<g id="node43" class="node">
<title>l8_expert_6_7</title>
<polygon fill="lightblue" stroke="black" points="784,-1745.8 686,-1745.8 686,-1682.8 784,-1682.8 784,-1745.8"/>
<text text-anchor="middle" x="735" y="-1733.8" font-family="Arial" font-size="10.00">L8&#45;Experts&#45;6,7</text>
<text text-anchor="middle" x="735" y="-1722.8" font-family="Arial" font-size="10.00">EP32[268&#45;271]</text>
<text text-anchor="middle" x="735" y="-1711.8" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="735" y="-1700.8" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="735" y="-1689.8" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l8_dispatch&#45;&gt;l8_expert_6_7 -->
<g id="edge56" class="edge">
<title>l8_dispatch&#45;&gt;l8_expert_6_7</title>
<path fill="none" stroke="black" d="M682.21,-1818.12C691.6,-1799.82 704.07,-1775.55 714.52,-1755.18"/>
<polygon fill="black" stroke="black" points="717.72,-1756.63 719.17,-1746.13 711.49,-1753.43 717.72,-1756.63"/>
</g>
<!-- l8_expert_8_15 -->
<g id="node44" class="node">
<title>l8_expert_8_15</title>
<polygon fill="lightblue" stroke="black" points="918,-1745.8 820,-1745.8 820,-1682.8 918,-1682.8 918,-1745.8"/>
<text text-anchor="middle" x="869" y="-1733.8" font-family="Arial" font-size="10.00">L8&#45;Experts&#45;8&#45;15</text>
<text text-anchor="middle" x="869" y="-1722.8" font-family="Arial" font-size="10.00">EP32[272&#45;287]</text>
<text text-anchor="middle" x="869" y="-1711.8" font-family="Arial" font-size="10.00">(8 experts total)</text>
<text text-anchor="middle" x="869" y="-1700.8" font-family="Arial" font-size="10.00">In: [4,1024,1024]</text>
<text text-anchor="middle" x="869" y="-1689.8" font-family="Arial" font-size="10.00">Out: [4,1024,1024]</text>
</g>
<!-- l8_dispatch&#45;&gt;l8_expert_8_15 -->
<g id="edge57" class="edge">
<title>l8_dispatch&#45;&gt;l8_expert_8_15</title>
<path fill="none" stroke="black" d="M704.87,-1821.86C735.17,-1802.19 778.57,-1774.01 813.14,-1751.57"/>
<polygon fill="black" stroke="black" points="815.24,-1754.37 821.72,-1745.99 811.43,-1748.5 815.24,-1754.37"/>
</g>
<!-- l8_expert_16_31 -->
<g id="node45" class="node">
<title>l8_expert_16_31</title>
<polygon fill="lightblue" stroke="black" points="1052,-1745.8 954,-1745.8 954,-1682.8 1052,-1682.8 1052,-1745.8"/>
<text text-anchor="middle" x="1003" y="-1733.8" font-family="Arial" font-size="10.00">L8&#45;Experts&#45;16&#45;31</text>
<text text-anchor="middle" x="1003" y="-1722.8" font-family="Arial" font-size="10.00">EP32[288&#45;383]</text>
<text text-anchor="middle" x="1003" y="-1711.8" font-family="Arial" font-size="10.00">(16 experts total)</text>
<text text-anchor="middle" x="1003" y="-1700.8" font-family="Arial" font-size="10.00">In: [8,1024,1024]</text>
<text text-anchor="middle" x="1003" y="-1689.8" font-family="Arial" font-size="10.00">Out: [8,1024,1024]</text>
</g>
<!-- l8_dispatch&#45;&gt;l8_expert_16_31 -->
<g id="edge58" class="edge">
<title>l8_dispatch&#45;&gt;l8_expert_16_31</title>
<path fill="none" stroke="black" d="M721.06,-1827.24C775.43,-1807.93 862.23,-1776.31 936,-1745.8 938.8,-1744.64 941.66,-1743.44 944.54,-1742.2"/>
<polygon fill="black" stroke="black" points="946,-1745.38 953.78,-1738.18 943.21,-1738.96 946,-1745.38"/>
</g>
<!-- l8_combine -->
<g id="node46" class="node">
<title>l8_combine</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-1610.8 605.04,-1610.8 561.43,-1506.8 730.96,-1506.8 774.57,-1610.8"/>
<text text-anchor="middle" x="668" y="-1572.8" font-family="Arial" font-size="10.00">L8&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-1561.8" font-family="Arial" font-size="10.00">EP32[256&#45;287]</text>
<text text-anchor="middle" x="668" y="-1550.8" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-1539.8" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l8_expert_0_1&#45;&gt;l8_combine -->
<g id="edge59" class="edge">
<title>l8_expert_0_1&#45;&gt;l8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382.07,-1690.82C436.11,-1666.05 523.84,-1625.86 587.88,-1596.51"/>
<polygon fill="black" stroke="black" points="589.52,-1599.61 597.15,-1592.26 586.6,-1593.25 589.52,-1599.61"/>
</g>
<!-- l8_expert_2_3&#45;&gt;l8_combine -->
<g id="edge60" class="edge">
<title>l8_expert_2_3&#45;&gt;l8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.19,-1682.61C532.43,-1663.33 565.72,-1637.91 595.46,-1615.2"/>
<polygon fill="black" stroke="black" points="597.92,-1617.72 603.74,-1608.87 593.67,-1612.16 597.92,-1617.72"/>
</g>
<!-- l8_expert_4_5&#45;&gt;l8_combine -->
<g id="edge61" class="edge">
<title>l8_expert_4_5&#45;&gt;l8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M614.4,-1682.61C622.18,-1664.77 632.26,-1641.67 641.58,-1620.33"/>
<polygon fill="black" stroke="black" points="644.86,-1621.56 645.66,-1610.99 638.45,-1618.76 644.86,-1621.56"/>
</g>
<!-- l8_expert_6_7&#45;&gt;l8_combine -->
<g id="edge62" class="edge">
<title>l8_expert_6_7&#45;&gt;l8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M721.6,-1682.61C713.82,-1664.77 703.74,-1641.67 694.42,-1620.33"/>
<polygon fill="black" stroke="black" points="697.55,-1618.76 690.34,-1610.99 691.14,-1621.56 697.55,-1618.76"/>
</g>
<!-- l8_expert_8_15&#45;&gt;l8_combine -->
<g id="edge63" class="edge">
<title>l8_expert_8_15&#45;&gt;l8_combine</title>
<path fill="none" stroke="black" d="M828.81,-1682.61C804.3,-1663.89 772.21,-1639.38 743.14,-1617.19"/>
<polygon fill="black" stroke="black" points="745.1,-1614.28 735.03,-1610.99 740.86,-1619.84 745.1,-1614.28"/>
</g>
<!-- l8_expert_16_31&#45;&gt;l8_combine -->
<g id="edge64" class="edge">
<title>l8_expert_16_31&#45;&gt;l8_combine</title>
<path fill="none" stroke="black" d="M953.93,-1690.82C909.16,-1670.3 841.29,-1639.2 782.91,-1612.45"/>
<polygon fill="black" stroke="black" points="784.17,-1609.18 773.62,-1608.2 781.26,-1615.55 784.17,-1609.18"/>
</g>
<!-- l8_combine_alltoall -->
<g id="node47" class="node">
<title>l8_combine_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-1405.81" rx="71.34" ry="28.98"/>
<text text-anchor="middle" x="668" y="-1414.31" font-family="Arial" font-size="10.00">L8&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-1403.31" font-family="Arial" font-size="10.00">EP32[256&#45;287]</text>
<text text-anchor="middle" x="668" y="-1392.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l8_combine&#45;&gt;l8_combine_alltoall -->
<g id="edge65" class="edge">
<title>l8_combine&#45;&gt;l8_combine_alltoall</title>
<path fill="none" stroke="black" d="M668,-1506.68C668,-1486.56 668,-1463.86 668,-1445.19"/>
<polygon fill="black" stroke="black" points="671.5,-1444.99 668,-1434.99 664.5,-1444.99 671.5,-1444.99"/>
</g>
<!-- l12_attn_qkv -->
<g id="node48" class="node">
<title>l12_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="719.5,-1275.82 616.5,-1275.82 616.5,-1223.82 719.5,-1223.82 719.5,-1275.82"/>
<text text-anchor="middle" x="668" y="-1263.82" font-family="Arial" font-size="10.00">L12&#45;Attention&#45;QKV</text>
<text text-anchor="middle" x="668" y="-1252.82" font-family="Arial" font-size="10.00">TP4[384&#45;387]</text>
<text text-anchor="middle" x="668" y="-1241.82" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-1230.82" font-family="Arial" font-size="10.00">Out: [16,1024,3072]</text>
</g>
<!-- l8_combine_alltoall&#45;&gt;l12_attn_qkv -->
<g id="edge66" class="edge">
<title>l8_combine_alltoall&#45;&gt;l12_attn_qkv</title>
<path fill="none" stroke="black" d="M668,-1376.57C668,-1351.12 668,-1313.6 668,-1286.17"/>
<polygon fill="black" stroke="black" points="671.5,-1285.83 668,-1275.83 664.5,-1285.83 671.5,-1285.83"/>
</g>
<!-- l12_attn_allreduce -->
<g id="node51" class="node">
<title>l12_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-1130.61" rx="86.03" ry="21.43"/>
<text text-anchor="middle" x="668" y="-1133.61" font-family="Arial" font-size="10.00">L12&#45;Attention&#45;AllReduce</text>
<text text-anchor="middle" x="668" y="-1122.61" font-family="Arial" font-size="10.00">TP4[384&#45;387]</text>
</g>
<!-- l12_attn_qkv&#45;&gt;l12_attn_allreduce -->
<g id="edge67" class="edge">
<title>l12_attn_qkv&#45;&gt;l12_attn_allreduce</title>
<path fill="none" stroke="black" d="M668,-1223.67C668,-1205.62 668,-1181.21 668,-1162.05"/>
<polygon fill="black" stroke="black" points="671.5,-1162.03 668,-1152.03 664.5,-1162.03 671.5,-1162.03"/>
</g>
<!-- l12_attn_score -->
<g id="node49" class="node">
<title>l12_attn_score</title>
<polygon fill="lightblue" stroke="black" points="726,-1037.39 610,-1037.39 610,-985.39 726,-985.39 726,-1037.39"/>
<text text-anchor="middle" x="668" y="-1025.39" font-family="Arial" font-size="10.00">L12&#45;Attention&#45;Score</text>
<text text-anchor="middle" x="668" y="-1014.39" font-family="Arial" font-size="10.00">TP4[384&#45;387]</text>
<text text-anchor="middle" x="668" y="-1003.39" font-family="Arial" font-size="10.00">In: [16,16,1024,64]</text>
<text text-anchor="middle" x="668" y="-992.39" font-family="Arial" font-size="10.00">Out: [16,16,1024,1024]</text>
</g>
<!-- l12_attn_out -->
<g id="node50" class="node">
<title>l12_attn_out</title>
<polygon fill="lightblue" stroke="black" points="719.5,-913.39 616.5,-913.39 616.5,-861.39 719.5,-861.39 719.5,-913.39"/>
<text text-anchor="middle" x="668" y="-901.39" font-family="Arial" font-size="10.00">L12&#45;Attention&#45;</text>
<text text-anchor="middle" x="668" y="-890.39" font-family="Arial" font-size="10.00">TP4[384&#45;387]</text>
<text text-anchor="middle" x="668" y="-879.39" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-868.39" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l12_attn_score&#45;&gt;l12_attn_out -->
<g id="edge69" class="edge">
<title>l12_attn_score&#45;&gt;l12_attn_out</title>
<path fill="none" stroke="black" d="M668,-985.11C668,-967.37 668,-943.39 668,-923.75"/>
<polygon fill="black" stroke="black" points="671.5,-923.64 668,-913.64 664.5,-923.64 671.5,-923.64"/>
</g>
<!-- l12_route -->
<g id="node52" class="node">
<title>l12_route</title>
<polygon fill="lightyellow" stroke="black" points="774.57,-789.39 605.04,-789.39 561.43,-685.39 730.96,-685.39 774.57,-789.39"/>
<text text-anchor="middle" x="668" y="-751.39" font-family="Arial" font-size="10.00">L12&#45;Expert&#45;Routing</text>
<text text-anchor="middle" x="668" y="-740.39" font-family="Arial" font-size="10.00">EP32[384&#45;415]</text>
<text text-anchor="middle" x="668" y="-729.39" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-718.39" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l12_attn_out&#45;&gt;l12_route -->
<g id="edge70" class="edge">
<title>l12_attn_out&#45;&gt;l12_route</title>
<path fill="none" stroke="black" d="M668,-861.29C668,-844.34 668,-821.21 668,-799.58"/>
<polygon fill="black" stroke="black" points="671.5,-799.44 668,-789.44 664.5,-799.44 671.5,-799.44"/>
</g>
<!-- l12_attn_allreduce&#45;&gt;l12_attn_score -->
<g id="edge68" class="edge">
<title>l12_attn_allreduce&#45;&gt;l12_attn_score</title>
<path fill="none" stroke="black" d="M668,-1109.19C668,-1092.21 668,-1067.65 668,-1047.52"/>
<polygon fill="black" stroke="black" points="671.5,-1047.47 668,-1037.47 664.5,-1047.47 671.5,-1047.47"/>
</g>
<!-- l12_dispatch -->
<g id="node53" class="node">
<title>l12_dispatch</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-584.4" rx="74.91" ry="28.98"/>
<text text-anchor="middle" x="668" y="-592.9" font-family="Arial" font-size="10.00">L12&#45;Expert&#45;Dispatch</text>
<text text-anchor="middle" x="668" y="-581.9" font-family="Arial" font-size="10.00">EP32[384&#45;415]</text>
<text text-anchor="middle" x="668" y="-570.9" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l12_route&#45;&gt;l12_dispatch -->
<g id="edge71" class="edge">
<title>l12_route&#45;&gt;l12_dispatch</title>
<path fill="none" stroke="black" d="M668,-685.27C668,-665.15 668,-642.45 668,-623.78"/>
<polygon fill="black" stroke="black" points="671.5,-623.58 668,-613.58 664.5,-623.58 671.5,-623.58"/>
</g>
<!-- l12_expert_0_1 -->
<g id="node54" class="node">
<title>l12_expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="382,-483.41 284,-483.41 284,-420.41 382,-420.41 382,-483.41"/>
<text text-anchor="middle" x="333" y="-471.41" font-family="Arial" font-size="10.00">L12&#45;Experts&#45;0,1</text>
<text text-anchor="middle" x="333" y="-460.41" font-family="Arial" font-size="10.00">EP32[384&#45;387]</text>
<text text-anchor="middle" x="333" y="-449.41" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="333" y="-438.41" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="333" y="-427.41" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l12_dispatch&#45;&gt;l12_expert_0_1 -->
<g id="edge72" class="edge">
<title>l12_dispatch&#45;&gt;l12_expert_0_1</title>
<path fill="none" stroke="black" d="M613.67,-564.39C559.22,-545.05 473.2,-513.68 400,-483.41 397.2,-482.25 394.34,-481.04 391.46,-479.81"/>
<polygon fill="black" stroke="black" points="392.79,-476.57 382.22,-475.79 390,-482.99 392.79,-476.57"/>
</g>
<!-- l12_expert_2_3 -->
<g id="node55" class="node">
<title>l12_expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="516,-483.41 418,-483.41 418,-420.41 516,-420.41 516,-483.41"/>
<text text-anchor="middle" x="467" y="-471.41" font-family="Arial" font-size="10.00">L12&#45;Experts&#45;2,3</text>
<text text-anchor="middle" x="467" y="-460.41" font-family="Arial" font-size="10.00">EP32[388&#45;391]</text>
<text text-anchor="middle" x="467" y="-449.41" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="467" y="-438.41" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="467" y="-427.41" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l12_dispatch&#45;&gt;l12_expert_2_3 -->
<g id="edge73" class="edge">
<title>l12_dispatch&#45;&gt;l12_expert_2_3</title>
<path fill="none" stroke="black" d="M630.66,-559.16C600.31,-539.46 557.04,-511.36 522.61,-489.01"/>
<polygon fill="black" stroke="black" points="524.35,-485.97 514.06,-483.46 520.54,-491.84 524.35,-485.97"/>
</g>
<!-- l12_expert_4_5 -->
<g id="node56" class="node">
<title>l12_expert_4_5</title>
<polygon fill="lightblue" stroke="black" points="650,-483.41 552,-483.41 552,-420.41 650,-420.41 650,-483.41"/>
<text text-anchor="middle" x="601" y="-471.41" font-family="Arial" font-size="10.00">L12&#45;Experts&#45;4,5</text>
<text text-anchor="middle" x="601" y="-460.41" font-family="Arial" font-size="10.00">EP32[392&#45;395]</text>
<text text-anchor="middle" x="601" y="-449.41" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="601" y="-438.41" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="601" y="-427.41" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l12_dispatch&#45;&gt;l12_expert_4_5 -->
<g id="edge74" class="edge">
<title>l12_dispatch&#45;&gt;l12_expert_4_5</title>
<path fill="none" stroke="black" d="M653.79,-555.73C644.4,-537.43 631.93,-513.16 621.48,-492.79"/>
<polygon fill="black" stroke="black" points="624.51,-491.04 616.83,-483.74 618.28,-494.24 624.51,-491.04"/>
</g>
<!-- l12_expert_6_7 -->
<g id="node57" class="node">
<title>l12_expert_6_7</title>
<polygon fill="lightblue" stroke="black" points="784,-483.41 686,-483.41 686,-420.41 784,-420.41 784,-483.41"/>
<text text-anchor="middle" x="735" y="-471.41" font-family="Arial" font-size="10.00">L12&#45;Experts&#45;6,7</text>
<text text-anchor="middle" x="735" y="-460.41" font-family="Arial" font-size="10.00">EP32[396&#45;399]</text>
<text text-anchor="middle" x="735" y="-449.41" font-family="Arial" font-size="10.00">(2 experts)</text>
<text text-anchor="middle" x="735" y="-438.41" font-family="Arial" font-size="10.00">In: [1,1024,1024]</text>
<text text-anchor="middle" x="735" y="-427.41" font-family="Arial" font-size="10.00">Out: [1,1024,1024]</text>
</g>
<!-- l12_dispatch&#45;&gt;l12_expert_6_7 -->
<g id="edge75" class="edge">
<title>l12_dispatch&#45;&gt;l12_expert_6_7</title>
<path fill="none" stroke="black" d="M682.21,-555.73C691.6,-537.43 704.07,-513.16 714.52,-492.79"/>
<polygon fill="black" stroke="black" points="717.72,-494.24 719.17,-483.74 711.49,-491.04 717.72,-494.24"/>
</g>
<!-- l12_expert_8_15 -->
<g id="node58" class="node">
<title>l12_expert_8_15</title>
<polygon fill="lightblue" stroke="black" points="918,-483.41 820,-483.41 820,-420.41 918,-420.41 918,-483.41"/>
<text text-anchor="middle" x="869" y="-471.41" font-family="Arial" font-size="10.00">L12&#45;Experts&#45;8&#45;15</text>
<text text-anchor="middle" x="869" y="-460.41" font-family="Arial" font-size="10.00">EP32[400&#45;415]</text>
<text text-anchor="middle" x="869" y="-449.41" font-family="Arial" font-size="10.00">(8 experts total)</text>
<text text-anchor="middle" x="869" y="-438.41" font-family="Arial" font-size="10.00">In: [4,1024,1024]</text>
<text text-anchor="middle" x="869" y="-427.41" font-family="Arial" font-size="10.00">Out: [4,1024,1024]</text>
</g>
<!-- l12_dispatch&#45;&gt;l12_expert_8_15 -->
<g id="edge76" class="edge">
<title>l12_dispatch&#45;&gt;l12_expert_8_15</title>
<path fill="none" stroke="black" d="M705.34,-559.16C735.69,-539.46 778.96,-511.36 813.39,-489.01"/>
<polygon fill="black" stroke="black" points="815.46,-491.84 821.94,-483.46 811.65,-485.97 815.46,-491.84"/>
</g>
<!-- l12_expert_16_31 -->
<g id="node59" class="node">
<title>l12_expert_16_31</title>
<polygon fill="lightblue" stroke="black" points="1052,-483.41 954,-483.41 954,-420.41 1052,-420.41 1052,-483.41"/>
<text text-anchor="middle" x="1003" y="-471.41" font-family="Arial" font-size="10.00">L12&#45;Experts&#45;16&#45;31</text>
<text text-anchor="middle" x="1003" y="-460.41" font-family="Arial" font-size="10.00">EP32[416&#45;479]</text>
<text text-anchor="middle" x="1003" y="-449.41" font-family="Arial" font-size="10.00">(16 experts total)</text>
<text text-anchor="middle" x="1003" y="-438.41" font-family="Arial" font-size="10.00">In: [8,1024,1024]</text>
<text text-anchor="middle" x="1003" y="-427.41" font-family="Arial" font-size="10.00">Out: [8,1024,1024]</text>
</g>
<!-- l12_dispatch&#45;&gt;l12_expert_16_31 -->
<g id="edge77" class="edge">
<title>l12_dispatch&#45;&gt;l12_expert_16_31</title>
<path fill="none" stroke="black" d="M722.33,-564.39C776.78,-545.05 862.8,-513.68 936,-483.41 938.8,-482.25 941.66,-481.04 944.54,-479.81"/>
<polygon fill="black" stroke="black" points="946,-482.99 953.78,-475.79 943.21,-476.57 946,-482.99"/>
</g>
<!-- l12_combine -->
<g id="node60" class="node">
<title>l12_combine</title>
<polygon fill="lightyellow" stroke="black" points="777.79,-348.41 603.14,-348.41 558.21,-244.41 732.86,-244.41 777.79,-348.41"/>
<text text-anchor="middle" x="668" y="-310.41" font-family="Arial" font-size="10.00">L12&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-299.41" font-family="Arial" font-size="10.00">EP32[384&#45;415]</text>
<text text-anchor="middle" x="668" y="-288.41" font-family="Arial" font-size="10.00">In: [16,1024,1024]</text>
<text text-anchor="middle" x="668" y="-277.41" font-family="Arial" font-size="10.00">Out: [16,1024,1024]</text>
</g>
<!-- l12_expert_0_1&#45;&gt;l12_combine -->
<g id="edge78" class="edge">
<title>l12_expert_0_1&#45;&gt;l12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382.07,-428.42C435.6,-403.9 522.15,-364.24 586.03,-334.97"/>
<polygon fill="black" stroke="black" points="587.65,-338.08 595.28,-330.73 584.73,-331.71 587.65,-338.08"/>
</g>
<!-- l12_expert_2_3&#45;&gt;l12_combine -->
<g id="edge79" class="edge">
<title>l12_expert_2_3&#45;&gt;l12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M507.19,-420.22C532.12,-401.18 564.89,-376.15 594.35,-353.66"/>
<polygon fill="black" stroke="black" points="596.73,-356.24 602.56,-347.39 592.48,-350.67 596.73,-356.24"/>
</g>
<!-- l12_expert_4_5&#45;&gt;l12_combine -->
<g id="edge80" class="edge">
<title>l12_expert_4_5&#45;&gt;l12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M614.4,-420.22C622.18,-402.38 632.26,-379.28 641.58,-357.94"/>
<polygon fill="black" stroke="black" points="644.86,-359.17 645.66,-348.6 638.45,-356.37 644.86,-359.17"/>
</g>
<!-- l12_expert_6_7&#45;&gt;l12_combine -->
<g id="edge81" class="edge">
<title>l12_expert_6_7&#45;&gt;l12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M721.6,-420.22C713.82,-402.38 703.74,-379.28 694.42,-357.94"/>
<polygon fill="black" stroke="black" points="697.55,-356.37 690.34,-348.6 691.14,-359.17 697.55,-356.37"/>
</g>
<!-- l12_expert_8_15&#45;&gt;l12_combine -->
<g id="edge82" class="edge">
<title>l12_expert_8_15&#45;&gt;l12_combine</title>
<path fill="none" stroke="black" d="M828.81,-420.22C804.3,-401.5 772.21,-376.99 743.14,-354.79"/>
<polygon fill="black" stroke="black" points="745.1,-351.89 735.03,-348.6 740.86,-357.45 745.1,-351.89"/>
</g>
<!-- l12_expert_16_31&#45;&gt;l12_combine -->
<g id="edge83" class="edge">
<title>l12_expert_16_31&#45;&gt;l12_combine</title>
<path fill="none" stroke="black" d="M953.93,-428.42C910.11,-408.35 844.16,-378.13 786.63,-351.77"/>
<polygon fill="black" stroke="black" points="788.03,-348.56 777.48,-347.57 785.11,-354.92 788.03,-348.56"/>
</g>
<!-- l12_combine_alltoall -->
<g id="node61" class="node">
<title>l12_combine_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="668" cy="-143.42" rx="74.91" ry="28.98"/>
<text text-anchor="middle" x="668" y="-151.92" font-family="Arial" font-size="10.00">L12&#45;Expert&#45;Combine</text>
<text text-anchor="middle" x="668" y="-140.92" font-family="Arial" font-size="10.00">EP32[384&#45;415]</text>
<text text-anchor="middle" x="668" y="-129.92" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- l12_combine&#45;&gt;l12_combine_alltoall -->
<g id="edge84" class="edge">
<title>l12_combine&#45;&gt;l12_combine_alltoall</title>
<path fill="none" stroke="black" d="M668,-244.29C668,-224.17 668,-201.47 668,-182.79"/>
<polygon fill="black" stroke="black" points="671.5,-182.6 668,-172.6 664.5,-182.6 671.5,-182.6"/>
</g>
<!-- output -->
<g id="node62" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="668" cy="-21.21" rx="101.23" ry="21.43"/>
<text text-anchor="middle" x="668" y="-24.21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="668" y="-13.21" font-family="Arial" font-size="10.00">[BS=128, SL=1024, H=1024]</text>
</g>
<!-- l12_combine_alltoall&#45;&gt;output -->
<g id="edge85" class="edge">
<title>l12_combine_alltoall&#45;&gt;output</title>
<path fill="none" stroke="black" d="M668,-114.24C668,-95.82 668,-71.77 668,-52.88"/>
<polygon fill="black" stroke="black" points="671.5,-52.7 668,-42.7 664.5,-52.7 671.5,-52.7"/>
</g>
</g>
</svg>
