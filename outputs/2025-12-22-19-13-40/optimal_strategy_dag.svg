<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="6925pt" height="5200pt"
 viewBox="0.00 0.00 6925.00 5199.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5195.83)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5195.83 6921,-5195.83 6921,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightgray" stroke="black" d="M83,-3866.39C83,-3866.39 6829,-3866.39 6829,-3866.39 6835,-3866.39 6841,-3872.39 6841,-3878.39 6841,-3878.39 6841,-5078.87 6841,-5078.87 6841,-5084.87 6835,-5090.87 6829,-5090.87 6829,-5090.87 83,-5090.87 83,-5090.87 77,-5090.87 71,-5084.87 71,-5078.87 71,-5078.87 71,-3878.39 71,-3878.39 71,-3872.39 77,-3866.39 83,-3866.39"/>
<text text-anchor="middle" x="3456" y="-5075.67" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;3)</text>
<text text-anchor="middle" x="3456" y="-5060.67" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;127</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgray" stroke="black" d="M126,-2623.91C126,-2623.91 6897,-2623.91 6897,-2623.91 6903,-2623.91 6909,-2629.91 6909,-2635.91 6909,-2635.91 6909,-3836.39 6909,-3836.39 6909,-3842.39 6903,-3848.39 6897,-3848.39 6897,-3848.39 126,-3848.39 126,-3848.39 120,-3848.39 114,-3842.39 114,-3836.39 114,-3836.39 114,-2635.91 114,-2635.91 114,-2629.91 120,-2623.91 126,-2623.91"/>
<text text-anchor="middle" x="3511.5" y="-3833.19" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 4&#45;7)</text>
<text text-anchor="middle" x="3511.5" y="-3818.19" font-family="Times,serif" font-size="14.00">GPUs: 128&#45;255</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="lightgray" stroke="black" d="M73,-1381.43C73,-1381.43 6844,-1381.43 6844,-1381.43 6850,-1381.43 6856,-1387.43 6856,-1393.43 6856,-1393.43 6856,-2593.91 6856,-2593.91 6856,-2599.91 6850,-2605.91 6844,-2605.91 6844,-2605.91 73,-2605.91 73,-2605.91 67,-2605.91 61,-2599.91 61,-2593.91 61,-2593.91 61,-1393.43 61,-1393.43 61,-1387.43 67,-1381.43 73,-1381.43"/>
<text text-anchor="middle" x="3458.5" y="-2590.71" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (Layers 8&#45;11)</text>
<text text-anchor="middle" x="3458.5" y="-2575.71" font-family="Times,serif" font-size="14.00">GPUs: 256&#45;383</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="lightgray" stroke="black" d="M20,-138.95C20,-138.95 6791,-138.95 6791,-138.95 6797,-138.95 6803,-144.95 6803,-150.95 6803,-150.95 6803,-1351.43 6803,-1351.43 6803,-1357.43 6797,-1363.43 6791,-1363.43 6791,-1363.43 20,-1363.43 20,-1363.43 14,-1363.43 8,-1357.43 8,-1351.43 8,-1351.43 8,-150.95 8,-150.95 8,-144.95 14,-138.95 20,-138.95"/>
<text text-anchor="middle" x="3405.5" y="-1348.23" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (Layers 12&#45;15)</text>
<text text-anchor="middle" x="3405.5" y="-1333.23" font-family="Times,serif" font-size="14.00">GPUs: 384&#45;511</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="3453" cy="-5154.35" rx="251.96" ry="37.45"/>
<text text-anchor="middle" x="3453" y="-5165.65" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="3453" y="-5150.65" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="3453" y="-5135.65" font-family="Times,serif" font-size="14.00">DP8: 16 seqs per GPU</text>
</g>
<!-- layer0_attn_qkv_tp -->
<g id="node2" class="node">
<title>layer0_attn_qkv_tp</title>
<polygon fill="lightblue" stroke="black" points="3545.5,-5044.87 3360.5,-5044.87 3360.5,-4976.87 3545.5,-4976.87 3545.5,-5044.87"/>
<text text-anchor="middle" x="3453" y="-5029.67" font-family="Times,serif" font-size="14.00">Layer 0 Attention QKV</text>
<text text-anchor="middle" x="3453" y="-5014.67" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 0&#45;3]</text>
<text text-anchor="middle" x="3453" y="-4999.67" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3453" y="-4984.67" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- input&#45;&gt;layer0_attn_qkv_tp -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_attn_qkv_tp</title>
<path fill="none" stroke="black" d="M3453,-5116.55C3453,-5097.81 3453,-5074.91 3453,-5055.31"/>
<polygon fill="black" stroke="black" points="3456.5,-5055.11 3453,-5045.11 3449.5,-5055.11 3456.5,-5055.11"/>
</g>
<!-- layer0_attn_score -->
<g id="node3" class="node">
<title>layer0_attn_score</title>
<polygon fill="lightblue" stroke="black" points="3557,-4904.87 3349,-4904.87 3349,-4836.87 3557,-4836.87 3557,-4904.87"/>
<text text-anchor="middle" x="3453" y="-4889.67" font-family="Times,serif" font-size="14.00">Layer 0 Attention Score</text>
<text text-anchor="middle" x="3453" y="-4874.67" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 0&#45;3]</text>
<text text-anchor="middle" x="3453" y="-4859.67" font-family="Times,serif" font-size="14.00">Input: [16,16,1024,64]</text>
<text text-anchor="middle" x="3453" y="-4844.67" font-family="Times,serif" font-size="14.00">Output: [16,16,1024,1024]</text>
</g>
<!-- layer0_attn_qkv_tp&#45;&gt;layer0_attn_score -->
<g id="edge2" class="edge">
<title>layer0_attn_qkv_tp&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M3453,-4976.82C3453,-4958.35 3453,-4935.11 3453,-4915.2"/>
<polygon fill="black" stroke="black" points="3456.5,-4915.14 3453,-4905.14 3449.5,-4915.14 3456.5,-4915.14"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node39" class="node">
<title>layer0_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3453" cy="-4738" rx="115.93" ry="26.74"/>
<text text-anchor="middle" x="3453" y="-4741.8" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3453" y="-4726.8" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 0&#45;3]</text>
</g>
<!-- layer0_attn_score&#45;&gt;layer0_attn_allreduce -->
<g id="edge3" class="edge">
<title>layer0_attn_score&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M3453,-4836.85C3453,-4818.07 3453,-4794.52 3453,-4775.23"/>
<polygon fill="black" stroke="black" points="3456.5,-4775.01 3453,-4765.01 3449.5,-4775.01 3456.5,-4775.01"/>
</g>
<!-- layer0_attn_out_tp -->
<g id="node4" class="node">
<title>layer0_attn_out_tp</title>
<polygon fill="lightblue" stroke="black" points="3551.5,-4639.13 3354.5,-4639.13 3354.5,-4571.13 3551.5,-4571.13 3551.5,-4639.13"/>
<text text-anchor="middle" x="3453" y="-4623.93" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output</text>
<text text-anchor="middle" x="3453" y="-4608.93" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 0&#45;3]</text>
<text text-anchor="middle" x="3453" y="-4593.93" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3453" y="-4578.93" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer0_route -->
<g id="node5" class="node">
<title>layer0_route</title>
<polygon fill="lightyellow" stroke="black" points="3644.6,-4499.13 3339.81,-4499.13 3261.4,-4363.13 3566.19,-4363.13 3644.6,-4499.13"/>
<text text-anchor="middle" x="3453" y="-4449.93" font-family="Times,serif" font-size="14.00">Layer 0 Expert Routing</text>
<text text-anchor="middle" x="3453" y="-4434.93" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 0&#45;31]</text>
<text text-anchor="middle" x="3453" y="-4419.93" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3453" y="-4404.93" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer0_attn_out_tp&#45;&gt;layer0_route -->
<g id="edge5" class="edge">
<title>layer0_attn_out_tp&#45;&gt;layer0_route</title>
<path fill="none" stroke="black" d="M3453,-4570.97C3453,-4553.44 3453,-4531.13 3453,-4509.55"/>
<polygon fill="black" stroke="black" points="3456.5,-4509.37 3453,-4499.37 3449.5,-4509.37 3456.5,-4509.37"/>
</g>
<!-- layer0_moe_alltoall -->
<g id="node40" class="node">
<title>layer0_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="3453" cy="-4264.26" rx="106.13" ry="26.74"/>
<text text-anchor="middle" x="3453" y="-4268.06" font-family="Times,serif" font-size="14.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3453" y="-4253.06" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 0&#45;31]</text>
</g>
<!-- layer0_route&#45;&gt;layer0_moe_alltoall -->
<g id="edge6" class="edge">
<title>layer0_route&#45;&gt;layer0_moe_alltoall</title>
<path fill="none" stroke="black" d="M3453,-4363.08C3453,-4342.06 3453,-4319.66 3453,-4301.61"/>
<polygon fill="black" stroke="black" points="3456.5,-4301.52 3453,-4291.52 3449.5,-4301.52 3456.5,-4301.52"/>
</g>
<!-- layer0_expert_group_0 -->
<g id="node6" class="node">
<title>layer0_expert_group_0</title>
<polygon fill="lightblue" stroke="black" points="255,-4165.39 79,-4165.39 79,-4082.39 255,-4082.39 255,-4165.39"/>
<text text-anchor="middle" x="167" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 0</text>
<text text-anchor="middle" x="167" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="167" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 0&#45;3]</text>
<text text-anchor="middle" x="167" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="167" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_combine -->
<g id="node38" class="node">
<title>layer0_combine</title>
<polygon fill="lightyellow" stroke="black" points="3608.04,-4010.39 3293,-4010.39 3211.96,-3874.39 3527,-3874.39 3608.04,-4010.39"/>
<text text-anchor="middle" x="3410" y="-3961.19" font-family="Times,serif" font-size="14.00">Layer 0 Expert Combine</text>
<text text-anchor="middle" x="3410" y="-3946.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 0&#45;31]</text>
<text text-anchor="middle" x="3410" y="-3931.19" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3410" y="-3916.19" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer0_expert_group_0&#45;&gt;layer0_combine -->
<g id="edge8" class="edge">
<title>layer0_expert_group_0&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M255.15,-4086.82C261.13,-4085.12 267.12,-4083.61 273,-4082.39 848.28,-3963.01 2678.8,-3946.12 3242.89,-3943.77"/>
<polygon fill="black" stroke="black" points="3243.15,-3947.27 3253.14,-3943.72 3243.12,-3940.27 3243.15,-3947.27"/>
</g>
<!-- layer0_expert_group_1 -->
<g id="node7" class="node">
<title>layer0_expert_group_1</title>
<polygon fill="lightblue" stroke="black" points="467,-4165.39 291,-4165.39 291,-4082.39 467,-4082.39 467,-4165.39"/>
<text text-anchor="middle" x="379" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 1</text>
<text text-anchor="middle" x="379" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="379" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 4&#45;7]</text>
<text text-anchor="middle" x="379" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="379" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_1&#45;&gt;layer0_combine -->
<g id="edge10" class="edge">
<title>layer0_expert_group_1&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467.15,-4086.85C473.13,-4085.14 479.12,-4083.62 485,-4082.39 1017.62,-3970.97 2704.78,-3948.7 3243.16,-3944.39"/>
<polygon fill="black" stroke="black" points="3243.37,-3947.89 3253.34,-3944.31 3243.31,-3940.89 3243.37,-3947.89"/>
</g>
<!-- layer0_expert_group_2 -->
<g id="node8" class="node">
<title>layer0_expert_group_2</title>
<polygon fill="lightblue" stroke="black" points="679,-4165.39 503,-4165.39 503,-4082.39 679,-4082.39 679,-4165.39"/>
<text text-anchor="middle" x="591" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 2</text>
<text text-anchor="middle" x="591" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="591" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 8&#45;11]</text>
<text text-anchor="middle" x="591" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="591" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_2&#45;&gt;layer0_combine -->
<g id="edge12" class="edge">
<title>layer0_expert_group_2&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M679.16,-4086.87C685.14,-4085.16 691.12,-4083.64 697,-4082.39 1187.21,-3978.9 2732.45,-3951.45 3243.84,-3945.11"/>
<polygon fill="black" stroke="black" points="3243.92,-3948.61 3253.88,-3944.98 3243.84,-3941.61 3243.92,-3948.61"/>
</g>
<!-- layer0_expert_group_3 -->
<g id="node9" class="node">
<title>layer0_expert_group_3</title>
<polygon fill="lightblue" stroke="black" points="891,-4165.39 715,-4165.39 715,-4082.39 891,-4082.39 891,-4165.39"/>
<text text-anchor="middle" x="803" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 3</text>
<text text-anchor="middle" x="803" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="803" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 12&#45;15]</text>
<text text-anchor="middle" x="803" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="803" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_3&#45;&gt;layer0_combine -->
<g id="edge14" class="edge">
<title>layer0_expert_group_3&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M891.17,-4086.9C897.14,-4085.18 903.12,-4083.65 909,-4082.39 1356.75,-3986.85 2759.91,-3954.44 3243.91,-3945.95"/>
<polygon fill="black" stroke="black" points="3244.19,-3949.44 3254.12,-3945.77 3244.06,-3942.44 3244.19,-3949.44"/>
</g>
<!-- layer0_expert_group_4 -->
<g id="node10" class="node">
<title>layer0_expert_group_4</title>
<polygon fill="lightblue" stroke="black" points="1103,-4165.39 927,-4165.39 927,-4082.39 1103,-4082.39 1103,-4165.39"/>
<text text-anchor="middle" x="1015" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 4</text>
<text text-anchor="middle" x="1015" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1015" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 16&#45;19]</text>
<text text-anchor="middle" x="1015" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1015" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_4&#45;&gt;layer0_combine -->
<g id="edge16" class="edge">
<title>layer0_expert_group_4&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1103.17,-4086.94C1109.15,-4085.2 1115.13,-4083.66 1121,-4082.39 1526.63,-3994.75 2789.59,-3957.67 3244.55,-3946.93"/>
<polygon fill="black" stroke="black" points="3244.9,-3950.42 3254.82,-3946.68 3244.74,-3943.42 3244.9,-3950.42"/>
</g>
<!-- layer0_expert_group_5 -->
<g id="node11" class="node">
<title>layer0_expert_group_5</title>
<polygon fill="lightblue" stroke="black" points="1315,-4165.39 1139,-4165.39 1139,-4082.39 1315,-4082.39 1315,-4165.39"/>
<text text-anchor="middle" x="1227" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 5</text>
<text text-anchor="middle" x="1227" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1227" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 20&#45;23]</text>
<text text-anchor="middle" x="1227" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1227" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_5&#45;&gt;layer0_combine -->
<g id="edge18" class="edge">
<title>layer0_expert_group_5&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1315.18,-4086.98C1321.16,-4085.24 1327.13,-4083.68 1333,-4082.39 1696.73,-4002.62 2820.76,-3961.21 3245.34,-3948.09"/>
<polygon fill="black" stroke="black" points="3245.66,-3951.58 3255.54,-3947.78 3245.44,-3944.59 3245.66,-3951.58"/>
</g>
<!-- layer0_expert_group_6 -->
<g id="node12" class="node">
<title>layer0_expert_group_6</title>
<polygon fill="lightblue" stroke="black" points="1527,-4165.39 1351,-4165.39 1351,-4082.39 1527,-4082.39 1527,-4165.39"/>
<text text-anchor="middle" x="1439" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 6</text>
<text text-anchor="middle" x="1439" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1439" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 24&#45;27]</text>
<text text-anchor="middle" x="1439" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1439" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_6&#45;&gt;layer0_combine -->
<g id="edge20" class="edge">
<title>layer0_expert_group_6&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1527.19,-4087.03C1533.16,-4085.28 1539.14,-4083.7 1545,-4082.39 1867.12,-4010.47 2853.9,-3965.12 3246.45,-3949.49"/>
<polygon fill="black" stroke="black" points="3246.61,-3952.99 3256.46,-3949.1 3246.33,-3946 3246.61,-3952.99"/>
</g>
<!-- layer0_expert_group_7 -->
<g id="node13" class="node">
<title>layer0_expert_group_7</title>
<polygon fill="lightblue" stroke="black" points="1739,-4165.39 1563,-4165.39 1563,-4082.39 1739,-4082.39 1739,-4165.39"/>
<text text-anchor="middle" x="1651" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 7</text>
<text text-anchor="middle" x="1651" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1651" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 28&#45;31]</text>
<text text-anchor="middle" x="1651" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1651" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_7&#45;&gt;layer0_combine -->
<g id="edge22" class="edge">
<title>layer0_expert_group_7&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1739.21,-4087.09C1745.18,-4085.32 1751.14,-4083.73 1757,-4082.39 2037.62,-4018.34 2887.82,-3969.57 3247.03,-3951.27"/>
<polygon fill="black" stroke="black" points="3247.44,-3954.75 3257.25,-3950.75 3247.09,-3947.76 3247.44,-3954.75"/>
</g>
<!-- layer0_expert_group_8 -->
<g id="node14" class="node">
<title>layer0_expert_group_8</title>
<polygon fill="lightblue" stroke="black" points="1951,-4165.39 1775,-4165.39 1775,-4082.39 1951,-4082.39 1951,-4165.39"/>
<text text-anchor="middle" x="1863" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 8</text>
<text text-anchor="middle" x="1863" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1863" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 32&#45;35]</text>
<text text-anchor="middle" x="1863" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1863" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_8&#45;&gt;layer0_combine -->
<g id="edge24" class="edge">
<title>layer0_expert_group_8&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1951.23,-4087.18C1957.19,-4085.39 1963.15,-4083.77 1969,-4082.39 2421.66,-3976.14 2972.6,-3950.87 3243.4,-3945.02"/>
<polygon fill="black" stroke="black" points="3243.78,-3948.51 3253.71,-3944.8 3243.63,-3941.51 3243.78,-3948.51"/>
</g>
<!-- layer0_expert_group_9 -->
<g id="node15" class="node">
<title>layer0_expert_group_9</title>
<polygon fill="lightblue" stroke="black" points="2163,-4165.39 1987,-4165.39 1987,-4082.39 2163,-4082.39 2163,-4165.39"/>
<text text-anchor="middle" x="2075" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 9</text>
<text text-anchor="middle" x="2075" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2075" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 36&#45;39]</text>
<text text-anchor="middle" x="2075" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2075" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_9&#45;&gt;layer0_combine -->
<g id="edge26" class="edge">
<title>layer0_expert_group_9&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2163.26,-4087.29C2169.21,-4085.47 2175.16,-4083.82 2181,-4082.39 2555.08,-3991.33 3008.04,-3959.64 3245.88,-3948.83"/>
<polygon fill="black" stroke="black" points="3246.16,-3952.32 3255.99,-3948.37 3245.85,-3945.32 3246.16,-3952.32"/>
</g>
<!-- layer0_expert_group_10 -->
<g id="node16" class="node">
<title>layer0_expert_group_10</title>
<polygon fill="lightblue" stroke="black" points="2375,-4165.39 2199,-4165.39 2199,-4082.39 2375,-4082.39 2375,-4165.39"/>
<text text-anchor="middle" x="2287" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 10</text>
<text text-anchor="middle" x="2287" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2287" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 40&#45;43]</text>
<text text-anchor="middle" x="2287" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2287" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_10&#45;&gt;layer0_combine -->
<g id="edge28" class="edge">
<title>layer0_expert_group_10&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2375,-4087.54C2381.05,-4085.65 2387.08,-4083.91 2393,-4082.39 2689.69,-4006.51 3046.34,-3969.87 3248.75,-3953.98"/>
<polygon fill="black" stroke="black" points="3249.17,-3957.46 3258.87,-3953.19 3248.63,-3950.48 3249.17,-3957.46"/>
</g>
<!-- layer0_expert_group_11 -->
<g id="node17" class="node">
<title>layer0_expert_group_11</title>
<polygon fill="lightblue" stroke="black" points="2587,-4165.39 2411,-4165.39 2411,-4082.39 2587,-4082.39 2587,-4165.39"/>
<text text-anchor="middle" x="2499" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 11</text>
<text text-anchor="middle" x="2499" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2499" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 44&#45;47]</text>
<text text-anchor="middle" x="2499" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2499" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_11&#45;&gt;layer0_combine -->
<g id="edge30" class="edge">
<title>layer0_expert_group_11&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2587.07,-4087.78C2593.09,-4085.83 2599.11,-4084.01 2605,-4082.39 2826.03,-4021.7 3088.82,-3982.24 3252.55,-3961.4"/>
<polygon fill="black" stroke="black" points="3253.22,-3964.84 3262.7,-3960.11 3252.34,-3957.89 3253.22,-3964.84"/>
</g>
<!-- layer0_expert_group_12 -->
<g id="node18" class="node">
<title>layer0_expert_group_12</title>
<polygon fill="lightblue" stroke="black" points="2799,-4165.39 2623,-4165.39 2623,-4082.39 2799,-4082.39 2799,-4165.39"/>
<text text-anchor="middle" x="2711" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 12</text>
<text text-anchor="middle" x="2711" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2711" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 48&#45;51]</text>
<text text-anchor="middle" x="2711" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2711" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_12&#45;&gt;layer0_combine -->
<g id="edge32" class="edge">
<title>layer0_expert_group_12&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2799.18,-4088.18C2805.18,-4086.14 2811.16,-4084.18 2817,-4082.39 2965.35,-4036.89 3138.49,-3997.88 3259.24,-3972.87"/>
<polygon fill="black" stroke="black" points="3260.21,-3976.24 3269.3,-3970.8 3258.79,-3969.39 3260.21,-3976.24"/>
</g>
<!-- layer0_expert_group_13 -->
<g id="node19" class="node">
<title>layer0_expert_group_13</title>
<polygon fill="lightblue" stroke="black" points="3011,-4165.39 2835,-4165.39 2835,-4082.39 3011,-4082.39 3011,-4165.39"/>
<text text-anchor="middle" x="2923" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 13</text>
<text text-anchor="middle" x="2923" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2923" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 52&#45;55]</text>
<text text-anchor="middle" x="2923" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2923" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_13&#45;&gt;layer0_combine -->
<g id="edge34" class="edge">
<title>layer0_expert_group_13&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3011.17,-4089.09C3017.2,-4086.81 3023.19,-4084.56 3029,-4082.39 3109.01,-4052.51 3198.74,-4019.74 3271.02,-3993.53"/>
<polygon fill="black" stroke="black" points="3272.44,-3996.74 3280.64,-3990.04 3270.05,-3990.16 3272.44,-3996.74"/>
</g>
<!-- layer0_expert_group_14 -->
<g id="node20" class="node">
<title>layer0_expert_group_14</title>
<polygon fill="lightblue" stroke="black" points="3223,-4165.39 3047,-4165.39 3047,-4082.39 3223,-4082.39 3223,-4165.39"/>
<text text-anchor="middle" x="3135" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 14</text>
<text text-anchor="middle" x="3135" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3135" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 56&#45;59]</text>
<text text-anchor="middle" x="3135" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3135" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_14&#45;&gt;layer0_combine -->
<g id="edge36" class="edge">
<title>layer0_expert_group_14&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3197.06,-4082.39C3227,-4062.85 3263.85,-4038.79 3298.42,-4016.22"/>
<polygon fill="black" stroke="black" points="3300.7,-4018.92 3307.16,-4010.52 3296.87,-4013.05 3300.7,-4018.92"/>
</g>
<!-- layer0_expert_group_15 -->
<g id="node21" class="node">
<title>layer0_expert_group_15</title>
<polygon fill="lightblue" stroke="black" points="3435,-4165.39 3259,-4165.39 3259,-4082.39 3435,-4082.39 3435,-4165.39"/>
<text text-anchor="middle" x="3347" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 15</text>
<text text-anchor="middle" x="3347" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3347" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 60&#45;63]</text>
<text text-anchor="middle" x="3347" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3347" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_15&#45;&gt;layer0_combine -->
<g id="edge38" class="edge">
<title>layer0_expert_group_15&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3361.3,-4082.16C3367.72,-4063.86 3375.52,-4041.64 3382.97,-4020.4"/>
<polygon fill="black" stroke="black" points="3386.36,-4021.31 3386.37,-4010.72 3379.76,-4019 3386.36,-4021.31"/>
</g>
<!-- layer0_expert_group_16 -->
<g id="node22" class="node">
<title>layer0_expert_group_16</title>
<polygon fill="lightblue" stroke="black" points="3647,-4165.39 3471,-4165.39 3471,-4082.39 3647,-4082.39 3647,-4165.39"/>
<text text-anchor="middle" x="3559" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 16</text>
<text text-anchor="middle" x="3559" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3559" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 64&#45;67]</text>
<text text-anchor="middle" x="3559" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3559" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_16&#45;&gt;layer0_combine -->
<g id="edge40" class="edge">
<title>layer0_expert_group_16&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3525.19,-4082.16C3509.59,-4063.37 3490.56,-4040.44 3472.49,-4018.68"/>
<polygon fill="black" stroke="black" points="3474.97,-4016.18 3465.89,-4010.72 3469.58,-4020.65 3474.97,-4016.18"/>
</g>
<!-- layer0_expert_group_17 -->
<g id="node23" class="node">
<title>layer0_expert_group_17</title>
<polygon fill="lightblue" stroke="black" points="3859,-4165.39 3683,-4165.39 3683,-4082.39 3859,-4082.39 3859,-4165.39"/>
<text text-anchor="middle" x="3771" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 17</text>
<text text-anchor="middle" x="3771" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3771" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 68&#45;71]</text>
<text text-anchor="middle" x="3771" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3771" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_17&#45;&gt;layer0_combine -->
<g id="edge42" class="edge">
<title>layer0_expert_group_17&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3689.53,-4082.39C3649.57,-4062.51 3600.22,-4037.98 3554.16,-4015.08"/>
<polygon fill="black" stroke="black" points="3555.51,-4011.84 3545,-4010.52 3552.4,-4018.11 3555.51,-4011.84"/>
</g>
<!-- layer0_expert_group_18 -->
<g id="node24" class="node">
<title>layer0_expert_group_18</title>
<polygon fill="lightblue" stroke="black" points="4071,-4165.39 3895,-4165.39 3895,-4082.39 4071,-4082.39 4071,-4165.39"/>
<text text-anchor="middle" x="3983" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 18</text>
<text text-anchor="middle" x="3983" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3983" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 72&#45;75]</text>
<text text-anchor="middle" x="3983" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3983" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_18&#45;&gt;layer0_combine -->
<g id="edge44" class="edge">
<title>layer0_expert_group_18&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3894.98,-4088.68C3888.91,-4086.5 3882.88,-4084.39 3877,-4082.39 3790.02,-4052.88 3692.82,-4023.4 3609.71,-3999.23"/>
<polygon fill="black" stroke="black" points="3610.49,-3995.81 3599.91,-3996.39 3608.53,-4002.53 3610.49,-3995.81"/>
</g>
<!-- layer0_expert_group_19 -->
<g id="node25" class="node">
<title>layer0_expert_group_19</title>
<polygon fill="lightblue" stroke="black" points="4283,-4165.39 4107,-4165.39 4107,-4082.39 4283,-4082.39 4283,-4165.39"/>
<text text-anchor="middle" x="4195" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 19</text>
<text text-anchor="middle" x="4195" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4195" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 76&#45;79]</text>
<text text-anchor="middle" x="4195" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4195" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_19&#45;&gt;layer0_combine -->
<g id="edge46" class="edge">
<title>layer0_expert_group_19&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4106.87,-4087.99C4100.86,-4085.99 4094.86,-4084.1 4089,-4082.39 3924.45,-4034.46 3732.81,-3996.84 3595.17,-3972.89"/>
<polygon fill="black" stroke="black" points="3595.39,-3969.38 3584.94,-3971.12 3594.19,-3976.27 3595.39,-3969.38"/>
</g>
<!-- layer0_expert_group_20 -->
<g id="node26" class="node">
<title>layer0_expert_group_20</title>
<polygon fill="lightblue" stroke="black" points="4495,-4165.39 4319,-4165.39 4319,-4082.39 4495,-4082.39 4495,-4165.39"/>
<text text-anchor="middle" x="4407" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 20</text>
<text text-anchor="middle" x="4407" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4407" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 80&#45;83]</text>
<text text-anchor="middle" x="4407" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4407" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_20&#45;&gt;layer0_combine -->
<g id="edge48" class="edge">
<title>layer0_expert_group_20&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4318.96,-4087.67C4312.93,-4085.75 4306.9,-4083.96 4301,-4082.39 4058.03,-4017.79 3769.27,-3979.54 3587.79,-3960.01"/>
<polygon fill="black" stroke="black" points="3587.93,-3956.5 3577.61,-3958.92 3587.18,-3963.46 3587.93,-3956.5"/>
</g>
<!-- layer0_expert_group_21 -->
<g id="node27" class="node">
<title>layer0_expert_group_21</title>
<polygon fill="lightblue" stroke="black" points="4707,-4165.39 4531,-4165.39 4531,-4082.39 4707,-4082.39 4707,-4165.39"/>
<text text-anchor="middle" x="4619" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 21</text>
<text text-anchor="middle" x="4619" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4619" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 84&#45;87]</text>
<text text-anchor="middle" x="4619" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4619" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_21&#45;&gt;layer0_combine -->
<g id="edge50" class="edge">
<title>layer0_expert_group_21&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4530.72,-4087.38C4524.77,-4085.54 4518.83,-4083.85 4513,-4082.39 4190.53,-4001.71 3802.72,-3966.68 3583.44,-3952.39"/>
<polygon fill="black" stroke="black" points="3583.66,-3948.89 3573.45,-3951.74 3583.21,-3955.88 3583.66,-3948.89"/>
</g>
<!-- layer0_expert_group_22 -->
<g id="node28" class="node">
<title>layer0_expert_group_22</title>
<polygon fill="lightblue" stroke="black" points="4919,-4165.39 4743,-4165.39 4743,-4082.39 4919,-4082.39 4919,-4165.39"/>
<text text-anchor="middle" x="4831" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 22</text>
<text text-anchor="middle" x="4831" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4831" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 88&#45;91]</text>
<text text-anchor="middle" x="4831" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4831" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_22&#45;&gt;layer0_combine -->
<g id="edge52" class="edge">
<title>layer0_expert_group_22&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4742.76,-4087.24C4736.8,-4085.44 4730.84,-4083.79 4725,-4082.39 4321.97,-3985.84 3833.44,-3956.34 3580.41,-3947.34"/>
<polygon fill="black" stroke="black" points="3580.51,-3943.84 3570.39,-3946.99 3580.27,-3950.84 3580.51,-3943.84"/>
</g>
<!-- layer0_expert_group_23 -->
<g id="node29" class="node">
<title>layer0_expert_group_23</title>
<polygon fill="lightblue" stroke="black" points="5131,-4165.39 4955,-4165.39 4955,-4082.39 5131,-4082.39 5131,-4165.39"/>
<text text-anchor="middle" x="5043" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 23</text>
<text text-anchor="middle" x="5043" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5043" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 92&#45;95]</text>
<text text-anchor="middle" x="5043" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5043" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_23&#45;&gt;layer0_combine -->
<g id="edge54" class="edge">
<title>layer0_expert_group_23&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4954.78,-4087.14C4948.82,-4085.36 4942.85,-4083.75 4937,-4082.39 4452.87,-3970.13 3862.75,-3947.68 3578.71,-3943.76"/>
<polygon fill="black" stroke="black" points="3578.37,-3940.25 3568.32,-3943.62 3578.27,-3947.25 3578.37,-3940.25"/>
</g>
<!-- layer0_expert_group_24 -->
<g id="node30" class="node">
<title>layer0_expert_group_24</title>
<polygon fill="lightblue" stroke="black" points="5343,-4165.39 5167,-4165.39 5167,-4082.39 5343,-4082.39 5343,-4165.39"/>
<text text-anchor="middle" x="5255" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 24</text>
<text text-anchor="middle" x="5255" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5255" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 96&#45;99]</text>
<text text-anchor="middle" x="5255" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5255" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_24&#45;&gt;layer0_combine -->
<g id="edge56" class="edge">
<title>layer0_expert_group_24&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5166.8,-4087.07C5160.83,-4085.3 5154.86,-4083.72 5149,-4082.39 4854.06,-4015.71 3961.22,-3968.48 3582.64,-3950.93"/>
<polygon fill="black" stroke="black" points="3582.57,-3947.43 3572.42,-3950.46 3582.25,-3954.42 3582.57,-3947.43"/>
</g>
<!-- layer0_expert_group_25 -->
<g id="node31" class="node">
<title>layer0_expert_group_25</title>
<polygon fill="lightblue" stroke="black" points="5555.5,-4165.39 5378.5,-4165.39 5378.5,-4082.39 5555.5,-4082.39 5555.5,-4165.39"/>
<text text-anchor="middle" x="5467" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 25</text>
<text text-anchor="middle" x="5467" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5467" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 100&#45;103]</text>
<text text-anchor="middle" x="5467" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5467" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_25&#45;&gt;layer0_combine -->
<g id="edge58" class="edge">
<title>layer0_expert_group_25&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5378.22,-4086.84C5372.45,-4085.16 5366.67,-4083.65 5361,-4082.39 5024.1,-4007.75 3992.48,-3964.02 3581.54,-3949.16"/>
<polygon fill="black" stroke="black" points="3581.47,-3945.66 3571.35,-3948.79 3581.22,-3952.65 3581.47,-3945.66"/>
</g>
<!-- layer0_expert_group_26 -->
<g id="node32" class="node">
<title>layer0_expert_group_26</title>
<polygon fill="lightblue" stroke="black" points="5768.5,-4165.39 5591.5,-4165.39 5591.5,-4082.39 5768.5,-4082.39 5768.5,-4165.39"/>
<text text-anchor="middle" x="5680" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 26</text>
<text text-anchor="middle" x="5680" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5680" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 104&#45;107]</text>
<text text-anchor="middle" x="5680" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5680" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_26&#45;&gt;layer0_combine -->
<g id="edge60" class="edge">
<title>layer0_expert_group_26&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5591.23,-4086.79C5585.46,-4085.12 5579.68,-4083.63 5574,-4082.39 5194.89,-3999.78 4023.32,-3960.09 3581.23,-3947.76"/>
<polygon fill="black" stroke="black" points="3581.01,-3944.25 3570.92,-3947.47 3580.82,-3951.25 3581.01,-3944.25"/>
</g>
<!-- layer0_expert_group_27 -->
<g id="node33" class="node">
<title>layer0_expert_group_27</title>
<polygon fill="lightblue" stroke="black" points="5981.5,-4165.39 5804.5,-4165.39 5804.5,-4082.39 5981.5,-4082.39 5981.5,-4165.39"/>
<text text-anchor="middle" x="5893" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 27</text>
<text text-anchor="middle" x="5893" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5893" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 108&#45;111]</text>
<text text-anchor="middle" x="5893" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5893" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_27&#45;&gt;layer0_combine -->
<g id="edge62" class="edge">
<title>layer0_expert_group_27&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5804.24,-4086.75C5798.46,-4085.09 5792.68,-4083.62 5787,-4082.39 5365.25,-3991.76 4051.26,-3956.52 3580.19,-3946.59"/>
<polygon fill="black" stroke="black" points="3579.98,-3943.09 3569.91,-3946.38 3579.83,-3950.09 3579.98,-3943.09"/>
</g>
<!-- layer0_expert_group_28 -->
<g id="node34" class="node">
<title>layer0_expert_group_28</title>
<polygon fill="lightblue" stroke="black" points="6194.5,-4165.39 6017.5,-4165.39 6017.5,-4082.39 6194.5,-4082.39 6194.5,-4165.39"/>
<text text-anchor="middle" x="6106" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 28</text>
<text text-anchor="middle" x="6106" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6106" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 112&#45;115]</text>
<text text-anchor="middle" x="6106" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6106" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_28&#45;&gt;layer0_combine -->
<g id="edge64" class="edge">
<title>layer0_expert_group_28&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6017.25,-4086.72C6011.47,-4085.07 6005.68,-4083.6 6000,-4082.39 5535.61,-3983.76 4079.07,-3953.31 3579.86,-3945.63"/>
<polygon fill="black" stroke="black" points="3579.74,-3942.13 3569.69,-3945.48 3579.63,-3949.13 3579.74,-3942.13"/>
</g>
<!-- layer0_expert_group_29 -->
<g id="node35" class="node">
<title>layer0_expert_group_29</title>
<polygon fill="lightblue" stroke="black" points="6407.5,-4165.39 6230.5,-4165.39 6230.5,-4082.39 6407.5,-4082.39 6407.5,-4165.39"/>
<text text-anchor="middle" x="6319" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 29</text>
<text text-anchor="middle" x="6319" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6319" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 116&#45;119]</text>
<text text-anchor="middle" x="6319" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6319" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_29&#45;&gt;layer0_combine -->
<g id="edge66" class="edge">
<title>layer0_expert_group_29&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6230.25,-4086.69C6224.47,-4085.05 6218.69,-4083.59 6213,-4082.39 5705.74,-3975.73 4105.34,-3950.35 3579.36,-3944.82"/>
<polygon fill="black" stroke="black" points="3579.07,-3941.32 3569.03,-3944.71 3579,-3948.32 3579.07,-3941.32"/>
</g>
<!-- layer0_expert_group_30 -->
<g id="node36" class="node">
<title>layer0_expert_group_30</title>
<polygon fill="lightblue" stroke="black" points="6620.5,-4165.39 6443.5,-4165.39 6443.5,-4082.39 6620.5,-4082.39 6620.5,-4165.39"/>
<text text-anchor="middle" x="6532" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 30</text>
<text text-anchor="middle" x="6532" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6532" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 120&#45;123]</text>
<text text-anchor="middle" x="6532" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6532" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_30&#45;&gt;layer0_combine -->
<g id="edge68" class="edge">
<title>layer0_expert_group_30&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6443.26,-4086.67C6437.47,-4085.03 6431.69,-4083.58 6426,-4082.39 5875.67,-3967.68 4130.23,-3947.61 3578.73,-3944.12"/>
<polygon fill="black" stroke="black" points="3578.72,-3940.62 3568.7,-3944.06 3578.68,-3947.62 3578.72,-3940.62"/>
</g>
<!-- layer0_expert_group_31 -->
<g id="node37" class="node">
<title>layer0_expert_group_31</title>
<polygon fill="lightblue" stroke="black" points="6833.5,-4165.39 6656.5,-4165.39 6656.5,-4082.39 6833.5,-4082.39 6833.5,-4165.39"/>
<text text-anchor="middle" x="6745" y="-4150.19" font-family="Times,serif" font-size="14.00">Expert Group 31</text>
<text text-anchor="middle" x="6745" y="-4135.19" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6745" y="-4120.19" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 124&#45;127]</text>
<text text-anchor="middle" x="6745" y="-4105.19" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6745" y="-4090.19" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer0_expert_group_31&#45;&gt;layer0_combine -->
<g id="edge70" class="edge">
<title>layer0_expert_group_31&#45;&gt;layer0_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6656.26,-4086.65C6650.48,-4085.02 6644.69,-4083.57 6639,-4082.39 6045.63,-3959.64 4155.18,-3945.08 3578.58,-3943.52"/>
<polygon fill="black" stroke="black" points="3578.53,-3940.02 3568.53,-3943.5 3578.52,-3947.02 3578.53,-3940.02"/>
</g>
<!-- layer4_attn_qkv_tp -->
<g id="node41" class="node">
<title>layer4_attn_qkv_tp</title>
<polygon fill="lightblue" stroke="black" points="3502.5,-3802.39 3317.5,-3802.39 3317.5,-3734.39 3502.5,-3734.39 3502.5,-3802.39"/>
<text text-anchor="middle" x="3410" y="-3787.19" font-family="Times,serif" font-size="14.00">Layer 4 Attention QKV</text>
<text text-anchor="middle" x="3410" y="-3772.19" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 128&#45;131]</text>
<text text-anchor="middle" x="3410" y="-3757.19" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3410" y="-3742.19" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer0_combine&#45;&gt;layer4_attn_qkv_tp -->
<g id="edge71" class="edge">
<title>layer0_combine&#45;&gt;layer4_attn_qkv_tp</title>
<path fill="none" stroke="black" d="M3410,-3873.91C3410,-3853.36 3410,-3831.33 3410,-3812.81"/>
<polygon fill="black" stroke="black" points="3413.5,-3812.64 3410,-3802.64 3406.5,-3812.64 3413.5,-3812.64"/>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_out_tp -->
<g id="edge4" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_out_tp</title>
<path fill="none" stroke="black" d="M3453,-4710.84C3453,-4693.3 3453,-4669.8 3453,-4649.51"/>
<polygon fill="black" stroke="black" points="3456.5,-4649.24 3453,-4639.24 3449.5,-4649.24 3456.5,-4649.24"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_0 -->
<g id="edge7" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_0</title>
<path fill="none" stroke="black" d="M3346.98,-4262.1C2829.28,-4256.13 579.41,-4226.82 273,-4165.39 270.33,-4164.86 267.64,-4164.26 264.94,-4163.62"/>
<polygon fill="black" stroke="black" points="265.69,-4160.19 255.13,-4161.06 263.92,-4166.97 265.69,-4160.19"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_1 -->
<g id="edge9" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_1</title>
<path fill="none" stroke="black" d="M3347.14,-4261.85C2851.18,-4254.95 769.6,-4222.78 485,-4165.39 482.33,-4164.86 479.64,-4164.26 476.94,-4163.61"/>
<polygon fill="black" stroke="black" points="477.69,-4160.19 467.13,-4161.04 475.92,-4166.96 477.69,-4160.19"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_2 -->
<g id="edge11" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_2</title>
<path fill="none" stroke="black" d="M3347.29,-4261.56C2873.82,-4253.68 959.83,-4218.73 697,-4165.39 694.33,-4164.85 691.64,-4164.25 688.94,-4163.6"/>
<polygon fill="black" stroke="black" points="689.7,-4160.18 679.14,-4161.02 687.92,-4166.95 689.7,-4160.18"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_3 -->
<g id="edge13" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_3</title>
<path fill="none" stroke="black" d="M3346.63,-4263.77C2927.02,-4265.08 1386.15,-4262.96 909,-4165.39 906.33,-4164.85 903.64,-4164.24 900.94,-4163.59"/>
<polygon fill="black" stroke="black" points="901.7,-4160.17 891.14,-4161 899.92,-4166.94 901.7,-4160.17"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_4 -->
<g id="edge15" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_4</title>
<path fill="none" stroke="black" d="M3346.82,-4263.34C2950.05,-4262.92 1555.07,-4254.94 1121,-4165.39 1118.33,-4164.84 1115.65,-4164.24 1112.95,-4163.58"/>
<polygon fill="black" stroke="black" points="1113.71,-4160.16 1103.15,-4160.98 1111.92,-4166.92 1113.71,-4160.16"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_5 -->
<g id="edge17" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_5</title>
<path fill="none" stroke="black" d="M3346.99,-4262.82C2974.06,-4260.56 1724.12,-4246.94 1333,-4165.39 1330.33,-4164.84 1327.65,-4164.22 1324.95,-4163.56"/>
<polygon fill="black" stroke="black" points="1325.72,-4160.14 1315.15,-4160.95 1323.92,-4166.91 1325.72,-4160.14"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_6 -->
<g id="edge19" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_6</title>
<path fill="none" stroke="black" d="M3347.19,-4262.19C2999.31,-4257.97 1893.36,-4238.95 1545,-4165.39 1542.34,-4164.83 1539.65,-4164.21 1536.95,-4163.54"/>
<polygon fill="black" stroke="black" points="1537.73,-4160.13 1527.16,-4160.92 1535.91,-4166.89 1537.73,-4160.13"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_7 -->
<g id="edge21" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_7</title>
<path fill="none" stroke="black" d="M3347.29,-4261.4C3025.75,-4255.07 2062.77,-4230.98 1757,-4165.39 1754.34,-4164.82 1751.65,-4164.2 1748.96,-4163.52"/>
<polygon fill="black" stroke="black" points="1749.74,-4160.1 1739.17,-4160.87 1747.91,-4166.86 1749.74,-4160.1"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_8 -->
<g id="edge23" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_8</title>
<path fill="none" stroke="black" d="M3347.96,-4260.41C3054.9,-4251.8 2232.58,-4223.07 1969,-4165.39 1966.34,-4164.81 1963.66,-4164.17 1960.97,-4163.49"/>
<polygon fill="black" stroke="black" points="1961.75,-4160.08 1951.18,-4160.82 1959.91,-4166.83 1961.75,-4160.08"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_9 -->
<g id="edge25" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_9</title>
<path fill="none" stroke="black" d="M3348.52,-4259.1C3085.76,-4248.01 2402.64,-4215.16 2181,-4165.39 2178.34,-4164.8 2175.66,-4164.15 2172.97,-4163.45"/>
<polygon fill="black" stroke="black" points="2173.77,-4160.04 2163.2,-4160.74 2171.9,-4166.79 2173.77,-4160.04"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_10 -->
<g id="edge27" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_10</title>
<path fill="none" stroke="black" d="M3346.92,-4262.97C3154.34,-4260.36 2735.46,-4245.04 2393,-4165.39 2390.35,-4164.78 2387.67,-4164.11 2384.99,-4163.4"/>
<polygon fill="black" stroke="black" points="2385.8,-4159.99 2375.22,-4160.64 2383.89,-4166.72 2385.8,-4159.99"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_11 -->
<g id="edge29" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_11</title>
<path fill="none" stroke="black" d="M3348.4,-4259.59C3186.82,-4252.04 2867.72,-4229.67 2605,-4165.39 2602.36,-4164.75 2599.69,-4164.05 2597.01,-4163.32"/>
<polygon fill="black" stroke="black" points="2597.84,-4159.91 2587.26,-4160.48 2595.88,-4166.63 2597.84,-4159.91"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_12 -->
<g id="edge31" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_12</title>
<path fill="none" stroke="black" d="M3353.88,-4254.59C3227.62,-4242.05 3003.43,-4214.75 2817,-4165.39 2814.23,-4164.66 2811.44,-4163.88 2808.63,-4163.06"/>
<polygon fill="black" stroke="black" points="2809.62,-4159.7 2799.03,-4160.13 2807.58,-4166.4 2809.62,-4159.7"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_13 -->
<g id="edge33" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_13</title>
<path fill="none" stroke="black" d="M3369.63,-4247.57C3283.48,-4230.52 3145.52,-4200.92 3029,-4165.39 3026.26,-4164.56 3023.49,-4163.69 3020.71,-4162.79"/>
<polygon fill="black" stroke="black" points="3021.77,-4159.45 3011.18,-4159.63 3019.57,-4166.1 3021.77,-4159.45"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_14 -->
<g id="edge35" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_14</title>
<path fill="none" stroke="black" d="M3401.2,-4240.72C3355.6,-4220.88 3287.99,-4191.47 3232.32,-4167.24"/>
<polygon fill="black" stroke="black" points="3233.71,-4164.03 3223.14,-4163.25 3230.91,-4170.45 3233.71,-4164.03"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_15 -->
<g id="edge37" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_15</title>
<path fill="none" stroke="black" d="M3433.31,-4237.56C3419.56,-4219.61 3400.78,-4195.1 3384.25,-4173.52"/>
<polygon fill="black" stroke="black" points="3386.9,-4171.22 3378.04,-4165.41 3381.34,-4175.48 3386.9,-4171.22"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_16 -->
<g id="edge39" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_16</title>
<path fill="none" stroke="black" d="M3472.69,-4237.56C3486.44,-4219.61 3505.22,-4195.1 3521.75,-4173.52"/>
<polygon fill="black" stroke="black" points="3524.66,-4175.48 3527.96,-4165.41 3519.1,-4171.22 3524.66,-4175.48"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_17 -->
<g id="edge41" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_17</title>
<path fill="none" stroke="black" d="M3504.8,-4240.72C3550.4,-4220.88 3618.01,-4191.47 3673.68,-4167.24"/>
<polygon fill="black" stroke="black" points="3675.09,-4170.45 3682.86,-4163.25 3672.29,-4164.03 3675.09,-4170.45"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_18 -->
<g id="edge43" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_18</title>
<path fill="none" stroke="black" d="M3536.37,-4247.57C3622.52,-4230.52 3760.48,-4200.92 3877,-4165.39 3879.74,-4164.56 3882.51,-4163.69 3885.29,-4162.79"/>
<polygon fill="black" stroke="black" points="3886.43,-4166.1 3894.82,-4159.63 3884.23,-4159.45 3886.43,-4166.1"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_19 -->
<g id="edge45" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_19</title>
<path fill="none" stroke="black" d="M3552.12,-4254.59C3678.38,-4242.05 3902.57,-4214.75 4089,-4165.39 4091.77,-4164.66 4094.56,-4163.88 4097.37,-4163.06"/>
<polygon fill="black" stroke="black" points="4098.42,-4166.4 4106.97,-4160.13 4096.38,-4159.7 4098.42,-4166.4"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_20 -->
<g id="edge47" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_20</title>
<path fill="none" stroke="black" d="M3557.6,-4259.59C3719.18,-4252.04 4038.28,-4229.67 4301,-4165.39 4303.64,-4164.75 4306.31,-4164.05 4308.99,-4163.32"/>
<polygon fill="black" stroke="black" points="4310.12,-4166.63 4318.74,-4160.48 4308.16,-4159.91 4310.12,-4166.63"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_21 -->
<g id="edge49" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_21</title>
<path fill="none" stroke="black" d="M3559.08,-4262.97C3751.66,-4260.36 4170.54,-4245.04 4513,-4165.39 4515.65,-4164.78 4518.33,-4164.11 4521.01,-4163.4"/>
<polygon fill="black" stroke="black" points="4522.11,-4166.72 4530.78,-4160.64 4520.2,-4159.99 4522.11,-4166.72"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_22 -->
<g id="edge51" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_22</title>
<path fill="none" stroke="black" d="M3557.48,-4259.1C3820.24,-4248.01 4503.36,-4215.16 4725,-4165.39 4727.66,-4164.8 4730.34,-4164.15 4733.03,-4163.45"/>
<polygon fill="black" stroke="black" points="4734.1,-4166.79 4742.8,-4160.74 4732.23,-4160.04 4734.1,-4166.79"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_23 -->
<g id="edge53" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_23</title>
<path fill="none" stroke="black" d="M3558.04,-4260.41C3851.1,-4251.8 4673.42,-4223.07 4937,-4165.39 4939.66,-4164.81 4942.34,-4164.17 4945.03,-4163.49"/>
<polygon fill="black" stroke="black" points="4946.09,-4166.83 4954.82,-4160.82 4944.25,-4160.08 4946.09,-4166.83"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_24 -->
<g id="edge55" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_24</title>
<path fill="none" stroke="black" d="M3558.71,-4261.4C3880.25,-4255.07 4843.23,-4230.98 5149,-4165.39 5151.66,-4164.82 5154.35,-4164.2 5157.04,-4163.52"/>
<polygon fill="black" stroke="black" points="5158.09,-4166.86 5166.83,-4160.87 5156.26,-4160.1 5158.09,-4166.86"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_25 -->
<g id="edge57" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_25</title>
<path fill="none" stroke="black" d="M3558.81,-4262.19C3906.69,-4257.97 5012.64,-4238.95 5361,-4165.39 5363.49,-4164.87 5365.99,-4164.29 5368.51,-4163.67"/>
<polygon fill="black" stroke="black" points="5369.49,-4167.04 5378.25,-4161.08 5367.69,-4160.27 5369.49,-4167.04"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_26 -->
<g id="edge59" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_26</title>
<path fill="none" stroke="black" d="M3559.06,-4262.82C3932.16,-4260.57 5182.69,-4246.97 5574,-4165.39 5576.49,-4164.88 5579,-4164.31 5581.51,-4163.69"/>
<polygon fill="black" stroke="black" points="5582.48,-4167.06 5591.26,-4161.12 5580.7,-4160.29 5582.48,-4167.06"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_27 -->
<g id="edge61" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_27</title>
<path fill="none" stroke="black" d="M3559.27,-4263.34C3956.39,-4262.94 5352.56,-4255.01 5787,-4165.39 5789.49,-4164.88 5792,-4164.32 5794.52,-4163.71"/>
<polygon fill="black" stroke="black" points="5795.48,-4167.07 5804.26,-4161.15 5793.7,-4160.3 5795.48,-4167.07"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_28 -->
<g id="edge63" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_28</title>
<path fill="none" stroke="black" d="M3559.13,-4263.78C3978.73,-4265.11 5522.15,-4263.1 6000,-4165.39 6002.49,-4164.88 6005,-4164.32 6007.52,-4163.72"/>
<polygon fill="black" stroke="black" points="6008.48,-4167.08 6017.27,-4161.17 6006.71,-4160.31 6008.48,-4167.08"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_29 -->
<g id="edge65" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_29</title>
<path fill="none" stroke="black" d="M3558.86,-4261.57C4033.02,-4253.69 5949.79,-4218.81 6213,-4165.39 6215.49,-4164.89 6218,-4164.33 6220.52,-4163.73"/>
<polygon fill="black" stroke="black" points="6221.48,-4167.1 6230.27,-4161.19 6219.71,-4160.32 6221.48,-4167.1"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_30 -->
<g id="edge67" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_30</title>
<path fill="none" stroke="black" d="M3559.04,-4261.85C4055.84,-4254.97 6140.92,-4222.87 6426,-4165.39 6428.49,-4164.89 6431,-4164.34 6433.52,-4163.74"/>
<polygon fill="black" stroke="black" points="6434.48,-4167.11 6443.28,-4161.21 6432.72,-4160.33 6434.48,-4167.11"/>
</g>
<!-- layer0_moe_alltoall&#45;&gt;layer0_expert_group_31 -->
<g id="edge69" class="edge">
<title>layer0_moe_alltoall&#45;&gt;layer0_expert_group_31</title>
<path fill="none" stroke="black" d="M3558.79,-4262.11C4076.65,-4256.17 6331.93,-4226.95 6639,-4165.39 6641.49,-4164.89 6644,-4164.34 6646.52,-4163.74"/>
<polygon fill="black" stroke="black" points="6647.47,-4167.11 6656.28,-4161.22 6645.72,-4160.34 6647.47,-4167.11"/>
</g>
<!-- layer4_attn_score -->
<g id="node42" class="node">
<title>layer4_attn_score</title>
<polygon fill="lightblue" stroke="black" points="3514,-3662.39 3306,-3662.39 3306,-3594.39 3514,-3594.39 3514,-3662.39"/>
<text text-anchor="middle" x="3410" y="-3647.19" font-family="Times,serif" font-size="14.00">Layer 4 Attention Score</text>
<text text-anchor="middle" x="3410" y="-3632.19" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 128&#45;131]</text>
<text text-anchor="middle" x="3410" y="-3617.19" font-family="Times,serif" font-size="14.00">Input: [16,16,1024,64]</text>
<text text-anchor="middle" x="3410" y="-3602.19" font-family="Times,serif" font-size="14.00">Output: [16,16,1024,1024]</text>
</g>
<!-- layer4_attn_qkv_tp&#45;&gt;layer4_attn_score -->
<g id="edge72" class="edge">
<title>layer4_attn_qkv_tp&#45;&gt;layer4_attn_score</title>
<path fill="none" stroke="black" d="M3410,-3734.34C3410,-3715.87 3410,-3692.63 3410,-3672.72"/>
<polygon fill="black" stroke="black" points="3413.5,-3672.66 3410,-3662.66 3406.5,-3672.66 3413.5,-3672.66"/>
</g>
<!-- layer4_attn_allreduce -->
<g id="node78" class="node">
<title>layer4_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3410" cy="-3495.52" rx="118.17" ry="26.74"/>
<text text-anchor="middle" x="3410" y="-3499.32" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3410" y="-3484.32" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 128&#45;131]</text>
</g>
<!-- layer4_attn_score&#45;&gt;layer4_attn_allreduce -->
<g id="edge73" class="edge">
<title>layer4_attn_score&#45;&gt;layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M3410,-3594.37C3410,-3575.59 3410,-3552.04 3410,-3532.75"/>
<polygon fill="black" stroke="black" points="3413.5,-3532.53 3410,-3522.53 3406.5,-3532.53 3413.5,-3532.53"/>
</g>
<!-- layer4_attn_out_tp -->
<g id="node43" class="node">
<title>layer4_attn_out_tp</title>
<polygon fill="lightblue" stroke="black" points="3508.5,-3396.65 3311.5,-3396.65 3311.5,-3328.65 3508.5,-3328.65 3508.5,-3396.65"/>
<text text-anchor="middle" x="3410" y="-3381.45" font-family="Times,serif" font-size="14.00">Layer 4 Attention Output</text>
<text text-anchor="middle" x="3410" y="-3366.45" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 128&#45;131]</text>
<text text-anchor="middle" x="3410" y="-3351.45" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3410" y="-3336.45" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer4_route -->
<g id="node44" class="node">
<title>layer4_route</title>
<polygon fill="lightyellow" stroke="black" points="3601.6,-3256.65 3296.81,-3256.65 3218.4,-3120.65 3523.19,-3120.65 3601.6,-3256.65"/>
<text text-anchor="middle" x="3410" y="-3207.45" font-family="Times,serif" font-size="14.00">Layer 4 Expert Routing</text>
<text text-anchor="middle" x="3410" y="-3192.45" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 128&#45;159]</text>
<text text-anchor="middle" x="3410" y="-3177.45" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3410" y="-3162.45" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer4_attn_out_tp&#45;&gt;layer4_route -->
<g id="edge75" class="edge">
<title>layer4_attn_out_tp&#45;&gt;layer4_route</title>
<path fill="none" stroke="black" d="M3410,-3328.49C3410,-3310.96 3410,-3288.65 3410,-3267.07"/>
<polygon fill="black" stroke="black" points="3413.5,-3266.89 3410,-3256.89 3406.5,-3266.89 3413.5,-3266.89"/>
</g>
<!-- layer4_moe_alltoall -->
<g id="node79" class="node">
<title>layer4_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="3410" cy="-3021.78" rx="125.32" ry="26.74"/>
<text text-anchor="middle" x="3410" y="-3025.58" font-family="Times,serif" font-size="14.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3410" y="-3010.58" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 128&#45;159]</text>
</g>
<!-- layer4_route&#45;&gt;layer4_moe_alltoall -->
<g id="edge76" class="edge">
<title>layer4_route&#45;&gt;layer4_moe_alltoall</title>
<path fill="none" stroke="black" d="M3410,-3120.59C3410,-3099.58 3410,-3077.18 3410,-3059.13"/>
<polygon fill="black" stroke="black" points="3413.5,-3059.04 3410,-3049.04 3406.5,-3059.04 3413.5,-3059.04"/>
</g>
<!-- layer4_expert_group_0 -->
<g id="node45" class="node">
<title>layer4_expert_group_0</title>
<polygon fill="lightblue" stroke="black" points="298.5,-2922.91 121.5,-2922.91 121.5,-2839.91 298.5,-2839.91 298.5,-2922.91"/>
<text text-anchor="middle" x="210" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 0</text>
<text text-anchor="middle" x="210" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="210" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 128&#45;131]</text>
<text text-anchor="middle" x="210" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="210" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_combine -->
<g id="node77" class="node">
<title>layer4_combine</title>
<polygon fill="lightyellow" stroke="black" points="3656.04,-2767.91 3341,-2767.91 3259.96,-2631.91 3575,-2631.91 3656.04,-2767.91"/>
<text text-anchor="middle" x="3458" y="-2718.71" font-family="Times,serif" font-size="14.00">Layer 4 Expert Combine</text>
<text text-anchor="middle" x="3458" y="-2703.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 128&#45;159]</text>
<text text-anchor="middle" x="3458" y="-2688.71" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3458" y="-2673.71" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer4_expert_group_0&#45;&gt;layer4_combine -->
<g id="edge78" class="edge">
<title>layer4_expert_group_0&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298.7,-2844.43C304.83,-2842.69 310.97,-2841.16 317,-2839.91 893.21,-2721.29 2725.93,-2703.88 3290.69,-2701.34"/>
<polygon fill="black" stroke="black" points="3290.97,-2704.84 3300.95,-2701.3 3290.94,-2697.84 3290.97,-2704.84"/>
</g>
<!-- layer4_expert_group_1 -->
<g id="node46" class="node">
<title>layer4_expert_group_1</title>
<polygon fill="lightblue" stroke="black" points="511.5,-2922.91 334.5,-2922.91 334.5,-2839.91 511.5,-2839.91 511.5,-2922.91"/>
<text text-anchor="middle" x="423" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 1</text>
<text text-anchor="middle" x="423" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="423" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 132&#45;135]</text>
<text text-anchor="middle" x="423" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="423" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_1&#45;&gt;layer4_combine -->
<g id="edge80" class="edge">
<title>layer4_expert_group_1&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M511.7,-2844.45C517.83,-2842.71 523.97,-2841.17 530,-2839.91 1063.5,-2729.19 2753.09,-2706.44 3291.48,-2701.97"/>
<polygon fill="black" stroke="black" points="3291.68,-2705.47 3301.65,-2701.88 3291.62,-2698.47 3291.68,-2705.47"/>
</g>
<!-- layer4_expert_group_2 -->
<g id="node47" class="node">
<title>layer4_expert_group_2</title>
<polygon fill="lightblue" stroke="black" points="724.5,-2922.91 547.5,-2922.91 547.5,-2839.91 724.5,-2839.91 724.5,-2922.91"/>
<text text-anchor="middle" x="636" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 2</text>
<text text-anchor="middle" x="636" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="636" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 136&#45;139]</text>
<text text-anchor="middle" x="636" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="636" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_2&#45;&gt;layer4_combine -->
<g id="edge82" class="edge">
<title>layer4_expert_group_2&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M724.71,-2844.48C730.84,-2842.73 736.97,-2841.18 743,-2839.91 1233.74,-2737.11 2780.01,-2709.21 3291.73,-2702.69"/>
<polygon fill="black" stroke="black" points="3291.82,-2706.19 3301.78,-2702.56 3291.74,-2699.19 3291.82,-2706.19"/>
</g>
<!-- layer4_expert_group_3 -->
<g id="node48" class="node">
<title>layer4_expert_group_3</title>
<polygon fill="lightblue" stroke="black" points="937.5,-2922.91 760.5,-2922.91 760.5,-2839.91 937.5,-2839.91 937.5,-2922.91"/>
<text text-anchor="middle" x="849" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 3</text>
<text text-anchor="middle" x="849" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="849" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 140&#45;143]</text>
<text text-anchor="middle" x="849" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="849" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_3&#45;&gt;layer4_combine -->
<g id="edge84" class="edge">
<title>layer4_expert_group_3&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M937.71,-2844.51C943.84,-2842.75 949.98,-2841.19 956,-2839.91 1404.21,-2745 2808.53,-2712.18 3292.29,-2703.52"/>
<polygon fill="black" stroke="black" points="3292.56,-2707.02 3302.49,-2703.34 3292.43,-2700.02 3292.56,-2707.02"/>
</g>
<!-- layer4_expert_group_4 -->
<g id="node49" class="node">
<title>layer4_expert_group_4</title>
<polygon fill="lightblue" stroke="black" points="1150.5,-2922.91 973.5,-2922.91 973.5,-2839.91 1150.5,-2839.91 1150.5,-2922.91"/>
<text text-anchor="middle" x="1062" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 4</text>
<text text-anchor="middle" x="1062" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1062" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 144&#45;147]</text>
<text text-anchor="middle" x="1062" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1062" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_4&#45;&gt;layer4_combine -->
<g id="edge86" class="edge">
<title>layer4_expert_group_4&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1150.72,-2844.54C1156.85,-2842.78 1162.98,-2841.2 1169,-2839.91 1574.77,-2752.9 2837.64,-2715.43 3292.56,-2704.51"/>
<polygon fill="black" stroke="black" points="3292.92,-2708 3302.83,-2704.27 3292.75,-2701 3292.92,-2708"/>
</g>
<!-- layer4_expert_group_5 -->
<g id="node50" class="node">
<title>layer4_expert_group_5</title>
<polygon fill="lightblue" stroke="black" points="1363.5,-2922.91 1186.5,-2922.91 1186.5,-2839.91 1363.5,-2839.91 1363.5,-2922.91"/>
<text text-anchor="middle" x="1275" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 5</text>
<text text-anchor="middle" x="1275" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1275" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 148&#45;151]</text>
<text text-anchor="middle" x="1275" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1275" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_5&#45;&gt;layer4_combine -->
<g id="edge88" class="edge">
<title>layer4_expert_group_5&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1363.73,-2844.59C1369.86,-2842.81 1375.98,-2841.22 1382,-2839.91 1745.68,-2760.74 2869.1,-2718.96 3293.43,-2705.68"/>
<polygon fill="black" stroke="black" points="3293.75,-2709.17 3303.63,-2705.36 3293.53,-2702.17 3293.75,-2709.17"/>
</g>
<!-- layer4_expert_group_6 -->
<g id="node51" class="node">
<title>layer4_expert_group_6</title>
<polygon fill="lightblue" stroke="black" points="1576.5,-2922.91 1399.5,-2922.91 1399.5,-2839.91 1576.5,-2839.91 1576.5,-2922.91"/>
<text text-anchor="middle" x="1488" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 6</text>
<text text-anchor="middle" x="1488" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1488" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 152&#45;155]</text>
<text text-anchor="middle" x="1488" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1488" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_6&#45;&gt;layer4_combine -->
<g id="edge90" class="edge">
<title>layer4_expert_group_6&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1576.74,-2844.64C1582.86,-2842.85 1588.99,-2841.25 1595,-2839.91 1916.79,-2768.58 2901.94,-2722.9 3294.28,-2707.1"/>
<polygon fill="black" stroke="black" points="3294.44,-2710.6 3304.29,-2706.7 3294.16,-2703.6 3294.44,-2710.6"/>
</g>
<!-- layer4_expert_group_7 -->
<g id="node52" class="node">
<title>layer4_expert_group_7</title>
<polygon fill="lightblue" stroke="black" points="1789.5,-2922.91 1612.5,-2922.91 1612.5,-2839.91 1789.5,-2839.91 1789.5,-2922.91"/>
<text text-anchor="middle" x="1701" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 7</text>
<text text-anchor="middle" x="1701" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1701" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 156&#45;159]</text>
<text text-anchor="middle" x="1701" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1701" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_7&#45;&gt;layer4_combine -->
<g id="edge92" class="edge">
<title>layer4_expert_group_7&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1789.76,-2844.71C1795.88,-2842.9 1801.99,-2841.28 1808,-2839.91 2088.12,-2776.41 2936.29,-2727.35 3295,-2708.88"/>
<polygon fill="black" stroke="black" points="3295.41,-2712.36 3305.21,-2708.36 3295.05,-2705.37 3295.41,-2712.36"/>
</g>
<!-- layer4_expert_group_8 -->
<g id="node53" class="node">
<title>layer4_expert_group_8</title>
<polygon fill="lightblue" stroke="black" points="2002.5,-2922.91 1825.5,-2922.91 1825.5,-2839.91 2002.5,-2839.91 2002.5,-2922.91"/>
<text text-anchor="middle" x="1914" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 8</text>
<text text-anchor="middle" x="1914" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1914" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 160&#45;163]</text>
<text text-anchor="middle" x="1914" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1914" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_8&#45;&gt;layer4_combine -->
<g id="edge94" class="edge">
<title>layer4_expert_group_8&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2002.78,-2844.79C2008.89,-2842.97 2015,-2841.31 2021,-2839.91 2472.41,-2734.63 3021.54,-2708.92 3291.63,-2702.76"/>
<polygon fill="black" stroke="black" points="3291.99,-2706.25 3301.91,-2702.53 3291.83,-2699.26 3291.99,-2706.25"/>
</g>
<!-- layer4_expert_group_9 -->
<g id="node54" class="node">
<title>layer4_expert_group_9</title>
<polygon fill="lightblue" stroke="black" points="2215.5,-2922.91 2038.5,-2922.91 2038.5,-2839.91 2215.5,-2839.91 2215.5,-2922.91"/>
<text text-anchor="middle" x="2127" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 9</text>
<text text-anchor="middle" x="2127" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2127" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 164&#45;167]</text>
<text text-anchor="middle" x="2127" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2127" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_9&#45;&gt;layer4_combine -->
<g id="edge96" class="edge">
<title>layer4_expert_group_9&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2215.51,-2845C2221.71,-2843.11 2227.92,-2841.39 2234,-2839.91 2606.44,-2749.77 3057.14,-2717.72 3294.1,-2706.6"/>
<polygon fill="black" stroke="black" points="3294.35,-2710.09 3304.17,-2706.13 3294.02,-2703.1 3294.35,-2710.09"/>
</g>
<!-- layer4_expert_group_10 -->
<g id="node55" class="node">
<title>layer4_expert_group_10</title>
<polygon fill="lightblue" stroke="black" points="2428.5,-2922.91 2251.5,-2922.91 2251.5,-2839.91 2428.5,-2839.91 2428.5,-2922.91"/>
<text text-anchor="middle" x="2340" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 10</text>
<text text-anchor="middle" x="2340" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2340" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 168&#45;171]</text>
<text text-anchor="middle" x="2340" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2340" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_10&#45;&gt;layer4_combine -->
<g id="edge98" class="edge">
<title>layer4_expert_group_10&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2428.55,-2845.16C2434.75,-2843.23 2440.94,-2841.46 2447,-2839.91 2741.64,-2764.92 3095.55,-2728.01 3296.88,-2711.82"/>
<polygon fill="black" stroke="black" points="3297.25,-2715.3 3306.94,-2711.02 3296.69,-2708.33 3297.25,-2715.3"/>
</g>
<!-- layer4_expert_group_11 -->
<g id="node56" class="node">
<title>layer4_expert_group_11</title>
<polygon fill="lightblue" stroke="black" points="2641.5,-2922.91 2464.5,-2922.91 2464.5,-2839.91 2641.5,-2839.91 2641.5,-2922.91"/>
<text text-anchor="middle" x="2553" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 11</text>
<text text-anchor="middle" x="2553" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2553" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 172&#45;175]</text>
<text text-anchor="middle" x="2553" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2553" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_11&#45;&gt;layer4_combine -->
<g id="edge100" class="edge">
<title>layer4_expert_group_11&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2641.62,-2845.41C2647.8,-2843.42 2653.97,-2841.57 2660,-2839.91 2878.72,-2780.05 3138.51,-2740.45 3300.85,-2719.34"/>
<polygon fill="black" stroke="black" points="3301.45,-2722.79 3310.92,-2718.04 3300.56,-2715.85 3301.45,-2722.79"/>
</g>
<!-- layer4_expert_group_12 -->
<g id="node57" class="node">
<title>layer4_expert_group_12</title>
<polygon fill="lightblue" stroke="black" points="2854.5,-2922.91 2677.5,-2922.91 2677.5,-2839.91 2854.5,-2839.91 2854.5,-2922.91"/>
<text text-anchor="middle" x="2766" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 12</text>
<text text-anchor="middle" x="2766" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2766" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 176&#45;179]</text>
<text text-anchor="middle" x="2766" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2766" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_12&#45;&gt;layer4_combine -->
<g id="edge102" class="edge">
<title>layer4_expert_group_12&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2854.74,-2845.83C2860.89,-2843.74 2867.02,-2841.75 2873,-2839.91 3018.85,-2795.19 3188.83,-2756.23 3307.85,-2731.03"/>
<polygon fill="black" stroke="black" points="3308.7,-2734.42 3317.76,-2728.93 3307.26,-2727.57 3308.7,-2734.42"/>
</g>
<!-- layer4_expert_group_13 -->
<g id="node58" class="node">
<title>layer4_expert_group_13</title>
<polygon fill="lightblue" stroke="black" points="3067.5,-2922.91 2890.5,-2922.91 2890.5,-2839.91 3067.5,-2839.91 3067.5,-2922.91"/>
<text text-anchor="middle" x="2979" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 13</text>
<text text-anchor="middle" x="2979" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2979" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 180&#45;183]</text>
<text text-anchor="middle" x="2979" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2979" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_13&#45;&gt;layer4_combine -->
<g id="edge104" class="edge">
<title>layer4_expert_group_13&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3067.74,-2846.79C3073.92,-2844.46 3080.05,-2842.15 3086,-2839.91 3163.2,-2810.88 3249.47,-2778.63 3319.49,-2752.51"/>
<polygon fill="black" stroke="black" points="3321.11,-2755.64 3329.26,-2748.87 3318.67,-2749.08 3321.11,-2755.64"/>
</g>
<!-- layer4_expert_group_14 -->
<g id="node59" class="node">
<title>layer4_expert_group_14</title>
<polygon fill="lightblue" stroke="black" points="3280.5,-2922.91 3103.5,-2922.91 3103.5,-2839.91 3280.5,-2839.91 3280.5,-2922.91"/>
<text text-anchor="middle" x="3192" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 14</text>
<text text-anchor="middle" x="3192" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3192" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 184&#45;187]</text>
<text text-anchor="middle" x="3192" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3192" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_14&#45;&gt;layer4_combine -->
<g id="edge106" class="edge">
<title>layer4_expert_group_14&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3252.03,-2839.91C3280.99,-2820.37 3316.63,-2796.31 3350.08,-2773.74"/>
<polygon fill="black" stroke="black" points="3352.2,-2776.53 3358.53,-2768.04 3348.28,-2770.73 3352.2,-2776.53"/>
</g>
<!-- layer4_expert_group_15 -->
<g id="node60" class="node">
<title>layer4_expert_group_15</title>
<polygon fill="lightblue" stroke="black" points="3493.5,-2922.91 3316.5,-2922.91 3316.5,-2839.91 3493.5,-2839.91 3493.5,-2922.91"/>
<text text-anchor="middle" x="3405" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 15</text>
<text text-anchor="middle" x="3405" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3405" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 188&#45;191]</text>
<text text-anchor="middle" x="3405" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3405" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_15&#45;&gt;layer4_combine -->
<g id="edge108" class="edge">
<title>layer4_expert_group_15&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3417.03,-2839.68C3422.43,-2821.38 3428.99,-2799.16 3435.26,-2777.92"/>
<polygon fill="black" stroke="black" points="3438.65,-2778.82 3438.12,-2768.24 3431.93,-2776.84 3438.65,-2778.82"/>
</g>
<!-- layer4_expert_group_16 -->
<g id="node61" class="node">
<title>layer4_expert_group_16</title>
<polygon fill="lightblue" stroke="black" points="3706.5,-2922.91 3529.5,-2922.91 3529.5,-2839.91 3706.5,-2839.91 3706.5,-2922.91"/>
<text text-anchor="middle" x="3618" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 16</text>
<text text-anchor="middle" x="3618" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3618" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 192&#45;195]</text>
<text text-anchor="middle" x="3618" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3618" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_16&#45;&gt;layer4_combine -->
<g id="edge110" class="edge">
<title>layer4_expert_group_16&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3581.69,-2839.68C3564.87,-2820.81 3544.32,-2797.76 3524.85,-2775.91"/>
<polygon fill="black" stroke="black" points="3527.28,-2773.38 3518.01,-2768.24 3522.05,-2778.03 3527.28,-2773.38"/>
</g>
<!-- layer4_expert_group_17 -->
<g id="node62" class="node">
<title>layer4_expert_group_17</title>
<polygon fill="lightblue" stroke="black" points="3919.5,-2922.91 3742.5,-2922.91 3742.5,-2839.91 3919.5,-2839.91 3919.5,-2922.91"/>
<text text-anchor="middle" x="3831" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 17</text>
<text text-anchor="middle" x="3831" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3831" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 196&#45;199]</text>
<text text-anchor="middle" x="3831" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3831" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_17&#45;&gt;layer4_combine -->
<g id="edge112" class="edge">
<title>layer4_expert_group_17&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3746.83,-2839.91C3705.45,-2819.99 3654.33,-2795.39 3606.66,-2772.45"/>
<polygon fill="black" stroke="black" points="3608.02,-2769.22 3597.49,-2768.04 3604.98,-2775.53 3608.02,-2769.22"/>
</g>
<!-- layer4_expert_group_18 -->
<g id="node63" class="node">
<title>layer4_expert_group_18</title>
<polygon fill="lightblue" stroke="black" points="4132.5,-2922.91 3955.5,-2922.91 3955.5,-2839.91 4132.5,-2839.91 4132.5,-2922.91"/>
<text text-anchor="middle" x="4044" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 18</text>
<text text-anchor="middle" x="4044" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4044" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 200&#45;203]</text>
<text text-anchor="middle" x="4044" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4044" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_18&#45;&gt;layer4_combine -->
<g id="edge114" class="edge">
<title>layer4_expert_group_18&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3955.42,-2845.95C3949.54,-2843.85 3943.7,-2841.82 3938,-2839.91 3846.13,-2809.12 3743.05,-2778.74 3656.04,-2754.27"/>
<polygon fill="black" stroke="black" points="3656.9,-2750.87 3646.33,-2751.54 3655.01,-2757.61 3656.9,-2750.87"/>
</g>
<!-- layer4_expert_group_19 -->
<g id="node64" class="node">
<title>layer4_expert_group_19</title>
<polygon fill="lightblue" stroke="black" points="4345.5,-2922.91 4168.5,-2922.91 4168.5,-2839.91 4345.5,-2839.91 4345.5,-2922.91"/>
<text text-anchor="middle" x="4257" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 19</text>
<text text-anchor="middle" x="4257" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4257" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 204&#45;207]</text>
<text text-anchor="middle" x="4257" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4257" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_19&#45;&gt;layer4_combine -->
<g id="edge116" class="edge">
<title>layer4_expert_group_19&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4168.3,-2845.29C4162.48,-2843.37 4156.68,-2841.56 4151,-2839.91 3981.2,-2790.82 3783.08,-2752.97 3642.27,-2729.25"/>
<polygon fill="black" stroke="black" points="3642.67,-2725.77 3632.23,-2727.56 3641.52,-2732.67 3642.67,-2725.77"/>
</g>
<!-- layer4_expert_group_20 -->
<g id="node65" class="node">
<title>layer4_expert_group_20</title>
<polygon fill="lightblue" stroke="black" points="4558.5,-2922.91 4381.5,-2922.91 4381.5,-2839.91 4558.5,-2839.91 4558.5,-2922.91"/>
<text text-anchor="middle" x="4470" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 20</text>
<text text-anchor="middle" x="4470" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4470" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 208&#45;211]</text>
<text text-anchor="middle" x="4470" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4470" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_20&#45;&gt;layer4_combine -->
<g id="edge118" class="edge">
<title>layer4_expert_group_20&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4381.38,-2844.99C4375.54,-2843.14 4369.71,-2841.43 4364,-2839.91 4115.31,-2774.13 3819.45,-2736 3635.14,-2716.83"/>
<polygon fill="black" stroke="black" points="3635.39,-2713.34 3625.08,-2715.79 3634.67,-2720.3 3635.39,-2713.34"/>
</g>
<!-- layer4_expert_group_21 -->
<g id="node66" class="node">
<title>layer4_expert_group_21</title>
<polygon fill="lightblue" stroke="black" points="4771.5,-2922.91 4594.5,-2922.91 4594.5,-2839.91 4771.5,-2839.91 4771.5,-2922.91"/>
<text text-anchor="middle" x="4683" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 21</text>
<text text-anchor="middle" x="4683" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4683" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 212&#45;215]</text>
<text text-anchor="middle" x="4683" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4683" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_21&#45;&gt;layer4_combine -->
<g id="edge120" class="edge">
<title>layer4_expert_group_21&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4594.43,-2844.79C4588.58,-2842.99 4582.73,-2841.34 4577,-2839.91 4248.45,-2758.02 3853.04,-2723.34 3631.1,-2709.45"/>
<polygon fill="black" stroke="black" points="3631.19,-2705.95 3621,-2708.83 3630.76,-2712.94 3631.19,-2705.95"/>
</g>
<!-- layer4_expert_group_22 -->
<g id="node67" class="node">
<title>layer4_expert_group_22</title>
<polygon fill="lightblue" stroke="black" points="4984.5,-2922.91 4807.5,-2922.91 4807.5,-2839.91 4984.5,-2839.91 4984.5,-2922.91"/>
<text text-anchor="middle" x="4896" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 22</text>
<text text-anchor="middle" x="4896" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4896" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 216&#45;219]</text>
<text text-anchor="middle" x="4896" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4896" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_22&#45;&gt;layer4_combine -->
<g id="edge122" class="edge">
<title>layer4_expert_group_22&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4807.47,-2844.66C4801.61,-2842.89 4795.75,-2841.29 4790,-2839.91 4380.5,-2742.1 3883.86,-2713.11 3628.25,-2704.53"/>
<polygon fill="black" stroke="black" points="3628.25,-2701.03 3618.14,-2704.19 3628.02,-2708.02 3628.25,-2701.03"/>
</g>
<!-- layer4_expert_group_23 -->
<g id="node68" class="node">
<title>layer4_expert_group_23</title>
<polygon fill="lightblue" stroke="black" points="5197.5,-2922.91 5020.5,-2922.91 5020.5,-2839.91 5197.5,-2839.91 5197.5,-2922.91"/>
<text text-anchor="middle" x="5109" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 23</text>
<text text-anchor="middle" x="5109" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5109" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 220&#45;223]</text>
<text text-anchor="middle" x="5109" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5109" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_23&#45;&gt;layer4_combine -->
<g id="edge124" class="edge">
<title>layer4_expert_group_23&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5020.49,-2844.57C5014.62,-2842.82 5008.76,-2841.25 5003,-2839.91 4511.77,-2726.27 3912.73,-2704.51 3626.28,-2701.01"/>
<polygon fill="black" stroke="black" points="3626.26,-2697.51 3616.22,-2700.9 3626.18,-2704.51 3626.26,-2697.51"/>
</g>
<!-- layer4_expert_group_24 -->
<g id="node69" class="node">
<title>layer4_expert_group_24</title>
<polygon fill="lightblue" stroke="black" points="5410.5,-2922.91 5233.5,-2922.91 5233.5,-2839.91 5410.5,-2839.91 5410.5,-2922.91"/>
<text text-anchor="middle" x="5322" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 24</text>
<text text-anchor="middle" x="5322" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5322" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 224&#45;227]</text>
<text text-anchor="middle" x="5322" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5322" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_24&#45;&gt;layer4_combine -->
<g id="edge126" class="edge">
<title>layer4_expert_group_24&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5233.21,-2844.41C5227.44,-2842.72 5221.67,-2841.19 5216,-2839.91 4917.29,-2772.51 4011.99,-2725.57 3630.47,-2708.27"/>
<polygon fill="black" stroke="black" points="3630.59,-2704.78 3620.45,-2707.82 3630.28,-2711.77 3630.59,-2704.78"/>
</g>
<!-- layer4_expert_group_25 -->
<g id="node70" class="node">
<title>layer4_expert_group_25</title>
<polygon fill="lightblue" stroke="black" points="5623.5,-2922.91 5446.5,-2922.91 5446.5,-2839.91 5623.5,-2839.91 5623.5,-2922.91"/>
<text text-anchor="middle" x="5535" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 25</text>
<text text-anchor="middle" x="5535" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5535" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 228&#45;231]</text>
<text text-anchor="middle" x="5535" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5535" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_25&#45;&gt;layer4_combine -->
<g id="edge128" class="edge">
<title>layer4_expert_group_25&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5446.22,-2844.35C5440.45,-2842.67 5434.67,-2841.17 5429,-2839.91 5088.22,-2764.54 4043.9,-2721.17 3629.78,-2706.55"/>
<polygon fill="black" stroke="black" points="3629.63,-2703.04 3619.51,-2706.19 3629.39,-2710.03 3629.63,-2703.04"/>
</g>
<!-- layer4_expert_group_26 -->
<g id="node71" class="node">
<title>layer4_expert_group_26</title>
<polygon fill="lightblue" stroke="black" points="5836.5,-2922.91 5659.5,-2922.91 5659.5,-2839.91 5836.5,-2839.91 5836.5,-2922.91"/>
<text text-anchor="middle" x="5748" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 26</text>
<text text-anchor="middle" x="5748" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5748" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 232&#45;235]</text>
<text text-anchor="middle" x="5748" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5748" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_26&#45;&gt;layer4_combine -->
<g id="edge130" class="edge">
<title>layer4_expert_group_26&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5659.23,-2844.31C5653.46,-2842.64 5647.68,-2841.15 5642,-2839.91 5258.83,-2756.54 4073.56,-2717.24 3628.87,-2705.15"/>
<polygon fill="black" stroke="black" points="3628.92,-2701.65 3618.83,-2704.88 3628.73,-2708.65 3628.92,-2701.65"/>
</g>
<!-- layer4_expert_group_27 -->
<g id="node72" class="node">
<title>layer4_expert_group_27</title>
<polygon fill="lightblue" stroke="black" points="6049.5,-2922.91 5872.5,-2922.91 5872.5,-2839.91 6049.5,-2839.91 6049.5,-2922.91"/>
<text text-anchor="middle" x="5961" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 27</text>
<text text-anchor="middle" x="5961" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5961" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 236&#45;239]</text>
<text text-anchor="middle" x="5961" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5961" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_27&#45;&gt;layer4_combine -->
<g id="edge132" class="edge">
<title>layer4_expert_group_27&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5872.24,-2844.27C5866.46,-2842.61 5860.68,-2841.13 5855,-2839.91 5429.21,-2748.52 4101.63,-2713.72 3628.01,-2704.01"/>
<polygon fill="black" stroke="black" points="3628.08,-2700.51 3618.01,-2703.81 3627.93,-2707.51 3628.08,-2700.51"/>
</g>
<!-- layer4_expert_group_28 -->
<g id="node73" class="node">
<title>layer4_expert_group_28</title>
<polygon fill="lightblue" stroke="black" points="6262.5,-2922.91 6085.5,-2922.91 6085.5,-2839.91 6262.5,-2839.91 6262.5,-2922.91"/>
<text text-anchor="middle" x="6174" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 28</text>
<text text-anchor="middle" x="6174" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6174" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 240&#45;243]</text>
<text text-anchor="middle" x="6174" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6174" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_28&#45;&gt;layer4_combine -->
<g id="edge134" class="edge">
<title>layer4_expert_group_28&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6085.25,-2844.24C6079.47,-2842.59 6073.69,-2841.12 6068,-2839.91 5599.6,-2740.53 4129.64,-2710.54 3627.84,-2703.07"/>
<polygon fill="black" stroke="black" points="3627.67,-2699.57 3617.62,-2702.92 3627.56,-2706.57 3627.67,-2699.57"/>
</g>
<!-- layer4_expert_group_29 -->
<g id="node74" class="node">
<title>layer4_expert_group_29</title>
<polygon fill="lightblue" stroke="black" points="6475.5,-2922.91 6298.5,-2922.91 6298.5,-2839.91 6475.5,-2839.91 6475.5,-2922.91"/>
<text text-anchor="middle" x="6387" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 29</text>
<text text-anchor="middle" x="6387" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6387" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 244&#45;247]</text>
<text text-anchor="middle" x="6387" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6387" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_29&#45;&gt;layer4_combine -->
<g id="edge136" class="edge">
<title>layer4_expert_group_29&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6298.25,-2844.21C6292.47,-2842.57 6286.69,-2841.11 6281,-2839.91 5769.81,-2732.52 4156.42,-2707.62 3627.64,-2702.27"/>
<polygon fill="black" stroke="black" points="3627.29,-2698.77 3617.26,-2702.17 3627.22,-2705.77 3627.29,-2698.77"/>
</g>
<!-- layer4_expert_group_30 -->
<g id="node75" class="node">
<title>layer4_expert_group_30</title>
<polygon fill="lightblue" stroke="black" points="6688.5,-2922.91 6511.5,-2922.91 6511.5,-2839.91 6688.5,-2839.91 6688.5,-2922.91"/>
<text text-anchor="middle" x="6600" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 30</text>
<text text-anchor="middle" x="6600" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6600" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 248&#45;251]</text>
<text text-anchor="middle" x="6600" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6600" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_30&#45;&gt;layer4_combine -->
<g id="edge138" class="edge">
<title>layer4_expert_group_30&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6511.26,-2844.19C6505.48,-2842.55 6499.69,-2841.1 6494,-2839.91 5939.69,-2724.46 4180.97,-2704.89 3626.88,-2701.59"/>
<polygon fill="black" stroke="black" points="3626.83,-2698.08 3616.81,-2701.53 3626.79,-2705.08 3626.83,-2698.08"/>
</g>
<!-- layer4_expert_group_31 -->
<g id="node76" class="node">
<title>layer4_expert_group_31</title>
<polygon fill="lightblue" stroke="black" points="6901.5,-2922.91 6724.5,-2922.91 6724.5,-2839.91 6901.5,-2839.91 6901.5,-2922.91"/>
<text text-anchor="middle" x="6813" y="-2907.71" font-family="Times,serif" font-size="14.00">Expert Group 31</text>
<text text-anchor="middle" x="6813" y="-2892.71" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6813" y="-2877.71" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 252&#45;255]</text>
<text text-anchor="middle" x="6813" y="-2862.71" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6813" y="-2847.71" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer4_expert_group_31&#45;&gt;layer4_combine -->
<g id="edge140" class="edge">
<title>layer4_expert_group_31&#45;&gt;layer4_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6724.26,-2844.17C6718.48,-2842.53 6712.69,-2841.09 6707,-2839.91 6109.6,-2716.41 4205.61,-2702.37 3626.63,-2700.99"/>
<polygon fill="black" stroke="black" points="3626.54,-2697.49 3616.53,-2700.97 3626.52,-2704.49 3626.54,-2697.49"/>
</g>
<!-- layer8_attn_qkv_tp -->
<g id="node80" class="node">
<title>layer8_attn_qkv_tp</title>
<polygon fill="lightblue" stroke="black" points="3550.5,-2559.91 3365.5,-2559.91 3365.5,-2491.91 3550.5,-2491.91 3550.5,-2559.91"/>
<text text-anchor="middle" x="3458" y="-2544.71" font-family="Times,serif" font-size="14.00">Layer 8 Attention QKV</text>
<text text-anchor="middle" x="3458" y="-2529.71" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 256&#45;259]</text>
<text text-anchor="middle" x="3458" y="-2514.71" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3458" y="-2499.71" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer4_combine&#45;&gt;layer8_attn_qkv_tp -->
<g id="edge141" class="edge">
<title>layer4_combine&#45;&gt;layer8_attn_qkv_tp</title>
<path fill="none" stroke="black" d="M3458,-2631.43C3458,-2610.88 3458,-2588.85 3458,-2570.33"/>
<polygon fill="black" stroke="black" points="3461.5,-2570.16 3458,-2560.16 3454.5,-2570.16 3461.5,-2570.16"/>
</g>
<!-- layer4_attn_allreduce&#45;&gt;layer4_attn_out_tp -->
<g id="edge74" class="edge">
<title>layer4_attn_allreduce&#45;&gt;layer4_attn_out_tp</title>
<path fill="none" stroke="black" d="M3410,-3468.35C3410,-3450.82 3410,-3427.32 3410,-3407.03"/>
<polygon fill="black" stroke="black" points="3413.5,-3406.76 3410,-3396.76 3406.5,-3406.76 3413.5,-3406.76"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_0 -->
<g id="edge77" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_0</title>
<path fill="none" stroke="black" d="M3285.07,-3019.26C2743.29,-3012.32 610.98,-2981.51 317,-2922.91 314.17,-2922.35 311.32,-2921.72 308.45,-2921.03"/>
<polygon fill="black" stroke="black" points="309.24,-2917.62 298.68,-2918.49 307.47,-2924.39 309.24,-2917.62"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_1 -->
<g id="edge79" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_1</title>
<path fill="none" stroke="black" d="M3285.5,-3018.95C2768.11,-3011.01 802.24,-2977.51 530,-2922.91 527.17,-2922.35 524.32,-2921.71 521.45,-2921.02"/>
<polygon fill="black" stroke="black" points="522.24,-2917.61 511.68,-2918.47 520.47,-2924.38 522.24,-2917.61"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_2 -->
<g id="edge81" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_2</title>
<path fill="none" stroke="black" d="M3285.65,-3018.59C2793.08,-3009.58 993.5,-2973.5 743,-2922.91 740.17,-2922.34 737.32,-2921.71 734.45,-2921.01"/>
<polygon fill="black" stroke="black" points="735.25,-2917.6 724.69,-2918.45 733.47,-2924.37 735.25,-2917.6"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_3 -->
<g id="edge83" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_3</title>
<path fill="none" stroke="black" d="M3284.68,-3021.09C2849.87,-3021.32 1408.15,-3014.97 956,-2922.91 953.17,-2922.34 950.32,-2921.7 947.46,-2921"/>
<polygon fill="black" stroke="black" points="948.25,-2917.59 937.69,-2918.43 946.47,-2924.36 948.25,-2917.59"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_4 -->
<g id="edge85" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_4</title>
<path fill="none" stroke="black" d="M3284.67,-3020.53C2874.96,-3018.89 1578.11,-3007.01 1169,-2922.91 1166.17,-2922.33 1163.32,-2921.69 1160.46,-2920.99"/>
<polygon fill="black" stroke="black" points="1161.26,-2917.58 1150.7,-2918.4 1159.47,-2924.34 1161.26,-2917.58"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_5 -->
<g id="edge87" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_5</title>
<path fill="none" stroke="black" d="M3284.98,-3019.86C2901.93,-3016.23 1748.36,-2999.1 1382,-2922.91 1379.17,-2922.33 1376.32,-2921.67 1373.46,-2920.97"/>
<polygon fill="black" stroke="black" points="1374.27,-2917.56 1363.7,-2918.37 1372.47,-2924.33 1374.27,-2917.56"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_6 -->
<g id="edge89" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_6</title>
<path fill="none" stroke="black" d="M3285.39,-3019.04C2930.44,-3013.29 1918.82,-2991.21 1595,-2922.91 1592.18,-2922.32 1589.33,-2921.66 1586.47,-2920.95"/>
<polygon fill="black" stroke="black" points="1587.28,-2917.54 1576.71,-2918.33 1585.46,-2924.3 1587.28,-2917.54"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_7 -->
<g id="edge91" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_7</title>
<path fill="none" stroke="black" d="M3285.91,-3018.02C2960.73,-3009.99 2089.55,-2983.34 1808,-2922.91 1805.18,-2922.31 1802.33,-2921.64 1799.47,-2920.92"/>
<polygon fill="black" stroke="black" points="1800.29,-2917.52 1789.72,-2918.28 1798.46,-2924.27 1800.29,-2917.52"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_8 -->
<g id="edge93" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_8</title>
<path fill="none" stroke="black" d="M3286.86,-3016.7C2993.64,-3006.24 2260.66,-2975.52 2021,-2922.91 2018.18,-2922.29 2015.34,-2921.62 2012.48,-2920.89"/>
<polygon fill="black" stroke="black" points="2013.3,-2917.48 2002.74,-2918.22 2011.46,-2924.23 2013.3,-2917.48"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_9 -->
<g id="edge95" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_9</title>
<path fill="none" stroke="black" d="M3284.67,-3021.72C3067.8,-3020.84 2609.67,-3007.88 2234,-2922.91 2231.18,-2922.28 2228.34,-2921.58 2225.49,-2920.84"/>
<polygon fill="black" stroke="black" points="2226.33,-2917.44 2215.76,-2918.13 2224.45,-2924.18 2226.33,-2917.44"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_10 -->
<g id="edge97" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_10</title>
<path fill="none" stroke="black" d="M3285.55,-3018.44C3100.38,-3012.66 2742.44,-2992.57 2447,-2922.91 2444.19,-2922.25 2441.36,-2921.53 2438.51,-2920.77"/>
<polygon fill="black" stroke="black" points="2439.36,-2917.37 2428.78,-2918 2437.44,-2924.11 2439.36,-2917.37"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_11 -->
<g id="edge99" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_11</title>
<path fill="none" stroke="black" d="M3290.52,-3013.77C3141.18,-3003.05 2878.59,-2977.75 2660,-2922.91 2657.16,-2922.2 2654.28,-2921.43 2651.4,-2920.62"/>
<polygon fill="black" stroke="black" points="2652.12,-2917.19 2641.54,-2917.71 2650.14,-2923.9 2652.12,-2917.19"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_12 -->
<g id="edge101" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_12</title>
<path fill="none" stroke="black" d="M3304.27,-3007.3C3195.04,-2992.03 3020.23,-2963.83 2873,-2922.91 2870.17,-2922.13 2867.32,-2921.3 2864.45,-2920.43"/>
<polygon fill="black" stroke="black" points="2865.22,-2917.01 2854.63,-2917.36 2863.13,-2923.69 2865.22,-2917.01"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_13 -->
<g id="edge103" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_13</title>
<path fill="none" stroke="black" d="M3336.2,-3000.05C3270.23,-2981.15 3171.12,-2951.84 3086,-2922.91 3083.09,-2921.92 3080.13,-2920.9 3077.15,-2919.86"/>
<polygon fill="black" stroke="black" points="3078.17,-2916.51 3067.58,-2916.48 3075.84,-2923.11 3078.17,-2916.51"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_14 -->
<g id="edge105" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_14</title>
<path fill="none" stroke="black" d="M3371.28,-2996.21C3341.71,-2977.44 3300.13,-2951.04 3264.45,-2928.4"/>
<polygon fill="black" stroke="black" points="3266.31,-2925.43 3255.99,-2923.03 3262.56,-2931.34 3266.31,-2925.43"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_15 -->
<g id="edge107" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_15</title>
<path fill="none" stroke="black" d="M3409.06,-2994.76C3408.43,-2977.4 3407.59,-2954.01 3406.83,-2933.06"/>
<polygon fill="black" stroke="black" points="3410.33,-2932.88 3406.47,-2923.01 3403.33,-2933.13 3410.33,-2932.88"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_16 -->
<g id="edge109" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_16</title>
<path fill="none" stroke="black" d="M3447.19,-2996.05C3475.3,-2977.34 3514.72,-2951.12 3548.6,-2928.58"/>
<polygon fill="black" stroke="black" points="3550.7,-2931.39 3557.08,-2922.94 3546.82,-2925.56 3550.7,-2931.39"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_17 -->
<g id="edge111" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_17</title>
<path fill="none" stroke="black" d="M3482.36,-2999.73C3546.48,-2980.73 3642.47,-2951.47 3725,-2922.91 3727.57,-2922.02 3730.18,-2921.11 3732.8,-2920.18"/>
<polygon fill="black" stroke="black" points="3734.14,-2923.42 3742.37,-2916.75 3731.78,-2916.83 3734.14,-2923.42"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_18 -->
<g id="edge113" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_18</title>
<path fill="none" stroke="black" d="M3514.97,-3007.07C3622.46,-2991.69 3793.73,-2963.48 3938,-2922.91 3940.49,-2922.21 3943,-2921.48 3945.53,-2920.72"/>
<polygon fill="black" stroke="black" points="3946.84,-2923.97 3955.33,-2917.64 3944.74,-2917.29 3946.84,-2923.97"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_19 -->
<g id="edge115" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_19</title>
<path fill="none" stroke="black" d="M3529.36,-3013.63C3677.16,-3002.81 3935.74,-2977.45 4151,-2922.91 4153.51,-2922.28 4156.03,-2921.6 4158.58,-2920.89"/>
<polygon fill="black" stroke="black" points="4159.82,-2924.17 4168.42,-2917.98 4157.84,-2917.46 4159.82,-2924.17"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_20 -->
<g id="edge117" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_20</title>
<path fill="none" stroke="black" d="M3534.47,-3018.39C3718.27,-3012.54 4072.04,-2992.38 4364,-2922.91 4366.52,-2922.32 4369.05,-2921.67 4371.6,-2920.99"/>
<polygon fill="black" stroke="black" points="4372.81,-2924.28 4381.47,-2918.18 4370.89,-2917.55 4372.81,-2924.28"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_21 -->
<g id="edge119" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_21</title>
<path fill="none" stroke="black" d="M3535.26,-3021.73C3750.86,-3020.83 4204.84,-3007.82 4577,-2922.91 4579.52,-2922.34 4582.06,-2921.72 4584.61,-2921.05"/>
<polygon fill="black" stroke="black" points="4585.8,-2924.35 4594.5,-2918.3 4583.93,-2917.61 4585.8,-2924.35"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_22 -->
<g id="edge121" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_22</title>
<path fill="none" stroke="black" d="M3533.16,-3016.68C3825.04,-3006.22 4552.2,-2975.56 4790,-2922.91 4792.48,-2922.36 4794.98,-2921.77 4797.5,-2921.13"/>
<polygon fill="black" stroke="black" points="4798.5,-2924.48 4807.22,-2918.47 4796.66,-2917.73 4798.5,-2924.48"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_23 -->
<g id="edge123" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_23</title>
<path fill="none" stroke="black" d="M3533.99,-3018.02C3857.83,-3010.02 4723.3,-2983.45 5003,-2922.91 5005.49,-2922.38 5007.99,-2921.79 5010.5,-2921.16"/>
<polygon fill="black" stroke="black" points="5011.49,-2924.52 5020.24,-2918.54 5009.67,-2917.76 5011.49,-2924.52"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_24 -->
<g id="edge125" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_24</title>
<path fill="none" stroke="black" d="M3534.63,-3019.05C3888.43,-3013.34 4894.09,-2991.38 5216,-2922.91 5218.49,-2922.38 5220.99,-2921.81 5223.51,-2921.18"/>
<polygon fill="black" stroke="black" points="5224.49,-2924.55 5233.25,-2918.59 5222.68,-2917.78 5224.49,-2924.55"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_25 -->
<g id="edge127" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_25</title>
<path fill="none" stroke="black" d="M3535.15,-3019.88C3917.21,-3016.31 5064.61,-2999.32 5429,-2922.91 5431.49,-2922.39 5434,-2921.82 5436.51,-2921.2"/>
<polygon fill="black" stroke="black" points="5437.49,-2924.57 5446.26,-2918.62 5435.69,-2917.8 5437.49,-2924.57"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_26 -->
<g id="edge129" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_26</title>
<path fill="none" stroke="black" d="M3535.19,-3020.56C3943.69,-3018.99 5234.78,-3007.32 5642,-2922.91 5644.49,-2922.4 5647,-2921.83 5649.52,-2921.22"/>
<polygon fill="black" stroke="black" points="5650.48,-2924.58 5659.26,-2918.65 5648.7,-2917.81 5650.48,-2924.58"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_27 -->
<g id="edge131" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_27</title>
<path fill="none" stroke="black" d="M3535.24,-3021.12C3968.95,-3021.44 5404.79,-3015.34 5855,-2922.91 5857.49,-2922.4 5860,-2921.84 5862.52,-2921.23"/>
<polygon fill="black" stroke="black" points="5863.48,-2924.6 5872.27,-2918.68 5861.71,-2917.83 5863.48,-2924.6"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_28 -->
<g id="edge133" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_28</title>
<path fill="none" stroke="black" d="M3534.36,-3018.6C4025.87,-3009.63 5818.5,-2973.72 6068,-2922.91 6070.49,-2922.41 6073,-2921.85 6075.52,-2921.24"/>
<polygon fill="black" stroke="black" points="6076.48,-2924.61 6085.27,-2918.7 6074.71,-2917.84 6076.48,-2924.61"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_29 -->
<g id="edge135" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_29</title>
<path fill="none" stroke="black" d="M3534.55,-3018.96C4051.01,-3011.07 6009.77,-2977.76 6281,-2922.91 6283.49,-2922.41 6286,-2921.85 6288.52,-2921.25"/>
<polygon fill="black" stroke="black" points="6289.48,-2924.62 6298.28,-2918.72 6287.72,-2917.85 6289.48,-2924.62"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_30 -->
<g id="edge137" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_30</title>
<path fill="none" stroke="black" d="M3535.02,-3019.27C4075.98,-3012.38 6201.05,-2981.79 6494,-2922.91 6496.49,-2922.41 6499,-2921.86 6501.52,-2921.26"/>
<polygon fill="black" stroke="black" points="6502.48,-2924.63 6511.28,-2918.74 6500.72,-2917.85 6502.48,-2924.63"/>
</g>
<!-- layer4_moe_alltoall&#45;&gt;layer4_expert_group_31 -->
<g id="edge139" class="edge">
<title>layer4_moe_alltoall&#45;&gt;layer4_expert_group_31</title>
<path fill="none" stroke="black" d="M3535.03,-3019.55C4099.01,-3013.62 6392.19,-2985.85 6707,-2922.91 6709.49,-2922.42 6712,-2921.86 6714.53,-2921.27"/>
<polygon fill="black" stroke="black" points="6715.47,-2924.64 6724.28,-2918.75 6713.72,-2917.86 6715.47,-2924.64"/>
</g>
<!-- layer8_attn_score -->
<g id="node81" class="node">
<title>layer8_attn_score</title>
<polygon fill="lightblue" stroke="black" points="3562,-2419.91 3354,-2419.91 3354,-2351.91 3562,-2351.91 3562,-2419.91"/>
<text text-anchor="middle" x="3458" y="-2404.71" font-family="Times,serif" font-size="14.00">Layer 8 Attention Score</text>
<text text-anchor="middle" x="3458" y="-2389.71" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 256&#45;259]</text>
<text text-anchor="middle" x="3458" y="-2374.71" font-family="Times,serif" font-size="14.00">Input: [16,16,1024,64]</text>
<text text-anchor="middle" x="3458" y="-2359.71" font-family="Times,serif" font-size="14.00">Output: [16,16,1024,1024]</text>
</g>
<!-- layer8_attn_qkv_tp&#45;&gt;layer8_attn_score -->
<g id="edge142" class="edge">
<title>layer8_attn_qkv_tp&#45;&gt;layer8_attn_score</title>
<path fill="none" stroke="black" d="M3458,-2491.86C3458,-2473.39 3458,-2450.15 3458,-2430.24"/>
<polygon fill="black" stroke="black" points="3461.5,-2430.18 3458,-2420.18 3454.5,-2430.18 3461.5,-2430.18"/>
</g>
<!-- layer8_attn_allreduce -->
<g id="node117" class="node">
<title>layer8_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3458" cy="-2253.04" rx="118.17" ry="26.74"/>
<text text-anchor="middle" x="3458" y="-2256.84" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3458" y="-2241.84" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 256&#45;259]</text>
</g>
<!-- layer8_attn_score&#45;&gt;layer8_attn_allreduce -->
<g id="edge143" class="edge">
<title>layer8_attn_score&#45;&gt;layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M3458,-2351.89C3458,-2333.11 3458,-2309.56 3458,-2290.27"/>
<polygon fill="black" stroke="black" points="3461.5,-2290.05 3458,-2280.05 3454.5,-2290.05 3461.5,-2290.05"/>
</g>
<!-- layer8_attn_out_tp -->
<g id="node82" class="node">
<title>layer8_attn_out_tp</title>
<polygon fill="lightblue" stroke="black" points="3556.5,-2154.17 3359.5,-2154.17 3359.5,-2086.17 3556.5,-2086.17 3556.5,-2154.17"/>
<text text-anchor="middle" x="3458" y="-2138.97" font-family="Times,serif" font-size="14.00">Layer 8 Attention Output</text>
<text text-anchor="middle" x="3458" y="-2123.97" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 256&#45;259]</text>
<text text-anchor="middle" x="3458" y="-2108.97" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3458" y="-2093.97" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer8_route -->
<g id="node83" class="node">
<title>layer8_route</title>
<polygon fill="lightyellow" stroke="black" points="3649.6,-2014.17 3344.81,-2014.17 3266.4,-1878.17 3571.19,-1878.17 3649.6,-2014.17"/>
<text text-anchor="middle" x="3458" y="-1964.97" font-family="Times,serif" font-size="14.00">Layer 8 Expert Routing</text>
<text text-anchor="middle" x="3458" y="-1949.97" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 256&#45;287]</text>
<text text-anchor="middle" x="3458" y="-1934.97" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3458" y="-1919.97" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer8_attn_out_tp&#45;&gt;layer8_route -->
<g id="edge145" class="edge">
<title>layer8_attn_out_tp&#45;&gt;layer8_route</title>
<path fill="none" stroke="black" d="M3458,-2086.01C3458,-2068.48 3458,-2046.17 3458,-2024.59"/>
<polygon fill="black" stroke="black" points="3461.5,-2024.41 3458,-2014.41 3454.5,-2024.41 3461.5,-2024.41"/>
</g>
<!-- layer8_moe_alltoall -->
<g id="node118" class="node">
<title>layer8_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="3458" cy="-1779.3" rx="125.32" ry="26.74"/>
<text text-anchor="middle" x="3458" y="-1783.1" font-family="Times,serif" font-size="14.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3458" y="-1768.1" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 256&#45;287]</text>
</g>
<!-- layer8_route&#45;&gt;layer8_moe_alltoall -->
<g id="edge146" class="edge">
<title>layer8_route&#45;&gt;layer8_moe_alltoall</title>
<path fill="none" stroke="black" d="M3458,-1878.11C3458,-1857.1 3458,-1834.7 3458,-1816.65"/>
<polygon fill="black" stroke="black" points="3461.5,-1816.56 3458,-1806.56 3454.5,-1816.56 3461.5,-1816.56"/>
</g>
<!-- layer8_expert_group_0 -->
<g id="node84" class="node">
<title>layer8_expert_group_0</title>
<polygon fill="lightblue" stroke="black" points="245.5,-1680.43 68.5,-1680.43 68.5,-1597.43 245.5,-1597.43 245.5,-1680.43"/>
<text text-anchor="middle" x="157" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 0</text>
<text text-anchor="middle" x="157" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="157" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 256&#45;259]</text>
<text text-anchor="middle" x="157" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="157" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_combine -->
<g id="node116" class="node">
<title>layer8_combine</title>
<polygon fill="lightyellow" stroke="black" points="3603.04,-1525.43 3288,-1525.43 3206.96,-1389.43 3522,-1389.43 3603.04,-1525.43"/>
<text text-anchor="middle" x="3405" y="-1476.23" font-family="Times,serif" font-size="14.00">Layer 8 Expert Combine</text>
<text text-anchor="middle" x="3405" y="-1461.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 256&#45;287]</text>
<text text-anchor="middle" x="3405" y="-1446.23" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3405" y="-1431.23" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer8_expert_group_0&#45;&gt;layer8_combine -->
<g id="edge148" class="edge">
<title>layer8_expert_group_0&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M245.7,-1601.95C251.83,-1600.21 257.97,-1598.68 264,-1597.43 840.21,-1478.81 2672.93,-1461.4 3237.69,-1458.86"/>
<polygon fill="black" stroke="black" points="3237.97,-1462.36 3247.95,-1458.82 3237.94,-1455.36 3237.97,-1462.36"/>
</g>
<!-- layer8_expert_group_1 -->
<g id="node85" class="node">
<title>layer8_expert_group_1</title>
<polygon fill="lightblue" stroke="black" points="458.5,-1680.43 281.5,-1680.43 281.5,-1597.43 458.5,-1597.43 458.5,-1680.43"/>
<text text-anchor="middle" x="370" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 1</text>
<text text-anchor="middle" x="370" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="370" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 260&#45;263]</text>
<text text-anchor="middle" x="370" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="370" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_1&#45;&gt;layer8_combine -->
<g id="edge150" class="edge">
<title>layer8_expert_group_1&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M458.7,-1601.97C464.83,-1600.23 470.97,-1598.68 477,-1597.43 1010.5,-1486.71 2700.09,-1463.96 3238.48,-1459.49"/>
<polygon fill="black" stroke="black" points="3238.68,-1462.98 3248.65,-1459.4 3238.62,-1455.99 3238.68,-1462.98"/>
</g>
<!-- layer8_expert_group_2 -->
<g id="node86" class="node">
<title>layer8_expert_group_2</title>
<polygon fill="lightblue" stroke="black" points="671.5,-1680.43 494.5,-1680.43 494.5,-1597.43 671.5,-1597.43 671.5,-1680.43"/>
<text text-anchor="middle" x="583" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 2</text>
<text text-anchor="middle" x="583" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="583" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 264&#45;267]</text>
<text text-anchor="middle" x="583" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="583" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_2&#45;&gt;layer8_combine -->
<g id="edge152" class="edge">
<title>layer8_expert_group_2&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M671.71,-1602C677.84,-1600.25 683.97,-1598.7 690,-1597.43 1180.74,-1494.63 2727.01,-1466.73 3238.73,-1460.21"/>
<polygon fill="black" stroke="black" points="3238.82,-1463.71 3248.78,-1460.08 3238.74,-1456.71 3238.82,-1463.71"/>
</g>
<!-- layer8_expert_group_3 -->
<g id="node87" class="node">
<title>layer8_expert_group_3</title>
<polygon fill="lightblue" stroke="black" points="884.5,-1680.43 707.5,-1680.43 707.5,-1597.43 884.5,-1597.43 884.5,-1680.43"/>
<text text-anchor="middle" x="796" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 3</text>
<text text-anchor="middle" x="796" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="796" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 268&#45;271]</text>
<text text-anchor="middle" x="796" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="796" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_3&#45;&gt;layer8_combine -->
<g id="edge154" class="edge">
<title>layer8_expert_group_3&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M884.71,-1602.03C890.84,-1600.27 896.98,-1598.71 903,-1597.43 1351.21,-1502.52 2755.53,-1469.7 3239.29,-1461.04"/>
<polygon fill="black" stroke="black" points="3239.56,-1464.54 3249.49,-1460.86 3239.43,-1457.54 3239.56,-1464.54"/>
</g>
<!-- layer8_expert_group_4 -->
<g id="node88" class="node">
<title>layer8_expert_group_4</title>
<polygon fill="lightblue" stroke="black" points="1097.5,-1680.43 920.5,-1680.43 920.5,-1597.43 1097.5,-1597.43 1097.5,-1680.43"/>
<text text-anchor="middle" x="1009" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 4</text>
<text text-anchor="middle" x="1009" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1009" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 272&#45;275]</text>
<text text-anchor="middle" x="1009" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1009" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_4&#45;&gt;layer8_combine -->
<g id="edge156" class="edge">
<title>layer8_expert_group_4&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1097.72,-1602.06C1103.85,-1600.3 1109.98,-1598.72 1116,-1597.43 1521.77,-1510.42 2784.64,-1472.95 3239.56,-1462.03"/>
<polygon fill="black" stroke="black" points="3239.92,-1465.52 3249.83,-1461.78 3239.75,-1458.52 3239.92,-1465.52"/>
</g>
<!-- layer8_expert_group_5 -->
<g id="node89" class="node">
<title>layer8_expert_group_5</title>
<polygon fill="lightblue" stroke="black" points="1310.5,-1680.43 1133.5,-1680.43 1133.5,-1597.43 1310.5,-1597.43 1310.5,-1680.43"/>
<text text-anchor="middle" x="1222" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 5</text>
<text text-anchor="middle" x="1222" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1222" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 276&#45;279]</text>
<text text-anchor="middle" x="1222" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1222" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_5&#45;&gt;layer8_combine -->
<g id="edge158" class="edge">
<title>layer8_expert_group_5&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1310.73,-1602.11C1316.86,-1600.33 1322.98,-1598.74 1329,-1597.43 1692.68,-1518.26 2816.1,-1476.48 3240.43,-1463.2"/>
<polygon fill="black" stroke="black" points="3240.75,-1466.69 3250.63,-1462.88 3240.53,-1459.69 3240.75,-1466.69"/>
</g>
<!-- layer8_expert_group_6 -->
<g id="node90" class="node">
<title>layer8_expert_group_6</title>
<polygon fill="lightblue" stroke="black" points="1523.5,-1680.43 1346.5,-1680.43 1346.5,-1597.43 1523.5,-1597.43 1523.5,-1680.43"/>
<text text-anchor="middle" x="1435" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 6</text>
<text text-anchor="middle" x="1435" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1435" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 280&#45;283]</text>
<text text-anchor="middle" x="1435" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1435" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_6&#45;&gt;layer8_combine -->
<g id="edge160" class="edge">
<title>layer8_expert_group_6&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1523.74,-1602.16C1529.86,-1600.37 1535.99,-1598.77 1542,-1597.43 1863.79,-1526.1 2848.94,-1480.42 3241.28,-1464.62"/>
<polygon fill="black" stroke="black" points="3241.44,-1468.12 3251.29,-1464.22 3241.16,-1461.12 3241.44,-1468.12"/>
</g>
<!-- layer8_expert_group_7 -->
<g id="node91" class="node">
<title>layer8_expert_group_7</title>
<polygon fill="lightblue" stroke="black" points="1736.5,-1680.43 1559.5,-1680.43 1559.5,-1597.43 1736.5,-1597.43 1736.5,-1680.43"/>
<text text-anchor="middle" x="1648" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 7</text>
<text text-anchor="middle" x="1648" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1648" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 284&#45;287]</text>
<text text-anchor="middle" x="1648" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1648" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_7&#45;&gt;layer8_combine -->
<g id="edge162" class="edge">
<title>layer8_expert_group_7&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1736.76,-1602.23C1742.88,-1600.42 1748.99,-1598.79 1755,-1597.43 2035.12,-1533.93 2883.29,-1484.87 3242,-1466.4"/>
<polygon fill="black" stroke="black" points="3242.41,-1469.88 3252.21,-1465.88 3242.05,-1462.89 3242.41,-1469.88"/>
</g>
<!-- layer8_expert_group_8 -->
<g id="node92" class="node">
<title>layer8_expert_group_8</title>
<polygon fill="lightblue" stroke="black" points="1949.5,-1680.43 1772.5,-1680.43 1772.5,-1597.43 1949.5,-1597.43 1949.5,-1680.43"/>
<text text-anchor="middle" x="1861" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 8</text>
<text text-anchor="middle" x="1861" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1861" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 288&#45;291]</text>
<text text-anchor="middle" x="1861" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1861" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_8&#45;&gt;layer8_combine -->
<g id="edge164" class="edge">
<title>layer8_expert_group_8&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1949.78,-1602.31C1955.89,-1600.49 1962,-1598.83 1968,-1597.43 2419.41,-1492.15 2968.54,-1466.44 3238.63,-1460.28"/>
<polygon fill="black" stroke="black" points="3238.99,-1463.77 3248.91,-1460.05 3238.83,-1456.78 3238.99,-1463.77"/>
</g>
<!-- layer8_expert_group_9 -->
<g id="node93" class="node">
<title>layer8_expert_group_9</title>
<polygon fill="lightblue" stroke="black" points="2162.5,-1680.43 1985.5,-1680.43 1985.5,-1597.43 2162.5,-1597.43 2162.5,-1680.43"/>
<text text-anchor="middle" x="2074" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 9</text>
<text text-anchor="middle" x="2074" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2074" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 292&#45;295]</text>
<text text-anchor="middle" x="2074" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2074" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_9&#45;&gt;layer8_combine -->
<g id="edge166" class="edge">
<title>layer8_expert_group_9&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2162.51,-1602.52C2168.71,-1600.63 2174.92,-1598.91 2181,-1597.43 2553.44,-1507.29 3004.14,-1475.24 3241.1,-1464.12"/>
<polygon fill="black" stroke="black" points="3241.35,-1467.61 3251.17,-1463.65 3241.02,-1460.62 3241.35,-1467.61"/>
</g>
<!-- layer8_expert_group_10 -->
<g id="node94" class="node">
<title>layer8_expert_group_10</title>
<polygon fill="lightblue" stroke="black" points="2375.5,-1680.43 2198.5,-1680.43 2198.5,-1597.43 2375.5,-1597.43 2375.5,-1680.43"/>
<text text-anchor="middle" x="2287" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 10</text>
<text text-anchor="middle" x="2287" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2287" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 296&#45;299]</text>
<text text-anchor="middle" x="2287" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2287" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_10&#45;&gt;layer8_combine -->
<g id="edge168" class="edge">
<title>layer8_expert_group_10&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2375.55,-1602.68C2381.75,-1600.75 2387.94,-1598.98 2394,-1597.43 2688.64,-1522.44 3042.55,-1485.53 3243.88,-1469.34"/>
<polygon fill="black" stroke="black" points="3244.25,-1472.82 3253.94,-1468.54 3243.69,-1465.85 3244.25,-1472.82"/>
</g>
<!-- layer8_expert_group_11 -->
<g id="node95" class="node">
<title>layer8_expert_group_11</title>
<polygon fill="lightblue" stroke="black" points="2588.5,-1680.43 2411.5,-1680.43 2411.5,-1597.43 2588.5,-1597.43 2588.5,-1680.43"/>
<text text-anchor="middle" x="2500" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 11</text>
<text text-anchor="middle" x="2500" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2500" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 300&#45;303]</text>
<text text-anchor="middle" x="2500" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2500" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_11&#45;&gt;layer8_combine -->
<g id="edge170" class="edge">
<title>layer8_expert_group_11&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2588.62,-1602.93C2594.8,-1600.94 2600.97,-1599.09 2607,-1597.43 2825.72,-1537.57 3085.51,-1497.97 3247.85,-1476.86"/>
<polygon fill="black" stroke="black" points="3248.45,-1480.31 3257.92,-1475.56 3247.56,-1473.37 3248.45,-1480.31"/>
</g>
<!-- layer8_expert_group_12 -->
<g id="node96" class="node">
<title>layer8_expert_group_12</title>
<polygon fill="lightblue" stroke="black" points="2801.5,-1680.43 2624.5,-1680.43 2624.5,-1597.43 2801.5,-1597.43 2801.5,-1680.43"/>
<text text-anchor="middle" x="2713" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 12</text>
<text text-anchor="middle" x="2713" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2713" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 304&#45;307]</text>
<text text-anchor="middle" x="2713" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2713" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_12&#45;&gt;layer8_combine -->
<g id="edge172" class="edge">
<title>layer8_expert_group_12&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2801.74,-1603.35C2807.89,-1601.26 2814.02,-1599.27 2820,-1597.43 2965.85,-1552.71 3135.83,-1513.75 3254.85,-1488.55"/>
<polygon fill="black" stroke="black" points="3255.7,-1491.94 3264.76,-1486.45 3254.26,-1485.09 3255.7,-1491.94"/>
</g>
<!-- layer8_expert_group_13 -->
<g id="node97" class="node">
<title>layer8_expert_group_13</title>
<polygon fill="lightblue" stroke="black" points="3014.5,-1680.43 2837.5,-1680.43 2837.5,-1597.43 3014.5,-1597.43 3014.5,-1680.43"/>
<text text-anchor="middle" x="2926" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 13</text>
<text text-anchor="middle" x="2926" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2926" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 308&#45;311]</text>
<text text-anchor="middle" x="2926" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2926" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_13&#45;&gt;layer8_combine -->
<g id="edge174" class="edge">
<title>layer8_expert_group_13&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3014.74,-1604.31C3020.92,-1601.98 3027.05,-1599.67 3033,-1597.43 3110.2,-1568.4 3196.47,-1536.15 3266.49,-1510.03"/>
<polygon fill="black" stroke="black" points="3268.11,-1513.16 3276.26,-1506.39 3265.67,-1506.6 3268.11,-1513.16"/>
</g>
<!-- layer8_expert_group_14 -->
<g id="node98" class="node">
<title>layer8_expert_group_14</title>
<polygon fill="lightblue" stroke="black" points="3227.5,-1680.43 3050.5,-1680.43 3050.5,-1597.43 3227.5,-1597.43 3227.5,-1680.43"/>
<text text-anchor="middle" x="3139" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 14</text>
<text text-anchor="middle" x="3139" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3139" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 312&#45;315]</text>
<text text-anchor="middle" x="3139" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3139" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_14&#45;&gt;layer8_combine -->
<g id="edge176" class="edge">
<title>layer8_expert_group_14&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3199.03,-1597.43C3227.99,-1577.89 3263.63,-1553.83 3297.08,-1531.26"/>
<polygon fill="black" stroke="black" points="3299.2,-1534.05 3305.53,-1525.56 3295.28,-1528.25 3299.2,-1534.05"/>
</g>
<!-- layer8_expert_group_15 -->
<g id="node99" class="node">
<title>layer8_expert_group_15</title>
<polygon fill="lightblue" stroke="black" points="3440.5,-1680.43 3263.5,-1680.43 3263.5,-1597.43 3440.5,-1597.43 3440.5,-1680.43"/>
<text text-anchor="middle" x="3352" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 15</text>
<text text-anchor="middle" x="3352" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3352" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 316&#45;319]</text>
<text text-anchor="middle" x="3352" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3352" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_15&#45;&gt;layer8_combine -->
<g id="edge178" class="edge">
<title>layer8_expert_group_15&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3364.03,-1597.2C3369.43,-1578.9 3375.99,-1556.68 3382.26,-1535.44"/>
<polygon fill="black" stroke="black" points="3385.65,-1536.34 3385.12,-1525.76 3378.93,-1534.36 3385.65,-1536.34"/>
</g>
<!-- layer8_expert_group_16 -->
<g id="node100" class="node">
<title>layer8_expert_group_16</title>
<polygon fill="lightblue" stroke="black" points="3653.5,-1680.43 3476.5,-1680.43 3476.5,-1597.43 3653.5,-1597.43 3653.5,-1680.43"/>
<text text-anchor="middle" x="3565" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 16</text>
<text text-anchor="middle" x="3565" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3565" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 320&#45;323]</text>
<text text-anchor="middle" x="3565" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3565" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_16&#45;&gt;layer8_combine -->
<g id="edge180" class="edge">
<title>layer8_expert_group_16&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3528.69,-1597.2C3511.87,-1578.33 3491.32,-1555.28 3471.85,-1533.43"/>
<polygon fill="black" stroke="black" points="3474.28,-1530.9 3465.01,-1525.76 3469.05,-1535.55 3474.28,-1530.9"/>
</g>
<!-- layer8_expert_group_17 -->
<g id="node101" class="node">
<title>layer8_expert_group_17</title>
<polygon fill="lightblue" stroke="black" points="3866.5,-1680.43 3689.5,-1680.43 3689.5,-1597.43 3866.5,-1597.43 3866.5,-1680.43"/>
<text text-anchor="middle" x="3778" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 17</text>
<text text-anchor="middle" x="3778" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3778" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 324&#45;327]</text>
<text text-anchor="middle" x="3778" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3778" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_17&#45;&gt;layer8_combine -->
<g id="edge182" class="edge">
<title>layer8_expert_group_17&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3693.83,-1597.43C3652.45,-1577.51 3601.33,-1552.91 3553.66,-1529.97"/>
<polygon fill="black" stroke="black" points="3555.02,-1526.74 3544.49,-1525.56 3551.98,-1533.05 3555.02,-1526.74"/>
</g>
<!-- layer8_expert_group_18 -->
<g id="node102" class="node">
<title>layer8_expert_group_18</title>
<polygon fill="lightblue" stroke="black" points="4079.5,-1680.43 3902.5,-1680.43 3902.5,-1597.43 4079.5,-1597.43 4079.5,-1680.43"/>
<text text-anchor="middle" x="3991" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 18</text>
<text text-anchor="middle" x="3991" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3991" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 328&#45;331]</text>
<text text-anchor="middle" x="3991" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3991" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_18&#45;&gt;layer8_combine -->
<g id="edge184" class="edge">
<title>layer8_expert_group_18&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3902.42,-1603.47C3896.54,-1601.37 3890.7,-1599.34 3885,-1597.43 3793.13,-1566.64 3690.05,-1536.26 3603.04,-1511.79"/>
<polygon fill="black" stroke="black" points="3603.9,-1508.39 3593.33,-1509.06 3602.01,-1515.13 3603.9,-1508.39"/>
</g>
<!-- layer8_expert_group_19 -->
<g id="node103" class="node">
<title>layer8_expert_group_19</title>
<polygon fill="lightblue" stroke="black" points="4292.5,-1680.43 4115.5,-1680.43 4115.5,-1597.43 4292.5,-1597.43 4292.5,-1680.43"/>
<text text-anchor="middle" x="4204" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 19</text>
<text text-anchor="middle" x="4204" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4204" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 332&#45;335]</text>
<text text-anchor="middle" x="4204" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4204" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_19&#45;&gt;layer8_combine -->
<g id="edge186" class="edge">
<title>layer8_expert_group_19&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4115.3,-1602.81C4109.48,-1600.89 4103.68,-1599.08 4098,-1597.43 3928.2,-1548.34 3730.08,-1510.49 3589.27,-1486.77"/>
<polygon fill="black" stroke="black" points="3589.67,-1483.29 3579.23,-1485.08 3588.52,-1490.19 3589.67,-1483.29"/>
</g>
<!-- layer8_expert_group_20 -->
<g id="node104" class="node">
<title>layer8_expert_group_20</title>
<polygon fill="lightblue" stroke="black" points="4505.5,-1680.43 4328.5,-1680.43 4328.5,-1597.43 4505.5,-1597.43 4505.5,-1680.43"/>
<text text-anchor="middle" x="4417" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 20</text>
<text text-anchor="middle" x="4417" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4417" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 336&#45;339]</text>
<text text-anchor="middle" x="4417" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4417" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_20&#45;&gt;layer8_combine -->
<g id="edge188" class="edge">
<title>layer8_expert_group_20&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4328.38,-1602.51C4322.54,-1600.66 4316.71,-1598.94 4311,-1597.43 4062.31,-1531.65 3766.45,-1493.52 3582.14,-1474.35"/>
<polygon fill="black" stroke="black" points="3582.39,-1470.86 3572.08,-1473.31 3581.67,-1477.82 3582.39,-1470.86"/>
</g>
<!-- layer8_expert_group_21 -->
<g id="node105" class="node">
<title>layer8_expert_group_21</title>
<polygon fill="lightblue" stroke="black" points="4718.5,-1680.43 4541.5,-1680.43 4541.5,-1597.43 4718.5,-1597.43 4718.5,-1680.43"/>
<text text-anchor="middle" x="4630" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 21</text>
<text text-anchor="middle" x="4630" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4630" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 340&#45;343]</text>
<text text-anchor="middle" x="4630" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4630" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_21&#45;&gt;layer8_combine -->
<g id="edge190" class="edge">
<title>layer8_expert_group_21&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4541.43,-1602.31C4535.58,-1600.51 4529.73,-1598.86 4524,-1597.43 4195.45,-1515.54 3800.04,-1480.86 3578.1,-1466.97"/>
<polygon fill="black" stroke="black" points="3578.19,-1463.47 3568,-1466.35 3577.76,-1470.46 3578.19,-1463.47"/>
</g>
<!-- layer8_expert_group_22 -->
<g id="node106" class="node">
<title>layer8_expert_group_22</title>
<polygon fill="lightblue" stroke="black" points="4931.5,-1680.43 4754.5,-1680.43 4754.5,-1597.43 4931.5,-1597.43 4931.5,-1680.43"/>
<text text-anchor="middle" x="4843" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 22</text>
<text text-anchor="middle" x="4843" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4843" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 344&#45;347]</text>
<text text-anchor="middle" x="4843" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4843" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_22&#45;&gt;layer8_combine -->
<g id="edge192" class="edge">
<title>layer8_expert_group_22&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4754.47,-1602.18C4748.61,-1600.41 4742.75,-1598.81 4737,-1597.43 4327.5,-1499.62 3830.86,-1470.63 3575.25,-1462.05"/>
<polygon fill="black" stroke="black" points="3575.25,-1458.55 3565.14,-1461.71 3575.02,-1465.54 3575.25,-1458.55"/>
</g>
<!-- layer8_expert_group_23 -->
<g id="node107" class="node">
<title>layer8_expert_group_23</title>
<polygon fill="lightblue" stroke="black" points="5144.5,-1680.43 4967.5,-1680.43 4967.5,-1597.43 5144.5,-1597.43 5144.5,-1680.43"/>
<text text-anchor="middle" x="5056" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 23</text>
<text text-anchor="middle" x="5056" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5056" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 348&#45;351]</text>
<text text-anchor="middle" x="5056" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5056" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_23&#45;&gt;layer8_combine -->
<g id="edge194" class="edge">
<title>layer8_expert_group_23&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4967.49,-1602.09C4961.62,-1600.34 4955.76,-1598.77 4950,-1597.43 4458.77,-1483.79 3859.73,-1462.03 3573.28,-1458.53"/>
<polygon fill="black" stroke="black" points="3573.26,-1455.03 3563.22,-1458.42 3573.18,-1462.03 3573.26,-1455.03"/>
</g>
<!-- layer8_expert_group_24 -->
<g id="node108" class="node">
<title>layer8_expert_group_24</title>
<polygon fill="lightblue" stroke="black" points="5357.5,-1680.43 5180.5,-1680.43 5180.5,-1597.43 5357.5,-1597.43 5357.5,-1680.43"/>
<text text-anchor="middle" x="5269" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 24</text>
<text text-anchor="middle" x="5269" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5269" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 352&#45;355]</text>
<text text-anchor="middle" x="5269" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5269" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_24&#45;&gt;layer8_combine -->
<g id="edge196" class="edge">
<title>layer8_expert_group_24&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5180.21,-1601.93C5174.44,-1600.23 5168.67,-1598.71 5163,-1597.43 4864.29,-1530.03 3958.99,-1483.09 3577.47,-1465.79"/>
<polygon fill="black" stroke="black" points="3577.59,-1462.3 3567.45,-1465.34 3577.28,-1469.29 3577.59,-1462.3"/>
</g>
<!-- layer8_expert_group_25 -->
<g id="node109" class="node">
<title>layer8_expert_group_25</title>
<polygon fill="lightblue" stroke="black" points="5570.5,-1680.43 5393.5,-1680.43 5393.5,-1597.43 5570.5,-1597.43 5570.5,-1680.43"/>
<text text-anchor="middle" x="5482" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 25</text>
<text text-anchor="middle" x="5482" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5482" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 356&#45;359]</text>
<text text-anchor="middle" x="5482" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5482" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_25&#45;&gt;layer8_combine -->
<g id="edge198" class="edge">
<title>layer8_expert_group_25&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5393.22,-1601.87C5387.45,-1600.19 5381.67,-1598.69 5376,-1597.43 5035.22,-1522.06 3990.9,-1478.69 3576.78,-1464.07"/>
<polygon fill="black" stroke="black" points="3576.63,-1460.56 3566.51,-1463.7 3576.39,-1467.55 3576.63,-1460.56"/>
</g>
<!-- layer8_expert_group_26 -->
<g id="node110" class="node">
<title>layer8_expert_group_26</title>
<polygon fill="lightblue" stroke="black" points="5783.5,-1680.43 5606.5,-1680.43 5606.5,-1597.43 5783.5,-1597.43 5783.5,-1680.43"/>
<text text-anchor="middle" x="5695" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 26</text>
<text text-anchor="middle" x="5695" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5695" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 360&#45;363]</text>
<text text-anchor="middle" x="5695" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5695" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_26&#45;&gt;layer8_combine -->
<g id="edge200" class="edge">
<title>layer8_expert_group_26&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5606.23,-1601.82C5600.46,-1600.16 5594.68,-1598.67 5589,-1597.43 5205.83,-1514.06 4020.56,-1474.76 3575.87,-1462.67"/>
<polygon fill="black" stroke="black" points="3575.92,-1459.17 3565.83,-1462.4 3575.73,-1466.17 3575.92,-1459.17"/>
</g>
<!-- layer8_expert_group_27 -->
<g id="node111" class="node">
<title>layer8_expert_group_27</title>
<polygon fill="lightblue" stroke="black" points="5996.5,-1680.43 5819.5,-1680.43 5819.5,-1597.43 5996.5,-1597.43 5996.5,-1680.43"/>
<text text-anchor="middle" x="5908" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 27</text>
<text text-anchor="middle" x="5908" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5908" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 364&#45;367]</text>
<text text-anchor="middle" x="5908" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5908" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_27&#45;&gt;layer8_combine -->
<g id="edge202" class="edge">
<title>layer8_expert_group_27&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5819.24,-1601.79C5813.46,-1600.13 5807.68,-1598.65 5802,-1597.43 5376.21,-1506.04 4048.63,-1471.24 3575.01,-1461.53"/>
<polygon fill="black" stroke="black" points="3575.08,-1458.03 3565.01,-1461.33 3574.93,-1465.03 3575.08,-1458.03"/>
</g>
<!-- layer8_expert_group_28 -->
<g id="node112" class="node">
<title>layer8_expert_group_28</title>
<polygon fill="lightblue" stroke="black" points="6209.5,-1680.43 6032.5,-1680.43 6032.5,-1597.43 6209.5,-1597.43 6209.5,-1680.43"/>
<text text-anchor="middle" x="6121" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 28</text>
<text text-anchor="middle" x="6121" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6121" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 368&#45;371]</text>
<text text-anchor="middle" x="6121" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6121" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_28&#45;&gt;layer8_combine -->
<g id="edge204" class="edge">
<title>layer8_expert_group_28&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6032.25,-1601.76C6026.47,-1600.11 6020.69,-1598.64 6015,-1597.43 5546.6,-1498.05 4076.64,-1468.06 3574.84,-1460.59"/>
<polygon fill="black" stroke="black" points="3574.67,-1457.09 3564.62,-1460.44 3574.56,-1464.09 3574.67,-1457.09"/>
</g>
<!-- layer8_expert_group_29 -->
<g id="node113" class="node">
<title>layer8_expert_group_29</title>
<polygon fill="lightblue" stroke="black" points="6422.5,-1680.43 6245.5,-1680.43 6245.5,-1597.43 6422.5,-1597.43 6422.5,-1680.43"/>
<text text-anchor="middle" x="6334" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 29</text>
<text text-anchor="middle" x="6334" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6334" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 372&#45;375]</text>
<text text-anchor="middle" x="6334" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6334" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_29&#45;&gt;layer8_combine -->
<g id="edge206" class="edge">
<title>layer8_expert_group_29&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6245.25,-1601.73C6239.47,-1600.09 6233.69,-1598.63 6228,-1597.43 5716.81,-1490.04 4103.42,-1465.14 3574.64,-1459.79"/>
<polygon fill="black" stroke="black" points="3574.29,-1456.29 3564.26,-1459.69 3574.22,-1463.29 3574.29,-1456.29"/>
</g>
<!-- layer8_expert_group_30 -->
<g id="node114" class="node">
<title>layer8_expert_group_30</title>
<polygon fill="lightblue" stroke="black" points="6635.5,-1680.43 6458.5,-1680.43 6458.5,-1597.43 6635.5,-1597.43 6635.5,-1680.43"/>
<text text-anchor="middle" x="6547" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 30</text>
<text text-anchor="middle" x="6547" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6547" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 376&#45;379]</text>
<text text-anchor="middle" x="6547" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6547" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_30&#45;&gt;layer8_combine -->
<g id="edge208" class="edge">
<title>layer8_expert_group_30&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6458.26,-1601.71C6452.48,-1600.07 6446.69,-1598.62 6441,-1597.43 5886.69,-1481.98 4127.97,-1462.41 3573.88,-1459.1"/>
<polygon fill="black" stroke="black" points="3573.83,-1455.6 3563.81,-1459.05 3573.79,-1462.6 3573.83,-1455.6"/>
</g>
<!-- layer8_expert_group_31 -->
<g id="node115" class="node">
<title>layer8_expert_group_31</title>
<polygon fill="lightblue" stroke="black" points="6848.5,-1680.43 6671.5,-1680.43 6671.5,-1597.43 6848.5,-1597.43 6848.5,-1680.43"/>
<text text-anchor="middle" x="6760" y="-1665.23" font-family="Times,serif" font-size="14.00">Expert Group 31</text>
<text text-anchor="middle" x="6760" y="-1650.23" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6760" y="-1635.23" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 380&#45;383]</text>
<text text-anchor="middle" x="6760" y="-1620.23" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6760" y="-1605.23" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer8_expert_group_31&#45;&gt;layer8_combine -->
<g id="edge210" class="edge">
<title>layer8_expert_group_31&#45;&gt;layer8_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6671.26,-1601.69C6665.48,-1600.05 6659.69,-1598.61 6654,-1597.43 6056.6,-1473.93 4152.61,-1459.89 3573.63,-1458.51"/>
<polygon fill="black" stroke="black" points="3573.54,-1455.01 3563.53,-1458.49 3573.52,-1462.01 3573.54,-1455.01"/>
</g>
<!-- layer12_attn_qkv_tp -->
<g id="node119" class="node">
<title>layer12_attn_qkv_tp</title>
<polygon fill="lightblue" stroke="black" points="3498.5,-1317.43 3311.5,-1317.43 3311.5,-1249.43 3498.5,-1249.43 3498.5,-1317.43"/>
<text text-anchor="middle" x="3405" y="-1302.23" font-family="Times,serif" font-size="14.00">Layer 12 Attention QKV</text>
<text text-anchor="middle" x="3405" y="-1287.23" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 384&#45;387]</text>
<text text-anchor="middle" x="3405" y="-1272.23" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3405" y="-1257.23" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer8_combine&#45;&gt;layer12_attn_qkv_tp -->
<g id="edge211" class="edge">
<title>layer8_combine&#45;&gt;layer12_attn_qkv_tp</title>
<path fill="none" stroke="black" d="M3405,-1388.95C3405,-1368.4 3405,-1346.37 3405,-1327.85"/>
<polygon fill="black" stroke="black" points="3408.5,-1327.68 3405,-1317.68 3401.5,-1327.68 3408.5,-1327.68"/>
</g>
<!-- layer8_attn_allreduce&#45;&gt;layer8_attn_out_tp -->
<g id="edge144" class="edge">
<title>layer8_attn_allreduce&#45;&gt;layer8_attn_out_tp</title>
<path fill="none" stroke="black" d="M3458,-2225.87C3458,-2208.34 3458,-2184.84 3458,-2164.55"/>
<polygon fill="black" stroke="black" points="3461.5,-2164.28 3458,-2154.28 3454.5,-2164.28 3461.5,-2164.28"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_0 -->
<g id="edge147" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_0</title>
<path fill="none" stroke="black" d="M3333.2,-1776.92C2780.64,-1770.44 568.37,-1740.94 264,-1680.43 261.17,-1679.87 258.31,-1679.24 255.45,-1678.55"/>
<polygon fill="black" stroke="black" points="256.24,-1675.14 245.68,-1676.01 254.47,-1681.92 256.24,-1675.14"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_1 -->
<g id="edge149" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_1</title>
<path fill="none" stroke="black" d="M3333.17,-1776.62C2803.93,-1769.16 759.52,-1736.92 477,-1680.43 474.17,-1679.87 471.32,-1679.24 468.45,-1678.55"/>
<polygon fill="black" stroke="black" points="469.24,-1675.14 458.68,-1676 467.47,-1681.91 469.24,-1675.14"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_2 -->
<g id="edge151" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_2</title>
<path fill="none" stroke="black" d="M3333.25,-1776.28C2828.32,-1767.78 950.75,-1732.91 690,-1680.43 687.17,-1679.86 684.32,-1679.23 681.45,-1678.54"/>
<polygon fill="black" stroke="black" points="682.24,-1675.13 671.68,-1675.98 680.47,-1681.9 682.24,-1675.13"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_3 -->
<g id="edge153" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_3</title>
<path fill="none" stroke="black" d="M3332.58,-1778.84C2886.12,-1779.93 1375.57,-1776.26 903,-1680.43 900.17,-1679.86 897.32,-1679.22 894.45,-1678.53"/>
<polygon fill="black" stroke="black" points="895.25,-1675.12 884.69,-1675.96 893.47,-1681.89 895.25,-1675.12"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_4 -->
<g id="edge155" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_4</title>
<path fill="none" stroke="black" d="M3332.59,-1778.33C2910.73,-1777.59 1545.47,-1768.3 1116,-1680.43 1113.17,-1679.86 1110.32,-1679.21 1107.46,-1678.51"/>
<polygon fill="black" stroke="black" points="1108.26,-1675.1 1097.69,-1675.94 1106.47,-1681.87 1108.26,-1675.1"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_5 -->
<g id="edge157" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_5</title>
<path fill="none" stroke="black" d="M3332.74,-1777.71C2936.78,-1775.04 1715.58,-1760.36 1329,-1680.43 1326.17,-1679.85 1323.32,-1679.2 1320.46,-1678.5"/>
<polygon fill="black" stroke="black" points="1321.26,-1675.09 1310.7,-1675.91 1319.47,-1681.85 1321.26,-1675.09"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_6 -->
<g id="edge159" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_6</title>
<path fill="none" stroke="black" d="M3333.09,-1776.97C2964.52,-1772.24 1885.93,-1752.46 1542,-1680.43 1539.18,-1679.84 1536.33,-1679.19 1533.46,-1678.48"/>
<polygon fill="black" stroke="black" points="1534.27,-1675.07 1523.71,-1675.87 1532.46,-1681.83 1534.27,-1675.07"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_7 -->
<g id="edge161" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_7</title>
<path fill="none" stroke="black" d="M3333.53,-1776.05C2993.9,-1769.12 2056.52,-1744.58 1755,-1680.43 1752.18,-1679.83 1749.33,-1679.17 1746.47,-1678.45"/>
<polygon fill="black" stroke="black" points="1747.28,-1675.05 1736.72,-1675.83 1745.46,-1681.81 1747.28,-1675.05"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_8 -->
<g id="edge163" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_8</title>
<path fill="none" stroke="black" d="M3334.51,-1774.89C3025.95,-1765.61 2227.52,-1736.76 1968,-1680.43 1965.18,-1679.82 1962.33,-1679.15 1959.48,-1678.42"/>
<polygon fill="black" stroke="black" points="1960.3,-1675.02 1949.73,-1675.77 1958.46,-1681.77 1960.3,-1675.02"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_9 -->
<g id="edge165" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_9</title>
<path fill="none" stroke="black" d="M3335.67,-1773.38C3060.31,-1761.56 2398.85,-1728.96 2181,-1680.43 2178.18,-1679.81 2175.34,-1679.12 2172.49,-1678.38"/>
<polygon fill="black" stroke="black" points="2173.32,-1674.98 2162.74,-1675.69 2171.45,-1681.73 2173.32,-1674.98"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_10 -->
<g id="edge167" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_10</title>
<path fill="none" stroke="black" d="M3333,-1777.67C3132.39,-1774.23 2727.26,-1757.33 2394,-1680.43 2391.19,-1679.78 2388.35,-1679.08 2385.5,-1678.32"/>
<polygon fill="black" stroke="black" points="2386.34,-1674.93 2375.77,-1675.59 2384.45,-1681.67 2386.34,-1674.93"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_11 -->
<g id="edge169" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_11</title>
<path fill="none" stroke="black" d="M3335.5,-1773.71C3168.64,-1765.32 2861.53,-1742.23 2607,-1680.43 2604.15,-1679.74 2601.27,-1678.99 2598.38,-1678.2"/>
<polygon fill="black" stroke="black" points="2599.09,-1674.76 2588.51,-1675.34 2597.14,-1681.49 2599.09,-1674.76"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_12 -->
<g id="edge171" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_12</title>
<path fill="none" stroke="black" d="M3344.17,-1768.11C3215.41,-1754.92 3000.18,-1727.79 2820,-1680.43 2817.16,-1679.69 2814.3,-1678.89 2811.42,-1678.06"/>
<polygon fill="black" stroke="black" points="2812.16,-1674.63 2801.58,-1675.08 2810.13,-1681.33 2812.16,-1674.63"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_13 -->
<g id="edge173" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_13</title>
<path fill="none" stroke="black" d="M3366.28,-1760.93C3279.56,-1743.62 3146.23,-1714.73 3033,-1680.43 3030.19,-1679.58 3027.35,-1678.7 3024.5,-1677.78"/>
<polygon fill="black" stroke="black" points="3025.32,-1674.37 3014.72,-1674.56 3023.13,-1681.01 3025.32,-1674.37"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_14 -->
<g id="edge175" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_14</title>
<path fill="none" stroke="black" d="M3404.25,-1754.99C3358.67,-1735.22 3292.14,-1706.36 3237.11,-1682.49"/>
<polygon fill="black" stroke="black" points="3238.25,-1679.17 3227.68,-1678.4 3235.46,-1685.59 3238.25,-1679.17"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_15 -->
<g id="edge177" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_15</title>
<path fill="none" stroke="black" d="M3438.31,-1752.6C3424.56,-1734.65 3405.78,-1710.14 3389.25,-1688.56"/>
<polygon fill="black" stroke="black" points="3391.9,-1686.26 3383.04,-1680.45 3386.34,-1690.52 3391.9,-1686.26"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_16 -->
<g id="edge179" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_16</title>
<path fill="none" stroke="black" d="M3477.88,-1752.6C3491.76,-1734.65 3510.71,-1710.14 3527.4,-1688.56"/>
<polygon fill="black" stroke="black" points="3530.32,-1690.5 3533.67,-1680.45 3524.78,-1686.22 3530.32,-1690.5"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_17 -->
<g id="edge181" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_17</title>
<path fill="none" stroke="black" d="M3511.92,-1754.99C3557.72,-1735.18 3624.63,-1706.25 3679.89,-1682.36"/>
<polygon fill="black" stroke="black" points="3681.56,-1685.45 3689.35,-1678.26 3678.79,-1679.02 3681.56,-1685.45"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_18 -->
<g id="edge183" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_18</title>
<path fill="none" stroke="black" d="M3550.18,-1761.05C3637.33,-1743.83 3771.3,-1715 3885,-1680.43 3887.47,-1679.68 3889.97,-1678.9 3892.49,-1678.09"/>
<polygon fill="black" stroke="black" points="3893.85,-1681.33 3902.25,-1674.88 3891.65,-1674.68 3893.85,-1681.33"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_19 -->
<g id="edge185" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_19</title>
<path fill="none" stroke="black" d="M3572.21,-1768.25C3701.41,-1755.19 3917.33,-1728.18 4098,-1680.43 4100.5,-1679.77 4103.02,-1679.07 4105.56,-1678.34"/>
<polygon fill="black" stroke="black" points="4106.83,-1681.61 4115.39,-1675.36 4104.8,-1674.91 4106.83,-1681.61"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_20 -->
<g id="edge187" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_20</title>
<path fill="none" stroke="black" d="M3580.82,-1773.86C3748.1,-1765.64 4055.96,-1742.74 4311,-1680.43 4313.51,-1679.82 4316.04,-1679.16 4318.59,-1678.47"/>
<polygon fill="black" stroke="black" points="4319.82,-1681.76 4328.45,-1675.62 4317.87,-1675.03 4319.82,-1681.76"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_21 -->
<g id="edge189" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_21</title>
<path fill="none" stroke="black" d="M3583.26,-1777.82C3784.29,-1774.59 4190.23,-1757.97 4524,-1680.43 4526.52,-1679.85 4529.06,-1679.22 4531.61,-1678.55"/>
<polygon fill="black" stroke="black" points="4532.81,-1681.84 4541.49,-1675.77 4530.91,-1675.11 4532.81,-1681.84"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_22 -->
<g id="edge191" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_22</title>
<path fill="none" stroke="black" d="M3580.27,-1773.44C3855.94,-1761.76 4518.82,-1729.38 4737,-1680.43 4739.48,-1679.88 4741.98,-1679.27 4744.49,-1678.63"/>
<polygon fill="black" stroke="black" points="4745.5,-1681.98 4754.22,-1675.96 4743.65,-1675.23 4745.5,-1681.98"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_23 -->
<g id="edge193" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_23</title>
<path fill="none" stroke="black" d="M3581.67,-1774.95C3890.66,-1765.8 4690.22,-1737.23 4950,-1680.43 4952.48,-1679.89 4954.99,-1679.3 4957.5,-1678.67"/>
<polygon fill="black" stroke="black" points="4958.5,-1682.02 4967.23,-1676.03 4956.66,-1675.27 4958.5,-1682.02"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_24 -->
<g id="edge195" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_24</title>
<path fill="none" stroke="black" d="M3582.32,-1776.11C3922.12,-1769.34 4861.13,-1745.14 5163,-1680.43 5165.49,-1679.9 5167.99,-1679.32 5170.51,-1678.69"/>
<polygon fill="black" stroke="black" points="5171.49,-1682.05 5180.24,-1676.08 5169.68,-1675.29 5171.49,-1682.05"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_25 -->
<g id="edge197" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_25</title>
<path fill="none" stroke="black" d="M3582.73,-1777.03C3951.39,-1772.47 5031.72,-1753.08 5376,-1680.43 5378.49,-1679.91 5380.99,-1679.33 5383.51,-1678.71"/>
<polygon fill="black" stroke="black" points="5384.49,-1682.08 5393.25,-1676.13 5382.69,-1675.31 5384.49,-1682.08"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_26 -->
<g id="edge199" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_26</title>
<path fill="none" stroke="black" d="M3583.04,-1777.77C3979.03,-1775.27 5202.07,-1761.06 5589,-1680.43 5591.49,-1679.91 5594,-1679.35 5596.51,-1678.73"/>
<polygon fill="black" stroke="black" points="5597.48,-1682.1 5606.26,-1676.16 5595.7,-1675.33 5597.48,-1682.1"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_27 -->
<g id="edge201" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_27</title>
<path fill="none" stroke="black" d="M3583.16,-1778.38C4004.99,-1777.83 5372.18,-1769.06 5802,-1680.43 5804.49,-1679.92 5807,-1679.36 5809.52,-1678.75"/>
<polygon fill="black" stroke="black" points="5810.48,-1682.11 5819.27,-1676.19 5808.7,-1675.34 5810.48,-1682.11"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_28 -->
<g id="edge203" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_28</title>
<path fill="none" stroke="black" d="M3583.52,-1778.9C4030.38,-1780.17 5542.21,-1777.06 6015,-1680.43 6017.49,-1679.92 6020,-1679.36 6022.52,-1678.76"/>
<polygon fill="black" stroke="black" points="6023.48,-1682.12 6032.27,-1676.21 6021.71,-1675.35 6023.48,-1682.12"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_29 -->
<g id="edge205" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_29</title>
<path fill="none" stroke="black" d="M3582.42,-1776.32C4087.09,-1767.92 5967.07,-1733.36 6228,-1680.43 6230.49,-1679.93 6233,-1679.37 6235.52,-1678.77"/>
<polygon fill="black" stroke="black" points="6236.48,-1682.14 6245.27,-1676.23 6234.71,-1675.36 6236.48,-1682.14"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_30 -->
<g id="edge207" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_30</title>
<path fill="none" stroke="black" d="M3582.91,-1776.65C4112.53,-1769.29 6158.38,-1737.39 6441,-1680.43 6443.49,-1679.93 6446,-1679.38 6448.52,-1678.78"/>
<polygon fill="black" stroke="black" points="6449.48,-1682.15 6458.28,-1676.25 6447.72,-1675.37 6449.48,-1682.15"/>
</g>
<!-- layer8_moe_alltoall&#45;&gt;layer8_expert_group_31 -->
<g id="edge209" class="edge">
<title>layer8_moe_alltoall&#45;&gt;layer8_expert_group_31</title>
<path fill="none" stroke="black" d="M3582.89,-1776.94C4135.81,-1770.57 6349.53,-1741.45 6654,-1680.43 6656.49,-1679.93 6659,-1679.38 6661.52,-1678.78"/>
<polygon fill="black" stroke="black" points="6662.47,-1682.15 6671.28,-1676.26 6660.72,-1675.38 6662.47,-1682.15"/>
</g>
<!-- layer12_attn_score -->
<g id="node120" class="node">
<title>layer12_attn_score</title>
<polygon fill="lightblue" stroke="black" points="3509,-1177.43 3301,-1177.43 3301,-1109.43 3509,-1109.43 3509,-1177.43"/>
<text text-anchor="middle" x="3405" y="-1162.23" font-family="Times,serif" font-size="14.00">Layer 12 Attention Score</text>
<text text-anchor="middle" x="3405" y="-1147.23" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 384&#45;387]</text>
<text text-anchor="middle" x="3405" y="-1132.23" font-family="Times,serif" font-size="14.00">Input: [16,16,1024,64]</text>
<text text-anchor="middle" x="3405" y="-1117.23" font-family="Times,serif" font-size="14.00">Output: [16,16,1024,1024]</text>
</g>
<!-- layer12_attn_qkv_tp&#45;&gt;layer12_attn_score -->
<g id="edge212" class="edge">
<title>layer12_attn_qkv_tp&#45;&gt;layer12_attn_score</title>
<path fill="none" stroke="black" d="M3405,-1249.38C3405,-1230.91 3405,-1207.67 3405,-1187.76"/>
<polygon fill="black" stroke="black" points="3408.5,-1187.7 3405,-1177.7 3401.5,-1187.7 3408.5,-1187.7"/>
</g>
<!-- layer12_attn_allreduce -->
<g id="node156" class="node">
<title>layer12_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3405" cy="-1010.56" rx="118.17" ry="26.74"/>
<text text-anchor="middle" x="3405" y="-1014.36" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3405" y="-999.36" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 384&#45;387]</text>
</g>
<!-- layer12_attn_score&#45;&gt;layer12_attn_allreduce -->
<g id="edge213" class="edge">
<title>layer12_attn_score&#45;&gt;layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M3405,-1109.41C3405,-1090.63 3405,-1067.08 3405,-1047.79"/>
<polygon fill="black" stroke="black" points="3408.5,-1047.57 3405,-1037.57 3401.5,-1047.57 3408.5,-1047.57"/>
</g>
<!-- layer12_attn_out_tp -->
<g id="node121" class="node">
<title>layer12_attn_out_tp</title>
<polygon fill="lightblue" stroke="black" points="3508,-911.69 3302,-911.69 3302,-843.69 3508,-843.69 3508,-911.69"/>
<text text-anchor="middle" x="3405" y="-896.49" font-family="Times,serif" font-size="14.00">Layer 12 Attention Output</text>
<text text-anchor="middle" x="3405" y="-881.49" font-family="Times,serif" font-size="14.00">TP4 [GPUs: 384&#45;387]</text>
<text text-anchor="middle" x="3405" y="-866.49" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3405" y="-851.49" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer12_route -->
<g id="node122" class="node">
<title>layer12_route</title>
<polygon fill="lightyellow" stroke="black" points="3606.26,-771.69 3286.1,-771.69 3203.74,-635.69 3523.9,-635.69 3606.26,-771.69"/>
<text text-anchor="middle" x="3405" y="-722.49" font-family="Times,serif" font-size="14.00">Layer 12 Expert Routing</text>
<text text-anchor="middle" x="3405" y="-707.49" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 384&#45;415]</text>
<text text-anchor="middle" x="3405" y="-692.49" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3405" y="-677.49" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer12_attn_out_tp&#45;&gt;layer12_route -->
<g id="edge215" class="edge">
<title>layer12_attn_out_tp&#45;&gt;layer12_route</title>
<path fill="none" stroke="black" d="M3405,-843.53C3405,-826 3405,-803.69 3405,-782.11"/>
<polygon fill="black" stroke="black" points="3408.5,-781.93 3405,-771.93 3401.5,-781.93 3408.5,-781.93"/>
</g>
<!-- layer12_moe_alltoall -->
<g id="node157" class="node">
<title>layer12_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="3405" cy="-536.82" rx="125.32" ry="26.74"/>
<text text-anchor="middle" x="3405" y="-540.62" font-family="Times,serif" font-size="14.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="3405" y="-525.62" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 384&#45;415]</text>
</g>
<!-- layer12_route&#45;&gt;layer12_moe_alltoall -->
<g id="edge216" class="edge">
<title>layer12_route&#45;&gt;layer12_moe_alltoall</title>
<path fill="none" stroke="black" d="M3405,-635.63C3405,-614.62 3405,-592.22 3405,-574.17"/>
<polygon fill="black" stroke="black" points="3408.5,-574.08 3405,-564.08 3401.5,-574.08 3408.5,-574.08"/>
</g>
<!-- layer12_expert_group_0 -->
<g id="node123" class="node">
<title>layer12_expert_group_0</title>
<polygon fill="lightblue" stroke="black" points="192.5,-437.95 15.5,-437.95 15.5,-354.95 192.5,-354.95 192.5,-437.95"/>
<text text-anchor="middle" x="104" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 0</text>
<text text-anchor="middle" x="104" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="104" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 384&#45;387]</text>
<text text-anchor="middle" x="104" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="104" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_combine -->
<g id="node155" class="node">
<title>layer12_combine</title>
<polygon fill="lightyellow" stroke="black" points="3612.2,-282.95 3282.59,-282.95 3197.8,-146.95 3527.41,-146.95 3612.2,-282.95"/>
<text text-anchor="middle" x="3405" y="-233.75" font-family="Times,serif" font-size="14.00">Layer 12 Expert Combine</text>
<text text-anchor="middle" x="3405" y="-218.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 384&#45;415]</text>
<text text-anchor="middle" x="3405" y="-203.75" font-family="Times,serif" font-size="14.00">Input: [16,1024,1024]</text>
<text text-anchor="middle" x="3405" y="-188.75" font-family="Times,serif" font-size="14.00">Output: [16,1024,1024]</text>
</g>
<!-- layer12_expert_group_0&#45;&gt;layer12_combine -->
<g id="edge218" class="edge">
<title>layer12_expert_group_0&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M192.7,-359.46C198.83,-357.73 204.97,-356.19 211,-354.95 795.58,-234.83 2651.83,-218.44 3230.8,-216.26"/>
<polygon fill="black" stroke="black" points="3230.92,-219.76 3240.9,-216.23 3230.89,-212.76 3230.92,-219.76"/>
</g>
<!-- layer12_expert_group_1 -->
<g id="node124" class="node">
<title>layer12_expert_group_1</title>
<polygon fill="lightblue" stroke="black" points="405.5,-437.95 228.5,-437.95 228.5,-354.95 405.5,-354.95 405.5,-437.95"/>
<text text-anchor="middle" x="317" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 1</text>
<text text-anchor="middle" x="317" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="317" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 388&#45;391]</text>
<text text-anchor="middle" x="317" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="317" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_1&#45;&gt;layer12_combine -->
<g id="edge220" class="edge">
<title>layer12_expert_group_1&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405.7,-359.48C411.83,-357.74 417.97,-356.2 424,-354.95 965.74,-242.76 2678.21,-221.02 3231.07,-216.9"/>
<polygon fill="black" stroke="black" points="3231.15,-220.4 3241.13,-216.82 3231.1,-213.4 3231.15,-220.4"/>
</g>
<!-- layer12_expert_group_2 -->
<g id="node125" class="node">
<title>layer12_expert_group_2</title>
<polygon fill="lightblue" stroke="black" points="618.5,-437.95 441.5,-437.95 441.5,-354.95 618.5,-354.95 618.5,-437.95"/>
<text text-anchor="middle" x="530" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 2</text>
<text text-anchor="middle" x="530" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="530" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 392&#45;395]</text>
<text text-anchor="middle" x="530" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="530" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_2&#45;&gt;layer12_combine -->
<g id="edge222" class="edge">
<title>layer12_expert_group_2&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M618.71,-359.51C624.84,-357.76 630.97,-356.21 637,-354.95 1136.03,-250.67 2705.5,-223.79 3231.35,-217.62"/>
<polygon fill="black" stroke="black" points="3231.72,-221.12 3241.68,-217.5 3231.64,-214.12 3231.72,-221.12"/>
</g>
<!-- layer12_expert_group_3 -->
<g id="node126" class="node">
<title>layer12_expert_group_3</title>
<polygon fill="lightblue" stroke="black" points="831.5,-437.95 654.5,-437.95 654.5,-354.95 831.5,-354.95 831.5,-437.95"/>
<text text-anchor="middle" x="743" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 3</text>
<text text-anchor="middle" x="743" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="743" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 396&#45;399]</text>
<text text-anchor="middle" x="743" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="743" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_3&#45;&gt;layer12_combine -->
<g id="edge224" class="edge">
<title>layer12_expert_group_3&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M831.71,-359.54C837.84,-357.78 843.98,-356.23 850,-354.95 1306.5,-258.56 2734.04,-226.77 3231.75,-218.46"/>
<polygon fill="black" stroke="black" points="3231.96,-221.96 3241.9,-218.3 3231.84,-214.96 3231.96,-221.96"/>
</g>
<!-- layer12_expert_group_4 -->
<g id="node127" class="node">
<title>layer12_expert_group_4</title>
<polygon fill="lightblue" stroke="black" points="1044.5,-437.95 867.5,-437.95 867.5,-354.95 1044.5,-354.95 1044.5,-437.95"/>
<text text-anchor="middle" x="956" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 4</text>
<text text-anchor="middle" x="956" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="956" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 400&#45;403]</text>
<text text-anchor="middle" x="956" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="956" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_4&#45;&gt;layer12_combine -->
<g id="edge226" class="edge">
<title>layer12_expert_group_4&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1044.72,-359.57C1050.85,-357.81 1056.98,-356.24 1063,-354.95 1477.18,-266.43 2764,-230 3232.33,-219.45"/>
<polygon fill="black" stroke="black" points="3232.64,-222.94 3242.56,-219.22 3232.48,-215.94 3232.64,-222.94"/>
</g>
<!-- layer12_expert_group_5 -->
<g id="node128" class="node">
<title>layer12_expert_group_5</title>
<polygon fill="lightblue" stroke="black" points="1257.5,-437.95 1080.5,-437.95 1080.5,-354.95 1257.5,-354.95 1257.5,-437.95"/>
<text text-anchor="middle" x="1169" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 5</text>
<text text-anchor="middle" x="1169" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1169" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 404&#45;407]</text>
<text text-anchor="middle" x="1169" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1169" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_5&#45;&gt;layer12_combine -->
<g id="edge228" class="edge">
<title>layer12_expert_group_5&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1257.73,-359.61C1263.85,-357.84 1269.98,-356.26 1276,-354.95 1648.07,-274.28 2795.4,-233.54 3233.01,-220.62"/>
<polygon fill="black" stroke="black" points="3233.32,-224.11 3243.21,-220.32 3233.11,-217.11 3233.32,-224.11"/>
</g>
<!-- layer12_expert_group_6 -->
<g id="node129" class="node">
<title>layer12_expert_group_6</title>
<polygon fill="lightblue" stroke="black" points="1470.5,-437.95 1293.5,-437.95 1293.5,-354.95 1470.5,-354.95 1470.5,-437.95"/>
<text text-anchor="middle" x="1382" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 6</text>
<text text-anchor="middle" x="1382" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1382" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 408&#45;411]</text>
<text text-anchor="middle" x="1382" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1382" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_6&#45;&gt;layer12_combine -->
<g id="edge230" class="edge">
<title>layer12_expert_group_6&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1470.74,-359.67C1476.86,-357.88 1482.99,-356.28 1489,-354.95 1819.25,-282.1 2828.69,-237.44 3233.96,-222.03"/>
<polygon fill="black" stroke="black" points="3234.15,-225.52 3244.01,-221.65 3233.88,-218.53 3234.15,-225.52"/>
</g>
<!-- layer12_expert_group_7 -->
<g id="node130" class="node">
<title>layer12_expert_group_7</title>
<polygon fill="lightblue" stroke="black" points="1683.5,-437.95 1506.5,-437.95 1506.5,-354.95 1683.5,-354.95 1683.5,-437.95"/>
<text text-anchor="middle" x="1595" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 7</text>
<text text-anchor="middle" x="1595" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1595" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 412&#45;415]</text>
<text text-anchor="middle" x="1595" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1595" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_7&#45;&gt;layer12_combine -->
<g id="edge232" class="edge">
<title>layer12_expert_group_7&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1683.75,-359.73C1689.87,-357.93 1695.99,-356.31 1702,-354.95 1990.74,-289.89 2864.15,-241.8 3235.25,-223.76"/>
<polygon fill="black" stroke="black" points="3235.46,-227.25 3245.27,-223.27 3235.12,-220.26 3235.46,-227.25"/>
</g>
<!-- layer12_expert_group_8 -->
<g id="node131" class="node">
<title>layer12_expert_group_8</title>
<polygon fill="lightblue" stroke="black" points="1896.5,-437.95 1719.5,-437.95 1719.5,-354.95 1896.5,-354.95 1896.5,-437.95"/>
<text text-anchor="middle" x="1808" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 8</text>
<text text-anchor="middle" x="1808" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="1808" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 416&#45;419]</text>
<text text-anchor="middle" x="1808" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="1808" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_8&#45;&gt;layer12_combine -->
<g id="edge234" class="edge">
<title>layer12_expert_group_8&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1896.77,-359.81C1902.89,-357.99 1909,-356.34 1915,-354.95 2382.23,-246.82 2950.36,-222.36 3230.95,-217.12"/>
<polygon fill="black" stroke="black" points="3231.28,-220.62 3241.22,-216.94 3231.16,-213.62 3231.28,-220.62"/>
</g>
<!-- layer12_expert_group_9 -->
<g id="node132" class="node">
<title>layer12_expert_group_9</title>
<polygon fill="lightblue" stroke="black" points="2109.5,-437.95 1932.5,-437.95 1932.5,-354.95 2109.5,-354.95 2109.5,-437.95"/>
<text text-anchor="middle" x="2021" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 9</text>
<text text-anchor="middle" x="2021" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2021" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 420&#45;423]</text>
<text text-anchor="middle" x="2021" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2021" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_9&#45;&gt;layer12_combine -->
<g id="edge236" class="edge">
<title>layer12_expert_group_9&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2109.5,-360C2115.71,-358.12 2121.92,-356.41 2128,-354.95 2516.25,-261.94 2985.96,-231.04 3233.35,-220.87"/>
<polygon fill="black" stroke="black" points="3233.66,-224.36 3243.51,-220.46 3233.37,-217.37 3233.66,-224.36"/>
</g>
<!-- layer12_expert_group_10 -->
<g id="node133" class="node">
<title>layer12_expert_group_10</title>
<polygon fill="lightblue" stroke="black" points="2322.5,-437.95 2145.5,-437.95 2145.5,-354.95 2322.5,-354.95 2322.5,-437.95"/>
<text text-anchor="middle" x="2234" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 10</text>
<text text-anchor="middle" x="2234" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2234" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 424&#45;427]</text>
<text text-anchor="middle" x="2234" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2234" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_10&#45;&gt;layer12_combine -->
<g id="edge238" class="edge">
<title>layer12_expert_group_10&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2322.54,-360.16C2328.74,-358.24 2334.93,-356.48 2341,-354.95 2651.44,-277.05 3024.44,-241.1 3236.19,-225.89"/>
<polygon fill="black" stroke="black" points="3236.74,-229.36 3246.47,-225.16 3236.24,-222.38 3236.74,-229.36"/>
</g>
<!-- layer12_expert_group_11 -->
<g id="node134" class="node">
<title>layer12_expert_group_11</title>
<polygon fill="lightblue" stroke="black" points="2535.5,-437.95 2358.5,-437.95 2358.5,-354.95 2535.5,-354.95 2535.5,-437.95"/>
<text text-anchor="middle" x="2447" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 11</text>
<text text-anchor="middle" x="2447" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2447" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 428&#45;431]</text>
<text text-anchor="middle" x="2447" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2447" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_11&#45;&gt;layer12_combine -->
<g id="edge240" class="edge">
<title>layer12_expert_group_11&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2535.6,-360.38C2541.78,-358.41 2547.96,-356.57 2554,-354.95 2788.57,-292.08 3067.59,-253.07 3240.52,-232.93"/>
<polygon fill="black" stroke="black" points="3240.94,-236.41 3250.47,-231.78 3240.13,-229.46 3240.94,-236.41"/>
</g>
<!-- layer12_expert_group_12 -->
<g id="node135" class="node">
<title>layer12_expert_group_12</title>
<polygon fill="lightblue" stroke="black" points="2748.5,-437.95 2571.5,-437.95 2571.5,-354.95 2748.5,-354.95 2748.5,-437.95"/>
<text text-anchor="middle" x="2660" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 12</text>
<text text-anchor="middle" x="2660" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2660" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 432&#45;435]</text>
<text text-anchor="middle" x="2660" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2660" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_12&#45;&gt;layer12_combine -->
<g id="edge242" class="edge">
<title>layer12_expert_group_12&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2748.7,-360.74C2754.86,-358.69 2761,-356.73 2767,-354.95 2928.14,-307.19 3116.63,-268.12 3246.74,-243.71"/>
<polygon fill="black" stroke="black" points="3247.6,-247.11 3256.78,-241.83 3246.31,-240.23 3247.6,-247.11"/>
</g>
<!-- layer12_expert_group_13 -->
<g id="node136" class="node">
<title>layer12_expert_group_13</title>
<polygon fill="lightblue" stroke="black" points="2961.5,-437.95 2784.5,-437.95 2784.5,-354.95 2961.5,-354.95 2961.5,-437.95"/>
<text text-anchor="middle" x="2873" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 13</text>
<text text-anchor="middle" x="2873" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="2873" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 436&#45;439]</text>
<text text-anchor="middle" x="2873" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="2873" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_13&#45;&gt;layer12_combine -->
<g id="edge244" class="edge">
<title>layer12_expert_group_13&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2961.63,-361.55C2967.84,-359.28 2974.01,-357.07 2980,-354.95 3071.81,-322.58 3175.66,-288.57 3257.71,-262.3"/>
<polygon fill="black" stroke="black" points="3259.15,-265.51 3267.61,-259.13 3257.02,-258.84 3259.15,-265.51"/>
</g>
<!-- layer12_expert_group_14 -->
<g id="node137" class="node">
<title>layer12_expert_group_14</title>
<polygon fill="lightblue" stroke="black" points="3174.5,-437.95 2997.5,-437.95 2997.5,-354.95 3174.5,-354.95 3174.5,-437.95"/>
<text text-anchor="middle" x="3086" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 14</text>
<text text-anchor="middle" x="3086" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3086" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 440&#45;443]</text>
<text text-anchor="middle" x="3086" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3086" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_14&#45;&gt;layer12_combine -->
<g id="edge246" class="edge">
<title>layer12_expert_group_14&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3157.99,-354.95C3193.08,-335.2 3236.37,-310.84 3276.85,-288.07"/>
<polygon fill="black" stroke="black" points="3278.71,-291.03 3285.71,-283.08 3275.28,-284.93 3278.71,-291.03"/>
</g>
<!-- layer12_expert_group_15 -->
<g id="node138" class="node">
<title>layer12_expert_group_15</title>
<polygon fill="lightblue" stroke="black" points="3387.5,-437.95 3210.5,-437.95 3210.5,-354.95 3387.5,-354.95 3387.5,-437.95"/>
<text text-anchor="middle" x="3299" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 15</text>
<text text-anchor="middle" x="3299" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3299" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 444&#45;447]</text>
<text text-anchor="middle" x="3299" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3299" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_15&#45;&gt;layer12_combine -->
<g id="edge248" class="edge">
<title>layer12_expert_group_15&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3323.05,-354.72C3334.01,-336.18 3347.34,-313.6 3360.04,-292.09"/>
<polygon fill="black" stroke="black" points="3363.17,-293.67 3365.24,-283.28 3357.14,-290.11 3363.17,-293.67"/>
</g>
<!-- layer12_expert_group_16 -->
<g id="node139" class="node">
<title>layer12_expert_group_16</title>
<polygon fill="lightblue" stroke="black" points="3600.5,-437.95 3423.5,-437.95 3423.5,-354.95 3600.5,-354.95 3600.5,-437.95"/>
<text text-anchor="middle" x="3512" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 16</text>
<text text-anchor="middle" x="3512" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3512" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 448&#45;451]</text>
<text text-anchor="middle" x="3512" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3512" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_16&#45;&gt;layer12_combine -->
<g id="edge250" class="edge">
<title>layer12_expert_group_16&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3487.72,-354.72C3476.66,-336.18 3463.21,-313.6 3450.39,-292.09"/>
<polygon fill="black" stroke="black" points="3453.26,-290.08 3445.13,-283.28 3447.25,-293.66 3453.26,-290.08"/>
</g>
<!-- layer12_expert_group_17 -->
<g id="node140" class="node">
<title>layer12_expert_group_17</title>
<polygon fill="lightblue" stroke="black" points="3813.5,-437.95 3636.5,-437.95 3636.5,-354.95 3813.5,-354.95 3813.5,-437.95"/>
<text text-anchor="middle" x="3725" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 17</text>
<text text-anchor="middle" x="3725" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3725" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 452&#45;455]</text>
<text text-anchor="middle" x="3725" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3725" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_17&#45;&gt;layer12_combine -->
<g id="edge252" class="edge">
<title>layer12_expert_group_17&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3652.79,-354.95C3617.58,-335.2 3574.16,-310.84 3533.56,-288.07"/>
<polygon fill="black" stroke="black" points="3535.1,-284.92 3524.67,-283.08 3531.68,-291.02 3535.1,-284.92"/>
</g>
<!-- layer12_expert_group_18 -->
<g id="node141" class="node">
<title>layer12_expert_group_18</title>
<polygon fill="lightblue" stroke="black" points="4026.5,-437.95 3849.5,-437.95 3849.5,-354.95 4026.5,-354.95 4026.5,-437.95"/>
<text text-anchor="middle" x="3938" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 18</text>
<text text-anchor="middle" x="3938" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="3938" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 456&#45;459]</text>
<text text-anchor="middle" x="3938" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="3938" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_18&#45;&gt;layer12_combine -->
<g id="edge254" class="edge">
<title>layer12_expert_group_18&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3849.34,-361.2C3843.48,-359.06 3837.66,-356.96 3832,-354.95 3763.55,-330.75 3688.41,-305.77 3620.48,-283.77"/>
<polygon fill="black" stroke="black" points="3621.54,-280.43 3610.95,-280.69 3619.39,-287.09 3621.54,-280.43"/>
</g>
<!-- layer12_expert_group_19 -->
<g id="node142" class="node">
<title>layer12_expert_group_19</title>
<polygon fill="lightblue" stroke="black" points="4239.5,-437.95 4062.5,-437.95 4062.5,-354.95 4239.5,-354.95 4239.5,-437.95"/>
<text text-anchor="middle" x="4151" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 19</text>
<text text-anchor="middle" x="4151" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4151" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 460&#45;463]</text>
<text text-anchor="middle" x="4151" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4151" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_19&#45;&gt;layer12_combine -->
<g id="edge256" class="edge">
<title>layer12_expert_group_19&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4062.27,-360.44C4056.46,-358.49 4050.66,-356.64 4045,-354.95 3898.17,-311.23 3728.61,-275.03 3600.92,-250.54"/>
<polygon fill="black" stroke="black" points="3601.5,-247.09 3591.03,-248.65 3600.19,-253.96 3601.5,-247.09"/>
</g>
<!-- layer12_expert_group_20 -->
<g id="node143" class="node">
<title>layer12_expert_group_20</title>
<polygon fill="lightblue" stroke="black" points="4452.5,-437.95 4275.5,-437.95 4275.5,-354.95 4452.5,-354.95 4452.5,-437.95"/>
<text text-anchor="middle" x="4364" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 20</text>
<text text-anchor="middle" x="4364" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4364" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 464&#45;467]</text>
<text text-anchor="middle" x="4364" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4364" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_20&#45;&gt;layer12_combine -->
<g id="edge258" class="edge">
<title>layer12_expert_group_20&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4275.37,-360.09C4269.53,-358.22 4263.71,-356.49 4258,-354.95 4032.75,-294.25 3766.46,-256.01 3592.07,-235.34"/>
<polygon fill="black" stroke="black" points="3592.36,-231.85 3582.02,-234.15 3591.54,-238.8 3592.36,-231.85"/>
</g>
<!-- layer12_expert_group_21 -->
<g id="node144" class="node">
<title>layer12_expert_group_21</title>
<polygon fill="lightblue" stroke="black" points="4665.5,-437.95 4488.5,-437.95 4488.5,-354.95 4665.5,-354.95 4665.5,-437.95"/>
<text text-anchor="middle" x="4577" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 21</text>
<text text-anchor="middle" x="4577" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4577" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 468&#45;471]</text>
<text text-anchor="middle" x="4577" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4577" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_21&#45;&gt;layer12_combine -->
<g id="edge260" class="edge">
<title>layer12_expert_group_21&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4488.42,-359.87C4482.57,-358.06 4476.73,-356.4 4471,-354.95 4166.17,-277.99 3800.95,-242.13 3586.8,-226.6"/>
<polygon fill="black" stroke="black" points="3586.94,-223.1 3576.71,-225.88 3586.44,-230.08 3586.94,-223.1"/>
</g>
<!-- layer12_expert_group_22 -->
<g id="node145" class="node">
<title>layer12_expert_group_22</title>
<polygon fill="lightblue" stroke="black" points="4878.5,-437.95 4701.5,-437.95 4701.5,-354.95 4878.5,-354.95 4878.5,-437.95"/>
<text text-anchor="middle" x="4790" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 22</text>
<text text-anchor="middle" x="4790" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="4790" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 472&#45;475]</text>
<text text-anchor="middle" x="4790" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="4790" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_22&#45;&gt;layer12_combine -->
<g id="edge262" class="edge">
<title>layer12_expert_group_22&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4701.46,-359.73C4695.6,-357.96 4689.75,-356.34 4684,-354.95 4298.77,-262.07 3833.2,-231.17 3583.67,-220.95"/>
<polygon fill="black" stroke="black" points="3583.55,-217.44 3573.42,-220.53 3583.27,-224.43 3583.55,-217.44"/>
</g>
<!-- layer12_expert_group_23 -->
<g id="node146" class="node">
<title>layer12_expert_group_23</title>
<polygon fill="lightblue" stroke="black" points="5091.5,-437.95 4914.5,-437.95 4914.5,-354.95 5091.5,-354.95 5091.5,-437.95"/>
<text text-anchor="middle" x="5003" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 23</text>
<text text-anchor="middle" x="5003" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5003" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 476&#45;479]</text>
<text text-anchor="middle" x="5003" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5003" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_23&#45;&gt;layer12_combine -->
<g id="edge264" class="edge">
<title>layer12_expert_group_23&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4914.48,-359.63C4908.62,-357.88 4902.76,-356.29 4897,-354.95 4430.4,-246.23 3863,-222 3581.3,-216.96"/>
<polygon fill="black" stroke="black" points="3581.05,-213.46 3570.99,-216.78 3580.93,-220.46 3581.05,-213.46"/>
</g>
<!-- layer12_expert_group_24 -->
<g id="node147" class="node">
<title>layer12_expert_group_24</title>
<polygon fill="lightblue" stroke="black" points="5304.5,-437.95 5127.5,-437.95 5127.5,-354.95 5304.5,-354.95 5304.5,-437.95"/>
<text text-anchor="middle" x="5216" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 24</text>
<text text-anchor="middle" x="5216" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5216" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 480&#45;483]</text>
<text text-anchor="middle" x="5216" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5216" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_24&#45;&gt;layer12_combine -->
<g id="edge266" class="edge">
<title>layer12_expert_group_24&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5127.21,-359.46C5121.44,-357.77 5115.67,-356.24 5110,-354.95 4823.71,-289.98 3962.77,-242.46 3585.47,-224.19"/>
<polygon fill="black" stroke="black" points="3585.43,-220.68 3575.28,-223.7 3585.09,-227.67 3585.43,-220.68"/>
</g>
<!-- layer12_expert_group_25 -->
<g id="node148" class="node">
<title>layer12_expert_group_25</title>
<polygon fill="lightblue" stroke="black" points="5517.5,-437.95 5340.5,-437.95 5340.5,-354.95 5517.5,-354.95 5517.5,-437.95"/>
<text text-anchor="middle" x="5429" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 25</text>
<text text-anchor="middle" x="5429" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5429" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 484&#45;487]</text>
<text text-anchor="middle" x="5429" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5429" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_25&#45;&gt;layer12_combine -->
<g id="edge268" class="edge">
<title>layer12_expert_group_25&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5340.22,-359.4C5334.45,-357.72 5328.67,-356.21 5323,-354.95 4994.74,-282.01 3995.52,-237.8 3584.5,-222.26"/>
<polygon fill="black" stroke="black" points="3584.43,-218.76 3574.3,-221.88 3584.17,-225.75 3584.43,-218.76"/>
</g>
<!-- layer12_expert_group_26 -->
<g id="node149" class="node">
<title>layer12_expert_group_26</title>
<polygon fill="lightblue" stroke="black" points="5730.5,-437.95 5553.5,-437.95 5553.5,-354.95 5730.5,-354.95 5730.5,-437.95"/>
<text text-anchor="middle" x="5642" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 26</text>
<text text-anchor="middle" x="5642" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5642" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 488&#45;491]</text>
<text text-anchor="middle" x="5642" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5642" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_26&#45;&gt;layer12_combine -->
<g id="edge270" class="edge">
<title>layer12_expert_group_26&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5553.23,-359.36C5547.45,-357.69 5541.68,-356.19 5536,-354.95 5165.41,-274.01 4025.73,-233.66 3583.24,-220.72"/>
<polygon fill="black" stroke="black" points="3583.33,-217.22 3573.24,-220.43 3583.13,-224.22 3583.33,-217.22"/>
</g>
<!-- layer12_expert_group_27 -->
<g id="node150" class="node">
<title>layer12_expert_group_27</title>
<polygon fill="lightblue" stroke="black" points="5943.5,-437.95 5766.5,-437.95 5766.5,-354.95 5943.5,-354.95 5943.5,-437.95"/>
<text text-anchor="middle" x="5855" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 27</text>
<text text-anchor="middle" x="5855" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="5855" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 492&#45;495]</text>
<text text-anchor="middle" x="5855" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="5855" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_27&#45;&gt;layer12_combine -->
<g id="edge272" class="edge">
<title>layer12_expert_group_27&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5766.24,-359.32C5760.46,-357.66 5754.68,-356.18 5749,-354.95 5336.09,-266.04 4055.81,-229.99 3582.9,-219.49"/>
<polygon fill="black" stroke="black" points="3582.64,-215.98 3572.57,-219.26 3582.49,-222.98 3582.64,-215.98"/>
</g>
<!-- layer12_expert_group_28 -->
<g id="node151" class="node">
<title>layer12_expert_group_28</title>
<polygon fill="lightblue" stroke="black" points="6156.5,-437.95 5979.5,-437.95 5979.5,-354.95 6156.5,-354.95 6156.5,-437.95"/>
<text text-anchor="middle" x="6068" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 28</text>
<text text-anchor="middle" x="6068" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6068" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 496&#45;499]</text>
<text text-anchor="middle" x="6068" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6068" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_28&#45;&gt;layer12_combine -->
<g id="edge274" class="edge">
<title>layer12_expert_group_28&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5979.25,-359.28C5973.47,-357.63 5967.68,-356.16 5962,-354.95 5506.51,-258.04 4084.13,-226.66 3582.39,-218.45"/>
<polygon fill="black" stroke="black" points="3582.22,-214.95 3572.16,-218.29 3582.1,-221.95 3582.22,-214.95"/>
</g>
<!-- layer12_expert_group_29 -->
<g id="node152" class="node">
<title>layer12_expert_group_29</title>
<polygon fill="lightblue" stroke="black" points="6369.5,-437.95 6192.5,-437.95 6192.5,-354.95 6369.5,-354.95 6369.5,-437.95"/>
<text text-anchor="middle" x="6281" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 29</text>
<text text-anchor="middle" x="6281" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6281" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 500&#45;503]</text>
<text text-anchor="middle" x="6281" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6281" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_29&#45;&gt;layer12_combine -->
<g id="edge276" class="edge">
<title>layer12_expert_group_29&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6192.25,-359.26C6186.47,-357.61 6180.69,-356.15 6175,-354.95 5676.68,-250.02 4110.73,-223.59 3581.65,-217.58"/>
<polygon fill="black" stroke="black" points="3581.68,-214.08 3571.64,-217.47 3581.6,-221.08 3581.68,-214.08"/>
</g>
<!-- layer12_expert_group_30 -->
<g id="node153" class="node">
<title>layer12_expert_group_30</title>
<polygon fill="lightblue" stroke="black" points="6582.5,-437.95 6405.5,-437.95 6405.5,-354.95 6582.5,-354.95 6582.5,-437.95"/>
<text text-anchor="middle" x="6494" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 30</text>
<text text-anchor="middle" x="6494" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6494" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 504&#45;507]</text>
<text text-anchor="middle" x="6494" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6494" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_30&#45;&gt;layer12_combine -->
<g id="edge278" class="edge">
<title>layer12_expert_group_30&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6405.26,-359.23C6399.47,-357.59 6393.69,-356.14 6388,-354.95 5846.86,-242.01 4137.31,-220.78 3581.48,-216.84"/>
<polygon fill="black" stroke="black" points="3581.39,-213.34 3571.37,-216.77 3581.35,-220.34 3581.39,-213.34"/>
</g>
<!-- layer12_expert_group_31 -->
<g id="node154" class="node">
<title>layer12_expert_group_31</title>
<polygon fill="lightblue" stroke="black" points="6795.5,-437.95 6618.5,-437.95 6618.5,-354.95 6795.5,-354.95 6795.5,-437.95"/>
<text text-anchor="middle" x="6707" y="-422.75" font-family="Times,serif" font-size="14.00">Expert Group 31</text>
<text text-anchor="middle" x="6707" y="-407.75" font-family="Times,serif" font-size="14.00">(2 experts)</text>
<text text-anchor="middle" x="6707" y="-392.75" font-family="Times,serif" font-size="14.00">EP32 [GPUs: 508&#45;511]</text>
<text text-anchor="middle" x="6707" y="-377.75" font-family="Times,serif" font-size="14.00">Input: [1,1024,1024]</text>
<text text-anchor="middle" x="6707" y="-362.75" font-family="Times,serif" font-size="14.00">Output: [1,1024,1024]</text>
</g>
<!-- layer12_expert_group_31&#45;&gt;layer12_combine -->
<g id="edge280" class="edge">
<title>layer12_expert_group_31&#45;&gt;layer12_combine</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6618.26,-359.21C6612.48,-357.58 6606.69,-356.13 6601,-354.95 6016.75,-233.96 4161.92,-218.15 3580.83,-216.19"/>
<polygon fill="black" stroke="black" points="3580.7,-212.69 3570.69,-216.16 3580.68,-219.69 3580.7,-212.69"/>
</g>
<!-- output -->
<g id="node158" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="3405" cy="-37.48" rx="251.96" ry="37.45"/>
<text text-anchor="middle" x="3405" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3405" y="-33.78" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="3405" y="-18.78" font-family="Times,serif" font-size="14.00">DP8: Aggregated from 8 groups</text>
</g>
<!-- layer12_combine&#45;&gt;output -->
<g id="edge281" class="edge">
<title>layer12_combine&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3405,-146.86C3405,-126.29 3405,-104.11 3405,-85.21"/>
<polygon fill="black" stroke="black" points="3408.5,-85.08 3405,-75.08 3401.5,-85.08 3408.5,-85.08"/>
</g>
<!-- layer12_attn_allreduce&#45;&gt;layer12_attn_out_tp -->
<g id="edge214" class="edge">
<title>layer12_attn_allreduce&#45;&gt;layer12_attn_out_tp</title>
<path fill="none" stroke="black" d="M3405,-983.39C3405,-965.86 3405,-942.36 3405,-922.07"/>
<polygon fill="black" stroke="black" points="3408.5,-921.8 3405,-911.8 3401.5,-921.8 3408.5,-921.8"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_0 -->
<g id="edge217" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_0</title>
<path fill="none" stroke="black" d="M3280.2,-534.44C2727.64,-527.96 515.37,-498.46 211,-437.95 208.17,-437.39 205.31,-436.76 202.45,-436.07"/>
<polygon fill="black" stroke="black" points="203.24,-432.66 192.68,-433.53 201.47,-439.44 203.24,-432.66"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_1 -->
<g id="edge219" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_1</title>
<path fill="none" stroke="black" d="M3280.17,-534.14C2750.93,-526.68 706.52,-494.44 424,-437.95 421.17,-437.39 418.32,-436.76 415.45,-436.07"/>
<polygon fill="black" stroke="black" points="416.24,-432.66 405.68,-433.52 414.47,-439.43 416.24,-432.66"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_2 -->
<g id="edge221" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_2</title>
<path fill="none" stroke="black" d="M3280.25,-533.8C2775.32,-525.3 897.75,-490.43 637,-437.95 634.17,-437.38 631.32,-436.75 628.45,-436.06"/>
<polygon fill="black" stroke="black" points="629.24,-432.65 618.68,-433.5 627.47,-439.42 629.24,-432.65"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_3 -->
<g id="edge223" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_3</title>
<path fill="none" stroke="black" d="M3279.58,-536.36C2833.12,-537.45 1322.57,-533.78 850,-437.95 847.17,-437.38 844.32,-436.74 841.45,-436.05"/>
<polygon fill="black" stroke="black" points="842.25,-432.64 831.69,-433.48 840.47,-439.41 842.25,-432.64"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_4 -->
<g id="edge225" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_4</title>
<path fill="none" stroke="black" d="M3279.59,-535.85C2857.73,-535.11 1492.47,-525.82 1063,-437.95 1060.17,-437.37 1057.32,-436.73 1054.46,-436.03"/>
<polygon fill="black" stroke="black" points="1055.26,-432.62 1044.69,-433.46 1053.47,-439.39 1055.26,-432.62"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_5 -->
<g id="edge227" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_5</title>
<path fill="none" stroke="black" d="M3279.74,-535.23C2883.78,-532.56 1662.58,-517.88 1276,-437.95 1273.17,-437.37 1270.32,-436.72 1267.46,-436.02"/>
<polygon fill="black" stroke="black" points="1268.26,-432.61 1257.7,-433.43 1266.47,-439.37 1268.26,-432.61"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_6 -->
<g id="edge229" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_6</title>
<path fill="none" stroke="black" d="M3280.09,-534.49C2911.52,-529.76 1832.93,-509.98 1489,-437.95 1486.18,-437.36 1483.33,-436.71 1480.46,-436"/>
<polygon fill="black" stroke="black" points="1481.27,-432.59 1470.71,-433.39 1479.46,-439.35 1481.27,-432.59"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_7 -->
<g id="edge231" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_7</title>
<path fill="none" stroke="black" d="M3280.53,-533.57C2940.9,-526.64 2003.52,-502.1 1702,-437.95 1699.18,-437.35 1696.33,-436.69 1693.47,-435.97"/>
<polygon fill="black" stroke="black" points="1694.28,-432.57 1683.72,-433.35 1692.46,-439.33 1694.28,-432.57"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_8 -->
<g id="edge233" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_8</title>
<path fill="none" stroke="black" d="M3281.51,-532.41C2972.95,-523.13 2174.52,-494.28 1915,-437.95 1912.18,-437.34 1909.33,-436.67 1906.48,-435.94"/>
<polygon fill="black" stroke="black" points="1907.3,-432.54 1896.73,-433.29 1905.46,-439.29 1907.3,-432.54"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_9 -->
<g id="edge235" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_9</title>
<path fill="none" stroke="black" d="M3282.67,-530.9C3007.31,-519.08 2345.85,-486.48 2128,-437.95 2125.18,-437.33 2122.34,-436.64 2119.49,-435.9"/>
<polygon fill="black" stroke="black" points="2120.32,-432.5 2109.74,-433.21 2118.45,-439.25 2120.32,-432.5"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_10 -->
<g id="edge237" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_10</title>
<path fill="none" stroke="black" d="M3280,-535.19C3079.39,-531.75 2674.26,-514.85 2341,-437.95 2338.19,-437.3 2335.35,-436.6 2332.5,-435.84"/>
<polygon fill="black" stroke="black" points="2333.34,-432.45 2322.77,-433.11 2331.45,-439.18 2333.34,-432.45"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_11 -->
<g id="edge239" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_11</title>
<path fill="none" stroke="black" d="M3282.5,-531.23C3115.64,-522.84 2808.53,-499.75 2554,-437.95 2551.15,-437.26 2548.27,-436.51 2545.38,-435.72"/>
<polygon fill="black" stroke="black" points="2546.09,-432.28 2535.51,-432.86 2544.14,-439.01 2546.09,-432.28"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_12 -->
<g id="edge241" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_12</title>
<path fill="none" stroke="black" d="M3291.17,-525.63C3162.41,-512.44 2947.18,-485.31 2767,-437.95 2764.16,-437.21 2761.3,-436.41 2758.42,-435.58"/>
<polygon fill="black" stroke="black" points="2759.16,-432.15 2748.58,-432.6 2757.13,-438.85 2759.16,-432.15"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_13 -->
<g id="edge243" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_13</title>
<path fill="none" stroke="black" d="M3313.28,-518.45C3226.56,-501.14 3093.23,-472.25 2980,-437.95 2977.19,-437.1 2974.35,-436.22 2971.5,-435.3"/>
<polygon fill="black" stroke="black" points="2972.32,-431.89 2961.72,-432.08 2970.13,-438.53 2972.32,-431.89"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_14 -->
<g id="edge245" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_14</title>
<path fill="none" stroke="black" d="M3351.25,-512.51C3305.67,-492.74 3239.14,-463.88 3184.11,-440.01"/>
<polygon fill="black" stroke="black" points="3185.25,-436.69 3174.68,-435.92 3182.46,-443.11 3185.25,-436.69"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_15 -->
<g id="edge247" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_15</title>
<path fill="none" stroke="black" d="M3385.31,-510.12C3371.56,-492.17 3352.78,-467.66 3336.25,-446.08"/>
<polygon fill="black" stroke="black" points="3338.9,-443.78 3330.04,-437.97 3333.34,-448.04 3338.9,-443.78"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_16 -->
<g id="edge249" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_16</title>
<path fill="none" stroke="black" d="M3424.88,-510.12C3438.76,-492.17 3457.71,-467.66 3474.4,-446.08"/>
<polygon fill="black" stroke="black" points="3477.32,-448.02 3480.67,-437.97 3471.78,-443.74 3477.32,-448.02"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_17 -->
<g id="edge251" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_17</title>
<path fill="none" stroke="black" d="M3458.92,-512.51C3504.72,-492.7 3571.63,-463.77 3626.89,-439.88"/>
<polygon fill="black" stroke="black" points="3628.56,-442.97 3636.35,-435.78 3625.79,-436.54 3628.56,-442.97"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_18 -->
<g id="edge253" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_18</title>
<path fill="none" stroke="black" d="M3497.18,-518.57C3584.33,-501.35 3718.3,-472.52 3832,-437.95 3834.47,-437.2 3836.97,-436.42 3839.49,-435.61"/>
<polygon fill="black" stroke="black" points="3840.85,-438.85 3849.25,-432.4 3838.65,-432.2 3840.85,-438.85"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_19 -->
<g id="edge255" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_19</title>
<path fill="none" stroke="black" d="M3519.21,-525.77C3648.41,-512.7 3864.33,-485.7 4045,-437.95 4047.5,-437.29 4050.02,-436.59 4052.56,-435.86"/>
<polygon fill="black" stroke="black" points="4053.83,-439.13 4062.39,-432.88 4051.8,-432.43 4053.83,-439.13"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_20 -->
<g id="edge257" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_20</title>
<path fill="none" stroke="black" d="M3527.82,-531.38C3695.1,-523.16 4002.96,-500.26 4258,-437.95 4260.51,-437.34 4263.04,-436.68 4265.59,-435.99"/>
<polygon fill="black" stroke="black" points="4266.82,-439.28 4275.45,-433.14 4264.87,-432.55 4266.82,-439.28"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_21 -->
<g id="edge259" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_21</title>
<path fill="none" stroke="black" d="M3530.26,-535.34C3731.29,-532.11 4137.23,-515.49 4471,-437.95 4473.52,-437.37 4476.06,-436.74 4478.61,-436.06"/>
<polygon fill="black" stroke="black" points="4479.81,-439.36 4488.49,-433.29 4477.91,-432.63 4479.81,-439.36"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_22 -->
<g id="edge261" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_22</title>
<path fill="none" stroke="black" d="M3527.27,-530.96C3802.94,-519.28 4465.82,-486.9 4684,-437.95 4686.48,-437.4 4688.98,-436.79 4691.49,-436.15"/>
<polygon fill="black" stroke="black" points="4692.5,-439.5 4701.22,-433.48 4690.65,-432.75 4692.5,-439.5"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_23 -->
<g id="edge263" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_23</title>
<path fill="none" stroke="black" d="M3528.67,-532.47C3837.66,-523.32 4637.22,-494.74 4897,-437.95 4899.48,-437.41 4901.99,-436.82 4904.5,-436.19"/>
<polygon fill="black" stroke="black" points="4905.5,-439.54 4914.23,-433.55 4903.66,-432.79 4905.5,-439.54"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_24 -->
<g id="edge265" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_24</title>
<path fill="none" stroke="black" d="M3529.32,-533.63C3869.12,-526.86 4808.13,-502.66 5110,-437.95 5112.49,-437.42 5114.99,-436.84 5117.51,-436.21"/>
<polygon fill="black" stroke="black" points="5118.49,-439.57 5127.24,-433.6 5116.68,-432.81 5118.49,-439.57"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_25 -->
<g id="edge267" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_25</title>
<path fill="none" stroke="black" d="M3529.73,-534.55C3898.39,-529.99 4978.72,-510.6 5323,-437.95 5325.49,-437.43 5327.99,-436.85 5330.51,-436.23"/>
<polygon fill="black" stroke="black" points="5331.49,-439.6 5340.25,-433.65 5329.69,-432.83 5331.49,-439.6"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_26 -->
<g id="edge269" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_26</title>
<path fill="none" stroke="black" d="M3530.04,-535.29C3926.03,-532.79 5149.07,-518.58 5536,-437.95 5538.49,-437.43 5541,-436.87 5543.51,-436.25"/>
<polygon fill="black" stroke="black" points="5544.48,-439.62 5553.26,-433.68 5542.7,-432.85 5544.48,-439.62"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_27 -->
<g id="edge271" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_27</title>
<path fill="none" stroke="black" d="M3530.16,-535.9C3951.99,-535.35 5319.18,-526.58 5749,-437.95 5751.49,-437.44 5754,-436.88 5756.52,-436.27"/>
<polygon fill="black" stroke="black" points="5757.48,-439.63 5766.27,-433.71 5755.7,-432.86 5757.48,-439.63"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_28 -->
<g id="edge273" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_28</title>
<path fill="none" stroke="black" d="M3530.52,-536.42C3977.38,-537.69 5489.21,-534.58 5962,-437.95 5964.49,-437.44 5967,-436.88 5969.52,-436.28"/>
<polygon fill="black" stroke="black" points="5970.48,-439.64 5979.27,-433.73 5968.71,-432.87 5970.48,-439.64"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_29 -->
<g id="edge275" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_29</title>
<path fill="none" stroke="black" d="M3529.42,-533.84C4034.09,-525.44 5914.07,-490.88 6175,-437.95 6177.49,-437.45 6180,-436.89 6182.52,-436.29"/>
<polygon fill="black" stroke="black" points="6183.48,-439.66 6192.27,-433.75 6181.71,-432.88 6183.48,-439.66"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_30 -->
<g id="edge277" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_30</title>
<path fill="none" stroke="black" d="M3529.91,-534.17C4059.53,-526.81 6105.38,-494.91 6388,-437.95 6390.49,-437.45 6393,-436.9 6395.52,-436.3"/>
<polygon fill="black" stroke="black" points="6396.48,-439.66 6405.28,-433.77 6394.72,-432.89 6396.48,-439.66"/>
</g>
<!-- layer12_moe_alltoall&#45;&gt;layer12_expert_group_31 -->
<g id="edge279" class="edge">
<title>layer12_moe_alltoall&#45;&gt;layer12_expert_group_31</title>
<path fill="none" stroke="black" d="M3529.89,-534.46C4082.81,-528.09 6296.53,-498.97 6601,-437.95 6603.49,-437.45 6606,-436.9 6608.52,-436.3"/>
<polygon fill="black" stroke="black" points="6609.47,-439.67 6618.28,-433.78 6607.72,-432.9 6609.47,-439.67"/>
</g>
</g>
</svg>
