<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layer_wise Pages: 1 -->
<svg width="960pt" height="34729pt"
 viewBox="0.00 0.00 959.74 34729.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 34725.33)">
<title>proposed_layer_wise</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-34725.33 955.74,-34725.33 955.74,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer0_gpu0</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M168.87,-32455C168.87,-32455 658.87,-32455 658.87,-32455 664.87,-32455 670.87,-32461 670.87,-32467 670.87,-32467 670.87,-34577.33 670.87,-34577.33 670.87,-34583.33 664.87,-34589.33 658.87,-34589.33 658.87,-34589.33 168.87,-34589.33 168.87,-34589.33 162.87,-34589.33 156.87,-34583.33 156.87,-34577.33 156.87,-34577.33 156.87,-32467 156.87,-32467 156.87,-32461 162.87,-32455 168.87,-32455"/>
<text text-anchor="middle" x="413.87" y="-34574.13" font-family="Times,serif" font-size="14.00">Layer 0 on GPU 0</text>
<text text-anchor="middle" x="413.87" y="-34559.13" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1_gpu1</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-30302.66C159.87,-30302.66 649.87,-30302.66 649.87,-30302.66 655.87,-30302.66 661.87,-30308.66 661.87,-30314.66 661.87,-30314.66 661.87,-32425 661.87,-32425 661.87,-32431 655.87,-32437 649.87,-32437 649.87,-32437 159.87,-32437 159.87,-32437 153.87,-32437 147.87,-32431 147.87,-32425 147.87,-32425 147.87,-30314.66 147.87,-30314.66 147.87,-30308.66 153.87,-30302.66 159.87,-30302.66"/>
<text text-anchor="middle" x="404.87" y="-32421.8" font-family="Times,serif" font-size="14.00">Layer 1 on GPU 1</text>
<text text-anchor="middle" x="404.87" y="-32406.8" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer2_gpu2</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-28150.33C159.87,-28150.33 649.87,-28150.33 649.87,-28150.33 655.87,-28150.33 661.87,-28156.33 661.87,-28162.33 661.87,-28162.33 661.87,-30272.66 661.87,-30272.66 661.87,-30278.66 655.87,-30284.66 649.87,-30284.66 649.87,-30284.66 159.87,-30284.66 159.87,-30284.66 153.87,-30284.66 147.87,-30278.66 147.87,-30272.66 147.87,-30272.66 147.87,-28162.33 147.87,-28162.33 147.87,-28156.33 153.87,-28150.33 159.87,-28150.33"/>
<text text-anchor="middle" x="404.87" y="-30269.46" font-family="Times,serif" font-size="14.00">Layer 2 on GPU 2</text>
<text text-anchor="middle" x="404.87" y="-30254.46" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer3_gpu3</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-25998C159.87,-25998 649.87,-25998 649.87,-25998 655.87,-25998 661.87,-26004 661.87,-26010 661.87,-26010 661.87,-28120.33 661.87,-28120.33 661.87,-28126.33 655.87,-28132.33 649.87,-28132.33 649.87,-28132.33 159.87,-28132.33 159.87,-28132.33 153.87,-28132.33 147.87,-28126.33 147.87,-28120.33 147.87,-28120.33 147.87,-26010 147.87,-26010 147.87,-26004 153.87,-25998 159.87,-25998"/>
<text text-anchor="middle" x="404.87" y="-28117.13" font-family="Times,serif" font-size="14.00">Layer 3 on GPU 3</text>
<text text-anchor="middle" x="404.87" y="-28102.13" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer4_gpu4</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-23845.66C159.87,-23845.66 649.87,-23845.66 649.87,-23845.66 655.87,-23845.66 661.87,-23851.66 661.87,-23857.66 661.87,-23857.66 661.87,-25968 661.87,-25968 661.87,-25974 655.87,-25980 649.87,-25980 649.87,-25980 159.87,-25980 159.87,-25980 153.87,-25980 147.87,-25974 147.87,-25968 147.87,-25968 147.87,-23857.66 147.87,-23857.66 147.87,-23851.66 153.87,-23845.66 159.87,-23845.66"/>
<text text-anchor="middle" x="404.87" y="-25964.8" font-family="Times,serif" font-size="14.00">Layer 4 on GPU 4</text>
<text text-anchor="middle" x="404.87" y="-25949.8" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer5_gpu5</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-21693.33C159.87,-21693.33 649.87,-21693.33 649.87,-21693.33 655.87,-21693.33 661.87,-21699.33 661.87,-21705.33 661.87,-21705.33 661.87,-23815.66 661.87,-23815.66 661.87,-23821.66 655.87,-23827.66 649.87,-23827.66 649.87,-23827.66 159.87,-23827.66 159.87,-23827.66 153.87,-23827.66 147.87,-23821.66 147.87,-23815.66 147.87,-23815.66 147.87,-21705.33 147.87,-21705.33 147.87,-21699.33 153.87,-21693.33 159.87,-21693.33"/>
<text text-anchor="middle" x="404.87" y="-23812.46" font-family="Times,serif" font-size="14.00">Layer 5 on GPU 5</text>
<text text-anchor="middle" x="404.87" y="-23797.46" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer6_gpu6</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M168.87,-19541C168.87,-19541 658.87,-19541 658.87,-19541 664.87,-19541 670.87,-19547 670.87,-19553 670.87,-19553 670.87,-21663.33 670.87,-21663.33 670.87,-21669.33 664.87,-21675.33 658.87,-21675.33 658.87,-21675.33 168.87,-21675.33 168.87,-21675.33 162.87,-21675.33 156.87,-21669.33 156.87,-21663.33 156.87,-21663.33 156.87,-19553 156.87,-19553 156.87,-19547 162.87,-19541 168.87,-19541"/>
<text text-anchor="middle" x="413.87" y="-21660.13" font-family="Times,serif" font-size="14.00">Layer 6 on GPU 6</text>
<text text-anchor="middle" x="413.87" y="-21645.13" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer7_gpu7</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-17388.66C159.87,-17388.66 649.87,-17388.66 649.87,-17388.66 655.87,-17388.66 661.87,-17394.66 661.87,-17400.66 661.87,-17400.66 661.87,-19511 661.87,-19511 661.87,-19517 655.87,-19523 649.87,-19523 649.87,-19523 159.87,-19523 159.87,-19523 153.87,-19523 147.87,-19517 147.87,-19511 147.87,-19511 147.87,-17400.66 147.87,-17400.66 147.87,-17394.66 153.87,-17388.66 159.87,-17388.66"/>
<text text-anchor="middle" x="404.87" y="-19507.8" font-family="Times,serif" font-size="14.00">Layer 7 on GPU 7</text>
<text text-anchor="middle" x="404.87" y="-19492.8" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer8_gpu8</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M181.87,-15236.33C181.87,-15236.33 671.87,-15236.33 671.87,-15236.33 677.87,-15236.33 683.87,-15242.33 683.87,-15248.33 683.87,-15248.33 683.87,-17358.66 683.87,-17358.66 683.87,-17364.66 677.87,-17370.66 671.87,-17370.66 671.87,-17370.66 181.87,-17370.66 181.87,-17370.66 175.87,-17370.66 169.87,-17364.66 169.87,-17358.66 169.87,-17358.66 169.87,-15248.33 169.87,-15248.33 169.87,-15242.33 175.87,-15236.33 181.87,-15236.33"/>
<text text-anchor="middle" x="426.87" y="-17355.46" font-family="Times,serif" font-size="14.00">Layer 8 on GPU 8</text>
<text text-anchor="middle" x="426.87" y="-17340.46" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer9_gpu9</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-13084C159.87,-13084 649.87,-13084 649.87,-13084 655.87,-13084 661.87,-13090 661.87,-13096 661.87,-13096 661.87,-15206.33 661.87,-15206.33 661.87,-15212.33 655.87,-15218.33 649.87,-15218.33 649.87,-15218.33 159.87,-15218.33 159.87,-15218.33 153.87,-15218.33 147.87,-15212.33 147.87,-15206.33 147.87,-15206.33 147.87,-13096 147.87,-13096 147.87,-13090 153.87,-13084 159.87,-13084"/>
<text text-anchor="middle" x="404.87" y="-15203.13" font-family="Times,serif" font-size="14.00">Layer 9 on GPU 9</text>
<text text-anchor="middle" x="404.87" y="-15188.13" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer10_gpu10</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M159.87,-10931.67C159.87,-10931.67 649.87,-10931.67 649.87,-10931.67 655.87,-10931.67 661.87,-10937.67 661.87,-10943.67 661.87,-10943.67 661.87,-13054 661.87,-13054 661.87,-13060 655.87,-13066 649.87,-13066 649.87,-13066 159.87,-13066 159.87,-13066 153.87,-13066 147.87,-13060 147.87,-13054 147.87,-13054 147.87,-10943.67 147.87,-10943.67 147.87,-10937.67 153.87,-10931.67 159.87,-10931.67"/>
<text text-anchor="middle" x="404.87" y="-13050.8" font-family="Times,serif" font-size="14.00">Layer 10 on GPU 10</text>
<text text-anchor="middle" x="404.87" y="-13035.8" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer11_gpu11</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M178.87,-8779.33C178.87,-8779.33 668.87,-8779.33 668.87,-8779.33 674.87,-8779.33 680.87,-8785.33 680.87,-8791.33 680.87,-8791.33 680.87,-10901.67 680.87,-10901.67 680.87,-10907.67 674.87,-10913.67 668.87,-10913.67 668.87,-10913.67 178.87,-10913.67 178.87,-10913.67 172.87,-10913.67 166.87,-10907.67 166.87,-10901.67 166.87,-10901.67 166.87,-8791.33 166.87,-8791.33 166.87,-8785.33 172.87,-8779.33 178.87,-8779.33"/>
<text text-anchor="middle" x="423.87" y="-10898.47" font-family="Times,serif" font-size="14.00">Layer 11 on GPU 11</text>
<text text-anchor="middle" x="423.87" y="-10883.47" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer12_gpu12</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M176.87,-6627C176.87,-6627 666.87,-6627 666.87,-6627 672.87,-6627 678.87,-6633 678.87,-6639 678.87,-6639 678.87,-8749.33 678.87,-8749.33 678.87,-8755.33 672.87,-8761.33 666.87,-8761.33 666.87,-8761.33 176.87,-8761.33 176.87,-8761.33 170.87,-8761.33 164.87,-8755.33 164.87,-8749.33 164.87,-8749.33 164.87,-6639 164.87,-6639 164.87,-6633 170.87,-6627 176.87,-6627"/>
<text text-anchor="middle" x="421.87" y="-8746.13" font-family="Times,serif" font-size="14.00">Layer 12 on GPU 12</text>
<text text-anchor="middle" x="421.87" y="-8731.13" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer13_gpu13</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M184.87,-4474.67C184.87,-4474.67 674.87,-4474.67 674.87,-4474.67 680.87,-4474.67 686.87,-4480.67 686.87,-4486.67 686.87,-4486.67 686.87,-6597 686.87,-6597 686.87,-6603 680.87,-6609 674.87,-6609 674.87,-6609 184.87,-6609 184.87,-6609 178.87,-6609 172.87,-6603 172.87,-6597 172.87,-6597 172.87,-4486.67 172.87,-4486.67 172.87,-4480.67 178.87,-4474.67 184.87,-4474.67"/>
<text text-anchor="middle" x="429.87" y="-6593.8" font-family="Times,serif" font-size="14.00">Layer 13 on GPU 13</text>
<text text-anchor="middle" x="429.87" y="-6578.8" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer14_gpu14</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M192.87,-2322.33C192.87,-2322.33 682.87,-2322.33 682.87,-2322.33 688.87,-2322.33 694.87,-2328.33 694.87,-2334.33 694.87,-2334.33 694.87,-4444.67 694.87,-4444.67 694.87,-4450.67 688.87,-4456.67 682.87,-4456.67 682.87,-4456.67 192.87,-4456.67 192.87,-4456.67 186.87,-4456.67 180.87,-4450.67 180.87,-4444.67 180.87,-4444.67 180.87,-2334.33 180.87,-2334.33 180.87,-2328.33 186.87,-2322.33 192.87,-2322.33"/>
<text text-anchor="middle" x="437.87" y="-4441.47" font-family="Times,serif" font-size="14.00">Layer 14 on GPU 14</text>
<text text-anchor="middle" x="437.87" y="-4426.47" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer15_gpu15</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M173.87,-170C173.87,-170 663.87,-170 663.87,-170 669.87,-170 675.87,-176 675.87,-182 675.87,-182 675.87,-2292.33 675.87,-2292.33 675.87,-2298.33 669.87,-2304.33 663.87,-2304.33 663.87,-2304.33 173.87,-2304.33 173.87,-2304.33 167.87,-2304.33 161.87,-2298.33 161.87,-2292.33 161.87,-2292.33 161.87,-182 161.87,-182 161.87,-176 167.87,-170 173.87,-170"/>
<text text-anchor="middle" x="418.87" y="-2289.13" font-family="Times,serif" font-size="14.00">Layer 15 on GPU 15</text>
<text text-anchor="middle" x="418.87" y="-2274.13" font-family="Times,serif" font-size="14.00">Cache&#45;capacity: 11.8GB</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="951.61,-34721.33 194.81,-34721.33 0.13,-34615.33 756.93,-34615.33 951.61,-34721.33"/>
<text text-anchor="middle" x="475.87" y="-34679.63" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="475.87" y="-34664.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="475.87" y="-34649.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- layer0_input -->
<g id="node2" class="node">
<title>layer0_input</title>
<polygon fill="lightyellow" stroke="black" points="600.19,-34543.33 402.42,-34543.33 351.55,-34407.33 549.32,-34407.33 600.19,-34543.33"/>
<text text-anchor="middle" x="475.87" y="-34494.13" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="475.87" y="-34479.13" font-family="Times,serif" font-size="14.00">From: Input</text>
<text text-anchor="middle" x="475.87" y="-34464.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="475.87" y="-34449.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_input -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_input</title>
<path fill="none" stroke="black" d="M475.87,-34615.08C475.87,-34615.08 475.87,-34553.62 475.87,-34553.62"/>
<polygon fill="black" stroke="black" points="479.37,-34553.62 475.87,-34543.62 472.37,-34553.62 479.37,-34553.62"/>
</g>
<!-- lay0_qkv_proj -->
<g id="node3" class="node">
<title>lay0_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="530.37,-34335.33 313.37,-34335.33 313.37,-34267.33 530.37,-34267.33 530.37,-34335.33"/>
<text text-anchor="middle" x="421.87" y="-34320.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="421.87" y="-34305.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-34290.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="421.87" y="-34275.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_input&#45;&gt;lay0_qkv_proj -->
<g id="edge2" class="edge">
<title>layer0_input&#45;&gt;lay0_qkv_proj</title>
<path fill="none" stroke="black" d="M440.91,-34407.06C440.91,-34407.06 440.91,-34345.44 440.91,-34345.44"/>
<polygon fill="black" stroke="black" points="444.41,-34345.44 440.91,-34335.44 437.41,-34345.44 444.41,-34345.44"/>
</g>
<!-- lay0_res1 -->
<g id="node7" class="node">
<title>lay0_res1</title>
<ellipse fill="lightgray" stroke="black" cx="430.87" cy="-33727.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="430.87" y="-33746.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="430.87" y="-33731.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-33716.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-33701.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_input&#45;&gt;lay0_res1 -->
<g id="edge7" class="edge">
<title>layer0_input&#45;&gt;lay0_res1</title>
<path fill="none" stroke="black" d="M582.32,-34475.19C582.32,-34475.19 582.32,-33773.79 582.32,-33773.79"/>
<polygon fill="black" stroke="black" points="585.82,-33773.79 582.32,-33763.79 578.82,-33773.79 585.82,-33773.79"/>
</g>
<!-- lay0_attn_score -->
<g id="node4" class="node">
<title>lay0_attn_score</title>
<polygon fill="lightpink" stroke="black" points="564.37,-34195.33 209.37,-34195.33 209.37,-34127.33 564.37,-34127.33 564.37,-34195.33"/>
<text text-anchor="middle" x="386.87" y="-34180.13" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="386.87" y="-34165.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-34150.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-34135.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_qkv_proj&#45;&gt;lay0_attn_score -->
<g id="edge3" class="edge">
<title>lay0_qkv_proj&#45;&gt;lay0_attn_score</title>
<path fill="none" stroke="black" d="M421.87,-34267.08C421.87,-34267.08 421.87,-34205.71 421.87,-34205.71"/>
<polygon fill="black" stroke="black" points="425.37,-34205.71 421.87,-34195.71 418.37,-34205.71 425.37,-34205.71"/>
</g>
<!-- lay0_attn_concat -->
<g id="node5" class="node">
<title>lay0_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="506.37,-34055.33 301.37,-34055.33 301.37,-33987.33 506.37,-33987.33 506.37,-34055.33"/>
<text text-anchor="middle" x="403.87" y="-34040.13" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="403.87" y="-34025.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="403.87" y="-34010.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="403.87" y="-33995.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_attn_score&#45;&gt;lay0_attn_concat -->
<g id="edge4" class="edge">
<title>lay0_attn_score&#45;&gt;lay0_attn_concat</title>
<path fill="none" stroke="black" d="M403.87,-34127.08C403.87,-34127.08 403.87,-34065.71 403.87,-34065.71"/>
<polygon fill="black" stroke="black" points="407.37,-34065.71 403.87,-34055.71 400.37,-34065.71 407.37,-34065.71"/>
</g>
<!-- lay0_attn_out -->
<g id="node6" class="node">
<title>lay0_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="529.37,-33915.33 314.37,-33915.33 314.37,-33847.33 529.37,-33847.33 529.37,-33915.33"/>
<text text-anchor="middle" x="421.87" y="-33900.13" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="421.87" y="-33885.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-33870.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-33855.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_attn_concat&#45;&gt;lay0_attn_out -->
<g id="edge5" class="edge">
<title>lay0_attn_concat&#45;&gt;lay0_attn_out</title>
<path fill="none" stroke="black" d="M410.37,-33987.08C410.37,-33987.08 410.37,-33925.71 410.37,-33925.71"/>
<polygon fill="black" stroke="black" points="413.87,-33925.71 410.37,-33915.71 406.87,-33925.71 413.87,-33925.71"/>
</g>
<!-- lay0_attn_out&#45;&gt;lay0_res1 -->
<g id="edge6" class="edge">
<title>lay0_attn_out&#45;&gt;lay0_res1</title>
<path fill="none" stroke="black" d="M421.87,-33847.13C421.87,-33847.13 421.87,-33785.37 421.87,-33785.37"/>
<polygon fill="black" stroke="black" points="425.37,-33785.37 421.87,-33775.37 418.37,-33785.37 425.37,-33785.37"/>
</g>
<!-- lay0_ln1 -->
<g id="node8" class="node">
<title>lay0_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="563.37,-33607.16 360.37,-33607.16 360.37,-33539.16 563.37,-33539.16 563.37,-33607.16"/>
<text text-anchor="middle" x="461.87" y="-33591.96" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="461.87" y="-33576.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="461.87" y="-33561.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="461.87" y="-33546.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_res1&#45;&gt;lay0_ln1 -->
<g id="edge8" class="edge">
<title>lay0_res1&#45;&gt;lay0_ln1</title>
<path fill="none" stroke="black" d="M461.87,-33679.34C461.87,-33679.34 461.87,-33617.35 461.87,-33617.35"/>
<polygon fill="black" stroke="black" points="465.37,-33617.35 461.87,-33607.35 458.37,-33617.35 465.37,-33617.35"/>
</g>
<!-- lay0_mlp_gate -->
<g id="node9" class="node">
<title>lay0_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="403.87,-33467.16 191.87,-33467.16 191.87,-33399.16 403.87,-33399.16 403.87,-33467.16"/>
<text text-anchor="middle" x="297.87" y="-33451.96" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="297.87" y="-33436.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="297.87" y="-33421.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="297.87" y="-33406.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_ln1&#45;&gt;lay0_mlp_gate -->
<g id="edge9" class="edge">
<title>lay0_ln1&#45;&gt;lay0_mlp_gate</title>
<path fill="none" stroke="black" d="M382.12,-33538.91C382.12,-33538.91 382.12,-33477.54 382.12,-33477.54"/>
<polygon fill="black" stroke="black" points="385.62,-33477.54 382.12,-33467.54 378.62,-33477.54 385.62,-33477.54"/>
</g>
<!-- lay0_mlp_up -->
<g id="node10" class="node">
<title>lay0_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="624.87,-33327.16 412.87,-33327.16 412.87,-33259.16 624.87,-33259.16 624.87,-33327.16"/>
<text text-anchor="middle" x="518.87" y="-33311.96" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="518.87" y="-33296.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="518.87" y="-33281.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="518.87" y="-33266.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_ln1&#45;&gt;lay0_mlp_up -->
<g id="edge10" class="edge">
<title>lay0_ln1&#45;&gt;lay0_mlp_up</title>
<path fill="none" stroke="black" d="M488.12,-33539.11C488.12,-33539.11 488.12,-33337.42 488.12,-33337.42"/>
<polygon fill="black" stroke="black" points="491.62,-33337.42 488.12,-33327.42 484.62,-33337.42 491.62,-33337.42"/>
</g>
<!-- lay0_res2 -->
<g id="node14" class="node">
<title>lay0_res2</title>
<ellipse fill="lightgray" stroke="black" cx="430.87" cy="-32859.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="430.87" y="-32877.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="430.87" y="-32862.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-32847.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-32832.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_ln1&#45;&gt;lay0_res2 -->
<g id="edge16" class="edge">
<title>lay0_ln1&#45;&gt;lay0_res2</title>
<path fill="none" stroke="black" d="M563.49,-33573C605.17,-33573 643.84,-33573 643.84,-33573 643.84,-33573 643.84,-32888.17 643.84,-32888.17"/>
<polygon fill="black" stroke="black" points="647.34,-32888.17 643.84,-32878.17 640.34,-32888.17 647.34,-32888.17"/>
</g>
<!-- lay0_mlp_act -->
<g id="node11" class="node">
<title>lay0_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="376.87,-33327.16 164.87,-33327.16 164.87,-33259.16 376.87,-33259.16 376.87,-33327.16"/>
<text text-anchor="middle" x="270.87" y="-33311.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="270.87" y="-33296.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="270.87" y="-33281.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="270.87" y="-33266.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_mlp_gate&#45;&gt;lay0_mlp_act -->
<g id="edge11" class="edge">
<title>lay0_mlp_gate&#45;&gt;lay0_mlp_act</title>
<path fill="none" stroke="black" d="M284.37,-33398.91C284.37,-33398.91 284.37,-33337.54 284.37,-33337.54"/>
<polygon fill="black" stroke="black" points="287.87,-33337.54 284.37,-33327.54 280.87,-33337.54 287.87,-33337.54"/>
</g>
<!-- lay0_mlp_mul -->
<g id="node12" class="node">
<title>lay0_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="603.87,-33187.16 257.87,-33187.16 257.87,-33119.16 603.87,-33119.16 603.87,-33187.16"/>
<text text-anchor="middle" x="430.87" y="-33171.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="430.87" y="-33156.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="430.87" y="-33141.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="430.87" y="-33126.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_mlp_up&#45;&gt;lay0_mlp_mul -->
<g id="edge12" class="edge">
<title>lay0_mlp_up&#45;&gt;lay0_mlp_mul</title>
<path fill="none" stroke="black" d="M508.37,-33258.91C508.37,-33258.91 508.37,-33197.54 508.37,-33197.54"/>
<polygon fill="black" stroke="black" points="511.87,-33197.54 508.37,-33187.54 504.87,-33197.54 511.87,-33197.54"/>
</g>
<!-- lay0_mlp_act&#45;&gt;lay0_mlp_mul -->
<g id="edge13" class="edge">
<title>lay0_mlp_act&#45;&gt;lay0_mlp_mul</title>
<path fill="none" stroke="black" d="M317.37,-33258.91C317.37,-33258.91 317.37,-33197.54 317.37,-33197.54"/>
<polygon fill="black" stroke="black" points="320.87,-33197.54 317.37,-33187.54 313.87,-33197.54 320.87,-33197.54"/>
</g>
<!-- lay0_mlp_down -->
<g id="node13" class="node">
<title>lay0_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="532.37,-33047.16 329.37,-33047.16 329.37,-32979.16 532.37,-32979.16 532.37,-33047.16"/>
<text text-anchor="middle" x="430.87" y="-33031.96" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="430.87" y="-33016.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="430.87" y="-33001.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-32986.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_mlp_mul&#45;&gt;lay0_mlp_down -->
<g id="edge14" class="edge">
<title>lay0_mlp_mul&#45;&gt;lay0_mlp_down</title>
<path fill="none" stroke="black" d="M430.87,-33118.91C430.87,-33118.91 430.87,-33057.54 430.87,-33057.54"/>
<polygon fill="black" stroke="black" points="434.37,-33057.54 430.87,-33047.54 427.37,-33057.54 434.37,-33057.54"/>
</g>
<!-- lay0_mlp_down&#45;&gt;lay0_res2 -->
<g id="edge15" class="edge">
<title>lay0_mlp_down&#45;&gt;lay0_res2</title>
<path fill="none" stroke="black" d="M430.87,-32978.97C430.87,-32978.97 430.87,-32917.2 430.87,-32917.2"/>
<polygon fill="black" stroke="black" points="434.37,-32917.2 430.87,-32907.2 427.37,-32917.2 434.37,-32917.2"/>
</g>
<!-- lay0_ln2 -->
<g id="node15" class="node">
<title>lay0_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="532.37,-32739 329.37,-32739 329.37,-32671 532.37,-32671 532.37,-32739"/>
<text text-anchor="middle" x="430.87" y="-32723.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="430.87" y="-32708.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-32693.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-32678.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_res2&#45;&gt;lay0_ln2 -->
<g id="edge17" class="edge">
<title>lay0_res2&#45;&gt;lay0_ln2</title>
<path fill="none" stroke="black" d="M430.87,-32810.75C430.87,-32810.75 430.87,-32749.47 430.87,-32749.47"/>
<polygon fill="black" stroke="black" points="434.37,-32749.47 430.87,-32739.47 427.37,-32749.47 434.37,-32749.47"/>
</g>
<!-- layer0_output -->
<g id="node16" class="node">
<title>layer0_output</title>
<polygon fill="lightyellow" stroke="black" points="567.57,-32599 350.11,-32599 294.17,-32463 511.63,-32463 567.57,-32599"/>
<text text-anchor="middle" x="430.87" y="-32549.8" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="430.87" y="-32534.8" font-family="Times,serif" font-size="14.00">To: GPU 1</text>
<text text-anchor="middle" x="430.87" y="-32519.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="430.87" y="-32504.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- lay0_ln2&#45;&gt;layer0_output -->
<g id="edge18" class="edge">
<title>lay0_ln2&#45;&gt;layer0_output</title>
<path fill="none" stroke="black" d="M430.87,-32670.62C430.87,-32670.62 430.87,-32609.14 430.87,-32609.14"/>
<polygon fill="black" stroke="black" points="434.37,-32609.14 430.87,-32599.14 427.37,-32609.14 434.37,-32609.14"/>
</g>
<!-- layer1_input -->
<g id="node17" class="node">
<title>layer1_input</title>
<polygon fill="lightyellow" stroke="black" points="555.19,-32391 357.42,-32391 306.55,-32255 504.32,-32255 555.19,-32391"/>
<text text-anchor="middle" x="430.87" y="-32341.8" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="430.87" y="-32326.8" font-family="Times,serif" font-size="14.00">From: GPU 0</text>
<text text-anchor="middle" x="430.87" y="-32311.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="430.87" y="-32296.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_output&#45;&gt;layer1_input -->
<g id="edge19" class="edge">
<title>layer0_output&#45;&gt;layer1_input</title>
<path fill="none" stroke="black" d="M430.87,-32462.89C430.87,-32462.89 430.87,-32401.26 430.87,-32401.26"/>
<polygon fill="black" stroke="black" points="434.37,-32401.26 430.87,-32391.26 427.37,-32401.26 434.37,-32401.26"/>
</g>
<!-- lay1_qkv_proj -->
<g id="node18" class="node">
<title>lay1_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="508.37,-32183 291.37,-32183 291.37,-32115 508.37,-32115 508.37,-32183"/>
<text text-anchor="middle" x="399.87" y="-32167.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="399.87" y="-32152.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="399.87" y="-32137.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="399.87" y="-32122.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_input&#45;&gt;lay1_qkv_proj -->
<g id="edge20" class="edge">
<title>layer1_input&#45;&gt;lay1_qkv_proj</title>
<path fill="none" stroke="black" d="M407.41,-32254.73C407.41,-32254.73 407.41,-32193.1 407.41,-32193.1"/>
<polygon fill="black" stroke="black" points="410.91,-32193.1 407.41,-32183.1 403.91,-32193.1 410.91,-32193.1"/>
</g>
<!-- lay1_res1 -->
<g id="node22" class="node">
<title>lay1_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-31574.91" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-31593.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-31578.71" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-31563.71" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-31548.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_input&#45;&gt;lay1_res1 -->
<g id="edge25" class="edge">
<title>layer1_input&#45;&gt;lay1_res1</title>
<path fill="none" stroke="black" d="M548.82,-32322.86C548.82,-32322.86 548.82,-31625.33 548.82,-31625.33"/>
<polygon fill="black" stroke="black" points="552.32,-31625.33 548.82,-31615.33 545.32,-31625.33 552.32,-31625.33"/>
</g>
<!-- lay1_attn_score -->
<g id="node19" class="node">
<title>lay1_attn_score</title>
<polygon fill="lightpink" stroke="black" points="542.37,-32043 187.37,-32043 187.37,-31975 542.37,-31975 542.37,-32043"/>
<text text-anchor="middle" x="364.87" y="-32027.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="364.87" y="-32012.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-31997.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-31982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_qkv_proj&#45;&gt;lay1_attn_score -->
<g id="edge21" class="edge">
<title>lay1_qkv_proj&#45;&gt;lay1_attn_score</title>
<path fill="none" stroke="black" d="M399.87,-32114.75C399.87,-32114.75 399.87,-32053.38 399.87,-32053.38"/>
<polygon fill="black" stroke="black" points="403.37,-32053.38 399.87,-32043.38 396.37,-32053.38 403.37,-32053.38"/>
</g>
<!-- lay1_attn_concat -->
<g id="node20" class="node">
<title>lay1_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="491.37,-31903 286.37,-31903 286.37,-31835 491.37,-31835 491.37,-31903"/>
<text text-anchor="middle" x="388.87" y="-31887.8" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="388.87" y="-31872.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="388.87" y="-31857.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="388.87" y="-31842.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_attn_score&#45;&gt;lay1_attn_concat -->
<g id="edge22" class="edge">
<title>lay1_attn_score&#45;&gt;lay1_attn_concat</title>
<path fill="none" stroke="black" d="M388.87,-31974.75C388.87,-31974.75 388.87,-31913.38 388.87,-31913.38"/>
<polygon fill="black" stroke="black" points="392.37,-31913.38 388.87,-31903.38 385.37,-31913.38 392.37,-31913.38"/>
</g>
<!-- lay1_attn_out -->
<g id="node21" class="node">
<title>lay1_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="520.37,-31763 305.37,-31763 305.37,-31695 520.37,-31695 520.37,-31763"/>
<text text-anchor="middle" x="412.87" y="-31747.8" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="412.87" y="-31732.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-31717.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-31702.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_attn_concat&#45;&gt;lay1_attn_out -->
<g id="edge23" class="edge">
<title>lay1_attn_concat&#45;&gt;lay1_attn_out</title>
<path fill="none" stroke="black" d="M398.37,-31834.75C398.37,-31834.75 398.37,-31773.38 398.37,-31773.38"/>
<polygon fill="black" stroke="black" points="401.87,-31773.38 398.37,-31763.38 394.87,-31773.38 401.87,-31773.38"/>
</g>
<!-- lay1_attn_out&#45;&gt;lay1_res1 -->
<g id="edge24" class="edge">
<title>lay1_attn_out&#45;&gt;lay1_res1</title>
<path fill="none" stroke="black" d="M412.87,-31694.8C412.87,-31694.8 412.87,-31633.04 412.87,-31633.04"/>
<polygon fill="black" stroke="black" points="416.37,-31633.04 412.87,-31623.04 409.37,-31633.04 416.37,-31633.04"/>
</g>
<!-- lay1_ln1 -->
<g id="node23" class="node">
<title>lay1_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-31454.83 351.37,-31454.83 351.37,-31386.83 554.37,-31386.83 554.37,-31454.83"/>
<text text-anchor="middle" x="452.87" y="-31439.63" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-31424.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-31409.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-31394.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_res1&#45;&gt;lay1_ln1 -->
<g id="edge26" class="edge">
<title>lay1_res1&#45;&gt;lay1_ln1</title>
<path fill="none" stroke="black" d="M452.87,-31527C452.87,-31527 452.87,-31465.01 452.87,-31465.01"/>
<polygon fill="black" stroke="black" points="456.37,-31465.01 452.87,-31455.01 449.37,-31465.01 456.37,-31465.01"/>
</g>
<!-- lay1_mlp_gate -->
<g id="node24" class="node">
<title>lay1_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-31314.83 182.87,-31314.83 182.87,-31246.83 394.87,-31246.83 394.87,-31314.83"/>
<text text-anchor="middle" x="288.87" y="-31299.63" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-31284.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-31269.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-31254.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_ln1&#45;&gt;lay1_mlp_gate -->
<g id="edge27" class="edge">
<title>lay1_ln1&#45;&gt;lay1_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-31386.58C373.12,-31386.58 373.12,-31325.21 373.12,-31325.21"/>
<polygon fill="black" stroke="black" points="376.62,-31325.21 373.12,-31315.21 369.62,-31325.21 376.62,-31325.21"/>
</g>
<!-- lay1_mlp_up -->
<g id="node25" class="node">
<title>lay1_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-31174.83 403.87,-31174.83 403.87,-31106.83 615.87,-31106.83 615.87,-31174.83"/>
<text text-anchor="middle" x="509.87" y="-31159.63" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-31144.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-31129.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-31114.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_ln1&#45;&gt;lay1_mlp_up -->
<g id="edge28" class="edge">
<title>lay1_ln1&#45;&gt;lay1_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-31386.78C479.12,-31386.78 479.12,-31185.08 479.12,-31185.08"/>
<polygon fill="black" stroke="black" points="482.62,-31185.08 479.12,-31175.08 475.62,-31185.08 482.62,-31185.08"/>
</g>
<!-- lay1_res2 -->
<g id="node29" class="node">
<title>lay1_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-30706.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-30725.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-30710.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-30695.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-30680.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_ln1&#45;&gt;lay1_res2 -->
<g id="edge34" class="edge">
<title>lay1_ln1&#45;&gt;lay1_res2</title>
<path fill="none" stroke="black" d="M554.49,-31420C596.17,-31420 634.84,-31420 634.84,-31420 634.84,-31420 634.84,-30735.82 634.84,-30735.82"/>
<polygon fill="black" stroke="black" points="638.34,-30735.82 634.84,-30725.82 631.34,-30735.82 638.34,-30735.82"/>
</g>
<!-- lay1_mlp_act -->
<g id="node26" class="node">
<title>lay1_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-31174.83 155.87,-31174.83 155.87,-31106.83 367.87,-31106.83 367.87,-31174.83"/>
<text text-anchor="middle" x="261.87" y="-31159.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-31144.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-31129.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-31114.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_mlp_gate&#45;&gt;lay1_mlp_act -->
<g id="edge29" class="edge">
<title>lay1_mlp_gate&#45;&gt;lay1_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-31246.58C275.37,-31246.58 275.37,-31185.21 275.37,-31185.21"/>
<polygon fill="black" stroke="black" points="278.87,-31185.21 275.37,-31175.21 271.87,-31185.21 278.87,-31185.21"/>
</g>
<!-- lay1_mlp_mul -->
<g id="node27" class="node">
<title>lay1_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-31034.83 248.87,-31034.83 248.87,-30966.83 594.87,-30966.83 594.87,-31034.83"/>
<text text-anchor="middle" x="421.87" y="-31019.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-31004.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-30989.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-30974.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_mlp_up&#45;&gt;lay1_mlp_mul -->
<g id="edge30" class="edge">
<title>lay1_mlp_up&#45;&gt;lay1_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-31106.58C499.37,-31106.58 499.37,-31045.21 499.37,-31045.21"/>
<polygon fill="black" stroke="black" points="502.87,-31045.21 499.37,-31035.21 495.87,-31045.21 502.87,-31045.21"/>
</g>
<!-- lay1_mlp_act&#45;&gt;lay1_mlp_mul -->
<g id="edge31" class="edge">
<title>lay1_mlp_act&#45;&gt;lay1_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-31106.58C308.37,-31106.58 308.37,-31045.21 308.37,-31045.21"/>
<polygon fill="black" stroke="black" points="311.87,-31045.21 308.37,-31035.21 304.87,-31045.21 311.87,-31045.21"/>
</g>
<!-- lay1_mlp_down -->
<g id="node28" class="node">
<title>lay1_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-30894.83 320.37,-30894.83 320.37,-30826.83 523.37,-30826.83 523.37,-30894.83"/>
<text text-anchor="middle" x="421.87" y="-30879.63" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-30864.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-30849.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-30834.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_mlp_mul&#45;&gt;lay1_mlp_down -->
<g id="edge32" class="edge">
<title>lay1_mlp_mul&#45;&gt;lay1_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-30966.58C421.87,-30966.58 421.87,-30905.21 421.87,-30905.21"/>
<polygon fill="black" stroke="black" points="425.37,-30905.21 421.87,-30895.21 418.37,-30905.21 425.37,-30905.21"/>
</g>
<!-- lay1_mlp_down&#45;&gt;lay1_res2 -->
<g id="edge33" class="edge">
<title>lay1_mlp_down&#45;&gt;lay1_res2</title>
<path fill="none" stroke="black" d="M421.87,-30826.63C421.87,-30826.63 421.87,-30764.87 421.87,-30764.87"/>
<polygon fill="black" stroke="black" points="425.37,-30764.87 421.87,-30754.87 418.37,-30764.87 425.37,-30764.87"/>
</g>
<!-- lay1_ln2 -->
<g id="node30" class="node">
<title>lay1_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-30586.66 320.37,-30586.66 320.37,-30518.66 523.37,-30518.66 523.37,-30586.66"/>
<text text-anchor="middle" x="421.87" y="-30571.46" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-30556.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-30541.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-30526.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_res2&#45;&gt;lay1_ln2 -->
<g id="edge35" class="edge">
<title>lay1_res2&#45;&gt;lay1_ln2</title>
<path fill="none" stroke="black" d="M421.87,-30658.42C421.87,-30658.42 421.87,-30597.14 421.87,-30597.14"/>
<polygon fill="black" stroke="black" points="425.37,-30597.14 421.87,-30587.14 418.37,-30597.14 425.37,-30597.14"/>
</g>
<!-- layer1_output -->
<g id="node31" class="node">
<title>layer1_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-30446.66 341.11,-30446.66 285.17,-30310.66 502.63,-30310.66 558.57,-30446.66"/>
<text text-anchor="middle" x="421.87" y="-30397.46" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-30382.46" font-family="Times,serif" font-size="14.00">To: GPU 2</text>
<text text-anchor="middle" x="421.87" y="-30367.46" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-30352.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- lay1_ln2&#45;&gt;layer1_output -->
<g id="edge36" class="edge">
<title>lay1_ln2&#45;&gt;layer1_output</title>
<path fill="none" stroke="black" d="M421.87,-30518.29C421.87,-30518.29 421.87,-30456.8 421.87,-30456.8"/>
<polygon fill="black" stroke="black" points="425.37,-30456.8 421.87,-30446.8 418.37,-30456.8 425.37,-30456.8"/>
</g>
<!-- layer2_input -->
<g id="node32" class="node">
<title>layer2_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-30238.66 348.42,-30238.66 297.55,-30102.66 495.32,-30102.66 546.19,-30238.66"/>
<text text-anchor="middle" x="421.87" y="-30189.46" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-30174.46" font-family="Times,serif" font-size="14.00">From: GPU 1</text>
<text text-anchor="middle" x="421.87" y="-30159.46" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-30144.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_output&#45;&gt;layer2_input -->
<g id="edge37" class="edge">
<title>layer1_output&#45;&gt;layer2_input</title>
<path fill="none" stroke="black" d="M421.87,-30310.56C421.87,-30310.56 421.87,-30248.92 421.87,-30248.92"/>
<polygon fill="black" stroke="black" points="425.37,-30248.92 421.87,-30238.92 418.37,-30248.92 425.37,-30248.92"/>
</g>
<!-- lay2_qkv_proj -->
<g id="node33" class="node">
<title>lay2_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="495.37,-30030.66 278.37,-30030.66 278.37,-29962.66 495.37,-29962.66 495.37,-30030.66"/>
<text text-anchor="middle" x="386.87" y="-30015.46" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="386.87" y="-30000.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="386.87" y="-29985.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-29970.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_input&#45;&gt;lay2_qkv_proj -->
<g id="edge38" class="edge">
<title>layer2_input&#45;&gt;lay2_qkv_proj</title>
<path fill="none" stroke="black" d="M396.41,-30102.39C396.41,-30102.39 396.41,-30040.77 396.41,-30040.77"/>
<polygon fill="black" stroke="black" points="399.91,-30040.77 396.41,-30030.77 392.91,-30040.77 399.91,-30040.77"/>
</g>
<!-- lay2_res1 -->
<g id="node37" class="node">
<title>lay2_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-29422.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-29441.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-29426.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-29411.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-29396.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_input&#45;&gt;lay2_res1 -->
<g id="edge43" class="edge">
<title>layer2_input&#45;&gt;lay2_res1</title>
<path fill="none" stroke="black" d="M537.82,-30170.53C537.82,-30170.53 537.82,-29474.32 537.82,-29474.32"/>
<polygon fill="black" stroke="black" points="541.32,-29474.32 537.82,-29464.32 534.32,-29474.32 541.32,-29474.32"/>
</g>
<!-- lay2_attn_score -->
<g id="node34" class="node">
<title>lay2_attn_score</title>
<polygon fill="lightpink" stroke="black" points="529.37,-29890.66 174.37,-29890.66 174.37,-29822.66 529.37,-29822.66 529.37,-29890.66"/>
<text text-anchor="middle" x="351.87" y="-29875.46" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="351.87" y="-29860.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="351.87" y="-29845.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="351.87" y="-29830.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_qkv_proj&#45;&gt;lay2_attn_score -->
<g id="edge39" class="edge">
<title>lay2_qkv_proj&#45;&gt;lay2_attn_score</title>
<path fill="none" stroke="black" d="M386.87,-29962.41C386.87,-29962.41 386.87,-29901.04 386.87,-29901.04"/>
<polygon fill="black" stroke="black" points="390.37,-29901.04 386.87,-29891.04 383.37,-29901.04 390.37,-29901.04"/>
</g>
<!-- lay2_attn_concat -->
<g id="node35" class="node">
<title>lay2_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="472.37,-29750.66 267.37,-29750.66 267.37,-29682.66 472.37,-29682.66 472.37,-29750.66"/>
<text text-anchor="middle" x="369.87" y="-29735.46" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="369.87" y="-29720.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="369.87" y="-29705.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="369.87" y="-29690.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_attn_score&#45;&gt;lay2_attn_concat -->
<g id="edge40" class="edge">
<title>lay2_attn_score&#45;&gt;lay2_attn_concat</title>
<path fill="none" stroke="black" d="M369.87,-29822.41C369.87,-29822.41 369.87,-29761.04 369.87,-29761.04"/>
<polygon fill="black" stroke="black" points="373.37,-29761.04 369.87,-29751.04 366.37,-29761.04 373.37,-29761.04"/>
</g>
<!-- lay2_attn_out -->
<g id="node36" class="node">
<title>lay2_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="512.37,-29610.66 297.37,-29610.66 297.37,-29542.66 512.37,-29542.66 512.37,-29610.66"/>
<text text-anchor="middle" x="404.87" y="-29595.46" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="404.87" y="-29580.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-29565.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-29550.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_attn_concat&#45;&gt;lay2_attn_out -->
<g id="edge41" class="edge">
<title>lay2_attn_concat&#45;&gt;lay2_attn_out</title>
<path fill="none" stroke="black" d="M384.87,-29682.41C384.87,-29682.41 384.87,-29621.04 384.87,-29621.04"/>
<polygon fill="black" stroke="black" points="388.37,-29621.04 384.87,-29611.04 381.37,-29621.04 388.37,-29621.04"/>
</g>
<!-- lay2_attn_out&#45;&gt;lay2_res1 -->
<g id="edge42" class="edge">
<title>lay2_attn_out&#45;&gt;lay2_res1</title>
<path fill="none" stroke="black" d="M404.87,-29542.47C404.87,-29542.47 404.87,-29480.71 404.87,-29480.71"/>
<polygon fill="black" stroke="black" points="408.37,-29480.71 404.87,-29470.71 401.37,-29480.71 408.37,-29480.71"/>
</g>
<!-- lay2_ln1 -->
<g id="node38" class="node">
<title>lay2_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-29302.5 351.37,-29302.5 351.37,-29234.5 554.37,-29234.5 554.37,-29302.5"/>
<text text-anchor="middle" x="452.87" y="-29287.3" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-29272.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-29257.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-29242.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_res1&#45;&gt;lay2_ln1 -->
<g id="edge44" class="edge">
<title>lay2_res1&#45;&gt;lay2_ln1</title>
<path fill="none" stroke="black" d="M452.87,-29374.67C452.87,-29374.67 452.87,-29312.68 452.87,-29312.68"/>
<polygon fill="black" stroke="black" points="456.37,-29312.68 452.87,-29302.68 449.37,-29312.68 456.37,-29312.68"/>
</g>
<!-- lay2_mlp_gate -->
<g id="node39" class="node">
<title>lay2_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-29162.5 182.87,-29162.5 182.87,-29094.5 394.87,-29094.5 394.87,-29162.5"/>
<text text-anchor="middle" x="288.87" y="-29147.3" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-29132.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-29117.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-29102.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_ln1&#45;&gt;lay2_mlp_gate -->
<g id="edge45" class="edge">
<title>lay2_ln1&#45;&gt;lay2_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-29234.25C373.12,-29234.25 373.12,-29172.88 373.12,-29172.88"/>
<polygon fill="black" stroke="black" points="376.62,-29172.88 373.12,-29162.88 369.62,-29172.88 376.62,-29172.88"/>
</g>
<!-- lay2_mlp_up -->
<g id="node40" class="node">
<title>lay2_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-29022.5 403.87,-29022.5 403.87,-28954.5 615.87,-28954.5 615.87,-29022.5"/>
<text text-anchor="middle" x="509.87" y="-29007.3" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-28992.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-28977.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-28962.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_ln1&#45;&gt;lay2_mlp_up -->
<g id="edge46" class="edge">
<title>lay2_ln1&#45;&gt;lay2_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-29234.44C479.12,-29234.44 479.12,-29032.75 479.12,-29032.75"/>
<polygon fill="black" stroke="black" points="482.62,-29032.75 479.12,-29022.75 475.62,-29032.75 482.62,-29032.75"/>
</g>
<!-- lay2_res2 -->
<g id="node44" class="node">
<title>lay2_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-28554.41" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-28573.21" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-28558.21" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-28543.21" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-28528.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_ln1&#45;&gt;lay2_res2 -->
<g id="edge52" class="edge">
<title>lay2_ln1&#45;&gt;lay2_res2</title>
<path fill="none" stroke="black" d="M554.49,-29268C596.17,-29268 634.84,-29268 634.84,-29268 634.84,-29268 634.84,-28583.5 634.84,-28583.5"/>
<polygon fill="black" stroke="black" points="638.34,-28583.5 634.84,-28573.5 631.34,-28583.5 638.34,-28583.5"/>
</g>
<!-- lay2_mlp_act -->
<g id="node41" class="node">
<title>lay2_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-29022.5 155.87,-29022.5 155.87,-28954.5 367.87,-28954.5 367.87,-29022.5"/>
<text text-anchor="middle" x="261.87" y="-29007.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-28992.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-28977.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-28962.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_mlp_gate&#45;&gt;lay2_mlp_act -->
<g id="edge47" class="edge">
<title>lay2_mlp_gate&#45;&gt;lay2_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-29094.25C275.37,-29094.25 275.37,-29032.88 275.37,-29032.88"/>
<polygon fill="black" stroke="black" points="278.87,-29032.88 275.37,-29022.88 271.87,-29032.88 278.87,-29032.88"/>
</g>
<!-- lay2_mlp_mul -->
<g id="node42" class="node">
<title>lay2_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-28882.5 248.87,-28882.5 248.87,-28814.5 594.87,-28814.5 594.87,-28882.5"/>
<text text-anchor="middle" x="421.87" y="-28867.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-28852.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-28837.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-28822.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_mlp_up&#45;&gt;lay2_mlp_mul -->
<g id="edge48" class="edge">
<title>lay2_mlp_up&#45;&gt;lay2_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-28954.25C499.37,-28954.25 499.37,-28892.88 499.37,-28892.88"/>
<polygon fill="black" stroke="black" points="502.87,-28892.88 499.37,-28882.88 495.87,-28892.88 502.87,-28892.88"/>
</g>
<!-- lay2_mlp_act&#45;&gt;lay2_mlp_mul -->
<g id="edge49" class="edge">
<title>lay2_mlp_act&#45;&gt;lay2_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-28954.25C308.37,-28954.25 308.37,-28892.88 308.37,-28892.88"/>
<polygon fill="black" stroke="black" points="311.87,-28892.88 308.37,-28882.88 304.87,-28892.88 311.87,-28892.88"/>
</g>
<!-- lay2_mlp_down -->
<g id="node43" class="node">
<title>lay2_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-28742.5 320.37,-28742.5 320.37,-28674.5 523.37,-28674.5 523.37,-28742.5"/>
<text text-anchor="middle" x="421.87" y="-28727.3" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-28712.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-28697.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-28682.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_mlp_mul&#45;&gt;lay2_mlp_down -->
<g id="edge50" class="edge">
<title>lay2_mlp_mul&#45;&gt;lay2_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-28814.25C421.87,-28814.25 421.87,-28752.88 421.87,-28752.88"/>
<polygon fill="black" stroke="black" points="425.37,-28752.88 421.87,-28742.88 418.37,-28752.88 425.37,-28752.88"/>
</g>
<!-- lay2_mlp_down&#45;&gt;lay2_res2 -->
<g id="edge51" class="edge">
<title>lay2_mlp_down&#45;&gt;lay2_res2</title>
<path fill="none" stroke="black" d="M421.87,-28674.3C421.87,-28674.3 421.87,-28612.54 421.87,-28612.54"/>
<polygon fill="black" stroke="black" points="425.37,-28612.54 421.87,-28602.54 418.37,-28612.54 425.37,-28612.54"/>
</g>
<!-- lay2_ln2 -->
<g id="node45" class="node">
<title>lay2_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-28434.33 320.37,-28434.33 320.37,-28366.33 523.37,-28366.33 523.37,-28434.33"/>
<text text-anchor="middle" x="421.87" y="-28419.13" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-28404.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-28389.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-28374.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_res2&#45;&gt;lay2_ln2 -->
<g id="edge53" class="edge">
<title>lay2_res2&#45;&gt;lay2_ln2</title>
<path fill="none" stroke="black" d="M421.87,-28506.08C421.87,-28506.08 421.87,-28444.81 421.87,-28444.81"/>
<polygon fill="black" stroke="black" points="425.37,-28444.81 421.87,-28434.81 418.37,-28444.81 425.37,-28444.81"/>
</g>
<!-- layer2_output -->
<g id="node46" class="node">
<title>layer2_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-28294.33 341.11,-28294.33 285.17,-28158.33 502.63,-28158.33 558.57,-28294.33"/>
<text text-anchor="middle" x="421.87" y="-28245.13" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-28230.13" font-family="Times,serif" font-size="14.00">To: GPU 3</text>
<text text-anchor="middle" x="421.87" y="-28215.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-28200.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- lay2_ln2&#45;&gt;layer2_output -->
<g id="edge54" class="edge">
<title>lay2_ln2&#45;&gt;layer2_output</title>
<path fill="none" stroke="black" d="M421.87,-28365.95C421.87,-28365.95 421.87,-28304.47 421.87,-28304.47"/>
<polygon fill="black" stroke="black" points="425.37,-28304.47 421.87,-28294.47 418.37,-28304.47 425.37,-28304.47"/>
</g>
<!-- layer3_input -->
<g id="node47" class="node">
<title>layer3_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-28086.33 348.42,-28086.33 297.55,-27950.33 495.32,-27950.33 546.19,-28086.33"/>
<text text-anchor="middle" x="421.87" y="-28037.13" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-28022.13" font-family="Times,serif" font-size="14.00">From: GPU 2</text>
<text text-anchor="middle" x="421.87" y="-28007.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-27992.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_output&#45;&gt;layer3_input -->
<g id="edge55" class="edge">
<title>layer2_output&#45;&gt;layer3_input</title>
<path fill="none" stroke="black" d="M421.87,-28158.22C421.87,-28158.22 421.87,-28096.59 421.87,-28096.59"/>
<polygon fill="black" stroke="black" points="425.37,-28096.59 421.87,-28086.59 418.37,-28096.59 425.37,-28096.59"/>
</g>
<!-- lay3_qkv_proj -->
<g id="node48" class="node">
<title>lay3_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="508.37,-27878.33 291.37,-27878.33 291.37,-27810.33 508.37,-27810.33 508.37,-27878.33"/>
<text text-anchor="middle" x="399.87" y="-27863.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="399.87" y="-27848.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="399.87" y="-27833.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="399.87" y="-27818.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_input&#45;&gt;lay3_qkv_proj -->
<g id="edge56" class="edge">
<title>layer3_input&#45;&gt;lay3_qkv_proj</title>
<path fill="none" stroke="black" d="M402.91,-27950.06C402.91,-27950.06 402.91,-27888.44 402.91,-27888.44"/>
<polygon fill="black" stroke="black" points="406.41,-27888.44 402.91,-27878.44 399.41,-27888.44 406.41,-27888.44"/>
</g>
<!-- lay3_res1 -->
<g id="node52" class="node">
<title>lay3_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-27270.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-27289.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-27274.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-27259.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-27244.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_input&#45;&gt;lay3_res1 -->
<g id="edge61" class="edge">
<title>layer3_input&#45;&gt;lay3_res1</title>
<path fill="none" stroke="black" d="M520.88,-28018C539.1,-28018 552.5,-28018 552.5,-28018 552.5,-28018 552.5,-27320.18 552.5,-27320.18"/>
<polygon fill="black" stroke="black" points="556,-27320.18 552.5,-27310.18 549,-27320.18 556,-27320.18"/>
</g>
<!-- lay3_attn_score -->
<g id="node49" class="node">
<title>lay3_attn_score</title>
<polygon fill="lightpink" stroke="black" points="542.37,-27738.33 187.37,-27738.33 187.37,-27670.33 542.37,-27670.33 542.37,-27738.33"/>
<text text-anchor="middle" x="364.87" y="-27723.13" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="364.87" y="-27708.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-27693.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-27678.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_qkv_proj&#45;&gt;lay3_attn_score -->
<g id="edge57" class="edge">
<title>lay3_qkv_proj&#45;&gt;lay3_attn_score</title>
<path fill="none" stroke="black" d="M399.87,-27810.08C399.87,-27810.08 399.87,-27748.71 399.87,-27748.71"/>
<polygon fill="black" stroke="black" points="403.37,-27748.71 399.87,-27738.71 396.37,-27748.71 403.37,-27748.71"/>
</g>
<!-- lay3_attn_concat -->
<g id="node50" class="node">
<title>lay3_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="491.37,-27598.33 286.37,-27598.33 286.37,-27530.33 491.37,-27530.33 491.37,-27598.33"/>
<text text-anchor="middle" x="388.87" y="-27583.13" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="388.87" y="-27568.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="388.87" y="-27553.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="388.87" y="-27538.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_attn_score&#45;&gt;lay3_attn_concat -->
<g id="edge58" class="edge">
<title>lay3_attn_score&#45;&gt;lay3_attn_concat</title>
<path fill="none" stroke="black" d="M388.87,-27670.08C388.87,-27670.08 388.87,-27608.71 388.87,-27608.71"/>
<polygon fill="black" stroke="black" points="392.37,-27608.71 388.87,-27598.71 385.37,-27608.71 392.37,-27608.71"/>
</g>
<!-- lay3_attn_out -->
<g id="node51" class="node">
<title>lay3_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="520.37,-27458.33 305.37,-27458.33 305.37,-27390.33 520.37,-27390.33 520.37,-27458.33"/>
<text text-anchor="middle" x="412.87" y="-27443.13" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="412.87" y="-27428.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-27413.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-27398.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_attn_concat&#45;&gt;lay3_attn_out -->
<g id="edge59" class="edge">
<title>lay3_attn_concat&#45;&gt;lay3_attn_out</title>
<path fill="none" stroke="black" d="M398.37,-27530.08C398.37,-27530.08 398.37,-27468.71 398.37,-27468.71"/>
<polygon fill="black" stroke="black" points="401.87,-27468.71 398.37,-27458.71 394.87,-27468.71 401.87,-27468.71"/>
</g>
<!-- lay3_attn_out&#45;&gt;lay3_res1 -->
<g id="edge60" class="edge">
<title>lay3_attn_out&#45;&gt;lay3_res1</title>
<path fill="none" stroke="black" d="M412.87,-27390.13C412.87,-27390.13 412.87,-27328.37 412.87,-27328.37"/>
<polygon fill="black" stroke="black" points="416.37,-27328.37 412.87,-27318.37 409.37,-27328.37 416.37,-27328.37"/>
</g>
<!-- lay3_ln1 -->
<g id="node53" class="node">
<title>lay3_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-27150.16 351.37,-27150.16 351.37,-27082.16 554.37,-27082.16 554.37,-27150.16"/>
<text text-anchor="middle" x="452.87" y="-27134.96" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-27119.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-27104.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-27089.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_res1&#45;&gt;lay3_ln1 -->
<g id="edge62" class="edge">
<title>lay3_res1&#45;&gt;lay3_ln1</title>
<path fill="none" stroke="black" d="M452.87,-27222.34C452.87,-27222.34 452.87,-27160.35 452.87,-27160.35"/>
<polygon fill="black" stroke="black" points="456.37,-27160.35 452.87,-27150.35 449.37,-27160.35 456.37,-27160.35"/>
</g>
<!-- lay3_mlp_gate -->
<g id="node54" class="node">
<title>lay3_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-27010.16 182.87,-27010.16 182.87,-26942.16 394.87,-26942.16 394.87,-27010.16"/>
<text text-anchor="middle" x="288.87" y="-26994.96" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-26979.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-26964.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-26949.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_ln1&#45;&gt;lay3_mlp_gate -->
<g id="edge63" class="edge">
<title>lay3_ln1&#45;&gt;lay3_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-27081.92C373.12,-27081.92 373.12,-27020.54 373.12,-27020.54"/>
<polygon fill="black" stroke="black" points="376.62,-27020.54 373.12,-27010.54 369.62,-27020.54 376.62,-27020.54"/>
</g>
<!-- lay3_mlp_up -->
<g id="node55" class="node">
<title>lay3_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-26870.16 403.87,-26870.16 403.87,-26802.16 615.87,-26802.16 615.87,-26870.16"/>
<text text-anchor="middle" x="509.87" y="-26854.96" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-26839.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-26824.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-26809.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_ln1&#45;&gt;lay3_mlp_up -->
<g id="edge64" class="edge">
<title>lay3_ln1&#45;&gt;lay3_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-27082.11C479.12,-27082.11 479.12,-26880.42 479.12,-26880.42"/>
<polygon fill="black" stroke="black" points="482.62,-26880.42 479.12,-26870.42 475.62,-26880.42 482.62,-26880.42"/>
</g>
<!-- lay3_res2 -->
<g id="node59" class="node">
<title>lay3_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-26402.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-26420.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-26405.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-26390.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-26375.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_ln1&#45;&gt;lay3_res2 -->
<g id="edge70" class="edge">
<title>lay3_ln1&#45;&gt;lay3_res2</title>
<path fill="none" stroke="black" d="M554.49,-27116C596.17,-27116 634.84,-27116 634.84,-27116 634.84,-27116 634.84,-26431.18 634.84,-26431.18"/>
<polygon fill="black" stroke="black" points="638.34,-26431.18 634.84,-26421.18 631.34,-26431.18 638.34,-26431.18"/>
</g>
<!-- lay3_mlp_act -->
<g id="node56" class="node">
<title>lay3_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-26870.16 155.87,-26870.16 155.87,-26802.16 367.87,-26802.16 367.87,-26870.16"/>
<text text-anchor="middle" x="261.87" y="-26854.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-26839.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-26824.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-26809.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_mlp_gate&#45;&gt;lay3_mlp_act -->
<g id="edge65" class="edge">
<title>lay3_mlp_gate&#45;&gt;lay3_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-26941.92C275.37,-26941.92 275.37,-26880.54 275.37,-26880.54"/>
<polygon fill="black" stroke="black" points="278.87,-26880.54 275.37,-26870.54 271.87,-26880.54 278.87,-26880.54"/>
</g>
<!-- lay3_mlp_mul -->
<g id="node57" class="node">
<title>lay3_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-26730.16 248.87,-26730.16 248.87,-26662.16 594.87,-26662.16 594.87,-26730.16"/>
<text text-anchor="middle" x="421.87" y="-26714.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-26699.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-26684.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-26669.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_mlp_up&#45;&gt;lay3_mlp_mul -->
<g id="edge66" class="edge">
<title>lay3_mlp_up&#45;&gt;lay3_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-26801.92C499.37,-26801.92 499.37,-26740.54 499.37,-26740.54"/>
<polygon fill="black" stroke="black" points="502.87,-26740.54 499.37,-26730.54 495.87,-26740.54 502.87,-26740.54"/>
</g>
<!-- lay3_mlp_act&#45;&gt;lay3_mlp_mul -->
<g id="edge67" class="edge">
<title>lay3_mlp_act&#45;&gt;lay3_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-26801.92C308.37,-26801.92 308.37,-26740.54 308.37,-26740.54"/>
<polygon fill="black" stroke="black" points="311.87,-26740.54 308.37,-26730.54 304.87,-26740.54 311.87,-26740.54"/>
</g>
<!-- lay3_mlp_down -->
<g id="node58" class="node">
<title>lay3_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-26590.16 320.37,-26590.16 320.37,-26522.16 523.37,-26522.16 523.37,-26590.16"/>
<text text-anchor="middle" x="421.87" y="-26574.96" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-26559.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-26544.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-26529.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_mlp_mul&#45;&gt;lay3_mlp_down -->
<g id="edge68" class="edge">
<title>lay3_mlp_mul&#45;&gt;lay3_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-26661.92C421.87,-26661.92 421.87,-26600.54 421.87,-26600.54"/>
<polygon fill="black" stroke="black" points="425.37,-26600.54 421.87,-26590.54 418.37,-26600.54 425.37,-26600.54"/>
</g>
<!-- lay3_mlp_down&#45;&gt;lay3_res2 -->
<g id="edge69" class="edge">
<title>lay3_mlp_down&#45;&gt;lay3_res2</title>
<path fill="none" stroke="black" d="M421.87,-26521.97C421.87,-26521.97 421.87,-26460.21 421.87,-26460.21"/>
<polygon fill="black" stroke="black" points="425.37,-26460.21 421.87,-26450.21 418.37,-26460.21 425.37,-26460.21"/>
</g>
<!-- lay3_ln2 -->
<g id="node60" class="node">
<title>lay3_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-26282 320.37,-26282 320.37,-26214 523.37,-26214 523.37,-26282"/>
<text text-anchor="middle" x="421.87" y="-26266.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-26251.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-26236.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-26221.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_res2&#45;&gt;lay3_ln2 -->
<g id="edge71" class="edge">
<title>lay3_res2&#45;&gt;lay3_ln2</title>
<path fill="none" stroke="black" d="M421.87,-26353.75C421.87,-26353.75 421.87,-26292.48 421.87,-26292.48"/>
<polygon fill="black" stroke="black" points="425.37,-26292.48 421.87,-26282.48 418.37,-26292.48 425.37,-26292.48"/>
</g>
<!-- layer3_output -->
<g id="node61" class="node">
<title>layer3_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-26142 341.11,-26142 285.17,-26006 502.63,-26006 558.57,-26142"/>
<text text-anchor="middle" x="421.87" y="-26092.8" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-26077.8" font-family="Times,serif" font-size="14.00">To: GPU 4</text>
<text text-anchor="middle" x="421.87" y="-26062.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-26047.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- lay3_ln2&#45;&gt;layer3_output -->
<g id="edge72" class="edge">
<title>lay3_ln2&#45;&gt;layer3_output</title>
<path fill="none" stroke="black" d="M421.87,-26213.62C421.87,-26213.62 421.87,-26152.14 421.87,-26152.14"/>
<polygon fill="black" stroke="black" points="425.37,-26152.14 421.87,-26142.14 418.37,-26152.14 425.37,-26152.14"/>
</g>
<!-- layer4_input -->
<g id="node62" class="node">
<title>layer4_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-25934 348.42,-25934 297.55,-25798 495.32,-25798 546.19,-25934"/>
<text text-anchor="middle" x="421.87" y="-25884.8" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-25869.8" font-family="Times,serif" font-size="14.00">From: GPU 3</text>
<text text-anchor="middle" x="421.87" y="-25854.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-25839.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_output&#45;&gt;layer4_input -->
<g id="edge73" class="edge">
<title>layer3_output&#45;&gt;layer4_input</title>
<path fill="none" stroke="black" d="M421.87,-26005.89C421.87,-26005.89 421.87,-25944.26 421.87,-25944.26"/>
<polygon fill="black" stroke="black" points="425.37,-25944.26 421.87,-25934.26 418.37,-25944.26 425.37,-25944.26"/>
</g>
<!-- lay4_qkv_proj -->
<g id="node63" class="node">
<title>lay4_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="508.37,-25726 291.37,-25726 291.37,-25658 508.37,-25658 508.37,-25726"/>
<text text-anchor="middle" x="399.87" y="-25710.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="399.87" y="-25695.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="399.87" y="-25680.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="399.87" y="-25665.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_input&#45;&gt;lay4_qkv_proj -->
<g id="edge74" class="edge">
<title>layer4_input&#45;&gt;lay4_qkv_proj</title>
<path fill="none" stroke="black" d="M402.91,-25797.73C402.91,-25797.73 402.91,-25736.11 402.91,-25736.11"/>
<polygon fill="black" stroke="black" points="406.41,-25736.11 402.91,-25726.11 399.41,-25736.11 406.41,-25736.11"/>
</g>
<!-- lay4_res1 -->
<g id="node67" class="node">
<title>lay4_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-25117.91" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-25136.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-25121.71" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-25106.71" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-25091.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_input&#45;&gt;lay4_res1 -->
<g id="edge79" class="edge">
<title>layer4_input&#45;&gt;lay4_res1</title>
<path fill="none" stroke="black" d="M520.54,-25865C538.93,-25865 552.5,-25865 552.5,-25865 552.5,-25865 552.5,-25167.82 552.5,-25167.82"/>
<polygon fill="black" stroke="black" points="556,-25167.82 552.5,-25157.82 549,-25167.82 556,-25167.82"/>
</g>
<!-- lay4_attn_score -->
<g id="node64" class="node">
<title>lay4_attn_score</title>
<polygon fill="lightpink" stroke="black" points="542.37,-25586 187.37,-25586 187.37,-25518 542.37,-25518 542.37,-25586"/>
<text text-anchor="middle" x="364.87" y="-25570.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="364.87" y="-25555.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-25540.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-25525.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_qkv_proj&#45;&gt;lay4_attn_score -->
<g id="edge75" class="edge">
<title>lay4_qkv_proj&#45;&gt;lay4_attn_score</title>
<path fill="none" stroke="black" d="M399.87,-25657.75C399.87,-25657.75 399.87,-25596.38 399.87,-25596.38"/>
<polygon fill="black" stroke="black" points="403.37,-25596.38 399.87,-25586.38 396.37,-25596.38 403.37,-25596.38"/>
</g>
<!-- lay4_attn_concat -->
<g id="node65" class="node">
<title>lay4_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="491.37,-25446 286.37,-25446 286.37,-25378 491.37,-25378 491.37,-25446"/>
<text text-anchor="middle" x="388.87" y="-25430.8" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="388.87" y="-25415.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="388.87" y="-25400.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="388.87" y="-25385.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_attn_score&#45;&gt;lay4_attn_concat -->
<g id="edge76" class="edge">
<title>lay4_attn_score&#45;&gt;lay4_attn_concat</title>
<path fill="none" stroke="black" d="M388.87,-25517.75C388.87,-25517.75 388.87,-25456.38 388.87,-25456.38"/>
<polygon fill="black" stroke="black" points="392.37,-25456.38 388.87,-25446.38 385.37,-25456.38 392.37,-25456.38"/>
</g>
<!-- lay4_attn_out -->
<g id="node66" class="node">
<title>lay4_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="520.37,-25306 305.37,-25306 305.37,-25238 520.37,-25238 520.37,-25306"/>
<text text-anchor="middle" x="412.87" y="-25290.8" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="412.87" y="-25275.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-25260.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-25245.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_attn_concat&#45;&gt;lay4_attn_out -->
<g id="edge77" class="edge">
<title>lay4_attn_concat&#45;&gt;lay4_attn_out</title>
<path fill="none" stroke="black" d="M398.37,-25377.75C398.37,-25377.75 398.37,-25316.38 398.37,-25316.38"/>
<polygon fill="black" stroke="black" points="401.87,-25316.38 398.37,-25306.38 394.87,-25316.38 401.87,-25316.38"/>
</g>
<!-- lay4_attn_out&#45;&gt;lay4_res1 -->
<g id="edge78" class="edge">
<title>lay4_attn_out&#45;&gt;lay4_res1</title>
<path fill="none" stroke="black" d="M412.87,-25237.8C412.87,-25237.8 412.87,-25176.04 412.87,-25176.04"/>
<polygon fill="black" stroke="black" points="416.37,-25176.04 412.87,-25166.04 409.37,-25176.04 416.37,-25176.04"/>
</g>
<!-- lay4_ln1 -->
<g id="node68" class="node">
<title>lay4_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-24997.83 351.37,-24997.83 351.37,-24929.83 554.37,-24929.83 554.37,-24997.83"/>
<text text-anchor="middle" x="452.87" y="-24982.63" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-24967.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-24952.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-24937.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_res1&#45;&gt;lay4_ln1 -->
<g id="edge80" class="edge">
<title>lay4_res1&#45;&gt;lay4_ln1</title>
<path fill="none" stroke="black" d="M452.87,-25070C452.87,-25070 452.87,-25008.01 452.87,-25008.01"/>
<polygon fill="black" stroke="black" points="456.37,-25008.01 452.87,-24998.01 449.37,-25008.01 456.37,-25008.01"/>
</g>
<!-- lay4_mlp_gate -->
<g id="node69" class="node">
<title>lay4_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-24857.83 182.87,-24857.83 182.87,-24789.83 394.87,-24789.83 394.87,-24857.83"/>
<text text-anchor="middle" x="288.87" y="-24842.63" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-24827.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-24812.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-24797.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_ln1&#45;&gt;lay4_mlp_gate -->
<g id="edge81" class="edge">
<title>lay4_ln1&#45;&gt;lay4_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-24929.58C373.12,-24929.58 373.12,-24868.21 373.12,-24868.21"/>
<polygon fill="black" stroke="black" points="376.62,-24868.21 373.12,-24858.21 369.62,-24868.21 376.62,-24868.21"/>
</g>
<!-- lay4_mlp_up -->
<g id="node70" class="node">
<title>lay4_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-24717.83 403.87,-24717.83 403.87,-24649.83 615.87,-24649.83 615.87,-24717.83"/>
<text text-anchor="middle" x="509.87" y="-24702.63" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-24687.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-24672.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-24657.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_ln1&#45;&gt;lay4_mlp_up -->
<g id="edge82" class="edge">
<title>lay4_ln1&#45;&gt;lay4_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-24929.78C479.12,-24929.78 479.12,-24728.08 479.12,-24728.08"/>
<polygon fill="black" stroke="black" points="482.62,-24728.08 479.12,-24718.08 475.62,-24728.08 482.62,-24728.08"/>
</g>
<!-- lay4_res2 -->
<g id="node74" class="node">
<title>lay4_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-24249.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-24268.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-24253.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-24238.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-24223.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_ln1&#45;&gt;lay4_res2 -->
<g id="edge88" class="edge">
<title>lay4_ln1&#45;&gt;lay4_res2</title>
<path fill="none" stroke="black" d="M554.49,-24963C596.17,-24963 634.84,-24963 634.84,-24963 634.84,-24963 634.84,-24278.82 634.84,-24278.82"/>
<polygon fill="black" stroke="black" points="638.34,-24278.82 634.84,-24268.82 631.34,-24278.82 638.34,-24278.82"/>
</g>
<!-- lay4_mlp_act -->
<g id="node71" class="node">
<title>lay4_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-24717.83 155.87,-24717.83 155.87,-24649.83 367.87,-24649.83 367.87,-24717.83"/>
<text text-anchor="middle" x="261.87" y="-24702.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-24687.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-24672.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-24657.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_mlp_gate&#45;&gt;lay4_mlp_act -->
<g id="edge83" class="edge">
<title>lay4_mlp_gate&#45;&gt;lay4_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-24789.58C275.37,-24789.58 275.37,-24728.21 275.37,-24728.21"/>
<polygon fill="black" stroke="black" points="278.87,-24728.21 275.37,-24718.21 271.87,-24728.21 278.87,-24728.21"/>
</g>
<!-- lay4_mlp_mul -->
<g id="node72" class="node">
<title>lay4_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-24577.83 248.87,-24577.83 248.87,-24509.83 594.87,-24509.83 594.87,-24577.83"/>
<text text-anchor="middle" x="421.87" y="-24562.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-24547.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-24532.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-24517.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_mlp_up&#45;&gt;lay4_mlp_mul -->
<g id="edge84" class="edge">
<title>lay4_mlp_up&#45;&gt;lay4_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-24649.58C499.37,-24649.58 499.37,-24588.21 499.37,-24588.21"/>
<polygon fill="black" stroke="black" points="502.87,-24588.21 499.37,-24578.21 495.87,-24588.21 502.87,-24588.21"/>
</g>
<!-- lay4_mlp_act&#45;&gt;lay4_mlp_mul -->
<g id="edge85" class="edge">
<title>lay4_mlp_act&#45;&gt;lay4_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-24649.58C308.37,-24649.58 308.37,-24588.21 308.37,-24588.21"/>
<polygon fill="black" stroke="black" points="311.87,-24588.21 308.37,-24578.21 304.87,-24588.21 311.87,-24588.21"/>
</g>
<!-- lay4_mlp_down -->
<g id="node73" class="node">
<title>lay4_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-24437.83 320.37,-24437.83 320.37,-24369.83 523.37,-24369.83 523.37,-24437.83"/>
<text text-anchor="middle" x="421.87" y="-24422.63" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-24407.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-24392.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-24377.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_mlp_mul&#45;&gt;lay4_mlp_down -->
<g id="edge86" class="edge">
<title>lay4_mlp_mul&#45;&gt;lay4_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-24509.58C421.87,-24509.58 421.87,-24448.21 421.87,-24448.21"/>
<polygon fill="black" stroke="black" points="425.37,-24448.21 421.87,-24438.21 418.37,-24448.21 425.37,-24448.21"/>
</g>
<!-- lay4_mlp_down&#45;&gt;lay4_res2 -->
<g id="edge87" class="edge">
<title>lay4_mlp_down&#45;&gt;lay4_res2</title>
<path fill="none" stroke="black" d="M421.87,-24369.63C421.87,-24369.63 421.87,-24307.87 421.87,-24307.87"/>
<polygon fill="black" stroke="black" points="425.37,-24307.87 421.87,-24297.87 418.37,-24307.87 425.37,-24307.87"/>
</g>
<!-- lay4_ln2 -->
<g id="node75" class="node">
<title>lay4_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-24129.66 320.37,-24129.66 320.37,-24061.66 523.37,-24061.66 523.37,-24129.66"/>
<text text-anchor="middle" x="421.87" y="-24114.46" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-24099.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-24084.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-24069.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_res2&#45;&gt;lay4_ln2 -->
<g id="edge89" class="edge">
<title>lay4_res2&#45;&gt;lay4_ln2</title>
<path fill="none" stroke="black" d="M421.87,-24201.42C421.87,-24201.42 421.87,-24140.14 421.87,-24140.14"/>
<polygon fill="black" stroke="black" points="425.37,-24140.14 421.87,-24130.14 418.37,-24140.14 425.37,-24140.14"/>
</g>
<!-- layer4_output -->
<g id="node76" class="node">
<title>layer4_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-23989.66 341.11,-23989.66 285.17,-23853.66 502.63,-23853.66 558.57,-23989.66"/>
<text text-anchor="middle" x="421.87" y="-23940.46" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-23925.46" font-family="Times,serif" font-size="14.00">To: GPU 5</text>
<text text-anchor="middle" x="421.87" y="-23910.46" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-23895.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- lay4_ln2&#45;&gt;layer4_output -->
<g id="edge90" class="edge">
<title>lay4_ln2&#45;&gt;layer4_output</title>
<path fill="none" stroke="black" d="M421.87,-24061.29C421.87,-24061.29 421.87,-23999.8 421.87,-23999.8"/>
<polygon fill="black" stroke="black" points="425.37,-23999.8 421.87,-23989.8 418.37,-23999.8 425.37,-23999.8"/>
</g>
<!-- layer5_input -->
<g id="node77" class="node">
<title>layer5_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-23781.66 348.42,-23781.66 297.55,-23645.66 495.32,-23645.66 546.19,-23781.66"/>
<text text-anchor="middle" x="421.87" y="-23732.46" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-23717.46" font-family="Times,serif" font-size="14.00">From: GPU 4</text>
<text text-anchor="middle" x="421.87" y="-23702.46" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-23687.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_output&#45;&gt;layer5_input -->
<g id="edge91" class="edge">
<title>layer4_output&#45;&gt;layer5_input</title>
<path fill="none" stroke="black" d="M421.87,-23853.56C421.87,-23853.56 421.87,-23791.92 421.87,-23791.92"/>
<polygon fill="black" stroke="black" points="425.37,-23791.92 421.87,-23781.92 418.37,-23791.92 425.37,-23791.92"/>
</g>
<!-- lay5_qkv_proj -->
<g id="node78" class="node">
<title>lay5_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="495.37,-23573.66 278.37,-23573.66 278.37,-23505.66 495.37,-23505.66 495.37,-23573.66"/>
<text text-anchor="middle" x="386.87" y="-23558.46" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="386.87" y="-23543.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="386.87" y="-23528.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-23513.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_input&#45;&gt;lay5_qkv_proj -->
<g id="edge92" class="edge">
<title>layer5_input&#45;&gt;lay5_qkv_proj</title>
<path fill="none" stroke="black" d="M396.41,-23645.39C396.41,-23645.39 396.41,-23583.77 396.41,-23583.77"/>
<polygon fill="black" stroke="black" points="399.91,-23583.77 396.41,-23573.77 392.91,-23583.77 399.91,-23583.77"/>
</g>
<!-- lay5_res1 -->
<g id="node82" class="node">
<title>lay5_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-22965.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-22984.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-22969.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-22954.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-22939.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_input&#45;&gt;lay5_res1 -->
<g id="edge97" class="edge">
<title>layer5_input&#45;&gt;lay5_res1</title>
<path fill="none" stroke="black" d="M537.82,-23713.53C537.82,-23713.53 537.82,-23017.32 537.82,-23017.32"/>
<polygon fill="black" stroke="black" points="541.32,-23017.32 537.82,-23007.32 534.32,-23017.32 541.32,-23017.32"/>
</g>
<!-- lay5_attn_score -->
<g id="node79" class="node">
<title>lay5_attn_score</title>
<polygon fill="lightpink" stroke="black" points="529.37,-23433.66 174.37,-23433.66 174.37,-23365.66 529.37,-23365.66 529.37,-23433.66"/>
<text text-anchor="middle" x="351.87" y="-23418.46" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="351.87" y="-23403.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="351.87" y="-23388.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="351.87" y="-23373.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_qkv_proj&#45;&gt;lay5_attn_score -->
<g id="edge93" class="edge">
<title>lay5_qkv_proj&#45;&gt;lay5_attn_score</title>
<path fill="none" stroke="black" d="M386.87,-23505.42C386.87,-23505.42 386.87,-23444.04 386.87,-23444.04"/>
<polygon fill="black" stroke="black" points="390.37,-23444.04 386.87,-23434.04 383.37,-23444.04 390.37,-23444.04"/>
</g>
<!-- lay5_attn_concat -->
<g id="node80" class="node">
<title>lay5_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="472.37,-23293.66 267.37,-23293.66 267.37,-23225.66 472.37,-23225.66 472.37,-23293.66"/>
<text text-anchor="middle" x="369.87" y="-23278.46" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="369.87" y="-23263.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="369.87" y="-23248.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="369.87" y="-23233.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_attn_score&#45;&gt;lay5_attn_concat -->
<g id="edge94" class="edge">
<title>lay5_attn_score&#45;&gt;lay5_attn_concat</title>
<path fill="none" stroke="black" d="M369.87,-23365.42C369.87,-23365.42 369.87,-23304.04 369.87,-23304.04"/>
<polygon fill="black" stroke="black" points="373.37,-23304.04 369.87,-23294.04 366.37,-23304.04 373.37,-23304.04"/>
</g>
<!-- lay5_attn_out -->
<g id="node81" class="node">
<title>lay5_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="512.37,-23153.66 297.37,-23153.66 297.37,-23085.66 512.37,-23085.66 512.37,-23153.66"/>
<text text-anchor="middle" x="404.87" y="-23138.46" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="404.87" y="-23123.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-23108.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-23093.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_attn_concat&#45;&gt;lay5_attn_out -->
<g id="edge95" class="edge">
<title>lay5_attn_concat&#45;&gt;lay5_attn_out</title>
<path fill="none" stroke="black" d="M384.87,-23225.42C384.87,-23225.42 384.87,-23164.04 384.87,-23164.04"/>
<polygon fill="black" stroke="black" points="388.37,-23164.04 384.87,-23154.04 381.37,-23164.04 388.37,-23164.04"/>
</g>
<!-- lay5_attn_out&#45;&gt;lay5_res1 -->
<g id="edge96" class="edge">
<title>lay5_attn_out&#45;&gt;lay5_res1</title>
<path fill="none" stroke="black" d="M404.87,-23085.47C404.87,-23085.47 404.87,-23023.71 404.87,-23023.71"/>
<polygon fill="black" stroke="black" points="408.37,-23023.71 404.87,-23013.71 401.37,-23023.71 408.37,-23023.71"/>
</g>
<!-- lay5_ln1 -->
<g id="node83" class="node">
<title>lay5_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-22845.5 351.37,-22845.5 351.37,-22777.5 554.37,-22777.5 554.37,-22845.5"/>
<text text-anchor="middle" x="452.87" y="-22830.3" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-22815.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-22800.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-22785.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_res1&#45;&gt;lay5_ln1 -->
<g id="edge98" class="edge">
<title>lay5_res1&#45;&gt;lay5_ln1</title>
<path fill="none" stroke="black" d="M452.87,-22917.67C452.87,-22917.67 452.87,-22855.68 452.87,-22855.68"/>
<polygon fill="black" stroke="black" points="456.37,-22855.68 452.87,-22845.68 449.37,-22855.68 456.37,-22855.68"/>
</g>
<!-- lay5_mlp_gate -->
<g id="node84" class="node">
<title>lay5_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-22705.5 182.87,-22705.5 182.87,-22637.5 394.87,-22637.5 394.87,-22705.5"/>
<text text-anchor="middle" x="288.87" y="-22690.3" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-22675.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-22660.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-22645.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_ln1&#45;&gt;lay5_mlp_gate -->
<g id="edge99" class="edge">
<title>lay5_ln1&#45;&gt;lay5_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-22777.25C373.12,-22777.25 373.12,-22715.88 373.12,-22715.88"/>
<polygon fill="black" stroke="black" points="376.62,-22715.88 373.12,-22705.88 369.62,-22715.88 376.62,-22715.88"/>
</g>
<!-- lay5_mlp_up -->
<g id="node85" class="node">
<title>lay5_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-22565.5 403.87,-22565.5 403.87,-22497.5 615.87,-22497.5 615.87,-22565.5"/>
<text text-anchor="middle" x="509.87" y="-22550.3" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-22535.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-22520.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-22505.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_ln1&#45;&gt;lay5_mlp_up -->
<g id="edge100" class="edge">
<title>lay5_ln1&#45;&gt;lay5_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-22777.44C479.12,-22777.44 479.12,-22575.75 479.12,-22575.75"/>
<polygon fill="black" stroke="black" points="482.62,-22575.75 479.12,-22565.75 475.62,-22575.75 482.62,-22575.75"/>
</g>
<!-- lay5_res2 -->
<g id="node89" class="node">
<title>lay5_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-22097.41" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-22116.21" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-22101.21" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-22086.21" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-22071.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_ln1&#45;&gt;lay5_res2 -->
<g id="edge106" class="edge">
<title>lay5_ln1&#45;&gt;lay5_res2</title>
<path fill="none" stroke="black" d="M554.49,-22811C596.17,-22811 634.84,-22811 634.84,-22811 634.84,-22811 634.84,-22126.5 634.84,-22126.5"/>
<polygon fill="black" stroke="black" points="638.34,-22126.5 634.84,-22116.5 631.34,-22126.5 638.34,-22126.5"/>
</g>
<!-- lay5_mlp_act -->
<g id="node86" class="node">
<title>lay5_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-22565.5 155.87,-22565.5 155.87,-22497.5 367.87,-22497.5 367.87,-22565.5"/>
<text text-anchor="middle" x="261.87" y="-22550.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-22535.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-22520.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-22505.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_mlp_gate&#45;&gt;lay5_mlp_act -->
<g id="edge101" class="edge">
<title>lay5_mlp_gate&#45;&gt;lay5_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-22637.25C275.37,-22637.25 275.37,-22575.88 275.37,-22575.88"/>
<polygon fill="black" stroke="black" points="278.87,-22575.88 275.37,-22565.88 271.87,-22575.88 278.87,-22575.88"/>
</g>
<!-- lay5_mlp_mul -->
<g id="node87" class="node">
<title>lay5_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-22425.5 248.87,-22425.5 248.87,-22357.5 594.87,-22357.5 594.87,-22425.5"/>
<text text-anchor="middle" x="421.87" y="-22410.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-22395.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-22380.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-22365.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_mlp_up&#45;&gt;lay5_mlp_mul -->
<g id="edge102" class="edge">
<title>lay5_mlp_up&#45;&gt;lay5_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-22497.25C499.37,-22497.25 499.37,-22435.88 499.37,-22435.88"/>
<polygon fill="black" stroke="black" points="502.87,-22435.88 499.37,-22425.88 495.87,-22435.88 502.87,-22435.88"/>
</g>
<!-- lay5_mlp_act&#45;&gt;lay5_mlp_mul -->
<g id="edge103" class="edge">
<title>lay5_mlp_act&#45;&gt;lay5_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-22497.25C308.37,-22497.25 308.37,-22435.88 308.37,-22435.88"/>
<polygon fill="black" stroke="black" points="311.87,-22435.88 308.37,-22425.88 304.87,-22435.88 311.87,-22435.88"/>
</g>
<!-- lay5_mlp_down -->
<g id="node88" class="node">
<title>lay5_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-22285.5 320.37,-22285.5 320.37,-22217.5 523.37,-22217.5 523.37,-22285.5"/>
<text text-anchor="middle" x="421.87" y="-22270.3" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-22255.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-22240.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-22225.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_mlp_mul&#45;&gt;lay5_mlp_down -->
<g id="edge104" class="edge">
<title>lay5_mlp_mul&#45;&gt;lay5_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-22357.25C421.87,-22357.25 421.87,-22295.88 421.87,-22295.88"/>
<polygon fill="black" stroke="black" points="425.37,-22295.88 421.87,-22285.88 418.37,-22295.88 425.37,-22295.88"/>
</g>
<!-- lay5_mlp_down&#45;&gt;lay5_res2 -->
<g id="edge105" class="edge">
<title>lay5_mlp_down&#45;&gt;lay5_res2</title>
<path fill="none" stroke="black" d="M421.87,-22217.3C421.87,-22217.3 421.87,-22155.54 421.87,-22155.54"/>
<polygon fill="black" stroke="black" points="425.37,-22155.54 421.87,-22145.54 418.37,-22155.54 425.37,-22155.54"/>
</g>
<!-- lay5_ln2 -->
<g id="node90" class="node">
<title>lay5_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-21977.33 320.37,-21977.33 320.37,-21909.33 523.37,-21909.33 523.37,-21977.33"/>
<text text-anchor="middle" x="421.87" y="-21962.13" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-21947.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-21932.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-21917.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_res2&#45;&gt;lay5_ln2 -->
<g id="edge107" class="edge">
<title>lay5_res2&#45;&gt;lay5_ln2</title>
<path fill="none" stroke="black" d="M421.87,-22049.08C421.87,-22049.08 421.87,-21987.81 421.87,-21987.81"/>
<polygon fill="black" stroke="black" points="425.37,-21987.81 421.87,-21977.81 418.37,-21987.81 425.37,-21987.81"/>
</g>
<!-- layer5_output -->
<g id="node91" class="node">
<title>layer5_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-21837.33 341.11,-21837.33 285.17,-21701.33 502.63,-21701.33 558.57,-21837.33"/>
<text text-anchor="middle" x="421.87" y="-21788.13" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-21773.13" font-family="Times,serif" font-size="14.00">To: GPU 6</text>
<text text-anchor="middle" x="421.87" y="-21758.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-21743.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- lay5_ln2&#45;&gt;layer5_output -->
<g id="edge108" class="edge">
<title>lay5_ln2&#45;&gt;layer5_output</title>
<path fill="none" stroke="black" d="M421.87,-21908.95C421.87,-21908.95 421.87,-21847.47 421.87,-21847.47"/>
<polygon fill="black" stroke="black" points="425.37,-21847.47 421.87,-21837.47 418.37,-21847.47 425.37,-21847.47"/>
</g>
<!-- layer6_input -->
<g id="node92" class="node">
<title>layer6_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-21629.33 348.42,-21629.33 297.55,-21493.33 495.32,-21493.33 546.19,-21629.33"/>
<text text-anchor="middle" x="421.87" y="-21580.13" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-21565.13" font-family="Times,serif" font-size="14.00">From: GPU 5</text>
<text text-anchor="middle" x="421.87" y="-21550.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-21535.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer5_output&#45;&gt;layer6_input -->
<g id="edge109" class="edge">
<title>layer5_output&#45;&gt;layer6_input</title>
<path fill="none" stroke="black" d="M421.87,-21701.22C421.87,-21701.22 421.87,-21639.59 421.87,-21639.59"/>
<polygon fill="black" stroke="black" points="425.37,-21639.59 421.87,-21629.59 418.37,-21639.59 425.37,-21639.59"/>
</g>
<!-- lay6_qkv_proj -->
<g id="node93" class="node">
<title>lay6_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="504.37,-21421.33 287.37,-21421.33 287.37,-21353.33 504.37,-21353.33 504.37,-21421.33"/>
<text text-anchor="middle" x="395.87" y="-21406.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="395.87" y="-21391.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="395.87" y="-21376.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="395.87" y="-21361.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_input&#45;&gt;lay6_qkv_proj -->
<g id="edge110" class="edge">
<title>layer6_input&#45;&gt;lay6_qkv_proj</title>
<path fill="none" stroke="black" d="M400.91,-21493.06C400.91,-21493.06 400.91,-21431.44 400.91,-21431.44"/>
<polygon fill="black" stroke="black" points="404.41,-21431.44 400.91,-21421.44 397.41,-21431.44 404.41,-21431.44"/>
</g>
<!-- lay6_res1 -->
<g id="node97" class="node">
<title>lay6_res1</title>
<ellipse fill="lightgray" stroke="black" cx="430.87" cy="-20813.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="430.87" y="-20832.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="430.87" y="-20817.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-20802.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-20787.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_input&#45;&gt;lay6_res1 -->
<g id="edge115" class="edge">
<title>layer6_input&#45;&gt;lay6_res1</title>
<path fill="none" stroke="black" d="M542.32,-21561.19C542.32,-21561.19 542.32,-20865.52 542.32,-20865.52"/>
<polygon fill="black" stroke="black" points="545.82,-20865.52 542.32,-20855.52 538.82,-20865.52 545.82,-20865.52"/>
</g>
<!-- lay6_attn_score -->
<g id="node94" class="node">
<title>lay6_attn_score</title>
<polygon fill="lightpink" stroke="black" points="538.37,-21281.33 183.37,-21281.33 183.37,-21213.33 538.37,-21213.33 538.37,-21281.33"/>
<text text-anchor="middle" x="360.87" y="-21266.13" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="360.87" y="-21251.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="360.87" y="-21236.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="360.87" y="-21221.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_qkv_proj&#45;&gt;lay6_attn_score -->
<g id="edge111" class="edge">
<title>lay6_qkv_proj&#45;&gt;lay6_attn_score</title>
<path fill="none" stroke="black" d="M395.87,-21353.08C395.87,-21353.08 395.87,-21291.71 395.87,-21291.71"/>
<polygon fill="black" stroke="black" points="399.37,-21291.71 395.87,-21281.71 392.37,-21291.71 399.37,-21291.71"/>
</g>
<!-- lay6_attn_concat -->
<g id="node95" class="node">
<title>lay6_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="481.37,-21141.33 276.37,-21141.33 276.37,-21073.33 481.37,-21073.33 481.37,-21141.33"/>
<text text-anchor="middle" x="378.87" y="-21126.13" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="378.87" y="-21111.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="378.87" y="-21096.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="378.87" y="-21081.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_attn_score&#45;&gt;lay6_attn_concat -->
<g id="edge112" class="edge">
<title>lay6_attn_score&#45;&gt;lay6_attn_concat</title>
<path fill="none" stroke="black" d="M378.87,-21213.08C378.87,-21213.08 378.87,-21151.71 378.87,-21151.71"/>
<polygon fill="black" stroke="black" points="382.37,-21151.71 378.87,-21141.71 375.37,-21151.71 382.37,-21151.71"/>
</g>
<!-- lay6_attn_out -->
<g id="node96" class="node">
<title>lay6_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="521.37,-21001.33 306.37,-21001.33 306.37,-20933.33 521.37,-20933.33 521.37,-21001.33"/>
<text text-anchor="middle" x="413.87" y="-20986.13" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="413.87" y="-20971.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="413.87" y="-20956.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="413.87" y="-20941.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_attn_concat&#45;&gt;lay6_attn_out -->
<g id="edge113" class="edge">
<title>lay6_attn_concat&#45;&gt;lay6_attn_out</title>
<path fill="none" stroke="black" d="M393.87,-21073.08C393.87,-21073.08 393.87,-21011.71 393.87,-21011.71"/>
<polygon fill="black" stroke="black" points="397.37,-21011.71 393.87,-21001.71 390.37,-21011.71 397.37,-21011.71"/>
</g>
<!-- lay6_attn_out&#45;&gt;lay6_res1 -->
<g id="edge114" class="edge">
<title>lay6_attn_out&#45;&gt;lay6_res1</title>
<path fill="none" stroke="black" d="M413.87,-20933.13C413.87,-20933.13 413.87,-20871.37 413.87,-20871.37"/>
<polygon fill="black" stroke="black" points="417.37,-20871.37 413.87,-20861.37 410.37,-20871.37 417.37,-20871.37"/>
</g>
<!-- lay6_ln1 -->
<g id="node98" class="node">
<title>lay6_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="563.37,-20693.16 360.37,-20693.16 360.37,-20625.16 563.37,-20625.16 563.37,-20693.16"/>
<text text-anchor="middle" x="461.87" y="-20677.96" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="461.87" y="-20662.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="461.87" y="-20647.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="461.87" y="-20632.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_res1&#45;&gt;lay6_ln1 -->
<g id="edge116" class="edge">
<title>lay6_res1&#45;&gt;lay6_ln1</title>
<path fill="none" stroke="black" d="M461.87,-20765.34C461.87,-20765.34 461.87,-20703.35 461.87,-20703.35"/>
<polygon fill="black" stroke="black" points="465.37,-20703.35 461.87,-20693.35 458.37,-20703.35 465.37,-20703.35"/>
</g>
<!-- lay6_mlp_gate -->
<g id="node99" class="node">
<title>lay6_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="403.87,-20553.16 191.87,-20553.16 191.87,-20485.16 403.87,-20485.16 403.87,-20553.16"/>
<text text-anchor="middle" x="297.87" y="-20537.96" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="297.87" y="-20522.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="297.87" y="-20507.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="297.87" y="-20492.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_ln1&#45;&gt;lay6_mlp_gate -->
<g id="edge117" class="edge">
<title>lay6_ln1&#45;&gt;lay6_mlp_gate</title>
<path fill="none" stroke="black" d="M382.12,-20624.92C382.12,-20624.92 382.12,-20563.54 382.12,-20563.54"/>
<polygon fill="black" stroke="black" points="385.62,-20563.54 382.12,-20553.54 378.62,-20563.54 385.62,-20563.54"/>
</g>
<!-- lay6_mlp_up -->
<g id="node100" class="node">
<title>lay6_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="624.87,-20413.16 412.87,-20413.16 412.87,-20345.16 624.87,-20345.16 624.87,-20413.16"/>
<text text-anchor="middle" x="518.87" y="-20397.96" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="518.87" y="-20382.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="518.87" y="-20367.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="518.87" y="-20352.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_ln1&#45;&gt;lay6_mlp_up -->
<g id="edge118" class="edge">
<title>lay6_ln1&#45;&gt;lay6_mlp_up</title>
<path fill="none" stroke="black" d="M488.12,-20625.11C488.12,-20625.11 488.12,-20423.42 488.12,-20423.42"/>
<polygon fill="black" stroke="black" points="491.62,-20423.42 488.12,-20413.42 484.62,-20423.42 491.62,-20423.42"/>
</g>
<!-- lay6_res2 -->
<g id="node104" class="node">
<title>lay6_res2</title>
<ellipse fill="lightgray" stroke="black" cx="430.87" cy="-19945.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="430.87" y="-19963.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="430.87" y="-19948.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-19933.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-19918.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_ln1&#45;&gt;lay6_res2 -->
<g id="edge124" class="edge">
<title>lay6_ln1&#45;&gt;lay6_res2</title>
<path fill="none" stroke="black" d="M563.49,-20659C605.17,-20659 643.84,-20659 643.84,-20659 643.84,-20659 643.84,-19974.18 643.84,-19974.18"/>
<polygon fill="black" stroke="black" points="647.34,-19974.18 643.84,-19964.18 640.34,-19974.18 647.34,-19974.18"/>
</g>
<!-- lay6_mlp_act -->
<g id="node101" class="node">
<title>lay6_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="376.87,-20413.16 164.87,-20413.16 164.87,-20345.16 376.87,-20345.16 376.87,-20413.16"/>
<text text-anchor="middle" x="270.87" y="-20397.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="270.87" y="-20382.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="270.87" y="-20367.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="270.87" y="-20352.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_mlp_gate&#45;&gt;lay6_mlp_act -->
<g id="edge119" class="edge">
<title>lay6_mlp_gate&#45;&gt;lay6_mlp_act</title>
<path fill="none" stroke="black" d="M284.37,-20484.92C284.37,-20484.92 284.37,-20423.54 284.37,-20423.54"/>
<polygon fill="black" stroke="black" points="287.87,-20423.54 284.37,-20413.54 280.87,-20423.54 287.87,-20423.54"/>
</g>
<!-- lay6_mlp_mul -->
<g id="node102" class="node">
<title>lay6_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="603.87,-20273.16 257.87,-20273.16 257.87,-20205.16 603.87,-20205.16 603.87,-20273.16"/>
<text text-anchor="middle" x="430.87" y="-20257.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="430.87" y="-20242.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="430.87" y="-20227.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="430.87" y="-20212.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_mlp_up&#45;&gt;lay6_mlp_mul -->
<g id="edge120" class="edge">
<title>lay6_mlp_up&#45;&gt;lay6_mlp_mul</title>
<path fill="none" stroke="black" d="M508.37,-20344.92C508.37,-20344.92 508.37,-20283.54 508.37,-20283.54"/>
<polygon fill="black" stroke="black" points="511.87,-20283.54 508.37,-20273.54 504.87,-20283.54 511.87,-20283.54"/>
</g>
<!-- lay6_mlp_act&#45;&gt;lay6_mlp_mul -->
<g id="edge121" class="edge">
<title>lay6_mlp_act&#45;&gt;lay6_mlp_mul</title>
<path fill="none" stroke="black" d="M317.37,-20344.92C317.37,-20344.92 317.37,-20283.54 317.37,-20283.54"/>
<polygon fill="black" stroke="black" points="320.87,-20283.54 317.37,-20273.54 313.87,-20283.54 320.87,-20283.54"/>
</g>
<!-- lay6_mlp_down -->
<g id="node103" class="node">
<title>lay6_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="532.37,-20133.16 329.37,-20133.16 329.37,-20065.16 532.37,-20065.16 532.37,-20133.16"/>
<text text-anchor="middle" x="430.87" y="-20117.96" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="430.87" y="-20102.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="430.87" y="-20087.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-20072.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_mlp_mul&#45;&gt;lay6_mlp_down -->
<g id="edge122" class="edge">
<title>lay6_mlp_mul&#45;&gt;lay6_mlp_down</title>
<path fill="none" stroke="black" d="M430.87,-20204.92C430.87,-20204.92 430.87,-20143.54 430.87,-20143.54"/>
<polygon fill="black" stroke="black" points="434.37,-20143.54 430.87,-20133.54 427.37,-20143.54 434.37,-20143.54"/>
</g>
<!-- lay6_mlp_down&#45;&gt;lay6_res2 -->
<g id="edge123" class="edge">
<title>lay6_mlp_down&#45;&gt;lay6_res2</title>
<path fill="none" stroke="black" d="M430.87,-20064.97C430.87,-20064.97 430.87,-20003.21 430.87,-20003.21"/>
<polygon fill="black" stroke="black" points="434.37,-20003.21 430.87,-19993.21 427.37,-20003.21 434.37,-20003.21"/>
</g>
<!-- lay6_ln2 -->
<g id="node105" class="node">
<title>lay6_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="532.37,-19825 329.37,-19825 329.37,-19757 532.37,-19757 532.37,-19825"/>
<text text-anchor="middle" x="430.87" y="-19809.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="430.87" y="-19794.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-19779.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="430.87" y="-19764.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_res2&#45;&gt;lay6_ln2 -->
<g id="edge125" class="edge">
<title>lay6_res2&#45;&gt;lay6_ln2</title>
<path fill="none" stroke="black" d="M430.87,-19896.75C430.87,-19896.75 430.87,-19835.48 430.87,-19835.48"/>
<polygon fill="black" stroke="black" points="434.37,-19835.48 430.87,-19825.48 427.37,-19835.48 434.37,-19835.48"/>
</g>
<!-- layer6_output -->
<g id="node106" class="node">
<title>layer6_output</title>
<polygon fill="lightyellow" stroke="black" points="567.57,-19685 350.11,-19685 294.17,-19549 511.63,-19549 567.57,-19685"/>
<text text-anchor="middle" x="430.87" y="-19635.8" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="430.87" y="-19620.8" font-family="Times,serif" font-size="14.00">To: GPU 7</text>
<text text-anchor="middle" x="430.87" y="-19605.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="430.87" y="-19590.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- lay6_ln2&#45;&gt;layer6_output -->
<g id="edge126" class="edge">
<title>lay6_ln2&#45;&gt;layer6_output</title>
<path fill="none" stroke="black" d="M430.87,-19756.62C430.87,-19756.62 430.87,-19695.14 430.87,-19695.14"/>
<polygon fill="black" stroke="black" points="434.37,-19695.14 430.87,-19685.14 427.37,-19695.14 434.37,-19695.14"/>
</g>
<!-- layer7_input -->
<g id="node107" class="node">
<title>layer7_input</title>
<polygon fill="lightyellow" stroke="black" points="555.19,-19477 357.42,-19477 306.55,-19341 504.32,-19341 555.19,-19477"/>
<text text-anchor="middle" x="430.87" y="-19427.8" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="430.87" y="-19412.8" font-family="Times,serif" font-size="14.00">From: GPU 6</text>
<text text-anchor="middle" x="430.87" y="-19397.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="430.87" y="-19382.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer6_output&#45;&gt;layer7_input -->
<g id="edge127" class="edge">
<title>layer6_output&#45;&gt;layer7_input</title>
<path fill="none" stroke="black" d="M430.87,-19548.89C430.87,-19548.89 430.87,-19487.26 430.87,-19487.26"/>
<polygon fill="black" stroke="black" points="434.37,-19487.26 430.87,-19477.26 427.37,-19487.26 434.37,-19487.26"/>
</g>
<!-- lay7_qkv_proj -->
<g id="node108" class="node">
<title>lay7_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="495.37,-19269 278.37,-19269 278.37,-19201 495.37,-19201 495.37,-19269"/>
<text text-anchor="middle" x="386.87" y="-19253.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="386.87" y="-19238.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="386.87" y="-19223.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-19208.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_input&#45;&gt;lay7_qkv_proj -->
<g id="edge128" class="edge">
<title>layer7_input&#45;&gt;lay7_qkv_proj</title>
<path fill="none" stroke="black" d="M400.91,-19340.73C400.91,-19340.73 400.91,-19279.11 400.91,-19279.11"/>
<polygon fill="black" stroke="black" points="404.41,-19279.11 400.91,-19269.11 397.41,-19279.11 404.41,-19279.11"/>
</g>
<!-- lay7_res1 -->
<g id="node112" class="node">
<title>lay7_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-18660.91" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-18679.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-18664.71" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-18649.71" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-18634.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_input&#45;&gt;lay7_res1 -->
<g id="edge133" class="edge">
<title>layer7_input&#45;&gt;lay7_res1</title>
<path fill="none" stroke="black" d="M542.32,-19408.86C542.32,-19408.86 542.32,-18712.12 542.32,-18712.12"/>
<polygon fill="black" stroke="black" points="545.82,-18712.12 542.32,-18702.12 538.82,-18712.12 545.82,-18712.12"/>
</g>
<!-- lay7_attn_score -->
<g id="node109" class="node">
<title>lay7_attn_score</title>
<polygon fill="lightpink" stroke="black" points="529.37,-19129 174.37,-19129 174.37,-19061 529.37,-19061 529.37,-19129"/>
<text text-anchor="middle" x="351.87" y="-19113.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="351.87" y="-19098.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="351.87" y="-19083.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="351.87" y="-19068.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_qkv_proj&#45;&gt;lay7_attn_score -->
<g id="edge129" class="edge">
<title>lay7_qkv_proj&#45;&gt;lay7_attn_score</title>
<path fill="none" stroke="black" d="M386.87,-19200.75C386.87,-19200.75 386.87,-19139.38 386.87,-19139.38"/>
<polygon fill="black" stroke="black" points="390.37,-19139.38 386.87,-19129.38 383.37,-19139.38 390.37,-19139.38"/>
</g>
<!-- lay7_attn_concat -->
<g id="node110" class="node">
<title>lay7_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="472.37,-18989 267.37,-18989 267.37,-18921 472.37,-18921 472.37,-18989"/>
<text text-anchor="middle" x="369.87" y="-18973.8" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="369.87" y="-18958.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="369.87" y="-18943.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="369.87" y="-18928.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_attn_score&#45;&gt;lay7_attn_concat -->
<g id="edge130" class="edge">
<title>lay7_attn_score&#45;&gt;lay7_attn_concat</title>
<path fill="none" stroke="black" d="M369.87,-19060.75C369.87,-19060.75 369.87,-18999.38 369.87,-18999.38"/>
<polygon fill="black" stroke="black" points="373.37,-18999.38 369.87,-18989.38 366.37,-18999.38 373.37,-18999.38"/>
</g>
<!-- lay7_attn_out -->
<g id="node111" class="node">
<title>lay7_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="512.37,-18849 297.37,-18849 297.37,-18781 512.37,-18781 512.37,-18849"/>
<text text-anchor="middle" x="404.87" y="-18833.8" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="404.87" y="-18818.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-18803.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-18788.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_attn_concat&#45;&gt;lay7_attn_out -->
<g id="edge131" class="edge">
<title>lay7_attn_concat&#45;&gt;lay7_attn_out</title>
<path fill="none" stroke="black" d="M384.87,-18920.75C384.87,-18920.75 384.87,-18859.38 384.87,-18859.38"/>
<polygon fill="black" stroke="black" points="388.37,-18859.38 384.87,-18849.38 381.37,-18859.38 388.37,-18859.38"/>
</g>
<!-- lay7_attn_out&#45;&gt;lay7_res1 -->
<g id="edge132" class="edge">
<title>lay7_attn_out&#45;&gt;lay7_res1</title>
<path fill="none" stroke="black" d="M404.87,-18780.8C404.87,-18780.8 404.87,-18719.04 404.87,-18719.04"/>
<polygon fill="black" stroke="black" points="408.37,-18719.04 404.87,-18709.04 401.37,-18719.04 408.37,-18719.04"/>
</g>
<!-- lay7_ln1 -->
<g id="node113" class="node">
<title>lay7_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-18540.83 351.37,-18540.83 351.37,-18472.83 554.37,-18472.83 554.37,-18540.83"/>
<text text-anchor="middle" x="452.87" y="-18525.63" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-18510.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-18495.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-18480.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_res1&#45;&gt;lay7_ln1 -->
<g id="edge134" class="edge">
<title>lay7_res1&#45;&gt;lay7_ln1</title>
<path fill="none" stroke="black" d="M452.87,-18613.01C452.87,-18613.01 452.87,-18551.01 452.87,-18551.01"/>
<polygon fill="black" stroke="black" points="456.37,-18551.01 452.87,-18541.01 449.37,-18551.02 456.37,-18551.01"/>
</g>
<!-- lay7_mlp_gate -->
<g id="node114" class="node">
<title>lay7_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-18400.83 182.87,-18400.83 182.87,-18332.83 394.87,-18332.83 394.87,-18400.83"/>
<text text-anchor="middle" x="288.87" y="-18385.63" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-18370.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-18355.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-18340.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_ln1&#45;&gt;lay7_mlp_gate -->
<g id="edge135" class="edge">
<title>lay7_ln1&#45;&gt;lay7_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-18472.58C373.12,-18472.58 373.12,-18411.21 373.12,-18411.21"/>
<polygon fill="black" stroke="black" points="376.62,-18411.21 373.12,-18401.21 369.62,-18411.21 376.62,-18411.21"/>
</g>
<!-- lay7_mlp_up -->
<g id="node115" class="node">
<title>lay7_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-18260.83 403.87,-18260.83 403.87,-18192.83 615.87,-18192.83 615.87,-18260.83"/>
<text text-anchor="middle" x="509.87" y="-18245.63" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-18230.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-18215.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-18200.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_ln1&#45;&gt;lay7_mlp_up -->
<g id="edge136" class="edge">
<title>lay7_ln1&#45;&gt;lay7_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-18472.78C479.12,-18472.78 479.12,-18271.09 479.12,-18271.09"/>
<polygon fill="black" stroke="black" points="482.62,-18271.08 479.12,-18261.09 475.62,-18271.09 482.62,-18271.08"/>
</g>
<!-- lay7_res2 -->
<g id="node119" class="node">
<title>lay7_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-17792.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-17811.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-17796.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-17781.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-17766.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_ln1&#45;&gt;lay7_res2 -->
<g id="edge142" class="edge">
<title>lay7_ln1&#45;&gt;lay7_res2</title>
<path fill="none" stroke="black" d="M554.49,-18506C596.17,-18506 634.84,-18506 634.84,-18506 634.84,-18506 634.84,-17821.83 634.84,-17821.83"/>
<polygon fill="black" stroke="black" points="638.34,-17821.83 634.84,-17811.83 631.34,-17821.83 638.34,-17821.83"/>
</g>
<!-- lay7_mlp_act -->
<g id="node116" class="node">
<title>lay7_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-18260.83 155.87,-18260.83 155.87,-18192.83 367.87,-18192.83 367.87,-18260.83"/>
<text text-anchor="middle" x="261.87" y="-18245.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-18230.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-18215.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-18200.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_mlp_gate&#45;&gt;lay7_mlp_act -->
<g id="edge137" class="edge">
<title>lay7_mlp_gate&#45;&gt;lay7_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-18332.58C275.37,-18332.58 275.37,-18271.21 275.37,-18271.21"/>
<polygon fill="black" stroke="black" points="278.87,-18271.21 275.37,-18261.21 271.87,-18271.21 278.87,-18271.21"/>
</g>
<!-- lay7_mlp_mul -->
<g id="node117" class="node">
<title>lay7_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-18120.83 248.87,-18120.83 248.87,-18052.83 594.87,-18052.83 594.87,-18120.83"/>
<text text-anchor="middle" x="421.87" y="-18105.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-18090.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-18075.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-18060.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_mlp_up&#45;&gt;lay7_mlp_mul -->
<g id="edge138" class="edge">
<title>lay7_mlp_up&#45;&gt;lay7_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-18192.58C499.37,-18192.58 499.37,-18131.21 499.37,-18131.21"/>
<polygon fill="black" stroke="black" points="502.87,-18131.21 499.37,-18121.21 495.87,-18131.21 502.87,-18131.21"/>
</g>
<!-- lay7_mlp_act&#45;&gt;lay7_mlp_mul -->
<g id="edge139" class="edge">
<title>lay7_mlp_act&#45;&gt;lay7_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-18192.58C308.37,-18192.58 308.37,-18131.21 308.37,-18131.21"/>
<polygon fill="black" stroke="black" points="311.87,-18131.21 308.37,-18121.21 304.87,-18131.21 311.87,-18131.21"/>
</g>
<!-- lay7_mlp_down -->
<g id="node118" class="node">
<title>lay7_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-17980.83 320.37,-17980.83 320.37,-17912.83 523.37,-17912.83 523.37,-17980.83"/>
<text text-anchor="middle" x="421.87" y="-17965.63" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-17950.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-17935.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-17920.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_mlp_mul&#45;&gt;lay7_mlp_down -->
<g id="edge140" class="edge">
<title>lay7_mlp_mul&#45;&gt;lay7_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-18052.58C421.87,-18052.58 421.87,-17991.21 421.87,-17991.21"/>
<polygon fill="black" stroke="black" points="425.37,-17991.21 421.87,-17981.21 418.37,-17991.21 425.37,-17991.21"/>
</g>
<!-- lay7_mlp_down&#45;&gt;lay7_res2 -->
<g id="edge141" class="edge">
<title>lay7_mlp_down&#45;&gt;lay7_res2</title>
<path fill="none" stroke="black" d="M421.87,-17912.63C421.87,-17912.63 421.87,-17850.87 421.87,-17850.87"/>
<polygon fill="black" stroke="black" points="425.37,-17850.87 421.87,-17840.87 418.37,-17850.87 425.37,-17850.87"/>
</g>
<!-- lay7_ln2 -->
<g id="node120" class="node">
<title>lay7_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-17672.66 320.37,-17672.66 320.37,-17604.66 523.37,-17604.66 523.37,-17672.66"/>
<text text-anchor="middle" x="421.87" y="-17657.46" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-17642.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-17627.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-17612.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_res2&#45;&gt;lay7_ln2 -->
<g id="edge143" class="edge">
<title>lay7_res2&#45;&gt;lay7_ln2</title>
<path fill="none" stroke="black" d="M421.87,-17744.42C421.87,-17744.42 421.87,-17683.14 421.87,-17683.14"/>
<polygon fill="black" stroke="black" points="425.37,-17683.14 421.87,-17673.14 418.37,-17683.14 425.37,-17683.14"/>
</g>
<!-- layer7_output -->
<g id="node121" class="node">
<title>layer7_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-17532.66 341.11,-17532.66 285.17,-17396.66 502.63,-17396.66 558.57,-17532.66"/>
<text text-anchor="middle" x="421.87" y="-17483.46" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-17468.46" font-family="Times,serif" font-size="14.00">To: GPU 8</text>
<text text-anchor="middle" x="421.87" y="-17453.46" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-17438.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- lay7_ln2&#45;&gt;layer7_output -->
<g id="edge144" class="edge">
<title>lay7_ln2&#45;&gt;layer7_output</title>
<path fill="none" stroke="black" d="M421.87,-17604.29C421.87,-17604.29 421.87,-17542.81 421.87,-17542.81"/>
<polygon fill="black" stroke="black" points="425.37,-17542.81 421.87,-17532.81 418.37,-17542.81 425.37,-17542.81"/>
</g>
<!-- layer8_input -->
<g id="node122" class="node">
<title>layer8_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-17324.66 348.42,-17324.66 297.55,-17188.66 495.32,-17188.66 546.19,-17324.66"/>
<text text-anchor="middle" x="421.87" y="-17275.46" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-17260.46" font-family="Times,serif" font-size="14.00">From: GPU 7</text>
<text text-anchor="middle" x="421.87" y="-17245.46" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-17230.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer7_output&#45;&gt;layer8_input -->
<g id="edge145" class="edge">
<title>layer7_output&#45;&gt;layer8_input</title>
<path fill="none" stroke="black" d="M421.87,-17396.56C421.87,-17396.56 421.87,-17334.92 421.87,-17334.92"/>
<polygon fill="black" stroke="black" points="425.37,-17334.92 421.87,-17324.92 418.37,-17334.92 425.37,-17334.92"/>
</g>
<!-- lay8_qkv_proj -->
<g id="node123" class="node">
<title>lay8_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="522.37,-17116.66 305.37,-17116.66 305.37,-17048.66 522.37,-17048.66 522.37,-17116.66"/>
<text text-anchor="middle" x="413.87" y="-17101.46" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="413.87" y="-17086.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="413.87" y="-17071.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="413.87" y="-17056.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_input&#45;&gt;lay8_qkv_proj -->
<g id="edge146" class="edge">
<title>layer8_input&#45;&gt;lay8_qkv_proj</title>
<path fill="none" stroke="black" d="M413.87,-17188.39C413.87,-17188.39 413.87,-17126.77 413.87,-17126.77"/>
<polygon fill="black" stroke="black" points="417.37,-17126.77 413.87,-17116.77 410.37,-17126.77 417.37,-17126.77"/>
</g>
<!-- lay8_res1 -->
<g id="node127" class="node">
<title>lay8_res1</title>
<ellipse fill="lightgray" stroke="black" cx="443.87" cy="-16508.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="443.87" y="-16527.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="443.87" y="-16512.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-16497.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-16482.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_input&#45;&gt;lay8_res1 -->
<g id="edge151" class="edge">
<title>layer8_input&#45;&gt;lay8_res1</title>
<path fill="none" stroke="black" d="M520.54,-17256C564.38,-17256 606.26,-17256 606.26,-17256 606.26,-17256 606.26,-16553.13 606.26,-16553.13"/>
<polygon fill="black" stroke="black" points="609.76,-16553.13 606.26,-16543.13 602.76,-16553.13 609.76,-16553.13"/>
</g>
<!-- lay8_attn_score -->
<g id="node124" class="node">
<title>lay8_attn_score</title>
<polygon fill="lightpink" stroke="black" points="556.37,-16976.66 201.37,-16976.66 201.37,-16908.66 556.37,-16908.66 556.37,-16976.66"/>
<text text-anchor="middle" x="378.87" y="-16961.46" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="378.87" y="-16946.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="378.87" y="-16931.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="378.87" y="-16916.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_qkv_proj&#45;&gt;lay8_attn_score -->
<g id="edge147" class="edge">
<title>lay8_qkv_proj&#45;&gt;lay8_attn_score</title>
<path fill="none" stroke="black" d="M413.87,-17048.42C413.87,-17048.42 413.87,-16987.04 413.87,-16987.04"/>
<polygon fill="black" stroke="black" points="417.37,-16987.04 413.87,-16977.04 410.37,-16987.04 417.37,-16987.04"/>
</g>
<!-- lay8_attn_concat -->
<g id="node125" class="node">
<title>lay8_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="505.37,-16836.66 300.37,-16836.66 300.37,-16768.66 505.37,-16768.66 505.37,-16836.66"/>
<text text-anchor="middle" x="402.87" y="-16821.46" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="402.87" y="-16806.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="402.87" y="-16791.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="402.87" y="-16776.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_attn_score&#45;&gt;lay8_attn_concat -->
<g id="edge148" class="edge">
<title>lay8_attn_score&#45;&gt;lay8_attn_concat</title>
<path fill="none" stroke="black" d="M402.87,-16908.42C402.87,-16908.42 402.87,-16847.04 402.87,-16847.04"/>
<polygon fill="black" stroke="black" points="406.37,-16847.04 402.87,-16837.04 399.37,-16847.04 406.37,-16847.04"/>
</g>
<!-- lay8_attn_out -->
<g id="node126" class="node">
<title>lay8_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="528.37,-16696.66 313.37,-16696.66 313.37,-16628.66 528.37,-16628.66 528.37,-16696.66"/>
<text text-anchor="middle" x="420.87" y="-16681.46" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="420.87" y="-16666.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="420.87" y="-16651.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="420.87" y="-16636.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_attn_concat&#45;&gt;lay8_attn_out -->
<g id="edge149" class="edge">
<title>lay8_attn_concat&#45;&gt;lay8_attn_out</title>
<path fill="none" stroke="black" d="M409.37,-16768.42C409.37,-16768.42 409.37,-16707.04 409.37,-16707.04"/>
<polygon fill="black" stroke="black" points="412.87,-16707.04 409.37,-16697.04 405.87,-16707.04 412.87,-16707.04"/>
</g>
<!-- lay8_attn_out&#45;&gt;lay8_res1 -->
<g id="edge150" class="edge">
<title>lay8_attn_out&#45;&gt;lay8_res1</title>
<path fill="none" stroke="black" d="M420.87,-16628.47C420.87,-16628.47 420.87,-16566.71 420.87,-16566.71"/>
<polygon fill="black" stroke="black" points="424.37,-16566.71 420.87,-16556.71 417.37,-16566.71 424.37,-16566.71"/>
</g>
<!-- lay8_ln1 -->
<g id="node128" class="node">
<title>lay8_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="576.37,-16388.5 373.37,-16388.5 373.37,-16320.5 576.37,-16320.5 576.37,-16388.5"/>
<text text-anchor="middle" x="474.87" y="-16373.3" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="474.87" y="-16358.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="474.87" y="-16343.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="474.87" y="-16328.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_res1&#45;&gt;lay8_ln1 -->
<g id="edge152" class="edge">
<title>lay8_res1&#45;&gt;lay8_ln1</title>
<path fill="none" stroke="black" d="M474.87,-16460.67C474.87,-16460.67 474.87,-16398.68 474.87,-16398.68"/>
<polygon fill="black" stroke="black" points="478.37,-16398.68 474.87,-16388.68 471.37,-16398.68 478.37,-16398.68"/>
</g>
<!-- lay8_mlp_gate -->
<g id="node129" class="node">
<title>lay8_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="416.87,-16248.5 204.87,-16248.5 204.87,-16180.5 416.87,-16180.5 416.87,-16248.5"/>
<text text-anchor="middle" x="310.87" y="-16233.3" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="310.87" y="-16218.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="310.87" y="-16203.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="310.87" y="-16188.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_ln1&#45;&gt;lay8_mlp_gate -->
<g id="edge153" class="edge">
<title>lay8_ln1&#45;&gt;lay8_mlp_gate</title>
<path fill="none" stroke="black" d="M395.12,-16320.25C395.12,-16320.25 395.12,-16258.88 395.12,-16258.88"/>
<polygon fill="black" stroke="black" points="398.62,-16258.88 395.12,-16248.88 391.62,-16258.88 398.62,-16258.88"/>
</g>
<!-- lay8_mlp_up -->
<g id="node130" class="node">
<title>lay8_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="637.87,-16108.5 425.87,-16108.5 425.87,-16040.5 637.87,-16040.5 637.87,-16108.5"/>
<text text-anchor="middle" x="531.87" y="-16093.3" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="531.87" y="-16078.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="531.87" y="-16063.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="531.87" y="-16048.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_ln1&#45;&gt;lay8_mlp_up -->
<g id="edge154" class="edge">
<title>lay8_ln1&#45;&gt;lay8_mlp_up</title>
<path fill="none" stroke="black" d="M501.12,-16320.44C501.12,-16320.44 501.12,-16118.75 501.12,-16118.75"/>
<polygon fill="black" stroke="black" points="504.62,-16118.75 501.12,-16108.75 497.62,-16118.75 504.62,-16118.75"/>
</g>
<!-- lay8_res2 -->
<g id="node134" class="node">
<title>lay8_res2</title>
<ellipse fill="lightgray" stroke="black" cx="443.87" cy="-15640.41" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="443.87" y="-15659.21" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="443.87" y="-15644.21" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-15629.21" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-15614.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_ln1&#45;&gt;lay8_res2 -->
<g id="edge160" class="edge">
<title>lay8_ln1&#45;&gt;lay8_res2</title>
<path fill="none" stroke="black" d="M576.49,-16354C618.17,-16354 656.84,-16354 656.84,-16354 656.84,-16354 656.84,-15669.5 656.84,-15669.5"/>
<polygon fill="black" stroke="black" points="660.34,-15669.5 656.84,-15659.5 653.34,-15669.5 660.34,-15669.5"/>
</g>
<!-- lay8_mlp_act -->
<g id="node131" class="node">
<title>lay8_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="389.87,-16108.5 177.87,-16108.5 177.87,-16040.5 389.87,-16040.5 389.87,-16108.5"/>
<text text-anchor="middle" x="283.87" y="-16093.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="283.87" y="-16078.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="283.87" y="-16063.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="283.87" y="-16048.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_mlp_gate&#45;&gt;lay8_mlp_act -->
<g id="edge155" class="edge">
<title>lay8_mlp_gate&#45;&gt;lay8_mlp_act</title>
<path fill="none" stroke="black" d="M297.37,-16180.25C297.37,-16180.25 297.37,-16118.88 297.37,-16118.88"/>
<polygon fill="black" stroke="black" points="300.87,-16118.88 297.37,-16108.88 293.87,-16118.88 300.87,-16118.88"/>
</g>
<!-- lay8_mlp_mul -->
<g id="node132" class="node">
<title>lay8_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="616.87,-15968.5 270.87,-15968.5 270.87,-15900.5 616.87,-15900.5 616.87,-15968.5"/>
<text text-anchor="middle" x="443.87" y="-15953.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="443.87" y="-15938.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="443.87" y="-15923.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="443.87" y="-15908.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_mlp_up&#45;&gt;lay8_mlp_mul -->
<g id="edge156" class="edge">
<title>lay8_mlp_up&#45;&gt;lay8_mlp_mul</title>
<path fill="none" stroke="black" d="M521.37,-16040.25C521.37,-16040.25 521.37,-15978.88 521.37,-15978.88"/>
<polygon fill="black" stroke="black" points="524.87,-15978.88 521.37,-15968.88 517.87,-15978.88 524.87,-15978.88"/>
</g>
<!-- lay8_mlp_act&#45;&gt;lay8_mlp_mul -->
<g id="edge157" class="edge">
<title>lay8_mlp_act&#45;&gt;lay8_mlp_mul</title>
<path fill="none" stroke="black" d="M330.37,-16040.25C330.37,-16040.25 330.37,-15978.88 330.37,-15978.88"/>
<polygon fill="black" stroke="black" points="333.87,-15978.88 330.37,-15968.88 326.87,-15978.88 333.87,-15978.88"/>
</g>
<!-- lay8_mlp_down -->
<g id="node133" class="node">
<title>lay8_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="545.37,-15828.5 342.37,-15828.5 342.37,-15760.5 545.37,-15760.5 545.37,-15828.5"/>
<text text-anchor="middle" x="443.87" y="-15813.3" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="443.87" y="-15798.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="443.87" y="-15783.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-15768.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_mlp_mul&#45;&gt;lay8_mlp_down -->
<g id="edge158" class="edge">
<title>lay8_mlp_mul&#45;&gt;lay8_mlp_down</title>
<path fill="none" stroke="black" d="M443.87,-15900.25C443.87,-15900.25 443.87,-15838.88 443.87,-15838.88"/>
<polygon fill="black" stroke="black" points="447.37,-15838.88 443.87,-15828.88 440.37,-15838.88 447.37,-15838.88"/>
</g>
<!-- lay8_mlp_down&#45;&gt;lay8_res2 -->
<g id="edge159" class="edge">
<title>lay8_mlp_down&#45;&gt;lay8_res2</title>
<path fill="none" stroke="black" d="M443.87,-15760.3C443.87,-15760.3 443.87,-15698.54 443.87,-15698.54"/>
<polygon fill="black" stroke="black" points="447.37,-15698.54 443.87,-15688.54 440.37,-15698.54 447.37,-15698.54"/>
</g>
<!-- lay8_ln2 -->
<g id="node135" class="node">
<title>lay8_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="545.37,-15520.33 342.37,-15520.33 342.37,-15452.33 545.37,-15452.33 545.37,-15520.33"/>
<text text-anchor="middle" x="443.87" y="-15505.13" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="443.87" y="-15490.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-15475.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="443.87" y="-15460.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_res2&#45;&gt;lay8_ln2 -->
<g id="edge161" class="edge">
<title>lay8_res2&#45;&gt;lay8_ln2</title>
<path fill="none" stroke="black" d="M443.87,-15592.08C443.87,-15592.08 443.87,-15530.81 443.87,-15530.81"/>
<polygon fill="black" stroke="black" points="447.37,-15530.81 443.87,-15520.81 440.37,-15530.81 447.37,-15530.81"/>
</g>
<!-- layer8_output -->
<g id="node136" class="node">
<title>layer8_output</title>
<polygon fill="lightyellow" stroke="black" points="580.57,-15380.33 363.11,-15380.33 307.17,-15244.33 524.63,-15244.33 580.57,-15380.33"/>
<text text-anchor="middle" x="443.87" y="-15331.13" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="443.87" y="-15316.13" font-family="Times,serif" font-size="14.00">To: GPU 9</text>
<text text-anchor="middle" x="443.87" y="-15301.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="443.87" y="-15286.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- lay8_ln2&#45;&gt;layer8_output -->
<g id="edge162" class="edge">
<title>lay8_ln2&#45;&gt;layer8_output</title>
<path fill="none" stroke="black" d="M443.87,-15451.95C443.87,-15451.95 443.87,-15390.47 443.87,-15390.47"/>
<polygon fill="black" stroke="black" points="447.37,-15390.47 443.87,-15380.47 440.37,-15390.47 447.37,-15390.47"/>
</g>
<!-- layer9_input -->
<g id="node137" class="node">
<title>layer9_input</title>
<polygon fill="lightyellow" stroke="black" points="568.19,-15172.33 370.42,-15172.33 319.55,-15036.33 517.32,-15036.33 568.19,-15172.33"/>
<text text-anchor="middle" x="443.87" y="-15123.13" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="443.87" y="-15108.13" font-family="Times,serif" font-size="14.00">From: GPU 8</text>
<text text-anchor="middle" x="443.87" y="-15093.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="443.87" y="-15078.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer8_output&#45;&gt;layer9_input -->
<g id="edge163" class="edge">
<title>layer8_output&#45;&gt;layer9_input</title>
<path fill="none" stroke="black" d="M443.87,-15244.22C443.87,-15244.22 443.87,-15182.59 443.87,-15182.59"/>
<polygon fill="black" stroke="black" points="447.37,-15182.59 443.87,-15172.59 440.37,-15182.59 447.37,-15182.59"/>
</g>
<!-- lay9_qkv_proj -->
<g id="node138" class="node">
<title>lay9_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="508.37,-14964.33 291.37,-14964.33 291.37,-14896.33 508.37,-14896.33 508.37,-14964.33"/>
<text text-anchor="middle" x="399.87" y="-14949.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="399.87" y="-14934.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="399.87" y="-14919.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="399.87" y="-14904.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_input&#45;&gt;lay9_qkv_proj -->
<g id="edge164" class="edge">
<title>layer9_input&#45;&gt;lay9_qkv_proj</title>
<path fill="none" stroke="black" d="M413.91,-15036.06C413.91,-15036.06 413.91,-14974.44 413.91,-14974.44"/>
<polygon fill="black" stroke="black" points="417.41,-14974.44 413.91,-14964.44 410.41,-14974.44 417.41,-14974.44"/>
</g>
<!-- lay9_res1 -->
<g id="node142" class="node">
<title>lay9_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-14356.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-14375.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-14360.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-14345.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-14330.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_input&#45;&gt;lay9_res1 -->
<g id="edge169" class="edge">
<title>layer9_input&#45;&gt;lay9_res1</title>
<path fill="none" stroke="black" d="M555.32,-15104.2C555.32,-15104.2 555.32,-14405.61 555.32,-14405.61"/>
<polygon fill="black" stroke="black" points="558.82,-14405.61 555.32,-14395.61 551.82,-14405.61 558.82,-14405.61"/>
</g>
<!-- lay9_attn_score -->
<g id="node139" class="node">
<title>lay9_attn_score</title>
<polygon fill="lightpink" stroke="black" points="542.37,-14824.33 187.37,-14824.33 187.37,-14756.33 542.37,-14756.33 542.37,-14824.33"/>
<text text-anchor="middle" x="364.87" y="-14809.13" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="364.87" y="-14794.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-14779.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-14764.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_qkv_proj&#45;&gt;lay9_attn_score -->
<g id="edge165" class="edge">
<title>lay9_qkv_proj&#45;&gt;lay9_attn_score</title>
<path fill="none" stroke="black" d="M399.87,-14896.08C399.87,-14896.08 399.87,-14834.71 399.87,-14834.71"/>
<polygon fill="black" stroke="black" points="403.37,-14834.71 399.87,-14824.71 396.37,-14834.71 403.37,-14834.71"/>
</g>
<!-- lay9_attn_concat -->
<g id="node140" class="node">
<title>lay9_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="491.37,-14684.33 286.37,-14684.33 286.37,-14616.33 491.37,-14616.33 491.37,-14684.33"/>
<text text-anchor="middle" x="388.87" y="-14669.13" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="388.87" y="-14654.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="388.87" y="-14639.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="388.87" y="-14624.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_attn_score&#45;&gt;lay9_attn_concat -->
<g id="edge166" class="edge">
<title>lay9_attn_score&#45;&gt;lay9_attn_concat</title>
<path fill="none" stroke="black" d="M388.87,-14756.08C388.87,-14756.08 388.87,-14694.71 388.87,-14694.71"/>
<polygon fill="black" stroke="black" points="392.37,-14694.71 388.87,-14684.71 385.37,-14694.71 392.37,-14694.71"/>
</g>
<!-- lay9_attn_out -->
<g id="node141" class="node">
<title>lay9_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="520.37,-14544.33 305.37,-14544.33 305.37,-14476.33 520.37,-14476.33 520.37,-14544.33"/>
<text text-anchor="middle" x="412.87" y="-14529.13" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="412.87" y="-14514.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-14499.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-14484.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_attn_concat&#45;&gt;lay9_attn_out -->
<g id="edge167" class="edge">
<title>lay9_attn_concat&#45;&gt;lay9_attn_out</title>
<path fill="none" stroke="black" d="M398.37,-14616.08C398.37,-14616.08 398.37,-14554.71 398.37,-14554.71"/>
<polygon fill="black" stroke="black" points="401.87,-14554.71 398.37,-14544.71 394.87,-14554.71 401.87,-14554.71"/>
</g>
<!-- lay9_attn_out&#45;&gt;lay9_res1 -->
<g id="edge168" class="edge">
<title>lay9_attn_out&#45;&gt;lay9_res1</title>
<path fill="none" stroke="black" d="M412.87,-14476.14C412.87,-14476.14 412.87,-14414.37 412.87,-14414.37"/>
<polygon fill="black" stroke="black" points="416.37,-14414.37 412.87,-14404.37 409.37,-14414.37 416.37,-14414.37"/>
</g>
<!-- lay9_ln1 -->
<g id="node143" class="node">
<title>lay9_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-14236.16 351.37,-14236.16 351.37,-14168.16 554.37,-14168.16 554.37,-14236.16"/>
<text text-anchor="middle" x="452.87" y="-14220.96" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-14205.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-14190.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-14175.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_res1&#45;&gt;lay9_ln1 -->
<g id="edge170" class="edge">
<title>lay9_res1&#45;&gt;lay9_ln1</title>
<path fill="none" stroke="black" d="M452.87,-14308.34C452.87,-14308.34 452.87,-14246.35 452.87,-14246.35"/>
<polygon fill="black" stroke="black" points="456.37,-14246.35 452.87,-14236.35 449.37,-14246.35 456.37,-14246.35"/>
</g>
<!-- lay9_mlp_gate -->
<g id="node144" class="node">
<title>lay9_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-14096.16 182.87,-14096.16 182.87,-14028.16 394.87,-14028.16 394.87,-14096.16"/>
<text text-anchor="middle" x="288.87" y="-14080.96" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-14065.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-14050.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-14035.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_ln1&#45;&gt;lay9_mlp_gate -->
<g id="edge171" class="edge">
<title>lay9_ln1&#45;&gt;lay9_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-14167.92C373.12,-14167.92 373.12,-14106.54 373.12,-14106.54"/>
<polygon fill="black" stroke="black" points="376.62,-14106.54 373.12,-14096.54 369.62,-14106.54 376.62,-14106.54"/>
</g>
<!-- lay9_mlp_up -->
<g id="node145" class="node">
<title>lay9_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-13956.16 403.87,-13956.16 403.87,-13888.16 615.87,-13888.16 615.87,-13956.16"/>
<text text-anchor="middle" x="509.87" y="-13940.96" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-13925.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-13910.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-13895.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_ln1&#45;&gt;lay9_mlp_up -->
<g id="edge172" class="edge">
<title>lay9_ln1&#45;&gt;lay9_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-14168.11C479.12,-14168.11 479.12,-13966.42 479.12,-13966.42"/>
<polygon fill="black" stroke="black" points="482.62,-13966.42 479.12,-13956.42 475.62,-13966.42 482.62,-13966.42"/>
</g>
<!-- lay9_res2 -->
<g id="node149" class="node">
<title>lay9_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-13488.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-13506.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-13491.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-13476.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-13461.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_ln1&#45;&gt;lay9_res2 -->
<g id="edge178" class="edge">
<title>lay9_ln1&#45;&gt;lay9_res2</title>
<path fill="none" stroke="black" d="M554.49,-14202C596.17,-14202 634.84,-14202 634.84,-14202 634.84,-14202 634.84,-13517.18 634.84,-13517.18"/>
<polygon fill="black" stroke="black" points="638.34,-13517.18 634.84,-13507.18 631.34,-13517.18 638.34,-13517.18"/>
</g>
<!-- lay9_mlp_act -->
<g id="node146" class="node">
<title>lay9_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-13956.16 155.87,-13956.16 155.87,-13888.16 367.87,-13888.16 367.87,-13956.16"/>
<text text-anchor="middle" x="261.87" y="-13940.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-13925.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-13910.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-13895.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_mlp_gate&#45;&gt;lay9_mlp_act -->
<g id="edge173" class="edge">
<title>lay9_mlp_gate&#45;&gt;lay9_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-14027.92C275.37,-14027.92 275.37,-13966.54 275.37,-13966.54"/>
<polygon fill="black" stroke="black" points="278.87,-13966.54 275.37,-13956.54 271.87,-13966.54 278.87,-13966.54"/>
</g>
<!-- lay9_mlp_mul -->
<g id="node147" class="node">
<title>lay9_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-13816.16 248.87,-13816.16 248.87,-13748.16 594.87,-13748.16 594.87,-13816.16"/>
<text text-anchor="middle" x="421.87" y="-13800.96" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-13785.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-13770.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-13755.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_mlp_up&#45;&gt;lay9_mlp_mul -->
<g id="edge174" class="edge">
<title>lay9_mlp_up&#45;&gt;lay9_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-13887.92C499.37,-13887.92 499.37,-13826.54 499.37,-13826.54"/>
<polygon fill="black" stroke="black" points="502.87,-13826.54 499.37,-13816.54 495.87,-13826.54 502.87,-13826.54"/>
</g>
<!-- lay9_mlp_act&#45;&gt;lay9_mlp_mul -->
<g id="edge175" class="edge">
<title>lay9_mlp_act&#45;&gt;lay9_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-13887.92C308.37,-13887.92 308.37,-13826.54 308.37,-13826.54"/>
<polygon fill="black" stroke="black" points="311.87,-13826.54 308.37,-13816.54 304.87,-13826.54 311.87,-13826.54"/>
</g>
<!-- lay9_mlp_down -->
<g id="node148" class="node">
<title>lay9_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-13676.16 320.37,-13676.16 320.37,-13608.16 523.37,-13608.16 523.37,-13676.16"/>
<text text-anchor="middle" x="421.87" y="-13660.96" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-13645.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-13630.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-13615.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_mlp_mul&#45;&gt;lay9_mlp_down -->
<g id="edge176" class="edge">
<title>lay9_mlp_mul&#45;&gt;lay9_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-13747.92C421.87,-13747.92 421.87,-13686.54 421.87,-13686.54"/>
<polygon fill="black" stroke="black" points="425.37,-13686.54 421.87,-13676.54 418.37,-13686.54 425.37,-13686.54"/>
</g>
<!-- lay9_mlp_down&#45;&gt;lay9_res2 -->
<g id="edge177" class="edge">
<title>lay9_mlp_down&#45;&gt;lay9_res2</title>
<path fill="none" stroke="black" d="M421.87,-13607.97C421.87,-13607.97 421.87,-13546.21 421.87,-13546.21"/>
<polygon fill="black" stroke="black" points="425.37,-13546.21 421.87,-13536.21 418.37,-13546.21 425.37,-13546.21"/>
</g>
<!-- lay9_ln2 -->
<g id="node150" class="node">
<title>lay9_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-13368 320.37,-13368 320.37,-13300 523.37,-13300 523.37,-13368"/>
<text text-anchor="middle" x="421.87" y="-13352.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-13337.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-13322.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-13307.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_res2&#45;&gt;lay9_ln2 -->
<g id="edge179" class="edge">
<title>lay9_res2&#45;&gt;lay9_ln2</title>
<path fill="none" stroke="black" d="M421.87,-13439.75C421.87,-13439.75 421.87,-13378.48 421.87,-13378.48"/>
<polygon fill="black" stroke="black" points="425.37,-13378.48 421.87,-13368.48 418.37,-13378.48 425.37,-13378.48"/>
</g>
<!-- layer9_output -->
<g id="node151" class="node">
<title>layer9_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-13228 341.11,-13228 285.17,-13092 502.63,-13092 558.57,-13228"/>
<text text-anchor="middle" x="421.87" y="-13178.8" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-13163.8" font-family="Times,serif" font-size="14.00">To: GPU 10</text>
<text text-anchor="middle" x="421.87" y="-13148.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-13133.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- lay9_ln2&#45;&gt;layer9_output -->
<g id="edge180" class="edge">
<title>lay9_ln2&#45;&gt;layer9_output</title>
<path fill="none" stroke="black" d="M421.87,-13299.62C421.87,-13299.62 421.87,-13238.14 421.87,-13238.14"/>
<polygon fill="black" stroke="black" points="425.37,-13238.14 421.87,-13228.14 418.37,-13238.14 425.37,-13238.14"/>
</g>
<!-- layer10_input -->
<g id="node152" class="node">
<title>layer10_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-13020 348.42,-13020 297.55,-12884 495.32,-12884 546.19,-13020"/>
<text text-anchor="middle" x="421.87" y="-12970.8" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-12955.8" font-family="Times,serif" font-size="14.00">From: GPU 9</text>
<text text-anchor="middle" x="421.87" y="-12940.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-12925.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer9_output&#45;&gt;layer10_input -->
<g id="edge181" class="edge">
<title>layer9_output&#45;&gt;layer10_input</title>
<path fill="none" stroke="black" d="M421.87,-13091.89C421.87,-13091.89 421.87,-13030.26 421.87,-13030.26"/>
<polygon fill="black" stroke="black" points="425.37,-13030.26 421.87,-13020.26 418.37,-13030.26 425.37,-13030.26"/>
</g>
<!-- lay10_qkv_proj -->
<g id="node153" class="node">
<title>lay10_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="508.37,-12812 291.37,-12812 291.37,-12744 508.37,-12744 508.37,-12812"/>
<text text-anchor="middle" x="399.87" y="-12796.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="399.87" y="-12781.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="399.87" y="-12766.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="399.87" y="-12751.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_input&#45;&gt;lay10_qkv_proj -->
<g id="edge182" class="edge">
<title>layer10_input&#45;&gt;lay10_qkv_proj</title>
<path fill="none" stroke="black" d="M402.91,-12883.73C402.91,-12883.73 402.91,-12822.11 402.91,-12822.11"/>
<polygon fill="black" stroke="black" points="406.41,-12822.11 402.91,-12812.11 399.41,-12822.11 406.41,-12822.11"/>
</g>
<!-- lay10_res1 -->
<g id="node157" class="node">
<title>lay10_res1</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-12203.92" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-12222.72" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="421.87" y="-12207.72" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-12192.72" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-12177.72" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_input&#45;&gt;lay10_res1 -->
<g id="edge187" class="edge">
<title>layer10_input&#45;&gt;lay10_res1</title>
<path fill="none" stroke="black" d="M520.54,-12951C538.93,-12951 552.5,-12951 552.5,-12951 552.5,-12951 552.5,-12253.82 552.5,-12253.82"/>
<polygon fill="black" stroke="black" points="556,-12253.82 552.5,-12243.82 549,-12253.82 556,-12253.82"/>
</g>
<!-- lay10_attn_score -->
<g id="node154" class="node">
<title>lay10_attn_score</title>
<polygon fill="lightpink" stroke="black" points="542.37,-12672 187.37,-12672 187.37,-12604 542.37,-12604 542.37,-12672"/>
<text text-anchor="middle" x="364.87" y="-12656.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="364.87" y="-12641.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-12626.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="364.87" y="-12611.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_qkv_proj&#45;&gt;lay10_attn_score -->
<g id="edge183" class="edge">
<title>lay10_qkv_proj&#45;&gt;lay10_attn_score</title>
<path fill="none" stroke="black" d="M399.87,-12743.75C399.87,-12743.75 399.87,-12682.38 399.87,-12682.38"/>
<polygon fill="black" stroke="black" points="403.37,-12682.38 399.87,-12672.38 396.37,-12682.38 403.37,-12682.38"/>
</g>
<!-- lay10_attn_concat -->
<g id="node155" class="node">
<title>lay10_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="491.37,-12532 286.37,-12532 286.37,-12464 491.37,-12464 491.37,-12532"/>
<text text-anchor="middle" x="388.87" y="-12516.8" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="388.87" y="-12501.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="388.87" y="-12486.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="388.87" y="-12471.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_attn_score&#45;&gt;lay10_attn_concat -->
<g id="edge184" class="edge">
<title>lay10_attn_score&#45;&gt;lay10_attn_concat</title>
<path fill="none" stroke="black" d="M388.87,-12603.75C388.87,-12603.75 388.87,-12542.38 388.87,-12542.38"/>
<polygon fill="black" stroke="black" points="392.37,-12542.38 388.87,-12532.38 385.37,-12542.38 392.37,-12542.38"/>
</g>
<!-- lay10_attn_out -->
<g id="node156" class="node">
<title>lay10_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="520.37,-12392 305.37,-12392 305.37,-12324 520.37,-12324 520.37,-12392"/>
<text text-anchor="middle" x="412.87" y="-12376.8" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="412.87" y="-12361.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-12346.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="412.87" y="-12331.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_attn_concat&#45;&gt;lay10_attn_out -->
<g id="edge185" class="edge">
<title>lay10_attn_concat&#45;&gt;lay10_attn_out</title>
<path fill="none" stroke="black" d="M398.37,-12463.75C398.37,-12463.75 398.37,-12402.38 398.37,-12402.38"/>
<polygon fill="black" stroke="black" points="401.87,-12402.38 398.37,-12392.38 394.87,-12402.38 401.87,-12402.38"/>
</g>
<!-- lay10_attn_out&#45;&gt;lay10_res1 -->
<g id="edge186" class="edge">
<title>lay10_attn_out&#45;&gt;lay10_res1</title>
<path fill="none" stroke="black" d="M412.87,-12323.8C412.87,-12323.8 412.87,-12262.04 412.87,-12262.04"/>
<polygon fill="black" stroke="black" points="416.37,-12262.04 412.87,-12252.04 409.37,-12262.04 416.37,-12262.04"/>
</g>
<!-- lay10_ln1 -->
<g id="node158" class="node">
<title>lay10_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="554.37,-12083.83 351.37,-12083.83 351.37,-12015.83 554.37,-12015.83 554.37,-12083.83"/>
<text text-anchor="middle" x="452.87" y="-12068.63" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="452.87" y="-12053.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-12038.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="452.87" y="-12023.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_res1&#45;&gt;lay10_ln1 -->
<g id="edge188" class="edge">
<title>lay10_res1&#45;&gt;lay10_ln1</title>
<path fill="none" stroke="black" d="M452.87,-12156.01C452.87,-12156.01 452.87,-12094.02 452.87,-12094.02"/>
<polygon fill="black" stroke="black" points="456.37,-12094.02 452.87,-12084.02 449.37,-12094.02 456.37,-12094.02"/>
</g>
<!-- lay10_mlp_gate -->
<g id="node159" class="node">
<title>lay10_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="394.87,-11943.83 182.87,-11943.83 182.87,-11875.83 394.87,-11875.83 394.87,-11943.83"/>
<text text-anchor="middle" x="288.87" y="-11928.63" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="288.87" y="-11913.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="288.87" y="-11898.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="288.87" y="-11883.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_ln1&#45;&gt;lay10_mlp_gate -->
<g id="edge189" class="edge">
<title>lay10_ln1&#45;&gt;lay10_mlp_gate</title>
<path fill="none" stroke="black" d="M373.12,-12015.58C373.12,-12015.58 373.12,-11954.21 373.12,-11954.21"/>
<polygon fill="black" stroke="black" points="376.62,-11954.21 373.12,-11944.21 369.62,-11954.21 376.62,-11954.21"/>
</g>
<!-- lay10_mlp_up -->
<g id="node160" class="node">
<title>lay10_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="615.87,-11803.83 403.87,-11803.83 403.87,-11735.83 615.87,-11735.83 615.87,-11803.83"/>
<text text-anchor="middle" x="509.87" y="-11788.63" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="509.87" y="-11773.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="509.87" y="-11758.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="509.87" y="-11743.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_ln1&#45;&gt;lay10_mlp_up -->
<g id="edge190" class="edge">
<title>lay10_ln1&#45;&gt;lay10_mlp_up</title>
<path fill="none" stroke="black" d="M479.12,-12015.78C479.12,-12015.78 479.12,-11814.09 479.12,-11814.09"/>
<polygon fill="black" stroke="black" points="482.62,-11814.09 479.12,-11804.09 475.62,-11814.09 482.62,-11814.09"/>
</g>
<!-- lay10_res2 -->
<g id="node164" class="node">
<title>lay10_res2</title>
<ellipse fill="lightgray" stroke="black" cx="421.87" cy="-11335.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="421.87" y="-11354.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="421.87" y="-11339.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-11324.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-11309.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_ln1&#45;&gt;lay10_res2 -->
<g id="edge196" class="edge">
<title>lay10_ln1&#45;&gt;lay10_res2</title>
<path fill="none" stroke="black" d="M554.49,-12049C596.17,-12049 634.84,-12049 634.84,-12049 634.84,-12049 634.84,-11364.83 634.84,-11364.83"/>
<polygon fill="black" stroke="black" points="638.34,-11364.83 634.84,-11354.83 631.34,-11364.83 638.34,-11364.83"/>
</g>
<!-- lay10_mlp_act -->
<g id="node161" class="node">
<title>lay10_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="367.87,-11803.83 155.87,-11803.83 155.87,-11735.83 367.87,-11735.83 367.87,-11803.83"/>
<text text-anchor="middle" x="261.87" y="-11788.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="261.87" y="-11773.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-11758.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="261.87" y="-11743.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_mlp_gate&#45;&gt;lay10_mlp_act -->
<g id="edge191" class="edge">
<title>lay10_mlp_gate&#45;&gt;lay10_mlp_act</title>
<path fill="none" stroke="black" d="M275.37,-11875.58C275.37,-11875.58 275.37,-11814.21 275.37,-11814.21"/>
<polygon fill="black" stroke="black" points="278.87,-11814.21 275.37,-11804.21 271.87,-11814.21 278.87,-11814.21"/>
</g>
<!-- lay10_mlp_mul -->
<g id="node162" class="node">
<title>lay10_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="594.87,-11663.83 248.87,-11663.83 248.87,-11595.83 594.87,-11595.83 594.87,-11663.83"/>
<text text-anchor="middle" x="421.87" y="-11648.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="421.87" y="-11633.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-11618.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-11603.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_mlp_up&#45;&gt;lay10_mlp_mul -->
<g id="edge192" class="edge">
<title>lay10_mlp_up&#45;&gt;lay10_mlp_mul</title>
<path fill="none" stroke="black" d="M499.37,-11735.58C499.37,-11735.58 499.37,-11674.21 499.37,-11674.21"/>
<polygon fill="black" stroke="black" points="502.87,-11674.21 499.37,-11664.21 495.87,-11674.21 502.87,-11674.21"/>
</g>
<!-- lay10_mlp_act&#45;&gt;lay10_mlp_mul -->
<g id="edge193" class="edge">
<title>lay10_mlp_act&#45;&gt;lay10_mlp_mul</title>
<path fill="none" stroke="black" d="M308.37,-11735.58C308.37,-11735.58 308.37,-11674.21 308.37,-11674.21"/>
<polygon fill="black" stroke="black" points="311.87,-11674.21 308.37,-11664.21 304.87,-11674.21 311.87,-11674.21"/>
</g>
<!-- lay10_mlp_down -->
<g id="node163" class="node">
<title>lay10_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="523.37,-11523.83 320.37,-11523.83 320.37,-11455.83 523.37,-11455.83 523.37,-11523.83"/>
<text text-anchor="middle" x="421.87" y="-11508.63" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="421.87" y="-11493.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="421.87" y="-11478.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-11463.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_mlp_mul&#45;&gt;lay10_mlp_down -->
<g id="edge194" class="edge">
<title>lay10_mlp_mul&#45;&gt;lay10_mlp_down</title>
<path fill="none" stroke="black" d="M421.87,-11595.58C421.87,-11595.58 421.87,-11534.21 421.87,-11534.21"/>
<polygon fill="black" stroke="black" points="425.37,-11534.21 421.87,-11524.21 418.37,-11534.21 425.37,-11534.21"/>
</g>
<!-- lay10_mlp_down&#45;&gt;lay10_res2 -->
<g id="edge195" class="edge">
<title>lay10_mlp_down&#45;&gt;lay10_res2</title>
<path fill="none" stroke="black" d="M421.87,-11455.64C421.87,-11455.64 421.87,-11393.87 421.87,-11393.87"/>
<polygon fill="black" stroke="black" points="425.37,-11393.87 421.87,-11383.87 418.37,-11393.87 425.37,-11393.87"/>
</g>
<!-- lay10_ln2 -->
<g id="node165" class="node">
<title>lay10_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="523.37,-11215.67 320.37,-11215.67 320.37,-11147.67 523.37,-11147.67 523.37,-11215.67"/>
<text text-anchor="middle" x="421.87" y="-11200.47" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="421.87" y="-11185.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-11170.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-11155.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_res2&#45;&gt;lay10_ln2 -->
<g id="edge197" class="edge">
<title>lay10_res2&#45;&gt;lay10_ln2</title>
<path fill="none" stroke="black" d="M421.87,-11287.42C421.87,-11287.42 421.87,-11226.14 421.87,-11226.14"/>
<polygon fill="black" stroke="black" points="425.37,-11226.14 421.87,-11216.14 418.37,-11226.14 425.37,-11226.14"/>
</g>
<!-- layer10_output -->
<g id="node166" class="node">
<title>layer10_output</title>
<polygon fill="lightyellow" stroke="black" points="558.57,-11075.67 341.11,-11075.67 285.17,-10939.67 502.63,-10939.67 558.57,-11075.67"/>
<text text-anchor="middle" x="421.87" y="-11026.47" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="421.87" y="-11011.47" font-family="Times,serif" font-size="14.00">To: GPU 11</text>
<text text-anchor="middle" x="421.87" y="-10996.47" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-10981.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- lay10_ln2&#45;&gt;layer10_output -->
<g id="edge198" class="edge">
<title>lay10_ln2&#45;&gt;layer10_output</title>
<path fill="none" stroke="black" d="M421.87,-11147.29C421.87,-11147.29 421.87,-11085.81 421.87,-11085.81"/>
<polygon fill="black" stroke="black" points="425.37,-11085.81 421.87,-11075.81 418.37,-11085.81 425.37,-11085.81"/>
</g>
<!-- layer11_input -->
<g id="node167" class="node">
<title>layer11_input</title>
<polygon fill="lightyellow" stroke="black" points="546.19,-10867.67 348.42,-10867.67 297.55,-10731.67 495.32,-10731.67 546.19,-10867.67"/>
<text text-anchor="middle" x="421.87" y="-10818.47" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="421.87" y="-10803.47" font-family="Times,serif" font-size="14.00">From: GPU 10</text>
<text text-anchor="middle" x="421.87" y="-10788.47" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="421.87" y="-10773.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer10_output&#45;&gt;layer11_input -->
<g id="edge199" class="edge">
<title>layer10_output&#45;&gt;layer11_input</title>
<path fill="none" stroke="black" d="M421.87,-10939.56C421.87,-10939.56 421.87,-10877.93 421.87,-10877.93"/>
<polygon fill="black" stroke="black" points="425.37,-10877.93 421.87,-10867.93 418.37,-10877.93 425.37,-10877.93"/>
</g>
<!-- lay11_qkv_proj -->
<g id="node168" class="node">
<title>lay11_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="513.37,-10659.67 296.37,-10659.67 296.37,-10591.67 513.37,-10591.67 513.37,-10659.67"/>
<text text-anchor="middle" x="404.87" y="-10644.47" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="404.87" y="-10629.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-10614.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="404.87" y="-10599.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_input&#45;&gt;lay11_qkv_proj -->
<g id="edge200" class="edge">
<title>layer11_input&#45;&gt;lay11_qkv_proj</title>
<path fill="none" stroke="black" d="M405.41,-10731.4C405.41,-10731.4 405.41,-10669.77 405.41,-10669.77"/>
<polygon fill="black" stroke="black" points="408.91,-10669.77 405.41,-10659.77 401.91,-10669.77 408.91,-10669.77"/>
</g>
<!-- lay11_res1 -->
<g id="node172" class="node">
<title>lay11_res1</title>
<ellipse fill="lightgray" stroke="black" cx="440.87" cy="-10051.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="440.87" y="-10070.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="440.87" y="-10055.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-10040.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-10025.38" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_input&#45;&gt;lay11_res1 -->
<g id="edge205" class="edge">
<title>layer11_input&#45;&gt;lay11_res1</title>
<path fill="none" stroke="black" d="M520.62,-10799C539.26,-10799 553.05,-10799 553.05,-10799 553.05,-10799 553.05,-10103.91 553.05,-10103.91"/>
<polygon fill="black" stroke="black" points="556.55,-10103.91 553.05,-10093.91 549.55,-10103.91 556.55,-10103.91"/>
</g>
<!-- lay11_attn_score -->
<g id="node169" class="node">
<title>lay11_attn_score</title>
<polygon fill="lightpink" stroke="black" points="547.37,-10519.67 192.37,-10519.67 192.37,-10451.67 547.37,-10451.67 547.37,-10519.67"/>
<text text-anchor="middle" x="369.87" y="-10504.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="369.87" y="-10489.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="369.87" y="-10474.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="369.87" y="-10459.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_qkv_proj&#45;&gt;lay11_attn_score -->
<g id="edge201" class="edge">
<title>lay11_qkv_proj&#45;&gt;lay11_attn_score</title>
<path fill="none" stroke="black" d="M404.87,-10591.42C404.87,-10591.42 404.87,-10530.04 404.87,-10530.04"/>
<polygon fill="black" stroke="black" points="408.37,-10530.04 404.87,-10520.04 401.37,-10530.04 408.37,-10530.04"/>
</g>
<!-- lay11_attn_concat -->
<g id="node170" class="node">
<title>lay11_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="489.37,-10379.67 284.37,-10379.67 284.37,-10311.67 489.37,-10311.67 489.37,-10379.67"/>
<text text-anchor="middle" x="386.87" y="-10364.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="386.87" y="-10349.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-10334.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="386.87" y="-10319.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_attn_score&#45;&gt;lay11_attn_concat -->
<g id="edge202" class="edge">
<title>lay11_attn_score&#45;&gt;lay11_attn_concat</title>
<path fill="none" stroke="black" d="M386.87,-10451.42C386.87,-10451.42 386.87,-10390.04 386.87,-10390.04"/>
<polygon fill="black" stroke="black" points="390.37,-10390.04 386.87,-10380.04 383.37,-10390.04 390.37,-10390.04"/>
</g>
<!-- lay11_attn_out -->
<g id="node171" class="node">
<title>lay11_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="529.37,-10239.67 314.37,-10239.67 314.37,-10171.67 529.37,-10171.67 529.37,-10239.67"/>
<text text-anchor="middle" x="421.87" y="-10224.47" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="421.87" y="-10209.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-10194.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-10179.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_attn_concat&#45;&gt;lay11_attn_out -->
<g id="edge203" class="edge">
<title>lay11_attn_concat&#45;&gt;lay11_attn_out</title>
<path fill="none" stroke="black" d="M401.87,-10311.42C401.87,-10311.42 401.87,-10250.04 401.87,-10250.04"/>
<polygon fill="black" stroke="black" points="405.37,-10250.04 401.87,-10240.04 398.37,-10250.04 405.37,-10250.04"/>
</g>
<!-- lay11_attn_out&#45;&gt;lay11_res1 -->
<g id="edge204" class="edge">
<title>lay11_attn_out&#45;&gt;lay11_res1</title>
<path fill="none" stroke="black" d="M421.87,-10171.47C421.87,-10171.47 421.87,-10109.71 421.87,-10109.71"/>
<polygon fill="black" stroke="black" points="425.37,-10109.71 421.87,-10099.71 418.37,-10109.71 425.37,-10109.71"/>
</g>
<!-- lay11_ln1 -->
<g id="node173" class="node">
<title>lay11_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="573.37,-9931.5 370.37,-9931.5 370.37,-9863.5 573.37,-9863.5 573.37,-9931.5"/>
<text text-anchor="middle" x="471.87" y="-9916.3" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="471.87" y="-9901.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="471.87" y="-9886.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="471.87" y="-9871.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_res1&#45;&gt;lay11_ln1 -->
<g id="edge206" class="edge">
<title>lay11_res1&#45;&gt;lay11_ln1</title>
<path fill="none" stroke="black" d="M471.87,-10003.67C471.87,-10003.67 471.87,-9941.68 471.87,-9941.68"/>
<polygon fill="black" stroke="black" points="475.37,-9941.68 471.87,-9931.68 468.37,-9941.68 475.37,-9941.68"/>
</g>
<!-- lay11_mlp_gate -->
<g id="node174" class="node">
<title>lay11_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="413.87,-9791.5 201.87,-9791.5 201.87,-9723.5 413.87,-9723.5 413.87,-9791.5"/>
<text text-anchor="middle" x="307.87" y="-9776.3" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="307.87" y="-9761.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="307.87" y="-9746.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="307.87" y="-9731.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_ln1&#45;&gt;lay11_mlp_gate -->
<g id="edge207" class="edge">
<title>lay11_ln1&#45;&gt;lay11_mlp_gate</title>
<path fill="none" stroke="black" d="M392.12,-9863.25C392.12,-9863.25 392.12,-9801.88 392.12,-9801.88"/>
<polygon fill="black" stroke="black" points="395.62,-9801.88 392.12,-9791.88 388.62,-9801.88 395.62,-9801.88"/>
</g>
<!-- lay11_mlp_up -->
<g id="node175" class="node">
<title>lay11_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="634.87,-9651.5 422.87,-9651.5 422.87,-9583.5 634.87,-9583.5 634.87,-9651.5"/>
<text text-anchor="middle" x="528.87" y="-9636.3" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="528.87" y="-9621.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="528.87" y="-9606.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="528.87" y="-9591.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_ln1&#45;&gt;lay11_mlp_up -->
<g id="edge208" class="edge">
<title>lay11_ln1&#45;&gt;lay11_mlp_up</title>
<path fill="none" stroke="black" d="M498.12,-9863.45C498.12,-9863.45 498.12,-9661.75 498.12,-9661.75"/>
<polygon fill="black" stroke="black" points="501.62,-9661.75 498.12,-9651.75 494.62,-9661.75 501.62,-9661.75"/>
</g>
<!-- lay11_res2 -->
<g id="node179" class="node">
<title>lay11_res2</title>
<ellipse fill="lightgray" stroke="black" cx="440.87" cy="-9183.42" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="440.87" y="-9202.22" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="440.87" y="-9187.22" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-9172.22" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-9157.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_ln1&#45;&gt;lay11_res2 -->
<g id="edge214" class="edge">
<title>lay11_ln1&#45;&gt;lay11_res2</title>
<path fill="none" stroke="black" d="M573.49,-9897C615.17,-9897 653.84,-9897 653.84,-9897 653.84,-9897 653.84,-9212.5 653.84,-9212.5"/>
<polygon fill="black" stroke="black" points="657.34,-9212.5 653.84,-9202.5 650.34,-9212.5 657.34,-9212.5"/>
</g>
<!-- lay11_mlp_act -->
<g id="node176" class="node">
<title>lay11_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="386.87,-9651.5 174.87,-9651.5 174.87,-9583.5 386.87,-9583.5 386.87,-9651.5"/>
<text text-anchor="middle" x="280.87" y="-9636.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="280.87" y="-9621.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="280.87" y="-9606.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="280.87" y="-9591.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_mlp_gate&#45;&gt;lay11_mlp_act -->
<g id="edge209" class="edge">
<title>lay11_mlp_gate&#45;&gt;lay11_mlp_act</title>
<path fill="none" stroke="black" d="M294.37,-9723.25C294.37,-9723.25 294.37,-9661.88 294.37,-9661.88"/>
<polygon fill="black" stroke="black" points="297.87,-9661.88 294.37,-9651.88 290.87,-9661.88 297.87,-9661.88"/>
</g>
<!-- lay11_mlp_mul -->
<g id="node177" class="node">
<title>lay11_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="613.87,-9511.5 267.87,-9511.5 267.87,-9443.5 613.87,-9443.5 613.87,-9511.5"/>
<text text-anchor="middle" x="440.87" y="-9496.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="440.87" y="-9481.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="440.87" y="-9466.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="440.87" y="-9451.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_mlp_up&#45;&gt;lay11_mlp_mul -->
<g id="edge210" class="edge">
<title>lay11_mlp_up&#45;&gt;lay11_mlp_mul</title>
<path fill="none" stroke="black" d="M518.37,-9583.25C518.37,-9583.25 518.37,-9521.88 518.37,-9521.88"/>
<polygon fill="black" stroke="black" points="521.87,-9521.88 518.37,-9511.88 514.87,-9521.88 521.87,-9521.88"/>
</g>
<!-- lay11_mlp_act&#45;&gt;lay11_mlp_mul -->
<g id="edge211" class="edge">
<title>lay11_mlp_act&#45;&gt;lay11_mlp_mul</title>
<path fill="none" stroke="black" d="M327.37,-9583.25C327.37,-9583.25 327.37,-9521.88 327.37,-9521.88"/>
<polygon fill="black" stroke="black" points="330.87,-9521.88 327.37,-9511.88 323.87,-9521.88 330.87,-9521.88"/>
</g>
<!-- lay11_mlp_down -->
<g id="node178" class="node">
<title>lay11_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="542.37,-9371.5 339.37,-9371.5 339.37,-9303.5 542.37,-9303.5 542.37,-9371.5"/>
<text text-anchor="middle" x="440.87" y="-9356.3" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="440.87" y="-9341.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="440.87" y="-9326.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-9311.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_mlp_mul&#45;&gt;lay11_mlp_down -->
<g id="edge212" class="edge">
<title>lay11_mlp_mul&#45;&gt;lay11_mlp_down</title>
<path fill="none" stroke="black" d="M440.87,-9443.25C440.87,-9443.25 440.87,-9381.88 440.87,-9381.88"/>
<polygon fill="black" stroke="black" points="444.37,-9381.88 440.87,-9371.88 437.37,-9381.88 444.37,-9381.88"/>
</g>
<!-- lay11_mlp_down&#45;&gt;lay11_res2 -->
<g id="edge213" class="edge">
<title>lay11_mlp_down&#45;&gt;lay11_res2</title>
<path fill="none" stroke="black" d="M440.87,-9303.3C440.87,-9303.3 440.87,-9241.54 440.87,-9241.54"/>
<polygon fill="black" stroke="black" points="444.37,-9241.54 440.87,-9231.54 437.37,-9241.54 444.37,-9241.54"/>
</g>
<!-- lay11_ln2 -->
<g id="node180" class="node">
<title>lay11_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="542.37,-9063.33 339.37,-9063.33 339.37,-8995.33 542.37,-8995.33 542.37,-9063.33"/>
<text text-anchor="middle" x="440.87" y="-9048.13" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="440.87" y="-9033.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-9018.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="440.87" y="-9003.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_res2&#45;&gt;lay11_ln2 -->
<g id="edge215" class="edge">
<title>lay11_res2&#45;&gt;lay11_ln2</title>
<path fill="none" stroke="black" d="M440.87,-9135.09C440.87,-9135.09 440.87,-9073.81 440.87,-9073.81"/>
<polygon fill="black" stroke="black" points="444.37,-9073.81 440.87,-9063.81 437.37,-9073.81 444.37,-9073.81"/>
</g>
<!-- layer11_output -->
<g id="node181" class="node">
<title>layer11_output</title>
<polygon fill="lightyellow" stroke="black" points="577.57,-8923.33 360.11,-8923.33 304.17,-8787.33 521.63,-8787.33 577.57,-8923.33"/>
<text text-anchor="middle" x="440.87" y="-8874.13" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="440.87" y="-8859.13" font-family="Times,serif" font-size="14.00">To: GPU 12</text>
<text text-anchor="middle" x="440.87" y="-8844.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="440.87" y="-8829.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- lay11_ln2&#45;&gt;layer11_output -->
<g id="edge216" class="edge">
<title>lay11_ln2&#45;&gt;layer11_output</title>
<path fill="none" stroke="black" d="M440.87,-8994.96C440.87,-8994.96 440.87,-8933.47 440.87,-8933.47"/>
<polygon fill="black" stroke="black" points="444.37,-8933.47 440.87,-8923.47 437.37,-8933.47 444.37,-8933.47"/>
</g>
<!-- layer12_input -->
<g id="node182" class="node">
<title>layer12_input</title>
<polygon fill="lightyellow" stroke="black" points="565.19,-8715.33 367.42,-8715.33 316.55,-8579.33 514.32,-8579.33 565.19,-8715.33"/>
<text text-anchor="middle" x="440.87" y="-8666.13" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="440.87" y="-8651.13" font-family="Times,serif" font-size="14.00">From: GPU 11</text>
<text text-anchor="middle" x="440.87" y="-8636.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="440.87" y="-8621.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer11_output&#45;&gt;layer12_input -->
<g id="edge217" class="edge">
<title>layer11_output&#45;&gt;layer12_input</title>
<path fill="none" stroke="black" d="M440.87,-8787.23C440.87,-8787.23 440.87,-8725.59 440.87,-8725.59"/>
<polygon fill="black" stroke="black" points="444.37,-8725.59 440.87,-8715.59 437.37,-8725.59 444.37,-8725.59"/>
</g>
<!-- lay12_qkv_proj -->
<g id="node183" class="node">
<title>lay12_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="512.37,-8507.33 295.37,-8507.33 295.37,-8439.33 512.37,-8439.33 512.37,-8507.33"/>
<text text-anchor="middle" x="403.87" y="-8492.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="403.87" y="-8477.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="403.87" y="-8462.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="403.87" y="-8447.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_input&#45;&gt;lay12_qkv_proj -->
<g id="edge218" class="edge">
<title>layer12_input&#45;&gt;lay12_qkv_proj</title>
<path fill="none" stroke="black" d="M414.41,-8579.06C414.41,-8579.06 414.41,-8517.44 414.41,-8517.44"/>
<polygon fill="black" stroke="black" points="417.91,-8517.44 414.41,-8507.44 410.91,-8517.44 417.91,-8517.44"/>
</g>
<!-- lay12_res1 -->
<g id="node187" class="node">
<title>lay12_res1</title>
<ellipse fill="lightgray" stroke="black" cx="438.87" cy="-7899.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="438.87" y="-7918.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="438.87" y="-7903.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-7888.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-7873.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_input&#45;&gt;lay12_res1 -->
<g id="edge223" class="edge">
<title>layer12_input&#45;&gt;lay12_res1</title>
<path fill="none" stroke="black" d="M555.82,-8647.2C555.82,-8647.2 555.82,-7950.99 555.82,-7950.99"/>
<polygon fill="black" stroke="black" points="559.32,-7950.99 555.82,-7940.99 552.32,-7950.99 559.32,-7950.99"/>
</g>
<!-- lay12_attn_score -->
<g id="node184" class="node">
<title>lay12_attn_score</title>
<polygon fill="lightpink" stroke="black" points="546.37,-8367.33 191.37,-8367.33 191.37,-8299.33 546.37,-8299.33 546.37,-8367.33"/>
<text text-anchor="middle" x="368.87" y="-8352.13" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="368.87" y="-8337.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="368.87" y="-8322.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="368.87" y="-8307.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_qkv_proj&#45;&gt;lay12_attn_score -->
<g id="edge219" class="edge">
<title>lay12_qkv_proj&#45;&gt;lay12_attn_score</title>
<path fill="none" stroke="black" d="M403.87,-8439.08C403.87,-8439.08 403.87,-8377.71 403.87,-8377.71"/>
<polygon fill="black" stroke="black" points="407.37,-8377.71 403.87,-8367.71 400.37,-8377.71 407.37,-8377.71"/>
</g>
<!-- lay12_attn_concat -->
<g id="node185" class="node">
<title>lay12_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="489.37,-8227.33 284.37,-8227.33 284.37,-8159.33 489.37,-8159.33 489.37,-8227.33"/>
<text text-anchor="middle" x="386.87" y="-8212.13" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="386.87" y="-8197.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="386.87" y="-8182.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="386.87" y="-8167.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_attn_score&#45;&gt;lay12_attn_concat -->
<g id="edge220" class="edge">
<title>lay12_attn_score&#45;&gt;lay12_attn_concat</title>
<path fill="none" stroke="black" d="M386.87,-8299.08C386.87,-8299.08 386.87,-8237.71 386.87,-8237.71"/>
<polygon fill="black" stroke="black" points="390.37,-8237.71 386.87,-8227.71 383.37,-8237.71 390.37,-8237.71"/>
</g>
<!-- lay12_attn_out -->
<g id="node186" class="node">
<title>lay12_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="529.37,-8087.33 314.37,-8087.33 314.37,-8019.33 529.37,-8019.33 529.37,-8087.33"/>
<text text-anchor="middle" x="421.87" y="-8072.13" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="421.87" y="-8057.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-8042.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="421.87" y="-8027.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_attn_concat&#45;&gt;lay12_attn_out -->
<g id="edge221" class="edge">
<title>lay12_attn_concat&#45;&gt;lay12_attn_out</title>
<path fill="none" stroke="black" d="M401.87,-8159.08C401.87,-8159.08 401.87,-8097.71 401.87,-8097.71"/>
<polygon fill="black" stroke="black" points="405.37,-8097.71 401.87,-8087.71 398.37,-8097.71 405.37,-8097.71"/>
</g>
<!-- lay12_attn_out&#45;&gt;lay12_res1 -->
<g id="edge222" class="edge">
<title>lay12_attn_out&#45;&gt;lay12_res1</title>
<path fill="none" stroke="black" d="M421.87,-8019.14C421.87,-8019.14 421.87,-7957.37 421.87,-7957.37"/>
<polygon fill="black" stroke="black" points="425.37,-7957.37 421.87,-7947.37 418.37,-7957.37 425.37,-7957.37"/>
</g>
<!-- lay12_ln1 -->
<g id="node188" class="node">
<title>lay12_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="571.37,-7779.17 368.37,-7779.17 368.37,-7711.17 571.37,-7711.17 571.37,-7779.17"/>
<text text-anchor="middle" x="469.87" y="-7763.97" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="469.87" y="-7748.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="469.87" y="-7733.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="469.87" y="-7718.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_res1&#45;&gt;lay12_ln1 -->
<g id="edge224" class="edge">
<title>lay12_res1&#45;&gt;lay12_ln1</title>
<path fill="none" stroke="black" d="M469.87,-7851.34C469.87,-7851.34 469.87,-7789.35 469.87,-7789.35"/>
<polygon fill="black" stroke="black" points="473.37,-7789.35 469.87,-7779.35 466.37,-7789.35 473.37,-7789.35"/>
</g>
<!-- lay12_mlp_gate -->
<g id="node189" class="node">
<title>lay12_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="411.87,-7639.17 199.87,-7639.17 199.87,-7571.17 411.87,-7571.17 411.87,-7639.17"/>
<text text-anchor="middle" x="305.87" y="-7623.97" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="305.87" y="-7608.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="305.87" y="-7593.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="305.87" y="-7578.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_ln1&#45;&gt;lay12_mlp_gate -->
<g id="edge225" class="edge">
<title>lay12_ln1&#45;&gt;lay12_mlp_gate</title>
<path fill="none" stroke="black" d="M390.12,-7710.92C390.12,-7710.92 390.12,-7649.55 390.12,-7649.55"/>
<polygon fill="black" stroke="black" points="393.62,-7649.55 390.12,-7639.55 386.62,-7649.55 393.62,-7649.55"/>
</g>
<!-- lay12_mlp_up -->
<g id="node190" class="node">
<title>lay12_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="632.87,-7499.17 420.87,-7499.17 420.87,-7431.17 632.87,-7431.17 632.87,-7499.17"/>
<text text-anchor="middle" x="526.87" y="-7483.97" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="526.87" y="-7468.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="526.87" y="-7453.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="526.87" y="-7438.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_ln1&#45;&gt;lay12_mlp_up -->
<g id="edge226" class="edge">
<title>lay12_ln1&#45;&gt;lay12_mlp_up</title>
<path fill="none" stroke="black" d="M496.12,-7711.11C496.12,-7711.11 496.12,-7509.42 496.12,-7509.42"/>
<polygon fill="black" stroke="black" points="499.62,-7509.42 496.12,-7499.42 492.62,-7509.42 499.62,-7509.42"/>
</g>
<!-- lay12_res2 -->
<g id="node194" class="node">
<title>lay12_res2</title>
<ellipse fill="lightgray" stroke="black" cx="438.87" cy="-7031.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="438.87" y="-7049.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="438.87" y="-7034.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-7019.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-7004.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_ln1&#45;&gt;lay12_res2 -->
<g id="edge232" class="edge">
<title>lay12_ln1&#45;&gt;lay12_res2</title>
<path fill="none" stroke="black" d="M571.49,-7745C613.17,-7745 651.84,-7745 651.84,-7745 651.84,-7745 651.84,-7060.18 651.84,-7060.18"/>
<polygon fill="black" stroke="black" points="655.34,-7060.18 651.84,-7050.18 648.34,-7060.18 655.34,-7060.18"/>
</g>
<!-- lay12_mlp_act -->
<g id="node191" class="node">
<title>lay12_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="384.87,-7499.17 172.87,-7499.17 172.87,-7431.17 384.87,-7431.17 384.87,-7499.17"/>
<text text-anchor="middle" x="278.87" y="-7483.97" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="278.87" y="-7468.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="278.87" y="-7453.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="278.87" y="-7438.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_mlp_gate&#45;&gt;lay12_mlp_act -->
<g id="edge227" class="edge">
<title>lay12_mlp_gate&#45;&gt;lay12_mlp_act</title>
<path fill="none" stroke="black" d="M292.37,-7570.92C292.37,-7570.92 292.37,-7509.55 292.37,-7509.55"/>
<polygon fill="black" stroke="black" points="295.87,-7509.55 292.37,-7499.55 288.87,-7509.55 295.87,-7509.55"/>
</g>
<!-- lay12_mlp_mul -->
<g id="node192" class="node">
<title>lay12_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="611.87,-7359.17 265.87,-7359.17 265.87,-7291.17 611.87,-7291.17 611.87,-7359.17"/>
<text text-anchor="middle" x="438.87" y="-7343.97" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="438.87" y="-7328.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="438.87" y="-7313.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="438.87" y="-7298.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_mlp_up&#45;&gt;lay12_mlp_mul -->
<g id="edge228" class="edge">
<title>lay12_mlp_up&#45;&gt;lay12_mlp_mul</title>
<path fill="none" stroke="black" d="M516.37,-7430.92C516.37,-7430.92 516.37,-7369.55 516.37,-7369.55"/>
<polygon fill="black" stroke="black" points="519.87,-7369.55 516.37,-7359.55 512.87,-7369.55 519.87,-7369.55"/>
</g>
<!-- lay12_mlp_act&#45;&gt;lay12_mlp_mul -->
<g id="edge229" class="edge">
<title>lay12_mlp_act&#45;&gt;lay12_mlp_mul</title>
<path fill="none" stroke="black" d="M325.37,-7430.92C325.37,-7430.92 325.37,-7369.55 325.37,-7369.55"/>
<polygon fill="black" stroke="black" points="328.87,-7369.55 325.37,-7359.55 321.87,-7369.55 328.87,-7369.55"/>
</g>
<!-- lay12_mlp_down -->
<g id="node193" class="node">
<title>lay12_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="540.37,-7219.17 337.37,-7219.17 337.37,-7151.17 540.37,-7151.17 540.37,-7219.17"/>
<text text-anchor="middle" x="438.87" y="-7203.97" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="438.87" y="-7188.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="438.87" y="-7173.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-7158.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_mlp_mul&#45;&gt;lay12_mlp_down -->
<g id="edge230" class="edge">
<title>lay12_mlp_mul&#45;&gt;lay12_mlp_down</title>
<path fill="none" stroke="black" d="M438.87,-7290.92C438.87,-7290.92 438.87,-7229.55 438.87,-7229.55"/>
<polygon fill="black" stroke="black" points="442.37,-7229.55 438.87,-7219.55 435.37,-7229.55 442.37,-7229.55"/>
</g>
<!-- lay12_mlp_down&#45;&gt;lay12_res2 -->
<g id="edge231" class="edge">
<title>lay12_mlp_down&#45;&gt;lay12_res2</title>
<path fill="none" stroke="black" d="M438.87,-7150.97C438.87,-7150.97 438.87,-7089.21 438.87,-7089.21"/>
<polygon fill="black" stroke="black" points="442.37,-7089.21 438.87,-7079.21 435.37,-7089.21 442.37,-7089.21"/>
</g>
<!-- lay12_ln2 -->
<g id="node195" class="node">
<title>lay12_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="540.37,-6911 337.37,-6911 337.37,-6843 540.37,-6843 540.37,-6911"/>
<text text-anchor="middle" x="438.87" y="-6895.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="438.87" y="-6880.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-6865.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-6850.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_res2&#45;&gt;lay12_ln2 -->
<g id="edge233" class="edge">
<title>lay12_res2&#45;&gt;lay12_ln2</title>
<path fill="none" stroke="black" d="M438.87,-6982.75C438.87,-6982.75 438.87,-6921.48 438.87,-6921.48"/>
<polygon fill="black" stroke="black" points="442.37,-6921.48 438.87,-6911.48 435.37,-6921.48 442.37,-6921.48"/>
</g>
<!-- layer12_output -->
<g id="node196" class="node">
<title>layer12_output</title>
<polygon fill="lightyellow" stroke="black" points="575.57,-6771 358.11,-6771 302.17,-6635 519.63,-6635 575.57,-6771"/>
<text text-anchor="middle" x="438.87" y="-6721.8" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="438.87" y="-6706.8" font-family="Times,serif" font-size="14.00">To: GPU 13</text>
<text text-anchor="middle" x="438.87" y="-6691.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="438.87" y="-6676.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- lay12_ln2&#45;&gt;layer12_output -->
<g id="edge234" class="edge">
<title>lay12_ln2&#45;&gt;layer12_output</title>
<path fill="none" stroke="black" d="M438.87,-6842.62C438.87,-6842.62 438.87,-6781.14 438.87,-6781.14"/>
<polygon fill="black" stroke="black" points="442.37,-6781.14 438.87,-6771.14 435.37,-6781.14 442.37,-6781.14"/>
</g>
<!-- layer13_input -->
<g id="node197" class="node">
<title>layer13_input</title>
<polygon fill="lightyellow" stroke="black" points="563.19,-6563 365.42,-6563 314.55,-6427 512.32,-6427 563.19,-6563"/>
<text text-anchor="middle" x="438.87" y="-6513.8" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="438.87" y="-6498.8" font-family="Times,serif" font-size="14.00">From: GPU 12</text>
<text text-anchor="middle" x="438.87" y="-6483.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="438.87" y="-6468.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer12_output&#45;&gt;layer13_input -->
<g id="edge235" class="edge">
<title>layer12_output&#45;&gt;layer13_input</title>
<path fill="none" stroke="black" d="M438.87,-6634.89C438.87,-6634.89 438.87,-6573.26 438.87,-6573.26"/>
<polygon fill="black" stroke="black" points="442.37,-6573.26 438.87,-6563.26 435.37,-6573.26 442.37,-6573.26"/>
</g>
<!-- lay13_qkv_proj -->
<g id="node198" class="node">
<title>lay13_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="547.37,-6355 330.37,-6355 330.37,-6287 547.37,-6287 547.37,-6355"/>
<text text-anchor="middle" x="438.87" y="-6339.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="438.87" y="-6324.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="438.87" y="-6309.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="438.87" y="-6294.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_input&#45;&gt;lay13_qkv_proj -->
<g id="edge236" class="edge">
<title>layer13_input&#45;&gt;lay13_qkv_proj</title>
<path fill="none" stroke="black" d="M438.87,-6426.73C438.87,-6426.73 438.87,-6365.11 438.87,-6365.11"/>
<polygon fill="black" stroke="black" points="442.37,-6365.11 438.87,-6355.11 435.37,-6365.11 442.37,-6365.11"/>
</g>
<!-- lay13_res1 -->
<g id="node202" class="node">
<title>lay13_res1</title>
<ellipse fill="lightgray" stroke="black" cx="446.87" cy="-5746.92" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="446.87" y="-5765.72" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="446.87" y="-5750.72" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-5735.72" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-5720.72" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_input&#45;&gt;lay13_res1 -->
<g id="edge241" class="edge">
<title>layer13_input&#45;&gt;lay13_res1</title>
<path fill="none" stroke="black" d="M557.32,-6494.86C557.32,-6494.86 557.32,-5799.46 557.32,-5799.46"/>
<polygon fill="black" stroke="black" points="560.82,-5799.46 557.32,-5789.46 553.82,-5799.46 560.82,-5799.46"/>
</g>
<!-- lay13_attn_score -->
<g id="node199" class="node">
<title>lay13_attn_score</title>
<polygon fill="lightpink" stroke="black" points="551.37,-6215 196.37,-6215 196.37,-6147 551.37,-6147 551.37,-6215"/>
<text text-anchor="middle" x="373.87" y="-6199.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="373.87" y="-6184.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="373.87" y="-6169.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="373.87" y="-6154.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_qkv_proj&#45;&gt;lay13_attn_score -->
<g id="edge237" class="edge">
<title>lay13_qkv_proj&#45;&gt;lay13_attn_score</title>
<path fill="none" stroke="black" d="M438.87,-6286.75C438.87,-6286.75 438.87,-6225.38 438.87,-6225.38"/>
<polygon fill="black" stroke="black" points="442.37,-6225.38 438.87,-6215.38 435.37,-6225.38 442.37,-6225.38"/>
</g>
<!-- lay13_attn_concat -->
<g id="node200" class="node">
<title>lay13_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="509.37,-6075 304.37,-6075 304.37,-6007 509.37,-6007 509.37,-6075"/>
<text text-anchor="middle" x="406.87" y="-6059.8" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="406.87" y="-6044.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="406.87" y="-6029.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="406.87" y="-6014.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_attn_score&#45;&gt;lay13_attn_concat -->
<g id="edge238" class="edge">
<title>lay13_attn_score&#45;&gt;lay13_attn_concat</title>
<path fill="none" stroke="black" d="M406.87,-6146.75C406.87,-6146.75 406.87,-6085.38 406.87,-6085.38"/>
<polygon fill="black" stroke="black" points="410.37,-6085.38 406.87,-6075.38 403.37,-6085.38 410.37,-6085.38"/>
</g>
<!-- lay13_attn_out -->
<g id="node201" class="node">
<title>lay13_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="549.37,-5935 334.37,-5935 334.37,-5867 549.37,-5867 549.37,-5935"/>
<text text-anchor="middle" x="441.87" y="-5919.8" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="441.87" y="-5904.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="441.87" y="-5889.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="441.87" y="-5874.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_attn_concat&#45;&gt;lay13_attn_out -->
<g id="edge239" class="edge">
<title>lay13_attn_concat&#45;&gt;lay13_attn_out</title>
<path fill="none" stroke="black" d="M421.87,-6006.75C421.87,-6006.75 421.87,-5945.38 421.87,-5945.38"/>
<polygon fill="black" stroke="black" points="425.37,-5945.38 421.87,-5935.38 418.37,-5945.38 425.37,-5945.38"/>
</g>
<!-- lay13_attn_out&#45;&gt;lay13_res1 -->
<g id="edge240" class="edge">
<title>lay13_attn_out&#45;&gt;lay13_res1</title>
<path fill="none" stroke="black" d="M441.87,-5866.8C441.87,-5866.8 441.87,-5805.04 441.87,-5805.04"/>
<polygon fill="black" stroke="black" points="445.37,-5805.04 441.87,-5795.04 438.37,-5805.04 445.37,-5805.04"/>
</g>
<!-- lay13_ln1 -->
<g id="node203" class="node">
<title>lay13_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="579.37,-5626.83 376.37,-5626.83 376.37,-5558.83 579.37,-5558.83 579.37,-5626.83"/>
<text text-anchor="middle" x="477.87" y="-5611.63" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="477.87" y="-5596.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="477.87" y="-5581.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="477.87" y="-5566.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_res1&#45;&gt;lay13_ln1 -->
<g id="edge242" class="edge">
<title>lay13_res1&#45;&gt;lay13_ln1</title>
<path fill="none" stroke="black" d="M477.87,-5699.01C477.87,-5699.01 477.87,-5637.02 477.87,-5637.02"/>
<polygon fill="black" stroke="black" points="481.37,-5637.02 477.87,-5627.02 474.37,-5637.02 481.37,-5637.02"/>
</g>
<!-- lay13_mlp_gate -->
<g id="node204" class="node">
<title>lay13_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="419.87,-5486.83 207.87,-5486.83 207.87,-5418.83 419.87,-5418.83 419.87,-5486.83"/>
<text text-anchor="middle" x="313.87" y="-5471.63" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="313.87" y="-5456.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="313.87" y="-5441.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="313.87" y="-5426.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_ln1&#45;&gt;lay13_mlp_gate -->
<g id="edge243" class="edge">
<title>lay13_ln1&#45;&gt;lay13_mlp_gate</title>
<path fill="none" stroke="black" d="M398.12,-5558.58C398.12,-5558.58 398.12,-5497.21 398.12,-5497.21"/>
<polygon fill="black" stroke="black" points="401.62,-5497.21 398.12,-5487.21 394.62,-5497.21 401.62,-5497.21"/>
</g>
<!-- lay13_mlp_up -->
<g id="node205" class="node">
<title>lay13_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="640.87,-5346.83 428.87,-5346.83 428.87,-5278.83 640.87,-5278.83 640.87,-5346.83"/>
<text text-anchor="middle" x="534.87" y="-5331.63" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="534.87" y="-5316.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="534.87" y="-5301.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="534.87" y="-5286.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_ln1&#45;&gt;lay13_mlp_up -->
<g id="edge244" class="edge">
<title>lay13_ln1&#45;&gt;lay13_mlp_up</title>
<path fill="none" stroke="black" d="M504.12,-5558.78C504.12,-5558.78 504.12,-5357.09 504.12,-5357.09"/>
<polygon fill="black" stroke="black" points="507.62,-5357.09 504.12,-5347.09 500.62,-5357.09 507.62,-5357.09"/>
</g>
<!-- lay13_res2 -->
<g id="node209" class="node">
<title>lay13_res2</title>
<ellipse fill="lightgray" stroke="black" cx="446.87" cy="-4878.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="446.87" y="-4897.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="446.87" y="-4882.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-4867.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-4852.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_ln1&#45;&gt;lay13_res2 -->
<g id="edge250" class="edge">
<title>lay13_ln1&#45;&gt;lay13_res2</title>
<path fill="none" stroke="black" d="M579.49,-5592C621.17,-5592 659.84,-5592 659.84,-5592 659.84,-5592 659.84,-4907.83 659.84,-4907.83"/>
<polygon fill="black" stroke="black" points="663.34,-4907.83 659.84,-4897.83 656.34,-4907.83 663.34,-4907.83"/>
</g>
<!-- lay13_mlp_act -->
<g id="node206" class="node">
<title>lay13_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="392.87,-5346.83 180.87,-5346.83 180.87,-5278.83 392.87,-5278.83 392.87,-5346.83"/>
<text text-anchor="middle" x="286.87" y="-5331.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="286.87" y="-5316.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="286.87" y="-5301.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="286.87" y="-5286.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_mlp_gate&#45;&gt;lay13_mlp_act -->
<g id="edge245" class="edge">
<title>lay13_mlp_gate&#45;&gt;lay13_mlp_act</title>
<path fill="none" stroke="black" d="M300.37,-5418.58C300.37,-5418.58 300.37,-5357.21 300.37,-5357.21"/>
<polygon fill="black" stroke="black" points="303.87,-5357.21 300.37,-5347.21 296.87,-5357.21 303.87,-5357.21"/>
</g>
<!-- lay13_mlp_mul -->
<g id="node207" class="node">
<title>lay13_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="619.87,-5206.83 273.87,-5206.83 273.87,-5138.83 619.87,-5138.83 619.87,-5206.83"/>
<text text-anchor="middle" x="446.87" y="-5191.63" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="446.87" y="-5176.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="446.87" y="-5161.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="446.87" y="-5146.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_mlp_up&#45;&gt;lay13_mlp_mul -->
<g id="edge246" class="edge">
<title>lay13_mlp_up&#45;&gt;lay13_mlp_mul</title>
<path fill="none" stroke="black" d="M524.37,-5278.58C524.37,-5278.58 524.37,-5217.21 524.37,-5217.21"/>
<polygon fill="black" stroke="black" points="527.87,-5217.21 524.37,-5207.21 520.87,-5217.21 527.87,-5217.21"/>
</g>
<!-- lay13_mlp_act&#45;&gt;lay13_mlp_mul -->
<g id="edge247" class="edge">
<title>lay13_mlp_act&#45;&gt;lay13_mlp_mul</title>
<path fill="none" stroke="black" d="M333.37,-5278.58C333.37,-5278.58 333.37,-5217.21 333.37,-5217.21"/>
<polygon fill="black" stroke="black" points="336.87,-5217.21 333.37,-5207.21 329.87,-5217.21 336.87,-5217.21"/>
</g>
<!-- lay13_mlp_down -->
<g id="node208" class="node">
<title>lay13_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="548.37,-5066.83 345.37,-5066.83 345.37,-4998.83 548.37,-4998.83 548.37,-5066.83"/>
<text text-anchor="middle" x="446.87" y="-5051.63" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="446.87" y="-5036.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="446.87" y="-5021.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_mlp_mul&#45;&gt;lay13_mlp_down -->
<g id="edge248" class="edge">
<title>lay13_mlp_mul&#45;&gt;lay13_mlp_down</title>
<path fill="none" stroke="black" d="M446.87,-5138.58C446.87,-5138.58 446.87,-5077.21 446.87,-5077.21"/>
<polygon fill="black" stroke="black" points="450.37,-5077.21 446.87,-5067.21 443.37,-5077.21 450.37,-5077.21"/>
</g>
<!-- lay13_mlp_down&#45;&gt;lay13_res2 -->
<g id="edge249" class="edge">
<title>lay13_mlp_down&#45;&gt;lay13_res2</title>
<path fill="none" stroke="black" d="M446.87,-4998.64C446.87,-4998.64 446.87,-4936.88 446.87,-4936.88"/>
<polygon fill="black" stroke="black" points="450.37,-4936.88 446.87,-4926.88 443.37,-4936.88 450.37,-4936.88"/>
</g>
<!-- lay13_ln2 -->
<g id="node210" class="node">
<title>lay13_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="548.37,-4758.67 345.37,-4758.67 345.37,-4690.67 548.37,-4690.67 548.37,-4758.67"/>
<text text-anchor="middle" x="446.87" y="-4743.47" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="446.87" y="-4728.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-4713.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="446.87" y="-4698.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_res2&#45;&gt;lay13_ln2 -->
<g id="edge251" class="edge">
<title>lay13_res2&#45;&gt;lay13_ln2</title>
<path fill="none" stroke="black" d="M446.87,-4830.42C446.87,-4830.42 446.87,-4769.14 446.87,-4769.14"/>
<polygon fill="black" stroke="black" points="450.37,-4769.14 446.87,-4759.14 443.37,-4769.14 450.37,-4769.14"/>
</g>
<!-- layer13_output -->
<g id="node211" class="node">
<title>layer13_output</title>
<polygon fill="lightyellow" stroke="black" points="583.57,-4618.67 366.11,-4618.67 310.17,-4482.67 527.63,-4482.67 583.57,-4618.67"/>
<text text-anchor="middle" x="446.87" y="-4569.47" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="446.87" y="-4554.47" font-family="Times,serif" font-size="14.00">To: GPU 14</text>
<text text-anchor="middle" x="446.87" y="-4539.47" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="446.87" y="-4524.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- lay13_ln2&#45;&gt;layer13_output -->
<g id="edge252" class="edge">
<title>lay13_ln2&#45;&gt;layer13_output</title>
<path fill="none" stroke="black" d="M446.87,-4690.29C446.87,-4690.29 446.87,-4628.81 446.87,-4628.81"/>
<polygon fill="black" stroke="black" points="450.37,-4628.81 446.87,-4618.81 443.37,-4628.81 450.37,-4628.81"/>
</g>
<!-- layer14_input -->
<g id="node212" class="node">
<title>layer14_input</title>
<polygon fill="lightyellow" stroke="black" points="571.19,-4410.67 373.42,-4410.67 322.55,-4274.67 520.32,-4274.67 571.19,-4410.67"/>
<text text-anchor="middle" x="446.87" y="-4361.47" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="446.87" y="-4346.47" font-family="Times,serif" font-size="14.00">From: GPU 13</text>
<text text-anchor="middle" x="446.87" y="-4331.47" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="446.87" y="-4316.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer13_output&#45;&gt;layer14_input -->
<g id="edge253" class="edge">
<title>layer13_output&#45;&gt;layer14_input</title>
<path fill="none" stroke="black" d="M446.87,-4482.56C446.87,-4482.56 446.87,-4420.93 446.87,-4420.93"/>
<polygon fill="black" stroke="black" points="450.37,-4420.93 446.87,-4410.93 443.37,-4420.93 450.37,-4420.93"/>
</g>
<!-- lay14_qkv_proj -->
<g id="node213" class="node">
<title>lay14_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="526.37,-4202.67 309.37,-4202.67 309.37,-4134.67 526.37,-4134.67 526.37,-4202.67"/>
<text text-anchor="middle" x="417.87" y="-4187.47" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="417.87" y="-4172.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="417.87" y="-4157.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="417.87" y="-4142.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_input&#45;&gt;lay14_qkv_proj -->
<g id="edge254" class="edge">
<title>layer14_input&#45;&gt;lay14_qkv_proj</title>
<path fill="none" stroke="black" d="M424.41,-4274.4C424.41,-4274.4 424.41,-4212.78 424.41,-4212.78"/>
<polygon fill="black" stroke="black" points="427.91,-4212.78 424.41,-4202.78 420.91,-4212.78 427.91,-4212.78"/>
</g>
<!-- lay14_res1 -->
<g id="node217" class="node">
<title>lay14_res1</title>
<ellipse fill="lightgray" stroke="black" cx="454.87" cy="-3594.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="454.87" y="-3613.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="454.87" y="-3598.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-3583.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-3568.38" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_input&#45;&gt;lay14_res1 -->
<g id="edge259" class="edge">
<title>layer14_input&#45;&gt;lay14_res1</title>
<path fill="none" stroke="black" d="M565.82,-4342.53C565.82,-4342.53 565.82,-3646.86 565.82,-3646.86"/>
<polygon fill="black" stroke="black" points="569.32,-3646.86 565.82,-3636.86 562.32,-3646.86 569.32,-3646.86"/>
</g>
<!-- lay14_attn_score -->
<g id="node214" class="node">
<title>lay14_attn_score</title>
<polygon fill="lightpink" stroke="black" points="560.37,-4062.67 205.37,-4062.67 205.37,-3994.67 560.37,-3994.67 560.37,-4062.67"/>
<text text-anchor="middle" x="382.87" y="-4047.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="382.87" y="-4032.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="382.87" y="-4017.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="382.87" y="-4002.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_qkv_proj&#45;&gt;lay14_attn_score -->
<g id="edge255" class="edge">
<title>lay14_qkv_proj&#45;&gt;lay14_attn_score</title>
<path fill="none" stroke="black" d="M417.87,-4134.42C417.87,-4134.42 417.87,-4073.05 417.87,-4073.05"/>
<polygon fill="black" stroke="black" points="421.37,-4073.05 417.87,-4063.05 414.37,-4073.05 421.37,-4073.05"/>
</g>
<!-- lay14_attn_concat -->
<g id="node215" class="node">
<title>lay14_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="507.37,-3922.67 302.37,-3922.67 302.37,-3854.67 507.37,-3854.67 507.37,-3922.67"/>
<text text-anchor="middle" x="404.87" y="-3907.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="404.87" y="-3892.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="404.87" y="-3877.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="404.87" y="-3862.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_attn_score&#45;&gt;lay14_attn_concat -->
<g id="edge256" class="edge">
<title>lay14_attn_score&#45;&gt;lay14_attn_concat</title>
<path fill="none" stroke="black" d="M404.87,-3994.42C404.87,-3994.42 404.87,-3933.05 404.87,-3933.05"/>
<polygon fill="black" stroke="black" points="408.37,-3933.05 404.87,-3923.05 401.37,-3933.05 408.37,-3933.05"/>
</g>
<!-- lay14_attn_out -->
<g id="node216" class="node">
<title>lay14_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="547.37,-3782.67 332.37,-3782.67 332.37,-3714.67 547.37,-3714.67 547.37,-3782.67"/>
<text text-anchor="middle" x="439.87" y="-3767.47" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="439.87" y="-3752.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="439.87" y="-3737.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="439.87" y="-3722.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_attn_concat&#45;&gt;lay14_attn_out -->
<g id="edge257" class="edge">
<title>lay14_attn_concat&#45;&gt;lay14_attn_out</title>
<path fill="none" stroke="black" d="M419.87,-3854.42C419.87,-3854.42 419.87,-3793.05 419.87,-3793.05"/>
<polygon fill="black" stroke="black" points="423.37,-3793.05 419.87,-3783.05 416.37,-3793.05 423.37,-3793.05"/>
</g>
<!-- lay14_attn_out&#45;&gt;lay14_res1 -->
<g id="edge258" class="edge">
<title>lay14_attn_out&#45;&gt;lay14_res1</title>
<path fill="none" stroke="black" d="M439.87,-3714.47C439.87,-3714.47 439.87,-3652.71 439.87,-3652.71"/>
<polygon fill="black" stroke="black" points="443.37,-3652.71 439.87,-3642.71 436.37,-3652.71 443.37,-3652.71"/>
</g>
<!-- lay14_ln1 -->
<g id="node218" class="node">
<title>lay14_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="587.37,-3474.5 384.37,-3474.5 384.37,-3406.5 587.37,-3406.5 587.37,-3474.5"/>
<text text-anchor="middle" x="485.87" y="-3459.3" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="485.87" y="-3444.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="485.87" y="-3429.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="485.87" y="-3414.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_res1&#45;&gt;lay14_ln1 -->
<g id="edge260" class="edge">
<title>lay14_res1&#45;&gt;lay14_ln1</title>
<path fill="none" stroke="black" d="M485.87,-3546.67C485.87,-3546.67 485.87,-3484.68 485.87,-3484.68"/>
<polygon fill="black" stroke="black" points="489.37,-3484.68 485.87,-3474.68 482.37,-3484.68 489.37,-3484.68"/>
</g>
<!-- lay14_mlp_gate -->
<g id="node219" class="node">
<title>lay14_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="427.87,-3334.5 215.87,-3334.5 215.87,-3266.5 427.87,-3266.5 427.87,-3334.5"/>
<text text-anchor="middle" x="321.87" y="-3319.3" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="321.87" y="-3304.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="321.87" y="-3289.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="321.87" y="-3274.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_ln1&#45;&gt;lay14_mlp_gate -->
<g id="edge261" class="edge">
<title>lay14_ln1&#45;&gt;lay14_mlp_gate</title>
<path fill="none" stroke="black" d="M406.12,-3406.25C406.12,-3406.25 406.12,-3344.88 406.12,-3344.88"/>
<polygon fill="black" stroke="black" points="409.62,-3344.88 406.12,-3334.88 402.62,-3344.88 409.62,-3344.88"/>
</g>
<!-- lay14_mlp_up -->
<g id="node220" class="node">
<title>lay14_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="648.87,-3194.5 436.87,-3194.5 436.87,-3126.5 648.87,-3126.5 648.87,-3194.5"/>
<text text-anchor="middle" x="542.87" y="-3179.3" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="542.87" y="-3164.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="542.87" y="-3149.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="542.87" y="-3134.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_ln1&#45;&gt;lay14_mlp_up -->
<g id="edge262" class="edge">
<title>lay14_ln1&#45;&gt;lay14_mlp_up</title>
<path fill="none" stroke="black" d="M512.12,-3406.45C512.12,-3406.45 512.12,-3204.75 512.12,-3204.75"/>
<polygon fill="black" stroke="black" points="515.62,-3204.75 512.12,-3194.75 508.62,-3204.75 515.62,-3204.75"/>
</g>
<!-- lay14_res2 -->
<g id="node224" class="node">
<title>lay14_res2</title>
<ellipse fill="lightgray" stroke="black" cx="454.87" cy="-2726.42" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="454.87" y="-2745.22" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="454.87" y="-2730.22" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-2715.22" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-2700.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_ln1&#45;&gt;lay14_res2 -->
<g id="edge268" class="edge">
<title>lay14_ln1&#45;&gt;lay14_res2</title>
<path fill="none" stroke="black" d="M587.49,-3440C629.17,-3440 667.84,-3440 667.84,-3440 667.84,-3440 667.84,-2755.5 667.84,-2755.5"/>
<polygon fill="black" stroke="black" points="671.34,-2755.5 667.84,-2745.5 664.34,-2755.5 671.34,-2755.5"/>
</g>
<!-- lay14_mlp_act -->
<g id="node221" class="node">
<title>lay14_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="400.87,-3194.5 188.87,-3194.5 188.87,-3126.5 400.87,-3126.5 400.87,-3194.5"/>
<text text-anchor="middle" x="294.87" y="-3179.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="294.87" y="-3164.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="294.87" y="-3149.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="294.87" y="-3134.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_mlp_gate&#45;&gt;lay14_mlp_act -->
<g id="edge263" class="edge">
<title>lay14_mlp_gate&#45;&gt;lay14_mlp_act</title>
<path fill="none" stroke="black" d="M308.37,-3266.25C308.37,-3266.25 308.37,-3204.88 308.37,-3204.88"/>
<polygon fill="black" stroke="black" points="311.87,-3204.88 308.37,-3194.88 304.87,-3204.88 311.87,-3204.88"/>
</g>
<!-- lay14_mlp_mul -->
<g id="node222" class="node">
<title>lay14_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="627.87,-3054.5 281.87,-3054.5 281.87,-2986.5 627.87,-2986.5 627.87,-3054.5"/>
<text text-anchor="middle" x="454.87" y="-3039.3" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="454.87" y="-3024.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="454.87" y="-3009.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="454.87" y="-2994.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_mlp_up&#45;&gt;lay14_mlp_mul -->
<g id="edge264" class="edge">
<title>lay14_mlp_up&#45;&gt;lay14_mlp_mul</title>
<path fill="none" stroke="black" d="M532.37,-3126.25C532.37,-3126.25 532.37,-3064.88 532.37,-3064.88"/>
<polygon fill="black" stroke="black" points="535.87,-3064.88 532.37,-3054.88 528.87,-3064.88 535.87,-3064.88"/>
</g>
<!-- lay14_mlp_act&#45;&gt;lay14_mlp_mul -->
<g id="edge265" class="edge">
<title>lay14_mlp_act&#45;&gt;lay14_mlp_mul</title>
<path fill="none" stroke="black" d="M341.37,-3126.25C341.37,-3126.25 341.37,-3064.88 341.37,-3064.88"/>
<polygon fill="black" stroke="black" points="344.87,-3064.88 341.37,-3054.88 337.87,-3064.88 344.87,-3064.88"/>
</g>
<!-- lay14_mlp_down -->
<g id="node223" class="node">
<title>lay14_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="556.37,-2914.5 353.37,-2914.5 353.37,-2846.5 556.37,-2846.5 556.37,-2914.5"/>
<text text-anchor="middle" x="454.87" y="-2899.3" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="454.87" y="-2884.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="454.87" y="-2869.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-2854.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_mlp_mul&#45;&gt;lay14_mlp_down -->
<g id="edge266" class="edge">
<title>lay14_mlp_mul&#45;&gt;lay14_mlp_down</title>
<path fill="none" stroke="black" d="M454.87,-2986.25C454.87,-2986.25 454.87,-2924.88 454.87,-2924.88"/>
<polygon fill="black" stroke="black" points="458.37,-2924.88 454.87,-2914.88 451.37,-2924.88 458.37,-2924.88"/>
</g>
<!-- lay14_mlp_down&#45;&gt;lay14_res2 -->
<g id="edge267" class="edge">
<title>lay14_mlp_down&#45;&gt;lay14_res2</title>
<path fill="none" stroke="black" d="M454.87,-2846.3C454.87,-2846.3 454.87,-2784.54 454.87,-2784.54"/>
<polygon fill="black" stroke="black" points="458.37,-2784.54 454.87,-2774.54 451.37,-2784.54 458.37,-2784.54"/>
</g>
<!-- lay14_ln2 -->
<g id="node225" class="node">
<title>lay14_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="556.37,-2606.33 353.37,-2606.33 353.37,-2538.33 556.37,-2538.33 556.37,-2606.33"/>
<text text-anchor="middle" x="454.87" y="-2591.13" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="454.87" y="-2576.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-2561.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="454.87" y="-2546.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_res2&#45;&gt;lay14_ln2 -->
<g id="edge269" class="edge">
<title>lay14_res2&#45;&gt;lay14_ln2</title>
<path fill="none" stroke="black" d="M454.87,-2678.09C454.87,-2678.09 454.87,-2616.81 454.87,-2616.81"/>
<polygon fill="black" stroke="black" points="458.37,-2616.81 454.87,-2606.81 451.37,-2616.81 458.37,-2616.81"/>
</g>
<!-- layer14_output -->
<g id="node226" class="node">
<title>layer14_output</title>
<polygon fill="lightyellow" stroke="black" points="591.57,-2466.33 374.11,-2466.33 318.17,-2330.33 535.63,-2330.33 591.57,-2466.33"/>
<text text-anchor="middle" x="454.87" y="-2417.13" font-family="Times,serif" font-size="14.00">Output Transfer</text>
<text text-anchor="middle" x="454.87" y="-2402.13" font-family="Times,serif" font-size="14.00">To: GPU 15</text>
<text text-anchor="middle" x="454.87" y="-2387.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="454.87" y="-2372.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- lay14_ln2&#45;&gt;layer14_output -->
<g id="edge270" class="edge">
<title>lay14_ln2&#45;&gt;layer14_output</title>
<path fill="none" stroke="black" d="M454.87,-2537.96C454.87,-2537.96 454.87,-2476.47 454.87,-2476.47"/>
<polygon fill="black" stroke="black" points="458.37,-2476.47 454.87,-2466.47 451.37,-2476.47 458.37,-2476.47"/>
</g>
<!-- layer15_input -->
<g id="node227" class="node">
<title>layer15_input</title>
<polygon fill="lightyellow" stroke="black" points="579.19,-2258.33 381.42,-2258.33 330.55,-2122.33 528.32,-2122.33 579.19,-2258.33"/>
<text text-anchor="middle" x="454.87" y="-2209.13" font-family="Times,serif" font-size="14.00">Input Transfer</text>
<text text-anchor="middle" x="454.87" y="-2194.13" font-family="Times,serif" font-size="14.00">From: GPU 14</text>
<text text-anchor="middle" x="454.87" y="-2179.13" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="454.87" y="-2164.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer14_output&#45;&gt;layer15_input -->
<g id="edge271" class="edge">
<title>layer14_output&#45;&gt;layer15_input</title>
<path fill="none" stroke="black" d="M454.87,-2330.23C454.87,-2330.23 454.87,-2268.59 454.87,-2268.59"/>
<polygon fill="black" stroke="black" points="458.37,-2268.59 454.87,-2258.59 451.37,-2268.59 458.37,-2268.59"/>
</g>
<!-- lay15_qkv_proj -->
<g id="node228" class="node">
<title>lay15_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="537.37,-2050.33 320.37,-2050.33 320.37,-1982.33 537.37,-1982.33 537.37,-2050.33"/>
<text text-anchor="middle" x="428.87" y="-2035.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="428.87" y="-2020.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="428.87" y="-2005.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="428.87" y="-1990.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_input&#45;&gt;lay15_qkv_proj -->
<g id="edge272" class="edge">
<title>layer15_input&#45;&gt;lay15_qkv_proj</title>
<path fill="none" stroke="black" d="M433.91,-2122.06C433.91,-2122.06 433.91,-2060.44 433.91,-2060.44"/>
<polygon fill="black" stroke="black" points="437.41,-2060.44 433.91,-2050.44 430.41,-2060.44 437.41,-2060.44"/>
</g>
<!-- lay15_res1 -->
<g id="node232" class="node">
<title>lay15_res1</title>
<ellipse fill="lightgray" stroke="black" cx="435.87" cy="-1442.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="435.87" y="-1461.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="435.87" y="-1446.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-1431.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-1416.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_input&#45;&gt;lay15_res1 -->
<g id="edge277" class="edge">
<title>layer15_input&#45;&gt;lay15_res1</title>
<path fill="none" stroke="black" d="M568.32,-2190.2C568.32,-2190.2 568.32,-1491.88 568.32,-1491.88"/>
<polygon fill="black" stroke="black" points="571.82,-1491.88 568.32,-1481.88 564.82,-1491.88 571.82,-1491.88"/>
</g>
<!-- lay15_attn_score -->
<g id="node229" class="node">
<title>lay15_attn_score</title>
<polygon fill="lightpink" stroke="black" points="557.37,-1910.33 202.37,-1910.33 202.37,-1842.33 557.37,-1842.33 557.37,-1910.33"/>
<text text-anchor="middle" x="379.87" y="-1895.13" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="379.87" y="-1880.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128], [128,10000,32,128]</text>
<text text-anchor="middle" x="379.87" y="-1865.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="379.87" y="-1850.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_qkv_proj&#45;&gt;lay15_attn_score -->
<g id="edge273" class="edge">
<title>lay15_qkv_proj&#45;&gt;lay15_attn_score</title>
<path fill="none" stroke="black" d="M428.87,-1982.09C428.87,-1982.09 428.87,-1920.71 428.87,-1920.71"/>
<polygon fill="black" stroke="black" points="432.37,-1920.71 428.87,-1910.71 425.37,-1920.71 432.37,-1920.71"/>
</g>
<!-- lay15_attn_concat -->
<g id="node230" class="node">
<title>lay15_attn_concat</title>
<polygon fill="lightpink" stroke="black" points="512.37,-1770.33 307.37,-1770.33 307.37,-1702.33 512.37,-1702.33 512.37,-1770.33"/>
<text text-anchor="middle" x="409.87" y="-1755.13" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="409.87" y="-1740.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="409.87" y="-1725.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="409.87" y="-1710.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_attn_score&#45;&gt;lay15_attn_concat -->
<g id="edge274" class="edge">
<title>lay15_attn_score&#45;&gt;lay15_attn_concat</title>
<path fill="none" stroke="black" d="M409.87,-1842.09C409.87,-1842.09 409.87,-1780.71 409.87,-1780.71"/>
<polygon fill="black" stroke="black" points="413.37,-1780.71 409.87,-1770.71 406.37,-1780.71 413.37,-1780.71"/>
</g>
<!-- lay15_attn_out -->
<g id="node231" class="node">
<title>lay15_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="532.37,-1630.33 317.37,-1630.33 317.37,-1562.33 532.37,-1562.33 532.37,-1630.33"/>
<text text-anchor="middle" x="424.87" y="-1615.13" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="424.87" y="-1600.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="424.87" y="-1585.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="424.87" y="-1570.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_attn_concat&#45;&gt;lay15_attn_out -->
<g id="edge275" class="edge">
<title>lay15_attn_concat&#45;&gt;lay15_attn_out</title>
<path fill="none" stroke="black" d="M414.87,-1702.09C414.87,-1702.09 414.87,-1640.71 414.87,-1640.71"/>
<polygon fill="black" stroke="black" points="418.37,-1640.71 414.87,-1630.71 411.37,-1640.71 418.37,-1640.71"/>
</g>
<!-- lay15_attn_out&#45;&gt;lay15_res1 -->
<g id="edge276" class="edge">
<title>lay15_attn_out&#45;&gt;lay15_res1</title>
<path fill="none" stroke="black" d="M424.87,-1562.14C424.87,-1562.14 424.87,-1500.38 424.87,-1500.38"/>
<polygon fill="black" stroke="black" points="428.37,-1500.38 424.87,-1490.38 421.37,-1500.38 428.37,-1500.38"/>
</g>
<!-- lay15_ln1 -->
<g id="node233" class="node">
<title>lay15_ln1</title>
<polygon fill="lightsteelblue" stroke="black" points="568.37,-1322.17 365.37,-1322.17 365.37,-1254.17 568.37,-1254.17 568.37,-1322.17"/>
<text text-anchor="middle" x="466.87" y="-1306.97" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="466.87" y="-1291.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="466.87" y="-1276.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="466.87" y="-1261.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_res1&#45;&gt;lay15_ln1 -->
<g id="edge278" class="edge">
<title>lay15_res1&#45;&gt;lay15_ln1</title>
<path fill="none" stroke="black" d="M466.87,-1394.34C466.87,-1394.34 466.87,-1332.35 466.87,-1332.35"/>
<polygon fill="black" stroke="black" points="470.37,-1332.35 466.87,-1322.35 463.37,-1332.35 470.37,-1332.35"/>
</g>
<!-- lay15_mlp_gate -->
<g id="node234" class="node">
<title>lay15_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="408.87,-1182.17 196.87,-1182.17 196.87,-1114.17 408.87,-1114.17 408.87,-1182.17"/>
<text text-anchor="middle" x="302.87" y="-1166.97" font-family="Times,serif" font-size="14.00">MLP Gate Projection</text>
<text text-anchor="middle" x="302.87" y="-1151.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="302.87" y="-1136.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="302.87" y="-1121.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_ln1&#45;&gt;lay15_mlp_gate -->
<g id="edge279" class="edge">
<title>lay15_ln1&#45;&gt;lay15_mlp_gate</title>
<path fill="none" stroke="black" d="M387.12,-1253.92C387.12,-1253.92 387.12,-1192.55 387.12,-1192.55"/>
<polygon fill="black" stroke="black" points="390.62,-1192.55 387.12,-1182.55 383.62,-1192.55 390.62,-1192.55"/>
</g>
<!-- lay15_mlp_up -->
<g id="node235" class="node">
<title>lay15_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="629.87,-1042.17 417.87,-1042.17 417.87,-974.17 629.87,-974.17 629.87,-1042.17"/>
<text text-anchor="middle" x="523.87" y="-1026.97" font-family="Times,serif" font-size="14.00">MLP Up Projection</text>
<text text-anchor="middle" x="523.87" y="-1011.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="523.87" y="-996.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="523.87" y="-981.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_ln1&#45;&gt;lay15_mlp_up -->
<g id="edge280" class="edge">
<title>lay15_ln1&#45;&gt;lay15_mlp_up</title>
<path fill="none" stroke="black" d="M493.12,-1254.11C493.12,-1254.11 493.12,-1052.42 493.12,-1052.42"/>
<polygon fill="black" stroke="black" points="496.62,-1052.42 493.12,-1042.42 489.62,-1052.42 496.62,-1052.42"/>
</g>
<!-- lay15_res2 -->
<g id="node239" class="node">
<title>lay15_res2</title>
<ellipse fill="lightgray" stroke="black" cx="435.87" cy="-574.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="435.87" y="-592.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="435.87" y="-577.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-562.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-547.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_ln1&#45;&gt;lay15_res2 -->
<g id="edge286" class="edge">
<title>lay15_ln1&#45;&gt;lay15_res2</title>
<path fill="none" stroke="black" d="M568.49,-1288C610.17,-1288 648.84,-1288 648.84,-1288 648.84,-1288 648.84,-603.18 648.84,-603.18"/>
<polygon fill="black" stroke="black" points="652.34,-603.18 648.84,-593.18 645.34,-603.18 652.34,-603.18"/>
</g>
<!-- lay15_mlp_act -->
<g id="node236" class="node">
<title>lay15_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="381.87,-1042.17 169.87,-1042.17 169.87,-974.17 381.87,-974.17 381.87,-1042.17"/>
<text text-anchor="middle" x="275.87" y="-1026.97" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="275.87" y="-1011.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="275.87" y="-996.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="275.87" y="-981.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_mlp_gate&#45;&gt;lay15_mlp_act -->
<g id="edge281" class="edge">
<title>lay15_mlp_gate&#45;&gt;lay15_mlp_act</title>
<path fill="none" stroke="black" d="M289.37,-1113.92C289.37,-1113.92 289.37,-1052.55 289.37,-1052.55"/>
<polygon fill="black" stroke="black" points="292.87,-1052.55 289.37,-1042.55 285.87,-1052.55 292.87,-1052.55"/>
</g>
<!-- lay15_mlp_mul -->
<g id="node237" class="node">
<title>lay15_mlp_mul</title>
<polygon fill="lightblue" stroke="black" points="608.87,-902.17 262.87,-902.17 262.87,-834.17 608.87,-834.17 608.87,-902.17"/>
<text text-anchor="middle" x="435.87" y="-886.97" font-family="Times,serif" font-size="14.00">Element&#45;wise Mul</text>
<text text-anchor="middle" x="435.87" y="-871.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384], [128,10000,16384]</text>
<text text-anchor="middle" x="435.87" y="-856.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="435.87" y="-841.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_mlp_up&#45;&gt;lay15_mlp_mul -->
<g id="edge282" class="edge">
<title>lay15_mlp_up&#45;&gt;lay15_mlp_mul</title>
<path fill="none" stroke="black" d="M513.37,-973.92C513.37,-973.92 513.37,-912.55 513.37,-912.55"/>
<polygon fill="black" stroke="black" points="516.87,-912.55 513.37,-902.55 509.87,-912.55 516.87,-912.55"/>
</g>
<!-- lay15_mlp_act&#45;&gt;lay15_mlp_mul -->
<g id="edge283" class="edge">
<title>lay15_mlp_act&#45;&gt;lay15_mlp_mul</title>
<path fill="none" stroke="black" d="M322.37,-973.92C322.37,-973.92 322.37,-912.55 322.37,-912.55"/>
<polygon fill="black" stroke="black" points="325.87,-912.55 322.37,-902.55 318.87,-912.55 325.87,-912.55"/>
</g>
<!-- lay15_mlp_down -->
<g id="node238" class="node">
<title>lay15_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="537.37,-762.17 334.37,-762.17 334.37,-694.17 537.37,-694.17 537.37,-762.17"/>
<text text-anchor="middle" x="435.87" y="-746.97" font-family="Times,serif" font-size="14.00">MLP Down Projection</text>
<text text-anchor="middle" x="435.87" y="-731.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="435.87" y="-716.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-701.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_mlp_mul&#45;&gt;lay15_mlp_down -->
<g id="edge284" class="edge">
<title>lay15_mlp_mul&#45;&gt;lay15_mlp_down</title>
<path fill="none" stroke="black" d="M435.87,-833.92C435.87,-833.92 435.87,-772.55 435.87,-772.55"/>
<polygon fill="black" stroke="black" points="439.37,-772.55 435.87,-762.55 432.37,-772.55 439.37,-772.55"/>
</g>
<!-- lay15_mlp_down&#45;&gt;lay15_res2 -->
<g id="edge285" class="edge">
<title>lay15_mlp_down&#45;&gt;lay15_res2</title>
<path fill="none" stroke="black" d="M435.87,-693.97C435.87,-693.97 435.87,-632.21 435.87,-632.21"/>
<polygon fill="black" stroke="black" points="439.37,-632.21 435.87,-622.21 432.37,-632.21 439.37,-632.21"/>
</g>
<!-- lay15_ln2 -->
<g id="node240" class="node">
<title>lay15_ln2</title>
<polygon fill="lightsteelblue" stroke="black" points="537.37,-454 334.37,-454 334.37,-386 537.37,-386 537.37,-454"/>
<text text-anchor="middle" x="435.87" y="-438.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="435.87" y="-423.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-408.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-393.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_res2&#45;&gt;lay15_ln2 -->
<g id="edge287" class="edge">
<title>lay15_res2&#45;&gt;lay15_ln2</title>
<path fill="none" stroke="black" d="M435.87,-525.75C435.87,-525.75 435.87,-464.48 435.87,-464.48"/>
<polygon fill="black" stroke="black" points="439.37,-464.48 435.87,-454.48 432.37,-464.48 439.37,-464.48"/>
</g>
<!-- layer15_output -->
<g id="node241" class="node">
<title>layer15_output</title>
<polygon fill="lightgreen" stroke="black" points="573.65,-314 354.47,-314 298.09,-178 517.26,-178 573.65,-314"/>
<text text-anchor="middle" x="435.87" y="-264.8" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="435.87" y="-249.8" font-family="Times,serif" font-size="14.00">To: Final Output</text>
<text text-anchor="middle" x="435.87" y="-234.8" font-family="Times,serif" font-size="14.00">Size: 524MB</text>
<text text-anchor="middle" x="435.87" y="-219.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- lay15_ln2&#45;&gt;layer15_output -->
<g id="edge288" class="edge">
<title>lay15_ln2&#45;&gt;layer15_output</title>
<path fill="none" stroke="black" d="M435.87,-385.62C435.87,-385.62 435.87,-324.14 435.87,-324.14"/>
<polygon fill="black" stroke="black" points="439.37,-324.14 435.87,-314.14 432.37,-324.14 439.37,-324.14"/>
</g>
<!-- final_output -->
<g id="node242" class="node">
<title>final_output</title>
<polygon fill="lightgreen" stroke="black" points="646.29,-106 311.56,-106 225.45,0 560.18,0 646.29,-106"/>
<text text-anchor="middle" x="435.87" y="-64.3" font-family="Times,serif" font-size="14.00">Final Model Output</text>
<text text-anchor="middle" x="435.87" y="-49.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="435.87" y="-34.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
</g>
<!-- layer15_output&#45;&gt;final_output -->
<g id="edge289" class="edge">
<title>layer15_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M435.87,-177.96C435.87,-177.96 435.87,-116.19 435.87,-116.19"/>
<polygon fill="black" stroke="black" points="439.37,-116.19 435.87,-106.19 432.37,-116.19 439.37,-116.19"/>
</g>
</g>
</svg>
