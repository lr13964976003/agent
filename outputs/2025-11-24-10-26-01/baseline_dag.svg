<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp8_pp2 Pages: 1 -->
<svg width="1355pt" height="19967pt"
 viewBox="0.00 0.00 1355.46 19967.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 19963.33)">
<title>baseline_tp8_pp2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-19963.33 1351.46,-19963.33 1351.46,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20,-10007.66C20,-10007.66 964,-10007.66 964,-10007.66 970,-10007.66 976,-10013.66 976,-10019.66 976,-10019.66 976,-19782.33 976,-19782.33 976,-19788.33 970,-19794.33 964,-19794.33 964,-19794.33 20,-19794.33 20,-19794.33 14,-19794.33 8,-19788.33 8,-19782.33 8,-19782.33 8,-10019.66 8,-10019.66 8,-10013.66 14,-10007.66 20,-10007.66"/>
<text text-anchor="middle" x="492" y="-19779.13" font-family="Times,serif" font-size="14.00">Stage 0 (Layers 0&#45;7)</text>
<text text-anchor="middle" x="492" y="-19764.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7 (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-18432 252,-19597.33 732,-19597.33 732,-18432 252,-18432"/>
<text text-anchor="middle" x="492" y="-19582.13" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="492" y="-19567.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-17229.66 252,-18395 732,-18395 732,-17229.66 252,-17229.66"/>
<text text-anchor="middle" x="492" y="-18379.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="492" y="-18364.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-16027.33 252,-17192.66 732,-17192.66 732,-16027.33 252,-16027.33"/>
<text text-anchor="middle" x="492" y="-17177.46" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="492" y="-17162.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-14825 252,-15990.33 732,-15990.33 732,-14825 252,-14825"/>
<text text-anchor="middle" x="492" y="-15975.13" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="492" y="-15960.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer4</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-13622.66 252,-14788 732,-14788 732,-13622.66 252,-13622.66"/>
<text text-anchor="middle" x="492" y="-14772.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="492" y="-14757.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer5</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-12420.33 252,-13585.66 732,-13585.66 732,-12420.33 252,-12420.33"/>
<text text-anchor="middle" x="492" y="-13570.46" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="492" y="-13555.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer6</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-11218 252,-12383.33 732,-12383.33 732,-11218 252,-11218"/>
<text text-anchor="middle" x="492" y="-12368.13" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="492" y="-12353.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer7</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="252,-10015.66 252,-11181 732,-11181 732,-10015.66 252,-10015.66"/>
<text text-anchor="middle" x="492" y="-11165.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="492" y="-11150.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M20,-163C20,-163 964,-163 964,-163 970,-163 976,-169 976,-175 976,-175 976,-9937.66 976,-9937.66 976,-9943.66 970,-9949.66 964,-9949.66 964,-9949.66 20,-9949.66 20,-9949.66 14,-9949.66 8,-9943.66 8,-9937.66 8,-9937.66 8,-175 8,-175 8,-169 14,-163 20,-163"/>
<text text-anchor="middle" x="492" y="-9934.46" font-family="Times,serif" font-size="14.00">Stage 1 (Layers 8&#45;15)</text>
<text text-anchor="middle" x="492" y="-9919.46" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15 (TP=8)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer8</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-8587.33 252,-9752.66 732,-9752.66 732,-8587.33 252,-8587.33"/>
<text text-anchor="middle" x="492" y="-9737.46" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="492" y="-9722.46" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer9</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-7385 252,-8550.33 732,-8550.33 732,-7385 252,-7385"/>
<text text-anchor="middle" x="492" y="-8535.13" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="492" y="-8520.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer10</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-6182.67 252,-7348 732,-7348 732,-6182.67 252,-6182.67"/>
<text text-anchor="middle" x="492" y="-7332.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="492" y="-7317.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer11</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-4980.33 252,-6145.67 732,-6145.67 732,-4980.33 252,-4980.33"/>
<text text-anchor="middle" x="492" y="-6130.47" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="492" y="-6115.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer12</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-3778 252,-4943.33 732,-4943.33 732,-3778 252,-3778"/>
<text text-anchor="middle" x="492" y="-4928.13" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="492" y="-4913.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer13</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-2575.67 252,-3741 732,-3741 732,-2575.67 252,-2575.67"/>
<text text-anchor="middle" x="492" y="-3725.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="492" y="-3710.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer14</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-1373.33 252,-2538.67 732,-2538.67 732,-1373.33 252,-1373.33"/>
<text text-anchor="middle" x="492" y="-2523.47" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="492" y="-2508.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer15</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="252,-171 252,-1336.33 732,-1336.33 732,-171 252,-171"/>
<text text-anchor="middle" x="492" y="-1321.13" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="492" y="-1306.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="967.74,-19959.33 210.94,-19959.33 16.26,-19853.33 773.06,-19853.33 967.74,-19959.33"/>
<text text-anchor="middle" x="492" y="-19917.63" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="492" y="-19902.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="492" y="-19887.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- stage0_input -->
<g id="node2" class="node">
<title>stage0_input</title>
<polygon fill="lightyellow" stroke="black" points="967.74,-19748.33 210.94,-19748.33 16.26,-19642.33 773.06,-19642.33 967.74,-19748.33"/>
<text text-anchor="middle" x="492" y="-19706.63" font-family="Times,serif" font-size="14.00">Input to Stage 0</text>
<text text-anchor="middle" x="492" y="-19691.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="492" y="-19676.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- input&#45;&gt;stage0_input -->
<g id="edge1" class="edge">
<title>input&#45;&gt;stage0_input</title>
<path fill="none" stroke="black" d="M492,-19853.08C492,-19853.08 492,-19758.56 492,-19758.56"/>
<polygon fill="black" stroke="black" points="495.5,-19758.56 492,-19748.56 488.5,-19758.56 495.5,-19758.56"/>
<text text-anchor="middle" x="552" y="-19806.13" font-family="Times,serif" font-size="14.00">Full Model Input</text>
</g>
<!-- lay0_qkv_proj -->
<g id="node3" class="node">
<title>lay0_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-19551.33 383.5,-19551.33 383.5,-19483.33 600.5,-19483.33 600.5,-19551.33"/>
<text text-anchor="middle" x="492" y="-19536.13" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-19521.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-19506.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-19491.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- stage0_input&#45;&gt;lay0_qkv_proj -->
<g id="edge2" class="edge">
<title>stage0_input&#45;&gt;lay0_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-19641.92C492,-19641.92 492,-19561.34 492,-19561.34"/>
<polygon fill="black" stroke="black" points="495.5,-19561.34 492,-19551.34 488.5,-19561.34 495.5,-19561.34"/>
</g>
<!-- lay0_attn -->
<g id="node4" class="node">
<title>lay0_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-19410.33 380.5,-19410.33 380.5,-19342.33 603.5,-19342.33 603.5,-19410.33"/>
<text text-anchor="middle" x="492" y="-19395.13" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-19380.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-19365.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-19350.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_qkv_proj&#45;&gt;lay0_attn -->
<g id="edge3" class="edge">
<title>lay0_qkv_proj&#45;&gt;lay0_attn</title>
<path fill="none" stroke="black" d="M492,-19483.2C492,-19483.2 492,-19420.64 492,-19420.64"/>
<polygon fill="black" stroke="black" points="495.5,-19420.64 492,-19410.64 488.5,-19420.64 495.5,-19420.64"/>
</g>
<!-- lay0_attn_out -->
<g id="node5" class="node">
<title>lay0_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-19269.33 357,-19269.33 357,-19201.33 627,-19201.33 627,-19269.33"/>
<text text-anchor="middle" x="492" y="-19254.13" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-19239.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-19224.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-19209.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_attn&#45;&gt;lay0_attn_out -->
<g id="edge4" class="edge">
<title>lay0_attn&#45;&gt;lay0_attn_out</title>
<path fill="none" stroke="black" d="M492,-19342.2C492,-19342.2 492,-19279.64 492,-19279.64"/>
<polygon fill="black" stroke="black" points="495.5,-19279.64 492,-19269.64 488.5,-19279.64 495.5,-19279.64"/>
</g>
<!-- lay0_res1 -->
<g id="node6" class="node">
<title>lay0_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-19080.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-19099.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-19084.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-19069.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-19054.05" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_attn_out&#45;&gt;lay0_res1 -->
<g id="edge5" class="edge">
<title>lay0_attn_out&#45;&gt;lay0_res1</title>
<path fill="none" stroke="black" d="M492,-19201.3C492,-19201.3 492,-19138.61 492,-19138.61"/>
<polygon fill="black" stroke="black" points="495.5,-19138.61 492,-19128.61 488.5,-19138.61 495.5,-19138.61"/>
</g>
<!-- tp_allreduce -->
<g id="node149" class="node">
<title>tp_allreduce</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1182" cy="-19906.33" rx="165.43" ry="37.45"/>
<text text-anchor="middle" x="1182" y="-19917.63" font-family="Times,serif" font-size="14.00">Tensor Parallel All&#45;Reduce</text>
<text text-anchor="middle" x="1182" y="-19902.63" font-family="Times,serif" font-size="14.00">Across GPUs 0&#45;7 or 8&#45;15</text>
<text text-anchor="middle" x="1182" y="-19887.63" font-family="Times,serif" font-size="14.00">Size: 4096 elements per token</text>
</g>
<!-- lay0_attn_out&#45;&gt;tp_allreduce -->
<g id="edge164" class="edge">
<title>lay0_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.02,-19246C783.93,-19246 1021.63,-19246 1021.63,-19246 1021.63,-19246 1021.63,-19886.99 1021.63,-19886.99"/>
<polygon fill="black" stroke="black" points="1018.13,-19886.99 1021.63,-19896.99 1025.13,-19886.99 1018.13,-19886.99"/>
</g>
<!-- lay0_mlp_gate -->
<g id="node7" class="node">
<title>lay0_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-18959.16 262,-18959.16 262,-18891.16 474,-18891.16 474,-18959.16"/>
<text text-anchor="middle" x="368" y="-18943.96" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-18928.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-18913.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-18898.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_res1&#45;&gt;lay0_mlp_gate -->
<g id="edge6" class="edge">
<title>lay0_res1&#45;&gt;lay0_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-19039.5C368,-19039.5 368,-18969.35 368,-18969.35"/>
<polygon fill="black" stroke="black" points="371.5,-18969.35 368,-18959.35 364.5,-18969.35 371.5,-18969.35"/>
</g>
<!-- lay0_mlp_up -->
<g id="node8" class="node">
<title>lay0_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-18959.16 510,-18959.16 510,-18891.16 722,-18891.16 722,-18959.16"/>
<text text-anchor="middle" x="616" y="-18943.96" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-18928.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-18913.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-18898.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_res1&#45;&gt;lay0_mlp_up -->
<g id="edge7" class="edge">
<title>lay0_res1&#45;&gt;lay0_mlp_up</title>
<path fill="none" stroke="black" d="M616,-19039.5C616,-19039.5 616,-18969.35 616,-18969.35"/>
<polygon fill="black" stroke="black" points="619.5,-18969.35 616,-18959.35 612.5,-18969.35 619.5,-18969.35"/>
</g>
<!-- lay0_mlp_act -->
<g id="node9" class="node">
<title>lay0_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-18818.16 386,-18818.16 386,-18750.16 598,-18750.16 598,-18818.16"/>
<text text-anchor="middle" x="492" y="-18802.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-18787.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-18772.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-18757.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_mlp_gate&#45;&gt;lay0_mlp_act -->
<g id="edge8" class="edge">
<title>lay0_mlp_gate&#45;&gt;lay0_mlp_act</title>
<path fill="none" stroke="black" d="M430,-18891.03C430,-18891.03 430,-18828.47 430,-18828.47"/>
<polygon fill="black" stroke="black" points="433.5,-18828.47 430,-18818.47 426.5,-18828.47 433.5,-18828.47"/>
</g>
<!-- lay0_mlp_up&#45;&gt;lay0_mlp_act -->
<g id="edge9" class="edge">
<title>lay0_mlp_up&#45;&gt;lay0_mlp_act</title>
<path fill="none" stroke="black" d="M554,-18891.03C554,-18891.03 554,-18828.47 554,-18828.47"/>
<polygon fill="black" stroke="black" points="557.5,-18828.47 554,-18818.47 550.5,-18828.47 557.5,-18828.47"/>
</g>
<!-- lay0_mlp_down -->
<g id="node10" class="node">
<title>lay0_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-18677.16 390.5,-18677.16 390.5,-18609.16 593.5,-18609.16 593.5,-18677.16"/>
<text text-anchor="middle" x="492" y="-18661.96" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-18646.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-18631.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18616.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_mlp_act&#45;&gt;lay0_mlp_down -->
<g id="edge10" class="edge">
<title>lay0_mlp_act&#45;&gt;lay0_mlp_down</title>
<path fill="none" stroke="black" d="M492,-18750.03C492,-18750.03 492,-18687.47 492,-18687.47"/>
<polygon fill="black" stroke="black" points="495.5,-18687.47 492,-18677.47 488.5,-18687.47 495.5,-18687.47"/>
</g>
<!-- lay0_res2 -->
<g id="node11" class="node">
<title>lay0_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-18488.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-18506.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-18491.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18476.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18461.88" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_mlp_down&#45;&gt;lay0_res2 -->
<g id="edge11" class="edge">
<title>lay0_mlp_down&#45;&gt;lay0_res2</title>
<path fill="none" stroke="black" d="M492,-18609.13C492,-18609.13 492,-18546.45 492,-18546.45"/>
<polygon fill="black" stroke="black" points="495.5,-18546.45 492,-18536.45 488.5,-18546.45 495.5,-18546.45"/>
</g>
<!-- lay0_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge166" class="edge">
<title>lay0_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.53,-18654C749.9,-18654 1031.81,-18654 1031.81,-18654 1031.81,-18654 1031.81,-19880.49 1031.81,-19880.49"/>
<polygon fill="black" stroke="black" points="1028.31,-19880.49 1031.81,-19890.49 1035.31,-19880.49 1028.31,-19880.49"/>
</g>
<!-- lay1_qkv_proj -->
<g id="node12" class="node">
<title>lay1_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-18349 383.5,-18349 383.5,-18281 600.5,-18281 600.5,-18349"/>
<text text-anchor="middle" x="492" y="-18333.8" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-18318.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18303.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-18288.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_res2&#45;&gt;lay1_qkv_proj -->
<g id="edge12" class="edge">
<title>lay0_res2&#45;&gt;lay1_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-18439.87C492,-18439.87 492,-18359.24 492,-18359.24"/>
<polygon fill="black" stroke="black" points="495.5,-18359.24 492,-18349.24 488.5,-18359.24 495.5,-18359.24"/>
</g>
<!-- lay1_attn -->
<g id="node13" class="node">
<title>lay1_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-18208 380.5,-18208 380.5,-18140 603.5,-18140 603.5,-18208"/>
<text text-anchor="middle" x="492" y="-18192.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-18177.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-18162.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18147.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_qkv_proj&#45;&gt;lay1_attn -->
<g id="edge13" class="edge">
<title>lay1_qkv_proj&#45;&gt;lay1_attn</title>
<path fill="none" stroke="black" d="M492,-18280.86C492,-18280.86 492,-18218.3 492,-18218.3"/>
<polygon fill="black" stroke="black" points="495.5,-18218.3 492,-18208.3 488.5,-18218.3 495.5,-18218.3"/>
</g>
<!-- lay1_attn_out -->
<g id="node14" class="node">
<title>lay1_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-18067 357,-18067 357,-17999 627,-17999 627,-18067"/>
<text text-anchor="middle" x="492" y="-18051.8" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-18036.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18021.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-18006.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_attn&#45;&gt;lay1_attn_out -->
<g id="edge14" class="edge">
<title>lay1_attn&#45;&gt;lay1_attn_out</title>
<path fill="none" stroke="black" d="M492,-18139.86C492,-18139.86 492,-18077.3 492,-18077.3"/>
<polygon fill="black" stroke="black" points="495.5,-18077.3 492,-18067.3 488.5,-18077.3 495.5,-18077.3"/>
</g>
<!-- lay1_res1 -->
<g id="node15" class="node">
<title>lay1_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-17877.91" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-17896.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-17881.71" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-17866.71" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-17851.71" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_attn_out&#45;&gt;lay1_res1 -->
<g id="edge15" class="edge">
<title>lay1_attn_out&#45;&gt;lay1_res1</title>
<path fill="none" stroke="black" d="M492,-17998.96C492,-17998.96 492,-17936.28 492,-17936.28"/>
<polygon fill="black" stroke="black" points="495.5,-17936.28 492,-17926.28 488.5,-17936.28 495.5,-17936.28"/>
</g>
<!-- lay1_attn_out&#45;&gt;tp_allreduce -->
<g id="edge168" class="edge">
<title>lay1_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.25,-18044C790.1,-18044 1041.99,-18044 1041.99,-18044 1041.99,-18044 1041.99,-19876.05 1041.99,-19876.05"/>
<polygon fill="black" stroke="black" points="1038.49,-19876.05 1041.99,-19886.05 1045.49,-19876.05 1038.49,-19876.05"/>
</g>
<!-- lay1_mlp_gate -->
<g id="node16" class="node">
<title>lay1_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-17756.83 262,-17756.83 262,-17688.83 474,-17688.83 474,-17756.83"/>
<text text-anchor="middle" x="368" y="-17741.63" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-17726.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-17711.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-17696.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_res1&#45;&gt;lay1_mlp_gate -->
<g id="edge16" class="edge">
<title>lay1_res1&#45;&gt;lay1_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-17837.17C368,-17837.17 368,-17767.01 368,-17767.01"/>
<polygon fill="black" stroke="black" points="371.5,-17767.01 368,-17757.01 364.5,-17767.01 371.5,-17767.01"/>
</g>
<!-- lay1_mlp_up -->
<g id="node17" class="node">
<title>lay1_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-17756.83 510,-17756.83 510,-17688.83 722,-17688.83 722,-17756.83"/>
<text text-anchor="middle" x="616" y="-17741.63" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-17726.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-17711.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-17696.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_res1&#45;&gt;lay1_mlp_up -->
<g id="edge17" class="edge">
<title>lay1_res1&#45;&gt;lay1_mlp_up</title>
<path fill="none" stroke="black" d="M616,-17837.17C616,-17837.17 616,-17767.01 616,-17767.01"/>
<polygon fill="black" stroke="black" points="619.5,-17767.01 616,-17757.01 612.5,-17767.01 619.5,-17767.01"/>
</g>
<!-- lay1_mlp_act -->
<g id="node18" class="node">
<title>lay1_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-17615.83 386,-17615.83 386,-17547.83 598,-17547.83 598,-17615.83"/>
<text text-anchor="middle" x="492" y="-17600.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-17585.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-17570.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-17555.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_mlp_gate&#45;&gt;lay1_mlp_act -->
<g id="edge18" class="edge">
<title>lay1_mlp_gate&#45;&gt;lay1_mlp_act</title>
<path fill="none" stroke="black" d="M430,-17688.7C430,-17688.7 430,-17626.14 430,-17626.14"/>
<polygon fill="black" stroke="black" points="433.5,-17626.14 430,-17616.14 426.5,-17626.14 433.5,-17626.14"/>
</g>
<!-- lay1_mlp_up&#45;&gt;lay1_mlp_act -->
<g id="edge19" class="edge">
<title>lay1_mlp_up&#45;&gt;lay1_mlp_act</title>
<path fill="none" stroke="black" d="M554,-17688.7C554,-17688.7 554,-17626.14 554,-17626.14"/>
<polygon fill="black" stroke="black" points="557.5,-17626.14 554,-17616.14 550.5,-17626.14 557.5,-17626.14"/>
</g>
<!-- lay1_mlp_down -->
<g id="node19" class="node">
<title>lay1_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-17474.83 390.5,-17474.83 390.5,-17406.83 593.5,-17406.83 593.5,-17474.83"/>
<text text-anchor="middle" x="492" y="-17459.63" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-17444.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-17429.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-17414.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_mlp_act&#45;&gt;lay1_mlp_down -->
<g id="edge20" class="edge">
<title>lay1_mlp_act&#45;&gt;lay1_mlp_down</title>
<path fill="none" stroke="black" d="M492,-17547.7C492,-17547.7 492,-17485.14 492,-17485.14"/>
<polygon fill="black" stroke="black" points="495.5,-17485.14 492,-17475.14 488.5,-17485.14 495.5,-17485.14"/>
</g>
<!-- lay1_res2 -->
<g id="node20" class="node">
<title>lay1_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-17285.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-17304.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-17289.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-17274.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-17259.55" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_mlp_down&#45;&gt;lay1_res2 -->
<g id="edge21" class="edge">
<title>lay1_mlp_down&#45;&gt;lay1_res2</title>
<path fill="none" stroke="black" d="M492,-17406.8C492,-17406.8 492,-17344.12 492,-17344.12"/>
<polygon fill="black" stroke="black" points="495.5,-17344.12 492,-17334.12 488.5,-17344.12 495.5,-17344.12"/>
</g>
<!-- lay1_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge170" class="edge">
<title>lay1_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.77,-17452C755.27,-17452 1052.18,-17452 1052.18,-17452 1052.18,-17452 1052.18,-19872.82 1052.18,-19872.82"/>
<polygon fill="black" stroke="black" points="1048.68,-19872.82 1052.18,-19882.82 1055.68,-19872.82 1048.68,-19872.82"/>
</g>
<!-- lay2_qkv_proj -->
<g id="node21" class="node">
<title>lay2_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-17146.66 383.5,-17146.66 383.5,-17078.66 600.5,-17078.66 600.5,-17146.66"/>
<text text-anchor="middle" x="492" y="-17131.46" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-17116.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-17101.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-17086.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1_res2&#45;&gt;lay2_qkv_proj -->
<g id="edge22" class="edge">
<title>lay1_res2&#45;&gt;lay2_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-17237.53C492,-17237.53 492,-17156.91 492,-17156.91"/>
<polygon fill="black" stroke="black" points="495.5,-17156.91 492,-17146.91 488.5,-17156.91 495.5,-17156.91"/>
</g>
<!-- lay2_attn -->
<g id="node22" class="node">
<title>lay2_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-17005.66 380.5,-17005.66 380.5,-16937.66 603.5,-16937.66 603.5,-17005.66"/>
<text text-anchor="middle" x="492" y="-16990.46" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-16975.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-16960.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16945.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_qkv_proj&#45;&gt;lay2_attn -->
<g id="edge23" class="edge">
<title>lay2_qkv_proj&#45;&gt;lay2_attn</title>
<path fill="none" stroke="black" d="M492,-17078.53C492,-17078.53 492,-17015.97 492,-17015.97"/>
<polygon fill="black" stroke="black" points="495.5,-17015.97 492,-17005.97 488.5,-17015.97 495.5,-17015.97"/>
</g>
<!-- lay2_attn_out -->
<g id="node23" class="node">
<title>lay2_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-16864.66 357,-16864.66 357,-16796.66 627,-16796.66 627,-16864.66"/>
<text text-anchor="middle" x="492" y="-16849.46" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-16834.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16819.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16804.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_attn&#45;&gt;lay2_attn_out -->
<g id="edge24" class="edge">
<title>lay2_attn&#45;&gt;lay2_attn_out</title>
<path fill="none" stroke="black" d="M492,-16937.53C492,-16937.53 492,-16874.97 492,-16874.97"/>
<polygon fill="black" stroke="black" points="495.5,-16874.97 492,-16864.97 488.5,-16874.97 495.5,-16874.97"/>
</g>
<!-- lay2_res1 -->
<g id="node24" class="node">
<title>lay2_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-16675.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-16694.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-16679.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16664.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16649.38" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_attn_out&#45;&gt;lay2_res1 -->
<g id="edge25" class="edge">
<title>lay2_attn_out&#45;&gt;lay2_res1</title>
<path fill="none" stroke="black" d="M492,-16796.63C492,-16796.63 492,-16733.95 492,-16733.95"/>
<polygon fill="black" stroke="black" points="495.5,-16733.95 492,-16723.95 488.5,-16733.95 495.5,-16733.95"/>
</g>
<!-- lay2_attn_out&#45;&gt;tp_allreduce -->
<g id="edge172" class="edge">
<title>lay2_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.17,-16841C795.83,-16841 1062.36,-16841 1062.36,-16841 1062.36,-16841 1062.36,-19870.29 1062.36,-19870.29"/>
<polygon fill="black" stroke="black" points="1058.86,-19870.29 1062.36,-19880.29 1065.86,-19870.29 1058.86,-19870.29"/>
</g>
<!-- lay2_mlp_gate -->
<g id="node25" class="node">
<title>lay2_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-16554.5 262,-16554.5 262,-16486.5 474,-16486.5 474,-16554.5"/>
<text text-anchor="middle" x="368" y="-16539.3" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-16524.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-16509.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-16494.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_res1&#45;&gt;lay2_mlp_gate -->
<g id="edge26" class="edge">
<title>lay2_res1&#45;&gt;lay2_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-16634.83C368,-16634.83 368,-16564.68 368,-16564.68"/>
<polygon fill="black" stroke="black" points="371.5,-16564.68 368,-16554.68 364.5,-16564.68 371.5,-16564.68"/>
</g>
<!-- lay2_mlp_up -->
<g id="node26" class="node">
<title>lay2_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-16554.5 510,-16554.5 510,-16486.5 722,-16486.5 722,-16554.5"/>
<text text-anchor="middle" x="616" y="-16539.3" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-16524.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-16509.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-16494.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_res1&#45;&gt;lay2_mlp_up -->
<g id="edge27" class="edge">
<title>lay2_res1&#45;&gt;lay2_mlp_up</title>
<path fill="none" stroke="black" d="M616,-16634.83C616,-16634.83 616,-16564.68 616,-16564.68"/>
<polygon fill="black" stroke="black" points="619.5,-16564.68 616,-16554.68 612.5,-16564.68 619.5,-16564.68"/>
</g>
<!-- lay2_mlp_act -->
<g id="node27" class="node">
<title>lay2_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-16413.5 386,-16413.5 386,-16345.5 598,-16345.5 598,-16413.5"/>
<text text-anchor="middle" x="492" y="-16398.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-16383.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-16368.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-16353.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_mlp_gate&#45;&gt;lay2_mlp_act -->
<g id="edge28" class="edge">
<title>lay2_mlp_gate&#45;&gt;lay2_mlp_act</title>
<path fill="none" stroke="black" d="M430,-16486.36C430,-16486.36 430,-16423.8 430,-16423.8"/>
<polygon fill="black" stroke="black" points="433.5,-16423.8 430,-16413.8 426.5,-16423.8 433.5,-16423.8"/>
</g>
<!-- lay2_mlp_up&#45;&gt;lay2_mlp_act -->
<g id="edge29" class="edge">
<title>lay2_mlp_up&#45;&gt;lay2_mlp_act</title>
<path fill="none" stroke="black" d="M554,-16486.36C554,-16486.36 554,-16423.8 554,-16423.8"/>
<polygon fill="black" stroke="black" points="557.5,-16423.8 554,-16413.8 550.5,-16423.8 557.5,-16423.8"/>
</g>
<!-- lay2_mlp_down -->
<g id="node28" class="node">
<title>lay2_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-16272.5 390.5,-16272.5 390.5,-16204.5 593.5,-16204.5 593.5,-16272.5"/>
<text text-anchor="middle" x="492" y="-16257.3" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-16242.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-16227.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16212.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_mlp_act&#45;&gt;lay2_mlp_down -->
<g id="edge30" class="edge">
<title>lay2_mlp_act&#45;&gt;lay2_mlp_down</title>
<path fill="none" stroke="black" d="M492,-16345.36C492,-16345.36 492,-16282.8 492,-16282.8"/>
<polygon fill="black" stroke="black" points="495.5,-16282.8 492,-16272.8 488.5,-16282.8 495.5,-16282.8"/>
</g>
<!-- lay2_res2 -->
<g id="node29" class="node">
<title>lay2_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-16083.41" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-16102.21" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-16087.21" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16072.21" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-16057.21" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_mlp_down&#45;&gt;lay2_res2 -->
<g id="edge31" class="edge">
<title>lay2_mlp_down&#45;&gt;lay2_res2</title>
<path fill="none" stroke="black" d="M492,-16204.46C492,-16204.46 492,-16141.78 492,-16141.78"/>
<polygon fill="black" stroke="black" points="495.5,-16141.78 492,-16131.78 488.5,-16141.78 495.5,-16141.78"/>
</g>
<!-- lay2_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge174" class="edge">
<title>lay2_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.79,-16249C760.28,-16249 1072.54,-16249 1072.54,-16249 1072.54,-16249 1072.54,-19868.21 1072.54,-19868.21"/>
<polygon fill="black" stroke="black" points="1069.04,-19868.21 1072.54,-19878.21 1076.04,-19868.21 1069.04,-19868.21"/>
</g>
<!-- lay3_qkv_proj -->
<g id="node30" class="node">
<title>lay3_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-15944.33 383.5,-15944.33 383.5,-15876.33 600.5,-15876.33 600.5,-15944.33"/>
<text text-anchor="middle" x="492" y="-15929.13" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-15914.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15899.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-15884.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2_res2&#45;&gt;lay3_qkv_proj -->
<g id="edge32" class="edge">
<title>lay2_res2&#45;&gt;lay3_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-16035.2C492,-16035.2 492,-15954.58 492,-15954.58"/>
<polygon fill="black" stroke="black" points="495.5,-15954.58 492,-15944.58 488.5,-15954.58 495.5,-15954.58"/>
</g>
<!-- lay3_attn -->
<g id="node31" class="node">
<title>lay3_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-15803.33 380.5,-15803.33 380.5,-15735.33 603.5,-15735.33 603.5,-15803.33"/>
<text text-anchor="middle" x="492" y="-15788.13" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-15773.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-15758.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15743.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_qkv_proj&#45;&gt;lay3_attn -->
<g id="edge33" class="edge">
<title>lay3_qkv_proj&#45;&gt;lay3_attn</title>
<path fill="none" stroke="black" d="M492,-15876.2C492,-15876.2 492,-15813.64 492,-15813.64"/>
<polygon fill="black" stroke="black" points="495.5,-15813.64 492,-15803.64 488.5,-15813.64 495.5,-15813.64"/>
</g>
<!-- lay3_attn_out -->
<g id="node32" class="node">
<title>lay3_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-15662.33 357,-15662.33 357,-15594.33 627,-15594.33 627,-15662.33"/>
<text text-anchor="middle" x="492" y="-15647.13" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-15632.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15617.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15602.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_attn&#45;&gt;lay3_attn_out -->
<g id="edge34" class="edge">
<title>lay3_attn&#45;&gt;lay3_attn_out</title>
<path fill="none" stroke="black" d="M492,-15735.2C492,-15735.2 492,-15672.64 492,-15672.64"/>
<polygon fill="black" stroke="black" points="495.5,-15672.64 492,-15662.64 488.5,-15672.64 495.5,-15672.64"/>
</g>
<!-- lay3_res1 -->
<g id="node33" class="node">
<title>lay3_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-15473.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-15492.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-15477.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15462.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15447.05" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_attn_out&#45;&gt;lay3_res1 -->
<g id="edge35" class="edge">
<title>lay3_attn_out&#45;&gt;lay3_res1</title>
<path fill="none" stroke="black" d="M492,-15594.3C492,-15594.3 492,-15531.62 492,-15531.62"/>
<polygon fill="black" stroke="black" points="495.5,-15531.62 492,-15521.62 488.5,-15531.62 495.5,-15531.62"/>
</g>
<!-- lay3_attn_out&#45;&gt;tp_allreduce -->
<g id="edge176" class="edge">
<title>lay3_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.15,-15639C801.53,-15639 1082.72,-15639 1082.72,-15639 1082.72,-15639 1082.72,-19866.22 1082.72,-19866.22"/>
<polygon fill="black" stroke="black" points="1079.22,-19866.22 1082.72,-19876.22 1086.22,-19866.22 1079.22,-19866.22"/>
</g>
<!-- lay3_mlp_gate -->
<g id="node34" class="node">
<title>lay3_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-15352.16 262,-15352.16 262,-15284.16 474,-15284.16 474,-15352.16"/>
<text text-anchor="middle" x="368" y="-15336.96" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-15321.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-15306.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-15291.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_res1&#45;&gt;lay3_mlp_gate -->
<g id="edge36" class="edge">
<title>lay3_res1&#45;&gt;lay3_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-15432.5C368,-15432.5 368,-15362.35 368,-15362.35"/>
<polygon fill="black" stroke="black" points="371.5,-15362.35 368,-15352.35 364.5,-15362.35 371.5,-15362.35"/>
</g>
<!-- lay3_mlp_up -->
<g id="node35" class="node">
<title>lay3_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-15352.16 510,-15352.16 510,-15284.16 722,-15284.16 722,-15352.16"/>
<text text-anchor="middle" x="616" y="-15336.96" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-15321.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-15306.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-15291.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_res1&#45;&gt;lay3_mlp_up -->
<g id="edge37" class="edge">
<title>lay3_res1&#45;&gt;lay3_mlp_up</title>
<path fill="none" stroke="black" d="M616,-15432.5C616,-15432.5 616,-15362.35 616,-15362.35"/>
<polygon fill="black" stroke="black" points="619.5,-15362.35 616,-15352.35 612.5,-15362.35 619.5,-15362.35"/>
</g>
<!-- lay3_mlp_act -->
<g id="node36" class="node">
<title>lay3_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-15211.16 386,-15211.16 386,-15143.16 598,-15143.16 598,-15211.16"/>
<text text-anchor="middle" x="492" y="-15195.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-15180.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-15165.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-15150.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_mlp_gate&#45;&gt;lay3_mlp_act -->
<g id="edge38" class="edge">
<title>lay3_mlp_gate&#45;&gt;lay3_mlp_act</title>
<path fill="none" stroke="black" d="M430,-15284.03C430,-15284.03 430,-15221.47 430,-15221.47"/>
<polygon fill="black" stroke="black" points="433.5,-15221.47 430,-15211.47 426.5,-15221.47 433.5,-15221.47"/>
</g>
<!-- lay3_mlp_up&#45;&gt;lay3_mlp_act -->
<g id="edge39" class="edge">
<title>lay3_mlp_up&#45;&gt;lay3_mlp_act</title>
<path fill="none" stroke="black" d="M554,-15284.03C554,-15284.03 554,-15221.47 554,-15221.47"/>
<polygon fill="black" stroke="black" points="557.5,-15221.47 554,-15211.47 550.5,-15221.47 557.5,-15221.47"/>
</g>
<!-- lay3_mlp_down -->
<g id="node37" class="node">
<title>lay3_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-15070.16 390.5,-15070.16 390.5,-15002.16 593.5,-15002.16 593.5,-15070.16"/>
<text text-anchor="middle" x="492" y="-15054.96" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-15039.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-15024.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-15009.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_mlp_act&#45;&gt;lay3_mlp_down -->
<g id="edge40" class="edge">
<title>lay3_mlp_act&#45;&gt;lay3_mlp_down</title>
<path fill="none" stroke="black" d="M492,-15143.03C492,-15143.03 492,-15080.47 492,-15080.47"/>
<polygon fill="black" stroke="black" points="495.5,-15080.47 492,-15070.47 488.5,-15080.47 495.5,-15080.47"/>
</g>
<!-- lay3_res2 -->
<g id="node38" class="node">
<title>lay3_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-14881.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-14899.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-14884.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14869.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14854.88" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_mlp_down&#45;&gt;lay3_res2 -->
<g id="edge41" class="edge">
<title>lay3_mlp_down&#45;&gt;lay3_res2</title>
<path fill="none" stroke="black" d="M492,-15002.13C492,-15002.13 492,-14939.45 492,-14939.45"/>
<polygon fill="black" stroke="black" points="495.5,-14939.45 492,-14929.45 488.5,-14939.45 495.5,-14939.45"/>
</g>
<!-- lay3_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge178" class="edge">
<title>lay3_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.6,-15047C764.94,-15047 1092.9,-15047 1092.9,-15047 1092.9,-15047 1092.9,-19864.66 1092.9,-19864.66"/>
<polygon fill="black" stroke="black" points="1089.4,-19864.66 1092.9,-19874.66 1096.4,-19864.66 1089.4,-19864.66"/>
</g>
<!-- lay4_qkv_proj -->
<g id="node39" class="node">
<title>lay4_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-14742 383.5,-14742 383.5,-14674 600.5,-14674 600.5,-14742"/>
<text text-anchor="middle" x="492" y="-14726.8" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-14711.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14696.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-14681.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3_res2&#45;&gt;lay4_qkv_proj -->
<g id="edge42" class="edge">
<title>lay3_res2&#45;&gt;lay4_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-14832.87C492,-14832.87 492,-14752.24 492,-14752.24"/>
<polygon fill="black" stroke="black" points="495.5,-14752.24 492,-14742.24 488.5,-14752.24 495.5,-14752.24"/>
</g>
<!-- lay4_attn -->
<g id="node40" class="node">
<title>lay4_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-14601 380.5,-14601 380.5,-14533 603.5,-14533 603.5,-14601"/>
<text text-anchor="middle" x="492" y="-14585.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-14570.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-14555.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14540.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_qkv_proj&#45;&gt;lay4_attn -->
<g id="edge43" class="edge">
<title>lay4_qkv_proj&#45;&gt;lay4_attn</title>
<path fill="none" stroke="black" d="M492,-14673.86C492,-14673.86 492,-14611.3 492,-14611.3"/>
<polygon fill="black" stroke="black" points="495.5,-14611.3 492,-14601.3 488.5,-14611.3 495.5,-14611.3"/>
</g>
<!-- lay4_attn_out -->
<g id="node41" class="node">
<title>lay4_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-14460 357,-14460 357,-14392 627,-14392 627,-14460"/>
<text text-anchor="middle" x="492" y="-14444.8" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-14429.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14414.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14399.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_attn&#45;&gt;lay4_attn_out -->
<g id="edge44" class="edge">
<title>lay4_attn&#45;&gt;lay4_attn_out</title>
<path fill="none" stroke="black" d="M492,-14532.86C492,-14532.86 492,-14470.3 492,-14470.3"/>
<polygon fill="black" stroke="black" points="495.5,-14470.3 492,-14460.3 488.5,-14470.3 495.5,-14470.3"/>
</g>
<!-- lay4_res1 -->
<g id="node42" class="node">
<title>lay4_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-14270.91" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-14289.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-14274.71" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14259.71" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-14244.71" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_attn_out&#45;&gt;lay4_res1 -->
<g id="edge45" class="edge">
<title>lay4_attn_out&#45;&gt;lay4_res1</title>
<path fill="none" stroke="black" d="M492,-14391.96C492,-14391.96 492,-14329.28 492,-14329.28"/>
<polygon fill="black" stroke="black" points="495.5,-14329.28 492,-14319.28 488.5,-14329.28 495.5,-14329.28"/>
</g>
<!-- lay4_attn_out&#45;&gt;tp_allreduce -->
<g id="edge180" class="edge">
<title>lay4_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.24,-14437C807.24,-14437 1103.09,-14437 1103.09,-14437 1103.09,-14437 1103.09,-19863.17 1103.09,-19863.17"/>
<polygon fill="black" stroke="black" points="1099.59,-19863.17 1103.09,-19873.17 1106.59,-19863.17 1099.59,-19863.17"/>
</g>
<!-- lay4_mlp_gate -->
<g id="node43" class="node">
<title>lay4_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-14149.83 262,-14149.83 262,-14081.83 474,-14081.83 474,-14149.83"/>
<text text-anchor="middle" x="368" y="-14134.63" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-14119.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-14104.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-14089.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_res1&#45;&gt;lay4_mlp_gate -->
<g id="edge46" class="edge">
<title>lay4_res1&#45;&gt;lay4_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-14230.17C368,-14230.17 368,-14160.01 368,-14160.01"/>
<polygon fill="black" stroke="black" points="371.5,-14160.01 368,-14150.01 364.5,-14160.01 371.5,-14160.01"/>
</g>
<!-- lay4_mlp_up -->
<g id="node44" class="node">
<title>lay4_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-14149.83 510,-14149.83 510,-14081.83 722,-14081.83 722,-14149.83"/>
<text text-anchor="middle" x="616" y="-14134.63" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-14119.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-14104.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-14089.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_res1&#45;&gt;lay4_mlp_up -->
<g id="edge47" class="edge">
<title>lay4_res1&#45;&gt;lay4_mlp_up</title>
<path fill="none" stroke="black" d="M616,-14230.17C616,-14230.17 616,-14160.01 616,-14160.01"/>
<polygon fill="black" stroke="black" points="619.5,-14160.01 616,-14150.01 612.5,-14160.01 619.5,-14160.01"/>
</g>
<!-- lay4_mlp_act -->
<g id="node45" class="node">
<title>lay4_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-14008.83 386,-14008.83 386,-13940.83 598,-13940.83 598,-14008.83"/>
<text text-anchor="middle" x="492" y="-13993.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-13978.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-13963.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-13948.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_mlp_gate&#45;&gt;lay4_mlp_act -->
<g id="edge48" class="edge">
<title>lay4_mlp_gate&#45;&gt;lay4_mlp_act</title>
<path fill="none" stroke="black" d="M430,-14081.7C430,-14081.7 430,-14019.14 430,-14019.14"/>
<polygon fill="black" stroke="black" points="433.5,-14019.14 430,-14009.14 426.5,-14019.14 433.5,-14019.14"/>
</g>
<!-- lay4_mlp_up&#45;&gt;lay4_mlp_act -->
<g id="edge49" class="edge">
<title>lay4_mlp_up&#45;&gt;lay4_mlp_act</title>
<path fill="none" stroke="black" d="M554,-14081.7C554,-14081.7 554,-14019.14 554,-14019.14"/>
<polygon fill="black" stroke="black" points="557.5,-14019.14 554,-14009.14 550.5,-14019.14 557.5,-14019.14"/>
</g>
<!-- lay4_mlp_down -->
<g id="node46" class="node">
<title>lay4_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-13867.83 390.5,-13867.83 390.5,-13799.83 593.5,-13799.83 593.5,-13867.83"/>
<text text-anchor="middle" x="492" y="-13852.63" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-13837.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-13822.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13807.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_mlp_act&#45;&gt;lay4_mlp_down -->
<g id="edge50" class="edge">
<title>lay4_mlp_act&#45;&gt;lay4_mlp_down</title>
<path fill="none" stroke="black" d="M492,-13940.7C492,-13940.7 492,-13878.14 492,-13878.14"/>
<polygon fill="black" stroke="black" points="495.5,-13878.14 492,-13868.14 488.5,-13878.14 495.5,-13878.14"/>
</g>
<!-- lay4_res2 -->
<g id="node47" class="node">
<title>lay4_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-13678.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-13697.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-13682.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13667.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13652.55" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_mlp_down&#45;&gt;lay4_res2 -->
<g id="edge51" class="edge">
<title>lay4_mlp_down&#45;&gt;lay4_res2</title>
<path fill="none" stroke="black" d="M492,-13799.8C492,-13799.8 492,-13737.12 492,-13737.12"/>
<polygon fill="black" stroke="black" points="495.5,-13737.12 492,-13727.12 488.5,-13737.12 495.5,-13737.12"/>
</g>
<!-- lay4_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge182" class="edge">
<title>lay4_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.55,-13845C769.7,-13845 1113.27,-13845 1113.27,-13845 1113.27,-13845 1113.27,-19861.87 1113.27,-19861.87"/>
<polygon fill="black" stroke="black" points="1109.77,-19861.87 1113.27,-19871.87 1116.77,-19861.87 1109.77,-19861.87"/>
</g>
<!-- lay5_qkv_proj -->
<g id="node48" class="node">
<title>lay5_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-13539.66 383.5,-13539.66 383.5,-13471.66 600.5,-13471.66 600.5,-13539.66"/>
<text text-anchor="middle" x="492" y="-13524.46" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-13509.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13494.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-13479.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4_res2&#45;&gt;lay5_qkv_proj -->
<g id="edge52" class="edge">
<title>lay4_res2&#45;&gt;lay5_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-13630.53C492,-13630.53 492,-13549.91 492,-13549.91"/>
<polygon fill="black" stroke="black" points="495.5,-13549.91 492,-13539.91 488.5,-13549.91 495.5,-13549.91"/>
</g>
<!-- lay5_attn -->
<g id="node49" class="node">
<title>lay5_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-13398.66 380.5,-13398.66 380.5,-13330.66 603.5,-13330.66 603.5,-13398.66"/>
<text text-anchor="middle" x="492" y="-13383.46" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-13368.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-13353.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13338.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_qkv_proj&#45;&gt;lay5_attn -->
<g id="edge53" class="edge">
<title>lay5_qkv_proj&#45;&gt;lay5_attn</title>
<path fill="none" stroke="black" d="M492,-13471.53C492,-13471.53 492,-13408.97 492,-13408.97"/>
<polygon fill="black" stroke="black" points="495.5,-13408.97 492,-13398.97 488.5,-13408.97 495.5,-13408.97"/>
</g>
<!-- lay5_attn_out -->
<g id="node50" class="node">
<title>lay5_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-13257.66 357,-13257.66 357,-13189.66 627,-13189.66 627,-13257.66"/>
<text text-anchor="middle" x="492" y="-13242.46" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-13227.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13212.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13197.46" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_attn&#45;&gt;lay5_attn_out -->
<g id="edge54" class="edge">
<title>lay5_attn&#45;&gt;lay5_attn_out</title>
<path fill="none" stroke="black" d="M492,-13330.53C492,-13330.53 492,-13267.97 492,-13267.97"/>
<polygon fill="black" stroke="black" points="495.5,-13267.97 492,-13257.97 488.5,-13267.97 495.5,-13267.97"/>
</g>
<!-- lay5_res1 -->
<g id="node51" class="node">
<title>lay5_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-13068.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-13087.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-13072.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13057.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-13042.38" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_attn_out&#45;&gt;lay5_res1 -->
<g id="edge55" class="edge">
<title>lay5_attn_out&#45;&gt;lay5_res1</title>
<path fill="none" stroke="black" d="M492,-13189.63C492,-13189.63 492,-13126.95 492,-13126.95"/>
<polygon fill="black" stroke="black" points="495.5,-13126.95 492,-13116.95 488.5,-13126.95 495.5,-13126.95"/>
</g>
<!-- lay5_attn_out&#45;&gt;tp_allreduce -->
<g id="edge184" class="edge">
<title>lay5_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.07,-13234C812.57,-13234 1123.45,-13234 1123.45,-13234 1123.45,-13234 1123.45,-19861.23 1123.45,-19861.23"/>
<polygon fill="black" stroke="black" points="1119.95,-19861.23 1123.45,-19871.23 1126.95,-19861.23 1119.95,-19861.23"/>
</g>
<!-- lay5_mlp_gate -->
<g id="node52" class="node">
<title>lay5_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-12947.5 262,-12947.5 262,-12879.5 474,-12879.5 474,-12947.5"/>
<text text-anchor="middle" x="368" y="-12932.3" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-12917.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-12902.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-12887.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_res1&#45;&gt;lay5_mlp_gate -->
<g id="edge56" class="edge">
<title>lay5_res1&#45;&gt;lay5_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-13027.83C368,-13027.83 368,-12957.68 368,-12957.68"/>
<polygon fill="black" stroke="black" points="371.5,-12957.68 368,-12947.68 364.5,-12957.68 371.5,-12957.68"/>
</g>
<!-- lay5_mlp_up -->
<g id="node53" class="node">
<title>lay5_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-12947.5 510,-12947.5 510,-12879.5 722,-12879.5 722,-12947.5"/>
<text text-anchor="middle" x="616" y="-12932.3" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-12917.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-12902.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-12887.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_res1&#45;&gt;lay5_mlp_up -->
<g id="edge57" class="edge">
<title>lay5_res1&#45;&gt;lay5_mlp_up</title>
<path fill="none" stroke="black" d="M616,-13027.83C616,-13027.83 616,-12957.68 616,-12957.68"/>
<polygon fill="black" stroke="black" points="619.5,-12957.68 616,-12947.68 612.5,-12957.68 619.5,-12957.68"/>
</g>
<!-- lay5_mlp_act -->
<g id="node54" class="node">
<title>lay5_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-12806.5 386,-12806.5 386,-12738.5 598,-12738.5 598,-12806.5"/>
<text text-anchor="middle" x="492" y="-12791.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-12776.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-12761.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-12746.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_mlp_gate&#45;&gt;lay5_mlp_act -->
<g id="edge58" class="edge">
<title>lay5_mlp_gate&#45;&gt;lay5_mlp_act</title>
<path fill="none" stroke="black" d="M430,-12879.36C430,-12879.36 430,-12816.8 430,-12816.8"/>
<polygon fill="black" stroke="black" points="433.5,-12816.8 430,-12806.8 426.5,-12816.8 433.5,-12816.8"/>
</g>
<!-- lay5_mlp_up&#45;&gt;lay5_mlp_act -->
<g id="edge59" class="edge">
<title>lay5_mlp_up&#45;&gt;lay5_mlp_act</title>
<path fill="none" stroke="black" d="M554,-12879.36C554,-12879.36 554,-12816.8 554,-12816.8"/>
<polygon fill="black" stroke="black" points="557.5,-12816.8 554,-12806.8 550.5,-12816.8 557.5,-12816.8"/>
</g>
<!-- lay5_mlp_down -->
<g id="node55" class="node">
<title>lay5_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-12665.5 390.5,-12665.5 390.5,-12597.5 593.5,-12597.5 593.5,-12665.5"/>
<text text-anchor="middle" x="492" y="-12650.3" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-12635.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-12620.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-12605.3" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_mlp_act&#45;&gt;lay5_mlp_down -->
<g id="edge60" class="edge">
<title>lay5_mlp_act&#45;&gt;lay5_mlp_down</title>
<path fill="none" stroke="black" d="M492,-12738.36C492,-12738.36 492,-12675.8 492,-12675.8"/>
<polygon fill="black" stroke="black" points="495.5,-12675.8 492,-12665.8 488.5,-12675.8 495.5,-12675.8"/>
</g>
<!-- lay5_res2 -->
<g id="node56" class="node">
<title>lay5_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-12476.41" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-12495.21" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-12480.21" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-12465.21" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-12450.21" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_mlp_down&#45;&gt;lay5_res2 -->
<g id="edge61" class="edge">
<title>lay5_mlp_down&#45;&gt;lay5_res2</title>
<path fill="none" stroke="black" d="M492,-12597.46C492,-12597.46 492,-12534.78 492,-12534.78"/>
<polygon fill="black" stroke="black" points="495.5,-12534.78 492,-12524.78 488.5,-12534.78 495.5,-12534.78"/>
</g>
<!-- lay5_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge186" class="edge">
<title>lay5_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.67,-12642C774.59,-12642 1133.63,-12642 1133.63,-12642 1133.63,-12642 1133.63,-19860.25 1133.63,-19860.25"/>
<polygon fill="black" stroke="black" points="1130.13,-19860.25 1133.63,-19870.25 1137.13,-19860.25 1130.13,-19860.25"/>
</g>
<!-- lay6_qkv_proj -->
<g id="node57" class="node">
<title>lay6_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-12337.33 383.5,-12337.33 383.5,-12269.33 600.5,-12269.33 600.5,-12337.33"/>
<text text-anchor="middle" x="492" y="-12322.13" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-12307.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-12292.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-12277.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5_res2&#45;&gt;lay6_qkv_proj -->
<g id="edge62" class="edge">
<title>lay5_res2&#45;&gt;lay6_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-12428.2C492,-12428.2 492,-12347.58 492,-12347.58"/>
<polygon fill="black" stroke="black" points="495.5,-12347.58 492,-12337.58 488.5,-12347.58 495.5,-12347.58"/>
</g>
<!-- lay6_attn -->
<g id="node58" class="node">
<title>lay6_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-12196.33 380.5,-12196.33 380.5,-12128.33 603.5,-12128.33 603.5,-12196.33"/>
<text text-anchor="middle" x="492" y="-12181.13" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-12166.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-12151.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-12136.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_qkv_proj&#45;&gt;lay6_attn -->
<g id="edge63" class="edge">
<title>lay6_qkv_proj&#45;&gt;lay6_attn</title>
<path fill="none" stroke="black" d="M492,-12269.2C492,-12269.2 492,-12206.64 492,-12206.64"/>
<polygon fill="black" stroke="black" points="495.5,-12206.64 492,-12196.64 488.5,-12206.64 495.5,-12206.64"/>
</g>
<!-- lay6_attn_out -->
<g id="node59" class="node">
<title>lay6_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-12055.33 357,-12055.33 357,-11987.33 627,-11987.33 627,-12055.33"/>
<text text-anchor="middle" x="492" y="-12040.13" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-12025.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-12010.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11995.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_attn&#45;&gt;lay6_attn_out -->
<g id="edge64" class="edge">
<title>lay6_attn&#45;&gt;lay6_attn_out</title>
<path fill="none" stroke="black" d="M492,-12128.2C492,-12128.2 492,-12065.64 492,-12065.64"/>
<polygon fill="black" stroke="black" points="495.5,-12065.64 492,-12055.64 488.5,-12065.64 495.5,-12065.64"/>
</g>
<!-- lay6_res1 -->
<g id="node60" class="node">
<title>lay6_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-11866.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-11885.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-11870.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11855.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11840.05" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_attn_out&#45;&gt;lay6_res1 -->
<g id="edge65" class="edge">
<title>lay6_attn_out&#45;&gt;lay6_res1</title>
<path fill="none" stroke="black" d="M492,-11987.3C492,-11987.3 492,-11924.62 492,-11924.62"/>
<polygon fill="black" stroke="black" points="495.5,-11924.62 492,-11914.62 488.5,-11924.62 495.5,-11924.62"/>
</g>
<!-- lay6_attn_out&#45;&gt;tp_allreduce -->
<g id="edge188" class="edge">
<title>lay6_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.06,-12032C817.98,-12032 1143.82,-12032 1143.82,-12032 1143.82,-12032 1143.82,-19859.47 1143.82,-19859.47"/>
<polygon fill="black" stroke="black" points="1140.32,-19859.47 1143.82,-19869.47 1147.32,-19859.47 1140.32,-19859.47"/>
</g>
<!-- lay6_mlp_gate -->
<g id="node61" class="node">
<title>lay6_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-11745.16 262,-11745.16 262,-11677.16 474,-11677.16 474,-11745.16"/>
<text text-anchor="middle" x="368" y="-11729.96" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-11714.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-11699.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-11684.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_res1&#45;&gt;lay6_mlp_gate -->
<g id="edge66" class="edge">
<title>lay6_res1&#45;&gt;lay6_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-11825.5C368,-11825.5 368,-11755.35 368,-11755.35"/>
<polygon fill="black" stroke="black" points="371.5,-11755.35 368,-11745.35 364.5,-11755.35 371.5,-11755.35"/>
</g>
<!-- lay6_mlp_up -->
<g id="node62" class="node">
<title>lay6_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-11745.16 510,-11745.16 510,-11677.16 722,-11677.16 722,-11745.16"/>
<text text-anchor="middle" x="616" y="-11729.96" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-11714.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-11699.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-11684.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_res1&#45;&gt;lay6_mlp_up -->
<g id="edge67" class="edge">
<title>lay6_res1&#45;&gt;lay6_mlp_up</title>
<path fill="none" stroke="black" d="M616,-11825.5C616,-11825.5 616,-11755.35 616,-11755.35"/>
<polygon fill="black" stroke="black" points="619.5,-11755.35 616,-11745.35 612.5,-11755.35 619.5,-11755.35"/>
</g>
<!-- lay6_mlp_act -->
<g id="node63" class="node">
<title>lay6_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-11604.16 386,-11604.16 386,-11536.16 598,-11536.16 598,-11604.16"/>
<text text-anchor="middle" x="492" y="-11588.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-11573.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-11558.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-11543.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_mlp_gate&#45;&gt;lay6_mlp_act -->
<g id="edge68" class="edge">
<title>lay6_mlp_gate&#45;&gt;lay6_mlp_act</title>
<path fill="none" stroke="black" d="M430,-11677.03C430,-11677.03 430,-11614.47 430,-11614.47"/>
<polygon fill="black" stroke="black" points="433.5,-11614.47 430,-11604.47 426.5,-11614.47 433.5,-11614.47"/>
</g>
<!-- lay6_mlp_up&#45;&gt;lay6_mlp_act -->
<g id="edge69" class="edge">
<title>lay6_mlp_up&#45;&gt;lay6_mlp_act</title>
<path fill="none" stroke="black" d="M554,-11677.03C554,-11677.03 554,-11614.47 554,-11614.47"/>
<polygon fill="black" stroke="black" points="557.5,-11614.47 554,-11604.47 550.5,-11614.47 557.5,-11614.47"/>
</g>
<!-- lay6_mlp_down -->
<g id="node64" class="node">
<title>lay6_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-11463.16 390.5,-11463.16 390.5,-11395.16 593.5,-11395.16 593.5,-11463.16"/>
<text text-anchor="middle" x="492" y="-11447.96" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-11432.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-11417.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11402.96" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_mlp_act&#45;&gt;lay6_mlp_down -->
<g id="edge70" class="edge">
<title>lay6_mlp_act&#45;&gt;lay6_mlp_down</title>
<path fill="none" stroke="black" d="M492,-11536.03C492,-11536.03 492,-11473.47 492,-11473.47"/>
<polygon fill="black" stroke="black" points="495.5,-11473.47 492,-11463.47 488.5,-11473.47 495.5,-11473.47"/>
</g>
<!-- lay6_res2 -->
<g id="node65" class="node">
<title>lay6_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-11274.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-11292.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-11277.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11262.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11247.88" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_mlp_down&#45;&gt;lay6_res2 -->
<g id="edge71" class="edge">
<title>lay6_mlp_down&#45;&gt;lay6_res2</title>
<path fill="none" stroke="black" d="M492,-11395.13C492,-11395.13 492,-11332.45 492,-11332.45"/>
<polygon fill="black" stroke="black" points="495.5,-11332.45 492,-11322.45 488.5,-11332.45 495.5,-11332.45"/>
</g>
<!-- lay6_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge190" class="edge">
<title>lay6_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.62,-11440C779.2,-11440 1154,-11440 1154,-11440 1154,-11440 1154,-19859.05 1154,-19859.05"/>
<polygon fill="black" stroke="black" points="1150.5,-19859.05 1154,-19869.05 1157.5,-19859.05 1150.5,-19859.05"/>
</g>
<!-- lay7_qkv_proj -->
<g id="node66" class="node">
<title>lay7_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-11135 383.5,-11135 383.5,-11067 600.5,-11067 600.5,-11135"/>
<text text-anchor="middle" x="492" y="-11119.8" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-11104.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-11089.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-11074.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6_res2&#45;&gt;lay7_qkv_proj -->
<g id="edge72" class="edge">
<title>lay6_res2&#45;&gt;lay7_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-11225.87C492,-11225.87 492,-11145.24 492,-11145.24"/>
<polygon fill="black" stroke="black" points="495.5,-11145.24 492,-11135.24 488.5,-11145.24 495.5,-11145.24"/>
</g>
<!-- lay7_attn -->
<g id="node67" class="node">
<title>lay7_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-10994 380.5,-10994 380.5,-10926 603.5,-10926 603.5,-10994"/>
<text text-anchor="middle" x="492" y="-10978.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-10963.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-10948.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10933.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_qkv_proj&#45;&gt;lay7_attn -->
<g id="edge73" class="edge">
<title>lay7_qkv_proj&#45;&gt;lay7_attn</title>
<path fill="none" stroke="black" d="M492,-11066.87C492,-11066.87 492,-11004.3 492,-11004.3"/>
<polygon fill="black" stroke="black" points="495.5,-11004.3 492,-10994.3 488.5,-11004.3 495.5,-11004.3"/>
</g>
<!-- lay7_attn_out -->
<g id="node68" class="node">
<title>lay7_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-10853 357,-10853 357,-10785 627,-10785 627,-10853"/>
<text text-anchor="middle" x="492" y="-10837.8" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-10822.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10807.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10792.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_attn&#45;&gt;lay7_attn_out -->
<g id="edge74" class="edge">
<title>lay7_attn&#45;&gt;lay7_attn_out</title>
<path fill="none" stroke="black" d="M492,-10925.87C492,-10925.87 492,-10863.3 492,-10863.3"/>
<polygon fill="black" stroke="black" points="495.5,-10863.3 492,-10853.3 488.5,-10863.3 495.5,-10863.3"/>
</g>
<!-- lay7_res1 -->
<g id="node69" class="node">
<title>lay7_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-10663.91" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-10682.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-10667.71" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10652.71" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10637.71" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_attn_out&#45;&gt;lay7_res1 -->
<g id="edge75" class="edge">
<title>lay7_attn_out&#45;&gt;lay7_res1</title>
<path fill="none" stroke="black" d="M492,-10784.96C492,-10784.96 492,-10722.28 492,-10722.28"/>
<polygon fill="black" stroke="black" points="495.5,-10722.28 492,-10712.28 488.5,-10722.28 495.5,-10722.28"/>
</g>
<!-- lay7_attn_out&#45;&gt;tp_allreduce -->
<g id="edge192" class="edge">
<title>lay7_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.22,-10830C823.51,-10830 1164.18,-10830 1164.18,-10830 1164.18,-10830 1164.18,-19858.8 1164.18,-19858.8"/>
<polygon fill="black" stroke="black" points="1160.68,-19858.8 1164.18,-19868.8 1167.68,-19858.8 1160.68,-19858.8"/>
</g>
<!-- lay7_mlp_gate -->
<g id="node70" class="node">
<title>lay7_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-10542.83 262,-10542.83 262,-10474.83 474,-10474.83 474,-10542.83"/>
<text text-anchor="middle" x="368" y="-10527.63" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-10512.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-10497.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-10482.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_res1&#45;&gt;lay7_mlp_gate -->
<g id="edge76" class="edge">
<title>lay7_res1&#45;&gt;lay7_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-10623.17C368,-10623.17 368,-10553.01 368,-10553.01"/>
<polygon fill="black" stroke="black" points="371.5,-10553.01 368,-10543.01 364.5,-10553.01 371.5,-10553.01"/>
</g>
<!-- lay7_mlp_up -->
<g id="node71" class="node">
<title>lay7_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-10542.83 510,-10542.83 510,-10474.83 722,-10474.83 722,-10542.83"/>
<text text-anchor="middle" x="616" y="-10527.63" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-10512.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-10497.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-10482.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_res1&#45;&gt;lay7_mlp_up -->
<g id="edge77" class="edge">
<title>lay7_res1&#45;&gt;lay7_mlp_up</title>
<path fill="none" stroke="black" d="M616,-10623.17C616,-10623.17 616,-10553.01 616,-10553.01"/>
<polygon fill="black" stroke="black" points="619.5,-10553.01 616,-10543.01 612.5,-10553.01 619.5,-10553.01"/>
</g>
<!-- lay7_mlp_act -->
<g id="node72" class="node">
<title>lay7_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-10401.83 386,-10401.83 386,-10333.83 598,-10333.83 598,-10401.83"/>
<text text-anchor="middle" x="492" y="-10386.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-10371.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-10356.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-10341.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_mlp_gate&#45;&gt;lay7_mlp_act -->
<g id="edge78" class="edge">
<title>lay7_mlp_gate&#45;&gt;lay7_mlp_act</title>
<path fill="none" stroke="black" d="M430,-10474.7C430,-10474.7 430,-10412.14 430,-10412.14"/>
<polygon fill="black" stroke="black" points="433.5,-10412.14 430,-10402.14 426.5,-10412.14 433.5,-10412.14"/>
</g>
<!-- lay7_mlp_up&#45;&gt;lay7_mlp_act -->
<g id="edge79" class="edge">
<title>lay7_mlp_up&#45;&gt;lay7_mlp_act</title>
<path fill="none" stroke="black" d="M554,-10474.7C554,-10474.7 554,-10412.14 554,-10412.14"/>
<polygon fill="black" stroke="black" points="557.5,-10412.14 554,-10402.14 550.5,-10412.14 557.5,-10412.14"/>
</g>
<!-- lay7_mlp_down -->
<g id="node73" class="node">
<title>lay7_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-10260.83 390.5,-10260.83 390.5,-10192.83 593.5,-10192.83 593.5,-10260.83"/>
<text text-anchor="middle" x="492" y="-10245.63" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-10230.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-10215.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10200.63" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_mlp_act&#45;&gt;lay7_mlp_down -->
<g id="edge80" class="edge">
<title>lay7_mlp_act&#45;&gt;lay7_mlp_down</title>
<path fill="none" stroke="black" d="M492,-10333.7C492,-10333.7 492,-10271.14 492,-10271.14"/>
<polygon fill="black" stroke="black" points="495.5,-10271.14 492,-10261.14 488.5,-10271.14 495.5,-10271.14"/>
</g>
<!-- lay7_res2 -->
<g id="node74" class="node">
<title>lay7_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-10071.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-10090.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-10075.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10060.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-10045.55" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay7_mlp_down&#45;&gt;lay7_res2 -->
<g id="edge81" class="edge">
<title>lay7_mlp_down&#45;&gt;lay7_res2</title>
<path fill="none" stroke="black" d="M492,-10192.8C492,-10192.8 492,-10130.12 492,-10130.12"/>
<polygon fill="black" stroke="black" points="495.5,-10130.12 492,-10120.12 488.5,-10130.12 495.5,-10130.12"/>
</g>
<!-- lay7_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge194" class="edge">
<title>lay7_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.79,-10238C784.01,-10238 1174.36,-10238 1174.36,-10238 1174.36,-10238 1174.36,-19858.88 1174.36,-19858.88"/>
<polygon fill="black" stroke="black" points="1170.86,-19858.88 1174.36,-19868.88 1177.86,-19858.88 1170.86,-19858.88"/>
</g>
<!-- stage1_input -->
<g id="node75" class="node">
<title>stage1_input</title>
<polygon fill="lightyellow" stroke="black" points="967.74,-9903.66 210.94,-9903.66 16.26,-9797.66 773.06,-9797.66 967.74,-9903.66"/>
<text text-anchor="middle" x="492" y="-9861.96" font-family="Times,serif" font-size="14.00">Input to Stage 1</text>
<text text-anchor="middle" x="492" y="-9846.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="492" y="-9831.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- lay7_res2&#45;&gt;stage1_input -->
<g id="edge82" class="edge">
<title>lay7_res2&#45;&gt;stage1_input</title>
<path fill="none" stroke="black" d="M492,-10023.5C492,-10023.5 492,-9913.84 492,-9913.84"/>
<polygon fill="black" stroke="black" points="495.5,-9913.84 492,-9903.84 488.5,-9913.84 495.5,-9913.84"/>
<text text-anchor="middle" x="554" y="-9976.46" font-family="Times,serif" font-size="14.00">Pipeline Transfer</text>
<text text-anchor="middle" x="554" y="-9961.46" font-family="Times,serif" font-size="14.00">Size: 5.24GB</text>
</g>
<!-- lay8_qkv_proj -->
<g id="node76" class="node">
<title>lay8_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-9706.66 383.5,-9706.66 383.5,-9638.66 600.5,-9638.66 600.5,-9706.66"/>
<text text-anchor="middle" x="492" y="-9691.46" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-9676.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-9661.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-9646.46" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- stage1_input&#45;&gt;lay8_qkv_proj -->
<g id="edge83" class="edge">
<title>stage1_input&#45;&gt;lay8_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-9797.26C492,-9797.26 492,-9716.67 492,-9716.67"/>
<polygon fill="black" stroke="black" points="495.5,-9716.67 492,-9706.67 488.5,-9716.67 495.5,-9716.67"/>
</g>
<!-- lay8_attn -->
<g id="node77" class="node">
<title>lay8_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-9565.66 380.5,-9565.66 380.5,-9497.66 603.5,-9497.66 603.5,-9565.66"/>
<text text-anchor="middle" x="492" y="-9550.46" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-9535.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-9520.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-9505.46" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_qkv_proj&#45;&gt;lay8_attn -->
<g id="edge84" class="edge">
<title>lay8_qkv_proj&#45;&gt;lay8_attn</title>
<path fill="none" stroke="black" d="M492,-9638.53C492,-9638.53 492,-9575.97 492,-9575.97"/>
<polygon fill="black" stroke="black" points="495.5,-9575.97 492,-9565.97 488.5,-9575.97 495.5,-9575.97"/>
</g>
<!-- lay8_attn_out -->
<g id="node78" class="node">
<title>lay8_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-9424.66 357,-9424.66 357,-9356.66 627,-9356.66 627,-9424.66"/>
<text text-anchor="middle" x="492" y="-9409.46" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-9394.46" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-9379.46" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-9364.46" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_attn&#45;&gt;lay8_attn_out -->
<g id="edge85" class="edge">
<title>lay8_attn&#45;&gt;lay8_attn_out</title>
<path fill="none" stroke="black" d="M492,-9497.53C492,-9497.53 492,-9434.97 492,-9434.97"/>
<polygon fill="black" stroke="black" points="495.5,-9434.97 492,-9424.97 488.5,-9434.97 495.5,-9434.97"/>
</g>
<!-- lay8_res1 -->
<g id="node79" class="node">
<title>lay8_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-9235.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-9254.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-9239.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-9224.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-9209.38" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_attn_out&#45;&gt;lay8_res1 -->
<g id="edge86" class="edge">
<title>lay8_attn_out&#45;&gt;lay8_res1</title>
<path fill="none" stroke="black" d="M492,-9356.63C492,-9356.63 492,-9293.95 492,-9293.95"/>
<polygon fill="black" stroke="black" points="495.5,-9293.95 492,-9283.95 488.5,-9293.95 495.5,-9293.95"/>
</g>
<!-- lay8_attn_out&#45;&gt;tp_allreduce -->
<g id="edge196" class="edge">
<title>lay8_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.17,-9401C828.72,-9401 1184.55,-9401 1184.55,-9401 1184.55,-9401 1184.55,-19858.81 1184.55,-19858.81"/>
<polygon fill="black" stroke="black" points="1181.05,-19858.81 1184.55,-19868.81 1188.05,-19858.81 1181.05,-19858.81"/>
</g>
<!-- lay8_mlp_gate -->
<g id="node80" class="node">
<title>lay8_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-9114.5 262,-9114.5 262,-9046.5 474,-9046.5 474,-9114.5"/>
<text text-anchor="middle" x="368" y="-9099.3" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-9084.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-9069.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-9054.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_res1&#45;&gt;lay8_mlp_gate -->
<g id="edge87" class="edge">
<title>lay8_res1&#45;&gt;lay8_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-9194.83C368,-9194.83 368,-9124.68 368,-9124.68"/>
<polygon fill="black" stroke="black" points="371.5,-9124.68 368,-9114.68 364.5,-9124.68 371.5,-9124.68"/>
</g>
<!-- lay8_mlp_up -->
<g id="node81" class="node">
<title>lay8_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-9114.5 510,-9114.5 510,-9046.5 722,-9046.5 722,-9114.5"/>
<text text-anchor="middle" x="616" y="-9099.3" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-9084.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-9069.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-9054.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_res1&#45;&gt;lay8_mlp_up -->
<g id="edge88" class="edge">
<title>lay8_res1&#45;&gt;lay8_mlp_up</title>
<path fill="none" stroke="black" d="M616,-9194.83C616,-9194.83 616,-9124.68 616,-9124.68"/>
<polygon fill="black" stroke="black" points="619.5,-9124.68 616,-9114.68 612.5,-9124.68 619.5,-9124.68"/>
</g>
<!-- lay8_mlp_act -->
<g id="node82" class="node">
<title>lay8_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-8973.5 386,-8973.5 386,-8905.5 598,-8905.5 598,-8973.5"/>
<text text-anchor="middle" x="492" y="-8958.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-8943.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-8928.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-8913.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_mlp_gate&#45;&gt;lay8_mlp_act -->
<g id="edge89" class="edge">
<title>lay8_mlp_gate&#45;&gt;lay8_mlp_act</title>
<path fill="none" stroke="black" d="M430,-9046.37C430,-9046.37 430,-8983.8 430,-8983.8"/>
<polygon fill="black" stroke="black" points="433.5,-8983.8 430,-8973.8 426.5,-8983.8 433.5,-8983.8"/>
</g>
<!-- lay8_mlp_up&#45;&gt;lay8_mlp_act -->
<g id="edge90" class="edge">
<title>lay8_mlp_up&#45;&gt;lay8_mlp_act</title>
<path fill="none" stroke="black" d="M554,-9046.37C554,-9046.37 554,-8983.8 554,-8983.8"/>
<polygon fill="black" stroke="black" points="557.5,-8983.8 554,-8973.8 550.5,-8983.8 557.5,-8983.8"/>
</g>
<!-- lay8_mlp_down -->
<g id="node83" class="node">
<title>lay8_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-8832.5 390.5,-8832.5 390.5,-8764.5 593.5,-8764.5 593.5,-8832.5"/>
<text text-anchor="middle" x="492" y="-8817.3" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-8802.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-8787.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8772.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_mlp_act&#45;&gt;lay8_mlp_down -->
<g id="edge91" class="edge">
<title>lay8_mlp_act&#45;&gt;lay8_mlp_down</title>
<path fill="none" stroke="black" d="M492,-8905.37C492,-8905.37 492,-8842.8 492,-8842.8"/>
<polygon fill="black" stroke="black" points="495.5,-8842.8 492,-8832.8 488.5,-8842.8 495.5,-8842.8"/>
</g>
<!-- lay8_res2 -->
<g id="node84" class="node">
<title>lay8_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-8643.41" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-8662.21" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-8647.21" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8632.21" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8617.21" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_mlp_down&#45;&gt;lay8_res2 -->
<g id="edge92" class="edge">
<title>lay8_mlp_down&#45;&gt;lay8_res2</title>
<path fill="none" stroke="black" d="M492,-8764.46C492,-8764.46 492,-8701.78 492,-8701.78"/>
<polygon fill="black" stroke="black" points="495.5,-8701.78 492,-8691.78 488.5,-8701.78 495.5,-8701.78"/>
</g>
<!-- lay8_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge198" class="edge">
<title>lay8_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.81,-8809C788.56,-8809 1194.73,-8809 1194.73,-8809 1194.73,-8809 1194.73,-19858.86 1194.73,-19858.86"/>
<polygon fill="black" stroke="black" points="1191.23,-19858.86 1194.73,-19868.86 1198.23,-19858.86 1191.23,-19858.86"/>
</g>
<!-- lay9_qkv_proj -->
<g id="node85" class="node">
<title>lay9_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-8504.33 383.5,-8504.33 383.5,-8436.33 600.5,-8436.33 600.5,-8504.33"/>
<text text-anchor="middle" x="492" y="-8489.13" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-8474.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8459.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-8444.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8_res2&#45;&gt;lay9_qkv_proj -->
<g id="edge93" class="edge">
<title>lay8_res2&#45;&gt;lay9_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-8595.2C492,-8595.2 492,-8514.58 492,-8514.58"/>
<polygon fill="black" stroke="black" points="495.5,-8514.58 492,-8504.58 488.5,-8514.58 495.5,-8514.58"/>
</g>
<!-- lay9_attn -->
<g id="node86" class="node">
<title>lay9_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-8363.33 380.5,-8363.33 380.5,-8295.33 603.5,-8295.33 603.5,-8363.33"/>
<text text-anchor="middle" x="492" y="-8348.13" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-8333.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-8318.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8303.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_qkv_proj&#45;&gt;lay9_attn -->
<g id="edge94" class="edge">
<title>lay9_qkv_proj&#45;&gt;lay9_attn</title>
<path fill="none" stroke="black" d="M492,-8436.2C492,-8436.2 492,-8373.64 492,-8373.64"/>
<polygon fill="black" stroke="black" points="495.5,-8373.64 492,-8363.64 488.5,-8373.64 495.5,-8373.64"/>
</g>
<!-- lay9_attn_out -->
<g id="node87" class="node">
<title>lay9_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-8222.33 357,-8222.33 357,-8154.33 627,-8154.33 627,-8222.33"/>
<text text-anchor="middle" x="492" y="-8207.13" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-8192.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8177.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8162.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_attn&#45;&gt;lay9_attn_out -->
<g id="edge95" class="edge">
<title>lay9_attn&#45;&gt;lay9_attn_out</title>
<path fill="none" stroke="black" d="M492,-8295.2C492,-8295.2 492,-8232.64 492,-8232.64"/>
<polygon fill="black" stroke="black" points="495.5,-8232.64 492,-8222.64 488.5,-8232.64 495.5,-8232.64"/>
</g>
<!-- lay9_res1 -->
<g id="node88" class="node">
<title>lay9_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-8033.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-8052.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-8037.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8022.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-8007.05" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_attn_out&#45;&gt;lay9_res1 -->
<g id="edge96" class="edge">
<title>lay9_attn_out&#45;&gt;lay9_res1</title>
<path fill="none" stroke="black" d="M492,-8154.3C492,-8154.3 492,-8091.62 492,-8091.62"/>
<polygon fill="black" stroke="black" points="495.5,-8091.62 492,-8081.62 488.5,-8091.62 495.5,-8091.62"/>
</g>
<!-- lay9_attn_out&#45;&gt;tp_allreduce -->
<g id="edge200" class="edge">
<title>lay9_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.35,-8199C834.11,-8199 1204.91,-8199 1204.91,-8199 1204.91,-8199 1204.91,-19859.01 1204.91,-19859.01"/>
<polygon fill="black" stroke="black" points="1201.41,-19859.01 1204.91,-19869.01 1208.41,-19859.01 1201.41,-19859.01"/>
</g>
<!-- lay9_mlp_gate -->
<g id="node89" class="node">
<title>lay9_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-7912.16 262,-7912.16 262,-7844.16 474,-7844.16 474,-7912.16"/>
<text text-anchor="middle" x="368" y="-7896.96" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-7881.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-7866.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-7851.96" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_res1&#45;&gt;lay9_mlp_gate -->
<g id="edge97" class="edge">
<title>lay9_res1&#45;&gt;lay9_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-7992.5C368,-7992.5 368,-7922.35 368,-7922.35"/>
<polygon fill="black" stroke="black" points="371.5,-7922.35 368,-7912.35 364.5,-7922.35 371.5,-7922.35"/>
</g>
<!-- lay9_mlp_up -->
<g id="node90" class="node">
<title>lay9_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-7912.16 510,-7912.16 510,-7844.16 722,-7844.16 722,-7912.16"/>
<text text-anchor="middle" x="616" y="-7896.96" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-7881.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-7866.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-7851.96" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_res1&#45;&gt;lay9_mlp_up -->
<g id="edge98" class="edge">
<title>lay9_res1&#45;&gt;lay9_mlp_up</title>
<path fill="none" stroke="black" d="M616,-7992.5C616,-7992.5 616,-7922.35 616,-7922.35"/>
<polygon fill="black" stroke="black" points="619.5,-7922.35 616,-7912.35 612.5,-7922.35 619.5,-7922.35"/>
</g>
<!-- lay9_mlp_act -->
<g id="node91" class="node">
<title>lay9_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-7771.16 386,-7771.16 386,-7703.16 598,-7703.16 598,-7771.16"/>
<text text-anchor="middle" x="492" y="-7755.96" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-7740.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-7725.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-7710.96" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_mlp_gate&#45;&gt;lay9_mlp_act -->
<g id="edge99" class="edge">
<title>lay9_mlp_gate&#45;&gt;lay9_mlp_act</title>
<path fill="none" stroke="black" d="M430,-7844.03C430,-7844.03 430,-7781.47 430,-7781.47"/>
<polygon fill="black" stroke="black" points="433.5,-7781.47 430,-7771.47 426.5,-7781.47 433.5,-7781.47"/>
</g>
<!-- lay9_mlp_up&#45;&gt;lay9_mlp_act -->
<g id="edge100" class="edge">
<title>lay9_mlp_up&#45;&gt;lay9_mlp_act</title>
<path fill="none" stroke="black" d="M554,-7844.03C554,-7844.03 554,-7781.47 554,-7781.47"/>
<polygon fill="black" stroke="black" points="557.5,-7781.47 554,-7771.47 550.5,-7781.47 557.5,-7781.47"/>
</g>
<!-- lay9_mlp_down -->
<g id="node92" class="node">
<title>lay9_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-7630.16 390.5,-7630.16 390.5,-7562.16 593.5,-7562.16 593.5,-7630.16"/>
<text text-anchor="middle" x="492" y="-7614.96" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-7599.96" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-7584.96" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-7569.96" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_mlp_act&#45;&gt;lay9_mlp_down -->
<g id="edge101" class="edge">
<title>lay9_mlp_act&#45;&gt;lay9_mlp_down</title>
<path fill="none" stroke="black" d="M492,-7703.03C492,-7703.03 492,-7640.47 492,-7640.47"/>
<polygon fill="black" stroke="black" points="495.5,-7640.47 492,-7630.47 488.5,-7640.47 495.5,-7640.47"/>
</g>
<!-- lay9_res2 -->
<g id="node93" class="node">
<title>lay9_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-7441.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-7459.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-7444.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-7429.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-7414.88" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_mlp_down&#45;&gt;lay9_res2 -->
<g id="edge102" class="edge">
<title>lay9_mlp_down&#45;&gt;lay9_res2</title>
<path fill="none" stroke="black" d="M492,-7562.13C492,-7562.13 492,-7499.45 492,-7499.45"/>
<polygon fill="black" stroke="black" points="495.5,-7499.45 492,-7489.45 488.5,-7499.45 495.5,-7499.45"/>
</g>
<!-- lay9_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge202" class="edge">
<title>lay9_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.69,-7607C792.85,-7607 1215.09,-7607 1215.09,-7607 1215.09,-7607 1215.09,-19859.39 1215.09,-19859.39"/>
<polygon fill="black" stroke="black" points="1211.59,-19859.39 1215.09,-19869.39 1218.59,-19859.39 1211.59,-19859.39"/>
</g>
<!-- lay10_qkv_proj -->
<g id="node94" class="node">
<title>lay10_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-7302 383.5,-7302 383.5,-7234 600.5,-7234 600.5,-7302"/>
<text text-anchor="middle" x="492" y="-7286.8" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-7271.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-7256.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-7241.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9_res2&#45;&gt;lay10_qkv_proj -->
<g id="edge103" class="edge">
<title>lay9_res2&#45;&gt;lay10_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-7392.87C492,-7392.87 492,-7312.25 492,-7312.25"/>
<polygon fill="black" stroke="black" points="495.5,-7312.25 492,-7302.25 488.5,-7312.25 495.5,-7312.25"/>
</g>
<!-- lay10_attn -->
<g id="node95" class="node">
<title>lay10_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-7161 380.5,-7161 380.5,-7093 603.5,-7093 603.5,-7161"/>
<text text-anchor="middle" x="492" y="-7145.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-7130.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-7115.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-7100.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_qkv_proj&#45;&gt;lay10_attn -->
<g id="edge104" class="edge">
<title>lay10_qkv_proj&#45;&gt;lay10_attn</title>
<path fill="none" stroke="black" d="M492,-7233.87C492,-7233.87 492,-7171.3 492,-7171.3"/>
<polygon fill="black" stroke="black" points="495.5,-7171.3 492,-7161.3 488.5,-7171.3 495.5,-7171.3"/>
</g>
<!-- lay10_attn_out -->
<g id="node96" class="node">
<title>lay10_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-7020 357,-7020 357,-6952 627,-6952 627,-7020"/>
<text text-anchor="middle" x="492" y="-7004.8" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-6989.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6974.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6959.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_attn&#45;&gt;lay10_attn_out -->
<g id="edge105" class="edge">
<title>lay10_attn&#45;&gt;lay10_attn_out</title>
<path fill="none" stroke="black" d="M492,-7092.87C492,-7092.87 492,-7030.3 492,-7030.3"/>
<polygon fill="black" stroke="black" points="495.5,-7030.3 492,-7020.3 488.5,-7030.3 495.5,-7030.3"/>
</g>
<!-- lay10_res1 -->
<g id="node97" class="node">
<title>lay10_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-6830.92" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-6849.72" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-6834.72" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6819.72" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6804.72" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_attn_out&#45;&gt;lay10_res1 -->
<g id="edge106" class="edge">
<title>lay10_attn_out&#45;&gt;lay10_res1</title>
<path fill="none" stroke="black" d="M492,-6951.96C492,-6951.96 492,-6889.28 492,-6889.28"/>
<polygon fill="black" stroke="black" points="495.5,-6889.28 492,-6879.28 488.5,-6889.28 495.5,-6889.28"/>
</g>
<!-- lay10_attn_out&#45;&gt;tp_allreduce -->
<g id="edge204" class="edge">
<title>lay10_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.35,-6997C839.22,-6997 1225.27,-6997 1225.27,-6997 1225.27,-6997 1225.27,-19860.15 1225.27,-19860.15"/>
<polygon fill="black" stroke="black" points="1221.78,-19860.15 1225.27,-19870.15 1228.78,-19860.15 1221.78,-19860.15"/>
</g>
<!-- lay10_mlp_gate -->
<g id="node98" class="node">
<title>lay10_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-6709.83 262,-6709.83 262,-6641.83 474,-6641.83 474,-6709.83"/>
<text text-anchor="middle" x="368" y="-6694.63" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-6679.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-6664.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-6649.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_res1&#45;&gt;lay10_mlp_gate -->
<g id="edge107" class="edge">
<title>lay10_res1&#45;&gt;lay10_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-6790.17C368,-6790.17 368,-6720.02 368,-6720.02"/>
<polygon fill="black" stroke="black" points="371.5,-6720.02 368,-6710.02 364.5,-6720.02 371.5,-6720.02"/>
</g>
<!-- lay10_mlp_up -->
<g id="node99" class="node">
<title>lay10_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-6709.83 510,-6709.83 510,-6641.83 722,-6641.83 722,-6709.83"/>
<text text-anchor="middle" x="616" y="-6694.63" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-6679.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-6664.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-6649.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_res1&#45;&gt;lay10_mlp_up -->
<g id="edge108" class="edge">
<title>lay10_res1&#45;&gt;lay10_mlp_up</title>
<path fill="none" stroke="black" d="M616,-6790.17C616,-6790.17 616,-6720.02 616,-6720.02"/>
<polygon fill="black" stroke="black" points="619.5,-6720.02 616,-6710.02 612.5,-6720.02 619.5,-6720.02"/>
</g>
<!-- lay10_mlp_act -->
<g id="node100" class="node">
<title>lay10_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-6568.83 386,-6568.83 386,-6500.83 598,-6500.83 598,-6568.83"/>
<text text-anchor="middle" x="492" y="-6553.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-6538.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-6523.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-6508.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_mlp_gate&#45;&gt;lay10_mlp_act -->
<g id="edge109" class="edge">
<title>lay10_mlp_gate&#45;&gt;lay10_mlp_act</title>
<path fill="none" stroke="black" d="M430,-6641.7C430,-6641.7 430,-6579.14 430,-6579.14"/>
<polygon fill="black" stroke="black" points="433.5,-6579.14 430,-6569.14 426.5,-6579.14 433.5,-6579.14"/>
</g>
<!-- lay10_mlp_up&#45;&gt;lay10_mlp_act -->
<g id="edge110" class="edge">
<title>lay10_mlp_up&#45;&gt;lay10_mlp_act</title>
<path fill="none" stroke="black" d="M554,-6641.7C554,-6641.7 554,-6579.14 554,-6579.14"/>
<polygon fill="black" stroke="black" points="557.5,-6579.14 554,-6569.14 550.5,-6579.14 557.5,-6579.14"/>
</g>
<!-- lay10_mlp_down -->
<g id="node101" class="node">
<title>lay10_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-6427.83 390.5,-6427.83 390.5,-6359.83 593.5,-6359.83 593.5,-6427.83"/>
<text text-anchor="middle" x="492" y="-6412.63" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-6397.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-6382.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6367.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_mlp_act&#45;&gt;lay10_mlp_down -->
<g id="edge111" class="edge">
<title>lay10_mlp_act&#45;&gt;lay10_mlp_down</title>
<path fill="none" stroke="black" d="M492,-6500.7C492,-6500.7 492,-6438.14 492,-6438.14"/>
<polygon fill="black" stroke="black" points="495.5,-6438.14 492,-6428.14 488.5,-6438.14 495.5,-6438.14"/>
</g>
<!-- lay10_res2 -->
<g id="node102" class="node">
<title>lay10_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-6238.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-6257.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-6242.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6227.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6212.55" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_mlp_down&#45;&gt;lay10_res2 -->
<g id="edge112" class="edge">
<title>lay10_mlp_down&#45;&gt;lay10_res2</title>
<path fill="none" stroke="black" d="M492,-6359.8C492,-6359.8 492,-6297.12 492,-6297.12"/>
<polygon fill="black" stroke="black" points="495.5,-6297.12 492,-6287.12 488.5,-6297.12 495.5,-6297.12"/>
</g>
<!-- lay10_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge206" class="edge">
<title>lay10_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.82,-6405C797.43,-6405 1235.46,-6405 1235.46,-6405 1235.46,-6405 1235.46,-19860.82 1235.46,-19860.82"/>
<polygon fill="black" stroke="black" points="1231.96,-19860.82 1235.46,-19870.82 1238.96,-19860.82 1231.96,-19860.82"/>
</g>
<!-- lay11_qkv_proj -->
<g id="node103" class="node">
<title>lay11_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-6099.67 383.5,-6099.67 383.5,-6031.67 600.5,-6031.67 600.5,-6099.67"/>
<text text-anchor="middle" x="492" y="-6084.47" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-6069.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-6054.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-6039.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10_res2&#45;&gt;lay11_qkv_proj -->
<g id="edge113" class="edge">
<title>lay10_res2&#45;&gt;lay11_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-6190.54C492,-6190.54 492,-6109.91 492,-6109.91"/>
<polygon fill="black" stroke="black" points="495.5,-6109.91 492,-6099.91 488.5,-6109.91 495.5,-6109.91"/>
</g>
<!-- lay11_attn -->
<g id="node104" class="node">
<title>lay11_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-5958.67 380.5,-5958.67 380.5,-5890.67 603.5,-5890.67 603.5,-5958.67"/>
<text text-anchor="middle" x="492" y="-5943.47" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-5928.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-5913.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5898.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_qkv_proj&#45;&gt;lay11_attn -->
<g id="edge114" class="edge">
<title>lay11_qkv_proj&#45;&gt;lay11_attn</title>
<path fill="none" stroke="black" d="M492,-6031.53C492,-6031.53 492,-5968.97 492,-5968.97"/>
<polygon fill="black" stroke="black" points="495.5,-5968.97 492,-5958.97 488.5,-5968.97 495.5,-5968.97"/>
</g>
<!-- lay11_attn_out -->
<g id="node105" class="node">
<title>lay11_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-5817.67 357,-5817.67 357,-5749.67 627,-5749.67 627,-5817.67"/>
<text text-anchor="middle" x="492" y="-5802.47" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-5787.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5772.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5757.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_attn&#45;&gt;lay11_attn_out -->
<g id="edge115" class="edge">
<title>lay11_attn&#45;&gt;lay11_attn_out</title>
<path fill="none" stroke="black" d="M492,-5890.53C492,-5890.53 492,-5827.97 492,-5827.97"/>
<polygon fill="black" stroke="black" points="495.5,-5827.97 492,-5817.97 488.5,-5827.97 495.5,-5827.97"/>
</g>
<!-- lay11_res1 -->
<g id="node106" class="node">
<title>lay11_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-5628.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-5647.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-5632.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5617.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5602.38" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_attn_out&#45;&gt;lay11_res1 -->
<g id="edge116" class="edge">
<title>lay11_attn_out&#45;&gt;lay11_res1</title>
<path fill="none" stroke="black" d="M492,-5749.63C492,-5749.63 492,-5686.95 492,-5686.95"/>
<polygon fill="black" stroke="black" points="495.5,-5686.95 492,-5676.95 488.5,-5686.95 495.5,-5686.95"/>
</g>
<!-- lay11_attn_out&#45;&gt;tp_allreduce -->
<g id="edge208" class="edge">
<title>lay11_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.17,-5794C844.05,-5794 1245.64,-5794 1245.64,-5794 1245.64,-5794 1245.64,-19861.58 1245.64,-19861.58"/>
<polygon fill="black" stroke="black" points="1242.14,-19861.58 1245.64,-19871.58 1249.14,-19861.58 1242.14,-19861.58"/>
</g>
<!-- lay11_mlp_gate -->
<g id="node107" class="node">
<title>lay11_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-5507.5 262,-5507.5 262,-5439.5 474,-5439.5 474,-5507.5"/>
<text text-anchor="middle" x="368" y="-5492.3" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-5477.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-5462.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-5447.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_res1&#45;&gt;lay11_mlp_gate -->
<g id="edge117" class="edge">
<title>lay11_res1&#45;&gt;lay11_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-5587.84C368,-5587.84 368,-5517.68 368,-5517.68"/>
<polygon fill="black" stroke="black" points="371.5,-5517.68 368,-5507.68 364.5,-5517.68 371.5,-5517.68"/>
</g>
<!-- lay11_mlp_up -->
<g id="node108" class="node">
<title>lay11_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-5507.5 510,-5507.5 510,-5439.5 722,-5439.5 722,-5507.5"/>
<text text-anchor="middle" x="616" y="-5492.3" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-5477.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-5462.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-5447.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_res1&#45;&gt;lay11_mlp_up -->
<g id="edge118" class="edge">
<title>lay11_res1&#45;&gt;lay11_mlp_up</title>
<path fill="none" stroke="black" d="M616,-5587.84C616,-5587.84 616,-5517.68 616,-5517.68"/>
<polygon fill="black" stroke="black" points="619.5,-5517.68 616,-5507.68 612.5,-5517.68 619.5,-5517.68"/>
</g>
<!-- lay11_mlp_act -->
<g id="node109" class="node">
<title>lay11_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-5366.5 386,-5366.5 386,-5298.5 598,-5298.5 598,-5366.5"/>
<text text-anchor="middle" x="492" y="-5351.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-5336.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-5321.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-5306.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_mlp_gate&#45;&gt;lay11_mlp_act -->
<g id="edge119" class="edge">
<title>lay11_mlp_gate&#45;&gt;lay11_mlp_act</title>
<path fill="none" stroke="black" d="M430,-5439.37C430,-5439.37 430,-5376.81 430,-5376.81"/>
<polygon fill="black" stroke="black" points="433.5,-5376.81 430,-5366.81 426.5,-5376.81 433.5,-5376.81"/>
</g>
<!-- lay11_mlp_up&#45;&gt;lay11_mlp_act -->
<g id="edge120" class="edge">
<title>lay11_mlp_up&#45;&gt;lay11_mlp_act</title>
<path fill="none" stroke="black" d="M554,-5439.37C554,-5439.37 554,-5376.81 554,-5376.81"/>
<polygon fill="black" stroke="black" points="557.5,-5376.81 554,-5366.81 550.5,-5376.81 557.5,-5376.81"/>
</g>
<!-- lay11_mlp_down -->
<g id="node110" class="node">
<title>lay11_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-5225.5 390.5,-5225.5 390.5,-5157.5 593.5,-5157.5 593.5,-5225.5"/>
<text text-anchor="middle" x="492" y="-5210.3" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-5195.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-5180.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5165.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_mlp_act&#45;&gt;lay11_mlp_down -->
<g id="edge121" class="edge">
<title>lay11_mlp_act&#45;&gt;lay11_mlp_down</title>
<path fill="none" stroke="black" d="M492,-5298.37C492,-5298.37 492,-5235.81 492,-5235.81"/>
<polygon fill="black" stroke="black" points="495.5,-5235.81 492,-5225.81 488.5,-5235.81 495.5,-5235.81"/>
</g>
<!-- lay11_res2 -->
<g id="node111" class="node">
<title>lay11_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-5036.42" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-5055.22" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-5040.22" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5025.22" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-5010.22" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_mlp_down&#45;&gt;lay11_res2 -->
<g id="edge122" class="edge">
<title>lay11_mlp_down&#45;&gt;lay11_res2</title>
<path fill="none" stroke="black" d="M492,-5157.47C492,-5157.47 492,-5094.78 492,-5094.78"/>
<polygon fill="black" stroke="black" points="495.5,-5094.78 492,-5084.78 488.5,-5094.78 495.5,-5094.78"/>
</g>
<!-- lay11_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge210" class="edge">
<title>lay11_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.82,-5202C801.78,-5202 1255.82,-5202 1255.82,-5202 1255.82,-5202 1255.82,-19862.5 1255.82,-19862.5"/>
<polygon fill="black" stroke="black" points="1252.32,-19862.5 1255.82,-19872.5 1259.32,-19862.5 1252.32,-19862.5"/>
</g>
<!-- lay12_qkv_proj -->
<g id="node112" class="node">
<title>lay12_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-4897.33 383.5,-4897.33 383.5,-4829.33 600.5,-4829.33 600.5,-4897.33"/>
<text text-anchor="middle" x="492" y="-4882.13" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-4867.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-4852.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-4837.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11_res2&#45;&gt;lay12_qkv_proj -->
<g id="edge123" class="edge">
<title>lay11_res2&#45;&gt;lay12_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-4988.2C492,-4988.2 492,-4907.58 492,-4907.58"/>
<polygon fill="black" stroke="black" points="495.5,-4907.58 492,-4897.58 488.5,-4907.58 495.5,-4907.58"/>
</g>
<!-- lay12_attn -->
<g id="node113" class="node">
<title>lay12_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-4756.33 380.5,-4756.33 380.5,-4688.33 603.5,-4688.33 603.5,-4756.33"/>
<text text-anchor="middle" x="492" y="-4741.13" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-4726.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-4711.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-4696.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_qkv_proj&#45;&gt;lay12_attn -->
<g id="edge124" class="edge">
<title>lay12_qkv_proj&#45;&gt;lay12_attn</title>
<path fill="none" stroke="black" d="M492,-4829.2C492,-4829.2 492,-4766.64 492,-4766.64"/>
<polygon fill="black" stroke="black" points="495.5,-4766.64 492,-4756.64 488.5,-4766.64 495.5,-4766.64"/>
</g>
<!-- lay12_attn_out -->
<g id="node114" class="node">
<title>lay12_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-4615.33 357,-4615.33 357,-4547.33 627,-4547.33 627,-4615.33"/>
<text text-anchor="middle" x="492" y="-4600.13" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-4585.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-4570.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-4555.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_attn&#45;&gt;lay12_attn_out -->
<g id="edge125" class="edge">
<title>lay12_attn&#45;&gt;lay12_attn_out</title>
<path fill="none" stroke="black" d="M492,-4688.2C492,-4688.2 492,-4625.64 492,-4625.64"/>
<polygon fill="black" stroke="black" points="495.5,-4625.64 492,-4615.64 488.5,-4625.64 495.5,-4625.64"/>
</g>
<!-- lay12_res1 -->
<g id="node115" class="node">
<title>lay12_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-4426.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-4445.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-4430.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-4415.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-4400.05" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_attn_out&#45;&gt;lay12_res1 -->
<g id="edge126" class="edge">
<title>lay12_attn_out&#45;&gt;lay12_res1</title>
<path fill="none" stroke="black" d="M492,-4547.3C492,-4547.3 492,-4484.62 492,-4484.62"/>
<polygon fill="black" stroke="black" points="495.5,-4484.62 492,-4474.62 488.5,-4484.62 495.5,-4484.62"/>
</g>
<!-- lay12_attn_out&#45;&gt;tp_allreduce -->
<g id="edge212" class="edge">
<title>lay12_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.26,-4592C849.13,-4592 1266,-4592 1266,-4592 1266,-4592 1266,-19863.79 1266,-19863.79"/>
<polygon fill="black" stroke="black" points="1262.5,-19863.79 1266,-19873.79 1269.5,-19863.79 1262.5,-19863.79"/>
</g>
<!-- lay12_mlp_gate -->
<g id="node116" class="node">
<title>lay12_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-4305.17 262,-4305.17 262,-4237.17 474,-4237.17 474,-4305.17"/>
<text text-anchor="middle" x="368" y="-4289.97" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-4274.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-4259.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-4244.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_res1&#45;&gt;lay12_mlp_gate -->
<g id="edge127" class="edge">
<title>lay12_res1&#45;&gt;lay12_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-4385.5C368,-4385.5 368,-4315.35 368,-4315.35"/>
<polygon fill="black" stroke="black" points="371.5,-4315.35 368,-4305.35 364.5,-4315.35 371.5,-4315.35"/>
</g>
<!-- lay12_mlp_up -->
<g id="node117" class="node">
<title>lay12_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-4305.17 510,-4305.17 510,-4237.17 722,-4237.17 722,-4305.17"/>
<text text-anchor="middle" x="616" y="-4289.97" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-4274.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-4259.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-4244.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_res1&#45;&gt;lay12_mlp_up -->
<g id="edge128" class="edge">
<title>lay12_res1&#45;&gt;lay12_mlp_up</title>
<path fill="none" stroke="black" d="M616,-4385.5C616,-4385.5 616,-4315.35 616,-4315.35"/>
<polygon fill="black" stroke="black" points="619.5,-4315.35 616,-4305.35 612.5,-4315.35 619.5,-4315.35"/>
</g>
<!-- lay12_mlp_act -->
<g id="node118" class="node">
<title>lay12_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-4164.17 386,-4164.17 386,-4096.17 598,-4096.17 598,-4164.17"/>
<text text-anchor="middle" x="492" y="-4148.97" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-4133.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-4118.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-4103.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_mlp_gate&#45;&gt;lay12_mlp_act -->
<g id="edge129" class="edge">
<title>lay12_mlp_gate&#45;&gt;lay12_mlp_act</title>
<path fill="none" stroke="black" d="M430,-4237.03C430,-4237.03 430,-4174.47 430,-4174.47"/>
<polygon fill="black" stroke="black" points="433.5,-4174.47 430,-4164.47 426.5,-4174.47 433.5,-4174.47"/>
</g>
<!-- lay12_mlp_up&#45;&gt;lay12_mlp_act -->
<g id="edge130" class="edge">
<title>lay12_mlp_up&#45;&gt;lay12_mlp_act</title>
<path fill="none" stroke="black" d="M554,-4237.03C554,-4237.03 554,-4174.47 554,-4174.47"/>
<polygon fill="black" stroke="black" points="557.5,-4174.47 554,-4164.47 550.5,-4174.47 557.5,-4174.47"/>
</g>
<!-- lay12_mlp_down -->
<g id="node119" class="node">
<title>lay12_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-4023.17 390.5,-4023.17 390.5,-3955.17 593.5,-3955.17 593.5,-4023.17"/>
<text text-anchor="middle" x="492" y="-4007.97" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-3992.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-3977.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3962.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_mlp_act&#45;&gt;lay12_mlp_down -->
<g id="edge131" class="edge">
<title>lay12_mlp_act&#45;&gt;lay12_mlp_down</title>
<path fill="none" stroke="black" d="M492,-4096.03C492,-4096.03 492,-4033.47 492,-4033.47"/>
<polygon fill="black" stroke="black" points="495.5,-4033.47 492,-4023.47 488.5,-4033.47 495.5,-4033.47"/>
</g>
<!-- lay12_res2 -->
<g id="node120" class="node">
<title>lay12_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-3834.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-3852.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-3837.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3822.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3807.88" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_mlp_down&#45;&gt;lay12_res2 -->
<g id="edge132" class="edge">
<title>lay12_mlp_down&#45;&gt;lay12_res2</title>
<path fill="none" stroke="black" d="M492,-3955.13C492,-3955.13 492,-3892.45 492,-3892.45"/>
<polygon fill="black" stroke="black" points="495.5,-3892.45 492,-3882.45 488.5,-3892.45 495.5,-3892.45"/>
</g>
<!-- lay12_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge214" class="edge">
<title>lay12_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.71,-4000C805.9,-4000 1276.19,-4000 1276.19,-4000 1276.19,-4000 1276.19,-19865.51 1276.19,-19865.51"/>
<polygon fill="black" stroke="black" points="1272.69,-19865.51 1276.19,-19875.51 1279.69,-19865.51 1272.69,-19865.51"/>
</g>
<!-- lay13_qkv_proj -->
<g id="node121" class="node">
<title>lay13_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-3695 383.5,-3695 383.5,-3627 600.5,-3627 600.5,-3695"/>
<text text-anchor="middle" x="492" y="-3679.8" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-3664.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3649.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-3634.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12_res2&#45;&gt;lay13_qkv_proj -->
<g id="edge133" class="edge">
<title>lay12_res2&#45;&gt;lay13_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-3785.87C492,-3785.87 492,-3705.25 492,-3705.25"/>
<polygon fill="black" stroke="black" points="495.5,-3705.25 492,-3695.25 488.5,-3705.25 495.5,-3705.25"/>
</g>
<!-- lay13_attn -->
<g id="node122" class="node">
<title>lay13_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-3554 380.5,-3554 380.5,-3486 603.5,-3486 603.5,-3554"/>
<text text-anchor="middle" x="492" y="-3538.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-3523.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-3508.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3493.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_qkv_proj&#45;&gt;lay13_attn -->
<g id="edge134" class="edge">
<title>lay13_qkv_proj&#45;&gt;lay13_attn</title>
<path fill="none" stroke="black" d="M492,-3626.87C492,-3626.87 492,-3564.31 492,-3564.31"/>
<polygon fill="black" stroke="black" points="495.5,-3564.31 492,-3554.31 488.5,-3564.31 495.5,-3564.31"/>
</g>
<!-- lay13_attn_out -->
<g id="node123" class="node">
<title>lay13_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-3413 357,-3413 357,-3345 627,-3345 627,-3413"/>
<text text-anchor="middle" x="492" y="-3397.8" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-3382.8" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3367.8" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3352.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_attn&#45;&gt;lay13_attn_out -->
<g id="edge135" class="edge">
<title>lay13_attn&#45;&gt;lay13_attn_out</title>
<path fill="none" stroke="black" d="M492,-3485.87C492,-3485.87 492,-3423.31 492,-3423.31"/>
<polygon fill="black" stroke="black" points="495.5,-3423.31 492,-3413.31 488.5,-3423.31 495.5,-3423.31"/>
</g>
<!-- lay13_res1 -->
<g id="node124" class="node">
<title>lay13_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-3223.92" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-3242.72" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-3227.72" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3212.72" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-3197.72" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_attn_out&#45;&gt;lay13_res1 -->
<g id="edge136" class="edge">
<title>lay13_attn_out&#45;&gt;lay13_res1</title>
<path fill="none" stroke="black" d="M492,-3344.97C492,-3344.97 492,-3282.29 492,-3282.29"/>
<polygon fill="black" stroke="black" points="495.5,-3282.29 492,-3272.29 488.5,-3282.29 495.5,-3282.29"/>
</g>
<!-- lay13_attn_out&#45;&gt;tp_allreduce -->
<g id="edge216" class="edge">
<title>lay13_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.2,-3390C853.96,-3390 1286.37,-3390 1286.37,-3390 1286.37,-3390 1286.37,-19866.99 1286.37,-19866.99"/>
<polygon fill="black" stroke="black" points="1282.87,-19866.99 1286.37,-19876.99 1289.87,-19866.99 1282.87,-19866.99"/>
</g>
<!-- lay13_mlp_gate -->
<g id="node125" class="node">
<title>lay13_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-3102.83 262,-3102.83 262,-3034.83 474,-3034.83 474,-3102.83"/>
<text text-anchor="middle" x="368" y="-3087.63" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-3072.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-3057.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-3042.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_res1&#45;&gt;lay13_mlp_gate -->
<g id="edge137" class="edge">
<title>lay13_res1&#45;&gt;lay13_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-3183.17C368,-3183.17 368,-3113.02 368,-3113.02"/>
<polygon fill="black" stroke="black" points="371.5,-3113.02 368,-3103.02 364.5,-3113.02 371.5,-3113.02"/>
</g>
<!-- lay13_mlp_up -->
<g id="node126" class="node">
<title>lay13_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-3102.83 510,-3102.83 510,-3034.83 722,-3034.83 722,-3102.83"/>
<text text-anchor="middle" x="616" y="-3087.63" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-3072.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-3057.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-3042.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_res1&#45;&gt;lay13_mlp_up -->
<g id="edge138" class="edge">
<title>lay13_res1&#45;&gt;lay13_mlp_up</title>
<path fill="none" stroke="black" d="M616,-3183.17C616,-3183.17 616,-3113.02 616,-3113.02"/>
<polygon fill="black" stroke="black" points="619.5,-3113.02 616,-3103.02 612.5,-3113.02 619.5,-3113.02"/>
</g>
<!-- lay13_mlp_act -->
<g id="node127" class="node">
<title>lay13_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-2961.83 386,-2961.83 386,-2893.83 598,-2893.83 598,-2961.83"/>
<text text-anchor="middle" x="492" y="-2946.63" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-2931.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-2916.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-2901.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_mlp_gate&#45;&gt;lay13_mlp_act -->
<g id="edge139" class="edge">
<title>lay13_mlp_gate&#45;&gt;lay13_mlp_act</title>
<path fill="none" stroke="black" d="M430,-3034.7C430,-3034.7 430,-2972.14 430,-2972.14"/>
<polygon fill="black" stroke="black" points="433.5,-2972.14 430,-2962.14 426.5,-2972.14 433.5,-2972.14"/>
</g>
<!-- lay13_mlp_up&#45;&gt;lay13_mlp_act -->
<g id="edge140" class="edge">
<title>lay13_mlp_up&#45;&gt;lay13_mlp_act</title>
<path fill="none" stroke="black" d="M554,-3034.7C554,-3034.7 554,-2972.14 554,-2972.14"/>
<polygon fill="black" stroke="black" points="557.5,-2972.14 554,-2962.14 550.5,-2972.14 557.5,-2972.14"/>
</g>
<!-- lay13_mlp_down -->
<g id="node128" class="node">
<title>lay13_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-2820.83 390.5,-2820.83 390.5,-2752.83 593.5,-2752.83 593.5,-2820.83"/>
<text text-anchor="middle" x="492" y="-2805.63" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-2790.63" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-2775.63" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2760.63" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_mlp_act&#45;&gt;lay13_mlp_down -->
<g id="edge141" class="edge">
<title>lay13_mlp_act&#45;&gt;lay13_mlp_down</title>
<path fill="none" stroke="black" d="M492,-2893.7C492,-2893.7 492,-2831.14 492,-2831.14"/>
<polygon fill="black" stroke="black" points="495.5,-2831.14 492,-2821.14 488.5,-2831.14 495.5,-2831.14"/>
</g>
<!-- lay13_res2 -->
<g id="node129" class="node">
<title>lay13_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-2631.75" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-2650.55" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-2635.55" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2620.55" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2605.55" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_mlp_down&#45;&gt;lay13_res2 -->
<g id="edge142" class="edge">
<title>lay13_mlp_down&#45;&gt;lay13_res2</title>
<path fill="none" stroke="black" d="M492,-2752.8C492,-2752.8 492,-2690.12 492,-2690.12"/>
<polygon fill="black" stroke="black" points="495.5,-2690.12 492,-2680.12 488.5,-2690.12 495.5,-2690.12"/>
</g>
<!-- lay13_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge218" class="edge">
<title>lay13_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.9,-2798C810.39,-2798 1296.55,-2798 1296.55,-2798 1296.55,-2798 1296.55,-19869.15 1296.55,-19869.15"/>
<polygon fill="black" stroke="black" points="1293.05,-19869.15 1296.55,-19879.15 1300.05,-19869.15 1293.05,-19869.15"/>
</g>
<!-- lay14_qkv_proj -->
<g id="node130" class="node">
<title>lay14_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-2492.67 383.5,-2492.67 383.5,-2424.67 600.5,-2424.67 600.5,-2492.67"/>
<text text-anchor="middle" x="492" y="-2477.47" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-2462.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2447.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-2432.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13_res2&#45;&gt;lay14_qkv_proj -->
<g id="edge143" class="edge">
<title>lay13_res2&#45;&gt;lay14_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-2583.54C492,-2583.54 492,-2502.91 492,-2502.91"/>
<polygon fill="black" stroke="black" points="495.5,-2502.91 492,-2492.91 488.5,-2502.91 495.5,-2502.91"/>
</g>
<!-- lay14_attn -->
<g id="node131" class="node">
<title>lay14_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-2351.67 380.5,-2351.67 380.5,-2283.67 603.5,-2283.67 603.5,-2351.67"/>
<text text-anchor="middle" x="492" y="-2336.47" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-2321.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-2306.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2291.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_qkv_proj&#45;&gt;lay14_attn -->
<g id="edge144" class="edge">
<title>lay14_qkv_proj&#45;&gt;lay14_attn</title>
<path fill="none" stroke="black" d="M492,-2424.53C492,-2424.53 492,-2361.97 492,-2361.97"/>
<polygon fill="black" stroke="black" points="495.5,-2361.97 492,-2351.97 488.5,-2361.97 495.5,-2361.97"/>
</g>
<!-- lay14_attn_out -->
<g id="node132" class="node">
<title>lay14_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-2210.67 357,-2210.67 357,-2142.67 627,-2142.67 627,-2210.67"/>
<text text-anchor="middle" x="492" y="-2195.47" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-2180.47" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2165.47" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2150.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_attn&#45;&gt;lay14_attn_out -->
<g id="edge145" class="edge">
<title>lay14_attn&#45;&gt;lay14_attn_out</title>
<path fill="none" stroke="black" d="M492,-2283.53C492,-2283.53 492,-2220.97 492,-2220.97"/>
<polygon fill="black" stroke="black" points="495.5,-2220.97 492,-2210.97 488.5,-2220.97 495.5,-2220.97"/>
</g>
<!-- lay14_res1 -->
<g id="node133" class="node">
<title>lay14_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-2021.58" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-2040.38" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-2025.38" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-2010.38" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-1995.38" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_attn_out&#45;&gt;lay14_res1 -->
<g id="edge146" class="edge">
<title>lay14_attn_out&#45;&gt;lay14_res1</title>
<path fill="none" stroke="black" d="M492,-2142.63C492,-2142.63 492,-2079.95 492,-2079.95"/>
<polygon fill="black" stroke="black" points="495.5,-2079.95 492,-2069.95 488.5,-2079.95 495.5,-2079.95"/>
</g>
<!-- lay14_attn_out&#45;&gt;tp_allreduce -->
<g id="edge220" class="edge">
<title>lay14_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.45,-2187C859.12,-2187 1306.73,-2187 1306.73,-2187 1306.73,-2187 1306.73,-19871.59 1306.73,-19871.59"/>
<polygon fill="black" stroke="black" points="1303.23,-19871.59 1306.73,-19881.59 1310.23,-19871.59 1303.23,-19871.59"/>
</g>
<!-- lay14_mlp_gate -->
<g id="node134" class="node">
<title>lay14_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-1900.5 262,-1900.5 262,-1832.5 474,-1832.5 474,-1900.5"/>
<text text-anchor="middle" x="368" y="-1885.3" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-1870.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-1855.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-1840.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_res1&#45;&gt;lay14_mlp_gate -->
<g id="edge147" class="edge">
<title>lay14_res1&#45;&gt;lay14_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-1980.84C368,-1980.84 368,-1910.68 368,-1910.68"/>
<polygon fill="black" stroke="black" points="371.5,-1910.68 368,-1900.68 364.5,-1910.68 371.5,-1910.68"/>
</g>
<!-- lay14_mlp_up -->
<g id="node135" class="node">
<title>lay14_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-1900.5 510,-1900.5 510,-1832.5 722,-1832.5 722,-1900.5"/>
<text text-anchor="middle" x="616" y="-1885.3" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-1870.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-1855.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-1840.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_res1&#45;&gt;lay14_mlp_up -->
<g id="edge148" class="edge">
<title>lay14_res1&#45;&gt;lay14_mlp_up</title>
<path fill="none" stroke="black" d="M616,-1980.84C616,-1980.84 616,-1910.68 616,-1910.68"/>
<polygon fill="black" stroke="black" points="619.5,-1910.68 616,-1900.68 612.5,-1910.68 619.5,-1910.68"/>
</g>
<!-- lay14_mlp_act -->
<g id="node136" class="node">
<title>lay14_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-1759.5 386,-1759.5 386,-1691.5 598,-1691.5 598,-1759.5"/>
<text text-anchor="middle" x="492" y="-1744.3" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-1729.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-1714.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-1699.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_mlp_gate&#45;&gt;lay14_mlp_act -->
<g id="edge149" class="edge">
<title>lay14_mlp_gate&#45;&gt;lay14_mlp_act</title>
<path fill="none" stroke="black" d="M430,-1832.37C430,-1832.37 430,-1769.81 430,-1769.81"/>
<polygon fill="black" stroke="black" points="433.5,-1769.81 430,-1759.81 426.5,-1769.81 433.5,-1769.81"/>
</g>
<!-- lay14_mlp_up&#45;&gt;lay14_mlp_act -->
<g id="edge150" class="edge">
<title>lay14_mlp_up&#45;&gt;lay14_mlp_act</title>
<path fill="none" stroke="black" d="M554,-1832.37C554,-1832.37 554,-1769.81 554,-1769.81"/>
<polygon fill="black" stroke="black" points="557.5,-1769.81 554,-1759.81 550.5,-1769.81 557.5,-1769.81"/>
</g>
<!-- lay14_mlp_down -->
<g id="node137" class="node">
<title>lay14_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-1618.5 390.5,-1618.5 390.5,-1550.5 593.5,-1550.5 593.5,-1618.5"/>
<text text-anchor="middle" x="492" y="-1603.3" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-1588.3" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-1573.3" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-1558.3" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_mlp_act&#45;&gt;lay14_mlp_down -->
<g id="edge151" class="edge">
<title>lay14_mlp_act&#45;&gt;lay14_mlp_down</title>
<path fill="none" stroke="black" d="M492,-1691.37C492,-1691.37 492,-1628.81 492,-1628.81"/>
<polygon fill="black" stroke="black" points="495.5,-1628.81 492,-1618.81 488.5,-1628.81 495.5,-1628.81"/>
</g>
<!-- lay14_res2 -->
<g id="node138" class="node">
<title>lay14_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-1429.42" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-1448.22" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-1433.22" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-1418.22" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-1403.22" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_mlp_down&#45;&gt;lay14_res2 -->
<g id="edge152" class="edge">
<title>lay14_mlp_down&#45;&gt;lay14_res2</title>
<path fill="none" stroke="black" d="M492,-1550.47C492,-1550.47 492,-1487.79 492,-1487.79"/>
<polygon fill="black" stroke="black" points="495.5,-1487.79 492,-1477.79 488.5,-1487.79 495.5,-1487.79"/>
</g>
<!-- lay14_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge222" class="edge">
<title>lay14_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.56,-1595C814.06,-1595 1316.92,-1595 1316.92,-1595 1316.92,-1595 1316.92,-19874.61 1316.92,-19874.61"/>
<polygon fill="black" stroke="black" points="1313.42,-19874.61 1316.92,-19884.61 1320.42,-19874.61 1313.42,-19874.61"/>
</g>
<!-- lay15_qkv_proj -->
<g id="node139" class="node">
<title>lay15_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="600.5,-1290.33 383.5,-1290.33 383.5,-1222.33 600.5,-1222.33 600.5,-1290.33"/>
<text text-anchor="middle" x="492" y="-1275.13" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-1260.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-1245.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-1230.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14_res2&#45;&gt;lay15_qkv_proj -->
<g id="edge153" class="edge">
<title>lay14_res2&#45;&gt;lay15_qkv_proj</title>
<path fill="none" stroke="black" d="M492,-1381.2C492,-1381.2 492,-1300.58 492,-1300.58"/>
<polygon fill="black" stroke="black" points="495.5,-1300.58 492,-1290.58 488.5,-1300.58 495.5,-1300.58"/>
</g>
<!-- lay15_attn -->
<g id="node140" class="node">
<title>lay15_attn</title>
<polygon fill="lightpink" stroke="black" points="603.5,-1149.33 380.5,-1149.33 380.5,-1081.33 603.5,-1081.33 603.5,-1149.33"/>
<text text-anchor="middle" x="492" y="-1134.13" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="492" y="-1119.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="492" y="-1104.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-1089.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_qkv_proj&#45;&gt;lay15_attn -->
<g id="edge154" class="edge">
<title>lay15_qkv_proj&#45;&gt;lay15_attn</title>
<path fill="none" stroke="black" d="M492,-1222.2C492,-1222.2 492,-1159.64 492,-1159.64"/>
<polygon fill="black" stroke="black" points="495.5,-1159.64 492,-1149.64 488.5,-1159.64 495.5,-1159.64"/>
</g>
<!-- lay15_attn_out -->
<g id="node141" class="node">
<title>lay15_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="627,-1008.33 357,-1008.33 357,-940.33 627,-940.33 627,-1008.33"/>
<text text-anchor="middle" x="492" y="-993.13" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="492" y="-978.13" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-963.13" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-948.13" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_attn&#45;&gt;lay15_attn_out -->
<g id="edge155" class="edge">
<title>lay15_attn&#45;&gt;lay15_attn_out</title>
<path fill="none" stroke="black" d="M492,-1081.2C492,-1081.2 492,-1018.64 492,-1018.64"/>
<polygon fill="black" stroke="black" points="495.5,-1018.64 492,-1008.64 488.5,-1018.64 495.5,-1018.64"/>
</g>
<!-- lay15_res1 -->
<g id="node142" class="node">
<title>lay15_res1</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-819.25" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-838.05" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="492" y="-823.05" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-808.05" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-793.05" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_attn_out&#45;&gt;lay15_res1 -->
<g id="edge156" class="edge">
<title>lay15_attn_out&#45;&gt;lay15_res1</title>
<path fill="none" stroke="black" d="M492,-940.3C492,-940.3 492,-877.62 492,-877.62"/>
<polygon fill="black" stroke="black" points="495.5,-877.62 492,-867.62 488.5,-877.62 495.5,-877.62"/>
</g>
<!-- lay15_attn_out&#45;&gt;tp_allreduce -->
<g id="edge224" class="edge">
<title>lay15_attn_out&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M627.1,-985C863.45,-985 1327.1,-985 1327.1,-985 1327.1,-985 1327.1,-19878.02 1327.1,-19878.02"/>
<polygon fill="black" stroke="black" points="1323.6,-19878.02 1327.1,-19888.02 1330.6,-19878.02 1323.6,-19878.02"/>
</g>
<!-- lay15_mlp_gate -->
<g id="node143" class="node">
<title>lay15_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="474,-698.17 262,-698.17 262,-630.17 474,-630.17 474,-698.17"/>
<text text-anchor="middle" x="368" y="-682.97" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="368" y="-667.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="368" y="-652.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="368" y="-637.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_res1&#45;&gt;lay15_mlp_gate -->
<g id="edge157" class="edge">
<title>lay15_res1&#45;&gt;lay15_mlp_gate</title>
<path fill="none" stroke="black" d="M368,-778.5C368,-778.5 368,-708.35 368,-708.35"/>
<polygon fill="black" stroke="black" points="371.5,-708.35 368,-698.35 364.5,-708.35 371.5,-708.35"/>
</g>
<!-- lay15_mlp_up -->
<g id="node144" class="node">
<title>lay15_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="722,-698.17 510,-698.17 510,-630.17 722,-630.17 722,-698.17"/>
<text text-anchor="middle" x="616" y="-682.97" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="616" y="-667.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="616" y="-652.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="616" y="-637.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_res1&#45;&gt;lay15_mlp_up -->
<g id="edge158" class="edge">
<title>lay15_res1&#45;&gt;lay15_mlp_up</title>
<path fill="none" stroke="black" d="M616,-778.5C616,-778.5 616,-708.35 616,-708.35"/>
<polygon fill="black" stroke="black" points="619.5,-708.35 616,-698.35 612.5,-708.35 619.5,-708.35"/>
</g>
<!-- lay15_mlp_act -->
<g id="node145" class="node">
<title>lay15_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="598,-557.17 386,-557.17 386,-489.17 598,-489.17 598,-557.17"/>
<text text-anchor="middle" x="492" y="-541.97" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="492" y="-526.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-511.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-496.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_mlp_gate&#45;&gt;lay15_mlp_act -->
<g id="edge159" class="edge">
<title>lay15_mlp_gate&#45;&gt;lay15_mlp_act</title>
<path fill="none" stroke="black" d="M430,-630.03C430,-630.03 430,-567.47 430,-567.47"/>
<polygon fill="black" stroke="black" points="433.5,-567.47 430,-557.47 426.5,-567.47 433.5,-567.47"/>
</g>
<!-- lay15_mlp_up&#45;&gt;lay15_mlp_act -->
<g id="edge160" class="edge">
<title>lay15_mlp_up&#45;&gt;lay15_mlp_act</title>
<path fill="none" stroke="black" d="M554,-630.03C554,-630.03 554,-567.47 554,-567.47"/>
<polygon fill="black" stroke="black" points="557.5,-567.47 554,-557.47 550.5,-567.47 557.5,-567.47"/>
</g>
<!-- lay15_mlp_down -->
<g id="node146" class="node">
<title>lay15_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="593.5,-416.17 390.5,-416.17 390.5,-348.17 593.5,-348.17 593.5,-416.17"/>
<text text-anchor="middle" x="492" y="-400.97" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="492" y="-385.97" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="492" y="-370.97" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-355.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_mlp_act&#45;&gt;lay15_mlp_down -->
<g id="edge161" class="edge">
<title>lay15_mlp_act&#45;&gt;lay15_mlp_down</title>
<path fill="none" stroke="black" d="M492,-489.03C492,-489.03 492,-426.47 492,-426.47"/>
<polygon fill="black" stroke="black" points="495.5,-426.47 492,-416.47 488.5,-426.47 495.5,-426.47"/>
</g>
<!-- lay15_res2 -->
<g id="node147" class="node">
<title>lay15_res2</title>
<ellipse fill="lightgray" stroke="black" cx="492" cy="-227.08" rx="231.86" ry="48.17"/>
<text text-anchor="middle" x="492" y="-245.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="492" y="-230.88" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-215.88" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="492" y="-200.88" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay15_mlp_down&#45;&gt;lay15_res2 -->
<g id="edge162" class="edge">
<title>lay15_mlp_down&#45;&gt;lay15_res2</title>
<path fill="none" stroke="black" d="M492,-348.13C492,-348.13 492,-285.45 492,-285.45"/>
<polygon fill="black" stroke="black" points="495.5,-285.45 492,-275.45 488.5,-285.45 495.5,-285.45"/>
</g>
<!-- lay15_mlp_down&#45;&gt;tp_allreduce -->
<g id="edge226" class="edge">
<title>lay15_mlp_down&#45;&gt;tp_allreduce</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M593.54,-393C818.13,-393 1337.28,-393 1337.28,-393 1337.28,-393 1337.28,-19883.05 1337.28,-19883.05"/>
<polygon fill="black" stroke="black" points="1333.78,-19883.05 1337.28,-19893.05 1340.78,-19883.05 1333.78,-19883.05"/>
</g>
<!-- output -->
<g id="node148" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="967.74,-106 210.94,-106 16.26,0 773.06,0 967.74,-106"/>
<text text-anchor="middle" x="492" y="-64.3" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="492" y="-49.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="492" y="-34.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- lay15_res2&#45;&gt;output -->
<g id="edge163" class="edge">
<title>lay15_res2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M492,-178.59C492,-178.59 492,-116.12 492,-116.12"/>
<polygon fill="black" stroke="black" points="495.5,-116.12 492,-106.12 488.5,-116.12 495.5,-116.12"/>
</g>
<!-- tp_allreduce&#45;&gt;lay0_attn_out -->
<g id="edge165" class="edge">
<title>tp_allreduce&#45;&gt;lay0_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1026.72,-19893.29C1026.72,-19798.82 1026.72,-19223 1026.72,-19223 1026.72,-19223 637.28,-19223 637.28,-19223"/>
<polygon fill="black" stroke="black" points="637.28,-19219.5 627.28,-19223 637.28,-19226.5 637.28,-19219.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay0_mlp_down -->
<g id="edge167" class="edge">
<title>tp_allreduce&#45;&gt;lay0_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1036.9,-19888.3C1036.9,-19733.29 1036.9,-18631 1036.9,-18631 1036.9,-18631 603.53,-18631 603.53,-18631"/>
<polygon fill="black" stroke="black" points="603.53,-18627.5 593.53,-18631 603.53,-18634.5 603.53,-18627.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay1_attn_out -->
<g id="edge169" class="edge">
<title>tp_allreduce&#45;&gt;lay1_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1047.08,-19884.5C1047.08,-19674.58 1047.08,-18021 1047.08,-18021 1047.08,-18021 637.08,-18021 637.08,-18021"/>
<polygon fill="black" stroke="black" points="637.08,-18017.5 627.08,-18021 637.08,-18024.5 637.08,-18017.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay1_mlp_down -->
<g id="edge171" class="edge">
<title>tp_allreduce&#45;&gt;lay1_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1057.27,-19881.41C1057.27,-19622.25 1057.27,-17429 1057.27,-17429 1057.27,-17429 603.71,-17429 603.71,-17429"/>
<polygon fill="black" stroke="black" points="603.71,-17425.5 593.71,-17429 603.71,-17432.5 603.71,-17425.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay2_attn_out -->
<g id="edge173" class="edge">
<title>tp_allreduce&#45;&gt;lay2_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1067.45,-19879.17C1067.45,-19575.04 1067.45,-16819 1067.45,-16819 1067.45,-16819 637.28,-16819 637.28,-16819"/>
<polygon fill="black" stroke="black" points="637.28,-16815.5 627.28,-16819 637.28,-16822.5 637.28,-16815.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay2_mlp_down -->
<g id="edge175" class="edge">
<title>tp_allreduce&#45;&gt;lay2_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1077.63,-19876.98C1077.63,-19530.21 1077.63,-16227 1077.63,-16227 1077.63,-16227 603.67,-16227 603.67,-16227"/>
<polygon fill="black" stroke="black" points="603.67,-16223.5 593.67,-16227 603.67,-16230.5 603.67,-16223.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay3_attn_out -->
<g id="edge177" class="edge">
<title>tp_allreduce&#45;&gt;lay3_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1087.81,-19875.46C1087.81,-19489.61 1087.81,-15616 1087.81,-15616 1087.81,-15616 637.2,-15616 637.2,-15616"/>
<polygon fill="black" stroke="black" points="637.2,-15612.5 627.2,-15616 637.2,-15619.5 637.2,-15612.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay3_mlp_down -->
<g id="edge179" class="edge">
<title>tp_allreduce&#45;&gt;lay3_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1098,-19873.86C1098,-19450.25 1098,-15024 1098,-15024 1098,-15024 603.77,-15024 603.77,-15024"/>
<polygon fill="black" stroke="black" points="603.77,-15020.5 593.77,-15024 603.77,-15027.5 603.77,-15020.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay4_attn_out -->
<g id="edge181" class="edge">
<title>tp_allreduce&#45;&gt;lay4_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1108.18,-19872.68C1108.18,-19413.72 1108.18,-14414 1108.18,-14414 1108.18,-14414 637.22,-14414 637.22,-14414"/>
<polygon fill="black" stroke="black" points="637.22,-14410.5 627.22,-14414 637.22,-14417.5 637.22,-14410.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay4_mlp_down -->
<g id="edge183" class="edge">
<title>tp_allreduce&#45;&gt;lay4_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1118.36,-19871.36C1118.36,-19377.64 1118.36,-13822 1118.36,-13822 1118.36,-13822 603.68,-13822 603.68,-13822"/>
<polygon fill="black" stroke="black" points="603.68,-13818.5 593.68,-13822 603.68,-13825.5 603.68,-13818.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay5_attn_out -->
<g id="edge185" class="edge">
<title>tp_allreduce&#45;&gt;lay5_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1128.54,-19870.71C1128.54,-19346.52 1128.54,-13212 1128.54,-13212 1128.54,-13212 637.38,-13212 637.38,-13212"/>
<polygon fill="black" stroke="black" points="637.38,-13208.5 627.38,-13212 637.38,-13215.5 637.38,-13208.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay5_mlp_down -->
<g id="edge187" class="edge">
<title>tp_allreduce&#45;&gt;lay5_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1138.73,-19870.14C1138.73,-19317.47 1138.73,-12620 1138.73,-12620 1138.73,-12620 603.76,-12620 603.76,-12620"/>
<polygon fill="black" stroke="black" points="603.76,-12616.5 593.76,-12620 603.76,-12623.5 603.76,-12616.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay6_attn_out -->
<g id="edge189" class="edge">
<title>tp_allreduce&#45;&gt;lay6_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1148.91,-19869.36C1148.91,-19286.59 1148.91,-12009 1148.91,-12009 1148.91,-12009 637.32,-12009 637.32,-12009"/>
<polygon fill="black" stroke="black" points="637.32,-12005.5 627.32,-12009 637.32,-12012.5 637.32,-12005.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay6_mlp_down -->
<g id="edge191" class="edge">
<title>tp_allreduce&#45;&gt;lay6_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1159.09,-19868.95C1159.09,-19260.04 1159.09,-11417 1159.09,-11417 1159.09,-11417 603.68,-11417 603.68,-11417"/>
<polygon fill="black" stroke="black" points="603.68,-11413.5 593.68,-11417 603.68,-11420.5 603.68,-11413.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay7_attn_out -->
<g id="edge193" class="edge">
<title>tp_allreduce&#45;&gt;lay7_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1169.27,-19868.71C1169.27,-19234.96 1169.27,-10807 1169.27,-10807 1169.27,-10807 637.02,-10807 637.02,-10807"/>
<polygon fill="black" stroke="black" points="637.02,-10803.5 627.02,-10807 637.02,-10810.5 637.02,-10803.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay7_mlp_down -->
<g id="edge195" class="edge">
<title>tp_allreduce&#45;&gt;lay7_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1179.45,-19868.79C1179.45,-19214.07 1179.45,-10215 1179.45,-10215 1179.45,-10215 603.81,-10215 603.81,-10215"/>
<polygon fill="black" stroke="black" points="603.81,-10211.5 593.81,-10215 603.81,-10218.5 603.81,-10211.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay8_attn_out -->
<g id="edge197" class="edge">
<title>tp_allreduce&#45;&gt;lay8_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1189.64,-19868.73C1189.64,-19184.1 1189.64,-9379 1189.64,-9379 1189.64,-9379 637.34,-9379 637.34,-9379"/>
<polygon fill="black" stroke="black" points="637.34,-9375.5 627.34,-9379 637.34,-9382.5 637.34,-9375.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay8_mlp_down -->
<g id="edge199" class="edge">
<title>tp_allreduce&#45;&gt;lay8_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1199.82,-19869.05C1199.82,-19167.08 1199.82,-8787 1199.82,-8787 1199.82,-8787 603.79,-8787 603.79,-8787"/>
<polygon fill="black" stroke="black" points="603.79,-8783.5 593.79,-8787 603.79,-8790.5 603.79,-8783.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay9_attn_out -->
<g id="edge201" class="edge">
<title>tp_allreduce&#45;&gt;lay9_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1210,-19869.21C1210,-19148.6 1210,-8176 1210,-8176 1210,-8176 637.05,-8176 637.05,-8176"/>
<polygon fill="black" stroke="black" points="637.05,-8172.5 627.05,-8176 637.05,-8179.5 637.05,-8172.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay9_mlp_down -->
<g id="edge203" class="edge">
<title>tp_allreduce&#45;&gt;lay9_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1220.18,-19869.6C1220.18,-19133.65 1220.18,-7584 1220.18,-7584 1220.18,-7584 603.63,-7584 603.63,-7584"/>
<polygon fill="black" stroke="black" points="603.63,-7580.5 593.63,-7584 603.63,-7587.5 603.63,-7580.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay10_attn_out -->
<g id="edge205" class="edge">
<title>tp_allreduce&#45;&gt;lay10_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1230.37,-19870.37C1230.37,-19122.93 1230.37,-6974 1230.37,-6974 1230.37,-6974 637.43,-6974 637.43,-6974"/>
<polygon fill="black" stroke="black" points="637.43,-6970.5 627.43,-6974 637.43,-6977.5 637.43,-6970.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay10_mlp_down -->
<g id="edge207" class="edge">
<title>tp_allreduce&#45;&gt;lay10_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1240.55,-19871.05C1240.55,-19112.68 1240.55,-6382 1240.55,-6382 1240.55,-6382 603.73,-6382 603.73,-6382"/>
<polygon fill="black" stroke="black" points="603.73,-6378.5 593.73,-6382 603.73,-6385.5 603.73,-6378.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay11_attn_out -->
<g id="edge209" class="edge">
<title>tp_allreduce&#45;&gt;lay11_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1250.73,-19872.1C1250.73,-19107.03 1250.73,-5772 1250.73,-5772 1250.73,-5772 637.21,-5772 637.21,-5772"/>
<polygon fill="black" stroke="black" points="637.21,-5768.5 627.21,-5772 637.21,-5775.5 637.21,-5768.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay11_mlp_down -->
<g id="edge211" class="edge">
<title>tp_allreduce&#45;&gt;lay11_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1260.91,-19873.32C1260.91,-19105 1260.91,-5180 1260.91,-5180 1260.91,-5180 603.71,-5180 603.71,-5180"/>
<polygon fill="black" stroke="black" points="603.71,-5176.5 593.71,-5180 603.71,-5183.5 603.71,-5176.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay12_attn_out -->
<g id="edge213" class="edge">
<title>tp_allreduce&#45;&gt;lay12_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1271.1,-19874.61C1271.1,-19104.54 1271.1,-4569 1271.1,-4569 1271.1,-4569 637.26,-4569 637.26,-4569"/>
<polygon fill="black" stroke="black" points="637.26,-4565.5 627.26,-4569 637.26,-4572.5 637.26,-4565.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay12_mlp_down -->
<g id="edge215" class="edge">
<title>tp_allreduce&#45;&gt;lay12_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1281.28,-19876.33C1281.28,-19111.48 1281.28,-3977 1281.28,-3977 1281.28,-3977 603.57,-3977 603.57,-3977"/>
<polygon fill="black" stroke="black" points="603.57,-3973.5 593.57,-3977 603.57,-3980.5 603.57,-3973.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay13_attn_out -->
<g id="edge217" class="edge">
<title>tp_allreduce&#45;&gt;lay13_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1291.46,-19878.09C1291.46,-19120.42 1291.46,-3367 1291.46,-3367 1291.46,-3367 637.17,-3367 637.17,-3367"/>
<polygon fill="black" stroke="black" points="637.17,-3363.5 627.17,-3367 637.17,-3370.5 637.17,-3363.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay13_mlp_down -->
<g id="edge219" class="edge">
<title>tp_allreduce&#45;&gt;lay13_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1301.64,-19880.24C1301.64,-19137.22 1301.64,-2775 1301.64,-2775 1301.64,-2775 603.72,-2775 603.72,-2775"/>
<polygon fill="black" stroke="black" points="603.72,-2771.5 593.72,-2775 603.72,-2778.5 603.72,-2771.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay14_attn_out -->
<g id="edge221" class="edge">
<title>tp_allreduce&#45;&gt;lay14_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1311.82,-19882.93C1311.82,-19164.91 1311.82,-2165 1311.82,-2165 1311.82,-2165 637.38,-2165 637.38,-2165"/>
<polygon fill="black" stroke="black" points="637.38,-2161.5 627.38,-2165 637.38,-2168.5 637.38,-2161.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay14_mlp_down -->
<g id="edge223" class="edge">
<title>tp_allreduce&#45;&gt;lay14_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1322.01,-19886.13C1322.01,-19205.95 1322.01,-1573 1322.01,-1573 1322.01,-1573 603.78,-1573 603.78,-1573"/>
<polygon fill="black" stroke="black" points="603.78,-1569.5 593.78,-1573 603.78,-1576.5 603.78,-1569.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay15_attn_out -->
<g id="edge225" class="edge">
<title>tp_allreduce&#45;&gt;lay15_attn_out</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1332.19,-19890.38C1332.19,-19273.44 1332.19,-962 1332.19,-962 1332.19,-962 637.46,-962 637.46,-962"/>
<polygon fill="black" stroke="black" points="637.46,-958.5 627.46,-962 637.46,-965.5 637.46,-958.5"/>
</g>
<!-- tp_allreduce&#45;&gt;lay15_mlp_down -->
<g id="edge227" class="edge">
<title>tp_allreduce&#45;&gt;lay15_mlp_down</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1342.37,-19896.96C1342.37,-19413.44 1342.37,-370 1342.37,-370 1342.37,-370 603.73,-370 603.73,-370"/>
<polygon fill="black" stroke="black" points="603.73,-366.5 593.73,-370 603.73,-373.5 603.73,-366.5"/>
</g>
</g>
</svg>
