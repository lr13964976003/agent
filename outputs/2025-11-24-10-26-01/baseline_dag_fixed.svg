<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp8_pp2_fixed Pages: 1 -->
<svg width="960pt" height="3748pt"
 viewBox="0.00 0.00 959.74 3747.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3743.95)">
<title>baseline_tp8_pp2_fixed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3743.95 955.74,-3743.95 955.74,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M241.87,-1424.95C241.87,-1424.95 709.87,-1424.95 709.87,-1424.95 715.87,-1424.95 721.87,-1430.95 721.87,-1436.95 721.87,-1436.95 721.87,-3435.95 721.87,-3435.95 721.87,-3441.95 715.87,-3447.95 709.87,-3447.95 709.87,-3447.95 241.87,-3447.95 241.87,-3447.95 235.87,-3447.95 229.87,-3441.95 229.87,-3435.95 229.87,-3435.95 229.87,-1436.95 229.87,-1436.95 229.87,-1430.95 235.87,-1424.95 241.87,-1424.95"/>
<text text-anchor="middle" x="475.87" y="-3432.75" font-family="Times,serif" font-size="14.00">Stage 0 (Layers 0&#45;7)</text>
<text text-anchor="middle" x="475.87" y="-3417.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7 (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="red" stroke-dasharray="1,5" points="237.87,-2299.95 237.87,-3401.95 713.87,-3401.95 713.87,-2299.95 237.87,-2299.95"/>
<text text-anchor="middle" x="475.87" y="-3386.75" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="475.87" y="-3371.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M376.87,-100C376.87,-100 574.87,-100 574.87,-100 580.87,-100 586.87,-106 586.87,-112 586.87,-112 586.87,-1070 586.87,-1070 586.87,-1076 580.87,-1082 574.87,-1082 574.87,-1082 376.87,-1082 376.87,-1082 370.87,-1082 364.87,-1076 364.87,-1070 364.87,-1070 364.87,-112 364.87,-112 364.87,-106 370.87,-100 376.87,-100"/>
<text text-anchor="middle" x="475.87" y="-1066.8" font-family="Times,serif" font-size="14.00">Stage 1 (Layers 8&#45;15)</text>
<text text-anchor="middle" x="475.87" y="-1051.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15 (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="951.61,-3739.95 194.81,-3739.95 0.13,-3633.95 756.93,-3633.95 951.61,-3739.95"/>
<text text-anchor="middle" x="475.87" y="-3698.25" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="475.87" y="-3683.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="475.87" y="-3668.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- stage0_input -->
<g id="node26" class="node">
<title>stage0_input</title>
<polygon fill="lightyellow" stroke="black" points="951.61,-3561.95 194.81,-3561.95 0.13,-3455.95 756.93,-3455.95 951.61,-3561.95"/>
<text text-anchor="middle" x="475.87" y="-3520.25" font-family="Times,serif" font-size="14.00">Stage 0 Input</text>
<text text-anchor="middle" x="475.87" y="-3505.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="475.87" y="-3490.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- input&#45;&gt;stage0_input -->
<g id="edge24" class="edge">
<title>input&#45;&gt;stage0_input</title>
<path fill="none" stroke="black" d="M475.87,-3633.55C475.87,-3633.55 475.87,-3572.01 475.87,-3572.01"/>
<polygon fill="black" stroke="black" points="479.37,-3572.01 475.87,-3562.01 472.37,-3572.01 479.37,-3572.01"/>
</g>
<!-- lay0_qkv_proj -->
<g id="node2" class="node">
<title>lay0_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="584.37,-3355.95 367.37,-3355.95 367.37,-3287.95 584.37,-3287.95 584.37,-3355.95"/>
<text text-anchor="middle" x="475.87" y="-3340.75" font-family="Times,serif" font-size="14.00">QKV Projection (TP=8)</text>
<text text-anchor="middle" x="475.87" y="-3325.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-3310.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,32,128]</text>
<text text-anchor="middle" x="475.87" y="-3295.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_attn -->
<g id="node3" class="node">
<title>lay0_attn</title>
<polygon fill="lightpink" stroke="black" points="587.37,-3215.95 364.37,-3215.95 364.37,-3147.95 587.37,-3147.95 587.37,-3215.95"/>
<text text-anchor="middle" x="475.87" y="-3200.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention (TP=8)</text>
<text text-anchor="middle" x="475.87" y="-3185.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,32,128]</text>
<text text-anchor="middle" x="475.87" y="-3170.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-3155.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_qkv_proj&#45;&gt;lay0_attn -->
<g id="edge1" class="edge">
<title>lay0_qkv_proj&#45;&gt;lay0_attn</title>
<path fill="none" stroke="black" d="M475.87,-3287.71C475.87,-3287.71 475.87,-3226.33 475.87,-3226.33"/>
<polygon fill="black" stroke="black" points="479.37,-3226.33 475.87,-3216.33 472.37,-3226.33 479.37,-3226.33"/>
</g>
<!-- lay0_attn_out -->
<g id="node4" class="node">
<title>lay0_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="610.87,-3075.95 340.87,-3075.95 340.87,-3007.95 610.87,-3007.95 610.87,-3075.95"/>
<text text-anchor="middle" x="475.87" y="-3060.75" font-family="Times,serif" font-size="14.00">Attention Output Projection (TP=8)</text>
<text text-anchor="middle" x="475.87" y="-3045.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-3030.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-3015.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_attn&#45;&gt;lay0_attn_out -->
<g id="edge2" class="edge">
<title>lay0_attn&#45;&gt;lay0_attn_out</title>
<path fill="none" stroke="black" d="M475.87,-3147.71C475.87,-3147.71 475.87,-3086.33 475.87,-3086.33"/>
<polygon fill="black" stroke="black" points="479.37,-3086.33 475.87,-3076.33 472.37,-3086.33 479.37,-3086.33"/>
</g>
<!-- lay0_res1 -->
<g id="node5" class="node">
<title>lay0_res1</title>
<polygon fill="lightgray" stroke="black" points="639.87,-2935.95 311.87,-2935.95 311.87,-2867.95 639.87,-2867.95 639.87,-2935.95"/>
<text text-anchor="middle" x="475.87" y="-2920.75" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="475.87" y="-2905.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-2890.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-2875.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_attn_out&#45;&gt;lay0_res1 -->
<g id="edge3" class="edge">
<title>lay0_attn_out&#45;&gt;lay0_res1</title>
<path fill="none" stroke="black" d="M475.87,-3007.71C475.87,-3007.71 475.87,-2946.33 475.87,-2946.33"/>
<polygon fill="black" stroke="black" points="479.37,-2946.33 475.87,-2936.33 472.37,-2946.33 479.37,-2946.33"/>
</g>
<!-- lay0_mlp_gate -->
<g id="node6" class="node">
<title>lay0_mlp_gate</title>
<polygon fill="lightseagreen" stroke="black" points="457.87,-2795.95 245.87,-2795.95 245.87,-2727.95 457.87,-2727.95 457.87,-2795.95"/>
<text text-anchor="middle" x="351.87" y="-2780.75" font-family="Times,serif" font-size="14.00">MLP Gate (TP=8)</text>
<text text-anchor="middle" x="351.87" y="-2765.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="351.87" y="-2750.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="351.87" y="-2735.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_res1&#45;&gt;lay0_mlp_gate -->
<g id="edge4" class="edge">
<title>lay0_res1&#45;&gt;lay0_mlp_gate</title>
<path fill="none" stroke="black" d="M384.87,-2867.71C384.87,-2867.71 384.87,-2806.33 384.87,-2806.33"/>
<polygon fill="black" stroke="black" points="388.37,-2806.33 384.87,-2796.33 381.37,-2806.33 388.37,-2806.33"/>
</g>
<!-- lay0_mlp_up -->
<g id="node7" class="node">
<title>lay0_mlp_up</title>
<polygon fill="lightseagreen" stroke="black" points="705.87,-2795.95 493.87,-2795.95 493.87,-2727.95 705.87,-2727.95 705.87,-2795.95"/>
<text text-anchor="middle" x="599.87" y="-2780.75" font-family="Times,serif" font-size="14.00">MLP Up (TP=8)</text>
<text text-anchor="middle" x="599.87" y="-2765.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096]</text>
<text text-anchor="middle" x="599.87" y="-2750.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="599.87" y="-2735.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_res1&#45;&gt;lay0_mlp_up -->
<g id="edge5" class="edge">
<title>lay0_res1&#45;&gt;lay0_mlp_up</title>
<path fill="none" stroke="black" d="M566.87,-2867.71C566.87,-2867.71 566.87,-2806.33 566.87,-2806.33"/>
<polygon fill="black" stroke="black" points="570.37,-2806.33 566.87,-2796.33 563.37,-2806.33 570.37,-2806.33"/>
</g>
<!-- lay0_mlp_act -->
<g id="node8" class="node">
<title>lay0_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="581.87,-2655.95 369.87,-2655.95 369.87,-2587.95 581.87,-2587.95 581.87,-2655.95"/>
<text text-anchor="middle" x="475.87" y="-2640.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="475.87" y="-2625.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="475.87" y="-2610.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,16384]</text>
<text text-anchor="middle" x="475.87" y="-2595.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_mlp_gate&#45;&gt;lay0_mlp_act -->
<g id="edge6" class="edge">
<title>lay0_mlp_gate&#45;&gt;lay0_mlp_act</title>
<path fill="none" stroke="black" d="M413.87,-2727.71C413.87,-2727.71 413.87,-2666.33 413.87,-2666.33"/>
<polygon fill="black" stroke="black" points="417.37,-2666.33 413.87,-2656.33 410.37,-2666.33 417.37,-2666.33"/>
</g>
<!-- lay0_mlp_up&#45;&gt;lay0_mlp_act -->
<g id="edge7" class="edge">
<title>lay0_mlp_up&#45;&gt;lay0_mlp_act</title>
<path fill="none" stroke="black" d="M537.87,-2727.71C537.87,-2727.71 537.87,-2666.33 537.87,-2666.33"/>
<polygon fill="black" stroke="black" points="541.37,-2666.33 537.87,-2656.33 534.37,-2666.33 541.37,-2666.33"/>
</g>
<!-- lay0_mlp_down -->
<g id="node9" class="node">
<title>lay0_mlp_down</title>
<polygon fill="lightseagreen" stroke="black" points="577.37,-2515.95 374.37,-2515.95 374.37,-2447.95 577.37,-2447.95 577.37,-2515.95"/>
<text text-anchor="middle" x="475.87" y="-2500.75" font-family="Times,serif" font-size="14.00">MLP Down (TP=8)</text>
<text text-anchor="middle" x="475.87" y="-2485.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,16384]</text>
<text text-anchor="middle" x="475.87" y="-2470.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-2455.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_mlp_act&#45;&gt;lay0_mlp_down -->
<g id="edge8" class="edge">
<title>lay0_mlp_act&#45;&gt;lay0_mlp_down</title>
<path fill="none" stroke="black" d="M475.87,-2587.71C475.87,-2587.71 475.87,-2526.33 475.87,-2526.33"/>
<polygon fill="black" stroke="black" points="479.37,-2526.33 475.87,-2516.33 472.37,-2526.33 479.37,-2526.33"/>
</g>
<!-- lay0_res2 -->
<g id="node10" class="node">
<title>lay0_res2</title>
<polygon fill="lightgray" stroke="black" points="639.87,-2375.95 311.87,-2375.95 311.87,-2307.95 639.87,-2307.95 639.87,-2375.95"/>
<text text-anchor="middle" x="475.87" y="-2360.75" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="475.87" y="-2345.75" font-family="Times,serif" font-size="14.00">Input: [128,10000,4096], [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-2330.75" font-family="Times,serif" font-size="14.00">Output: [128,10000,4096]</text>
<text text-anchor="middle" x="475.87" y="-2315.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_mlp_down&#45;&gt;lay0_res2 -->
<g id="edge9" class="edge">
<title>lay0_mlp_down&#45;&gt;lay0_res2</title>
<path fill="none" stroke="black" d="M475.87,-2447.71C475.87,-2447.71 475.87,-2386.33 475.87,-2386.33"/>
<polygon fill="black" stroke="black" points="479.37,-2386.33 475.87,-2376.33 472.37,-2386.33 479.37,-2386.33"/>
</g>
<!-- lay1 -->
<g id="node11" class="node">
<title>lay1</title>
<polygon fill="lightblue" stroke="black" points="578.87,-2235.95 372.87,-2235.95 372.87,-2182.95 578.87,-2182.95 578.87,-2235.95"/>
<text text-anchor="middle" x="475.87" y="-2220.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="475.87" y="-2205.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-2190.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay0_res2&#45;&gt;lay1 -->
<g id="edge10" class="edge">
<title>lay0_res2&#45;&gt;lay1</title>
<path fill="none" stroke="black" d="M475.87,-2307.83C475.87,-2307.83 475.87,-2246.36 475.87,-2246.36"/>
<polygon fill="black" stroke="black" points="479.37,-2246.36 475.87,-2236.36 472.37,-2246.36 479.37,-2246.36"/>
</g>
<!-- lay2 -->
<g id="node12" class="node">
<title>lay2</title>
<polygon fill="lightblue" stroke="black" points="578.87,-2110.95 372.87,-2110.95 372.87,-2057.95 578.87,-2057.95 578.87,-2110.95"/>
<text text-anchor="middle" x="475.87" y="-2095.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="475.87" y="-2080.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-2065.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay1&#45;&gt;lay2 -->
<g id="edge11" class="edge">
<title>lay1&#45;&gt;lay2</title>
<path fill="none" stroke="black" d="M475.87,-2182.94C475.87,-2182.94 475.87,-2121.36 475.87,-2121.36"/>
<polygon fill="black" stroke="black" points="479.37,-2121.36 475.87,-2111.36 472.37,-2121.36 479.37,-2121.36"/>
</g>
<!-- lay3 -->
<g id="node13" class="node">
<title>lay3</title>
<polygon fill="lightblue" stroke="black" points="578.87,-1985.95 372.87,-1985.95 372.87,-1932.95 578.87,-1932.95 578.87,-1985.95"/>
<text text-anchor="middle" x="475.87" y="-1970.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="475.87" y="-1955.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-1940.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay2&#45;&gt;lay3 -->
<g id="edge12" class="edge">
<title>lay2&#45;&gt;lay3</title>
<path fill="none" stroke="black" d="M475.87,-2057.94C475.87,-2057.94 475.87,-1996.36 475.87,-1996.36"/>
<polygon fill="black" stroke="black" points="479.37,-1996.36 475.87,-1986.36 472.37,-1996.36 479.37,-1996.36"/>
</g>
<!-- lay4 -->
<g id="node14" class="node">
<title>lay4</title>
<polygon fill="lightblue" stroke="black" points="578.87,-1860.95 372.87,-1860.95 372.87,-1807.95 578.87,-1807.95 578.87,-1860.95"/>
<text text-anchor="middle" x="475.87" y="-1845.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="475.87" y="-1830.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-1815.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay3&#45;&gt;lay4 -->
<g id="edge13" class="edge">
<title>lay3&#45;&gt;lay4</title>
<path fill="none" stroke="black" d="M475.87,-1932.94C475.87,-1932.94 475.87,-1871.36 475.87,-1871.36"/>
<polygon fill="black" stroke="black" points="479.37,-1871.36 475.87,-1861.36 472.37,-1871.36 479.37,-1871.36"/>
</g>
<!-- lay5 -->
<g id="node15" class="node">
<title>lay5</title>
<polygon fill="lightblue" stroke="black" points="578.87,-1735.95 372.87,-1735.95 372.87,-1682.95 578.87,-1682.95 578.87,-1735.95"/>
<text text-anchor="middle" x="475.87" y="-1720.75" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="475.87" y="-1705.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-1690.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay4&#45;&gt;lay5 -->
<g id="edge14" class="edge">
<title>lay4&#45;&gt;lay5</title>
<path fill="none" stroke="black" d="M475.87,-1807.94C475.87,-1807.94 475.87,-1746.36 475.87,-1746.36"/>
<polygon fill="black" stroke="black" points="479.37,-1746.36 475.87,-1736.36 472.37,-1746.36 479.37,-1746.36"/>
</g>
<!-- lay6 -->
<g id="node16" class="node">
<title>lay6</title>
<polygon fill="lightblue" stroke="black" points="578.87,-1610.95 372.87,-1610.95 372.87,-1557.95 578.87,-1557.95 578.87,-1610.95"/>
<text text-anchor="middle" x="475.87" y="-1595.75" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="475.87" y="-1580.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-1565.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay5&#45;&gt;lay6 -->
<g id="edge15" class="edge">
<title>lay5&#45;&gt;lay6</title>
<path fill="none" stroke="black" d="M475.87,-1682.94C475.87,-1682.94 475.87,-1621.36 475.87,-1621.36"/>
<polygon fill="black" stroke="black" points="479.37,-1621.36 475.87,-1611.36 472.37,-1621.36 479.37,-1621.36"/>
</g>
<!-- lay7 -->
<g id="node17" class="node">
<title>lay7</title>
<polygon fill="lightblue" stroke="black" points="578.87,-1485.95 372.87,-1485.95 372.87,-1432.95 578.87,-1432.95 578.87,-1485.95"/>
<text text-anchor="middle" x="475.87" y="-1470.75" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="475.87" y="-1455.75" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-1440.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<!-- lay6&#45;&gt;lay7 -->
<g id="edge16" class="edge">
<title>lay6&#45;&gt;lay7</title>
<path fill="none" stroke="black" d="M475.87,-1557.94C475.87,-1557.94 475.87,-1496.36 475.87,-1496.36"/>
<polygon fill="black" stroke="black" points="479.37,-1496.36 475.87,-1486.36 472.37,-1496.36 479.37,-1496.36"/>
</g>
<!-- pipeline_transfer -->
<g id="node28" class="node">
<title>pipeline_transfer</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="475.87" cy="-1323.48" rx="98.99" ry="37.45"/>
<text text-anchor="middle" x="475.87" y="-1334.78" font-family="Times,serif" font-size="14.00">Pipeline Transfer</text>
<text text-anchor="middle" x="475.87" y="-1319.78" font-family="Times,serif" font-size="14.00">Between stages</text>
<text text-anchor="middle" x="475.87" y="-1304.78" font-family="Times,serif" font-size="14.00">Size: 5.24GB</text>
</g>
<!-- lay7&#45;&gt;pipeline_transfer -->
<g id="edge26" class="edge">
<title>lay7&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M475.87,-1432.91C475.87,-1432.91 475.87,-1371.01 475.87,-1371.01"/>
<polygon fill="black" stroke="black" points="479.37,-1371.01 475.87,-1361.01 472.37,-1371.01 479.37,-1371.01"/>
</g>
<!-- lay8 -->
<g id="node18" class="node">
<title>lay8</title>
<polygon fill="lightblue" stroke="black" points="578.87,-1036 372.87,-1036 372.87,-983 578.87,-983 578.87,-1036"/>
<text text-anchor="middle" x="475.87" y="-1020.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="475.87" y="-1005.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-990.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9 -->
<g id="node19" class="node">
<title>lay9</title>
<polygon fill="lightblue" stroke="black" points="578.87,-911 372.87,-911 372.87,-858 578.87,-858 578.87,-911"/>
<text text-anchor="middle" x="475.87" y="-895.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="475.87" y="-880.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-865.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay8&#45;&gt;lay9 -->
<g id="edge17" class="edge">
<title>lay8&#45;&gt;lay9</title>
<path fill="none" stroke="black" d="M475.87,-982.99C475.87,-982.99 475.87,-921.4 475.87,-921.4"/>
<polygon fill="black" stroke="black" points="479.37,-921.4 475.87,-911.4 472.37,-921.4 479.37,-921.4"/>
</g>
<!-- lay10 -->
<g id="node20" class="node">
<title>lay10</title>
<polygon fill="lightblue" stroke="black" points="578.87,-786 372.87,-786 372.87,-733 578.87,-733 578.87,-786"/>
<text text-anchor="middle" x="475.87" y="-770.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="475.87" y="-755.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-740.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay9&#45;&gt;lay10 -->
<g id="edge18" class="edge">
<title>lay9&#45;&gt;lay10</title>
<path fill="none" stroke="black" d="M475.87,-857.99C475.87,-857.99 475.87,-796.4 475.87,-796.4"/>
<polygon fill="black" stroke="black" points="479.37,-796.4 475.87,-786.4 472.37,-796.4 479.37,-796.4"/>
</g>
<!-- lay11 -->
<g id="node21" class="node">
<title>lay11</title>
<polygon fill="lightblue" stroke="black" points="578.87,-661 372.87,-661 372.87,-608 578.87,-608 578.87,-661"/>
<text text-anchor="middle" x="475.87" y="-645.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="475.87" y="-630.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-615.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay10&#45;&gt;lay11 -->
<g id="edge19" class="edge">
<title>lay10&#45;&gt;lay11</title>
<path fill="none" stroke="black" d="M475.87,-732.99C475.87,-732.99 475.87,-671.4 475.87,-671.4"/>
<polygon fill="black" stroke="black" points="479.37,-671.4 475.87,-661.4 472.37,-671.4 479.37,-671.4"/>
</g>
<!-- lay12 -->
<g id="node22" class="node">
<title>lay12</title>
<polygon fill="lightblue" stroke="black" points="578.87,-536 372.87,-536 372.87,-483 578.87,-483 578.87,-536"/>
<text text-anchor="middle" x="475.87" y="-520.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="475.87" y="-505.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-490.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay11&#45;&gt;lay12 -->
<g id="edge20" class="edge">
<title>lay11&#45;&gt;lay12</title>
<path fill="none" stroke="black" d="M475.87,-607.99C475.87,-607.99 475.87,-546.4 475.87,-546.4"/>
<polygon fill="black" stroke="black" points="479.37,-546.4 475.87,-536.4 472.37,-546.4 479.37,-546.4"/>
</g>
<!-- lay13 -->
<g id="node23" class="node">
<title>lay13</title>
<polygon fill="lightblue" stroke="black" points="578.87,-411 372.87,-411 372.87,-358 578.87,-358 578.87,-411"/>
<text text-anchor="middle" x="475.87" y="-395.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="475.87" y="-380.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-365.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay12&#45;&gt;lay13 -->
<g id="edge21" class="edge">
<title>lay12&#45;&gt;lay13</title>
<path fill="none" stroke="black" d="M475.87,-482.99C475.87,-482.99 475.87,-421.4 475.87,-421.4"/>
<polygon fill="black" stroke="black" points="479.37,-421.4 475.87,-411.4 472.37,-421.4 479.37,-421.4"/>
</g>
<!-- lay14 -->
<g id="node24" class="node">
<title>lay14</title>
<polygon fill="lightblue" stroke="black" points="578.87,-286 372.87,-286 372.87,-233 578.87,-233 578.87,-286"/>
<text text-anchor="middle" x="475.87" y="-270.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="475.87" y="-255.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-240.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay13&#45;&gt;lay14 -->
<g id="edge22" class="edge">
<title>lay13&#45;&gt;lay14</title>
<path fill="none" stroke="black" d="M475.87,-357.99C475.87,-357.99 475.87,-296.4 475.87,-296.4"/>
<polygon fill="black" stroke="black" points="479.37,-296.4 475.87,-286.4 472.37,-296.4 479.37,-296.4"/>
</g>
<!-- lay15 -->
<g id="node25" class="node">
<title>lay15</title>
<polygon fill="lightblue" stroke="black" points="578.87,-161 372.87,-161 372.87,-108 578.87,-108 578.87,-161"/>
<text text-anchor="middle" x="475.87" y="-145.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="475.87" y="-130.8" font-family="Times,serif" font-size="14.00">Same structure as Layer 0</text>
<text text-anchor="middle" x="475.87" y="-115.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- lay14&#45;&gt;lay15 -->
<g id="edge23" class="edge">
<title>lay14&#45;&gt;lay15</title>
<path fill="none" stroke="black" d="M475.87,-232.99C475.87,-232.99 475.87,-171.4 475.87,-171.4"/>
<polygon fill="black" stroke="black" points="479.37,-171.4 475.87,-161.4 472.37,-171.4 479.37,-171.4"/>
</g>
<!-- output -->
<g id="node29" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="475.87" cy="-18" rx="41.69" ry="18"/>
<text text-anchor="middle" x="475.87" y="-14.3" font-family="Times,serif" font-size="14.00">output</text>
</g>
<!-- lay15&#45;&gt;output -->
<g id="edge29" class="edge">
<title>lay15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M475.87,-107.77C475.87,-107.77 475.87,-46.26 475.87,-46.26"/>
<polygon fill="black" stroke="black" points="479.37,-46.26 475.87,-36.26 472.37,-46.26 479.37,-46.26"/>
</g>
<!-- stage0_input&#45;&gt;lay0_qkv_proj -->
<g id="edge25" class="edge">
<title>stage0_input&#45;&gt;lay0_qkv_proj</title>
<path fill="none" stroke="black" d="M475.87,-3455.87C475.87,-3455.87 475.87,-3366 475.87,-3366"/>
<polygon fill="black" stroke="black" points="479.37,-3366 475.87,-3356 472.37,-3366 479.37,-3366"/>
</g>
<!-- stage1_input -->
<g id="node27" class="node">
<title>stage1_input</title>
<polygon fill="lightyellow" stroke="black" points="951.61,-1214 194.81,-1214 0.13,-1108 756.93,-1108 951.61,-1214"/>
<text text-anchor="middle" x="475.87" y="-1172.3" font-family="Times,serif" font-size="14.00">Stage 1 Input</text>
<text text-anchor="middle" x="475.87" y="-1157.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="475.87" y="-1142.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- stage1_input&#45;&gt;lay8 -->
<g id="edge28" class="edge">
<title>stage1_input&#45;&gt;lay8</title>
<path fill="none" stroke="black" d="M475.87,-1107.59C475.87,-1107.59 475.87,-1046.14 475.87,-1046.14"/>
<polygon fill="black" stroke="black" points="479.37,-1046.14 475.87,-1036.14 472.37,-1046.14 479.37,-1046.14"/>
</g>
<!-- pipeline_transfer&#45;&gt;stage1_input -->
<g id="edge27" class="edge">
<title>pipeline_transfer&#45;&gt;stage1_input</title>
<path fill="none" stroke="black" d="M475.87,-1285.79C475.87,-1285.79 475.87,-1224.17 475.87,-1224.17"/>
<polygon fill="black" stroke="black" points="479.37,-1224.17 475.87,-1214.17 472.37,-1224.17 479.37,-1224.17"/>
</g>
</g>
</svg>
