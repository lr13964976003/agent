<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_static_parallelization Pages: 1 -->
<svg width="60390pt" height="1906pt"
 viewBox="0.00 0.00 60390.00 1906.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1902.5)">
<title>baseline_static_parallelization</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1902.5 60386,-1902.5 60386,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="black" points="1758,-8 1758,-1414.33 20463,-1414.33 20463,-8 1758,-8"/>
<text text-anchor="middle" x="11110.5" y="-1399.13" font-family="Times,serif" font-size="14.00">Layer 1 &#45; Pipeline Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" points="20471,-892.33 20471,-1067.33 60374,-1067.33 60374,-892.33 20471,-892.33"/>
<text text-anchor="middle" x="40422.5" y="-1052.13" font-family="Times,serif" font-size="14.00">Layer 2 &#45; Pipeline Stage 1 (GPUs 8&#45;15)</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="none" stroke="black" cx="2015" cy="-1850.42" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="2015" y="-1869.22" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2015" y="-1854.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1839.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1824.22" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- Embedding_GPU0 -->
<g id="node2" class="node">
<title>Embedding_GPU0</title>
<polygon fill="none" stroke="black" points="488,-1766.33 0,-1766.33 0,-1698.33 488,-1698.33 488,-1766.33"/>
<text text-anchor="middle" x="244" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="244" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="244" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="244" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU0 -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Embedding_GPU0</title>
<path fill="none" stroke="black" d="M1674.96,-1838.11C1369.44,-1826.22 908.41,-1804.04 498,-1766.4"/>
<polygon fill="black" stroke="black" points="498.29,-1762.91 488.01,-1765.48 497.65,-1769.89 498.29,-1762.91"/>
</g>
<!-- Embedding_GPU1 -->
<g id="node3" class="node">
<title>Embedding_GPU1</title>
<polygon fill="none" stroke="black" points="994,-1766.33 506,-1766.33 506,-1698.33 994,-1698.33 994,-1766.33"/>
<text text-anchor="middle" x="750" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="750" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="750" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="750" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU1 -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;Embedding_GPU1</title>
<path fill="none" stroke="black" d="M1704.6,-1827.79C1506.91,-1813.08 1245.17,-1791.87 1004.04,-1766.43"/>
<polygon fill="black" stroke="black" points="1004.34,-1762.94 994.03,-1765.37 1003.6,-1769.9 1004.34,-1762.94"/>
</g>
<!-- Embedding_GPU2 -->
<g id="node4" class="node">
<title>Embedding_GPU2</title>
<polygon fill="none" stroke="black" points="1500,-1766.33 1012,-1766.33 1012,-1698.33 1500,-1698.33 1500,-1766.33"/>
<text text-anchor="middle" x="1256" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="1256" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="1256" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="1256" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU2 -->
<g id="edge3" class="edge">
<title>Input&#45;&gt;Embedding_GPU2</title>
<path fill="none" stroke="black" d="M1784.18,-1814.11C1688.25,-1799.44 1577.26,-1782.47 1481.85,-1767.88"/>
<polygon fill="black" stroke="black" points="1482.2,-1764.39 1471.78,-1766.34 1481.14,-1771.31 1482.2,-1764.39"/>
</g>
<!-- Embedding_GPU3 -->
<g id="node5" class="node">
<title>Embedding_GPU3</title>
<polygon fill="none" stroke="black" points="2006,-1766.33 1518,-1766.33 1518,-1698.33 2006,-1698.33 2006,-1766.33"/>
<text text-anchor="middle" x="1762" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="1762" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="1762" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="1762" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU3 -->
<g id="edge4" class="edge">
<title>Input&#45;&gt;Embedding_GPU3</title>
<path fill="none" stroke="black" d="M1916.46,-1804.2C1892.21,-1793.08 1866.51,-1781.29 1843.18,-1770.58"/>
<polygon fill="black" stroke="black" points="1844.58,-1767.37 1834.03,-1766.38 1841.66,-1773.73 1844.58,-1767.37"/>
</g>
<!-- Embedding_GPU4 -->
<g id="node6" class="node">
<title>Embedding_GPU4</title>
<polygon fill="none" stroke="black" points="2512,-1766.33 2024,-1766.33 2024,-1698.33 2512,-1698.33 2512,-1766.33"/>
<text text-anchor="middle" x="2268" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="2268" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="2268" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="2268" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU4 -->
<g id="edge5" class="edge">
<title>Input&#45;&gt;Embedding_GPU4</title>
<path fill="none" stroke="black" d="M2113.54,-1804.2C2137.79,-1793.08 2163.49,-1781.29 2186.82,-1770.58"/>
<polygon fill="black" stroke="black" points="2188.34,-1773.73 2195.97,-1766.38 2185.42,-1767.37 2188.34,-1773.73"/>
</g>
<!-- Embedding_GPU5 -->
<g id="node7" class="node">
<title>Embedding_GPU5</title>
<polygon fill="none" stroke="black" points="3018,-1766.33 2530,-1766.33 2530,-1698.33 3018,-1698.33 3018,-1766.33"/>
<text text-anchor="middle" x="2774" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="2774" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="2774" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="2774" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU5 -->
<g id="edge6" class="edge">
<title>Input&#45;&gt;Embedding_GPU5</title>
<path fill="none" stroke="black" d="M2245.82,-1814.11C2341.75,-1799.44 2452.74,-1782.47 2548.15,-1767.88"/>
<polygon fill="black" stroke="black" points="2548.86,-1771.31 2558.22,-1766.34 2547.8,-1764.39 2548.86,-1771.31"/>
</g>
<!-- Embedding_GPU6 -->
<g id="node8" class="node">
<title>Embedding_GPU6</title>
<polygon fill="none" stroke="black" points="3524,-1766.33 3036,-1766.33 3036,-1698.33 3524,-1698.33 3524,-1766.33"/>
<text text-anchor="middle" x="3280" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="3280" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="3280" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="3280" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU6 -->
<g id="edge7" class="edge">
<title>Input&#45;&gt;Embedding_GPU6</title>
<path fill="none" stroke="black" d="M2325.4,-1827.79C2523.09,-1813.08 2784.83,-1791.87 3025.96,-1766.43"/>
<polygon fill="black" stroke="black" points="3026.4,-1769.9 3035.97,-1765.37 3025.66,-1762.94 3026.4,-1769.9"/>
</g>
<!-- Embedding_GPU7 -->
<g id="node9" class="node">
<title>Embedding_GPU7</title>
<polygon fill="none" stroke="black" points="4030,-1766.33 3542,-1766.33 3542,-1698.33 4030,-1698.33 4030,-1766.33"/>
<text text-anchor="middle" x="3786" y="-1751.13" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="3786" y="-1736.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, token_ids]</text>
<text text-anchor="middle" x="3786" y="-1721.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="3786" y="-1706.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU7 -->
<g id="edge8" class="edge">
<title>Input&#45;&gt;Embedding_GPU7</title>
<path fill="none" stroke="black" d="M2355.04,-1838.11C2660.56,-1826.22 3121.59,-1804.04 3532,-1766.4"/>
<polygon fill="black" stroke="black" points="3532.35,-1769.89 3541.99,-1765.48 3531.71,-1762.91 3532.35,-1769.89"/>
</g>
<!-- Embedding_AllGather -->
<g id="node10" class="node">
<title>Embedding_AllGather</title>
<polygon fill="none" stroke="black" points="2530.03,-1662.33 1710.73,-1662.33 1499.97,-1526.33 2319.27,-1526.33 2530.03,-1662.33"/>
<text text-anchor="middle" x="2015" y="-1613.13" font-family="Times,serif" font-size="14.00">Embedding All&#45;Gather</text>
<text text-anchor="middle" x="2015" y="-1598.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="2015" y="-1583.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1568.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Embedding_GPU0&#45;&gt;Embedding_AllGather -->
<g id="edge9" class="edge">
<title>Embedding_GPU0&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M488.02,-1699.24C491.03,-1698.93 494.02,-1698.63 497,-1698.33 880.04,-1660.39 1318.86,-1632.27 1625.85,-1615.09"/>
<polygon fill="black" stroke="black" points="1626.47,-1618.56 1636.26,-1614.5 1626.08,-1611.57 1626.47,-1618.56"/>
</g>
<!-- Embedding_GPU1&#45;&gt;Embedding_AllGather -->
<g id="edge10" class="edge">
<title>Embedding_GPU1&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M994.04,-1699.38C997.04,-1699.03 1000.03,-1698.68 1003,-1698.33 1216.92,-1673.5 1456.66,-1648.96 1649.09,-1630.06"/>
<polygon fill="black" stroke="black" points="1649.47,-1633.54 1659.08,-1629.08 1648.79,-1626.57 1649.47,-1633.54"/>
</g>
<!-- Embedding_GPU2&#45;&gt;Embedding_AllGather -->
<g id="edge11" class="edge">
<title>Embedding_GPU2&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M1440.22,-1698.32C1514.08,-1685.09 1601.5,-1669.43 1685.59,-1654.36"/>
<polygon fill="black" stroke="black" points="1686.33,-1657.78 1695.56,-1652.57 1685.1,-1650.89 1686.33,-1657.78"/>
</g>
<!-- Embedding_GPU3&#45;&gt;Embedding_AllGather -->
<g id="edge12" class="edge">
<title>Embedding_GPU3&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M1823.57,-1698.24C1841.21,-1688.75 1861.17,-1678.02 1881.38,-1667.16"/>
<polygon fill="black" stroke="black" points="1883.2,-1670.15 1890.35,-1662.34 1879.89,-1663.99 1883.2,-1670.15"/>
</g>
<!-- Embedding_GPU4&#45;&gt;Embedding_AllGather -->
<g id="edge13" class="edge">
<title>Embedding_GPU4&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M2206.43,-1698.24C2188.79,-1688.75 2168.83,-1678.02 2148.62,-1667.16"/>
<polygon fill="black" stroke="black" points="2150.11,-1663.99 2139.65,-1662.34 2146.8,-1670.15 2150.11,-1663.99"/>
</g>
<!-- Embedding_GPU5&#45;&gt;Embedding_AllGather -->
<g id="edge14" class="edge">
<title>Embedding_GPU5&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M2589.78,-1698.32C2531.88,-1687.95 2465.63,-1676.08 2399.2,-1664.17"/>
<polygon fill="black" stroke="black" points="2399.43,-1660.66 2388.97,-1662.34 2398.19,-1667.55 2399.43,-1660.66"/>
</g>
<!-- Embedding_GPU6&#45;&gt;Embedding_AllGather -->
<g id="edge15" class="edge">
<title>Embedding_GPU6&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M3035.96,-1699.38C3032.96,-1699.03 3029.97,-1698.68 3027,-1698.33 2858.29,-1678.75 2673.51,-1659.34 2508.55,-1642.74"/>
<polygon fill="black" stroke="black" points="2508.51,-1639.22 2498.21,-1641.71 2507.81,-1646.19 2508.51,-1639.22"/>
</g>
<!-- Embedding_GPU7&#45;&gt;Embedding_AllGather -->
<g id="edge16" class="edge">
<title>Embedding_GPU7&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M3541.98,-1699.24C3538.97,-1698.93 3535.98,-1698.63 3533,-1698.33 3177.57,-1663.13 2774.12,-1636.38 2472.53,-1618.97"/>
<polygon fill="black" stroke="black" points="2472.48,-1615.46 2462.3,-1618.38 2472.08,-1622.45 2472.48,-1615.46"/>
</g>
<!-- Positional_Encoding -->
<g id="node11" class="node">
<title>Positional_Encoding</title>
<polygon fill="none" stroke="black" points="2263.5,-1490.33 1766.5,-1490.33 1766.5,-1422.33 2263.5,-1422.33 2263.5,-1490.33"/>
<text text-anchor="middle" x="2015" y="-1475.13" font-family="Times,serif" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="2015" y="-1460.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1445.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1430.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Embedding_AllGather&#45;&gt;Positional_Encoding -->
<g id="edge17" class="edge">
<title>Embedding_AllGather&#45;&gt;Positional_Encoding</title>
<path fill="none" stroke="black" d="M2015,-1526.13C2015,-1517.38 2015,-1508.61 2015,-1500.4"/>
<polygon fill="black" stroke="black" points="2018.5,-1500.35 2015,-1490.35 2011.5,-1500.35 2018.5,-1500.35"/>
</g>
<!-- LayerNorm1 -->
<g id="node12" class="node">
<title>LayerNorm1</title>
<polygon fill="none" stroke="black" points="2263.5,-1349.33 1766.5,-1349.33 1766.5,-1281.33 2263.5,-1281.33 2263.5,-1349.33"/>
<text text-anchor="middle" x="2015" y="-1334.13" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2015" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2015" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Positional_Encoding&#45;&gt;LayerNorm1 -->
<g id="edge18" class="edge">
<title>Positional_Encoding&#45;&gt;LayerNorm1</title>
<path fill="none" stroke="black" d="M2015,-1422.04C2015,-1403.3 2015,-1379.69 2015,-1359.53"/>
<polygon fill="black" stroke="black" points="2018.5,-1359.36 2015,-1349.36 2011.5,-1359.36 2018.5,-1359.36"/>
</g>
<!-- MHA_Query_Split1 -->
<g id="node13" class="node">
<title>MHA_Query_Split1</title>
<polygon fill="none" stroke="black" points="4722.33,-1211.33 3896.19,-1211.33 3683.67,-1075.33 4509.81,-1075.33 4722.33,-1211.33"/>
<text text-anchor="middle" x="4203" y="-1162.13" font-family="Times,serif" font-size="14.00">Query Split</text>
<text text-anchor="middle" x="4203" y="-1147.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="4203" y="-1132.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4203" y="-1117.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- LayerNorm1&#45;&gt;MHA_Query_Split1 -->
<g id="edge19" class="edge">
<title>LayerNorm1&#45;&gt;MHA_Query_Split1</title>
<path fill="none" stroke="black" d="M2122.26,-1281.33C2168.23,-1268.53 2222.81,-1255.11 2273,-1247.33 2556.46,-1203.42 3322.12,-1172.22 3799.48,-1156.34"/>
<polygon fill="black" stroke="black" points="3799.77,-1159.83 3809.65,-1156 3799.54,-1152.84 3799.77,-1159.83"/>
</g>
<!-- MHA_Key_Split1 -->
<g id="node14" class="node">
<title>MHA_Key_Split1</title>
<polygon fill="none" stroke="black" points="5779.33,-1211.33 4953.19,-1211.33 4740.67,-1075.33 5566.81,-1075.33 5779.33,-1211.33"/>
<text text-anchor="middle" x="5260" y="-1162.13" font-family="Times,serif" font-size="14.00">Key Split</text>
<text text-anchor="middle" x="5260" y="-1147.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5260" y="-1132.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5260" y="-1117.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- LayerNorm1&#45;&gt;MHA_Key_Split1 -->
<g id="edge20" class="edge">
<title>LayerNorm1&#45;&gt;MHA_Key_Split1</title>
<path fill="none" stroke="black" d="M2118.99,-1281.26C2165.58,-1268.03 2221.52,-1254.29 2273,-1247.33 2814.36,-1174.15 4186.07,-1249.71 4731,-1211.33 4790.16,-1207.17 4852.83,-1200.89 4913.56,-1193.82"/>
<polygon fill="black" stroke="black" points="4914.16,-1197.27 4923.68,-1192.63 4913.34,-1190.32 4914.16,-1197.27"/>
</g>
<!-- MHA_Value_Split1 -->
<g id="node15" class="node">
<title>MHA_Value_Split1</title>
<polygon fill="none" stroke="black" points="6836.33,-1211.33 6010.19,-1211.33 5797.67,-1075.33 6623.81,-1075.33 6836.33,-1211.33"/>
<text text-anchor="middle" x="6317" y="-1162.13" font-family="Times,serif" font-size="14.00">Value Split</text>
<text text-anchor="middle" x="6317" y="-1147.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="6317" y="-1132.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6317" y="-1117.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- LayerNorm1&#45;&gt;MHA_Value_Split1 -->
<g id="edge21" class="edge">
<title>LayerNorm1&#45;&gt;MHA_Value_Split1</title>
<path fill="none" stroke="black" d="M2118.67,-1281.24C2165.32,-1267.96 2221.39,-1254.19 2273,-1247.33 2660.17,-1195.86 5398.33,-1237.92 5788,-1211.33 5847.27,-1207.29 5910.07,-1201.06 5970.91,-1194"/>
<polygon fill="black" stroke="black" points="5971.52,-1197.45 5981.05,-1192.81 5970.71,-1190.5 5971.52,-1197.45"/>
</g>
<!-- MHA_Attention1_GPU0 -->
<g id="node16" class="node">
<title>MHA_Attention1_GPU0</title>
<polygon fill="none" stroke="black" points="2748.5,-1002.33 1765.5,-1002.33 1765.5,-934.33 2748.5,-934.33 2748.5,-1002.33"/>
<text text-anchor="middle" x="2257" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="2257" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2257" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2257" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU0 -->
<g id="edge22" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU0</title>
<path fill="none" stroke="black" d="M3778.39,-1136.06C3489.75,-1127.93 3099.73,-1109.41 2758,-1067.33 2639.25,-1052.71 2506.41,-1026.26 2407.37,-1004.52"/>
<polygon fill="black" stroke="black" points="2408.11,-1001.09 2397.59,-1002.36 2406.61,-1007.93 2408.11,-1001.09"/>
</g>
<!-- MHA_Attention1_GPU1 -->
<g id="node17" class="node">
<title>MHA_Attention1_GPU1</title>
<polygon fill="none" stroke="black" points="3749.5,-1002.33 2766.5,-1002.33 2766.5,-934.33 3749.5,-934.33 3749.5,-1002.33"/>
<text text-anchor="middle" x="3258" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="3258" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3258" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3258" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU1 -->
<g id="edge23" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU1</title>
<path fill="none" stroke="black" d="M3803.25,-1075.31C3788.31,-1072.64 3773.52,-1069.98 3759,-1067.33 3649.73,-1047.42 3527.38,-1023.52 3430.94,-1004.31"/>
<polygon fill="black" stroke="black" points="3431.59,-1000.87 3421.1,-1002.34 3430.22,-1007.73 3431.59,-1000.87"/>
</g>
<!-- MHA_Attention1_GPU2 -->
<g id="node18" class="node">
<title>MHA_Attention1_GPU2</title>
<polygon fill="none" stroke="black" points="4750.5,-1002.33 3767.5,-1002.33 3767.5,-934.33 4750.5,-934.33 4750.5,-1002.33"/>
<text text-anchor="middle" x="4259" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="4259" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4259" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4259" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU2 -->
<g id="edge24" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU2</title>
<path fill="none" stroke="black" d="M4224.81,-1074.95C4231.66,-1053.78 4239.04,-1031.01 4245.17,-1012.05"/>
<polygon fill="black" stroke="black" points="4248.51,-1013.1 4248.26,-1002.51 4241.85,-1010.94 4248.51,-1013.1"/>
</g>
<!-- MHA_Attention1_GPU3 -->
<g id="node19" class="node">
<title>MHA_Attention1_GPU3</title>
<polygon fill="none" stroke="black" points="5751.5,-1002.33 4768.5,-1002.33 4768.5,-934.33 5751.5,-934.33 5751.5,-1002.33"/>
<text text-anchor="middle" x="5260" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="5260" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5260" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5260" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU3 -->
<g id="edge25" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU3</title>
<path fill="none" stroke="black" d="M4547.4,-1099.23C4617.85,-1089.5 4691.41,-1078.66 4760,-1067.33 4871.9,-1048.85 4997.14,-1024.3 5094.29,-1004.39"/>
<polygon fill="black" stroke="black" points="5095.1,-1007.8 5104.19,-1002.36 5093.7,-1000.94 5095.1,-1007.8"/>
</g>
<!-- MHA_Attention1_GPU4 -->
<g id="node20" class="node">
<title>MHA_Attention1_GPU4</title>
<polygon fill="none" stroke="black" points="6752.5,-1002.33 5769.5,-1002.33 5769.5,-934.33 6752.5,-934.33 6752.5,-1002.33"/>
<text text-anchor="middle" x="6261" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="6261" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6261" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6261" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU4 -->
<g id="edge26" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU4</title>
<path fill="none" stroke="black" d="M4538.94,-1093.73C4602.91,-1086.19 4669.42,-1079.52 4732,-1075.33 4846.08,-1067.69 5647.24,-1078.82 5761,-1067.33 5882.69,-1055.04 6018.79,-1027.44 6118.23,-1004.65"/>
<polygon fill="black" stroke="black" points="6119.09,-1008.05 6128.05,-1002.39 6117.51,-1001.22 6119.09,-1008.05"/>
</g>
<!-- MHA_Attention1_GPU5 -->
<g id="node21" class="node">
<title>MHA_Attention1_GPU5</title>
<polygon fill="none" stroke="black" points="7753.5,-1002.33 6770.5,-1002.33 6770.5,-934.33 7753.5,-934.33 7753.5,-1002.33"/>
<text text-anchor="middle" x="7262" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="7262" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7262" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7262" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU5 -->
<g id="edge27" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU5</title>
<path fill="none" stroke="black" d="M4538.58,-1093.57C4602.66,-1086.04 4669.3,-1079.41 4732,-1075.33 4844.54,-1068.01 6649.77,-1078.45 6762,-1067.33 6884.03,-1055.24 7020.53,-1027.51 7120.03,-1004.62"/>
<polygon fill="black" stroke="black" points="7120.89,-1008.01 7129.85,-1002.35 7119.32,-1001.19 7120.89,-1008.01"/>
</g>
<!-- MHA_Attention1_GPU6 -->
<g id="node22" class="node">
<title>MHA_Attention1_GPU6</title>
<polygon fill="none" stroke="black" points="8754.5,-1002.33 7771.5,-1002.33 7771.5,-934.33 8754.5,-934.33 8754.5,-1002.33"/>
<text text-anchor="middle" x="8263" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="8263" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8263" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8263" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU6 -->
<g id="edge28" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU6</title>
<path fill="none" stroke="black" d="M4538.57,-1093.51C4602.65,-1085.98 4669.3,-1079.37 4732,-1075.33 4900.04,-1064.51 7595.42,-1083.82 7763,-1067.33 7885.15,-1055.31 8021.77,-1027.53 8121.3,-1004.61"/>
<polygon fill="black" stroke="black" points="8122.16,-1008 8131.11,-1002.33 8120.58,-1001.18 8122.16,-1008"/>
</g>
<!-- MHA_Attention1_GPU7 -->
<g id="node23" class="node">
<title>MHA_Attention1_GPU7</title>
<polygon fill="none" stroke="black" points="9755.5,-1002.33 8772.5,-1002.33 8772.5,-934.33 9755.5,-934.33 9755.5,-1002.33"/>
<text text-anchor="middle" x="9264" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="9264" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9264" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9264" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU7 -->
<g id="edge29" class="edge">
<title>MHA_Query_Split1&#45;&gt;MHA_Attention1_GPU7</title>
<path fill="none" stroke="black" d="M4538.57,-1093.47C4602.65,-1085.95 4669.29,-1079.35 4732,-1075.33 4843.77,-1068.17 8652.53,-1078.27 8764,-1067.33 8886.15,-1055.35 9022.78,-1027.57 9122.3,-1004.63"/>
<polygon fill="black" stroke="black" points="9123.16,-1008.03 9132.12,-1002.36 9121.58,-1001.21 9123.16,-1008.03"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU0 -->
<g id="edge30" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU0</title>
<path fill="none" stroke="black" d="M4741.78,-1076.06C4738.17,-1075.81 4734.58,-1075.57 4731,-1075.33 4621.62,-1068.21 2867.08,-1078.12 2758,-1067.33 2635.73,-1055.24 2498.96,-1027.5 2399.26,-1004.61"/>
<polygon fill="black" stroke="black" points="2399.95,-1001.18 2389.42,-1002.34 2398.38,-1008 2399.95,-1001.18"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU1 -->
<g id="edge31" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU1</title>
<path fill="none" stroke="black" d="M4741.77,-1076.08C4738.17,-1075.82 4734.58,-1075.57 4731,-1075.33 4623.24,-1068.09 3866.46,-1078.19 3759,-1067.33 3637.07,-1055.01 3500.7,-1027.41 3401.06,-1004.63"/>
<polygon fill="black" stroke="black" points="3401.76,-1001.2 3391.23,-1002.37 3400.19,-1008.02 3401.76,-1001.2"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU2 -->
<g id="edge32" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU2</title>
<path fill="none" stroke="black" d="M4807.1,-1075.31C4791.2,-1072.67 4775.46,-1070 4760,-1067.33 4649.18,-1048.19 4525.13,-1023.95 4428.19,-1004.36"/>
<polygon fill="black" stroke="black" points="4428.8,-1000.92 4418.3,-1002.36 4427.41,-1007.78 4428.8,-1000.92"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU3 -->
<g id="edge33" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU3</title>
<path fill="none" stroke="black" d="M5260,-1074.95C5260,-1053.98 5260,-1031.43 5260,-1012.57"/>
<polygon fill="black" stroke="black" points="5263.5,-1012.51 5260,-1002.51 5256.5,-1012.51 5263.5,-1012.51"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU4 -->
<g id="edge34" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU4</title>
<path fill="none" stroke="black" d="M5596.19,-1094.13C5651.33,-1085.62 5707.81,-1076.52 5761,-1067.33 5871.61,-1048.22 5995.41,-1023.98 6092.15,-1004.39"/>
<polygon fill="black" stroke="black" points="6092.92,-1007.8 6102.02,-1002.39 6091.53,-1000.94 6092.92,-1007.8"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU5 -->
<g id="edge35" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU5</title>
<path fill="none" stroke="black" d="M5595.94,-1093.75C5659.92,-1086.21 5726.42,-1079.54 5789,-1075.33 5896.87,-1068.08 6654.43,-1078.22 6762,-1067.33 6883.69,-1055.01 7019.79,-1027.41 7119.23,-1004.63"/>
<polygon fill="black" stroke="black" points="7120.08,-1008.03 7129.04,-1002.37 7118.51,-1001.21 7120.08,-1008.03"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU6 -->
<g id="edge36" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU6</title>
<path fill="none" stroke="black" d="M5595.58,-1093.58C5659.66,-1086.04 5726.3,-1079.42 5789,-1075.33 5898.44,-1068.21 7653.87,-1078.15 7763,-1067.33 7885.03,-1055.24 8021.53,-1027.5 8121.03,-1004.61"/>
<polygon fill="black" stroke="black" points="8121.89,-1008.01 8130.85,-1002.34 8120.32,-1001.19 8121.89,-1008.01"/>
</g>
<!-- MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU7 -->
<g id="edge37" class="edge">
<title>MHA_Key_Split1&#45;&gt;MHA_Attention1_GPU7</title>
<path fill="none" stroke="black" d="M5595.57,-1093.51C5659.65,-1085.98 5726.3,-1079.37 5789,-1075.33 5953.94,-1064.71 8599.52,-1083.52 8764,-1067.33 8886.04,-1055.32 9022.53,-1027.58 9122.04,-1004.67"/>
<polygon fill="black" stroke="black" points="9122.9,-1008.06 9131.85,-1002.39 9121.32,-1001.24 9122.9,-1008.06"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU0 -->
<g id="edge38" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU0</title>
<path fill="none" stroke="black" d="M5798.78,-1076.05C5795.17,-1075.8 5791.58,-1075.56 5788,-1075.33 5620.01,-1064.51 2925.53,-1083.79 2758,-1067.33 2635.61,-1055.31 2498.72,-1027.53 2398.99,-1004.61"/>
<polygon fill="black" stroke="black" points="2399.69,-1001.18 2389.15,-1002.33 2398.11,-1008 2399.69,-1001.18"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU1 -->
<g id="edge39" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU1</title>
<path fill="none" stroke="black" d="M5798.78,-1076.06C5795.17,-1075.81 5791.58,-1075.57 5788,-1075.33 5675.51,-1068.02 3871.18,-1078.42 3759,-1067.33 3636.73,-1055.24 3499.96,-1027.51 3400.26,-1004.62"/>
<polygon fill="black" stroke="black" points="3400.95,-1001.19 3390.42,-1002.35 3399.38,-1008.01 3400.95,-1001.19"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU2 -->
<g id="edge40" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU2</title>
<path fill="none" stroke="black" d="M5798.78,-1076.08C5795.17,-1075.82 5791.58,-1075.57 5788,-1075.33 5674.03,-1067.7 4873.65,-1078.79 4760,-1067.33 4638.07,-1055.04 4501.7,-1027.44 4402.06,-1004.65"/>
<polygon fill="black" stroke="black" points="4402.75,-1001.22 4392.22,-1002.39 4401.19,-1008.04 4402.75,-1001.22"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU3 -->
<g id="edge41" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU3</title>
<path fill="none" stroke="black" d="M5810.38,-1075.28C5793.71,-1072.66 5777.22,-1070.01 5761,-1067.33 5648.88,-1048.82 5523.39,-1024.27 5426.05,-1004.37"/>
<polygon fill="black" stroke="black" points="5426.62,-1000.91 5416.12,-1002.34 5425.22,-1007.77 5426.62,-1000.91"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU4 -->
<g id="edge42" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU4</title>
<path fill="none" stroke="black" d="M6295.19,-1074.95C6288.34,-1053.78 6280.96,-1031.01 6274.83,-1012.05"/>
<polygon fill="black" stroke="black" points="6278.15,-1010.94 6271.74,-1002.51 6271.49,-1013.1 6278.15,-1010.94"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU5 -->
<g id="edge43" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU5</title>
<path fill="none" stroke="black" d="M6644.05,-1088.23C6683.81,-1081.35 6723.85,-1074.29 6762,-1067.33 6871.06,-1047.46 6993.16,-1023.56 7089.41,-1004.33"/>
<polygon fill="black" stroke="black" points="7090.11,-1007.76 7099.23,-1002.37 7088.74,-1000.9 7090.11,-1007.76"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU6 -->
<g id="edge44" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU6</title>
<path fill="none" stroke="black" d="M6719.98,-1136.71C7010.79,-1128.94 7412.31,-1110.57 7763,-1067.33 7881.4,-1052.73 8013.82,-1026.32 8112.63,-1004.59"/>
<polygon fill="black" stroke="black" points="8113.68,-1007.94 8122.69,-1002.37 8112.17,-1001.1 8113.68,-1007.94"/>
</g>
<!-- MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU7 -->
<g id="edge45" class="edge">
<title>MHA_Value_Split1&#45;&gt;MHA_Attention1_GPU7</title>
<path fill="none" stroke="black" d="M6721.62,-1137.92C7312.01,-1130.12 8380.91,-1110.46 8764,-1067.33 8884.05,-1053.82 9018.32,-1026.83 9117.47,-1004.59"/>
<polygon fill="black" stroke="black" points="9118.27,-1008 9127.25,-1002.39 9116.73,-1001.17 9118.27,-1008"/>
</g>
<!-- MHA_Concat1 -->
<g id="node24" class="node">
<title>MHA_Concat1</title>
<polygon fill="none" stroke="black" points="6275.03,-864.33 5455.73,-864.33 5244.97,-728.33 6064.27,-728.33 6275.03,-864.33"/>
<text text-anchor="middle" x="5760" y="-815.13" font-family="Times,serif" font-size="14.00">Attention Concat</text>
<text text-anchor="middle" x="5760" y="-800.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5760" y="-785.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5760" y="-770.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- MHA_Attention1_GPU0&#45;&gt;MHA_Concat1 -->
<g id="edge46" class="edge">
<title>MHA_Attention1_GPU0&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M2442.25,-934.32C2536.48,-918.87 2653,-901.82 2758,-892.33 3248.93,-847.97 4652.11,-817.32 5352.31,-804.32"/>
<polygon fill="black" stroke="black" points="5352.38,-807.82 5362.31,-804.14 5352.25,-800.82 5352.38,-807.82"/>
</g>
<!-- MHA_Attention1_GPU1&#45;&gt;MHA_Concat1 -->
<g id="edge47" class="edge">
<title>MHA_Attention1_GPU1&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M3447.76,-934.3C3541.21,-919.22 3655.72,-902.49 3759,-892.33 4309.05,-838.24 4947.3,-814.7 5352.28,-804.62"/>
<polygon fill="black" stroke="black" points="5352.48,-808.12 5362.4,-804.37 5352.31,-801.12 5352.48,-808.12"/>
</g>
<!-- MHA_Attention1_GPU2&#45;&gt;MHA_Concat1 -->
<g id="edge48" class="edge">
<title>MHA_Attention1_GPU2&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M4462.5,-934.33C4553.39,-920.24 4661.9,-904.33 4760,-892.33 4967.26,-866.99 5199.4,-844.58 5387.8,-827.89"/>
<polygon fill="black" stroke="black" points="5388.22,-831.37 5397.87,-827 5387.6,-824.39 5388.22,-831.37"/>
</g>
<!-- MHA_Attention1_GPU3&#45;&gt;MHA_Concat1 -->
<g id="edge49" class="edge">
<title>MHA_Attention1_GPU3&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M5357.29,-934.25C5413.12,-915.27 5485.42,-890.69 5553.31,-867.61"/>
<polygon fill="black" stroke="black" points="5554.52,-870.89 5562.86,-864.36 5552.27,-864.27 5554.52,-870.89"/>
</g>
<!-- MHA_Attention1_GPU4&#45;&gt;MHA_Concat1 -->
<g id="edge50" class="edge">
<title>MHA_Attention1_GPU4&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M6163.51,-934.25C6107.57,-915.27 6035.13,-890.69 5967.1,-867.61"/>
<polygon fill="black" stroke="black" points="5968.13,-864.26 5957.53,-864.36 5965.88,-870.89 5968.13,-864.26"/>
</g>
<!-- MHA_Attention1_GPU5&#45;&gt;MHA_Concat1 -->
<g id="edge51" class="edge">
<title>MHA_Attention1_GPU5&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M7058.91,-934.31C6968.21,-920.22 6859.91,-904.31 6762,-892.33 6593.07,-871.67 6407.64,-852.98 6242.72,-837.75"/>
<polygon fill="black" stroke="black" points="6242.67,-834.23 6232.39,-836.8 6242.02,-841.2 6242.67,-834.23"/>
</g>
<!-- MHA_Attention1_GPU6&#45;&gt;MHA_Concat1 -->
<g id="edge52" class="edge">
<title>MHA_Attention1_GPU6&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M8073.62,-934.29C7980.36,-919.21 7866.08,-902.48 7763,-892.33 7223.79,-839.24 6599.89,-815.59 6193.57,-805.21"/>
<polygon fill="black" stroke="black" points="6193.5,-801.71 6183.41,-804.95 6193.32,-808.7 6193.5,-801.71"/>
</g>
<!-- MHA_Attention1_GPU7&#45;&gt;MHA_Concat1 -->
<g id="edge53" class="edge">
<title>MHA_Attention1_GPU7&#45;&gt;MHA_Concat1</title>
<path fill="none" stroke="black" d="M9079.12,-934.31C8985.08,-918.86 8868.79,-901.82 8764,-892.33 8278.49,-848.4 6901.31,-817.99 6192.8,-804.76"/>
<polygon fill="black" stroke="black" points="6192.74,-801.26 6182.67,-804.58 6192.61,-808.26 6192.74,-801.26"/>
</g>
<!-- MHA_Projection1_GPU0 -->
<g id="node25" class="node">
<title>MHA_Projection1_GPU0</title>
<polygon fill="none" stroke="black" points="6257,-678.25 5769,-678.25 5769,-610.25 6257,-610.25 6257,-678.25"/>
<text text-anchor="middle" x="6013" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6013" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="6013" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="6013" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU0 -->
<g id="edge54" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU0</title>
<path fill="none" stroke="black" d="M5873.18,-728.19C5899.08,-712.83 5925.73,-697.02 5948.73,-683.38"/>
<polygon fill="black" stroke="black" points="5950.54,-686.37 5957.36,-678.26 5946.97,-680.35 5950.54,-686.37"/>
</g>
<!-- MHA_Projection1_GPU1 -->
<g id="node26" class="node">
<title>MHA_Projection1_GPU1</title>
<polygon fill="none" stroke="black" points="6763,-678.25 6275,-678.25 6275,-610.25 6763,-610.25 6763,-678.25"/>
<text text-anchor="middle" x="6519" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6519" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="6519" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="6519" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU1 -->
<g id="edge55" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU1</title>
<path fill="none" stroke="black" d="M6072.55,-733.53C6164.34,-715.38 6261.53,-696.16 6341.71,-680.31"/>
<polygon fill="black" stroke="black" points="6342.77,-683.67 6351.9,-678.29 6341.41,-676.8 6342.77,-683.67"/>
</g>
<!-- MHA_Projection1_GPU2 -->
<g id="node27" class="node">
<title>MHA_Projection1_GPU2</title>
<polygon fill="none" stroke="black" points="7269,-678.25 6781,-678.25 6781,-610.25 7269,-610.25 7269,-678.25"/>
<text text-anchor="middle" x="7025" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7025" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="7025" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="7025" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU2 -->
<g id="edge56" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU2</title>
<path fill="none" stroke="black" d="M6122.41,-765.75C6315.71,-748.14 6557.32,-723.18 6772,-692.33 6796.69,-688.78 6822.65,-684.54 6848.15,-680.08"/>
<polygon fill="black" stroke="black" points="6849.03,-683.48 6858.27,-678.3 6847.82,-676.59 6849.03,-683.48"/>
</g>
<!-- MHA_Projection1_GPU3 -->
<g id="node28" class="node">
<title>MHA_Projection1_GPU3</title>
<polygon fill="none" stroke="black" points="7775,-678.25 7287,-678.25 7287,-610.25 7775,-610.25 7775,-678.25"/>
<text text-anchor="middle" x="7531" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7531" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="7531" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="7531" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU3 -->
<g id="edge57" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU3</title>
<path fill="none" stroke="black" d="M6146.85,-781.5C6454.33,-767.51 6894.9,-740.81 7278,-692.33 7304.35,-689 7332.11,-684.67 7359.19,-680"/>
<polygon fill="black" stroke="black" points="7359.89,-683.43 7369.14,-678.26 7358.69,-676.53 7359.89,-683.43"/>
</g>
<!-- MHA_Projection1_GPU4 -->
<g id="node29" class="node">
<title>MHA_Projection1_GPU4</title>
<polygon fill="none" stroke="black" points="4233,-678.25 3745,-678.25 3745,-610.25 4233,-610.25 4233,-678.25"/>
<text text-anchor="middle" x="3989" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3989" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="3989" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="3989" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU4 -->
<g id="edge58" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU4</title>
<path fill="none" stroke="black" d="M5323.57,-779.18C5019.49,-764.64 4604.95,-738.26 4242,-692.33 4215.65,-689 4187.89,-684.67 4160.81,-680"/>
<polygon fill="black" stroke="black" points="4161.31,-676.53 4150.86,-678.26 4160.11,-683.43 4161.31,-676.53"/>
</g>
<!-- MHA_Projection1_GPU5 -->
<g id="node30" class="node">
<title>MHA_Projection1_GPU5</title>
<polygon fill="none" stroke="black" points="4739,-678.25 4251,-678.25 4251,-610.25 4739,-610.25 4739,-678.25"/>
<text text-anchor="middle" x="4495" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4495" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="4495" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="4495" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU5 -->
<g id="edge59" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU5</title>
<path fill="none" stroke="black" d="M5286.63,-755.31C5116.43,-738.77 4923.24,-717.51 4748,-692.33 4723.31,-688.78 4697.35,-684.54 4671.85,-680.08"/>
<polygon fill="black" stroke="black" points="4672.18,-676.59 4661.73,-678.3 4670.97,-683.48 4672.18,-676.59"/>
</g>
<!-- MHA_Projection1_GPU6 -->
<g id="node31" class="node">
<title>MHA_Projection1_GPU6</title>
<polygon fill="none" stroke="black" points="5245,-678.25 4757,-678.25 4757,-610.25 5245,-610.25 5245,-678.25"/>
<text text-anchor="middle" x="5001" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5001" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5001" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5001" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU6 -->
<g id="edge60" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU6</title>
<path fill="none" stroke="black" d="M5421.01,-728.3C5337.17,-711.72 5250.65,-694.62 5178.09,-680.27"/>
<polygon fill="black" stroke="black" points="5178.44,-676.77 5167.95,-678.26 5177.08,-683.64 5178.44,-676.77"/>
</g>
<!-- MHA_Projection1_GPU7 -->
<g id="node32" class="node">
<title>MHA_Projection1_GPU7</title>
<polygon fill="none" stroke="black" points="5751,-678.25 5263,-678.25 5263,-610.25 5751,-610.25 5751,-678.25"/>
<text text-anchor="middle" x="5507" y="-663.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5507" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5507" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5507" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- MHA_Concat1&#45;&gt;MHA_Projection1_GPU7 -->
<g id="edge61" class="edge">
<title>MHA_Concat1&#45;&gt;MHA_Projection1_GPU7</title>
<path fill="none" stroke="black" d="M5646.82,-728.19C5620.92,-712.83 5594.27,-697.02 5571.27,-683.38"/>
<polygon fill="black" stroke="black" points="5573.03,-680.35 5562.64,-678.26 5569.46,-686.37 5573.03,-680.35"/>
</g>
<!-- MHA_AllGather1 -->
<g id="node33" class="node">
<title>MHA_AllGather1</title>
<polygon fill="none" stroke="black" points="6275.03,-560.17 5455.73,-560.17 5244.97,-424.17 6064.27,-424.17 6275.03,-560.17"/>
<text text-anchor="middle" x="5760" y="-510.97" font-family="Times,serif" font-size="14.00">Projection All&#45;Gather</text>
<text text-anchor="middle" x="5760" y="-495.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5760" y="-480.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5760" y="-465.97" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- MHA_Projection1_GPU0&#45;&gt;MHA_AllGather1 -->
<g id="edge62" class="edge">
<title>MHA_Projection1_GPU0&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M5957.16,-610.13C5934.87,-596.9 5908.27,-581.12 5881.93,-565.5"/>
<polygon fill="black" stroke="black" points="5883.41,-562.3 5873.02,-560.21 5879.83,-568.32 5883.41,-562.3"/>
</g>
<!-- MHA_Projection1_GPU1&#45;&gt;MHA_AllGather1 -->
<g id="edge63" class="edge">
<title>MHA_Projection1_GPU1&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M6351.96,-610.22C6280.28,-596.04 6193.66,-578.92 6109.08,-562.19"/>
<polygon fill="black" stroke="black" points="6109.53,-558.71 6099.04,-560.21 6108.17,-565.58 6109.53,-558.71"/>
</g>
<!-- MHA_Projection1_GPU2&#45;&gt;MHA_AllGather1 -->
<g id="edge64" class="edge">
<title>MHA_Projection1_GPU2&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M6858.27,-610.2C6829.57,-605.09 6799.97,-600.19 6772,-596.17 6600.18,-571.48 6411.11,-550.56 6243.37,-534.16"/>
<polygon fill="black" stroke="black" points="6243.66,-530.68 6233.37,-533.19 6242.99,-537.64 6243.66,-530.68"/>
</g>
<!-- MHA_Projection1_GPU3&#45;&gt;MHA_AllGather1 -->
<g id="edge65" class="edge">
<title>MHA_Projection1_GPU3&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M7369.14,-610.24C7338.94,-604.9 7307.59,-599.91 7278,-596.17 6919.13,-550.75 6509.81,-524.45 6206.72,-509.81"/>
<polygon fill="black" stroke="black" points="6206.59,-506.3 6196.43,-509.32 6206.25,-513.29 6206.59,-506.3"/>
</g>
<!-- MHA_Projection1_GPU4&#45;&gt;MHA_AllGather1 -->
<g id="edge66" class="edge">
<title>MHA_Projection1_GPU4&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M4150.86,-610.24C4181.06,-604.9 4212.41,-599.91 4242,-596.17 4620.79,-548.23 5055.78,-521.59 5362.74,-507.48"/>
<polygon fill="black" stroke="black" points="5363.32,-510.96 5373.15,-507 5363,-503.96 5363.32,-510.96"/>
</g>
<!-- MHA_Projection1_GPU5&#45;&gt;MHA_AllGather1 -->
<g id="edge67" class="edge">
<title>MHA_Projection1_GPU5&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M4661.73,-610.2C4690.43,-605.09 4720.03,-600.19 4748,-596.17 4958.91,-565.86 5195.81,-541.24 5387.35,-523.68"/>
<polygon fill="black" stroke="black" points="5387.95,-527.14 5397.59,-522.75 5387.31,-520.17 5387.95,-527.14"/>
</g>
<!-- MHA_Projection1_GPU6&#45;&gt;MHA_AllGather1 -->
<g id="edge68" class="edge">
<title>MHA_Projection1_GPU6&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M5168.04,-610.22C5247.29,-594.55 5344.78,-575.27 5437.6,-556.92"/>
<polygon fill="black" stroke="black" points="5438.31,-560.35 5447.44,-554.97 5436.95,-553.48 5438.31,-560.35"/>
</g>
<!-- MHA_Projection1_GPU7&#45;&gt;MHA_AllGather1 -->
<g id="edge69" class="edge">
<title>MHA_Projection1_GPU7&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" d="M5562.84,-610.13C5585.13,-596.9 5611.73,-581.12 5638.07,-565.5"/>
<polygon fill="black" stroke="black" points="5640.17,-568.32 5646.98,-560.21 5636.59,-562.3 5640.17,-568.32"/>
</g>
<!-- Residual_Add1 -->
<g id="node34" class="node">
<title>Residual_Add1</title>
<ellipse fill="none" stroke="black" cx="5760" cy="-340.08" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="5760" y="-358.88" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5760" y="-343.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096], [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5760" y="-328.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5760" y="-313.88" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- MHA_AllGather1&#45;&gt;Residual_Add1 -->
<g id="edge71" class="edge">
<title>MHA_AllGather1&#45;&gt;Residual_Add1</title>
<path fill="none" stroke="black" d="M5753.28,-424.03C5753.21,-415.48 5753.26,-406.8 5753.42,-398.43"/>
<polygon fill="black" stroke="black" points="5756.92,-398.49 5753.68,-388.4 5749.92,-398.31 5756.92,-398.49"/>
</g>
<!-- Residual_Add1&#45;&gt;MHA_AllGather1 -->
<g id="edge70" class="edge">
<title>Residual_Add1&#45;&gt;MHA_AllGather1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5766.32,-388.4C5766.58,-396.53 5766.73,-405.17 5766.75,-413.85"/>
<polygon fill="black" stroke="black" points="5763.25,-414.02 5766.72,-424.03 5770.25,-414.04 5763.25,-414.02"/>
</g>
<!-- FFN_LayerNorm1 -->
<g id="node35" class="node">
<title>FFN_LayerNorm1</title>
<polygon fill="none" stroke="black" points="6008.5,-256 5511.5,-256 5511.5,-188 6008.5,-188 6008.5,-256"/>
<text text-anchor="middle" x="5760" y="-240.8" font-family="Times,serif" font-size="14.00">FFN LayerNorm 1</text>
<text text-anchor="middle" x="5760" y="-225.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5760" y="-210.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5760" y="-195.8" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Residual_Add1&#45;&gt;FFN_LayerNorm1 -->
<g id="edge72" class="edge">
<title>Residual_Add1&#45;&gt;FFN_LayerNorm1</title>
<path fill="none" stroke="black" d="M5760,-291.87C5760,-283.48 5760,-274.78 5760,-266.51"/>
<polygon fill="black" stroke="black" points="5763.5,-266.3 5760,-256.3 5756.5,-266.3 5763.5,-266.3"/>
</g>
<!-- FFN_Gate_Split1 -->
<g id="node36" class="node">
<title>FFN_Gate_Split1</title>
<polygon fill="none" stroke="black" points="5750.65,-152 4951.05,-152 4745.35,-16 5544.95,-16 5750.65,-152"/>
<text text-anchor="middle" x="5248" y="-102.8" font-family="Times,serif" font-size="14.00">Gate Split</text>
<text text-anchor="middle" x="5248" y="-87.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="5248" y="-72.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=2048]</text>
<text text-anchor="middle" x="5248" y="-57.8" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- FFN_LayerNorm1&#45;&gt;FFN_Gate_Split1 -->
<g id="edge73" class="edge">
<title>FFN_LayerNorm1&#45;&gt;FFN_Gate_Split1</title>
<path fill="none" stroke="black" d="M5635.73,-187.99C5597.55,-177.85 5554,-166.28 5510.21,-154.65"/>
<polygon fill="black" stroke="black" points="5510.83,-151.19 5500.27,-152.01 5509.03,-157.96 5510.83,-151.19"/>
</g>
<!-- FFN_Up_Split1 -->
<g id="node37" class="node">
<title>FFN_Up_Split1</title>
<polygon fill="none" stroke="black" points="6774.65,-152 5975.05,-152 5769.35,-16 6568.95,-16 6774.65,-152"/>
<text text-anchor="middle" x="6272" y="-102.8" font-family="Times,serif" font-size="14.00">Up Projection Split</text>
<text text-anchor="middle" x="6272" y="-87.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="6272" y="-72.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=2048]</text>
<text text-anchor="middle" x="6272" y="-57.8" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- FFN_LayerNorm1&#45;&gt;FFN_Up_Split1 -->
<g id="edge74" class="edge">
<title>FFN_LayerNorm1&#45;&gt;FFN_Up_Split1</title>
<path fill="none" stroke="black" d="M5884.27,-187.99C5922.45,-177.85 5966,-166.28 6009.79,-154.65"/>
<polygon fill="black" stroke="black" points="6010.97,-157.96 6019.73,-152.01 6009.17,-151.19 6010.97,-157.96"/>
</g>
<!-- FFN_Gate1_GPU0 -->
<g id="node38" class="node">
<title>FFN_Gate1_GPU0</title>
<polygon fill="none" stroke="black" points="19145,-1349.33 18669,-1349.33 18669,-1281.33 19145,-1281.33 19145,-1349.33"/>
<text text-anchor="middle" x="18907" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="18907" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="18907" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="18907" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- FFN_Gate1_GPU1 -->
<g id="node39" class="node">
<title>FFN_Gate1_GPU1</title>
<polygon fill="none" stroke="black" points="18651,-1349.33 18175,-1349.33 18175,-1281.33 18651,-1281.33 18651,-1349.33"/>
<text text-anchor="middle" x="18413" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="18413" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="18413" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="18413" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- FFN_Gate1_GPU2 -->
<g id="node40" class="node">
<title>FFN_Gate1_GPU2</title>
<polygon fill="none" stroke="black" points="18157,-1349.33 17681,-1349.33 17681,-1281.33 18157,-1281.33 18157,-1349.33"/>
<text text-anchor="middle" x="17919" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="17919" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="17919" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="17919" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- FFN_Gate1_GPU3 -->
<g id="node41" class="node">
<title>FFN_Gate1_GPU3</title>
<polygon fill="none" stroke="black" points="17663,-1349.33 17187,-1349.33 17187,-1281.33 17663,-1281.33 17663,-1349.33"/>
<text text-anchor="middle" x="17425" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="17425" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="17425" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="17425" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- FFN_Gate1_GPU4 -->
<g id="node42" class="node">
<title>FFN_Gate1_GPU4</title>
<polygon fill="none" stroke="black" points="17169,-1349.33 16693,-1349.33 16693,-1281.33 17169,-1281.33 17169,-1349.33"/>
<text text-anchor="middle" x="16931" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="16931" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="16931" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="16931" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- FFN_Gate1_GPU5 -->
<g id="node43" class="node">
<title>FFN_Gate1_GPU5</title>
<polygon fill="none" stroke="black" points="16675,-1349.33 16199,-1349.33 16199,-1281.33 16675,-1281.33 16675,-1349.33"/>
<text text-anchor="middle" x="16437" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="16437" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="16437" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="16437" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- FFN_Gate1_GPU6 -->
<g id="node44" class="node">
<title>FFN_Gate1_GPU6</title>
<polygon fill="none" stroke="black" points="16181,-1349.33 15705,-1349.33 15705,-1281.33 16181,-1281.33 16181,-1349.33"/>
<text text-anchor="middle" x="15943" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="15943" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="15943" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="15943" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- FFN_Gate1_GPU7 -->
<g id="node45" class="node">
<title>FFN_Gate1_GPU7</title>
<polygon fill="none" stroke="black" points="15687,-1349.33 15211,-1349.33 15211,-1281.33 15687,-1281.33 15687,-1349.33"/>
<text text-anchor="middle" x="15449" y="-1334.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="15449" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="15449" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="15449" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- FFN_Up1_GPU0 -->
<g id="node46" class="node">
<title>FFN_Up1_GPU0</title>
<polygon fill="none" stroke="black" points="15193,-1349.33 14717,-1349.33 14717,-1281.33 15193,-1281.33 15193,-1349.33"/>
<text text-anchor="middle" x="14955" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="14955" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="14955" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="14955" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- FFN_Up1_GPU1 -->
<g id="node47" class="node">
<title>FFN_Up1_GPU1</title>
<polygon fill="none" stroke="black" points="14699,-1349.33 14223,-1349.33 14223,-1281.33 14699,-1281.33 14699,-1349.33"/>
<text text-anchor="middle" x="14461" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="14461" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="14461" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="14461" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- FFN_Up1_GPU2 -->
<g id="node48" class="node">
<title>FFN_Up1_GPU2</title>
<polygon fill="none" stroke="black" points="14205,-1349.33 13729,-1349.33 13729,-1281.33 14205,-1281.33 14205,-1349.33"/>
<text text-anchor="middle" x="13967" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="13967" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="13967" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="13967" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- FFN_Up1_GPU3 -->
<g id="node49" class="node">
<title>FFN_Up1_GPU3</title>
<polygon fill="none" stroke="black" points="13711,-1349.33 13235,-1349.33 13235,-1281.33 13711,-1281.33 13711,-1349.33"/>
<text text-anchor="middle" x="13473" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="13473" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="13473" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="13473" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- FFN_Up1_GPU4 -->
<g id="node50" class="node">
<title>FFN_Up1_GPU4</title>
<polygon fill="none" stroke="black" points="13217,-1349.33 12741,-1349.33 12741,-1281.33 13217,-1281.33 13217,-1349.33"/>
<text text-anchor="middle" x="12979" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="12979" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="12979" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="12979" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- FFN_Up1_GPU5 -->
<g id="node51" class="node">
<title>FFN_Up1_GPU5</title>
<polygon fill="none" stroke="black" points="12723,-1349.33 12247,-1349.33 12247,-1281.33 12723,-1281.33 12723,-1349.33"/>
<text text-anchor="middle" x="12485" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="12485" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="12485" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="12485" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- FFN_Up1_GPU6 -->
<g id="node52" class="node">
<title>FFN_Up1_GPU6</title>
<polygon fill="none" stroke="black" points="12229,-1349.33 11753,-1349.33 11753,-1281.33 12229,-1281.33 12229,-1349.33"/>
<text text-anchor="middle" x="11991" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="11991" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="11991" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="11991" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- FFN_Up1_GPU7 -->
<g id="node53" class="node">
<title>FFN_Up1_GPU7</title>
<polygon fill="none" stroke="black" points="11735,-1349.33 11259,-1349.33 11259,-1281.33 11735,-1281.33 11735,-1349.33"/>
<text text-anchor="middle" x="11497" y="-1334.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="11497" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="11497" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="11497" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- FFN_GELU1_GPU0 -->
<g id="node54" class="node">
<title>FFN_GELU1_GPU0</title>
<polygon fill="none" stroke="black" points="11240.5,-1349.33 10773.5,-1349.33 10773.5,-1281.33 11240.5,-1281.33 11240.5,-1349.33"/>
<text text-anchor="middle" x="11007" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="11007" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="11007" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="11007" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- FFN_GELU1_GPU1 -->
<g id="node55" class="node">
<title>FFN_GELU1_GPU1</title>
<polygon fill="none" stroke="black" points="10755.5,-1349.33 10288.5,-1349.33 10288.5,-1281.33 10755.5,-1281.33 10755.5,-1349.33"/>
<text text-anchor="middle" x="10522" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="10522" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="10522" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="10522" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- FFN_GELU1_GPU2 -->
<g id="node56" class="node">
<title>FFN_GELU1_GPU2</title>
<polygon fill="none" stroke="black" points="10270.5,-1349.33 9803.5,-1349.33 9803.5,-1281.33 10270.5,-1281.33 10270.5,-1349.33"/>
<text text-anchor="middle" x="10037" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="10037" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="10037" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="10037" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- FFN_GELU1_GPU3 -->
<g id="node57" class="node">
<title>FFN_GELU1_GPU3</title>
<polygon fill="none" stroke="black" points="9785.5,-1349.33 9318.5,-1349.33 9318.5,-1281.33 9785.5,-1281.33 9785.5,-1349.33"/>
<text text-anchor="middle" x="9552" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="9552" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="9552" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="9552" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- FFN_GELU1_GPU4 -->
<g id="node58" class="node">
<title>FFN_GELU1_GPU4</title>
<polygon fill="none" stroke="black" points="9300.5,-1349.33 8833.5,-1349.33 8833.5,-1281.33 9300.5,-1281.33 9300.5,-1349.33"/>
<text text-anchor="middle" x="9067" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="9067" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="9067" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="9067" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- FFN_GELU1_GPU5 -->
<g id="node59" class="node">
<title>FFN_GELU1_GPU5</title>
<polygon fill="none" stroke="black" points="8815.5,-1349.33 8348.5,-1349.33 8348.5,-1281.33 8815.5,-1281.33 8815.5,-1349.33"/>
<text text-anchor="middle" x="8582" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="8582" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="8582" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="8582" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- FFN_GELU1_GPU6 -->
<g id="node60" class="node">
<title>FFN_GELU1_GPU6</title>
<polygon fill="none" stroke="black" points="8330.5,-1349.33 7863.5,-1349.33 7863.5,-1281.33 8330.5,-1281.33 8330.5,-1349.33"/>
<text text-anchor="middle" x="8097" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="8097" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="8097" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="8097" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- FFN_GELU1_GPU7 -->
<g id="node61" class="node">
<title>FFN_GELU1_GPU7</title>
<polygon fill="none" stroke="black" points="7845.5,-1349.33 7378.5,-1349.33 7378.5,-1281.33 7845.5,-1281.33 7845.5,-1349.33"/>
<text text-anchor="middle" x="7612" y="-1334.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="7612" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="7612" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="7612" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- FFN_Down1_GPU0 -->
<g id="node62" class="node">
<title>FFN_Down1_GPU0</title>
<polygon fill="none" stroke="black" points="7360,-1349.33 6872,-1349.33 6872,-1281.33 7360,-1281.33 7360,-1349.33"/>
<text text-anchor="middle" x="7116" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="7116" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="7116" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="7116" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- FFN_Down1_GPU1 -->
<g id="node63" class="node">
<title>FFN_Down1_GPU1</title>
<polygon fill="none" stroke="black" points="6854,-1349.33 6366,-1349.33 6366,-1281.33 6854,-1281.33 6854,-1349.33"/>
<text text-anchor="middle" x="6610" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="6610" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="6610" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="6610" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- FFN_Down1_GPU2 -->
<g id="node64" class="node">
<title>FFN_Down1_GPU2</title>
<polygon fill="none" stroke="black" points="6348,-1349.33 5860,-1349.33 5860,-1281.33 6348,-1281.33 6348,-1349.33"/>
<text text-anchor="middle" x="6104" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="6104" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="6104" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="6104" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- FFN_Down1_GPU3 -->
<g id="node65" class="node">
<title>FFN_Down1_GPU3</title>
<polygon fill="none" stroke="black" points="5842,-1349.33 5354,-1349.33 5354,-1281.33 5842,-1281.33 5842,-1349.33"/>
<text text-anchor="middle" x="5598" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="5598" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="5598" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5598" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- FFN_Down1_GPU4 -->
<g id="node66" class="node">
<title>FFN_Down1_GPU4</title>
<polygon fill="none" stroke="black" points="5336,-1349.33 4848,-1349.33 4848,-1281.33 5336,-1281.33 5336,-1349.33"/>
<text text-anchor="middle" x="5092" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="5092" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="5092" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="5092" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- FFN_Down1_GPU5 -->
<g id="node67" class="node">
<title>FFN_Down1_GPU5</title>
<polygon fill="none" stroke="black" points="4830,-1349.33 4342,-1349.33 4342,-1281.33 4830,-1281.33 4830,-1349.33"/>
<text text-anchor="middle" x="4586" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="4586" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="4586" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="4586" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- FFN_Down1_GPU6 -->
<g id="node68" class="node">
<title>FFN_Down1_GPU6</title>
<polygon fill="none" stroke="black" points="4324,-1349.33 3836,-1349.33 3836,-1281.33 4324,-1281.33 4324,-1349.33"/>
<text text-anchor="middle" x="4080" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="4080" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="4080" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="4080" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- FFN_Down1_GPU7 -->
<g id="node69" class="node">
<title>FFN_Down1_GPU7</title>
<polygon fill="none" stroke="black" points="3818,-1349.33 3330,-1349.33 3330,-1281.33 3818,-1281.33 3818,-1349.33"/>
<text text-anchor="middle" x="3574" y="-1334.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="3574" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="3574" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="3574" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- FFN_AllReduce1 -->
<g id="node70" class="node">
<title>FFN_AllReduce1</title>
<polygon fill="none" stroke="black" points="3312.03,-1383.33 2492.73,-1383.33 2281.97,-1247.33 3101.27,-1247.33 3312.03,-1383.33"/>
<text text-anchor="middle" x="2797" y="-1334.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2797" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="2797" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="2797" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Residual_Add2 -->
<g id="node71" class="node">
<title>Residual_Add2</title>
<ellipse fill="none" stroke="black" cx="19809" cy="-1315.33" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="19809" y="-1334.13" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="19809" y="-1319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096], [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="19809" y="-1304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="19809" y="-1289.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Pipeline_Comm1 -->
<g id="node72" class="node">
<title>Pipeline_Comm1</title>
<ellipse fill="none" stroke="black" cx="40469" cy="-1143.33" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="40469" y="-1162.13" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="40469" y="-1147.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="40469" y="-1132.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="40469" y="-1117.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7  GPUs 8&#45;15</text>
</g>
<!-- Residual_Add2&#45;&gt;Pipeline_Comm1 -->
<g id="edge75" class="edge">
<title>Residual_Add2&#45;&gt;Pipeline_Comm1</title>
<path fill="none" stroke="black" d="M20449.97,-1309.06C23631.72,-1282.88 37673.14,-1167.34 40108.41,-1147.3"/>
<polygon fill="black" stroke="black" points="40108.64,-1150.8 40118.61,-1147.22 40108.58,-1143.8 40108.64,-1150.8"/>
</g>
<!-- LayerNorm2 -->
<g id="node73" class="node">
<title>LayerNorm2</title>
<polygon fill="none" stroke="black" points="60365.5,-1002.33 59868.5,-1002.33 59868.5,-934.33 60365.5,-934.33 60365.5,-1002.33"/>
<text text-anchor="middle" x="60117" y="-987.13" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="60117" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="60117" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="60117" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- Pipeline_Comm1&#45;&gt;LayerNorm2 -->
<g id="edge76" class="edge">
<title>Pipeline_Comm1&#45;&gt;LayerNorm2</title>
<path fill="none" stroke="black" d="M40820.52,-1141.83C43423.98,-1138.02 59615.51,-1112.51 59859,-1067.33 59922.42,-1055.57 59990.49,-1029.08 60040.77,-1006.6"/>
<polygon fill="black" stroke="black" points="60042.28,-1009.76 60049.95,-1002.45 60039.4,-1003.38 60042.28,-1009.76"/>
</g>
<!-- MHA_Query_Split2 -->
<g id="node74" class="node">
<title>MHA_Query_Split2</title>
<polygon fill="none" stroke="black" points="59850.33,-1036.33 59024.19,-1036.33 58811.67,-900.33 59637.81,-900.33 59850.33,-1036.33"/>
<text text-anchor="middle" x="59331" y="-987.13" font-family="Times,serif" font-size="14.00">Query Split</text>
<text text-anchor="middle" x="59331" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="59331" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="59331" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- MHA_Key_Split2 -->
<g id="node75" class="node">
<title>MHA_Key_Split2</title>
<polygon fill="none" stroke="black" points="58793.33,-1036.33 57967.19,-1036.33 57754.67,-900.33 58580.81,-900.33 58793.33,-1036.33"/>
<text text-anchor="middle" x="58274" y="-987.13" font-family="Times,serif" font-size="14.00">Key Split</text>
<text text-anchor="middle" x="58274" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="58274" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="58274" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- MHA_Value_Split2 -->
<g id="node76" class="node">
<title>MHA_Value_Split2</title>
<polygon fill="none" stroke="black" points="57736.33,-1036.33 56910.19,-1036.33 56697.67,-900.33 57523.81,-900.33 57736.33,-1036.33"/>
<text text-anchor="middle" x="57217" y="-987.13" font-family="Times,serif" font-size="14.00">Value Split</text>
<text text-anchor="middle" x="57217" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="57217" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="57217" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- MHA_Attention2_GPU8 -->
<g id="node77" class="node">
<title>MHA_Attention2_GPU8</title>
<polygon fill="none" stroke="black" points="56679.5,-1002.33 55696.5,-1002.33 55696.5,-934.33 56679.5,-934.33 56679.5,-1002.33"/>
<text text-anchor="middle" x="56188" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="56188" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="56188" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="56188" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- MHA_Attention2_GPU9 -->
<g id="node78" class="node">
<title>MHA_Attention2_GPU9</title>
<polygon fill="none" stroke="black" points="55678.5,-1002.33 54695.5,-1002.33 54695.5,-934.33 55678.5,-934.33 55678.5,-1002.33"/>
<text text-anchor="middle" x="55187" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="55187" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="55187" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="55187" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- MHA_Attention2_GPU10 -->
<g id="node79" class="node">
<title>MHA_Attention2_GPU10</title>
<polygon fill="none" stroke="black" points="54677.5,-1002.33 53694.5,-1002.33 53694.5,-934.33 54677.5,-934.33 54677.5,-1002.33"/>
<text text-anchor="middle" x="54186" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="54186" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="54186" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="54186" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- MHA_Attention2_GPU11 -->
<g id="node80" class="node">
<title>MHA_Attention2_GPU11</title>
<polygon fill="none" stroke="black" points="53676.5,-1002.33 52693.5,-1002.33 52693.5,-934.33 53676.5,-934.33 53676.5,-1002.33"/>
<text text-anchor="middle" x="53185" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="53185" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="53185" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="53185" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- MHA_Attention2_GPU12 -->
<g id="node81" class="node">
<title>MHA_Attention2_GPU12</title>
<polygon fill="none" stroke="black" points="52675.5,-1002.33 51692.5,-1002.33 51692.5,-934.33 52675.5,-934.33 52675.5,-1002.33"/>
<text text-anchor="middle" x="52184" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="52184" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="52184" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="52184" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- MHA_Attention2_GPU13 -->
<g id="node82" class="node">
<title>MHA_Attention2_GPU13</title>
<polygon fill="none" stroke="black" points="51674.5,-1002.33 50691.5,-1002.33 50691.5,-934.33 51674.5,-934.33 51674.5,-1002.33"/>
<text text-anchor="middle" x="51183" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="51183" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="51183" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="51183" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- MHA_Attention2_GPU14 -->
<g id="node83" class="node">
<title>MHA_Attention2_GPU14</title>
<polygon fill="none" stroke="black" points="50673.5,-1002.33 49690.5,-1002.33 49690.5,-934.33 50673.5,-934.33 50673.5,-1002.33"/>
<text text-anchor="middle" x="50182" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="50182" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="50182" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="50182" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- MHA_Attention2_GPU15 -->
<g id="node84" class="node">
<title>MHA_Attention2_GPU15</title>
<polygon fill="none" stroke="black" points="49672.5,-1002.33 48689.5,-1002.33 48689.5,-934.33 49672.5,-934.33 49672.5,-1002.33"/>
<text text-anchor="middle" x="49181" y="-987.13" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="49181" y="-972.13" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="49181" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="49181" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- MHA_Concat2 -->
<g id="node85" class="node">
<title>MHA_Concat2</title>
<polygon fill="none" stroke="black" points="48671.03,-1036.33 47851.73,-1036.33 47640.97,-900.33 48460.27,-900.33 48671.03,-1036.33"/>
<text text-anchor="middle" x="48156" y="-987.13" font-family="Times,serif" font-size="14.00">Attention Concat</text>
<text text-anchor="middle" x="48156" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, heads=4, d_k=128]</text>
<text text-anchor="middle" x="48156" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="48156" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- MHA_Projection2_GPU8 -->
<g id="node86" class="node">
<title>MHA_Projection2_GPU8</title>
<polygon fill="none" stroke="black" points="47623,-1002.33 47135,-1002.33 47135,-934.33 47623,-934.33 47623,-1002.33"/>
<text text-anchor="middle" x="47379" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="47379" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="47379" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="47379" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- MHA_Projection2_GPU9 -->
<g id="node87" class="node">
<title>MHA_Projection2_GPU9</title>
<polygon fill="none" stroke="black" points="47117,-1002.33 46629,-1002.33 46629,-934.33 47117,-934.33 47117,-1002.33"/>
<text text-anchor="middle" x="46873" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="46873" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="46873" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="46873" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- MHA_Projection2_GPU10 -->
<g id="node88" class="node">
<title>MHA_Projection2_GPU10</title>
<polygon fill="none" stroke="black" points="46611,-1002.33 46123,-1002.33 46123,-934.33 46611,-934.33 46611,-1002.33"/>
<text text-anchor="middle" x="46367" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="46367" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="46367" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="46367" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- MHA_Projection2_GPU11 -->
<g id="node89" class="node">
<title>MHA_Projection2_GPU11</title>
<polygon fill="none" stroke="black" points="46105,-1002.33 45617,-1002.33 45617,-934.33 46105,-934.33 46105,-1002.33"/>
<text text-anchor="middle" x="45861" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="45861" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="45861" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="45861" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- MHA_Projection2_GPU12 -->
<g id="node90" class="node">
<title>MHA_Projection2_GPU12</title>
<polygon fill="none" stroke="black" points="45599,-1002.33 45111,-1002.33 45111,-934.33 45599,-934.33 45599,-1002.33"/>
<text text-anchor="middle" x="45355" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="45355" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="45355" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="45355" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- MHA_Projection2_GPU13 -->
<g id="node91" class="node">
<title>MHA_Projection2_GPU13</title>
<polygon fill="none" stroke="black" points="45093,-1002.33 44605,-1002.33 44605,-934.33 45093,-934.33 45093,-1002.33"/>
<text text-anchor="middle" x="44849" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="44849" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="44849" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="44849" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- MHA_Projection2_GPU14 -->
<g id="node92" class="node">
<title>MHA_Projection2_GPU14</title>
<polygon fill="none" stroke="black" points="44587,-1002.33 44099,-1002.33 44099,-934.33 44587,-934.33 44587,-1002.33"/>
<text text-anchor="middle" x="44343" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="44343" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="44343" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="44343" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- MHA_Projection2_GPU15 -->
<g id="node93" class="node">
<title>MHA_Projection2_GPU15</title>
<polygon fill="none" stroke="black" points="44081,-1002.33 43593,-1002.33 43593,-934.33 44081,-934.33 44081,-1002.33"/>
<text text-anchor="middle" x="43837" y="-987.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="43837" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="43837" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="43837" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- MHA_AllGather2 -->
<g id="node94" class="node">
<title>MHA_AllGather2</title>
<polygon fill="none" stroke="black" points="43575.03,-1036.33 42755.73,-1036.33 42544.97,-900.33 43364.27,-900.33 43575.03,-1036.33"/>
<text text-anchor="middle" x="43060" y="-987.13" font-family="Times,serif" font-size="14.00">Projection All&#45;Gather</text>
<text text-anchor="middle" x="43060" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="43060" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="43060" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- Residual_Add3 -->
<g id="node95" class="node">
<title>Residual_Add3</title>
<ellipse fill="none" stroke="black" cx="41880" cy="-968.33" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="41880" y="-987.13" font-family="Times,serif" font-size="14.00">Residual Add 3</text>
<text text-anchor="middle" x="41880" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096], [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="41880" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="41880" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- FFN_LayerNorm2 -->
<g id="node96" class="node">
<title>FFN_LayerNorm2</title>
<polygon fill="none" stroke="black" points="41215.5,-1002.33 40718.5,-1002.33 40718.5,-934.33 41215.5,-934.33 41215.5,-1002.33"/>
<text text-anchor="middle" x="40967" y="-987.13" font-family="Times,serif" font-size="14.00">FFN LayerNorm 2</text>
<text text-anchor="middle" x="40967" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="40967" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="40967" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- FFN_Gate_Split2 -->
<g id="node97" class="node">
<title>FFN_Gate_Split2</title>
<polygon fill="none" stroke="black" points="40700.65,-1036.33 39901.05,-1036.33 39695.35,-900.33 40494.95,-900.33 40700.65,-1036.33"/>
<text text-anchor="middle" x="40198" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Split</text>
<text text-anchor="middle" x="40198" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="40198" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=2048]</text>
<text text-anchor="middle" x="40198" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- FFN_Up_Split2 -->
<g id="node98" class="node">
<title>FFN_Up_Split2</title>
<polygon fill="none" stroke="black" points="39676.65,-1036.33 38877.05,-1036.33 38671.35,-900.33 39470.95,-900.33 39676.65,-1036.33"/>
<text text-anchor="middle" x="39174" y="-987.13" font-family="Times,serif" font-size="14.00">Up Projection Split</text>
<text text-anchor="middle" x="39174" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="39174" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=2048]</text>
<text text-anchor="middle" x="39174" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- FFN_Gate2_GPU8 -->
<g id="node99" class="node">
<title>FFN_Gate2_GPU8</title>
<polygon fill="none" stroke="black" points="38653,-1002.33 38177,-1002.33 38177,-934.33 38653,-934.33 38653,-1002.33"/>
<text text-anchor="middle" x="38415" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="38415" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="38415" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="38415" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- FFN_Gate2_GPU9 -->
<g id="node100" class="node">
<title>FFN_Gate2_GPU9</title>
<polygon fill="none" stroke="black" points="38159,-1002.33 37683,-1002.33 37683,-934.33 38159,-934.33 38159,-1002.33"/>
<text text-anchor="middle" x="37921" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="37921" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="37921" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="37921" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- FFN_Gate2_GPU10 -->
<g id="node101" class="node">
<title>FFN_Gate2_GPU10</title>
<polygon fill="none" stroke="black" points="37665,-1002.33 37189,-1002.33 37189,-934.33 37665,-934.33 37665,-1002.33"/>
<text text-anchor="middle" x="37427" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="37427" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="37427" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="37427" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- FFN_Gate2_GPU11 -->
<g id="node102" class="node">
<title>FFN_Gate2_GPU11</title>
<polygon fill="none" stroke="black" points="37171,-1002.33 36695,-1002.33 36695,-934.33 37171,-934.33 37171,-1002.33"/>
<text text-anchor="middle" x="36933" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="36933" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="36933" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="36933" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- FFN_Gate2_GPU12 -->
<g id="node103" class="node">
<title>FFN_Gate2_GPU12</title>
<polygon fill="none" stroke="black" points="36677,-1002.33 36201,-1002.33 36201,-934.33 36677,-934.33 36677,-1002.33"/>
<text text-anchor="middle" x="36439" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="36439" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="36439" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="36439" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- FFN_Gate2_GPU13 -->
<g id="node104" class="node">
<title>FFN_Gate2_GPU13</title>
<polygon fill="none" stroke="black" points="36183,-1002.33 35707,-1002.33 35707,-934.33 36183,-934.33 36183,-1002.33"/>
<text text-anchor="middle" x="35945" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="35945" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="35945" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="35945" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- FFN_Gate2_GPU14 -->
<g id="node105" class="node">
<title>FFN_Gate2_GPU14</title>
<polygon fill="none" stroke="black" points="35689,-1002.33 35213,-1002.33 35213,-934.33 35689,-934.33 35689,-1002.33"/>
<text text-anchor="middle" x="35451" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="35451" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="35451" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="35451" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- FFN_Gate2_GPU15 -->
<g id="node106" class="node">
<title>FFN_Gate2_GPU15</title>
<polygon fill="none" stroke="black" points="35195,-1002.33 34719,-1002.33 34719,-934.33 35195,-934.33 35195,-1002.33"/>
<text text-anchor="middle" x="34957" y="-987.13" font-family="Times,serif" font-size="14.00">Gate Linear</text>
<text text-anchor="middle" x="34957" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="34957" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="34957" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- FFN_Up2_GPU8 -->
<g id="node107" class="node">
<title>FFN_Up2_GPU8</title>
<polygon fill="none" stroke="black" points="34701,-1002.33 34225,-1002.33 34225,-934.33 34701,-934.33 34701,-1002.33"/>
<text text-anchor="middle" x="34463" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="34463" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="34463" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="34463" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- FFN_Up2_GPU9 -->
<g id="node108" class="node">
<title>FFN_Up2_GPU9</title>
<polygon fill="none" stroke="black" points="34207,-1002.33 33731,-1002.33 33731,-934.33 34207,-934.33 34207,-1002.33"/>
<text text-anchor="middle" x="33969" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="33969" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="33969" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="33969" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- FFN_Up2_GPU10 -->
<g id="node109" class="node">
<title>FFN_Up2_GPU10</title>
<polygon fill="none" stroke="black" points="33713,-1002.33 33237,-1002.33 33237,-934.33 33713,-934.33 33713,-1002.33"/>
<text text-anchor="middle" x="33475" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="33475" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="33475" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="33475" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- FFN_Up2_GPU11 -->
<g id="node110" class="node">
<title>FFN_Up2_GPU11</title>
<polygon fill="none" stroke="black" points="33219,-1002.33 32743,-1002.33 32743,-934.33 33219,-934.33 33219,-1002.33"/>
<text text-anchor="middle" x="32981" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="32981" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="32981" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="32981" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- FFN_Up2_GPU12 -->
<g id="node111" class="node">
<title>FFN_Up2_GPU12</title>
<polygon fill="none" stroke="black" points="32725,-1002.33 32249,-1002.33 32249,-934.33 32725,-934.33 32725,-1002.33"/>
<text text-anchor="middle" x="32487" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="32487" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="32487" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="32487" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- FFN_Up2_GPU13 -->
<g id="node112" class="node">
<title>FFN_Up2_GPU13</title>
<polygon fill="none" stroke="black" points="32231,-1002.33 31755,-1002.33 31755,-934.33 32231,-934.33 32231,-1002.33"/>
<text text-anchor="middle" x="31993" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="31993" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="31993" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="31993" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- FFN_Up2_GPU14 -->
<g id="node113" class="node">
<title>FFN_Up2_GPU14</title>
<polygon fill="none" stroke="black" points="31737,-1002.33 31261,-1002.33 31261,-934.33 31737,-934.33 31737,-1002.33"/>
<text text-anchor="middle" x="31499" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="31499" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="31499" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="31499" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- FFN_Up2_GPU15 -->
<g id="node114" class="node">
<title>FFN_Up2_GPU15</title>
<polygon fill="none" stroke="black" points="31243,-1002.33 30767,-1002.33 30767,-934.33 31243,-934.33 31243,-1002.33"/>
<text text-anchor="middle" x="31005" y="-987.13" font-family="Times,serif" font-size="14.00">Up Linear</text>
<text text-anchor="middle" x="31005" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="31005" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="31005" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- FFN_GELU2_GPU8 -->
<g id="node115" class="node">
<title>FFN_GELU2_GPU8</title>
<polygon fill="none" stroke="black" points="30748.5,-1002.33 30281.5,-1002.33 30281.5,-934.33 30748.5,-934.33 30748.5,-1002.33"/>
<text text-anchor="middle" x="30515" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="30515" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="30515" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="30515" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- FFN_GELU2_GPU9 -->
<g id="node116" class="node">
<title>FFN_GELU2_GPU9</title>
<polygon fill="none" stroke="black" points="30263.5,-1002.33 29796.5,-1002.33 29796.5,-934.33 30263.5,-934.33 30263.5,-1002.33"/>
<text text-anchor="middle" x="30030" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="30030" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="30030" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="30030" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- FFN_GELU2_GPU10 -->
<g id="node117" class="node">
<title>FFN_GELU2_GPU10</title>
<polygon fill="none" stroke="black" points="29778.5,-1002.33 29311.5,-1002.33 29311.5,-934.33 29778.5,-934.33 29778.5,-1002.33"/>
<text text-anchor="middle" x="29545" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="29545" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="29545" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="29545" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- FFN_GELU2_GPU11 -->
<g id="node118" class="node">
<title>FFN_GELU2_GPU11</title>
<polygon fill="none" stroke="black" points="29293.5,-1002.33 28826.5,-1002.33 28826.5,-934.33 29293.5,-934.33 29293.5,-1002.33"/>
<text text-anchor="middle" x="29060" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="29060" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="29060" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="29060" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- FFN_GELU2_GPU12 -->
<g id="node119" class="node">
<title>FFN_GELU2_GPU12</title>
<polygon fill="none" stroke="black" points="28808.5,-1002.33 28341.5,-1002.33 28341.5,-934.33 28808.5,-934.33 28808.5,-1002.33"/>
<text text-anchor="middle" x="28575" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="28575" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="28575" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="28575" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- FFN_GELU2_GPU13 -->
<g id="node120" class="node">
<title>FFN_GELU2_GPU13</title>
<polygon fill="none" stroke="black" points="28323.5,-1002.33 27856.5,-1002.33 27856.5,-934.33 28323.5,-934.33 28323.5,-1002.33"/>
<text text-anchor="middle" x="28090" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="28090" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="28090" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="28090" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- FFN_GELU2_GPU14 -->
<g id="node121" class="node">
<title>FFN_GELU2_GPU14</title>
<polygon fill="none" stroke="black" points="27838.5,-1002.33 27371.5,-1002.33 27371.5,-934.33 27838.5,-934.33 27838.5,-1002.33"/>
<text text-anchor="middle" x="27605" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="27605" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="27605" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="27605" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- FFN_GELU2_GPU15 -->
<g id="node122" class="node">
<title>FFN_GELU2_GPU15</title>
<polygon fill="none" stroke="black" points="27353.5,-1002.33 26886.5,-1002.33 26886.5,-934.33 27353.5,-934.33 27353.5,-1002.33"/>
<text text-anchor="middle" x="27120" y="-987.13" font-family="Times,serif" font-size="14.00">GELU + Multiply</text>
<text text-anchor="middle" x="27120" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="27120" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="27120" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- FFN_Down2_GPU8 -->
<g id="node123" class="node">
<title>FFN_Down2_GPU8</title>
<polygon fill="none" stroke="black" points="26868,-1002.33 26380,-1002.33 26380,-934.33 26868,-934.33 26868,-1002.33"/>
<text text-anchor="middle" x="26624" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="26624" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="26624" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="26624" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- FFN_Down2_GPU9 -->
<g id="node124" class="node">
<title>FFN_Down2_GPU9</title>
<polygon fill="none" stroke="black" points="26362,-1002.33 25874,-1002.33 25874,-934.33 26362,-934.33 26362,-1002.33"/>
<text text-anchor="middle" x="26118" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="26118" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="26118" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="26118" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- FFN_Down2_GPU10 -->
<g id="node125" class="node">
<title>FFN_Down2_GPU10</title>
<polygon fill="none" stroke="black" points="25856,-1002.33 25368,-1002.33 25368,-934.33 25856,-934.33 25856,-1002.33"/>
<text text-anchor="middle" x="25612" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="25612" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="25612" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="25612" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- FFN_Down2_GPU11 -->
<g id="node126" class="node">
<title>FFN_Down2_GPU11</title>
<polygon fill="none" stroke="black" points="25350,-1002.33 24862,-1002.33 24862,-934.33 25350,-934.33 25350,-1002.33"/>
<text text-anchor="middle" x="25106" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="25106" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="25106" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="25106" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- FFN_Down2_GPU12 -->
<g id="node127" class="node">
<title>FFN_Down2_GPU12</title>
<polygon fill="none" stroke="black" points="24844,-1002.33 24356,-1002.33 24356,-934.33 24844,-934.33 24844,-1002.33"/>
<text text-anchor="middle" x="24600" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="24600" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="24600" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="24600" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- FFN_Down2_GPU13 -->
<g id="node128" class="node">
<title>FFN_Down2_GPU13</title>
<polygon fill="none" stroke="black" points="24338,-1002.33 23850,-1002.33 23850,-934.33 24338,-934.33 24338,-1002.33"/>
<text text-anchor="middle" x="24094" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="24094" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="24094" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="24094" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- FFN_Down2_GPU14 -->
<g id="node129" class="node">
<title>FFN_Down2_GPU14</title>
<polygon fill="none" stroke="black" points="23832,-1002.33 23344,-1002.33 23344,-934.33 23832,-934.33 23832,-1002.33"/>
<text text-anchor="middle" x="23588" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="23588" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="23588" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="23588" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- FFN_Down2_GPU15 -->
<g id="node130" class="node">
<title>FFN_Down2_GPU15</title>
<polygon fill="none" stroke="black" points="23326,-1002.33 22838,-1002.33 22838,-934.33 23326,-934.33 23326,-1002.33"/>
<text text-anchor="middle" x="23082" y="-987.13" font-family="Times,serif" font-size="14.00">Down Linear</text>
<text text-anchor="middle" x="23082" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, ffn_dim=1024]</text>
<text text-anchor="middle" x="23082" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="23082" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- FFN_AllReduce2 -->
<g id="node131" class="node">
<title>FFN_AllReduce2</title>
<polygon fill="none" stroke="black" points="22820.03,-1036.33 22000.73,-1036.33 21789.97,-900.33 22609.27,-900.33 22820.03,-1036.33"/>
<text text-anchor="middle" x="22305" y="-987.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="22305" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=512]</text>
<text text-anchor="middle" x="22305" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="22305" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- Residual_Add4 -->
<g id="node132" class="node">
<title>Residual_Add4</title>
<ellipse fill="none" stroke="black" cx="21125" cy="-968.33" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="21125" y="-987.13" font-family="Times,serif" font-size="14.00">Residual Add 4</text>
<text text-anchor="middle" x="21125" y="-972.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096], [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="21125" y="-957.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="21125" y="-942.13" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- Output_LayerNorm -->
<g id="node133" class="node">
<title>Output_LayerNorm</title>
<polygon fill="none" stroke="black" points="21373.5,-830.33 20876.5,-830.33 20876.5,-762.33 21373.5,-762.33 21373.5,-830.33"/>
<text text-anchor="middle" x="21125" y="-815.13" font-family="Times,serif" font-size="14.00">Output LayerNorm</text>
<text text-anchor="middle" x="21125" y="-800.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="21125" y="-785.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="21125" y="-770.13" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- Residual_Add4&#45;&gt;Output_LayerNorm -->
<g id="edge77" class="edge">
<title>Residual_Add4&#45;&gt;Output_LayerNorm</title>
<path fill="none" stroke="black" d="M21125,-919.98C21125,-895.16 21125,-864.98 21125,-840.76"/>
<polygon fill="black" stroke="black" points="21128.5,-840.44 21125,-830.44 21121.5,-840.44 21128.5,-840.44"/>
</g>
<!-- Output -->
<g id="node134" class="node">
<title>Output</title>
<ellipse fill="none" stroke="black" cx="21125" cy="-644.25" rx="342.89" ry="48.17"/>
<text text-anchor="middle" x="21125" y="-663.05" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="21125" y="-648.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=VARIABLE, hidden_dim=4096]</text>
<text text-anchor="middle" x="21125" y="-633.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=VARIABLE, vocab_size]</text>
<text text-anchor="middle" x="21125" y="-618.05" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- Output_LayerNorm&#45;&gt;Output -->
<g id="edge78" class="edge">
<title>Output_LayerNorm&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M21125,-762.02C21125,-744.52 21125,-722.56 21125,-702.43"/>
<polygon fill="black" stroke="black" points="21128.5,-702.41 21125,-692.41 21121.5,-702.41 21128.5,-702.41"/>
</g>
</g>
</svg>
