<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_no_attention_pool Pages: 1 -->
<svg width="12126pt" height="1198pt"
 viewBox="0.00 0.00 12126.00 1197.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1193.7)">
<title>fa_pool_no_attention_pool</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1193.7 12122,-1193.7 12122,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_base_only</title>
<polygon fill="none" stroke="black" points="8,-595.17 8,-1046.17 12110,-1046.17 12110,-595.17 8,-595.17"/>
<text text-anchor="middle" x="6059" y="-1030.97" font-family="Times,serif" font-size="14.00">Base Layer Only &#45; 8 GPUs (No Pool Activated)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layers</title>
<polygon fill="none" stroke="black" points="10119,-228.17 10119,-587.17 10366,-587.17 10366,-228.17 10119,-228.17"/>
<text text-anchor="middle" x="10242.5" y="-571.97" font-family="Times,serif" font-size="14.00">4&#45;Layer Transformer Processing</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="none" stroke="black" cx="10242" cy="-1121.94" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="10242" y="-1140.74" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="10242" y="-1125.74" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-1110.74" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-1095.74" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- Embedding_GPU0 -->
<g id="node2" class="node">
<title>Embedding_GPU0</title>
<polygon fill="none" stroke="black" points="12101.5,-981.17 11652.5,-981.17 11652.5,-913.17 12101.5,-913.17 12101.5,-981.17"/>
<text text-anchor="middle" x="11877" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="11877" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="11877" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="11877" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU0 -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Embedding_GPU0</title>
<path fill="none" stroke="black" d="M10410.03,-1080.77C10462.54,-1069.97 10520.89,-1059.74 10575,-1054.17 10634.08,-1048.08 11585.83,-1058.13 11644,-1046.17 11701.51,-1034.34 11762.54,-1008.11 11807.71,-985.76"/>
<polygon fill="black" stroke="black" points="11809.44,-988.81 11816.81,-981.2 11806.3,-982.55 11809.44,-988.81"/>
</g>
<!-- Embedding_GPU1 -->
<g id="node3" class="node">
<title>Embedding_GPU1</title>
<polygon fill="none" stroke="black" points="11634.5,-981.17 11185.5,-981.17 11185.5,-913.17 11634.5,-913.17 11634.5,-981.17"/>
<text text-anchor="middle" x="11410" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="11410" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="11410" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="11410" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU1 -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;Embedding_GPU1</title>
<path fill="none" stroke="black" d="M10410.9,-1080.79C10463.19,-1070.06 10521.2,-1059.87 10575,-1054.17 10641.52,-1047.12 11111.52,-1059.83 11177,-1046.17 11234.27,-1034.22 11295.08,-1008.14 11340.21,-985.88"/>
<polygon fill="black" stroke="black" points="11341.92,-988.94 11349.31,-981.34 11338.8,-982.68 11341.92,-988.94"/>
</g>
<!-- Embedding_GPU2 -->
<g id="node4" class="node">
<title>Embedding_GPU2</title>
<polygon fill="none" stroke="black" points="11167.5,-981.17 10718.5,-981.17 10718.5,-913.17 11167.5,-913.17 11167.5,-981.17"/>
<text text-anchor="middle" x="10943" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="10943" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="10943" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10943" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU2 -->
<g id="edge3" class="edge">
<title>Input&#45;&gt;Embedding_GPU2</title>
<path fill="none" stroke="black" d="M10415.8,-1081.35C10466.85,-1071.01 10522.96,-1060.89 10575,-1054.17 10634.61,-1046.46 10651.46,-1059.79 10710,-1046.17 10766.38,-1033.04 10826.52,-1007.43 10871.58,-985.67"/>
<polygon fill="black" stroke="black" points="10873.22,-988.77 10880.67,-981.24 10870.15,-982.48 10873.22,-988.77"/>
</g>
<!-- Embedding_GPU3 -->
<g id="node5" class="node">
<title>Embedding_GPU3</title>
<polygon fill="none" stroke="black" points="10700.5,-981.17 10251.5,-981.17 10251.5,-913.17 10700.5,-913.17 10700.5,-981.17"/>
<text text-anchor="middle" x="10476" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="10476" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="10476" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10476" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU3 -->
<g id="edge4" class="edge">
<title>Input&#45;&gt;Embedding_GPU3</title>
<path fill="none" stroke="black" d="M10304.71,-1074.64C10341.68,-1047.34 10387.95,-1013.18 10423.07,-987.24"/>
<polygon fill="black" stroke="black" points="10425.33,-989.93 10431.3,-981.17 10421.17,-984.3 10425.33,-989.93"/>
</g>
<!-- Embedding_GPU4 -->
<g id="node6" class="node">
<title>Embedding_GPU4</title>
<polygon fill="none" stroke="black" points="10233.5,-981.17 9784.5,-981.17 9784.5,-913.17 10233.5,-913.17 10233.5,-981.17"/>
<text text-anchor="middle" x="10009" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="10009" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="10009" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10009" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU4 -->
<g id="edge5" class="edge">
<title>Input&#45;&gt;Embedding_GPU4</title>
<path fill="none" stroke="black" d="M10179.56,-1074.64C10142.75,-1047.34 10096.68,-1013.18 10061.7,-987.24"/>
<polygon fill="black" stroke="black" points="10063.63,-984.32 10053.51,-981.17 10059.46,-989.94 10063.63,-984.32"/>
</g>
<!-- Embedding_GPU5 -->
<g id="node7" class="node">
<title>Embedding_GPU5</title>
<polygon fill="none" stroke="black" points="9766.5,-981.17 9317.5,-981.17 9317.5,-913.17 9766.5,-913.17 9766.5,-981.17"/>
<text text-anchor="middle" x="9542" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="9542" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="9542" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="9542" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU5 -->
<g id="edge6" class="edge">
<title>Input&#45;&gt;Embedding_GPU5</title>
<path fill="none" stroke="black" d="M9989.9,-1091.67C9919.89,-1080.53 9844.35,-1065.66 9776,-1046.17 9721.71,-1030.68 9663.13,-1006.14 9618.16,-985.49"/>
<polygon fill="black" stroke="black" points="9619.61,-982.3 9609.07,-981.28 9616.67,-988.65 9619.61,-982.3"/>
</g>
<!-- Embedding_GPU6 -->
<g id="node8" class="node">
<title>Embedding_GPU6</title>
<polygon fill="none" stroke="black" points="9299.5,-981.17 8850.5,-981.17 8850.5,-913.17 9299.5,-913.17 9299.5,-981.17"/>
<text text-anchor="middle" x="9075" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="9075" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="9075" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="9075" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU6 -->
<g id="edge7" class="edge">
<title>Input&#45;&gt;Embedding_GPU6</title>
<path fill="none" stroke="black" d="M9934.49,-1106.75C9709.32,-1094.39 9423.83,-1074.06 9309,-1046.17 9252.94,-1032.55 9192.99,-1007.21 9147.81,-985.71"/>
<polygon fill="black" stroke="black" points="9149.22,-982.51 9138.69,-981.33 9146.18,-988.82 9149.22,-982.51"/>
</g>
<!-- Embedding_GPU7 -->
<g id="node9" class="node">
<title>Embedding_GPU7</title>
<polygon fill="none" stroke="black" points="8832.5,-981.17 8383.5,-981.17 8383.5,-913.17 8832.5,-913.17 8832.5,-981.17"/>
<text text-anchor="middle" x="8608" y="-965.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="8608" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, token_ids]</text>
<text text-anchor="middle" x="8608" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="8608" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Input&#45;&gt;Embedding_GPU7 -->
<g id="edge8" class="edge">
<title>Input&#45;&gt;Embedding_GPU7</title>
<path fill="none" stroke="black" d="M9919.94,-1116.47C9571.52,-1109.38 9039.38,-1091.34 8842,-1046.17 8785.37,-1033.21 8724.97,-1007.58 8679.72,-985.78"/>
<polygon fill="black" stroke="black" points="8681.11,-982.57 8670.59,-981.34 8678.05,-988.86 8681.11,-982.57"/>
</g>
<!-- Embedding_AllGather -->
<g id="node10" class="node">
<title>Embedding_AllGather</title>
<polygon fill="none" stroke="black" points="10716.67,-843.17 9961.58,-843.17 9767.33,-707.17 10522.42,-707.17 10716.67,-843.17"/>
<text text-anchor="middle" x="10242" y="-793.97" font-family="Times,serif" font-size="14.00">Embedding All&#45;Gather</text>
<text text-anchor="middle" x="10242" y="-778.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10242" y="-763.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-748.97" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Embedding_GPU0&#45;&gt;Embedding_AllGather -->
<g id="edge9" class="edge">
<title>Embedding_GPU0&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M11779.14,-913.15C11737.88,-900.51 11689.06,-887.21 11644,-879.17 11309.22,-819.4 10923.52,-794.18 10641.52,-783.61"/>
<polygon fill="black" stroke="black" points="10641.23,-780.09 10631.11,-783.22 10640.98,-787.09 10641.23,-780.09"/>
</g>
<!-- Embedding_GPU1&#45;&gt;Embedding_AllGather -->
<g id="edge10" class="edge">
<title>Embedding_GPU1&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M11309.13,-913.1C11268.47,-900.84 11220.87,-887.83 11177,-879.17 11014.84,-847.16 10834.74,-824.36 10676.25,-808.49"/>
<polygon fill="black" stroke="black" points="10676.14,-804.97 10665.84,-807.46 10675.45,-811.93 10676.14,-804.97"/>
</g>
<!-- Embedding_GPU2&#45;&gt;Embedding_AllGather -->
<g id="edge11" class="edge">
<title>Embedding_GPU2&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M10833.45,-913.12C10794.61,-901.81 10750.49,-889.43 10710,-879.17 10664.64,-867.67 10616.62,-856.25 10569.29,-845.43"/>
<polygon fill="black" stroke="black" points="10570.05,-842.01 10559.52,-843.2 10568.5,-848.83 10570.05,-842.01"/>
</g>
<!-- Embedding_GPU3&#45;&gt;Embedding_AllGather -->
<g id="edge12" class="edge">
<title>Embedding_GPU3&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M10430.33,-912.99C10405.3,-894.8 10373.23,-871.5 10342.67,-849.3"/>
<polygon fill="black" stroke="black" points="10344.67,-846.43 10334.52,-843.38 10340.55,-852.09 10344.67,-846.43"/>
</g>
<!-- Embedding_GPU4&#45;&gt;Embedding_AllGather -->
<g id="edge13" class="edge">
<title>Embedding_GPU4&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M10054.48,-912.99C10079.4,-894.8 10111.33,-871.5 10141.76,-849.3"/>
<polygon fill="black" stroke="black" points="10143.86,-852.1 10149.87,-843.38 10139.73,-846.45 10143.86,-852.1"/>
</g>
<!-- Embedding_GPU5&#45;&gt;Embedding_AllGather -->
<g id="edge14" class="edge">
<title>Embedding_GPU5&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M9652.03,-913.16C9691.04,-901.85 9735.34,-889.47 9776,-879.17 9829.7,-865.56 9887.14,-852.03 9942.7,-839.47"/>
<polygon fill="black" stroke="black" points="9943.7,-842.84 9952.68,-837.22 9942.16,-836.01 9943.7,-842.84"/>
</g>
<!-- Embedding_GPU6&#45;&gt;Embedding_AllGather -->
<g id="edge15" class="edge">
<title>Embedding_GPU6&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M9176.31,-913.11C9217.15,-900.86 9264.95,-887.84 9309,-879.17 9499.18,-841.72 9714.04,-816.84 9889.6,-800.92"/>
<polygon fill="black" stroke="black" points="9890.13,-804.39 9899.78,-800.01 9889.5,-797.42 9890.13,-804.39"/>
</g>
<!-- Embedding_GPU7&#45;&gt;Embedding_AllGather -->
<g id="edge16" class="edge">
<title>Embedding_GPU7&#45;&gt;Embedding_AllGather</title>
<path fill="none" stroke="black" d="M8706.29,-913.16C8747.72,-900.52 8796.76,-887.22 8842,-879.17 9185.1,-818.1 9581.7,-793.11 9864.99,-782.96"/>
<polygon fill="black" stroke="black" points="9865.15,-786.46 9875.02,-782.6 9864.91,-779.46 9865.15,-786.46"/>
</g>
<!-- Positional_Encoding -->
<g id="node11" class="node">
<title>Positional_Encoding</title>
<polygon fill="none" stroke="black" points="10471,-671.17 10013,-671.17 10013,-603.17 10471,-603.17 10471,-671.17"/>
<text text-anchor="middle" x="10242" y="-655.97" font-family="Times,serif" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="10242" y="-640.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-625.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-610.97" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Embedding_AllGather&#45;&gt;Positional_Encoding -->
<g id="edge17" class="edge">
<title>Embedding_AllGather&#45;&gt;Positional_Encoding</title>
<path fill="none" stroke="black" d="M10242,-706.96C10242,-698.21 10242,-689.44 10242,-681.23"/>
<polygon fill="black" stroke="black" points="10245.5,-681.18 10242,-671.18 10238.5,-681.18 10245.5,-681.18"/>
</g>
<!-- Layer1 -->
<g id="node21" class="node">
<title>Layer1</title>
<polygon fill="none" stroke="black" points="10294.5,-556.17 10189.5,-556.17 10189.5,-503.17 10294.5,-503.17 10294.5,-556.17"/>
<text text-anchor="middle" x="10242" y="-540.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10242" y="-525.97" font-family="Times,serif" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="10242" y="-510.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- Positional_Encoding&#45;&gt;Layer1 -->
<g id="edge18" class="edge">
<title>Positional_Encoding&#45;&gt;Layer1</title>
<path fill="none" stroke="black" d="M10242,-603.08C10242,-591.39 10242,-578.2 10242,-566.32"/>
<polygon fill="black" stroke="black" points="10245.5,-566.28 10242,-556.28 10238.5,-566.28 10245.5,-566.28"/>
</g>
<!-- Attention_Base_GPU0 -->
<g id="node12" class="node">
<title>Attention_Base_GPU0</title>
<polygon fill="none" stroke="black" points="8365.5,-981.17 7458.5,-981.17 7458.5,-913.17 8365.5,-913.17 8365.5,-981.17"/>
<text text-anchor="middle" x="7912" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="7912" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7912" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7912" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Attention_Base_GPU1 -->
<g id="node13" class="node">
<title>Attention_Base_GPU1</title>
<polygon fill="none" stroke="black" points="7440.5,-981.17 6533.5,-981.17 6533.5,-913.17 7440.5,-913.17 7440.5,-981.17"/>
<text text-anchor="middle" x="6987" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="6987" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6987" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6987" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Attention_Base_GPU2 -->
<g id="node14" class="node">
<title>Attention_Base_GPU2</title>
<polygon fill="none" stroke="black" points="6515.5,-981.17 5608.5,-981.17 5608.5,-913.17 6515.5,-913.17 6515.5,-981.17"/>
<text text-anchor="middle" x="6062" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="6062" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6062" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6062" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Attention_Base_GPU3 -->
<g id="node15" class="node">
<title>Attention_Base_GPU3</title>
<polygon fill="none" stroke="black" points="5590.5,-981.17 4683.5,-981.17 4683.5,-913.17 5590.5,-913.17 5590.5,-981.17"/>
<text text-anchor="middle" x="5137" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="5137" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5137" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5137" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Attention_Base_GPU4 -->
<g id="node16" class="node">
<title>Attention_Base_GPU4</title>
<polygon fill="none" stroke="black" points="4665.5,-981.17 3758.5,-981.17 3758.5,-913.17 4665.5,-913.17 4665.5,-981.17"/>
<text text-anchor="middle" x="4212" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="4212" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4212" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4212" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Attention_Base_GPU5 -->
<g id="node17" class="node">
<title>Attention_Base_GPU5</title>
<polygon fill="none" stroke="black" points="3740.5,-981.17 2833.5,-981.17 2833.5,-913.17 3740.5,-913.17 3740.5,-981.17"/>
<text text-anchor="middle" x="3287" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="3287" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3287" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3287" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Attention_Base_GPU6 -->
<g id="node18" class="node">
<title>Attention_Base_GPU6</title>
<polygon fill="none" stroke="black" points="2815.5,-981.17 1908.5,-981.17 1908.5,-913.17 2815.5,-913.17 2815.5,-981.17"/>
<text text-anchor="middle" x="2362" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="2362" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2362" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2362" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Attention_Base_GPU7 -->
<g id="node19" class="node">
<title>Attention_Base_GPU7</title>
<polygon fill="none" stroke="black" points="1890.5,-981.17 983.5,-981.17 983.5,-913.17 1890.5,-913.17 1890.5,-981.17"/>
<text text-anchor="middle" x="1437" y="-965.97" font-family="Times,serif" font-size="14.00">Flash Attention</text>
<text text-anchor="middle" x="1437" y="-950.97" font-family="Times,serif" font-size="14.00">Input: Q=[batch_size=1024, seq_len=2048, heads=4, d_k=128], K,V=[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1437" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1437" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Attention_AllGather -->
<g id="node20" class="node">
<title>Attention_AllGather</title>
<polygon fill="none" stroke="black" points="965.67,-1015.17 210.58,-1015.17 16.33,-879.17 771.42,-879.17 965.67,-1015.17"/>
<text text-anchor="middle" x="491" y="-965.97" font-family="Times,serif" font-size="14.00">Attention All&#45;Gather</text>
<text text-anchor="middle" x="491" y="-950.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="491" y="-935.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="491" y="-920.97" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Layer2 -->
<g id="node22" class="node">
<title>Layer2</title>
<polygon fill="none" stroke="black" points="10294.5,-467.17 10189.5,-467.17 10189.5,-414.17 10294.5,-414.17 10294.5,-467.17"/>
<text text-anchor="middle" x="10242" y="-451.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10242" y="-436.97" font-family="Times,serif" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="10242" y="-421.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- Layer1&#45;&gt;Layer2 -->
<g id="edge19" class="edge">
<title>Layer1&#45;&gt;Layer2</title>
<path fill="none" stroke="black" d="M10242,-503.03C10242,-495.05 10242,-486.1 10242,-477.55"/>
<polygon fill="black" stroke="black" points="10245.5,-477.42 10242,-467.42 10238.5,-477.42 10245.5,-477.42"/>
</g>
<!-- Layer3 -->
<g id="node23" class="node">
<title>Layer3</title>
<polygon fill="none" stroke="black" points="10294.5,-378.17 10189.5,-378.17 10189.5,-325.17 10294.5,-325.17 10294.5,-378.17"/>
<text text-anchor="middle" x="10242" y="-362.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="10242" y="-347.97" font-family="Times,serif" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="10242" y="-332.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- Layer2&#45;&gt;Layer3 -->
<g id="edge20" class="edge">
<title>Layer2&#45;&gt;Layer3</title>
<path fill="none" stroke="black" d="M10242,-414.03C10242,-406.05 10242,-397.1 10242,-388.55"/>
<polygon fill="black" stroke="black" points="10245.5,-388.42 10242,-378.42 10238.5,-388.42 10245.5,-388.42"/>
</g>
<!-- Layer4 -->
<g id="node24" class="node">
<title>Layer4</title>
<polygon fill="none" stroke="black" points="10294.5,-289.17 10189.5,-289.17 10189.5,-236.17 10294.5,-236.17 10294.5,-289.17"/>
<text text-anchor="middle" x="10242" y="-273.97" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="10242" y="-258.97" font-family="Times,serif" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="10242" y="-243.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- Layer3&#45;&gt;Layer4 -->
<g id="edge21" class="edge">
<title>Layer3&#45;&gt;Layer4</title>
<path fill="none" stroke="black" d="M10242,-325.03C10242,-317.05 10242,-308.1 10242,-299.55"/>
<polygon fill="black" stroke="black" points="10245.5,-299.42 10242,-289.42 10238.5,-299.42 10245.5,-299.42"/>
</g>
<!-- Output_LayerNorm -->
<g id="node25" class="node">
<title>Output_LayerNorm</title>
<polygon fill="none" stroke="black" points="10471,-200.17 10013,-200.17 10013,-132.17 10471,-132.17 10471,-200.17"/>
<text text-anchor="middle" x="10242" y="-184.97" font-family="Times,serif" font-size="14.00">Output LayerNorm</text>
<text text-anchor="middle" x="10242" y="-169.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Layer4&#45;&gt;Output_LayerNorm -->
<g id="edge22" class="edge">
<title>Layer4&#45;&gt;Output_LayerNorm</title>
<path fill="none" stroke="black" d="M10242,-235.84C10242,-227.99 10242,-219.13 10242,-210.45"/>
<polygon fill="black" stroke="black" points="10245.5,-210.42 10242,-200.42 10238.5,-210.42 10245.5,-210.42"/>
</g>
<!-- Output -->
<g id="node26" class="node">
<title>Output</title>
<ellipse fill="none" stroke="black" cx="10242" cy="-48.08" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="10242" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="10242" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10242" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, vocab_size]</text>
<text text-anchor="middle" x="10242" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- Output_LayerNorm&#45;&gt;Output -->
<g id="edge23" class="edge">
<title>Output_LayerNorm&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M10242,-131.9C10242,-123.91 10242,-115.14 10242,-106.4"/>
<polygon fill="black" stroke="black" points="10245.5,-106.19 10242,-96.19 10238.5,-106.19 10245.5,-106.19"/>
</g>
<!-- Resource_Manager -->
<g id="node27" class="node">
<title>Resource_Manager</title>
<polygon fill="none" stroke="black" points="10869.77,-1121.94 10798.39,-1189.47 10655.61,-1189.47 10584.23,-1121.94 10655.61,-1054.4 10798.39,-1054.4 10869.77,-1121.94"/>
<text text-anchor="middle" x="10727" y="-1148.24" font-family="Times,serif" font-size="14.00">Resource Manager</text>
<text text-anchor="middle" x="10727" y="-1133.24" font-family="Times,serif" font-size="14.00">seq_len=2048 ≤ 4096</text>
<text text-anchor="middle" x="10727" y="-1118.24" font-family="Times,serif" font-size="14.00">pool_gpus=0</text>
<text text-anchor="middle" x="10727" y="-1103.24" font-family="Times,serif" font-size="14.00">Using 8 base GPUs</text>
<text text-anchor="middle" x="10727" y="-1088.24" font-family="Times,serif" font-size="14.00">GPU: Control</text>
</g>
</g>
</svg>
