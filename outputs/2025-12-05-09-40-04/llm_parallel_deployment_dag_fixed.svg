<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2362pt" height="2408pt"
 viewBox="0.00 0.00 2362.00 2408.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2404.21)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2404.21 2358,-2404.21 2358,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M1118,-2257.05C1118,-2257.05 1746,-2257.05 1746,-2257.05 1752,-2257.05 1758,-2263.05 1758,-2269.05 1758,-2269.05 1758,-2380.21 1758,-2380.21 1758,-2386.21 1752,-2392.21 1746,-2392.21 1746,-2392.21 1118,-2392.21 1118,-2392.21 1112,-2392.21 1106,-2386.21 1106,-2380.21 1106,-2380.21 1106,-2269.05 1106,-2269.05 1106,-2263.05 1112,-2257.05 1118,-2257.05"/>
<text text-anchor="middle" x="1432" y="-2377.01" font-family="Times,serif" font-size="14.00">Input Stage</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_embedding</title>
<path fill="none" stroke="blue" d="M1224,-1650.88C1224,-1650.88 1640,-1650.88 1640,-1650.88 1646,-1650.88 1652,-1656.88 1652,-1662.88 1652,-1662.88 1652,-2237.05 1652,-2237.05 1652,-2243.05 1646,-2249.05 1640,-2249.05 1640,-2249.05 1224,-2249.05 1224,-2249.05 1218,-2249.05 1212,-2243.05 1212,-2237.05 1212,-2237.05 1212,-1662.88 1212,-1662.88 1212,-1656.88 1218,-1650.88 1224,-1650.88"/>
<text text-anchor="middle" x="1432" y="-2233.85" font-family="Times,serif" font-size="14.00">Embedding Stage (TP&#45;2)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_expert</title>
<path fill="none" stroke="green" d="M20,-738.71C20,-738.71 2334,-738.71 2334,-738.71 2340,-738.71 2346,-744.71 2346,-750.71 2346,-750.71 2346,-1630.88 2346,-1630.88 2346,-1636.88 2340,-1642.88 2334,-1642.88 2334,-1642.88 20,-1642.88 20,-1642.88 14,-1642.88 8,-1636.88 8,-1630.88 8,-1630.88 8,-750.71 8,-750.71 8,-744.71 14,-738.71 20,-738.71"/>
<text text-anchor="middle" x="1177" y="-1627.68" font-family="Times,serif" font-size="14.00">Expert Parallel Stage (EP&#45;64)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_aggregation</title>
<path fill="none" stroke="orange" d="M1311,-172.38C1311,-172.38 1708,-172.38 1708,-172.38 1714,-172.38 1720,-178.38 1720,-184.38 1720,-184.38 1720,-718.71 1720,-718.71 1720,-724.71 1714,-730.71 1708,-730.71 1708,-730.71 1311,-730.71 1311,-730.71 1305,-730.71 1299,-724.71 1299,-718.71 1299,-718.71 1299,-184.38 1299,-184.38 1299,-178.38 1305,-172.38 1311,-172.38"/>
<text text-anchor="middle" x="1509.5" y="-715.51" font-family="Times,serif" font-size="14.00">Aggregation Stage (TP&#45;2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M1376,-8C1376,-8 1642,-8 1642,-8 1648,-8 1654,-14 1654,-20 1654,-20 1654,-152.38 1654,-152.38 1654,-158.38 1648,-164.38 1642,-164.38 1642,-164.38 1376,-164.38 1376,-164.38 1370,-164.38 1364,-158.38 1364,-152.38 1364,-152.38 1364,-20 1364,-20 1364,-14 1370,-8 1376,-8"/>
<text text-anchor="middle" x="1509" y="-149.18" font-family="Times,serif" font-size="14.00">Output Stage</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="1432" cy="-2313.13" rx="318.4" ry="48.17"/>
<text text-anchor="middle" x="1432" y="-2331.93" font-family="Times,serif" font-size="14.00">Input Layer</text>
<text text-anchor="middle" x="1432" y="-2316.93" font-family="Times,serif" font-size="14.00">GPU: All</text>
<text text-anchor="middle" x="1432" y="-2301.93" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="1432" y="-2286.93" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- split_embed -->
<g id="node2" class="node">
<title>split_embed</title>
<polygon fill="lightgray" stroke="black" points="1623.6,-2218.05 1318.81,-2218.05 1240.4,-2082.05 1545.19,-2082.05 1623.6,-2218.05"/>
<text text-anchor="middle" x="1432" y="-2168.85" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="1432" y="-2153.85" font-family="Times,serif" font-size="14.00">GPU: 0,1</text>
<text text-anchor="middle" x="1432" y="-2138.85" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1432" y="-2123.85" font-family="Times,serif" font-size="14.00">Output: [128,1024,512]</text>
</g>
<!-- input&#45;&gt;split_embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;split_embed</title>
<path fill="none" stroke="black" d="M1432,-2264.67C1432,-2253.29 1432,-2240.84 1432,-2228.48"/>
<polygon fill="black" stroke="black" points="1435.5,-2228.16 1432,-2218.16 1428.5,-2228.16 1435.5,-2228.16"/>
</g>
<!-- embed_0 -->
<g id="node3" class="node">
<title>embed_0</title>
<polygon fill="lightblue" stroke="black" points="1414,-2046.05 1220,-2046.05 1220,-1963.05 1414,-1963.05 1414,-2046.05"/>
<text text-anchor="middle" x="1317" y="-2030.85" font-family="Times,serif" font-size="14.00">Embedding Layer 0</text>
<text text-anchor="middle" x="1317" y="-2015.85" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="1317" y="-2000.85" font-family="Times,serif" font-size="14.00">Input: [128,1024,512]</text>
<text text-anchor="middle" x="1317" y="-1985.85" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="1317" y="-1970.85" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- split_embed&#45;&gt;embed_0 -->
<g id="edge2" class="edge">
<title>split_embed&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M1378.2,-2081.92C1370.68,-2072.54 1363.08,-2063.05 1355.91,-2054.1"/>
<polygon fill="black" stroke="black" points="1358.44,-2051.66 1349.46,-2046.05 1352.98,-2056.04 1358.44,-2051.66"/>
</g>
<!-- embed_1 -->
<g id="node4" class="node">
<title>embed_1</title>
<polygon fill="lightblue" stroke="black" points="1644,-2046.05 1450,-2046.05 1450,-1963.05 1644,-1963.05 1644,-2046.05"/>
<text text-anchor="middle" x="1547" y="-2030.85" font-family="Times,serif" font-size="14.00">Embedding Layer 1</text>
<text text-anchor="middle" x="1547" y="-2015.85" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="1547" y="-2000.85" font-family="Times,serif" font-size="14.00">Input: [128,1024,512]</text>
<text text-anchor="middle" x="1547" y="-1985.85" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="1547" y="-1970.85" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- split_embed&#45;&gt;embed_1 -->
<g id="edge3" class="edge">
<title>split_embed&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M1485.8,-2081.92C1493.32,-2072.54 1500.92,-2063.05 1508.09,-2054.1"/>
<polygon fill="black" stroke="black" points="1511.02,-2056.04 1514.54,-2046.05 1505.56,-2051.66 1511.02,-2056.04"/>
</g>
<!-- embed_allreduce -->
<g id="node5" class="node">
<title>embed_allreduce</title>
<ellipse fill="lightcoral" stroke="black" cx="1432" cy="-1878.96" rx="137.36" ry="48.17"/>
<text text-anchor="middle" x="1432" y="-1897.76" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1432" y="-1882.76" font-family="Times,serif" font-size="14.00">GPU: 0,1</text>
<text text-anchor="middle" x="1432" y="-1867.76" font-family="Times,serif" font-size="14.00">Input: [128,1024,2048]</text>
<text text-anchor="middle" x="1432" y="-1852.76" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
</g>
<!-- embed_0&#45;&gt;embed_allreduce -->
<g id="edge4" class="edge">
<title>embed_0&#45;&gt;embed_allreduce</title>
<path fill="none" stroke="black" d="M1354.97,-1962.74C1364.03,-1953.01 1373.82,-1942.49 1383.28,-1932.32"/>
<polygon fill="black" stroke="black" points="1385.85,-1934.7 1390.1,-1924.99 1380.72,-1929.93 1385.85,-1934.7"/>
</g>
<!-- embed_1&#45;&gt;embed_allreduce -->
<g id="edge5" class="edge">
<title>embed_1&#45;&gt;embed_allreduce</title>
<path fill="none" stroke="black" d="M1509.03,-1962.74C1499.97,-1953.01 1490.18,-1942.49 1480.72,-1932.32"/>
<polygon fill="black" stroke="black" points="1483.28,-1929.93 1473.9,-1924.99 1478.15,-1934.7 1483.28,-1929.93"/>
</g>
<!-- embed_merge -->
<g id="node6" class="node">
<title>embed_merge</title>
<polygon fill="lightgray" stroke="black" points="1633.26,-1794.88 1313.1,-1794.88 1230.74,-1658.88 1550.9,-1658.88 1633.26,-1794.88"/>
<text text-anchor="middle" x="1432" y="-1745.68" font-family="Times,serif" font-size="14.00">Merge Embeddings</text>
<text text-anchor="middle" x="1432" y="-1730.68" font-family="Times,serif" font-size="14.00">GPU: 0,1</text>
<text text-anchor="middle" x="1432" y="-1715.68" font-family="Times,serif" font-size="14.00">Input: [128,1024,2048]</text>
<text text-anchor="middle" x="1432" y="-1700.68" font-family="Times,serif" font-size="14.00">Output: [128,1024,1024]</text>
</g>
<!-- embed_allreduce&#45;&gt;embed_merge -->
<g id="edge6" class="edge">
<title>embed_allreduce&#45;&gt;embed_merge</title>
<path fill="none" stroke="black" d="M1432,-1830.48C1432,-1822.39 1432,-1813.81 1432,-1805.19"/>
<polygon fill="black" stroke="black" points="1435.5,-1805.07 1432,-1795.07 1428.5,-1805.07 1435.5,-1805.07"/>
</g>
<!-- broadcast_expert -->
<g id="node7" class="node">
<title>broadcast_expert</title>
<ellipse fill="lightcoral" stroke="black" cx="1432" cy="-1563.8" rx="137.36" ry="48.17"/>
<text text-anchor="middle" x="1432" y="-1582.6" font-family="Times,serif" font-size="14.00">Broadcast to Experts</text>
<text text-anchor="middle" x="1432" y="-1567.6" font-family="Times,serif" font-size="14.00">GPU: 0,1 → 2&#45;65</text>
<text text-anchor="middle" x="1432" y="-1552.6" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1432" y="-1537.6" font-family="Times,serif" font-size="14.00">Output: [128,1024,1024]</text>
</g>
<!-- embed_merge&#45;&gt;broadcast_expert -->
<g id="edge7" class="edge">
<title>embed_merge&#45;&gt;broadcast_expert</title>
<path fill="none" stroke="black" d="M1432,-1658.5C1432,-1646.5 1432,-1634.09 1432,-1622.39"/>
<polygon fill="black" stroke="black" points="1435.5,-1622.32 1432,-1612.32 1428.5,-1622.32 1435.5,-1622.32"/>
</g>
<!-- gate_compute -->
<g id="node8" class="node">
<title>gate_compute</title>
<polygon fill="lightpink" stroke="black" points="1442.88,-1479.71 1142.42,-1479.71 1065.12,-1313.71 1365.58,-1313.71 1442.88,-1479.71"/>
<text text-anchor="middle" x="1254" y="-1423.01" font-family="Times,serif" font-size="14.00">Gate Computation</text>
<text text-anchor="middle" x="1254" y="-1408.01" font-family="Times,serif" font-size="14.00">GPU: 2&#45;65</text>
<text text-anchor="middle" x="1254" y="-1393.01" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1254" y="-1378.01" font-family="Times,serif" font-size="14.00">Output: [128,1024,64]</text>
<text text-anchor="middle" x="1254" y="-1363.01" font-family="Times,serif" font-size="14.00">(gate scores)</text>
</g>
<!-- broadcast_expert&#45;&gt;gate_compute -->
<g id="edge8" class="edge">
<title>broadcast_expert&#45;&gt;gate_compute</title>
<path fill="none" stroke="black" d="M1384.3,-1518.56C1373.64,-1508.67 1361.96,-1497.84 1350.12,-1486.86"/>
<polygon fill="black" stroke="black" points="1352.44,-1484.24 1342.73,-1480 1347.68,-1489.37 1352.44,-1484.24"/>
</g>
<!-- alltoall_expert -->
<g id="node19" class="node">
<title>alltoall_expert</title>
<ellipse fill="lightcoral" stroke="black" cx="1740" cy="-1064.21" rx="137.77" ry="37.45"/>
<text text-anchor="middle" x="1740" y="-1075.51" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="1740" y="-1060.51" font-family="Times,serif" font-size="14.00">GPU: 2&#45;65</text>
<text text-anchor="middle" x="1740" y="-1045.51" font-family="Times,serif" font-size="14.00">Routes tokens to experts</text>
</g>
<!-- broadcast_expert&#45;&gt;alltoall_expert -->
<g id="edge19" class="edge">
<title>broadcast_expert&#45;&gt;alltoall_expert</title>
<path fill="none" stroke="black" d="M1460.7,-1516.43C1519.73,-1421.07 1654.07,-1204.04 1712.26,-1110.02"/>
<polygon fill="black" stroke="black" points="1715.36,-1111.66 1717.65,-1101.32 1709.41,-1107.98 1715.36,-1111.66"/>
</g>
<!-- expert_select -->
<g id="node9" class="node">
<title>expert_select</title>
<polygon fill="lightpink" stroke="black" points="1330.13,-1277.71 1002.22,-1277.71 917.87,-1141.71 1245.78,-1141.71 1330.13,-1277.71"/>
<text text-anchor="middle" x="1124" y="-1228.51" font-family="Times,serif" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="1124" y="-1213.51" font-family="Times,serif" font-size="14.00">GPU: 2&#45;65</text>
<text text-anchor="middle" x="1124" y="-1198.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,64]</text>
<text text-anchor="middle" x="1124" y="-1183.51" font-family="Times,serif" font-size="14.00">Output: routing decisions</text>
</g>
<!-- gate_compute&#45;&gt;expert_select -->
<g id="edge9" class="edge">
<title>gate_compute&#45;&gt;expert_select</title>
<path fill="none" stroke="black" d="M1196.22,-1313.49C1189.84,-1304.4 1183.36,-1295.18 1177.03,-1286.18"/>
<polygon fill="black" stroke="black" points="1179.89,-1284.16 1171.28,-1277.99 1174.16,-1288.19 1179.89,-1284.16"/>
</g>
<!-- expert_2 -->
<g id="node10" class="node">
<title>expert_2</title>
<polygon fill="lightgreen" stroke="black" points="2108,-1105.71 1914,-1105.71 1914,-1022.71 2108,-1022.71 2108,-1105.71"/>
<text text-anchor="middle" x="2011" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2011" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="2011" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="2011" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="2011" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_2 -->
<g id="edge10" class="edge">
<title>expert_select&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1280.62,-1197.33C1437.83,-1183.7 1686.13,-1156.1 1896,-1105.71 1898.66,-1105.07 1901.34,-1104.4 1904.04,-1103.69"/>
<polygon fill="black" stroke="black" points="1905.15,-1107.01 1913.86,-1100.98 1903.29,-1100.26 1905.15,-1107.01"/>
</g>
<!-- expert_3 -->
<g id="node11" class="node">
<title>expert_3</title>
<polygon fill="lightgreen" stroke="black" points="2338,-1105.71 2144,-1105.71 2144,-1022.71 2338,-1022.71 2338,-1105.71"/>
<text text-anchor="middle" x="2241" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2241" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="2241" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="2241" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="2241" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_3 -->
<g id="edge11" class="edge">
<title>expert_select&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1284.66,-1203.86C1484.13,-1195.18 1833.78,-1171.22 2126,-1105.71 2128.67,-1105.11 2131.36,-1104.47 2134.06,-1103.8"/>
<polygon fill="black" stroke="black" points="2135.13,-1107.13 2143.91,-1101.19 2133.34,-1100.37 2135.13,-1107.13"/>
</g>
<!-- expert_4 -->
<g id="node12" class="node">
<title>expert_4</title>
<polygon fill="lightgreen" stroke="black" points="1336,-1105.71 1142,-1105.71 1142,-1022.71 1336,-1022.71 1336,-1105.71"/>
<text text-anchor="middle" x="1239" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1239" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1239" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1239" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="1239" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_4 -->
<g id="edge12" class="edge">
<title>expert_select&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1177.8,-1141.58C1185.32,-1132.2 1192.92,-1122.71 1200.09,-1113.76"/>
<polygon fill="black" stroke="black" points="1203.02,-1115.71 1206.54,-1105.72 1197.56,-1111.33 1203.02,-1115.71"/>
</g>
<!-- expert_5 -->
<g id="node13" class="node">
<title>expert_5</title>
<polygon fill="lightgreen" stroke="black" points="1566,-1105.71 1372,-1105.71 1372,-1022.71 1566,-1022.71 1566,-1105.71"/>
<text text-anchor="middle" x="1469" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1469" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1469" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1469" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="1469" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_5 -->
<g id="edge13" class="edge">
<title>expert_select&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1253.94,-1154.67C1289.73,-1139.78 1328.13,-1123.81 1362.43,-1109.54"/>
<polygon fill="black" stroke="black" points="1364.11,-1112.63 1372,-1105.56 1361.42,-1106.17 1364.11,-1112.63"/>
</g>
<!-- expert_6 -->
<g id="node14" class="node">
<title>expert_6</title>
<polygon fill="lightgreen" stroke="black" points="210,-1105.71 16,-1105.71 16,-1022.71 210,-1022.71 210,-1105.71"/>
<text text-anchor="middle" x="113" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="113" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="113" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="113" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="113" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_6 -->
<g id="edge14" class="edge">
<title>expert_select&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M954.06,-1200.53C772.4,-1189.16 476.9,-1163.08 228,-1105.71 225.34,-1105.1 222.65,-1104.44 219.95,-1103.75"/>
<polygon fill="black" stroke="black" points="220.68,-1100.33 210.11,-1101.11 218.86,-1107.09 220.68,-1100.33"/>
</g>
<!-- expert_7 -->
<g id="node15" class="node">
<title>expert_7</title>
<polygon fill="lightgreen" stroke="black" points="876,-1105.71 682,-1105.71 682,-1022.71 876,-1022.71 876,-1105.71"/>
<text text-anchor="middle" x="779" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="779" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="779" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="779" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="779" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_7 -->
<g id="edge15" class="edge">
<title>expert_select&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M962.86,-1141.69C936.56,-1130.75 909.9,-1119.66 885.35,-1109.45"/>
<polygon fill="black" stroke="black" points="886.63,-1106.19 876.05,-1105.58 883.94,-1112.65 886.63,-1106.19"/>
</g>
<!-- expert_8 -->
<g id="node16" class="node">
<title>expert_8</title>
<polygon fill="lightgreen" stroke="black" points="1106,-1105.71 912,-1105.71 912,-1022.71 1106,-1022.71 1106,-1105.71"/>
<text text-anchor="middle" x="1009" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1009" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1009" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1009" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="1009" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_8 -->
<g id="edge16" class="edge">
<title>expert_select&#45;&gt;expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1070.2,-1141.58C1062.68,-1132.2 1055.08,-1122.71 1047.91,-1113.76"/>
<polygon fill="black" stroke="black" points="1050.44,-1111.33 1041.46,-1105.72 1044.98,-1115.71 1050.44,-1111.33"/>
</g>
<!-- expert_9 -->
<g id="node17" class="node">
<title>expert_9</title>
<polygon fill="lightgreen" stroke="black" points="646,-1105.71 452,-1105.71 452,-1022.71 646,-1022.71 646,-1105.71"/>
<text text-anchor="middle" x="549" y="-1090.51" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="549" y="-1075.51" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="549" y="-1060.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="549" y="-1045.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
<text text-anchor="middle" x="549" y="-1030.51" font-family="Times,serif" font-size="14.00">Weight: [1024,2048]</text>
</g>
<!-- expert_select&#45;&gt;expert_9 -->
<g id="edge17" class="edge">
<title>expert_select&#45;&gt;expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M936.41,-1171.96C852.49,-1154.18 752.69,-1131.16 664,-1105.71 661.37,-1104.96 658.72,-1104.18 656.04,-1103.37"/>
<polygon fill="black" stroke="black" points="656.89,-1099.97 646.3,-1100.38 654.83,-1106.66 656.89,-1099.97"/>
</g>
<!-- experts_ellipsis -->
<g id="node18" class="node">
<title>experts_ellipsis</title>
<text text-anchor="middle" x="331" y="-1068.01" font-family="Times,serif" font-size="14.00">... 56 more experts ...</text>
<text text-anchor="middle" x="331" y="-1053.01" font-family="Times,serif" font-size="14.00">GPUs: 10&#45;65</text>
</g>
<!-- expert_select&#45;&gt;experts_ellipsis -->
<g id="edge18" class="edge">
<title>expert_select&#45;&gt;experts_ellipsis</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M949.87,-1193.73C809.01,-1179 606.43,-1151.84 434,-1105.71 416.16,-1100.94 397.19,-1094.04 380.46,-1087.28"/>
<polygon fill="black" stroke="black" points="381.47,-1083.92 370.89,-1083.34 378.8,-1090.39 381.47,-1083.92"/>
</g>
<!-- expert_compute_2 -->
<g id="node20" class="node">
<title>expert_compute_2</title>
<polygon fill="lightgreen" stroke="black" points="1837,-986.71 1643,-986.71 1643,-918.71 1837,-918.71 1837,-986.71"/>
<text text-anchor="middle" x="1740" y="-971.51" font-family="Times,serif" font-size="14.00">Expert 0 Compute</text>
<text text-anchor="middle" x="1740" y="-956.51" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="1740" y="-941.51" font-family="Times,serif" font-size="14.00">Input: routed tokens</text>
<text text-anchor="middle" x="1740" y="-926.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
</g>
<!-- expert_2&#45;&gt;expert_compute_2 -->
<g id="edge25" class="edge">
<title>expert_2&#45;&gt;expert_compute_2</title>
<path fill="none" stroke="black" d="M1913.93,-1023.99C1887.03,-1013.12 1857.93,-1001.36 1831.36,-990.63"/>
<polygon fill="black" stroke="black" points="1832.66,-987.38 1822.08,-986.88 1830.04,-993.87 1832.66,-987.38"/>
</g>
<!-- expert_compute_3 -->
<g id="node21" class="node">
<title>expert_compute_3</title>
<polygon fill="lightgreen" stroke="black" points="2067,-986.71 1873,-986.71 1873,-918.71 2067,-918.71 2067,-986.71"/>
<text text-anchor="middle" x="1970" y="-971.51" font-family="Times,serif" font-size="14.00">Expert 1 Compute</text>
<text text-anchor="middle" x="1970" y="-956.51" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="1970" y="-941.51" font-family="Times,serif" font-size="14.00">Input: routed tokens</text>
<text text-anchor="middle" x="1970" y="-926.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
</g>
<!-- expert_3&#45;&gt;expert_compute_3 -->
<g id="edge26" class="edge">
<title>expert_3&#45;&gt;expert_compute_3</title>
<path fill="none" stroke="black" d="M2143.93,-1023.99C2117.03,-1013.12 2087.93,-1001.36 2061.36,-990.63"/>
<polygon fill="black" stroke="black" points="2062.66,-987.38 2052.08,-986.88 2060.04,-993.87 2062.66,-987.38"/>
</g>
<!-- expert_compute_4 -->
<g id="node22" class="node">
<title>expert_compute_4</title>
<polygon fill="lightgreen" stroke="black" points="1377,-986.71 1183,-986.71 1183,-918.71 1377,-918.71 1377,-986.71"/>
<text text-anchor="middle" x="1280" y="-971.51" font-family="Times,serif" font-size="14.00">Expert 2 Compute</text>
<text text-anchor="middle" x="1280" y="-956.51" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1280" y="-941.51" font-family="Times,serif" font-size="14.00">Input: routed tokens</text>
<text text-anchor="middle" x="1280" y="-926.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
</g>
<!-- expert_4&#45;&gt;expert_compute_4 -->
<g id="edge27" class="edge">
<title>expert_4&#45;&gt;expert_compute_4</title>
<path fill="none" stroke="black" d="M1254.27,-1022.44C1257.44,-1013.96 1260.8,-1004.99 1264,-996.44"/>
<polygon fill="black" stroke="black" points="1267.3,-997.6 1267.53,-987.01 1260.75,-995.15 1267.3,-997.6"/>
</g>
<!-- expert_compute_5 -->
<g id="node23" class="node">
<title>expert_compute_5</title>
<polygon fill="lightgreen" stroke="black" points="1607,-986.71 1413,-986.71 1413,-918.71 1607,-918.71 1607,-986.71"/>
<text text-anchor="middle" x="1510" y="-971.51" font-family="Times,serif" font-size="14.00">Expert 3 Compute</text>
<text text-anchor="middle" x="1510" y="-956.51" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1510" y="-941.51" font-family="Times,serif" font-size="14.00">Input: routed tokens</text>
<text text-anchor="middle" x="1510" y="-926.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,2048]</text>
</g>
<!-- expert_5&#45;&gt;expert_compute_5 -->
<g id="edge28" class="edge">
<title>expert_5&#45;&gt;expert_compute_5</title>
<path fill="none" stroke="black" d="M1484.27,-1022.44C1487.44,-1013.96 1490.8,-1004.99 1494,-996.44"/>
<polygon fill="black" stroke="black" points="1497.3,-997.6 1497.53,-987.01 1490.75,-995.15 1497.3,-997.6"/>
</g>
<!-- expert_compute_ellipsis -->
<g id="node24" class="node">
<title>expert_compute_ellipsis</title>
<text text-anchor="middle" x="894" y="-949.01" font-family="Times,serif" font-size="14.00">... expert computations ...</text>
</g>
<!-- expert_6&#45;&gt;expert_compute_ellipsis -->
<g id="edge29" class="edge">
<title>expert_6&#45;&gt;expert_compute_ellipsis</title>
<path fill="none" stroke="black" d="M210.1,-1027.24C216.11,-1025.56 222.11,-1024.03 228,-1022.71 420.48,-979.48 650.43,-963.25 783.6,-957.21"/>
<polygon fill="black" stroke="black" points="783.97,-960.7 793.81,-956.76 783.66,-953.71 783.97,-960.7"/>
</g>
<!-- expert_7&#45;&gt;expert_compute_ellipsis -->
<g id="edge30" class="edge">
<title>expert_7&#45;&gt;expert_compute_ellipsis</title>
<path fill="none" stroke="black" d="M821.82,-1022.44C837.52,-1007.5 854.77,-991.06 868.48,-978.01"/>
<polygon fill="black" stroke="black" points="871.27,-980.19 876.1,-970.76 866.44,-975.12 871.27,-980.19"/>
</g>
<!-- expert_8&#45;&gt;expert_compute_ellipsis -->
<g id="edge31" class="edge">
<title>expert_8&#45;&gt;expert_compute_ellipsis</title>
<path fill="none" stroke="black" d="M966.18,-1022.44C950.48,-1007.5 933.23,-991.06 919.52,-978.01"/>
<polygon fill="black" stroke="black" points="921.56,-975.12 911.9,-970.76 916.73,-980.19 921.56,-975.12"/>
</g>
<!-- expert_9&#45;&gt;expert_compute_ellipsis -->
<g id="edge32" class="edge">
<title>expert_9&#45;&gt;expert_compute_ellipsis</title>
<path fill="none" stroke="black" d="M646.14,-1028.64C652.17,-1026.61 658.16,-1024.61 664,-1022.71 717.54,-1005.26 778.62,-987.02 824.38,-973.67"/>
<polygon fill="black" stroke="black" points="825.57,-976.97 834.19,-970.82 823.61,-970.25 825.57,-976.97"/>
</g>
<!-- alltoall_expert&#45;&gt;expert_compute_2 -->
<g id="edge20" class="edge">
<title>alltoall_expert&#45;&gt;expert_compute_2</title>
<path fill="none" stroke="black" d="M1740,-1026.45C1740,-1017.05 1740,-1006.85 1740,-997.15"/>
<polygon fill="black" stroke="black" points="1743.5,-996.88 1740,-986.88 1736.5,-996.88 1743.5,-996.88"/>
</g>
<!-- alltoall_expert&#45;&gt;expert_compute_3 -->
<g id="edge21" class="edge">
<title>alltoall_expert&#45;&gt;expert_compute_3</title>
<path fill="none" stroke="black" d="M1806.83,-1031.39C1833.29,-1018.8 1863.89,-1004.23 1891.4,-991.13"/>
<polygon fill="black" stroke="black" points="1893.07,-994.21 1900.6,-986.75 1890.07,-987.89 1893.07,-994.21"/>
</g>
<!-- alltoall_expert&#45;&gt;expert_compute_4 -->
<g id="edge22" class="edge">
<title>alltoall_expert&#45;&gt;expert_compute_4</title>
<path fill="none" stroke="black" d="M1644.13,-1037.26C1624.3,-1032.2 1603.52,-1027.1 1584,-1022.71 1500.57,-1003.96 1478.18,-1006.53 1395,-986.71 1392.34,-986.08 1389.66,-985.43 1386.95,-984.75"/>
<polygon fill="black" stroke="black" points="1387.64,-981.32 1377.09,-982.25 1385.92,-988.1 1387.64,-981.32"/>
</g>
<!-- alltoall_expert&#45;&gt;expert_compute_5 -->
<g id="edge23" class="edge">
<title>alltoall_expert&#45;&gt;expert_compute_5</title>
<path fill="none" stroke="black" d="M1673.17,-1031.39C1646.71,-1018.8 1616.11,-1004.23 1588.6,-991.13"/>
<polygon fill="black" stroke="black" points="1589.93,-987.89 1579.4,-986.75 1586.93,-994.21 1589.93,-987.89"/>
</g>
<!-- alltoall_expert&#45;&gt;expert_compute_ellipsis -->
<g id="edge24" class="edge">
<title>alltoall_expert&#45;&gt;expert_compute_ellipsis</title>
<path fill="none" stroke="black" d="M1647.34,-1036.42C1626.64,-1031.21 1604.68,-1026.26 1584,-1022.71 1399.78,-991.12 1350.91,-1006.01 1165,-986.71 1112.07,-981.22 1053.45,-974.2 1004.31,-968.04"/>
<polygon fill="black" stroke="black" points="1004.65,-964.56 994.29,-966.79 1003.77,-971.5 1004.65,-964.56"/>
</g>
<!-- expert_agg -->
<g id="node25" class="node">
<title>expert_agg</title>
<polygon fill="lightgray" stroke="black" points="1729.58,-882.71 1380.28,-882.71 1290.42,-746.71 1639.72,-746.71 1729.58,-882.71"/>
<text text-anchor="middle" x="1510" y="-833.51" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="1510" y="-818.51" font-family="Times,serif" font-size="14.00">GPU: 2&#45;65</text>
<text text-anchor="middle" x="1510" y="-803.51" font-family="Times,serif" font-size="14.00">Input: [128,1024,2048]</text>
<text text-anchor="middle" x="1510" y="-788.51" font-family="Times,serif" font-size="14.00">Output: [128,1024,1024]</text>
</g>
<!-- expert_compute_2&#45;&gt;expert_agg -->
<g id="edge33" class="edge">
<title>expert_compute_2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1684.03,-918.62C1668.26,-909.29 1650.46,-898.77 1632.41,-888.1"/>
<polygon fill="black" stroke="black" points="1633.93,-884.93 1623.54,-882.85 1630.37,-890.95 1633.93,-884.93"/>
</g>
<!-- expert_compute_3&#45;&gt;expert_agg -->
<g id="edge34" class="edge">
<title>expert_compute_3&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1872.73,-922.95C1833.14,-911.25 1785.57,-897.19 1738.11,-883.15"/>
<polygon fill="black" stroke="black" points="1738.89,-879.73 1728.31,-880.26 1736.9,-886.45 1738.89,-879.73"/>
</g>
<!-- expert_compute_4&#45;&gt;expert_agg -->
<g id="edge35" class="edge">
<title>expert_compute_4&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1335.97,-918.62C1351.74,-909.29 1369.54,-898.77 1387.59,-888.1"/>
<polygon fill="black" stroke="black" points="1389.63,-890.95 1396.46,-882.85 1386.07,-884.93 1389.63,-890.95"/>
</g>
<!-- expert_compute_5&#45;&gt;expert_agg -->
<g id="edge36" class="edge">
<title>expert_compute_5&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1510,-918.44C1510,-910.62 1510,-901.95 1510,-893.07"/>
<polygon fill="black" stroke="black" points="1513.5,-892.98 1510,-882.98 1506.5,-892.98 1513.5,-892.98"/>
</g>
<!-- expert_compute_ellipsis&#45;&gt;expert_agg -->
<g id="edge37" class="edge">
<title>expert_compute_ellipsis&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M971.08,-934.69C1065.06,-913.95 1226.4,-878.33 1348.11,-851.45"/>
<polygon fill="black" stroke="black" points="1348.9,-854.86 1357.91,-849.29 1347.39,-848.03 1348.9,-854.86"/>
</g>
<!-- reduce_scatter -->
<g id="node26" class="node">
<title>reduce_scatter</title>
<ellipse fill="lightcoral" stroke="black" cx="1510" cy="-651.63" rx="130.63" ry="48.17"/>
<text text-anchor="middle" x="1510" y="-670.43" font-family="Times,serif" font-size="14.00">Reduce&#45;Scatter</text>
<text text-anchor="middle" x="1510" y="-655.43" font-family="Times,serif" font-size="14.00">GPU: 2&#45;65 → 66,67</text>
<text text-anchor="middle" x="1510" y="-640.43" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1510" y="-625.43" font-family="Times,serif" font-size="14.00">Output: [128,1024,512]</text>
</g>
<!-- expert_agg&#45;&gt;reduce_scatter -->
<g id="edge38" class="edge">
<title>expert_agg&#45;&gt;reduce_scatter</title>
<path fill="none" stroke="black" d="M1510,-746.33C1510,-734.33 1510,-721.93 1510,-710.23"/>
<polygon fill="black" stroke="black" points="1513.5,-710.16 1510,-700.16 1506.5,-710.16 1513.5,-710.16"/>
</g>
<!-- agg_0 -->
<g id="node27" class="node">
<title>agg_0</title>
<polygon fill="lightyellow" stroke="black" points="1491.5,-567.55 1306.5,-567.55 1306.5,-484.55 1491.5,-484.55 1491.5,-567.55"/>
<text text-anchor="middle" x="1399" y="-552.35" font-family="Times,serif" font-size="14.00">Aggregation Layer 0</text>
<text text-anchor="middle" x="1399" y="-537.35" font-family="Times,serif" font-size="14.00">GPU: 66</text>
<text text-anchor="middle" x="1399" y="-522.35" font-family="Times,serif" font-size="14.00">Input: [128,1024,512]</text>
<text text-anchor="middle" x="1399" y="-507.35" font-family="Times,serif" font-size="14.00">Output: [128,1024,512]</text>
<text text-anchor="middle" x="1399" y="-492.35" font-family="Times,serif" font-size="14.00">Weight: [512,1024]</text>
</g>
<!-- reduce_scatter&#45;&gt;agg_0 -->
<g id="edge39" class="edge">
<title>reduce_scatter&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1469.61,-605.66C1460.72,-595.76 1451.27,-585.24 1442.27,-575.22"/>
<polygon fill="black" stroke="black" points="1444.78,-572.78 1435.49,-567.68 1439.57,-577.45 1444.78,-572.78"/>
</g>
<!-- agg_1 -->
<g id="node28" class="node">
<title>agg_1</title>
<polygon fill="lightyellow" stroke="black" points="1712.5,-567.55 1527.5,-567.55 1527.5,-484.55 1712.5,-484.55 1712.5,-567.55"/>
<text text-anchor="middle" x="1620" y="-552.35" font-family="Times,serif" font-size="14.00">Aggregation Layer 1</text>
<text text-anchor="middle" x="1620" y="-537.35" font-family="Times,serif" font-size="14.00">GPU: 67</text>
<text text-anchor="middle" x="1620" y="-522.35" font-family="Times,serif" font-size="14.00">Input: [128,1024,512]</text>
<text text-anchor="middle" x="1620" y="-507.35" font-family="Times,serif" font-size="14.00">Output: [128,1024,512]</text>
<text text-anchor="middle" x="1620" y="-492.35" font-family="Times,serif" font-size="14.00">Weight: [512,1024]</text>
</g>
<!-- reduce_scatter&#45;&gt;agg_1 -->
<g id="edge40" class="edge">
<title>reduce_scatter&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1550.02,-605.66C1558.83,-595.76 1568.2,-585.24 1577.12,-575.22"/>
<polygon fill="black" stroke="black" points="1579.8,-577.47 1583.84,-567.68 1574.57,-572.82 1579.8,-577.47"/>
</g>
<!-- agg_allreduce -->
<g id="node29" class="node">
<title>agg_allreduce</title>
<ellipse fill="lightcoral" stroke="black" cx="1509" cy="-400.46" rx="137.36" ry="48.17"/>
<text text-anchor="middle" x="1509" y="-419.26" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1509" y="-404.26" font-family="Times,serif" font-size="14.00">GPU: 66,67</text>
<text text-anchor="middle" x="1509" y="-389.26" font-family="Times,serif" font-size="14.00">Input: [128,1024,512]</text>
<text text-anchor="middle" x="1509" y="-374.26" font-family="Times,serif" font-size="14.00">Output: [128,1024,1024]</text>
</g>
<!-- agg_0&#45;&gt;agg_allreduce -->
<g id="edge41" class="edge">
<title>agg_0&#45;&gt;agg_allreduce</title>
<path fill="none" stroke="black" d="M1435.32,-484.24C1443.9,-474.6 1453.17,-464.19 1462.13,-454.12"/>
<polygon fill="black" stroke="black" points="1464.89,-456.29 1468.92,-446.49 1459.66,-451.63 1464.89,-456.29"/>
</g>
<!-- agg_1&#45;&gt;agg_allreduce -->
<g id="edge42" class="edge">
<title>agg_1&#45;&gt;agg_allreduce</title>
<path fill="none" stroke="black" d="M1583.35,-484.24C1574.69,-474.6 1565.34,-464.19 1556.29,-454.12"/>
<polygon fill="black" stroke="black" points="1558.73,-451.59 1549.44,-446.49 1553.52,-456.27 1558.73,-451.59"/>
</g>
<!-- final_merge -->
<g id="node30" class="node">
<title>final_merge</title>
<polygon fill="lightgray" stroke="black" points="1710.26,-316.38 1390.1,-316.38 1307.74,-180.38 1627.9,-180.38 1710.26,-316.38"/>
<text text-anchor="middle" x="1509" y="-267.18" font-family="Times,serif" font-size="14.00">Final Output Merge</text>
<text text-anchor="middle" x="1509" y="-252.18" font-family="Times,serif" font-size="14.00">GPU: 66,67</text>
<text text-anchor="middle" x="1509" y="-237.18" font-family="Times,serif" font-size="14.00">Input: [128,1024,512]</text>
<text text-anchor="middle" x="1509" y="-222.18" font-family="Times,serif" font-size="14.00">Output: [128,1024,1024]</text>
</g>
<!-- agg_allreduce&#45;&gt;final_merge -->
<g id="edge43" class="edge">
<title>agg_allreduce&#45;&gt;final_merge</title>
<path fill="none" stroke="black" d="M1509,-351.98C1509,-343.89 1509,-335.31 1509,-326.69"/>
<polygon fill="black" stroke="black" points="1512.5,-326.57 1509,-316.57 1505.5,-326.57 1512.5,-326.57"/>
</g>
<!-- output -->
<g id="node31" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="1509" cy="-74.69" rx="137.36" ry="58.88"/>
<text text-anchor="middle" x="1509" y="-100.99" font-family="Times,serif" font-size="14.00">Output Layer</text>
<text text-anchor="middle" x="1509" y="-85.99" font-family="Times,serif" font-size="14.00">GPU: 66,67</text>
<text text-anchor="middle" x="1509" y="-70.99" font-family="Times,serif" font-size="14.00">Input: [128,1024,1024]</text>
<text text-anchor="middle" x="1509" y="-55.99" font-family="Times,serif" font-size="14.00">Output: [128,1024,1024]</text>
<text text-anchor="middle" x="1509" y="-40.99" font-family="Times,serif" font-size="14.00">(final hidden states)</text>
</g>
<!-- final_merge&#45;&gt;output -->
<g id="edge44" class="edge">
<title>final_merge&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1509,-180.02C1509,-168.1 1509,-155.68 1509,-143.75"/>
<polygon fill="black" stroke="black" points="1512.5,-143.41 1509,-133.41 1505.5,-143.41 1512.5,-143.41"/>
</g>
</g>
</svg>
