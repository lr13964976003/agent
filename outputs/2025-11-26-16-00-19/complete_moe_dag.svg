<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="11472pt" height="2150pt"
 viewBox="0.00 0.00 11472.00 2150.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2146.45)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2146.45 11468,-2146.45 11468,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="8,-454.23 8,-857.23 358,-857.23 358,-454.23 8,-454.23"/>
<text text-anchor="middle" x="183" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="366,-454.23 366,-857.23 716,-857.23 716,-454.23 366,-454.23"/>
<text text-anchor="middle" x="541" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="724,-454.23 724,-857.23 1074,-857.23 1074,-454.23 724,-454.23"/>
<text text-anchor="middle" x="899" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1082,-454.23 1082,-857.23 1432,-857.23 1432,-454.23 1082,-454.23"/>
<text text-anchor="middle" x="1257" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1440,-454.23 1440,-857.23 1790,-857.23 1790,-454.23 1440,-454.23"/>
<text text-anchor="middle" x="1615" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1798,-454.23 1798,-857.23 2148,-857.23 2148,-454.23 1798,-454.23"/>
<text text-anchor="middle" x="1973" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="2156,-454.23 2156,-857.23 2506,-857.23 2506,-454.23 2156,-454.23"/>
<text text-anchor="middle" x="2331" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="2514,-454.23 2514,-857.23 2864,-857.23 2864,-454.23 2514,-454.23"/>
<text text-anchor="middle" x="2689" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="2872,-454.23 2872,-857.23 3222,-857.23 3222,-454.23 2872,-454.23"/>
<text text-anchor="middle" x="3047" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="3230,-454.23 3230,-857.23 3580,-857.23 3580,-454.23 3230,-454.23"/>
<text text-anchor="middle" x="3405" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="3588,-454.23 3588,-857.23 3938,-857.23 3938,-454.23 3588,-454.23"/>
<text text-anchor="middle" x="3763" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="3946,-454.23 3946,-857.23 4296,-857.23 4296,-454.23 3946,-454.23"/>
<text text-anchor="middle" x="4121" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="4304,-454.23 4304,-857.23 4654,-857.23 4654,-454.23 4304,-454.23"/>
<text text-anchor="middle" x="4479" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="4662,-454.23 4662,-857.23 5012,-857.23 5012,-454.23 4662,-454.23"/>
<text text-anchor="middle" x="4837" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="5020,-454.23 5020,-857.23 5370,-857.23 5370,-454.23 5020,-454.23"/>
<text text-anchor="middle" x="5195" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="5378,-454.23 5378,-857.23 5728,-857.23 5728,-454.23 5378,-454.23"/>
<text text-anchor="middle" x="5553" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_gpu_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="5736,-454.23 5736,-857.23 6086,-857.23 6086,-454.23 5736,-454.23"/>
<text text-anchor="middle" x="5911" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 16</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_gpu_17</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="6094,-454.23 6094,-857.23 6444,-857.23 6444,-454.23 6094,-454.23"/>
<text text-anchor="middle" x="6269" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 17</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_gpu_18</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="6452,-454.23 6452,-857.23 6802,-857.23 6802,-454.23 6452,-454.23"/>
<text text-anchor="middle" x="6627" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 18</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_gpu_19</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="6810,-454.23 6810,-857.23 7160,-857.23 7160,-454.23 6810,-454.23"/>
<text text-anchor="middle" x="6985" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 19</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_gpu_20</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="7168,-454.23 7168,-857.23 7518,-857.23 7518,-454.23 7168,-454.23"/>
<text text-anchor="middle" x="7343" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 20</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_gpu_21</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="7526,-454.23 7526,-857.23 7876,-857.23 7876,-454.23 7526,-454.23"/>
<text text-anchor="middle" x="7701" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 21</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_gpu_22</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="7884,-454.23 7884,-857.23 8234,-857.23 8234,-454.23 7884,-454.23"/>
<text text-anchor="middle" x="8059" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 22</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_gpu_23</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="8242,-454.23 8242,-857.23 8592,-857.23 8592,-454.23 8242,-454.23"/>
<text text-anchor="middle" x="8417" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 23</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_gpu_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="8600,-454.23 8600,-857.23 8950,-857.23 8950,-454.23 8600,-454.23"/>
<text text-anchor="middle" x="8775" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 24</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_gpu_25</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="8958,-454.23 8958,-857.23 9308,-857.23 9308,-454.23 8958,-454.23"/>
<text text-anchor="middle" x="9133" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 25</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_gpu_26</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="9316,-454.23 9316,-857.23 9666,-857.23 9666,-454.23 9316,-454.23"/>
<text text-anchor="middle" x="9491" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 26</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_gpu_27</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="9674,-454.23 9674,-857.23 10024,-857.23 10024,-454.23 9674,-454.23"/>
<text text-anchor="middle" x="9849" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 27</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_gpu_28</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="10032,-454.23 10032,-857.23 10382,-857.23 10382,-454.23 10032,-454.23"/>
<text text-anchor="middle" x="10207" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 28</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_gpu_29</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="10390,-454.23 10390,-857.23 10740,-857.23 10740,-454.23 10390,-454.23"/>
<text text-anchor="middle" x="10565" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 29</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_gpu_30</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="10748,-454.23 10748,-857.23 11098,-857.23 11098,-454.23 10748,-454.23"/>
<text text-anchor="middle" x="10923" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 30</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_gpu_31</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11106,-454.23 11106,-857.23 11456,-857.23 11456,-454.23 11106,-454.23"/>
<text text-anchor="middle" x="11281" y="-842.03" font-family="Times,serif" font-size="14.00">GPU 31</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgray" stroke="black" points="6080.5,-2142.45 5925.5,-2142.45 5925.5,-2099.45 6080.5,-2099.45 6080.5,-2142.45"/>
<text text-anchor="middle" x="6003" y="-2128.05" font-family="Times,serif" font-size="8.00">Input Tokens</text>
<text text-anchor="middle" x="6003" y="-2119.05" font-family="Times,serif" font-size="8.00">GPU: All</text>
<text text-anchor="middle" x="6003" y="-2110.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- layernorm1 -->
<g id="node2" class="node">
<title>layernorm1</title>
<polygon fill="lightblue" stroke="black" points="6020,-2063.45 5856,-2063.45 5856,-2019.45 6020,-2019.45 6020,-2063.45"/>
<text text-anchor="middle" x="5938" y="-2053.05" font-family="Times,serif" font-size="8.00">LayerNorm</text>
<text text-anchor="middle" x="5938" y="-2044.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5938" y="-2035.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="5938" y="-2026.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- input&#45;&gt;layernorm1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layernorm1</title>
<path fill="none" stroke="black" d="M5972.75,-2099.23C5972.75,-2099.23 5972.75,-2073.7 5972.75,-2073.7"/>
<polygon fill="black" stroke="black" points="5976.25,-2073.7 5972.75,-2063.7 5969.25,-2073.7 5976.25,-2073.7"/>
</g>
<!-- mha_residual -->
<g id="node11" class="node">
<title>mha_residual</title>
<polygon fill="lightblue" stroke="black" points="6252,-1503.45 5980,-1503.45 5980,-1459.45 6252,-1459.45 6252,-1503.45"/>
<text text-anchor="middle" x="6116" y="-1493.05" font-family="Times,serif" font-size="8.00">MHA Residual Add</text>
<text text-anchor="middle" x="6116" y="-1484.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="6116" y="-1475.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168] + [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="6116" y="-1466.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- input&#45;&gt;mha_residual -->
<g id="edge13" class="edge">
<title>input&#45;&gt;mha_residual</title>
<path fill="none" stroke="black" d="M6080.69,-2120C6136.16,-2120 6201,-2120 6201,-2120 6201,-2120 6201,-1513.8 6201,-1513.8"/>
<polygon fill="black" stroke="black" points="6204.5,-1513.8 6201,-1503.8 6197.5,-1513.8 6204.5,-1513.8"/>
</g>
<!-- q_proj -->
<g id="node3" class="node">
<title>q_proj</title>
<polygon fill="lightblue" stroke="black" points="5707.5,-1983.45 5504.5,-1983.45 5504.5,-1939.45 5707.5,-1939.45 5707.5,-1983.45"/>
<text text-anchor="middle" x="5606" y="-1973.05" font-family="Times,serif" font-size="8.00">Query Projection (Linear)</text>
<text text-anchor="middle" x="5606" y="-1964.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5606" y="-1955.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="5606" y="-1946.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, Nh=128, Dh=128]</text>
</g>
<!-- layernorm1&#45;&gt;q_proj -->
<g id="edge2" class="edge">
<title>layernorm1&#45;&gt;q_proj</title>
<path fill="none" stroke="black" d="M5855.93,-2041C5757.62,-2041 5606,-2041 5606,-2041 5606,-2041 5606,-1993.61 5606,-1993.61"/>
<polygon fill="black" stroke="black" points="5609.5,-1993.61 5606,-1983.61 5602.5,-1993.61 5609.5,-1993.61"/>
</g>
<!-- k_proj -->
<g id="node4" class="node">
<title>k_proj</title>
<polygon fill="lightblue" stroke="black" points="5928.5,-1983.45 5725.5,-1983.45 5725.5,-1939.45 5928.5,-1939.45 5928.5,-1983.45"/>
<text text-anchor="middle" x="5827" y="-1973.05" font-family="Times,serif" font-size="8.00">Key Projection (Linear)</text>
<text text-anchor="middle" x="5827" y="-1964.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5827" y="-1955.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="5827" y="-1946.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, Nh=128, Dh=128]</text>
</g>
<!-- layernorm1&#45;&gt;k_proj -->
<g id="edge3" class="edge">
<title>layernorm1&#45;&gt;k_proj</title>
<path fill="none" stroke="black" d="M5892.25,-2019.17C5892.25,-2019.17 5892.25,-1993.62 5892.25,-1993.62"/>
<polygon fill="black" stroke="black" points="5895.75,-1993.62 5892.25,-1983.62 5888.75,-1993.62 5895.75,-1993.62"/>
</g>
<!-- v_proj -->
<g id="node5" class="node">
<title>v_proj</title>
<polygon fill="lightblue" stroke="black" points="6149.5,-1983.45 5946.5,-1983.45 5946.5,-1939.45 6149.5,-1939.45 6149.5,-1983.45"/>
<text text-anchor="middle" x="6048" y="-1973.05" font-family="Times,serif" font-size="8.00">Value Projection (Linear)</text>
<text text-anchor="middle" x="6048" y="-1964.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="6048" y="-1955.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="6048" y="-1946.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, Nh=128, Dh=128]</text>
</g>
<!-- layernorm1&#45;&gt;v_proj -->
<g id="edge4" class="edge">
<title>layernorm1&#45;&gt;v_proj</title>
<path fill="none" stroke="black" d="M5983.25,-2019.17C5983.25,-2019.17 5983.25,-1993.62 5983.25,-1993.62"/>
<polygon fill="black" stroke="black" points="5986.75,-1993.62 5983.25,-1983.62 5979.75,-1993.62 5986.75,-1993.62"/>
</g>
<!-- attention_scores -->
<g id="node6" class="node">
<title>attention_scores</title>
<polygon fill="lightblue" stroke="black" points="5999.5,-1903.45 5654.5,-1903.45 5654.5,-1859.45 5999.5,-1859.45 5999.5,-1903.45"/>
<text text-anchor="middle" x="5827" y="-1893.05" font-family="Times,serif" font-size="8.00">Attention Scores</text>
<text text-anchor="middle" x="5827" y="-1884.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5827" y="-1875.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, Nh=128, Dh=128]×[B=32, S=2048, Nh=128, Dh=128]</text>
<text text-anchor="middle" x="5827" y="-1866.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, Nh=128, S=2048, S=2048]</text>
</g>
<!-- q_proj&#45;&gt;attention_scores -->
<g id="edge5" class="edge">
<title>q_proj&#45;&gt;attention_scores</title>
<path fill="none" stroke="black" d="M5681,-1939.17C5681,-1939.17 5681,-1913.62 5681,-1913.62"/>
<polygon fill="black" stroke="black" points="5684.5,-1913.62 5681,-1903.62 5677.5,-1913.62 5684.5,-1913.62"/>
</g>
<!-- k_proj&#45;&gt;attention_scores -->
<g id="edge6" class="edge">
<title>k_proj&#45;&gt;attention_scores</title>
<path fill="none" stroke="black" d="M5827,-1939.17C5827,-1939.17 5827,-1913.62 5827,-1913.62"/>
<polygon fill="black" stroke="black" points="5830.5,-1913.62 5827,-1903.62 5823.5,-1913.62 5830.5,-1913.62"/>
</g>
<!-- attention_output -->
<g id="node8" class="node">
<title>attention_output</title>
<polygon fill="lightblue" stroke="black" points="6150,-1743.45 5806,-1743.45 5806,-1699.45 6150,-1699.45 6150,-1743.45"/>
<text text-anchor="middle" x="5978" y="-1733.05" font-family="Times,serif" font-size="8.00">Attention Output</text>
<text text-anchor="middle" x="5978" y="-1724.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5978" y="-1715.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, Nh=128, S=2048, S=2048]×[B=32, S=2048, Nh=128, Dh=128]</text>
<text text-anchor="middle" x="5978" y="-1706.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, Nh=128, Dh=128]</text>
</g>
<!-- v_proj&#45;&gt;attention_output -->
<g id="edge9" class="edge">
<title>v_proj&#45;&gt;attention_output</title>
<path fill="none" stroke="black" d="M6074.5,-1939.3C6074.5,-1939.3 6074.5,-1753.55 6074.5,-1753.55"/>
<polygon fill="black" stroke="black" points="6078,-1753.55 6074.5,-1743.55 6071,-1753.55 6078,-1753.55"/>
</g>
<!-- attention_weights -->
<g id="node7" class="node">
<title>attention_weights</title>
<polygon fill="lightblue" stroke="black" points="5968.5,-1823.45 5767.5,-1823.45 5767.5,-1779.45 5968.5,-1779.45 5968.5,-1823.45"/>
<text text-anchor="middle" x="5868" y="-1813.05" font-family="Times,serif" font-size="8.00">Softmax</text>
<text text-anchor="middle" x="5868" y="-1804.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5868" y="-1795.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, Nh=128, S=2048, S=2048]</text>
<text text-anchor="middle" x="5868" y="-1786.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, Nh=128, S=2048, S=2048]</text>
</g>
<!-- attention_scores&#45;&gt;attention_weights -->
<g id="edge7" class="edge">
<title>attention_scores&#45;&gt;attention_weights</title>
<path fill="none" stroke="black" d="M5868,-1859.17C5868,-1859.17 5868,-1833.62 5868,-1833.62"/>
<polygon fill="black" stroke="black" points="5871.5,-1833.62 5868,-1823.62 5864.5,-1833.62 5871.5,-1833.62"/>
</g>
<!-- attention_weights&#45;&gt;attention_output -->
<g id="edge8" class="edge">
<title>attention_weights&#45;&gt;attention_output</title>
<path fill="none" stroke="black" d="M5887.25,-1779.17C5887.25,-1779.17 5887.25,-1753.62 5887.25,-1753.62"/>
<polygon fill="black" stroke="black" points="5890.75,-1753.62 5887.25,-1743.62 5883.75,-1753.62 5890.75,-1753.62"/>
</g>
<!-- attention_reshape -->
<g id="node9" class="node">
<title>attention_reshape</title>
<polygon fill="lightblue" stroke="black" points="6113,-1663.45 5919,-1663.45 5919,-1619.45 6113,-1619.45 6113,-1663.45"/>
<text text-anchor="middle" x="6016" y="-1653.05" font-family="Times,serif" font-size="8.00">Reshape Attention</text>
<text text-anchor="middle" x="6016" y="-1644.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="6016" y="-1635.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, Nh=128, Dh=128]</text>
<text text-anchor="middle" x="6016" y="-1626.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- attention_output&#45;&gt;attention_reshape -->
<g id="edge10" class="edge">
<title>attention_output&#45;&gt;attention_reshape</title>
<path fill="none" stroke="black" d="M6016,-1699.17C6016,-1699.17 6016,-1673.62 6016,-1673.62"/>
<polygon fill="black" stroke="black" points="6019.5,-1673.62 6016,-1663.62 6012.5,-1673.62 6019.5,-1673.62"/>
</g>
<!-- mha_out_proj -->
<g id="node10" class="node">
<title>mha_out_proj</title>
<polygon fill="lightblue" stroke="black" points="6143,-1583.45 5979,-1583.45 5979,-1539.45 6143,-1539.45 6143,-1583.45"/>
<text text-anchor="middle" x="6061" y="-1573.05" font-family="Times,serif" font-size="8.00">MHA Output Projection</text>
<text text-anchor="middle" x="6061" y="-1564.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="6061" y="-1555.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="6061" y="-1546.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- attention_reshape&#45;&gt;mha_out_proj -->
<g id="edge11" class="edge">
<title>attention_reshape&#45;&gt;mha_out_proj</title>
<path fill="none" stroke="black" d="M6046,-1619.17C6046,-1619.17 6046,-1593.62 6046,-1593.62"/>
<polygon fill="black" stroke="black" points="6049.5,-1593.62 6046,-1583.62 6042.5,-1593.62 6049.5,-1593.62"/>
</g>
<!-- mha_out_proj&#45;&gt;mha_residual -->
<g id="edge12" class="edge">
<title>mha_out_proj&#45;&gt;mha_residual</title>
<path fill="none" stroke="black" d="M6061.5,-1539.17C6061.5,-1539.17 6061.5,-1513.62 6061.5,-1513.62"/>
<polygon fill="black" stroke="black" points="6065,-1513.62 6061.5,-1503.62 6058,-1513.62 6065,-1513.62"/>
</g>
<!-- gating -->
<g id="node12" class="node">
<title>gating</title>
<polygon fill="lightyellow" stroke="black" points="6077.61,-1423.45 5817.34,-1423.45 5750.39,-1335.45 6010.66,-1335.45 6077.61,-1423.45"/>
<text text-anchor="middle" x="5914" y="-1391.05" font-family="Times,serif" font-size="8.00">Gating Network (Linear)</text>
<text text-anchor="middle" x="5914" y="-1382.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5914" y="-1373.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="5914" y="-1364.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, Ne=32]</text>
</g>
<!-- mha_residual&#45;&gt;gating -->
<g id="edge14" class="edge">
<title>mha_residual&#45;&gt;gating</title>
<path fill="none" stroke="black" d="M6028.9,-1459.32C6028.9,-1459.32 6028.9,-1433.76 6028.9,-1433.76"/>
<polygon fill="black" stroke="black" points="6032.4,-1433.76 6028.9,-1423.76 6025.4,-1433.76 6032.4,-1433.76"/>
</g>
<!-- token_pack -->
<g id="node15" class="node">
<title>token_pack</title>
<polygon fill="lightyellow" stroke="black" points="6088.58,-1051.45 5794.95,-1051.45 5719.42,-963.45 6013.05,-963.45 6088.58,-1051.45"/>
<text text-anchor="middle" x="5904" y="-1019.05" font-family="Times,serif" font-size="8.00">Pack Tokens by Expert</text>
<text text-anchor="middle" x="5904" y="-1010.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5904" y="-1001.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="5904" y="-992.05" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens, H=7168] per expert</text>
</g>
<!-- mha_residual&#45;&gt;token_pack -->
<g id="edge18" class="edge">
<title>mha_residual&#45;&gt;token_pack</title>
<path fill="none" stroke="black" d="M6093.03,-1459.21C6093.03,-1370.27 6093.03,-1045 6093.03,-1045 6093.03,-1045 6092.04,-1045 6092.04,-1045"/>
<polygon fill="black" stroke="black" points="6093.13,-1041.5 6083.13,-1045 6093.13,-1048.5 6093.13,-1041.5"/>
</g>
<!-- ffn_residual -->
<g id="node244" class="node">
<title>ffn_residual</title>
<polygon fill="lightblue" stroke="black" points="10171,-124 9899,-124 9899,-80 10171,-80 10171,-124"/>
<text text-anchor="middle" x="10035" y="-113.6" font-family="Times,serif" font-size="8.00">FFN Residual Add</text>
<text text-anchor="middle" x="10035" y="-104.6" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="10035" y="-95.6" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168] + [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="10035" y="-86.6" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- mha_residual&#45;&gt;ffn_residual -->
<g id="edge343" class="edge">
<title>mha_residual&#45;&gt;ffn_residual</title>
<path fill="none" stroke="black" d="M6097.51,-1459.22C6097.51,-1281.79 6097.51,-102 6097.51,-102 6097.51,-102 9888.89,-102 9888.89,-102"/>
<polygon fill="black" stroke="black" points="9888.89,-105.5 9898.89,-102 9888.89,-98.5 9888.89,-105.5"/>
</g>
<!-- topk_gate -->
<g id="node13" class="node">
<title>topk_gate</title>
<polygon fill="lightyellow" stroke="black" points="6087.51,-1299.45 5795.59,-1299.45 5720.49,-1211.45 6012.41,-1211.45 6087.51,-1299.45"/>
<text text-anchor="middle" x="5904" y="-1267.05" font-family="Times,serif" font-size="8.00">Top&#45;K Selection (K=2)</text>
<text text-anchor="middle" x="5904" y="-1258.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5904" y="-1249.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, Ne=32]</text>
<text text-anchor="middle" x="5904" y="-1240.05" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, K=2] indices</text>
</g>
<!-- gating&#45;&gt;topk_gate -->
<g id="edge15" class="edge">
<title>gating&#45;&gt;topk_gate</title>
<path fill="none" stroke="black" d="M5914,-1335.38C5914,-1335.38 5914,-1309.79 5914,-1309.79"/>
<polygon fill="black" stroke="black" points="5917.5,-1309.79 5914,-1299.79 5910.5,-1309.79 5917.5,-1309.79"/>
</g>
<!-- token_counts -->
<g id="node14" class="node">
<title>token_counts</title>
<polygon fill="lightyellow" stroke="black" points="6078.35,-1175.45 5801,-1175.45 5729.65,-1087.45 6007,-1087.45 6078.35,-1175.45"/>
<text text-anchor="middle" x="5904" y="-1143.05" font-family="Times,serif" font-size="8.00">Compute Token Counts</text>
<text text-anchor="middle" x="5904" y="-1134.05" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="5904" y="-1125.05" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, K=2] indices</text>
<text text-anchor="middle" x="5904" y="-1116.05" font-family="Times,serif" font-size="8.00">OUTPUT: Expert token counts</text>
</g>
<!-- topk_gate&#45;&gt;token_counts -->
<g id="edge16" class="edge">
<title>topk_gate&#45;&gt;token_counts</title>
<path fill="none" stroke="black" d="M5904,-1211.38C5904,-1211.38 5904,-1185.79 5904,-1185.79"/>
<polygon fill="black" stroke="black" points="5907.5,-1185.79 5904,-1175.79 5900.5,-1185.79 5907.5,-1185.79"/>
</g>
<!-- token_counts&#45;&gt;token_pack -->
<g id="edge17" class="edge">
<title>token_counts&#45;&gt;token_pack</title>
<path fill="none" stroke="black" d="M5904,-1087.38C5904,-1087.38 5904,-1061.79 5904,-1061.79"/>
<polygon fill="black" stroke="black" points="5907.5,-1061.79 5904,-1051.79 5900.5,-1061.79 5907.5,-1061.79"/>
</g>
<!-- scatter_comm -->
<g id="node16" class="node">
<title>scatter_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="5823" cy="-896.34" rx="135.11" ry="31.23"/>
<text text-anchor="middle" x="5823" y="-907.94" font-family="Times,serif" font-size="8.00">All&#45;to&#45;All Scatter</text>
<text text-anchor="middle" x="5823" y="-898.94" font-family="Times,serif" font-size="8.00">Communication: NCCL</text>
<text text-anchor="middle" x="5823" y="-889.94" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens, H=7168] per expert</text>
<text text-anchor="middle" x="5823" y="-880.94" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168] per GPU</text>
</g>
<!-- token_pack&#45;&gt;scatter_comm -->
<g id="edge19" class="edge">
<title>token_pack&#45;&gt;scatter_comm</title>
<path fill="none" stroke="black" d="M5838.76,-963.22C5838.76,-963.22 5838.76,-937.43 5838.76,-937.43"/>
<polygon fill="black" stroke="black" points="5842.26,-937.43 5838.76,-927.43 5835.26,-937.43 5842.26,-937.43"/>
</g>
<!-- expert_0_ln -->
<g id="node17" class="node">
<title>expert_0_ln</title>
<polygon fill="lightblue" stroke="black" points="348,-826.23 194,-826.23 194,-782.23 348,-782.23 348,-826.23"/>
<text text-anchor="middle" x="271" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 0 LayerNorm</text>
<text text-anchor="middle" x="271" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="271" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="271" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_0_ln -->
<g id="edge29" class="edge">
<title>token_pack&#45;&gt;expert_0_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5790.01,-1046C4989.64,-1046 245.33,-1046 245.33,-1046 245.33,-1046 245.33,-836.54 245.33,-836.54"/>
<polygon fill="black" stroke="black" points="248.83,-836.54 245.33,-826.54 241.83,-836.54 248.83,-836.54"/>
</g>
<!-- expert_1_ln -->
<g id="node24" class="node">
<title>expert_1_ln</title>
<polygon fill="lightblue" stroke="black" points="706,-826.23 552,-826.23 552,-782.23 706,-782.23 706,-826.23"/>
<text text-anchor="middle" x="629" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 1 LayerNorm</text>
<text text-anchor="middle" x="629" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="629" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="629" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_1_ln -->
<g id="edge39" class="edge">
<title>token_pack&#45;&gt;expert_1_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5785.86,-1041C5003.75,-1041 603.33,-1041 603.33,-1041 603.33,-1041 603.33,-836.5 603.33,-836.5"/>
<polygon fill="black" stroke="black" points="606.83,-836.5 603.33,-826.5 599.83,-836.5 606.83,-836.5"/>
</g>
<!-- expert_2_ln -->
<g id="node31" class="node">
<title>expert_2_ln</title>
<polygon fill="lightblue" stroke="black" points="1064,-826.23 910,-826.23 910,-782.23 1064,-782.23 1064,-826.23"/>
<text text-anchor="middle" x="987" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 2 LayerNorm</text>
<text text-anchor="middle" x="987" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="987" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="987" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_2_ln -->
<g id="edge49" class="edge">
<title>token_pack&#45;&gt;expert_2_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5780.59,-1035C5016.32,-1035 961.33,-1035 961.33,-1035 961.33,-1035 961.33,-836.35 961.33,-836.35"/>
<polygon fill="black" stroke="black" points="964.83,-836.35 961.33,-826.35 957.83,-836.35 964.83,-836.35"/>
</g>
<!-- expert_3_ln -->
<g id="node38" class="node">
<title>expert_3_ln</title>
<polygon fill="lightblue" stroke="black" points="1422,-826.23 1268,-826.23 1268,-782.23 1422,-782.23 1422,-826.23"/>
<text text-anchor="middle" x="1345" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 3 LayerNorm</text>
<text text-anchor="middle" x="1345" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1345" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1345" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_3_ln -->
<g id="edge59" class="edge">
<title>token_pack&#45;&gt;expert_3_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5776.29,-1030C5035.13,-1030 1319.33,-1030 1319.33,-1030 1319.33,-1030 1319.33,-836.28 1319.33,-836.28"/>
<polygon fill="black" stroke="black" points="1322.83,-836.28 1319.33,-826.28 1315.83,-836.28 1322.83,-836.28"/>
</g>
<!-- expert_4_ln -->
<g id="node45" class="node">
<title>expert_4_ln</title>
<polygon fill="lightblue" stroke="black" points="1780,-826.23 1626,-826.23 1626,-782.23 1780,-782.23 1780,-826.23"/>
<text text-anchor="middle" x="1703" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 4 LayerNorm</text>
<text text-anchor="middle" x="1703" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1703" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1703" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_4_ln -->
<g id="edge69" class="edge">
<title>token_pack&#45;&gt;expert_4_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5771.99,-1025C5056.68,-1025 1677.33,-1025 1677.33,-1025 1677.33,-1025 1677.33,-836.61 1677.33,-836.61"/>
<polygon fill="black" stroke="black" points="1680.83,-836.61 1677.33,-826.61 1673.83,-836.61 1680.83,-836.61"/>
</g>
<!-- expert_5_ln -->
<g id="node52" class="node">
<title>expert_5_ln</title>
<polygon fill="lightblue" stroke="black" points="2138,-826.23 1984,-826.23 1984,-782.23 2138,-782.23 2138,-826.23"/>
<text text-anchor="middle" x="2061" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 5 LayerNorm</text>
<text text-anchor="middle" x="2061" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="2061" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2061" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_5_ln -->
<g id="edge79" class="edge">
<title>token_pack&#45;&gt;expert_5_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5767.73,-1020C5081.34,-1020 2035.33,-1020 2035.33,-1020 2035.33,-1020 2035.33,-836.5 2035.33,-836.5"/>
<polygon fill="black" stroke="black" points="2038.83,-836.5 2035.33,-826.5 2031.83,-836.5 2038.83,-836.5"/>
</g>
<!-- expert_6_ln -->
<g id="node59" class="node">
<title>expert_6_ln</title>
<polygon fill="lightblue" stroke="black" points="2496,-826.23 2342,-826.23 2342,-782.23 2496,-782.23 2496,-826.23"/>
<text text-anchor="middle" x="2419" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 6 LayerNorm</text>
<text text-anchor="middle" x="2419" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2419" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2419" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_6_ln -->
<g id="edge89" class="edge">
<title>token_pack&#45;&gt;expert_6_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5763.39,-1015C5109.01,-1015 2393.33,-1015 2393.33,-1015 2393.33,-1015 2393.33,-836.38 2393.33,-836.38"/>
<polygon fill="black" stroke="black" points="2396.83,-836.38 2393.33,-826.38 2389.83,-836.38 2396.83,-836.38"/>
</g>
<!-- expert_7_ln -->
<g id="node66" class="node">
<title>expert_7_ln</title>
<polygon fill="lightblue" stroke="black" points="2854,-826.23 2700,-826.23 2700,-782.23 2854,-782.23 2854,-826.23"/>
<text text-anchor="middle" x="2777" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 7 LayerNorm</text>
<text text-anchor="middle" x="2777" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2777" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2777" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_7_ln -->
<g id="edge99" class="edge">
<title>token_pack&#45;&gt;expert_7_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5759.31,-1010C5140.91,-1010 2751.33,-1010 2751.33,-1010 2751.33,-1010 2751.33,-836.25 2751.33,-836.25"/>
<polygon fill="black" stroke="black" points="2754.83,-836.25 2751.33,-826.25 2747.83,-836.25 2754.83,-836.25"/>
</g>
<!-- expert_8_ln -->
<g id="node73" class="node">
<title>expert_8_ln</title>
<polygon fill="lightblue" stroke="black" points="3212,-826.23 3058,-826.23 3058,-782.23 3212,-782.23 3212,-826.23"/>
<text text-anchor="middle" x="3135" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 8 LayerNorm</text>
<text text-anchor="middle" x="3135" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="3135" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3135" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_8_ln -->
<g id="edge109" class="edge">
<title>token_pack&#45;&gt;expert_8_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5753.75,-1004C5173.27,-1004 3109.33,-1004 3109.33,-1004 3109.33,-1004 3109.33,-836.37 3109.33,-836.37"/>
<polygon fill="black" stroke="black" points="3112.83,-836.37 3109.33,-826.37 3105.83,-836.37 3112.83,-836.37"/>
</g>
<!-- expert_9_ln -->
<g id="node80" class="node">
<title>expert_9_ln</title>
<polygon fill="lightblue" stroke="black" points="3570,-826.23 3416,-826.23 3416,-782.23 3570,-782.23 3570,-826.23"/>
<text text-anchor="middle" x="3493" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 9 LayerNorm</text>
<text text-anchor="middle" x="3493" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3493" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3493" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_9_ln -->
<g id="edge119" class="edge">
<title>token_pack&#45;&gt;expert_9_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5749.73,-999C5214.1,-999 3467.33,-999 3467.33,-999 3467.33,-999 3467.33,-836.57 3467.33,-836.57"/>
<polygon fill="black" stroke="black" points="3470.83,-836.57 3467.33,-826.57 3463.83,-836.57 3470.83,-836.57"/>
</g>
<!-- expert_10_ln -->
<g id="node87" class="node">
<title>expert_10_ln</title>
<polygon fill="lightblue" stroke="black" points="3928,-826.23 3774,-826.23 3774,-782.23 3928,-782.23 3928,-826.23"/>
<text text-anchor="middle" x="3851" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 10 LayerNorm</text>
<text text-anchor="middle" x="3851" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3851" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3851" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_10_ln -->
<g id="edge129" class="edge">
<title>token_pack&#45;&gt;expert_10_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5745.63,-994C5260.13,-994 3825.33,-994 3825.33,-994 3825.33,-994 3825.33,-836.37 3825.33,-836.37"/>
<polygon fill="black" stroke="black" points="3828.83,-836.37 3825.33,-826.37 3821.83,-836.37 3828.83,-836.37"/>
</g>
<!-- expert_11_ln -->
<g id="node94" class="node">
<title>expert_11_ln</title>
<polygon fill="lightblue" stroke="black" points="4286,-826.23 4132,-826.23 4132,-782.23 4286,-782.23 4286,-826.23"/>
<text text-anchor="middle" x="4209" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 11 LayerNorm</text>
<text text-anchor="middle" x="4209" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4209" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4209" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_11_ln -->
<g id="edge139" class="edge">
<title>token_pack&#45;&gt;expert_11_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5740.96,-989C5311.75,-989 4183.33,-989 4183.33,-989 4183.33,-989 4183.33,-836.51 4183.33,-836.51"/>
<polygon fill="black" stroke="black" points="4186.83,-836.51 4183.33,-826.51 4179.83,-836.51 4186.83,-836.51"/>
</g>
<!-- expert_12_ln -->
<g id="node101" class="node">
<title>expert_12_ln</title>
<polygon fill="lightblue" stroke="black" points="4644,-826.23 4490,-826.23 4490,-782.23 4644,-782.23 4644,-826.23"/>
<text text-anchor="middle" x="4567" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 12 LayerNorm</text>
<text text-anchor="middle" x="4567" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4567" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4567" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_12_ln -->
<g id="edge149" class="edge">
<title>token_pack&#45;&gt;expert_12_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5736.91,-984C5373.04,-984 4541.33,-984 4541.33,-984 4541.33,-984 4541.33,-836.27 4541.33,-836.27"/>
<polygon fill="black" stroke="black" points="4544.83,-836.27 4541.33,-826.27 4537.83,-836.27 4544.83,-836.27"/>
</g>
<!-- expert_13_ln -->
<g id="node108" class="node">
<title>expert_13_ln</title>
<polygon fill="lightblue" stroke="black" points="5002,-826.23 4848,-826.23 4848,-782.23 5002,-782.23 5002,-826.23"/>
<text text-anchor="middle" x="4925" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 13 LayerNorm</text>
<text text-anchor="middle" x="4925" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4925" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4925" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_13_ln -->
<g id="edge159" class="edge">
<title>token_pack&#45;&gt;expert_13_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5731.86,-978C5444.77,-978 4899.33,-978 4899.33,-978 4899.33,-978 4899.33,-836.23 4899.33,-836.23"/>
<polygon fill="black" stroke="black" points="4902.83,-836.23 4899.33,-826.23 4895.83,-836.23 4902.83,-836.23"/>
</g>
<!-- expert_14_ln -->
<g id="node115" class="node">
<title>expert_14_ln</title>
<polygon fill="lightblue" stroke="black" points="5360,-826.23 5206,-826.23 5206,-782.23 5360,-782.23 5360,-826.23"/>
<text text-anchor="middle" x="5283" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 14 LayerNorm</text>
<text text-anchor="middle" x="5283" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5283" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5283" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_14_ln -->
<g id="edge169" class="edge">
<title>token_pack&#45;&gt;expert_14_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5727.3,-973C5535.83,-973 5257.33,-973 5257.33,-973 5257.33,-973 5257.33,-836.29 5257.33,-836.29"/>
<polygon fill="black" stroke="black" points="5260.83,-836.29 5257.33,-826.29 5253.83,-836.29 5260.83,-836.29"/>
</g>
<!-- expert_15_ln -->
<g id="node122" class="node">
<title>expert_15_ln</title>
<polygon fill="lightblue" stroke="black" points="5718,-826.23 5564,-826.23 5564,-782.23 5718,-782.23 5718,-826.23"/>
<text text-anchor="middle" x="5641" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 15 LayerNorm</text>
<text text-anchor="middle" x="5641" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5641" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5641" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_15_ln -->
<g id="edge179" class="edge">
<title>token_pack&#45;&gt;expert_15_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5723.17,-968C5692.97,-968 5671.22,-968 5671.22,-968 5671.22,-968 5671.22,-836.31 5671.22,-836.31"/>
<polygon fill="black" stroke="black" points="5674.72,-836.31 5671.22,-826.31 5667.72,-836.31 5674.72,-836.31"/>
</g>
<!-- expert_16_ln -->
<g id="node129" class="node">
<title>expert_16_ln</title>
<polygon fill="lightblue" stroke="black" points="5900,-826.23 5746,-826.23 5746,-782.23 5900,-782.23 5900,-826.23"/>
<text text-anchor="middle" x="5823" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 16 LayerNorm</text>
<text text-anchor="middle" x="5823" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5823" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5823" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_16_ln -->
<g id="edge189" class="edge">
<title>token_pack&#45;&gt;expert_16_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6018.03,-969.22C6018.03,-909.04 6018.03,-799 6018.03,-799 6018.03,-799 5910.08,-799 5910.08,-799"/>
<polygon fill="black" stroke="black" points="5910.08,-795.5 5900.08,-799 5910.08,-802.5 5910.08,-795.5"/>
</g>
<!-- expert_17_ln -->
<g id="node136" class="node">
<title>expert_17_ln</title>
<polygon fill="lightblue" stroke="black" points="6258,-826.23 6104,-826.23 6104,-782.23 6258,-782.23 6258,-826.23"/>
<text text-anchor="middle" x="6181" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 17 LayerNorm</text>
<text text-anchor="middle" x="6181" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6181" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6181" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_17_ln -->
<g id="edge199" class="edge">
<title>token_pack&#45;&gt;expert_17_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6083.27,-1007.31C6083.27,-1001.55 6083.27,-817 6083.27,-817 6083.27,-817 6094,-817 6094,-817"/>
<polygon fill="black" stroke="black" points="6094,-820.5 6104,-817 6094,-813.5 6094,-820.5"/>
</g>
<!-- expert_18_ln -->
<g id="node143" class="node">
<title>expert_18_ln</title>
<polygon fill="lightblue" stroke="black" points="6616,-826.23 6462,-826.23 6462,-782.23 6616,-782.23 6616,-826.23"/>
<text text-anchor="middle" x="6539" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 18 LayerNorm</text>
<text text-anchor="middle" x="6539" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6539" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6539" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_18_ln -->
<g id="edge209" class="edge">
<title>token_pack&#45;&gt;expert_18_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6017.2,-968C6205.99,-968 6564.67,-968 6564.67,-968 6564.67,-968 6564.67,-836.31 6564.67,-836.31"/>
<polygon fill="black" stroke="black" points="6568.17,-836.31 6564.67,-826.31 6561.17,-836.31 6568.17,-836.31"/>
</g>
<!-- expert_19_ln -->
<g id="node150" class="node">
<title>expert_19_ln</title>
<polygon fill="lightblue" stroke="black" points="6974,-826.23 6820,-826.23 6820,-782.23 6974,-782.23 6974,-826.23"/>
<text text-anchor="middle" x="6897" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 19 LayerNorm</text>
<text text-anchor="middle" x="6897" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="6897" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6897" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_19_ln -->
<g id="edge219" class="edge">
<title>token_pack&#45;&gt;expert_19_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6022.35,-974C6290.78,-974 6922.67,-974 6922.67,-974 6922.67,-974 6922.67,-836.42 6922.67,-836.42"/>
<polygon fill="black" stroke="black" points="6926.17,-836.42 6922.67,-826.42 6919.17,-836.42 6926.17,-836.42"/>
</g>
<!-- expert_20_ln -->
<g id="node157" class="node">
<title>expert_20_ln</title>
<polygon fill="lightblue" stroke="black" points="7332,-826.23 7178,-826.23 7178,-782.23 7332,-782.23 7332,-826.23"/>
<text text-anchor="middle" x="7255" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 20 LayerNorm</text>
<text text-anchor="middle" x="7255" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7255" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7255" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_20_ln -->
<g id="edge229" class="edge">
<title>token_pack&#45;&gt;expert_20_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6026.47,-979C6363.64,-979 7280.67,-979 7280.67,-979 7280.67,-979 7280.67,-836.36 7280.67,-836.36"/>
<polygon fill="black" stroke="black" points="7284.17,-836.36 7280.67,-826.36 7277.17,-836.36 7284.17,-836.36"/>
</g>
<!-- expert_21_ln -->
<g id="node164" class="node">
<title>expert_21_ln</title>
<polygon fill="lightblue" stroke="black" points="7690,-826.23 7536,-826.23 7536,-782.23 7690,-782.23 7690,-826.23"/>
<text text-anchor="middle" x="7613" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 21 LayerNorm</text>
<text text-anchor="middle" x="7613" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7613" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7613" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_21_ln -->
<g id="edge239" class="edge">
<title>token_pack&#45;&gt;expert_21_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.55,-985C6432.15,-985 7638.67,-985 7638.67,-985 7638.67,-985 7638.67,-836.39 7638.67,-836.39"/>
<polygon fill="black" stroke="black" points="7642.17,-836.39 7638.67,-826.39 7635.17,-836.39 7642.17,-836.39"/>
</g>
<!-- expert_22_ln -->
<g id="node171" class="node">
<title>expert_22_ln</title>
<polygon fill="lightblue" stroke="black" points="8048,-826.23 7894,-826.23 7894,-782.23 8048,-782.23 8048,-826.23"/>
<text text-anchor="middle" x="7971" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 22 LayerNorm</text>
<text text-anchor="middle" x="7971" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="7971" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7971" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_22_ln -->
<g id="edge249" class="edge">
<title>token_pack&#45;&gt;expert_22_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6036.1,-990C6495.64,-990 7996.67,-990 7996.67,-990 7996.67,-990 7996.67,-836.27 7996.67,-836.27"/>
<polygon fill="black" stroke="black" points="8000.17,-836.27 7996.67,-826.27 7993.17,-836.27 8000.17,-836.27"/>
</g>
<!-- expert_23_ln -->
<g id="node178" class="node">
<title>expert_23_ln</title>
<polygon fill="lightblue" stroke="black" points="8406,-826.23 8252,-826.23 8252,-782.23 8406,-782.23 8406,-826.23"/>
<text text-anchor="middle" x="8329" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 23 LayerNorm</text>
<text text-anchor="middle" x="8329" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8329" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8329" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_23_ln -->
<g id="edge259" class="edge">
<title>token_pack&#45;&gt;expert_23_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6041.01,-996C6557.11,-996 8354.67,-996 8354.67,-996 8354.67,-996 8354.67,-836.6 8354.67,-836.6"/>
<polygon fill="black" stroke="black" points="8358.17,-836.6 8354.67,-826.6 8351.17,-836.6 8358.17,-836.6"/>
</g>
<!-- expert_24_ln -->
<g id="node185" class="node">
<title>expert_24_ln</title>
<polygon fill="lightblue" stroke="black" points="8764,-826.23 8610,-826.23 8610,-782.23 8764,-782.23 8764,-826.23"/>
<text text-anchor="middle" x="8687" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 24 LayerNorm</text>
<text text-anchor="middle" x="8687" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8687" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8687" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_24_ln -->
<g id="edge269" class="edge">
<title>token_pack&#45;&gt;expert_24_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6045.69,-1001C6615.94,-1001 8712.67,-1001 8712.67,-1001 8712.67,-1001 8712.67,-836.42 8712.67,-836.42"/>
<polygon fill="black" stroke="black" points="8716.17,-836.42 8712.67,-826.42 8709.17,-836.42 8716.17,-836.42"/>
</g>
<!-- expert_25_ln -->
<g id="node192" class="node">
<title>expert_25_ln</title>
<polygon fill="lightblue" stroke="black" points="9122,-826.23 8968,-826.23 8968,-782.23 9122,-782.23 9122,-826.23"/>
<text text-anchor="middle" x="9045" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 25 LayerNorm</text>
<text text-anchor="middle" x="9045" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9045" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9045" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_25_ln -->
<g id="edge279" class="edge">
<title>token_pack&#45;&gt;expert_25_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6050.65,-1007C6673.84,-1007 9070.67,-1007 9070.67,-1007 9070.67,-1007 9070.67,-836.31 9070.67,-836.31"/>
<polygon fill="black" stroke="black" points="9074.17,-836.31 9070.67,-826.31 9067.17,-836.31 9074.17,-836.31"/>
</g>
<!-- expert_26_ln -->
<g id="node199" class="node">
<title>expert_26_ln</title>
<polygon fill="lightblue" stroke="black" points="9480,-826.23 9326,-826.23 9326,-782.23 9480,-782.23 9480,-826.23"/>
<text text-anchor="middle" x="9403" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 26 LayerNorm</text>
<text text-anchor="middle" x="9403" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9403" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9403" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_26_ln -->
<g id="edge289" class="edge">
<title>token_pack&#45;&gt;expert_26_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6054.89,-1012C6728.59,-1012 9428.67,-1012 9428.67,-1012 9428.67,-1012 9428.67,-836.46 9428.67,-836.46"/>
<polygon fill="black" stroke="black" points="9432.17,-836.46 9428.67,-826.46 9425.17,-836.46 9432.17,-836.46"/>
</g>
<!-- expert_27_ln -->
<g id="node206" class="node">
<title>expert_27_ln</title>
<polygon fill="lightblue" stroke="black" points="9838,-826.23 9684,-826.23 9684,-782.23 9838,-782.23 9838,-826.23"/>
<text text-anchor="middle" x="9761" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 27 LayerNorm</text>
<text text-anchor="middle" x="9761" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9761" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9761" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_27_ln -->
<g id="edge299" class="edge">
<title>token_pack&#45;&gt;expert_27_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6060.11,-1018C6784.9,-1018 9786.67,-1018 9786.67,-1018 9786.67,-1018 9786.67,-836.3 9786.67,-836.3"/>
<polygon fill="black" stroke="black" points="9790.17,-836.3 9786.67,-826.3 9783.17,-836.3 9790.17,-836.3"/>
</g>
<!-- expert_28_ln -->
<g id="node213" class="node">
<title>expert_28_ln</title>
<polygon fill="lightblue" stroke="black" points="10196,-826.23 10042,-826.23 10042,-782.23 10196,-782.23 10196,-826.23"/>
<text text-anchor="middle" x="10119" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 28 LayerNorm</text>
<text text-anchor="middle" x="10119" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10119" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10119" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_28_ln -->
<g id="edge309" class="edge">
<title>token_pack&#45;&gt;expert_28_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6064.42,-1023C6837.84,-1023 10144.67,-1023 10144.67,-1023 10144.67,-1023 10144.67,-836.41 10144.67,-836.41"/>
<polygon fill="black" stroke="black" points="10148.17,-836.41 10144.67,-826.41 10141.17,-836.41 10148.17,-836.41"/>
</g>
<!-- expert_29_ln -->
<g id="node220" class="node">
<title>expert_29_ln</title>
<polygon fill="lightblue" stroke="black" points="10554,-826.23 10400,-826.23 10400,-782.23 10554,-782.23 10554,-826.23"/>
<text text-anchor="middle" x="10477" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 29 LayerNorm</text>
<text text-anchor="middle" x="10477" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10477" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10477" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_29_ln -->
<g id="edge319" class="edge">
<title>token_pack&#45;&gt;expert_29_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6069.36,-1029C6891.85,-1029 10502.67,-1029 10502.67,-1029 10502.67,-1029 10502.67,-836.6 10502.67,-836.6"/>
<polygon fill="black" stroke="black" points="10506.17,-836.6 10502.67,-826.6 10499.17,-836.6 10506.17,-836.6"/>
</g>
<!-- expert_30_ln -->
<g id="node227" class="node">
<title>expert_30_ln</title>
<polygon fill="lightblue" stroke="black" points="10912,-826.23 10758,-826.23 10758,-782.23 10912,-782.23 10912,-826.23"/>
<text text-anchor="middle" x="10835" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 30 LayerNorm</text>
<text text-anchor="middle" x="10835" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="10835" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10835" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_30_ln -->
<g id="edge329" class="edge">
<title>token_pack&#45;&gt;expert_30_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6073.9,-1034C6944.05,-1034 10860.67,-1034 10860.67,-1034 10860.67,-1034 10860.67,-836.26 10860.67,-836.26"/>
<polygon fill="black" stroke="black" points="10864.17,-836.26 10860.67,-826.26 10857.17,-836.26 10864.17,-836.26"/>
</g>
<!-- expert_31_ln -->
<g id="node234" class="node">
<title>expert_31_ln</title>
<polygon fill="lightblue" stroke="black" points="11270,-826.23 11116,-826.23 11116,-782.23 11270,-782.23 11270,-826.23"/>
<text text-anchor="middle" x="11193" y="-815.83" font-family="Times,serif" font-size="8.00">Expert 31 LayerNorm</text>
<text text-anchor="middle" x="11193" y="-806.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11193" y="-797.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="11193" y="-788.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- token_pack&#45;&gt;expert_31_ln -->
<g id="edge339" class="edge">
<title>token_pack&#45;&gt;expert_31_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6078.94,-1040C6997.22,-1040 11218.67,-1040 11218.67,-1040 11218.67,-1040 11218.67,-836.41 11218.67,-836.41"/>
<polygon fill="black" stroke="black" points="11222.17,-836.41 11218.67,-826.41 11215.17,-836.41 11222.17,-836.41"/>
</g>
<!-- scatter_comm&#45;&gt;expert_0_ln -->
<g id="edge20" class="edge">
<title>scatter_comm&#45;&gt;expert_0_ln</title>
<path fill="none" stroke="black" d="M5753.13,-923C5113.4,-923 296.67,-923 296.67,-923 296.67,-923 296.67,-836.29 296.67,-836.29"/>
<polygon fill="black" stroke="black" points="300.17,-836.29 296.67,-826.29 293.17,-836.29 300.17,-836.29"/>
</g>
<!-- scatter_comm&#45;&gt;expert_1_ln -->
<g id="edge30" class="edge">
<title>scatter_comm&#45;&gt;expert_1_ln</title>
<path fill="none" stroke="black" d="M5730.27,-919C5034.21,-919 654.67,-919 654.67,-919 654.67,-919 654.67,-836.36 654.67,-836.36"/>
<polygon fill="black" stroke="black" points="658.17,-836.36 654.67,-826.36 651.17,-836.36 658.17,-836.36"/>
</g>
<!-- scatter_comm&#45;&gt;expert_2_ln -->
<g id="edge40" class="edge">
<title>scatter_comm&#45;&gt;expert_2_ln</title>
<path fill="none" stroke="black" d="M5714.93,-915C5002.82,-915 1012.67,-915 1012.67,-915 1012.67,-915 1012.67,-836.38 1012.67,-836.38"/>
<polygon fill="black" stroke="black" points="1016.17,-836.38 1012.67,-826.38 1009.17,-836.38 1016.17,-836.38"/>
</g>
<!-- scatter_comm&#45;&gt;expert_3_ln -->
<g id="edge50" class="edge">
<title>scatter_comm&#45;&gt;expert_3_ln</title>
<path fill="none" stroke="black" d="M5703.62,-911C4994.88,-911 1370.67,-911 1370.67,-911 1370.67,-911 1370.67,-836.35 1370.67,-836.35"/>
<polygon fill="black" stroke="black" points="1374.17,-836.35 1370.67,-826.35 1367.17,-836.35 1374.17,-836.35"/>
</g>
<!-- scatter_comm&#45;&gt;expert_4_ln -->
<g id="edge60" class="edge">
<title>scatter_comm&#45;&gt;expert_4_ln</title>
<path fill="none" stroke="black" d="M5697.67,-908C5010.26,-908 1728.67,-908 1728.67,-908 1728.67,-908 1728.67,-836.23 1728.67,-836.23"/>
<polygon fill="black" stroke="black" points="1732.17,-836.23 1728.67,-826.23 1725.17,-836.23 1732.17,-836.23"/>
</g>
<!-- scatter_comm&#45;&gt;expert_5_ln -->
<g id="edge70" class="edge">
<title>scatter_comm&#45;&gt;expert_5_ln</title>
<path fill="none" stroke="black" d="M5691.94,-904C5030.1,-904 2086.67,-904 2086.67,-904 2086.67,-904 2086.67,-836.37 2086.67,-836.37"/>
<polygon fill="black" stroke="black" points="2090.17,-836.37 2086.67,-826.37 2083.17,-836.37 2090.17,-836.37"/>
</g>
<!-- scatter_comm&#45;&gt;expert_6_ln -->
<g id="edge80" class="edge">
<title>scatter_comm&#45;&gt;expert_6_ln</title>
<path fill="none" stroke="black" d="M5688.74,-900C5060.88,-900 2444.67,-900 2444.67,-900 2444.67,-900 2444.67,-836.44 2444.67,-836.44"/>
<polygon fill="black" stroke="black" points="2448.17,-836.44 2444.67,-826.44 2441.17,-836.44 2448.17,-836.44"/>
</g>
<!-- scatter_comm&#45;&gt;expert_7_ln -->
<g id="edge90" class="edge">
<title>scatter_comm&#45;&gt;expert_7_ln</title>
<path fill="none" stroke="black" d="M5687.85,-896C5100.94,-896 2802.67,-896 2802.67,-896 2802.67,-896 2802.67,-836.44 2802.67,-836.44"/>
<polygon fill="black" stroke="black" points="2806.17,-836.44 2802.67,-826.44 2799.17,-836.44 2806.17,-836.44"/>
</g>
<!-- scatter_comm&#45;&gt;expert_8_ln -->
<g id="edge100" class="edge">
<title>scatter_comm&#45;&gt;expert_8_ln</title>
<path fill="none" stroke="black" d="M5689.15,-892C5149.27,-892 3160.67,-892 3160.67,-892 3160.67,-892 3160.67,-836.37 3160.67,-836.37"/>
<polygon fill="black" stroke="black" points="3164.17,-836.37 3160.67,-826.37 3157.17,-836.37 3164.17,-836.37"/>
</g>
<!-- scatter_comm&#45;&gt;expert_9_ln -->
<g id="edge110" class="edge">
<title>scatter_comm&#45;&gt;expert_9_ln</title>
<path fill="none" stroke="black" d="M5692.51,-888C5205.04,-888 3518.67,-888 3518.67,-888 3518.67,-888 3518.67,-836.24 3518.67,-836.24"/>
<polygon fill="black" stroke="black" points="3522.17,-836.24 3518.67,-826.24 3515.17,-836.24 3522.17,-836.24"/>
</g>
<!-- scatter_comm&#45;&gt;expert_10_ln -->
<g id="edge120" class="edge">
<title>scatter_comm&#45;&gt;expert_10_ln</title>
<path fill="none" stroke="black" d="M5698.66,-884C5269.51,-884 3876.67,-884 3876.67,-884 3876.67,-884 3876.67,-836.45 3876.67,-836.45"/>
<polygon fill="black" stroke="black" points="3880.17,-836.45 3876.67,-826.45 3873.17,-836.45 3880.17,-836.45"/>
</g>
<!-- scatter_comm&#45;&gt;expert_11_ln -->
<g id="edge130" class="edge">
<title>scatter_comm&#45;&gt;expert_11_ln</title>
<path fill="none" stroke="black" d="M5707.81,-880C5342.64,-880 4234.67,-880 4234.67,-880 4234.67,-880 4234.67,-836.55 4234.67,-836.55"/>
<polygon fill="black" stroke="black" points="4238.17,-836.55 4234.67,-826.55 4231.17,-836.55 4238.17,-836.55"/>
</g>
<!-- scatter_comm&#45;&gt;expert_12_ln -->
<g id="edge140" class="edge">
<title>scatter_comm&#45;&gt;expert_12_ln</title>
<path fill="none" stroke="black" d="M5720.74,-876C5425.51,-876 4592.67,-876 4592.67,-876 4592.67,-876 4592.67,-836.54 4592.67,-836.54"/>
<polygon fill="black" stroke="black" points="4596.17,-836.54 4592.67,-826.54 4589.17,-836.54 4596.17,-836.54"/>
</g>
<!-- scatter_comm&#45;&gt;expert_13_ln -->
<g id="edge150" class="edge">
<title>scatter_comm&#45;&gt;expert_13_ln</title>
<path fill="none" stroke="black" d="M5733.34,-873C5510.73,-873 4950.67,-873 4950.67,-873 4950.67,-873 4950.67,-836.36 4950.67,-836.36"/>
<polygon fill="black" stroke="black" points="4954.17,-836.36 4950.67,-826.36 4947.17,-836.36 4954.17,-836.36"/>
</g>
<!-- scatter_comm&#45;&gt;expert_14_ln -->
<g id="edge160" class="edge">
<title>scatter_comm&#45;&gt;expert_14_ln</title>
<path fill="none" stroke="black" d="M5758.38,-869C5620.24,-869 5308.67,-869 5308.67,-869 5308.67,-869 5308.67,-836.52 5308.67,-836.52"/>
<polygon fill="black" stroke="black" points="5312.17,-836.52 5308.67,-826.52 5305.17,-836.52 5312.17,-836.52"/>
</g>
<!-- scatter_comm&#45;&gt;expert_15_ln -->
<g id="edge170" class="edge">
<title>scatter_comm&#45;&gt;expert_15_ln</title>
<path fill="none" stroke="black" d="M5702.97,-881.95C5702.97,-881.95 5702.97,-836.41 5702.97,-836.41"/>
<polygon fill="black" stroke="black" points="5706.47,-836.41 5702.97,-826.41 5699.47,-836.41 5706.47,-836.41"/>
</g>
<!-- scatter_comm&#45;&gt;expert_16_ln -->
<g id="edge180" class="edge">
<title>scatter_comm&#45;&gt;expert_16_ln</title>
<path fill="none" stroke="black" d="M5823,-865.15C5823,-865.15 5823,-836.36 5823,-836.36"/>
<polygon fill="black" stroke="black" points="5826.5,-836.36 5823,-826.36 5819.5,-836.36 5826.5,-836.36"/>
</g>
<!-- scatter_comm&#45;&gt;expert_17_ln -->
<g id="edge190" class="edge">
<title>scatter_comm&#45;&gt;expert_17_ln</title>
<path fill="none" stroke="black" d="M5945.37,-882.92C5945.37,-858.21 5945.37,-808 5945.37,-808 5945.37,-808 6093.85,-808 6093.85,-808"/>
<polygon fill="black" stroke="black" points="6093.85,-811.5 6103.85,-808 6093.85,-804.5 6093.85,-811.5"/>
</g>
<!-- scatter_comm&#45;&gt;expert_18_ln -->
<g id="edge200" class="edge">
<title>scatter_comm&#45;&gt;expert_18_ln</title>
<path fill="none" stroke="black" d="M5887.63,-869C6059.25,-869 6513.33,-869 6513.33,-869 6513.33,-869 6513.33,-836.52 6513.33,-836.52"/>
<polygon fill="black" stroke="black" points="6516.83,-836.52 6513.33,-826.52 6509.83,-836.52 6516.83,-836.52"/>
</g>
<!-- scatter_comm&#45;&gt;expert_19_ln -->
<g id="edge210" class="edge">
<title>scatter_comm&#45;&gt;expert_19_ln</title>
<path fill="none" stroke="black" d="M5912.38,-873C6165.9,-873 6871.33,-873 6871.33,-873 6871.33,-873 6871.33,-836.36 6871.33,-836.36"/>
<polygon fill="black" stroke="black" points="6874.83,-836.36 6871.33,-826.36 6867.83,-836.36 6874.83,-836.36"/>
</g>
<!-- scatter_comm&#45;&gt;expert_20_ln -->
<g id="edge220" class="edge">
<title>scatter_comm&#45;&gt;expert_20_ln</title>
<path fill="none" stroke="black" d="M5928.99,-877C6256.33,-877 7229.33,-877 7229.33,-877 7229.33,-877 7229.33,-836.46 7229.33,-836.46"/>
<polygon fill="black" stroke="black" points="7232.83,-836.46 7229.33,-826.46 7225.83,-836.46 7232.83,-836.46"/>
</g>
<!-- scatter_comm&#45;&gt;expert_21_ln -->
<g id="edge230" class="edge">
<title>scatter_comm&#45;&gt;expert_21_ln</title>
<path fill="none" stroke="black" d="M5940.81,-881C6335.64,-881 7587.33,-881 7587.33,-881 7587.33,-881 7587.33,-836.43 7587.33,-836.43"/>
<polygon fill="black" stroke="black" points="7590.83,-836.43 7587.33,-826.43 7583.83,-836.43 7590.83,-836.43"/>
</g>
<!-- scatter_comm&#45;&gt;expert_22_ln -->
<g id="edge240" class="edge">
<title>scatter_comm&#45;&gt;expert_22_ln</title>
<path fill="none" stroke="black" d="M5949.01,-885C6405.42,-885 7945.33,-885 7945.33,-885 7945.33,-885 7945.33,-836.3 7945.33,-836.3"/>
<polygon fill="black" stroke="black" points="7948.83,-836.3 7945.33,-826.3 7941.83,-836.3 7948.83,-836.3"/>
</g>
<!-- scatter_comm&#45;&gt;expert_23_ln -->
<g id="edge250" class="edge">
<title>scatter_comm&#45;&gt;expert_23_ln</title>
<path fill="none" stroke="black" d="M5955.48,-890C6469.46,-890 8303.33,-890 8303.33,-890 8303.33,-890 8303.33,-836.31 8303.33,-836.31"/>
<polygon fill="black" stroke="black" points="8306.83,-836.31 8303.33,-826.31 8299.83,-836.31 8306.83,-836.31"/>
</g>
<!-- scatter_comm&#45;&gt;expert_24_ln -->
<g id="edge260" class="edge">
<title>scatter_comm&#45;&gt;expert_24_ln</title>
<path fill="none" stroke="black" d="M5957.99,-894C6522.06,-894 8661.33,-894 8661.33,-894 8661.33,-894 8661.33,-836.42 8661.33,-836.42"/>
<polygon fill="black" stroke="black" points="8664.83,-836.42 8661.33,-826.42 8657.83,-836.42 8664.83,-836.42"/>
</g>
<!-- scatter_comm&#45;&gt;expert_25_ln -->
<g id="edge270" class="edge">
<title>scatter_comm&#45;&gt;expert_25_ln</title>
<path fill="none" stroke="black" d="M5958.05,-898C6565.99,-898 9019.33,-898 9019.33,-898 9019.33,-898 9019.33,-836.45 9019.33,-836.45"/>
<polygon fill="black" stroke="black" points="9022.83,-836.45 9019.33,-826.45 9015.83,-836.45 9022.83,-836.45"/>
</g>
<!-- scatter_comm&#45;&gt;expert_26_ln -->
<g id="edge280" class="edge">
<title>scatter_comm&#45;&gt;expert_26_ln</title>
<path fill="none" stroke="black" d="M5955.85,-902C6601.1,-902 9377.33,-902 9377.33,-902 9377.33,-902 9377.33,-836.41 9377.33,-836.41"/>
<polygon fill="black" stroke="black" points="9380.83,-836.41 9377.33,-826.41 9373.83,-836.41 9380.83,-836.41"/>
</g>
<!-- scatter_comm&#45;&gt;expert_27_ln -->
<g id="edge290" class="edge">
<title>scatter_comm&#45;&gt;expert_27_ln</title>
<path fill="none" stroke="black" d="M5951.5,-906C6626.91,-906 9735.33,-906 9735.33,-906 9735.33,-906 9735.33,-836.31 9735.33,-836.31"/>
<polygon fill="black" stroke="black" points="9738.83,-836.31 9735.33,-826.31 9731.83,-836.31 9738.83,-836.31"/>
</g>
<!-- scatter_comm&#45;&gt;expert_28_ln -->
<g id="edge300" class="edge">
<title>scatter_comm&#45;&gt;expert_28_ln</title>
<path fill="none" stroke="black" d="M5944.49,-910C6640.74,-910 10093.33,-910 10093.33,-910 10093.33,-910 10093.33,-836.4 10093.33,-836.4"/>
<polygon fill="black" stroke="black" points="10096.83,-836.4 10093.33,-826.4 10089.83,-836.4 10096.83,-836.4"/>
</g>
<!-- scatter_comm&#45;&gt;expert_29_ln -->
<g id="edge310" class="edge">
<title>scatter_comm&#45;&gt;expert_29_ln</title>
<path fill="none" stroke="black" d="M5931.15,-915C6627.57,-915 10451.33,-915 10451.33,-915 10451.33,-915 10451.33,-836.38 10451.33,-836.38"/>
<polygon fill="black" stroke="black" points="10454.83,-836.38 10451.33,-826.38 10447.83,-836.38 10454.83,-836.38"/>
</g>
<!-- scatter_comm&#45;&gt;expert_30_ln -->
<g id="edge320" class="edge">
<title>scatter_comm&#45;&gt;expert_30_ln</title>
<path fill="none" stroke="black" d="M5915.7,-919C6597.45,-919 10809.33,-919 10809.33,-919 10809.33,-919 10809.33,-836.36 10809.33,-836.36"/>
<polygon fill="black" stroke="black" points="10812.83,-836.36 10809.33,-826.36 10805.83,-836.36 10812.83,-836.36"/>
</g>
<!-- scatter_comm&#45;&gt;expert_31_ln -->
<g id="edge330" class="edge">
<title>scatter_comm&#45;&gt;expert_31_ln</title>
<path fill="none" stroke="black" d="M5893.02,-923C6521.4,-923 11167.33,-923 11167.33,-923 11167.33,-923 11167.33,-836.29 11167.33,-836.29"/>
<polygon fill="black" stroke="black" points="11170.83,-836.29 11167.33,-826.29 11163.83,-836.29 11170.83,-836.29"/>
</g>
<!-- expert_0_gate -->
<g id="node18" class="node">
<title>expert_0_gate</title>
<polygon fill="lightblue" stroke="black" points="174,-746.23 16,-746.23 16,-702.23 174,-702.23 174,-746.23"/>
<text text-anchor="middle" x="95" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 0 Gate</text>
<text text-anchor="middle" x="95" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="95" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="95" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_0_ln&#45;&gt;expert_0_gate -->
<g id="edge21" class="edge">
<title>expert_0_ln&#45;&gt;expert_0_gate</title>
<path fill="none" stroke="black" d="M193.8,-804C146.51,-804 95,-804 95,-804 95,-804 95,-756.45 95,-756.45"/>
<polygon fill="black" stroke="black" points="98.5,-756.45 95,-746.45 91.5,-756.45 98.5,-756.45"/>
</g>
<!-- expert_0_expert -->
<g id="node20" class="node">
<title>expert_0_expert</title>
<polygon fill="lightblue" stroke="black" points="350,-746.23 192,-746.23 192,-702.23 350,-702.23 350,-746.23"/>
<text text-anchor="middle" x="271" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 0 Expert</text>
<text text-anchor="middle" x="271" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="271" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="271" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_0_ln&#45;&gt;expert_0_expert -->
<g id="edge23" class="edge">
<title>expert_0_ln&#45;&gt;expert_0_expert</title>
<path fill="none" stroke="black" d="M271,-781.94C271,-781.94 271,-756.39 271,-756.39"/>
<polygon fill="black" stroke="black" points="274.5,-756.39 271,-746.39 267.5,-756.39 274.5,-756.39"/>
</g>
<!-- expert_0_gate_act -->
<g id="node19" class="node">
<title>expert_0_gate_act</title>
<polygon fill="lightblue" stroke="black" points="174,-666.23 16,-666.23 16,-622.23 174,-622.23 174,-666.23"/>
<text text-anchor="middle" x="95" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 0 SiLU</text>
<text text-anchor="middle" x="95" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="95" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="95" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_0_gate&#45;&gt;expert_0_gate_act -->
<g id="edge22" class="edge">
<title>expert_0_gate&#45;&gt;expert_0_gate_act</title>
<path fill="none" stroke="black" d="M95,-701.94C95,-701.94 95,-676.39 95,-676.39"/>
<polygon fill="black" stroke="black" points="98.5,-676.39 95,-666.39 91.5,-676.39 98.5,-676.39"/>
</g>
<!-- expert_0_multiply -->
<g id="node22" class="node">
<title>expert_0_multiply</title>
<polygon fill="lightblue" stroke="black" points="349.5,-586.23 88.5,-586.23 88.5,-542.23 349.5,-542.23 349.5,-586.23"/>
<text text-anchor="middle" x="219" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 0 Multiply</text>
<text text-anchor="middle" x="219" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="219" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="219" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_0_gate_act&#45;&gt;expert_0_multiply -->
<g id="edge25" class="edge">
<title>expert_0_gate_act&#45;&gt;expert_0_multiply</title>
<path fill="none" stroke="black" d="M131.25,-621.94C131.25,-621.94 131.25,-596.39 131.25,-596.39"/>
<polygon fill="black" stroke="black" points="134.75,-596.39 131.25,-586.39 127.75,-596.39 134.75,-596.39"/>
</g>
<!-- expert_0_expert_act -->
<g id="node21" class="node">
<title>expert_0_expert_act</title>
<polygon fill="lightblue" stroke="black" points="350,-666.23 192,-666.23 192,-622.23 350,-622.23 350,-666.23"/>
<text text-anchor="middle" x="271" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 0 Expert Act</text>
<text text-anchor="middle" x="271" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="271" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="271" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_0_expert&#45;&gt;expert_0_expert_act -->
<g id="edge24" class="edge">
<title>expert_0_expert&#45;&gt;expert_0_expert_act</title>
<path fill="none" stroke="black" d="M271,-701.94C271,-701.94 271,-676.39 271,-676.39"/>
<polygon fill="black" stroke="black" points="274.5,-676.39 271,-666.39 267.5,-676.39 274.5,-676.39"/>
</g>
<!-- expert_0_expert_act&#45;&gt;expert_0_multiply -->
<g id="edge26" class="edge">
<title>expert_0_expert_act&#45;&gt;expert_0_multiply</title>
<path fill="none" stroke="black" d="M270.75,-621.94C270.75,-621.94 270.75,-596.39 270.75,-596.39"/>
<polygon fill="black" stroke="black" points="274.25,-596.39 270.75,-586.39 267.25,-596.39 274.25,-596.39"/>
</g>
<!-- expert_0_out_proj -->
<g id="node23" class="node">
<title>expert_0_out_proj</title>
<polygon fill="lightblue" stroke="black" points="323,-506.23 169,-506.23 169,-462.23 323,-462.23 323,-506.23"/>
<text text-anchor="middle" x="246" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 0 Output Proj</text>
<text text-anchor="middle" x="246" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="246" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="246" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_0_multiply&#45;&gt;expert_0_out_proj -->
<g id="edge27" class="edge">
<title>expert_0_multiply&#45;&gt;expert_0_out_proj</title>
<path fill="none" stroke="black" d="M246,-541.94C246,-541.94 246,-516.39 246,-516.39"/>
<polygon fill="black" stroke="black" points="249.5,-516.39 246,-506.39 242.5,-516.39 249.5,-516.39"/>
</g>
<!-- gather_comm -->
<g id="node241" class="node">
<title>gather_comm</title>
<ellipse fill="lightcoral" stroke="black" cx="5911" cy="-395.11" rx="128.89" ry="31.23"/>
<text text-anchor="middle" x="5911" y="-406.71" font-family="Times,serif" font-size="8.00">All&#45;to&#45;All Gather</text>
<text text-anchor="middle" x="5911" y="-397.71" font-family="Times,serif" font-size="8.00">Communication: NCCL</text>
<text text-anchor="middle" x="5911" y="-388.71" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168] per GPU</text>
<text text-anchor="middle" x="5911" y="-379.71" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- expert_0_out_proj&#45;&gt;gather_comm -->
<g id="edge28" class="edge">
<title>expert_0_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M246,-462.18C246,-428.22 246,-367 246,-367 246,-367 5845.84,-367 5845.84,-367"/>
<polygon fill="black" stroke="black" points="5845.84,-370.5 5855.84,-367 5845.84,-363.5 5845.84,-370.5"/>
</g>
<!-- expert_1_gate -->
<g id="node25" class="node">
<title>expert_1_gate</title>
<polygon fill="lightblue" stroke="black" points="532,-746.23 374,-746.23 374,-702.23 532,-702.23 532,-746.23"/>
<text text-anchor="middle" x="453" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 1 Gate</text>
<text text-anchor="middle" x="453" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="453" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="453" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_1_ln&#45;&gt;expert_1_gate -->
<g id="edge31" class="edge">
<title>expert_1_ln&#45;&gt;expert_1_gate</title>
<path fill="none" stroke="black" d="M551.8,-804C504.51,-804 453,-804 453,-804 453,-804 453,-756.45 453,-756.45"/>
<polygon fill="black" stroke="black" points="456.5,-756.45 453,-746.45 449.5,-756.45 456.5,-756.45"/>
</g>
<!-- expert_1_expert -->
<g id="node27" class="node">
<title>expert_1_expert</title>
<polygon fill="lightblue" stroke="black" points="708,-746.23 550,-746.23 550,-702.23 708,-702.23 708,-746.23"/>
<text text-anchor="middle" x="629" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 1 Expert</text>
<text text-anchor="middle" x="629" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="629" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="629" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_1_ln&#45;&gt;expert_1_expert -->
<g id="edge33" class="edge">
<title>expert_1_ln&#45;&gt;expert_1_expert</title>
<path fill="none" stroke="black" d="M629,-781.94C629,-781.94 629,-756.39 629,-756.39"/>
<polygon fill="black" stroke="black" points="632.5,-756.39 629,-746.39 625.5,-756.39 632.5,-756.39"/>
</g>
<!-- expert_1_gate_act -->
<g id="node26" class="node">
<title>expert_1_gate_act</title>
<polygon fill="lightblue" stroke="black" points="532,-666.23 374,-666.23 374,-622.23 532,-622.23 532,-666.23"/>
<text text-anchor="middle" x="453" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 1 SiLU</text>
<text text-anchor="middle" x="453" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="453" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="453" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_1_gate&#45;&gt;expert_1_gate_act -->
<g id="edge32" class="edge">
<title>expert_1_gate&#45;&gt;expert_1_gate_act</title>
<path fill="none" stroke="black" d="M453,-701.94C453,-701.94 453,-676.39 453,-676.39"/>
<polygon fill="black" stroke="black" points="456.5,-676.39 453,-666.39 449.5,-676.39 456.5,-676.39"/>
</g>
<!-- expert_1_multiply -->
<g id="node29" class="node">
<title>expert_1_multiply</title>
<polygon fill="lightblue" stroke="black" points="707.5,-586.23 446.5,-586.23 446.5,-542.23 707.5,-542.23 707.5,-586.23"/>
<text text-anchor="middle" x="577" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 1 Multiply</text>
<text text-anchor="middle" x="577" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="577" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="577" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_1_gate_act&#45;&gt;expert_1_multiply -->
<g id="edge35" class="edge">
<title>expert_1_gate_act&#45;&gt;expert_1_multiply</title>
<path fill="none" stroke="black" d="M489.25,-621.94C489.25,-621.94 489.25,-596.39 489.25,-596.39"/>
<polygon fill="black" stroke="black" points="492.75,-596.39 489.25,-586.39 485.75,-596.39 492.75,-596.39"/>
</g>
<!-- expert_1_expert_act -->
<g id="node28" class="node">
<title>expert_1_expert_act</title>
<polygon fill="lightblue" stroke="black" points="708,-666.23 550,-666.23 550,-622.23 708,-622.23 708,-666.23"/>
<text text-anchor="middle" x="629" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 1 Expert Act</text>
<text text-anchor="middle" x="629" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="629" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="629" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_1_expert&#45;&gt;expert_1_expert_act -->
<g id="edge34" class="edge">
<title>expert_1_expert&#45;&gt;expert_1_expert_act</title>
<path fill="none" stroke="black" d="M629,-701.94C629,-701.94 629,-676.39 629,-676.39"/>
<polygon fill="black" stroke="black" points="632.5,-676.39 629,-666.39 625.5,-676.39 632.5,-676.39"/>
</g>
<!-- expert_1_expert_act&#45;&gt;expert_1_multiply -->
<g id="edge36" class="edge">
<title>expert_1_expert_act&#45;&gt;expert_1_multiply</title>
<path fill="none" stroke="black" d="M628.75,-621.94C628.75,-621.94 628.75,-596.39 628.75,-596.39"/>
<polygon fill="black" stroke="black" points="632.25,-596.39 628.75,-586.39 625.25,-596.39 632.25,-596.39"/>
</g>
<!-- expert_1_out_proj -->
<g id="node30" class="node">
<title>expert_1_out_proj</title>
<polygon fill="lightblue" stroke="black" points="681,-506.23 527,-506.23 527,-462.23 681,-462.23 681,-506.23"/>
<text text-anchor="middle" x="604" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 1 Output Proj</text>
<text text-anchor="middle" x="604" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="604" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="604" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_1_multiply&#45;&gt;expert_1_out_proj -->
<g id="edge37" class="edge">
<title>expert_1_multiply&#45;&gt;expert_1_out_proj</title>
<path fill="none" stroke="black" d="M604,-541.94C604,-541.94 604,-516.39 604,-516.39"/>
<polygon fill="black" stroke="black" points="607.5,-516.39 604,-506.39 600.5,-516.39 607.5,-516.39"/>
</g>
<!-- expert_1_out_proj&#45;&gt;gather_comm -->
<g id="edge38" class="edge">
<title>expert_1_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M604,-462.13C604,-429.17 604,-371 604,-371 604,-371 5819.5,-371 5819.5,-371"/>
<polygon fill="black" stroke="black" points="5819.5,-374.5 5829.5,-371 5819.5,-367.5 5819.5,-374.5"/>
</g>
<!-- expert_2_gate -->
<g id="node32" class="node">
<title>expert_2_gate</title>
<polygon fill="lightblue" stroke="black" points="890,-746.23 732,-746.23 732,-702.23 890,-702.23 890,-746.23"/>
<text text-anchor="middle" x="811" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 2 Gate</text>
<text text-anchor="middle" x="811" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="811" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="811" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_2_ln&#45;&gt;expert_2_gate -->
<g id="edge41" class="edge">
<title>expert_2_ln&#45;&gt;expert_2_gate</title>
<path fill="none" stroke="black" d="M909.8,-804C862.51,-804 811,-804 811,-804 811,-804 811,-756.45 811,-756.45"/>
<polygon fill="black" stroke="black" points="814.5,-756.45 811,-746.45 807.5,-756.45 814.5,-756.45"/>
</g>
<!-- expert_2_expert -->
<g id="node34" class="node">
<title>expert_2_expert</title>
<polygon fill="lightblue" stroke="black" points="1066,-746.23 908,-746.23 908,-702.23 1066,-702.23 1066,-746.23"/>
<text text-anchor="middle" x="987" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 2 Expert</text>
<text text-anchor="middle" x="987" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="987" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="987" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_2_ln&#45;&gt;expert_2_expert -->
<g id="edge43" class="edge">
<title>expert_2_ln&#45;&gt;expert_2_expert</title>
<path fill="none" stroke="black" d="M987,-781.94C987,-781.94 987,-756.39 987,-756.39"/>
<polygon fill="black" stroke="black" points="990.5,-756.39 987,-746.39 983.5,-756.39 990.5,-756.39"/>
</g>
<!-- expert_2_gate_act -->
<g id="node33" class="node">
<title>expert_2_gate_act</title>
<polygon fill="lightblue" stroke="black" points="890,-666.23 732,-666.23 732,-622.23 890,-622.23 890,-666.23"/>
<text text-anchor="middle" x="811" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 2 SiLU</text>
<text text-anchor="middle" x="811" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="811" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="811" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_2_gate&#45;&gt;expert_2_gate_act -->
<g id="edge42" class="edge">
<title>expert_2_gate&#45;&gt;expert_2_gate_act</title>
<path fill="none" stroke="black" d="M811,-701.94C811,-701.94 811,-676.39 811,-676.39"/>
<polygon fill="black" stroke="black" points="814.5,-676.39 811,-666.39 807.5,-676.39 814.5,-676.39"/>
</g>
<!-- expert_2_multiply -->
<g id="node36" class="node">
<title>expert_2_multiply</title>
<polygon fill="lightblue" stroke="black" points="1065.5,-586.23 804.5,-586.23 804.5,-542.23 1065.5,-542.23 1065.5,-586.23"/>
<text text-anchor="middle" x="935" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 2 Multiply</text>
<text text-anchor="middle" x="935" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="935" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="935" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_2_gate_act&#45;&gt;expert_2_multiply -->
<g id="edge45" class="edge">
<title>expert_2_gate_act&#45;&gt;expert_2_multiply</title>
<path fill="none" stroke="black" d="M847.25,-621.94C847.25,-621.94 847.25,-596.39 847.25,-596.39"/>
<polygon fill="black" stroke="black" points="850.75,-596.39 847.25,-586.39 843.75,-596.39 850.75,-596.39"/>
</g>
<!-- expert_2_expert_act -->
<g id="node35" class="node">
<title>expert_2_expert_act</title>
<polygon fill="lightblue" stroke="black" points="1066,-666.23 908,-666.23 908,-622.23 1066,-622.23 1066,-666.23"/>
<text text-anchor="middle" x="987" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 2 Expert Act</text>
<text text-anchor="middle" x="987" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="987" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="987" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_2_expert&#45;&gt;expert_2_expert_act -->
<g id="edge44" class="edge">
<title>expert_2_expert&#45;&gt;expert_2_expert_act</title>
<path fill="none" stroke="black" d="M987,-701.94C987,-701.94 987,-676.39 987,-676.39"/>
<polygon fill="black" stroke="black" points="990.5,-676.39 987,-666.39 983.5,-676.39 990.5,-676.39"/>
</g>
<!-- expert_2_expert_act&#45;&gt;expert_2_multiply -->
<g id="edge46" class="edge">
<title>expert_2_expert_act&#45;&gt;expert_2_multiply</title>
<path fill="none" stroke="black" d="M986.75,-621.94C986.75,-621.94 986.75,-596.39 986.75,-596.39"/>
<polygon fill="black" stroke="black" points="990.25,-596.39 986.75,-586.39 983.25,-596.39 990.25,-596.39"/>
</g>
<!-- expert_2_out_proj -->
<g id="node37" class="node">
<title>expert_2_out_proj</title>
<polygon fill="lightblue" stroke="black" points="1039,-506.23 885,-506.23 885,-462.23 1039,-462.23 1039,-506.23"/>
<text text-anchor="middle" x="962" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 2 Output Proj</text>
<text text-anchor="middle" x="962" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="962" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="962" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_2_multiply&#45;&gt;expert_2_out_proj -->
<g id="edge47" class="edge">
<title>expert_2_multiply&#45;&gt;expert_2_out_proj</title>
<path fill="none" stroke="black" d="M962,-541.94C962,-541.94 962,-516.39 962,-516.39"/>
<polygon fill="black" stroke="black" points="965.5,-516.39 962,-506.39 958.5,-516.39 965.5,-516.39"/>
</g>
<!-- expert_2_out_proj&#45;&gt;gather_comm -->
<g id="edge48" class="edge">
<title>expert_2_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M962,-462.12C962,-430.21 962,-375 962,-375 962,-375 5802.7,-375 5802.7,-375"/>
<polygon fill="black" stroke="black" points="5802.7,-378.5 5812.7,-375 5802.7,-371.5 5802.7,-378.5"/>
</g>
<!-- expert_3_gate -->
<g id="node39" class="node">
<title>expert_3_gate</title>
<polygon fill="lightblue" stroke="black" points="1248,-746.23 1090,-746.23 1090,-702.23 1248,-702.23 1248,-746.23"/>
<text text-anchor="middle" x="1169" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 3 Gate</text>
<text text-anchor="middle" x="1169" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1169" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1169" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_3_ln&#45;&gt;expert_3_gate -->
<g id="edge51" class="edge">
<title>expert_3_ln&#45;&gt;expert_3_gate</title>
<path fill="none" stroke="black" d="M1267.8,-804C1220.51,-804 1169,-804 1169,-804 1169,-804 1169,-756.45 1169,-756.45"/>
<polygon fill="black" stroke="black" points="1172.5,-756.45 1169,-746.45 1165.5,-756.45 1172.5,-756.45"/>
</g>
<!-- expert_3_expert -->
<g id="node41" class="node">
<title>expert_3_expert</title>
<polygon fill="lightblue" stroke="black" points="1424,-746.23 1266,-746.23 1266,-702.23 1424,-702.23 1424,-746.23"/>
<text text-anchor="middle" x="1345" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 3 Expert</text>
<text text-anchor="middle" x="1345" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1345" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1345" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_3_ln&#45;&gt;expert_3_expert -->
<g id="edge53" class="edge">
<title>expert_3_ln&#45;&gt;expert_3_expert</title>
<path fill="none" stroke="black" d="M1345,-781.94C1345,-781.94 1345,-756.39 1345,-756.39"/>
<polygon fill="black" stroke="black" points="1348.5,-756.39 1345,-746.39 1341.5,-756.39 1348.5,-756.39"/>
</g>
<!-- expert_3_gate_act -->
<g id="node40" class="node">
<title>expert_3_gate_act</title>
<polygon fill="lightblue" stroke="black" points="1248,-666.23 1090,-666.23 1090,-622.23 1248,-622.23 1248,-666.23"/>
<text text-anchor="middle" x="1169" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 3 SiLU</text>
<text text-anchor="middle" x="1169" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1169" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1169" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_3_gate&#45;&gt;expert_3_gate_act -->
<g id="edge52" class="edge">
<title>expert_3_gate&#45;&gt;expert_3_gate_act</title>
<path fill="none" stroke="black" d="M1169,-701.94C1169,-701.94 1169,-676.39 1169,-676.39"/>
<polygon fill="black" stroke="black" points="1172.5,-676.39 1169,-666.39 1165.5,-676.39 1172.5,-676.39"/>
</g>
<!-- expert_3_multiply -->
<g id="node43" class="node">
<title>expert_3_multiply</title>
<polygon fill="lightblue" stroke="black" points="1423.5,-586.23 1162.5,-586.23 1162.5,-542.23 1423.5,-542.23 1423.5,-586.23"/>
<text text-anchor="middle" x="1293" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 3 Multiply</text>
<text text-anchor="middle" x="1293" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1293" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1293" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_3_gate_act&#45;&gt;expert_3_multiply -->
<g id="edge55" class="edge">
<title>expert_3_gate_act&#45;&gt;expert_3_multiply</title>
<path fill="none" stroke="black" d="M1205.25,-621.94C1205.25,-621.94 1205.25,-596.39 1205.25,-596.39"/>
<polygon fill="black" stroke="black" points="1208.75,-596.39 1205.25,-586.39 1201.75,-596.39 1208.75,-596.39"/>
</g>
<!-- expert_3_expert_act -->
<g id="node42" class="node">
<title>expert_3_expert_act</title>
<polygon fill="lightblue" stroke="black" points="1424,-666.23 1266,-666.23 1266,-622.23 1424,-622.23 1424,-666.23"/>
<text text-anchor="middle" x="1345" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 3 Expert Act</text>
<text text-anchor="middle" x="1345" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1345" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1345" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_3_expert&#45;&gt;expert_3_expert_act -->
<g id="edge54" class="edge">
<title>expert_3_expert&#45;&gt;expert_3_expert_act</title>
<path fill="none" stroke="black" d="M1345,-701.94C1345,-701.94 1345,-676.39 1345,-676.39"/>
<polygon fill="black" stroke="black" points="1348.5,-676.39 1345,-666.39 1341.5,-676.39 1348.5,-676.39"/>
</g>
<!-- expert_3_expert_act&#45;&gt;expert_3_multiply -->
<g id="edge56" class="edge">
<title>expert_3_expert_act&#45;&gt;expert_3_multiply</title>
<path fill="none" stroke="black" d="M1344.75,-621.94C1344.75,-621.94 1344.75,-596.39 1344.75,-596.39"/>
<polygon fill="black" stroke="black" points="1348.25,-596.39 1344.75,-586.39 1341.25,-596.39 1348.25,-596.39"/>
</g>
<!-- expert_3_out_proj -->
<g id="node44" class="node">
<title>expert_3_out_proj</title>
<polygon fill="lightblue" stroke="black" points="1397,-506.23 1243,-506.23 1243,-462.23 1397,-462.23 1397,-506.23"/>
<text text-anchor="middle" x="1320" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 3 Output Proj</text>
<text text-anchor="middle" x="1320" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1320" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1320" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_3_multiply&#45;&gt;expert_3_out_proj -->
<g id="edge57" class="edge">
<title>expert_3_multiply&#45;&gt;expert_3_out_proj</title>
<path fill="none" stroke="black" d="M1320,-541.94C1320,-541.94 1320,-516.39 1320,-516.39"/>
<polygon fill="black" stroke="black" points="1323.5,-516.39 1320,-506.39 1316.5,-516.39 1323.5,-516.39"/>
</g>
<!-- expert_3_out_proj&#45;&gt;gather_comm -->
<g id="edge58" class="edge">
<title>expert_3_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M1320,-462.17C1320,-431.31 1320,-379 1320,-379 1320,-379 5790.64,-379 5790.64,-379"/>
<polygon fill="black" stroke="black" points="5790.64,-382.5 5800.64,-379 5790.64,-375.5 5790.64,-382.5"/>
</g>
<!-- expert_4_gate -->
<g id="node46" class="node">
<title>expert_4_gate</title>
<polygon fill="lightblue" stroke="black" points="1606,-746.23 1448,-746.23 1448,-702.23 1606,-702.23 1606,-746.23"/>
<text text-anchor="middle" x="1527" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 4 Gate</text>
<text text-anchor="middle" x="1527" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1527" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1527" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_4_ln&#45;&gt;expert_4_gate -->
<g id="edge61" class="edge">
<title>expert_4_ln&#45;&gt;expert_4_gate</title>
<path fill="none" stroke="black" d="M1625.8,-804C1578.51,-804 1527,-804 1527,-804 1527,-804 1527,-756.45 1527,-756.45"/>
<polygon fill="black" stroke="black" points="1530.5,-756.45 1527,-746.45 1523.5,-756.45 1530.5,-756.45"/>
</g>
<!-- expert_4_expert -->
<g id="node48" class="node">
<title>expert_4_expert</title>
<polygon fill="lightblue" stroke="black" points="1782,-746.23 1624,-746.23 1624,-702.23 1782,-702.23 1782,-746.23"/>
<text text-anchor="middle" x="1703" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 4 Expert</text>
<text text-anchor="middle" x="1703" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1703" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1703" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_4_ln&#45;&gt;expert_4_expert -->
<g id="edge63" class="edge">
<title>expert_4_ln&#45;&gt;expert_4_expert</title>
<path fill="none" stroke="black" d="M1703,-781.94C1703,-781.94 1703,-756.39 1703,-756.39"/>
<polygon fill="black" stroke="black" points="1706.5,-756.39 1703,-746.39 1699.5,-756.39 1706.5,-756.39"/>
</g>
<!-- expert_4_gate_act -->
<g id="node47" class="node">
<title>expert_4_gate_act</title>
<polygon fill="lightblue" stroke="black" points="1606,-666.23 1448,-666.23 1448,-622.23 1606,-622.23 1606,-666.23"/>
<text text-anchor="middle" x="1527" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 4 SiLU</text>
<text text-anchor="middle" x="1527" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1527" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1527" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_4_gate&#45;&gt;expert_4_gate_act -->
<g id="edge62" class="edge">
<title>expert_4_gate&#45;&gt;expert_4_gate_act</title>
<path fill="none" stroke="black" d="M1527,-701.94C1527,-701.94 1527,-676.39 1527,-676.39"/>
<polygon fill="black" stroke="black" points="1530.5,-676.39 1527,-666.39 1523.5,-676.39 1530.5,-676.39"/>
</g>
<!-- expert_4_multiply -->
<g id="node50" class="node">
<title>expert_4_multiply</title>
<polygon fill="lightblue" stroke="black" points="1781.5,-586.23 1520.5,-586.23 1520.5,-542.23 1781.5,-542.23 1781.5,-586.23"/>
<text text-anchor="middle" x="1651" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 4 Multiply</text>
<text text-anchor="middle" x="1651" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1651" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1651" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_4_gate_act&#45;&gt;expert_4_multiply -->
<g id="edge65" class="edge">
<title>expert_4_gate_act&#45;&gt;expert_4_multiply</title>
<path fill="none" stroke="black" d="M1563.25,-621.94C1563.25,-621.94 1563.25,-596.39 1563.25,-596.39"/>
<polygon fill="black" stroke="black" points="1566.75,-596.39 1563.25,-586.39 1559.75,-596.39 1566.75,-596.39"/>
</g>
<!-- expert_4_expert_act -->
<g id="node49" class="node">
<title>expert_4_expert_act</title>
<polygon fill="lightblue" stroke="black" points="1782,-666.23 1624,-666.23 1624,-622.23 1782,-622.23 1782,-666.23"/>
<text text-anchor="middle" x="1703" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 4 Expert Act</text>
<text text-anchor="middle" x="1703" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1703" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1703" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_4_expert&#45;&gt;expert_4_expert_act -->
<g id="edge64" class="edge">
<title>expert_4_expert&#45;&gt;expert_4_expert_act</title>
<path fill="none" stroke="black" d="M1703,-701.94C1703,-701.94 1703,-676.39 1703,-676.39"/>
<polygon fill="black" stroke="black" points="1706.5,-676.39 1703,-666.39 1699.5,-676.39 1706.5,-676.39"/>
</g>
<!-- expert_4_expert_act&#45;&gt;expert_4_multiply -->
<g id="edge66" class="edge">
<title>expert_4_expert_act&#45;&gt;expert_4_multiply</title>
<path fill="none" stroke="black" d="M1702.75,-621.94C1702.75,-621.94 1702.75,-596.39 1702.75,-596.39"/>
<polygon fill="black" stroke="black" points="1706.25,-596.39 1702.75,-586.39 1699.25,-596.39 1706.25,-596.39"/>
</g>
<!-- expert_4_out_proj -->
<g id="node51" class="node">
<title>expert_4_out_proj</title>
<polygon fill="lightblue" stroke="black" points="1755,-506.23 1601,-506.23 1601,-462.23 1755,-462.23 1755,-506.23"/>
<text text-anchor="middle" x="1678" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 4 Output Proj</text>
<text text-anchor="middle" x="1678" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1678" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1678" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_4_multiply&#45;&gt;expert_4_out_proj -->
<g id="edge67" class="edge">
<title>expert_4_multiply&#45;&gt;expert_4_out_proj</title>
<path fill="none" stroke="black" d="M1678,-541.94C1678,-541.94 1678,-516.39 1678,-516.39"/>
<polygon fill="black" stroke="black" points="1681.5,-516.39 1678,-506.39 1674.5,-516.39 1681.5,-516.39"/>
</g>
<!-- expert_4_out_proj&#45;&gt;gather_comm -->
<g id="edge68" class="edge">
<title>expert_4_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M1678,-462.01C1678,-432.21 1678,-383 1678,-383 1678,-383 5782.25,-383 5782.25,-383"/>
<polygon fill="black" stroke="black" points="5782.25,-386.5 5792.25,-383 5782.25,-379.5 5782.25,-386.5"/>
</g>
<!-- expert_5_gate -->
<g id="node53" class="node">
<title>expert_5_gate</title>
<polygon fill="lightblue" stroke="black" points="1964,-746.23 1806,-746.23 1806,-702.23 1964,-702.23 1964,-746.23"/>
<text text-anchor="middle" x="1885" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 5 Gate</text>
<text text-anchor="middle" x="1885" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="1885" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="1885" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_5_ln&#45;&gt;expert_5_gate -->
<g id="edge71" class="edge">
<title>expert_5_ln&#45;&gt;expert_5_gate</title>
<path fill="none" stroke="black" d="M1983.8,-804C1936.51,-804 1885,-804 1885,-804 1885,-804 1885,-756.45 1885,-756.45"/>
<polygon fill="black" stroke="black" points="1888.5,-756.45 1885,-746.45 1881.5,-756.45 1888.5,-756.45"/>
</g>
<!-- expert_5_expert -->
<g id="node55" class="node">
<title>expert_5_expert</title>
<polygon fill="lightblue" stroke="black" points="2140,-746.23 1982,-746.23 1982,-702.23 2140,-702.23 2140,-746.23"/>
<text text-anchor="middle" x="2061" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 5 Expert</text>
<text text-anchor="middle" x="2061" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="2061" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2061" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_5_ln&#45;&gt;expert_5_expert -->
<g id="edge73" class="edge">
<title>expert_5_ln&#45;&gt;expert_5_expert</title>
<path fill="none" stroke="black" d="M2061,-781.94C2061,-781.94 2061,-756.39 2061,-756.39"/>
<polygon fill="black" stroke="black" points="2064.5,-756.39 2061,-746.39 2057.5,-756.39 2064.5,-756.39"/>
</g>
<!-- expert_5_gate_act -->
<g id="node54" class="node">
<title>expert_5_gate_act</title>
<polygon fill="lightblue" stroke="black" points="1964,-666.23 1806,-666.23 1806,-622.23 1964,-622.23 1964,-666.23"/>
<text text-anchor="middle" x="1885" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 5 SiLU</text>
<text text-anchor="middle" x="1885" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="1885" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="1885" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_5_gate&#45;&gt;expert_5_gate_act -->
<g id="edge72" class="edge">
<title>expert_5_gate&#45;&gt;expert_5_gate_act</title>
<path fill="none" stroke="black" d="M1885,-701.94C1885,-701.94 1885,-676.39 1885,-676.39"/>
<polygon fill="black" stroke="black" points="1888.5,-676.39 1885,-666.39 1881.5,-676.39 1888.5,-676.39"/>
</g>
<!-- expert_5_multiply -->
<g id="node57" class="node">
<title>expert_5_multiply</title>
<polygon fill="lightblue" stroke="black" points="2139.5,-586.23 1878.5,-586.23 1878.5,-542.23 2139.5,-542.23 2139.5,-586.23"/>
<text text-anchor="middle" x="2009" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 5 Multiply</text>
<text text-anchor="middle" x="2009" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="2009" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2009" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_5_gate_act&#45;&gt;expert_5_multiply -->
<g id="edge75" class="edge">
<title>expert_5_gate_act&#45;&gt;expert_5_multiply</title>
<path fill="none" stroke="black" d="M1921.25,-621.94C1921.25,-621.94 1921.25,-596.39 1921.25,-596.39"/>
<polygon fill="black" stroke="black" points="1924.75,-596.39 1921.25,-586.39 1917.75,-596.39 1924.75,-596.39"/>
</g>
<!-- expert_5_expert_act -->
<g id="node56" class="node">
<title>expert_5_expert_act</title>
<polygon fill="lightblue" stroke="black" points="2140,-666.23 1982,-666.23 1982,-622.23 2140,-622.23 2140,-666.23"/>
<text text-anchor="middle" x="2061" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 5 Expert Act</text>
<text text-anchor="middle" x="2061" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="2061" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2061" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_5_expert&#45;&gt;expert_5_expert_act -->
<g id="edge74" class="edge">
<title>expert_5_expert&#45;&gt;expert_5_expert_act</title>
<path fill="none" stroke="black" d="M2061,-701.94C2061,-701.94 2061,-676.39 2061,-676.39"/>
<polygon fill="black" stroke="black" points="2064.5,-676.39 2061,-666.39 2057.5,-676.39 2064.5,-676.39"/>
</g>
<!-- expert_5_expert_act&#45;&gt;expert_5_multiply -->
<g id="edge76" class="edge">
<title>expert_5_expert_act&#45;&gt;expert_5_multiply</title>
<path fill="none" stroke="black" d="M2060.75,-621.94C2060.75,-621.94 2060.75,-596.39 2060.75,-596.39"/>
<polygon fill="black" stroke="black" points="2064.25,-596.39 2060.75,-586.39 2057.25,-596.39 2064.25,-596.39"/>
</g>
<!-- expert_5_out_proj -->
<g id="node58" class="node">
<title>expert_5_out_proj</title>
<polygon fill="lightblue" stroke="black" points="2113,-506.23 1959,-506.23 1959,-462.23 2113,-462.23 2113,-506.23"/>
<text text-anchor="middle" x="2036" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 5 Output Proj</text>
<text text-anchor="middle" x="2036" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="2036" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2036" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_5_multiply&#45;&gt;expert_5_out_proj -->
<g id="edge77" class="edge">
<title>expert_5_multiply&#45;&gt;expert_5_out_proj</title>
<path fill="none" stroke="black" d="M2036,-541.94C2036,-541.94 2036,-516.39 2036,-516.39"/>
<polygon fill="black" stroke="black" points="2039.5,-516.39 2036,-506.39 2032.5,-516.39 2039.5,-516.39"/>
</g>
<!-- expert_5_out_proj&#45;&gt;gather_comm -->
<g id="edge78" class="edge">
<title>expert_5_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M2036,-462.16C2036,-433.48 2036,-387 2036,-387 2036,-387 5776.73,-387 5776.73,-387"/>
<polygon fill="black" stroke="black" points="5776.73,-390.5 5786.73,-387 5776.73,-383.5 5776.73,-390.5"/>
</g>
<!-- expert_6_gate -->
<g id="node60" class="node">
<title>expert_6_gate</title>
<polygon fill="lightblue" stroke="black" points="2322,-746.23 2164,-746.23 2164,-702.23 2322,-702.23 2322,-746.23"/>
<text text-anchor="middle" x="2243" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 6 Gate</text>
<text text-anchor="middle" x="2243" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2243" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2243" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_6_ln&#45;&gt;expert_6_gate -->
<g id="edge81" class="edge">
<title>expert_6_ln&#45;&gt;expert_6_gate</title>
<path fill="none" stroke="black" d="M2341.8,-804C2294.51,-804 2243,-804 2243,-804 2243,-804 2243,-756.45 2243,-756.45"/>
<polygon fill="black" stroke="black" points="2246.5,-756.45 2243,-746.45 2239.5,-756.45 2246.5,-756.45"/>
</g>
<!-- expert_6_expert -->
<g id="node62" class="node">
<title>expert_6_expert</title>
<polygon fill="lightblue" stroke="black" points="2498,-746.23 2340,-746.23 2340,-702.23 2498,-702.23 2498,-746.23"/>
<text text-anchor="middle" x="2419" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 6 Expert</text>
<text text-anchor="middle" x="2419" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2419" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2419" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_6_ln&#45;&gt;expert_6_expert -->
<g id="edge83" class="edge">
<title>expert_6_ln&#45;&gt;expert_6_expert</title>
<path fill="none" stroke="black" d="M2419,-781.94C2419,-781.94 2419,-756.39 2419,-756.39"/>
<polygon fill="black" stroke="black" points="2422.5,-756.39 2419,-746.39 2415.5,-756.39 2422.5,-756.39"/>
</g>
<!-- expert_6_gate_act -->
<g id="node61" class="node">
<title>expert_6_gate_act</title>
<polygon fill="lightblue" stroke="black" points="2322,-666.23 2164,-666.23 2164,-622.23 2322,-622.23 2322,-666.23"/>
<text text-anchor="middle" x="2243" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 6 SiLU</text>
<text text-anchor="middle" x="2243" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2243" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2243" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_6_gate&#45;&gt;expert_6_gate_act -->
<g id="edge82" class="edge">
<title>expert_6_gate&#45;&gt;expert_6_gate_act</title>
<path fill="none" stroke="black" d="M2243,-701.94C2243,-701.94 2243,-676.39 2243,-676.39"/>
<polygon fill="black" stroke="black" points="2246.5,-676.39 2243,-666.39 2239.5,-676.39 2246.5,-676.39"/>
</g>
<!-- expert_6_multiply -->
<g id="node64" class="node">
<title>expert_6_multiply</title>
<polygon fill="lightblue" stroke="black" points="2497.5,-586.23 2236.5,-586.23 2236.5,-542.23 2497.5,-542.23 2497.5,-586.23"/>
<text text-anchor="middle" x="2367" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 6 Multiply</text>
<text text-anchor="middle" x="2367" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2367" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2367" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_6_gate_act&#45;&gt;expert_6_multiply -->
<g id="edge85" class="edge">
<title>expert_6_gate_act&#45;&gt;expert_6_multiply</title>
<path fill="none" stroke="black" d="M2279.25,-621.94C2279.25,-621.94 2279.25,-596.39 2279.25,-596.39"/>
<polygon fill="black" stroke="black" points="2282.75,-596.39 2279.25,-586.39 2275.75,-596.39 2282.75,-596.39"/>
</g>
<!-- expert_6_expert_act -->
<g id="node63" class="node">
<title>expert_6_expert_act</title>
<polygon fill="lightblue" stroke="black" points="2498,-666.23 2340,-666.23 2340,-622.23 2498,-622.23 2498,-666.23"/>
<text text-anchor="middle" x="2419" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 6 Expert Act</text>
<text text-anchor="middle" x="2419" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2419" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2419" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_6_expert&#45;&gt;expert_6_expert_act -->
<g id="edge84" class="edge">
<title>expert_6_expert&#45;&gt;expert_6_expert_act</title>
<path fill="none" stroke="black" d="M2419,-701.94C2419,-701.94 2419,-676.39 2419,-676.39"/>
<polygon fill="black" stroke="black" points="2422.5,-676.39 2419,-666.39 2415.5,-676.39 2422.5,-676.39"/>
</g>
<!-- expert_6_expert_act&#45;&gt;expert_6_multiply -->
<g id="edge86" class="edge">
<title>expert_6_expert_act&#45;&gt;expert_6_multiply</title>
<path fill="none" stroke="black" d="M2418.75,-621.94C2418.75,-621.94 2418.75,-596.39 2418.75,-596.39"/>
<polygon fill="black" stroke="black" points="2422.25,-596.39 2418.75,-586.39 2415.25,-596.39 2422.25,-596.39"/>
</g>
<!-- expert_6_out_proj -->
<g id="node65" class="node">
<title>expert_6_out_proj</title>
<polygon fill="lightblue" stroke="black" points="2471,-506.23 2317,-506.23 2317,-462.23 2471,-462.23 2471,-506.23"/>
<text text-anchor="middle" x="2394" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 6 Output Proj</text>
<text text-anchor="middle" x="2394" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2394" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2394" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_6_multiply&#45;&gt;expert_6_out_proj -->
<g id="edge87" class="edge">
<title>expert_6_multiply&#45;&gt;expert_6_out_proj</title>
<path fill="none" stroke="black" d="M2394,-541.94C2394,-541.94 2394,-516.39 2394,-516.39"/>
<polygon fill="black" stroke="black" points="2397.5,-516.39 2394,-506.39 2390.5,-516.39 2397.5,-516.39"/>
</g>
<!-- expert_6_out_proj&#45;&gt;gather_comm -->
<g id="edge88" class="edge">
<title>expert_6_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M2394,-462.13C2394,-434.56 2394,-391 2394,-391 2394,-391 5773.23,-391 5773.23,-391"/>
<polygon fill="black" stroke="black" points="5773.23,-394.5 5783.23,-391 5773.23,-387.5 5773.23,-394.5"/>
</g>
<!-- expert_7_gate -->
<g id="node67" class="node">
<title>expert_7_gate</title>
<polygon fill="lightblue" stroke="black" points="2680,-746.23 2522,-746.23 2522,-702.23 2680,-702.23 2680,-746.23"/>
<text text-anchor="middle" x="2601" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 7 Gate</text>
<text text-anchor="middle" x="2601" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2601" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2601" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_7_ln&#45;&gt;expert_7_gate -->
<g id="edge91" class="edge">
<title>expert_7_ln&#45;&gt;expert_7_gate</title>
<path fill="none" stroke="black" d="M2699.8,-804C2652.51,-804 2601,-804 2601,-804 2601,-804 2601,-756.45 2601,-756.45"/>
<polygon fill="black" stroke="black" points="2604.5,-756.45 2601,-746.45 2597.5,-756.45 2604.5,-756.45"/>
</g>
<!-- expert_7_expert -->
<g id="node69" class="node">
<title>expert_7_expert</title>
<polygon fill="lightblue" stroke="black" points="2856,-746.23 2698,-746.23 2698,-702.23 2856,-702.23 2856,-746.23"/>
<text text-anchor="middle" x="2777" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 7 Expert</text>
<text text-anchor="middle" x="2777" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2777" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2777" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_7_ln&#45;&gt;expert_7_expert -->
<g id="edge93" class="edge">
<title>expert_7_ln&#45;&gt;expert_7_expert</title>
<path fill="none" stroke="black" d="M2777,-781.94C2777,-781.94 2777,-756.39 2777,-756.39"/>
<polygon fill="black" stroke="black" points="2780.5,-756.39 2777,-746.39 2773.5,-756.39 2780.5,-756.39"/>
</g>
<!-- expert_7_gate_act -->
<g id="node68" class="node">
<title>expert_7_gate_act</title>
<polygon fill="lightblue" stroke="black" points="2680,-666.23 2522,-666.23 2522,-622.23 2680,-622.23 2680,-666.23"/>
<text text-anchor="middle" x="2601" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 7 SiLU</text>
<text text-anchor="middle" x="2601" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2601" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2601" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_7_gate&#45;&gt;expert_7_gate_act -->
<g id="edge92" class="edge">
<title>expert_7_gate&#45;&gt;expert_7_gate_act</title>
<path fill="none" stroke="black" d="M2601,-701.94C2601,-701.94 2601,-676.39 2601,-676.39"/>
<polygon fill="black" stroke="black" points="2604.5,-676.39 2601,-666.39 2597.5,-676.39 2604.5,-676.39"/>
</g>
<!-- expert_7_multiply -->
<g id="node71" class="node">
<title>expert_7_multiply</title>
<polygon fill="lightblue" stroke="black" points="2855.5,-586.23 2594.5,-586.23 2594.5,-542.23 2855.5,-542.23 2855.5,-586.23"/>
<text text-anchor="middle" x="2725" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 7 Multiply</text>
<text text-anchor="middle" x="2725" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2725" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2725" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_7_gate_act&#45;&gt;expert_7_multiply -->
<g id="edge95" class="edge">
<title>expert_7_gate_act&#45;&gt;expert_7_multiply</title>
<path fill="none" stroke="black" d="M2637.25,-621.94C2637.25,-621.94 2637.25,-596.39 2637.25,-596.39"/>
<polygon fill="black" stroke="black" points="2640.75,-596.39 2637.25,-586.39 2633.75,-596.39 2640.75,-596.39"/>
</g>
<!-- expert_7_expert_act -->
<g id="node70" class="node">
<title>expert_7_expert_act</title>
<polygon fill="lightblue" stroke="black" points="2856,-666.23 2698,-666.23 2698,-622.23 2856,-622.23 2856,-666.23"/>
<text text-anchor="middle" x="2777" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 7 Expert Act</text>
<text text-anchor="middle" x="2777" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2777" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2777" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_7_expert&#45;&gt;expert_7_expert_act -->
<g id="edge94" class="edge">
<title>expert_7_expert&#45;&gt;expert_7_expert_act</title>
<path fill="none" stroke="black" d="M2777,-701.94C2777,-701.94 2777,-676.39 2777,-676.39"/>
<polygon fill="black" stroke="black" points="2780.5,-676.39 2777,-666.39 2773.5,-676.39 2780.5,-676.39"/>
</g>
<!-- expert_7_expert_act&#45;&gt;expert_7_multiply -->
<g id="edge96" class="edge">
<title>expert_7_expert_act&#45;&gt;expert_7_multiply</title>
<path fill="none" stroke="black" d="M2776.75,-621.94C2776.75,-621.94 2776.75,-596.39 2776.75,-596.39"/>
<polygon fill="black" stroke="black" points="2780.25,-596.39 2776.75,-586.39 2773.25,-596.39 2780.25,-596.39"/>
</g>
<!-- expert_7_out_proj -->
<g id="node72" class="node">
<title>expert_7_out_proj</title>
<polygon fill="lightblue" stroke="black" points="2829,-506.23 2675,-506.23 2675,-462.23 2829,-462.23 2829,-506.23"/>
<text text-anchor="middle" x="2752" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 7 Output Proj</text>
<text text-anchor="middle" x="2752" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2752" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2752" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_7_multiply&#45;&gt;expert_7_out_proj -->
<g id="edge97" class="edge">
<title>expert_7_multiply&#45;&gt;expert_7_out_proj</title>
<path fill="none" stroke="black" d="M2752,-541.94C2752,-541.94 2752,-516.39 2752,-516.39"/>
<polygon fill="black" stroke="black" points="2755.5,-516.39 2752,-506.39 2748.5,-516.39 2755.5,-516.39"/>
</g>
<!-- expert_7_out_proj&#45;&gt;gather_comm -->
<g id="edge98" class="edge">
<title>expert_7_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M2752,-462.17C2752,-435.75 2752,-395 2752,-395 2752,-395 5772.26,-395 5772.26,-395"/>
<polygon fill="black" stroke="black" points="5772.26,-398.5 5782.26,-395 5772.26,-391.5 5772.26,-398.5"/>
</g>
<!-- expert_8_gate -->
<g id="node74" class="node">
<title>expert_8_gate</title>
<polygon fill="lightblue" stroke="black" points="3038,-746.23 2880,-746.23 2880,-702.23 3038,-702.23 3038,-746.23"/>
<text text-anchor="middle" x="2959" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 8 Gate</text>
<text text-anchor="middle" x="2959" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="2959" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="2959" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_8_ln&#45;&gt;expert_8_gate -->
<g id="edge101" class="edge">
<title>expert_8_ln&#45;&gt;expert_8_gate</title>
<path fill="none" stroke="black" d="M3057.8,-804C3010.51,-804 2959,-804 2959,-804 2959,-804 2959,-756.45 2959,-756.45"/>
<polygon fill="black" stroke="black" points="2962.5,-756.45 2959,-746.45 2955.5,-756.45 2962.5,-756.45"/>
</g>
<!-- expert_8_expert -->
<g id="node76" class="node">
<title>expert_8_expert</title>
<polygon fill="lightblue" stroke="black" points="3214,-746.23 3056,-746.23 3056,-702.23 3214,-702.23 3214,-746.23"/>
<text text-anchor="middle" x="3135" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 8 Expert</text>
<text text-anchor="middle" x="3135" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="3135" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3135" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_8_ln&#45;&gt;expert_8_expert -->
<g id="edge103" class="edge">
<title>expert_8_ln&#45;&gt;expert_8_expert</title>
<path fill="none" stroke="black" d="M3135,-781.94C3135,-781.94 3135,-756.39 3135,-756.39"/>
<polygon fill="black" stroke="black" points="3138.5,-756.39 3135,-746.39 3131.5,-756.39 3138.5,-756.39"/>
</g>
<!-- expert_8_gate_act -->
<g id="node75" class="node">
<title>expert_8_gate_act</title>
<polygon fill="lightblue" stroke="black" points="3038,-666.23 2880,-666.23 2880,-622.23 3038,-622.23 3038,-666.23"/>
<text text-anchor="middle" x="2959" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 8 SiLU</text>
<text text-anchor="middle" x="2959" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="2959" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="2959" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_8_gate&#45;&gt;expert_8_gate_act -->
<g id="edge102" class="edge">
<title>expert_8_gate&#45;&gt;expert_8_gate_act</title>
<path fill="none" stroke="black" d="M2959,-701.94C2959,-701.94 2959,-676.39 2959,-676.39"/>
<polygon fill="black" stroke="black" points="2962.5,-676.39 2959,-666.39 2955.5,-676.39 2962.5,-676.39"/>
</g>
<!-- expert_8_multiply -->
<g id="node78" class="node">
<title>expert_8_multiply</title>
<polygon fill="lightblue" stroke="black" points="3213.5,-586.23 2952.5,-586.23 2952.5,-542.23 3213.5,-542.23 3213.5,-586.23"/>
<text text-anchor="middle" x="3083" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 8 Multiply</text>
<text text-anchor="middle" x="3083" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="3083" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3083" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_8_gate_act&#45;&gt;expert_8_multiply -->
<g id="edge105" class="edge">
<title>expert_8_gate_act&#45;&gt;expert_8_multiply</title>
<path fill="none" stroke="black" d="M2995.25,-621.94C2995.25,-621.94 2995.25,-596.39 2995.25,-596.39"/>
<polygon fill="black" stroke="black" points="2998.75,-596.39 2995.25,-586.39 2991.75,-596.39 2998.75,-596.39"/>
</g>
<!-- expert_8_expert_act -->
<g id="node77" class="node">
<title>expert_8_expert_act</title>
<polygon fill="lightblue" stroke="black" points="3214,-666.23 3056,-666.23 3056,-622.23 3214,-622.23 3214,-666.23"/>
<text text-anchor="middle" x="3135" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 8 Expert Act</text>
<text text-anchor="middle" x="3135" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="3135" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3135" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_8_expert&#45;&gt;expert_8_expert_act -->
<g id="edge104" class="edge">
<title>expert_8_expert&#45;&gt;expert_8_expert_act</title>
<path fill="none" stroke="black" d="M3135,-701.94C3135,-701.94 3135,-676.39 3135,-676.39"/>
<polygon fill="black" stroke="black" points="3138.5,-676.39 3135,-666.39 3131.5,-676.39 3138.5,-676.39"/>
</g>
<!-- expert_8_expert_act&#45;&gt;expert_8_multiply -->
<g id="edge106" class="edge">
<title>expert_8_expert_act&#45;&gt;expert_8_multiply</title>
<path fill="none" stroke="black" d="M3134.75,-621.94C3134.75,-621.94 3134.75,-596.39 3134.75,-596.39"/>
<polygon fill="black" stroke="black" points="3138.25,-596.39 3134.75,-586.39 3131.25,-596.39 3138.25,-596.39"/>
</g>
<!-- expert_8_out_proj -->
<g id="node79" class="node">
<title>expert_8_out_proj</title>
<polygon fill="lightblue" stroke="black" points="3187,-506.23 3033,-506.23 3033,-462.23 3187,-462.23 3187,-506.23"/>
<text text-anchor="middle" x="3110" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 8 Output Proj</text>
<text text-anchor="middle" x="3110" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="3110" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3110" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_8_multiply&#45;&gt;expert_8_out_proj -->
<g id="edge107" class="edge">
<title>expert_8_multiply&#45;&gt;expert_8_out_proj</title>
<path fill="none" stroke="black" d="M3110,-541.94C3110,-541.94 3110,-516.39 3110,-516.39"/>
<polygon fill="black" stroke="black" points="3113.5,-516.39 3110,-506.39 3106.5,-516.39 3113.5,-516.39"/>
</g>
<!-- expert_8_out_proj&#45;&gt;gather_comm -->
<g id="edge108" class="edge">
<title>expert_8_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M3110,-461.83C3110,-436.58 3110,-399 3110,-399 3110,-399 5772.91,-399 5772.91,-399"/>
<polygon fill="black" stroke="black" points="5772.91,-402.5 5782.91,-399 5772.91,-395.5 5772.91,-402.5"/>
</g>
<!-- expert_9_gate -->
<g id="node81" class="node">
<title>expert_9_gate</title>
<polygon fill="lightblue" stroke="black" points="3396,-746.23 3238,-746.23 3238,-702.23 3396,-702.23 3396,-746.23"/>
<text text-anchor="middle" x="3317" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 9 Gate</text>
<text text-anchor="middle" x="3317" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3317" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3317" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_9_ln&#45;&gt;expert_9_gate -->
<g id="edge111" class="edge">
<title>expert_9_ln&#45;&gt;expert_9_gate</title>
<path fill="none" stroke="black" d="M3415.8,-804C3368.51,-804 3317,-804 3317,-804 3317,-804 3317,-756.45 3317,-756.45"/>
<polygon fill="black" stroke="black" points="3320.5,-756.45 3317,-746.45 3313.5,-756.45 3320.5,-756.45"/>
</g>
<!-- expert_9_expert -->
<g id="node83" class="node">
<title>expert_9_expert</title>
<polygon fill="lightblue" stroke="black" points="3572,-746.23 3414,-746.23 3414,-702.23 3572,-702.23 3572,-746.23"/>
<text text-anchor="middle" x="3493" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 9 Expert</text>
<text text-anchor="middle" x="3493" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3493" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3493" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_9_ln&#45;&gt;expert_9_expert -->
<g id="edge113" class="edge">
<title>expert_9_ln&#45;&gt;expert_9_expert</title>
<path fill="none" stroke="black" d="M3493,-781.94C3493,-781.94 3493,-756.39 3493,-756.39"/>
<polygon fill="black" stroke="black" points="3496.5,-756.39 3493,-746.39 3489.5,-756.39 3496.5,-756.39"/>
</g>
<!-- expert_9_gate_act -->
<g id="node82" class="node">
<title>expert_9_gate_act</title>
<polygon fill="lightblue" stroke="black" points="3396,-666.23 3238,-666.23 3238,-622.23 3396,-622.23 3396,-666.23"/>
<text text-anchor="middle" x="3317" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 9 SiLU</text>
<text text-anchor="middle" x="3317" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3317" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3317" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_9_gate&#45;&gt;expert_9_gate_act -->
<g id="edge112" class="edge">
<title>expert_9_gate&#45;&gt;expert_9_gate_act</title>
<path fill="none" stroke="black" d="M3317,-701.94C3317,-701.94 3317,-676.39 3317,-676.39"/>
<polygon fill="black" stroke="black" points="3320.5,-676.39 3317,-666.39 3313.5,-676.39 3320.5,-676.39"/>
</g>
<!-- expert_9_multiply -->
<g id="node85" class="node">
<title>expert_9_multiply</title>
<polygon fill="lightblue" stroke="black" points="3571.5,-586.23 3310.5,-586.23 3310.5,-542.23 3571.5,-542.23 3571.5,-586.23"/>
<text text-anchor="middle" x="3441" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 9 Multiply</text>
<text text-anchor="middle" x="3441" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3441" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3441" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_9_gate_act&#45;&gt;expert_9_multiply -->
<g id="edge115" class="edge">
<title>expert_9_gate_act&#45;&gt;expert_9_multiply</title>
<path fill="none" stroke="black" d="M3353.25,-621.94C3353.25,-621.94 3353.25,-596.39 3353.25,-596.39"/>
<polygon fill="black" stroke="black" points="3356.75,-596.39 3353.25,-586.39 3349.75,-596.39 3356.75,-596.39"/>
</g>
<!-- expert_9_expert_act -->
<g id="node84" class="node">
<title>expert_9_expert_act</title>
<polygon fill="lightblue" stroke="black" points="3572,-666.23 3414,-666.23 3414,-622.23 3572,-622.23 3572,-666.23"/>
<text text-anchor="middle" x="3493" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 9 Expert Act</text>
<text text-anchor="middle" x="3493" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3493" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3493" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_9_expert&#45;&gt;expert_9_expert_act -->
<g id="edge114" class="edge">
<title>expert_9_expert&#45;&gt;expert_9_expert_act</title>
<path fill="none" stroke="black" d="M3493,-701.94C3493,-701.94 3493,-676.39 3493,-676.39"/>
<polygon fill="black" stroke="black" points="3496.5,-676.39 3493,-666.39 3489.5,-676.39 3496.5,-676.39"/>
</g>
<!-- expert_9_expert_act&#45;&gt;expert_9_multiply -->
<g id="edge116" class="edge">
<title>expert_9_expert_act&#45;&gt;expert_9_multiply</title>
<path fill="none" stroke="black" d="M3492.75,-621.94C3492.75,-621.94 3492.75,-596.39 3492.75,-596.39"/>
<polygon fill="black" stroke="black" points="3496.25,-596.39 3492.75,-586.39 3489.25,-596.39 3496.25,-596.39"/>
</g>
<!-- expert_9_out_proj -->
<g id="node86" class="node">
<title>expert_9_out_proj</title>
<polygon fill="lightblue" stroke="black" points="3545,-506.23 3391,-506.23 3391,-462.23 3545,-462.23 3545,-506.23"/>
<text text-anchor="middle" x="3468" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 9 Output Proj</text>
<text text-anchor="middle" x="3468" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="3468" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3468" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_9_multiply&#45;&gt;expert_9_out_proj -->
<g id="edge117" class="edge">
<title>expert_9_multiply&#45;&gt;expert_9_out_proj</title>
<path fill="none" stroke="black" d="M3468,-541.94C3468,-541.94 3468,-516.39 3468,-516.39"/>
<polygon fill="black" stroke="black" points="3471.5,-516.39 3468,-506.39 3464.5,-516.39 3471.5,-516.39"/>
</g>
<!-- expert_9_out_proj&#45;&gt;gather_comm -->
<g id="edge118" class="edge">
<title>expert_9_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M3468,-462.19C3468,-437.83 3468,-402 3468,-402 3468,-402 5775.22,-402 5775.22,-402"/>
<polygon fill="black" stroke="black" points="5775.22,-405.5 5785.22,-402 5775.22,-398.5 5775.22,-405.5"/>
</g>
<!-- expert_10_gate -->
<g id="node88" class="node">
<title>expert_10_gate</title>
<polygon fill="lightblue" stroke="black" points="3754,-746.23 3596,-746.23 3596,-702.23 3754,-702.23 3754,-746.23"/>
<text text-anchor="middle" x="3675" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 10 Gate</text>
<text text-anchor="middle" x="3675" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3675" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3675" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_10_ln&#45;&gt;expert_10_gate -->
<g id="edge121" class="edge">
<title>expert_10_ln&#45;&gt;expert_10_gate</title>
<path fill="none" stroke="black" d="M3773.8,-804C3726.51,-804 3675,-804 3675,-804 3675,-804 3675,-756.45 3675,-756.45"/>
<polygon fill="black" stroke="black" points="3678.5,-756.45 3675,-746.45 3671.5,-756.45 3678.5,-756.45"/>
</g>
<!-- expert_10_expert -->
<g id="node90" class="node">
<title>expert_10_expert</title>
<polygon fill="lightblue" stroke="black" points="3930,-746.23 3772,-746.23 3772,-702.23 3930,-702.23 3930,-746.23"/>
<text text-anchor="middle" x="3851" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 10 Expert</text>
<text text-anchor="middle" x="3851" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3851" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="3851" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_10_ln&#45;&gt;expert_10_expert -->
<g id="edge123" class="edge">
<title>expert_10_ln&#45;&gt;expert_10_expert</title>
<path fill="none" stroke="black" d="M3851,-781.94C3851,-781.94 3851,-756.39 3851,-756.39"/>
<polygon fill="black" stroke="black" points="3854.5,-756.39 3851,-746.39 3847.5,-756.39 3854.5,-756.39"/>
</g>
<!-- expert_10_gate_act -->
<g id="node89" class="node">
<title>expert_10_gate_act</title>
<polygon fill="lightblue" stroke="black" points="3754,-666.23 3596,-666.23 3596,-622.23 3754,-622.23 3754,-666.23"/>
<text text-anchor="middle" x="3675" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 10 SiLU</text>
<text text-anchor="middle" x="3675" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3675" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3675" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_10_gate&#45;&gt;expert_10_gate_act -->
<g id="edge122" class="edge">
<title>expert_10_gate&#45;&gt;expert_10_gate_act</title>
<path fill="none" stroke="black" d="M3675,-701.94C3675,-701.94 3675,-676.39 3675,-676.39"/>
<polygon fill="black" stroke="black" points="3678.5,-676.39 3675,-666.39 3671.5,-676.39 3678.5,-676.39"/>
</g>
<!-- expert_10_multiply -->
<g id="node92" class="node">
<title>expert_10_multiply</title>
<polygon fill="lightblue" stroke="black" points="3929.5,-586.23 3668.5,-586.23 3668.5,-542.23 3929.5,-542.23 3929.5,-586.23"/>
<text text-anchor="middle" x="3799" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 10 Multiply</text>
<text text-anchor="middle" x="3799" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3799" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3799" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_10_gate_act&#45;&gt;expert_10_multiply -->
<g id="edge125" class="edge">
<title>expert_10_gate_act&#45;&gt;expert_10_multiply</title>
<path fill="none" stroke="black" d="M3711.25,-621.94C3711.25,-621.94 3711.25,-596.39 3711.25,-596.39"/>
<polygon fill="black" stroke="black" points="3714.75,-596.39 3711.25,-586.39 3707.75,-596.39 3714.75,-596.39"/>
</g>
<!-- expert_10_expert_act -->
<g id="node91" class="node">
<title>expert_10_expert_act</title>
<polygon fill="lightblue" stroke="black" points="3930,-666.23 3772,-666.23 3772,-622.23 3930,-622.23 3930,-666.23"/>
<text text-anchor="middle" x="3851" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 10 Expert Act</text>
<text text-anchor="middle" x="3851" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3851" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3851" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_10_expert&#45;&gt;expert_10_expert_act -->
<g id="edge124" class="edge">
<title>expert_10_expert&#45;&gt;expert_10_expert_act</title>
<path fill="none" stroke="black" d="M3851,-701.94C3851,-701.94 3851,-676.39 3851,-676.39"/>
<polygon fill="black" stroke="black" points="3854.5,-676.39 3851,-666.39 3847.5,-676.39 3854.5,-676.39"/>
</g>
<!-- expert_10_expert_act&#45;&gt;expert_10_multiply -->
<g id="edge126" class="edge">
<title>expert_10_expert_act&#45;&gt;expert_10_multiply</title>
<path fill="none" stroke="black" d="M3850.75,-621.94C3850.75,-621.94 3850.75,-596.39 3850.75,-596.39"/>
<polygon fill="black" stroke="black" points="3854.25,-596.39 3850.75,-586.39 3847.25,-596.39 3854.25,-596.39"/>
</g>
<!-- expert_10_out_proj -->
<g id="node93" class="node">
<title>expert_10_out_proj</title>
<polygon fill="lightblue" stroke="black" points="3903,-506.23 3749,-506.23 3749,-462.23 3903,-462.23 3903,-506.23"/>
<text text-anchor="middle" x="3826" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 10 Output Proj</text>
<text text-anchor="middle" x="3826" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3826" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="3826" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_10_multiply&#45;&gt;expert_10_out_proj -->
<g id="edge127" class="edge">
<title>expert_10_multiply&#45;&gt;expert_10_out_proj</title>
<path fill="none" stroke="black" d="M3826,-541.94C3826,-541.94 3826,-516.39 3826,-516.39"/>
<polygon fill="black" stroke="black" points="3829.5,-516.39 3826,-506.39 3822.5,-516.39 3829.5,-516.39"/>
</g>
<!-- expert_10_out_proj&#45;&gt;gather_comm -->
<g id="edge128" class="edge">
<title>expert_10_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M3826,-462.02C3826,-438.89 3826,-406 3826,-406 3826,-406 5780.27,-406 5780.27,-406"/>
<polygon fill="black" stroke="black" points="5780.27,-409.5 5790.27,-406 5780.27,-402.5 5780.27,-409.5"/>
</g>
<!-- expert_11_gate -->
<g id="node95" class="node">
<title>expert_11_gate</title>
<polygon fill="lightblue" stroke="black" points="4112,-746.23 3954,-746.23 3954,-702.23 4112,-702.23 4112,-746.23"/>
<text text-anchor="middle" x="4033" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 11 Gate</text>
<text text-anchor="middle" x="4033" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4033" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4033" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_11_ln&#45;&gt;expert_11_gate -->
<g id="edge131" class="edge">
<title>expert_11_ln&#45;&gt;expert_11_gate</title>
<path fill="none" stroke="black" d="M4131.8,-804C4084.51,-804 4033,-804 4033,-804 4033,-804 4033,-756.45 4033,-756.45"/>
<polygon fill="black" stroke="black" points="4036.5,-756.45 4033,-746.45 4029.5,-756.45 4036.5,-756.45"/>
</g>
<!-- expert_11_expert -->
<g id="node97" class="node">
<title>expert_11_expert</title>
<polygon fill="lightblue" stroke="black" points="4288,-746.23 4130,-746.23 4130,-702.23 4288,-702.23 4288,-746.23"/>
<text text-anchor="middle" x="4209" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 11 Expert</text>
<text text-anchor="middle" x="4209" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4209" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4209" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_11_ln&#45;&gt;expert_11_expert -->
<g id="edge133" class="edge">
<title>expert_11_ln&#45;&gt;expert_11_expert</title>
<path fill="none" stroke="black" d="M4209,-781.94C4209,-781.94 4209,-756.39 4209,-756.39"/>
<polygon fill="black" stroke="black" points="4212.5,-756.39 4209,-746.39 4205.5,-756.39 4212.5,-756.39"/>
</g>
<!-- expert_11_gate_act -->
<g id="node96" class="node">
<title>expert_11_gate_act</title>
<polygon fill="lightblue" stroke="black" points="4112,-666.23 3954,-666.23 3954,-622.23 4112,-622.23 4112,-666.23"/>
<text text-anchor="middle" x="4033" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 11 SiLU</text>
<text text-anchor="middle" x="4033" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4033" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4033" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_11_gate&#45;&gt;expert_11_gate_act -->
<g id="edge132" class="edge">
<title>expert_11_gate&#45;&gt;expert_11_gate_act</title>
<path fill="none" stroke="black" d="M4033,-701.94C4033,-701.94 4033,-676.39 4033,-676.39"/>
<polygon fill="black" stroke="black" points="4036.5,-676.39 4033,-666.39 4029.5,-676.39 4036.5,-676.39"/>
</g>
<!-- expert_11_multiply -->
<g id="node99" class="node">
<title>expert_11_multiply</title>
<polygon fill="lightblue" stroke="black" points="4287.5,-586.23 4026.5,-586.23 4026.5,-542.23 4287.5,-542.23 4287.5,-586.23"/>
<text text-anchor="middle" x="4157" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 11 Multiply</text>
<text text-anchor="middle" x="4157" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4157" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4157" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_11_gate_act&#45;&gt;expert_11_multiply -->
<g id="edge135" class="edge">
<title>expert_11_gate_act&#45;&gt;expert_11_multiply</title>
<path fill="none" stroke="black" d="M4069.25,-621.94C4069.25,-621.94 4069.25,-596.39 4069.25,-596.39"/>
<polygon fill="black" stroke="black" points="4072.75,-596.39 4069.25,-586.39 4065.75,-596.39 4072.75,-596.39"/>
</g>
<!-- expert_11_expert_act -->
<g id="node98" class="node">
<title>expert_11_expert_act</title>
<polygon fill="lightblue" stroke="black" points="4288,-666.23 4130,-666.23 4130,-622.23 4288,-622.23 4288,-666.23"/>
<text text-anchor="middle" x="4209" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 11 Expert Act</text>
<text text-anchor="middle" x="4209" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4209" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4209" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_11_expert&#45;&gt;expert_11_expert_act -->
<g id="edge134" class="edge">
<title>expert_11_expert&#45;&gt;expert_11_expert_act</title>
<path fill="none" stroke="black" d="M4209,-701.94C4209,-701.94 4209,-676.39 4209,-676.39"/>
<polygon fill="black" stroke="black" points="4212.5,-676.39 4209,-666.39 4205.5,-676.39 4212.5,-676.39"/>
</g>
<!-- expert_11_expert_act&#45;&gt;expert_11_multiply -->
<g id="edge136" class="edge">
<title>expert_11_expert_act&#45;&gt;expert_11_multiply</title>
<path fill="none" stroke="black" d="M4208.75,-621.94C4208.75,-621.94 4208.75,-596.39 4208.75,-596.39"/>
<polygon fill="black" stroke="black" points="4212.25,-596.39 4208.75,-586.39 4205.25,-596.39 4212.25,-596.39"/>
</g>
<!-- expert_11_out_proj -->
<g id="node100" class="node">
<title>expert_11_out_proj</title>
<polygon fill="lightblue" stroke="black" points="4261,-506.23 4107,-506.23 4107,-462.23 4261,-462.23 4261,-506.23"/>
<text text-anchor="middle" x="4184" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 11 Output Proj</text>
<text text-anchor="middle" x="4184" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="4184" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4184" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_11_multiply&#45;&gt;expert_11_out_proj -->
<g id="edge137" class="edge">
<title>expert_11_multiply&#45;&gt;expert_11_out_proj</title>
<path fill="none" stroke="black" d="M4184,-541.94C4184,-541.94 4184,-516.39 4184,-516.39"/>
<polygon fill="black" stroke="black" points="4187.5,-516.39 4184,-506.39 4180.5,-516.39 4187.5,-516.39"/>
</g>
<!-- expert_11_out_proj&#45;&gt;gather_comm -->
<g id="edge138" class="edge">
<title>expert_11_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M4184,-461.96C4184,-440.09 4184,-410 4184,-410 4184,-410 5787.69,-410 5787.69,-410"/>
<polygon fill="black" stroke="black" points="5787.69,-413.5 5797.69,-410 5787.69,-406.5 5787.69,-413.5"/>
</g>
<!-- expert_12_gate -->
<g id="node102" class="node">
<title>expert_12_gate</title>
<polygon fill="lightblue" stroke="black" points="4470,-746.23 4312,-746.23 4312,-702.23 4470,-702.23 4470,-746.23"/>
<text text-anchor="middle" x="4391" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 12 Gate</text>
<text text-anchor="middle" x="4391" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4391" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4391" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_12_ln&#45;&gt;expert_12_gate -->
<g id="edge141" class="edge">
<title>expert_12_ln&#45;&gt;expert_12_gate</title>
<path fill="none" stroke="black" d="M4489.8,-804C4442.51,-804 4391,-804 4391,-804 4391,-804 4391,-756.45 4391,-756.45"/>
<polygon fill="black" stroke="black" points="4394.5,-756.45 4391,-746.45 4387.5,-756.45 4394.5,-756.45"/>
</g>
<!-- expert_12_expert -->
<g id="node104" class="node">
<title>expert_12_expert</title>
<polygon fill="lightblue" stroke="black" points="4646,-746.23 4488,-746.23 4488,-702.23 4646,-702.23 4646,-746.23"/>
<text text-anchor="middle" x="4567" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 12 Expert</text>
<text text-anchor="middle" x="4567" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4567" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4567" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_12_ln&#45;&gt;expert_12_expert -->
<g id="edge143" class="edge">
<title>expert_12_ln&#45;&gt;expert_12_expert</title>
<path fill="none" stroke="black" d="M4567,-781.94C4567,-781.94 4567,-756.39 4567,-756.39"/>
<polygon fill="black" stroke="black" points="4570.5,-756.39 4567,-746.39 4563.5,-756.39 4570.5,-756.39"/>
</g>
<!-- expert_12_gate_act -->
<g id="node103" class="node">
<title>expert_12_gate_act</title>
<polygon fill="lightblue" stroke="black" points="4470,-666.23 4312,-666.23 4312,-622.23 4470,-622.23 4470,-666.23"/>
<text text-anchor="middle" x="4391" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 12 SiLU</text>
<text text-anchor="middle" x="4391" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4391" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4391" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_12_gate&#45;&gt;expert_12_gate_act -->
<g id="edge142" class="edge">
<title>expert_12_gate&#45;&gt;expert_12_gate_act</title>
<path fill="none" stroke="black" d="M4391,-701.94C4391,-701.94 4391,-676.39 4391,-676.39"/>
<polygon fill="black" stroke="black" points="4394.5,-676.39 4391,-666.39 4387.5,-676.39 4394.5,-676.39"/>
</g>
<!-- expert_12_multiply -->
<g id="node106" class="node">
<title>expert_12_multiply</title>
<polygon fill="lightblue" stroke="black" points="4645.5,-586.23 4384.5,-586.23 4384.5,-542.23 4645.5,-542.23 4645.5,-586.23"/>
<text text-anchor="middle" x="4515" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 12 Multiply</text>
<text text-anchor="middle" x="4515" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4515" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4515" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_12_gate_act&#45;&gt;expert_12_multiply -->
<g id="edge145" class="edge">
<title>expert_12_gate_act&#45;&gt;expert_12_multiply</title>
<path fill="none" stroke="black" d="M4427.25,-621.94C4427.25,-621.94 4427.25,-596.39 4427.25,-596.39"/>
<polygon fill="black" stroke="black" points="4430.75,-596.39 4427.25,-586.39 4423.75,-596.39 4430.75,-596.39"/>
</g>
<!-- expert_12_expert_act -->
<g id="node105" class="node">
<title>expert_12_expert_act</title>
<polygon fill="lightblue" stroke="black" points="4646,-666.23 4488,-666.23 4488,-622.23 4646,-622.23 4646,-666.23"/>
<text text-anchor="middle" x="4567" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 12 Expert Act</text>
<text text-anchor="middle" x="4567" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4567" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4567" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_12_expert&#45;&gt;expert_12_expert_act -->
<g id="edge144" class="edge">
<title>expert_12_expert&#45;&gt;expert_12_expert_act</title>
<path fill="none" stroke="black" d="M4567,-701.94C4567,-701.94 4567,-676.39 4567,-676.39"/>
<polygon fill="black" stroke="black" points="4570.5,-676.39 4567,-666.39 4563.5,-676.39 4570.5,-676.39"/>
</g>
<!-- expert_12_expert_act&#45;&gt;expert_12_multiply -->
<g id="edge146" class="edge">
<title>expert_12_expert_act&#45;&gt;expert_12_multiply</title>
<path fill="none" stroke="black" d="M4566.75,-621.94C4566.75,-621.94 4566.75,-596.39 4566.75,-596.39"/>
<polygon fill="black" stroke="black" points="4570.25,-596.39 4566.75,-586.39 4563.25,-596.39 4570.25,-596.39"/>
</g>
<!-- expert_12_out_proj -->
<g id="node107" class="node">
<title>expert_12_out_proj</title>
<polygon fill="lightblue" stroke="black" points="4619,-506.23 4465,-506.23 4465,-462.23 4619,-462.23 4619,-506.23"/>
<text text-anchor="middle" x="4542" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 12 Output Proj</text>
<text text-anchor="middle" x="4542" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="4542" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4542" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_12_multiply&#45;&gt;expert_12_out_proj -->
<g id="edge147" class="edge">
<title>expert_12_multiply&#45;&gt;expert_12_out_proj</title>
<path fill="none" stroke="black" d="M4542,-541.94C4542,-541.94 4542,-516.39 4542,-516.39"/>
<polygon fill="black" stroke="black" points="4545.5,-516.39 4542,-506.39 4538.5,-516.39 4545.5,-516.39"/>
</g>
<!-- expert_12_out_proj&#45;&gt;gather_comm -->
<g id="edge148" class="edge">
<title>expert_12_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M4542,-462.01C4542,-441.43 4542,-414 4542,-414 4542,-414 5798.66,-414 5798.66,-414"/>
<polygon fill="black" stroke="black" points="5798.66,-417.5 5808.66,-414 5798.66,-410.5 5798.66,-417.5"/>
</g>
<!-- expert_13_gate -->
<g id="node109" class="node">
<title>expert_13_gate</title>
<polygon fill="lightblue" stroke="black" points="4828,-746.23 4670,-746.23 4670,-702.23 4828,-702.23 4828,-746.23"/>
<text text-anchor="middle" x="4749" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 13 Gate</text>
<text text-anchor="middle" x="4749" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4749" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4749" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_13_ln&#45;&gt;expert_13_gate -->
<g id="edge151" class="edge">
<title>expert_13_ln&#45;&gt;expert_13_gate</title>
<path fill="none" stroke="black" d="M4847.8,-804C4800.51,-804 4749,-804 4749,-804 4749,-804 4749,-756.45 4749,-756.45"/>
<polygon fill="black" stroke="black" points="4752.5,-756.45 4749,-746.45 4745.5,-756.45 4752.5,-756.45"/>
</g>
<!-- expert_13_expert -->
<g id="node111" class="node">
<title>expert_13_expert</title>
<polygon fill="lightblue" stroke="black" points="5004,-746.23 4846,-746.23 4846,-702.23 5004,-702.23 5004,-746.23"/>
<text text-anchor="middle" x="4925" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 13 Expert</text>
<text text-anchor="middle" x="4925" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4925" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="4925" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_13_ln&#45;&gt;expert_13_expert -->
<g id="edge153" class="edge">
<title>expert_13_ln&#45;&gt;expert_13_expert</title>
<path fill="none" stroke="black" d="M4925,-781.94C4925,-781.94 4925,-756.39 4925,-756.39"/>
<polygon fill="black" stroke="black" points="4928.5,-756.39 4925,-746.39 4921.5,-756.39 4928.5,-756.39"/>
</g>
<!-- expert_13_gate_act -->
<g id="node110" class="node">
<title>expert_13_gate_act</title>
<polygon fill="lightblue" stroke="black" points="4828,-666.23 4670,-666.23 4670,-622.23 4828,-622.23 4828,-666.23"/>
<text text-anchor="middle" x="4749" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 13 SiLU</text>
<text text-anchor="middle" x="4749" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4749" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4749" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_13_gate&#45;&gt;expert_13_gate_act -->
<g id="edge152" class="edge">
<title>expert_13_gate&#45;&gt;expert_13_gate_act</title>
<path fill="none" stroke="black" d="M4749,-701.94C4749,-701.94 4749,-676.39 4749,-676.39"/>
<polygon fill="black" stroke="black" points="4752.5,-676.39 4749,-666.39 4745.5,-676.39 4752.5,-676.39"/>
</g>
<!-- expert_13_multiply -->
<g id="node113" class="node">
<title>expert_13_multiply</title>
<polygon fill="lightblue" stroke="black" points="5003.5,-586.23 4742.5,-586.23 4742.5,-542.23 5003.5,-542.23 5003.5,-586.23"/>
<text text-anchor="middle" x="4873" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 13 Multiply</text>
<text text-anchor="middle" x="4873" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4873" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4873" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_13_gate_act&#45;&gt;expert_13_multiply -->
<g id="edge155" class="edge">
<title>expert_13_gate_act&#45;&gt;expert_13_multiply</title>
<path fill="none" stroke="black" d="M4785.25,-621.94C4785.25,-621.94 4785.25,-596.39 4785.25,-596.39"/>
<polygon fill="black" stroke="black" points="4788.75,-596.39 4785.25,-586.39 4781.75,-596.39 4788.75,-596.39"/>
</g>
<!-- expert_13_expert_act -->
<g id="node112" class="node">
<title>expert_13_expert_act</title>
<polygon fill="lightblue" stroke="black" points="5004,-666.23 4846,-666.23 4846,-622.23 5004,-622.23 5004,-666.23"/>
<text text-anchor="middle" x="4925" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 13 Expert Act</text>
<text text-anchor="middle" x="4925" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4925" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4925" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_13_expert&#45;&gt;expert_13_expert_act -->
<g id="edge154" class="edge">
<title>expert_13_expert&#45;&gt;expert_13_expert_act</title>
<path fill="none" stroke="black" d="M4925,-701.94C4925,-701.94 4925,-676.39 4925,-676.39"/>
<polygon fill="black" stroke="black" points="4928.5,-676.39 4925,-666.39 4921.5,-676.39 4928.5,-676.39"/>
</g>
<!-- expert_13_expert_act&#45;&gt;expert_13_multiply -->
<g id="edge156" class="edge">
<title>expert_13_expert_act&#45;&gt;expert_13_multiply</title>
<path fill="none" stroke="black" d="M4924.75,-621.94C4924.75,-621.94 4924.75,-596.39 4924.75,-596.39"/>
<polygon fill="black" stroke="black" points="4928.25,-596.39 4924.75,-586.39 4921.25,-596.39 4928.25,-596.39"/>
</g>
<!-- expert_13_out_proj -->
<g id="node114" class="node">
<title>expert_13_out_proj</title>
<polygon fill="lightblue" stroke="black" points="4977,-506.23 4823,-506.23 4823,-462.23 4977,-462.23 4977,-506.23"/>
<text text-anchor="middle" x="4900" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 13 Output Proj</text>
<text text-anchor="middle" x="4900" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4900" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="4900" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_13_multiply&#45;&gt;expert_13_out_proj -->
<g id="edge157" class="edge">
<title>expert_13_multiply&#45;&gt;expert_13_out_proj</title>
<path fill="none" stroke="black" d="M4900,-541.94C4900,-541.94 4900,-516.39 4900,-516.39"/>
<polygon fill="black" stroke="black" points="4903.5,-516.39 4900,-506.39 4896.5,-516.39 4903.5,-516.39"/>
</g>
<!-- expert_13_out_proj&#45;&gt;gather_comm -->
<g id="edge158" class="edge">
<title>expert_13_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M4900,-462.17C4900,-442.91 4900,-418 4900,-418 4900,-418 5813.49,-418 5813.49,-418"/>
<polygon fill="black" stroke="black" points="5813.49,-421.5 5823.49,-418 5813.49,-414.5 5813.49,-421.5"/>
</g>
<!-- expert_14_gate -->
<g id="node116" class="node">
<title>expert_14_gate</title>
<polygon fill="lightblue" stroke="black" points="5186,-746.23 5028,-746.23 5028,-702.23 5186,-702.23 5186,-746.23"/>
<text text-anchor="middle" x="5107" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 14 Gate</text>
<text text-anchor="middle" x="5107" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5107" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5107" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_14_ln&#45;&gt;expert_14_gate -->
<g id="edge161" class="edge">
<title>expert_14_ln&#45;&gt;expert_14_gate</title>
<path fill="none" stroke="black" d="M5205.8,-804C5158.51,-804 5107,-804 5107,-804 5107,-804 5107,-756.45 5107,-756.45"/>
<polygon fill="black" stroke="black" points="5110.5,-756.45 5107,-746.45 5103.5,-756.45 5110.5,-756.45"/>
</g>
<!-- expert_14_expert -->
<g id="node118" class="node">
<title>expert_14_expert</title>
<polygon fill="lightblue" stroke="black" points="5362,-746.23 5204,-746.23 5204,-702.23 5362,-702.23 5362,-746.23"/>
<text text-anchor="middle" x="5283" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 14 Expert</text>
<text text-anchor="middle" x="5283" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5283" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5283" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_14_ln&#45;&gt;expert_14_expert -->
<g id="edge163" class="edge">
<title>expert_14_ln&#45;&gt;expert_14_expert</title>
<path fill="none" stroke="black" d="M5283,-781.94C5283,-781.94 5283,-756.39 5283,-756.39"/>
<polygon fill="black" stroke="black" points="5286.5,-756.39 5283,-746.39 5279.5,-756.39 5286.5,-756.39"/>
</g>
<!-- expert_14_gate_act -->
<g id="node117" class="node">
<title>expert_14_gate_act</title>
<polygon fill="lightblue" stroke="black" points="5186,-666.23 5028,-666.23 5028,-622.23 5186,-622.23 5186,-666.23"/>
<text text-anchor="middle" x="5107" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 14 SiLU</text>
<text text-anchor="middle" x="5107" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5107" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5107" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_14_gate&#45;&gt;expert_14_gate_act -->
<g id="edge162" class="edge">
<title>expert_14_gate&#45;&gt;expert_14_gate_act</title>
<path fill="none" stroke="black" d="M5107,-701.94C5107,-701.94 5107,-676.39 5107,-676.39"/>
<polygon fill="black" stroke="black" points="5110.5,-676.39 5107,-666.39 5103.5,-676.39 5110.5,-676.39"/>
</g>
<!-- expert_14_multiply -->
<g id="node120" class="node">
<title>expert_14_multiply</title>
<polygon fill="lightblue" stroke="black" points="5361.5,-586.23 5100.5,-586.23 5100.5,-542.23 5361.5,-542.23 5361.5,-586.23"/>
<text text-anchor="middle" x="5231" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 14 Multiply</text>
<text text-anchor="middle" x="5231" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5231" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5231" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_14_gate_act&#45;&gt;expert_14_multiply -->
<g id="edge165" class="edge">
<title>expert_14_gate_act&#45;&gt;expert_14_multiply</title>
<path fill="none" stroke="black" d="M5143.25,-621.94C5143.25,-621.94 5143.25,-596.39 5143.25,-596.39"/>
<polygon fill="black" stroke="black" points="5146.75,-596.39 5143.25,-586.39 5139.75,-596.39 5146.75,-596.39"/>
</g>
<!-- expert_14_expert_act -->
<g id="node119" class="node">
<title>expert_14_expert_act</title>
<polygon fill="lightblue" stroke="black" points="5362,-666.23 5204,-666.23 5204,-622.23 5362,-622.23 5362,-666.23"/>
<text text-anchor="middle" x="5283" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 14 Expert Act</text>
<text text-anchor="middle" x="5283" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5283" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5283" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_14_expert&#45;&gt;expert_14_expert_act -->
<g id="edge164" class="edge">
<title>expert_14_expert&#45;&gt;expert_14_expert_act</title>
<path fill="none" stroke="black" d="M5283,-701.94C5283,-701.94 5283,-676.39 5283,-676.39"/>
<polygon fill="black" stroke="black" points="5286.5,-676.39 5283,-666.39 5279.5,-676.39 5286.5,-676.39"/>
</g>
<!-- expert_14_expert_act&#45;&gt;expert_14_multiply -->
<g id="edge166" class="edge">
<title>expert_14_expert_act&#45;&gt;expert_14_multiply</title>
<path fill="none" stroke="black" d="M5282.75,-621.94C5282.75,-621.94 5282.75,-596.39 5282.75,-596.39"/>
<polygon fill="black" stroke="black" points="5286.25,-596.39 5282.75,-586.39 5279.25,-596.39 5286.25,-596.39"/>
</g>
<!-- expert_14_out_proj -->
<g id="node121" class="node">
<title>expert_14_out_proj</title>
<polygon fill="lightblue" stroke="black" points="5335,-506.23 5181,-506.23 5181,-462.23 5335,-462.23 5335,-506.23"/>
<text text-anchor="middle" x="5258" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 14 Output Proj</text>
<text text-anchor="middle" x="5258" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="5258" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5258" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_14_multiply&#45;&gt;expert_14_out_proj -->
<g id="edge167" class="edge">
<title>expert_14_multiply&#45;&gt;expert_14_out_proj</title>
<path fill="none" stroke="black" d="M5258,-541.94C5258,-541.94 5258,-516.39 5258,-516.39"/>
<polygon fill="black" stroke="black" points="5261.5,-516.39 5258,-506.39 5254.5,-516.39 5261.5,-516.39"/>
</g>
<!-- expert_14_out_proj&#45;&gt;gather_comm -->
<g id="edge168" class="edge">
<title>expert_14_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M5258,-462.11C5258,-444.23 5258,-422 5258,-422 5258,-422 5836,-422 5836,-422"/>
<polygon fill="black" stroke="black" points="5836,-425.5 5846,-422 5836,-418.5 5836,-425.5"/>
</g>
<!-- expert_15_gate -->
<g id="node123" class="node">
<title>expert_15_gate</title>
<polygon fill="lightblue" stroke="black" points="5544,-746.23 5386,-746.23 5386,-702.23 5544,-702.23 5544,-746.23"/>
<text text-anchor="middle" x="5465" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 15 Gate</text>
<text text-anchor="middle" x="5465" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5465" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5465" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_15_ln&#45;&gt;expert_15_gate -->
<g id="edge171" class="edge">
<title>expert_15_ln&#45;&gt;expert_15_gate</title>
<path fill="none" stroke="black" d="M5563.78,-804C5542.06,-804 5524.25,-804 5524.25,-804 5524.25,-804 5524.25,-756.45 5524.25,-756.45"/>
<polygon fill="black" stroke="black" points="5527.75,-756.45 5524.25,-746.45 5520.75,-756.45 5527.75,-756.45"/>
</g>
<!-- expert_15_expert -->
<g id="node125" class="node">
<title>expert_15_expert</title>
<polygon fill="lightblue" stroke="black" points="5720,-746.23 5562,-746.23 5562,-702.23 5720,-702.23 5720,-746.23"/>
<text text-anchor="middle" x="5641" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 15 Expert</text>
<text text-anchor="middle" x="5641" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5641" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5641" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_15_ln&#45;&gt;expert_15_expert -->
<g id="edge173" class="edge">
<title>expert_15_ln&#45;&gt;expert_15_expert</title>
<path fill="none" stroke="black" d="M5641,-781.94C5641,-781.94 5641,-756.39 5641,-756.39"/>
<polygon fill="black" stroke="black" points="5644.5,-756.39 5641,-746.39 5637.5,-756.39 5644.5,-756.39"/>
</g>
<!-- expert_15_gate_act -->
<g id="node124" class="node">
<title>expert_15_gate_act</title>
<polygon fill="lightblue" stroke="black" points="5544,-666.23 5386,-666.23 5386,-622.23 5544,-622.23 5544,-666.23"/>
<text text-anchor="middle" x="5465" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 15 SiLU</text>
<text text-anchor="middle" x="5465" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5465" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5465" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_15_gate&#45;&gt;expert_15_gate_act -->
<g id="edge172" class="edge">
<title>expert_15_gate&#45;&gt;expert_15_gate_act</title>
<path fill="none" stroke="black" d="M5465,-701.94C5465,-701.94 5465,-676.39 5465,-676.39"/>
<polygon fill="black" stroke="black" points="5468.5,-676.39 5465,-666.39 5461.5,-676.39 5468.5,-676.39"/>
</g>
<!-- expert_15_multiply -->
<g id="node127" class="node">
<title>expert_15_multiply</title>
<polygon fill="lightblue" stroke="black" points="5719.5,-586.23 5458.5,-586.23 5458.5,-542.23 5719.5,-542.23 5719.5,-586.23"/>
<text text-anchor="middle" x="5589" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 15 Multiply</text>
<text text-anchor="middle" x="5589" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5589" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5589" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_15_gate_act&#45;&gt;expert_15_multiply -->
<g id="edge175" class="edge">
<title>expert_15_gate_act&#45;&gt;expert_15_multiply</title>
<path fill="none" stroke="black" d="M5501.25,-621.94C5501.25,-621.94 5501.25,-596.39 5501.25,-596.39"/>
<polygon fill="black" stroke="black" points="5504.75,-596.39 5501.25,-586.39 5497.75,-596.39 5504.75,-596.39"/>
</g>
<!-- expert_15_expert_act -->
<g id="node126" class="node">
<title>expert_15_expert_act</title>
<polygon fill="lightblue" stroke="black" points="5720,-666.23 5562,-666.23 5562,-622.23 5720,-622.23 5720,-666.23"/>
<text text-anchor="middle" x="5641" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 15 Expert Act</text>
<text text-anchor="middle" x="5641" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5641" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5641" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_15_expert&#45;&gt;expert_15_expert_act -->
<g id="edge174" class="edge">
<title>expert_15_expert&#45;&gt;expert_15_expert_act</title>
<path fill="none" stroke="black" d="M5641,-701.94C5641,-701.94 5641,-676.39 5641,-676.39"/>
<polygon fill="black" stroke="black" points="5644.5,-676.39 5641,-666.39 5637.5,-676.39 5644.5,-676.39"/>
</g>
<!-- expert_15_expert_act&#45;&gt;expert_15_multiply -->
<g id="edge176" class="edge">
<title>expert_15_expert_act&#45;&gt;expert_15_multiply</title>
<path fill="none" stroke="black" d="M5640.75,-621.94C5640.75,-621.94 5640.75,-596.39 5640.75,-596.39"/>
<polygon fill="black" stroke="black" points="5644.25,-596.39 5640.75,-586.39 5637.25,-596.39 5644.25,-596.39"/>
</g>
<!-- expert_15_out_proj -->
<g id="node128" class="node">
<title>expert_15_out_proj</title>
<polygon fill="lightblue" stroke="black" points="5693,-506.23 5539,-506.23 5539,-462.23 5693,-462.23 5693,-506.23"/>
<text text-anchor="middle" x="5616" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 15 Output Proj</text>
<text text-anchor="middle" x="5616" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="5616" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5616" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_15_multiply&#45;&gt;expert_15_out_proj -->
<g id="edge177" class="edge">
<title>expert_15_multiply&#45;&gt;expert_15_out_proj</title>
<path fill="none" stroke="black" d="M5616,-541.94C5616,-541.94 5616,-516.39 5616,-516.39"/>
<polygon fill="black" stroke="black" points="5619.5,-516.39 5616,-506.39 5612.5,-516.39 5619.5,-516.39"/>
</g>
<!-- expert_15_out_proj&#45;&gt;gather_comm -->
<g id="edge178" class="edge">
<title>expert_15_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M5693.05,-484C5746.51,-484 5808.15,-484 5808.15,-484 5808.15,-484 5808.15,-423.96 5808.15,-423.96"/>
<polygon fill="black" stroke="black" points="5811.65,-423.96 5808.15,-413.96 5804.65,-423.96 5811.65,-423.96"/>
</g>
<!-- expert_16_gate -->
<g id="node130" class="node">
<title>expert_16_gate</title>
<polygon fill="lightblue" stroke="black" points="5902,-746.23 5744,-746.23 5744,-702.23 5902,-702.23 5902,-746.23"/>
<text text-anchor="middle" x="5823" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 16 Gate</text>
<text text-anchor="middle" x="5823" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5823" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5823" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_16_ln&#45;&gt;expert_16_gate -->
<g id="edge181" class="edge">
<title>expert_16_ln&#45;&gt;expert_16_gate</title>
<path fill="none" stroke="black" d="M5823,-781.94C5823,-781.94 5823,-756.39 5823,-756.39"/>
<polygon fill="black" stroke="black" points="5826.5,-756.39 5823,-746.39 5819.5,-756.39 5826.5,-756.39"/>
</g>
<!-- expert_16_expert -->
<g id="node132" class="node">
<title>expert_16_expert</title>
<polygon fill="lightblue" stroke="black" points="6078,-746.23 5920,-746.23 5920,-702.23 6078,-702.23 6078,-746.23"/>
<text text-anchor="middle" x="5999" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 16 Expert</text>
<text text-anchor="middle" x="5999" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5999" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="5999" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_16_ln&#45;&gt;expert_16_expert -->
<g id="edge183" class="edge">
<title>expert_16_ln&#45;&gt;expert_16_expert</title>
<path fill="none" stroke="black" d="M5900.07,-791C5918.37,-791 5932.69,-791 5932.69,-791 5932.69,-791 5932.69,-756.46 5932.69,-756.46"/>
<polygon fill="black" stroke="black" points="5936.19,-756.46 5932.69,-746.46 5929.19,-756.46 5936.19,-756.46"/>
</g>
<!-- expert_16_gate_act -->
<g id="node131" class="node">
<title>expert_16_gate_act</title>
<polygon fill="lightblue" stroke="black" points="5902,-666.23 5744,-666.23 5744,-622.23 5902,-622.23 5902,-666.23"/>
<text text-anchor="middle" x="5823" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 16 SiLU</text>
<text text-anchor="middle" x="5823" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5823" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5823" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_16_gate&#45;&gt;expert_16_gate_act -->
<g id="edge182" class="edge">
<title>expert_16_gate&#45;&gt;expert_16_gate_act</title>
<path fill="none" stroke="black" d="M5823,-701.94C5823,-701.94 5823,-676.39 5823,-676.39"/>
<polygon fill="black" stroke="black" points="5826.5,-676.39 5823,-666.39 5819.5,-676.39 5826.5,-676.39"/>
</g>
<!-- expert_16_multiply -->
<g id="node134" class="node">
<title>expert_16_multiply</title>
<polygon fill="lightblue" stroke="black" points="6041.5,-586.23 5780.5,-586.23 5780.5,-542.23 6041.5,-542.23 6041.5,-586.23"/>
<text text-anchor="middle" x="5911" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 16 Multiply</text>
<text text-anchor="middle" x="5911" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5911" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5911" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_16_gate_act&#45;&gt;expert_16_multiply -->
<g id="edge185" class="edge">
<title>expert_16_gate_act&#45;&gt;expert_16_multiply</title>
<path fill="none" stroke="black" d="M5841.25,-621.94C5841.25,-621.94 5841.25,-596.39 5841.25,-596.39"/>
<polygon fill="black" stroke="black" points="5844.75,-596.39 5841.25,-586.39 5837.75,-596.39 5844.75,-596.39"/>
</g>
<!-- expert_16_expert_act -->
<g id="node133" class="node">
<title>expert_16_expert_act</title>
<polygon fill="lightblue" stroke="black" points="6078,-666.23 5920,-666.23 5920,-622.23 6078,-622.23 6078,-666.23"/>
<text text-anchor="middle" x="5999" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 16 Expert Act</text>
<text text-anchor="middle" x="5999" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5999" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5999" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_16_expert&#45;&gt;expert_16_expert_act -->
<g id="edge184" class="edge">
<title>expert_16_expert&#45;&gt;expert_16_expert_act</title>
<path fill="none" stroke="black" d="M5999,-701.94C5999,-701.94 5999,-676.39 5999,-676.39"/>
<polygon fill="black" stroke="black" points="6002.5,-676.39 5999,-666.39 5995.5,-676.39 6002.5,-676.39"/>
</g>
<!-- expert_16_expert_act&#45;&gt;expert_16_multiply -->
<g id="edge186" class="edge">
<title>expert_16_expert_act&#45;&gt;expert_16_multiply</title>
<path fill="none" stroke="black" d="M5980.75,-621.94C5980.75,-621.94 5980.75,-596.39 5980.75,-596.39"/>
<polygon fill="black" stroke="black" points="5984.25,-596.39 5980.75,-586.39 5977.25,-596.39 5984.25,-596.39"/>
</g>
<!-- expert_16_out_proj -->
<g id="node135" class="node">
<title>expert_16_out_proj</title>
<polygon fill="lightblue" stroke="black" points="5988,-506.23 5834,-506.23 5834,-462.23 5988,-462.23 5988,-506.23"/>
<text text-anchor="middle" x="5911" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 16 Output Proj</text>
<text text-anchor="middle" x="5911" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="5911" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="5911" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_16_multiply&#45;&gt;expert_16_out_proj -->
<g id="edge187" class="edge">
<title>expert_16_multiply&#45;&gt;expert_16_out_proj</title>
<path fill="none" stroke="black" d="M5911,-541.94C5911,-541.94 5911,-516.39 5911,-516.39"/>
<polygon fill="black" stroke="black" points="5914.5,-516.39 5911,-506.39 5907.5,-516.39 5914.5,-516.39"/>
</g>
<!-- expert_16_out_proj&#45;&gt;gather_comm -->
<g id="edge188" class="edge">
<title>expert_16_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M5911,-462.2C5911,-462.2 5911,-436.3 5911,-436.3"/>
<polygon fill="black" stroke="black" points="5914.5,-436.3 5911,-426.3 5907.5,-436.3 5914.5,-436.3"/>
</g>
<!-- expert_17_gate -->
<g id="node137" class="node">
<title>expert_17_gate</title>
<polygon fill="lightblue" stroke="black" points="6260,-746.23 6102,-746.23 6102,-702.23 6260,-702.23 6260,-746.23"/>
<text text-anchor="middle" x="6181" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 17 Gate</text>
<text text-anchor="middle" x="6181" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6181" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6181" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_17_ln&#45;&gt;expert_17_gate -->
<g id="edge191" class="edge">
<title>expert_17_ln&#45;&gt;expert_17_gate</title>
<path fill="none" stroke="black" d="M6181,-781.94C6181,-781.94 6181,-756.39 6181,-756.39"/>
<polygon fill="black" stroke="black" points="6184.5,-756.39 6181,-746.39 6177.5,-756.39 6184.5,-756.39"/>
</g>
<!-- expert_17_expert -->
<g id="node139" class="node">
<title>expert_17_expert</title>
<polygon fill="lightblue" stroke="black" points="6436,-746.23 6278,-746.23 6278,-702.23 6436,-702.23 6436,-746.23"/>
<text text-anchor="middle" x="6357" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 17 Expert</text>
<text text-anchor="middle" x="6357" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6357" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6357" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_17_ln&#45;&gt;expert_17_expert -->
<g id="edge193" class="edge">
<title>expert_17_ln&#45;&gt;expert_17_expert</title>
<path fill="none" stroke="black" d="M6258.2,-804C6305.49,-804 6357,-804 6357,-804 6357,-804 6357,-756.45 6357,-756.45"/>
<polygon fill="black" stroke="black" points="6360.5,-756.45 6357,-746.45 6353.5,-756.45 6360.5,-756.45"/>
</g>
<!-- expert_17_gate_act -->
<g id="node138" class="node">
<title>expert_17_gate_act</title>
<polygon fill="lightblue" stroke="black" points="6260,-666.23 6102,-666.23 6102,-622.23 6260,-622.23 6260,-666.23"/>
<text text-anchor="middle" x="6181" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 17 SiLU</text>
<text text-anchor="middle" x="6181" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6181" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6181" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_17_gate&#45;&gt;expert_17_gate_act -->
<g id="edge192" class="edge">
<title>expert_17_gate&#45;&gt;expert_17_gate_act</title>
<path fill="none" stroke="black" d="M6181,-701.94C6181,-701.94 6181,-676.39 6181,-676.39"/>
<polygon fill="black" stroke="black" points="6184.5,-676.39 6181,-666.39 6177.5,-676.39 6184.5,-676.39"/>
</g>
<!-- expert_17_multiply -->
<g id="node141" class="node">
<title>expert_17_multiply</title>
<polygon fill="lightblue" stroke="black" points="6363.5,-586.23 6102.5,-586.23 6102.5,-542.23 6363.5,-542.23 6363.5,-586.23"/>
<text text-anchor="middle" x="6233" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 17 Multiply</text>
<text text-anchor="middle" x="6233" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6233" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6233" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_17_gate_act&#45;&gt;expert_17_multiply -->
<g id="edge195" class="edge">
<title>expert_17_gate_act&#45;&gt;expert_17_multiply</title>
<path fill="none" stroke="black" d="M6181.25,-621.94C6181.25,-621.94 6181.25,-596.39 6181.25,-596.39"/>
<polygon fill="black" stroke="black" points="6184.75,-596.39 6181.25,-586.39 6177.75,-596.39 6184.75,-596.39"/>
</g>
<!-- expert_17_expert_act -->
<g id="node140" class="node">
<title>expert_17_expert_act</title>
<polygon fill="lightblue" stroke="black" points="6436,-666.23 6278,-666.23 6278,-622.23 6436,-622.23 6436,-666.23"/>
<text text-anchor="middle" x="6357" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 17 Expert Act</text>
<text text-anchor="middle" x="6357" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6357" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6357" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_17_expert&#45;&gt;expert_17_expert_act -->
<g id="edge194" class="edge">
<title>expert_17_expert&#45;&gt;expert_17_expert_act</title>
<path fill="none" stroke="black" d="M6357,-701.94C6357,-701.94 6357,-676.39 6357,-676.39"/>
<polygon fill="black" stroke="black" points="6360.5,-676.39 6357,-666.39 6353.5,-676.39 6360.5,-676.39"/>
</g>
<!-- expert_17_expert_act&#45;&gt;expert_17_multiply -->
<g id="edge196" class="edge">
<title>expert_17_expert_act&#45;&gt;expert_17_multiply</title>
<path fill="none" stroke="black" d="M6320.75,-621.94C6320.75,-621.94 6320.75,-596.39 6320.75,-596.39"/>
<polygon fill="black" stroke="black" points="6324.25,-596.39 6320.75,-586.39 6317.25,-596.39 6324.25,-596.39"/>
</g>
<!-- expert_17_out_proj -->
<g id="node142" class="node">
<title>expert_17_out_proj</title>
<polygon fill="lightblue" stroke="black" points="6283,-506.23 6129,-506.23 6129,-462.23 6283,-462.23 6283,-506.23"/>
<text text-anchor="middle" x="6206" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 17 Output Proj</text>
<text text-anchor="middle" x="6206" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="6206" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6206" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_17_multiply&#45;&gt;expert_17_out_proj -->
<g id="edge197" class="edge">
<title>expert_17_multiply&#45;&gt;expert_17_out_proj</title>
<path fill="none" stroke="black" d="M6206,-541.94C6206,-541.94 6206,-516.39 6206,-516.39"/>
<polygon fill="black" stroke="black" points="6209.5,-516.39 6206,-506.39 6202.5,-516.39 6209.5,-516.39"/>
</g>
<!-- expert_17_out_proj&#45;&gt;gather_comm -->
<g id="edge198" class="edge">
<title>expert_17_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M6128.95,-484C6075.49,-484 6013.85,-484 6013.85,-484 6013.85,-484 6013.85,-423.96 6013.85,-423.96"/>
<polygon fill="black" stroke="black" points="6017.35,-423.96 6013.85,-413.96 6010.35,-423.96 6017.35,-423.96"/>
</g>
<!-- expert_18_gate -->
<g id="node144" class="node">
<title>expert_18_gate</title>
<polygon fill="lightblue" stroke="black" points="6618,-746.23 6460,-746.23 6460,-702.23 6618,-702.23 6618,-746.23"/>
<text text-anchor="middle" x="6539" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 18 Gate</text>
<text text-anchor="middle" x="6539" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6539" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6539" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_18_ln&#45;&gt;expert_18_gate -->
<g id="edge201" class="edge">
<title>expert_18_ln&#45;&gt;expert_18_gate</title>
<path fill="none" stroke="black" d="M6539,-781.94C6539,-781.94 6539,-756.39 6539,-756.39"/>
<polygon fill="black" stroke="black" points="6542.5,-756.39 6539,-746.39 6535.5,-756.39 6542.5,-756.39"/>
</g>
<!-- expert_18_expert -->
<g id="node146" class="node">
<title>expert_18_expert</title>
<polygon fill="lightblue" stroke="black" points="6794,-746.23 6636,-746.23 6636,-702.23 6794,-702.23 6794,-746.23"/>
<text text-anchor="middle" x="6715" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 18 Expert</text>
<text text-anchor="middle" x="6715" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6715" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6715" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_18_ln&#45;&gt;expert_18_expert -->
<g id="edge203" class="edge">
<title>expert_18_ln&#45;&gt;expert_18_expert</title>
<path fill="none" stroke="black" d="M6616.2,-804C6663.49,-804 6715,-804 6715,-804 6715,-804 6715,-756.45 6715,-756.45"/>
<polygon fill="black" stroke="black" points="6718.5,-756.45 6715,-746.45 6711.5,-756.45 6718.5,-756.45"/>
</g>
<!-- expert_18_gate_act -->
<g id="node145" class="node">
<title>expert_18_gate_act</title>
<polygon fill="lightblue" stroke="black" points="6618,-666.23 6460,-666.23 6460,-622.23 6618,-622.23 6618,-666.23"/>
<text text-anchor="middle" x="6539" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 18 SiLU</text>
<text text-anchor="middle" x="6539" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6539" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6539" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_18_gate&#45;&gt;expert_18_gate_act -->
<g id="edge202" class="edge">
<title>expert_18_gate&#45;&gt;expert_18_gate_act</title>
<path fill="none" stroke="black" d="M6539,-701.94C6539,-701.94 6539,-676.39 6539,-676.39"/>
<polygon fill="black" stroke="black" points="6542.5,-676.39 6539,-666.39 6535.5,-676.39 6542.5,-676.39"/>
</g>
<!-- expert_18_multiply -->
<g id="node148" class="node">
<title>expert_18_multiply</title>
<polygon fill="lightblue" stroke="black" points="6721.5,-586.23 6460.5,-586.23 6460.5,-542.23 6721.5,-542.23 6721.5,-586.23"/>
<text text-anchor="middle" x="6591" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 18 Multiply</text>
<text text-anchor="middle" x="6591" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6591" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6591" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_18_gate_act&#45;&gt;expert_18_multiply -->
<g id="edge205" class="edge">
<title>expert_18_gate_act&#45;&gt;expert_18_multiply</title>
<path fill="none" stroke="black" d="M6539.25,-621.94C6539.25,-621.94 6539.25,-596.39 6539.25,-596.39"/>
<polygon fill="black" stroke="black" points="6542.75,-596.39 6539.25,-586.39 6535.75,-596.39 6542.75,-596.39"/>
</g>
<!-- expert_18_expert_act -->
<g id="node147" class="node">
<title>expert_18_expert_act</title>
<polygon fill="lightblue" stroke="black" points="6794,-666.23 6636,-666.23 6636,-622.23 6794,-622.23 6794,-666.23"/>
<text text-anchor="middle" x="6715" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 18 Expert Act</text>
<text text-anchor="middle" x="6715" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6715" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6715" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_18_expert&#45;&gt;expert_18_expert_act -->
<g id="edge204" class="edge">
<title>expert_18_expert&#45;&gt;expert_18_expert_act</title>
<path fill="none" stroke="black" d="M6715,-701.94C6715,-701.94 6715,-676.39 6715,-676.39"/>
<polygon fill="black" stroke="black" points="6718.5,-676.39 6715,-666.39 6711.5,-676.39 6718.5,-676.39"/>
</g>
<!-- expert_18_expert_act&#45;&gt;expert_18_multiply -->
<g id="edge206" class="edge">
<title>expert_18_expert_act&#45;&gt;expert_18_multiply</title>
<path fill="none" stroke="black" d="M6678.75,-621.94C6678.75,-621.94 6678.75,-596.39 6678.75,-596.39"/>
<polygon fill="black" stroke="black" points="6682.25,-596.39 6678.75,-586.39 6675.25,-596.39 6682.25,-596.39"/>
</g>
<!-- expert_18_out_proj -->
<g id="node149" class="node">
<title>expert_18_out_proj</title>
<polygon fill="lightblue" stroke="black" points="6641,-506.23 6487,-506.23 6487,-462.23 6641,-462.23 6641,-506.23"/>
<text text-anchor="middle" x="6564" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 18 Output Proj</text>
<text text-anchor="middle" x="6564" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="6564" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6564" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_18_multiply&#45;&gt;expert_18_out_proj -->
<g id="edge207" class="edge">
<title>expert_18_multiply&#45;&gt;expert_18_out_proj</title>
<path fill="none" stroke="black" d="M6564,-541.94C6564,-541.94 6564,-516.39 6564,-516.39"/>
<polygon fill="black" stroke="black" points="6567.5,-516.39 6564,-506.39 6560.5,-516.39 6567.5,-516.39"/>
</g>
<!-- expert_18_out_proj&#45;&gt;gather_comm -->
<g id="edge208" class="edge">
<title>expert_18_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M6564,-462.11C6564,-444.23 6564,-422 6564,-422 6564,-422 5986,-422 5986,-422"/>
<polygon fill="black" stroke="black" points="5986,-418.5 5976,-422 5986,-425.5 5986,-418.5"/>
</g>
<!-- expert_19_gate -->
<g id="node151" class="node">
<title>expert_19_gate</title>
<polygon fill="lightblue" stroke="black" points="6976,-746.23 6818,-746.23 6818,-702.23 6976,-702.23 6976,-746.23"/>
<text text-anchor="middle" x="6897" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 19 Gate</text>
<text text-anchor="middle" x="6897" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="6897" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="6897" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_19_ln&#45;&gt;expert_19_gate -->
<g id="edge211" class="edge">
<title>expert_19_ln&#45;&gt;expert_19_gate</title>
<path fill="none" stroke="black" d="M6897,-781.94C6897,-781.94 6897,-756.39 6897,-756.39"/>
<polygon fill="black" stroke="black" points="6900.5,-756.39 6897,-746.39 6893.5,-756.39 6900.5,-756.39"/>
</g>
<!-- expert_19_expert -->
<g id="node153" class="node">
<title>expert_19_expert</title>
<polygon fill="lightblue" stroke="black" points="7152,-746.23 6994,-746.23 6994,-702.23 7152,-702.23 7152,-746.23"/>
<text text-anchor="middle" x="7073" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 19 Expert</text>
<text text-anchor="middle" x="7073" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="7073" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7073" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_19_ln&#45;&gt;expert_19_expert -->
<g id="edge213" class="edge">
<title>expert_19_ln&#45;&gt;expert_19_expert</title>
<path fill="none" stroke="black" d="M6974.2,-804C7021.49,-804 7073,-804 7073,-804 7073,-804 7073,-756.45 7073,-756.45"/>
<polygon fill="black" stroke="black" points="7076.5,-756.45 7073,-746.45 7069.5,-756.45 7076.5,-756.45"/>
</g>
<!-- expert_19_gate_act -->
<g id="node152" class="node">
<title>expert_19_gate_act</title>
<polygon fill="lightblue" stroke="black" points="6976,-666.23 6818,-666.23 6818,-622.23 6976,-622.23 6976,-666.23"/>
<text text-anchor="middle" x="6897" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 19 SiLU</text>
<text text-anchor="middle" x="6897" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="6897" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6897" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_19_gate&#45;&gt;expert_19_gate_act -->
<g id="edge212" class="edge">
<title>expert_19_gate&#45;&gt;expert_19_gate_act</title>
<path fill="none" stroke="black" d="M6897,-701.94C6897,-701.94 6897,-676.39 6897,-676.39"/>
<polygon fill="black" stroke="black" points="6900.5,-676.39 6897,-666.39 6893.5,-676.39 6900.5,-676.39"/>
</g>
<!-- expert_19_multiply -->
<g id="node155" class="node">
<title>expert_19_multiply</title>
<polygon fill="lightblue" stroke="black" points="7079.5,-586.23 6818.5,-586.23 6818.5,-542.23 7079.5,-542.23 7079.5,-586.23"/>
<text text-anchor="middle" x="6949" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 19 Multiply</text>
<text text-anchor="middle" x="6949" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="6949" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6949" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_19_gate_act&#45;&gt;expert_19_multiply -->
<g id="edge215" class="edge">
<title>expert_19_gate_act&#45;&gt;expert_19_multiply</title>
<path fill="none" stroke="black" d="M6897.25,-621.94C6897.25,-621.94 6897.25,-596.39 6897.25,-596.39"/>
<polygon fill="black" stroke="black" points="6900.75,-596.39 6897.25,-586.39 6893.75,-596.39 6900.75,-596.39"/>
</g>
<!-- expert_19_expert_act -->
<g id="node154" class="node">
<title>expert_19_expert_act</title>
<polygon fill="lightblue" stroke="black" points="7152,-666.23 6994,-666.23 6994,-622.23 7152,-622.23 7152,-666.23"/>
<text text-anchor="middle" x="7073" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 19 Expert Act</text>
<text text-anchor="middle" x="7073" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="7073" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7073" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_19_expert&#45;&gt;expert_19_expert_act -->
<g id="edge214" class="edge">
<title>expert_19_expert&#45;&gt;expert_19_expert_act</title>
<path fill="none" stroke="black" d="M7073,-701.94C7073,-701.94 7073,-676.39 7073,-676.39"/>
<polygon fill="black" stroke="black" points="7076.5,-676.39 7073,-666.39 7069.5,-676.39 7076.5,-676.39"/>
</g>
<!-- expert_19_expert_act&#45;&gt;expert_19_multiply -->
<g id="edge216" class="edge">
<title>expert_19_expert_act&#45;&gt;expert_19_multiply</title>
<path fill="none" stroke="black" d="M7036.75,-621.94C7036.75,-621.94 7036.75,-596.39 7036.75,-596.39"/>
<polygon fill="black" stroke="black" points="7040.25,-596.39 7036.75,-586.39 7033.25,-596.39 7040.25,-596.39"/>
</g>
<!-- expert_19_out_proj -->
<g id="node156" class="node">
<title>expert_19_out_proj</title>
<polygon fill="lightblue" stroke="black" points="6999,-506.23 6845,-506.23 6845,-462.23 6999,-462.23 6999,-506.23"/>
<text text-anchor="middle" x="6922" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 19 Output Proj</text>
<text text-anchor="middle" x="6922" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="6922" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="6922" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_19_multiply&#45;&gt;expert_19_out_proj -->
<g id="edge217" class="edge">
<title>expert_19_multiply&#45;&gt;expert_19_out_proj</title>
<path fill="none" stroke="black" d="M6922,-541.94C6922,-541.94 6922,-516.39 6922,-516.39"/>
<polygon fill="black" stroke="black" points="6925.5,-516.39 6922,-506.39 6918.5,-516.39 6925.5,-516.39"/>
</g>
<!-- expert_19_out_proj&#45;&gt;gather_comm -->
<g id="edge218" class="edge">
<title>expert_19_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M6922,-462.17C6922,-442.91 6922,-418 6922,-418 6922,-418 6008.51,-418 6008.51,-418"/>
<polygon fill="black" stroke="black" points="6008.51,-414.5 5998.51,-418 6008.51,-421.5 6008.51,-414.5"/>
</g>
<!-- expert_20_gate -->
<g id="node158" class="node">
<title>expert_20_gate</title>
<polygon fill="lightblue" stroke="black" points="7334,-746.23 7176,-746.23 7176,-702.23 7334,-702.23 7334,-746.23"/>
<text text-anchor="middle" x="7255" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 20 Gate</text>
<text text-anchor="middle" x="7255" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7255" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7255" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_20_ln&#45;&gt;expert_20_gate -->
<g id="edge221" class="edge">
<title>expert_20_ln&#45;&gt;expert_20_gate</title>
<path fill="none" stroke="black" d="M7255,-781.94C7255,-781.94 7255,-756.39 7255,-756.39"/>
<polygon fill="black" stroke="black" points="7258.5,-756.39 7255,-746.39 7251.5,-756.39 7258.5,-756.39"/>
</g>
<!-- expert_20_expert -->
<g id="node160" class="node">
<title>expert_20_expert</title>
<polygon fill="lightblue" stroke="black" points="7510,-746.23 7352,-746.23 7352,-702.23 7510,-702.23 7510,-746.23"/>
<text text-anchor="middle" x="7431" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 20 Expert</text>
<text text-anchor="middle" x="7431" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7431" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7431" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_20_ln&#45;&gt;expert_20_expert -->
<g id="edge223" class="edge">
<title>expert_20_ln&#45;&gt;expert_20_expert</title>
<path fill="none" stroke="black" d="M7332.2,-804C7379.49,-804 7431,-804 7431,-804 7431,-804 7431,-756.45 7431,-756.45"/>
<polygon fill="black" stroke="black" points="7434.5,-756.45 7431,-746.45 7427.5,-756.45 7434.5,-756.45"/>
</g>
<!-- expert_20_gate_act -->
<g id="node159" class="node">
<title>expert_20_gate_act</title>
<polygon fill="lightblue" stroke="black" points="7334,-666.23 7176,-666.23 7176,-622.23 7334,-622.23 7334,-666.23"/>
<text text-anchor="middle" x="7255" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 20 SiLU</text>
<text text-anchor="middle" x="7255" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7255" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7255" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_20_gate&#45;&gt;expert_20_gate_act -->
<g id="edge222" class="edge">
<title>expert_20_gate&#45;&gt;expert_20_gate_act</title>
<path fill="none" stroke="black" d="M7255,-701.94C7255,-701.94 7255,-676.39 7255,-676.39"/>
<polygon fill="black" stroke="black" points="7258.5,-676.39 7255,-666.39 7251.5,-676.39 7258.5,-676.39"/>
</g>
<!-- expert_20_multiply -->
<g id="node162" class="node">
<title>expert_20_multiply</title>
<polygon fill="lightblue" stroke="black" points="7437.5,-586.23 7176.5,-586.23 7176.5,-542.23 7437.5,-542.23 7437.5,-586.23"/>
<text text-anchor="middle" x="7307" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 20 Multiply</text>
<text text-anchor="middle" x="7307" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7307" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7307" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_20_gate_act&#45;&gt;expert_20_multiply -->
<g id="edge225" class="edge">
<title>expert_20_gate_act&#45;&gt;expert_20_multiply</title>
<path fill="none" stroke="black" d="M7255.25,-621.94C7255.25,-621.94 7255.25,-596.39 7255.25,-596.39"/>
<polygon fill="black" stroke="black" points="7258.75,-596.39 7255.25,-586.39 7251.75,-596.39 7258.75,-596.39"/>
</g>
<!-- expert_20_expert_act -->
<g id="node161" class="node">
<title>expert_20_expert_act</title>
<polygon fill="lightblue" stroke="black" points="7510,-666.23 7352,-666.23 7352,-622.23 7510,-622.23 7510,-666.23"/>
<text text-anchor="middle" x="7431" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 20 Expert Act</text>
<text text-anchor="middle" x="7431" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7431" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7431" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_20_expert&#45;&gt;expert_20_expert_act -->
<g id="edge224" class="edge">
<title>expert_20_expert&#45;&gt;expert_20_expert_act</title>
<path fill="none" stroke="black" d="M7431,-701.94C7431,-701.94 7431,-676.39 7431,-676.39"/>
<polygon fill="black" stroke="black" points="7434.5,-676.39 7431,-666.39 7427.5,-676.39 7434.5,-676.39"/>
</g>
<!-- expert_20_expert_act&#45;&gt;expert_20_multiply -->
<g id="edge226" class="edge">
<title>expert_20_expert_act&#45;&gt;expert_20_multiply</title>
<path fill="none" stroke="black" d="M7394.75,-621.94C7394.75,-621.94 7394.75,-596.39 7394.75,-596.39"/>
<polygon fill="black" stroke="black" points="7398.25,-596.39 7394.75,-586.39 7391.25,-596.39 7398.25,-596.39"/>
</g>
<!-- expert_20_out_proj -->
<g id="node163" class="node">
<title>expert_20_out_proj</title>
<polygon fill="lightblue" stroke="black" points="7357,-506.23 7203,-506.23 7203,-462.23 7357,-462.23 7357,-506.23"/>
<text text-anchor="middle" x="7280" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 20 Output Proj</text>
<text text-anchor="middle" x="7280" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="7280" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7280" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_20_multiply&#45;&gt;expert_20_out_proj -->
<g id="edge227" class="edge">
<title>expert_20_multiply&#45;&gt;expert_20_out_proj</title>
<path fill="none" stroke="black" d="M7280,-541.94C7280,-541.94 7280,-516.39 7280,-516.39"/>
<polygon fill="black" stroke="black" points="7283.5,-516.39 7280,-506.39 7276.5,-516.39 7283.5,-516.39"/>
</g>
<!-- expert_20_out_proj&#45;&gt;gather_comm -->
<g id="edge228" class="edge">
<title>expert_20_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M7280,-462.01C7280,-441.43 7280,-414 7280,-414 7280,-414 6023.34,-414 6023.34,-414"/>
<polygon fill="black" stroke="black" points="6023.34,-410.5 6013.34,-414 6023.34,-417.5 6023.34,-410.5"/>
</g>
<!-- expert_21_gate -->
<g id="node165" class="node">
<title>expert_21_gate</title>
<polygon fill="lightblue" stroke="black" points="7692,-746.23 7534,-746.23 7534,-702.23 7692,-702.23 7692,-746.23"/>
<text text-anchor="middle" x="7613" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 21 Gate</text>
<text text-anchor="middle" x="7613" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7613" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7613" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_21_ln&#45;&gt;expert_21_gate -->
<g id="edge231" class="edge">
<title>expert_21_ln&#45;&gt;expert_21_gate</title>
<path fill="none" stroke="black" d="M7613,-781.94C7613,-781.94 7613,-756.39 7613,-756.39"/>
<polygon fill="black" stroke="black" points="7616.5,-756.39 7613,-746.39 7609.5,-756.39 7616.5,-756.39"/>
</g>
<!-- expert_21_expert -->
<g id="node167" class="node">
<title>expert_21_expert</title>
<polygon fill="lightblue" stroke="black" points="7868,-746.23 7710,-746.23 7710,-702.23 7868,-702.23 7868,-746.23"/>
<text text-anchor="middle" x="7789" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 21 Expert</text>
<text text-anchor="middle" x="7789" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7789" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7789" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_21_ln&#45;&gt;expert_21_expert -->
<g id="edge233" class="edge">
<title>expert_21_ln&#45;&gt;expert_21_expert</title>
<path fill="none" stroke="black" d="M7690.2,-804C7737.49,-804 7789,-804 7789,-804 7789,-804 7789,-756.45 7789,-756.45"/>
<polygon fill="black" stroke="black" points="7792.5,-756.45 7789,-746.45 7785.5,-756.45 7792.5,-756.45"/>
</g>
<!-- expert_21_gate_act -->
<g id="node166" class="node">
<title>expert_21_gate_act</title>
<polygon fill="lightblue" stroke="black" points="7692,-666.23 7534,-666.23 7534,-622.23 7692,-622.23 7692,-666.23"/>
<text text-anchor="middle" x="7613" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 21 SiLU</text>
<text text-anchor="middle" x="7613" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7613" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7613" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_21_gate&#45;&gt;expert_21_gate_act -->
<g id="edge232" class="edge">
<title>expert_21_gate&#45;&gt;expert_21_gate_act</title>
<path fill="none" stroke="black" d="M7613,-701.94C7613,-701.94 7613,-676.39 7613,-676.39"/>
<polygon fill="black" stroke="black" points="7616.5,-676.39 7613,-666.39 7609.5,-676.39 7616.5,-676.39"/>
</g>
<!-- expert_21_multiply -->
<g id="node169" class="node">
<title>expert_21_multiply</title>
<polygon fill="lightblue" stroke="black" points="7795.5,-586.23 7534.5,-586.23 7534.5,-542.23 7795.5,-542.23 7795.5,-586.23"/>
<text text-anchor="middle" x="7665" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 21 Multiply</text>
<text text-anchor="middle" x="7665" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7665" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7665" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_21_gate_act&#45;&gt;expert_21_multiply -->
<g id="edge235" class="edge">
<title>expert_21_gate_act&#45;&gt;expert_21_multiply</title>
<path fill="none" stroke="black" d="M7613.25,-621.94C7613.25,-621.94 7613.25,-596.39 7613.25,-596.39"/>
<polygon fill="black" stroke="black" points="7616.75,-596.39 7613.25,-586.39 7609.75,-596.39 7616.75,-596.39"/>
</g>
<!-- expert_21_expert_act -->
<g id="node168" class="node">
<title>expert_21_expert_act</title>
<polygon fill="lightblue" stroke="black" points="7868,-666.23 7710,-666.23 7710,-622.23 7868,-622.23 7868,-666.23"/>
<text text-anchor="middle" x="7789" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 21 Expert Act</text>
<text text-anchor="middle" x="7789" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7789" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7789" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_21_expert&#45;&gt;expert_21_expert_act -->
<g id="edge234" class="edge">
<title>expert_21_expert&#45;&gt;expert_21_expert_act</title>
<path fill="none" stroke="black" d="M7789,-701.94C7789,-701.94 7789,-676.39 7789,-676.39"/>
<polygon fill="black" stroke="black" points="7792.5,-676.39 7789,-666.39 7785.5,-676.39 7792.5,-676.39"/>
</g>
<!-- expert_21_expert_act&#45;&gt;expert_21_multiply -->
<g id="edge236" class="edge">
<title>expert_21_expert_act&#45;&gt;expert_21_multiply</title>
<path fill="none" stroke="black" d="M7752.75,-621.94C7752.75,-621.94 7752.75,-596.39 7752.75,-596.39"/>
<polygon fill="black" stroke="black" points="7756.25,-596.39 7752.75,-586.39 7749.25,-596.39 7756.25,-596.39"/>
</g>
<!-- expert_21_out_proj -->
<g id="node170" class="node">
<title>expert_21_out_proj</title>
<polygon fill="lightblue" stroke="black" points="7715,-506.23 7561,-506.23 7561,-462.23 7715,-462.23 7715,-506.23"/>
<text text-anchor="middle" x="7638" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 21 Output Proj</text>
<text text-anchor="middle" x="7638" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="7638" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7638" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_21_multiply&#45;&gt;expert_21_out_proj -->
<g id="edge237" class="edge">
<title>expert_21_multiply&#45;&gt;expert_21_out_proj</title>
<path fill="none" stroke="black" d="M7638,-541.94C7638,-541.94 7638,-516.39 7638,-516.39"/>
<polygon fill="black" stroke="black" points="7641.5,-516.39 7638,-506.39 7634.5,-516.39 7641.5,-516.39"/>
</g>
<!-- expert_21_out_proj&#45;&gt;gather_comm -->
<g id="edge238" class="edge">
<title>expert_21_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M7638,-461.96C7638,-440.09 7638,-410 7638,-410 7638,-410 6034.31,-410 6034.31,-410"/>
<polygon fill="black" stroke="black" points="6034.31,-406.5 6024.31,-410 6034.31,-413.5 6034.31,-406.5"/>
</g>
<!-- expert_22_gate -->
<g id="node172" class="node">
<title>expert_22_gate</title>
<polygon fill="lightblue" stroke="black" points="8050,-746.23 7892,-746.23 7892,-702.23 8050,-702.23 8050,-746.23"/>
<text text-anchor="middle" x="7971" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 22 Gate</text>
<text text-anchor="middle" x="7971" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="7971" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="7971" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_22_ln&#45;&gt;expert_22_gate -->
<g id="edge241" class="edge">
<title>expert_22_ln&#45;&gt;expert_22_gate</title>
<path fill="none" stroke="black" d="M7971,-781.94C7971,-781.94 7971,-756.39 7971,-756.39"/>
<polygon fill="black" stroke="black" points="7974.5,-756.39 7971,-746.39 7967.5,-756.39 7974.5,-756.39"/>
</g>
<!-- expert_22_expert -->
<g id="node174" class="node">
<title>expert_22_expert</title>
<polygon fill="lightblue" stroke="black" points="8226,-746.23 8068,-746.23 8068,-702.23 8226,-702.23 8226,-746.23"/>
<text text-anchor="middle" x="8147" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 22 Expert</text>
<text text-anchor="middle" x="8147" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="8147" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8147" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_22_ln&#45;&gt;expert_22_expert -->
<g id="edge243" class="edge">
<title>expert_22_ln&#45;&gt;expert_22_expert</title>
<path fill="none" stroke="black" d="M8048.2,-804C8095.49,-804 8147,-804 8147,-804 8147,-804 8147,-756.45 8147,-756.45"/>
<polygon fill="black" stroke="black" points="8150.5,-756.45 8147,-746.45 8143.5,-756.45 8150.5,-756.45"/>
</g>
<!-- expert_22_gate_act -->
<g id="node173" class="node">
<title>expert_22_gate_act</title>
<polygon fill="lightblue" stroke="black" points="8050,-666.23 7892,-666.23 7892,-622.23 8050,-622.23 8050,-666.23"/>
<text text-anchor="middle" x="7971" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 22 SiLU</text>
<text text-anchor="middle" x="7971" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="7971" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7971" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_22_gate&#45;&gt;expert_22_gate_act -->
<g id="edge242" class="edge">
<title>expert_22_gate&#45;&gt;expert_22_gate_act</title>
<path fill="none" stroke="black" d="M7971,-701.94C7971,-701.94 7971,-676.39 7971,-676.39"/>
<polygon fill="black" stroke="black" points="7974.5,-676.39 7971,-666.39 7967.5,-676.39 7974.5,-676.39"/>
</g>
<!-- expert_22_multiply -->
<g id="node176" class="node">
<title>expert_22_multiply</title>
<polygon fill="lightblue" stroke="black" points="8153.5,-586.23 7892.5,-586.23 7892.5,-542.23 8153.5,-542.23 8153.5,-586.23"/>
<text text-anchor="middle" x="8023" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 22 Multiply</text>
<text text-anchor="middle" x="8023" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="8023" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8023" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_22_gate_act&#45;&gt;expert_22_multiply -->
<g id="edge245" class="edge">
<title>expert_22_gate_act&#45;&gt;expert_22_multiply</title>
<path fill="none" stroke="black" d="M7971.25,-621.94C7971.25,-621.94 7971.25,-596.39 7971.25,-596.39"/>
<polygon fill="black" stroke="black" points="7974.75,-596.39 7971.25,-586.39 7967.75,-596.39 7974.75,-596.39"/>
</g>
<!-- expert_22_expert_act -->
<g id="node175" class="node">
<title>expert_22_expert_act</title>
<polygon fill="lightblue" stroke="black" points="8226,-666.23 8068,-666.23 8068,-622.23 8226,-622.23 8226,-666.23"/>
<text text-anchor="middle" x="8147" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 22 Expert Act</text>
<text text-anchor="middle" x="8147" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="8147" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8147" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_22_expert&#45;&gt;expert_22_expert_act -->
<g id="edge244" class="edge">
<title>expert_22_expert&#45;&gt;expert_22_expert_act</title>
<path fill="none" stroke="black" d="M8147,-701.94C8147,-701.94 8147,-676.39 8147,-676.39"/>
<polygon fill="black" stroke="black" points="8150.5,-676.39 8147,-666.39 8143.5,-676.39 8150.5,-676.39"/>
</g>
<!-- expert_22_expert_act&#45;&gt;expert_22_multiply -->
<g id="edge246" class="edge">
<title>expert_22_expert_act&#45;&gt;expert_22_multiply</title>
<path fill="none" stroke="black" d="M8110.75,-621.94C8110.75,-621.94 8110.75,-596.39 8110.75,-596.39"/>
<polygon fill="black" stroke="black" points="8114.25,-596.39 8110.75,-586.39 8107.25,-596.39 8114.25,-596.39"/>
</g>
<!-- expert_22_out_proj -->
<g id="node177" class="node">
<title>expert_22_out_proj</title>
<polygon fill="lightblue" stroke="black" points="8073,-506.23 7919,-506.23 7919,-462.23 8073,-462.23 8073,-506.23"/>
<text text-anchor="middle" x="7996" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 22 Output Proj</text>
<text text-anchor="middle" x="7996" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="7996" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="7996" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_22_multiply&#45;&gt;expert_22_out_proj -->
<g id="edge247" class="edge">
<title>expert_22_multiply&#45;&gt;expert_22_out_proj</title>
<path fill="none" stroke="black" d="M7996,-541.94C7996,-541.94 7996,-516.39 7996,-516.39"/>
<polygon fill="black" stroke="black" points="7999.5,-516.39 7996,-506.39 7992.5,-516.39 7999.5,-516.39"/>
</g>
<!-- expert_22_out_proj&#45;&gt;gather_comm -->
<g id="edge248" class="edge">
<title>expert_22_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M7996,-462.02C7996,-438.89 7996,-406 7996,-406 7996,-406 6041.73,-406 6041.73,-406"/>
<polygon fill="black" stroke="black" points="6041.73,-402.5 6031.73,-406 6041.73,-409.5 6041.73,-402.5"/>
</g>
<!-- expert_23_gate -->
<g id="node179" class="node">
<title>expert_23_gate</title>
<polygon fill="lightblue" stroke="black" points="8408,-746.23 8250,-746.23 8250,-702.23 8408,-702.23 8408,-746.23"/>
<text text-anchor="middle" x="8329" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 23 Gate</text>
<text text-anchor="middle" x="8329" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8329" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8329" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_23_ln&#45;&gt;expert_23_gate -->
<g id="edge251" class="edge">
<title>expert_23_ln&#45;&gt;expert_23_gate</title>
<path fill="none" stroke="black" d="M8329,-781.94C8329,-781.94 8329,-756.39 8329,-756.39"/>
<polygon fill="black" stroke="black" points="8332.5,-756.39 8329,-746.39 8325.5,-756.39 8332.5,-756.39"/>
</g>
<!-- expert_23_expert -->
<g id="node181" class="node">
<title>expert_23_expert</title>
<polygon fill="lightblue" stroke="black" points="8584,-746.23 8426,-746.23 8426,-702.23 8584,-702.23 8584,-746.23"/>
<text text-anchor="middle" x="8505" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 23 Expert</text>
<text text-anchor="middle" x="8505" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8505" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8505" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_23_ln&#45;&gt;expert_23_expert -->
<g id="edge253" class="edge">
<title>expert_23_ln&#45;&gt;expert_23_expert</title>
<path fill="none" stroke="black" d="M8406.2,-804C8453.49,-804 8505,-804 8505,-804 8505,-804 8505,-756.45 8505,-756.45"/>
<polygon fill="black" stroke="black" points="8508.5,-756.45 8505,-746.45 8501.5,-756.45 8508.5,-756.45"/>
</g>
<!-- expert_23_gate_act -->
<g id="node180" class="node">
<title>expert_23_gate_act</title>
<polygon fill="lightblue" stroke="black" points="8408,-666.23 8250,-666.23 8250,-622.23 8408,-622.23 8408,-666.23"/>
<text text-anchor="middle" x="8329" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 23 SiLU</text>
<text text-anchor="middle" x="8329" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8329" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8329" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_23_gate&#45;&gt;expert_23_gate_act -->
<g id="edge252" class="edge">
<title>expert_23_gate&#45;&gt;expert_23_gate_act</title>
<path fill="none" stroke="black" d="M8329,-701.94C8329,-701.94 8329,-676.39 8329,-676.39"/>
<polygon fill="black" stroke="black" points="8332.5,-676.39 8329,-666.39 8325.5,-676.39 8332.5,-676.39"/>
</g>
<!-- expert_23_multiply -->
<g id="node183" class="node">
<title>expert_23_multiply</title>
<polygon fill="lightblue" stroke="black" points="8511.5,-586.23 8250.5,-586.23 8250.5,-542.23 8511.5,-542.23 8511.5,-586.23"/>
<text text-anchor="middle" x="8381" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 23 Multiply</text>
<text text-anchor="middle" x="8381" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8381" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8381" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_23_gate_act&#45;&gt;expert_23_multiply -->
<g id="edge255" class="edge">
<title>expert_23_gate_act&#45;&gt;expert_23_multiply</title>
<path fill="none" stroke="black" d="M8329.25,-621.94C8329.25,-621.94 8329.25,-596.39 8329.25,-596.39"/>
<polygon fill="black" stroke="black" points="8332.75,-596.39 8329.25,-586.39 8325.75,-596.39 8332.75,-596.39"/>
</g>
<!-- expert_23_expert_act -->
<g id="node182" class="node">
<title>expert_23_expert_act</title>
<polygon fill="lightblue" stroke="black" points="8584,-666.23 8426,-666.23 8426,-622.23 8584,-622.23 8584,-666.23"/>
<text text-anchor="middle" x="8505" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 23 Expert Act</text>
<text text-anchor="middle" x="8505" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8505" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8505" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_23_expert&#45;&gt;expert_23_expert_act -->
<g id="edge254" class="edge">
<title>expert_23_expert&#45;&gt;expert_23_expert_act</title>
<path fill="none" stroke="black" d="M8505,-701.94C8505,-701.94 8505,-676.39 8505,-676.39"/>
<polygon fill="black" stroke="black" points="8508.5,-676.39 8505,-666.39 8501.5,-676.39 8508.5,-676.39"/>
</g>
<!-- expert_23_expert_act&#45;&gt;expert_23_multiply -->
<g id="edge256" class="edge">
<title>expert_23_expert_act&#45;&gt;expert_23_multiply</title>
<path fill="none" stroke="black" d="M8468.75,-621.94C8468.75,-621.94 8468.75,-596.39 8468.75,-596.39"/>
<polygon fill="black" stroke="black" points="8472.25,-596.39 8468.75,-586.39 8465.25,-596.39 8472.25,-596.39"/>
</g>
<!-- expert_23_out_proj -->
<g id="node184" class="node">
<title>expert_23_out_proj</title>
<polygon fill="lightblue" stroke="black" points="8431,-506.23 8277,-506.23 8277,-462.23 8431,-462.23 8431,-506.23"/>
<text text-anchor="middle" x="8354" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 23 Output Proj</text>
<text text-anchor="middle" x="8354" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="8354" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8354" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_23_multiply&#45;&gt;expert_23_out_proj -->
<g id="edge257" class="edge">
<title>expert_23_multiply&#45;&gt;expert_23_out_proj</title>
<path fill="none" stroke="black" d="M8354,-541.94C8354,-541.94 8354,-516.39 8354,-516.39"/>
<polygon fill="black" stroke="black" points="8357.5,-516.39 8354,-506.39 8350.5,-516.39 8357.5,-516.39"/>
</g>
<!-- expert_23_out_proj&#45;&gt;gather_comm -->
<g id="edge258" class="edge">
<title>expert_23_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M8350.49,-462.19C8350.49,-437.83 8350.49,-402 8350.49,-402 8350.49,-402 6046.6,-402 6046.6,-402"/>
<polygon fill="black" stroke="black" points="6046.6,-398.5 6036.6,-402 6046.6,-405.5 6046.6,-398.5"/>
</g>
<!-- expert_24_gate -->
<g id="node186" class="node">
<title>expert_24_gate</title>
<polygon fill="lightblue" stroke="black" points="8766,-746.23 8608,-746.23 8608,-702.23 8766,-702.23 8766,-746.23"/>
<text text-anchor="middle" x="8687" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 24 Gate</text>
<text text-anchor="middle" x="8687" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8687" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8687" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_24_ln&#45;&gt;expert_24_gate -->
<g id="edge261" class="edge">
<title>expert_24_ln&#45;&gt;expert_24_gate</title>
<path fill="none" stroke="black" d="M8687,-781.94C8687,-781.94 8687,-756.39 8687,-756.39"/>
<polygon fill="black" stroke="black" points="8690.5,-756.39 8687,-746.39 8683.5,-756.39 8690.5,-756.39"/>
</g>
<!-- expert_24_expert -->
<g id="node188" class="node">
<title>expert_24_expert</title>
<polygon fill="lightblue" stroke="black" points="8942,-746.23 8784,-746.23 8784,-702.23 8942,-702.23 8942,-746.23"/>
<text text-anchor="middle" x="8863" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 24 Expert</text>
<text text-anchor="middle" x="8863" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8863" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="8863" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_24_ln&#45;&gt;expert_24_expert -->
<g id="edge263" class="edge">
<title>expert_24_ln&#45;&gt;expert_24_expert</title>
<path fill="none" stroke="black" d="M8764.2,-804C8811.49,-804 8863,-804 8863,-804 8863,-804 8863,-756.45 8863,-756.45"/>
<polygon fill="black" stroke="black" points="8866.5,-756.45 8863,-746.45 8859.5,-756.45 8866.5,-756.45"/>
</g>
<!-- expert_24_gate_act -->
<g id="node187" class="node">
<title>expert_24_gate_act</title>
<polygon fill="lightblue" stroke="black" points="8766,-666.23 8608,-666.23 8608,-622.23 8766,-622.23 8766,-666.23"/>
<text text-anchor="middle" x="8687" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 24 SiLU</text>
<text text-anchor="middle" x="8687" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8687" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8687" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_24_gate&#45;&gt;expert_24_gate_act -->
<g id="edge262" class="edge">
<title>expert_24_gate&#45;&gt;expert_24_gate_act</title>
<path fill="none" stroke="black" d="M8687,-701.94C8687,-701.94 8687,-676.39 8687,-676.39"/>
<polygon fill="black" stroke="black" points="8690.5,-676.39 8687,-666.39 8683.5,-676.39 8690.5,-676.39"/>
</g>
<!-- expert_24_multiply -->
<g id="node190" class="node">
<title>expert_24_multiply</title>
<polygon fill="lightblue" stroke="black" points="8869.5,-586.23 8608.5,-586.23 8608.5,-542.23 8869.5,-542.23 8869.5,-586.23"/>
<text text-anchor="middle" x="8739" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 24 Multiply</text>
<text text-anchor="middle" x="8739" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8739" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8739" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_24_gate_act&#45;&gt;expert_24_multiply -->
<g id="edge265" class="edge">
<title>expert_24_gate_act&#45;&gt;expert_24_multiply</title>
<path fill="none" stroke="black" d="M8687.25,-621.94C8687.25,-621.94 8687.25,-596.39 8687.25,-596.39"/>
<polygon fill="black" stroke="black" points="8690.75,-596.39 8687.25,-586.39 8683.75,-596.39 8690.75,-596.39"/>
</g>
<!-- expert_24_expert_act -->
<g id="node189" class="node">
<title>expert_24_expert_act</title>
<polygon fill="lightblue" stroke="black" points="8942,-666.23 8784,-666.23 8784,-622.23 8942,-622.23 8942,-666.23"/>
<text text-anchor="middle" x="8863" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 24 Expert Act</text>
<text text-anchor="middle" x="8863" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8863" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8863" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_24_expert&#45;&gt;expert_24_expert_act -->
<g id="edge264" class="edge">
<title>expert_24_expert&#45;&gt;expert_24_expert_act</title>
<path fill="none" stroke="black" d="M8863,-701.94C8863,-701.94 8863,-676.39 8863,-676.39"/>
<polygon fill="black" stroke="black" points="8866.5,-676.39 8863,-666.39 8859.5,-676.39 8866.5,-676.39"/>
</g>
<!-- expert_24_expert_act&#45;&gt;expert_24_multiply -->
<g id="edge266" class="edge">
<title>expert_24_expert_act&#45;&gt;expert_24_multiply</title>
<path fill="none" stroke="black" d="M8826.75,-621.94C8826.75,-621.94 8826.75,-596.39 8826.75,-596.39"/>
<polygon fill="black" stroke="black" points="8830.25,-596.39 8826.75,-586.39 8823.25,-596.39 8830.25,-596.39"/>
</g>
<!-- expert_24_out_proj -->
<g id="node191" class="node">
<title>expert_24_out_proj</title>
<polygon fill="lightblue" stroke="black" points="8789,-506.23 8635,-506.23 8635,-462.23 8789,-462.23 8789,-506.23"/>
<text text-anchor="middle" x="8712" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 24 Output Proj</text>
<text text-anchor="middle" x="8712" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="8712" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="8712" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_24_multiply&#45;&gt;expert_24_out_proj -->
<g id="edge267" class="edge">
<title>expert_24_multiply&#45;&gt;expert_24_out_proj</title>
<path fill="none" stroke="black" d="M8712,-541.94C8712,-541.94 8712,-516.39 8712,-516.39"/>
<polygon fill="black" stroke="black" points="8715.5,-516.39 8712,-506.39 8708.5,-516.39 8715.5,-516.39"/>
</g>
<!-- expert_24_out_proj&#45;&gt;gather_comm -->
<g id="edge268" class="edge">
<title>expert_24_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M8699.51,-461.83C8699.51,-436.58 8699.51,-399 8699.51,-399 8699.51,-399 6048.98,-399 6048.98,-399"/>
<polygon fill="black" stroke="black" points="6048.98,-395.5 6038.98,-399 6048.98,-402.5 6048.98,-395.5"/>
</g>
<!-- expert_25_gate -->
<g id="node193" class="node">
<title>expert_25_gate</title>
<polygon fill="lightblue" stroke="black" points="9124,-746.23 8966,-746.23 8966,-702.23 9124,-702.23 9124,-746.23"/>
<text text-anchor="middle" x="9045" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 25 Gate</text>
<text text-anchor="middle" x="9045" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9045" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9045" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_25_ln&#45;&gt;expert_25_gate -->
<g id="edge271" class="edge">
<title>expert_25_ln&#45;&gt;expert_25_gate</title>
<path fill="none" stroke="black" d="M9045,-781.94C9045,-781.94 9045,-756.39 9045,-756.39"/>
<polygon fill="black" stroke="black" points="9048.5,-756.39 9045,-746.39 9041.5,-756.39 9048.5,-756.39"/>
</g>
<!-- expert_25_expert -->
<g id="node195" class="node">
<title>expert_25_expert</title>
<polygon fill="lightblue" stroke="black" points="9300,-746.23 9142,-746.23 9142,-702.23 9300,-702.23 9300,-746.23"/>
<text text-anchor="middle" x="9221" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 25 Expert</text>
<text text-anchor="middle" x="9221" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9221" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9221" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_25_ln&#45;&gt;expert_25_expert -->
<g id="edge273" class="edge">
<title>expert_25_ln&#45;&gt;expert_25_expert</title>
<path fill="none" stroke="black" d="M9122.2,-804C9169.49,-804 9221,-804 9221,-804 9221,-804 9221,-756.45 9221,-756.45"/>
<polygon fill="black" stroke="black" points="9224.5,-756.45 9221,-746.45 9217.5,-756.45 9224.5,-756.45"/>
</g>
<!-- expert_25_gate_act -->
<g id="node194" class="node">
<title>expert_25_gate_act</title>
<polygon fill="lightblue" stroke="black" points="9124,-666.23 8966,-666.23 8966,-622.23 9124,-622.23 9124,-666.23"/>
<text text-anchor="middle" x="9045" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 25 SiLU</text>
<text text-anchor="middle" x="9045" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9045" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9045" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_25_gate&#45;&gt;expert_25_gate_act -->
<g id="edge272" class="edge">
<title>expert_25_gate&#45;&gt;expert_25_gate_act</title>
<path fill="none" stroke="black" d="M9045,-701.94C9045,-701.94 9045,-676.39 9045,-676.39"/>
<polygon fill="black" stroke="black" points="9048.5,-676.39 9045,-666.39 9041.5,-676.39 9048.5,-676.39"/>
</g>
<!-- expert_25_multiply -->
<g id="node197" class="node">
<title>expert_25_multiply</title>
<polygon fill="lightblue" stroke="black" points="9227.5,-586.23 8966.5,-586.23 8966.5,-542.23 9227.5,-542.23 9227.5,-586.23"/>
<text text-anchor="middle" x="9097" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 25 Multiply</text>
<text text-anchor="middle" x="9097" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9097" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9097" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_25_gate_act&#45;&gt;expert_25_multiply -->
<g id="edge275" class="edge">
<title>expert_25_gate_act&#45;&gt;expert_25_multiply</title>
<path fill="none" stroke="black" d="M9045.25,-621.94C9045.25,-621.94 9045.25,-596.39 9045.25,-596.39"/>
<polygon fill="black" stroke="black" points="9048.75,-596.39 9045.25,-586.39 9041.75,-596.39 9048.75,-596.39"/>
</g>
<!-- expert_25_expert_act -->
<g id="node196" class="node">
<title>expert_25_expert_act</title>
<polygon fill="lightblue" stroke="black" points="9300,-666.23 9142,-666.23 9142,-622.23 9300,-622.23 9300,-666.23"/>
<text text-anchor="middle" x="9221" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 25 Expert Act</text>
<text text-anchor="middle" x="9221" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9221" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9221" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_25_expert&#45;&gt;expert_25_expert_act -->
<g id="edge274" class="edge">
<title>expert_25_expert&#45;&gt;expert_25_expert_act</title>
<path fill="none" stroke="black" d="M9221,-701.94C9221,-701.94 9221,-676.39 9221,-676.39"/>
<polygon fill="black" stroke="black" points="9224.5,-676.39 9221,-666.39 9217.5,-676.39 9224.5,-676.39"/>
</g>
<!-- expert_25_expert_act&#45;&gt;expert_25_multiply -->
<g id="edge276" class="edge">
<title>expert_25_expert_act&#45;&gt;expert_25_multiply</title>
<path fill="none" stroke="black" d="M9184.75,-621.94C9184.75,-621.94 9184.75,-596.39 9184.75,-596.39"/>
<polygon fill="black" stroke="black" points="9188.25,-596.39 9184.75,-586.39 9181.25,-596.39 9188.25,-596.39"/>
</g>
<!-- expert_25_out_proj -->
<g id="node198" class="node">
<title>expert_25_out_proj</title>
<polygon fill="lightblue" stroke="black" points="9147,-506.23 8993,-506.23 8993,-462.23 9147,-462.23 9147,-506.23"/>
<text text-anchor="middle" x="9070" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 25 Output Proj</text>
<text text-anchor="middle" x="9070" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="9070" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9070" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_25_multiply&#45;&gt;expert_25_out_proj -->
<g id="edge277" class="edge">
<title>expert_25_multiply&#45;&gt;expert_25_out_proj</title>
<path fill="none" stroke="black" d="M9070,-541.94C9070,-541.94 9070,-516.39 9070,-516.39"/>
<polygon fill="black" stroke="black" points="9073.5,-516.39 9070,-506.39 9066.5,-516.39 9073.5,-516.39"/>
</g>
<!-- expert_25_out_proj&#45;&gt;gather_comm -->
<g id="edge278" class="edge">
<title>expert_25_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M9070,-462.17C9070,-435.75 9070,-395 9070,-395 9070,-395 6049.74,-395 6049.74,-395"/>
<polygon fill="black" stroke="black" points="6049.74,-391.5 6039.74,-395 6049.74,-398.5 6049.74,-391.5"/>
</g>
<!-- expert_26_gate -->
<g id="node200" class="node">
<title>expert_26_gate</title>
<polygon fill="lightblue" stroke="black" points="9482,-746.23 9324,-746.23 9324,-702.23 9482,-702.23 9482,-746.23"/>
<text text-anchor="middle" x="9403" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 26 Gate</text>
<text text-anchor="middle" x="9403" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9403" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9403" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_26_ln&#45;&gt;expert_26_gate -->
<g id="edge281" class="edge">
<title>expert_26_ln&#45;&gt;expert_26_gate</title>
<path fill="none" stroke="black" d="M9403,-781.94C9403,-781.94 9403,-756.39 9403,-756.39"/>
<polygon fill="black" stroke="black" points="9406.5,-756.39 9403,-746.39 9399.5,-756.39 9406.5,-756.39"/>
</g>
<!-- expert_26_expert -->
<g id="node202" class="node">
<title>expert_26_expert</title>
<polygon fill="lightblue" stroke="black" points="9658,-746.23 9500,-746.23 9500,-702.23 9658,-702.23 9658,-746.23"/>
<text text-anchor="middle" x="9579" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 26 Expert</text>
<text text-anchor="middle" x="9579" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9579" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9579" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_26_ln&#45;&gt;expert_26_expert -->
<g id="edge283" class="edge">
<title>expert_26_ln&#45;&gt;expert_26_expert</title>
<path fill="none" stroke="black" d="M9480.2,-804C9527.49,-804 9579,-804 9579,-804 9579,-804 9579,-756.45 9579,-756.45"/>
<polygon fill="black" stroke="black" points="9582.5,-756.45 9579,-746.45 9575.5,-756.45 9582.5,-756.45"/>
</g>
<!-- expert_26_gate_act -->
<g id="node201" class="node">
<title>expert_26_gate_act</title>
<polygon fill="lightblue" stroke="black" points="9482,-666.23 9324,-666.23 9324,-622.23 9482,-622.23 9482,-666.23"/>
<text text-anchor="middle" x="9403" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 26 SiLU</text>
<text text-anchor="middle" x="9403" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9403" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9403" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_26_gate&#45;&gt;expert_26_gate_act -->
<g id="edge282" class="edge">
<title>expert_26_gate&#45;&gt;expert_26_gate_act</title>
<path fill="none" stroke="black" d="M9403,-701.94C9403,-701.94 9403,-676.39 9403,-676.39"/>
<polygon fill="black" stroke="black" points="9406.5,-676.39 9403,-666.39 9399.5,-676.39 9406.5,-676.39"/>
</g>
<!-- expert_26_multiply -->
<g id="node204" class="node">
<title>expert_26_multiply</title>
<polygon fill="lightblue" stroke="black" points="9585.5,-586.23 9324.5,-586.23 9324.5,-542.23 9585.5,-542.23 9585.5,-586.23"/>
<text text-anchor="middle" x="9455" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 26 Multiply</text>
<text text-anchor="middle" x="9455" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9455" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9455" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_26_gate_act&#45;&gt;expert_26_multiply -->
<g id="edge285" class="edge">
<title>expert_26_gate_act&#45;&gt;expert_26_multiply</title>
<path fill="none" stroke="black" d="M9403.25,-621.94C9403.25,-621.94 9403.25,-596.39 9403.25,-596.39"/>
<polygon fill="black" stroke="black" points="9406.75,-596.39 9403.25,-586.39 9399.75,-596.39 9406.75,-596.39"/>
</g>
<!-- expert_26_expert_act -->
<g id="node203" class="node">
<title>expert_26_expert_act</title>
<polygon fill="lightblue" stroke="black" points="9658,-666.23 9500,-666.23 9500,-622.23 9658,-622.23 9658,-666.23"/>
<text text-anchor="middle" x="9579" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 26 Expert Act</text>
<text text-anchor="middle" x="9579" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9579" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9579" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_26_expert&#45;&gt;expert_26_expert_act -->
<g id="edge284" class="edge">
<title>expert_26_expert&#45;&gt;expert_26_expert_act</title>
<path fill="none" stroke="black" d="M9579,-701.94C9579,-701.94 9579,-676.39 9579,-676.39"/>
<polygon fill="black" stroke="black" points="9582.5,-676.39 9579,-666.39 9575.5,-676.39 9582.5,-676.39"/>
</g>
<!-- expert_26_expert_act&#45;&gt;expert_26_multiply -->
<g id="edge286" class="edge">
<title>expert_26_expert_act&#45;&gt;expert_26_multiply</title>
<path fill="none" stroke="black" d="M9542.75,-621.94C9542.75,-621.94 9542.75,-596.39 9542.75,-596.39"/>
<polygon fill="black" stroke="black" points="9546.25,-596.39 9542.75,-586.39 9539.25,-596.39 9546.25,-596.39"/>
</g>
<!-- expert_26_out_proj -->
<g id="node205" class="node">
<title>expert_26_out_proj</title>
<polygon fill="lightblue" stroke="black" points="9505,-506.23 9351,-506.23 9351,-462.23 9505,-462.23 9505,-506.23"/>
<text text-anchor="middle" x="9428" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 26 Output Proj</text>
<text text-anchor="middle" x="9428" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="9428" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9428" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_26_multiply&#45;&gt;expert_26_out_proj -->
<g id="edge287" class="edge">
<title>expert_26_multiply&#45;&gt;expert_26_out_proj</title>
<path fill="none" stroke="black" d="M9428,-541.94C9428,-541.94 9428,-516.39 9428,-516.39"/>
<polygon fill="black" stroke="black" points="9431.5,-516.39 9428,-506.39 9424.5,-516.39 9431.5,-516.39"/>
</g>
<!-- expert_26_out_proj&#45;&gt;gather_comm -->
<g id="edge288" class="edge">
<title>expert_26_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M9428,-462.13C9428,-434.56 9428,-391 9428,-391 9428,-391 6048.77,-391 6048.77,-391"/>
<polygon fill="black" stroke="black" points="6048.77,-387.5 6038.77,-391 6048.77,-394.5 6048.77,-387.5"/>
</g>
<!-- expert_27_gate -->
<g id="node207" class="node">
<title>expert_27_gate</title>
<polygon fill="lightblue" stroke="black" points="9840,-746.23 9682,-746.23 9682,-702.23 9840,-702.23 9840,-746.23"/>
<text text-anchor="middle" x="9761" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 27 Gate</text>
<text text-anchor="middle" x="9761" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9761" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9761" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_27_ln&#45;&gt;expert_27_gate -->
<g id="edge291" class="edge">
<title>expert_27_ln&#45;&gt;expert_27_gate</title>
<path fill="none" stroke="black" d="M9761,-781.94C9761,-781.94 9761,-756.39 9761,-756.39"/>
<polygon fill="black" stroke="black" points="9764.5,-756.39 9761,-746.39 9757.5,-756.39 9764.5,-756.39"/>
</g>
<!-- expert_27_expert -->
<g id="node209" class="node">
<title>expert_27_expert</title>
<polygon fill="lightblue" stroke="black" points="10016,-746.23 9858,-746.23 9858,-702.23 10016,-702.23 10016,-746.23"/>
<text text-anchor="middle" x="9937" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 27 Expert</text>
<text text-anchor="middle" x="9937" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9937" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="9937" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_27_ln&#45;&gt;expert_27_expert -->
<g id="edge293" class="edge">
<title>expert_27_ln&#45;&gt;expert_27_expert</title>
<path fill="none" stroke="black" d="M9838.2,-804C9885.49,-804 9937,-804 9937,-804 9937,-804 9937,-756.45 9937,-756.45"/>
<polygon fill="black" stroke="black" points="9940.5,-756.45 9937,-746.45 9933.5,-756.45 9940.5,-756.45"/>
</g>
<!-- expert_27_gate_act -->
<g id="node208" class="node">
<title>expert_27_gate_act</title>
<polygon fill="lightblue" stroke="black" points="9840,-666.23 9682,-666.23 9682,-622.23 9840,-622.23 9840,-666.23"/>
<text text-anchor="middle" x="9761" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 27 SiLU</text>
<text text-anchor="middle" x="9761" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9761" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9761" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_27_gate&#45;&gt;expert_27_gate_act -->
<g id="edge292" class="edge">
<title>expert_27_gate&#45;&gt;expert_27_gate_act</title>
<path fill="none" stroke="black" d="M9761,-701.94C9761,-701.94 9761,-676.39 9761,-676.39"/>
<polygon fill="black" stroke="black" points="9764.5,-676.39 9761,-666.39 9757.5,-676.39 9764.5,-676.39"/>
</g>
<!-- expert_27_multiply -->
<g id="node211" class="node">
<title>expert_27_multiply</title>
<polygon fill="lightblue" stroke="black" points="9943.5,-586.23 9682.5,-586.23 9682.5,-542.23 9943.5,-542.23 9943.5,-586.23"/>
<text text-anchor="middle" x="9813" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 27 Multiply</text>
<text text-anchor="middle" x="9813" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9813" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9813" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_27_gate_act&#45;&gt;expert_27_multiply -->
<g id="edge295" class="edge">
<title>expert_27_gate_act&#45;&gt;expert_27_multiply</title>
<path fill="none" stroke="black" d="M9761.25,-621.94C9761.25,-621.94 9761.25,-596.39 9761.25,-596.39"/>
<polygon fill="black" stroke="black" points="9764.75,-596.39 9761.25,-586.39 9757.75,-596.39 9764.75,-596.39"/>
</g>
<!-- expert_27_expert_act -->
<g id="node210" class="node">
<title>expert_27_expert_act</title>
<polygon fill="lightblue" stroke="black" points="10016,-666.23 9858,-666.23 9858,-622.23 10016,-622.23 10016,-666.23"/>
<text text-anchor="middle" x="9937" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 27 Expert Act</text>
<text text-anchor="middle" x="9937" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9937" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9937" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_27_expert&#45;&gt;expert_27_expert_act -->
<g id="edge294" class="edge">
<title>expert_27_expert&#45;&gt;expert_27_expert_act</title>
<path fill="none" stroke="black" d="M9937,-701.94C9937,-701.94 9937,-676.39 9937,-676.39"/>
<polygon fill="black" stroke="black" points="9940.5,-676.39 9937,-666.39 9933.5,-676.39 9940.5,-676.39"/>
</g>
<!-- expert_27_expert_act&#45;&gt;expert_27_multiply -->
<g id="edge296" class="edge">
<title>expert_27_expert_act&#45;&gt;expert_27_multiply</title>
<path fill="none" stroke="black" d="M9900.75,-621.94C9900.75,-621.94 9900.75,-596.39 9900.75,-596.39"/>
<polygon fill="black" stroke="black" points="9904.25,-596.39 9900.75,-586.39 9897.25,-596.39 9904.25,-596.39"/>
</g>
<!-- expert_27_out_proj -->
<g id="node212" class="node">
<title>expert_27_out_proj</title>
<polygon fill="lightblue" stroke="black" points="9863,-506.23 9709,-506.23 9709,-462.23 9863,-462.23 9863,-506.23"/>
<text text-anchor="middle" x="9786" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 27 Output Proj</text>
<text text-anchor="middle" x="9786" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="9786" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="9786" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_27_multiply&#45;&gt;expert_27_out_proj -->
<g id="edge297" class="edge">
<title>expert_27_multiply&#45;&gt;expert_27_out_proj</title>
<path fill="none" stroke="black" d="M9786,-541.94C9786,-541.94 9786,-516.39 9786,-516.39"/>
<polygon fill="black" stroke="black" points="9789.5,-516.39 9786,-506.39 9782.5,-516.39 9789.5,-516.39"/>
</g>
<!-- expert_27_out_proj&#45;&gt;gather_comm -->
<g id="edge298" class="edge">
<title>expert_27_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M9786,-462.16C9786,-433.48 9786,-387 9786,-387 9786,-387 6045.27,-387 6045.27,-387"/>
<polygon fill="black" stroke="black" points="6045.27,-383.5 6035.27,-387 6045.27,-390.5 6045.27,-383.5"/>
</g>
<!-- expert_28_gate -->
<g id="node214" class="node">
<title>expert_28_gate</title>
<polygon fill="lightblue" stroke="black" points="10198,-746.23 10040,-746.23 10040,-702.23 10198,-702.23 10198,-746.23"/>
<text text-anchor="middle" x="10119" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 28 Gate</text>
<text text-anchor="middle" x="10119" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10119" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10119" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_28_ln&#45;&gt;expert_28_gate -->
<g id="edge301" class="edge">
<title>expert_28_ln&#45;&gt;expert_28_gate</title>
<path fill="none" stroke="black" d="M10119,-781.94C10119,-781.94 10119,-756.39 10119,-756.39"/>
<polygon fill="black" stroke="black" points="10122.5,-756.39 10119,-746.39 10115.5,-756.39 10122.5,-756.39"/>
</g>
<!-- expert_28_expert -->
<g id="node216" class="node">
<title>expert_28_expert</title>
<polygon fill="lightblue" stroke="black" points="10374,-746.23 10216,-746.23 10216,-702.23 10374,-702.23 10374,-746.23"/>
<text text-anchor="middle" x="10295" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 28 Expert</text>
<text text-anchor="middle" x="10295" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10295" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10295" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_28_ln&#45;&gt;expert_28_expert -->
<g id="edge303" class="edge">
<title>expert_28_ln&#45;&gt;expert_28_expert</title>
<path fill="none" stroke="black" d="M10196.2,-804C10243.49,-804 10295,-804 10295,-804 10295,-804 10295,-756.45 10295,-756.45"/>
<polygon fill="black" stroke="black" points="10298.5,-756.45 10295,-746.45 10291.5,-756.45 10298.5,-756.45"/>
</g>
<!-- expert_28_gate_act -->
<g id="node215" class="node">
<title>expert_28_gate_act</title>
<polygon fill="lightblue" stroke="black" points="10198,-666.23 10040,-666.23 10040,-622.23 10198,-622.23 10198,-666.23"/>
<text text-anchor="middle" x="10119" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 28 SiLU</text>
<text text-anchor="middle" x="10119" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10119" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10119" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_28_gate&#45;&gt;expert_28_gate_act -->
<g id="edge302" class="edge">
<title>expert_28_gate&#45;&gt;expert_28_gate_act</title>
<path fill="none" stroke="black" d="M10119,-701.94C10119,-701.94 10119,-676.39 10119,-676.39"/>
<polygon fill="black" stroke="black" points="10122.5,-676.39 10119,-666.39 10115.5,-676.39 10122.5,-676.39"/>
</g>
<!-- expert_28_multiply -->
<g id="node218" class="node">
<title>expert_28_multiply</title>
<polygon fill="lightblue" stroke="black" points="10301.5,-586.23 10040.5,-586.23 10040.5,-542.23 10301.5,-542.23 10301.5,-586.23"/>
<text text-anchor="middle" x="10171" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 28 Multiply</text>
<text text-anchor="middle" x="10171" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10171" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10171" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_28_gate_act&#45;&gt;expert_28_multiply -->
<g id="edge305" class="edge">
<title>expert_28_gate_act&#45;&gt;expert_28_multiply</title>
<path fill="none" stroke="black" d="M10119.25,-621.94C10119.25,-621.94 10119.25,-596.39 10119.25,-596.39"/>
<polygon fill="black" stroke="black" points="10122.75,-596.39 10119.25,-586.39 10115.75,-596.39 10122.75,-596.39"/>
</g>
<!-- expert_28_expert_act -->
<g id="node217" class="node">
<title>expert_28_expert_act</title>
<polygon fill="lightblue" stroke="black" points="10374,-666.23 10216,-666.23 10216,-622.23 10374,-622.23 10374,-666.23"/>
<text text-anchor="middle" x="10295" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 28 Expert Act</text>
<text text-anchor="middle" x="10295" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10295" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10295" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_28_expert&#45;&gt;expert_28_expert_act -->
<g id="edge304" class="edge">
<title>expert_28_expert&#45;&gt;expert_28_expert_act</title>
<path fill="none" stroke="black" d="M10295,-701.94C10295,-701.94 10295,-676.39 10295,-676.39"/>
<polygon fill="black" stroke="black" points="10298.5,-676.39 10295,-666.39 10291.5,-676.39 10298.5,-676.39"/>
</g>
<!-- expert_28_expert_act&#45;&gt;expert_28_multiply -->
<g id="edge306" class="edge">
<title>expert_28_expert_act&#45;&gt;expert_28_multiply</title>
<path fill="none" stroke="black" d="M10258.75,-621.94C10258.75,-621.94 10258.75,-596.39 10258.75,-596.39"/>
<polygon fill="black" stroke="black" points="10262.25,-596.39 10258.75,-586.39 10255.25,-596.39 10262.25,-596.39"/>
</g>
<!-- expert_28_out_proj -->
<g id="node219" class="node">
<title>expert_28_out_proj</title>
<polygon fill="lightblue" stroke="black" points="10221,-506.23 10067,-506.23 10067,-462.23 10221,-462.23 10221,-506.23"/>
<text text-anchor="middle" x="10144" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 28 Output Proj</text>
<text text-anchor="middle" x="10144" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="10144" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10144" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_28_multiply&#45;&gt;expert_28_out_proj -->
<g id="edge307" class="edge">
<title>expert_28_multiply&#45;&gt;expert_28_out_proj</title>
<path fill="none" stroke="black" d="M10144,-541.94C10144,-541.94 10144,-516.39 10144,-516.39"/>
<polygon fill="black" stroke="black" points="10147.5,-516.39 10144,-506.39 10140.5,-516.39 10147.5,-516.39"/>
</g>
<!-- expert_28_out_proj&#45;&gt;gather_comm -->
<g id="edge308" class="edge">
<title>expert_28_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M10119,-462.01C10119,-432.21 10119,-383 10119,-383 10119,-383 6039.6,-383 6039.6,-383"/>
<polygon fill="black" stroke="black" points="6039.6,-379.5 6029.6,-383 6039.6,-386.5 6039.6,-379.5"/>
</g>
<!-- expert_29_gate -->
<g id="node221" class="node">
<title>expert_29_gate</title>
<polygon fill="lightblue" stroke="black" points="10556,-746.23 10398,-746.23 10398,-702.23 10556,-702.23 10556,-746.23"/>
<text text-anchor="middle" x="10477" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 29 Gate</text>
<text text-anchor="middle" x="10477" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10477" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10477" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_29_ln&#45;&gt;expert_29_gate -->
<g id="edge311" class="edge">
<title>expert_29_ln&#45;&gt;expert_29_gate</title>
<path fill="none" stroke="black" d="M10477,-781.94C10477,-781.94 10477,-756.39 10477,-756.39"/>
<polygon fill="black" stroke="black" points="10480.5,-756.39 10477,-746.39 10473.5,-756.39 10480.5,-756.39"/>
</g>
<!-- expert_29_expert -->
<g id="node223" class="node">
<title>expert_29_expert</title>
<polygon fill="lightblue" stroke="black" points="10732,-746.23 10574,-746.23 10574,-702.23 10732,-702.23 10732,-746.23"/>
<text text-anchor="middle" x="10653" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 29 Expert</text>
<text text-anchor="middle" x="10653" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10653" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10653" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_29_ln&#45;&gt;expert_29_expert -->
<g id="edge313" class="edge">
<title>expert_29_ln&#45;&gt;expert_29_expert</title>
<path fill="none" stroke="black" d="M10554.2,-804C10601.49,-804 10653,-804 10653,-804 10653,-804 10653,-756.45 10653,-756.45"/>
<polygon fill="black" stroke="black" points="10656.5,-756.45 10653,-746.45 10649.5,-756.45 10656.5,-756.45"/>
</g>
<!-- expert_29_gate_act -->
<g id="node222" class="node">
<title>expert_29_gate_act</title>
<polygon fill="lightblue" stroke="black" points="10556,-666.23 10398,-666.23 10398,-622.23 10556,-622.23 10556,-666.23"/>
<text text-anchor="middle" x="10477" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 29 SiLU</text>
<text text-anchor="middle" x="10477" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10477" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10477" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_29_gate&#45;&gt;expert_29_gate_act -->
<g id="edge312" class="edge">
<title>expert_29_gate&#45;&gt;expert_29_gate_act</title>
<path fill="none" stroke="black" d="M10477,-701.94C10477,-701.94 10477,-676.39 10477,-676.39"/>
<polygon fill="black" stroke="black" points="10480.5,-676.39 10477,-666.39 10473.5,-676.39 10480.5,-676.39"/>
</g>
<!-- expert_29_multiply -->
<g id="node225" class="node">
<title>expert_29_multiply</title>
<polygon fill="lightblue" stroke="black" points="10659.5,-586.23 10398.5,-586.23 10398.5,-542.23 10659.5,-542.23 10659.5,-586.23"/>
<text text-anchor="middle" x="10529" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 29 Multiply</text>
<text text-anchor="middle" x="10529" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10529" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10529" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_29_gate_act&#45;&gt;expert_29_multiply -->
<g id="edge315" class="edge">
<title>expert_29_gate_act&#45;&gt;expert_29_multiply</title>
<path fill="none" stroke="black" d="M10477.25,-621.94C10477.25,-621.94 10477.25,-596.39 10477.25,-596.39"/>
<polygon fill="black" stroke="black" points="10480.75,-596.39 10477.25,-586.39 10473.75,-596.39 10480.75,-596.39"/>
</g>
<!-- expert_29_expert_act -->
<g id="node224" class="node">
<title>expert_29_expert_act</title>
<polygon fill="lightblue" stroke="black" points="10732,-666.23 10574,-666.23 10574,-622.23 10732,-622.23 10732,-666.23"/>
<text text-anchor="middle" x="10653" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 29 Expert Act</text>
<text text-anchor="middle" x="10653" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10653" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10653" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_29_expert&#45;&gt;expert_29_expert_act -->
<g id="edge314" class="edge">
<title>expert_29_expert&#45;&gt;expert_29_expert_act</title>
<path fill="none" stroke="black" d="M10653,-701.94C10653,-701.94 10653,-676.39 10653,-676.39"/>
<polygon fill="black" stroke="black" points="10656.5,-676.39 10653,-666.39 10649.5,-676.39 10656.5,-676.39"/>
</g>
<!-- expert_29_expert_act&#45;&gt;expert_29_multiply -->
<g id="edge316" class="edge">
<title>expert_29_expert_act&#45;&gt;expert_29_multiply</title>
<path fill="none" stroke="black" d="M10616.75,-621.94C10616.75,-621.94 10616.75,-596.39 10616.75,-596.39"/>
<polygon fill="black" stroke="black" points="10620.25,-596.39 10616.75,-586.39 10613.25,-596.39 10620.25,-596.39"/>
</g>
<!-- expert_29_out_proj -->
<g id="node226" class="node">
<title>expert_29_out_proj</title>
<polygon fill="lightblue" stroke="black" points="10579,-506.23 10425,-506.23 10425,-462.23 10579,-462.23 10579,-506.23"/>
<text text-anchor="middle" x="10502" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 29 Output Proj</text>
<text text-anchor="middle" x="10502" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="10502" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10502" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_29_multiply&#45;&gt;expert_29_out_proj -->
<g id="edge317" class="edge">
<title>expert_29_multiply&#45;&gt;expert_29_out_proj</title>
<path fill="none" stroke="black" d="M10502,-541.94C10502,-541.94 10502,-516.39 10502,-516.39"/>
<polygon fill="black" stroke="black" points="10505.5,-516.39 10502,-506.39 10498.5,-516.39 10505.5,-516.39"/>
</g>
<!-- expert_29_out_proj&#45;&gt;gather_comm -->
<g id="edge318" class="edge">
<title>expert_29_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M10502,-462.17C10502,-431.31 10502,-379 10502,-379 10502,-379 6031.36,-379 6031.36,-379"/>
<polygon fill="black" stroke="black" points="6031.36,-375.5 6021.36,-379 6031.36,-382.5 6031.36,-375.5"/>
</g>
<!-- expert_30_gate -->
<g id="node228" class="node">
<title>expert_30_gate</title>
<polygon fill="lightblue" stroke="black" points="10914,-746.23 10756,-746.23 10756,-702.23 10914,-702.23 10914,-746.23"/>
<text text-anchor="middle" x="10835" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 30 Gate</text>
<text text-anchor="middle" x="10835" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="10835" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="10835" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_30_ln&#45;&gt;expert_30_gate -->
<g id="edge321" class="edge">
<title>expert_30_ln&#45;&gt;expert_30_gate</title>
<path fill="none" stroke="black" d="M10835,-781.94C10835,-781.94 10835,-756.39 10835,-756.39"/>
<polygon fill="black" stroke="black" points="10838.5,-756.39 10835,-746.39 10831.5,-756.39 10838.5,-756.39"/>
</g>
<!-- expert_30_expert -->
<g id="node230" class="node">
<title>expert_30_expert</title>
<polygon fill="lightblue" stroke="black" points="11090,-746.23 10932,-746.23 10932,-702.23 11090,-702.23 11090,-746.23"/>
<text text-anchor="middle" x="11011" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 30 Expert</text>
<text text-anchor="middle" x="11011" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="11011" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="11011" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_30_ln&#45;&gt;expert_30_expert -->
<g id="edge323" class="edge">
<title>expert_30_ln&#45;&gt;expert_30_expert</title>
<path fill="none" stroke="black" d="M10912.2,-804C10959.49,-804 11011,-804 11011,-804 11011,-804 11011,-756.45 11011,-756.45"/>
<polygon fill="black" stroke="black" points="11014.5,-756.45 11011,-746.45 11007.5,-756.45 11014.5,-756.45"/>
</g>
<!-- expert_30_gate_act -->
<g id="node229" class="node">
<title>expert_30_gate_act</title>
<polygon fill="lightblue" stroke="black" points="10914,-666.23 10756,-666.23 10756,-622.23 10914,-622.23 10914,-666.23"/>
<text text-anchor="middle" x="10835" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 30 SiLU</text>
<text text-anchor="middle" x="10835" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="10835" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10835" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_30_gate&#45;&gt;expert_30_gate_act -->
<g id="edge322" class="edge">
<title>expert_30_gate&#45;&gt;expert_30_gate_act</title>
<path fill="none" stroke="black" d="M10835,-701.94C10835,-701.94 10835,-676.39 10835,-676.39"/>
<polygon fill="black" stroke="black" points="10838.5,-676.39 10835,-666.39 10831.5,-676.39 10838.5,-676.39"/>
</g>
<!-- expert_30_multiply -->
<g id="node232" class="node">
<title>expert_30_multiply</title>
<polygon fill="lightblue" stroke="black" points="11017.5,-586.23 10756.5,-586.23 10756.5,-542.23 11017.5,-542.23 11017.5,-586.23"/>
<text text-anchor="middle" x="10887" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 30 Multiply</text>
<text text-anchor="middle" x="10887" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="10887" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10887" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_30_gate_act&#45;&gt;expert_30_multiply -->
<g id="edge325" class="edge">
<title>expert_30_gate_act&#45;&gt;expert_30_multiply</title>
<path fill="none" stroke="black" d="M10835.25,-621.94C10835.25,-621.94 10835.25,-596.39 10835.25,-596.39"/>
<polygon fill="black" stroke="black" points="10838.75,-596.39 10835.25,-586.39 10831.75,-596.39 10838.75,-596.39"/>
</g>
<!-- expert_30_expert_act -->
<g id="node231" class="node">
<title>expert_30_expert_act</title>
<polygon fill="lightblue" stroke="black" points="11090,-666.23 10932,-666.23 10932,-622.23 11090,-622.23 11090,-666.23"/>
<text text-anchor="middle" x="11011" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 30 Expert Act</text>
<text text-anchor="middle" x="11011" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="11011" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="11011" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_30_expert&#45;&gt;expert_30_expert_act -->
<g id="edge324" class="edge">
<title>expert_30_expert&#45;&gt;expert_30_expert_act</title>
<path fill="none" stroke="black" d="M11011,-701.94C11011,-701.94 11011,-676.39 11011,-676.39"/>
<polygon fill="black" stroke="black" points="11014.5,-676.39 11011,-666.39 11007.5,-676.39 11014.5,-676.39"/>
</g>
<!-- expert_30_expert_act&#45;&gt;expert_30_multiply -->
<g id="edge326" class="edge">
<title>expert_30_expert_act&#45;&gt;expert_30_multiply</title>
<path fill="none" stroke="black" d="M10974.75,-621.94C10974.75,-621.94 10974.75,-596.39 10974.75,-596.39"/>
<polygon fill="black" stroke="black" points="10978.25,-596.39 10974.75,-586.39 10971.25,-596.39 10978.25,-596.39"/>
</g>
<!-- expert_30_out_proj -->
<g id="node233" class="node">
<title>expert_30_out_proj</title>
<polygon fill="lightblue" stroke="black" points="10937,-506.23 10783,-506.23 10783,-462.23 10937,-462.23 10937,-506.23"/>
<text text-anchor="middle" x="10860" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 30 Output Proj</text>
<text text-anchor="middle" x="10860" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="10860" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="10860" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_30_multiply&#45;&gt;expert_30_out_proj -->
<g id="edge327" class="edge">
<title>expert_30_multiply&#45;&gt;expert_30_out_proj</title>
<path fill="none" stroke="black" d="M10860,-541.94C10860,-541.94 10860,-516.39 10860,-516.39"/>
<polygon fill="black" stroke="black" points="10863.5,-516.39 10860,-506.39 10856.5,-516.39 10863.5,-516.39"/>
</g>
<!-- expert_30_out_proj&#45;&gt;gather_comm -->
<g id="edge328" class="edge">
<title>expert_30_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M10860,-462.12C10860,-430.21 10860,-375 10860,-375 10860,-375 6019.3,-375 6019.3,-375"/>
<polygon fill="black" stroke="black" points="6019.3,-371.5 6009.3,-375 6019.3,-378.5 6019.3,-371.5"/>
</g>
<!-- expert_31_gate -->
<g id="node235" class="node">
<title>expert_31_gate</title>
<polygon fill="lightblue" stroke="black" points="11272,-746.23 11114,-746.23 11114,-702.23 11272,-702.23 11272,-746.23"/>
<text text-anchor="middle" x="11193" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 31 Gate</text>
<text text-anchor="middle" x="11193" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11193" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="11193" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_31_ln&#45;&gt;expert_31_gate -->
<g id="edge331" class="edge">
<title>expert_31_ln&#45;&gt;expert_31_gate</title>
<path fill="none" stroke="black" d="M11193,-781.94C11193,-781.94 11193,-756.39 11193,-756.39"/>
<polygon fill="black" stroke="black" points="11196.5,-756.39 11193,-746.39 11189.5,-756.39 11196.5,-756.39"/>
</g>
<!-- expert_31_expert -->
<g id="node237" class="node">
<title>expert_31_expert</title>
<polygon fill="lightblue" stroke="black" points="11448,-746.23 11290,-746.23 11290,-702.23 11448,-702.23 11448,-746.23"/>
<text text-anchor="middle" x="11369" y="-735.83" font-family="Times,serif" font-size="8.00">Expert 31 Expert</text>
<text text-anchor="middle" x="11369" y="-726.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11369" y="-717.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, H=7168]</text>
<text text-anchor="middle" x="11369" y="-708.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_31_ln&#45;&gt;expert_31_expert -->
<g id="edge333" class="edge">
<title>expert_31_ln&#45;&gt;expert_31_expert</title>
<path fill="none" stroke="black" d="M11270.2,-804C11317.49,-804 11369,-804 11369,-804 11369,-804 11369,-756.45 11369,-756.45"/>
<polygon fill="black" stroke="black" points="11372.5,-756.45 11369,-746.45 11365.5,-756.45 11372.5,-756.45"/>
</g>
<!-- expert_31_gate_act -->
<g id="node236" class="node">
<title>expert_31_gate_act</title>
<polygon fill="lightblue" stroke="black" points="11272,-666.23 11114,-666.23 11114,-622.23 11272,-622.23 11272,-666.23"/>
<text text-anchor="middle" x="11193" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 31 SiLU</text>
<text text-anchor="middle" x="11193" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11193" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="11193" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_31_gate&#45;&gt;expert_31_gate_act -->
<g id="edge332" class="edge">
<title>expert_31_gate&#45;&gt;expert_31_gate_act</title>
<path fill="none" stroke="black" d="M11193,-701.94C11193,-701.94 11193,-676.39 11193,-676.39"/>
<polygon fill="black" stroke="black" points="11196.5,-676.39 11193,-666.39 11189.5,-676.39 11196.5,-676.39"/>
</g>
<!-- expert_31_multiply -->
<g id="node239" class="node">
<title>expert_31_multiply</title>
<polygon fill="lightblue" stroke="black" points="11375.5,-586.23 11114.5,-586.23 11114.5,-542.23 11375.5,-542.23 11375.5,-586.23"/>
<text text-anchor="middle" x="11245" y="-575.83" font-family="Times,serif" font-size="8.00">Expert 31 Multiply</text>
<text text-anchor="middle" x="11245" y="-566.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11245" y="-557.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048] × [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="11245" y="-548.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_31_gate_act&#45;&gt;expert_31_multiply -->
<g id="edge335" class="edge">
<title>expert_31_gate_act&#45;&gt;expert_31_multiply</title>
<path fill="none" stroke="black" d="M11193.25,-621.94C11193.25,-621.94 11193.25,-596.39 11193.25,-596.39"/>
<polygon fill="black" stroke="black" points="11196.75,-596.39 11193.25,-586.39 11189.75,-596.39 11196.75,-596.39"/>
</g>
<!-- expert_31_expert_act -->
<g id="node238" class="node">
<title>expert_31_expert_act</title>
<polygon fill="lightblue" stroke="black" points="11448,-666.23 11290,-666.23 11290,-622.23 11448,-622.23 11448,-666.23"/>
<text text-anchor="middle" x="11369" y="-655.83" font-family="Times,serif" font-size="8.00">Expert 31 Expert Act</text>
<text text-anchor="middle" x="11369" y="-646.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11369" y="-637.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="11369" y="-628.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, He=2048]</text>
</g>
<!-- expert_31_expert&#45;&gt;expert_31_expert_act -->
<g id="edge334" class="edge">
<title>expert_31_expert&#45;&gt;expert_31_expert_act</title>
<path fill="none" stroke="black" d="M11369,-701.94C11369,-701.94 11369,-676.39 11369,-676.39"/>
<polygon fill="black" stroke="black" points="11372.5,-676.39 11369,-666.39 11365.5,-676.39 11372.5,-676.39"/>
</g>
<!-- expert_31_expert_act&#45;&gt;expert_31_multiply -->
<g id="edge336" class="edge">
<title>expert_31_expert_act&#45;&gt;expert_31_multiply</title>
<path fill="none" stroke="black" d="M11332.75,-621.94C11332.75,-621.94 11332.75,-596.39 11332.75,-596.39"/>
<polygon fill="black" stroke="black" points="11336.25,-596.39 11332.75,-586.39 11329.25,-596.39 11336.25,-596.39"/>
</g>
<!-- expert_31_out_proj -->
<g id="node240" class="node">
<title>expert_31_out_proj</title>
<polygon fill="lightblue" stroke="black" points="11295,-506.23 11141,-506.23 11141,-462.23 11295,-462.23 11295,-506.23"/>
<text text-anchor="middle" x="11218" y="-495.83" font-family="Times,serif" font-size="8.00">Expert 31 Output Proj</text>
<text text-anchor="middle" x="11218" y="-486.83" font-family="Times,serif" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="11218" y="-477.83" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens_gpu, He=2048]</text>
<text text-anchor="middle" x="11218" y="-468.83" font-family="Times,serif" font-size="8.00">OUTPUT: [Σtokens_gpu, H=7168]</text>
</g>
<!-- expert_31_multiply&#45;&gt;expert_31_out_proj -->
<g id="edge337" class="edge">
<title>expert_31_multiply&#45;&gt;expert_31_out_proj</title>
<path fill="none" stroke="black" d="M11218,-541.94C11218,-541.94 11218,-516.39 11218,-516.39"/>
<polygon fill="black" stroke="black" points="11221.5,-516.39 11218,-506.39 11214.5,-516.39 11221.5,-516.39"/>
</g>
<!-- expert_31_out_proj&#45;&gt;gather_comm -->
<g id="edge338" class="edge">
<title>expert_31_out_proj&#45;&gt;gather_comm</title>
<path fill="none" stroke="black" d="M11218,-462.13C11218,-429.17 11218,-371 11218,-371 11218,-371 6002.5,-371 6002.5,-371"/>
<polygon fill="black" stroke="black" points="6002.5,-367.5 5992.5,-371 6002.5,-374.5 6002.5,-367.5"/>
</g>
<!-- token_unpack -->
<g id="node242" class="node">
<title>token_unpack</title>
<polygon fill="lightcoral" stroke="black" points="8764.06,-328 8493.54,-328 8423.94,-240 8694.46,-240 8764.06,-328"/>
<text text-anchor="middle" x="8594" y="-295.6" font-family="Times,serif" font-size="8.00">Unpack Tokens</text>
<text text-anchor="middle" x="8594" y="-286.6" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="8594" y="-277.6" font-family="Times,serif" font-size="8.00">INPUT: [Σtokens, H=7168]</text>
<text text-anchor="middle" x="8594" y="-268.6" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- gather_comm&#45;&gt;token_unpack -->
<g id="edge340" class="edge">
<title>gather_comm&#45;&gt;token_unpack</title>
<path fill="none" stroke="black" d="M5966.2,-367C6335.03,-367 8427.49,-367 8427.49,-367 8427.49,-367 8427.49,-294.06 8427.49,-294.06"/>
<polygon fill="black" stroke="black" points="8430.99,-294.06 8427.49,-284.06 8423.99,-294.06 8430.99,-294.06"/>
</g>
<!-- layernorm2 -->
<g id="node243" class="node">
<title>layernorm2</title>
<polygon fill="lightblue" stroke="black" points="10062,-204 9898,-204 9898,-160 10062,-160 10062,-204"/>
<text text-anchor="middle" x="9980" y="-193.6" font-family="Times,serif" font-size="8.00">LayerNorm</text>
<text text-anchor="middle" x="9980" y="-184.6" font-family="Times,serif" font-size="8.00">GPU: Shared</text>
<text text-anchor="middle" x="9980" y="-175.6" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="9980" y="-166.6" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- token_unpack&#45;&gt;layernorm2 -->
<g id="edge341" class="edge">
<title>token_unpack&#45;&gt;layernorm2</title>
<path fill="none" stroke="black" d="M8729.44,-284C9067.37,-284 9920.75,-284 9920.75,-284 9920.75,-284 9920.75,-214.13 9920.75,-214.13"/>
<polygon fill="black" stroke="black" points="9924.25,-214.13 9920.75,-204.13 9917.25,-214.13 9924.25,-214.13"/>
</g>
<!-- layernorm2&#45;&gt;ffn_residual -->
<g id="edge342" class="edge">
<title>layernorm2&#45;&gt;ffn_residual</title>
<path fill="none" stroke="black" d="M9980.5,-159.72C9980.5,-159.72 9980.5,-134.16 9980.5,-134.16"/>
<polygon fill="black" stroke="black" points="9984,-134.16 9980.5,-124.16 9977,-134.16 9984,-134.16"/>
</g>
<!-- final_output -->
<g id="node245" class="node">
<title>final_output</title>
<polygon fill="lightgray" stroke="black" points="10117,-44 9953,-44 9953,0 10117,0 10117,-44"/>
<text text-anchor="middle" x="10035" y="-33.6" font-family="Times,serif" font-size="8.00">Layer Output</text>
<text text-anchor="middle" x="10035" y="-24.6" font-family="Times,serif" font-size="8.00">GPU: ALL</text>
<text text-anchor="middle" x="10035" y="-15.6" font-family="Times,serif" font-size="8.00">INPUT: [B=32, S=2048, H=7168]</text>
<text text-anchor="middle" x="10035" y="-6.6" font-family="Times,serif" font-size="8.00">OUTPUT: [B=32, S=2048, H=7168]</text>
</g>
<!-- ffn_residual&#45;&gt;final_output -->
<g id="edge344" class="edge">
<title>ffn_residual&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M10035,-79.72C10035,-79.72 10035,-54.16 10035,-54.16"/>
<polygon fill="black" stroke="black" points="10038.5,-54.16 10035,-44.16 10031.5,-54.16 10038.5,-54.16"/>
</g>
</g>
</svg>
