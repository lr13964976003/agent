<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7200pt" height="965pt"
 viewBox="0.00 0.00 7200.00 965.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.85 0.85) rotate(0) translate(4 1125.08)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1125.08 8418,-1125.08 8418,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgray" stroke="black" points="2902,-1121.08 2611,-1121.08 2611,-1063.08 2902,-1063.08 2902,-1121.08"/>
<text text-anchor="middle" x="2756.5" y="-1106.08" font-family="Times,serif" font-size="10.00">Input Layer</text>
<text text-anchor="middle" x="2756.5" y="-1095.08" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
<text text-anchor="middle" x="2756.5" y="-1084.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="2756.5" y="-1073.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- q_proj -->
<g id="node2" class="node">
<title>q_proj</title>
<polygon fill="lightcoral" stroke="black" points="2573.5,-1027.08 2243.5,-1027.08 2243.5,-969.08 2573.5,-969.08 2573.5,-1027.08"/>
<text text-anchor="middle" x="2408.5" y="-1012.08" font-family="Times,serif" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="2408.5" y="-1001.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="2408.5" y="-990.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="2408.5" y="-979.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
</g>
<!-- input&#45;&gt;q_proj -->
<g id="edge1" class="edge">
<title>input&#45;&gt;q_proj</title>
<path fill="none" stroke="black" d="M2610.93,-1092C2515.57,-1092 2408.5,-1092 2408.5,-1092 2408.5,-1092 2408.5,-1037.28 2408.5,-1037.28"/>
<polygon fill="black" stroke="black" points="2412,-1037.28 2408.5,-1027.28 2405,-1037.28 2412,-1037.28"/>
</g>
<!-- k_proj -->
<g id="node3" class="node">
<title>k_proj</title>
<polygon fill="lightcoral" stroke="black" points="2921.5,-1027.08 2591.5,-1027.08 2591.5,-969.08 2921.5,-969.08 2921.5,-1027.08"/>
<text text-anchor="middle" x="2756.5" y="-1012.08" font-family="Times,serif" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2756.5" y="-1001.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="2756.5" y="-990.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="2756.5" y="-979.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
</g>
<!-- input&#45;&gt;k_proj -->
<g id="edge2" class="edge">
<title>input&#45;&gt;k_proj</title>
<path fill="none" stroke="black" d="M2756.5,-1062.85C2756.5,-1062.85 2756.5,-1037.29 2756.5,-1037.29"/>
<polygon fill="black" stroke="black" points="2760,-1037.29 2756.5,-1027.29 2753,-1037.29 2760,-1037.29"/>
</g>
<!-- v_proj -->
<g id="node4" class="node">
<title>v_proj</title>
<polygon fill="lightcoral" stroke="black" points="3269.5,-1027.08 2939.5,-1027.08 2939.5,-969.08 3269.5,-969.08 3269.5,-1027.08"/>
<text text-anchor="middle" x="3104.5" y="-1012.08" font-family="Times,serif" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="3104.5" y="-1001.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="3104.5" y="-990.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3104.5" y="-979.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
</g>
<!-- input&#45;&gt;v_proj -->
<g id="edge3" class="edge">
<title>input&#45;&gt;v_proj</title>
<path fill="none" stroke="black" d="M2902.07,-1092C2997.43,-1092 3104.5,-1092 3104.5,-1092 3104.5,-1092 3104.5,-1037.28 3104.5,-1037.28"/>
<polygon fill="black" stroke="black" points="3108,-1037.28 3104.5,-1027.28 3101,-1037.28 3108,-1037.28"/>
</g>
<!-- attention -->
<g id="node5" class="node">
<title>attention</title>
<polygon fill="lightcoral" stroke="black" points="2917.5,-933.08 2595.5,-933.08 2595.5,-875.08 2917.5,-875.08 2917.5,-933.08"/>
<text text-anchor="middle" x="2756.5" y="-918.08" font-family="Times,serif" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2756.5" y="-907.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="2756.5" y="-896.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2756.5" y="-885.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- q_proj&#45;&gt;attention -->
<g id="edge4" class="edge">
<title>q_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M2538.5,-968.83C2538.5,-941.21 2538.5,-904 2538.5,-904 2538.5,-904 2585.49,-904 2585.49,-904"/>
<polygon fill="black" stroke="black" points="2585.49,-907.5 2595.49,-904 2585.49,-900.5 2585.49,-907.5"/>
</g>
<!-- k_proj&#45;&gt;attention -->
<g id="edge5" class="edge">
<title>k_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M2756.5,-968.85C2756.5,-968.85 2756.5,-943.29 2756.5,-943.29"/>
<polygon fill="black" stroke="black" points="2760,-943.29 2756.5,-933.29 2753,-943.29 2760,-943.29"/>
</g>
<!-- v_proj&#45;&gt;attention -->
<g id="edge6" class="edge">
<title>v_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M3015.45,-968.83C3015.45,-941.21 3015.45,-904 3015.45,-904 3015.45,-904 2927.55,-904 2927.55,-904"/>
<polygon fill="black" stroke="black" points="2927.55,-900.5 2917.55,-904 2927.55,-907.5 2927.55,-900.5"/>
</g>
<!-- mha_out_proj -->
<g id="node6" class="node">
<title>mha_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="984,-676.08 693,-676.08 693,-618.08 984,-618.08 984,-676.08"/>
<text text-anchor="middle" x="838.5" y="-661.08" font-family="Times,serif" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="838.5" y="-650.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="838.5" y="-639.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="838.5" y="-628.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- attention&#45;&gt;mha_out_proj -->
<g id="edge7" class="edge">
<title>attention&#45;&gt;mha_out_proj</title>
<path fill="none" stroke="black" d="M2648.5,-874.65C2648.5,-808.93 2648.5,-656 2648.5,-656 2648.5,-656 994.32,-656 994.32,-656"/>
<polygon fill="black" stroke="black" points="994.32,-652.5 984.32,-656 994.32,-659.5 994.32,-652.5"/>
</g>
<!-- gating -->
<g id="node7" class="node">
<title>gating</title>
<polygon fill="lightcoral" stroke="black" points="3773.68,-839.08 3230.94,-839.08 3091.32,-735.08 3634.06,-735.08 3773.68,-839.08"/>
<text text-anchor="middle" x="3432.5" y="-801.08" font-family="Times,serif" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="3432.5" y="-790.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="3432.5" y="-779.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3432.5" y="-768.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, experts=32, top_k=2]</text>
</g>
<!-- attention&#45;&gt;gating -->
<g id="edge8" class="edge">
<title>attention&#45;&gt;gating</title>
<path fill="none" stroke="black" d="M2871.5,-874.84C2871.5,-840.16 2871.5,-787 2871.5,-787 2871.5,-787 3150.63,-787 3150.63,-787"/>
<polygon fill="black" stroke="black" points="3150.63,-790.5 3160.63,-787 3150.63,-783.5 3150.63,-790.5"/>
</g>
<!-- layer_output -->
<g id="node59" class="node">
<title>layer_output</title>
<polygon fill="lightgray" stroke="black" points="2103,-58 1812,-58 1812,0 2103,0 2103,-58"/>
<text text-anchor="middle" x="1957.5" y="-43" font-family="Times,serif" font-size="10.00">Layer Output</text>
<text text-anchor="middle" x="1957.5" y="-32" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
<text text-anchor="middle" x="1957.5" y="-21" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="1957.5" y="-10" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- mha_out_proj&#45;&gt;layer_output -->
<g id="edge108" class="edge">
<title>mha_out_proj&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M984.16,-637C1018.33,-637 1045,-637 1045,-637 1045,-637 1045,-28 1045,-28 1045,-28 1801.9,-28 1801.9,-28"/>
<polygon fill="black" stroke="black" points="1801.9,-31.5 1811.9,-28 1801.9,-24.5 1801.9,-31.5"/>
</g>
<!-- routing -->
<g id="node8" class="node">
<title>routing</title>
<polygon fill="lightcoral" stroke="black" points="4256.1,-699.08 3727.01,-699.08 3590.9,-595.08 4119.99,-595.08 4256.1,-699.08"/>
<text text-anchor="middle" x="3923.5" y="-661.08" font-family="Times,serif" font-size="10.00">Token Routing Decision</text>
<text text-anchor="middle" x="3923.5" y="-650.08" font-family="Times,serif" font-size="10.00">GPU: Shared (All GPUs)</text>
<text text-anchor="middle" x="3923.5" y="-639.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, experts=32, top_k=2]</text>
<text text-anchor="middle" x="3923.5" y="-628.08" font-family="Times,serif" font-size="10.00">Output: Token routing masks</text>
</g>
<!-- gating&#45;&gt;routing -->
<g id="edge9" class="edge">
<title>gating&#45;&gt;routing</title>
<path fill="none" stroke="black" d="M3682.15,-770.74C3682.15,-770.74 3682.15,-675.07 3682.15,-675.07"/>
<polygon fill="black" stroke="black" points="3685.65,-675.07 3682.15,-665.07 3678.65,-675.07 3685.65,-675.07"/>
</g>
<!-- token_scatter -->
<g id="node9" class="node">
<title>token_scatter</title>
<ellipse fill="lightgreen" stroke="black" cx="4037.5" cy="-522.31" rx="200.22" ry="36.54"/>
<text text-anchor="middle" x="4037.5" y="-536.31" font-family="Times,serif" font-size="10.00">Token Scatter Communication</text>
<text text-anchor="middle" x="4037.5" y="-525.31" font-family="Times,serif" font-size="10.00">GPU: All&#45;to&#45;all</text>
<text text-anchor="middle" x="4037.5" y="-514.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="4037.5" y="-503.31" font-family="Times,serif" font-size="10.00">Output: Distributed tokens per expert</text>
</g>
<!-- routing&#45;&gt;token_scatter -->
<g id="edge10" class="edge">
<title>routing&#45;&gt;token_scatter</title>
<path fill="none" stroke="black" d="M4037.5,-594.89C4037.5,-594.89 4037.5,-569.12 4037.5,-569.12"/>
<polygon fill="black" stroke="black" points="4041,-569.12 4037.5,-559.12 4034,-569.12 4041,-569.12"/>
</g>
<!-- expert_0_gate -->
<g id="node10" class="node">
<title>expert_0_gate</title>
<polygon fill="lightcoral" stroke="black" points="5061.5,-449.54 4757.5,-449.54 4757.5,-391.54 5061.5,-391.54 5061.5,-449.54"/>
<text text-anchor="middle" x="4909.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 0 Gate</text>
<text text-anchor="middle" x="4909.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4909.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="4909.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_0_gate -->
<g id="edge15" class="edge">
<title>routing&#45;&gt;expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4154.21,-621C4459.68,-621 4960.17,-621 4960.17,-621 4960.17,-621 4960.17,-459.69 4960.17,-459.69"/>
<polygon fill="black" stroke="black" points="4963.67,-459.69 4960.17,-449.69 4956.67,-459.69 4963.67,-459.69"/>
</g>
<!-- expert_1_gate -->
<g id="node13" class="node">
<title>expert_1_gate</title>
<polygon fill="lightcoral" stroke="black" points="5383.5,-449.54 5079.5,-449.54 5079.5,-391.54 5383.5,-391.54 5383.5,-449.54"/>
<text text-anchor="middle" x="5231.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 1 Gate</text>
<text text-anchor="middle" x="5231.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="5231.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="5231.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_1_gate -->
<g id="edge20" class="edge">
<title>routing&#45;&gt;expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4171.12,-634C4563.01,-634 5282.17,-634 5282.17,-634 5282.17,-634 5282.17,-459.77 5282.17,-459.77"/>
<polygon fill="black" stroke="black" points="5285.67,-459.77 5282.17,-449.77 5278.67,-459.77 5285.67,-459.77"/>
</g>
<!-- expert_2_gate -->
<g id="node16" class="node">
<title>expert_2_gate</title>
<polygon fill="lightcoral" stroke="black" points="5705.5,-449.54 5401.5,-449.54 5401.5,-391.54 5705.5,-391.54 5705.5,-449.54"/>
<text text-anchor="middle" x="5553.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 2 Gate</text>
<text text-anchor="middle" x="5553.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="5553.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="5553.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_2_gate -->
<g id="edge25" class="edge">
<title>routing&#45;&gt;expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4187.95,-647C4661.25,-647 5604.17,-647 5604.17,-647 5604.17,-647 5604.17,-459.68 5604.17,-459.68"/>
<polygon fill="black" stroke="black" points="5607.67,-459.68 5604.17,-449.68 5600.67,-459.68 5607.67,-459.68"/>
</g>
<!-- expert_3_gate -->
<g id="node19" class="node">
<title>expert_3_gate</title>
<polygon fill="lightcoral" stroke="black" points="6027.5,-449.54 5723.5,-449.54 5723.5,-391.54 6027.5,-391.54 6027.5,-449.54"/>
<text text-anchor="middle" x="5875.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 3 Gate</text>
<text text-anchor="middle" x="5875.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="5875.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="5875.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_3_gate -->
<g id="edge30" class="edge">
<title>routing&#45;&gt;expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4205.13,-660C4756.73,-660 5926.17,-660 5926.17,-660 5926.17,-660 5926.17,-459.9 5926.17,-459.9"/>
<polygon fill="black" stroke="black" points="5929.67,-459.9 5926.17,-449.9 5922.67,-459.9 5929.67,-459.9"/>
</g>
<!-- expert_4_gate -->
<g id="node22" class="node">
<title>expert_4_gate</title>
<polygon fill="lightcoral" stroke="black" points="6349.5,-449.54 6045.5,-449.54 6045.5,-391.54 6349.5,-391.54 6349.5,-449.54"/>
<text text-anchor="middle" x="6197.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 4 Gate</text>
<text text-anchor="middle" x="6197.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="6197.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="6197.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_4_gate -->
<g id="edge35" class="edge">
<title>routing&#45;&gt;expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4222.06,-673C4849.63,-673 6248.17,-673 6248.17,-673 6248.17,-673 6248.17,-459.99 6248.17,-459.99"/>
<polygon fill="black" stroke="black" points="6251.67,-459.99 6248.17,-449.99 6244.67,-459.99 6251.67,-459.99"/>
</g>
<!-- expert_5_gate -->
<g id="node25" class="node">
<title>expert_5_gate</title>
<polygon fill="lightcoral" stroke="black" points="6671.5,-449.54 6367.5,-449.54 6367.5,-391.54 6671.5,-391.54 6671.5,-449.54"/>
<text text-anchor="middle" x="6519.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 5 Gate</text>
<text text-anchor="middle" x="6519.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="6519.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="6519.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_5_gate -->
<g id="edge40" class="edge">
<title>routing&#45;&gt;expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4239.14,-686C4941.11,-686 6570.17,-686 6570.17,-686 6570.17,-686 6570.17,-459.71 6570.17,-459.71"/>
<polygon fill="black" stroke="black" points="6573.67,-459.71 6570.17,-449.71 6566.67,-459.71 6573.67,-459.71"/>
</g>
<!-- expert_6_gate -->
<g id="node28" class="node">
<title>expert_6_gate</title>
<polygon fill="lightcoral" stroke="black" points="1841.5,-449.54 1537.5,-449.54 1537.5,-391.54 1841.5,-391.54 1841.5,-449.54"/>
<text text-anchor="middle" x="1689.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 6 Gate</text>
<text text-anchor="middle" x="1689.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1689.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="1689.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_6_gate -->
<g id="edge45" class="edge">
<title>routing&#45;&gt;expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3615.38,-614C2991.76,-614 1638.83,-614 1638.83,-614 1638.83,-614 1638.83,-459.92 1638.83,-459.92"/>
<polygon fill="black" stroke="black" points="1642.33,-459.92 1638.83,-449.92 1635.33,-459.92 1642.33,-459.92"/>
</g>
<!-- expert_7_gate -->
<g id="node31" class="node">
<title>expert_7_gate</title>
<polygon fill="lightcoral" stroke="black" points="2163.5,-449.54 1859.5,-449.54 1859.5,-391.54 2163.5,-391.54 2163.5,-449.54"/>
<text text-anchor="middle" x="2011.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 7 Gate</text>
<text text-anchor="middle" x="2011.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2011.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="2011.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_7_gate -->
<g id="edge50" class="edge">
<title>routing&#45;&gt;expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3611.7,-611C3058.02,-611 1960.83,-611 1960.83,-611 1960.83,-611 1960.83,-459.88 1960.83,-459.88"/>
<polygon fill="black" stroke="black" points="1964.33,-459.88 1960.83,-449.88 1957.33,-459.88 1964.33,-459.88"/>
</g>
<!-- expert_8_gate -->
<g id="node34" class="node">
<title>expert_8_gate</title>
<polygon fill="lightcoral" stroke="black" points="2485.5,-449.54 2181.5,-449.54 2181.5,-391.54 2485.5,-391.54 2485.5,-449.54"/>
<text text-anchor="middle" x="2333.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 8 Gate</text>
<text text-anchor="middle" x="2333.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2333.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="2333.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_8_gate -->
<g id="edge55" class="edge">
<title>routing&#45;&gt;expert_8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3607.52,-608C3141.43,-608 2324.17,-608 2324.17,-608 2324.17,-608 2324.17,-459.83 2324.17,-459.83"/>
<polygon fill="black" stroke="black" points="2327.67,-459.83 2324.17,-449.83 2320.67,-459.83 2327.67,-459.83"/>
</g>
<!-- expert_9_gate -->
<g id="node37" class="node">
<title>expert_9_gate</title>
<polygon fill="lightcoral" stroke="black" points="2807.5,-449.54 2503.5,-449.54 2503.5,-391.54 2807.5,-391.54 2807.5,-449.54"/>
<text text-anchor="middle" x="2655.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 9 Gate</text>
<text text-anchor="middle" x="2655.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2655.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="2655.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_9_gate -->
<g id="edge60" class="edge">
<title>routing&#45;&gt;expert_9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3602.43,-604C3240.38,-604 2701.5,-604 2701.5,-604 2701.5,-604 2701.5,-459.61 2701.5,-459.61"/>
<polygon fill="black" stroke="black" points="2705,-459.61 2701.5,-449.61 2698,-459.61 2705,-459.61"/>
</g>
<!-- expert_10_gate -->
<g id="node40" class="node">
<title>expert_10_gate</title>
<polygon fill="lightcoral" stroke="black" points="3129.5,-449.54 2825.5,-449.54 2825.5,-391.54 3129.5,-391.54 3129.5,-449.54"/>
<text text-anchor="middle" x="2977.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 10 Gate</text>
<text text-anchor="middle" x="2977.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2977.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="2977.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_10_gate -->
<g id="edge65" class="edge">
<title>routing&#45;&gt;expert_10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3598.48,-601C3369.71,-601 3104.11,-601 3104.11,-601 3104.11,-601 3104.11,-459.93 3104.11,-459.93"/>
<polygon fill="black" stroke="black" points="3107.61,-459.93 3104.11,-449.93 3100.61,-459.93 3107.61,-459.93"/>
</g>
<!-- expert_11_gate -->
<g id="node43" class="node">
<title>expert_11_gate</title>
<polygon fill="lightcoral" stroke="black" points="3451.5,-449.54 3147.5,-449.54 3147.5,-391.54 3451.5,-391.54 3451.5,-449.54"/>
<text text-anchor="middle" x="3299.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 11 Gate</text>
<text text-anchor="middle" x="3299.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3299.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="3299.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_11_gate -->
<g id="edge70" class="edge">
<title>routing&#45;&gt;expert_11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3594.57,-598C3423.15,-598 3248.83,-598 3248.83,-598 3248.83,-598 3248.83,-459.84 3248.83,-459.84"/>
<polygon fill="black" stroke="black" points="3252.33,-459.84 3248.83,-449.84 3245.33,-459.84 3252.33,-459.84"/>
</g>
<!-- expert_12_gate -->
<g id="node46" class="node">
<title>expert_12_gate</title>
<polygon fill="lightcoral" stroke="black" points="3773.5,-449.54 3469.5,-449.54 3469.5,-391.54 3773.5,-391.54 3773.5,-449.54"/>
<text text-anchor="middle" x="3621.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 12 Gate</text>
<text text-anchor="middle" x="3621.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3621.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="3621.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_12_gate -->
<g id="edge75" class="edge">
<title>routing&#45;&gt;expert_12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3651.63,-594.82C3651.63,-594.82 3651.63,-459.68 3651.63,-459.68"/>
<polygon fill="black" stroke="black" points="3655.13,-459.68 3651.63,-449.68 3648.13,-459.68 3655.13,-459.68"/>
</g>
<!-- expert_13_gate -->
<g id="node49" class="node">
<title>expert_13_gate</title>
<polygon fill="lightcoral" stroke="black" points="4095.5,-449.54 3791.5,-449.54 3791.5,-391.54 4095.5,-391.54 4095.5,-449.54"/>
<text text-anchor="middle" x="3943.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 13 Gate</text>
<text text-anchor="middle" x="3943.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3943.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="3943.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_13_gate -->
<g id="edge80" class="edge">
<title>routing&#45;&gt;expert_13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3814.44,-594.82C3814.44,-594.82 3814.44,-459.68 3814.44,-459.68"/>
<polygon fill="black" stroke="black" points="3817.94,-459.68 3814.44,-449.68 3810.94,-459.68 3817.94,-459.68"/>
</g>
<!-- expert_14_gate -->
<g id="node52" class="node">
<title>expert_14_gate</title>
<polygon fill="lightcoral" stroke="black" points="4417.5,-449.54 4113.5,-449.54 4113.5,-391.54 4417.5,-391.54 4417.5,-449.54"/>
<text text-anchor="middle" x="4265.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 14 Gate</text>
<text text-anchor="middle" x="4265.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4265.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="4265.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_14_gate -->
<g id="edge85" class="edge">
<title>routing&#45;&gt;expert_14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4246.95,-646.91C4246.95,-646.91 4246.95,-459.77 4246.95,-459.77"/>
<polygon fill="black" stroke="black" points="4250.45,-459.77 4246.95,-449.77 4243.45,-459.77 4250.45,-459.77"/>
</g>
<!-- expert_15_gate -->
<g id="node55" class="node">
<title>expert_15_gate</title>
<polygon fill="lightcoral" stroke="black" points="4739.5,-449.54 4435.5,-449.54 4435.5,-391.54 4739.5,-391.54 4739.5,-449.54"/>
<text text-anchor="middle" x="4587.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 15 Gate</text>
<text text-anchor="middle" x="4587.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4587.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="4587.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_15_gate -->
<g id="edge90" class="edge">
<title>routing&#45;&gt;expert_15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4136.96,-608C4347.54,-608 4638.17,-608 4638.17,-608 4638.17,-608 4638.17,-459.83 4638.17,-459.83"/>
<polygon fill="black" stroke="black" points="4641.67,-459.83 4638.17,-449.83 4634.67,-459.83 4641.67,-459.83"/>
</g>
<!-- token_scatter&#45;&gt;expert_0_gate -->
<g id="edge11" class="edge">
<title>token_scatter&#45;&gt;expert_0_gate</title>
<path fill="none" stroke="black" d="M4208.18,-503C4448.82,-503 4858.83,-503 4858.83,-503 4858.83,-503 4858.83,-459.84 4858.83,-459.84"/>
<polygon fill="black" stroke="black" points="4862.33,-459.84 4858.83,-449.84 4855.33,-459.84 4862.33,-459.84"/>
</g>
<!-- token_scatter&#45;&gt;expert_1_gate -->
<g id="edge16" class="edge">
<title>token_scatter&#45;&gt;expert_1_gate</title>
<path fill="none" stroke="black" d="M4231.13,-513C4557.24,-513 5180.83,-513 5180.83,-513 5180.83,-513 5180.83,-459.54 5180.83,-459.54"/>
<polygon fill="black" stroke="black" points="5184.33,-459.54 5180.83,-449.54 5177.33,-459.54 5184.33,-459.54"/>
</g>
<!-- token_scatter&#45;&gt;expert_2_gate -->
<g id="edge21" class="edge">
<title>token_scatter&#45;&gt;expert_2_gate</title>
<path fill="none" stroke="black" d="M4237.79,-522C4638.94,-522 5502.83,-522 5502.83,-522 5502.83,-522 5502.83,-459.61 5502.83,-459.61"/>
<polygon fill="black" stroke="black" points="5506.33,-459.61 5502.83,-449.61 5499.33,-459.61 5506.33,-459.61"/>
</g>
<!-- token_scatter&#45;&gt;expert_3_gate -->
<g id="edge26" class="edge">
<title>token_scatter&#45;&gt;expert_3_gate</title>
<path fill="none" stroke="black" d="M4232.18,-531C4695.42,-531 5824.83,-531 5824.83,-531 5824.83,-531 5824.83,-459.56 5824.83,-459.56"/>
<polygon fill="black" stroke="black" points="5828.33,-459.56 5824.83,-449.56 5821.33,-459.56 5828.33,-459.56"/>
</g>
<!-- token_scatter&#45;&gt;expert_4_gate -->
<g id="edge31" class="edge">
<title>token_scatter&#45;&gt;expert_4_gate</title>
<path fill="none" stroke="black" d="M4213.26,-540C4719.82,-540 6146.83,-540 6146.83,-540 6146.83,-540 6146.83,-459.76 6146.83,-459.76"/>
<polygon fill="black" stroke="black" points="6150.33,-459.76 6146.83,-449.76 6143.33,-459.76 6150.33,-459.76"/>
</g>
<!-- token_scatter&#45;&gt;expert_5_gate -->
<g id="edge36" class="edge">
<title>token_scatter&#45;&gt;expert_5_gate</title>
<path fill="none" stroke="black" d="M4175.19,-549C4689.52,-549 6468.83,-549 6468.83,-549 6468.83,-549 6468.83,-459.69 6468.83,-459.69"/>
<polygon fill="black" stroke="black" points="6472.33,-459.69 6468.83,-449.69 6465.33,-459.69 6472.33,-459.69"/>
</g>
<!-- token_scatter&#45;&gt;expert_6_gate -->
<g id="edge41" class="edge">
<title>token_scatter&#45;&gt;expert_6_gate</title>
<path fill="none" stroke="black" d="M3899.82,-549C3404.19,-549 1740.17,-549 1740.17,-549 1740.17,-549 1740.17,-459.69 1740.17,-459.69"/>
<polygon fill="black" stroke="black" points="1743.67,-459.69 1740.17,-449.69 1736.67,-459.69 1743.67,-459.69"/>
</g>
<!-- token_scatter&#45;&gt;expert_7_gate -->
<g id="edge46" class="edge">
<title>token_scatter&#45;&gt;expert_7_gate</title>
<path fill="none" stroke="black" d="M3861.77,-540C3377.98,-540 2062.17,-540 2062.17,-540 2062.17,-540 2062.17,-459.76 2062.17,-459.76"/>
<polygon fill="black" stroke="black" points="2065.67,-459.76 2062.17,-449.76 2058.67,-459.76 2065.67,-459.76"/>
</g>
<!-- token_scatter&#45;&gt;expert_8_gate -->
<g id="edge51" class="edge">
<title>token_scatter&#45;&gt;expert_8_gate</title>
<path fill="none" stroke="black" d="M3842.99,-531C3410.07,-531 2404.83,-531 2404.83,-531 2404.83,-531 2404.83,-459.56 2404.83,-459.56"/>
<polygon fill="black" stroke="black" points="2408.33,-459.56 2404.83,-449.56 2401.33,-459.56 2408.33,-459.56"/>
</g>
<!-- token_scatter&#45;&gt;expert_9_gate -->
<g id="edge56" class="edge">
<title>token_scatter&#45;&gt;expert_9_gate</title>
<path fill="none" stroke="black" d="M3837.38,-522C3476.66,-522 2754.5,-522 2754.5,-522 2754.5,-522 2754.5,-459.61 2754.5,-459.61"/>
<polygon fill="black" stroke="black" points="2758,-459.61 2754.5,-449.61 2751,-459.61 2758,-459.61"/>
</g>
<!-- token_scatter&#45;&gt;expert_10_gate -->
<g id="edge61" class="edge">
<title>token_scatter&#45;&gt;expert_10_gate</title>
<path fill="none" stroke="black" d="M3843.65,-513C3573.56,-513 3116.8,-513 3116.8,-513 3116.8,-513 3116.8,-459.54 3116.8,-459.54"/>
<polygon fill="black" stroke="black" points="3120.3,-459.54 3116.8,-449.54 3113.3,-459.54 3120.3,-459.54"/>
</g>
<!-- token_scatter&#45;&gt;expert_11_gate -->
<g id="edge66" class="edge">
<title>token_scatter&#45;&gt;expert_11_gate</title>
<path fill="none" stroke="black" d="M3867.16,-503C3663.6,-503 3350.17,-503 3350.17,-503 3350.17,-503 3350.17,-459.84 3350.17,-459.84"/>
<polygon fill="black" stroke="black" points="3353.67,-459.84 3350.17,-449.84 3346.67,-459.84 3353.67,-459.84"/>
</g>
<!-- token_scatter&#45;&gt;expert_12_gate -->
<g id="edge71" class="edge">
<title>token_scatter&#45;&gt;expert_12_gate</title>
<path fill="none" stroke="black" d="M3909.54,-494C3818.62,-494 3712.57,-494 3712.57,-494 3712.57,-494 3712.57,-459.57 3712.57,-459.57"/>
<polygon fill="black" stroke="black" points="3716.07,-459.57 3712.57,-449.57 3709.07,-459.57 3716.07,-459.57"/>
</g>
<!-- token_scatter&#45;&gt;expert_13_gate -->
<g id="edge76" class="edge">
<title>token_scatter&#45;&gt;expert_13_gate</title>
<path fill="none" stroke="black" d="M3966.44,-487.85C3966.44,-487.85 3966.44,-459.86 3966.44,-459.86"/>
<polygon fill="black" stroke="black" points="3969.94,-459.86 3966.44,-449.86 3962.94,-459.86 3969.94,-459.86"/>
</g>
<!-- token_scatter&#45;&gt;expert_14_gate -->
<g id="edge81" class="edge">
<title>token_scatter&#45;&gt;expert_14_gate</title>
<path fill="none" stroke="black" d="M4175.56,-495.57C4175.56,-495.57 4175.56,-459.6 4175.56,-459.6"/>
<polygon fill="black" stroke="black" points="4179.06,-459.6 4175.56,-449.6 4172.06,-459.6 4179.06,-459.6"/>
</g>
<!-- token_scatter&#45;&gt;expert_15_gate -->
<g id="edge86" class="edge">
<title>token_scatter&#45;&gt;expert_15_gate</title>
<path fill="none" stroke="black" d="M4165.44,-494C4313.39,-494 4536.83,-494 4536.83,-494 4536.83,-494 4536.83,-459.57 4536.83,-459.57"/>
<polygon fill="black" stroke="black" points="4540.33,-459.57 4536.83,-449.57 4533.33,-459.57 4540.33,-459.57"/>
</g>
<!-- expert_0_expert -->
<g id="node11" class="node">
<title>expert_0_expert</title>
<polygon fill="lightcoral" stroke="black" points="5186.5,-355.54 4890.5,-355.54 4890.5,-297.54 5186.5,-297.54 5186.5,-355.54"/>
<text text-anchor="middle" x="5038.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 0 Expert</text>
<text text-anchor="middle" x="5038.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5038.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="5038.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_0_gate&#45;&gt;expert_0_expert -->
<g id="edge12" class="edge">
<title>expert_0_gate&#45;&gt;expert_0_expert</title>
<path fill="none" stroke="black" d="M4976,-391.31C4976,-391.31 4976,-365.75 4976,-365.75"/>
<polygon fill="black" stroke="black" points="4979.5,-365.75 4976,-355.75 4972.5,-365.75 4979.5,-365.75"/>
</g>
<!-- expert_0_multiply -->
<g id="node12" class="node">
<title>expert_0_multiply</title>
<polygon fill="lightcoral" stroke="black" points="5779,-261.54 5270,-261.54 5270,-203.54 5779,-203.54 5779,-261.54"/>
<text text-anchor="middle" x="5524.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 0 Multiply</text>
<text text-anchor="middle" x="5524.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="5524.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="5524.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_0_expert&#45;&gt;expert_0_multiply -->
<g id="edge13" class="edge">
<title>expert_0_expert&#45;&gt;expert_0_multiply</title>
<path fill="none" stroke="black" d="M5038.5,-297.33C5038.5,-281.85 5038.5,-266 5038.5,-266 5038.5,-266 5349.17,-266 5349.17,-266 5349.17,-266 5349.17,-265.56 5349.17,-265.56"/>
<polygon fill="black" stroke="black" points="5352.67,-271.63 5349.17,-261.63 5345.67,-271.63 5352.67,-271.63"/>
</g>
<!-- token_gather -->
<g id="node58" class="node">
<title>token_gather</title>
<ellipse fill="lightcoral" stroke="black" cx="3943.5" cy="-130.77" rx="205.54" ry="36.54"/>
<text text-anchor="middle" x="3943.5" y="-144.77" font-family="Times,serif" font-size="10.00">Token Gather Communication</text>
<text text-anchor="middle" x="3943.5" y="-133.77" font-family="Times,serif" font-size="10.00">GPU: All&#45;to&#45;all</text>
<text text-anchor="middle" x="3943.5" y="-122.77" font-family="Times,serif" font-size="10.00">Input: Expert outputs</text>
<text text-anchor="middle" x="3943.5" y="-111.77" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- expert_0_multiply&#45;&gt;token_gather -->
<g id="edge14" class="edge">
<title>expert_0_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M5439.67,-203.39C5439.67,-177.92 5439.67,-145 5439.67,-145 5439.67,-145 4143.37,-145 4143.37,-145"/>
<polygon fill="black" stroke="black" points="4143.37,-141.5 4133.37,-145 4143.37,-148.5 4143.37,-141.5"/>
</g>
<!-- expert_0_multiply&#45;&gt;token_gather -->
<g id="edge91" class="edge">
<title>expert_0_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M5609.33,-203.32C5609.33,-176.53 5609.33,-141 5609.33,-141 5609.33,-141 4151.55,-141 4151.55,-141"/>
<polygon fill="black" stroke="black" points="4151.55,-137.5 4141.55,-141 4151.55,-144.5 4151.55,-137.5"/>
</g>
<!-- expert_1_expert -->
<g id="node14" class="node">
<title>expert_1_expert</title>
<polygon fill="lightcoral" stroke="black" points="5507.5,-355.54 5211.5,-355.54 5211.5,-297.54 5507.5,-297.54 5507.5,-355.54"/>
<text text-anchor="middle" x="5359.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 1 Expert</text>
<text text-anchor="middle" x="5359.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="5359.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="5359.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_1_gate&#45;&gt;expert_1_expert -->
<g id="edge17" class="edge">
<title>expert_1_gate&#45;&gt;expert_1_expert</title>
<path fill="none" stroke="black" d="M5297.5,-391.31C5297.5,-391.31 5297.5,-365.75 5297.5,-365.75"/>
<polygon fill="black" stroke="black" points="5301,-365.75 5297.5,-355.75 5294,-365.75 5301,-365.75"/>
</g>
<!-- expert_1_multiply -->
<g id="node15" class="node">
<title>expert_1_multiply</title>
<polygon fill="lightcoral" stroke="black" points="6306,-261.54 5797,-261.54 5797,-203.54 6306,-203.54 6306,-261.54"/>
<text text-anchor="middle" x="6051.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 1 Multiply</text>
<text text-anchor="middle" x="6051.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="6051.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="6051.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_1_expert&#45;&gt;expert_1_multiply -->
<g id="edge18" class="edge">
<title>expert_1_expert&#45;&gt;expert_1_multiply</title>
<path fill="none" stroke="black" d="M5428.33,-297.46C5428.33,-285.77 5428.33,-275 5428.33,-275 5428.33,-275 5806.17,-275 5806.17,-275 5806.17,-275 5806.17,-271.57 5806.17,-271.57"/>
<polygon fill="black" stroke="black" points="5809.67,-271.57 5806.17,-261.57 5802.67,-271.57 5809.67,-271.57"/>
</g>
<!-- expert_1_multiply&#45;&gt;token_gather -->
<g id="edge19" class="edge">
<title>expert_1_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M5966.67,-203.36C5966.67,-175.26 5966.67,-137 5966.67,-137 5966.67,-137 4156.75,-137 4156.75,-137"/>
<polygon fill="black" stroke="black" points="4156.75,-133.5 4146.75,-137 4156.75,-140.5 4156.75,-133.5"/>
</g>
<!-- expert_1_multiply&#45;&gt;token_gather -->
<g id="edge92" class="edge">
<title>expert_1_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M6136.33,-203.46C6136.33,-173.77 6136.33,-132 6136.33,-132 6136.33,-132 4159.3,-132 4159.3,-132"/>
<polygon fill="black" stroke="black" points="4159.3,-128.5 4149.3,-132 4159.3,-135.5 4159.3,-128.5"/>
</g>
<!-- expert_2_expert -->
<g id="node17" class="node">
<title>expert_2_expert</title>
<polygon fill="lightcoral" stroke="black" points="5824.5,-355.54 5528.5,-355.54 5528.5,-297.54 5824.5,-297.54 5824.5,-355.54"/>
<text text-anchor="middle" x="5676.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 2 Expert</text>
<text text-anchor="middle" x="5676.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="5676.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="5676.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_2_gate&#45;&gt;expert_2_expert -->
<g id="edge22" class="edge">
<title>expert_2_gate&#45;&gt;expert_2_expert</title>
<path fill="none" stroke="black" d="M5617,-391.31C5617,-391.31 5617,-365.75 5617,-365.75"/>
<polygon fill="black" stroke="black" points="5620.5,-365.75 5617,-355.75 5613.5,-365.75 5620.5,-365.75"/>
</g>
<!-- expert_2_multiply -->
<g id="node18" class="node">
<title>expert_2_multiply</title>
<polygon fill="lightcoral" stroke="black" points="6833,-261.54 6324,-261.54 6324,-203.54 6833,-203.54 6833,-261.54"/>
<text text-anchor="middle" x="6578.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 2 Multiply</text>
<text text-anchor="middle" x="6578.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="6578.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="6578.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_2_expert&#45;&gt;expert_2_multiply -->
<g id="edge23" class="edge">
<title>expert_2_expert&#45;&gt;expert_2_multiply</title>
<path fill="none" stroke="black" d="M5815.33,-297.46C5815.33,-289.98 5815.33,-284 5815.33,-284 5815.33,-284 6367.83,-284 6367.83,-284 6367.83,-284 6367.83,-271.58 6367.83,-271.58"/>
<polygon fill="black" stroke="black" points="6371.33,-271.58 6367.83,-261.58 6364.33,-271.58 6371.33,-271.58"/>
</g>
<!-- expert_2_multiply&#45;&gt;token_gather -->
<g id="edge24" class="edge">
<title>expert_2_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M6493.67,-203.42C6493.67,-172.49 6493.67,-128 6493.67,-128 6493.67,-128 4158.69,-128 4158.69,-128"/>
<polygon fill="black" stroke="black" points="4158.69,-124.5 4148.69,-128 4158.69,-131.5 4158.69,-124.5"/>
</g>
<!-- expert_2_multiply&#45;&gt;token_gather -->
<g id="edge93" class="edge">
<title>expert_2_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M6663.33,-203.45C6663.33,-171.3 6663.33,-124 6663.33,-124 6663.33,-124 4155.98,-124 4155.98,-124"/>
<polygon fill="black" stroke="black" points="4155.98,-120.5 4145.98,-124 4155.98,-127.5 4155.98,-120.5"/>
</g>
<!-- expert_3_expert -->
<g id="node20" class="node">
<title>expert_3_expert</title>
<polygon fill="lightcoral" stroke="black" points="6140.5,-355.54 5844.5,-355.54 5844.5,-297.54 6140.5,-297.54 6140.5,-355.54"/>
<text text-anchor="middle" x="5992.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 3 Expert</text>
<text text-anchor="middle" x="5992.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="5992.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="5992.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_3_gate&#45;&gt;expert_3_expert -->
<g id="edge27" class="edge">
<title>expert_3_gate&#45;&gt;expert_3_expert</title>
<path fill="none" stroke="black" d="M5936,-391.31C5936,-391.31 5936,-365.75 5936,-365.75"/>
<polygon fill="black" stroke="black" points="5939.5,-365.75 5936,-355.75 5932.5,-365.75 5939.5,-365.75"/>
</g>
<!-- expert_3_multiply -->
<g id="node21" class="node">
<title>expert_3_multiply</title>
<polygon fill="lightcoral" stroke="black" points="7360,-261.54 6851,-261.54 6851,-203.54 7360,-203.54 7360,-261.54"/>
<text text-anchor="middle" x="7105.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 3 Multiply</text>
<text text-anchor="middle" x="7105.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="7105.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="7105.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_3_expert&#45;&gt;expert_3_multiply -->
<g id="edge28" class="edge">
<title>expert_3_expert&#45;&gt;expert_3_multiply</title>
<path fill="none" stroke="black" d="M6093,-355.94C6093,-362.22 6093,-367 6093,-367 6093,-367 7105.5,-367 7105.5,-367 7105.5,-367 7105.5,-271.72 7105.5,-271.72"/>
<polygon fill="black" stroke="black" points="7109,-271.72 7105.5,-261.72 7102,-271.72 7109,-271.72"/>
</g>
<!-- expert_3_multiply&#45;&gt;token_gather -->
<g id="edge29" class="edge">
<title>expert_3_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M7020.67,-203.3C7020.67,-169.66 7020.67,-119 7020.67,-119 7020.67,-119 4148.62,-119 4148.62,-119"/>
<polygon fill="black" stroke="black" points="4148.62,-115.5 4138.62,-119 4148.62,-122.5 4148.62,-115.5"/>
</g>
<!-- expert_3_multiply&#45;&gt;token_gather -->
<g id="edge94" class="edge">
<title>expert_3_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M7190.33,-203.48C7190.33,-168.68 7190.33,-115 7190.33,-115 7190.33,-115 4139.43,-115 4139.43,-115"/>
<polygon fill="black" stroke="black" points="4139.43,-111.5 4129.43,-115 4139.43,-118.5 4139.43,-111.5"/>
</g>
<!-- expert_4_expert -->
<g id="node23" class="node">
<title>expert_4_expert</title>
<polygon fill="lightcoral" stroke="black" points="6455.5,-355.54 6159.5,-355.54 6159.5,-297.54 6455.5,-297.54 6455.5,-355.54"/>
<text text-anchor="middle" x="6307.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 4 Expert</text>
<text text-anchor="middle" x="6307.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="6307.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="6307.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_4_gate&#45;&gt;expert_4_expert -->
<g id="edge32" class="edge">
<title>expert_4_gate&#45;&gt;expert_4_expert</title>
<path fill="none" stroke="black" d="M6254.5,-391.31C6254.5,-391.31 6254.5,-365.75 6254.5,-365.75"/>
<polygon fill="black" stroke="black" points="6258,-365.75 6254.5,-355.75 6251,-365.75 6258,-365.75"/>
</g>
<!-- expert_4_multiply -->
<g id="node24" class="node">
<title>expert_4_multiply</title>
<polygon fill="lightcoral" stroke="black" points="7887,-261.54 7378,-261.54 7378,-203.54 7887,-203.54 7887,-261.54"/>
<text text-anchor="middle" x="7632.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 4 Multiply</text>
<text text-anchor="middle" x="7632.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="7632.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="7632.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_4_expert&#45;&gt;expert_4_multiply -->
<g id="edge33" class="edge">
<title>expert_4_expert&#45;&gt;expert_4_multiply</title>
<path fill="none" stroke="black" d="M6411.67,-297.38C6411.67,-294.72 6411.67,-293 6411.67,-293 6411.67,-293 7632.5,-293 7632.5,-293 7632.5,-293 7632.5,-271.71 7632.5,-271.71"/>
<polygon fill="black" stroke="black" points="7636,-271.71 7632.5,-261.71 7629,-271.71 7636,-271.71"/>
</g>
<!-- expert_4_multiply&#45;&gt;token_gather -->
<g id="edge34" class="edge">
<title>expert_4_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M7547.67,-203.43C7547.67,-167.47 7547.67,-111 7547.67,-111 7547.67,-111 4127.03,-111 4127.03,-111"/>
<polygon fill="black" stroke="black" points="4127.03,-107.5 4117.03,-111 4127.03,-114.5 4127.03,-107.5"/>
</g>
<!-- expert_4_multiply&#45;&gt;token_gather -->
<g id="edge95" class="edge">
<title>expert_4_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M7717.33,-203.51C7717.33,-166.15 7717.33,-106 7717.33,-106 7717.33,-106 4105.82,-106 4105.82,-106"/>
<polygon fill="black" stroke="black" points="4105.82,-102.5 4095.82,-106 4105.82,-109.5 4105.82,-102.5"/>
</g>
<!-- expert_5_expert -->
<g id="node26" class="node">
<title>expert_5_expert</title>
<polygon fill="lightcoral" stroke="black" points="6769.5,-355.54 6473.5,-355.54 6473.5,-297.54 6769.5,-297.54 6769.5,-355.54"/>
<text text-anchor="middle" x="6621.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 5 Expert</text>
<text text-anchor="middle" x="6621.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="6621.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="6621.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_5_gate&#45;&gt;expert_5_expert -->
<g id="edge37" class="edge">
<title>expert_5_gate&#45;&gt;expert_5_expert</title>
<path fill="none" stroke="black" d="M6572.5,-391.31C6572.5,-391.31 6572.5,-365.75 6572.5,-365.75"/>
<polygon fill="black" stroke="black" points="6576,-365.75 6572.5,-355.75 6569,-365.75 6576,-365.75"/>
</g>
<!-- expert_5_multiply -->
<g id="node27" class="node">
<title>expert_5_multiply</title>
<polygon fill="lightcoral" stroke="black" points="8414,-261.54 7905,-261.54 7905,-203.54 8414,-203.54 8414,-261.54"/>
<text text-anchor="middle" x="8159.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 5 Multiply</text>
<text text-anchor="middle" x="8159.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="8159.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="8159.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_5_expert&#45;&gt;expert_5_multiply -->
<g id="edge38" class="edge">
<title>expert_5_expert&#45;&gt;expert_5_multiply</title>
<path fill="none" stroke="black" d="M6769.67,-326C7155.13,-326 8159.5,-326 8159.5,-326 8159.5,-326 8159.5,-271.6 8159.5,-271.6"/>
<polygon fill="black" stroke="black" points="8163,-271.6 8159.5,-261.6 8156,-271.6 8163,-271.6"/>
</g>
<!-- expert_5_multiply&#45;&gt;token_gather -->
<g id="edge39" class="edge">
<title>expert_5_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M8074.67,-203.24C8074.67,-164.76 8074.67,-102 8074.67,-102 8074.67,-102 4081.67,-102 4081.67,-102"/>
<polygon fill="black" stroke="black" points="4081.67,-98.5 4071.67,-102 4081.67,-105.5 4081.67,-98.5"/>
</g>
<!-- expert_5_multiply&#45;&gt;token_gather -->
<g id="edge96" class="edge">
<title>expert_5_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M8244.33,-203.35C8244.33,-163.78 8244.33,-98 8244.33,-98 8244.33,-98 4047.08,-98 4047.08,-98"/>
<polygon fill="black" stroke="black" points="4047.08,-94.5 4037.08,-98 4047.08,-101.5 4047.08,-94.5"/>
</g>
<!-- expert_6_expert -->
<g id="node29" class="node">
<title>expert_6_expert</title>
<polygon fill="lightcoral" stroke="black" points="1759.5,-355.54 1463.5,-355.54 1463.5,-297.54 1759.5,-297.54 1759.5,-355.54"/>
<text text-anchor="middle" x="1611.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 6 Expert</text>
<text text-anchor="middle" x="1611.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="1611.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="1611.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_6_gate&#45;&gt;expert_6_expert -->
<g id="edge42" class="edge">
<title>expert_6_gate&#45;&gt;expert_6_expert</title>
<path fill="none" stroke="black" d="M1648.5,-391.31C1648.5,-391.31 1648.5,-365.75 1648.5,-365.75"/>
<polygon fill="black" stroke="black" points="1652,-365.75 1648.5,-355.75 1645,-365.75 1652,-365.75"/>
</g>
<!-- expert_6_multiply -->
<g id="node30" class="node">
<title>expert_6_multiply</title>
<polygon fill="lightcoral" stroke="black" points="509,-261.54 0,-261.54 0,-203.54 509,-203.54 509,-261.54"/>
<text text-anchor="middle" x="254.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 6 Multiply</text>
<text text-anchor="middle" x="254.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="254.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="254.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_6_expert&#45;&gt;expert_6_multiply -->
<g id="edge43" class="edge">
<title>expert_6_expert&#45;&gt;expert_6_multiply</title>
<path fill="none" stroke="black" d="M1463.37,-326C1111.46,-326 254.5,-326 254.5,-326 254.5,-326 254.5,-271.6 254.5,-271.6"/>
<polygon fill="black" stroke="black" points="258,-271.6 254.5,-261.6 251,-271.6 258,-271.6"/>
</g>
<!-- expert_6_multiply&#45;&gt;token_gather -->
<g id="edge44" class="edge">
<title>expert_6_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M339.33,-203.42C339.33,-166.34 339.33,-107 339.33,-107 339.33,-107 3776.32,-107 3776.32,-107"/>
<polygon fill="black" stroke="black" points="3776.32,-110.5 3786.32,-107 3776.32,-103.5 3776.32,-110.5"/>
</g>
<!-- expert_6_multiply&#45;&gt;token_gather -->
<g id="edge97" class="edge">
<title>expert_6_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M169.67,-203.47C169.67,-165.28 169.67,-103 169.67,-103 169.67,-103 3798.35,-103 3798.35,-103"/>
<polygon fill="black" stroke="black" points="3798.35,-106.5 3808.35,-103 3798.35,-99.5 3798.35,-106.5"/>
</g>
<!-- expert_7_expert -->
<g id="node32" class="node">
<title>expert_7_expert</title>
<polygon fill="lightcoral" stroke="black" points="2116.5,-355.54 1820.5,-355.54 1820.5,-297.54 2116.5,-297.54 2116.5,-355.54"/>
<text text-anchor="middle" x="1968.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 7 Expert</text>
<text text-anchor="middle" x="1968.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="1968.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="1968.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_7_gate&#45;&gt;expert_7_expert -->
<g id="edge47" class="edge">
<title>expert_7_gate&#45;&gt;expert_7_expert</title>
<path fill="none" stroke="black" d="M1988,-391.31C1988,-391.31 1988,-365.75 1988,-365.75"/>
<polygon fill="black" stroke="black" points="1991.5,-365.75 1988,-355.75 1984.5,-365.75 1991.5,-365.75"/>
</g>
<!-- expert_7_multiply -->
<g id="node33" class="node">
<title>expert_7_multiply</title>
<polygon fill="lightcoral" stroke="black" points="1036,-261.54 527,-261.54 527,-203.54 1036,-203.54 1036,-261.54"/>
<text text-anchor="middle" x="781.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 7 Multiply</text>
<text text-anchor="middle" x="781.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="781.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="781.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_7_expert&#45;&gt;expert_7_multiply -->
<g id="edge48" class="edge">
<title>expert_7_expert&#45;&gt;expert_7_multiply</title>
<path fill="none" stroke="black" d="M1831,-355.84C1831,-367.85 1831,-379 1831,-379 1831,-379 1010,-379 1010,-379 1010,-379 1010,-271.83 1010,-271.83"/>
<polygon fill="black" stroke="black" points="1013.5,-271.83 1010,-261.83 1006.5,-271.83 1013.5,-271.83"/>
</g>
<!-- expert_7_multiply&#45;&gt;token_gather -->
<g id="edge49" class="edge">
<title>expert_7_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M866.33,-203.43C866.33,-168.91 866.33,-116 866.33,-116 866.33,-116 3744.78,-116 3744.78,-116"/>
<polygon fill="black" stroke="black" points="3744.78,-119.5 3754.78,-116 3744.78,-112.5 3744.78,-119.5"/>
</g>
<!-- expert_7_multiply&#45;&gt;token_gather -->
<g id="edge98" class="edge">
<title>expert_7_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M696.67,-203.36C696.67,-167.69 696.67,-112 696.67,-112 696.67,-112 3756.34,-112 3756.34,-112"/>
<polygon fill="black" stroke="black" points="3756.34,-115.5 3766.34,-112 3756.34,-108.5 3756.34,-115.5"/>
</g>
<!-- expert_8_expert -->
<g id="node35" class="node">
<title>expert_8_expert</title>
<polygon fill="lightcoral" stroke="black" points="2455.5,-355.54 2159.5,-355.54 2159.5,-297.54 2455.5,-297.54 2455.5,-355.54"/>
<text text-anchor="middle" x="2307.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 8 Expert</text>
<text text-anchor="middle" x="2307.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2307.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="2307.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_8_gate&#45;&gt;expert_8_expert -->
<g id="edge52" class="edge">
<title>expert_8_gate&#45;&gt;expert_8_expert</title>
<path fill="none" stroke="black" d="M2318.5,-391.31C2318.5,-391.31 2318.5,-365.75 2318.5,-365.75"/>
<polygon fill="black" stroke="black" points="2322,-365.75 2318.5,-355.75 2315,-365.75 2322,-365.75"/>
</g>
<!-- expert_8_multiply -->
<g id="node36" class="node">
<title>expert_8_multiply</title>
<polygon fill="lightcoral" stroke="black" points="1563,-261.54 1054,-261.54 1054,-203.54 1563,-203.54 1563,-261.54"/>
<text text-anchor="middle" x="1308.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 8 Multiply</text>
<text text-anchor="middle" x="1308.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="1308.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="1308.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_8_expert&#45;&gt;expert_8_multiply -->
<g id="edge53" class="edge">
<title>expert_8_expert&#45;&gt;expert_8_multiply</title>
<path fill="none" stroke="black" d="M2307.5,-297.33C2307.5,-291.95 2307.5,-288 2307.5,-288 2307.5,-288 1513.25,-288 1513.25,-288 1513.25,-288 1513.25,-271.57 1513.25,-271.57"/>
<polygon fill="black" stroke="black" points="1516.75,-271.57 1513.25,-261.57 1509.75,-271.57 1516.75,-271.57"/>
</g>
<!-- expert_8_multiply&#45;&gt;token_gather -->
<g id="edge54" class="edge">
<title>expert_8_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M1393.33,-203.43C1393.33,-171.88 1393.33,-126 1393.33,-126 1393.33,-126 3729.39,-126 3729.39,-126"/>
<polygon fill="black" stroke="black" points="3729.39,-129.5 3739.39,-126 3729.39,-122.5 3729.39,-129.5"/>
</g>
<!-- expert_8_multiply&#45;&gt;token_gather -->
<g id="edge99" class="edge">
<title>expert_8_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M1223.67,-203.52C1223.67,-170.48 1223.67,-121 1223.67,-121 1223.67,-121 3734.88,-121 3734.88,-121"/>
<polygon fill="black" stroke="black" points="3734.88,-124.5 3744.88,-121 3734.88,-117.5 3734.88,-124.5"/>
</g>
<!-- expert_9_expert -->
<g id="node38" class="node">
<title>expert_9_expert</title>
<polygon fill="lightcoral" stroke="black" points="2786.5,-355.54 2490.5,-355.54 2490.5,-297.54 2786.5,-297.54 2786.5,-355.54"/>
<text text-anchor="middle" x="2638.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 9 Expert</text>
<text text-anchor="middle" x="2638.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="2638.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="2638.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_9_gate&#45;&gt;expert_9_expert -->
<g id="edge57" class="edge">
<title>expert_9_gate&#45;&gt;expert_9_expert</title>
<path fill="none" stroke="black" d="M2645,-391.31C2645,-391.31 2645,-365.75 2645,-365.75"/>
<polygon fill="black" stroke="black" points="2648.5,-365.75 2645,-355.75 2641.5,-365.75 2648.5,-365.75"/>
</g>
<!-- expert_9_multiply -->
<g id="node39" class="node">
<title>expert_9_multiply</title>
<polygon fill="lightcoral" stroke="black" points="2090,-261.54 1581,-261.54 1581,-203.54 2090,-203.54 2090,-261.54"/>
<text text-anchor="middle" x="1835.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 9 Multiply</text>
<text text-anchor="middle" x="1835.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1835.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="1835.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_9_expert&#45;&gt;expert_9_multiply -->
<g id="edge58" class="edge">
<title>expert_9_expert&#45;&gt;expert_9_multiply</title>
<path fill="none" stroke="black" d="M2532.67,-297.52C2532.67,-287.62 2532.67,-279 2532.67,-279 2532.67,-279 1955.25,-279 1955.25,-279 1955.25,-279 1955.25,-271.7 1955.25,-271.7"/>
<polygon fill="black" stroke="black" points="1958.75,-271.7 1955.25,-261.7 1951.75,-271.7 1958.75,-271.7"/>
</g>
<!-- expert_9_multiply&#45;&gt;token_gather -->
<g id="edge59" class="edge">
<title>expert_9_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M1997.33,-203.54C1997.33,-174.79 1997.33,-135 1997.33,-135 1997.33,-135 3728.9,-135 3728.9,-135"/>
<polygon fill="black" stroke="black" points="3728.9,-138.5 3738.9,-135 3728.9,-131.5 3728.9,-138.5"/>
</g>
<!-- expert_9_multiply&#45;&gt;token_gather -->
<g id="edge100" class="edge">
<title>expert_9_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M1904.67,-203.43C1904.67,-173.11 1904.67,-130 1904.67,-130 1904.67,-130 3727.73,-130 3727.73,-130"/>
<polygon fill="black" stroke="black" points="3727.73,-133.5 3737.73,-130 3727.73,-126.5 3727.73,-133.5"/>
</g>
<!-- expert_10_expert -->
<g id="node41" class="node">
<title>expert_10_expert</title>
<polygon fill="lightcoral" stroke="black" points="3112.5,-355.54 2816.5,-355.54 2816.5,-297.54 3112.5,-297.54 3112.5,-355.54"/>
<text text-anchor="middle" x="2964.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 10 Expert</text>
<text text-anchor="middle" x="2964.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2964.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="2964.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_10_gate&#45;&gt;expert_10_expert -->
<g id="edge62" class="edge">
<title>expert_10_gate&#45;&gt;expert_10_expert</title>
<path fill="none" stroke="black" d="M2969,-391.31C2969,-391.31 2969,-365.75 2969,-365.75"/>
<polygon fill="black" stroke="black" points="2972.5,-365.75 2969,-355.75 2965.5,-365.75 2972.5,-365.75"/>
</g>
<!-- expert_10_multiply -->
<g id="node42" class="node">
<title>expert_10_multiply</title>
<polygon fill="lightcoral" stroke="black" points="2617,-261.54 2108,-261.54 2108,-203.54 2617,-203.54 2617,-261.54"/>
<text text-anchor="middle" x="2362.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 10 Multiply</text>
<text text-anchor="middle" x="2362.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2362.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="2362.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_10_expert&#45;&gt;expert_10_multiply -->
<g id="edge63" class="edge">
<title>expert_10_expert&#45;&gt;expert_10_multiply</title>
<path fill="none" stroke="black" d="M2964.5,-297.28C2964.5,-283.48 2964.5,-270 2964.5,-270 2964.5,-270 2574.83,-270 2574.83,-270 2574.83,-270 2574.83,-269.17 2574.83,-269.17"/>
<polygon fill="black" stroke="black" points="2578.33,-271.69 2574.83,-261.69 2571.33,-271.69 2578.33,-271.69"/>
</g>
<!-- expert_10_multiply&#45;&gt;token_gather -->
<g id="edge64" class="edge">
<title>expert_10_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M2447.33,-203.06C2447.33,-177.3 2447.33,-144 2447.33,-144 2447.33,-144 3741.35,-144 3741.35,-144"/>
<polygon fill="black" stroke="black" points="3741.35,-147.5 3751.35,-144 3741.35,-140.5 3741.35,-147.5"/>
</g>
<!-- expert_10_multiply&#45;&gt;token_gather -->
<g id="edge101" class="edge">
<title>expert_10_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M2277.67,-203.46C2277.67,-176 2277.67,-139 2277.67,-139 2277.67,-139 3732.56,-139 3732.56,-139"/>
<polygon fill="black" stroke="black" points="3732.56,-142.5 3742.56,-139 3732.56,-135.5 3732.56,-142.5"/>
</g>
<!-- expert_11_expert -->
<g id="node44" class="node">
<title>expert_11_expert</title>
<polygon fill="lightcoral" stroke="black" points="3436.5,-355.54 3140.5,-355.54 3140.5,-297.54 3436.5,-297.54 3436.5,-355.54"/>
<text text-anchor="middle" x="3288.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 11 Expert</text>
<text text-anchor="middle" x="3288.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="3288.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="3288.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_11_gate&#45;&gt;expert_11_expert -->
<g id="edge67" class="edge">
<title>expert_11_gate&#45;&gt;expert_11_expert</title>
<path fill="none" stroke="black" d="M3292,-391.31C3292,-391.31 3292,-365.75 3292,-365.75"/>
<polygon fill="black" stroke="black" points="3295.5,-365.75 3292,-355.75 3288.5,-365.75 3295.5,-365.75"/>
</g>
<!-- expert_11_multiply -->
<g id="node45" class="node">
<title>expert_11_multiply</title>
<polygon fill="lightcoral" stroke="black" points="3144,-261.54 2635,-261.54 2635,-203.54 3144,-203.54 3144,-261.54"/>
<text text-anchor="middle" x="2889.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 11 Multiply</text>
<text text-anchor="middle" x="2889.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2889.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_11_expert&#45;&gt;expert_11_multiply -->
<g id="edge68" class="edge">
<title>expert_11_expert&#45;&gt;expert_11_multiply</title>
<path fill="none" stroke="black" d="M3140.46,-326C3136.97,-326 3135,-326 3135,-326 3135,-326 3135,-271.6 3135,-271.6"/>
<polygon fill="black" stroke="black" points="3138.5,-271.6 3135,-261.6 3131.5,-271.6 3138.5,-271.6"/>
</g>
<!-- expert_11_multiply&#45;&gt;token_gather -->
<g id="edge69" class="edge">
<title>expert_11_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M2974.33,-203.37C2974.33,-180.67 2974.33,-153 2974.33,-153 2974.33,-153 3769.37,-153 3769.37,-153"/>
<polygon fill="black" stroke="black" points="3769.37,-156.5 3779.37,-153 3769.37,-149.5 3769.37,-156.5"/>
</g>
<!-- expert_11_multiply&#45;&gt;token_gather -->
<g id="edge102" class="edge">
<title>expert_11_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M2804.67,-203.32C2804.67,-179.23 2804.67,-149 2804.67,-149 2804.67,-149 3754.62,-149 3754.62,-149"/>
<polygon fill="black" stroke="black" points="3754.62,-152.5 3764.62,-149 3754.62,-145.5 3754.62,-152.5"/>
</g>
<!-- expert_12_expert -->
<g id="node47" class="node">
<title>expert_12_expert</title>
<polygon fill="lightcoral" stroke="black" points="3759.5,-355.54 3463.5,-355.54 3463.5,-297.54 3759.5,-297.54 3759.5,-355.54"/>
<text text-anchor="middle" x="3611.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 12 Expert</text>
<text text-anchor="middle" x="3611.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3611.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="3611.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_12_gate&#45;&gt;expert_12_expert -->
<g id="edge72" class="edge">
<title>expert_12_gate&#45;&gt;expert_12_expert</title>
<path fill="none" stroke="black" d="M3614.5,-391.31C3614.5,-391.31 3614.5,-365.75 3614.5,-365.75"/>
<polygon fill="black" stroke="black" points="3618,-365.75 3614.5,-355.75 3611,-365.75 3618,-365.75"/>
</g>
<!-- expert_12_multiply -->
<g id="node48" class="node">
<title>expert_12_multiply</title>
<polygon fill="lightcoral" stroke="black" points="3671,-261.54 3162,-261.54 3162,-203.54 3671,-203.54 3671,-261.54"/>
<text text-anchor="middle" x="3416.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 12 Multiply</text>
<text text-anchor="middle" x="3416.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3416.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="3416.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_12_expert&#45;&gt;expert_12_multiply -->
<g id="edge73" class="edge">
<title>expert_12_expert&#45;&gt;expert_12_multiply</title>
<path fill="none" stroke="black" d="M3567.25,-297.31C3567.25,-297.31 3567.25,-271.75 3567.25,-271.75"/>
<polygon fill="black" stroke="black" points="3570.75,-271.75 3567.25,-261.75 3563.75,-271.75 3570.75,-271.75"/>
</g>
<!-- expert_12_multiply&#45;&gt;token_gather -->
<g id="edge74" class="edge">
<title>expert_12_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M3501.33,-203.44C3501.33,-184.01 3501.33,-162 3501.33,-162 3501.33,-162 3824.77,-162 3824.77,-162"/>
<polygon fill="black" stroke="black" points="3824.77,-165.5 3834.77,-162 3824.77,-158.5 3824.77,-165.5"/>
</g>
<!-- expert_12_multiply&#45;&gt;token_gather -->
<g id="edge103" class="edge">
<title>expert_12_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M3331.67,-203.51C3331.67,-182.58 3331.67,-158 3331.67,-158 3331.67,-158 3795.05,-158 3795.05,-158"/>
<polygon fill="black" stroke="black" points="3795.05,-161.5 3805.05,-158 3795.05,-154.5 3795.05,-161.5"/>
</g>
<!-- expert_13_expert -->
<g id="node50" class="node">
<title>expert_13_expert</title>
<polygon fill="lightcoral" stroke="black" points="4091.5,-355.54 3795.5,-355.54 3795.5,-297.54 4091.5,-297.54 4091.5,-355.54"/>
<text text-anchor="middle" x="3943.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 13 Expert</text>
<text text-anchor="middle" x="3943.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3943.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="3943.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_13_gate&#45;&gt;expert_13_expert -->
<g id="edge77" class="edge">
<title>expert_13_gate&#45;&gt;expert_13_expert</title>
<path fill="none" stroke="black" d="M3943.5,-391.31C3943.5,-391.31 3943.5,-365.75 3943.5,-365.75"/>
<polygon fill="black" stroke="black" points="3947,-365.75 3943.5,-355.75 3940,-365.75 3947,-365.75"/>
</g>
<!-- expert_13_multiply -->
<g id="node51" class="node">
<title>expert_13_multiply</title>
<polygon fill="lightcoral" stroke="black" points="4198,-261.54 3689,-261.54 3689,-203.54 4198,-203.54 4198,-261.54"/>
<text text-anchor="middle" x="3943.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 13 Multiply</text>
<text text-anchor="middle" x="3943.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3943.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="3943.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_13_expert&#45;&gt;expert_13_multiply -->
<g id="edge78" class="edge">
<title>expert_13_expert&#45;&gt;expert_13_multiply</title>
<path fill="none" stroke="black" d="M3943.5,-297.31C3943.5,-297.31 3943.5,-271.75 3943.5,-271.75"/>
<polygon fill="black" stroke="black" points="3947,-271.75 3943.5,-261.75 3940,-271.75 3947,-271.75"/>
</g>
<!-- expert_13_multiply&#45;&gt;token_gather -->
<g id="edge79" class="edge">
<title>expert_13_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M3874.91,-203.38C3874.91,-203.38 3874.91,-175.71 3874.91,-175.71"/>
<polygon fill="black" stroke="black" points="3878.41,-175.71 3874.91,-165.71 3871.41,-175.71 3878.41,-175.71"/>
</g>
<!-- expert_13_multiply&#45;&gt;token_gather -->
<g id="edge104" class="edge">
<title>expert_13_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M4012.09,-203.38C4012.09,-203.38 4012.09,-175.71 4012.09,-175.71"/>
<polygon fill="black" stroke="black" points="4015.59,-175.71 4012.09,-165.71 4008.59,-175.71 4015.59,-175.71"/>
</g>
<!-- expert_14_expert -->
<g id="node53" class="node">
<title>expert_14_expert</title>
<polygon fill="lightcoral" stroke="black" points="4516.5,-355.54 4220.5,-355.54 4220.5,-297.54 4516.5,-297.54 4516.5,-355.54"/>
<text text-anchor="middle" x="4368.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 14 Expert</text>
<text text-anchor="middle" x="4368.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4368.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="4368.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_14_gate&#45;&gt;expert_14_expert -->
<g id="edge82" class="edge">
<title>expert_14_gate&#45;&gt;expert_14_expert</title>
<path fill="none" stroke="black" d="M4319,-391.31C4319,-391.31 4319,-365.75 4319,-365.75"/>
<polygon fill="black" stroke="black" points="4322.5,-365.75 4319,-355.75 4315.5,-365.75 4322.5,-365.75"/>
</g>
<!-- expert_14_multiply -->
<g id="node54" class="node">
<title>expert_14_multiply</title>
<polygon fill="lightcoral" stroke="black" points="4725,-261.54 4216,-261.54 4216,-203.54 4725,-203.54 4725,-261.54"/>
<text text-anchor="middle" x="4470.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 14 Multiply</text>
<text text-anchor="middle" x="4470.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4470.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="4470.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_14_expert&#45;&gt;expert_14_multiply -->
<g id="edge83" class="edge">
<title>expert_14_expert&#45;&gt;expert_14_multiply</title>
<path fill="none" stroke="black" d="M4368.5,-297.31C4368.5,-297.31 4368.5,-271.75 4368.5,-271.75"/>
<polygon fill="black" stroke="black" points="4372,-271.75 4368.5,-261.75 4365,-271.75 4372,-271.75"/>
</g>
<!-- expert_14_multiply&#45;&gt;token_gather -->
<g id="edge84" class="edge">
<title>expert_14_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M4385.67,-203.45C4385.67,-184.4 4385.67,-163 4385.67,-163 4385.67,-163 4052.73,-163 4052.73,-163"/>
<polygon fill="black" stroke="black" points="4052.73,-159.5 4042.73,-163 4052.73,-166.5 4052.73,-159.5"/>
</g>
<!-- expert_14_multiply&#45;&gt;token_gather -->
<g id="edge105" class="edge">
<title>expert_14_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M4555.33,-203.51C4555.33,-182.58 4555.33,-158 4555.33,-158 4555.33,-158 4091.95,-158 4091.95,-158"/>
<polygon fill="black" stroke="black" points="4091.95,-154.5 4081.95,-158 4091.95,-161.5 4091.95,-154.5"/>
</g>
<!-- expert_15_expert -->
<g id="node56" class="node">
<title>expert_15_expert</title>
<polygon fill="lightcoral" stroke="black" points="4858.5,-355.54 4562.5,-355.54 4562.5,-297.54 4858.5,-297.54 4858.5,-355.54"/>
<text text-anchor="middle" x="4710.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 15 Expert</text>
<text text-anchor="middle" x="4710.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4710.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="4710.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_15_gate&#45;&gt;expert_15_expert -->
<g id="edge87" class="edge">
<title>expert_15_gate&#45;&gt;expert_15_expert</title>
<path fill="none" stroke="black" d="M4651,-391.31C4651,-391.31 4651,-365.75 4651,-365.75"/>
<polygon fill="black" stroke="black" points="4654.5,-365.75 4651,-355.75 4647.5,-365.75 4654.5,-365.75"/>
</g>
<!-- expert_15_multiply -->
<g id="node57" class="node">
<title>expert_15_multiply</title>
<polygon fill="lightcoral" stroke="black" points="5252,-261.54 4743,-261.54 4743,-203.54 5252,-203.54 5252,-261.54"/>
<text text-anchor="middle" x="4997.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 15 Multiply</text>
<text text-anchor="middle" x="4997.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4997.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=7168], [batch_size=?, seq_len=?, expert_hidden=2048]</text>
<text text-anchor="middle" x="4997.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
</g>
<!-- expert_15_expert&#45;&gt;expert_15_multiply -->
<g id="edge88" class="edge">
<title>expert_15_expert&#45;&gt;expert_15_multiply</title>
<path fill="none" stroke="black" d="M4800.75,-297.31C4800.75,-297.31 4800.75,-271.75 4800.75,-271.75"/>
<polygon fill="black" stroke="black" points="4804.25,-271.75 4800.75,-261.75 4797.25,-271.75 4804.25,-271.75"/>
</g>
<!-- expert_15_multiply&#45;&gt;token_gather -->
<g id="edge89" class="edge">
<title>expert_15_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M4912.67,-203.29C4912.67,-180.96 4912.67,-154 4912.67,-154 4912.67,-154 4113.27,-154 4113.27,-154"/>
<polygon fill="black" stroke="black" points="4113.27,-150.5 4103.27,-154 4113.27,-157.5 4113.27,-150.5"/>
</g>
<!-- expert_15_multiply&#45;&gt;token_gather -->
<g id="edge106" class="edge">
<title>expert_15_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M5082.33,-203.21C5082.33,-179.48 5082.33,-150 5082.33,-150 5082.33,-150 4128.95,-150 4128.95,-150"/>
<polygon fill="black" stroke="black" points="4128.95,-146.5 4118.95,-150 4128.95,-153.5 4128.95,-146.5"/>
</g>
<!-- token_gather&#45;&gt;layer_output -->
<g id="edge107" class="edge">
<title>token_gather&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M3850.01,-98C3474.54,-98 2096.5,-98 2096.5,-98 2096.5,-98 2096.5,-68.26 2096.5,-68.26"/>
<polygon fill="black" stroke="black" points="2100,-68.26 2096.5,-58.26 2093,-68.26 2100,-68.26"/>
</g>
</g>
</svg>
