<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Large_Scale_Cross_Node_Expert_Parallelism_32_Experts Pages: 1 -->
<svg width="14400pt" height="1069pt"
 viewBox="0.00 0.00 14400.00 1069.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.87 0.87) rotate(0) translate(4 1219.08)">
<title>Large_Scale_Cross_Node_Expert_Parallelism_32_Experts</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1219.08 16466,-1219.08 16466,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgray" stroke="black" points="3905,-1215.08 3614,-1215.08 3614,-1157.08 3905,-1157.08 3905,-1215.08"/>
<text text-anchor="middle" x="3759.5" y="-1200.08" font-family="Times,serif" font-size="10.00">Input Layer</text>
<text text-anchor="middle" x="3759.5" y="-1189.08" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
<text text-anchor="middle" x="3759.5" y="-1178.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3759.5" y="-1167.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- q_proj -->
<g id="node2" class="node">
<title>q_proj</title>
<polygon fill="lightblue" stroke="black" points="3402.5,-1121.08 3072.5,-1121.08 3072.5,-1063.08 3402.5,-1063.08 3402.5,-1121.08"/>
<text text-anchor="middle" x="3237.5" y="-1106.08" font-family="Times,serif" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="3237.5" y="-1095.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="3237.5" y="-1084.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3237.5" y="-1073.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
</g>
<!-- input&#45;&gt;q_proj -->
<g id="edge1" class="edge">
<title>input&#45;&gt;q_proj</title>
<path fill="none" stroke="black" d="M3613.75,-1186C3459.31,-1186 3237.5,-1186 3237.5,-1186 3237.5,-1186 3237.5,-1131.28 3237.5,-1131.28"/>
<polygon fill="black" stroke="black" points="3241,-1131.28 3237.5,-1121.28 3234,-1131.28 3241,-1131.28"/>
</g>
<!-- k_proj -->
<g id="node3" class="node">
<title>k_proj</title>
<polygon fill="lightblue" stroke="black" points="3750.5,-1121.08 3420.5,-1121.08 3420.5,-1063.08 3750.5,-1063.08 3750.5,-1121.08"/>
<text text-anchor="middle" x="3585.5" y="-1106.08" font-family="Times,serif" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="3585.5" y="-1095.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="3585.5" y="-1084.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3585.5" y="-1073.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
</g>
<!-- input&#45;&gt;k_proj -->
<g id="edge2" class="edge">
<title>input&#45;&gt;k_proj</title>
<path fill="none" stroke="black" d="M3682.25,-1156.85C3682.25,-1156.85 3682.25,-1131.29 3682.25,-1131.29"/>
<polygon fill="black" stroke="black" points="3685.75,-1131.29 3682.25,-1121.29 3678.75,-1131.29 3685.75,-1131.29"/>
</g>
<!-- v_proj -->
<g id="node4" class="node">
<title>v_proj</title>
<polygon fill="lightblue" stroke="black" points="4098.5,-1121.08 3768.5,-1121.08 3768.5,-1063.08 4098.5,-1063.08 4098.5,-1121.08"/>
<text text-anchor="middle" x="3933.5" y="-1106.08" font-family="Times,serif" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="3933.5" y="-1095.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="3933.5" y="-1084.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3933.5" y="-1073.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
</g>
<!-- input&#45;&gt;v_proj -->
<g id="edge3" class="edge">
<title>input&#45;&gt;v_proj</title>
<path fill="none" stroke="black" d="M3836.75,-1156.85C3836.75,-1156.85 3836.75,-1131.29 3836.75,-1131.29"/>
<polygon fill="black" stroke="black" points="3840.25,-1131.29 3836.75,-1121.29 3833.25,-1131.29 3840.25,-1131.29"/>
</g>
<!-- gating -->
<g id="node7" class="node">
<title>gating</title>
<polygon fill="lightyellow" stroke="black" points="4467.68,-839.08 3924.94,-839.08 3785.32,-735.08 4328.06,-735.08 4467.68,-839.08"/>
<text text-anchor="middle" x="4126.5" y="-801.08" font-family="Times,serif" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="4126.5" y="-790.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="4126.5" y="-779.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="4126.5" y="-768.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, experts=32, top_k=2]</text>
</g>
<!-- input&#45;&gt;gating -->
<g id="edge9" class="edge">
<title>input&#45;&gt;gating</title>
<path fill="none" stroke="black" d="M3759.5,-1157.05C3759.5,-1067.88 3759.5,-804 3759.5,-804 3759.5,-804 3867.64,-804 3867.64,-804"/>
<polygon fill="black" stroke="black" points="3867.64,-807.5 3877.64,-804 3867.64,-800.5 3867.64,-807.5"/>
</g>
<!-- attention -->
<g id="node5" class="node">
<title>attention</title>
<polygon fill="lightblue" stroke="black" points="3746.5,-1027.08 3424.5,-1027.08 3424.5,-969.08 3746.5,-969.08 3746.5,-1027.08"/>
<text text-anchor="middle" x="3585.5" y="-1012.08" font-family="Times,serif" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3585.5" y="-1001.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="3585.5" y="-990.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3585.5" y="-979.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- q_proj&#45;&gt;attention -->
<g id="edge4" class="edge">
<title>q_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M3390.75,-1062.83C3390.75,-1035.21 3390.75,-998 3390.75,-998 3390.75,-998 3414.23,-998 3414.23,-998"/>
<polygon fill="black" stroke="black" points="3414.23,-1001.5 3424.23,-998 3414.23,-994.5 3414.23,-1001.5"/>
</g>
<!-- k_proj&#45;&gt;attention -->
<g id="edge5" class="edge">
<title>k_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M3585.5,-1062.85C3585.5,-1062.85 3585.5,-1037.29 3585.5,-1037.29"/>
<polygon fill="black" stroke="black" points="3589,-1037.29 3585.5,-1027.29 3582,-1037.29 3589,-1037.29"/>
</g>
<!-- v_proj&#45;&gt;attention -->
<g id="edge6" class="edge">
<title>v_proj&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M3776.95,-1062.83C3776.95,-1035.21 3776.95,-998 3776.95,-998 3776.95,-998 3756.62,-998 3756.62,-998"/>
<polygon fill="black" stroke="black" points="3756.62,-994.5 3746.62,-998 3756.62,-1001.5 3756.62,-994.5"/>
</g>
<!-- mha_out_proj -->
<g id="node6" class="node">
<title>mha_out_proj</title>
<polygon fill="lightblue" stroke="black" points="3731,-933.08 3440,-933.08 3440,-875.08 3731,-875.08 3731,-933.08"/>
<text text-anchor="middle" x="3585.5" y="-918.08" font-family="Times,serif" font-size="10.00">MHA Output Projection</text>
<text text-anchor="middle" x="3585.5" y="-907.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="3585.5" y="-896.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3585.5" y="-885.08" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- attention&#45;&gt;mha_out_proj -->
<g id="edge7" class="edge">
<title>attention&#45;&gt;mha_out_proj</title>
<path fill="none" stroke="black" d="M3585.5,-968.85C3585.5,-968.85 3585.5,-943.29 3585.5,-943.29"/>
<polygon fill="black" stroke="black" points="3589,-943.29 3585.5,-933.29 3582,-943.29 3589,-943.29"/>
</g>
<!-- mha_out_proj&#45;&gt;gating -->
<g id="edge8" class="edge">
<title>mha_out_proj&#45;&gt;gating</title>
<path fill="none" stroke="black" d="M3703.5,-874.77C3703.5,-835.04 3703.5,-769 3703.5,-769 3703.5,-769 3820.7,-769 3820.7,-769"/>
<polygon fill="black" stroke="black" points="3820.7,-772.5 3830.7,-769 3820.7,-765.5 3820.7,-772.5"/>
</g>
<!-- layer_output -->
<g id="node107" class="node">
<title>layer_output</title>
<polygon fill="lightgray" stroke="black" points="4118,-58 3827,-58 3827,0 4118,0 4118,-58"/>
<text text-anchor="middle" x="3972.5" y="-43" font-family="Times,serif" font-size="10.00">Layer Output</text>
<text text-anchor="middle" x="3972.5" y="-32" font-family="Times,serif" font-size="10.00">GPU: ALL</text>
<text text-anchor="middle" x="3972.5" y="-21" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="3972.5" y="-10" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- mha_out_proj&#45;&gt;layer_output -->
<g id="edge173" class="edge">
<title>mha_out_proj&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M3667,-874.89C3667,-764.94 3667,-382 3667,-382 3667,-382 3822.5,-382 3822.5,-382 3822.5,-382 3822.5,-270 3822.5,-270 3822.5,-270 4107.33,-270 4107.33,-270 4107.33,-270 4107.33,-68.07 4107.33,-68.07"/>
<polygon fill="black" stroke="black" points="4110.83,-68.07 4107.33,-58.07 4103.83,-68.07 4110.83,-68.07"/>
</g>
<!-- routing -->
<g id="node8" class="node">
<title>routing</title>
<polygon fill="lightyellow" stroke="black" points="8205.1,-699.08 7676.01,-699.08 7539.9,-595.08 8068.99,-595.08 8205.1,-699.08"/>
<text text-anchor="middle" x="7872.5" y="-661.08" font-family="Times,serif" font-size="10.00">Token Routing Decision</text>
<text text-anchor="middle" x="7872.5" y="-650.08" font-family="Times,serif" font-size="10.00">GPU: Shared</text>
<text text-anchor="middle" x="7872.5" y="-639.08" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, experts=32, top_k=2]</text>
<text text-anchor="middle" x="7872.5" y="-628.08" font-family="Times,serif" font-size="10.00">Output: Routing decisions and token masks</text>
</g>
<!-- gating&#45;&gt;routing -->
<g id="edge10" class="edge">
<title>gating&#45;&gt;routing</title>
<path fill="none" stroke="black" d="M4368.8,-765.03C4368.8,-736.94 4368.8,-692 4368.8,-692 4368.8,-692 7656.73,-692 7656.73,-692"/>
<polygon fill="black" stroke="black" points="7656.73,-695.5 7666.73,-692 7656.73,-688.5 7656.73,-695.5"/>
</g>
<!-- token_scatter -->
<g id="node9" class="node">
<title>token_scatter</title>
<ellipse fill="lightgreen" stroke="black" cx="8005.5" cy="-522.31" rx="236.76" ry="36.54"/>
<text text-anchor="middle" x="8005.5" y="-536.31" font-family="Times,serif" font-size="10.00">Token Scatter Communication</text>
<text text-anchor="middle" x="8005.5" y="-525.31" font-family="Times,serif" font-size="10.00">GPU: All&#45;to&#45;all</text>
<text text-anchor="middle" x="8005.5" y="-514.31" font-family="Times,serif" font-size="10.00">Input: [batch_size=32, seq_len=2048, hidden=7168]</text>
<text text-anchor="middle" x="8005.5" y="-503.31" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168] per expert</text>
</g>
<!-- routing&#45;&gt;token_scatter -->
<g id="edge11" class="edge">
<title>routing&#45;&gt;token_scatter</title>
<path fill="none" stroke="black" d="M7986.96,-594.89C7986.96,-594.89 7986.96,-569.12 7986.96,-569.12"/>
<polygon fill="black" stroke="black" points="7990.46,-569.12 7986.96,-559.12 7983.46,-569.12 7990.46,-569.12"/>
</g>
<!-- expert_0_gate -->
<g id="node10" class="node">
<title>expert_0_gate</title>
<polygon fill="lightblue" stroke="black" points="11380,-449.54 11101,-449.54 11101,-391.54 11380,-391.54 11380,-449.54"/>
<text text-anchor="middle" x="11240.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 0 Gate</text>
<text text-anchor="middle" x="11240.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="11240.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="11240.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_0_gate -->
<g id="edge16" class="edge">
<title>routing&#45;&gt;expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8156.65,-662C8976.33,-662 11287,-662 11287,-662 11287,-662 11287,-459.66 11287,-459.66"/>
<polygon fill="black" stroke="black" points="11290.5,-459.66 11287,-449.66 11283.5,-459.66 11290.5,-459.66"/>
</g>
<!-- expert_1_gate -->
<g id="node13" class="node">
<title>expert_1_gate</title>
<polygon fill="lightblue" stroke="black" points="11677,-449.54 11398,-449.54 11398,-391.54 11677,-391.54 11677,-449.54"/>
<text text-anchor="middle" x="11537.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 1 Gate</text>
<text text-anchor="middle" x="11537.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="11537.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="11537.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_1_gate -->
<g id="edge21" class="edge">
<title>routing&#45;&gt;expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8164.51,-668C9040.19,-668 11584,-668 11584,-668 11584,-668 11584,-459.9 11584,-459.9"/>
<polygon fill="black" stroke="black" points="11587.5,-459.9 11584,-449.9 11580.5,-459.9 11587.5,-459.9"/>
</g>
<!-- expert_2_gate -->
<g id="node16" class="node">
<title>expert_2_gate</title>
<polygon fill="lightblue" stroke="black" points="11974,-449.54 11695,-449.54 11695,-391.54 11974,-391.54 11974,-449.54"/>
<text text-anchor="middle" x="11834.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 2 Gate</text>
<text text-anchor="middle" x="11834.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="11834.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="11834.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_2_gate -->
<g id="edge26" class="edge">
<title>routing&#45;&gt;expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8172.56,-674C9103.57,-674 11881,-674 11881,-674 11881,-674 11881,-459.61 11881,-459.61"/>
<polygon fill="black" stroke="black" points="11884.5,-459.61 11881,-449.61 11877.5,-459.61 11884.5,-459.61"/>
</g>
<!-- expert_3_gate -->
<g id="node19" class="node">
<title>expert_3_gate</title>
<polygon fill="lightblue" stroke="black" points="12271,-449.54 11992,-449.54 11992,-391.54 12271,-391.54 12271,-449.54"/>
<text text-anchor="middle" x="12131.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 3 Gate</text>
<text text-anchor="middle" x="12131.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="12131.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="12131.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_3_gate -->
<g id="edge31" class="edge">
<title>routing&#45;&gt;expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8180.41,-680C9165.84,-680 12178,-680 12178,-680 12178,-680 12178,-459.55 12178,-459.55"/>
<polygon fill="black" stroke="black" points="12181.5,-459.55 12178,-449.55 12174.5,-459.55 12181.5,-459.55"/>
</g>
<!-- expert_4_gate -->
<g id="node22" class="node">
<title>expert_4_gate</title>
<polygon fill="lightblue" stroke="black" points="12568,-449.54 12289,-449.54 12289,-391.54 12568,-391.54 12568,-449.54"/>
<text text-anchor="middle" x="12428.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 4 Gate</text>
<text text-anchor="middle" x="12428.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="12428.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="12428.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_4_gate -->
<g id="edge36" class="edge">
<title>routing&#45;&gt;expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8188.4,-686C9227.74,-686 12475,-686 12475,-686 12475,-686 12475,-459.71 12475,-459.71"/>
<polygon fill="black" stroke="black" points="12478.5,-459.71 12475,-449.71 12471.5,-459.71 12478.5,-459.71"/>
</g>
<!-- expert_5_gate -->
<g id="node25" class="node">
<title>expert_5_gate</title>
<polygon fill="lightblue" stroke="black" points="12865,-449.54 12586,-449.54 12586,-391.54 12865,-391.54 12865,-449.54"/>
<text text-anchor="middle" x="12725.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 5 Gate</text>
<text text-anchor="middle" x="12725.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="12725.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="12725.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_5_gate -->
<g id="edge41" class="edge">
<title>routing&#45;&gt;expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8195.86,-692C9288.01,-692 12772,-692 12772,-692 12772,-692 12772,-459.59 12772,-459.59"/>
<polygon fill="black" stroke="black" points="12775.5,-459.59 12772,-449.59 12768.5,-459.59 12775.5,-459.59"/>
</g>
<!-- expert_6_gate -->
<g id="node28" class="node">
<title>expert_6_gate</title>
<polygon fill="lightblue" stroke="black" points="3658,-449.54 3379,-449.54 3379,-391.54 3658,-391.54 3658,-449.54"/>
<text text-anchor="middle" x="3518.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 6 Gate</text>
<text text-anchor="middle" x="3518.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="3518.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="3518.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_6_gate -->
<g id="edge46" class="edge">
<title>routing&#45;&gt;expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7658.89,-686C6783.02,-686 3512.67,-686 3512.67,-686 3512.67,-686 3512.67,-459.71 3512.67,-459.71"/>
<polygon fill="black" stroke="black" points="3516.17,-459.71 3512.67,-449.71 3509.17,-459.71 3516.17,-459.71"/>
</g>
<!-- expert_7_gate -->
<g id="node31" class="node">
<title>expert_7_gate</title>
<polygon fill="lightblue" stroke="black" points="3955,-449.54 3676,-449.54 3676,-391.54 3955,-391.54 3955,-449.54"/>
<text text-anchor="middle" x="3815.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 7 Gate</text>
<text text-anchor="middle" x="3815.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3815.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="3815.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_7_gate -->
<g id="edge51" class="edge">
<title>routing&#45;&gt;expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7649.7,-679C6804.25,-679 3841.94,-679 3841.94,-679 3841.94,-679 3841.94,-459.69 3841.94,-459.69"/>
<polygon fill="black" stroke="black" points="3845.44,-459.69 3841.94,-449.69 3838.44,-459.69 3845.44,-459.69"/>
</g>
<!-- expert_8_gate -->
<g id="node34" class="node">
<title>expert_8_gate</title>
<polygon fill="lightblue" stroke="black" points="4252,-449.54 3973,-449.54 3973,-391.54 4252,-391.54 4252,-449.54"/>
<text text-anchor="middle" x="4112.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 8 Gate</text>
<text text-anchor="middle" x="4112.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="4112.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="4112.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_8_gate -->
<g id="edge56" class="edge">
<title>routing&#45;&gt;expert_8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7641.54,-673C6816.83,-673 4066,-673 4066,-673 4066,-673 4066,-459.99 4066,-459.99"/>
<polygon fill="black" stroke="black" points="4069.5,-459.99 4066,-449.99 4062.5,-459.99 4069.5,-459.99"/>
</g>
<!-- expert_9_gate -->
<g id="node37" class="node">
<title>expert_9_gate</title>
<polygon fill="lightblue" stroke="black" points="4549,-449.54 4270,-449.54 4270,-391.54 4549,-391.54 4549,-449.54"/>
<text text-anchor="middle" x="4409.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 9 Gate</text>
<text text-anchor="middle" x="4409.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="4409.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="4409.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_9_gate -->
<g id="edge61" class="edge">
<title>routing&#45;&gt;expert_9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7632.62,-666C6861.29,-666 4494.73,-666 4494.73,-666 4494.73,-666 4494.73,-459.66 4494.73,-459.66"/>
<polygon fill="black" stroke="black" points="4498.23,-459.66 4494.73,-449.66 4491.23,-459.66 4498.23,-459.66"/>
</g>
<!-- expert_10_gate -->
<g id="node40" class="node">
<title>expert_10_gate</title>
<polygon fill="lightblue" stroke="black" points="4846,-449.54 4567,-449.54 4567,-391.54 4846,-391.54 4846,-449.54"/>
<text text-anchor="middle" x="4706.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 10 Gate</text>
<text text-anchor="middle" x="4706.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4706.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="4706.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_10_gate -->
<g id="edge66" class="edge">
<title>routing&#45;&gt;expert_10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7624.76,-660C6871.56,-660 4660,-660 4660,-660 4660,-660 4660,-459.9 4660,-459.9"/>
<polygon fill="black" stroke="black" points="4663.5,-459.9 4660,-449.9 4656.5,-459.9 4663.5,-459.9"/>
</g>
<!-- expert_11_gate -->
<g id="node43" class="node">
<title>expert_11_gate</title>
<polygon fill="lightblue" stroke="black" points="5143,-449.54 4864,-449.54 4864,-391.54 5143,-391.54 5143,-449.54"/>
<text text-anchor="middle" x="5003.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 11 Gate</text>
<text text-anchor="middle" x="5003.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="5003.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="5003.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_11_gate -->
<g id="edge71" class="edge">
<title>routing&#45;&gt;expert_11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7615.69,-653C6903.72,-653 4957,-653 4957,-653 4957,-653 4957,-459.98 4957,-459.98"/>
<polygon fill="black" stroke="black" points="4960.5,-459.98 4957,-449.98 4953.5,-459.98 4960.5,-459.98"/>
</g>
<!-- expert_12_gate -->
<g id="node46" class="node">
<title>expert_12_gate</title>
<polygon fill="lightblue" stroke="black" points="5440,-449.54 5161,-449.54 5161,-391.54 5440,-391.54 5440,-449.54"/>
<text text-anchor="middle" x="5300.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 12 Gate</text>
<text text-anchor="middle" x="5300.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="5300.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="5300.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_12_gate -->
<g id="edge76" class="edge">
<title>routing&#45;&gt;expert_12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7607.62,-647C6942.34,-647 5254,-647 5254,-647 5254,-647 5254,-459.68 5254,-459.68"/>
<polygon fill="black" stroke="black" points="5257.5,-459.68 5254,-449.68 5250.5,-459.68 5257.5,-459.68"/>
</g>
<!-- expert_13_gate -->
<g id="node49" class="node">
<title>expert_13_gate</title>
<polygon fill="lightblue" stroke="black" points="5737,-449.54 5458,-449.54 5458,-391.54 5737,-391.54 5737,-449.54"/>
<text text-anchor="middle" x="5597.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 13 Gate</text>
<text text-anchor="middle" x="5597.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5597.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="5597.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_13_gate -->
<g id="edge81" class="edge">
<title>routing&#45;&gt;expert_13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7598.51,-640C6984.36,-640 5551,-640 5551,-640 5551,-640 5551,-459.68 5551,-459.68"/>
<polygon fill="black" stroke="black" points="5554.5,-459.68 5551,-449.68 5547.5,-459.68 5554.5,-459.68"/>
</g>
<!-- expert_14_gate -->
<g id="node52" class="node">
<title>expert_14_gate</title>
<polygon fill="lightblue" stroke="black" points="6034,-449.54 5755,-449.54 5755,-391.54 6034,-391.54 6034,-449.54"/>
<text text-anchor="middle" x="5894.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 14 Gate</text>
<text text-anchor="middle" x="5894.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5894.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="5894.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_14_gate -->
<g id="edge86" class="edge">
<title>routing&#45;&gt;expert_14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7590.74,-634C7034.35,-634 5848,-634 5848,-634 5848,-634 5848,-459.77 5848,-459.77"/>
<polygon fill="black" stroke="black" points="5851.5,-459.77 5848,-449.77 5844.5,-459.77 5851.5,-459.77"/>
</g>
<!-- expert_15_gate -->
<g id="node55" class="node">
<title>expert_15_gate</title>
<polygon fill="lightblue" stroke="black" points="6331,-449.54 6052,-449.54 6052,-391.54 6331,-391.54 6331,-449.54"/>
<text text-anchor="middle" x="6191.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 15 Gate</text>
<text text-anchor="middle" x="6191.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="6191.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="6191.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_15_gate -->
<g id="edge91" class="edge">
<title>routing&#45;&gt;expert_15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7581.41,-627C7089.08,-627 6145,-627 6145,-627 6145,-627 6145,-459.68 6145,-459.68"/>
<polygon fill="black" stroke="black" points="6148.5,-459.68 6145,-449.68 6141.5,-459.68 6148.5,-459.68"/>
</g>
<!-- expert_16_gate -->
<g id="node58" class="node">
<title>expert_16_gate</title>
<polygon fill="lightblue" stroke="black" points="6628,-449.54 6349,-449.54 6349,-391.54 6628,-391.54 6628,-449.54"/>
<text text-anchor="middle" x="6488.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 16 Gate</text>
<text text-anchor="middle" x="6488.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="6488.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="6488.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_16_gate -->
<g id="edge96" class="edge">
<title>routing&#45;&gt;expert_16_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7573.49,-621C7154.14,-621 6442,-621 6442,-621 6442,-621 6442,-459.69 6442,-459.69"/>
<polygon fill="black" stroke="black" points="6445.5,-459.69 6442,-449.69 6438.5,-459.69 6445.5,-459.69"/>
</g>
<!-- expert_17_gate -->
<g id="node61" class="node">
<title>expert_17_gate</title>
<polygon fill="lightblue" stroke="black" points="6925,-449.54 6646,-449.54 6646,-391.54 6925,-391.54 6925,-449.54"/>
<text text-anchor="middle" x="6785.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 17 Gate</text>
<text text-anchor="middle" x="6785.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="6785.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="6785.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_17_gate -->
<g id="edge101" class="edge">
<title>routing&#45;&gt;expert_17_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7564.64,-614C7228.98,-614 6739,-614 6739,-614 6739,-614 6739,-459.92 6739,-459.92"/>
<polygon fill="black" stroke="black" points="6742.5,-459.92 6739,-449.92 6735.5,-459.92 6742.5,-459.92"/>
</g>
<!-- expert_18_gate -->
<g id="node64" class="node">
<title>expert_18_gate</title>
<polygon fill="lightblue" stroke="black" points="7222,-449.54 6943,-449.54 6943,-391.54 7222,-391.54 7222,-449.54"/>
<text text-anchor="middle" x="7082.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 18 Gate</text>
<text text-anchor="middle" x="7082.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="7082.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="7082.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_18_gate -->
<g id="edge106" class="edge">
<title>routing&#45;&gt;expert_18_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7556.55,-608C7319.61,-608 7036,-608 7036,-608 7036,-608 7036,-459.83 7036,-459.83"/>
<polygon fill="black" stroke="black" points="7039.5,-459.83 7036,-449.83 7032.5,-459.83 7039.5,-459.83"/>
</g>
<!-- expert_19_gate -->
<g id="node67" class="node">
<title>expert_19_gate</title>
<polygon fill="lightblue" stroke="black" points="7519,-449.54 7240,-449.54 7240,-391.54 7519,-391.54 7519,-449.54"/>
<text text-anchor="middle" x="7379.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 19 Gate</text>
<text text-anchor="middle" x="7379.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="7379.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="7379.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_19_gate -->
<g id="edge111" class="edge">
<title>routing&#45;&gt;expert_19_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7547.39,-601C7433.29,-601 7333,-601 7333,-601 7333,-601 7333,-459.93 7333,-459.93"/>
<polygon fill="black" stroke="black" points="7336.5,-459.93 7333,-449.93 7329.5,-459.93 7336.5,-459.93"/>
</g>
<!-- expert_20_gate -->
<g id="node70" class="node">
<title>expert_20_gate</title>
<polygon fill="lightblue" stroke="black" points="7816,-449.54 7537,-449.54 7537,-391.54 7816,-391.54 7816,-449.54"/>
<text text-anchor="middle" x="7676.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 20 Gate</text>
<text text-anchor="middle" x="7676.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="7676.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="7676.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_20_gate -->
<g id="edge116" class="edge">
<title>routing&#45;&gt;expert_20_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7616.01,-594.82C7616.01,-594.82 7616.01,-459.68 7616.01,-459.68"/>
<polygon fill="black" stroke="black" points="7619.51,-459.68 7616.01,-449.68 7612.51,-459.68 7619.51,-459.68"/>
</g>
<!-- expert_21_gate -->
<g id="node73" class="node">
<title>expert_21_gate</title>
<polygon fill="lightblue" stroke="black" points="8113,-449.54 7834,-449.54 7834,-391.54 8113,-391.54 8113,-449.54"/>
<text text-anchor="middle" x="7973.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 21 Gate</text>
<text text-anchor="middle" x="7973.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="7973.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="7973.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_21_gate -->
<g id="edge121" class="edge">
<title>routing&#45;&gt;expert_21_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7692.31,-594.99C7692.31,-541.81 7692.31,-467 7692.31,-467 7692.31,-467 7927,-467 7927,-467 7927,-467 7927,-459.7 7927,-459.7"/>
<polygon fill="black" stroke="black" points="7930.5,-459.7 7927,-449.7 7923.5,-459.7 7930.5,-459.7"/>
</g>
<!-- expert_22_gate -->
<g id="node76" class="node">
<title>expert_22_gate</title>
<polygon fill="lightblue" stroke="black" points="8410,-449.54 8131,-449.54 8131,-391.54 8410,-391.54 8410,-449.54"/>
<text text-anchor="middle" x="8270.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 22 Gate</text>
<text text-anchor="middle" x="8270.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="8270.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="8270.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_22_gate -->
<g id="edge126" class="edge">
<title>routing&#45;&gt;expert_22_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8076.78,-601C8197.2,-601 8326.19,-601 8326.19,-601 8326.19,-601 8326.19,-459.93 8326.19,-459.93"/>
<polygon fill="black" stroke="black" points="8329.69,-459.93 8326.19,-449.93 8322.69,-459.93 8329.69,-459.93"/>
</g>
<!-- expert_23_gate -->
<g id="node79" class="node">
<title>expert_23_gate</title>
<polygon fill="lightblue" stroke="black" points="8707,-449.54 8428,-449.54 8428,-391.54 8707,-391.54 8707,-449.54"/>
<text text-anchor="middle" x="8567.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 23 Gate</text>
<text text-anchor="middle" x="8567.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="8567.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="8567.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_23_gate -->
<g id="edge131" class="edge">
<title>routing&#45;&gt;expert_23_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8084.98,-607C8304.1,-607 8614,-607 8614,-607 8614,-607 8614,-459.67 8614,-459.67"/>
<polygon fill="black" stroke="black" points="8617.5,-459.67 8614,-449.67 8610.5,-459.67 8617.5,-459.67"/>
</g>
<!-- expert_24_gate -->
<g id="node82" class="node">
<title>expert_24_gate</title>
<polygon fill="lightblue" stroke="black" points="9004,-449.54 8725,-449.54 8725,-391.54 9004,-391.54 9004,-449.54"/>
<text text-anchor="middle" x="8864.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 24 Gate</text>
<text text-anchor="middle" x="8864.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="8864.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="8864.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_24_gate -->
<g id="edge136" class="edge">
<title>routing&#45;&gt;expert_24_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8092.74,-613C8397.58,-613 8911,-613 8911,-613 8911,-613 8911,-459.77 8911,-459.77"/>
<polygon fill="black" stroke="black" points="8914.5,-459.77 8911,-449.77 8907.5,-459.77 8914.5,-459.77"/>
</g>
<!-- expert_25_gate -->
<g id="node85" class="node">
<title>expert_25_gate</title>
<polygon fill="lightblue" stroke="black" points="9301,-449.54 9022,-449.54 9022,-391.54 9301,-391.54 9301,-449.54"/>
<text text-anchor="middle" x="9161.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 25 Gate</text>
<text text-anchor="middle" x="9161.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="9161.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="9161.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_25_gate -->
<g id="edge141" class="edge">
<title>routing&#45;&gt;expert_25_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8100.56,-619C8482,-619 9208,-619 9208,-619 9208,-619 9208,-459.82 9208,-459.82"/>
<polygon fill="black" stroke="black" points="9211.5,-459.82 9208,-449.82 9204.5,-459.82 9211.5,-459.82"/>
</g>
<!-- expert_26_gate -->
<g id="node88" class="node">
<title>expert_26_gate</title>
<polygon fill="lightblue" stroke="black" points="9598,-449.54 9319,-449.54 9319,-391.54 9598,-391.54 9598,-449.54"/>
<text text-anchor="middle" x="9458.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 26 Gate</text>
<text text-anchor="middle" x="9458.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="9458.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="9458.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_26_gate -->
<g id="edge146" class="edge">
<title>routing&#45;&gt;expert_26_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8108.57,-625C8560.83,-625 9505,-625 9505,-625 9505,-625 9505,-459.83 9505,-459.83"/>
<polygon fill="black" stroke="black" points="9508.5,-459.83 9505,-449.83 9501.5,-459.83 9508.5,-459.83"/>
</g>
<!-- expert_27_gate -->
<g id="node91" class="node">
<title>expert_27_gate</title>
<polygon fill="lightblue" stroke="black" points="9895,-449.54 9616,-449.54 9616,-391.54 9895,-391.54 9895,-449.54"/>
<text text-anchor="middle" x="9755.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 27 Gate</text>
<text text-anchor="middle" x="9755.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="9755.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="9755.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_27_gate -->
<g id="edge151" class="edge">
<title>routing&#45;&gt;expert_27_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8116.38,-631C8635.34,-631 9802,-631 9802,-631 9802,-631 9802,-459.8 9802,-459.8"/>
<polygon fill="black" stroke="black" points="9805.5,-459.8 9802,-449.8 9798.5,-459.8 9805.5,-459.8"/>
</g>
<!-- expert_28_gate -->
<g id="node94" class="node">
<title>expert_28_gate</title>
<polygon fill="lightblue" stroke="black" points="10192,-449.54 9913,-449.54 9913,-391.54 10192,-391.54 10192,-449.54"/>
<text text-anchor="middle" x="10052.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 28 Gate</text>
<text text-anchor="middle" x="10052.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="10052.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="10052.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_28_gate -->
<g id="edge156" class="edge">
<title>routing&#45;&gt;expert_28_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8124.12,-637C8706.73,-637 10099,-637 10099,-637 10099,-637 10099,-459.73 10099,-459.73"/>
<polygon fill="black" stroke="black" points="10102.5,-459.73 10099,-449.73 10095.5,-459.73 10102.5,-459.73"/>
</g>
<!-- expert_29_gate -->
<g id="node97" class="node">
<title>expert_29_gate</title>
<polygon fill="lightblue" stroke="black" points="10489,-449.54 10210,-449.54 10210,-391.54 10489,-391.54 10489,-449.54"/>
<text text-anchor="middle" x="10349.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 29 Gate</text>
<text text-anchor="middle" x="10349.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="10349.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="10349.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_29_gate -->
<g id="edge161" class="edge">
<title>routing&#45;&gt;expert_29_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8133.05,-644C8777.8,-644 10396,-644 10396,-644 10396,-644 10396,-459.75 10396,-459.75"/>
<polygon fill="black" stroke="black" points="10399.5,-459.75 10396,-449.75 10392.5,-459.75 10399.5,-459.75"/>
</g>
<!-- expert_30_gate -->
<g id="node100" class="node">
<title>expert_30_gate</title>
<polygon fill="lightblue" stroke="black" points="10786,-449.54 10507,-449.54 10507,-391.54 10786,-391.54 10786,-449.54"/>
<text text-anchor="middle" x="10646.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 30 Gate</text>
<text text-anchor="middle" x="10646.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="10646.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="10646.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_30_gate -->
<g id="edge166" class="edge">
<title>routing&#45;&gt;expert_30_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8141.03,-650C8845.55,-650 10693,-650 10693,-650 10693,-650 10693,-459.6 10693,-459.6"/>
<polygon fill="black" stroke="black" points="10696.5,-459.6 10693,-449.6 10689.5,-459.6 10696.5,-459.6"/>
</g>
<!-- expert_31_gate -->
<g id="node103" class="node">
<title>expert_31_gate</title>
<polygon fill="lightblue" stroke="black" points="11083,-449.54 10804,-449.54 10804,-391.54 11083,-391.54 11083,-449.54"/>
<text text-anchor="middle" x="10943.5" y="-434.54" font-family="Times,serif" font-size="10.00">Expert 31 Gate</text>
<text text-anchor="middle" x="10943.5" y="-423.54" font-family="Times,serif" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="10943.5" y="-412.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168]</text>
<text text-anchor="middle" x="10943.5" y="-401.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=2048]</text>
</g>
<!-- routing&#45;&gt;expert_31_gate -->
<g id="edge171" class="edge">
<title>routing&#45;&gt;expert_31_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8148.82,-656C8911.51,-656 10990,-656 10990,-656 10990,-656 10990,-459.88 10990,-459.88"/>
<polygon fill="black" stroke="black" points="10993.5,-459.88 10990,-449.88 10986.5,-459.88 10993.5,-459.88"/>
</g>
<!-- token_scatter&#45;&gt;expert_0_gate -->
<g id="edge12" class="edge">
<title>token_scatter&#45;&gt;expert_0_gate</title>
<path fill="none" stroke="black" d="M8235.77,-531C8967.86,-531 11194,-531 11194,-531 11194,-531 11194,-459.56 11194,-459.56"/>
<polygon fill="black" stroke="black" points="11197.5,-459.56 11194,-449.56 11190.5,-459.56 11197.5,-459.56"/>
</g>
<!-- token_scatter&#45;&gt;expert_1_gate -->
<g id="edge17" class="edge">
<title>token_scatter&#45;&gt;expert_1_gate</title>
<path fill="none" stroke="black" d="M8225.52,-536C8990.92,-536 11491,-536 11491,-536 11491,-536 11491,-459.67 11491,-459.67"/>
<polygon fill="black" stroke="black" points="11494.5,-459.67 11491,-449.67 11487.5,-459.67 11494.5,-459.67"/>
</g>
<!-- token_scatter&#45;&gt;expert_2_gate -->
<g id="edge22" class="edge">
<title>token_scatter&#45;&gt;expert_2_gate</title>
<path fill="none" stroke="black" d="M8213.24,-540C9004.83,-540 11788,-540 11788,-540 11788,-540 11788,-459.76 11788,-459.76"/>
<polygon fill="black" stroke="black" points="11791.5,-459.76 11788,-449.76 11784.5,-459.76 11791.5,-459.76"/>
</g>
<!-- token_scatter&#45;&gt;expert_3_gate -->
<g id="edge27" class="edge">
<title>token_scatter&#45;&gt;expert_3_gate</title>
<path fill="none" stroke="black" d="M8192.06,-545C8991.19,-545 12085,-545 12085,-545 12085,-545 12085,-459.72 12085,-459.72"/>
<polygon fill="black" stroke="black" points="12088.5,-459.72 12085,-449.72 12081.5,-459.72 12088.5,-459.72"/>
</g>
<!-- token_scatter&#45;&gt;expert_4_gate -->
<g id="edge32" class="edge">
<title>token_scatter&#45;&gt;expert_4_gate</title>
<path fill="none" stroke="black" d="M8168.75,-549C8962.65,-549 12382,-549 12382,-549 12382,-549 12382,-459.69 12382,-459.69"/>
<polygon fill="black" stroke="black" points="12385.5,-459.69 12382,-449.69 12378.5,-459.69 12385.5,-459.69"/>
</g>
<!-- token_scatter&#45;&gt;expert_5_gate -->
<g id="edge37" class="edge">
<title>token_scatter&#45;&gt;expert_5_gate</title>
<path fill="none" stroke="black" d="M8125.72,-554C8857.23,-554 12679,-554 12679,-554 12679,-554 12679,-459.83 12679,-459.83"/>
<polygon fill="black" stroke="black" points="12682.5,-459.83 12679,-449.83 12675.5,-459.83 12682.5,-459.83"/>
</g>
<!-- token_scatter&#45;&gt;expert_6_gate -->
<g id="edge42" class="edge">
<title>token_scatter&#45;&gt;expert_6_gate</title>
<path fill="none" stroke="black" d="M7885.27,-554C7177.53,-554 3585.33,-554 3585.33,-554 3585.33,-554 3585.33,-459.83 3585.33,-459.83"/>
<polygon fill="black" stroke="black" points="3588.83,-459.83 3585.33,-449.83 3581.83,-459.83 3588.83,-459.83"/>
</g>
<!-- token_scatter&#45;&gt;expert_7_gate -->
<g id="edge47" class="edge">
<title>token_scatter&#45;&gt;expert_7_gate</title>
<path fill="none" stroke="black" d="M7842.28,-549C7078.99,-549 3898.47,-549 3898.47,-549 3898.47,-549 3898.47,-459.69 3898.47,-459.69"/>
<polygon fill="black" stroke="black" points="3901.97,-459.69 3898.47,-449.69 3894.97,-459.69 3901.97,-459.69"/>
</g>
<!-- token_scatter&#45;&gt;expert_8_gate -->
<g id="edge52" class="edge">
<title>token_scatter&#45;&gt;expert_8_gate</title>
<path fill="none" stroke="black" d="M7814.09,-544C7036.98,-544 4159,-544 4159,-544 4159,-544 4159,-459.8 4159,-459.8"/>
<polygon fill="black" stroke="black" points="4162.5,-459.8 4159,-449.8 4155.5,-459.8 4162.5,-459.8"/>
</g>
<!-- token_scatter&#45;&gt;expert_9_gate -->
<g id="edge57" class="edge">
<title>token_scatter&#45;&gt;expert_9_gate</title>
<path fill="none" stroke="black" d="M7794.13,-539C7039.37,-539 4521.86,-539 4521.86,-539 4521.86,-539 4521.86,-459.82 4521.86,-459.82"/>
<polygon fill="black" stroke="black" points="4525.36,-459.82 4521.86,-449.82 4518.36,-459.82 4525.36,-459.82"/>
</g>
<!-- token_scatter&#45;&gt;expert_10_gate -->
<g id="edge62" class="edge">
<title>token_scatter&#45;&gt;expert_10_gate</title>
<path fill="none" stroke="black" d="M7780.66,-534C7044.44,-534 4753,-534 4753,-534 4753,-534 4753,-459.76 4753,-459.76"/>
<polygon fill="black" stroke="black" points="4756.5,-459.76 4753,-449.76 4749.5,-459.76 4756.5,-459.76"/>
</g>
<!-- token_scatter&#45;&gt;expert_11_gate -->
<g id="edge67" class="edge">
<title>token_scatter&#45;&gt;expert_11_gate</title>
<path fill="none" stroke="black" d="M7772.35,-529C7074.47,-529 5050,-529 5050,-529 5050,-529 5050,-459.6 5050,-459.6"/>
<polygon fill="black" stroke="black" points="5053.5,-459.6 5050,-449.6 5046.5,-459.6 5053.5,-459.6"/>
</g>
<!-- token_scatter&#45;&gt;expert_12_gate -->
<g id="edge72" class="edge">
<title>token_scatter&#45;&gt;expert_12_gate</title>
<path fill="none" stroke="black" d="M7768.7,-524C7117.35,-524 5347,-524 5347,-524 5347,-524 5347,-459.63 5347,-459.63"/>
<polygon fill="black" stroke="black" points="5350.5,-459.63 5347,-449.63 5343.5,-459.63 5350.5,-459.63"/>
</g>
<!-- token_scatter&#45;&gt;expert_13_gate -->
<g id="edge77" class="edge">
<title>token_scatter&#45;&gt;expert_13_gate</title>
<path fill="none" stroke="black" d="M7769.35,-519C7171.27,-519 5644,-519 5644,-519 5644,-519 5644,-459.55 5644,-459.55"/>
<polygon fill="black" stroke="black" points="5647.5,-459.55 5644,-449.55 5640.5,-459.55 5647.5,-459.55"/>
</g>
<!-- token_scatter&#45;&gt;expert_14_gate -->
<g id="edge82" class="edge">
<title>token_scatter&#45;&gt;expert_14_gate</title>
<path fill="none" stroke="black" d="M7774.68,-514C7235.96,-514 5941,-514 5941,-514 5941,-514 5941,-459.6 5941,-459.6"/>
<polygon fill="black" stroke="black" points="5944.5,-459.6 5941,-449.6 5937.5,-459.6 5944.5,-459.6"/>
</g>
<!-- token_scatter&#45;&gt;expert_15_gate -->
<g id="edge87" class="edge">
<title>token_scatter&#45;&gt;expert_15_gate</title>
<path fill="none" stroke="black" d="M7782.09,-510C7306.71,-510 6238,-510 6238,-510 6238,-510 6238,-459.83 6238,-459.83"/>
<polygon fill="black" stroke="black" points="6241.5,-459.83 6238,-449.83 6234.5,-459.83 6241.5,-459.83"/>
</g>
<!-- token_scatter&#45;&gt;expert_16_gate -->
<g id="edge92" class="edge">
<title>token_scatter&#45;&gt;expert_16_gate</title>
<path fill="none" stroke="black" d="M7796.37,-505C7390.4,-505 6535,-505 6535,-505 6535,-505 6535,-459.61 6535,-459.61"/>
<polygon fill="black" stroke="black" points="6538.5,-459.61 6535,-449.61 6531.5,-459.61 6538.5,-459.61"/>
</g>
<!-- token_scatter&#45;&gt;expert_17_gate -->
<g id="edge97" class="edge">
<title>token_scatter&#45;&gt;expert_17_gate</title>
<path fill="none" stroke="black" d="M7816.96,-500C7485.24,-500 6832,-500 6832,-500 6832,-500 6832,-459.68 6832,-459.68"/>
<polygon fill="black" stroke="black" points="6835.5,-459.68 6832,-449.68 6828.5,-459.68 6835.5,-459.68"/>
</g>
<!-- token_scatter&#45;&gt;expert_18_gate -->
<g id="edge102" class="edge">
<title>token_scatter&#45;&gt;expert_18_gate</title>
<path fill="none" stroke="black" d="M7846.77,-495C7594.19,-495 7129,-495 7129,-495 7129,-495 7129,-459.54 7129,-459.54"/>
<polygon fill="black" stroke="black" points="7132.5,-459.54 7129,-449.54 7125.5,-459.54 7132.5,-459.54"/>
</g>
<!-- token_scatter&#45;&gt;expert_19_gate -->
<g id="edge107" class="edge">
<title>token_scatter&#45;&gt;expert_19_gate</title>
<path fill="none" stroke="black" d="M7892.39,-490C7723.75,-490 7426,-490 7426,-490 7426,-490 7426,-459.59 7426,-459.59"/>
<polygon fill="black" stroke="black" points="7429.5,-459.59 7426,-449.59 7422.5,-459.59 7429.5,-459.59"/>
</g>
<!-- token_scatter&#45;&gt;expert_20_gate -->
<g id="edge112" class="edge">
<title>token_scatter&#45;&gt;expert_20_gate</title>
<path fill="none" stroke="black" d="M7792.31,-505.96C7792.31,-505.96 7792.31,-459.58 7792.31,-459.58"/>
<polygon fill="black" stroke="black" points="7795.81,-459.58 7792.31,-449.58 7788.81,-459.58 7795.81,-459.58"/>
</g>
<!-- token_scatter&#45;&gt;expert_21_gate -->
<g id="edge117" class="edge">
<title>token_scatter&#45;&gt;expert_21_gate</title>
<path fill="none" stroke="black" d="M8020,-485.57C8020,-485.57 8020,-459.57 8020,-459.57"/>
<polygon fill="black" stroke="black" points="8023.5,-459.57 8020,-449.57 8016.5,-459.57 8023.5,-459.57"/>
</g>
<!-- token_scatter&#45;&gt;expert_22_gate -->
<g id="edge122" class="edge">
<title>token_scatter&#45;&gt;expert_22_gate</title>
<path fill="none" stroke="black" d="M8186.69,-498.45C8186.69,-498.45 8186.69,-459.7 8186.69,-459.7"/>
<polygon fill="black" stroke="black" points="8190.19,-459.7 8186.69,-449.7 8183.19,-459.7 8190.19,-459.7"/>
</g>
<!-- token_scatter&#45;&gt;expert_23_gate -->
<g id="edge127" class="edge">
<title>token_scatter&#45;&gt;expert_23_gate</title>
<path fill="none" stroke="black" d="M8118.63,-490C8270.37,-490 8521,-490 8521,-490 8521,-490 8521,-459.59 8521,-459.59"/>
<polygon fill="black" stroke="black" points="8524.5,-459.59 8521,-449.59 8517.5,-459.59 8524.5,-459.59"/>
</g>
<!-- token_scatter&#45;&gt;expert_24_gate -->
<g id="edge132" class="edge">
<title>token_scatter&#45;&gt;expert_24_gate</title>
<path fill="none" stroke="black" d="M8156.9,-494C8391.96,-494 8818,-494 8818,-494 8818,-494 8818,-459.57 8818,-459.57"/>
<polygon fill="black" stroke="black" points="8821.5,-459.57 8818,-449.57 8814.5,-459.57 8821.5,-459.57"/>
</g>
<!-- token_scatter&#45;&gt;expert_25_gate -->
<g id="edge137" class="edge">
<title>token_scatter&#45;&gt;expert_25_gate</title>
<path fill="none" stroke="black" d="M8188.71,-499C8503.84,-499 9115,-499 9115,-499 9115,-499 9115,-459.76 9115,-459.76"/>
<polygon fill="black" stroke="black" points="9118.5,-459.76 9115,-449.76 9111.5,-459.76 9118.5,-459.76"/>
</g>
<!-- token_scatter&#45;&gt;expert_26_gate -->
<g id="edge142" class="edge">
<title>token_scatter&#45;&gt;expert_26_gate</title>
<path fill="none" stroke="black" d="M8207.39,-503C8596.45,-503 9412,-503 9412,-503 9412,-503 9412,-459.84 9412,-459.84"/>
<polygon fill="black" stroke="black" points="9415.5,-459.84 9412,-449.84 9408.5,-459.84 9415.5,-459.84"/>
</g>
<!-- token_scatter&#45;&gt;expert_27_gate -->
<g id="edge147" class="edge">
<title>token_scatter&#45;&gt;expert_27_gate</title>
<path fill="none" stroke="black" d="M8223.85,-508C8683.51,-508 9709,-508 9709,-508 9709,-508 9709,-459.66 9709,-459.66"/>
<polygon fill="black" stroke="black" points="9712.5,-459.66 9709,-449.66 9705.5,-459.66 9712.5,-459.66"/>
</g>
<!-- token_scatter&#45;&gt;expert_28_gate -->
<g id="edge152" class="edge">
<title>token_scatter&#45;&gt;expert_28_gate</title>
<path fill="none" stroke="black" d="M8234.98,-513C8760.45,-513 10006,-513 10006,-513 10006,-513 10006,-459.54 10006,-459.54"/>
<polygon fill="black" stroke="black" points="10009.5,-459.54 10006,-449.54 10002.5,-459.54 10009.5,-459.54"/>
</g>
<!-- token_scatter&#45;&gt;expert_29_gate -->
<g id="edge157" class="edge">
<title>token_scatter&#45;&gt;expert_29_gate</title>
<path fill="none" stroke="black" d="M8240.04,-517C8825.23,-517 10303,-517 10303,-517 10303,-517 10303,-459.74 10303,-459.74"/>
<polygon fill="black" stroke="black" points="10306.5,-459.74 10303,-449.74 10299.5,-459.74 10306.5,-459.74"/>
</g>
<!-- token_scatter&#45;&gt;expert_30_gate -->
<g id="edge162" class="edge">
<title>token_scatter&#45;&gt;expert_30_gate</title>
<path fill="none" stroke="black" d="M8242.62,-522C8883.1,-522 10600,-522 10600,-522 10600,-522 10600,-459.61 10600,-459.61"/>
<polygon fill="black" stroke="black" points="10603.5,-459.61 10600,-449.61 10596.5,-459.61 10603.5,-459.61"/>
</g>
<!-- token_scatter&#45;&gt;expert_31_gate -->
<g id="edge167" class="edge">
<title>token_scatter&#45;&gt;expert_31_gate</title>
<path fill="none" stroke="black" d="M8241.2,-526C8930.95,-526 10897,-526 10897,-526 10897,-526 10897,-459.64 10897,-459.64"/>
<polygon fill="black" stroke="black" points="10900.5,-459.64 10897,-449.64 10893.5,-459.64 10900.5,-459.64"/>
</g>
<!-- expert_0_expert -->
<g id="node11" class="node">
<title>expert_0_expert</title>
<polygon fill="lightblue" stroke="black" points="11816,-355.54 11537,-355.54 11537,-297.54 11816,-297.54 11816,-355.54"/>
<text text-anchor="middle" x="11676.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 0 Expert</text>
<text text-anchor="middle" x="11676.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="11676.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="11676.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_0_gate&#45;&gt;expert_0_expert -->
<g id="edge13" class="edge">
<title>expert_0_gate&#45;&gt;expert_0_expert</title>
<path fill="none" stroke="black" d="M11333.33,-391.47C11333.33,-378.03 11333.33,-365 11333.33,-365 11333.33,-365 11583.67,-365 11583.67,-365 11583.67,-365 11583.67,-364.07 11583.67,-364.07"/>
<polygon fill="black" stroke="black" points="11587.17,-365.69 11583.67,-355.69 11580.17,-365.69 11587.17,-365.69"/>
</g>
<!-- expert_0_multiply -->
<g id="node12" class="node">
<title>expert_0_multiply</title>
<polygon fill="lightblue" stroke="black" points="13887,-261.54 13390,-261.54 13390,-203.54 13887,-203.54 13887,-261.54"/>
<text text-anchor="middle" x="13638.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 0 Multiply</text>
<text text-anchor="middle" x="13638.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="13638.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="13638.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_0_expert&#45;&gt;expert_0_multiply -->
<g id="edge14" class="edge">
<title>expert_0_expert&#45;&gt;expert_0_multiply</title>
<path fill="none" stroke="black" d="M11676.5,-297.44C11676.5,-288.52 11676.5,-281 11676.5,-281 11676.5,-281 13400,-281 13400,-281 13400,-281 13400,-271.57 13400,-271.57"/>
<polygon fill="black" stroke="black" points="13403.5,-271.57 13400,-261.57 13396.5,-271.57 13403.5,-271.57"/>
</g>
<!-- token_gather -->
<g id="node106" class="node">
<title>token_gather</title>
<ellipse fill="lightcoral" stroke="black" cx="7973.5" cy="-130.77" rx="255.03" ry="36.54"/>
<text text-anchor="middle" x="7973.5" y="-144.77" font-family="Times,serif" font-size="10.00">Token Gather Communication</text>
<text text-anchor="middle" x="7973.5" y="-133.77" font-family="Times,serif" font-size="10.00">GPU: All&#45;to&#45;all</text>
<text text-anchor="middle" x="7973.5" y="-122.77" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168] from each expert</text>
<text text-anchor="middle" x="7973.5" y="-111.77" font-family="Times,serif" font-size="10.00">Output: [batch_size=32, seq_len=2048, hidden=7168]</text>
</g>
<!-- expert_0_multiply&#45;&gt;token_gather -->
<g id="edge15" class="edge">
<title>expert_0_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M13638.5,-203.3C13638.5,-169.66 13638.5,-119 13638.5,-119 13638.5,-119 8225.56,-119 8225.56,-119"/>
<polygon fill="black" stroke="black" points="8225.56,-115.5 8215.56,-119 8225.56,-122.5 8225.56,-115.5"/>
</g>
<!-- expert_1_expert -->
<g id="node14" class="node">
<title>expert_1_expert</title>
<polygon fill="lightblue" stroke="black" points="12113,-355.54 11834,-355.54 11834,-297.54 12113,-297.54 12113,-355.54"/>
<text text-anchor="middle" x="11973.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 1 Expert</text>
<text text-anchor="middle" x="11973.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="11973.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="11973.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_1_gate&#45;&gt;expert_1_expert -->
<g id="edge18" class="edge">
<title>expert_1_gate&#45;&gt;expert_1_expert</title>
<path fill="none" stroke="black" d="M11630.33,-391.26C11630.33,-378.76 11630.33,-367 11630.33,-367 11630.33,-367 11880.67,-367 11880.67,-367 11880.67,-367 11880.67,-365.89 11880.67,-365.89"/>
<polygon fill="black" stroke="black" points="11884.17,-365.94 11880.67,-355.94 11877.17,-365.94 11884.17,-365.94"/>
</g>
<!-- expert_1_multiply -->
<g id="node15" class="node">
<title>expert_1_multiply</title>
<polygon fill="lightblue" stroke="black" points="14402,-261.54 13905,-261.54 13905,-203.54 14402,-203.54 14402,-261.54"/>
<text text-anchor="middle" x="14153.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 1 Multiply</text>
<text text-anchor="middle" x="14153.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="14153.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="14153.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_1_expert&#45;&gt;expert_1_multiply -->
<g id="edge19" class="edge">
<title>expert_1_expert&#45;&gt;expert_1_multiply</title>
<path fill="none" stroke="black" d="M12023.67,-297.26C12023.67,-289.38 12023.67,-283 12023.67,-283 12023.67,-283 13931.67,-283 13931.67,-283 13931.67,-283 13931.67,-271.6 13931.67,-271.6"/>
<polygon fill="black" stroke="black" points="13935.17,-271.6 13931.67,-261.6 13928.17,-271.6 13935.17,-271.6"/>
</g>
<!-- expert_1_multiply&#45;&gt;token_gather -->
<g id="edge20" class="edge">
<title>expert_1_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M14153.5,-203.48C14153.5,-168.68 14153.5,-115 14153.5,-115 14153.5,-115 8214.48,-115 8214.48,-115"/>
<polygon fill="black" stroke="black" points="8214.48,-111.5 8204.48,-115 8214.48,-118.5 8214.48,-111.5"/>
</g>
<!-- expert_2_expert -->
<g id="node17" class="node">
<title>expert_2_expert</title>
<polygon fill="lightblue" stroke="black" points="13391,-355.54 13112,-355.54 13112,-297.54 13391,-297.54 13391,-355.54"/>
<text text-anchor="middle" x="13251.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 2 Expert</text>
<text text-anchor="middle" x="13251.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="13251.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="13251.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_2_gate&#45;&gt;expert_2_expert -->
<g id="edge23" class="edge">
<title>expert_2_gate&#45;&gt;expert_2_expert</title>
<path fill="none" stroke="black" d="M11927.33,-391.52C11927.33,-387.66 11927.33,-385 11927.33,-385 11927.33,-385 13251.5,-385 13251.5,-385 13251.5,-385 13251.5,-365.77 13251.5,-365.77"/>
<polygon fill="black" stroke="black" points="13255,-365.77 13251.5,-355.77 13248,-365.77 13255,-365.77"/>
</g>
<!-- expert_2_multiply -->
<g id="node18" class="node">
<title>expert_2_multiply</title>
<polygon fill="lightblue" stroke="black" points="14917,-261.54 14420,-261.54 14420,-203.54 14917,-203.54 14917,-261.54"/>
<text text-anchor="middle" x="14668.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 2 Multiply</text>
<text text-anchor="middle" x="14668.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="14668.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="14668.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_2_expert&#45;&gt;expert_2_multiply -->
<g id="edge24" class="edge">
<title>expert_2_expert&#45;&gt;expert_2_multiply</title>
<path fill="none" stroke="black" d="M13381,-297.24C13381,-290.36 13381,-285 13381,-285 13381,-285 14668.5,-285 14668.5,-285 14668.5,-285 14668.5,-271.84 14668.5,-271.84"/>
<polygon fill="black" stroke="black" points="14672,-271.84 14668.5,-261.84 14665,-271.84 14672,-271.84"/>
</g>
<!-- expert_2_multiply&#45;&gt;token_gather -->
<g id="edge25" class="edge">
<title>expert_2_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M14668.5,-203.43C14668.5,-167.47 14668.5,-111 14668.5,-111 14668.5,-111 8199.14,-111 8199.14,-111"/>
<polygon fill="black" stroke="black" points="8199.14,-107.5 8189.14,-111 8199.14,-114.5 8199.14,-107.5"/>
</g>
<!-- expert_3_expert -->
<g id="node20" class="node">
<title>expert_3_expert</title>
<polygon fill="lightblue" stroke="black" points="13688,-355.54 13409,-355.54 13409,-297.54 13688,-297.54 13688,-355.54"/>
<text text-anchor="middle" x="13548.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 3 Expert</text>
<text text-anchor="middle" x="13548.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="13548.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="13548.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_3_gate&#45;&gt;expert_3_expert -->
<g id="edge28" class="edge">
<title>expert_3_gate&#45;&gt;expert_3_expert</title>
<path fill="none" stroke="black" d="M12192,-391.38C12192,-388.72 12192,-387 12192,-387 12192,-387 13548.5,-387 13548.5,-387 13548.5,-387 13548.5,-365.71 13548.5,-365.71"/>
<polygon fill="black" stroke="black" points="13552,-365.71 13548.5,-355.71 13545,-365.71 13552,-365.71"/>
</g>
<!-- expert_3_multiply -->
<g id="node21" class="node">
<title>expert_3_multiply</title>
<polygon fill="lightblue" stroke="black" points="15432,-261.54 14935,-261.54 14935,-203.54 15432,-203.54 15432,-261.54"/>
<text text-anchor="middle" x="15183.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 3 Multiply</text>
<text text-anchor="middle" x="15183.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="15183.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="15183.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_3_expert&#45;&gt;expert_3_multiply -->
<g id="edge29" class="edge">
<title>expert_3_expert&#45;&gt;expert_3_multiply</title>
<path fill="none" stroke="black" d="M13548.5,-297.33C13548.5,-292.48 13548.5,-289 13548.5,-289 13548.5,-289 15183.5,-289 15183.5,-289 15183.5,-289 15183.5,-271.76 15183.5,-271.76"/>
<polygon fill="black" stroke="black" points="15187,-271.76 15183.5,-261.76 15180,-271.76 15187,-271.76"/>
</g>
<!-- expert_3_multiply&#45;&gt;token_gather -->
<g id="edge30" class="edge">
<title>expert_3_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M15183.5,-203.51C15183.5,-166.15 15183.5,-106 15183.5,-106 15183.5,-106 8172.18,-106 8172.18,-106"/>
<polygon fill="black" stroke="black" points="8172.18,-102.5 8162.18,-106 8172.18,-109.5 8172.18,-102.5"/>
</g>
<!-- expert_4_expert -->
<g id="node23" class="node">
<title>expert_4_expert</title>
<polygon fill="lightblue" stroke="black" points="13985,-355.54 13706,-355.54 13706,-297.54 13985,-297.54 13985,-355.54"/>
<text text-anchor="middle" x="13845.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 4 Expert</text>
<text text-anchor="middle" x="13845.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="13845.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="13845.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_4_gate&#45;&gt;expert_4_expert -->
<g id="edge33" class="edge">
<title>expert_4_gate&#45;&gt;expert_4_expert</title>
<path fill="none" stroke="black" d="M12498.67,-391.48C12498.67,-389.34 12498.67,-388 12498.67,-388 12498.67,-388 13845.5,-388 13845.5,-388 13845.5,-388 13845.5,-365.83 13845.5,-365.83"/>
<polygon fill="black" stroke="black" points="13849,-365.83 13845.5,-355.83 13842,-365.83 13849,-365.83"/>
</g>
<!-- expert_4_multiply -->
<g id="node24" class="node">
<title>expert_4_multiply</title>
<polygon fill="lightblue" stroke="black" points="15947,-261.54 15450,-261.54 15450,-203.54 15947,-203.54 15947,-261.54"/>
<text text-anchor="middle" x="15698.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 4 Multiply</text>
<text text-anchor="middle" x="15698.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="15698.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="15698.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_4_expert&#45;&gt;expert_4_multiply -->
<g id="edge34" class="edge">
<title>expert_4_expert&#45;&gt;expert_4_multiply</title>
<path fill="none" stroke="black" d="M13958.33,-297.47C13958.33,-295.93 13958.33,-295 13958.33,-295 13958.33,-295 15698.5,-295 15698.5,-295 15698.5,-295 15698.5,-271.58 15698.5,-271.58"/>
<polygon fill="black" stroke="black" points="15702,-271.58 15698.5,-261.58 15695,-271.58 15702,-271.58"/>
</g>
<!-- expert_4_multiply&#45;&gt;token_gather -->
<g id="edge35" class="edge">
<title>expert_4_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M15698.5,-203.24C15698.5,-164.76 15698.5,-102 15698.5,-102 15698.5,-102 8142.63,-102 8142.63,-102"/>
<polygon fill="black" stroke="black" points="8142.63,-98.5 8132.63,-102 8142.63,-105.5 8142.63,-98.5"/>
</g>
<!-- expert_5_expert -->
<g id="node26" class="node">
<title>expert_5_expert</title>
<polygon fill="lightblue" stroke="black" points="14282,-355.54 14003,-355.54 14003,-297.54 14282,-297.54 14282,-355.54"/>
<text text-anchor="middle" x="14142.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 5 Expert</text>
<text text-anchor="middle" x="14142.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="14142.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="14142.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_5_gate&#45;&gt;expert_5_expert -->
<g id="edge38" class="edge">
<title>expert_5_gate&#45;&gt;expert_5_expert</title>
<path fill="none" stroke="black" d="M12865.25,-420C13222.73,-420 14142.5,-420 14142.5,-420 14142.5,-420 14142.5,-365.6 14142.5,-365.6"/>
<polygon fill="black" stroke="black" points="14146,-365.6 14142.5,-355.6 14139,-365.6 14146,-365.6"/>
</g>
<!-- expert_5_multiply -->
<g id="node27" class="node">
<title>expert_5_multiply</title>
<polygon fill="lightblue" stroke="black" points="16462,-261.54 15965,-261.54 15965,-203.54 16462,-203.54 16462,-261.54"/>
<text text-anchor="middle" x="16213.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 5 Multiply</text>
<text text-anchor="middle" x="16213.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="16213.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="16213.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_5_expert&#45;&gt;expert_5_multiply -->
<g id="edge39" class="edge">
<title>expert_5_expert&#45;&gt;expert_5_multiply</title>
<path fill="none" stroke="black" d="M14282,-326C14746.8,-326 16213.5,-326 16213.5,-326 16213.5,-326 16213.5,-271.6 16213.5,-271.6"/>
<polygon fill="black" stroke="black" points="16217,-271.6 16213.5,-261.6 16210,-271.6 16217,-271.6"/>
</g>
<!-- expert_5_multiply&#45;&gt;token_gather -->
<g id="edge40" class="edge">
<title>expert_5_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M16213.5,-203.35C16213.5,-163.78 16213.5,-98 16213.5,-98 16213.5,-98 8099.59,-98 8099.59,-98"/>
<polygon fill="black" stroke="black" points="8099.59,-94.5 8089.59,-98 8099.59,-101.5 8099.59,-94.5"/>
</g>
<!-- expert_6_expert -->
<g id="node29" class="node">
<title>expert_6_expert</title>
<polygon fill="lightblue" stroke="black" points="552,-355.54 273,-355.54 273,-297.54 552,-297.54 552,-355.54"/>
<text text-anchor="middle" x="412.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 6 Expert</text>
<text text-anchor="middle" x="412.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="412.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="412.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_6_gate&#45;&gt;expert_6_expert -->
<g id="edge43" class="edge">
<title>expert_6_gate&#45;&gt;expert_6_expert</title>
<path fill="none" stroke="black" d="M3378.75,-420C2773.97,-420 412.5,-420 412.5,-420 412.5,-420 412.5,-365.6 412.5,-365.6"/>
<polygon fill="black" stroke="black" points="416,-365.6 412.5,-355.6 409,-365.6 416,-365.6"/>
</g>
<!-- expert_6_multiply -->
<g id="node30" class="node">
<title>expert_6_multiply</title>
<polygon fill="lightblue" stroke="black" points="497,-261.54 0,-261.54 0,-203.54 497,-203.54 497,-261.54"/>
<text text-anchor="middle" x="248.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 6 Multiply</text>
<text text-anchor="middle" x="248.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="248.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="248.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_6_expert&#45;&gt;expert_6_multiply -->
<g id="edge44" class="edge">
<title>expert_6_expert&#45;&gt;expert_6_multiply</title>
<path fill="none" stroke="black" d="M385,-297.31C385,-297.31 385,-271.75 385,-271.75"/>
<polygon fill="black" stroke="black" points="388.5,-271.75 385,-261.75 381.5,-271.75 388.5,-271.75"/>
</g>
<!-- expert_6_multiply&#45;&gt;token_gather -->
<g id="edge45" class="edge">
<title>expert_6_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M248.5,-203.24C248.5,-164.76 248.5,-102 248.5,-102 248.5,-102 7804.37,-102 7804.37,-102"/>
<polygon fill="black" stroke="black" points="7804.37,-105.5 7814.37,-102 7804.37,-98.5 7804.37,-105.5"/>
</g>
<!-- expert_7_expert -->
<g id="node32" class="node">
<title>expert_7_expert</title>
<polygon fill="lightblue" stroke="black" points="2157,-355.54 1878,-355.54 1878,-297.54 2157,-297.54 2157,-355.54"/>
<text text-anchor="middle" x="2017.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 7 Expert</text>
<text text-anchor="middle" x="2017.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2017.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="2017.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_7_gate&#45;&gt;expert_7_expert -->
<g id="edge48" class="edge">
<title>expert_7_gate&#45;&gt;expert_7_expert</title>
<path fill="none" stroke="black" d="M3694.67,-391.31C3694.67,-390.48 3694.67,-390 3694.67,-390 3694.67,-390 2017.5,-390 2017.5,-390 2017.5,-390 2017.5,-365.67 2017.5,-365.67"/>
<polygon fill="black" stroke="black" points="2021,-365.67 2017.5,-355.67 2014,-365.67 2021,-365.67"/>
</g>
<!-- expert_7_multiply -->
<g id="node33" class="node">
<title>expert_7_multiply</title>
<polygon fill="lightblue" stroke="black" points="1012,-261.54 515,-261.54 515,-203.54 1012,-203.54 1012,-261.54"/>
<text text-anchor="middle" x="763.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 7 Multiply</text>
<text text-anchor="middle" x="763.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="763.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="763.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_7_expert&#45;&gt;expert_7_multiply -->
<g id="edge49" class="edge">
<title>expert_7_expert&#45;&gt;expert_7_multiply</title>
<path fill="none" stroke="black" d="M1877.87,-326C1554.58,-326 782,-326 782,-326 782,-326 782,-271.6 782,-271.6"/>
<polygon fill="black" stroke="black" points="785.5,-271.6 782,-261.6 778.5,-271.6 785.5,-271.6"/>
</g>
<!-- expert_7_multiply&#45;&gt;token_gather -->
<g id="edge50" class="edge">
<title>expert_7_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M763.5,-203.51C763.5,-166.15 763.5,-106 763.5,-106 763.5,-106 7774.82,-106 7774.82,-106"/>
<polygon fill="black" stroke="black" points="7774.82,-109.5 7784.82,-106 7774.82,-102.5 7774.82,-109.5"/>
</g>
<!-- expert_8_expert -->
<g id="node35" class="node">
<title>expert_8_expert</title>
<polygon fill="lightblue" stroke="black" points="3108,-355.54 2829,-355.54 2829,-297.54 3108,-297.54 3108,-355.54"/>
<text text-anchor="middle" x="2968.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 8 Expert</text>
<text text-anchor="middle" x="2968.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="2968.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="2968.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_8_gate&#45;&gt;expert_8_expert -->
<g id="edge53" class="edge">
<title>expert_8_gate&#45;&gt;expert_8_expert</title>
<path fill="none" stroke="black" d="M4046,-391.39C4046,-387.05 4046,-384 4046,-384 4046,-384 3090.25,-384 3090.25,-384 3090.25,-384 3090.25,-365.61 3090.25,-365.61"/>
<polygon fill="black" stroke="black" points="3093.75,-365.61 3090.25,-355.61 3086.75,-365.61 3093.75,-365.61"/>
</g>
<!-- expert_8_multiply -->
<g id="node36" class="node">
<title>expert_8_multiply</title>
<polygon fill="lightblue" stroke="black" points="1527,-261.54 1030,-261.54 1030,-203.54 1527,-203.54 1527,-261.54"/>
<text text-anchor="middle" x="1278.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 8 Multiply</text>
<text text-anchor="middle" x="1278.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="1278.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="1278.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_8_expert&#45;&gt;expert_8_multiply -->
<g id="edge54" class="edge">
<title>expert_8_expert&#45;&gt;expert_8_multiply</title>
<path fill="none" stroke="black" d="M2910,-297.48C2910,-295.34 2910,-294 2910,-294 2910,-294 1278.5,-294 1278.5,-294 1278.5,-294 1278.5,-271.83 1278.5,-271.83"/>
<polygon fill="black" stroke="black" points="1282,-271.83 1278.5,-261.83 1275,-271.83 1282,-271.83"/>
</g>
<!-- expert_8_multiply&#45;&gt;token_gather -->
<g id="edge55" class="edge">
<title>expert_8_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M1278.5,-203.43C1278.5,-167.47 1278.5,-111 1278.5,-111 1278.5,-111 7747.86,-111 7747.86,-111"/>
<polygon fill="black" stroke="black" points="7747.86,-114.5 7757.86,-111 7747.86,-107.5 7747.86,-114.5"/>
</g>
<!-- expert_9_expert -->
<g id="node38" class="node">
<title>expert_9_expert</title>
<polygon fill="lightblue" stroke="black" points="3732,-355.54 3453,-355.54 3453,-297.54 3732,-297.54 3732,-355.54"/>
<text text-anchor="middle" x="3592.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 9 Expert</text>
<text text-anchor="middle" x="3592.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="3592.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="3592.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_9_gate&#45;&gt;expert_9_expert -->
<g id="edge58" class="edge">
<title>expert_9_gate&#45;&gt;expert_9_expert</title>
<path fill="none" stroke="black" d="M4281,-391.39C4281,-385.46 4281,-381 4281,-381 4281,-381 3713.33,-381 3713.33,-381 3713.33,-381 3713.33,-365.68 3713.33,-365.68"/>
<polygon fill="black" stroke="black" points="3716.83,-365.68 3713.33,-355.68 3709.83,-365.68 3716.83,-365.68"/>
</g>
<!-- expert_9_multiply -->
<g id="node39" class="node">
<title>expert_9_multiply</title>
<polygon fill="lightblue" stroke="black" points="2042,-261.54 1545,-261.54 1545,-203.54 2042,-203.54 2042,-261.54"/>
<text text-anchor="middle" x="1793.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 9 Multiply</text>
<text text-anchor="middle" x="1793.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1793.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="1793.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_9_expert&#45;&gt;expert_9_multiply -->
<g id="edge59" class="edge">
<title>expert_9_expert&#45;&gt;expert_9_multiply</title>
<path fill="none" stroke="black" d="M3497.67,-297.4C3497.67,-294.16 3497.67,-292 3497.67,-292 3497.67,-292 1960,-292 1960,-292 1960,-292 1960,-271.57 1960,-271.57"/>
<polygon fill="black" stroke="black" points="1963.5,-271.57 1960,-261.57 1956.5,-271.57 1963.5,-271.57"/>
</g>
<!-- expert_9_multiply&#45;&gt;token_gather -->
<g id="edge60" class="edge">
<title>expert_9_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M1793.5,-203.48C1793.5,-168.68 1793.5,-115 1793.5,-115 1793.5,-115 7732.52,-115 7732.52,-115"/>
<polygon fill="black" stroke="black" points="7732.52,-118.5 7742.52,-115 7732.52,-111.5 7732.52,-118.5"/>
</g>
<!-- expert_10_expert -->
<g id="node41" class="node">
<title>expert_10_expert</title>
<polygon fill="lightblue" stroke="black" points="4192,-355.54 3913,-355.54 3913,-297.54 4192,-297.54 4192,-355.54"/>
<text text-anchor="middle" x="4052.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 10 Expert</text>
<text text-anchor="middle" x="4052.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="4052.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="4052.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_10_gate&#45;&gt;expert_10_expert -->
<g id="edge63" class="edge">
<title>expert_10_gate&#45;&gt;expert_10_expert</title>
<path fill="none" stroke="black" d="M4601.67,-391.51C4601.67,-385.01 4601.67,-380 4601.67,-380 4601.67,-380 4119,-380 4119,-380 4119,-380 4119,-365.77 4119,-365.77"/>
<polygon fill="black" stroke="black" points="4122.5,-365.77 4119,-355.77 4115.5,-365.77 4122.5,-365.77"/>
</g>
<!-- expert_10_multiply -->
<g id="node42" class="node">
<title>expert_10_multiply</title>
<polygon fill="lightblue" stroke="black" points="2557,-261.54 2060,-261.54 2060,-203.54 2557,-203.54 2557,-261.54"/>
<text text-anchor="middle" x="2308.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 10 Multiply</text>
<text text-anchor="middle" x="2308.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="2308.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="2308.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_10_expert&#45;&gt;expert_10_multiply -->
<g id="edge64" class="edge">
<title>expert_10_expert&#45;&gt;expert_10_multiply</title>
<path fill="none" stroke="black" d="M3976,-297.52C3976,-293.66 3976,-291 3976,-291 3976,-291 2357,-291 2357,-291 2357,-291 2357,-271.77 2357,-271.77"/>
<polygon fill="black" stroke="black" points="2360.5,-271.77 2357,-261.77 2353.5,-271.77 2360.5,-271.77"/>
</g>
<!-- expert_10_multiply&#45;&gt;token_gather -->
<g id="edge65" class="edge">
<title>expert_10_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M2308.5,-203.3C2308.5,-169.66 2308.5,-119 2308.5,-119 2308.5,-119 7721.44,-119 7721.44,-119"/>
<polygon fill="black" stroke="black" points="7721.44,-122.5 7731.44,-119 7721.44,-115.5 7721.44,-122.5"/>
</g>
<!-- expert_11_expert -->
<g id="node44" class="node">
<title>expert_11_expert</title>
<polygon fill="lightblue" stroke="black" points="4571,-355.54 4292,-355.54 4292,-297.54 4571,-297.54 4571,-355.54"/>
<text text-anchor="middle" x="4431.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 11 Expert</text>
<text text-anchor="middle" x="4431.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="4431.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="4431.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_11_gate&#45;&gt;expert_11_expert -->
<g id="edge68" class="edge">
<title>expert_11_gate&#45;&gt;expert_11_expert</title>
<path fill="none" stroke="black" d="M4879,-391.46C4879,-383.98 4879,-378 4879,-378 4879,-378 4558,-378 4558,-378 4558,-378 4558,-365.58 4558,-365.58"/>
<polygon fill="black" stroke="black" points="4561.5,-365.58 4558,-355.58 4554.5,-365.58 4561.5,-365.58"/>
</g>
<!-- expert_11_multiply -->
<g id="node45" class="node">
<title>expert_11_multiply</title>
<polygon fill="lightblue" stroke="black" points="3072,-261.54 2575,-261.54 2575,-203.54 3072,-203.54 3072,-261.54"/>
<text text-anchor="middle" x="2823.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 11 Multiply</text>
<text text-anchor="middle" x="2823.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2823.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="2823.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_11_expert&#45;&gt;expert_11_multiply -->
<g id="edge69" class="edge">
<title>expert_11_expert&#45;&gt;expert_11_multiply</title>
<path fill="none" stroke="black" d="M4431.5,-297.33C4431.5,-291.95 4431.5,-288 4431.5,-288 4431.5,-288 2991,-288 2991,-288 2991,-288 2991,-271.57 2991,-271.57"/>
<polygon fill="black" stroke="black" points="2994.5,-271.57 2991,-261.57 2987.5,-271.57 2994.5,-271.57"/>
</g>
<!-- expert_11_multiply&#45;&gt;token_gather -->
<g id="edge70" class="edge">
<title>expert_11_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M2823.5,-203.45C2823.5,-171.3 2823.5,-124 2823.5,-124 2823.5,-124 7712.49,-124 7712.49,-124"/>
<polygon fill="black" stroke="black" points="7712.49,-127.5 7722.49,-124 7712.49,-120.5 7712.49,-127.5"/>
</g>
<!-- expert_12_expert -->
<g id="node47" class="node">
<title>expert_12_expert</title>
<polygon fill="lightblue" stroke="black" points="4909,-355.54 4630,-355.54 4630,-297.54 4909,-297.54 4909,-355.54"/>
<text text-anchor="middle" x="4769.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 12 Expert</text>
<text text-anchor="middle" x="4769.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="4769.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="4769.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_12_gate&#45;&gt;expert_12_expert -->
<g id="edge73" class="edge">
<title>expert_12_gate&#45;&gt;expert_12_expert</title>
<path fill="none" stroke="black" d="M5182.67,-391.26C5182.67,-383.38 5182.67,-377 5182.67,-377 5182.67,-377 4894,-377 4894,-377 4894,-377 4894,-365.6 4894,-365.6"/>
<polygon fill="black" stroke="black" points="4897.5,-365.6 4894,-355.6 4890.5,-365.6 4897.5,-365.6"/>
</g>
<!-- expert_12_multiply -->
<g id="node48" class="node">
<title>expert_12_multiply</title>
<polygon fill="lightblue" stroke="black" points="3587,-261.54 3090,-261.54 3090,-203.54 3587,-203.54 3587,-261.54"/>
<text text-anchor="middle" x="3338.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 12 Multiply</text>
<text text-anchor="middle" x="3338.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3338.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="3338.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_12_expert&#45;&gt;expert_12_multiply -->
<g id="edge74" class="edge">
<title>expert_12_expert&#45;&gt;expert_12_multiply</title>
<path fill="none" stroke="black" d="M4772,-297.51C4772,-291.01 4772,-286 4772,-286 4772,-286 3542.33,-286 3542.33,-286 3542.33,-286 3542.33,-271.77 3542.33,-271.77"/>
<polygon fill="black" stroke="black" points="3545.83,-271.77 3542.33,-261.77 3538.83,-271.77 3545.83,-271.77"/>
</g>
<!-- expert_12_multiply&#45;&gt;token_gather -->
<g id="edge75" class="edge">
<title>expert_12_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M3338.5,-203.42C3338.5,-172.49 3338.5,-128 3338.5,-128 3338.5,-128 7708.94,-128 7708.94,-128"/>
<polygon fill="black" stroke="black" points="7708.94,-131.5 7718.94,-128 7708.94,-124.5 7708.94,-131.5"/>
</g>
<!-- expert_13_expert -->
<g id="node50" class="node">
<title>expert_13_expert</title>
<polygon fill="lightblue" stroke="black" points="5226,-355.54 4947,-355.54 4947,-297.54 5226,-297.54 5226,-355.54"/>
<text text-anchor="middle" x="5086.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 13 Expert</text>
<text text-anchor="middle" x="5086.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="5086.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="5086.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_13_gate&#45;&gt;expert_13_expert -->
<g id="edge78" class="edge">
<title>expert_13_gate&#45;&gt;expert_13_expert</title>
<path fill="none" stroke="black" d="M5483,-391.44C5483,-382.52 5483,-375 5483,-375 5483,-375 5204.33,-375 5204.33,-375 5204.33,-375 5204.33,-365.57 5204.33,-365.57"/>
<polygon fill="black" stroke="black" points="5207.83,-365.57 5204.33,-355.57 5200.83,-365.57 5207.83,-365.57"/>
</g>
<!-- expert_13_multiply -->
<g id="node51" class="node">
<title>expert_13_multiply</title>
<polygon fill="lightblue" stroke="black" points="4102,-261.54 3605,-261.54 3605,-203.54 4102,-203.54 4102,-261.54"/>
<text text-anchor="middle" x="3853.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 13 Multiply</text>
<text text-anchor="middle" x="3853.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3853.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="3853.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_13_expert&#45;&gt;expert_13_multiply -->
<g id="edge79" class="edge">
<title>expert_13_expert&#45;&gt;expert_13_multiply</title>
<path fill="none" stroke="black" d="M5008.67,-297.46C5008.67,-285.77 5008.67,-275 5008.67,-275 5008.67,-275 4039,-275 4039,-275 4039,-275 4039,-271.57 4039,-271.57"/>
<polygon fill="black" stroke="black" points="4042.5,-271.57 4039,-261.57 4035.5,-271.57 4042.5,-271.57"/>
</g>
<!-- expert_13_multiply&#45;&gt;token_gather -->
<g id="edge80" class="edge">
<title>expert_13_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M3964.5,-203.46C3964.5,-173.77 3964.5,-132 3964.5,-132 3964.5,-132 7708.15,-132 7708.15,-132"/>
<polygon fill="black" stroke="black" points="7708.15,-135.5 7718.15,-132 7708.15,-128.5 7708.15,-135.5"/>
</g>
<!-- expert_14_expert -->
<g id="node53" class="node">
<title>expert_14_expert</title>
<polygon fill="lightblue" stroke="black" points="5533,-355.54 5254,-355.54 5254,-297.54 5533,-297.54 5533,-355.54"/>
<text text-anchor="middle" x="5393.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 14 Expert</text>
<text text-anchor="middle" x="5393.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="5393.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="5393.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_14_gate&#45;&gt;expert_14_expert -->
<g id="edge83" class="edge">
<title>expert_14_gate&#45;&gt;expert_14_expert</title>
<path fill="none" stroke="black" d="M5781.67,-391.33C5781.67,-381.98 5781.67,-374 5781.67,-374 5781.67,-374 5508,-374 5508,-374 5508,-374 5508,-365.79 5508,-365.79"/>
<polygon fill="black" stroke="black" points="5511.5,-365.79 5508,-355.79 5504.5,-365.79 5511.5,-365.79"/>
</g>
<!-- expert_14_multiply -->
<g id="node54" class="node">
<title>expert_14_multiply</title>
<polygon fill="lightblue" stroke="black" points="4617,-261.54 4120,-261.54 4120,-203.54 4617,-203.54 4617,-261.54"/>
<text text-anchor="middle" x="4368.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 14 Multiply</text>
<text text-anchor="middle" x="4368.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4368.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="4368.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_14_expert&#45;&gt;expert_14_multiply -->
<g id="edge84" class="edge">
<title>expert_14_expert&#45;&gt;expert_14_multiply</title>
<path fill="none" stroke="black" d="M5393.5,-297.35C5393.5,-284.39 5393.5,-272 5393.5,-272 5393.5,-272 4586.33,-272 4586.33,-272 4586.33,-272 4586.33,-270.96 4586.33,-270.96"/>
<polygon fill="black" stroke="black" points="4589.83,-271.63 4586.33,-261.63 4582.83,-271.63 4589.83,-271.63"/>
</g>
<!-- expert_14_multiply&#45;&gt;token_gather -->
<g id="edge85" class="edge">
<title>expert_14_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M4368.5,-203.36C4368.5,-175.26 4368.5,-137 4368.5,-137 4368.5,-137 7711.79,-137 7711.79,-137"/>
<polygon fill="black" stroke="black" points="7711.79,-140.5 7721.79,-137 7711.79,-133.5 7711.79,-140.5"/>
</g>
<!-- expert_15_expert -->
<g id="node56" class="node">
<title>expert_15_expert</title>
<polygon fill="lightblue" stroke="black" points="5835,-355.54 5556,-355.54 5556,-297.54 5835,-297.54 5835,-355.54"/>
<text text-anchor="middle" x="5695.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 15 Expert</text>
<text text-anchor="middle" x="5695.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="5695.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="5695.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_15_gate&#45;&gt;expert_15_expert -->
<g id="edge88" class="edge">
<title>expert_15_gate&#45;&gt;expert_15_expert</title>
<path fill="none" stroke="black" d="M6079.67,-391.46C6079.67,-381.13 6079.67,-372 6079.67,-372 6079.67,-372 5808.33,-372 5808.33,-372 5808.33,-372 5808.33,-365.59 5808.33,-365.59"/>
<polygon fill="black" stroke="black" points="5811.83,-365.59 5808.33,-355.59 5804.83,-365.59 5811.83,-365.59"/>
</g>
<!-- expert_15_multiply -->
<g id="node57" class="node">
<title>expert_15_multiply</title>
<polygon fill="lightblue" stroke="black" points="5132,-261.54 4635,-261.54 4635,-203.54 5132,-203.54 5132,-261.54"/>
<text text-anchor="middle" x="4883.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 15 Multiply</text>
<text text-anchor="middle" x="4883.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4883.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="4883.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_15_expert&#45;&gt;expert_15_multiply -->
<g id="edge89" class="edge">
<title>expert_15_expert&#45;&gt;expert_15_multiply</title>
<path fill="none" stroke="black" d="M5586.33,-297.47C5586.33,-282.35 5586.33,-267 5586.33,-267 5586.33,-267 5070.33,-267 5070.33,-267 5070.33,-267 5070.33,-266.46 5070.33,-266.46"/>
<polygon fill="black" stroke="black" points="5073.83,-271.62 5070.33,-261.62 5066.83,-271.62 5073.83,-271.62"/>
</g>
<!-- expert_15_multiply&#45;&gt;token_gather -->
<g id="edge90" class="edge">
<title>expert_15_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M4883.5,-203.32C4883.5,-176.53 4883.5,-141 4883.5,-141 4883.5,-141 7718.13,-141 7718.13,-141"/>
<polygon fill="black" stroke="black" points="7718.13,-144.5 7728.13,-141 7718.13,-137.5 7718.13,-144.5"/>
</g>
<!-- expert_16_expert -->
<g id="node59" class="node">
<title>expert_16_expert</title>
<polygon fill="lightblue" stroke="black" points="6135,-355.54 5856,-355.54 5856,-297.54 6135,-297.54 6135,-355.54"/>
<text text-anchor="middle" x="5995.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 16 Expert</text>
<text text-anchor="middle" x="5995.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="5995.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="5995.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_16_gate&#45;&gt;expert_16_expert -->
<g id="edge93" class="edge">
<title>expert_16_gate&#45;&gt;expert_16_expert</title>
<path fill="none" stroke="black" d="M6377,-391.44C6377,-380.65 6377,-371 6377,-371 6377,-371 6107.33,-371 6107.33,-371 6107.33,-371 6107.33,-365.95 6107.33,-365.95"/>
<polygon fill="black" stroke="black" points="6110.83,-365.95 6107.33,-355.95 6103.83,-365.95 6110.83,-365.95"/>
</g>
<!-- expert_16_multiply -->
<g id="node60" class="node">
<title>expert_16_multiply</title>
<polygon fill="lightblue" stroke="black" points="5647,-261.54 5150,-261.54 5150,-203.54 5647,-203.54 5647,-261.54"/>
<text text-anchor="middle" x="5398.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 16 Multiply</text>
<text text-anchor="middle" x="5398.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="5398.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="5398.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_16_expert&#45;&gt;expert_16_multiply -->
<g id="edge94" class="edge">
<title>expert_16_expert&#45;&gt;expert_16_multiply</title>
<path fill="none" stroke="black" d="M5995.5,-297.47C5995.5,-281.13 5995.5,-264 5995.5,-264 5995.5,-264 5616.67,-264 5616.67,-264 5616.67,-264 5616.67,-263.79 5616.67,-263.79"/>
<polygon fill="black" stroke="black" points="5620.17,-271.94 5616.67,-261.94 5613.17,-271.94 5620.17,-271.94"/>
</g>
<!-- expert_16_multiply&#45;&gt;token_gather -->
<g id="edge95" class="edge">
<title>expert_16_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M5398.5,-203.39C5398.5,-177.92 5398.5,-145 5398.5,-145 5398.5,-145 7727.87,-145 7727.87,-145"/>
<polygon fill="black" stroke="black" points="7727.87,-148.5 7737.87,-145 7727.87,-141.5 7727.87,-148.5"/>
</g>
<!-- expert_17_expert -->
<g id="node62" class="node">
<title>expert_17_expert</title>
<polygon fill="lightblue" stroke="black" points="6433,-355.54 6154,-355.54 6154,-297.54 6433,-297.54 6433,-355.54"/>
<text text-anchor="middle" x="6293.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 17 Expert</text>
<text text-anchor="middle" x="6293.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="6293.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="6293.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_17_gate&#45;&gt;expert_17_expert -->
<g id="edge98" class="edge">
<title>expert_17_gate&#45;&gt;expert_17_expert</title>
<path fill="none" stroke="black" d="M6674.33,-391.46C6674.33,-379.77 6674.33,-369 6674.33,-369 6674.33,-369 6405,-369 6405,-369 6405,-369 6405,-365.57 6405,-365.57"/>
<polygon fill="black" stroke="black" points="6408.5,-365.57 6405,-355.57 6401.5,-365.57 6408.5,-365.57"/>
</g>
<!-- expert_17_multiply -->
<g id="node63" class="node">
<title>expert_17_multiply</title>
<polygon fill="lightblue" stroke="black" points="6162,-261.54 5665,-261.54 5665,-203.54 6162,-203.54 6162,-261.54"/>
<text text-anchor="middle" x="5913.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 17 Multiply</text>
<text text-anchor="middle" x="5913.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="5913.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="5913.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_17_expert&#45;&gt;expert_17_multiply -->
<g id="edge99" class="edge">
<title>expert_17_expert&#45;&gt;expert_17_multiply</title>
<path fill="none" stroke="black" d="M6158,-297.31C6158,-297.31 6158,-271.75 6158,-271.75"/>
<polygon fill="black" stroke="black" points="6161.5,-271.75 6158,-261.75 6154.5,-271.75 6161.5,-271.75"/>
</g>
<!-- expert_17_multiply&#45;&gt;token_gather -->
<g id="edge100" class="edge">
<title>expert_17_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M5913.5,-203.21C5913.5,-179.48 5913.5,-150 5913.5,-150 5913.5,-150 7745.48,-150 7745.48,-150"/>
<polygon fill="black" stroke="black" points="7745.48,-153.5 7755.48,-150 7745.48,-146.5 7745.48,-153.5"/>
</g>
<!-- expert_18_expert -->
<g id="node65" class="node">
<title>expert_18_expert</title>
<polygon fill="lightblue" stroke="black" points="6731,-355.54 6452,-355.54 6452,-297.54 6731,-297.54 6731,-355.54"/>
<text text-anchor="middle" x="6591.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 18 Expert</text>
<text text-anchor="middle" x="6591.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="6591.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="6591.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_18_gate&#45;&gt;expert_18_expert -->
<g id="edge103" class="edge">
<title>expert_18_gate&#45;&gt;expert_18_expert</title>
<path fill="none" stroke="black" d="M7067.5,-391.5C7067.5,-379.35 7067.5,-368 7067.5,-368 7067.5,-368 6702.67,-368 6702.67,-368 6702.67,-368 6702.67,-365.78 6702.67,-365.78"/>
<polygon fill="black" stroke="black" points="6706.17,-365.78 6702.67,-355.78 6699.17,-365.78 6706.17,-365.78"/>
</g>
<!-- expert_18_multiply -->
<g id="node66" class="node">
<title>expert_18_multiply</title>
<polygon fill="lightblue" stroke="black" points="6677,-261.54 6180,-261.54 6180,-203.54 6677,-203.54 6677,-261.54"/>
<text text-anchor="middle" x="6428.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 18 Multiply</text>
<text text-anchor="middle" x="6428.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="6428.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="6428.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_18_expert&#45;&gt;expert_18_multiply -->
<g id="edge104" class="edge">
<title>expert_18_expert&#45;&gt;expert_18_multiply</title>
<path fill="none" stroke="black" d="M6564.5,-297.31C6564.5,-297.31 6564.5,-271.75 6564.5,-271.75"/>
<polygon fill="black" stroke="black" points="6568,-271.75 6564.5,-261.75 6561,-271.75 6568,-271.75"/>
</g>
<!-- expert_18_multiply&#45;&gt;token_gather -->
<g id="edge105" class="edge">
<title>expert_18_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M6428.5,-203.29C6428.5,-180.96 6428.5,-154 6428.5,-154 6428.5,-154 7765.47,-154 7765.47,-154"/>
<polygon fill="black" stroke="black" points="7765.47,-157.5 7775.47,-154 7765.47,-150.5 7765.47,-157.5"/>
</g>
<!-- expert_19_expert -->
<g id="node68" class="node">
<title>expert_19_expert</title>
<polygon fill="lightblue" stroke="black" points="7192,-355.54 6913,-355.54 6913,-297.54 7192,-297.54 7192,-355.54"/>
<text text-anchor="middle" x="7052.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 19 Expert</text>
<text text-anchor="middle" x="7052.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="7052.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="7052.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_19_gate&#45;&gt;expert_19_expert -->
<g id="edge108" class="edge">
<title>expert_19_gate&#45;&gt;expert_19_expert</title>
<path fill="none" stroke="black" d="M7334,-391.4C7334,-363.63 7334,-326 7334,-326 7334,-326 7202.01,-326 7202.01,-326"/>
<polygon fill="black" stroke="black" points="7202.01,-322.5 7192.01,-326 7202.01,-329.5 7202.01,-322.5"/>
</g>
<!-- expert_19_multiply -->
<g id="node69" class="node">
<title>expert_19_multiply</title>
<polygon fill="lightblue" stroke="black" points="7192,-261.54 6695,-261.54 6695,-203.54 7192,-203.54 7192,-261.54"/>
<text text-anchor="middle" x="6943.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 19 Multiply</text>
<text text-anchor="middle" x="6943.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="6943.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="6943.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_19_expert&#45;&gt;expert_19_multiply -->
<g id="edge109" class="edge">
<title>expert_19_expert&#45;&gt;expert_19_multiply</title>
<path fill="none" stroke="black" d="M7052.5,-297.31C7052.5,-297.31 7052.5,-271.75 7052.5,-271.75"/>
<polygon fill="black" stroke="black" points="7056,-271.75 7052.5,-261.75 7049,-271.75 7056,-271.75"/>
</g>
<!-- expert_19_multiply&#45;&gt;token_gather -->
<g id="edge110" class="edge">
<title>expert_19_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M6943.5,-203.51C6943.5,-182.58 6943.5,-158 6943.5,-158 6943.5,-158 7791.68,-158 7791.68,-158"/>
<polygon fill="black" stroke="black" points="7791.68,-161.5 7801.68,-158 7791.68,-154.5 7791.68,-161.5"/>
</g>
<!-- expert_20_expert -->
<g id="node71" class="node">
<title>expert_20_expert</title>
<polygon fill="lightblue" stroke="black" points="7707,-355.54 7428,-355.54 7428,-297.54 7707,-297.54 7707,-355.54"/>
<text text-anchor="middle" x="7567.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 20 Expert</text>
<text text-anchor="middle" x="7567.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="7567.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="7567.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_20_gate&#45;&gt;expert_20_expert -->
<g id="edge113" class="edge">
<title>expert_20_gate&#45;&gt;expert_20_expert</title>
<path fill="none" stroke="black" d="M7622,-391.31C7622,-391.31 7622,-365.75 7622,-365.75"/>
<polygon fill="black" stroke="black" points="7625.5,-365.75 7622,-355.75 7618.5,-365.75 7625.5,-365.75"/>
</g>
<!-- expert_20_multiply -->
<g id="node72" class="node">
<title>expert_20_multiply</title>
<polygon fill="lightblue" stroke="black" points="7707,-261.54 7210,-261.54 7210,-203.54 7707,-203.54 7707,-261.54"/>
<text text-anchor="middle" x="7458.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 20 Multiply</text>
<text text-anchor="middle" x="7458.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="7458.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="7458.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_20_expert&#45;&gt;expert_20_multiply -->
<g id="edge114" class="edge">
<title>expert_20_expert&#45;&gt;expert_20_multiply</title>
<path fill="none" stroke="black" d="M7567.5,-297.31C7567.5,-297.31 7567.5,-271.75 7567.5,-271.75"/>
<polygon fill="black" stroke="black" points="7571,-271.75 7567.5,-261.75 7564,-271.75 7571,-271.75"/>
</g>
<!-- expert_20_multiply&#45;&gt;token_gather -->
<g id="edge115" class="edge">
<title>expert_20_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M7458.5,-203.45C7458.5,-184.4 7458.5,-163 7458.5,-163 7458.5,-163 7840.47,-163 7840.47,-163"/>
<polygon fill="black" stroke="black" points="7840.47,-166.5 7850.47,-163 7840.47,-159.5 7840.47,-166.5"/>
</g>
<!-- expert_21_expert -->
<g id="node74" class="node">
<title>expert_21_expert</title>
<polygon fill="lightblue" stroke="black" points="8113,-355.54 7834,-355.54 7834,-297.54 8113,-297.54 8113,-355.54"/>
<text text-anchor="middle" x="7973.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 21 Expert</text>
<text text-anchor="middle" x="7973.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="7973.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="7973.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_21_gate&#45;&gt;expert_21_expert -->
<g id="edge118" class="edge">
<title>expert_21_gate&#45;&gt;expert_21_expert</title>
<path fill="none" stroke="black" d="M7973.5,-391.31C7973.5,-391.31 7973.5,-365.75 7973.5,-365.75"/>
<polygon fill="black" stroke="black" points="7977,-365.75 7973.5,-355.75 7970,-365.75 7977,-365.75"/>
</g>
<!-- expert_21_multiply -->
<g id="node75" class="node">
<title>expert_21_multiply</title>
<polygon fill="lightblue" stroke="black" points="8222,-261.54 7725,-261.54 7725,-203.54 8222,-203.54 8222,-261.54"/>
<text text-anchor="middle" x="7973.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 21 Multiply</text>
<text text-anchor="middle" x="7973.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="7973.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="7973.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_21_expert&#45;&gt;expert_21_multiply -->
<g id="edge119" class="edge">
<title>expert_21_expert&#45;&gt;expert_21_multiply</title>
<path fill="none" stroke="black" d="M7973.5,-297.31C7973.5,-297.31 7973.5,-271.75 7973.5,-271.75"/>
<polygon fill="black" stroke="black" points="7977,-271.75 7973.5,-261.75 7970,-271.75 7977,-271.75"/>
</g>
<!-- expert_21_multiply&#45;&gt;token_gather -->
<g id="edge120" class="edge">
<title>expert_21_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M7973.5,-203.38C7973.5,-203.38 7973.5,-177.56 7973.5,-177.56"/>
<polygon fill="black" stroke="black" points="7977,-177.56 7973.5,-167.56 7970,-177.56 7977,-177.56"/>
</g>
<!-- expert_22_expert -->
<g id="node77" class="node">
<title>expert_22_expert</title>
<polygon fill="lightblue" stroke="black" points="8519,-355.54 8240,-355.54 8240,-297.54 8519,-297.54 8519,-355.54"/>
<text text-anchor="middle" x="8379.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 22 Expert</text>
<text text-anchor="middle" x="8379.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="8379.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="8379.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_22_gate&#45;&gt;expert_22_expert -->
<g id="edge123" class="edge">
<title>expert_22_gate&#45;&gt;expert_22_expert</title>
<path fill="none" stroke="black" d="M8325,-391.31C8325,-391.31 8325,-365.75 8325,-365.75"/>
<polygon fill="black" stroke="black" points="8328.5,-365.75 8325,-355.75 8321.5,-365.75 8328.5,-365.75"/>
</g>
<!-- expert_22_multiply -->
<g id="node78" class="node">
<title>expert_22_multiply</title>
<polygon fill="lightblue" stroke="black" points="8737,-261.54 8240,-261.54 8240,-203.54 8737,-203.54 8737,-261.54"/>
<text text-anchor="middle" x="8488.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 22 Multiply</text>
<text text-anchor="middle" x="8488.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="8488.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="8488.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_22_expert&#45;&gt;expert_22_multiply -->
<g id="edge124" class="edge">
<title>expert_22_expert&#45;&gt;expert_22_multiply</title>
<path fill="none" stroke="black" d="M8379.5,-297.31C8379.5,-297.31 8379.5,-271.75 8379.5,-271.75"/>
<polygon fill="black" stroke="black" points="8383,-271.75 8379.5,-261.75 8376,-271.75 8383,-271.75"/>
</g>
<!-- expert_22_multiply&#45;&gt;token_gather -->
<g id="edge125" class="edge">
<title>expert_22_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M8488.5,-203.45C8488.5,-184.4 8488.5,-163 8488.5,-163 8488.5,-163 8106.53,-163 8106.53,-163"/>
<polygon fill="black" stroke="black" points="8106.53,-159.5 8096.53,-163 8106.53,-166.5 8106.53,-159.5"/>
</g>
<!-- expert_23_expert -->
<g id="node80" class="node">
<title>expert_23_expert</title>
<polygon fill="lightblue" stroke="black" points="8816,-355.54 8537,-355.54 8537,-297.54 8816,-297.54 8816,-355.54"/>
<text text-anchor="middle" x="8676.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 23 Expert</text>
<text text-anchor="middle" x="8676.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="8676.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="8676.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_23_gate&#45;&gt;expert_23_expert -->
<g id="edge128" class="edge">
<title>expert_23_gate&#45;&gt;expert_23_expert</title>
<path fill="none" stroke="black" d="M8622,-391.31C8622,-391.31 8622,-365.75 8622,-365.75"/>
<polygon fill="black" stroke="black" points="8625.5,-365.75 8622,-355.75 8618.5,-365.75 8625.5,-365.75"/>
</g>
<!-- expert_23_multiply -->
<g id="node81" class="node">
<title>expert_23_multiply</title>
<polygon fill="lightblue" stroke="black" points="9252,-261.54 8755,-261.54 8755,-203.54 9252,-203.54 9252,-261.54"/>
<text text-anchor="middle" x="9003.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 23 Multiply</text>
<text text-anchor="middle" x="9003.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="9003.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="9003.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_23_expert&#45;&gt;expert_23_multiply -->
<g id="edge129" class="edge">
<title>expert_23_expert&#45;&gt;expert_23_multiply</title>
<path fill="none" stroke="black" d="M8785.5,-297.31C8785.5,-297.31 8785.5,-271.75 8785.5,-271.75"/>
<polygon fill="black" stroke="black" points="8789,-271.75 8785.5,-261.75 8782,-271.75 8789,-271.75"/>
</g>
<!-- expert_23_multiply&#45;&gt;token_gather -->
<g id="edge130" class="edge">
<title>expert_23_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M9003.5,-203.51C9003.5,-182.58 9003.5,-158 9003.5,-158 9003.5,-158 8155.32,-158 8155.32,-158"/>
<polygon fill="black" stroke="black" points="8155.32,-154.5 8145.32,-158 8155.32,-161.5 8155.32,-154.5"/>
</g>
<!-- expert_24_expert -->
<g id="node83" class="node">
<title>expert_24_expert</title>
<polygon fill="lightblue" stroke="black" points="9113,-355.54 8834,-355.54 8834,-297.54 9113,-297.54 9113,-355.54"/>
<text text-anchor="middle" x="8973.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 24 Expert</text>
<text text-anchor="middle" x="8973.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="8973.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="8973.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_24_gate&#45;&gt;expert_24_expert -->
<g id="edge133" class="edge">
<title>expert_24_gate&#45;&gt;expert_24_expert</title>
<path fill="none" stroke="black" d="M8919,-391.31C8919,-391.31 8919,-365.75 8919,-365.75"/>
<polygon fill="black" stroke="black" points="8922.5,-365.75 8919,-355.75 8915.5,-365.75 8922.5,-365.75"/>
</g>
<!-- expert_24_multiply -->
<g id="node84" class="node">
<title>expert_24_multiply</title>
<polygon fill="lightblue" stroke="black" points="9767,-261.54 9270,-261.54 9270,-203.54 9767,-203.54 9767,-261.54"/>
<text text-anchor="middle" x="9518.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 24 Multiply</text>
<text text-anchor="middle" x="9518.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="9518.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="9518.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_24_expert&#45;&gt;expert_24_multiply -->
<g id="edge134" class="edge">
<title>expert_24_expert&#45;&gt;expert_24_multiply</title>
<path fill="none" stroke="black" d="M9113,-316C9194.05,-316 9280.33,-316 9280.33,-316 9280.33,-316 9280.33,-271.73 9280.33,-271.73"/>
<polygon fill="black" stroke="black" points="9283.83,-271.73 9280.33,-261.73 9276.83,-271.73 9283.83,-271.73"/>
</g>
<!-- expert_24_multiply&#45;&gt;token_gather -->
<g id="edge135" class="edge">
<title>expert_24_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M9518.5,-203.29C9518.5,-180.96 9518.5,-154 9518.5,-154 9518.5,-154 8181.53,-154 8181.53,-154"/>
<polygon fill="black" stroke="black" points="8181.53,-150.5 8171.53,-154 8181.53,-157.5 8181.53,-150.5"/>
</g>
<!-- expert_25_expert -->
<g id="node86" class="node">
<title>expert_25_expert</title>
<polygon fill="lightblue" stroke="black" points="9737,-355.54 9458,-355.54 9458,-297.54 9737,-297.54 9737,-355.54"/>
<text text-anchor="middle" x="9597.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 25 Expert</text>
<text text-anchor="middle" x="9597.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="9597.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="9597.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_25_gate&#45;&gt;expert_25_expert -->
<g id="edge138" class="edge">
<title>expert_25_gate&#45;&gt;expert_25_expert</title>
<path fill="none" stroke="black" d="M9290.67,-391.45C9290.67,-366.99 9290.67,-336 9290.67,-336 9290.67,-336 9448,-336 9448,-336"/>
<polygon fill="black" stroke="black" points="9448,-339.5 9458,-336 9448,-332.5 9448,-339.5"/>
</g>
<!-- expert_25_multiply -->
<g id="node87" class="node">
<title>expert_25_multiply</title>
<polygon fill="lightblue" stroke="black" points="10282,-261.54 9785,-261.54 9785,-203.54 10282,-203.54 10282,-261.54"/>
<text text-anchor="middle" x="10033.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 25 Multiply</text>
<text text-anchor="middle" x="10033.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="10033.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="10033.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_25_expert&#45;&gt;expert_25_multiply -->
<g id="edge139" class="edge">
<title>expert_25_expert&#45;&gt;expert_25_multiply</title>
<path fill="none" stroke="black" d="M9597.5,-297.37C9597.5,-280.67 9597.5,-263 9597.5,-263 9597.5,-263 9868,-263 9868,-263 9868,-263 9868,-262.87 9868,-262.87"/>
<polygon fill="black" stroke="black" points="9871.5,-271.69 9868,-261.69 9864.5,-271.69 9871.5,-271.69"/>
</g>
<!-- expert_25_multiply&#45;&gt;token_gather -->
<g id="edge140" class="edge">
<title>expert_25_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M10033.5,-203.21C10033.5,-179.48 10033.5,-150 10033.5,-150 10033.5,-150 8201.52,-150 8201.52,-150"/>
<polygon fill="black" stroke="black" points="8201.52,-146.5 8191.52,-150 8201.52,-153.5 8201.52,-146.5"/>
</g>
<!-- expert_26_expert -->
<g id="node89" class="node">
<title>expert_26_expert</title>
<polygon fill="lightblue" stroke="black" points="10034,-355.54 9755,-355.54 9755,-297.54 10034,-297.54 10034,-355.54"/>
<text text-anchor="middle" x="9894.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 26 Expert</text>
<text text-anchor="middle" x="9894.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="9894.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="9894.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_26_gate&#45;&gt;expert_26_expert -->
<g id="edge143" class="edge">
<title>expert_26_gate&#45;&gt;expert_26_expert</title>
<path fill="none" stroke="black" d="M9528,-391.29C9528,-374.21 9528,-356 9528,-356 9528,-356 9801.67,-356 9801.67,-356 9801.67,-356 9801.67,-355.97 9801.67,-355.97"/>
<polygon fill="black" stroke="black" points="9805.17,-365.67 9801.67,-355.67 9798.17,-365.67 9805.17,-365.67"/>
</g>
<!-- expert_26_multiply -->
<g id="node90" class="node">
<title>expert_26_multiply</title>
<polygon fill="lightblue" stroke="black" points="10797,-261.54 10300,-261.54 10300,-203.54 10797,-203.54 10797,-261.54"/>
<text text-anchor="middle" x="10548.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 26 Multiply</text>
<text text-anchor="middle" x="10548.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="10548.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="10548.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_26_expert&#45;&gt;expert_26_multiply -->
<g id="edge144" class="edge">
<title>expert_26_expert&#45;&gt;expert_26_multiply</title>
<path fill="none" stroke="black" d="M9951,-297.33C9951,-281.85 9951,-266 9951,-266 9951,-266 10310.33,-266 10310.33,-266 10310.33,-266 10310.33,-265.56 10310.33,-265.56"/>
<polygon fill="black" stroke="black" points="10313.83,-271.63 10310.33,-261.63 10306.83,-271.63 10313.83,-271.63"/>
</g>
<!-- expert_26_multiply&#45;&gt;token_gather -->
<g id="edge145" class="edge">
<title>expert_26_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M10548.5,-203.39C10548.5,-177.92 10548.5,-145 10548.5,-145 10548.5,-145 8219.13,-145 8219.13,-145"/>
<polygon fill="black" stroke="black" points="8219.13,-141.5 8209.13,-145 8219.13,-148.5 8219.13,-141.5"/>
</g>
<!-- expert_27_expert -->
<g id="node92" class="node">
<title>expert_27_expert</title>
<polygon fill="lightblue" stroke="black" points="10331,-355.54 10052,-355.54 10052,-297.54 10331,-297.54 10331,-355.54"/>
<text text-anchor="middle" x="10191.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 27 Expert</text>
<text text-anchor="middle" x="10191.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="10191.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="10191.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_27_gate&#45;&gt;expert_27_expert -->
<g id="edge148" class="edge">
<title>expert_27_gate&#45;&gt;expert_27_expert</title>
<path fill="none" stroke="black" d="M9848.33,-391.47C9848.33,-375.13 9848.33,-358 9848.33,-358 9848.33,-358 10098.67,-358 10098.67,-358 10098.67,-358 10098.67,-357.79 10098.67,-357.79"/>
<polygon fill="black" stroke="black" points="10102.17,-365.94 10098.67,-355.94 10095.17,-365.94 10102.17,-365.94"/>
</g>
<!-- expert_27_multiply -->
<g id="node93" class="node">
<title>expert_27_multiply</title>
<polygon fill="lightblue" stroke="black" points="11312,-261.54 10815,-261.54 10815,-203.54 11312,-203.54 11312,-261.54"/>
<text text-anchor="middle" x="11063.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 27 Multiply</text>
<text text-anchor="middle" x="11063.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="11063.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="11063.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_27_expert&#45;&gt;expert_27_multiply -->
<g id="edge149" class="edge">
<title>expert_27_expert&#45;&gt;expert_27_multiply</title>
<path fill="none" stroke="black" d="M10320.67,-297.43C10320.67,-283.16 10320.67,-269 10320.67,-269 10320.67,-269 10851.67,-269 10851.67,-269 10851.67,-269 10851.67,-268.26 10851.67,-268.26"/>
<polygon fill="black" stroke="black" points="10855.17,-271.62 10851.67,-261.62 10848.17,-271.62 10855.17,-271.62"/>
</g>
<!-- expert_27_multiply&#45;&gt;token_gather -->
<g id="edge150" class="edge">
<title>expert_27_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M11063.5,-203.32C11063.5,-176.53 11063.5,-141 11063.5,-141 11063.5,-141 8228.87,-141 8228.87,-141"/>
<polygon fill="black" stroke="black" points="8228.87,-137.5 8218.87,-141 8228.87,-144.5 8228.87,-137.5"/>
</g>
<!-- expert_28_expert -->
<g id="node95" class="node">
<title>expert_28_expert</title>
<polygon fill="lightblue" stroke="black" points="10628,-355.54 10349,-355.54 10349,-297.54 10628,-297.54 10628,-355.54"/>
<text text-anchor="middle" x="10488.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 28 Expert</text>
<text text-anchor="middle" x="10488.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="10488.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="10488.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_28_gate&#45;&gt;expert_28_expert -->
<g id="edge153" class="edge">
<title>expert_28_gate&#45;&gt;expert_28_expert</title>
<path fill="none" stroke="black" d="M10145.33,-391.21C10145.33,-375.36 10145.33,-359 10145.33,-359 10145.33,-359 10395.67,-359 10395.67,-359 10395.67,-359 10395.67,-358.68 10395.67,-358.68"/>
<polygon fill="black" stroke="black" points="10399.17,-365.77 10395.67,-355.77 10392.17,-365.77 10399.17,-365.77"/>
</g>
<!-- expert_28_multiply -->
<g id="node96" class="node">
<title>expert_28_multiply</title>
<polygon fill="lightblue" stroke="black" points="11827,-261.54 11330,-261.54 11330,-203.54 11827,-203.54 11827,-261.54"/>
<text text-anchor="middle" x="11578.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 28 Multiply</text>
<text text-anchor="middle" x="11578.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="11578.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="11578.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_28_expert&#45;&gt;expert_28_multiply -->
<g id="edge154" class="edge">
<title>expert_28_expert&#45;&gt;expert_28_multiply</title>
<path fill="none" stroke="black" d="M10488.5,-297.5C10488.5,-285.35 10488.5,-274 10488.5,-274 10488.5,-274 11393,-274 11393,-274 11393,-274 11393,-271.78 11393,-271.78"/>
<polygon fill="black" stroke="black" points="11396.5,-271.78 11393,-261.78 11389.5,-271.78 11396.5,-271.78"/>
</g>
<!-- expert_28_multiply&#45;&gt;token_gather -->
<g id="edge155" class="edge">
<title>expert_28_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M11578.5,-203.36C11578.5,-175.26 11578.5,-137 11578.5,-137 11578.5,-137 8235.21,-137 8235.21,-137"/>
<polygon fill="black" stroke="black" points="8235.21,-133.5 8225.21,-137 8235.21,-140.5 8235.21,-133.5"/>
</g>
<!-- expert_29_expert -->
<g id="node98" class="node">
<title>expert_29_expert</title>
<polygon fill="lightblue" stroke="black" points="10925,-355.54 10646,-355.54 10646,-297.54 10925,-297.54 10925,-355.54"/>
<text text-anchor="middle" x="10785.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 29 Expert</text>
<text text-anchor="middle" x="10785.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="10785.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="10785.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_29_gate&#45;&gt;expert_29_expert -->
<g id="edge158" class="edge">
<title>expert_29_gate&#45;&gt;expert_29_expert</title>
<path fill="none" stroke="black" d="M10442.33,-391.47C10442.33,-376.35 10442.33,-361 10442.33,-361 10442.33,-361 10692.67,-361 10692.67,-361 10692.67,-361 10692.67,-360.46 10692.67,-360.46"/>
<polygon fill="black" stroke="black" points="10696.17,-365.62 10692.67,-355.62 10689.17,-365.62 10696.17,-365.62"/>
</g>
<!-- expert_29_multiply -->
<g id="node99" class="node">
<title>expert_29_multiply</title>
<polygon fill="lightblue" stroke="black" points="12342,-261.54 11845,-261.54 11845,-203.54 12342,-203.54 12342,-261.54"/>
<text text-anchor="middle" x="12093.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 29 Multiply</text>
<text text-anchor="middle" x="12093.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="12093.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="12093.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_29_expert&#45;&gt;expert_29_multiply -->
<g id="edge159" class="edge">
<title>expert_29_expert&#45;&gt;expert_29_multiply</title>
<path fill="none" stroke="black" d="M10888.33,-297.44C10888.33,-286.65 10888.33,-277 10888.33,-277 10888.33,-277 11934.33,-277 11934.33,-277 11934.33,-277 11934.33,-271.95 11934.33,-271.95"/>
<polygon fill="black" stroke="black" points="11937.83,-271.95 11934.33,-261.95 11930.83,-271.95 11937.83,-271.95"/>
</g>
<!-- expert_29_multiply&#45;&gt;token_gather -->
<g id="edge160" class="edge">
<title>expert_29_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M12093.5,-203.46C12093.5,-173.77 12093.5,-132 12093.5,-132 12093.5,-132 8238.89,-132 8238.89,-132"/>
<polygon fill="black" stroke="black" points="8238.89,-128.5 8228.89,-132 8238.89,-135.5 8238.89,-128.5"/>
</g>
<!-- expert_30_expert -->
<g id="node101" class="node">
<title>expert_30_expert</title>
<polygon fill="lightblue" stroke="black" points="11222,-355.54 10943,-355.54 10943,-297.54 11222,-297.54 11222,-355.54"/>
<text text-anchor="middle" x="11082.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 30 Expert</text>
<text text-anchor="middle" x="11082.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="11082.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="11082.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_30_gate&#45;&gt;expert_30_expert -->
<g id="edge163" class="edge">
<title>expert_30_gate&#45;&gt;expert_30_expert</title>
<path fill="none" stroke="black" d="M10739.33,-391.27C10739.33,-376.63 10739.33,-362 10739.33,-362 10739.33,-362 10989.67,-362 10989.67,-362 10989.67,-362 10989.67,-361.38 10989.67,-361.38"/>
<polygon fill="black" stroke="black" points="10993.17,-365.82 10989.67,-355.82 10986.17,-365.82 10993.17,-365.82"/>
</g>
<!-- expert_30_multiply -->
<g id="node102" class="node">
<title>expert_30_multiply</title>
<polygon fill="lightblue" stroke="black" points="12857,-261.54 12360,-261.54 12360,-203.54 12857,-203.54 12857,-261.54"/>
<text text-anchor="middle" x="12608.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 30 Multiply</text>
<text text-anchor="middle" x="12608.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="12608.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="12608.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_30_expert&#45;&gt;expert_30_multiply -->
<g id="edge164" class="edge">
<title>expert_30_expert&#45;&gt;expert_30_multiply</title>
<path fill="none" stroke="black" d="M11082.5,-297.46C11082.5,-287.13 11082.5,-278 11082.5,-278 11082.5,-278 12429.33,-278 12429.33,-278 12429.33,-278 12429.33,-271.59 12429.33,-271.59"/>
<polygon fill="black" stroke="black" points="12432.83,-271.59 12429.33,-261.59 12425.83,-271.59 12432.83,-271.59"/>
</g>
<!-- expert_30_multiply&#45;&gt;token_gather -->
<g id="edge165" class="edge">
<title>expert_30_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M12608.5,-203.42C12608.5,-172.49 12608.5,-128 12608.5,-128 12608.5,-128 8238.06,-128 8238.06,-128"/>
<polygon fill="black" stroke="black" points="8238.06,-124.5 8228.06,-128 8238.06,-131.5 8238.06,-124.5"/>
</g>
<!-- expert_31_expert -->
<g id="node104" class="node">
<title>expert_31_expert</title>
<polygon fill="lightblue" stroke="black" points="11519,-355.54 11240,-355.54 11240,-297.54 11519,-297.54 11519,-355.54"/>
<text text-anchor="middle" x="11379.5" y="-340.54" font-family="Times,serif" font-size="10.00">Expert 31 Expert</text>
<text text-anchor="middle" x="11379.5" y="-329.54" font-family="Times,serif" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="11379.5" y="-318.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="11379.5" y="-307.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_31_gate&#45;&gt;expert_31_expert -->
<g id="edge168" class="edge">
<title>expert_31_gate&#45;&gt;expert_31_expert</title>
<path fill="none" stroke="black" d="M11036.33,-391.28C11036.33,-377.48 11036.33,-364 11036.33,-364 11036.33,-364 11286.67,-364 11286.67,-364 11286.67,-364 11286.67,-363.17 11286.67,-363.17"/>
<polygon fill="black" stroke="black" points="11290.17,-365.69 11286.67,-355.69 11283.17,-365.69 11290.17,-365.69"/>
</g>
<!-- expert_31_multiply -->
<g id="node105" class="node">
<title>expert_31_multiply</title>
<polygon fill="lightblue" stroke="black" points="13372,-261.54 12875,-261.54 12875,-203.54 13372,-203.54 13372,-261.54"/>
<text text-anchor="middle" x="13123.5" y="-246.54" font-family="Times,serif" font-size="10.00">Expert 31 Multiply</text>
<text text-anchor="middle" x="13123.5" y="-235.54" font-family="Times,serif" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="13123.5" y="-224.54" font-family="Times,serif" font-size="10.00">Input: [batch_size=4, seq_len=128, hidden=7168], [batch_size=4, seq_len=128, hidden=2048]</text>
<text text-anchor="middle" x="13123.5" y="-213.54" font-family="Times,serif" font-size="10.00">Output: [batch_size=4, seq_len=128, hidden=7168]</text>
</g>
<!-- expert_31_expert&#45;&gt;expert_31_multiply -->
<g id="edge169" class="edge">
<title>expert_31_expert&#45;&gt;expert_31_multiply</title>
<path fill="none" stroke="black" d="M11456,-297.33C11456,-287.98 11456,-280 11456,-280 11456,-280 12993.5,-280 12993.5,-280 12993.5,-280 12993.5,-271.79 12993.5,-271.79"/>
<polygon fill="black" stroke="black" points="12997,-271.79 12993.5,-261.79 12990,-271.79 12997,-271.79"/>
</g>
<!-- expert_31_multiply&#45;&gt;token_gather -->
<g id="edge170" class="edge">
<title>expert_31_multiply&#45;&gt;token_gather</title>
<path fill="none" stroke="black" d="M13123.5,-203.45C13123.5,-171.3 13123.5,-124 13123.5,-124 13123.5,-124 8234.51,-124 8234.51,-124"/>
<polygon fill="black" stroke="black" points="8234.51,-120.5 8224.51,-124 8234.51,-127.5 8234.51,-120.5"/>
</g>
<!-- token_gather&#45;&gt;layer_output -->
<g id="edge172" class="edge">
<title>token_gather&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M7857.69,-98C7214.71,-98 4112.67,-98 4112.67,-98 4112.67,-98 4112.67,-68.26 4112.67,-68.26"/>
<polygon fill="black" stroke="black" points="4116.17,-68.26 4112.67,-58.26 4109.17,-68.26 4116.17,-68.26"/>
</g>
</g>
</svg>
