<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_EP8_TP4_PP4_Layer Pages: 1 -->
<svg width="3612pt" height="535pt"
 viewBox="0.00 0.00 3611.53 535.15" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 531.15)">
<title>MoE_EP8_TP4_PP4_Layer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-531.15 3607.53,-531.15 3607.53,4 -4,4"/>
<!-- inp -->
<g id="node1" class="node">
<title>inp</title>
<polygon fill="none" stroke="black" points="2512,-441.15 2416,-441.15 2416,-391.15 2512,-391.15 2512,-441.15"/>
<text text-anchor="middle" x="2464" y="-430.15" font-family="Times,serif" font-size="10.00">LayerInput</text>
<text text-anchor="middle" x="2464" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 0&#45;127</text>
<text text-anchor="middle" x="2464" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2464" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- ln_0 -->
<g id="node2" class="node">
<title>ln_0</title>
<polygon fill="none" stroke="black" points="2692,-341.15 2596,-341.15 2596,-291.15 2692,-291.15 2692,-341.15"/>
<text text-anchor="middle" x="2644" y="-330.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2644" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2644" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2644" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- inp&#45;&gt;ln_0 -->
<g id="edge1" class="edge">
<title>inp&#45;&gt;ln_0</title>
<path fill="none" stroke="black" d="M2512.02,-391.11C2533.04,-380.38 2557.89,-367.42 2580,-355.15 2585.07,-352.34 2590.32,-349.35 2595.55,-346.33"/>
<polygon fill="black" stroke="black" points="2597.39,-349.3 2604.26,-341.23 2593.86,-343.25 2597.39,-349.3"/>
</g>
<!-- ln_1 -->
<g id="node3" class="node">
<title>ln_1</title>
<polygon fill="none" stroke="black" points="2453,-341.15 2357,-341.15 2357,-291.15 2453,-291.15 2453,-341.15"/>
<text text-anchor="middle" x="2405" y="-330.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2405" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2405" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2405" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- inp&#45;&gt;ln_1 -->
<g id="edge2" class="edge">
<title>inp&#45;&gt;ln_1</title>
<path fill="none" stroke="black" d="M2449.42,-390.93C2442.04,-378.68 2432.98,-363.63 2424.97,-350.32"/>
<polygon fill="black" stroke="black" points="2427.78,-348.2 2419.62,-341.44 2421.78,-351.81 2427.78,-348.2"/>
</g>
<!-- ln_2 -->
<g id="node4" class="node">
<title>ln_2</title>
<polygon fill="none" stroke="black" points="2335,-341.15 2239,-341.15 2239,-291.15 2335,-291.15 2335,-341.15"/>
<text text-anchor="middle" x="2287" y="-330.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2287" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2287" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2287" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- inp&#45;&gt;ln_2 -->
<g id="edge3" class="edge">
<title>inp&#45;&gt;ln_2</title>
<path fill="none" stroke="black" d="M2415.85,-391.33C2394.81,-380.65 2369.97,-367.66 2348,-355.15 2343.26,-352.46 2338.35,-349.57 2333.48,-346.64"/>
<polygon fill="black" stroke="black" points="2335.15,-343.56 2324.79,-341.35 2331.51,-349.54 2335.15,-343.56"/>
</g>
<!-- ln_3 -->
<g id="node5" class="node">
<title>ln_3</title>
<polygon fill="none" stroke="black" points="2571,-341.15 2475,-341.15 2475,-291.15 2571,-291.15 2571,-341.15"/>
<text text-anchor="middle" x="2523" y="-330.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2523" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2523" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2523" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- inp&#45;&gt;ln_3 -->
<g id="edge4" class="edge">
<title>inp&#45;&gt;ln_3</title>
<path fill="none" stroke="black" d="M2478.58,-390.93C2485.96,-378.68 2495.02,-363.63 2503.03,-350.32"/>
<polygon fill="black" stroke="black" points="2506.22,-351.81 2508.38,-341.44 2500.22,-348.2 2506.22,-351.81"/>
</g>
<!-- 0 -->
<g id="node11" class="node">
<title>0</title>
<ellipse fill="none" stroke="black" cx="1403" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="1403" y="-15.5" font-family="Times,serif" font-size="10.00">0</text>
</g>
<!-- inp&#45;&gt;0 -->
<g id="edge33" class="edge">
<title>inp&#45;&gt;0</title>
<path fill="none" stroke="black" d="M2415.84,-414.09C2257.57,-410.24 1760.2,-395.03 1701,-355.15 1668.85,-333.5 1693.44,-299.82 1662,-277.15 1570.22,-211 1485.46,-325.45 1410,-241.15 1361.3,-186.76 1380.76,-91.43 1394.23,-45.38"/>
<polygon fill="black" stroke="black" points="1397.58,-46.4 1397.15,-35.82 1390.88,-44.36 1397.58,-46.4"/>
</g>
<!-- 1 -->
<g id="node13" class="node">
<title>1</title>
<ellipse fill="none" stroke="black" cx="2193" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="2193" y="-15.5" font-family="Times,serif" font-size="10.00">1</text>
</g>
<!-- inp&#45;&gt;1 -->
<g id="edge34" class="edge">
<title>inp&#45;&gt;1</title>
<path fill="none" stroke="black" d="M2512.1,-411.65C2583.26,-405.37 2711.31,-389.5 2740,-355.15 2761.6,-329.3 2764.21,-94.24 2744,-72 2709.46,-33.98 2348.31,-22.5 2230.17,-19.75"/>
<polygon fill="black" stroke="black" points="2230.23,-16.25 2220.15,-19.52 2230.07,-23.25 2230.23,-16.25"/>
</g>
<!-- 2 -->
<g id="node14" class="node">
<title>2</title>
<ellipse fill="none" stroke="black" cx="1531" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="1531" y="-15.5" font-family="Times,serif" font-size="10.00">2</text>
</g>
<!-- inp&#45;&gt;2 -->
<g id="edge35" class="edge">
<title>inp&#45;&gt;2</title>
<path fill="none" stroke="black" d="M2415.84,-403.62C2368.38,-392.07 2293.91,-373.43 2230,-355.15 2119.31,-323.51 2096.15,-298.39 1983,-277.15 1922.7,-265.83 1473.94,-285.93 1432,-241.15 1375.49,-180.83 1463.28,-82.87 1507.74,-40.1"/>
<polygon fill="black" stroke="black" points="1510.37,-42.43 1515.24,-33.01 1505.56,-37.34 1510.37,-42.43"/>
</g>
<!-- 3 -->
<g id="node15" class="node">
<title>3</title>
<ellipse fill="none" stroke="black" cx="2047" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="2047" y="-15.5" font-family="Times,serif" font-size="10.00">3</text>
</g>
<!-- inp&#45;&gt;3 -->
<g id="edge36" class="edge">
<title>inp&#45;&gt;3</title>
<path fill="none" stroke="black" d="M2512.14,-409.54C2574.14,-401.24 2676.83,-383.56 2701,-355.15 2728.69,-322.62 2737.13,-196.96 2711,-163.15 2612.7,-35.97 2518.18,-105.67 2361,-72 2308.42,-60.74 2154.46,-35.99 2083.54,-24.75"/>
<polygon fill="black" stroke="black" points="2083.72,-21.24 2073.3,-23.13 2082.63,-28.15 2083.72,-21.24"/>
</g>
<!-- qkv_0 -->
<g id="node6" class="node">
<title>qkv_0</title>
<polygon fill="none" stroke="black" points="2701.5,-227.15 2596.5,-227.15 2596.5,-177.15 2701.5,-177.15 2701.5,-227.15"/>
<text text-anchor="middle" x="2649" y="-216.15" font-family="Times,serif" font-size="10.00">QKV_Proj(col)</text>
<text text-anchor="middle" x="2649" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2649" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2649" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,3h/4=768]</text>
</g>
<!-- ln_0&#45;&gt;qkv_0 -->
<g id="edge5" class="edge">
<title>ln_0&#45;&gt;qkv_0</title>
<path fill="none" stroke="black" d="M2645.07,-291.13C2645.77,-275.58 2646.68,-255.1 2647.45,-237.81"/>
<polygon fill="black" stroke="black" points="2650.96,-237.67 2647.91,-227.53 2643.97,-237.36 2650.96,-237.67"/>
</g>
<!-- qkv_1 -->
<g id="node7" class="node">
<title>qkv_1</title>
<polygon fill="none" stroke="black" points="2455.5,-227.15 2350.5,-227.15 2350.5,-177.15 2455.5,-177.15 2455.5,-227.15"/>
<text text-anchor="middle" x="2403" y="-216.15" font-family="Times,serif" font-size="10.00">QKV_Proj(col)</text>
<text text-anchor="middle" x="2403" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2403" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2403" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,3h/4=768]</text>
</g>
<!-- ln_1&#45;&gt;qkv_1 -->
<g id="edge6" class="edge">
<title>ln_1&#45;&gt;qkv_1</title>
<path fill="none" stroke="black" d="M2404.57,-291.13C2404.29,-275.58 2403.93,-255.1 2403.62,-237.81"/>
<polygon fill="black" stroke="black" points="2407.11,-237.46 2403.44,-227.53 2400.11,-237.59 2407.11,-237.46"/>
</g>
<!-- qkv_2 -->
<g id="node8" class="node">
<title>qkv_2</title>
<polygon fill="none" stroke="black" points="2332.5,-227.15 2227.5,-227.15 2227.5,-177.15 2332.5,-177.15 2332.5,-227.15"/>
<text text-anchor="middle" x="2280" y="-216.15" font-family="Times,serif" font-size="10.00">QKV_Proj(col)</text>
<text text-anchor="middle" x="2280" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2280" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2280" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,3h/4=768]</text>
</g>
<!-- ln_2&#45;&gt;qkv_2 -->
<g id="edge7" class="edge">
<title>ln_2&#45;&gt;qkv_2</title>
<path fill="none" stroke="black" d="M2285.5,-291.13C2284.53,-275.58 2283.25,-255.1 2282.17,-237.81"/>
<polygon fill="black" stroke="black" points="2285.64,-237.29 2281.52,-227.53 2278.65,-237.73 2285.64,-237.29"/>
</g>
<!-- qkv_3 -->
<g id="node9" class="node">
<title>qkv_3</title>
<polygon fill="none" stroke="black" points="2578.5,-227.15 2473.5,-227.15 2473.5,-177.15 2578.5,-177.15 2578.5,-227.15"/>
<text text-anchor="middle" x="2526" y="-216.15" font-family="Times,serif" font-size="10.00">QKV_Proj(col)</text>
<text text-anchor="middle" x="2526" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2526" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2526" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,3h/4=768]</text>
</g>
<!-- ln_3&#45;&gt;qkv_3 -->
<g id="edge8" class="edge">
<title>ln_3&#45;&gt;qkv_3</title>
<path fill="none" stroke="black" d="M2523.64,-291.13C2524.06,-275.58 2524.61,-255.1 2525.07,-237.81"/>
<polygon fill="black" stroke="black" points="2528.58,-237.62 2525.35,-227.53 2521.58,-237.43 2528.58,-237.62"/>
</g>
<!-- ag_qkv -->
<g id="node10" class="node">
<title>ag_qkv</title>
<ellipse fill="none" stroke="black" cx="2280" cy="-99.58" rx="72.25" ry="27.65"/>
<text text-anchor="middle" x="2280" y="-108.08" font-family="Times,serif" font-size="10.00">AllGather(QKV)</text>
<text text-anchor="middle" x="2280" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s,3h/4=768]</text>
<text text-anchor="middle" x="2280" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s,3h=3072]</text>
</g>
<!-- qkv_0&#45;&gt;ag_qkv -->
<g id="edge9" class="edge">
<title>qkv_0&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2614.98,-177C2606.47,-171.81 2597.16,-166.8 2588,-163.15 2513.41,-133.47 2422.82,-117.23 2359.26,-108.8"/>
<polygon fill="black" stroke="black" points="2359.67,-105.32 2349.3,-107.51 2358.77,-112.26 2359.67,-105.32"/>
</g>
<!-- qkv_1&#45;&gt;ag_qkv -->
<g id="edge10" class="edge">
<title>qkv_1&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2373.54,-177.06C2356.77,-163.36 2335.6,-146.04 2317.65,-131.36"/>
<polygon fill="black" stroke="black" points="2319.6,-128.44 2309.65,-124.82 2315.17,-133.86 2319.6,-128.44"/>
</g>
<!-- qkv_2&#45;&gt;ag_qkv -->
<g id="edge11" class="edge">
<title>qkv_2&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2280,-177.06C2280,-165.23 2280,-150.72 2280,-137.52"/>
<polygon fill="black" stroke="black" points="2283.5,-137.3 2280,-127.3 2276.5,-137.3 2283.5,-137.3"/>
</g>
<!-- qkv_3&#45;&gt;ag_qkv -->
<g id="edge12" class="edge">
<title>qkv_3&#45;&gt;ag_qkv</title>
<path fill="none" stroke="black" d="M2490.33,-177.03C2482.2,-172.07 2473.46,-167.15 2465,-163.15 2427.32,-145.34 2383.16,-130.2 2347.44,-119.28"/>
<polygon fill="black" stroke="black" points="2348.18,-115.85 2337.6,-116.31 2346.16,-122.55 2348.18,-115.85"/>
</g>
<!-- ag_qkv&#45;&gt;0 -->
<g id="edge13" class="edge">
<title>ag_qkv&#45;&gt;0</title>
<path fill="none" stroke="black" d="M2229.55,-79.74C2219.55,-76.66 2209.04,-73.87 2199,-72 1890.99,-14.66 1806.16,-72.54 1495,-36 1476.16,-33.79 1455.37,-30.06 1438.32,-26.65"/>
<polygon fill="black" stroke="black" points="1438.74,-23.17 1428.25,-24.59 1437.34,-30.02 1438.74,-23.17"/>
</g>
<!-- ag_qkv&#45;&gt;1 -->
<g id="edge14" class="edge">
<title>ag_qkv&#45;&gt;1</title>
<path fill="none" stroke="black" d="M2252.95,-73.83C2241.03,-62.94 2227.19,-50.27 2215.81,-39.86"/>
<polygon fill="black" stroke="black" points="2218.12,-37.23 2208.37,-33.06 2213.39,-42.39 2218.12,-37.23"/>
</g>
<!-- ag_qkv&#45;&gt;2 -->
<g id="edge15" class="edge">
<title>ag_qkv&#45;&gt;2</title>
<path fill="none" stroke="black" d="M2229.07,-79.83C2219.21,-76.78 2208.87,-73.98 2199,-72 1962.15,-24.45 1670.03,-19.17 1568.14,-18.87"/>
<polygon fill="black" stroke="black" points="1568.05,-15.37 1558.04,-18.85 1568.04,-22.37 1568.05,-15.37"/>
</g>
<!-- ag_qkv&#45;&gt;3 -->
<g id="edge16" class="edge">
<title>ag_qkv&#45;&gt;3</title>
<path fill="none" stroke="black" d="M2227.42,-80.62C2182.32,-65.22 2118.72,-43.5 2080.32,-30.38"/>
<polygon fill="black" stroke="black" points="2081.26,-27 2070.66,-27.08 2078.99,-33.63 2081.26,-27"/>
</g>
<!-- _qkv_full -->
<g id="node12" class="node">
<title>_qkv_full</title>
<polygon fill="none" stroke="black" points="3072,-441.15 2970,-441.15 2970,-391.15 3072,-391.15 3072,-441.15"/>
<text text-anchor="middle" x="3021" y="-430.15" font-family="Times,serif" font-size="10.00">QKV_full</text>
<text text-anchor="middle" x="3021" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3021" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,3h=3072]</text>
<text text-anchor="middle" x="3021" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,3h=3072]</text>
</g>
<!-- attn_0 -->
<g id="node16" class="node">
<title>attn_0</title>
<polygon fill="none" stroke="black" points="2927.5,-341.15 2792.5,-341.15 2792.5,-291.15 2927.5,-291.15 2927.5,-341.15"/>
<text text-anchor="middle" x="2860" y="-330.15" font-family="Times,serif" font-size="10.00">Attention(heads=16/4=4)</text>
<text text-anchor="middle" x="2860" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2860" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,3h=3072]</text>
<text text-anchor="middle" x="2860" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _qkv_full&#45;&gt;attn_0 -->
<g id="edge17" class="edge">
<title>_qkv_full&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M2981.2,-390.93C2959.16,-377.51 2931.58,-360.73 2908.31,-346.56"/>
<polygon fill="black" stroke="black" points="2909.98,-343.48 2899.62,-341.27 2906.34,-349.46 2909.98,-343.48"/>
</g>
<!-- attn_1 -->
<g id="node17" class="node">
<title>attn_1</title>
<polygon fill="none" stroke="black" points="3080.5,-341.15 2945.5,-341.15 2945.5,-291.15 3080.5,-291.15 3080.5,-341.15"/>
<text text-anchor="middle" x="3013" y="-330.15" font-family="Times,serif" font-size="10.00">Attention(heads=16/4=4)</text>
<text text-anchor="middle" x="3013" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="3013" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,3h=3072]</text>
<text text-anchor="middle" x="3013" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _qkv_full&#45;&gt;attn_1 -->
<g id="edge18" class="edge">
<title>_qkv_full&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M3019.02,-390.93C3018.05,-379.03 3016.86,-364.49 3015.8,-351.47"/>
<polygon fill="black" stroke="black" points="3019.28,-351.12 3014.98,-341.44 3012.31,-351.69 3019.28,-351.12"/>
</g>
<!-- attn_2 -->
<g id="node18" class="node">
<title>attn_2</title>
<polygon fill="none" stroke="black" points="3233.5,-341.15 3098.5,-341.15 3098.5,-291.15 3233.5,-291.15 3233.5,-341.15"/>
<text text-anchor="middle" x="3166" y="-330.15" font-family="Times,serif" font-size="10.00">Attention(heads=16/4=4)</text>
<text text-anchor="middle" x="3166" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3166" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,3h=3072]</text>
<text text-anchor="middle" x="3166" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _qkv_full&#45;&gt;attn_2 -->
<g id="edge19" class="edge">
<title>_qkv_full&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M3056.84,-390.93C3076.52,-377.63 3101.09,-361.02 3121.94,-346.93"/>
<polygon fill="black" stroke="black" points="3123.99,-349.77 3130.32,-341.27 3120.07,-343.97 3123.99,-349.77"/>
</g>
<!-- attn_3 -->
<g id="node19" class="node">
<title>attn_3</title>
<polygon fill="none" stroke="black" points="3386.5,-341.15 3251.5,-341.15 3251.5,-291.15 3386.5,-291.15 3386.5,-341.15"/>
<text text-anchor="middle" x="3319" y="-330.15" font-family="Times,serif" font-size="10.00">Attention(heads=16/4=4)</text>
<text text-anchor="middle" x="3319" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3319" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,3h=3072]</text>
<text text-anchor="middle" x="3319" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _qkv_full&#45;&gt;attn_3 -->
<g id="edge20" class="edge">
<title>_qkv_full&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M3072.38,-398.44C3080.59,-395.91 3089.01,-393.4 3097,-391.15 3161.34,-373.08 3180.28,-378.24 3243,-355.15 3250.4,-352.43 3258.02,-349.19 3265.45,-345.76"/>
<polygon fill="black" stroke="black" points="3267.2,-348.81 3274.72,-341.35 3264.19,-342.49 3267.2,-348.81"/>
</g>
<!-- attn_out_0 -->
<g id="node20" class="node">
<title>attn_out_0</title>
<polygon fill="none" stroke="black" points="2914.5,-227.15 2815.5,-227.15 2815.5,-177.15 2914.5,-177.15 2914.5,-227.15"/>
<text text-anchor="middle" x="2865" y="-216.15" font-family="Times,serif" font-size="10.00">AttnOut(row)</text>
<text text-anchor="middle" x="2865" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2865" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2865" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h/4=256]</text>
</g>
<!-- attn_0&#45;&gt;attn_out_0 -->
<g id="edge21" class="edge">
<title>attn_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M2861.07,-291.13C2861.77,-275.58 2862.68,-255.1 2863.45,-237.81"/>
<polygon fill="black" stroke="black" points="2866.96,-237.67 2863.91,-227.53 2859.97,-237.36 2866.96,-237.67"/>
</g>
<!-- attn_out_1 -->
<g id="node21" class="node">
<title>attn_out_1</title>
<polygon fill="none" stroke="black" points="3048.5,-227.15 2949.5,-227.15 2949.5,-177.15 3048.5,-177.15 3048.5,-227.15"/>
<text text-anchor="middle" x="2999" y="-216.15" font-family="Times,serif" font-size="10.00">AttnOut(row)</text>
<text text-anchor="middle" x="2999" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2999" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="2999" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h/4=256]</text>
</g>
<!-- attn_1&#45;&gt;attn_out_1 -->
<g id="edge22" class="edge">
<title>attn_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M3010,-291.13C3008.05,-275.58 3005.49,-255.1 3003.33,-237.81"/>
<polygon fill="black" stroke="black" points="3006.76,-237.02 3002.05,-227.53 2999.81,-237.88 3006.76,-237.02"/>
</g>
<!-- attn_out_2 -->
<g id="node22" class="node">
<title>attn_out_2</title>
<polygon fill="none" stroke="black" points="3190.5,-227.15 3091.5,-227.15 3091.5,-177.15 3190.5,-177.15 3190.5,-227.15"/>
<text text-anchor="middle" x="3141" y="-216.15" font-family="Times,serif" font-size="10.00">AttnOut(row)</text>
<text text-anchor="middle" x="3141" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3141" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3141" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h/4=256]</text>
</g>
<!-- attn_2&#45;&gt;attn_out_2 -->
<g id="edge23" class="edge">
<title>attn_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M3160.64,-291.13C3157.13,-275.44 3152.51,-254.71 3148.63,-237.32"/>
<polygon fill="black" stroke="black" points="3152.04,-236.53 3146.44,-227.53 3145.2,-238.05 3152.04,-236.53"/>
</g>
<!-- attn_out_3 -->
<g id="node23" class="node">
<title>attn_out_3</title>
<polygon fill="none" stroke="black" points="3338.5,-227.15 3239.5,-227.15 3239.5,-177.15 3338.5,-177.15 3338.5,-227.15"/>
<text text-anchor="middle" x="3289" y="-216.15" font-family="Times,serif" font-size="10.00">AttnOut(row)</text>
<text text-anchor="middle" x="3289" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3289" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3289" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h/4=256]</text>
</g>
<!-- attn_3&#45;&gt;attn_out_3 -->
<g id="edge24" class="edge">
<title>attn_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M3312.56,-291.13C3308.36,-275.44 3302.81,-254.71 3298.15,-237.32"/>
<polygon fill="black" stroke="black" points="3301.5,-236.28 3295.53,-227.53 3294.74,-238.09 3301.5,-236.28"/>
</g>
<!-- ar_attn -->
<g id="node24" class="node">
<title>ar_attn</title>
<ellipse fill="none" stroke="black" cx="2871" cy="-99.58" rx="74.91" ry="27.65"/>
<text text-anchor="middle" x="2871" y="-108.08" font-family="Times,serif" font-size="10.00">AllReduce(AttnOut)</text>
<text text-anchor="middle" x="2871" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s,h/4=256]</text>
<text text-anchor="middle" x="2871" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- attn_out_0&#45;&gt;ar_attn -->
<g id="edge25" class="edge">
<title>attn_out_0&#45;&gt;ar_attn</title>
<path fill="none" stroke="black" d="M2866.44,-177.06C2867.14,-165.23 2868.01,-150.72 2868.8,-137.52"/>
<polygon fill="black" stroke="black" points="2872.3,-137.49 2869.41,-127.3 2865.32,-137.08 2872.3,-137.49"/>
</g>
<!-- attn_out_1&#45;&gt;ar_attn -->
<g id="edge26" class="edge">
<title>attn_out_1&#45;&gt;ar_attn</title>
<path fill="none" stroke="black" d="M2968.34,-177.06C2950.82,-163.29 2928.67,-145.89 2909.92,-131.16"/>
<polygon fill="black" stroke="black" points="2911.88,-128.25 2901.85,-124.82 2907.55,-133.75 2911.88,-128.25"/>
</g>
<!-- attn_out_2&#45;&gt;ar_attn -->
<g id="edge27" class="edge">
<title>attn_out_2&#45;&gt;ar_attn</title>
<path fill="none" stroke="black" d="M3091.34,-177.38C3080.44,-172.45 3068.91,-167.46 3058,-163.15 3018.56,-147.58 2973.51,-132.43 2937.52,-120.93"/>
<polygon fill="black" stroke="black" points="2938.2,-117.48 2927.61,-117.79 2936.09,-124.15 2938.2,-117.48"/>
</g>
<!-- attn_out_3&#45;&gt;ar_attn -->
<g id="edge28" class="edge">
<title>attn_out_3&#45;&gt;ar_attn</title>
<path fill="none" stroke="black" d="M3239.34,-177.72C3226.71,-172.38 3213.02,-167.12 3200,-163.15 3116.81,-137.81 3018.52,-120.72 2951.18,-110.89"/>
<polygon fill="black" stroke="black" points="2951.45,-107.39 2941.05,-109.43 2950.45,-114.32 2951.45,-107.39"/>
</g>
<!-- ar_attn&#45;&gt;0 -->
<g id="edge29" class="edge">
<title>ar_attn&#45;&gt;0</title>
<path fill="none" stroke="black" d="M2797.11,-94.48C2697.92,-89.04 2516.21,-79.27 2361,-72 1976.2,-53.98 1877.8,-79.11 1495,-36 1476.15,-33.88 1455.36,-30.15 1438.32,-26.73"/>
<polygon fill="black" stroke="black" points="1438.74,-23.25 1428.24,-24.66 1437.33,-30.1 1438.74,-23.25"/>
</g>
<!-- ar_attn&#45;&gt;1 -->
<g id="edge30" class="edge">
<title>ar_attn&#45;&gt;1</title>
<path fill="none" stroke="black" d="M2816.35,-80.39C2805.1,-77.17 2793.24,-74.16 2782,-72 2575.94,-32.38 2323.5,-22.24 2230.06,-19.76"/>
<polygon fill="black" stroke="black" points="2230.06,-16.26 2219.98,-19.51 2229.89,-23.26 2230.06,-16.26"/>
</g>
<!-- ar_attn&#45;&gt;2 -->
<g id="edge31" class="edge">
<title>ar_attn&#45;&gt;2</title>
<path fill="none" stroke="black" d="M2797.05,-94.19C2548.65,-79.43 1749.64,-31.98 1567.98,-21.2"/>
<polygon fill="black" stroke="black" points="1568.06,-17.69 1557.87,-20.6 1567.65,-24.68 1568.06,-17.69"/>
</g>
<!-- ar_attn&#45;&gt;3 -->
<g id="edge32" class="edge">
<title>ar_attn&#45;&gt;3</title>
<path fill="none" stroke="black" d="M2809.3,-83.79C2788.65,-79.34 2765.43,-74.88 2744,-72 2484.96,-37.14 2416.88,-63.99 2157,-36 2132.07,-33.31 2104.15,-28.98 2082.68,-25.37"/>
<polygon fill="black" stroke="black" points="2083.14,-21.89 2072.69,-23.66 2081.96,-28.79 2083.14,-21.89"/>
</g>
<!-- _attn_resid -->
<g id="node25" class="node">
<title>_attn_resid</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="2028,-527.15 1932,-527.15 1932,-477.15 2028,-477.15 2028,-527.15"/>
<text text-anchor="middle" x="1980" y="-516.15" font-family="Times,serif" font-size="10.00">Attn+Residual</text>
<text text-anchor="middle" x="1980" y="-505.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1980" y="-494.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="1980" y="-483.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- ln_moe_0 -->
<g id="node26" class="node">
<title>ln_moe_0</title>
<polygon fill="none" stroke="black" points="228,-441.15 132,-441.15 132,-391.15 228,-391.15 228,-441.15"/>
<text text-anchor="middle" x="180" y="-430.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="180" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="180" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="180" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;ln_moe_0 -->
<g id="edge37" class="edge">
<title>_attn_resid&#45;&gt;ln_moe_0</title>
<path fill="none" stroke="black" d="M1931.82,-501.03C1689.14,-500.16 599.09,-493.38 265,-441.15 256.1,-439.76 246.81,-437.75 237.77,-435.46"/>
<polygon fill="black" stroke="black" points="238.66,-432.08 228.1,-432.9 236.87,-438.85 238.66,-432.08"/>
</g>
<!-- ln_moe_1 -->
<g id="node27" class="node">
<title>ln_moe_1</title>
<polygon fill="none" stroke="black" points="370,-441.15 274,-441.15 274,-391.15 370,-391.15 370,-441.15"/>
<text text-anchor="middle" x="322" y="-430.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="322" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="322" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="322" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;ln_moe_1 -->
<g id="edge38" class="edge">
<title>_attn_resid&#45;&gt;ln_moe_1</title>
<path fill="none" stroke="black" d="M1931.71,-501.3C1744,-501.42 1044.94,-497.79 473,-441.15 442.18,-438.1 408.09,-432.85 380.11,-428.03"/>
<polygon fill="black" stroke="black" points="380.55,-424.55 370.1,-426.28 379.34,-431.45 380.55,-424.55"/>
</g>
<!-- ln_moe_2 -->
<g id="node28" class="node">
<title>ln_moe_2</title>
<polygon fill="none" stroke="black" points="844,-441.15 748,-441.15 748,-391.15 844,-391.15 844,-441.15"/>
<text text-anchor="middle" x="796" y="-430.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="796" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="796" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="796" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;ln_moe_2 -->
<g id="edge39" class="edge">
<title>_attn_resid&#45;&gt;ln_moe_2</title>
<path fill="none" stroke="black" d="M1931.75,-497.73C1743.57,-484.38 1059.23,-435.83 854.35,-421.29"/>
<polygon fill="black" stroke="black" points="854.32,-417.78 844.1,-420.57 853.83,-424.77 854.32,-417.78"/>
</g>
<!-- ln_moe_3 -->
<g id="node29" class="node">
<title>ln_moe_3</title>
<polygon fill="none" stroke="black" points="578,-441.15 482,-441.15 482,-391.15 578,-391.15 578,-441.15"/>
<text text-anchor="middle" x="530" y="-430.15" font-family="Times,serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="530" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="530" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="530" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;ln_moe_3 -->
<g id="edge40" class="edge">
<title>_attn_resid&#45;&gt;ln_moe_3</title>
<path fill="none" stroke="black" d="M1931.72,-499.97C1765.64,-495.64 1202.57,-478.94 739,-441.15 687.88,-436.99 629.96,-430.17 588.08,-424.87"/>
<polygon fill="black" stroke="black" points="588.42,-421.38 578.06,-423.59 587.53,-428.32 588.42,-421.38"/>
</g>
<!-- out_0 -->
<g id="node63" class="node">
<title>out_0</title>
<polygon fill="none" stroke="black" points="3316,-441.15 3220,-441.15 3220,-391.15 3316,-391.15 3316,-441.15"/>
<text text-anchor="middle" x="3268" y="-430.15" font-family="Times,serif" font-size="10.00">MoE+Residual</text>
<text text-anchor="middle" x="3268" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="3268" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3268" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;out_0 -->
<g id="edge97" class="edge">
<title>_attn_resid&#45;&gt;out_0</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M2028.12,-501.04C2223.6,-500.25 2959.3,-493.91 3209.74,-441"/>
<polygon fill="gray" stroke="gray" points="3210.86,-444.33 3219.87,-438.77 3209.35,-437.5 3210.86,-444.33"/>
</g>
<!-- out_1 -->
<g id="node64" class="node">
<title>out_1</title>
<polygon fill="none" stroke="black" points="3430,-441.15 3334,-441.15 3334,-391.15 3430,-391.15 3430,-441.15"/>
<text text-anchor="middle" x="3382" y="-430.15" font-family="Times,serif" font-size="10.00">MoE+Residual</text>
<text text-anchor="middle" x="3382" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="3382" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3382" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;out_1 -->
<g id="edge98" class="edge">
<title>_attn_resid&#45;&gt;out_1</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M2028.26,-501.27C2235.37,-501.45 3050.37,-498.53 3323.98,-440.94"/>
<polygon fill="gray" stroke="gray" points="3324.85,-444.34 3333.88,-438.78 3323.36,-437.5 3324.85,-444.34"/>
</g>
<!-- out_2 -->
<g id="node65" class="node">
<title>out_2</title>
<polygon fill="none" stroke="black" points="3544,-441.15 3448,-441.15 3448,-391.15 3544,-391.15 3544,-441.15"/>
<text text-anchor="middle" x="3496" y="-430.15" font-family="Times,serif" font-size="10.00">MoE+Residual</text>
<text text-anchor="middle" x="3496" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3496" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3496" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;out_2 -->
<g id="edge99" class="edge">
<title>_attn_resid&#45;&gt;out_2</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M2028.22,-501.47C2246.14,-502.55 3140.87,-503.19 3437.99,-440.94"/>
<polygon fill="gray" stroke="gray" points="3438.85,-444.34 3447.88,-438.8 3437.36,-437.5 3438.85,-444.34"/>
</g>
<!-- out_3 -->
<g id="node66" class="node">
<title>out_3</title>
<polygon fill="none" stroke="black" points="3202,-441.15 3106,-441.15 3106,-391.15 3202,-391.15 3202,-441.15"/>
<text text-anchor="middle" x="3154" y="-430.15" font-family="Times,serif" font-size="10.00">MoE+Residual</text>
<text text-anchor="middle" x="3154" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3154" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3154" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _attn_resid&#45;&gt;out_3 -->
<g id="edge100" class="edge">
<title>_attn_resid&#45;&gt;out_3</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M2028.17,-500.21C2212.7,-496.35 2874.53,-480.01 3081,-441.15 3085.95,-440.22 3091.03,-439.04 3096.1,-437.71"/>
<polygon fill="gray" stroke="gray" points="3097.1,-441.06 3105.78,-434.98 3095.2,-434.32 3097.1,-441.06"/>
</g>
<!-- gate_0 -->
<g id="node30" class="node">
<title>gate_0</title>
<polygon fill="none" stroke="black" points="143,-341.15 29,-341.15 29,-291.15 143,-291.15 143,-341.15"/>
<text text-anchor="middle" x="86" y="-330.15" font-family="Times,serif" font-size="10.00">Gate(h&#45;&gt;64E)</text>
<text text-anchor="middle" x="86" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="86" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="86" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,64E=64*64]</text>
</g>
<!-- ln_moe_0&#45;&gt;gate_0 -->
<g id="edge41" class="edge">
<title>ln_moe_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M156.76,-390.93C144.56,-378.21 129.46,-362.46 116.35,-348.79"/>
<polygon fill="black" stroke="black" points="118.74,-346.23 109.29,-341.44 113.69,-351.08 118.74,-346.23"/>
</g>
<!-- a2a_disp -->
<g id="node38" class="node">
<title>a2a_disp</title>
<ellipse fill="none" stroke="black" cx="615" cy="-99.58" rx="98.99" ry="27.65"/>
<text text-anchor="middle" x="615" y="-108.08" font-family="Times,serif" font-size="10.00">AllToAll(Dispatch)</text>
<text text-anchor="middle" x="615" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024] + indices</text>
<text text-anchor="middle" x="615" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024] (routed)</text>
</g>
<!-- ln_moe_0&#45;&gt;a2a_disp -->
<g id="edge49" class="edge">
<title>ln_moe_0&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" d="M173.67,-390.81C162.28,-340.8 144.67,-225.91 204,-163.15 244.17,-120.66 398.12,-106.89 505.75,-102.51"/>
<polygon fill="black" stroke="black" points="506.15,-105.99 516.01,-102.11 505.88,-99 506.15,-105.99"/>
</g>
<!-- gate_1 -->
<g id="node31" class="node">
<title>gate_1</title>
<polygon fill="none" stroke="black" points="379,-341.15 265,-341.15 265,-291.15 379,-291.15 379,-341.15"/>
<text text-anchor="middle" x="322" y="-330.15" font-family="Times,serif" font-size="10.00">Gate(h&#45;&gt;64E)</text>
<text text-anchor="middle" x="322" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="322" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="322" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,64E=64*64]</text>
</g>
<!-- ln_moe_1&#45;&gt;gate_1 -->
<g id="edge42" class="edge">
<title>ln_moe_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M322,-390.93C322,-379.03 322,-364.49 322,-351.47"/>
<polygon fill="black" stroke="black" points="325.5,-351.44 322,-341.44 318.5,-351.44 325.5,-351.44"/>
</g>
<!-- ln_moe_1&#45;&gt;a2a_disp -->
<g id="edge50" class="edge">
<title>ln_moe_1&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" d="M286.95,-390.91C275.34,-381.12 263.49,-368.89 256,-355.15 214.96,-279.86 181.54,-228.55 237,-163.15 271,-123.06 407.13,-108.62 506.31,-103.44"/>
<polygon fill="black" stroke="black" points="506.57,-106.93 516.39,-102.94 506.23,-99.94 506.57,-106.93"/>
</g>
<!-- gate_2 -->
<g id="node32" class="node">
<title>gate_2</title>
<polygon fill="none" stroke="black" points="765,-341.15 651,-341.15 651,-291.15 765,-291.15 765,-341.15"/>
<text text-anchor="middle" x="708" y="-330.15" font-family="Times,serif" font-size="10.00">Gate(h&#45;&gt;64E)</text>
<text text-anchor="middle" x="708" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="708" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="708" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,64E=64*64]</text>
</g>
<!-- ln_moe_2&#45;&gt;gate_2 -->
<g id="edge43" class="edge">
<title>ln_moe_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M774.25,-390.93C762.93,-378.33 748.95,-362.75 736.75,-349.17"/>
<polygon fill="black" stroke="black" points="739.09,-346.54 729.81,-341.44 733.88,-351.22 739.09,-346.54"/>
</g>
<!-- ln_moe_2&#45;&gt;a2a_disp -->
<g id="edge51" class="edge">
<title>ln_moe_2&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" d="M798.22,-391.01C802.85,-335.12 811.09,-198.87 785,-163.15 767.66,-139.41 740.32,-124.67 712.59,-115.51"/>
<polygon fill="black" stroke="black" points="713.36,-112.09 702.78,-112.5 711.31,-118.78 713.36,-112.09"/>
</g>
<!-- gate_3 -->
<g id="node33" class="node">
<title>gate_3</title>
<polygon fill="none" stroke="black" points="587,-341.15 473,-341.15 473,-291.15 587,-291.15 587,-341.15"/>
<text text-anchor="middle" x="530" y="-330.15" font-family="Times,serif" font-size="10.00">Gate(h&#45;&gt;64E)</text>
<text text-anchor="middle" x="530" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="530" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="530" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s,64E=64*64]</text>
</g>
<!-- ln_moe_3&#45;&gt;gate_3 -->
<g id="edge44" class="edge">
<title>ln_moe_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M530,-390.93C530,-379.03 530,-364.49 530,-351.47"/>
<polygon fill="black" stroke="black" points="533.5,-351.44 530,-341.44 526.5,-351.44 533.5,-351.44"/>
</g>
<!-- ln_moe_3&#45;&gt;a2a_disp -->
<g id="edge52" class="edge">
<title>ln_moe_3&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" d="M494.95,-390.91C483.34,-381.12 471.49,-368.89 464,-355.15 422.96,-279.86 395.94,-233.49 445,-163.15 461.82,-139.04 489.02,-124.19 516.78,-115.06"/>
<polygon fill="black" stroke="black" points="518.07,-118.33 526.61,-112.06 516.02,-111.63 518.07,-118.33"/>
</g>
<!-- top2_0 -->
<g id="node34" class="node">
<title>top2_0</title>
<polygon fill="none" stroke="black" points="152,-227.15 0,-227.15 0,-177.15 152,-177.15 152,-227.15"/>
<text text-anchor="middle" x="76" y="-216.15" font-family="Times,serif" font-size="10.00">Top2ExpertSelect</text>
<text text-anchor="middle" x="76" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="76" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,64E]</text>
<text text-anchor="middle" x="76" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,2] (indices+weight)</text>
</g>
<!-- gate_0&#45;&gt;top2_0 -->
<g id="edge45" class="edge">
<title>gate_0&#45;&gt;top2_0</title>
<path fill="none" stroke="black" d="M83.85,-291.13C82.47,-275.58 80.64,-255.1 79.09,-237.81"/>
<polygon fill="black" stroke="black" points="82.55,-237.18 78.18,-227.53 75.58,-237.8 82.55,-237.18"/>
</g>
<!-- top2_1 -->
<g id="node35" class="node">
<title>top2_1</title>
<polygon fill="none" stroke="black" points="398,-227.15 246,-227.15 246,-177.15 398,-177.15 398,-227.15"/>
<text text-anchor="middle" x="322" y="-216.15" font-family="Times,serif" font-size="10.00">Top2ExpertSelect</text>
<text text-anchor="middle" x="322" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="322" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,64E]</text>
<text text-anchor="middle" x="322" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,2] (indices+weight)</text>
</g>
<!-- gate_1&#45;&gt;top2_1 -->
<g id="edge46" class="edge">
<title>gate_1&#45;&gt;top2_1</title>
<path fill="none" stroke="black" d="M322,-291.13C322,-275.58 322,-255.1 322,-237.81"/>
<polygon fill="black" stroke="black" points="325.5,-237.53 322,-227.53 318.5,-237.53 325.5,-237.53"/>
</g>
<!-- top2_2 -->
<g id="node36" class="node">
<title>top2_2</title>
<polygon fill="none" stroke="black" points="776,-227.15 624,-227.15 624,-177.15 776,-177.15 776,-227.15"/>
<text text-anchor="middle" x="700" y="-216.15" font-family="Times,serif" font-size="10.00">Top2ExpertSelect</text>
<text text-anchor="middle" x="700" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="700" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,64E]</text>
<text text-anchor="middle" x="700" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,2] (indices+weight)</text>
</g>
<!-- gate_2&#45;&gt;top2_2 -->
<g id="edge47" class="edge">
<title>gate_2&#45;&gt;top2_2</title>
<path fill="none" stroke="black" d="M706.28,-291.13C705.17,-275.58 703.71,-255.1 702.48,-237.81"/>
<polygon fill="black" stroke="black" points="705.94,-237.25 701.74,-227.53 698.96,-237.75 705.94,-237.25"/>
</g>
<!-- top2_3 -->
<g id="node37" class="node">
<title>top2_3</title>
<polygon fill="none" stroke="black" points="606,-227.15 454,-227.15 454,-177.15 606,-177.15 606,-227.15"/>
<text text-anchor="middle" x="530" y="-216.15" font-family="Times,serif" font-size="10.00">Top2ExpertSelect</text>
<text text-anchor="middle" x="530" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="530" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s,64E]</text>
<text text-anchor="middle" x="530" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s,2] (indices+weight)</text>
</g>
<!-- gate_3&#45;&gt;top2_3 -->
<g id="edge48" class="edge">
<title>gate_3&#45;&gt;top2_3</title>
<path fill="none" stroke="black" d="M530,-291.13C530,-275.58 530,-255.1 530,-237.81"/>
<polygon fill="black" stroke="black" points="533.5,-237.53 530,-227.53 526.5,-237.53 533.5,-237.53"/>
</g>
<!-- top2_0&#45;&gt;a2a_disp -->
<g id="edge53" class="edge">
<title>top2_0&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126.58,-177.08C139.23,-171.82 152.92,-166.76 166,-163.15 280.82,-131.5 416.79,-115.4 508.78,-107.53"/>
<polygon fill="black" stroke="black" points="509.26,-111 518.93,-106.68 508.68,-104.03 509.26,-111"/>
</g>
<!-- top2_1&#45;&gt;a2a_disp -->
<g id="edge54" class="edge">
<title>top2_1&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M376.86,-176.96C388.39,-172.17 400.53,-167.33 412,-163.15 452.72,-148.33 498.82,-133.93 536.79,-122.69"/>
<polygon fill="black" stroke="black" points="538.16,-125.93 546.77,-119.75 536.19,-119.22 538.16,-125.93"/>
</g>
<!-- top2_2&#45;&gt;a2a_disp -->
<g id="edge55" class="edge">
<title>top2_2&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M679.64,-177.06C668.88,-164.34 655.5,-148.5 643.71,-134.55"/>
<polygon fill="black" stroke="black" points="646.11,-131.96 636.98,-126.59 640.76,-136.48 646.11,-131.96"/>
</g>
<!-- top2_3&#45;&gt;a2a_disp -->
<g id="edge56" class="edge">
<title>top2_3&#45;&gt;a2a_disp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M550.36,-177.06C561.12,-164.34 574.5,-148.5 586.29,-134.55"/>
<polygon fill="black" stroke="black" points="589.24,-136.48 593.02,-126.59 583.89,-131.96 589.24,-136.48"/>
</g>
<!-- a2a_disp&#45;&gt;0 -->
<g id="edge57" class="edge">
<title>a2a_disp&#45;&gt;0</title>
<path fill="none" stroke="black" d="M706.94,-89.29C880.36,-71.78 1248.91,-34.56 1366.29,-22.71"/>
<polygon fill="black" stroke="black" points="1366.93,-26.16 1376.53,-21.67 1366.23,-19.2 1366.93,-26.16"/>
</g>
<!-- a2a_disp&#45;&gt;1 -->
<g id="edge58" class="edge">
<title>a2a_disp&#45;&gt;1</title>
<path fill="none" stroke="black" d="M707.26,-89.5C770,-83.64 854.94,-76.34 930,-72 1441.84,-42.44 1572.49,-83.24 2083,-36 2107.97,-33.69 2135.89,-29.35 2157.35,-25.64"/>
<polygon fill="black" stroke="black" points="2158.09,-29.06 2167.33,-23.88 2156.87,-22.17 2158.09,-29.06"/>
</g>
<!-- a2a_disp&#45;&gt;2 -->
<g id="edge59" class="edge">
<title>a2a_disp&#45;&gt;2</title>
<path fill="none" stroke="black" d="M708.36,-90.37C771.02,-84.94 855.45,-77.78 930,-72 1156.11,-54.47 1214.03,-64.65 1439,-36 1457.81,-33.6 1478.6,-29.86 1495.66,-26.49"/>
<polygon fill="black" stroke="black" points="1496.63,-29.86 1505.74,-24.46 1495.24,-23 1496.63,-29.86"/>
</g>
<!-- a2a_disp&#45;&gt;3 -->
<g id="edge60" class="edge">
<title>a2a_disp&#45;&gt;3</title>
<path fill="none" stroke="black" d="M707.97,-89.83C770.66,-84.15 855.25,-76.93 930,-72 1353.39,-44.1 1867.99,-25.21 2009.47,-20.28"/>
<polygon fill="black" stroke="black" points="2009.89,-23.77 2019.76,-19.92 2009.65,-16.77 2009.89,-23.77"/>
</g>
<!-- _disp -->
<g id="node39" class="node">
<title>_disp</title>
<polygon fill="none" stroke="black" points="1457.5,-441.15 1300.5,-441.15 1300.5,-391.15 1457.5,-391.15 1457.5,-441.15"/>
<text text-anchor="middle" x="1379" y="-430.15" font-family="Times,serif" font-size="10.00">DispatchedTokens</text>
<text text-anchor="middle" x="1379" y="-419.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1379" y="-408.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="1379" y="-397.15" font-family="Times,serif" font-size="10.00">Out: [b,s_per_expert,h=1024]</text>
</g>
<!-- exp0_1 -->
<g id="node40" class="node">
<title>exp0_1</title>
<polygon fill="none" stroke="black" points="947.5,-341.15 824.5,-341.15 824.5,-291.15 947.5,-291.15 947.5,-341.15"/>
<text text-anchor="middle" x="886" y="-330.15" font-family="Times,serif" font-size="10.00">Expert0MLP1(col)</text>
<text text-anchor="middle" x="886" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="886" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="886" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp0_1 -->
<g id="edge61" class="edge">
<title>_disp&#45;&gt;exp0_1</title>
<path fill="none" stroke="black" d="M1300.31,-412.33C1213.91,-407.33 1072.03,-393.49 956,-355.15 948.52,-352.68 940.91,-349.43 933.59,-345.87"/>
<polygon fill="black" stroke="black" points="935,-342.66 924.5,-341.22 931.81,-348.89 935,-342.66"/>
</g>
<!-- exp1_1 -->
<g id="node42" class="node">
<title>exp1_1</title>
<polygon fill="none" stroke="black" points="1088.5,-341.15 965.5,-341.15 965.5,-291.15 1088.5,-291.15 1088.5,-341.15"/>
<text text-anchor="middle" x="1027" y="-330.15" font-family="Times,serif" font-size="10.00">Expert1MLP1(col)</text>
<text text-anchor="middle" x="1027" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1027" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1027" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp1_1 -->
<g id="edge63" class="edge">
<title>_disp&#45;&gt;exp1_1</title>
<path fill="none" stroke="black" d="M1300.41,-404.65C1242.87,-395.47 1163.56,-379.72 1097,-355.15 1090.04,-352.59 1082.93,-349.43 1076.03,-346.04"/>
<polygon fill="black" stroke="black" points="1077.28,-342.75 1066.79,-341.31 1074.09,-348.98 1077.28,-342.75"/>
</g>
<!-- exp2_1 -->
<g id="node44" class="node">
<title>exp2_1</title>
<polygon fill="none" stroke="black" points="1832.5,-341.15 1709.5,-341.15 1709.5,-291.15 1832.5,-291.15 1832.5,-341.15"/>
<text text-anchor="middle" x="1771" y="-330.15" font-family="Times,serif" font-size="10.00">Expert2MLP1(col)</text>
<text text-anchor="middle" x="1771" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1771" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1771" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp2_1 -->
<g id="edge65" class="edge">
<title>_disp&#45;&gt;exp2_1</title>
<path fill="none" stroke="black" d="M1457.72,-401.23C1514.87,-390.46 1593.79,-374.19 1662,-355.15 1674.38,-351.7 1687.4,-347.59 1699.97,-343.37"/>
<polygon fill="black" stroke="black" points="1701.13,-346.67 1709.46,-340.13 1698.87,-340.04 1701.13,-346.67"/>
</g>
<!-- exp3_1 -->
<g id="node46" class="node">
<title>exp3_1</title>
<polygon fill="none" stroke="black" points="1973.5,-341.15 1850.5,-341.15 1850.5,-291.15 1973.5,-291.15 1973.5,-341.15"/>
<text text-anchor="middle" x="1912" y="-330.15" font-family="Times,serif" font-size="10.00">Expert3MLP1(col)</text>
<text text-anchor="middle" x="1912" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1912" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1912" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp3_1 -->
<g id="edge67" class="edge">
<title>_disp&#45;&gt;exp3_1</title>
<path fill="none" stroke="black" d="M1457.51,-413.71C1551.17,-410.02 1711.49,-397.41 1842,-355.15 1849.49,-352.73 1857.12,-349.5 1864.44,-345.95"/>
<polygon fill="black" stroke="black" points="1866.21,-348.98 1873.53,-341.31 1863.03,-342.74 1866.21,-348.98"/>
</g>
<!-- exp4_1 -->
<g id="node48" class="node">
<title>exp4_1</title>
<polygon fill="none" stroke="black" points="1229.5,-341.15 1106.5,-341.15 1106.5,-291.15 1229.5,-291.15 1229.5,-341.15"/>
<text text-anchor="middle" x="1168" y="-330.15" font-family="Times,serif" font-size="10.00">Expert4MLP1(col)</text>
<text text-anchor="middle" x="1168" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1168" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1168" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp4_1 -->
<g id="edge69" class="edge">
<title>_disp&#45;&gt;exp4_1</title>
<path fill="none" stroke="black" d="M1319.09,-391.14C1293.82,-380.63 1264.23,-367.82 1238,-355.15 1232.2,-352.35 1226.19,-349.31 1220.24,-346.21"/>
<polygon fill="black" stroke="black" points="1221.46,-342.9 1210.98,-341.32 1218.19,-349.09 1221.46,-342.9"/>
</g>
<!-- exp5_1 -->
<g id="node50" class="node">
<title>exp5_1</title>
<polygon fill="none" stroke="black" points="1370.5,-341.15 1247.5,-341.15 1247.5,-291.15 1370.5,-291.15 1370.5,-341.15"/>
<text text-anchor="middle" x="1309" y="-330.15" font-family="Times,serif" font-size="10.00">Expert5MLP1(col)</text>
<text text-anchor="middle" x="1309" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1309" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1309" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp5_1 -->
<g id="edge71" class="edge">
<title>_disp&#45;&gt;exp5_1</title>
<path fill="none" stroke="black" d="M1361.7,-390.93C1352.86,-378.56 1341.99,-363.34 1332.41,-349.93"/>
<polygon fill="black" stroke="black" points="1335.01,-347.54 1326.35,-341.44 1329.31,-351.61 1335.01,-347.54"/>
</g>
<!-- exp6_1 -->
<g id="node52" class="node">
<title>exp6_1</title>
<polygon fill="none" stroke="black" points="1511.5,-341.15 1388.5,-341.15 1388.5,-291.15 1511.5,-291.15 1511.5,-341.15"/>
<text text-anchor="middle" x="1450" y="-330.15" font-family="Times,serif" font-size="10.00">Expert6MLP1(col)</text>
<text text-anchor="middle" x="1450" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1450" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1450" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp6_1 -->
<g id="edge73" class="edge">
<title>_disp&#45;&gt;exp6_1</title>
<path fill="none" stroke="black" d="M1396.55,-390.93C1405.6,-378.44 1416.75,-363.05 1426.53,-349.55"/>
<polygon fill="black" stroke="black" points="1429.37,-351.59 1432.41,-341.44 1423.7,-347.48 1429.37,-351.59"/>
</g>
<!-- exp7_1 -->
<g id="node54" class="node">
<title>exp7_1</title>
<polygon fill="none" stroke="black" points="1652.5,-341.15 1529.5,-341.15 1529.5,-291.15 1652.5,-291.15 1652.5,-341.15"/>
<text text-anchor="middle" x="1591" y="-330.15" font-family="Times,serif" font-size="10.00">Expert7MLP1(col)</text>
<text text-anchor="middle" x="1591" y="-319.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1591" y="-308.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1591" y="-297.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,ffn/4=1024]</text>
</g>
<!-- _disp&#45;&gt;exp7_1 -->
<g id="edge75" class="edge">
<title>_disp&#45;&gt;exp7_1</title>
<path fill="none" stroke="black" d="M1438.87,-391.06C1464.14,-380.54 1493.73,-367.74 1520,-355.15 1526.01,-352.27 1532.25,-349.14 1538.42,-345.96"/>
<polygon fill="black" stroke="black" points="1540.14,-349.02 1547.38,-341.29 1536.89,-342.81 1540.14,-349.02"/>
</g>
<!-- exp0_2 -->
<g id="node41" class="node">
<title>exp0_2</title>
<polygon fill="none" stroke="black" points="947.5,-227.15 832.5,-227.15 832.5,-177.15 947.5,-177.15 947.5,-227.15"/>
<text text-anchor="middle" x="890" y="-216.15" font-family="Times,serif" font-size="10.00">Expert0MLP2(row)</text>
<text text-anchor="middle" x="890" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="890" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="890" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp0_1&#45;&gt;exp0_2 -->
<g id="edge62" class="edge">
<title>exp0_1&#45;&gt;exp0_2</title>
<path fill="none" stroke="black" d="M886.86,-291.13C887.41,-275.58 888.14,-255.1 888.76,-237.81"/>
<polygon fill="black" stroke="black" points="892.27,-237.65 889.13,-227.53 885.27,-237.4 892.27,-237.65"/>
</g>
<!-- ar_exp_0 -->
<g id="node56" class="node">
<title>ar_exp_0</title>
<ellipse fill="none" stroke="black" cx="1023" cy="-99.58" rx="84.29" ry="27.65"/>
<text text-anchor="middle" x="1023" y="-108.08" font-family="Times,serif" font-size="10.00">AllReduce(ExpertOut)</text>
<text text-anchor="middle" x="1023" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s_e,h/4=256]</text>
<text text-anchor="middle" x="1023" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h=1024]</text>
</g>
<!-- exp0_2&#45;&gt;ar_exp_0 -->
<g id="edge77" class="edge">
<title>exp0_2&#45;&gt;ar_exp_0</title>
<path fill="none" stroke="black" d="M921.86,-177.06C940.01,-163.33 962.95,-145.99 982.39,-131.29"/>
<polygon fill="black" stroke="black" points="984.61,-133.99 990.48,-125.17 980.39,-128.41 984.61,-133.99"/>
</g>
<!-- exp1_2 -->
<g id="node43" class="node">
<title>exp1_2</title>
<polygon fill="none" stroke="black" points="1080.5,-227.15 965.5,-227.15 965.5,-177.15 1080.5,-177.15 1080.5,-227.15"/>
<text text-anchor="middle" x="1023" y="-216.15" font-family="Times,serif" font-size="10.00">Expert1MLP2(row)</text>
<text text-anchor="middle" x="1023" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1023" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="1023" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp1_1&#45;&gt;exp1_2 -->
<g id="edge64" class="edge">
<title>exp1_1&#45;&gt;exp1_2</title>
<path fill="none" stroke="black" d="M1026.14,-291.13C1025.59,-275.58 1024.86,-255.1 1024.24,-237.81"/>
<polygon fill="black" stroke="black" points="1027.73,-237.4 1023.87,-227.53 1020.73,-237.65 1027.73,-237.4"/>
</g>
<!-- exp1_2&#45;&gt;ar_exp_0 -->
<g id="edge78" class="edge">
<title>exp1_2&#45;&gt;ar_exp_0</title>
<path fill="none" stroke="black" d="M1023,-177.06C1023,-165.23 1023,-150.72 1023,-137.52"/>
<polygon fill="black" stroke="black" points="1026.5,-137.3 1023,-127.3 1019.5,-137.3 1026.5,-137.3"/>
</g>
<!-- exp2_2 -->
<g id="node45" class="node">
<title>exp2_2</title>
<polygon fill="none" stroke="black" points="2076.5,-227.15 1961.5,-227.15 1961.5,-177.15 2076.5,-177.15 2076.5,-227.15"/>
<text text-anchor="middle" x="2019" y="-216.15" font-family="Times,serif" font-size="10.00">Expert2MLP2(row)</text>
<text text-anchor="middle" x="2019" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2019" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="2019" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp2_1&#45;&gt;exp2_2 -->
<g id="edge66" class="edge">
<title>exp2_1&#45;&gt;exp2_2</title>
<path fill="none" stroke="black" d="M1813.2,-290.99C1822.53,-286.09 1832.48,-281.21 1842,-277.15 1889.72,-256.84 1905.6,-262.21 1953,-241.15 1959.09,-238.45 1965.34,-235.34 1971.45,-232.08"/>
<polygon fill="black" stroke="black" points="1973.18,-235.12 1980.27,-227.24 1969.82,-228.99 1973.18,-235.12"/>
</g>
<!-- ar_exp_1 -->
<g id="node57" class="node">
<title>ar_exp_1</title>
<ellipse fill="none" stroke="black" cx="2106" cy="-99.58" rx="84.29" ry="27.65"/>
<text text-anchor="middle" x="2106" y="-108.08" font-family="Times,serif" font-size="10.00">AllReduce(ExpertOut)</text>
<text text-anchor="middle" x="2106" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s_e,h/4=256]</text>
<text text-anchor="middle" x="2106" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h=1024]</text>
</g>
<!-- exp2_2&#45;&gt;ar_exp_1 -->
<g id="edge79" class="edge">
<title>exp2_2&#45;&gt;ar_exp_1</title>
<path fill="none" stroke="black" d="M2039.84,-177.06C2051.04,-164.12 2065.01,-147.96 2077.23,-133.83"/>
<polygon fill="black" stroke="black" points="2079.92,-136.08 2083.81,-126.23 2074.62,-131.5 2079.92,-136.08"/>
</g>
<!-- exp3_2 -->
<g id="node47" class="node">
<title>exp3_2</title>
<polygon fill="none" stroke="black" points="2209.5,-227.15 2094.5,-227.15 2094.5,-177.15 2209.5,-177.15 2209.5,-227.15"/>
<text text-anchor="middle" x="2152" y="-216.15" font-family="Times,serif" font-size="10.00">Expert3MLP2(row)</text>
<text text-anchor="middle" x="2152" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2152" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="2152" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp3_1&#45;&gt;exp3_2 -->
<g id="edge68" class="edge">
<title>exp3_1&#45;&gt;exp3_2</title>
<path fill="none" stroke="black" d="M1973.61,-291.06C2007.27,-277.38 2049.42,-259.38 2086,-241.15 2091.59,-238.37 2097.37,-235.32 2103.07,-232.19"/>
<polygon fill="black" stroke="black" points="2104.9,-235.18 2111.93,-227.25 2101.49,-229.06 2104.9,-235.18"/>
</g>
<!-- exp3_2&#45;&gt;ar_exp_1 -->
<g id="edge80" class="edge">
<title>exp3_2&#45;&gt;ar_exp_1</title>
<path fill="none" stroke="black" d="M2140.98,-177.06C2135.37,-164.79 2128.43,-149.62 2122.22,-136.04"/>
<polygon fill="black" stroke="black" points="2125.4,-134.58 2118.06,-126.94 2119.04,-137.49 2125.4,-134.58"/>
</g>
<!-- exp4_2 -->
<g id="node49" class="node">
<title>exp4_2</title>
<polygon fill="none" stroke="black" points="1213.5,-227.15 1098.5,-227.15 1098.5,-177.15 1213.5,-177.15 1213.5,-227.15"/>
<text text-anchor="middle" x="1156" y="-216.15" font-family="Times,serif" font-size="10.00">Expert4MLP2(row)</text>
<text text-anchor="middle" x="1156" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1156" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="1156" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp4_1&#45;&gt;exp4_2 -->
<g id="edge70" class="edge">
<title>exp4_1&#45;&gt;exp4_2</title>
<path fill="none" stroke="black" d="M1165.43,-291.13C1163.76,-275.58 1161.57,-255.1 1159.71,-237.81"/>
<polygon fill="black" stroke="black" points="1163.16,-237.1 1158.61,-227.53 1156.2,-237.84 1163.16,-237.1"/>
</g>
<!-- ar_exp_2 -->
<g id="node58" class="node">
<title>ar_exp_2</title>
<ellipse fill="none" stroke="black" cx="1263" cy="-99.58" rx="84.29" ry="27.65"/>
<text text-anchor="middle" x="1263" y="-108.08" font-family="Times,serif" font-size="10.00">AllReduce(ExpertOut)</text>
<text text-anchor="middle" x="1263" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s_e,h/4=256]</text>
<text text-anchor="middle" x="1263" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h=1024]</text>
</g>
<!-- exp4_2&#45;&gt;ar_exp_2 -->
<g id="edge81" class="edge">
<title>exp4_2&#45;&gt;ar_exp_2</title>
<path fill="none" stroke="black" d="M1181.63,-177.06C1195.76,-163.78 1213.5,-147.11 1228.8,-132.73"/>
<polygon fill="black" stroke="black" points="1231.2,-135.27 1236.09,-125.87 1226.4,-130.17 1231.2,-135.27"/>
</g>
<!-- exp5_2 -->
<g id="node51" class="node">
<title>exp5_2</title>
<polygon fill="none" stroke="black" points="1346.5,-227.15 1231.5,-227.15 1231.5,-177.15 1346.5,-177.15 1346.5,-227.15"/>
<text text-anchor="middle" x="1289" y="-216.15" font-family="Times,serif" font-size="10.00">Expert5MLP2(row)</text>
<text text-anchor="middle" x="1289" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1289" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="1289" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp5_1&#45;&gt;exp5_2 -->
<g id="edge72" class="edge">
<title>exp5_1&#45;&gt;exp5_2</title>
<path fill="none" stroke="black" d="M1304.71,-291.13C1301.93,-275.58 1298.28,-255.1 1295.19,-237.81"/>
<polygon fill="black" stroke="black" points="1298.56,-236.76 1293.35,-227.53 1291.66,-237.99 1298.56,-236.76"/>
</g>
<!-- exp5_2&#45;&gt;ar_exp_2 -->
<g id="edge82" class="edge">
<title>exp5_2&#45;&gt;ar_exp_2</title>
<path fill="none" stroke="black" d="M1282.77,-177.06C1279.68,-165.12 1275.89,-150.43 1272.45,-137.13"/>
<polygon fill="black" stroke="black" points="1275.8,-136.11 1269.91,-127.3 1269.02,-137.86 1275.8,-136.11"/>
</g>
<!-- exp6_2 -->
<g id="node53" class="node">
<title>exp6_2</title>
<polygon fill="none" stroke="black" points="1810.5,-227.15 1695.5,-227.15 1695.5,-177.15 1810.5,-177.15 1810.5,-227.15"/>
<text text-anchor="middle" x="1753" y="-216.15" font-family="Times,serif" font-size="10.00">Expert6MLP2(row)</text>
<text text-anchor="middle" x="1753" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1753" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="1753" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp6_1&#45;&gt;exp6_2 -->
<g id="edge74" class="edge">
<title>exp6_1&#45;&gt;exp6_2</title>
<path fill="none" stroke="black" d="M1489.8,-291.03C1499.44,-285.9 1509.89,-280.91 1520,-277.15 1590.77,-250.88 1615.47,-268.08 1686,-241.15 1692.7,-238.6 1699.53,-235.44 1706.15,-232.06"/>
<polygon fill="black" stroke="black" points="1707.83,-235.12 1715,-227.32 1704.53,-228.95 1707.83,-235.12"/>
</g>
<!-- ar_exp_3 -->
<g id="node59" class="node">
<title>ar_exp_3</title>
<ellipse fill="none" stroke="black" cx="1886" cy="-99.58" rx="84.29" ry="27.65"/>
<text text-anchor="middle" x="1886" y="-108.08" font-family="Times,serif" font-size="10.00">AllReduce(ExpertOut)</text>
<text text-anchor="middle" x="1886" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s_e,h/4=256]</text>
<text text-anchor="middle" x="1886" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h=1024]</text>
</g>
<!-- exp6_2&#45;&gt;ar_exp_3 -->
<g id="edge83" class="edge">
<title>exp6_2&#45;&gt;ar_exp_3</title>
<path fill="none" stroke="black" d="M1784.86,-177.06C1803.01,-163.33 1825.95,-145.99 1845.39,-131.29"/>
<polygon fill="black" stroke="black" points="1847.61,-133.99 1853.48,-125.17 1843.39,-128.41 1847.61,-133.99"/>
</g>
<!-- exp7_2 -->
<g id="node55" class="node">
<title>exp7_2</title>
<polygon fill="none" stroke="black" points="1943.5,-227.15 1828.5,-227.15 1828.5,-177.15 1943.5,-177.15 1943.5,-227.15"/>
<text text-anchor="middle" x="1886" y="-216.15" font-family="Times,serif" font-size="10.00">Expert7MLP2(row)</text>
<text text-anchor="middle" x="1886" y="-205.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1886" y="-194.15" font-family="Times,serif" font-size="10.00">In: [b,s_e,ffn/4=1024]</text>
<text text-anchor="middle" x="1886" y="-183.15" font-family="Times,serif" font-size="10.00">Out: [b,s_e,h/4=256]</text>
</g>
<!-- exp7_1&#45;&gt;exp7_2 -->
<g id="edge76" class="edge">
<title>exp7_1&#45;&gt;exp7_2</title>
<path fill="none" stroke="black" d="M1652.53,-293.43C1668.29,-287.99 1685.24,-282.26 1701,-277.15 1753.57,-260.13 1769.28,-263.08 1820,-241.15 1826.2,-238.48 1832.55,-235.35 1838.74,-232.07"/>
<polygon fill="black" stroke="black" points="1840.59,-235.05 1847.68,-227.18 1837.22,-228.91 1840.59,-235.05"/>
</g>
<!-- exp7_2&#45;&gt;ar_exp_3 -->
<g id="edge84" class="edge">
<title>exp7_2&#45;&gt;ar_exp_3</title>
<path fill="none" stroke="black" d="M1886,-177.06C1886,-165.23 1886,-150.72 1886,-137.52"/>
<polygon fill="black" stroke="black" points="1889.5,-137.3 1886,-127.3 1882.5,-137.3 1889.5,-137.3"/>
</g>
<!-- ar_exp_0&#45;&gt;0 -->
<g id="edge85" class="edge">
<title>ar_exp_0&#45;&gt;0</title>
<path fill="none" stroke="black" d="M1092.7,-83.98C1173.92,-66.97 1304.96,-39.53 1367.54,-26.43"/>
<polygon fill="black" stroke="black" points="1368.61,-29.78 1377.69,-24.3 1367.18,-22.93 1368.61,-29.78"/>
</g>
<!-- ar_exp_1&#45;&gt;1 -->
<g id="edge86" class="edge">
<title>ar_exp_1&#45;&gt;1</title>
<path fill="none" stroke="black" d="M2133.53,-73.4C2145.22,-62.7 2158.71,-50.36 2169.88,-40.15"/>
<polygon fill="black" stroke="black" points="2172.53,-42.47 2177.55,-33.14 2167.81,-37.3 2172.53,-42.47"/>
</g>
<!-- ar_exp_2&#45;&gt;2 -->
<g id="edge87" class="edge">
<title>ar_exp_2&#45;&gt;2</title>
<path fill="none" stroke="black" d="M1324.15,-80.42C1377.64,-64.54 1453.38,-42.05 1496.82,-29.15"/>
<polygon fill="black" stroke="black" points="1498.02,-32.44 1506.61,-26.24 1496.03,-25.73 1498.02,-32.44"/>
</g>
<!-- ar_exp_3&#45;&gt;3 -->
<g id="edge88" class="edge">
<title>ar_exp_3&#45;&gt;3</title>
<path fill="none" stroke="black" d="M1931.28,-76.2C1958.7,-62.64 1992.92,-45.73 2017.01,-33.82"/>
<polygon fill="black" stroke="black" points="2018.61,-36.93 2026.03,-29.37 2015.51,-30.66 2018.61,-36.93"/>
</g>
<!-- _exp_aggr -->
<g id="node60" class="node">
<title>_exp_aggr</title>
<polygon fill="none" stroke="black" points="1677.38,-241.15 1489.06,-241.15 1440.62,-163.15 1628.94,-163.15 1677.38,-241.15"/>
<text text-anchor="middle" x="1559" y="-210.65" font-family="Times,serif" font-size="10.00">AggregateExpertOut</text>
<text text-anchor="middle" x="1559" y="-199.65" font-family="Times,serif" font-size="10.00">In: [b,s_e,h=1024]</text>
<text text-anchor="middle" x="1559" y="-188.65" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- a2a_comb -->
<g id="node61" class="node">
<title>a2a_comb</title>
<ellipse fill="none" stroke="black" cx="1559" cy="-99.58" rx="70.01" ry="27.65"/>
<text text-anchor="middle" x="1559" y="-108.08" font-family="Times,serif" font-size="10.00">AllToAll(Combine)</text>
<text text-anchor="middle" x="1559" y="-97.08" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="1559" y="-86.08" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _exp_aggr&#45;&gt;a2a_comb -->
<g id="edge89" class="edge">
<title>_exp_aggr&#45;&gt;a2a_comb</title>
<path fill="none" stroke="black" d="M1539.3,-163.13C1538.51,-154.43 1538.57,-145.21 1539.49,-136.59"/>
<polygon fill="black" stroke="black" points="1542.99,-136.88 1541.04,-126.47 1536.07,-135.82 1542.99,-136.88"/>
</g>
<!-- _exp_aggr&#45;&gt;a2a_comb -->
<g id="edge90" class="edge">
<title>_exp_aggr&#45;&gt;a2a_comb</title>
<path fill="none" stroke="black" d="M1552.43,-163.13C1552.17,-154.59 1552.19,-145.54 1552.48,-137.06"/>
<polygon fill="black" stroke="black" points="1555.98,-137.24 1552.97,-127.08 1548.99,-136.89 1555.98,-137.24"/>
</g>
<!-- _exp_aggr&#45;&gt;a2a_comb -->
<g id="edge91" class="edge">
<title>_exp_aggr&#45;&gt;a2a_comb</title>
<path fill="none" stroke="black" d="M1565.57,-163.13C1565.83,-154.59 1565.81,-145.54 1565.52,-137.06"/>
<polygon fill="black" stroke="black" points="1569.01,-136.89 1565.03,-127.08 1562.02,-137.24 1569.01,-136.89"/>
</g>
<!-- _exp_aggr&#45;&gt;a2a_comb -->
<g id="edge92" class="edge">
<title>_exp_aggr&#45;&gt;a2a_comb</title>
<path fill="none" stroke="black" d="M1578.7,-163.13C1579.49,-154.43 1579.43,-145.21 1578.51,-136.59"/>
<polygon fill="black" stroke="black" points="1581.93,-135.82 1576.96,-126.47 1575.01,-136.88 1581.93,-135.82"/>
</g>
<!-- a2a_comb&#45;&gt;0 -->
<g id="edge93" class="edge">
<title>a2a_comb&#45;&gt;0</title>
<path fill="none" stroke="black" d="M1517.19,-77.25C1490.58,-63.68 1456.75,-46.42 1432.84,-34.22"/>
<polygon fill="black" stroke="black" points="1434.38,-31.08 1423.88,-29.65 1431.2,-37.31 1434.38,-31.08"/>
</g>
<!-- a2a_comb&#45;&gt;1 -->
<g id="edge94" class="edge">
<title>a2a_comb&#45;&gt;1</title>
<path fill="none" stroke="black" d="M1625.48,-90.93C1745.99,-77.01 1996.09,-47.9 2083,-36 2107.68,-32.62 2135.4,-28.33 2156.83,-24.91"/>
<polygon fill="black" stroke="black" points="2157.49,-28.35 2166.81,-23.31 2156.38,-21.44 2157.49,-28.35"/>
</g>
<!-- a2a_comb&#45;&gt;2 -->
<g id="edge95" class="edge">
<title>a2a_comb&#45;&gt;2</title>
<path fill="none" stroke="black" d="M1549.68,-72.08C1546.66,-63.5 1543.31,-53.99 1540.29,-45.42"/>
<polygon fill="black" stroke="black" points="1543.57,-44.17 1536.94,-35.89 1536.96,-46.49 1543.57,-44.17"/>
</g>
<!-- a2a_comb&#45;&gt;3 -->
<g id="edge96" class="edge">
<title>a2a_comb&#45;&gt;3</title>
<path fill="none" stroke="black" d="M1622.8,-88.17C1726.63,-71.24 1928.82,-38.27 2010.98,-24.87"/>
<polygon fill="black" stroke="black" points="2011.77,-28.29 2021.08,-23.23 2010.65,-21.38 2011.77,-28.29"/>
</g>
<!-- _comb -->
<g id="node62" class="node">
<title>_comb</title>
<polygon fill="none" stroke="black" points="3373,-527.15 3277,-527.15 3277,-477.15 3373,-477.15 3373,-527.15"/>
<text text-anchor="middle" x="3325" y="-516.15" font-family="Times,serif" font-size="10.00">CombinedTokens</text>
<text text-anchor="middle" x="3325" y="-505.15" font-family="Times,serif" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3325" y="-494.15" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3325" y="-483.15" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- _comb&#45;&gt;out_0 -->
<g id="edge101" class="edge">
<title>_comb&#45;&gt;out_0</title>
<path fill="none" stroke="black" d="M3308.51,-476.86C3302.78,-468.41 3296.26,-458.8 3290.15,-449.79"/>
<polygon fill="black" stroke="black" points="3292.96,-447.71 3284.45,-441.4 3287.17,-451.64 3292.96,-447.71"/>
</g>
<!-- _comb&#45;&gt;out_1 -->
<g id="edge102" class="edge">
<title>_comb&#45;&gt;out_1</title>
<path fill="none" stroke="black" d="M3341.49,-476.86C3347.22,-468.41 3353.74,-458.8 3359.85,-449.79"/>
<polygon fill="black" stroke="black" points="3362.83,-451.64 3365.55,-441.4 3357.04,-447.71 3362.83,-451.64"/>
</g>
<!-- _comb&#45;&gt;out_2 -->
<g id="edge103" class="edge">
<title>_comb&#45;&gt;out_2</title>
<path fill="none" stroke="black" d="M3373.09,-477.53C3393.57,-467.47 3417.63,-455.65 3439,-445.15"/>
<polygon fill="black" stroke="black" points="3440.54,-448.3 3447.98,-440.74 3437.46,-442.01 3440.54,-448.3"/>
</g>
<!-- _comb&#45;&gt;out_3 -->
<g id="edge104" class="edge">
<title>_comb&#45;&gt;out_3</title>
<path fill="none" stroke="black" d="M3276.91,-477.53C3256.43,-467.47 3232.37,-455.65 3211,-445.15"/>
<polygon fill="black" stroke="black" points="3212.54,-442.01 3202.02,-440.74 3209.46,-448.3 3212.54,-442.01"/>
</g>
<!-- output -->
<g id="node67" class="node">
<title>output</title>
<polygon fill="none" stroke="black" points="3603.56,-355.15 3445.18,-355.15 3404.44,-277.15 3562.82,-277.15 3603.56,-355.15"/>
<text text-anchor="middle" x="3504" y="-324.65" font-family="Times,serif" font-size="10.00">LayerOutput</text>
<text text-anchor="middle" x="3504" y="-313.65" font-family="Times,serif" font-size="10.00">In: [b,s,h=1024]</text>
<text text-anchor="middle" x="3504" y="-302.65" font-family="Times,serif" font-size="10.00">Out: [b,s,h=1024]</text>
</g>
<!-- out_0&#45;&gt;output -->
<g id="edge105" class="edge">
<title>out_0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3316.19,-394.84C3319.17,-393.59 3322.13,-392.35 3325,-391.15 3359.32,-376.84 3397.39,-361.08 3429.57,-347.8"/>
<polygon fill="black" stroke="black" points="3431,-350.99 3438.91,-343.94 3428.33,-344.52 3431,-350.99"/>
</g>
<!-- out_1&#45;&gt;output -->
<g id="edge106" class="edge">
<title>out_1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3412.16,-390.93C3423.16,-382.1 3435.97,-371.8 3448.47,-361.76"/>
<polygon fill="black" stroke="black" points="3451.02,-364.2 3456.62,-355.21 3446.63,-358.75 3451.02,-364.2"/>
</g>
<!-- out_2&#45;&gt;output -->
<g id="edge107" class="edge">
<title>out_2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3497.98,-390.93C3498.62,-383.1 3499.35,-374.14 3500.08,-365.21"/>
<polygon fill="black" stroke="black" points="3503.57,-365.46 3500.89,-355.21 3496.59,-364.89 3503.57,-365.46"/>
</g>
<!-- out_3&#45;&gt;output -->
<g id="edge108" class="edge">
<title>out_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3202.26,-394.04C3205.19,-393 3208.12,-392.03 3211,-391.15 3291.14,-366.77 3315.17,-377.11 3396,-355.15 3406.68,-352.25 3417.83,-348.82 3428.73,-345.21"/>
<polygon fill="black" stroke="black" points="3429.87,-348.52 3438.23,-342.01 3427.63,-341.89 3429.87,-348.52"/>
</g>
</g>
</svg>
