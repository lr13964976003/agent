<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Baseline_TP8_PP2 Pages: 1 -->
<svg width="61137pt" height="1256pt"
 viewBox="0.00 0.00 61136.52 1256.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1252.29)">
<title>MoE_Baseline_TP8_PP2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1252.29 61132.52,-1252.29 61132.52,4 -4,4"/>
<!-- model_input -->
<g id="node1" class="node">
<title>model_input</title>
<ellipse fill="none" stroke="black" cx="1966.72" cy="-1185.29" rx="188.6" ry="44.6"/>
<text text-anchor="middle" x="1966.72" y="-1204.79" font-family="Arial" font-size="10.00">model_input</text>
<text text-anchor="middle" x="1966.72" y="-1193.79" font-family="Arial" font-size="10.00">Model Input</text>
<text text-anchor="middle" x="1966.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="1966.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
<text text-anchor="middle" x="1966.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_input_reshape -->
<g id="node2" class="node">
<title>layer0_stage0_input_reshape</title>
<ellipse fill="none" stroke="black" cx="1966.72" cy="-1023.29" rx="183.7" ry="44.6"/>
<text text-anchor="middle" x="1966.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_input_reshape</text>
<text text-anchor="middle" x="1966.72" y="-1031.79" font-family="Arial" font-size="10.00">Input Reshape</text>
<text text-anchor="middle" x="1966.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1966.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
<text text-anchor="middle" x="1966.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- model_input&#45;&gt;layer0_stage0_input_reshape -->
<g id="edge171" class="edge">
<title>model_input&#45;&gt;layer0_stage0_input_reshape</title>
<path fill="none" stroke="black" d="M1966.72,-1140.57C1966.72,-1121.25 1966.72,-1098.36 1966.72,-1078.02"/>
<polygon fill="black" stroke="black" points="1970.22,-1077.95 1966.72,-1067.95 1963.22,-1077.95 1970.22,-1077.95"/>
</g>
<!-- layer0_stage0_qkv_proj_0 -->
<g id="node3" class="node">
<title>layer0_stage0_qkv_proj_0</title>
<polygon fill="none" stroke="black" points="505.72,-892.79 253.72,-892.79 253.72,-829.79 505.72,-829.79 505.72,-892.79"/>
<text text-anchor="middle" x="379.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_0</text>
<text text-anchor="middle" x="379.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;0)</text>
<text text-anchor="middle" x="379.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="379.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="379.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_0 -->
<g id="edge1" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_0</title>
<path fill="none" stroke="black" d="M1785.61,-1015.59C1536.45,-1004.75 1074.36,-978.82 683.72,-924.29 628.46,-916.57 568.16,-904.95 515.93,-893.85"/>
<polygon fill="black" stroke="black" points="516.45,-890.38 505.94,-891.71 514.98,-897.22 516.45,-890.38"/>
</g>
<!-- layer0_stage0_qkv_proj_1 -->
<g id="node4" class="node">
<title>layer0_stage0_qkv_proj_1</title>
<polygon fill="none" stroke="black" points="944.72,-892.79 692.72,-892.79 692.72,-829.79 944.72,-829.79 944.72,-892.79"/>
<text text-anchor="middle" x="818.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_1</text>
<text text-anchor="middle" x="818.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;1)</text>
<text text-anchor="middle" x="818.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="818.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="818.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_1 -->
<g id="edge2" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_1</title>
<path fill="none" stroke="black" d="M1788.16,-1012.53C1600.13,-1000.14 1296.09,-974.11 1037.72,-924.29 999.86,-916.99 959.04,-906.24 923.03,-895.74"/>
<polygon fill="black" stroke="black" points="923.58,-892.26 913,-892.79 921.6,-898.97 923.58,-892.26"/>
</g>
<!-- layer0_stage0_qkv_proj_2 -->
<g id="node5" class="node">
<title>layer0_stage0_qkv_proj_2</title>
<polygon fill="none" stroke="black" points="1298.72,-892.79 1046.72,-892.79 1046.72,-829.79 1298.72,-829.79 1298.72,-892.79"/>
<text text-anchor="middle" x="1172.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_2</text>
<text text-anchor="middle" x="1172.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;2)</text>
<text text-anchor="middle" x="1172.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1172.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="1172.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_2 -->
<g id="edge3" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_2</title>
<path fill="none" stroke="black" d="M1826.5,-994.39C1728.5,-974.86 1594.6,-948.1 1476.72,-924.29 1421.78,-913.19 1361.29,-900.87 1308.83,-890.16"/>
<polygon fill="black" stroke="black" points="1309.28,-886.68 1298.79,-888.11 1307.88,-893.54 1309.28,-886.68"/>
</g>
<!-- layer0_stage0_qkv_proj_3 -->
<g id="node6" class="node">
<title>layer0_stage0_qkv_proj_3</title>
<polygon fill="none" stroke="black" points="1737.72,-892.79 1485.72,-892.79 1485.72,-829.79 1737.72,-829.79 1737.72,-892.79"/>
<text text-anchor="middle" x="1611.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_3</text>
<text text-anchor="middle" x="1611.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;3)</text>
<text text-anchor="middle" x="1611.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1611.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="1611.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_3 -->
<g id="edge4" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_3</title>
<path fill="none" stroke="black" d="M1881.23,-983.76C1822.64,-957.35 1745.55,-922.61 1688.84,-897.04"/>
<polygon fill="black" stroke="black" points="1690.12,-893.78 1679.56,-892.86 1687.24,-900.16 1690.12,-893.78"/>
</g>
<!-- layer0_stage0_qkv_proj_4 -->
<g id="node7" class="node">
<title>layer0_stage0_qkv_proj_4</title>
<polygon fill="none" stroke="black" points="2092.72,-892.79 1840.72,-892.79 1840.72,-829.79 2092.72,-829.79 2092.72,-892.79"/>
<text text-anchor="middle" x="1966.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_4</text>
<text text-anchor="middle" x="1966.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;4)</text>
<text text-anchor="middle" x="1966.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1966.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="1966.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_4 -->
<g id="edge5" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_4</title>
<path fill="none" stroke="black" d="M1966.72,-978.57C1966.72,-955.14 1966.72,-926.44 1966.72,-903.42"/>
<polygon fill="black" stroke="black" points="1970.22,-903.28 1966.72,-893.28 1963.22,-903.28 1970.22,-903.28"/>
</g>
<!-- layer0_stage0_qkv_proj_5 -->
<g id="node8" class="node">
<title>layer0_stage0_qkv_proj_5</title>
<polygon fill="none" stroke="black" points="2447.72,-892.79 2195.72,-892.79 2195.72,-829.79 2447.72,-829.79 2447.72,-892.79"/>
<text text-anchor="middle" x="2321.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_5</text>
<text text-anchor="middle" x="2321.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;5)</text>
<text text-anchor="middle" x="2321.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2321.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="2321.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_5 -->
<g id="edge6" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_5</title>
<path fill="none" stroke="black" d="M2052.2,-983.76C2110.8,-957.35 2187.88,-922.61 2244.6,-897.04"/>
<polygon fill="black" stroke="black" points="2246.2,-900.16 2253.88,-892.86 2243.32,-893.78 2246.2,-900.16"/>
</g>
<!-- layer0_stage0_qkv_proj_6 -->
<g id="node9" class="node">
<title>layer0_stage0_qkv_proj_6</title>
<polygon fill="none" stroke="black" points="2844.72,-892.79 2592.72,-892.79 2592.72,-829.79 2844.72,-829.79 2844.72,-892.79"/>
<text text-anchor="middle" x="2718.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_6</text>
<text text-anchor="middle" x="2718.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;6)</text>
<text text-anchor="middle" x="2718.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2718.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="2718.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_6 -->
<g id="edge7" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_6</title>
<path fill="none" stroke="black" d="M2067.39,-985.95C2096.84,-976.42 2129.29,-966.95 2159.72,-960.29 2289.6,-931.82 2325.82,-947.63 2456.72,-924.29 2501.22,-916.35 2549.5,-905.56 2592.34,-895.21"/>
<polygon fill="black" stroke="black" points="2593.36,-898.56 2602.25,-892.8 2591.7,-891.76 2593.36,-898.56"/>
</g>
<!-- layer0_stage0_qkv_proj_7 -->
<g id="node10" class="node">
<title>layer0_stage0_qkv_proj_7</title>
<polygon fill="none" stroke="black" points="3262.72,-892.79 3010.72,-892.79 3010.72,-829.79 3262.72,-829.79 3262.72,-892.79"/>
<text text-anchor="middle" x="3136.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_qkv_proj_7</text>
<text text-anchor="middle" x="3136.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;7)</text>
<text text-anchor="middle" x="3136.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3136.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="3136.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_7 -->
<g id="edge8" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_qkv_proj_7</title>
<path fill="none" stroke="black" d="M2064.64,-985.42C2094.72,-975.57 2128.22,-966.06 2159.72,-960.29 2463.51,-904.59 2547.62,-965.47 2853.72,-924.29 2904.67,-917.43 2960.04,-906.17 3008.19,-895.11"/>
<polygon fill="black" stroke="black" points="3009.08,-898.49 3018.04,-892.83 3007.5,-891.67 3009.08,-898.49"/>
</g>
<!-- layer0_stage0_attention_residual -->
<g id="node36" class="node">
<title>layer0_stage0_attention_residual</title>
<ellipse fill="none" stroke="black" cx="2744.72" cy="-188.1" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="2744.72" y="-207.6" font-family="Arial" font-size="10.00">layer0_stage0_attention_residual</text>
<text text-anchor="middle" x="2744.72" y="-196.6" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2744.72" y="-185.6" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2744.72" y="-174.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="2744.72" y="-163.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_input_reshape&#45;&gt;layer0_stage0_attention_residual -->
<g id="edge41" class="edge">
<title>layer0_stage0_input_reshape&#45;&gt;layer0_stage0_attention_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2063.58,-985.36C2093.92,-975.38 2127.82,-965.82 2159.72,-960.29 2403.33,-918.07 3037.1,-1002.29 3271.72,-924.29 3408.54,-878.8 3522.72,-862.93 3522.72,-718.74 3522.72,-718.74 3522.72,-718.74 3522.72,-479.6 3522.72,-346.5 3118.04,-254.28 2892.41,-213.21"/>
<polygon fill="black" stroke="black" points="2892.93,-209.74 2882.46,-211.41 2891.68,-216.63 2892.93,-209.74"/>
</g>
<!-- layer0_stage0_qkv_reshape_0 -->
<g id="node11" class="node">
<title>layer0_stage0_qkv_reshape_0</title>
<ellipse fill="none" stroke="black" cx="210.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="210.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_0</text>
<text text-anchor="middle" x="210.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;0)</text>
<text text-anchor="middle" x="210.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="210.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="210.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_0&#45;&gt;layer0_stage0_qkv_reshape_0 -->
<g id="edge9" class="edge">
<title>layer0_stage0_qkv_proj_0&#45;&gt;layer0_stage0_qkv_reshape_0</title>
<path fill="none" stroke="black" d="M343.05,-829.57C321.5,-811.52 293.76,-788.29 269.25,-767.76"/>
<polygon fill="black" stroke="black" points="271.33,-764.94 261.42,-761.2 266.84,-770.31 271.33,-764.94"/>
</g>
<!-- layer0_stage0_qkv_reshape_1 -->
<g id="node12" class="node">
<title>layer0_stage0_qkv_reshape_1</title>
<ellipse fill="none" stroke="black" cx="649.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="649.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_1</text>
<text text-anchor="middle" x="649.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;1)</text>
<text text-anchor="middle" x="649.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="649.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="649.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_1&#45;&gt;layer0_stage0_qkv_reshape_1 -->
<g id="edge10" class="edge">
<title>layer0_stage0_qkv_proj_1&#45;&gt;layer0_stage0_qkv_reshape_1</title>
<path fill="none" stroke="black" d="M782.05,-829.57C760.5,-811.52 732.76,-788.29 708.25,-767.76"/>
<polygon fill="black" stroke="black" points="710.33,-764.94 700.42,-761.2 705.84,-770.31 710.33,-764.94"/>
</g>
<!-- layer0_stage0_qkv_reshape_2 -->
<g id="node13" class="node">
<title>layer0_stage0_qkv_reshape_2</title>
<ellipse fill="none" stroke="black" cx="1088.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="1088.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_2</text>
<text text-anchor="middle" x="1088.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;2)</text>
<text text-anchor="middle" x="1088.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1088.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="1088.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_2&#45;&gt;layer0_stage0_qkv_reshape_2 -->
<g id="edge11" class="edge">
<title>layer0_stage0_qkv_proj_2&#45;&gt;layer0_stage0_qkv_reshape_2</title>
<path fill="none" stroke="black" d="M1154.49,-829.57C1144.28,-812.36 1131.27,-790.44 1119.52,-770.64"/>
<polygon fill="black" stroke="black" points="1122.51,-768.82 1114.4,-762.01 1116.49,-772.4 1122.51,-768.82"/>
</g>
<!-- layer0_stage0_qkv_reshape_3 -->
<g id="node14" class="node">
<title>layer0_stage0_qkv_reshape_3</title>
<ellipse fill="none" stroke="black" cx="1527.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="1527.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_3</text>
<text text-anchor="middle" x="1527.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;3)</text>
<text text-anchor="middle" x="1527.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1527.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="1527.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_3&#45;&gt;layer0_stage0_qkv_reshape_3 -->
<g id="edge12" class="edge">
<title>layer0_stage0_qkv_proj_3&#45;&gt;layer0_stage0_qkv_reshape_3</title>
<path fill="none" stroke="black" d="M1593.49,-829.57C1583.28,-812.36 1570.27,-790.44 1558.52,-770.64"/>
<polygon fill="black" stroke="black" points="1561.51,-768.82 1553.4,-762.01 1555.49,-772.4 1561.51,-768.82"/>
</g>
<!-- layer0_stage0_qkv_reshape_4 -->
<g id="node15" class="node">
<title>layer0_stage0_qkv_reshape_4</title>
<ellipse fill="none" stroke="black" cx="1966.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="1966.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_4</text>
<text text-anchor="middle" x="1966.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;4)</text>
<text text-anchor="middle" x="1966.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1966.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="1966.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_4&#45;&gt;layer0_stage0_qkv_reshape_4 -->
<g id="edge13" class="edge">
<title>layer0_stage0_qkv_proj_4&#45;&gt;layer0_stage0_qkv_reshape_4</title>
<path fill="none" stroke="black" d="M1966.72,-829.57C1966.72,-812.96 1966.72,-791.96 1966.72,-772.72"/>
<polygon fill="black" stroke="black" points="1970.22,-772.55 1966.72,-762.55 1963.22,-772.55 1970.22,-772.55"/>
</g>
<!-- layer0_stage0_qkv_reshape_5 -->
<g id="node16" class="node">
<title>layer0_stage0_qkv_reshape_5</title>
<ellipse fill="none" stroke="black" cx="2405.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="2405.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_5</text>
<text text-anchor="middle" x="2405.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;5)</text>
<text text-anchor="middle" x="2405.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2405.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="2405.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_5&#45;&gt;layer0_stage0_qkv_reshape_5 -->
<g id="edge14" class="edge">
<title>layer0_stage0_qkv_proj_5&#45;&gt;layer0_stage0_qkv_reshape_5</title>
<path fill="none" stroke="black" d="M2339.94,-829.57C2350.16,-812.36 2363.17,-790.44 2374.92,-770.64"/>
<polygon fill="black" stroke="black" points="2377.94,-772.4 2380.04,-762.01 2371.92,-768.82 2377.94,-772.4"/>
</g>
<!-- layer0_stage0_qkv_reshape_6 -->
<g id="node17" class="node">
<title>layer0_stage0_qkv_reshape_6</title>
<ellipse fill="none" stroke="black" cx="2844.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="2844.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_6</text>
<text text-anchor="middle" x="2844.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;6)</text>
<text text-anchor="middle" x="2844.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2844.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="2844.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_6&#45;&gt;layer0_stage0_qkv_reshape_6 -->
<g id="edge15" class="edge">
<title>layer0_stage0_qkv_proj_6&#45;&gt;layer0_stage0_qkv_reshape_6</title>
<path fill="none" stroke="black" d="M2746.06,-829.57C2761.72,-811.98 2781.76,-789.46 2799.69,-769.33"/>
<polygon fill="black" stroke="black" points="2802.4,-771.54 2806.44,-761.74 2797.17,-766.88 2802.4,-771.54"/>
</g>
<!-- layer0_stage0_qkv_reshape_7 -->
<g id="node18" class="node">
<title>layer0_stage0_qkv_reshape_7</title>
<ellipse fill="none" stroke="black" cx="3283.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="3283.72" y="-737.24" font-family="Arial" font-size="10.00">layer0_stage0_qkv_reshape_7</text>
<text text-anchor="middle" x="3283.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;7)</text>
<text text-anchor="middle" x="3283.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3283.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="3283.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_proj_7&#45;&gt;layer0_stage0_qkv_reshape_7 -->
<g id="edge16" class="edge">
<title>layer0_stage0_qkv_proj_7&#45;&gt;layer0_stage0_qkv_reshape_7</title>
<path fill="none" stroke="black" d="M3168.61,-829.57C3187.12,-811.75 3210.87,-788.88 3231.99,-768.55"/>
<polygon fill="black" stroke="black" points="3234.56,-770.93 3239.34,-761.47 3229.71,-765.89 3234.56,-770.93"/>
</g>
<!-- layer0_stage0_attention_0 -->
<g id="node19" class="node">
<title>layer0_stage0_attention_0</title>
<polygon fill="none" stroke="black" points="454.72,-624.14 156.72,-624.14 156.72,-561.14 454.72,-561.14 454.72,-624.14"/>
<text text-anchor="middle" x="305.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_0</text>
<text text-anchor="middle" x="305.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;0)</text>
<text text-anchor="middle" x="305.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="305.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="305.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_0&#45;&gt;layer0_stage0_attention_0 -->
<g id="edge17" class="edge">
<title>layer0_stage0_qkv_reshape_0&#45;&gt;layer0_stage0_attention_0</title>
<path fill="none" stroke="black" d="M243.94,-673.69C254.31,-660.25 265.68,-645.52 275.81,-632.4"/>
<polygon fill="black" stroke="black" points="278.59,-634.52 281.93,-624.46 273.05,-630.24 278.59,-634.52"/>
</g>
<!-- layer0_stage0_attention_1 -->
<g id="node20" class="node">
<title>layer0_stage0_attention_1</title>
<polygon fill="none" stroke="black" points="831.72,-624.14 533.72,-624.14 533.72,-561.14 831.72,-561.14 831.72,-624.14"/>
<text text-anchor="middle" x="682.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_1</text>
<text text-anchor="middle" x="682.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;1)</text>
<text text-anchor="middle" x="682.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="682.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="682.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_1&#45;&gt;layer0_stage0_attention_1 -->
<g id="edge18" class="edge">
<title>layer0_stage0_qkv_reshape_1&#45;&gt;layer0_stage0_attention_1</title>
<path fill="none" stroke="black" d="M661.45,-672.99C664.8,-660.47 668.45,-646.87 671.76,-634.52"/>
<polygon fill="black" stroke="black" points="675.24,-635.06 674.45,-624.5 668.48,-633.25 675.24,-635.06"/>
</g>
<!-- layer0_stage0_attention_2 -->
<g id="node21" class="node">
<title>layer0_stage0_attention_2</title>
<polygon fill="none" stroke="black" points="1270.72,-624.14 972.72,-624.14 972.72,-561.14 1270.72,-561.14 1270.72,-624.14"/>
<text text-anchor="middle" x="1121.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_2</text>
<text text-anchor="middle" x="1121.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;2)</text>
<text text-anchor="middle" x="1121.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1121.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="1121.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_2&#45;&gt;layer0_stage0_attention_2 -->
<g id="edge19" class="edge">
<title>layer0_stage0_qkv_reshape_2&#45;&gt;layer0_stage0_attention_2</title>
<path fill="none" stroke="black" d="M1100.45,-672.99C1103.8,-660.47 1107.45,-646.87 1110.76,-634.52"/>
<polygon fill="black" stroke="black" points="1114.24,-635.06 1113.45,-624.5 1107.48,-633.25 1114.24,-635.06"/>
</g>
<!-- layer0_stage0_attention_3 -->
<g id="node22" class="node">
<title>layer0_stage0_attention_3</title>
<polygon fill="none" stroke="black" points="1709.72,-624.14 1411.72,-624.14 1411.72,-561.14 1709.72,-561.14 1709.72,-624.14"/>
<text text-anchor="middle" x="1560.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_3</text>
<text text-anchor="middle" x="1560.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;3)</text>
<text text-anchor="middle" x="1560.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1560.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="1560.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_3&#45;&gt;layer0_stage0_attention_3 -->
<g id="edge20" class="edge">
<title>layer0_stage0_qkv_reshape_3&#45;&gt;layer0_stage0_attention_3</title>
<path fill="none" stroke="black" d="M1539.45,-672.99C1542.8,-660.47 1546.45,-646.87 1549.76,-634.52"/>
<polygon fill="black" stroke="black" points="1553.24,-635.06 1552.45,-624.5 1546.48,-633.25 1553.24,-635.06"/>
</g>
<!-- layer0_stage0_attention_4 -->
<g id="node23" class="node">
<title>layer0_stage0_attention_4</title>
<polygon fill="none" stroke="black" points="2115.72,-624.14 1817.72,-624.14 1817.72,-561.14 2115.72,-561.14 2115.72,-624.14"/>
<text text-anchor="middle" x="1966.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_4</text>
<text text-anchor="middle" x="1966.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;4)</text>
<text text-anchor="middle" x="1966.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1966.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="1966.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_4&#45;&gt;layer0_stage0_attention_4 -->
<g id="edge21" class="edge">
<title>layer0_stage0_qkv_reshape_4&#45;&gt;layer0_stage0_attention_4</title>
<path fill="none" stroke="black" d="M1966.72,-672.99C1966.72,-660.47 1966.72,-646.87 1966.72,-634.52"/>
<polygon fill="black" stroke="black" points="1970.22,-634.5 1966.72,-624.5 1963.22,-634.5 1970.22,-634.5"/>
</g>
<!-- layer0_stage0_attention_5 -->
<g id="node24" class="node">
<title>layer0_stage0_attention_5</title>
<polygon fill="none" stroke="black" points="2493.72,-624.14 2195.72,-624.14 2195.72,-561.14 2493.72,-561.14 2493.72,-624.14"/>
<text text-anchor="middle" x="2344.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_5</text>
<text text-anchor="middle" x="2344.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;5)</text>
<text text-anchor="middle" x="2344.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2344.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="2344.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_5&#45;&gt;layer0_stage0_attention_5 -->
<g id="edge22" class="edge">
<title>layer0_stage0_qkv_reshape_5&#45;&gt;layer0_stage0_attention_5</title>
<path fill="none" stroke="black" d="M2384.21,-673.34C2377.75,-660.31 2370.7,-646.08 2364.37,-633.3"/>
<polygon fill="black" stroke="black" points="2367.48,-631.7 2359.9,-624.29 2361.21,-634.8 2367.48,-631.7"/>
</g>
<!-- layer0_stage0_attention_6 -->
<g id="node25" class="node">
<title>layer0_stage0_attention_6</title>
<polygon fill="none" stroke="black" points="2901.72,-624.14 2603.72,-624.14 2603.72,-561.14 2901.72,-561.14 2901.72,-624.14"/>
<text text-anchor="middle" x="2752.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_6</text>
<text text-anchor="middle" x="2752.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;6)</text>
<text text-anchor="middle" x="2752.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2752.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="2752.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_6&#45;&gt;layer0_stage0_attention_6 -->
<g id="edge23" class="edge">
<title>layer0_stage0_qkv_reshape_6&#45;&gt;layer0_stage0_attention_6</title>
<path fill="none" stroke="black" d="M2812.54,-673.69C2802.59,-660.38 2791.7,-645.8 2781.96,-632.77"/>
<polygon fill="black" stroke="black" points="2784.54,-630.38 2775.75,-624.46 2778.93,-634.57 2784.54,-630.38"/>
</g>
<!-- layer0_stage0_attention_7 -->
<g id="node26" class="node">
<title>layer0_stage0_attention_7</title>
<polygon fill="none" stroke="black" points="3325.72,-624.14 3027.72,-624.14 3027.72,-561.14 3325.72,-561.14 3325.72,-624.14"/>
<text text-anchor="middle" x="3176.72" y="-612.14" font-family="Arial" font-size="10.00">layer0_stage0_attention_7</text>
<text text-anchor="middle" x="3176.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;7)</text>
<text text-anchor="middle" x="3176.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3176.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="3176.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer0_stage0_qkv_reshape_7&#45;&gt;layer0_stage0_attention_7 -->
<g id="edge24" class="edge">
<title>layer0_stage0_qkv_reshape_7&#45;&gt;layer0_stage0_attention_7</title>
<path fill="none" stroke="black" d="M3246.29,-673.69C3234.51,-660.12 3221.57,-645.24 3210.08,-632.03"/>
<polygon fill="black" stroke="black" points="3212.71,-629.71 3203.51,-624.46 3207.43,-634.31 3212.71,-629.71"/>
</g>
<!-- layer0_stage0_output_proj_0 -->
<g id="node27" class="node">
<title>layer0_stage0_output_proj_0</title>
<polygon fill="none" stroke="black" points="550.72,-512.1 260.72,-512.1 260.72,-449.1 550.72,-449.1 550.72,-512.1"/>
<text text-anchor="middle" x="405.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_0</text>
<text text-anchor="middle" x="405.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;0)</text>
<text text-anchor="middle" x="405.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="405.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="405.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_0&#45;&gt;layer0_stage0_output_proj_0 -->
<g id="edge25" class="edge">
<title>layer0_stage0_attention_0&#45;&gt;layer0_stage0_output_proj_0</title>
<path fill="none" stroke="black" d="M333.57,-560.99C345.07,-548.34 358.53,-533.53 370.68,-520.15"/>
<polygon fill="black" stroke="black" points="373.53,-522.22 377.66,-512.47 368.35,-517.51 373.53,-522.22"/>
</g>
<!-- layer0_stage0_output_proj_1 -->
<g id="node28" class="node">
<title>layer0_stage0_output_proj_1</title>
<polygon fill="none" stroke="black" points="892.72,-512.1 602.72,-512.1 602.72,-449.1 892.72,-449.1 892.72,-512.1"/>
<text text-anchor="middle" x="747.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_1</text>
<text text-anchor="middle" x="747.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;1)</text>
<text text-anchor="middle" x="747.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="747.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="747.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_1&#45;&gt;layer0_stage0_output_proj_1 -->
<g id="edge26" class="edge">
<title>layer0_stage0_attention_1&#45;&gt;layer0_stage0_output_proj_1</title>
<path fill="none" stroke="black" d="M700.82,-560.99C708.09,-548.69 716.55,-534.36 724.28,-521.28"/>
<polygon fill="black" stroke="black" points="727.41,-522.86 729.48,-512.47 721.38,-519.3 727.41,-522.86"/>
</g>
<!-- layer0_stage0_output_proj_2 -->
<g id="node29" class="node">
<title>layer0_stage0_output_proj_2</title>
<polygon fill="none" stroke="black" points="1331.72,-512.1 1041.72,-512.1 1041.72,-449.1 1331.72,-449.1 1331.72,-512.1"/>
<text text-anchor="middle" x="1186.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_2</text>
<text text-anchor="middle" x="1186.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;2)</text>
<text text-anchor="middle" x="1186.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1186.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="1186.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_2&#45;&gt;layer0_stage0_output_proj_2 -->
<g id="edge27" class="edge">
<title>layer0_stage0_attention_2&#45;&gt;layer0_stage0_output_proj_2</title>
<path fill="none" stroke="black" d="M1139.82,-560.99C1147.09,-548.69 1155.55,-534.36 1163.28,-521.28"/>
<polygon fill="black" stroke="black" points="1166.41,-522.86 1168.48,-512.47 1160.38,-519.3 1166.41,-522.86"/>
</g>
<!-- layer0_stage0_output_proj_3 -->
<g id="node30" class="node">
<title>layer0_stage0_output_proj_3</title>
<polygon fill="none" stroke="black" points="1770.72,-512.1 1480.72,-512.1 1480.72,-449.1 1770.72,-449.1 1770.72,-512.1"/>
<text text-anchor="middle" x="1625.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_3</text>
<text text-anchor="middle" x="1625.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;3)</text>
<text text-anchor="middle" x="1625.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1625.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="1625.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_3&#45;&gt;layer0_stage0_output_proj_3 -->
<g id="edge28" class="edge">
<title>layer0_stage0_attention_3&#45;&gt;layer0_stage0_output_proj_3</title>
<path fill="none" stroke="black" d="M1578.82,-560.99C1586.09,-548.69 1594.55,-534.36 1602.28,-521.28"/>
<polygon fill="black" stroke="black" points="1605.41,-522.86 1607.48,-512.47 1599.38,-519.3 1605.41,-522.86"/>
</g>
<!-- layer0_stage0_output_proj_4 -->
<g id="node31" class="node">
<title>layer0_stage0_output_proj_4</title>
<polygon fill="none" stroke="black" points="2111.72,-512.1 1821.72,-512.1 1821.72,-449.1 2111.72,-449.1 2111.72,-512.1"/>
<text text-anchor="middle" x="1966.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_4</text>
<text text-anchor="middle" x="1966.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;4)</text>
<text text-anchor="middle" x="1966.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1966.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="1966.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_4&#45;&gt;layer0_stage0_output_proj_4 -->
<g id="edge29" class="edge">
<title>layer0_stage0_attention_4&#45;&gt;layer0_stage0_output_proj_4</title>
<path fill="none" stroke="black" d="M1966.72,-560.99C1966.72,-549.16 1966.72,-535.46 1966.72,-522.79"/>
<polygon fill="black" stroke="black" points="1970.22,-522.47 1966.72,-512.47 1963.22,-522.47 1970.22,-522.47"/>
</g>
<!-- layer0_stage0_output_proj_5 -->
<g id="node32" class="node">
<title>layer0_stage0_output_proj_5</title>
<polygon fill="none" stroke="black" points="2454.72,-512.1 2164.72,-512.1 2164.72,-449.1 2454.72,-449.1 2454.72,-512.1"/>
<text text-anchor="middle" x="2309.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_5</text>
<text text-anchor="middle" x="2309.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;5)</text>
<text text-anchor="middle" x="2309.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2309.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="2309.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_5&#45;&gt;layer0_stage0_output_proj_5 -->
<g id="edge30" class="edge">
<title>layer0_stage0_attention_5&#45;&gt;layer0_stage0_output_proj_5</title>
<path fill="none" stroke="black" d="M2334.97,-560.99C2331.13,-548.93 2326.67,-534.91 2322.58,-522.04"/>
<polygon fill="black" stroke="black" points="2325.9,-520.94 2319.54,-512.47 2319.23,-523.06 2325.9,-520.94"/>
</g>
<!-- layer0_stage0_output_proj_6 -->
<g id="node33" class="node">
<title>layer0_stage0_output_proj_6</title>
<polygon fill="none" stroke="black" points="2830.72,-512.1 2540.72,-512.1 2540.72,-449.1 2830.72,-449.1 2830.72,-512.1"/>
<text text-anchor="middle" x="2685.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_6</text>
<text text-anchor="middle" x="2685.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;6)</text>
<text text-anchor="middle" x="2685.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2685.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="2685.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_6&#45;&gt;layer0_stage0_output_proj_6 -->
<g id="edge31" class="edge">
<title>layer0_stage0_attention_6&#45;&gt;layer0_stage0_output_proj_6</title>
<path fill="none" stroke="black" d="M2734.05,-560.99C2726.57,-548.69 2717.84,-534.36 2709.88,-521.28"/>
<polygon fill="black" stroke="black" points="2712.7,-519.19 2704.51,-512.47 2706.72,-522.83 2712.7,-519.19"/>
</g>
<!-- layer0_stage0_output_proj_7 -->
<g id="node34" class="node">
<title>layer0_stage0_output_proj_7</title>
<polygon fill="none" stroke="black" points="3230.72,-512.1 2940.72,-512.1 2940.72,-449.1 3230.72,-449.1 3230.72,-512.1"/>
<text text-anchor="middle" x="3085.72" y="-500.1" font-family="Arial" font-size="10.00">layer0_stage0_output_proj_7</text>
<text text-anchor="middle" x="3085.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;7)</text>
<text text-anchor="middle" x="3085.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="3085.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="3085.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer0_stage0_attention_7&#45;&gt;layer0_stage0_output_proj_7 -->
<g id="edge32" class="edge">
<title>layer0_stage0_attention_7&#45;&gt;layer0_stage0_output_proj_7</title>
<path fill="none" stroke="black" d="M3151.37,-560.99C3141,-548.45 3128.89,-533.8 3117.91,-520.53"/>
<polygon fill="black" stroke="black" points="3120.32,-517.94 3111.25,-512.47 3114.92,-522.4 3120.32,-517.94"/>
</g>
<!-- layer0_stage0_attention_allreduce -->
<g id="node35" class="node">
<title>layer0_stage0_attention_allreduce</title>
<polygon fill="none" stroke="black" points="2202.98,-413.1 1827.14,-413.1 1730.46,-287.1 2106.29,-287.1 2202.98,-413.1"/>
<text text-anchor="middle" x="1966.72" y="-369.6" font-family="Arial" font-size="10.00">layer0_stage0_attention_allreduce</text>
<text text-anchor="middle" x="1966.72" y="-358.6" font-family="Arial" font-size="10.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="1966.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1966.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024 (x8)</text>
<text text-anchor="middle" x="1966.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_output_proj_0&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge33" class="edge">
<title>layer0_stage0_output_proj_0&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M550.77,-454.73C565.25,-452.65 579.76,-450.72 593.72,-449.1 1013.94,-400.11 1509.58,-372.01 1775.36,-359.33"/>
<polygon fill="black" stroke="black" points="1775.67,-362.82 1785.49,-358.85 1775.34,-355.83 1775.67,-362.82"/>
</g>
<!-- layer0_stage0_output_proj_1&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge34" class="edge">
<title>layer0_stage0_output_proj_1&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M893.06,-463.98C937.85,-459.19 987.32,-453.91 1032.72,-449.1 1293.35,-421.48 1594.93,-389.9 1783.27,-370.23"/>
<polygon fill="black" stroke="black" points="1783.69,-373.71 1793.28,-369.19 1782.97,-366.74 1783.69,-373.71"/>
</g>
<!-- layer0_stage0_output_proj_2&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge35" class="edge">
<title>layer0_stage0_output_proj_2&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M1332.06,-455.65C1461.83,-434.27 1652.23,-402.91 1790.61,-380.11"/>
<polygon fill="black" stroke="black" points="1791.19,-383.56 1800.48,-378.48 1790.05,-376.65 1791.19,-383.56"/>
</g>
<!-- layer0_stage0_output_proj_3&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge36" class="edge">
<title>layer0_stage0_output_proj_3&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M1706.96,-448.98C1738.43,-437.12 1775.54,-423.14 1811.72,-409.51"/>
<polygon fill="black" stroke="black" points="1813.26,-412.66 1821.39,-405.86 1810.79,-406.11 1813.26,-412.66"/>
</g>
<!-- layer0_stage0_output_proj_4&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge37" class="edge">
<title>layer0_stage0_output_proj_4&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M1966.72,-448.82C1966.72,-440.99 1966.72,-432.25 1966.72,-423.3"/>
<polygon fill="black" stroke="black" points="1970.22,-423.15 1966.72,-413.15 1963.22,-423.15 1970.22,-423.15"/>
</g>
<!-- layer0_stage0_output_proj_5&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge38" class="edge">
<title>layer0_stage0_output_proj_5&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M2228,-448.98C2201.98,-439.23 2172.13,-428.05 2142.11,-416.81"/>
<polygon fill="black" stroke="black" points="2142.96,-413.39 2132.37,-413.15 2140.51,-419.94 2142.96,-413.39"/>
</g>
<!-- layer0_stage0_output_proj_6&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge39" class="edge">
<title>layer0_stage0_output_proj_6&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M2540.65,-453.67C2441.8,-436 2308.86,-412.24 2195.82,-392.04"/>
<polygon fill="black" stroke="black" points="2196.1,-388.54 2185.64,-390.22 2194.87,-395.43 2196.1,-388.54"/>
</g>
<!-- layer0_stage0_output_proj_7&#45;&gt;layer0_stage0_attention_allreduce -->
<g id="edge40" class="edge">
<title>layer0_stage0_output_proj_7&#45;&gt;layer0_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M2940.71,-461.33C2907.53,-457.23 2872.41,-452.96 2839.72,-449.1 2615.92,-422.66 2359.64,-394.09 2182.93,-374.66"/>
<polygon fill="black" stroke="black" points="2183.05,-371.16 2172.73,-373.54 2182.29,-378.11 2183.05,-371.16"/>
</g>
<!-- layer0_stage0_attention_allreduce&#45;&gt;layer0_stage0_attention_residual -->
<g id="edge42" class="edge">
<title>layer0_stage0_attention_allreduce&#45;&gt;layer0_stage0_attention_residual</title>
<path fill="none" stroke="black" d="M2128.39,-315.85C2269.88,-286.75 2473.17,-244.94 2607.04,-217.41"/>
<polygon fill="black" stroke="black" points="2607.87,-220.81 2616.96,-215.37 2606.46,-213.96 2607.87,-220.81"/>
</g>
<!-- layer0_stage0_gating -->
<g id="node37" class="node">
<title>layer0_stage0_gating</title>
<polygon fill="none" stroke="black" points="9547.3,-1248.29 9197.99,-1248.29 9108.13,-1122.29 9457.44,-1122.29 9547.3,-1248.29"/>
<text text-anchor="middle" x="9327.72" y="-1204.79" font-family="Arial" font-size="10.00">layer0_stage0_gating</text>
<text text-anchor="middle" x="9327.72" y="-1193.79" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="9327.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="9327.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192</text>
<text text-anchor="middle" x="9327.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, num_experts=16</text>
</g>
<!-- layer0_stage0_expert_0_gpu0 -->
<g id="node38" class="node">
<title>layer0_stage0_expert_0_gpu0</title>
<polygon fill="none" stroke="black" points="2374.72,-1054.79 2168.72,-1054.79 2168.72,-991.79 2374.72,-991.79 2374.72,-1054.79"/>
<text text-anchor="middle" x="2271.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_0_gpu0</text>
<text text-anchor="middle" x="2271.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2271.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2271.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="2271.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_0_gpu0 -->
<g id="edge43" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9152.03,-1184.22C8104.86,-1183.55 2720.21,-1175.75 2383.72,-1086.29 2362.95,-1080.77 2341.9,-1070.57 2323.73,-1060.02"/>
<polygon fill="black" stroke="black" points="2325.44,-1056.97 2315.06,-1054.83 2321.85,-1062.97 2325.44,-1056.97"/>
</g>
<!-- layer0_stage0_expert_1_gpu0 -->
<g id="node39" class="node">
<title>layer0_stage0_expert_1_gpu0</title>
<polygon fill="none" stroke="black" points="2598.72,-1054.79 2392.72,-1054.79 2392.72,-991.79 2598.72,-991.79 2598.72,-1054.79"/>
<text text-anchor="middle" x="2495.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_1_gpu0</text>
<text text-anchor="middle" x="2495.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2495.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2495.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="2495.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_1_gpu0 -->
<g id="edge44" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.9,-1184.14C8124.59,-1182.97 2932.73,-1172.77 2607.72,-1086.29 2586.95,-1080.76 2565.9,-1070.57 2547.73,-1060.02"/>
<polygon fill="black" stroke="black" points="2549.44,-1056.96 2539.06,-1054.83 2545.85,-1062.97 2549.44,-1056.96"/>
</g>
<!-- layer0_stage0_expert_2_gpu0 -->
<g id="node40" class="node">
<title>layer0_stage0_expert_2_gpu0</title>
<polygon fill="none" stroke="black" points="2822.72,-1054.79 2616.72,-1054.79 2616.72,-991.79 2822.72,-991.79 2822.72,-1054.79"/>
<text text-anchor="middle" x="2719.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_2_gpu0</text>
<text text-anchor="middle" x="2719.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2719.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2719.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="2719.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_2_gpu0 -->
<g id="edge45" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9152.06,-1184.05C8145.66,-1182.36 3145.28,-1169.81 2831.72,-1086.29 2810.95,-1080.76 2789.9,-1070.56 2771.74,-1060.01"/>
<polygon fill="black" stroke="black" points="2773.44,-1056.95 2763.07,-1054.82 2769.85,-1062.96 2773.44,-1056.95"/>
</g>
<!-- layer0_stage0_expert_3_gpu0 -->
<g id="node41" class="node">
<title>layer0_stage0_expert_3_gpu0</title>
<polygon fill="none" stroke="black" points="3046.72,-1054.79 2840.72,-1054.79 2840.72,-991.79 3046.72,-991.79 3046.72,-1054.79"/>
<text text-anchor="middle" x="2943.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_3_gpu0</text>
<text text-anchor="middle" x="2943.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2943.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2943.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="2943.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_3_gpu0 -->
<g id="edge46" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.73,-1183.95C8165.46,-1181.73 3357.79,-1166.84 3055.72,-1086.29 3034.96,-1080.75 3013.9,-1070.55 2995.74,-1060"/>
<polygon fill="black" stroke="black" points="2997.45,-1056.95 2987.07,-1054.82 2993.85,-1062.95 2997.45,-1056.95"/>
</g>
<!-- layer0_stage0_expert_4_gpu0 -->
<g id="node42" class="node">
<title>layer0_stage0_expert_4_gpu0</title>
<polygon fill="none" stroke="black" points="3270.72,-1054.79 3064.72,-1054.79 3064.72,-991.79 3270.72,-991.79 3270.72,-1054.79"/>
<text text-anchor="middle" x="3167.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_4_gpu0</text>
<text text-anchor="middle" x="3167.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="3167.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3167.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="3167.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_4_gpu0 -->
<g id="edge47" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.75,-1183.84C8186.8,-1181.08 3570.35,-1163.88 3279.72,-1086.29 3258.96,-1080.74 3237.9,-1070.55 3219.74,-1060"/>
<polygon fill="black" stroke="black" points="3221.45,-1056.94 3211.07,-1054.81 3217.85,-1062.95 3221.45,-1056.94"/>
</g>
<!-- layer0_stage0_expert_5_gpu0 -->
<g id="node43" class="node">
<title>layer0_stage0_expert_5_gpu0</title>
<polygon fill="none" stroke="black" points="3494.72,-1054.79 3288.72,-1054.79 3288.72,-991.79 3494.72,-991.79 3494.72,-1054.79"/>
<text text-anchor="middle" x="3391.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_5_gpu0</text>
<text text-anchor="middle" x="3391.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="3391.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3391.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="3391.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_5_gpu0 -->
<g id="edge48" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.75,-1183.72C8208.46,-1180.41 3782.91,-1160.92 3503.72,-1086.29 3482.96,-1080.74 3461.91,-1070.54 3443.74,-1059.99"/>
<polygon fill="black" stroke="black" points="3445.45,-1056.93 3435.07,-1054.8 3441.86,-1062.94 3445.45,-1056.93"/>
</g>
<!-- layer0_stage0_expert_6_gpu0 -->
<g id="node44" class="node">
<title>layer0_stage0_expert_6_gpu0</title>
<polygon fill="none" stroke="black" points="3718.72,-1054.79 3512.72,-1054.79 3512.72,-991.79 3718.72,-991.79 3718.72,-1054.79"/>
<text text-anchor="middle" x="3615.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_6_gpu0</text>
<text text-anchor="middle" x="3615.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="3615.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3615.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="3615.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_6_gpu0 -->
<g id="edge49" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.76,-1183.6C8230.59,-1179.71 3995.49,-1157.96 3727.72,-1086.29 3706.96,-1080.73 3685.91,-1070.53 3667.74,-1059.98"/>
<polygon fill="black" stroke="black" points="3669.45,-1056.92 3659.07,-1054.8 3665.86,-1062.93 3669.45,-1056.92"/>
</g>
<!-- layer0_stage0_expert_7_gpu0 -->
<g id="node45" class="node">
<title>layer0_stage0_expert_7_gpu0</title>
<polygon fill="none" stroke="black" points="3942.72,-1054.79 3736.72,-1054.79 3736.72,-991.79 3942.72,-991.79 3942.72,-1054.79"/>
<text text-anchor="middle" x="3839.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_7_gpu0</text>
<text text-anchor="middle" x="3839.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="3839.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3839.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="3839.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_7_gpu0 -->
<g id="edge50" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.46,-1183.46C8252.22,-1178.97 4208.06,-1155 3951.72,-1086.29 3930.96,-1080.72 3909.91,-1070.52 3891.75,-1059.97"/>
<polygon fill="black" stroke="black" points="3893.45,-1056.92 3883.07,-1054.79 3889.86,-1062.92 3893.45,-1056.92"/>
</g>
<!-- layer0_stage0_expert_8_gpu1 -->
<g id="node46" class="node">
<title>layer0_stage0_expert_8_gpu1</title>
<polygon fill="none" stroke="black" points="4166.72,-1054.79 3960.72,-1054.79 3960.72,-991.79 4166.72,-991.79 4166.72,-1054.79"/>
<text text-anchor="middle" x="4063.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_8_gpu1</text>
<text text-anchor="middle" x="4063.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="4063.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="4063.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="4063.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_8_gpu1 -->
<g id="edge51" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_8_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.63,-1183.32C8275.75,-1178.21 4420.68,-1152.05 4175.72,-1086.29 4155.06,-1080.74 4134.1,-1070.6 4115.99,-1060.1"/>
<polygon fill="black" stroke="black" points="4117.72,-1057.06 4107.34,-1054.94 4114.14,-1063.07 4117.72,-1057.06"/>
</g>
<!-- layer0_stage0_expert_9_gpu1 -->
<g id="node47" class="node">
<title>layer0_stage0_expert_9_gpu1</title>
<polygon fill="none" stroke="black" points="4390.72,-1054.79 4184.72,-1054.79 4184.72,-991.79 4390.72,-991.79 4390.72,-1054.79"/>
<text text-anchor="middle" x="4287.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_9_gpu1</text>
<text text-anchor="middle" x="4287.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="4287.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="4287.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="4287.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_9_gpu1 -->
<g id="edge52" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_9_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.23,-1183.16C8298.15,-1177.4 4633.26,-1149.1 4399.72,-1086.29 4379.06,-1080.73 4358.1,-1070.59 4339.99,-1060.09"/>
<polygon fill="black" stroke="black" points="4341.73,-1057.05 4331.35,-1054.93 4338.14,-1063.06 4341.73,-1057.05"/>
</g>
<!-- layer0_stage0_expert_10_gpu1 -->
<g id="node48" class="node">
<title>layer0_stage0_expert_10_gpu1</title>
<polygon fill="none" stroke="black" points="4614.72,-1054.79 4408.72,-1054.79 4408.72,-991.79 4614.72,-991.79 4614.72,-1054.79"/>
<text text-anchor="middle" x="4511.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_10_gpu1</text>
<text text-anchor="middle" x="4511.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="4511.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="4511.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="4511.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_10_gpu1 -->
<g id="edge53" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_10_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.41,-1182.98C8322.73,-1176.57 4845.91,-1146.16 4623.72,-1086.29 4603.06,-1080.72 4582.11,-1070.58 4564,-1060.08"/>
<polygon fill="black" stroke="black" points="4565.73,-1057.04 4555.35,-1054.92 4562.14,-1063.05 4565.73,-1057.04"/>
</g>
<!-- layer0_stage0_expert_11_gpu1 -->
<g id="node49" class="node">
<title>layer0_stage0_expert_11_gpu1</title>
<polygon fill="none" stroke="black" points="4838.72,-1054.79 4632.72,-1054.79 4632.72,-991.79 4838.72,-991.79 4838.72,-1054.79"/>
<text text-anchor="middle" x="4735.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_11_gpu1</text>
<text text-anchor="middle" x="4735.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="4735.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="4735.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="4735.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_11_gpu1 -->
<g id="edge54" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_11_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.17,-1182.79C8346.75,-1175.68 5058.54,-1143.21 4847.72,-1086.29 4827.07,-1080.71 4806.11,-1070.56 4788,-1060.07"/>
<polygon fill="black" stroke="black" points="4789.73,-1057.03 4779.35,-1054.91 4786.15,-1063.04 4789.73,-1057.03"/>
</g>
<!-- layer0_stage0_expert_12_gpu1 -->
<g id="node50" class="node">
<title>layer0_stage0_expert_12_gpu1</title>
<polygon fill="none" stroke="black" points="5062.72,-1054.79 4856.72,-1054.79 4856.72,-991.79 5062.72,-991.79 5062.72,-1054.79"/>
<text text-anchor="middle" x="4959.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_12_gpu1</text>
<text text-anchor="middle" x="4959.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4959.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="4959.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="4959.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_12_gpu1 -->
<g id="edge55" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_12_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9150.95,-1182.58C8371.49,-1174.74 5271.2,-1140.27 5071.72,-1086.29 5051.07,-1080.7 5030.12,-1070.55 5012,-1060.06"/>
<polygon fill="black" stroke="black" points="5013.74,-1057.01 5003.36,-1054.9 5010.15,-1063.03 5013.74,-1057.01"/>
</g>
<!-- layer0_stage0_expert_13_gpu1 -->
<g id="node51" class="node">
<title>layer0_stage0_expert_13_gpu1</title>
<polygon fill="none" stroke="black" points="5286.72,-1054.79 5080.72,-1054.79 5080.72,-991.79 5286.72,-991.79 5286.72,-1054.79"/>
<text text-anchor="middle" x="5183.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_13_gpu1</text>
<text text-anchor="middle" x="5183.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="5183.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="5183.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="5183.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_13_gpu1 -->
<g id="edge56" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_13_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9150.86,-1182.34C8397.24,-1173.74 5483.88,-1137.34 5295.72,-1086.29 5275.07,-1080.68 5254.12,-1070.53 5236.01,-1060.04"/>
<polygon fill="black" stroke="black" points="5237.74,-1057 5227.36,-1054.88 5234.16,-1063.01 5237.74,-1057"/>
</g>
<!-- layer0_stage0_expert_14_gpu1 -->
<g id="node52" class="node">
<title>layer0_stage0_expert_14_gpu1</title>
<polygon fill="none" stroke="black" points="5510.72,-1054.79 5304.72,-1054.79 5304.72,-991.79 5510.72,-991.79 5510.72,-1054.79"/>
<text text-anchor="middle" x="5407.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_14_gpu1</text>
<text text-anchor="middle" x="5407.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="5407.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="5407.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="5407.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_14_gpu1 -->
<g id="edge57" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_14_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9152.52,-1184.67C8451.86,-1185.55 5872.14,-1182.17 5519.72,-1086.29 5499.08,-1080.67 5478.12,-1070.51 5460.01,-1060.02"/>
<polygon fill="black" stroke="black" points="5461.75,-1056.98 5451.36,-1054.87 5458.16,-1062.99 5461.75,-1056.98"/>
</g>
<!-- layer0_stage0_expert_15_gpu1 -->
<g id="node53" class="node">
<title>layer0_stage0_expert_15_gpu1</title>
<polygon fill="none" stroke="black" points="5734.72,-1054.79 5528.72,-1054.79 5528.72,-991.79 5734.72,-991.79 5734.72,-1054.79"/>
<text text-anchor="middle" x="5631.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_15_gpu1</text>
<text text-anchor="middle" x="5631.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="5631.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="5631.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="5631.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_15_gpu1 -->
<g id="edge58" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_15_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9152.33,-1184.36C8478.01,-1184 6073.61,-1176.33 5743.72,-1086.29 5723.08,-1080.65 5702.13,-1070.49 5684.02,-1060"/>
<polygon fill="black" stroke="black" points="5685.75,-1056.96 5675.37,-1054.85 5682.17,-1062.97 5685.75,-1056.96"/>
</g>
<!-- layer0_stage0_expert_16_gpu2 -->
<g id="node54" class="node">
<title>layer0_stage0_expert_16_gpu2</title>
<polygon fill="none" stroke="black" points="5958.72,-1054.79 5752.72,-1054.79 5752.72,-991.79 5958.72,-991.79 5958.72,-1054.79"/>
<text text-anchor="middle" x="5855.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_16_gpu2</text>
<text text-anchor="middle" x="5855.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 16</text>
<text text-anchor="middle" x="5855.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="5855.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="5855.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_16_gpu2 -->
<g id="edge59" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_16_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9152.06,-1184.01C8504.88,-1182.35 6275.13,-1170.49 5967.72,-1086.29 5947.09,-1080.63 5926.14,-1070.47 5908.02,-1059.98"/>
<polygon fill="black" stroke="black" points="5909.76,-1056.94 5899.37,-1054.83 5906.17,-1062.95 5909.76,-1056.94"/>
</g>
<!-- layer0_stage0_expert_17_gpu2 -->
<g id="node55" class="node">
<title>layer0_stage0_expert_17_gpu2</title>
<polygon fill="none" stroke="black" points="6182.72,-1054.79 5976.72,-1054.79 5976.72,-991.79 6182.72,-991.79 6182.72,-1054.79"/>
<text text-anchor="middle" x="6079.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_17_gpu2</text>
<text text-anchor="middle" x="6079.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 17</text>
<text text-anchor="middle" x="6079.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="6079.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="6079.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_17_gpu2 -->
<g id="edge60" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_17_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.65,-1183.61C8532.4,-1180.58 6476.68,-1164.67 6191.72,-1086.29 6171.09,-1080.61 6150.14,-1070.44 6132.03,-1059.96"/>
<polygon fill="black" stroke="black" points="6133.76,-1056.91 6123.38,-1054.8 6130.18,-1062.93 6133.76,-1056.91"/>
</g>
<!-- layer0_stage0_expert_18_gpu2 -->
<g id="node56" class="node">
<title>layer0_stage0_expert_18_gpu2</title>
<polygon fill="none" stroke="black" points="6406.72,-1054.79 6200.72,-1054.79 6200.72,-991.79 6406.72,-991.79 6406.72,-1054.79"/>
<text text-anchor="middle" x="6303.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_18_gpu2</text>
<text text-anchor="middle" x="6303.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 18</text>
<text text-anchor="middle" x="6303.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="6303.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="6303.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_18_gpu2 -->
<g id="edge61" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_18_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.34,-1183.15C8561.25,-1178.69 6678.32,-1158.85 6415.72,-1086.29 6395.19,-1080.61 6374.34,-1070.5 6356.28,-1060.07"/>
<polygon fill="black" stroke="black" points="6358.04,-1057.04 6347.66,-1054.94 6354.46,-1063.06 6358.04,-1057.04"/>
</g>
<!-- layer0_stage0_expert_19_gpu2 -->
<g id="node57" class="node">
<title>layer0_stage0_expert_19_gpu2</title>
<polygon fill="none" stroke="black" points="6630.72,-1054.79 6424.72,-1054.79 6424.72,-991.79 6630.72,-991.79 6630.72,-1054.79"/>
<text text-anchor="middle" x="6527.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_19_gpu2</text>
<text text-anchor="middle" x="6527.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 19</text>
<text text-anchor="middle" x="6527.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="6527.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="6527.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_19_gpu2 -->
<g id="edge62" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_19_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9150.9,-1182.61C8591.04,-1176.63 6880.01,-1153.05 6639.72,-1086.29 6619.2,-1080.59 6598.35,-1070.47 6580.29,-1060.03"/>
<polygon fill="black" stroke="black" points="6582.05,-1057.01 6571.66,-1054.91 6578.47,-1063.02 6582.05,-1057.01"/>
</g>
<!-- layer0_stage0_expert_20_gpu2 -->
<g id="node58" class="node">
<title>layer0_stage0_expert_20_gpu2</title>
<polygon fill="none" stroke="black" points="6854.72,-1054.79 6648.72,-1054.79 6648.72,-991.79 6854.72,-991.79 6854.72,-1054.79"/>
<text text-anchor="middle" x="6751.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_20_gpu2</text>
<text text-anchor="middle" x="6751.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 20</text>
<text text-anchor="middle" x="6751.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="6751.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="6751.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_20_gpu2 -->
<g id="edge63" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_20_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9150.47,-1181.96C8622.25,-1174.39 7081.79,-1147.26 6863.72,-1086.29 6843.21,-1080.55 6822.36,-1070.42 6804.3,-1059.99"/>
<polygon fill="black" stroke="black" points="6806.06,-1056.97 6795.67,-1054.87 6802.48,-1062.99 6806.06,-1056.97"/>
</g>
<!-- layer0_stage0_expert_21_gpu2 -->
<g id="node59" class="node">
<title>layer0_stage0_expert_21_gpu2</title>
<polygon fill="none" stroke="black" points="7078.72,-1054.79 6872.72,-1054.79 6872.72,-991.79 7078.72,-991.79 7078.72,-1054.79"/>
<text text-anchor="middle" x="6975.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_21_gpu2</text>
<text text-anchor="middle" x="6975.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 21</text>
<text text-anchor="middle" x="6975.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="6975.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="6975.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_21_gpu2 -->
<g id="edge64" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_21_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9150.06,-1181.19C8655.06,-1171.91 7283.66,-1141.5 7087.72,-1086.29 7067.22,-1080.51 7046.38,-1070.37 7028.32,-1059.95"/>
<polygon fill="black" stroke="black" points="7030.07,-1056.92 7019.69,-1054.82 7026.5,-1062.94 7030.07,-1056.92"/>
</g>
<!-- layer0_stage0_expert_22_gpu2 -->
<g id="node60" class="node">
<title>layer0_stage0_expert_22_gpu2</title>
<polygon fill="none" stroke="black" points="7302.72,-1054.79 7096.72,-1054.79 7096.72,-991.79 7302.72,-991.79 7302.72,-1054.79"/>
<text text-anchor="middle" x="7199.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_22_gpu2</text>
<text text-anchor="middle" x="7199.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 22</text>
<text text-anchor="middle" x="7199.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="7199.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="7199.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_22_gpu2 -->
<g id="edge65" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_22_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9149.43,-1180.24C8689.3,-1169.15 7485.61,-1135.74 7311.72,-1086.29 7291.33,-1080.49 7270.58,-1070.4 7252.58,-1060.03"/>
<polygon fill="black" stroke="black" points="7254.36,-1057.02 7243.97,-1054.93 7250.79,-1063.04 7254.36,-1057.02"/>
</g>
<!-- layer0_stage0_expert_23_gpu2 -->
<g id="node61" class="node">
<title>layer0_stage0_expert_23_gpu2</title>
<polygon fill="none" stroke="black" points="7526.72,-1054.79 7320.72,-1054.79 7320.72,-991.79 7526.72,-991.79 7526.72,-1054.79"/>
<text text-anchor="middle" x="7423.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_23_gpu2</text>
<text text-anchor="middle" x="7423.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 23</text>
<text text-anchor="middle" x="7423.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="7423.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="7423.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_23_gpu2 -->
<g id="edge66" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_23_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9152.43,-1184.64C8762.78,-1183.81 7835.52,-1172.53 7535.72,-1086.29 7515.34,-1080.43 7494.6,-1070.32 7476.6,-1059.96"/>
<polygon fill="black" stroke="black" points="7478.38,-1056.94 7467.99,-1054.86 7474.81,-1062.97 7478.38,-1056.94"/>
</g>
<!-- layer0_stage0_expert_24_gpu3 -->
<g id="node62" class="node">
<title>layer0_stage0_expert_24_gpu3</title>
<polygon fill="none" stroke="black" points="7750.72,-1054.79 7544.72,-1054.79 7544.72,-991.79 7750.72,-991.79 7750.72,-1054.79"/>
<text text-anchor="middle" x="7647.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_24_gpu3</text>
<text text-anchor="middle" x="7647.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 24</text>
<text text-anchor="middle" x="7647.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="7647.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="7647.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_24_gpu3 -->
<g id="edge67" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_24_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9151.3,-1182.99C8798.13,-1178.82 8016.15,-1161.13 7759.72,-1086.29 7739.64,-1080.43 7719.19,-1070.5 7701.36,-1060.28"/>
<polygon fill="black" stroke="black" points="7702.68,-1057 7692.28,-1054.94 7699.12,-1063.03 7702.68,-1057"/>
</g>
<!-- layer0_stage0_expert_25_gpu3 -->
<g id="node63" class="node">
<title>layer0_stage0_expert_25_gpu3</title>
<polygon fill="none" stroke="black" points="7974.72,-1054.79 7768.72,-1054.79 7768.72,-991.79 7974.72,-991.79 7974.72,-1054.79"/>
<text text-anchor="middle" x="7871.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_25_gpu3</text>
<text text-anchor="middle" x="7871.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 25</text>
<text text-anchor="middle" x="7871.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="7871.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="7871.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_25_gpu3 -->
<g id="edge68" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_25_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9149.81,-1180.78C8835.99,-1173.03 8197.09,-1149.77 7983.72,-1086.29 7963.67,-1080.32 7943.23,-1070.37 7925.39,-1060.16"/>
<polygon fill="black" stroke="black" points="7926.71,-1056.87 7916.32,-1054.82 7923.16,-1062.91 7926.71,-1056.87"/>
</g>
<!-- layer0_stage0_expert_26_gpu3 -->
<g id="node64" class="node">
<title>layer0_stage0_expert_26_gpu3</title>
<polygon fill="none" stroke="black" points="8198.72,-1054.79 7992.72,-1054.79 7992.72,-991.79 8198.72,-991.79 8198.72,-1054.79"/>
<text text-anchor="middle" x="8095.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_26_gpu3</text>
<text text-anchor="middle" x="8095.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 26</text>
<text text-anchor="middle" x="8095.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="8095.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="8095.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_26_gpu3 -->
<g id="edge69" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_26_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9147.55,-1177.63C8876.77,-1166.08 8378.41,-1138.42 8207.72,-1086.29 8187.81,-1080.21 8167.47,-1070.27 8149.69,-1060.12"/>
<polygon fill="black" stroke="black" points="8151.03,-1056.85 8140.64,-1054.81 8147.49,-1062.89 8151.03,-1056.85"/>
</g>
<!-- layer0_stage0_expert_27_gpu3 -->
<g id="node65" class="node">
<title>layer0_stage0_expert_27_gpu3</title>
<polygon fill="none" stroke="black" points="8422.72,-1054.79 8216.72,-1054.79 8216.72,-991.79 8422.72,-991.79 8422.72,-1054.79"/>
<text text-anchor="middle" x="8319.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_27_gpu3</text>
<text text-anchor="middle" x="8319.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 27</text>
<text text-anchor="middle" x="8319.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="8319.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="8319.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_27_gpu3 -->
<g id="edge70" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_27_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9144.02,-1172.77C8921.41,-1157.32 8560.18,-1127.05 8431.72,-1086.29 8412.05,-1080.05 8391.93,-1070.18 8374.26,-1060.14"/>
<polygon fill="black" stroke="black" points="8375.66,-1056.9 8365.25,-1054.89 8372.13,-1062.95 8375.66,-1056.9"/>
</g>
<!-- layer0_stage0_expert_28_gpu3 -->
<g id="node66" class="node">
<title>layer0_stage0_expert_28_gpu3</title>
<polygon fill="none" stroke="black" points="8646.72,-1054.79 8440.72,-1054.79 8440.72,-991.79 8646.72,-991.79 8646.72,-1054.79"/>
<text text-anchor="middle" x="8543.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_28_gpu3</text>
<text text-anchor="middle" x="8543.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 28</text>
<text text-anchor="middle" x="8543.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="8543.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="8543.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_28_gpu3 -->
<g id="edge71" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_28_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9146.05,-1175.52C9008.44,-1164.67 8816.32,-1140.44 8655.72,-1086.29 8636.35,-1079.76 8616.44,-1069.92 8598.88,-1059.99"/>
<polygon fill="black" stroke="black" points="8600.34,-1056.78 8589.93,-1054.8 8596.83,-1062.84 8600.34,-1056.78"/>
</g>
<!-- layer0_stage0_expert_29_gpu3 -->
<g id="node67" class="node">
<title>layer0_stage0_expert_29_gpu3</title>
<polygon fill="none" stroke="black" points="8870.72,-1054.79 8664.72,-1054.79 8664.72,-991.79 8870.72,-991.79 8870.72,-1054.79"/>
<text text-anchor="middle" x="8767.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_29_gpu3</text>
<text text-anchor="middle" x="8767.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 29</text>
<text text-anchor="middle" x="8767.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="8767.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="8767.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_29_gpu3 -->
<g id="edge72" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_29_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9130.66,-1153.98C9051.2,-1138.49 8959.62,-1116.4 8879.72,-1086.29 8861.03,-1079.24 8841.67,-1069.51 8824.41,-1059.84"/>
<polygon fill="black" stroke="black" points="8826,-1056.72 8815.58,-1054.8 8822.53,-1062.8 8826,-1056.72"/>
</g>
<!-- layer0_stage0_expert_30_gpu3 -->
<g id="node68" class="node">
<title>layer0_stage0_expert_30_gpu3</title>
<polygon fill="none" stroke="black" points="9094.72,-1054.79 8888.72,-1054.79 8888.72,-991.79 9094.72,-991.79 9094.72,-1054.79"/>
<text text-anchor="middle" x="8991.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_30_gpu3</text>
<text text-anchor="middle" x="8991.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 30</text>
<text text-anchor="middle" x="8991.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="8991.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="8991.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_30_gpu3 -->
<g id="edge73" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_30_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9180.42,-1122.18C9154.66,-1110.66 9128.26,-1098.42 9103.72,-1086.29 9087.16,-1078.1 9069.55,-1068.7 9053.31,-1059.73"/>
<polygon fill="black" stroke="black" points="9054.89,-1056.6 9044.45,-1054.8 9051.49,-1062.72 9054.89,-1056.6"/>
</g>
<!-- layer0_stage0_expert_31_gpu3 -->
<g id="node69" class="node">
<title>layer0_stage0_expert_31_gpu3</title>
<polygon fill="none" stroke="black" points="9318.72,-1054.79 9112.72,-1054.79 9112.72,-991.79 9318.72,-991.79 9318.72,-1054.79"/>
<text text-anchor="middle" x="9215.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_31_gpu3</text>
<text text-anchor="middle" x="9215.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 31</text>
<text text-anchor="middle" x="9215.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="9215.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="9215.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_31_gpu3 -->
<g id="edge74" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_31_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9284.09,-1121.97C9270.27,-1102.21 9255.38,-1080.94 9243.03,-1063.31"/>
<polygon fill="black" stroke="black" points="9245.8,-1061.15 9237.19,-1054.97 9240.06,-1065.17 9245.8,-1061.15"/>
</g>
<!-- layer0_stage0_expert_32_gpu4 -->
<g id="node70" class="node">
<title>layer0_stage0_expert_32_gpu4</title>
<polygon fill="none" stroke="black" points="9542.72,-1054.79 9336.72,-1054.79 9336.72,-991.79 9542.72,-991.79 9542.72,-1054.79"/>
<text text-anchor="middle" x="9439.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_32_gpu4</text>
<text text-anchor="middle" x="9439.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 32</text>
<text text-anchor="middle" x="9439.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="9439.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="9439.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_32_gpu4 -->
<g id="edge75" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_32_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9371.34,-1121.97C9385.17,-1102.21 9400.06,-1080.94 9412.4,-1063.31"/>
<polygon fill="black" stroke="black" points="9415.37,-1065.17 9418.24,-1054.97 9409.64,-1061.15 9415.37,-1065.17"/>
</g>
<!-- layer0_stage0_expert_33_gpu4 -->
<g id="node71" class="node">
<title>layer0_stage0_expert_33_gpu4</title>
<polygon fill="none" stroke="black" points="9766.72,-1054.79 9560.72,-1054.79 9560.72,-991.79 9766.72,-991.79 9766.72,-1054.79"/>
<text text-anchor="middle" x="9663.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_33_gpu4</text>
<text text-anchor="middle" x="9663.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 33</text>
<text text-anchor="middle" x="9663.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="9663.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="9663.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_33_gpu4 -->
<g id="edge76" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_33_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9461.91,-1128.01C9491.72,-1114.83 9522.99,-1100.49 9551.72,-1086.29 9568.28,-1078.1 9585.89,-1068.7 9602.12,-1059.73"/>
<polygon fill="black" stroke="black" points="9603.95,-1062.72 9610.99,-1054.8 9600.55,-1056.6 9603.95,-1062.72"/>
</g>
<!-- layer0_stage0_expert_34_gpu4 -->
<g id="node72" class="node">
<title>layer0_stage0_expert_34_gpu4</title>
<polygon fill="none" stroke="black" points="9990.72,-1054.79 9784.72,-1054.79 9784.72,-991.79 9990.72,-991.79 9990.72,-1054.79"/>
<text text-anchor="middle" x="9887.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_34_gpu4</text>
<text text-anchor="middle" x="9887.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 34</text>
<text text-anchor="middle" x="9887.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="9887.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="9887.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_34_gpu4 -->
<g id="edge77" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_34_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9485.39,-1161.33C9572.73,-1145.77 9682.22,-1121.53 9775.72,-1086.29 9794.4,-1079.24 9813.77,-1069.51 9831.03,-1059.84"/>
<polygon fill="black" stroke="black" points="9832.9,-1062.8 9839.85,-1054.8 9829.43,-1056.72 9832.9,-1062.8"/>
</g>
<!-- layer0_stage0_expert_35_gpu4 -->
<g id="node73" class="node">
<title>layer0_stage0_expert_35_gpu4</title>
<polygon fill="none" stroke="black" points="10214.72,-1054.79 10008.72,-1054.79 10008.72,-991.79 10214.72,-991.79 10214.72,-1054.79"/>
<text text-anchor="middle" x="10111.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_35_gpu4</text>
<text text-anchor="middle" x="10111.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 35</text>
<text text-anchor="middle" x="10111.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="10111.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="10111.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_35_gpu4 -->
<g id="edge78" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_35_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9496.27,-1176.52C9634.6,-1166.2 9833.95,-1142.18 9999.72,-1086.29 10019.09,-1079.76 10038.99,-1069.92 10056.55,-1059.99"/>
<polygon fill="black" stroke="black" points="10058.6,-1062.84 10065.51,-1054.8 10055.1,-1056.78 10058.6,-1062.84"/>
</g>
<!-- layer0_stage0_expert_36_gpu4 -->
<g id="node74" class="node">
<title>layer0_stage0_expert_36_gpu4</title>
<polygon fill="none" stroke="black" points="10438.72,-1054.79 10232.72,-1054.79 10232.72,-991.79 10438.72,-991.79 10438.72,-1054.79"/>
<text text-anchor="middle" x="10335.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_36_gpu4</text>
<text text-anchor="middle" x="10335.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 36</text>
<text text-anchor="middle" x="10335.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="10335.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="10335.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_36_gpu4 -->
<g id="edge79" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_36_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9494.73,-1173.92C9715.52,-1158.86 10092,-1128.08 10223.72,-1086.29 10243.38,-1080.05 10263.51,-1070.18 10281.18,-1060.14"/>
<polygon fill="black" stroke="black" points="10283.31,-1062.95 10290.18,-1054.89 10279.78,-1056.9 10283.31,-1062.95"/>
</g>
<!-- layer0_stage0_expert_37_gpu4 -->
<g id="node75" class="node">
<title>layer0_stage0_expert_37_gpu4</title>
<polygon fill="none" stroke="black" points="10662.72,-1054.79 10456.72,-1054.79 10456.72,-991.79 10662.72,-991.79 10662.72,-1054.79"/>
<text text-anchor="middle" x="10559.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_37_gpu4</text>
<text text-anchor="middle" x="10559.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 37</text>
<text text-anchor="middle" x="10559.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="10559.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="10559.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_37_gpu4 -->
<g id="edge80" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_37_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9497.45,-1178.07C9765.66,-1166.79 10274.81,-1139.1 10447.72,-1086.29 10467.63,-1080.21 10487.96,-1070.27 10505.75,-1060.12"/>
<polygon fill="black" stroke="black" points="10507.94,-1062.89 10514.8,-1054.81 10504.4,-1056.85 10507.94,-1062.89"/>
</g>
<!-- layer0_stage0_expert_38_gpu4 -->
<g id="node76" class="node">
<title>layer0_stage0_expert_38_gpu4</title>
<polygon fill="none" stroke="black" points="10886.72,-1054.79 10680.72,-1054.79 10680.72,-991.79 10886.72,-991.79 10886.72,-1054.79"/>
<text text-anchor="middle" x="10783.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_38_gpu4</text>
<text text-anchor="middle" x="10783.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 38</text>
<text text-anchor="middle" x="10783.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="10783.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="10783.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_38_gpu4 -->
<g id="edge81" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_38_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9499.48,-1180.93C9811.04,-1173.33 10456.94,-1150.19 10671.72,-1086.29 10691.76,-1080.32 10712.2,-1070.37 10730.04,-1060.16"/>
<polygon fill="black" stroke="black" points="10732.27,-1062.91 10739.12,-1054.82 10728.72,-1056.87 10732.27,-1062.91"/>
</g>
<!-- layer0_stage0_expert_39_gpu4 -->
<g id="node77" class="node">
<title>layer0_stage0_expert_39_gpu4</title>
<polygon fill="none" stroke="black" points="11110.72,-1054.79 10904.72,-1054.79 10904.72,-991.79 11110.72,-991.79 11110.72,-1054.79"/>
<text text-anchor="middle" x="11007.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_39_gpu4</text>
<text text-anchor="middle" x="11007.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 39</text>
<text text-anchor="middle" x="11007.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="11007.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="11007.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_39_gpu4 -->
<g id="edge82" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_39_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.1,-1183.03C9852.81,-1178.92 10638.55,-1161.35 10895.72,-1086.29 10915.79,-1080.43 10936.24,-1070.5 10954.08,-1060.28"/>
<polygon fill="black" stroke="black" points="10956.31,-1063.03 10963.15,-1054.94 10952.76,-1057 10956.31,-1063.03"/>
</g>
<!-- layer0_stage0_expert_40_gpu5 -->
<g id="node78" class="node">
<title>layer0_stage0_expert_40_gpu5</title>
<polygon fill="none" stroke="black" points="11334.72,-1054.79 11128.72,-1054.79 11128.72,-991.79 11334.72,-991.79 11334.72,-1054.79"/>
<text text-anchor="middle" x="11231.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_40_gpu5</text>
<text text-anchor="middle" x="11231.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 40</text>
<text text-anchor="middle" x="11231.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="11231.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="11231.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_40_gpu5 -->
<g id="edge83" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_40_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.91,-1184.64C9890.91,-1183.84 10819.63,-1172.61 11119.72,-1086.29 11140.09,-1080.43 11160.83,-1070.32 11178.84,-1059.96"/>
<polygon fill="black" stroke="black" points="11180.62,-1062.97 11187.45,-1054.86 11177.06,-1056.94 11180.62,-1062.97"/>
</g>
<!-- layer0_stage0_expert_41_gpu5 -->
<g id="node79" class="node">
<title>layer0_stage0_expert_41_gpu5</title>
<polygon fill="none" stroke="black" points="11558.72,-1054.79 11352.72,-1054.79 11352.72,-991.79 11558.72,-991.79 11558.72,-1054.79"/>
<text text-anchor="middle" x="11455.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_41_gpu5</text>
<text text-anchor="middle" x="11455.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 41</text>
<text text-anchor="middle" x="11455.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="11455.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="11455.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_41_gpu5 -->
<g id="edge84" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_41_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9498.96,-1180.41C9953.72,-1169.49 11168.93,-1136 11343.72,-1086.29 11364.11,-1080.49 11384.86,-1070.4 11402.86,-1060.03"/>
<polygon fill="black" stroke="black" points="11404.65,-1063.04 11411.46,-1054.93 11401.08,-1057.02 11404.65,-1063.04"/>
</g>
<!-- layer0_stage0_expert_42_gpu5 -->
<g id="node80" class="node">
<title>layer0_stage0_expert_42_gpu5</title>
<polygon fill="none" stroke="black" points="11782.72,-1054.79 11576.72,-1054.79 11576.72,-991.79 11782.72,-991.79 11782.72,-1054.79"/>
<text text-anchor="middle" x="11679.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_42_gpu5</text>
<text text-anchor="middle" x="11679.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 42</text>
<text text-anchor="middle" x="11679.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="11679.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="11679.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_42_gpu5 -->
<g id="edge85" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_42_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9499.65,-1181.3C9989.7,-1172.15 11371.02,-1141.71 11567.72,-1086.29 11588.22,-1080.51 11609.06,-1070.37 11627.12,-1059.95"/>
<polygon fill="black" stroke="black" points="11628.94,-1062.94 11635.75,-1054.82 11625.36,-1056.92 11628.94,-1062.94"/>
</g>
<!-- layer0_stage0_expert_43_gpu5 -->
<g id="node81" class="node">
<title>layer0_stage0_expert_43_gpu5</title>
<polygon fill="none" stroke="black" points="12006.72,-1054.79 11800.72,-1054.79 11800.72,-991.79 12006.72,-991.79 12006.72,-1054.79"/>
<text text-anchor="middle" x="11903.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_43_gpu5</text>
<text text-anchor="middle" x="11903.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 43</text>
<text text-anchor="middle" x="11903.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="11903.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="11903.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_43_gpu5 -->
<g id="edge86" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_43_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9500.31,-1182.03C10024.08,-1174.55 11573.01,-1147.45 11791.72,-1086.29 11812.23,-1080.55 11833.07,-1070.42 11851.13,-1059.99"/>
<polygon fill="black" stroke="black" points="11852.95,-1062.99 11859.76,-1054.87 11849.38,-1056.97 11852.95,-1062.99"/>
</g>
<!-- layer0_stage0_expert_44_gpu5 -->
<g id="node82" class="node">
<title>layer0_stage0_expert_44_gpu5</title>
<polygon fill="none" stroke="black" points="12230.72,-1054.79 12024.72,-1054.79 12024.72,-991.79 12230.72,-991.79 12230.72,-1054.79"/>
<text text-anchor="middle" x="12127.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_44_gpu5</text>
<text text-anchor="middle" x="12127.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 44</text>
<text text-anchor="middle" x="12127.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="12127.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="12127.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_44_gpu5 -->
<g id="edge87" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_44_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9500.62,-1182.65C10056.38,-1176.74 11774.86,-1153.21 12015.72,-1086.29 12036.24,-1080.59 12057.09,-1070.47 12075.14,-1060.03"/>
<polygon fill="black" stroke="black" points="12076.96,-1063.02 12083.77,-1054.91 12073.39,-1057.01 12076.96,-1063.02"/>
</g>
<!-- layer0_stage0_expert_45_gpu5 -->
<g id="node83" class="node">
<title>layer0_stage0_expert_45_gpu5</title>
<polygon fill="none" stroke="black" points="12454.72,-1054.79 12248.72,-1054.79 12248.72,-991.79 12454.72,-991.79 12454.72,-1054.79"/>
<text text-anchor="middle" x="12351.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_45_gpu5</text>
<text text-anchor="middle" x="12351.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 45</text>
<text text-anchor="middle" x="12351.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="12351.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="12351.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_45_gpu5 -->
<g id="edge88" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_45_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.02,-1183.17C10087.63,-1178.76 11976.66,-1158.98 12239.72,-1086.29 12260.24,-1080.61 12281.1,-1070.5 12299.15,-1060.07"/>
<polygon fill="black" stroke="black" points="12300.97,-1063.06 12307.78,-1054.94 12297.4,-1057.04 12300.97,-1063.06"/>
</g>
<!-- layer0_stage0_expert_46_gpu5 -->
<g id="node84" class="node">
<title>layer0_stage0_expert_46_gpu5</title>
<polygon fill="none" stroke="black" points="12678.72,-1054.79 12472.72,-1054.79 12472.72,-991.79 12678.72,-991.79 12678.72,-1054.79"/>
<text text-anchor="middle" x="12575.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_46_gpu5</text>
<text text-anchor="middle" x="12575.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 46</text>
<text text-anchor="middle" x="12575.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="12575.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="12575.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_46_gpu5 -->
<g id="edge89" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_46_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.38,-1183.63C10117.7,-1180.62 12178.38,-1164.77 12463.72,-1086.29 12484.34,-1080.61 12505.29,-1070.44 12523.4,-1059.96"/>
<polygon fill="black" stroke="black" points="12525.26,-1062.93 12532.05,-1054.8 12521.67,-1056.91 12525.26,-1062.93"/>
</g>
<!-- layer0_stage0_expert_47_gpu5 -->
<g id="node85" class="node">
<title>layer0_stage0_expert_47_gpu5</title>
<polygon fill="none" stroke="black" points="12902.72,-1054.79 12696.72,-1054.79 12696.72,-991.79 12902.72,-991.79 12902.72,-1054.79"/>
<text text-anchor="middle" x="12799.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_47_gpu5</text>
<text text-anchor="middle" x="12799.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 47</text>
<text text-anchor="middle" x="12799.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="12799.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="12799.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_47_gpu5 -->
<g id="edge90" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_47_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.71,-1184.02C10146.73,-1182.37 12380.04,-1170.57 12687.72,-1086.29 12708.35,-1080.63 12729.3,-1070.47 12747.41,-1059.98"/>
<polygon fill="black" stroke="black" points="12749.26,-1062.95 12756.06,-1054.83 12745.68,-1056.94 12749.26,-1062.95"/>
</g>
<!-- layer0_stage0_expert_48_gpu6 -->
<g id="node86" class="node">
<title>layer0_stage0_expert_48_gpu6</title>
<polygon fill="none" stroke="black" points="13126.72,-1054.79 12920.72,-1054.79 12920.72,-991.79 13126.72,-991.79 13126.72,-1054.79"/>
<text text-anchor="middle" x="13023.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_48_gpu6</text>
<text text-anchor="middle" x="13023.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 48</text>
<text text-anchor="middle" x="13023.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13023.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="13023.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_48_gpu6 -->
<g id="edge91" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_48_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.96,-1184.36C10174.69,-1184.01 12581.64,-1176.38 12911.72,-1086.29 12932.35,-1080.65 12953.31,-1070.49 12971.42,-1060"/>
<polygon fill="black" stroke="black" points="12973.27,-1062.97 12980.07,-1054.85 12969.68,-1056.96 12973.27,-1062.97"/>
</g>
<!-- layer0_stage0_expert_49_gpu6 -->
<g id="node87" class="node">
<title>layer0_stage0_expert_49_gpu6</title>
<polygon fill="none" stroke="black" points="13350.72,-1054.79 13144.72,-1054.79 13144.72,-991.79 13350.72,-991.79 13350.72,-1054.79"/>
<text text-anchor="middle" x="13247.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_49_gpu6</text>
<text text-anchor="middle" x="13247.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 49</text>
<text text-anchor="middle" x="13247.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13247.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="13247.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_49_gpu6 -->
<g id="edge92" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_49_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9502.02,-1184.67C10201.38,-1185.55 12783.15,-1182.22 13135.72,-1086.29 13156.36,-1080.67 13177.31,-1070.51 13195.42,-1060.02"/>
<polygon fill="black" stroke="black" points="13197.28,-1062.99 13204.07,-1054.87 13193.69,-1056.98 13197.28,-1062.99"/>
</g>
<!-- layer0_stage0_expert_50_gpu6 -->
<g id="node88" class="node">
<title>layer0_stage0_expert_50_gpu6</title>
<polygon fill="none" stroke="black" points="13574.72,-1054.79 13368.72,-1054.79 13368.72,-991.79 13574.72,-991.79 13574.72,-1054.79"/>
<text text-anchor="middle" x="13471.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_50_gpu6</text>
<text text-anchor="middle" x="13471.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 50</text>
<text text-anchor="middle" x="13471.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13471.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="13471.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_50_gpu6 -->
<g id="edge93" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_50_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9500.48,-1182.39C10247.56,-1173.88 13171.21,-1137.43 13359.72,-1086.29 13380.36,-1080.68 13401.32,-1070.53 13419.43,-1060.04"/>
<polygon fill="black" stroke="black" points="13421.28,-1063.01 13428.08,-1054.88 13417.69,-1057 13421.28,-1063.01"/>
</g>
<!-- layer0_stage0_expert_51_gpu6 -->
<g id="node89" class="node">
<title>layer0_stage0_expert_51_gpu6</title>
<polygon fill="none" stroke="black" points="13798.72,-1054.79 13592.72,-1054.79 13592.72,-991.79 13798.72,-991.79 13798.72,-1054.79"/>
<text text-anchor="middle" x="13695.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_51_gpu6</text>
<text text-anchor="middle" x="13695.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 51</text>
<text text-anchor="middle" x="13695.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13695.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="13695.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_51_gpu6 -->
<g id="edge94" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_51_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9500.58,-1182.62C10273.54,-1174.85 13383.9,-1140.36 13583.72,-1086.29 13604.37,-1080.7 13625.32,-1070.55 13643.43,-1060.06"/>
<polygon fill="black" stroke="black" points="13645.29,-1063.03 13652.08,-1054.9 13641.7,-1057.01 13645.29,-1063.03"/>
</g>
<!-- layer0_stage0_expert_52_gpu6 -->
<g id="node90" class="node">
<title>layer0_stage0_expert_52_gpu6</title>
<polygon fill="none" stroke="black" points="14022.72,-1054.79 13816.72,-1054.79 13816.72,-991.79 14022.72,-991.79 14022.72,-1054.79"/>
<text text-anchor="middle" x="13919.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_52_gpu6</text>
<text text-anchor="middle" x="13919.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 52</text>
<text text-anchor="middle" x="13919.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13919.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="13919.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_52_gpu6 -->
<g id="edge95" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_52_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9500.92,-1182.82C10299.53,-1175.77 13596.6,-1143.29 13807.72,-1086.29 13828.37,-1080.71 13849.32,-1070.56 13867.44,-1060.07"/>
<polygon fill="black" stroke="black" points="13869.29,-1063.04 13876.08,-1054.91 13865.7,-1057.03 13869.29,-1063.04"/>
</g>
<!-- layer0_stage0_expert_53_gpu6 -->
<g id="node91" class="node">
<title>layer0_stage0_expert_53_gpu6</title>
<polygon fill="none" stroke="black" points="14246.72,-1054.79 14040.72,-1054.79 14040.72,-991.79 14246.72,-991.79 14246.72,-1054.79"/>
<text text-anchor="middle" x="14143.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_53_gpu6</text>
<text text-anchor="middle" x="14143.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 53</text>
<text text-anchor="middle" x="14143.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="14143.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="14143.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_53_gpu6 -->
<g id="edge96" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_53_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9500.94,-1183.01C10324.02,-1176.64 13809.25,-1146.23 14031.72,-1086.29 14052.37,-1080.72 14073.33,-1070.58 14091.44,-1060.08"/>
<polygon fill="black" stroke="black" points="14093.29,-1063.05 14100.09,-1054.92 14089.71,-1057.04 14093.29,-1063.05"/>
</g>
<!-- layer0_stage0_expert_54_gpu6 -->
<g id="node92" class="node">
<title>layer0_stage0_expert_54_gpu6</title>
<polygon fill="none" stroke="black" points="14470.72,-1054.79 14264.72,-1054.79 14264.72,-991.79 14470.72,-991.79 14470.72,-1054.79"/>
<text text-anchor="middle" x="14367.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_54_gpu6</text>
<text text-anchor="middle" x="14367.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 54</text>
<text text-anchor="middle" x="14367.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="14367.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="14367.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_54_gpu6 -->
<g id="edge97" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_54_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.03,-1183.18C10348.17,-1177.47 14021.88,-1149.18 14255.72,-1086.29 14276.38,-1080.73 14297.33,-1070.59 14315.44,-1060.09"/>
<polygon fill="black" stroke="black" points="14317.3,-1063.06 14324.09,-1054.93 14313.71,-1057.05 14317.3,-1063.06"/>
</g>
<!-- layer0_stage0_expert_55_gpu6 -->
<g id="node93" class="node">
<title>layer0_stage0_expert_55_gpu6</title>
<polygon fill="none" stroke="black" points="14694.72,-1054.79 14488.72,-1054.79 14488.72,-991.79 14694.72,-991.79 14694.72,-1054.79"/>
<text text-anchor="middle" x="14591.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_55_gpu6</text>
<text text-anchor="middle" x="14591.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 55</text>
<text text-anchor="middle" x="14591.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="14591.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="14591.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_55_gpu6 -->
<g id="edge98" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_55_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.28,-1183.33C10372.25,-1178.26 14234.52,-1152.12 14479.72,-1086.29 14500.38,-1080.74 14521.33,-1070.6 14539.44,-1060.1"/>
<polygon fill="black" stroke="black" points="14541.3,-1063.07 14548.09,-1054.94 14537.71,-1057.06 14541.3,-1063.07"/>
</g>
<!-- layer0_stage0_expert_56_gpu7 -->
<g id="node94" class="node">
<title>layer0_stage0_expert_56_gpu7</title>
<polygon fill="none" stroke="black" points="14918.72,-1054.79 14712.72,-1054.79 14712.72,-991.79 14918.72,-991.79 14918.72,-1054.79"/>
<text text-anchor="middle" x="14815.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_56_gpu7</text>
<text text-anchor="middle" x="14815.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 56</text>
<text text-anchor="middle" x="14815.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="14815.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="14815.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_56_gpu7 -->
<g id="edge99" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_56_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.39,-1183.48C10395.44,-1179.02 14447.13,-1155.07 14703.72,-1086.29 14724.47,-1080.72 14745.52,-1070.52 14763.69,-1059.97"/>
<polygon fill="black" stroke="black" points="14765.57,-1062.92 14772.36,-1054.79 14761.98,-1056.92 14765.57,-1062.92"/>
</g>
<!-- layer0_stage0_expert_57_gpu7 -->
<g id="node95" class="node">
<title>layer0_stage0_expert_57_gpu7</title>
<polygon fill="none" stroke="black" points="15142.72,-1054.79 14936.72,-1054.79 14936.72,-991.79 15142.72,-991.79 15142.72,-1054.79"/>
<text text-anchor="middle" x="15039.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_57_gpu7</text>
<text text-anchor="middle" x="15039.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 57</text>
<text text-anchor="middle" x="15039.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="15039.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="15039.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_57_gpu7 -->
<g id="edge100" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_57_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.41,-1183.61C10417.88,-1179.74 14659.72,-1158.02 14927.72,-1086.29 14948.47,-1080.73 14969.53,-1070.53 14987.69,-1059.98"/>
<polygon fill="black" stroke="black" points="14989.58,-1062.93 14996.36,-1054.8 14985.98,-1056.92 14989.58,-1062.93"/>
</g>
<!-- layer0_stage0_expert_58_gpu7 -->
<g id="node96" class="node">
<title>layer0_stage0_expert_58_gpu7</title>
<polygon fill="none" stroke="black" points="15366.72,-1054.79 15160.72,-1054.79 15160.72,-991.79 15366.72,-991.79 15366.72,-1054.79"/>
<text text-anchor="middle" x="15263.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_58_gpu7</text>
<text text-anchor="middle" x="15263.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 58</text>
<text text-anchor="middle" x="15263.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="15263.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="15263.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_58_gpu7 -->
<g id="edge101" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_58_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.37,-1183.73C10439.71,-1180.44 14872.29,-1160.98 15151.72,-1086.29 15172.48,-1080.74 15193.53,-1070.54 15211.69,-1059.99"/>
<polygon fill="black" stroke="black" points="15213.58,-1062.94 15220.37,-1054.8 15209.99,-1056.93 15213.58,-1062.94"/>
</g>
<!-- layer0_stage0_expert_59_gpu7 -->
<g id="node97" class="node">
<title>layer0_stage0_expert_59_gpu7</title>
<polygon fill="none" stroke="black" points="15590.72,-1054.79 15384.72,-1054.79 15384.72,-991.79 15590.72,-991.79 15590.72,-1054.79"/>
<text text-anchor="middle" x="15487.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_59_gpu7</text>
<text text-anchor="middle" x="15487.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 59</text>
<text text-anchor="middle" x="15487.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="15487.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="15487.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_59_gpu7 -->
<g id="edge102" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_59_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.71,-1183.84C10462.34,-1181.11 15084.89,-1163.93 15375.72,-1086.29 15396.48,-1080.74 15417.53,-1070.55 15435.7,-1060"/>
<polygon fill="black" stroke="black" points="15437.58,-1062.95 15444.37,-1054.81 15433.99,-1056.94 15437.58,-1062.95"/>
</g>
<!-- layer0_stage0_expert_60_gpu7 -->
<g id="node98" class="node">
<title>layer0_stage0_expert_60_gpu7</title>
<polygon fill="none" stroke="black" points="15814.72,-1054.79 15608.72,-1054.79 15608.72,-991.79 15814.72,-991.79 15814.72,-1054.79"/>
<text text-anchor="middle" x="15711.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_60_gpu7</text>
<text text-anchor="middle" x="15711.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 60</text>
<text text-anchor="middle" x="15711.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="15711.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="15711.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_60_gpu7 -->
<g id="edge103" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_60_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.7,-1183.95C10483.43,-1181.75 15297.44,-1166.89 15599.72,-1086.29 15620.48,-1080.75 15641.53,-1070.55 15659.7,-1060"/>
<polygon fill="black" stroke="black" points="15661.58,-1062.95 15668.37,-1054.82 15657.99,-1056.95 15661.58,-1062.95"/>
</g>
<!-- layer0_stage0_expert_61_gpu7 -->
<g id="node99" class="node">
<title>layer0_stage0_expert_61_gpu7</title>
<polygon fill="none" stroke="black" points="16038.72,-1054.79 15832.72,-1054.79 15832.72,-991.79 16038.72,-991.79 16038.72,-1054.79"/>
<text text-anchor="middle" x="15935.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_61_gpu7</text>
<text text-anchor="middle" x="15935.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 61</text>
<text text-anchor="middle" x="15935.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="15935.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="15935.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_61_gpu7 -->
<g id="edge104" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_61_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.74,-1184.05C10504.34,-1182.38 15509.99,-1169.86 15823.72,-1086.29 15844.48,-1080.76 15865.54,-1070.56 15883.7,-1060.01"/>
<polygon fill="black" stroke="black" points="15885.59,-1062.96 15892.37,-1054.82 15881.99,-1056.95 15885.59,-1062.96"/>
</g>
<!-- layer0_stage0_expert_62_gpu7 -->
<g id="node100" class="node">
<title>layer0_stage0_expert_62_gpu7</title>
<polygon fill="none" stroke="black" points="16262.72,-1054.79 16056.72,-1054.79 16056.72,-991.79 16262.72,-991.79 16262.72,-1054.79"/>
<text text-anchor="middle" x="16159.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_62_gpu7</text>
<text text-anchor="middle" x="16159.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 62</text>
<text text-anchor="middle" x="16159.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="16159.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="16159.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_62_gpu7 -->
<g id="edge105" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_62_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.87,-1184.14C10525.22,-1182.98 15722.53,-1172.82 16047.72,-1086.29 16068.48,-1080.76 16089.54,-1070.57 16107.7,-1060.02"/>
<polygon fill="black" stroke="black" points="16109.59,-1062.97 16116.37,-1054.83 16105.99,-1056.96 16109.59,-1062.97"/>
</g>
<!-- layer0_stage0_expert_63_gpu7 -->
<g id="node101" class="node">
<title>layer0_stage0_expert_63_gpu7</title>
<polygon fill="none" stroke="black" points="16486.72,-1054.79 16280.72,-1054.79 16280.72,-991.79 16486.72,-991.79 16486.72,-1054.79"/>
<text text-anchor="middle" x="16383.72" y="-1042.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_63_gpu7</text>
<text text-anchor="middle" x="16383.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="16383.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="16383.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="16383.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_gating&#45;&gt;layer0_stage0_expert_63_gpu7 -->
<g id="edge106" class="edge">
<title>layer0_stage0_gating&#45;&gt;layer0_stage0_expert_63_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9501.71,-1184.23C10544.75,-1183.56 15935.04,-1175.79 16271.72,-1086.29 16292.48,-1080.77 16313.54,-1070.57 16331.7,-1060.02"/>
<polygon fill="black" stroke="black" points="16333.59,-1062.97 16340.37,-1054.83 16330,-1056.97 16333.59,-1062.97"/>
</g>
<!-- layer0_stage0_expert_aggregate -->
<g id="node102" class="node">
<title>layer0_stage0_expert_aggregate</title>
<polygon fill="none" stroke="black" points="9569.34,-924.29 9184.97,-924.29 9086.09,-798.29 9470.47,-798.29 9569.34,-924.29"/>
<text text-anchor="middle" x="9327.72" y="-880.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_aggregate</text>
<text text-anchor="middle" x="9327.72" y="-869.79" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="9327.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="9327.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x16)</text>
<text text-anchor="middle" x="9327.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_expert_0_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge107" class="edge">
<title>layer0_stage0_expert_0_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M2315.06,-991.74C2335,-979.46 2359.55,-966.71 2383.72,-960.29 2467.4,-938.04 7997.56,-876.75 9127.44,-864.45"/>
<polygon fill="black" stroke="black" points="9127.74,-867.95 9137.7,-864.34 9127.66,-860.95 9127.74,-867.95"/>
</g>
<!-- layer0_stage0_expert_1_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge108" class="edge">
<title>layer0_stage0_expert_1_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M2539.06,-991.74C2559,-979.47 2583.56,-966.72 2607.72,-960.29 2769.2,-917.31 8025.68,-872.75 9126.72,-863.88"/>
<polygon fill="black" stroke="black" points="9127.14,-867.37 9137.11,-863.79 9127.08,-860.37 9127.14,-867.37"/>
</g>
<!-- layer0_stage0_expert_2_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge109" class="edge">
<title>layer0_stage0_expert_2_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M2763.07,-991.75C2783,-979.47 2807.56,-966.72 2831.72,-960.29 2987.51,-918.79 8049.76,-873.22 9127.3,-863.98"/>
<polygon fill="black" stroke="black" points="9127.5,-867.47 9137.47,-863.89 9127.44,-860.47 9127.5,-867.47"/>
</g>
<!-- layer0_stage0_expert_3_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge110" class="edge">
<title>layer0_stage0_expert_3_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M2987.07,-991.76C3007,-979.48 3031.56,-966.73 3055.72,-960.29 3355.28,-880.4 8085.83,-865.09 9126.34,-862.68"/>
<polygon fill="black" stroke="black" points="9126.55,-866.18 9136.55,-862.66 9126.54,-859.18 9126.55,-866.18"/>
</g>
<!-- layer0_stage0_expert_4_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge111" class="edge">
<title>layer0_stage0_expert_4_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M3211.07,-991.76C3231.01,-979.49 3255.56,-966.74 3279.72,-960.29 3567.85,-883.36 8107.88,-865.79 9126.11,-862.81"/>
<polygon fill="black" stroke="black" points="9126.47,-866.31 9136.46,-862.78 9126.45,-859.31 9126.47,-866.31"/>
</g>
<!-- layer0_stage0_expert_5_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge112" class="edge">
<title>layer0_stage0_expert_5_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M3435.07,-991.77C3455.01,-979.5 3479.56,-966.74 3503.72,-960.29 3780.51,-886.3 8132.7,-866.5 9126.66,-862.94"/>
<polygon fill="black" stroke="black" points="9126.78,-866.44 9136.77,-862.9 9126.76,-859.44 9126.78,-866.44"/>
</g>
<!-- layer0_stage0_expert_6_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge113" class="edge">
<title>layer0_stage0_expert_6_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M3659.07,-991.78C3679.01,-979.51 3703.57,-966.75 3727.72,-960.29 3993.12,-889.25 8155.81,-867.25 9126.49,-863.08"/>
<polygon fill="black" stroke="black" points="9126.73,-866.58 9136.71,-863.04 9126.7,-859.58 9126.73,-866.58"/>
</g>
<!-- layer0_stage0_expert_7_gpu0&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge114" class="edge">
<title>layer0_stage0_expert_7_gpu0&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M3883.07,-991.79C3903.01,-979.52 3927.57,-966.76 3951.72,-960.29 4205.75,-892.19 8179.72,-868.04 9126.42,-863.23"/>
<polygon fill="black" stroke="black" points="9126.75,-866.73 9136.73,-863.18 9126.71,-859.73 9126.75,-866.73"/>
</g>
<!-- layer0_stage0_expert_8_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge115" class="edge">
<title>layer0_stage0_expert_8_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M4107.34,-991.63C4127.23,-979.41 4151.68,-966.74 4175.72,-960.29 4418.44,-895.12 8205.48,-868.84 9126.83,-863.4"/>
<polygon fill="black" stroke="black" points="9126.9,-866.9 9136.88,-863.34 9126.86,-859.9 9126.9,-866.9"/>
</g>
<!-- layer0_stage0_expert_9_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge116" class="edge">
<title>layer0_stage0_expert_9_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M4331.35,-991.64C4351.24,-979.43 4375.68,-966.75 4399.72,-960.29 4631.12,-898.05 8231.34,-869.69 9127.1,-863.58"/>
<polygon fill="black" stroke="black" points="9127.22,-867.08 9137.19,-863.51 9127.17,-860.08 9127.22,-867.08"/>
</g>
<!-- layer0_stage0_expert_10_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge117" class="edge">
<title>layer0_stage0_expert_10_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M4555.35,-991.65C4575.24,-979.44 4599.68,-966.76 4623.72,-960.29 4843.82,-900.98 8257.44,-870.58 9127.26,-863.78"/>
<polygon fill="black" stroke="black" points="9127.4,-867.27 9137.37,-863.7 9127.35,-860.28 9127.4,-867.27"/>
</g>
<!-- layer0_stage0_expert_11_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge118" class="edge">
<title>layer0_stage0_expert_11_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M4779.35,-991.66C4799.25,-979.45 4823.69,-966.78 4847.72,-960.29 5056.53,-903.9 8284.08,-871.52 9127.39,-863.99"/>
<polygon fill="black" stroke="black" points="9127.54,-867.49 9137.5,-863.9 9127.47,-860.49 9127.54,-867.49"/>
</g>
<!-- layer0_stage0_expert_12_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge119" class="edge">
<title>layer0_stage0_expert_12_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M5003.36,-991.68C5023.25,-979.47 5047.69,-966.79 5071.72,-960.29 5269.26,-906.83 8311.52,-872.51 9127.58,-864.23"/>
<polygon fill="black" stroke="black" points="9127.71,-867.73 9137.67,-864.13 9127.63,-860.73 9127.71,-867.73"/>
</g>
<!-- layer0_stage0_expert_13_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge120" class="edge">
<title>layer0_stage0_expert_13_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M5227.36,-991.69C5247.25,-979.49 5271.69,-966.8 5295.72,-960.29 5482,-909.75 8339.24,-873.56 9127.6,-864.5"/>
<polygon fill="black" stroke="black" points="9127.68,-868 9137.64,-864.38 9127.6,-861 9127.68,-868"/>
</g>
<!-- layer0_stage0_expert_14_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge121" class="edge">
<title>layer0_stage0_expert_14_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M5451.36,-991.71C5471.26,-979.51 5495.7,-966.82 5519.72,-960.29 5867.77,-865.59 8388.31,-861.12 9125.64,-861.87"/>
<polygon fill="black" stroke="black" points="9125.83,-865.37 9135.83,-861.88 9125.83,-858.37 9125.83,-865.37"/>
</g>
<!-- layer0_stage0_expert_15_gpu1&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge122" class="edge">
<title>layer0_stage0_expert_15_gpu1&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M5675.37,-991.73C5695.27,-979.53 5719.7,-966.84 5743.72,-960.29 6069.47,-871.37 8418.01,-862.78 9126.14,-862.23"/>
<polygon fill="black" stroke="black" points="9126.19,-865.73 9136.19,-862.22 9126.18,-858.73 9126.19,-865.73"/>
</g>
<!-- layer0_stage0_expert_16_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge123" class="edge">
<title>layer0_stage0_expert_16_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M5899.37,-991.75C5919.27,-979.55 5943.71,-966.86 5967.72,-960.29 6271.15,-877.17 8447.43,-864.54 9126.12,-862.63"/>
<polygon fill="black" stroke="black" points="9126.5,-866.13 9136.49,-862.6 9126.48,-859.13 9126.5,-866.13"/>
</g>
<!-- layer0_stage0_expert_17_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge124" class="edge">
<title>layer0_stage0_expert_17_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M6123.38,-991.77C6143.28,-979.58 6167.72,-966.89 6191.72,-960.29 6472.91,-882.95 8478.25,-866.42 9126.29,-863.09"/>
<polygon fill="black" stroke="black" points="9126.69,-866.58 9136.67,-863.03 9126.65,-859.58 9126.69,-866.58"/>
</g>
<!-- layer0_stage0_expert_18_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge125" class="edge">
<title>layer0_stage0_expert_18_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M6347.66,-991.63C6367.51,-979.5 6391.83,-966.89 6415.72,-960.29 6674.8,-888.69 8511.06,-868.43 9126.92,-863.61"/>
<polygon fill="black" stroke="black" points="9127.27,-867.11 9137.24,-863.53 9127.21,-860.11 9127.27,-867.11"/>
</g>
<!-- layer0_stage0_expert_19_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge126" class="edge">
<title>layer0_stage0_expert_19_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M6571.66,-991.67C6591.52,-979.54 6615.84,-966.92 6639.72,-960.29 6876.75,-894.43 8544.89,-870.59 9127.49,-864.22"/>
<polygon fill="black" stroke="black" points="9127.71,-867.72 9137.67,-864.11 9127.64,-860.72 9127.71,-867.72"/>
</g>
<!-- layer0_stage0_expert_20_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge127" class="edge">
<title>layer0_stage0_expert_20_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M6795.67,-991.7C6815.53,-979.58 6839.85,-966.96 6863.72,-960.29 7078.74,-900.16 8579.43,-872.95 9127.73,-864.94"/>
<polygon fill="black" stroke="black" points="9128.18,-868.43 9138.12,-864.79 9128.07,-861.43 9128.18,-868.43"/>
</g>
<!-- layer0_stage0_expert_21_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge128" class="edge">
<title>layer0_stage0_expert_21_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M7019.69,-991.75C7039.54,-979.64 7063.87,-967.01 7087.72,-960.29 7280.91,-905.85 8616.86,-875.52 9128.74,-865.78"/>
<polygon fill="black" stroke="black" points="9128.89,-869.28 9138.82,-865.59 9128.76,-862.28 9128.89,-869.28"/>
</g>
<!-- layer0_stage0_expert_22_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge129" class="edge">
<title>layer0_stage0_expert_22_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M7243.97,-991.64C7263.78,-979.59 7287.99,-967.03 7311.72,-960.29 7483.13,-911.54 8655.09,-878.38 9129.24,-866.82"/>
<polygon fill="black" stroke="black" points="9129.36,-870.32 9139.28,-866.58 9129.19,-863.32 9129.36,-870.32"/>
</g>
<!-- layer0_stage0_expert_23_gpu2&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge130" class="edge">
<title>layer0_stage0_expert_23_gpu2&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M7467.99,-991.71C7487.8,-979.67 7512.01,-967.11 7535.72,-960.29 7828.86,-875.96 8721.87,-863.3 9125.66,-862.01"/>
<polygon fill="black" stroke="black" points="9125.71,-865.51 9135.7,-861.98 9125.69,-858.51 9125.71,-865.51"/>
</g>
<!-- layer0_stage0_expert_24_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge131" class="edge">
<title>layer0_stage0_expert_24_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M7692.28,-991.64C7712.05,-979.66 7736.14,-967.17 7759.72,-960.29 8010.44,-887.1 8763.61,-868.57 9127.12,-863.88"/>
<polygon fill="black" stroke="black" points="9127.27,-867.38 9137.22,-863.75 9127.18,-860.38 9127.27,-867.38"/>
</g>
<!-- layer0_stage0_expert_25_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge132" class="edge">
<title>layer0_stage0_expert_25_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M7916.32,-991.76C7936.09,-979.8 7960.18,-967.29 7983.72,-960.29 8192.45,-898.18 8808.35,-874.58 9128.84,-866.32"/>
<polygon fill="black" stroke="black" points="9129.27,-869.81 9139.18,-866.06 9129.09,-862.81 9129.27,-869.81"/>
</g>
<!-- layer0_stage0_expert_26_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge133" class="edge">
<title>layer0_stage0_expert_26_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M8140.64,-991.76C8160.37,-979.88 8184.34,-967.43 8207.72,-960.29 8375.11,-909.16 8857.66,-881.57 9131.63,-869.63"/>
<polygon fill="black" stroke="black" points="9131.85,-873.13 9141.69,-869.2 9131.55,-866.13 9131.85,-873.13"/>
</g>
<!-- layer0_stage0_expert_27_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge134" class="edge">
<title>layer0_stage0_expert_27_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M8365.25,-991.68C8384.9,-979.94 8408.63,-967.61 8431.72,-960.29 8558.42,-920.08 8911.55,-890.08 9134.79,-874.45"/>
<polygon fill="black" stroke="black" points="9135.26,-877.92 9144.99,-873.73 9134.77,-870.94 9135.26,-877.92"/>
</g>
<!-- layer0_stage0_expert_28_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge135" class="edge">
<title>layer0_stage0_expert_28_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M8589.93,-991.77C8609.49,-980.19 8632.97,-967.96 8655.72,-960.29 8811.31,-907.83 8996.49,-883.44 9133.01,-872.11"/>
<polygon fill="black" stroke="black" points="9133.49,-875.58 9143.17,-871.28 9132.92,-868.61 9133.49,-875.58"/>
</g>
<!-- layer0_stage0_expert_29_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge136" class="edge">
<title>layer0_stage0_expert_29_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M8815.58,-991.77C8834.9,-980.54 8857.78,-968.56 8879.72,-960.29 8964.82,-928.21 9063.18,-905.24 9146.01,-889.65"/>
<polygon fill="black" stroke="black" points="9146.84,-893.05 9156.03,-887.78 9145.56,-886.17 9146.84,-893.05"/>
</g>
<!-- layer0_stage0_expert_30_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge137" class="edge">
<title>layer0_stage0_expert_30_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M9044.45,-991.77C9062.99,-981.4 9084.09,-969.99 9103.72,-960.29 9126.41,-949.07 9150.69,-937.76 9174.57,-927.02"/>
<polygon fill="black" stroke="black" points="9176.01,-930.21 9183.71,-922.92 9173.15,-923.82 9176.01,-930.21"/>
</g>
<!-- layer0_stage0_expert_31_gpu3&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge138" class="edge">
<title>layer0_stage0_expert_31_gpu3&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M9237.31,-991.44C9248.99,-974.76 9263.92,-953.42 9278.28,-932.92"/>
<polygon fill="black" stroke="black" points="9281.3,-934.7 9284.17,-924.5 9275.56,-930.69 9281.3,-934.7"/>
</g>
<!-- layer0_stage0_expert_32_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge139" class="edge">
<title>layer0_stage0_expert_32_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M9418.12,-991.44C9406.45,-974.76 9391.51,-953.42 9377.16,-932.92"/>
<polygon fill="black" stroke="black" points="9379.87,-930.69 9371.27,-924.5 9374.14,-934.7 9379.87,-930.69"/>
</g>
<!-- layer0_stage0_expert_33_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge140" class="edge">
<title>layer0_stage0_expert_33_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M9610.99,-991.77C9592.45,-981.4 9571.34,-969.99 9551.72,-960.29 9530.14,-949.63 9507.14,-938.88 9484.4,-928.61"/>
<polygon fill="black" stroke="black" points="9485.58,-925.3 9475.02,-924.39 9482.71,-931.69 9485.58,-925.3"/>
</g>
<!-- layer0_stage0_expert_34_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge141" class="edge">
<title>layer0_stage0_expert_34_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M9839.85,-991.77C9820.54,-980.54 9797.66,-968.56 9775.72,-960.29 9706.79,-934.3 9629.16,-914.3 9558.13,-899.35"/>
<polygon fill="black" stroke="black" points="9558.66,-895.89 9548.16,-897.27 9557.23,-902.74 9558.66,-895.89"/>
</g>
<!-- layer0_stage0_expert_35_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge142" class="edge">
<title>layer0_stage0_expert_35_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M10065.51,-991.77C10045.95,-980.19 10022.46,-967.96 9999.72,-960.29 9850.4,-909.94 9673.82,-885.45 9539.15,-873.54"/>
<polygon fill="black" stroke="black" points="9539.39,-870.05 9529.12,-872.67 9538.78,-877.03 9539.39,-870.05"/>
</g>
<!-- layer0_stage0_expert_36_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge143" class="edge">
<title>layer0_stage0_expert_36_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M10290.18,-991.68C10270.54,-979.94 10246.81,-967.61 10223.72,-960.29 10100.83,-921.29 9764.92,-891.89 9541.13,-875.89"/>
<polygon fill="black" stroke="black" points="9541.11,-872.38 9530.89,-875.17 9540.62,-879.37 9541.11,-872.38"/>
</g>
<!-- layer0_stage0_expert_37_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge144" class="edge">
<title>layer0_stage0_expert_37_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M10514.8,-991.76C10495.07,-979.88 10471.1,-967.43 10447.72,-960.29 10282.97,-909.97 9812.98,-882.45 9536.98,-870.21"/>
<polygon fill="black" stroke="black" points="9536.98,-866.71 9526.83,-869.76 9536.67,-873.7 9536.98,-866.71"/>
</g>
<!-- layer0_stage0_expert_38_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge145" class="edge">
<title>layer0_stage0_expert_38_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M10739.12,-991.76C10719.34,-979.8 10695.26,-967.29 10671.72,-960.29 10464.65,-898.68 9856.88,-874.96 9534.31,-866.52"/>
<polygon fill="black" stroke="black" points="9533.99,-863.01 9523.91,-866.25 9533.81,-870.01 9533.99,-863.01"/>
</g>
<!-- layer0_stage0_expert_39_gpu4&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge146" class="edge">
<title>layer0_stage0_expert_39_gpu4&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M10963.15,-991.64C10943.38,-979.66 10919.29,-967.17 10895.72,-960.29 10645.88,-887.36 9897.18,-868.7 9532.21,-863.93"/>
<polygon fill="black" stroke="black" points="9532.11,-860.43 9522.06,-863.8 9532.02,-867.43 9532.11,-860.43"/>
</g>
<!-- layer0_stage0_expert_40_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge147" class="edge">
<title>layer0_stage0_expert_40_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M11187.45,-991.71C11167.63,-979.67 11143.43,-967.11 11119.72,-960.29 10826.76,-876.01 9934.7,-863.31 9530.54,-862.01"/>
<polygon fill="black" stroke="black" points="9530.51,-858.51 9520.5,-861.98 9530.49,-865.51 9530.51,-858.51"/>
</g>
<!-- layer0_stage0_expert_41_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge148" class="edge">
<title>layer0_stage0_expert_41_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M11411.46,-991.64C11391.65,-979.59 11367.45,-967.03 11343.72,-960.29 11173.3,-911.82 10013.9,-878.77 9534.51,-867.02"/>
<polygon fill="black" stroke="black" points="9534.44,-863.52 9524.36,-866.78 9534.27,-870.52 9534.44,-863.52"/>
</g>
<!-- layer0_stage0_expert_42_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge149" class="edge">
<title>layer0_stage0_expert_42_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M11635.75,-991.75C11615.89,-979.64 11591.57,-967.01 11567.72,-960.29 11375.39,-906.09 10050.62,-875.79 9533.68,-865.92"/>
<polygon fill="black" stroke="black" points="9533.56,-862.41 9523.49,-865.72 9533.42,-869.41 9533.56,-862.41"/>
</g>
<!-- layer0_stage0_expert_43_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge150" class="edge">
<title>layer0_stage0_expert_43_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M11859.76,-991.7C11839.91,-979.58 11815.58,-966.96 11791.72,-960.29 11577.41,-900.36 10085.98,-873.13 9533.21,-865.02"/>
<polygon fill="black" stroke="black" points="9533.18,-861.52 9523.13,-864.87 9533.08,-868.52 9533.18,-861.52"/>
</g>
<!-- layer0_stage0_expert_44_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge151" class="edge">
<title>layer0_stage0_expert_44_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M12083.77,-991.67C12063.92,-979.54 12039.59,-966.92 12015.72,-960.29 11779.31,-894.6 10119.39,-870.72 9532.61,-864.27"/>
<polygon fill="black" stroke="black" points="9532.38,-860.77 9522.35,-864.16 9532.31,-867.77 9532.38,-860.77"/>
</g>
<!-- layer0_stage0_expert_45_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge152" class="edge">
<title>layer0_stage0_expert_45_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M12307.78,-991.63C12287.93,-979.5 12263.6,-966.89 12239.72,-960.29 11981.17,-888.84 10151.89,-868.51 9532.31,-863.64"/>
<polygon fill="black" stroke="black" points="9531.96,-860.14 9521.93,-863.56 9531.9,-867.14 9531.96,-860.14"/>
</g>
<!-- layer0_stage0_expert_46_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge153" class="edge">
<title>layer0_stage0_expert_46_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M12532.05,-991.77C12512.16,-979.58 12487.72,-966.89 12463.72,-960.29 12182.94,-883.06 10183.01,-866.47 9531.97,-863.1"/>
<polygon fill="black" stroke="black" points="9531.56,-859.6 9521.54,-863.05 9531.53,-866.6 9531.56,-859.6"/>
</g>
<!-- layer0_stage0_expert_47_gpu5&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge154" class="edge">
<title>layer0_stage0_expert_47_gpu5&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M12756.06,-991.75C12736.16,-979.55 12711.73,-966.86 12687.72,-960.29 12384.56,-877.24 10211.86,-864.57 9531.12,-862.63"/>
<polygon fill="black" stroke="black" points="9530.97,-859.13 9520.96,-862.6 9530.95,-866.13 9530.97,-859.13"/>
</g>
<!-- layer0_stage0_expert_48_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge155" class="edge">
<title>layer0_stage0_expert_48_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M12980.07,-991.73C12960.17,-979.53 12935.73,-966.84 12911.72,-960.29 12586.2,-871.44 10240.79,-862.79 9530.82,-862.23"/>
<polygon fill="black" stroke="black" points="9530.75,-858.73 9520.75,-862.22 9530.74,-865.73 9530.75,-858.73"/>
</g>
<!-- layer0_stage0_expert_49_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge156" class="edge">
<title>layer0_stage0_expert_49_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M13204.07,-991.71C13184.18,-979.51 13159.74,-966.82 13135.72,-960.29 12787.81,-865.63 10269.28,-861.13 9530.75,-861.87"/>
<polygon fill="black" stroke="black" points="9530.53,-858.37 9520.54,-861.88 9530.54,-865.37 9530.53,-858.37"/>
</g>
<!-- layer0_stage0_expert_50_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge157" class="edge">
<title>layer0_stage0_expert_50_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M13428.08,-991.69C13408.18,-979.49 13383.74,-966.8 13359.72,-960.29 13173.81,-909.85 10327.47,-873.7 9532.53,-864.55"/>
<polygon fill="black" stroke="black" points="9532.45,-861.05 9522.41,-864.44 9532.37,-868.05 9532.45,-861.05"/>
</g>
<!-- layer0_stage0_expert_51_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge158" class="edge">
<title>layer0_stage0_expert_51_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M13652.08,-991.68C13632.19,-979.47 13607.75,-966.79 13583.72,-960.29 13386.54,-906.92 10355.02,-872.63 9532.35,-864.28"/>
<polygon fill="black" stroke="black" points="9532.21,-860.78 9522.18,-864.17 9532.14,-867.78 9532.21,-860.78"/>
</g>
<!-- layer0_stage0_expert_52_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge159" class="edge">
<title>layer0_stage0_expert_52_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M13876.08,-991.66C13856.19,-979.45 13831.75,-966.78 13807.72,-960.29 13599.26,-904 10382.19,-871.63 9532.32,-864.03"/>
<polygon fill="black" stroke="black" points="9532.15,-860.53 9522.12,-863.94 9532.09,-867.53 9532.15,-860.53"/>
</g>
<!-- layer0_stage0_expert_53_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge160" class="edge">
<title>layer0_stage0_expert_53_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M14100.09,-991.65C14080.19,-979.44 14055.75,-966.76 14031.72,-960.29 13811.96,-901.07 10408.46,-870.68 9532.2,-863.81"/>
<polygon fill="black" stroke="black" points="9532.03,-860.31 9522,-863.73 9531.98,-867.31 9532.03,-860.31"/>
</g>
<!-- layer0_stage0_expert_54_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge161" class="edge">
<title>layer0_stage0_expert_54_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M14324.09,-991.64C14304.2,-979.43 14279.76,-966.75 14255.72,-960.29 14024.63,-898.14 10434.1,-869.77 9532.08,-863.6"/>
<polygon fill="black" stroke="black" points="9531.94,-860.1 9521.92,-863.53 9531.9,-867.1 9531.94,-860.1"/>
</g>
<!-- layer0_stage0_expert_55_gpu6&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge162" class="edge">
<title>layer0_stage0_expert_55_gpu6&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M14548.09,-991.63C14528.2,-979.41 14503.76,-966.74 14479.72,-960.29 14237.27,-895.19 10458.35,-868.9 9531.68,-863.42"/>
<polygon fill="black" stroke="black" points="9531.6,-859.92 9521.57,-863.36 9531.55,-866.92 9531.6,-859.92"/>
</g>
<!-- layer0_stage0_expert_56_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge163" class="edge">
<title>layer0_stage0_expert_56_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M14772.36,-991.79C14752.42,-979.52 14727.87,-966.76 14703.72,-960.29 14449.9,-892.25 10482.43,-868.08 9531.43,-863.25"/>
<polygon fill="black" stroke="black" points="9531.42,-859.75 9521.4,-863.2 9531.39,-866.75 9531.42,-859.75"/>
</g>
<!-- layer0_stage0_expert_57_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge164" class="edge">
<title>layer0_stage0_expert_57_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M14996.36,-991.78C14976.42,-979.51 14951.87,-966.75 14927.72,-960.29 14662.57,-889.31 10507.65,-867.3 9531.77,-863.09"/>
<polygon fill="black" stroke="black" points="9531.5,-859.59 9521.49,-863.05 9531.47,-866.59 9531.5,-859.59"/>
</g>
<!-- layer0_stage0_expert_58_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge165" class="edge">
<title>layer0_stage0_expert_58_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M15220.37,-991.77C15200.43,-979.5 15175.87,-966.74 15151.72,-960.29 14875.19,-886.37 10531.1,-866.54 9531.65,-862.95"/>
<polygon fill="black" stroke="black" points="9531.5,-859.45 9521.49,-862.91 9531.47,-866.45 9531.5,-859.45"/>
</g>
<!-- layer0_stage0_expert_59_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge166" class="edge">
<title>layer0_stage0_expert_59_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M15444.37,-991.76C15424.43,-979.49 15399.87,-966.74 15375.72,-960.29 15087.79,-883.42 10553.91,-865.81 9531.47,-862.81"/>
<polygon fill="black" stroke="black" points="9531.46,-859.31 9521.45,-862.78 9531.44,-866.31 9531.46,-859.31"/>
</g>
<!-- layer0_stage0_expert_60_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge167" class="edge">
<title>layer0_stage0_expert_60_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M15668.37,-991.76C15648.43,-979.48 15623.88,-966.73 15599.72,-960.29 15449.84,-920.32 10596.17,-873.85 9532.42,-864.12"/>
<polygon fill="black" stroke="black" points="9532.41,-860.62 9522.38,-864.03 9532.35,-867.62 9532.41,-860.62"/>
</g>
<!-- layer0_stage0_expert_61_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge168" class="edge">
<title>layer0_stage0_expert_61_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M15892.37,-991.75C15872.43,-979.47 15847.88,-966.72 15823.72,-960.29 15668.14,-918.84 10619.46,-873.34 9532.56,-864.01"/>
<polygon fill="black" stroke="black" points="9532.33,-860.51 9522.3,-863.93 9532.27,-867.51 9532.33,-860.51"/>
</g>
<!-- layer0_stage0_expert_62_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge169" class="edge">
<title>layer0_stage0_expert_62_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M16116.37,-991.74C16096.44,-979.47 16071.88,-966.72 16047.72,-960.29 15886.41,-917.36 10641.33,-872.85 9532.37,-863.91"/>
<polygon fill="black" stroke="black" points="9532.33,-860.41 9522.3,-863.83 9532.27,-867.41 9532.33,-860.41"/>
</g>
<!-- layer0_stage0_expert_63_gpu7&#45;&gt;layer0_stage0_expert_aggregate -->
<g id="edge170" class="edge">
<title>layer0_stage0_expert_63_gpu7&#45;&gt;layer0_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M16340.37,-991.74C16320.44,-979.46 16295.88,-966.71 16271.72,-960.29 16188.16,-938.07 10674.35,-876.93 9533.07,-864.51"/>
<polygon fill="black" stroke="black" points="9532.75,-861 9522.72,-864.39 9532.68,-868 9532.75,-861"/>
</g>
<!-- layer0_stage0_expert_residual -->
<g id="node103" class="node">
<title>layer0_stage0_expert_residual</title>
<ellipse fill="none" stroke="black" cx="16688.72" cy="-1185.29" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="16688.72" y="-1204.79" font-family="Arial" font-size="10.00">layer0_stage0_expert_residual</text>
<text text-anchor="middle" x="16688.72" y="-1193.79" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="16688.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="16688.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="16688.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_input_reshape -->
<g id="node104" class="node">
<title>layer1_stage0_input_reshape</title>
<ellipse fill="none" stroke="black" cx="16688.72" cy="-1023.29" rx="183.7" ry="44.6"/>
<text text-anchor="middle" x="16688.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_input_reshape</text>
<text text-anchor="middle" x="16688.72" y="-1031.79" font-family="Arial" font-size="10.00">Input Reshape</text>
<text text-anchor="middle" x="16688.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="16688.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
<text text-anchor="middle" x="16688.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer0_stage0_expert_residual&#45;&gt;layer1_stage0_input_reshape -->
<g id="edge342" class="edge">
<title>layer0_stage0_expert_residual&#45;&gt;layer1_stage0_input_reshape</title>
<path fill="none" stroke="black" d="M16688.72,-1140.57C16688.72,-1121.25 16688.72,-1098.36 16688.72,-1078.02"/>
<polygon fill="black" stroke="black" points="16692.22,-1077.95 16688.72,-1067.95 16685.22,-1077.95 16692.22,-1077.95"/>
</g>
<!-- layer1_stage0_qkv_proj_0 -->
<g id="node105" class="node">
<title>layer1_stage0_qkv_proj_0</title>
<polygon fill="none" stroke="black" points="15174.72,-892.79 14922.72,-892.79 14922.72,-829.79 15174.72,-829.79 15174.72,-892.79"/>
<text text-anchor="middle" x="15048.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_0</text>
<text text-anchor="middle" x="15048.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;0)</text>
<text text-anchor="middle" x="15048.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="15048.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="15048.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_0 -->
<g id="edge172" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_0</title>
<path fill="none" stroke="black" d="M16591.87,-985.32C16561.53,-975.33 16527.63,-965.78 16495.72,-960.29 15972.07,-870.14 15827.19,-996.16 15300.72,-924.29 15254.55,-917.98 15204.55,-906.65 15161.36,-895.39"/>
<polygon fill="black" stroke="black" points="15162.24,-892 15151.68,-892.83 15160.45,-898.77 15162.24,-892"/>
</g>
<!-- layer1_stage0_qkv_proj_1 -->
<g id="node106" class="node">
<title>layer1_stage0_qkv_proj_1</title>
<polygon fill="none" stroke="black" points="15561.72,-892.79 15309.72,-892.79 15309.72,-829.79 15561.72,-829.79 15561.72,-892.79"/>
<text text-anchor="middle" x="15435.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_1</text>
<text text-anchor="middle" x="15435.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;1)</text>
<text text-anchor="middle" x="15435.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15435.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="15435.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_1 -->
<g id="edge173" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_1</title>
<path fill="none" stroke="black" d="M16590.79,-985.45C16560.71,-975.6 16527.21,-966.09 16495.72,-960.29 16201.57,-906.1 16121.13,-955.93 15823.72,-924.29 15739.65,-915.34 15646.04,-900.53 15571.84,-887.62"/>
<polygon fill="black" stroke="black" points="15572.41,-884.17 15561.96,-885.9 15571.21,-891.07 15572.41,-884.17"/>
</g>
<!-- layer1_stage0_qkv_proj_2 -->
<g id="node107" class="node">
<title>layer1_stage0_qkv_proj_2</title>
<polygon fill="none" stroke="black" points="16084.72,-892.79 15832.72,-892.79 15832.72,-829.79 16084.72,-829.79 16084.72,-892.79"/>
<text text-anchor="middle" x="15958.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_2</text>
<text text-anchor="middle" x="15958.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;2)</text>
<text text-anchor="middle" x="15958.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15958.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="15958.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_2 -->
<g id="edge174" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_2</title>
<path fill="none" stroke="black" d="M16587.5,-985.98C16558.19,-976.5 16525.94,-967.06 16495.72,-960.29 16375.44,-933.33 16341.96,-946.51 16220.72,-924.29 16176.57,-916.2 16128.68,-905.45 16086.07,-895.18"/>
<polygon fill="black" stroke="black" points="16086.75,-891.75 16076.21,-892.79 16085.1,-898.55 16086.75,-891.75"/>
</g>
<!-- layer1_stage0_qkv_proj_3 -->
<g id="node108" class="node">
<title>layer1_stage0_qkv_proj_3</title>
<polygon fill="none" stroke="black" points="16481.72,-892.79 16229.72,-892.79 16229.72,-829.79 16481.72,-829.79 16481.72,-892.79"/>
<text text-anchor="middle" x="16355.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_3</text>
<text text-anchor="middle" x="16355.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;3)</text>
<text text-anchor="middle" x="16355.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16355.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="16355.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_3 -->
<g id="edge175" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_3</title>
<path fill="none" stroke="black" d="M16607.26,-983.15C16552.67,-956.92 16481.42,-922.69 16428.69,-897.35"/>
<polygon fill="black" stroke="black" points="16429.93,-894.06 16419.4,-892.89 16426.9,-900.37 16429.93,-894.06"/>
</g>
<!-- layer1_stage0_qkv_proj_4 -->
<g id="node109" class="node">
<title>layer1_stage0_qkv_proj_4</title>
<polygon fill="none" stroke="black" points="16814.72,-892.79 16562.72,-892.79 16562.72,-829.79 16814.72,-829.79 16814.72,-892.79"/>
<text text-anchor="middle" x="16688.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_4</text>
<text text-anchor="middle" x="16688.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;4)</text>
<text text-anchor="middle" x="16688.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="16688.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="16688.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_4 -->
<g id="edge176" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_4</title>
<path fill="none" stroke="black" d="M16688.72,-978.57C16688.72,-955.14 16688.72,-926.44 16688.72,-903.42"/>
<polygon fill="black" stroke="black" points="16692.22,-903.28 16688.72,-893.28 16685.22,-903.28 16692.22,-903.28"/>
</g>
<!-- layer1_stage0_qkv_proj_5 -->
<g id="node110" class="node">
<title>layer1_stage0_qkv_proj_5</title>
<polygon fill="none" stroke="black" points="17168.72,-892.79 16916.72,-892.79 16916.72,-829.79 17168.72,-829.79 17168.72,-892.79"/>
<text text-anchor="middle" x="17042.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_5</text>
<text text-anchor="middle" x="17042.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;5)</text>
<text text-anchor="middle" x="17042.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="17042.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="17042.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_5 -->
<g id="edge177" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_5</title>
<path fill="none" stroke="black" d="M16773.96,-983.76C16832.39,-957.35 16909.26,-922.61 16965.82,-897.04"/>
<polygon fill="black" stroke="black" points="16967.4,-900.17 16975.07,-892.86 16964.51,-893.79 16967.4,-900.17"/>
</g>
<!-- layer1_stage0_qkv_proj_6 -->
<g id="node111" class="node">
<title>layer1_stage0_qkv_proj_6</title>
<polygon fill="none" stroke="black" points="17544.72,-892.79 17292.72,-892.79 17292.72,-829.79 17544.72,-829.79 17544.72,-892.79"/>
<text text-anchor="middle" x="17418.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_6</text>
<text text-anchor="middle" x="17418.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;6)</text>
<text text-anchor="middle" x="17418.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="17418.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="17418.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_6 -->
<g id="edge178" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_6</title>
<path fill="none" stroke="black" d="M16789.4,-985.96C16818.84,-976.43 16851.29,-966.96 16881.72,-960.29 17011.17,-931.89 17047.49,-948.85 17177.72,-924.29 17218.71,-916.55 17263.07,-905.83 17302.43,-895.48"/>
<polygon fill="black" stroke="black" points="17303.55,-898.8 17312.32,-892.86 17301.75,-892.04 17303.55,-898.8"/>
</g>
<!-- layer1_stage0_qkv_proj_7 -->
<g id="node112" class="node">
<title>layer1_stage0_qkv_proj_7</title>
<polygon fill="none" stroke="black" points="17920.72,-892.79 17668.72,-892.79 17668.72,-829.79 17920.72,-829.79 17920.72,-892.79"/>
<text text-anchor="middle" x="17794.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_qkv_proj_7</text>
<text text-anchor="middle" x="17794.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;7)</text>
<text text-anchor="middle" x="17794.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="17794.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="17794.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_7 -->
<g id="edge179" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_qkv_proj_7</title>
<path fill="none" stroke="black" d="M16786.64,-985.45C16816.73,-975.6 16850.22,-966.09 16881.72,-960.29 17175.86,-906.1 17258.1,-969.77 17553.72,-924.29 17597.1,-917.61 17644.01,-906.47 17684.82,-895.46"/>
<polygon fill="black" stroke="black" points="17685.78,-898.82 17694.51,-892.81 17683.94,-892.07 17685.78,-898.82"/>
</g>
<!-- layer1_stage0_attention_residual -->
<g id="node138" class="node">
<title>layer1_stage0_attention_residual</title>
<ellipse fill="none" stroke="black" cx="17466.72" cy="-188.1" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="17466.72" y="-207.6" font-family="Arial" font-size="10.00">layer1_stage0_attention_residual</text>
<text text-anchor="middle" x="17466.72" y="-196.6" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="17466.72" y="-185.6" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="17466.72" y="-174.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="17466.72" y="-163.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_input_reshape&#45;&gt;layer1_stage0_attention_residual -->
<g id="edge212" class="edge">
<title>layer1_stage0_input_reshape&#45;&gt;layer1_stage0_attention_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16785.58,-985.4C16815.92,-975.42 16849.82,-965.85 16881.72,-960.29 17111.28,-920.27 17704.98,-985.89 17929.72,-924.29 18090.94,-880.09 18244.72,-885.91 18244.72,-718.74 18244.72,-718.74 18244.72,-718.74 18244.72,-479.6 18244.72,-346.5 17840.04,-254.28 17614.41,-213.21"/>
<polygon fill="black" stroke="black" points="17614.93,-209.74 17604.46,-211.41 17613.68,-216.63 17614.93,-209.74"/>
</g>
<!-- layer1_stage0_qkv_reshape_0 -->
<g id="node113" class="node">
<title>layer1_stage0_qkv_reshape_0</title>
<ellipse fill="none" stroke="black" cx="14932.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="14932.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_0</text>
<text text-anchor="middle" x="14932.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;0)</text>
<text text-anchor="middle" x="14932.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="14932.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="14932.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_0&#45;&gt;layer1_stage0_qkv_reshape_0 -->
<g id="edge180" class="edge">
<title>layer1_stage0_qkv_proj_0&#45;&gt;layer1_stage0_qkv_reshape_0</title>
<path fill="none" stroke="black" d="M15023.55,-829.57C15009.19,-812.06 14990.84,-789.66 14974.39,-769.59"/>
<polygon fill="black" stroke="black" points="14977.01,-767.26 14967.96,-761.74 14971.59,-771.7 14977.01,-767.26"/>
</g>
<!-- layer1_stage0_qkv_reshape_1 -->
<g id="node114" class="node">
<title>layer1_stage0_qkv_reshape_1</title>
<ellipse fill="none" stroke="black" cx="15371.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="15371.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_1</text>
<text text-anchor="middle" x="15371.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;1)</text>
<text text-anchor="middle" x="15371.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15371.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="15371.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_1&#45;&gt;layer1_stage0_qkv_reshape_1 -->
<g id="edge181" class="edge">
<title>layer1_stage0_qkv_proj_1&#45;&gt;layer1_stage0_qkv_reshape_1</title>
<path fill="none" stroke="black" d="M15421.83,-829.57C15414.15,-812.59 15404.39,-791.01 15395.54,-771.41"/>
<polygon fill="black" stroke="black" points="15398.71,-769.95 15391.41,-762.28 15392.34,-772.84 15398.71,-769.95"/>
</g>
<!-- layer1_stage0_qkv_reshape_2 -->
<g id="node115" class="node">
<title>layer1_stage0_qkv_reshape_2</title>
<ellipse fill="none" stroke="black" cx="15810.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="15810.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_2</text>
<text text-anchor="middle" x="15810.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;2)</text>
<text text-anchor="middle" x="15810.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15810.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="15810.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_2&#45;&gt;layer1_stage0_qkv_reshape_2 -->
<g id="edge182" class="edge">
<title>layer1_stage0_qkv_proj_2&#45;&gt;layer1_stage0_qkv_reshape_2</title>
<path fill="none" stroke="black" d="M15926.6,-829.57C15907.97,-811.75 15884.06,-788.88 15862.8,-768.55"/>
<polygon fill="black" stroke="black" points="15865.05,-765.86 15855.4,-761.47 15860.21,-770.91 15865.05,-765.86"/>
</g>
<!-- layer1_stage0_qkv_reshape_3 -->
<g id="node116" class="node">
<title>layer1_stage0_qkv_reshape_3</title>
<ellipse fill="none" stroke="black" cx="16249.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="16249.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_3</text>
<text text-anchor="middle" x="16249.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;3)</text>
<text text-anchor="middle" x="16249.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16249.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="16249.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_3&#45;&gt;layer1_stage0_qkv_reshape_3 -->
<g id="edge183" class="edge">
<title>layer1_stage0_qkv_proj_3&#45;&gt;layer1_stage0_qkv_reshape_3</title>
<path fill="none" stroke="black" d="M16332.72,-829.57C16319.71,-812.21 16303.12,-790.04 16288.19,-770.11"/>
<polygon fill="black" stroke="black" points="16290.92,-767.92 16282.12,-762.01 16285.32,-772.11 16290.92,-767.92"/>
</g>
<!-- layer1_stage0_qkv_reshape_4 -->
<g id="node117" class="node">
<title>layer1_stage0_qkv_reshape_4</title>
<ellipse fill="none" stroke="black" cx="16688.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="16688.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_4</text>
<text text-anchor="middle" x="16688.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;4)</text>
<text text-anchor="middle" x="16688.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="16688.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="16688.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_4&#45;&gt;layer1_stage0_qkv_reshape_4 -->
<g id="edge184" class="edge">
<title>layer1_stage0_qkv_proj_4&#45;&gt;layer1_stage0_qkv_reshape_4</title>
<path fill="none" stroke="black" d="M16688.72,-829.57C16688.72,-812.96 16688.72,-791.96 16688.72,-772.72"/>
<polygon fill="black" stroke="black" points="16692.22,-772.55 16688.72,-762.55 16685.22,-772.55 16692.22,-772.55"/>
</g>
<!-- layer1_stage0_qkv_reshape_5 -->
<g id="node118" class="node">
<title>layer1_stage0_qkv_reshape_5</title>
<ellipse fill="none" stroke="black" cx="17127.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="17127.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_5</text>
<text text-anchor="middle" x="17127.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;5)</text>
<text text-anchor="middle" x="17127.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="17127.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="17127.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_5&#45;&gt;layer1_stage0_qkv_reshape_5 -->
<g id="edge185" class="edge">
<title>layer1_stage0_qkv_proj_5&#45;&gt;layer1_stage0_qkv_reshape_5</title>
<path fill="none" stroke="black" d="M17061.16,-829.57C17071.5,-812.36 17084.66,-790.44 17096.55,-770.64"/>
<polygon fill="black" stroke="black" points="17099.58,-772.39 17101.73,-762.01 17093.58,-768.78 17099.58,-772.39"/>
</g>
<!-- layer1_stage0_qkv_reshape_6 -->
<g id="node119" class="node">
<title>layer1_stage0_qkv_reshape_6</title>
<ellipse fill="none" stroke="black" cx="17566.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="17566.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_6</text>
<text text-anchor="middle" x="17566.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;6)</text>
<text text-anchor="middle" x="17566.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="17566.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="17566.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_6&#45;&gt;layer1_stage0_qkv_reshape_6 -->
<g id="edge186" class="edge">
<title>layer1_stage0_qkv_proj_6&#45;&gt;layer1_stage0_qkv_reshape_6</title>
<path fill="none" stroke="black" d="M17450.83,-829.57C17469.46,-811.75 17493.38,-788.88 17514.64,-768.55"/>
<polygon fill="black" stroke="black" points="17517.23,-770.91 17522.04,-761.47 17512.39,-765.86 17517.23,-770.91"/>
</g>
<!-- layer1_stage0_qkv_reshape_7 -->
<g id="node120" class="node">
<title>layer1_stage0_qkv_reshape_7</title>
<ellipse fill="none" stroke="black" cx="18005.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="18005.72" y="-737.24" font-family="Arial" font-size="10.00">layer1_stage0_qkv_reshape_7</text>
<text text-anchor="middle" x="18005.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;7)</text>
<text text-anchor="middle" x="18005.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="18005.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="18005.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_proj_7&#45;&gt;layer1_stage0_qkv_reshape_7 -->
<g id="edge187" class="edge">
<title>layer1_stage0_qkv_proj_7&#45;&gt;layer1_stage0_qkv_reshape_7</title>
<path fill="none" stroke="black" d="M17840.24,-829.75C17867.82,-811.25 17903.57,-787.26 17934.79,-766.32"/>
<polygon fill="black" stroke="black" points="17937.11,-768.98 17943.47,-760.5 17933.21,-763.16 17937.11,-768.98"/>
</g>
<!-- layer1_stage0_attention_0 -->
<g id="node121" class="node">
<title>layer1_stage0_attention_0</title>
<polygon fill="none" stroke="black" points="15200.72,-624.14 14902.72,-624.14 14902.72,-561.14 15200.72,-561.14 15200.72,-624.14"/>
<text text-anchor="middle" x="15051.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_0</text>
<text text-anchor="middle" x="15051.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;0)</text>
<text text-anchor="middle" x="15051.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="15051.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="15051.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_0&#45;&gt;layer1_stage0_attention_0 -->
<g id="edge188" class="edge">
<title>layer1_stage0_qkv_reshape_0&#45;&gt;layer1_stage0_attention_0</title>
<path fill="none" stroke="black" d="M14974,-674.03C14987.37,-660.2 15002.1,-644.97 15015.1,-631.52"/>
<polygon fill="black" stroke="black" points="15017.69,-633.87 15022.13,-624.25 15012.66,-629.01 15017.69,-633.87"/>
</g>
<!-- layer1_stage0_attention_1 -->
<g id="node122" class="node">
<title>layer1_stage0_attention_1</title>
<polygon fill="none" stroke="black" points="15577.72,-624.14 15279.72,-624.14 15279.72,-561.14 15577.72,-561.14 15577.72,-624.14"/>
<text text-anchor="middle" x="15428.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_1</text>
<text text-anchor="middle" x="15428.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;1)</text>
<text text-anchor="middle" x="15428.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15428.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="15428.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_1&#45;&gt;layer1_stage0_attention_1 -->
<g id="edge189" class="edge">
<title>layer1_stage0_qkv_reshape_1&#45;&gt;layer1_stage0_attention_1</title>
<path fill="none" stroke="black" d="M15391.81,-673.34C15397.79,-660.43 15404.31,-646.36 15410.18,-633.67"/>
<polygon fill="black" stroke="black" points="15413.5,-634.84 15414.53,-624.29 15407.15,-631.89 15413.5,-634.84"/>
</g>
<!-- layer1_stage0_attention_2 -->
<g id="node123" class="node">
<title>layer1_stage0_attention_2</title>
<polygon fill="none" stroke="black" points="16007.72,-624.14 15709.72,-624.14 15709.72,-561.14 16007.72,-561.14 16007.72,-624.14"/>
<text text-anchor="middle" x="15858.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_2</text>
<text text-anchor="middle" x="15858.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;2)</text>
<text text-anchor="middle" x="15858.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15858.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="15858.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_2&#45;&gt;layer1_stage0_attention_2 -->
<g id="edge190" class="edge">
<title>layer1_stage0_qkv_reshape_2&#45;&gt;layer1_stage0_attention_2</title>
<path fill="none" stroke="black" d="M15827.78,-672.99C15832.71,-660.34 15838.07,-646.59 15842.92,-634.15"/>
<polygon fill="black" stroke="black" points="15846.31,-635.09 15846.69,-624.5 15839.79,-632.54 15846.31,-635.09"/>
</g>
<!-- layer1_stage0_attention_3 -->
<g id="node124" class="node">
<title>layer1_stage0_attention_3</title>
<polygon fill="none" stroke="black" points="16460.72,-624.14 16162.72,-624.14 16162.72,-561.14 16460.72,-561.14 16460.72,-624.14"/>
<text text-anchor="middle" x="16311.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_3</text>
<text text-anchor="middle" x="16311.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;3)</text>
<text text-anchor="middle" x="16311.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16311.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="16311.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_3&#45;&gt;layer1_stage0_attention_3 -->
<g id="edge191" class="edge">
<title>layer1_stage0_qkv_reshape_3&#45;&gt;layer1_stage0_attention_3</title>
<path fill="none" stroke="black" d="M16271.58,-673.34C16278.14,-660.31 16285.31,-646.08 16291.74,-633.3"/>
<polygon fill="black" stroke="black" points="16294.91,-634.8 16296.28,-624.29 16288.66,-631.65 16294.91,-634.8"/>
</g>
<!-- layer1_stage0_attention_4 -->
<g id="node125" class="node">
<title>layer1_stage0_attention_4</title>
<polygon fill="none" stroke="black" points="16837.72,-624.14 16539.72,-624.14 16539.72,-561.14 16837.72,-561.14 16837.72,-624.14"/>
<text text-anchor="middle" x="16688.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_4</text>
<text text-anchor="middle" x="16688.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;4)</text>
<text text-anchor="middle" x="16688.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="16688.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="16688.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_4&#45;&gt;layer1_stage0_attention_4 -->
<g id="edge192" class="edge">
<title>layer1_stage0_qkv_reshape_4&#45;&gt;layer1_stage0_attention_4</title>
<path fill="none" stroke="black" d="M16688.72,-672.99C16688.72,-660.47 16688.72,-646.87 16688.72,-634.52"/>
<polygon fill="black" stroke="black" points="16692.22,-634.5 16688.72,-624.5 16685.22,-634.5 16692.22,-634.5"/>
</g>
<!-- layer1_stage0_attention_5 -->
<g id="node126" class="node">
<title>layer1_stage0_attention_5</title>
<polygon fill="none" stroke="black" points="17215.72,-624.14 16917.72,-624.14 16917.72,-561.14 17215.72,-561.14 17215.72,-624.14"/>
<text text-anchor="middle" x="17066.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_5</text>
<text text-anchor="middle" x="17066.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;5)</text>
<text text-anchor="middle" x="17066.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="17066.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="17066.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_5&#45;&gt;layer1_stage0_attention_5 -->
<g id="edge193" class="edge">
<title>layer1_stage0_qkv_reshape_5&#45;&gt;layer1_stage0_attention_5</title>
<path fill="none" stroke="black" d="M17106.21,-673.34C17099.75,-660.31 17092.7,-646.08 17086.37,-633.3"/>
<polygon fill="black" stroke="black" points="17089.48,-631.7 17081.9,-624.29 17083.21,-634.8 17089.48,-631.7"/>
</g>
<!-- layer1_stage0_attention_6 -->
<g id="node127" class="node">
<title>layer1_stage0_attention_6</title>
<polygon fill="none" stroke="black" points="17623.72,-624.14 17325.72,-624.14 17325.72,-561.14 17623.72,-561.14 17623.72,-624.14"/>
<text text-anchor="middle" x="17474.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_6</text>
<text text-anchor="middle" x="17474.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;6)</text>
<text text-anchor="middle" x="17474.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="17474.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="17474.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_6&#45;&gt;layer1_stage0_attention_6 -->
<g id="edge194" class="edge">
<title>layer1_stage0_qkv_reshape_6&#45;&gt;layer1_stage0_attention_6</title>
<path fill="none" stroke="black" d="M17534.54,-673.69C17524.59,-660.38 17513.7,-645.8 17503.96,-632.77"/>
<polygon fill="black" stroke="black" points="17506.54,-630.38 17497.75,-624.46 17500.93,-634.57 17506.54,-630.38"/>
</g>
<!-- layer1_stage0_attention_7 -->
<g id="node128" class="node">
<title>layer1_stage0_attention_7</title>
<polygon fill="none" stroke="black" points="18047.72,-624.14 17749.72,-624.14 17749.72,-561.14 18047.72,-561.14 18047.72,-624.14"/>
<text text-anchor="middle" x="17898.72" y="-612.14" font-family="Arial" font-size="10.00">layer1_stage0_attention_7</text>
<text text-anchor="middle" x="17898.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;7)</text>
<text text-anchor="middle" x="17898.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="17898.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="17898.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer1_stage0_qkv_reshape_7&#45;&gt;layer1_stage0_attention_7 -->
<g id="edge195" class="edge">
<title>layer1_stage0_qkv_reshape_7&#45;&gt;layer1_stage0_attention_7</title>
<path fill="none" stroke="black" d="M17968.29,-673.69C17956.51,-660.12 17943.57,-645.24 17932.08,-632.03"/>
<polygon fill="black" stroke="black" points="17934.71,-629.71 17925.51,-624.46 17929.43,-634.31 17934.71,-629.71"/>
</g>
<!-- layer1_stage0_output_proj_0 -->
<g id="node129" class="node">
<title>layer1_stage0_output_proj_0</title>
<polygon fill="none" stroke="black" points="15345.72,-512.1 15055.72,-512.1 15055.72,-449.1 15345.72,-449.1 15345.72,-512.1"/>
<text text-anchor="middle" x="15200.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_0</text>
<text text-anchor="middle" x="15200.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;0)</text>
<text text-anchor="middle" x="15200.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="15200.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="15200.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_0&#45;&gt;layer1_stage0_output_proj_0 -->
<g id="edge196" class="edge">
<title>layer1_stage0_attention_0&#45;&gt;layer1_stage0_output_proj_0</title>
<path fill="none" stroke="black" d="M15093.22,-560.99C15111.15,-547.75 15132.27,-532.15 15151.03,-518.3"/>
<polygon fill="black" stroke="black" points="15153.21,-521.03 15159.18,-512.28 15149.05,-515.4 15153.21,-521.03"/>
</g>
<!-- layer1_stage0_output_proj_1 -->
<g id="node130" class="node">
<title>layer1_stage0_output_proj_1</title>
<polygon fill="none" stroke="black" points="15687.72,-512.1 15397.72,-512.1 15397.72,-449.1 15687.72,-449.1 15687.72,-512.1"/>
<text text-anchor="middle" x="15542.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_1</text>
<text text-anchor="middle" x="15542.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;1)</text>
<text text-anchor="middle" x="15542.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15542.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="15542.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_1&#45;&gt;layer1_stage0_output_proj_1 -->
<g id="edge197" class="edge">
<title>layer1_stage0_attention_1&#45;&gt;layer1_stage0_output_proj_1</title>
<path fill="none" stroke="black" d="M15460.47,-560.99C15473.7,-548.22 15489.21,-533.25 15503.17,-519.78"/>
<polygon fill="black" stroke="black" points="15505.97,-521.93 15510.74,-512.47 15501.11,-516.89 15505.97,-521.93"/>
</g>
<!-- layer1_stage0_output_proj_2 -->
<g id="node131" class="node">
<title>layer1_stage0_output_proj_2</title>
<polygon fill="none" stroke="black" points="16086.72,-512.1 15796.72,-512.1 15796.72,-449.1 16086.72,-449.1 16086.72,-512.1"/>
<text text-anchor="middle" x="15941.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_2</text>
<text text-anchor="middle" x="15941.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;2)</text>
<text text-anchor="middle" x="15941.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15941.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="15941.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_2&#45;&gt;layer1_stage0_output_proj_2 -->
<g id="edge198" class="edge">
<title>layer1_stage0_attention_2&#45;&gt;layer1_stage0_output_proj_2</title>
<path fill="none" stroke="black" d="M15881.84,-560.99C15891.29,-548.45 15902.34,-533.8 15912.36,-520.53"/>
<polygon fill="black" stroke="black" points="15915.21,-522.56 15918.43,-512.47 15909.62,-518.34 15915.21,-522.56"/>
</g>
<!-- layer1_stage0_output_proj_3 -->
<g id="node132" class="node">
<title>layer1_stage0_output_proj_3</title>
<polygon fill="none" stroke="black" points="16490.72,-512.1 16200.72,-512.1 16200.72,-449.1 16490.72,-449.1 16490.72,-512.1"/>
<text text-anchor="middle" x="16345.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_3</text>
<text text-anchor="middle" x="16345.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;3)</text>
<text text-anchor="middle" x="16345.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16345.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="16345.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_3&#45;&gt;layer1_stage0_output_proj_3 -->
<g id="edge199" class="edge">
<title>layer1_stage0_attention_3&#45;&gt;layer1_stage0_output_proj_3</title>
<path fill="none" stroke="black" d="M16321.19,-560.99C16324.92,-548.93 16329.25,-534.91 16333.22,-522.04"/>
<polygon fill="black" stroke="black" points="16336.57,-523.05 16336.18,-512.47 16329.88,-520.99 16336.57,-523.05"/>
</g>
<!-- layer1_stage0_output_proj_4 -->
<g id="node133" class="node">
<title>layer1_stage0_output_proj_4</title>
<polygon fill="none" stroke="black" points="16833.72,-512.1 16543.72,-512.1 16543.72,-449.1 16833.72,-449.1 16833.72,-512.1"/>
<text text-anchor="middle" x="16688.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_4</text>
<text text-anchor="middle" x="16688.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;4)</text>
<text text-anchor="middle" x="16688.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="16688.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="16688.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_4&#45;&gt;layer1_stage0_output_proj_4 -->
<g id="edge200" class="edge">
<title>layer1_stage0_attention_4&#45;&gt;layer1_stage0_output_proj_4</title>
<path fill="none" stroke="black" d="M16688.72,-560.99C16688.72,-549.16 16688.72,-535.46 16688.72,-522.79"/>
<polygon fill="black" stroke="black" points="16692.22,-522.47 16688.72,-512.47 16685.22,-522.47 16692.22,-522.47"/>
</g>
<!-- layer1_stage0_output_proj_5 -->
<g id="node134" class="node">
<title>layer1_stage0_output_proj_5</title>
<polygon fill="none" stroke="black" points="17176.72,-512.1 16886.72,-512.1 16886.72,-449.1 17176.72,-449.1 17176.72,-512.1"/>
<text text-anchor="middle" x="17031.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_5</text>
<text text-anchor="middle" x="17031.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;5)</text>
<text text-anchor="middle" x="17031.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="17031.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="17031.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_5&#45;&gt;layer1_stage0_output_proj_5 -->
<g id="edge201" class="edge">
<title>layer1_stage0_attention_5&#45;&gt;layer1_stage0_output_proj_5</title>
<path fill="none" stroke="black" d="M17056.97,-560.99C17053.13,-548.93 17048.67,-534.91 17044.58,-522.04"/>
<polygon fill="black" stroke="black" points="17047.9,-520.94 17041.54,-512.47 17041.23,-523.06 17047.9,-520.94"/>
</g>
<!-- layer1_stage0_output_proj_6 -->
<g id="node135" class="node">
<title>layer1_stage0_output_proj_6</title>
<polygon fill="none" stroke="black" points="17551.72,-512.1 17261.72,-512.1 17261.72,-449.1 17551.72,-449.1 17551.72,-512.1"/>
<text text-anchor="middle" x="17406.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_6</text>
<text text-anchor="middle" x="17406.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;6)</text>
<text text-anchor="middle" x="17406.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="17406.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="17406.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_6&#45;&gt;layer1_stage0_output_proj_6 -->
<g id="edge202" class="edge">
<title>layer1_stage0_attention_6&#45;&gt;layer1_stage0_output_proj_6</title>
<path fill="none" stroke="black" d="M17455.78,-560.99C17448.18,-548.69 17439.32,-534.36 17431.24,-521.28"/>
<polygon fill="black" stroke="black" points="17434.03,-519.13 17425.79,-512.47 17428.07,-522.81 17434.03,-519.13"/>
</g>
<!-- layer1_stage0_output_proj_7 -->
<g id="node136" class="node">
<title>layer1_stage0_output_proj_7</title>
<polygon fill="none" stroke="black" points="17951.72,-512.1 17661.72,-512.1 17661.72,-449.1 17951.72,-449.1 17951.72,-512.1"/>
<text text-anchor="middle" x="17806.72" y="-500.1" font-family="Arial" font-size="10.00">layer1_stage0_output_proj_7</text>
<text text-anchor="middle" x="17806.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;7)</text>
<text text-anchor="middle" x="17806.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="17806.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="17806.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer1_stage0_attention_7&#45;&gt;layer1_stage0_output_proj_7 -->
<g id="edge203" class="edge">
<title>layer1_stage0_attention_7&#45;&gt;layer1_stage0_output_proj_7</title>
<path fill="none" stroke="black" d="M17873.09,-560.99C17862.51,-548.34 17850.13,-533.53 17838.95,-520.15"/>
<polygon fill="black" stroke="black" points="17841.63,-517.89 17832.53,-512.47 17836.26,-522.38 17841.63,-517.89"/>
</g>
<!-- layer1_stage0_attention_allreduce -->
<g id="node137" class="node">
<title>layer1_stage0_attention_allreduce</title>
<polygon fill="none" stroke="black" points="16924.98,-413.1 16549.14,-413.1 16452.46,-287.1 16828.29,-287.1 16924.98,-413.1"/>
<text text-anchor="middle" x="16688.72" y="-369.6" font-family="Arial" font-size="10.00">layer1_stage0_attention_allreduce</text>
<text text-anchor="middle" x="16688.72" y="-358.6" font-family="Arial" font-size="10.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="16688.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="16688.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024 (x8)</text>
<text text-anchor="middle" x="16688.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_output_proj_0&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge204" class="edge">
<title>layer1_stage0_output_proj_0&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M15345.78,-454.79C15360.26,-452.7 15374.76,-450.75 15388.72,-449.1 15781.71,-402.49 16244.33,-373.83 16498.12,-360.35"/>
<polygon fill="black" stroke="black" points="16498.38,-363.84 16508.18,-359.81 16498.01,-356.85 16498.38,-363.84"/>
</g>
<!-- layer1_stage0_output_proj_1&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge205" class="edge">
<title>layer1_stage0_output_proj_1&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M15687.77,-461.16C15720.62,-457.09 15755.36,-452.87 15787.72,-449.1 16035.94,-420.15 16322.98,-389.4 16505.11,-370.22"/>
<polygon fill="black" stroke="black" points="16505.48,-373.7 16515.06,-369.18 16504.75,-366.74 16505.48,-373.7"/>
</g>
<!-- layer1_stage0_output_proj_2&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge206" class="edge">
<title>layer1_stage0_output_proj_2&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M16087.08,-454.59C16209,-433.62 16383.51,-403.6 16513.21,-381.29"/>
<polygon fill="black" stroke="black" points="16513.99,-384.7 16523.25,-379.56 16512.8,-377.81 16513.99,-384.7"/>
</g>
<!-- layer1_stage0_output_proj_3&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge207" class="edge">
<title>layer1_stage0_output_proj_3&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M16427.44,-448.98C16459.27,-437.05 16496.85,-422.98 16533.43,-409.27"/>
<polygon fill="black" stroke="black" points="16535.08,-412.39 16543.21,-405.61 16532.62,-405.84 16535.08,-412.39"/>
</g>
<!-- layer1_stage0_output_proj_4&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge208" class="edge">
<title>layer1_stage0_output_proj_4&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M16688.72,-448.82C16688.72,-440.99 16688.72,-432.25 16688.72,-423.3"/>
<polygon fill="black" stroke="black" points="16692.22,-423.15 16688.72,-413.15 16685.22,-423.15 16692.22,-423.15"/>
</g>
<!-- layer1_stage0_output_proj_5&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge209" class="edge">
<title>layer1_stage0_output_proj_5&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M16950,-448.98C16923.98,-439.23 16894.13,-428.05 16864.11,-416.81"/>
<polygon fill="black" stroke="black" points="16864.96,-413.39 16854.37,-413.15 16862.51,-419.94 16864.96,-413.39"/>
</g>
<!-- layer1_stage0_output_proj_6&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge210" class="edge">
<title>layer1_stage0_output_proj_6&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M17261.42,-453.59C17162.87,-435.95 17030.55,-412.27 16917.92,-392.12"/>
<polygon fill="black" stroke="black" points="16918.24,-388.62 16907.78,-390.3 16917.01,-395.51 16918.24,-388.62"/>
</g>
<!-- layer1_stage0_output_proj_7&#45;&gt;layer1_stage0_attention_allreduce -->
<g id="edge211" class="edge">
<title>layer1_stage0_output_proj_7&#45;&gt;layer1_stage0_attention_allreduce</title>
<path fill="none" stroke="black" d="M17661.71,-461.34C17628.53,-457.24 17593.41,-452.96 17560.72,-449.1 17337.36,-422.7 17081.62,-394.16 16905.12,-374.72"/>
<polygon fill="black" stroke="black" points="16905.26,-371.21 16894.93,-373.6 16904.49,-378.17 16905.26,-371.21"/>
</g>
<!-- layer1_stage0_attention_allreduce&#45;&gt;layer1_stage0_attention_residual -->
<g id="edge213" class="edge">
<title>layer1_stage0_attention_allreduce&#45;&gt;layer1_stage0_attention_residual</title>
<path fill="none" stroke="black" d="M16850.39,-315.85C16991.88,-286.75 17195.17,-244.94 17329.04,-217.41"/>
<polygon fill="black" stroke="black" points="17329.87,-220.81 17338.96,-215.37 17328.46,-213.96 17329.87,-220.81"/>
</g>
<!-- layer1_stage0_gating -->
<g id="node139" class="node">
<title>layer1_stage0_gating</title>
<polygon fill="none" stroke="black" points="24269.3,-1248.29 23919.99,-1248.29 23830.13,-1122.29 24179.44,-1122.29 24269.3,-1248.29"/>
<text text-anchor="middle" x="24049.72" y="-1204.79" font-family="Arial" font-size="10.00">layer1_stage0_gating</text>
<text text-anchor="middle" x="24049.72" y="-1193.79" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="24049.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="24049.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192</text>
<text text-anchor="middle" x="24049.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, num_experts=16</text>
</g>
<!-- layer1_stage0_expert_0_gpu0 -->
<g id="node140" class="node">
<title>layer1_stage0_expert_0_gpu0</title>
<polygon fill="none" stroke="black" points="17096.72,-1054.79 16890.72,-1054.79 16890.72,-991.79 17096.72,-991.79 17096.72,-1054.79"/>
<text text-anchor="middle" x="16993.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_0_gpu0</text>
<text text-anchor="middle" x="16993.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="16993.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="16993.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="16993.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_0_gpu0 -->
<g id="edge214" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23874.03,-1184.22C22826.86,-1183.55 17442.21,-1175.75 17105.72,-1086.29 17084.95,-1080.77 17063.9,-1070.57 17045.73,-1060.02"/>
<polygon fill="black" stroke="black" points="17047.44,-1056.97 17037.06,-1054.83 17043.85,-1062.97 17047.44,-1056.97"/>
</g>
<!-- layer1_stage0_expert_1_gpu0 -->
<g id="node141" class="node">
<title>layer1_stage0_expert_1_gpu0</title>
<polygon fill="none" stroke="black" points="17320.72,-1054.79 17114.72,-1054.79 17114.72,-991.79 17320.72,-991.79 17320.72,-1054.79"/>
<text text-anchor="middle" x="17217.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_1_gpu0</text>
<text text-anchor="middle" x="17217.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="17217.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="17217.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="17217.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_1_gpu0 -->
<g id="edge215" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.9,-1184.14C22846.59,-1182.97 17654.73,-1172.77 17329.72,-1086.29 17308.95,-1080.76 17287.9,-1070.57 17269.73,-1060.02"/>
<polygon fill="black" stroke="black" points="17271.44,-1056.96 17261.06,-1054.83 17267.85,-1062.97 17271.44,-1056.96"/>
</g>
<!-- layer1_stage0_expert_2_gpu0 -->
<g id="node142" class="node">
<title>layer1_stage0_expert_2_gpu0</title>
<polygon fill="none" stroke="black" points="17544.72,-1054.79 17338.72,-1054.79 17338.72,-991.79 17544.72,-991.79 17544.72,-1054.79"/>
<text text-anchor="middle" x="17441.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_2_gpu0</text>
<text text-anchor="middle" x="17441.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="17441.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="17441.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="17441.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_2_gpu0 -->
<g id="edge216" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23874.06,-1184.05C22867.66,-1182.36 17867.28,-1169.81 17553.72,-1086.29 17532.95,-1080.76 17511.9,-1070.56 17493.74,-1060.01"/>
<polygon fill="black" stroke="black" points="17495.44,-1056.95 17485.07,-1054.82 17491.85,-1062.96 17495.44,-1056.95"/>
</g>
<!-- layer1_stage0_expert_3_gpu0 -->
<g id="node143" class="node">
<title>layer1_stage0_expert_3_gpu0</title>
<polygon fill="none" stroke="black" points="17768.72,-1054.79 17562.72,-1054.79 17562.72,-991.79 17768.72,-991.79 17768.72,-1054.79"/>
<text text-anchor="middle" x="17665.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_3_gpu0</text>
<text text-anchor="middle" x="17665.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="17665.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="17665.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="17665.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_3_gpu0 -->
<g id="edge217" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.73,-1183.95C22887.46,-1181.73 18079.79,-1166.84 17777.72,-1086.29 17756.96,-1080.75 17735.9,-1070.55 17717.74,-1060"/>
<polygon fill="black" stroke="black" points="17719.45,-1056.95 17709.07,-1054.82 17715.85,-1062.95 17719.45,-1056.95"/>
</g>
<!-- layer1_stage0_expert_4_gpu0 -->
<g id="node144" class="node">
<title>layer1_stage0_expert_4_gpu0</title>
<polygon fill="none" stroke="black" points="17992.72,-1054.79 17786.72,-1054.79 17786.72,-991.79 17992.72,-991.79 17992.72,-1054.79"/>
<text text-anchor="middle" x="17889.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_4_gpu0</text>
<text text-anchor="middle" x="17889.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="17889.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="17889.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="17889.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_4_gpu0 -->
<g id="edge218" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_4_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.75,-1183.84C22908.8,-1181.08 18292.35,-1163.88 18001.72,-1086.29 17980.96,-1080.74 17959.9,-1070.55 17941.74,-1060"/>
<polygon fill="black" stroke="black" points="17943.45,-1056.94 17933.07,-1054.81 17939.85,-1062.95 17943.45,-1056.94"/>
</g>
<!-- layer1_stage0_expert_5_gpu0 -->
<g id="node145" class="node">
<title>layer1_stage0_expert_5_gpu0</title>
<polygon fill="none" stroke="black" points="18216.72,-1054.79 18010.72,-1054.79 18010.72,-991.79 18216.72,-991.79 18216.72,-1054.79"/>
<text text-anchor="middle" x="18113.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_5_gpu0</text>
<text text-anchor="middle" x="18113.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="18113.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="18113.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="18113.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_5_gpu0 -->
<g id="edge219" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_5_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.75,-1183.72C22930.46,-1180.41 18504.91,-1160.92 18225.72,-1086.29 18204.96,-1080.74 18183.91,-1070.54 18165.74,-1059.99"/>
<polygon fill="black" stroke="black" points="18167.45,-1056.93 18157.07,-1054.8 18163.86,-1062.94 18167.45,-1056.93"/>
</g>
<!-- layer1_stage0_expert_6_gpu0 -->
<g id="node146" class="node">
<title>layer1_stage0_expert_6_gpu0</title>
<polygon fill="none" stroke="black" points="18440.72,-1054.79 18234.72,-1054.79 18234.72,-991.79 18440.72,-991.79 18440.72,-1054.79"/>
<text text-anchor="middle" x="18337.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_6_gpu0</text>
<text text-anchor="middle" x="18337.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="18337.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="18337.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="18337.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_6_gpu0 -->
<g id="edge220" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_6_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.76,-1183.6C22952.59,-1179.71 18717.49,-1157.96 18449.72,-1086.29 18428.96,-1080.73 18407.91,-1070.53 18389.74,-1059.98"/>
<polygon fill="black" stroke="black" points="18391.45,-1056.92 18381.07,-1054.8 18387.86,-1062.93 18391.45,-1056.92"/>
</g>
<!-- layer1_stage0_expert_7_gpu0 -->
<g id="node147" class="node">
<title>layer1_stage0_expert_7_gpu0</title>
<polygon fill="none" stroke="black" points="18664.72,-1054.79 18458.72,-1054.79 18458.72,-991.79 18664.72,-991.79 18664.72,-1054.79"/>
<text text-anchor="middle" x="18561.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_7_gpu0</text>
<text text-anchor="middle" x="18561.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="18561.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="18561.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="18561.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_7_gpu0 -->
<g id="edge221" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_7_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.46,-1183.46C22974.22,-1178.97 18930.06,-1155 18673.72,-1086.29 18652.96,-1080.72 18631.91,-1070.52 18613.75,-1059.97"/>
<polygon fill="black" stroke="black" points="18615.45,-1056.92 18605.07,-1054.79 18611.86,-1062.92 18615.45,-1056.92"/>
</g>
<!-- layer1_stage0_expert_8_gpu1 -->
<g id="node148" class="node">
<title>layer1_stage0_expert_8_gpu1</title>
<polygon fill="none" stroke="black" points="18888.72,-1054.79 18682.72,-1054.79 18682.72,-991.79 18888.72,-991.79 18888.72,-1054.79"/>
<text text-anchor="middle" x="18785.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_8_gpu1</text>
<text text-anchor="middle" x="18785.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="18785.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="18785.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="18785.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_8_gpu1 -->
<g id="edge222" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_8_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.63,-1183.32C22997.75,-1178.21 19142.68,-1152.05 18897.72,-1086.29 18877.06,-1080.74 18856.1,-1070.6 18837.99,-1060.1"/>
<polygon fill="black" stroke="black" points="18839.72,-1057.06 18829.34,-1054.94 18836.14,-1063.07 18839.72,-1057.06"/>
</g>
<!-- layer1_stage0_expert_9_gpu1 -->
<g id="node149" class="node">
<title>layer1_stage0_expert_9_gpu1</title>
<polygon fill="none" stroke="black" points="19112.72,-1054.79 18906.72,-1054.79 18906.72,-991.79 19112.72,-991.79 19112.72,-1054.79"/>
<text text-anchor="middle" x="19009.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_9_gpu1</text>
<text text-anchor="middle" x="19009.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="19009.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="19009.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="19009.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_9_gpu1 -->
<g id="edge223" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_9_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.23,-1183.16C23020.15,-1177.4 19355.26,-1149.1 19121.72,-1086.29 19101.06,-1080.73 19080.1,-1070.59 19061.99,-1060.09"/>
<polygon fill="black" stroke="black" points="19063.73,-1057.05 19053.35,-1054.93 19060.14,-1063.06 19063.73,-1057.05"/>
</g>
<!-- layer1_stage0_expert_10_gpu1 -->
<g id="node150" class="node">
<title>layer1_stage0_expert_10_gpu1</title>
<polygon fill="none" stroke="black" points="19336.72,-1054.79 19130.72,-1054.79 19130.72,-991.79 19336.72,-991.79 19336.72,-1054.79"/>
<text text-anchor="middle" x="19233.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_10_gpu1</text>
<text text-anchor="middle" x="19233.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="19233.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="19233.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="19233.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_10_gpu1 -->
<g id="edge224" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_10_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.41,-1182.98C23044.73,-1176.57 19567.91,-1146.16 19345.72,-1086.29 19325.06,-1080.72 19304.11,-1070.58 19286,-1060.08"/>
<polygon fill="black" stroke="black" points="19287.73,-1057.04 19277.35,-1054.92 19284.14,-1063.05 19287.73,-1057.04"/>
</g>
<!-- layer1_stage0_expert_11_gpu1 -->
<g id="node151" class="node">
<title>layer1_stage0_expert_11_gpu1</title>
<polygon fill="none" stroke="black" points="19560.72,-1054.79 19354.72,-1054.79 19354.72,-991.79 19560.72,-991.79 19560.72,-1054.79"/>
<text text-anchor="middle" x="19457.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_11_gpu1</text>
<text text-anchor="middle" x="19457.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="19457.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="19457.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="19457.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_11_gpu1 -->
<g id="edge225" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_11_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.17,-1182.79C23068.75,-1175.68 19780.54,-1143.21 19569.72,-1086.29 19549.07,-1080.71 19528.11,-1070.56 19510,-1060.07"/>
<polygon fill="black" stroke="black" points="19511.73,-1057.03 19501.35,-1054.91 19508.15,-1063.04 19511.73,-1057.03"/>
</g>
<!-- layer1_stage0_expert_12_gpu1 -->
<g id="node152" class="node">
<title>layer1_stage0_expert_12_gpu1</title>
<polygon fill="none" stroke="black" points="19784.72,-1054.79 19578.72,-1054.79 19578.72,-991.79 19784.72,-991.79 19784.72,-1054.79"/>
<text text-anchor="middle" x="19681.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_12_gpu1</text>
<text text-anchor="middle" x="19681.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="19681.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="19681.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="19681.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_12_gpu1 -->
<g id="edge226" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_12_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23872.95,-1182.58C23093.49,-1174.74 19993.2,-1140.27 19793.72,-1086.29 19773.07,-1080.7 19752.12,-1070.55 19734,-1060.06"/>
<polygon fill="black" stroke="black" points="19735.74,-1057.01 19725.36,-1054.9 19732.15,-1063.03 19735.74,-1057.01"/>
</g>
<!-- layer1_stage0_expert_13_gpu1 -->
<g id="node153" class="node">
<title>layer1_stage0_expert_13_gpu1</title>
<polygon fill="none" stroke="black" points="20008.72,-1054.79 19802.72,-1054.79 19802.72,-991.79 20008.72,-991.79 20008.72,-1054.79"/>
<text text-anchor="middle" x="19905.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_13_gpu1</text>
<text text-anchor="middle" x="19905.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="19905.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="19905.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="19905.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_13_gpu1 -->
<g id="edge227" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_13_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23872.86,-1182.34C23119.24,-1173.74 20205.88,-1137.34 20017.72,-1086.29 19997.07,-1080.68 19976.12,-1070.53 19958.01,-1060.04"/>
<polygon fill="black" stroke="black" points="19959.74,-1057 19949.36,-1054.88 19956.16,-1063.01 19959.74,-1057"/>
</g>
<!-- layer1_stage0_expert_14_gpu1 -->
<g id="node154" class="node">
<title>layer1_stage0_expert_14_gpu1</title>
<polygon fill="none" stroke="black" points="20232.72,-1054.79 20026.72,-1054.79 20026.72,-991.79 20232.72,-991.79 20232.72,-1054.79"/>
<text text-anchor="middle" x="20129.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_14_gpu1</text>
<text text-anchor="middle" x="20129.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="20129.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="20129.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="20129.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_14_gpu1 -->
<g id="edge228" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_14_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23874.52,-1184.67C23173.86,-1185.55 20594.14,-1182.17 20241.72,-1086.29 20221.08,-1080.67 20200.12,-1070.51 20182.01,-1060.02"/>
<polygon fill="black" stroke="black" points="20183.75,-1056.98 20173.36,-1054.87 20180.16,-1062.99 20183.75,-1056.98"/>
</g>
<!-- layer1_stage0_expert_15_gpu1 -->
<g id="node155" class="node">
<title>layer1_stage0_expert_15_gpu1</title>
<polygon fill="none" stroke="black" points="20456.72,-1054.79 20250.72,-1054.79 20250.72,-991.79 20456.72,-991.79 20456.72,-1054.79"/>
<text text-anchor="middle" x="20353.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_15_gpu1</text>
<text text-anchor="middle" x="20353.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="20353.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="20353.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="20353.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_15_gpu1 -->
<g id="edge229" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_15_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23874.33,-1184.36C23200.01,-1184 20795.61,-1176.33 20465.72,-1086.29 20445.08,-1080.65 20424.13,-1070.49 20406.02,-1060"/>
<polygon fill="black" stroke="black" points="20407.75,-1056.96 20397.37,-1054.85 20404.17,-1062.97 20407.75,-1056.96"/>
</g>
<!-- layer1_stage0_expert_16_gpu2 -->
<g id="node156" class="node">
<title>layer1_stage0_expert_16_gpu2</title>
<polygon fill="none" stroke="black" points="20680.72,-1054.79 20474.72,-1054.79 20474.72,-991.79 20680.72,-991.79 20680.72,-1054.79"/>
<text text-anchor="middle" x="20577.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_16_gpu2</text>
<text text-anchor="middle" x="20577.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 16</text>
<text text-anchor="middle" x="20577.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="20577.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="20577.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_16_gpu2 -->
<g id="edge230" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_16_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23874.06,-1184.01C23226.88,-1182.35 20997.13,-1170.49 20689.72,-1086.29 20669.09,-1080.63 20648.14,-1070.47 20630.02,-1059.98"/>
<polygon fill="black" stroke="black" points="20631.76,-1056.94 20621.37,-1054.83 20628.17,-1062.95 20631.76,-1056.94"/>
</g>
<!-- layer1_stage0_expert_17_gpu2 -->
<g id="node157" class="node">
<title>layer1_stage0_expert_17_gpu2</title>
<polygon fill="none" stroke="black" points="20904.72,-1054.79 20698.72,-1054.79 20698.72,-991.79 20904.72,-991.79 20904.72,-1054.79"/>
<text text-anchor="middle" x="20801.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_17_gpu2</text>
<text text-anchor="middle" x="20801.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 17</text>
<text text-anchor="middle" x="20801.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="20801.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="20801.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_17_gpu2 -->
<g id="edge231" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_17_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.65,-1183.61C23254.4,-1180.58 21198.68,-1164.67 20913.72,-1086.29 20893.09,-1080.61 20872.14,-1070.44 20854.03,-1059.96"/>
<polygon fill="black" stroke="black" points="20855.76,-1056.91 20845.38,-1054.8 20852.18,-1062.93 20855.76,-1056.91"/>
</g>
<!-- layer1_stage0_expert_18_gpu2 -->
<g id="node158" class="node">
<title>layer1_stage0_expert_18_gpu2</title>
<polygon fill="none" stroke="black" points="21128.72,-1054.79 20922.72,-1054.79 20922.72,-991.79 21128.72,-991.79 21128.72,-1054.79"/>
<text text-anchor="middle" x="21025.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_18_gpu2</text>
<text text-anchor="middle" x="21025.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 18</text>
<text text-anchor="middle" x="21025.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="21025.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="21025.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_18_gpu2 -->
<g id="edge232" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_18_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.34,-1183.15C23283.25,-1178.69 21400.32,-1158.85 21137.72,-1086.29 21117.19,-1080.61 21096.34,-1070.5 21078.28,-1060.07"/>
<polygon fill="black" stroke="black" points="21080.04,-1057.04 21069.66,-1054.94 21076.46,-1063.06 21080.04,-1057.04"/>
</g>
<!-- layer1_stage0_expert_19_gpu2 -->
<g id="node159" class="node">
<title>layer1_stage0_expert_19_gpu2</title>
<polygon fill="none" stroke="black" points="21352.72,-1054.79 21146.72,-1054.79 21146.72,-991.79 21352.72,-991.79 21352.72,-1054.79"/>
<text text-anchor="middle" x="21249.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_19_gpu2</text>
<text text-anchor="middle" x="21249.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 19</text>
<text text-anchor="middle" x="21249.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="21249.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="21249.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_19_gpu2 -->
<g id="edge233" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_19_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23872.9,-1182.61C23313.04,-1176.63 21602.01,-1153.05 21361.72,-1086.29 21341.2,-1080.59 21320.35,-1070.47 21302.29,-1060.03"/>
<polygon fill="black" stroke="black" points="21304.05,-1057.01 21293.66,-1054.91 21300.47,-1063.02 21304.05,-1057.01"/>
</g>
<!-- layer1_stage0_expert_20_gpu2 -->
<g id="node160" class="node">
<title>layer1_stage0_expert_20_gpu2</title>
<polygon fill="none" stroke="black" points="21576.72,-1054.79 21370.72,-1054.79 21370.72,-991.79 21576.72,-991.79 21576.72,-1054.79"/>
<text text-anchor="middle" x="21473.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_20_gpu2</text>
<text text-anchor="middle" x="21473.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 20</text>
<text text-anchor="middle" x="21473.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="21473.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="21473.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_20_gpu2 -->
<g id="edge234" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_20_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23872.47,-1181.96C23344.25,-1174.39 21803.79,-1147.26 21585.72,-1086.29 21565.21,-1080.55 21544.36,-1070.42 21526.3,-1059.99"/>
<polygon fill="black" stroke="black" points="21528.06,-1056.97 21517.67,-1054.87 21524.48,-1062.99 21528.06,-1056.97"/>
</g>
<!-- layer1_stage0_expert_21_gpu2 -->
<g id="node161" class="node">
<title>layer1_stage0_expert_21_gpu2</title>
<polygon fill="none" stroke="black" points="21800.72,-1054.79 21594.72,-1054.79 21594.72,-991.79 21800.72,-991.79 21800.72,-1054.79"/>
<text text-anchor="middle" x="21697.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_21_gpu2</text>
<text text-anchor="middle" x="21697.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 21</text>
<text text-anchor="middle" x="21697.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="21697.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="21697.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_21_gpu2 -->
<g id="edge235" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_21_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23872.06,-1181.19C23377.06,-1171.91 22005.66,-1141.5 21809.72,-1086.29 21789.22,-1080.51 21768.38,-1070.37 21750.32,-1059.95"/>
<polygon fill="black" stroke="black" points="21752.07,-1056.92 21741.69,-1054.82 21748.5,-1062.94 21752.07,-1056.92"/>
</g>
<!-- layer1_stage0_expert_22_gpu2 -->
<g id="node162" class="node">
<title>layer1_stage0_expert_22_gpu2</title>
<polygon fill="none" stroke="black" points="22024.72,-1054.79 21818.72,-1054.79 21818.72,-991.79 22024.72,-991.79 22024.72,-1054.79"/>
<text text-anchor="middle" x="21921.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_22_gpu2</text>
<text text-anchor="middle" x="21921.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 22</text>
<text text-anchor="middle" x="21921.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="21921.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="21921.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_22_gpu2 -->
<g id="edge236" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_22_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23871.43,-1180.24C23411.3,-1169.15 22207.61,-1135.74 22033.72,-1086.29 22013.33,-1080.49 21992.58,-1070.4 21974.58,-1060.03"/>
<polygon fill="black" stroke="black" points="21976.36,-1057.02 21965.97,-1054.93 21972.79,-1063.04 21976.36,-1057.02"/>
</g>
<!-- layer1_stage0_expert_23_gpu2 -->
<g id="node163" class="node">
<title>layer1_stage0_expert_23_gpu2</title>
<polygon fill="none" stroke="black" points="22248.72,-1054.79 22042.72,-1054.79 22042.72,-991.79 22248.72,-991.79 22248.72,-1054.79"/>
<text text-anchor="middle" x="22145.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_23_gpu2</text>
<text text-anchor="middle" x="22145.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 23</text>
<text text-anchor="middle" x="22145.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="22145.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="22145.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_23_gpu2 -->
<g id="edge237" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_23_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23874.43,-1184.64C23484.78,-1183.81 22557.52,-1172.53 22257.72,-1086.29 22237.34,-1080.43 22216.6,-1070.32 22198.6,-1059.96"/>
<polygon fill="black" stroke="black" points="22200.38,-1056.94 22189.99,-1054.86 22196.81,-1062.97 22200.38,-1056.94"/>
</g>
<!-- layer1_stage0_expert_24_gpu3 -->
<g id="node164" class="node">
<title>layer1_stage0_expert_24_gpu3</title>
<polygon fill="none" stroke="black" points="22472.72,-1054.79 22266.72,-1054.79 22266.72,-991.79 22472.72,-991.79 22472.72,-1054.79"/>
<text text-anchor="middle" x="22369.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_24_gpu3</text>
<text text-anchor="middle" x="22369.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 24</text>
<text text-anchor="middle" x="22369.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="22369.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="22369.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_24_gpu3 -->
<g id="edge238" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_24_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23873.3,-1182.99C23520.13,-1178.82 22738.15,-1161.13 22481.72,-1086.29 22461.64,-1080.43 22441.19,-1070.5 22423.36,-1060.28"/>
<polygon fill="black" stroke="black" points="22424.68,-1057 22414.28,-1054.94 22421.12,-1063.03 22424.68,-1057"/>
</g>
<!-- layer1_stage0_expert_25_gpu3 -->
<g id="node165" class="node">
<title>layer1_stage0_expert_25_gpu3</title>
<polygon fill="none" stroke="black" points="22696.72,-1054.79 22490.72,-1054.79 22490.72,-991.79 22696.72,-991.79 22696.72,-1054.79"/>
<text text-anchor="middle" x="22593.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_25_gpu3</text>
<text text-anchor="middle" x="22593.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 25</text>
<text text-anchor="middle" x="22593.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="22593.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="22593.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_25_gpu3 -->
<g id="edge239" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_25_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23871.81,-1180.78C23557.99,-1173.03 22919.09,-1149.77 22705.72,-1086.29 22685.67,-1080.32 22665.23,-1070.37 22647.39,-1060.16"/>
<polygon fill="black" stroke="black" points="22648.71,-1056.87 22638.32,-1054.82 22645.16,-1062.91 22648.71,-1056.87"/>
</g>
<!-- layer1_stage0_expert_26_gpu3 -->
<g id="node166" class="node">
<title>layer1_stage0_expert_26_gpu3</title>
<polygon fill="none" stroke="black" points="22920.72,-1054.79 22714.72,-1054.79 22714.72,-991.79 22920.72,-991.79 22920.72,-1054.79"/>
<text text-anchor="middle" x="22817.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_26_gpu3</text>
<text text-anchor="middle" x="22817.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 26</text>
<text text-anchor="middle" x="22817.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="22817.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="22817.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_26_gpu3 -->
<g id="edge240" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_26_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23869.55,-1177.63C23598.77,-1166.08 23100.41,-1138.42 22929.72,-1086.29 22909.81,-1080.21 22889.47,-1070.27 22871.69,-1060.12"/>
<polygon fill="black" stroke="black" points="22873.03,-1056.85 22862.64,-1054.81 22869.49,-1062.89 22873.03,-1056.85"/>
</g>
<!-- layer1_stage0_expert_27_gpu3 -->
<g id="node167" class="node">
<title>layer1_stage0_expert_27_gpu3</title>
<polygon fill="none" stroke="black" points="23144.72,-1054.79 22938.72,-1054.79 22938.72,-991.79 23144.72,-991.79 23144.72,-1054.79"/>
<text text-anchor="middle" x="23041.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_27_gpu3</text>
<text text-anchor="middle" x="23041.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 27</text>
<text text-anchor="middle" x="23041.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="23041.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="23041.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_27_gpu3 -->
<g id="edge241" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_27_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23866.02,-1172.77C23643.41,-1157.32 23282.18,-1127.05 23153.72,-1086.29 23134.05,-1080.05 23113.93,-1070.18 23096.26,-1060.14"/>
<polygon fill="black" stroke="black" points="23097.66,-1056.9 23087.25,-1054.89 23094.13,-1062.95 23097.66,-1056.9"/>
</g>
<!-- layer1_stage0_expert_28_gpu3 -->
<g id="node168" class="node">
<title>layer1_stage0_expert_28_gpu3</title>
<polygon fill="none" stroke="black" points="23368.72,-1054.79 23162.72,-1054.79 23162.72,-991.79 23368.72,-991.79 23368.72,-1054.79"/>
<text text-anchor="middle" x="23265.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_28_gpu3</text>
<text text-anchor="middle" x="23265.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 28</text>
<text text-anchor="middle" x="23265.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="23265.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="23265.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_28_gpu3 -->
<g id="edge242" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_28_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23868.05,-1175.52C23730.44,-1164.67 23538.32,-1140.44 23377.72,-1086.29 23358.35,-1079.76 23338.44,-1069.92 23320.88,-1059.99"/>
<polygon fill="black" stroke="black" points="23322.34,-1056.78 23311.93,-1054.8 23318.83,-1062.84 23322.34,-1056.78"/>
</g>
<!-- layer1_stage0_expert_29_gpu3 -->
<g id="node169" class="node">
<title>layer1_stage0_expert_29_gpu3</title>
<polygon fill="none" stroke="black" points="23592.72,-1054.79 23386.72,-1054.79 23386.72,-991.79 23592.72,-991.79 23592.72,-1054.79"/>
<text text-anchor="middle" x="23489.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_29_gpu3</text>
<text text-anchor="middle" x="23489.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 29</text>
<text text-anchor="middle" x="23489.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="23489.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="23489.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_29_gpu3 -->
<g id="edge243" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_29_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23852.66,-1153.98C23773.2,-1138.49 23681.62,-1116.4 23601.72,-1086.29 23583.03,-1079.24 23563.67,-1069.51 23546.41,-1059.84"/>
<polygon fill="black" stroke="black" points="23548,-1056.72 23537.58,-1054.8 23544.53,-1062.8 23548,-1056.72"/>
</g>
<!-- layer1_stage0_expert_30_gpu3 -->
<g id="node170" class="node">
<title>layer1_stage0_expert_30_gpu3</title>
<polygon fill="none" stroke="black" points="23816.72,-1054.79 23610.72,-1054.79 23610.72,-991.79 23816.72,-991.79 23816.72,-1054.79"/>
<text text-anchor="middle" x="23713.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_30_gpu3</text>
<text text-anchor="middle" x="23713.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 30</text>
<text text-anchor="middle" x="23713.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="23713.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="23713.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_30_gpu3 -->
<g id="edge244" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_30_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23902.42,-1122.18C23876.66,-1110.66 23850.26,-1098.42 23825.72,-1086.29 23809.16,-1078.1 23791.55,-1068.7 23775.31,-1059.73"/>
<polygon fill="black" stroke="black" points="23776.89,-1056.6 23766.45,-1054.8 23773.49,-1062.72 23776.89,-1056.6"/>
</g>
<!-- layer1_stage0_expert_31_gpu3 -->
<g id="node171" class="node">
<title>layer1_stage0_expert_31_gpu3</title>
<polygon fill="none" stroke="black" points="24040.72,-1054.79 23834.72,-1054.79 23834.72,-991.79 24040.72,-991.79 24040.72,-1054.79"/>
<text text-anchor="middle" x="23937.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_31_gpu3</text>
<text text-anchor="middle" x="23937.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 31</text>
<text text-anchor="middle" x="23937.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="23937.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="23937.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_31_gpu3 -->
<g id="edge245" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_31_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24006.09,-1121.97C23992.27,-1102.21 23977.38,-1080.94 23965.03,-1063.31"/>
<polygon fill="black" stroke="black" points="23967.8,-1061.15 23959.19,-1054.97 23962.06,-1065.17 23967.8,-1061.15"/>
</g>
<!-- layer1_stage0_expert_32_gpu4 -->
<g id="node172" class="node">
<title>layer1_stage0_expert_32_gpu4</title>
<polygon fill="none" stroke="black" points="24264.72,-1054.79 24058.72,-1054.79 24058.72,-991.79 24264.72,-991.79 24264.72,-1054.79"/>
<text text-anchor="middle" x="24161.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_32_gpu4</text>
<text text-anchor="middle" x="24161.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 32</text>
<text text-anchor="middle" x="24161.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="24161.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="24161.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_32_gpu4 -->
<g id="edge246" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_32_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24093.34,-1121.97C24107.17,-1102.21 24122.06,-1080.94 24134.4,-1063.31"/>
<polygon fill="black" stroke="black" points="24137.37,-1065.17 24140.24,-1054.97 24131.64,-1061.15 24137.37,-1065.17"/>
</g>
<!-- layer1_stage0_expert_33_gpu4 -->
<g id="node173" class="node">
<title>layer1_stage0_expert_33_gpu4</title>
<polygon fill="none" stroke="black" points="24488.72,-1054.79 24282.72,-1054.79 24282.72,-991.79 24488.72,-991.79 24488.72,-1054.79"/>
<text text-anchor="middle" x="24385.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_33_gpu4</text>
<text text-anchor="middle" x="24385.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 33</text>
<text text-anchor="middle" x="24385.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="24385.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="24385.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_33_gpu4 -->
<g id="edge247" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_33_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24183.91,-1128.01C24213.72,-1114.83 24244.99,-1100.49 24273.72,-1086.29 24290.28,-1078.1 24307.89,-1068.7 24324.12,-1059.73"/>
<polygon fill="black" stroke="black" points="24325.95,-1062.72 24332.99,-1054.8 24322.55,-1056.6 24325.95,-1062.72"/>
</g>
<!-- layer1_stage0_expert_34_gpu4 -->
<g id="node174" class="node">
<title>layer1_stage0_expert_34_gpu4</title>
<polygon fill="none" stroke="black" points="24712.72,-1054.79 24506.72,-1054.79 24506.72,-991.79 24712.72,-991.79 24712.72,-1054.79"/>
<text text-anchor="middle" x="24609.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_34_gpu4</text>
<text text-anchor="middle" x="24609.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 34</text>
<text text-anchor="middle" x="24609.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="24609.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="24609.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_34_gpu4 -->
<g id="edge248" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_34_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24207.39,-1161.33C24294.73,-1145.77 24404.22,-1121.53 24497.72,-1086.29 24516.4,-1079.24 24535.77,-1069.51 24553.03,-1059.84"/>
<polygon fill="black" stroke="black" points="24554.9,-1062.8 24561.85,-1054.8 24551.43,-1056.72 24554.9,-1062.8"/>
</g>
<!-- layer1_stage0_expert_35_gpu4 -->
<g id="node175" class="node">
<title>layer1_stage0_expert_35_gpu4</title>
<polygon fill="none" stroke="black" points="24936.72,-1054.79 24730.72,-1054.79 24730.72,-991.79 24936.72,-991.79 24936.72,-1054.79"/>
<text text-anchor="middle" x="24833.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_35_gpu4</text>
<text text-anchor="middle" x="24833.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 35</text>
<text text-anchor="middle" x="24833.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="24833.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="24833.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_35_gpu4 -->
<g id="edge249" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_35_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24218.27,-1176.52C24356.6,-1166.2 24555.95,-1142.18 24721.72,-1086.29 24741.09,-1079.76 24760.99,-1069.92 24778.55,-1059.99"/>
<polygon fill="black" stroke="black" points="24780.6,-1062.84 24787.51,-1054.8 24777.1,-1056.78 24780.6,-1062.84"/>
</g>
<!-- layer1_stage0_expert_36_gpu4 -->
<g id="node176" class="node">
<title>layer1_stage0_expert_36_gpu4</title>
<polygon fill="none" stroke="black" points="25160.72,-1054.79 24954.72,-1054.79 24954.72,-991.79 25160.72,-991.79 25160.72,-1054.79"/>
<text text-anchor="middle" x="25057.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_36_gpu4</text>
<text text-anchor="middle" x="25057.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 36</text>
<text text-anchor="middle" x="25057.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="25057.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="25057.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_36_gpu4 -->
<g id="edge250" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_36_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24216.73,-1173.92C24437.52,-1158.86 24814,-1128.08 24945.72,-1086.29 24965.38,-1080.05 24985.51,-1070.18 25003.18,-1060.14"/>
<polygon fill="black" stroke="black" points="25005.31,-1062.95 25012.18,-1054.89 25001.78,-1056.9 25005.31,-1062.95"/>
</g>
<!-- layer1_stage0_expert_37_gpu4 -->
<g id="node177" class="node">
<title>layer1_stage0_expert_37_gpu4</title>
<polygon fill="none" stroke="black" points="25384.72,-1054.79 25178.72,-1054.79 25178.72,-991.79 25384.72,-991.79 25384.72,-1054.79"/>
<text text-anchor="middle" x="25281.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_37_gpu4</text>
<text text-anchor="middle" x="25281.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 37</text>
<text text-anchor="middle" x="25281.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="25281.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="25281.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_37_gpu4 -->
<g id="edge251" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_37_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24219.45,-1178.07C24487.66,-1166.79 24996.81,-1139.1 25169.72,-1086.29 25189.63,-1080.21 25209.96,-1070.27 25227.75,-1060.12"/>
<polygon fill="black" stroke="black" points="25229.94,-1062.89 25236.8,-1054.81 25226.4,-1056.85 25229.94,-1062.89"/>
</g>
<!-- layer1_stage0_expert_38_gpu4 -->
<g id="node178" class="node">
<title>layer1_stage0_expert_38_gpu4</title>
<polygon fill="none" stroke="black" points="25608.72,-1054.79 25402.72,-1054.79 25402.72,-991.79 25608.72,-991.79 25608.72,-1054.79"/>
<text text-anchor="middle" x="25505.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_38_gpu4</text>
<text text-anchor="middle" x="25505.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 38</text>
<text text-anchor="middle" x="25505.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="25505.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="25505.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_38_gpu4 -->
<g id="edge252" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_38_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24221.48,-1180.93C24533.04,-1173.33 25178.94,-1150.19 25393.72,-1086.29 25413.76,-1080.32 25434.2,-1070.37 25452.04,-1060.16"/>
<polygon fill="black" stroke="black" points="25454.27,-1062.91 25461.12,-1054.82 25450.72,-1056.87 25454.27,-1062.91"/>
</g>
<!-- layer1_stage0_expert_39_gpu4 -->
<g id="node179" class="node">
<title>layer1_stage0_expert_39_gpu4</title>
<polygon fill="none" stroke="black" points="25832.72,-1054.79 25626.72,-1054.79 25626.72,-991.79 25832.72,-991.79 25832.72,-1054.79"/>
<text text-anchor="middle" x="25729.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_39_gpu4</text>
<text text-anchor="middle" x="25729.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 39</text>
<text text-anchor="middle" x="25729.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="25729.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="25729.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_39_gpu4 -->
<g id="edge253" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_39_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.1,-1183.03C24574.81,-1178.92 25360.55,-1161.35 25617.72,-1086.29 25637.79,-1080.43 25658.24,-1070.5 25676.08,-1060.28"/>
<polygon fill="black" stroke="black" points="25678.31,-1063.03 25685.15,-1054.94 25674.76,-1057 25678.31,-1063.03"/>
</g>
<!-- layer1_stage0_expert_40_gpu5 -->
<g id="node180" class="node">
<title>layer1_stage0_expert_40_gpu5</title>
<polygon fill="none" stroke="black" points="26056.72,-1054.79 25850.72,-1054.79 25850.72,-991.79 26056.72,-991.79 26056.72,-1054.79"/>
<text text-anchor="middle" x="25953.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_40_gpu5</text>
<text text-anchor="middle" x="25953.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 40</text>
<text text-anchor="middle" x="25953.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="25953.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="25953.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_40_gpu5 -->
<g id="edge254" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_40_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.91,-1184.64C24612.91,-1183.84 25541.63,-1172.61 25841.72,-1086.29 25862.09,-1080.43 25882.83,-1070.32 25900.84,-1059.96"/>
<polygon fill="black" stroke="black" points="25902.62,-1062.97 25909.45,-1054.86 25899.06,-1056.94 25902.62,-1062.97"/>
</g>
<!-- layer1_stage0_expert_41_gpu5 -->
<g id="node181" class="node">
<title>layer1_stage0_expert_41_gpu5</title>
<polygon fill="none" stroke="black" points="26280.72,-1054.79 26074.72,-1054.79 26074.72,-991.79 26280.72,-991.79 26280.72,-1054.79"/>
<text text-anchor="middle" x="26177.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_41_gpu5</text>
<text text-anchor="middle" x="26177.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 41</text>
<text text-anchor="middle" x="26177.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="26177.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="26177.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_41_gpu5 -->
<g id="edge255" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_41_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24220.96,-1180.41C24675.72,-1169.49 25890.93,-1136 26065.72,-1086.29 26086.11,-1080.49 26106.86,-1070.4 26124.86,-1060.03"/>
<polygon fill="black" stroke="black" points="26126.65,-1063.04 26133.46,-1054.93 26123.08,-1057.02 26126.65,-1063.04"/>
</g>
<!-- layer1_stage0_expert_42_gpu5 -->
<g id="node182" class="node">
<title>layer1_stage0_expert_42_gpu5</title>
<polygon fill="none" stroke="black" points="26504.72,-1054.79 26298.72,-1054.79 26298.72,-991.79 26504.72,-991.79 26504.72,-1054.79"/>
<text text-anchor="middle" x="26401.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_42_gpu5</text>
<text text-anchor="middle" x="26401.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 42</text>
<text text-anchor="middle" x="26401.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="26401.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="26401.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_42_gpu5 -->
<g id="edge256" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_42_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24221.65,-1181.3C24711.7,-1172.15 26093.02,-1141.71 26289.72,-1086.29 26310.22,-1080.51 26331.06,-1070.37 26349.12,-1059.95"/>
<polygon fill="black" stroke="black" points="26350.94,-1062.94 26357.75,-1054.82 26347.36,-1056.92 26350.94,-1062.94"/>
</g>
<!-- layer1_stage0_expert_43_gpu5 -->
<g id="node183" class="node">
<title>layer1_stage0_expert_43_gpu5</title>
<polygon fill="none" stroke="black" points="26728.72,-1054.79 26522.72,-1054.79 26522.72,-991.79 26728.72,-991.79 26728.72,-1054.79"/>
<text text-anchor="middle" x="26625.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_43_gpu5</text>
<text text-anchor="middle" x="26625.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 43</text>
<text text-anchor="middle" x="26625.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="26625.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="26625.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_43_gpu5 -->
<g id="edge257" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_43_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24222.31,-1182.03C24746.08,-1174.55 26295.01,-1147.45 26513.72,-1086.29 26534.23,-1080.55 26555.07,-1070.42 26573.13,-1059.99"/>
<polygon fill="black" stroke="black" points="26574.95,-1062.99 26581.76,-1054.87 26571.38,-1056.97 26574.95,-1062.99"/>
</g>
<!-- layer1_stage0_expert_44_gpu5 -->
<g id="node184" class="node">
<title>layer1_stage0_expert_44_gpu5</title>
<polygon fill="none" stroke="black" points="26952.72,-1054.79 26746.72,-1054.79 26746.72,-991.79 26952.72,-991.79 26952.72,-1054.79"/>
<text text-anchor="middle" x="26849.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_44_gpu5</text>
<text text-anchor="middle" x="26849.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 44</text>
<text text-anchor="middle" x="26849.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="26849.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="26849.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_44_gpu5 -->
<g id="edge258" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_44_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24222.62,-1182.65C24778.38,-1176.74 26496.86,-1153.21 26737.72,-1086.29 26758.24,-1080.59 26779.09,-1070.47 26797.14,-1060.03"/>
<polygon fill="black" stroke="black" points="26798.96,-1063.02 26805.77,-1054.91 26795.39,-1057.01 26798.96,-1063.02"/>
</g>
<!-- layer1_stage0_expert_45_gpu5 -->
<g id="node185" class="node">
<title>layer1_stage0_expert_45_gpu5</title>
<polygon fill="none" stroke="black" points="27176.72,-1054.79 26970.72,-1054.79 26970.72,-991.79 27176.72,-991.79 27176.72,-1054.79"/>
<text text-anchor="middle" x="27073.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_45_gpu5</text>
<text text-anchor="middle" x="27073.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 45</text>
<text text-anchor="middle" x="27073.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="27073.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="27073.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_45_gpu5 -->
<g id="edge259" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_45_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.02,-1183.17C24809.63,-1178.76 26698.66,-1158.98 26961.72,-1086.29 26982.24,-1080.61 27003.1,-1070.5 27021.15,-1060.07"/>
<polygon fill="black" stroke="black" points="27022.97,-1063.06 27029.78,-1054.94 27019.4,-1057.04 27022.97,-1063.06"/>
</g>
<!-- layer1_stage0_expert_46_gpu5 -->
<g id="node186" class="node">
<title>layer1_stage0_expert_46_gpu5</title>
<polygon fill="none" stroke="black" points="27400.72,-1054.79 27194.72,-1054.79 27194.72,-991.79 27400.72,-991.79 27400.72,-1054.79"/>
<text text-anchor="middle" x="27297.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_46_gpu5</text>
<text text-anchor="middle" x="27297.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 46</text>
<text text-anchor="middle" x="27297.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="27297.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="27297.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_46_gpu5 -->
<g id="edge260" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_46_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.38,-1183.63C24839.7,-1180.62 26900.38,-1164.77 27185.72,-1086.29 27206.34,-1080.61 27227.29,-1070.44 27245.4,-1059.96"/>
<polygon fill="black" stroke="black" points="27247.26,-1062.93 27254.05,-1054.8 27243.67,-1056.91 27247.26,-1062.93"/>
</g>
<!-- layer1_stage0_expert_47_gpu5 -->
<g id="node187" class="node">
<title>layer1_stage0_expert_47_gpu5</title>
<polygon fill="none" stroke="black" points="27624.72,-1054.79 27418.72,-1054.79 27418.72,-991.79 27624.72,-991.79 27624.72,-1054.79"/>
<text text-anchor="middle" x="27521.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_47_gpu5</text>
<text text-anchor="middle" x="27521.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 47</text>
<text text-anchor="middle" x="27521.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="27521.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="27521.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_47_gpu5 -->
<g id="edge261" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_47_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.71,-1184.02C24868.73,-1182.37 27102.04,-1170.57 27409.72,-1086.29 27430.35,-1080.63 27451.3,-1070.47 27469.41,-1059.98"/>
<polygon fill="black" stroke="black" points="27471.26,-1062.95 27478.06,-1054.83 27467.68,-1056.94 27471.26,-1062.95"/>
</g>
<!-- layer1_stage0_expert_48_gpu6 -->
<g id="node188" class="node">
<title>layer1_stage0_expert_48_gpu6</title>
<polygon fill="none" stroke="black" points="27848.72,-1054.79 27642.72,-1054.79 27642.72,-991.79 27848.72,-991.79 27848.72,-1054.79"/>
<text text-anchor="middle" x="27745.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_48_gpu6</text>
<text text-anchor="middle" x="27745.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 48</text>
<text text-anchor="middle" x="27745.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="27745.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="27745.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_48_gpu6 -->
<g id="edge262" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_48_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.96,-1184.36C24896.69,-1184.01 27303.64,-1176.38 27633.72,-1086.29 27654.35,-1080.65 27675.31,-1070.49 27693.42,-1060"/>
<polygon fill="black" stroke="black" points="27695.27,-1062.97 27702.07,-1054.85 27691.68,-1056.96 27695.27,-1062.97"/>
</g>
<!-- layer1_stage0_expert_49_gpu6 -->
<g id="node189" class="node">
<title>layer1_stage0_expert_49_gpu6</title>
<polygon fill="none" stroke="black" points="28072.72,-1054.79 27866.72,-1054.79 27866.72,-991.79 28072.72,-991.79 28072.72,-1054.79"/>
<text text-anchor="middle" x="27969.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_49_gpu6</text>
<text text-anchor="middle" x="27969.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 49</text>
<text text-anchor="middle" x="27969.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="27969.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="27969.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_49_gpu6 -->
<g id="edge263" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_49_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24224.02,-1184.67C24923.38,-1185.55 27505.15,-1182.22 27857.72,-1086.29 27878.36,-1080.67 27899.31,-1070.51 27917.42,-1060.02"/>
<polygon fill="black" stroke="black" points="27919.28,-1062.99 27926.07,-1054.87 27915.69,-1056.98 27919.28,-1062.99"/>
</g>
<!-- layer1_stage0_expert_50_gpu6 -->
<g id="node190" class="node">
<title>layer1_stage0_expert_50_gpu6</title>
<polygon fill="none" stroke="black" points="28296.72,-1054.79 28090.72,-1054.79 28090.72,-991.79 28296.72,-991.79 28296.72,-1054.79"/>
<text text-anchor="middle" x="28193.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_50_gpu6</text>
<text text-anchor="middle" x="28193.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 50</text>
<text text-anchor="middle" x="28193.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="28193.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="28193.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_50_gpu6 -->
<g id="edge264" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_50_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24222.48,-1182.39C24969.56,-1173.88 27893.21,-1137.43 28081.72,-1086.29 28102.36,-1080.68 28123.32,-1070.53 28141.43,-1060.04"/>
<polygon fill="black" stroke="black" points="28143.28,-1063.01 28150.08,-1054.88 28139.69,-1057 28143.28,-1063.01"/>
</g>
<!-- layer1_stage0_expert_51_gpu6 -->
<g id="node191" class="node">
<title>layer1_stage0_expert_51_gpu6</title>
<polygon fill="none" stroke="black" points="28520.72,-1054.79 28314.72,-1054.79 28314.72,-991.79 28520.72,-991.79 28520.72,-1054.79"/>
<text text-anchor="middle" x="28417.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_51_gpu6</text>
<text text-anchor="middle" x="28417.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 51</text>
<text text-anchor="middle" x="28417.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="28417.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="28417.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_51_gpu6 -->
<g id="edge265" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_51_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24222.58,-1182.62C24995.54,-1174.85 28105.9,-1140.36 28305.72,-1086.29 28326.37,-1080.7 28347.32,-1070.55 28365.43,-1060.06"/>
<polygon fill="black" stroke="black" points="28367.29,-1063.03 28374.08,-1054.9 28363.7,-1057.01 28367.29,-1063.03"/>
</g>
<!-- layer1_stage0_expert_52_gpu6 -->
<g id="node192" class="node">
<title>layer1_stage0_expert_52_gpu6</title>
<polygon fill="none" stroke="black" points="28744.72,-1054.79 28538.72,-1054.79 28538.72,-991.79 28744.72,-991.79 28744.72,-1054.79"/>
<text text-anchor="middle" x="28641.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_52_gpu6</text>
<text text-anchor="middle" x="28641.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 52</text>
<text text-anchor="middle" x="28641.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="28641.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="28641.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_52_gpu6 -->
<g id="edge266" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_52_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24222.92,-1182.82C25021.53,-1175.77 28318.6,-1143.29 28529.72,-1086.29 28550.37,-1080.71 28571.32,-1070.56 28589.44,-1060.07"/>
<polygon fill="black" stroke="black" points="28591.29,-1063.04 28598.08,-1054.91 28587.7,-1057.03 28591.29,-1063.04"/>
</g>
<!-- layer1_stage0_expert_53_gpu6 -->
<g id="node193" class="node">
<title>layer1_stage0_expert_53_gpu6</title>
<polygon fill="none" stroke="black" points="28968.72,-1054.79 28762.72,-1054.79 28762.72,-991.79 28968.72,-991.79 28968.72,-1054.79"/>
<text text-anchor="middle" x="28865.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_53_gpu6</text>
<text text-anchor="middle" x="28865.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 53</text>
<text text-anchor="middle" x="28865.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="28865.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="28865.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_53_gpu6 -->
<g id="edge267" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_53_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24222.94,-1183.01C25046.02,-1176.64 28531.25,-1146.23 28753.72,-1086.29 28774.37,-1080.72 28795.33,-1070.58 28813.44,-1060.08"/>
<polygon fill="black" stroke="black" points="28815.29,-1063.05 28822.09,-1054.92 28811.71,-1057.04 28815.29,-1063.05"/>
</g>
<!-- layer1_stage0_expert_54_gpu6 -->
<g id="node194" class="node">
<title>layer1_stage0_expert_54_gpu6</title>
<polygon fill="none" stroke="black" points="29192.72,-1054.79 28986.72,-1054.79 28986.72,-991.79 29192.72,-991.79 29192.72,-1054.79"/>
<text text-anchor="middle" x="29089.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_54_gpu6</text>
<text text-anchor="middle" x="29089.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 54</text>
<text text-anchor="middle" x="29089.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="29089.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="29089.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_54_gpu6 -->
<g id="edge268" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_54_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.03,-1183.18C25070.17,-1177.47 28743.88,-1149.18 28977.72,-1086.29 28998.38,-1080.73 29019.33,-1070.59 29037.44,-1060.09"/>
<polygon fill="black" stroke="black" points="29039.3,-1063.06 29046.09,-1054.93 29035.71,-1057.05 29039.3,-1063.06"/>
</g>
<!-- layer1_stage0_expert_55_gpu6 -->
<g id="node195" class="node">
<title>layer1_stage0_expert_55_gpu6</title>
<polygon fill="none" stroke="black" points="29416.72,-1054.79 29210.72,-1054.79 29210.72,-991.79 29416.72,-991.79 29416.72,-1054.79"/>
<text text-anchor="middle" x="29313.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_55_gpu6</text>
<text text-anchor="middle" x="29313.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 55</text>
<text text-anchor="middle" x="29313.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="29313.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="29313.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_55_gpu6 -->
<g id="edge269" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_55_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.28,-1183.33C25094.25,-1178.26 28956.52,-1152.12 29201.72,-1086.29 29222.38,-1080.74 29243.33,-1070.6 29261.44,-1060.1"/>
<polygon fill="black" stroke="black" points="29263.3,-1063.07 29270.09,-1054.94 29259.71,-1057.06 29263.3,-1063.07"/>
</g>
<!-- layer1_stage0_expert_56_gpu7 -->
<g id="node196" class="node">
<title>layer1_stage0_expert_56_gpu7</title>
<polygon fill="none" stroke="black" points="29640.72,-1054.79 29434.72,-1054.79 29434.72,-991.79 29640.72,-991.79 29640.72,-1054.79"/>
<text text-anchor="middle" x="29537.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_56_gpu7</text>
<text text-anchor="middle" x="29537.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 56</text>
<text text-anchor="middle" x="29537.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="29537.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="29537.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_56_gpu7 -->
<g id="edge270" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_56_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.39,-1183.48C25117.44,-1179.02 29169.13,-1155.07 29425.72,-1086.29 29446.47,-1080.72 29467.52,-1070.52 29485.69,-1059.97"/>
<polygon fill="black" stroke="black" points="29487.57,-1062.92 29494.36,-1054.79 29483.98,-1056.92 29487.57,-1062.92"/>
</g>
<!-- layer1_stage0_expert_57_gpu7 -->
<g id="node197" class="node">
<title>layer1_stage0_expert_57_gpu7</title>
<polygon fill="none" stroke="black" points="29864.72,-1054.79 29658.72,-1054.79 29658.72,-991.79 29864.72,-991.79 29864.72,-1054.79"/>
<text text-anchor="middle" x="29761.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_57_gpu7</text>
<text text-anchor="middle" x="29761.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 57</text>
<text text-anchor="middle" x="29761.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="29761.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="29761.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_57_gpu7 -->
<g id="edge271" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_57_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.41,-1183.61C25139.88,-1179.74 29381.72,-1158.02 29649.72,-1086.29 29670.47,-1080.73 29691.53,-1070.53 29709.69,-1059.98"/>
<polygon fill="black" stroke="black" points="29711.58,-1062.93 29718.36,-1054.8 29707.98,-1056.92 29711.58,-1062.93"/>
</g>
<!-- layer1_stage0_expert_58_gpu7 -->
<g id="node198" class="node">
<title>layer1_stage0_expert_58_gpu7</title>
<polygon fill="none" stroke="black" points="30088.72,-1054.79 29882.72,-1054.79 29882.72,-991.79 30088.72,-991.79 30088.72,-1054.79"/>
<text text-anchor="middle" x="29985.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_58_gpu7</text>
<text text-anchor="middle" x="29985.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 58</text>
<text text-anchor="middle" x="29985.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="29985.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="29985.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_58_gpu7 -->
<g id="edge272" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_58_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.37,-1183.73C25161.71,-1180.44 29594.29,-1160.98 29873.72,-1086.29 29894.48,-1080.74 29915.53,-1070.54 29933.69,-1059.99"/>
<polygon fill="black" stroke="black" points="29935.58,-1062.94 29942.37,-1054.8 29931.99,-1056.93 29935.58,-1062.94"/>
</g>
<!-- layer1_stage0_expert_59_gpu7 -->
<g id="node199" class="node">
<title>layer1_stage0_expert_59_gpu7</title>
<polygon fill="none" stroke="black" points="30312.72,-1054.79 30106.72,-1054.79 30106.72,-991.79 30312.72,-991.79 30312.72,-1054.79"/>
<text text-anchor="middle" x="30209.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_59_gpu7</text>
<text text-anchor="middle" x="30209.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 59</text>
<text text-anchor="middle" x="30209.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="30209.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="30209.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_59_gpu7 -->
<g id="edge273" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_59_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.71,-1183.84C25184.34,-1181.11 29806.89,-1163.93 30097.72,-1086.29 30118.48,-1080.74 30139.53,-1070.55 30157.7,-1060"/>
<polygon fill="black" stroke="black" points="30159.58,-1062.95 30166.37,-1054.81 30155.99,-1056.94 30159.58,-1062.95"/>
</g>
<!-- layer1_stage0_expert_60_gpu7 -->
<g id="node200" class="node">
<title>layer1_stage0_expert_60_gpu7</title>
<polygon fill="none" stroke="black" points="30536.72,-1054.79 30330.72,-1054.79 30330.72,-991.79 30536.72,-991.79 30536.72,-1054.79"/>
<text text-anchor="middle" x="30433.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_60_gpu7</text>
<text text-anchor="middle" x="30433.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 60</text>
<text text-anchor="middle" x="30433.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="30433.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="30433.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_60_gpu7 -->
<g id="edge274" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_60_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.7,-1183.95C25205.43,-1181.75 30019.44,-1166.89 30321.72,-1086.29 30342.48,-1080.75 30363.53,-1070.55 30381.7,-1060"/>
<polygon fill="black" stroke="black" points="30383.58,-1062.95 30390.37,-1054.82 30379.99,-1056.95 30383.58,-1062.95"/>
</g>
<!-- layer1_stage0_expert_61_gpu7 -->
<g id="node201" class="node">
<title>layer1_stage0_expert_61_gpu7</title>
<polygon fill="none" stroke="black" points="30760.72,-1054.79 30554.72,-1054.79 30554.72,-991.79 30760.72,-991.79 30760.72,-1054.79"/>
<text text-anchor="middle" x="30657.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_61_gpu7</text>
<text text-anchor="middle" x="30657.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 61</text>
<text text-anchor="middle" x="30657.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="30657.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="30657.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_61_gpu7 -->
<g id="edge275" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_61_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.74,-1184.05C25226.34,-1182.38 30231.99,-1169.86 30545.72,-1086.29 30566.48,-1080.76 30587.54,-1070.56 30605.7,-1060.01"/>
<polygon fill="black" stroke="black" points="30607.59,-1062.96 30614.37,-1054.82 30603.99,-1056.95 30607.59,-1062.96"/>
</g>
<!-- layer1_stage0_expert_62_gpu7 -->
<g id="node202" class="node">
<title>layer1_stage0_expert_62_gpu7</title>
<polygon fill="none" stroke="black" points="30984.72,-1054.79 30778.72,-1054.79 30778.72,-991.79 30984.72,-991.79 30984.72,-1054.79"/>
<text text-anchor="middle" x="30881.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_62_gpu7</text>
<text text-anchor="middle" x="30881.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 62</text>
<text text-anchor="middle" x="30881.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="30881.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="30881.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_62_gpu7 -->
<g id="edge276" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_62_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.87,-1184.14C25247.22,-1182.98 30444.53,-1172.82 30769.72,-1086.29 30790.48,-1080.76 30811.54,-1070.57 30829.7,-1060.02"/>
<polygon fill="black" stroke="black" points="30831.59,-1062.97 30838.37,-1054.83 30827.99,-1056.96 30831.59,-1062.97"/>
</g>
<!-- layer1_stage0_expert_63_gpu7 -->
<g id="node203" class="node">
<title>layer1_stage0_expert_63_gpu7</title>
<polygon fill="none" stroke="black" points="31208.72,-1054.79 31002.72,-1054.79 31002.72,-991.79 31208.72,-991.79 31208.72,-1054.79"/>
<text text-anchor="middle" x="31105.72" y="-1042.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_63_gpu7</text>
<text text-anchor="middle" x="31105.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="31105.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="31105.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="31105.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_gating&#45;&gt;layer1_stage0_expert_63_gpu7 -->
<g id="edge277" class="edge">
<title>layer1_stage0_gating&#45;&gt;layer1_stage0_expert_63_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24223.71,-1184.23C25266.75,-1183.56 30657.04,-1175.79 30993.72,-1086.29 31014.48,-1080.77 31035.54,-1070.57 31053.7,-1060.02"/>
<polygon fill="black" stroke="black" points="31055.59,-1062.97 31062.37,-1054.83 31052,-1056.97 31055.59,-1062.97"/>
</g>
<!-- layer1_stage0_expert_aggregate -->
<g id="node204" class="node">
<title>layer1_stage0_expert_aggregate</title>
<polygon fill="none" stroke="black" points="24291.34,-924.29 23906.97,-924.29 23808.09,-798.29 24192.47,-798.29 24291.34,-924.29"/>
<text text-anchor="middle" x="24049.72" y="-880.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_aggregate</text>
<text text-anchor="middle" x="24049.72" y="-869.79" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="24049.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="24049.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x16)</text>
<text text-anchor="middle" x="24049.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_expert_0_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge278" class="edge">
<title>layer1_stage0_expert_0_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M17037.06,-991.74C17057,-979.46 17081.55,-966.71 17105.72,-960.29 17189.4,-938.04 22719.56,-876.75 23849.44,-864.45"/>
<polygon fill="black" stroke="black" points="23849.74,-867.95 23859.7,-864.34 23849.66,-860.95 23849.74,-867.95"/>
</g>
<!-- layer1_stage0_expert_1_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge279" class="edge">
<title>layer1_stage0_expert_1_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M17261.06,-991.74C17281,-979.47 17305.56,-966.72 17329.72,-960.29 17491.2,-917.31 22747.68,-872.75 23848.72,-863.88"/>
<polygon fill="black" stroke="black" points="23849.14,-867.37 23859.11,-863.79 23849.08,-860.37 23849.14,-867.37"/>
</g>
<!-- layer1_stage0_expert_2_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge280" class="edge">
<title>layer1_stage0_expert_2_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M17485.07,-991.75C17505,-979.47 17529.56,-966.72 17553.72,-960.29 17709.51,-918.79 22771.76,-873.22 23849.3,-863.98"/>
<polygon fill="black" stroke="black" points="23849.5,-867.47 23859.47,-863.89 23849.44,-860.47 23849.5,-867.47"/>
</g>
<!-- layer1_stage0_expert_3_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge281" class="edge">
<title>layer1_stage0_expert_3_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M17709.07,-991.76C17729,-979.48 17753.56,-966.73 17777.72,-960.29 18077.28,-880.4 22807.83,-865.09 23848.34,-862.68"/>
<polygon fill="black" stroke="black" points="23848.55,-866.18 23858.55,-862.66 23848.54,-859.18 23848.55,-866.18"/>
</g>
<!-- layer1_stage0_expert_4_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge282" class="edge">
<title>layer1_stage0_expert_4_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M17933.07,-991.76C17953.01,-979.49 17977.56,-966.74 18001.72,-960.29 18289.85,-883.36 22829.88,-865.79 23848.11,-862.81"/>
<polygon fill="black" stroke="black" points="23848.47,-866.31 23858.46,-862.78 23848.45,-859.31 23848.47,-866.31"/>
</g>
<!-- layer1_stage0_expert_5_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge283" class="edge">
<title>layer1_stage0_expert_5_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M18157.07,-991.77C18177.01,-979.5 18201.56,-966.74 18225.72,-960.29 18502.51,-886.3 22854.7,-866.5 23848.66,-862.94"/>
<polygon fill="black" stroke="black" points="23848.78,-866.44 23858.77,-862.9 23848.76,-859.44 23848.78,-866.44"/>
</g>
<!-- layer1_stage0_expert_6_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge284" class="edge">
<title>layer1_stage0_expert_6_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M18381.07,-991.78C18401.01,-979.51 18425.57,-966.75 18449.72,-960.29 18715.12,-889.25 22877.81,-867.25 23848.49,-863.08"/>
<polygon fill="black" stroke="black" points="23848.73,-866.58 23858.71,-863.04 23848.7,-859.58 23848.73,-866.58"/>
</g>
<!-- layer1_stage0_expert_7_gpu0&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge285" class="edge">
<title>layer1_stage0_expert_7_gpu0&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M18605.07,-991.79C18625.01,-979.52 18649.57,-966.76 18673.72,-960.29 18927.75,-892.19 22901.72,-868.04 23848.42,-863.23"/>
<polygon fill="black" stroke="black" points="23848.75,-866.73 23858.73,-863.18 23848.71,-859.73 23848.75,-866.73"/>
</g>
<!-- layer1_stage0_expert_8_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge286" class="edge">
<title>layer1_stage0_expert_8_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M18829.34,-991.63C18849.23,-979.41 18873.68,-966.74 18897.72,-960.29 19140.44,-895.12 22927.48,-868.84 23848.83,-863.4"/>
<polygon fill="black" stroke="black" points="23848.9,-866.9 23858.88,-863.34 23848.86,-859.9 23848.9,-866.9"/>
</g>
<!-- layer1_stage0_expert_9_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge287" class="edge">
<title>layer1_stage0_expert_9_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M19053.35,-991.64C19073.24,-979.43 19097.68,-966.75 19121.72,-960.29 19353.12,-898.05 22953.34,-869.69 23849.1,-863.58"/>
<polygon fill="black" stroke="black" points="23849.22,-867.08 23859.19,-863.51 23849.17,-860.08 23849.22,-867.08"/>
</g>
<!-- layer1_stage0_expert_10_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge288" class="edge">
<title>layer1_stage0_expert_10_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M19277.35,-991.65C19297.24,-979.44 19321.68,-966.76 19345.72,-960.29 19565.82,-900.98 22979.44,-870.58 23849.26,-863.78"/>
<polygon fill="black" stroke="black" points="23849.4,-867.27 23859.37,-863.7 23849.35,-860.28 23849.4,-867.27"/>
</g>
<!-- layer1_stage0_expert_11_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge289" class="edge">
<title>layer1_stage0_expert_11_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M19501.35,-991.66C19521.25,-979.45 19545.69,-966.78 19569.72,-960.29 19778.53,-903.9 23006.08,-871.52 23849.39,-863.99"/>
<polygon fill="black" stroke="black" points="23849.54,-867.49 23859.5,-863.9 23849.47,-860.49 23849.54,-867.49"/>
</g>
<!-- layer1_stage0_expert_12_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge290" class="edge">
<title>layer1_stage0_expert_12_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M19725.36,-991.68C19745.25,-979.47 19769.69,-966.79 19793.72,-960.29 19991.26,-906.83 23033.52,-872.51 23849.58,-864.23"/>
<polygon fill="black" stroke="black" points="23849.71,-867.73 23859.67,-864.13 23849.63,-860.73 23849.71,-867.73"/>
</g>
<!-- layer1_stage0_expert_13_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge291" class="edge">
<title>layer1_stage0_expert_13_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M19949.36,-991.69C19969.25,-979.49 19993.69,-966.8 20017.72,-960.29 20204,-909.75 23061.24,-873.56 23849.6,-864.5"/>
<polygon fill="black" stroke="black" points="23849.68,-868 23859.64,-864.38 23849.6,-861 23849.68,-868"/>
</g>
<!-- layer1_stage0_expert_14_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge292" class="edge">
<title>layer1_stage0_expert_14_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M20173.36,-991.71C20193.26,-979.51 20217.7,-966.82 20241.72,-960.29 20589.77,-865.59 23110.31,-861.12 23847.64,-861.87"/>
<polygon fill="black" stroke="black" points="23847.83,-865.37 23857.83,-861.88 23847.83,-858.37 23847.83,-865.37"/>
</g>
<!-- layer1_stage0_expert_15_gpu1&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge293" class="edge">
<title>layer1_stage0_expert_15_gpu1&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M20397.37,-991.73C20417.27,-979.53 20441.7,-966.84 20465.72,-960.29 20791.47,-871.37 23140.01,-862.78 23848.14,-862.23"/>
<polygon fill="black" stroke="black" points="23848.19,-865.73 23858.19,-862.22 23848.18,-858.73 23848.19,-865.73"/>
</g>
<!-- layer1_stage0_expert_16_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge294" class="edge">
<title>layer1_stage0_expert_16_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M20621.37,-991.75C20641.27,-979.55 20665.71,-966.86 20689.72,-960.29 20993.15,-877.17 23169.43,-864.54 23848.12,-862.63"/>
<polygon fill="black" stroke="black" points="23848.5,-866.13 23858.49,-862.6 23848.48,-859.13 23848.5,-866.13"/>
</g>
<!-- layer1_stage0_expert_17_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge295" class="edge">
<title>layer1_stage0_expert_17_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M20845.38,-991.77C20865.28,-979.58 20889.72,-966.89 20913.72,-960.29 21194.91,-882.95 23200.25,-866.42 23848.29,-863.09"/>
<polygon fill="black" stroke="black" points="23848.69,-866.58 23858.67,-863.03 23848.65,-859.58 23848.69,-866.58"/>
</g>
<!-- layer1_stage0_expert_18_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge296" class="edge">
<title>layer1_stage0_expert_18_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M21069.66,-991.63C21089.51,-979.5 21113.83,-966.89 21137.72,-960.29 21396.8,-888.69 23233.06,-868.43 23848.92,-863.61"/>
<polygon fill="black" stroke="black" points="23849.27,-867.11 23859.24,-863.53 23849.21,-860.11 23849.27,-867.11"/>
</g>
<!-- layer1_stage0_expert_19_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge297" class="edge">
<title>layer1_stage0_expert_19_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M21293.66,-991.67C21313.52,-979.54 21337.84,-966.92 21361.72,-960.29 21598.75,-894.43 23266.89,-870.59 23849.49,-864.22"/>
<polygon fill="black" stroke="black" points="23849.71,-867.72 23859.67,-864.11 23849.64,-860.72 23849.71,-867.72"/>
</g>
<!-- layer1_stage0_expert_20_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge298" class="edge">
<title>layer1_stage0_expert_20_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M21517.67,-991.7C21537.53,-979.58 21561.85,-966.96 21585.72,-960.29 21800.74,-900.16 23301.43,-872.95 23849.73,-864.94"/>
<polygon fill="black" stroke="black" points="23850.18,-868.43 23860.12,-864.79 23850.07,-861.43 23850.18,-868.43"/>
</g>
<!-- layer1_stage0_expert_21_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge299" class="edge">
<title>layer1_stage0_expert_21_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M21741.69,-991.75C21761.54,-979.64 21785.87,-967.01 21809.72,-960.29 22002.91,-905.85 23338.86,-875.52 23850.74,-865.78"/>
<polygon fill="black" stroke="black" points="23850.89,-869.28 23860.82,-865.59 23850.76,-862.28 23850.89,-869.28"/>
</g>
<!-- layer1_stage0_expert_22_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge300" class="edge">
<title>layer1_stage0_expert_22_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M21965.97,-991.64C21985.78,-979.59 22009.99,-967.03 22033.72,-960.29 22205.13,-911.54 23377.09,-878.38 23851.24,-866.82"/>
<polygon fill="black" stroke="black" points="23851.36,-870.32 23861.28,-866.58 23851.19,-863.32 23851.36,-870.32"/>
</g>
<!-- layer1_stage0_expert_23_gpu2&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge301" class="edge">
<title>layer1_stage0_expert_23_gpu2&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M22189.99,-991.71C22209.8,-979.67 22234.01,-967.11 22257.72,-960.29 22550.86,-875.96 23443.87,-863.3 23847.66,-862.01"/>
<polygon fill="black" stroke="black" points="23847.71,-865.51 23857.7,-861.98 23847.69,-858.51 23847.71,-865.51"/>
</g>
<!-- layer1_stage0_expert_24_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge302" class="edge">
<title>layer1_stage0_expert_24_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M22414.28,-991.64C22434.05,-979.66 22458.14,-967.17 22481.72,-960.29 22732.44,-887.1 23485.61,-868.57 23849.12,-863.88"/>
<polygon fill="black" stroke="black" points="23849.27,-867.38 23859.22,-863.75 23849.18,-860.38 23849.27,-867.38"/>
</g>
<!-- layer1_stage0_expert_25_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge303" class="edge">
<title>layer1_stage0_expert_25_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M22638.32,-991.76C22658.09,-979.8 22682.18,-967.29 22705.72,-960.29 22914.45,-898.18 23530.35,-874.58 23850.84,-866.32"/>
<polygon fill="black" stroke="black" points="23851.27,-869.81 23861.18,-866.06 23851.09,-862.81 23851.27,-869.81"/>
</g>
<!-- layer1_stage0_expert_26_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge304" class="edge">
<title>layer1_stage0_expert_26_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M22862.64,-991.76C22882.37,-979.88 22906.34,-967.43 22929.72,-960.29 23097.11,-909.16 23579.66,-881.57 23853.63,-869.63"/>
<polygon fill="black" stroke="black" points="23853.85,-873.13 23863.69,-869.2 23853.55,-866.13 23853.85,-873.13"/>
</g>
<!-- layer1_stage0_expert_27_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge305" class="edge">
<title>layer1_stage0_expert_27_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M23087.25,-991.68C23106.9,-979.94 23130.63,-967.61 23153.72,-960.29 23280.42,-920.08 23633.55,-890.08 23856.79,-874.45"/>
<polygon fill="black" stroke="black" points="23857.26,-877.92 23866.99,-873.73 23856.77,-870.94 23857.26,-877.92"/>
</g>
<!-- layer1_stage0_expert_28_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge306" class="edge">
<title>layer1_stage0_expert_28_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M23311.93,-991.77C23331.49,-980.19 23354.97,-967.96 23377.72,-960.29 23533.31,-907.83 23718.49,-883.44 23855.01,-872.11"/>
<polygon fill="black" stroke="black" points="23855.49,-875.58 23865.17,-871.28 23854.92,-868.61 23855.49,-875.58"/>
</g>
<!-- layer1_stage0_expert_29_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge307" class="edge">
<title>layer1_stage0_expert_29_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M23537.58,-991.77C23556.9,-980.54 23579.78,-968.56 23601.72,-960.29 23686.82,-928.21 23785.18,-905.24 23868.01,-889.65"/>
<polygon fill="black" stroke="black" points="23868.84,-893.05 23878.03,-887.78 23867.56,-886.17 23868.84,-893.05"/>
</g>
<!-- layer1_stage0_expert_30_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge308" class="edge">
<title>layer1_stage0_expert_30_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M23766.45,-991.77C23784.99,-981.4 23806.09,-969.99 23825.72,-960.29 23848.41,-949.07 23872.69,-937.76 23896.57,-927.02"/>
<polygon fill="black" stroke="black" points="23898.01,-930.21 23905.71,-922.92 23895.15,-923.82 23898.01,-930.21"/>
</g>
<!-- layer1_stage0_expert_31_gpu3&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge309" class="edge">
<title>layer1_stage0_expert_31_gpu3&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M23959.31,-991.44C23970.99,-974.76 23985.92,-953.42 24000.28,-932.92"/>
<polygon fill="black" stroke="black" points="24003.3,-934.7 24006.17,-924.5 23997.56,-930.69 24003.3,-934.7"/>
</g>
<!-- layer1_stage0_expert_32_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge310" class="edge">
<title>layer1_stage0_expert_32_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M24140.12,-991.44C24128.45,-974.76 24113.51,-953.42 24099.16,-932.92"/>
<polygon fill="black" stroke="black" points="24101.87,-930.69 24093.27,-924.5 24096.14,-934.7 24101.87,-930.69"/>
</g>
<!-- layer1_stage0_expert_33_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge311" class="edge">
<title>layer1_stage0_expert_33_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M24332.99,-991.77C24314.45,-981.4 24293.34,-969.99 24273.72,-960.29 24252.14,-949.63 24229.14,-938.88 24206.4,-928.61"/>
<polygon fill="black" stroke="black" points="24207.58,-925.3 24197.02,-924.39 24204.71,-931.69 24207.58,-925.3"/>
</g>
<!-- layer1_stage0_expert_34_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge312" class="edge">
<title>layer1_stage0_expert_34_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M24561.85,-991.77C24542.54,-980.54 24519.66,-968.56 24497.72,-960.29 24428.79,-934.3 24351.16,-914.3 24280.13,-899.35"/>
<polygon fill="black" stroke="black" points="24280.66,-895.89 24270.16,-897.27 24279.23,-902.74 24280.66,-895.89"/>
</g>
<!-- layer1_stage0_expert_35_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge313" class="edge">
<title>layer1_stage0_expert_35_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M24787.51,-991.77C24767.95,-980.19 24744.46,-967.96 24721.72,-960.29 24572.4,-909.94 24395.82,-885.45 24261.15,-873.54"/>
<polygon fill="black" stroke="black" points="24261.39,-870.05 24251.12,-872.67 24260.78,-877.03 24261.39,-870.05"/>
</g>
<!-- layer1_stage0_expert_36_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge314" class="edge">
<title>layer1_stage0_expert_36_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M25012.18,-991.68C24992.54,-979.94 24968.81,-967.61 24945.72,-960.29 24822.83,-921.29 24486.92,-891.89 24263.13,-875.89"/>
<polygon fill="black" stroke="black" points="24263.11,-872.38 24252.89,-875.17 24262.62,-879.37 24263.11,-872.38"/>
</g>
<!-- layer1_stage0_expert_37_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge315" class="edge">
<title>layer1_stage0_expert_37_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M25236.8,-991.76C25217.07,-979.88 25193.1,-967.43 25169.72,-960.29 25004.97,-909.97 24534.98,-882.45 24258.98,-870.21"/>
<polygon fill="black" stroke="black" points="24258.98,-866.71 24248.83,-869.76 24258.67,-873.7 24258.98,-866.71"/>
</g>
<!-- layer1_stage0_expert_38_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge316" class="edge">
<title>layer1_stage0_expert_38_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M25461.12,-991.76C25441.34,-979.8 25417.26,-967.29 25393.72,-960.29 25186.65,-898.68 24578.88,-874.96 24256.31,-866.52"/>
<polygon fill="black" stroke="black" points="24255.99,-863.01 24245.91,-866.25 24255.81,-870.01 24255.99,-863.01"/>
</g>
<!-- layer1_stage0_expert_39_gpu4&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge317" class="edge">
<title>layer1_stage0_expert_39_gpu4&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M25685.15,-991.64C25665.38,-979.66 25641.29,-967.17 25617.72,-960.29 25367.88,-887.36 24619.18,-868.7 24254.21,-863.93"/>
<polygon fill="black" stroke="black" points="24254.11,-860.43 24244.06,-863.8 24254.02,-867.43 24254.11,-860.43"/>
</g>
<!-- layer1_stage0_expert_40_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge318" class="edge">
<title>layer1_stage0_expert_40_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M25909.45,-991.71C25889.63,-979.67 25865.43,-967.11 25841.72,-960.29 25548.76,-876.01 24656.7,-863.31 24252.54,-862.01"/>
<polygon fill="black" stroke="black" points="24252.51,-858.51 24242.5,-861.98 24252.49,-865.51 24252.51,-858.51"/>
</g>
<!-- layer1_stage0_expert_41_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge319" class="edge">
<title>layer1_stage0_expert_41_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M26133.46,-991.64C26113.65,-979.59 26089.45,-967.03 26065.72,-960.29 25895.3,-911.82 24735.9,-878.77 24256.51,-867.02"/>
<polygon fill="black" stroke="black" points="24256.44,-863.52 24246.36,-866.78 24256.27,-870.52 24256.44,-863.52"/>
</g>
<!-- layer1_stage0_expert_42_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge320" class="edge">
<title>layer1_stage0_expert_42_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M26357.75,-991.75C26337.89,-979.64 26313.57,-967.01 26289.72,-960.29 26097.39,-906.09 24772.62,-875.79 24255.68,-865.92"/>
<polygon fill="black" stroke="black" points="24255.56,-862.41 24245.49,-865.72 24255.42,-869.41 24255.56,-862.41"/>
</g>
<!-- layer1_stage0_expert_43_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge321" class="edge">
<title>layer1_stage0_expert_43_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M26581.76,-991.7C26561.91,-979.58 26537.58,-966.96 26513.72,-960.29 26299.41,-900.36 24807.98,-873.13 24255.21,-865.02"/>
<polygon fill="black" stroke="black" points="24255.18,-861.52 24245.13,-864.87 24255.08,-868.52 24255.18,-861.52"/>
</g>
<!-- layer1_stage0_expert_44_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge322" class="edge">
<title>layer1_stage0_expert_44_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M26805.77,-991.67C26785.92,-979.54 26761.59,-966.92 26737.72,-960.29 26501.31,-894.6 24841.39,-870.72 24254.61,-864.27"/>
<polygon fill="black" stroke="black" points="24254.38,-860.77 24244.35,-864.16 24254.31,-867.77 24254.38,-860.77"/>
</g>
<!-- layer1_stage0_expert_45_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge323" class="edge">
<title>layer1_stage0_expert_45_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M27029.78,-991.63C27009.93,-979.5 26985.6,-966.89 26961.72,-960.29 26703.17,-888.84 24873.89,-868.51 24254.31,-863.64"/>
<polygon fill="black" stroke="black" points="24253.96,-860.14 24243.93,-863.56 24253.9,-867.14 24253.96,-860.14"/>
</g>
<!-- layer1_stage0_expert_46_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge324" class="edge">
<title>layer1_stage0_expert_46_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M27254.05,-991.77C27234.16,-979.58 27209.72,-966.89 27185.72,-960.29 26904.94,-883.06 24905.01,-866.47 24253.97,-863.1"/>
<polygon fill="black" stroke="black" points="24253.56,-859.6 24243.54,-863.05 24253.53,-866.6 24253.56,-859.6"/>
</g>
<!-- layer1_stage0_expert_47_gpu5&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge325" class="edge">
<title>layer1_stage0_expert_47_gpu5&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M27478.06,-991.75C27458.16,-979.55 27433.73,-966.86 27409.72,-960.29 27106.56,-877.24 24933.86,-864.57 24253.12,-862.63"/>
<polygon fill="black" stroke="black" points="24252.97,-859.13 24242.96,-862.6 24252.95,-866.13 24252.97,-859.13"/>
</g>
<!-- layer1_stage0_expert_48_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge326" class="edge">
<title>layer1_stage0_expert_48_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M27702.07,-991.73C27682.17,-979.53 27657.73,-966.84 27633.72,-960.29 27308.2,-871.44 24962.79,-862.79 24252.82,-862.23"/>
<polygon fill="black" stroke="black" points="24252.75,-858.73 24242.75,-862.22 24252.74,-865.73 24252.75,-858.73"/>
</g>
<!-- layer1_stage0_expert_49_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge327" class="edge">
<title>layer1_stage0_expert_49_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M27926.07,-991.71C27906.18,-979.51 27881.74,-966.82 27857.72,-960.29 27509.81,-865.63 24991.28,-861.13 24252.75,-861.87"/>
<polygon fill="black" stroke="black" points="24252.53,-858.37 24242.54,-861.88 24252.54,-865.37 24252.53,-858.37"/>
</g>
<!-- layer1_stage0_expert_50_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge328" class="edge">
<title>layer1_stage0_expert_50_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M28150.08,-991.69C28130.18,-979.49 28105.74,-966.8 28081.72,-960.29 27895.81,-909.85 25049.47,-873.7 24254.53,-864.55"/>
<polygon fill="black" stroke="black" points="24254.45,-861.05 24244.41,-864.44 24254.37,-868.05 24254.45,-861.05"/>
</g>
<!-- layer1_stage0_expert_51_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge329" class="edge">
<title>layer1_stage0_expert_51_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M28374.08,-991.68C28354.19,-979.47 28329.75,-966.79 28305.72,-960.29 28108.54,-906.92 25077.02,-872.63 24254.35,-864.28"/>
<polygon fill="black" stroke="black" points="24254.21,-860.78 24244.18,-864.17 24254.14,-867.78 24254.21,-860.78"/>
</g>
<!-- layer1_stage0_expert_52_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge330" class="edge">
<title>layer1_stage0_expert_52_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M28598.08,-991.66C28578.19,-979.45 28553.75,-966.78 28529.72,-960.29 28321.26,-904 25104.19,-871.63 24254.32,-864.03"/>
<polygon fill="black" stroke="black" points="24254.15,-860.53 24244.12,-863.94 24254.09,-867.53 24254.15,-860.53"/>
</g>
<!-- layer1_stage0_expert_53_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge331" class="edge">
<title>layer1_stage0_expert_53_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M28822.09,-991.65C28802.19,-979.44 28777.75,-966.76 28753.72,-960.29 28533.96,-901.07 25130.46,-870.68 24254.2,-863.81"/>
<polygon fill="black" stroke="black" points="24254.03,-860.31 24244,-863.73 24253.98,-867.31 24254.03,-860.31"/>
</g>
<!-- layer1_stage0_expert_54_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge332" class="edge">
<title>layer1_stage0_expert_54_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M29046.09,-991.64C29026.2,-979.43 29001.76,-966.75 28977.72,-960.29 28746.63,-898.14 25156.1,-869.77 24254.08,-863.6"/>
<polygon fill="black" stroke="black" points="24253.94,-860.1 24243.92,-863.53 24253.9,-867.1 24253.94,-860.1"/>
</g>
<!-- layer1_stage0_expert_55_gpu6&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge333" class="edge">
<title>layer1_stage0_expert_55_gpu6&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M29270.09,-991.63C29250.2,-979.41 29225.76,-966.74 29201.72,-960.29 28959.27,-895.19 25180.35,-868.9 24253.68,-863.42"/>
<polygon fill="black" stroke="black" points="24253.6,-859.92 24243.57,-863.36 24253.55,-866.92 24253.6,-859.92"/>
</g>
<!-- layer1_stage0_expert_56_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge334" class="edge">
<title>layer1_stage0_expert_56_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M29494.36,-991.79C29474.42,-979.52 29449.87,-966.76 29425.72,-960.29 29171.9,-892.25 25204.43,-868.08 24253.43,-863.25"/>
<polygon fill="black" stroke="black" points="24253.42,-859.75 24243.4,-863.2 24253.39,-866.75 24253.42,-859.75"/>
</g>
<!-- layer1_stage0_expert_57_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge335" class="edge">
<title>layer1_stage0_expert_57_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M29718.36,-991.78C29698.42,-979.51 29673.87,-966.75 29649.72,-960.29 29384.57,-889.31 25229.65,-867.3 24253.77,-863.09"/>
<polygon fill="black" stroke="black" points="24253.5,-859.59 24243.49,-863.05 24253.47,-866.59 24253.5,-859.59"/>
</g>
<!-- layer1_stage0_expert_58_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge336" class="edge">
<title>layer1_stage0_expert_58_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M29942.37,-991.77C29922.43,-979.5 29897.87,-966.74 29873.72,-960.29 29597.19,-886.37 25253.1,-866.54 24253.65,-862.95"/>
<polygon fill="black" stroke="black" points="24253.5,-859.45 24243.49,-862.91 24253.47,-866.45 24253.5,-859.45"/>
</g>
<!-- layer1_stage0_expert_59_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge337" class="edge">
<title>layer1_stage0_expert_59_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M30166.37,-991.76C30146.43,-979.49 30121.87,-966.74 30097.72,-960.29 29809.79,-883.42 25275.91,-865.81 24253.47,-862.81"/>
<polygon fill="black" stroke="black" points="24253.46,-859.31 24243.45,-862.78 24253.44,-866.31 24253.46,-859.31"/>
</g>
<!-- layer1_stage0_expert_60_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge338" class="edge">
<title>layer1_stage0_expert_60_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M30390.37,-991.76C30370.43,-979.48 30345.88,-966.73 30321.72,-960.29 30022.41,-880.47 25299.37,-865.12 24253.66,-862.69"/>
<polygon fill="black" stroke="black" points="24253.42,-859.19 24243.41,-862.67 24253.4,-866.19 24253.42,-859.19"/>
</g>
<!-- layer1_stage0_expert_61_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge339" class="edge">
<title>layer1_stage0_expert_61_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M30614.37,-991.75C30594.43,-979.47 30569.88,-966.72 30545.72,-960.29 30234.94,-877.5 25320,-864.44 24253.05,-862.57"/>
<polygon fill="black" stroke="black" points="24252.98,-859.07 24242.98,-862.56 24252.97,-866.07 24252.98,-859.07"/>
</g>
<!-- layer1_stage0_expert_62_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge340" class="edge">
<title>layer1_stage0_expert_62_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M30838.37,-991.74C30818.44,-979.47 30793.88,-966.72 30769.72,-960.29 30447.54,-874.55 25342.95,-863.79 24253.33,-862.47"/>
<polygon fill="black" stroke="black" points="24253.05,-858.97 24243.05,-862.46 24253.04,-865.97 24253.05,-858.97"/>
</g>
<!-- layer1_stage0_expert_63_gpu7&#45;&gt;layer1_stage0_expert_aggregate -->
<g id="edge341" class="edge">
<title>layer1_stage0_expert_63_gpu7&#45;&gt;layer1_stage0_expert_aggregate</title>
<path fill="none" stroke="black" d="M31062.37,-991.74C31042.44,-979.46 31017.88,-966.71 30993.72,-960.29 30660.06,-871.58 25363.17,-863.16 24252.86,-862.37"/>
<polygon fill="black" stroke="black" points="24252.78,-858.87 24242.78,-862.36 24252.78,-865.87 24252.78,-858.87"/>
</g>
<!-- layer1_stage0_expert_residual -->
<g id="node205" class="node">
<title>layer1_stage0_expert_residual</title>
<ellipse fill="none" stroke="black" cx="31450.72" cy="-1185.29" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="31450.72" y="-1204.79" font-family="Arial" font-size="10.00">layer1_stage0_expert_residual</text>
<text text-anchor="middle" x="31450.72" y="-1193.79" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="31450.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="31450.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="31450.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- pipeline_comm_0_to_1 -->
<g id="node206" class="node">
<title>pipeline_comm_0_to_1</title>
<polygon fill="none" stroke="black" points="31674.6,-1086.29 31318.46,-1086.29 31226.84,-960.29 31582.98,-960.29 31674.6,-1086.29"/>
<text text-anchor="middle" x="31450.72" y="-1042.79" font-family="Arial" font-size="10.00">pipeline_comm_0_to_1</text>
<text text-anchor="middle" x="31450.72" y="-1031.79" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="31450.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 7&#45;8</text>
<text text-anchor="middle" x="31450.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192</text>
<text text-anchor="middle" x="31450.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer1_stage0_expert_residual&#45;&gt;pipeline_comm_0_to_1 -->
<g id="edge343" class="edge">
<title>layer1_stage0_expert_residual&#45;&gt;pipeline_comm_0_to_1</title>
<path fill="none" stroke="black" d="M31450.72,-1140.57C31450.72,-1127.03 31450.72,-1111.75 31450.72,-1096.81"/>
<polygon fill="black" stroke="black" points="31454.22,-1096.55 31450.72,-1086.55 31447.22,-1096.55 31454.22,-1096.55"/>
</g>
<!-- layer2_stage1_input_reshape -->
<g id="node207" class="node">
<title>layer2_stage1_input_reshape</title>
<ellipse fill="none" stroke="black" cx="31450.72" cy="-861.29" rx="183.7" ry="44.6"/>
<text text-anchor="middle" x="31450.72" y="-880.79" font-family="Arial" font-size="10.00">layer2_stage1_input_reshape</text>
<text text-anchor="middle" x="31450.72" y="-869.79" font-family="Arial" font-size="10.00">Input Reshape</text>
<text text-anchor="middle" x="31450.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="31450.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
<text text-anchor="middle" x="31450.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- pipeline_comm_0_to_1&#45;&gt;layer2_stage1_input_reshape -->
<g id="edge514" class="edge">
<title>pipeline_comm_0_to_1&#45;&gt;layer2_stage1_input_reshape</title>
<path fill="none" stroke="black" d="M31450.72,-959.97C31450.72,-945.42 31450.72,-930.06 31450.72,-915.93"/>
<polygon fill="black" stroke="black" points="31454.22,-915.88 31450.72,-905.88 31447.22,-915.88 31454.22,-915.88"/>
</g>
<!-- layer2_stage1_qkv_proj_0 -->
<g id="node208" class="node">
<title>layer2_stage1_qkv_proj_0</title>
<polygon fill="none" stroke="black" points="29968.72,-749.24 29716.72,-749.24 29716.72,-686.24 29968.72,-686.24 29968.72,-749.24"/>
<text text-anchor="middle" x="29842.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_0</text>
<text text-anchor="middle" x="29842.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;0)</text>
<text text-anchor="middle" x="29842.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="29842.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="29842.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_0 -->
<g id="edge344" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_0</title>
<path fill="none" stroke="black" d="M31275.3,-847.95C31038.16,-830.86 30602.18,-798.04 30230.72,-762.29 30147.11,-754.24 30053.52,-743.78 29979.22,-735.13"/>
<polygon fill="black" stroke="black" points="29979.2,-731.6 29968.86,-733.92 29978.39,-738.55 29979.2,-731.6"/>
</g>
<!-- layer2_stage1_qkv_proj_1 -->
<g id="node209" class="node">
<title>layer2_stage1_qkv_proj_1</title>
<polygon fill="none" stroke="black" points="30491.72,-749.24 30239.72,-749.24 30239.72,-686.24 30491.72,-686.24 30491.72,-749.24"/>
<text text-anchor="middle" x="30365.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_1</text>
<text text-anchor="middle" x="30365.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;1)</text>
<text text-anchor="middle" x="30365.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="30365.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="30365.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_1 -->
<g id="edge345" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_1</title>
<path fill="none" stroke="black" d="M31283.34,-842.65C31116.84,-824.56 30854.21,-794.58 30627.72,-762.29 30586.71,-756.44 30542.21,-749.33 30501.73,-742.57"/>
<polygon fill="black" stroke="black" points="30502.24,-739.11 30491.8,-740.91 30501.09,-746.01 30502.24,-739.11"/>
</g>
<!-- layer2_stage1_qkv_proj_2 -->
<g id="node210" class="node">
<title>layer2_stage1_qkv_proj_2</title>
<polygon fill="none" stroke="black" points="30888.72,-749.24 30636.72,-749.24 30636.72,-686.24 30888.72,-686.24 30888.72,-749.24"/>
<text text-anchor="middle" x="30762.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_2</text>
<text text-anchor="middle" x="30762.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;2)</text>
<text text-anchor="middle" x="30762.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="30762.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="30762.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_2 -->
<g id="edge346" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_2</title>
<path fill="none" stroke="black" d="M31309.32,-832.75C31211.36,-813.49 31077.99,-786.91 30960.72,-762.29 30940.65,-758.07 30919.45,-753.52 30898.69,-749"/>
<polygon fill="black" stroke="black" points="30899.38,-745.57 30888.86,-746.86 30897.89,-752.41 30899.38,-745.57"/>
</g>
<!-- layer2_stage1_qkv_proj_3 -->
<g id="node211" class="node">
<title>layer2_stage1_qkv_proj_3</title>
<polygon fill="none" stroke="black" points="31221.72,-749.24 30969.72,-749.24 30969.72,-686.24 31221.72,-686.24 31221.72,-749.24"/>
<text text-anchor="middle" x="31095.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_3</text>
<text text-anchor="middle" x="31095.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;3)</text>
<text text-anchor="middle" x="31095.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="31095.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="31095.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_3 -->
<g id="edge347" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_3</title>
<path fill="none" stroke="black" d="M31356.98,-822.91C31302.62,-801.24 31234.67,-774.14 31181.69,-753.02"/>
<polygon fill="black" stroke="black" points="31182.9,-749.73 31172.31,-749.28 31180.31,-756.23 31182.9,-749.73"/>
</g>
<!-- layer2_stage1_qkv_proj_4 -->
<g id="node212" class="node">
<title>layer2_stage1_qkv_proj_4</title>
<polygon fill="none" stroke="black" points="31576.72,-749.24 31324.72,-749.24 31324.72,-686.24 31576.72,-686.24 31576.72,-749.24"/>
<text text-anchor="middle" x="31450.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_4</text>
<text text-anchor="middle" x="31450.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;4)</text>
<text text-anchor="middle" x="31450.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="31450.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="31450.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_4 -->
<g id="edge348" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_4</title>
<path fill="none" stroke="black" d="M31450.72,-816.66C31450.72,-798.46 31450.72,-777.44 31450.72,-759.55"/>
<polygon fill="black" stroke="black" points="31454.22,-759.43 31450.72,-749.43 31447.22,-759.43 31454.22,-759.43"/>
</g>
<!-- layer2_stage1_qkv_proj_5 -->
<g id="node213" class="node">
<title>layer2_stage1_qkv_proj_5</title>
<polygon fill="none" stroke="black" points="31931.72,-749.24 31679.72,-749.24 31679.72,-686.24 31931.72,-686.24 31931.72,-749.24"/>
<text text-anchor="middle" x="31805.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_5</text>
<text text-anchor="middle" x="31805.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;5)</text>
<text text-anchor="middle" x="31805.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="31805.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="31805.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_5 -->
<g id="edge349" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_5</title>
<path fill="none" stroke="black" d="M31544.45,-822.91C31598.81,-801.24 31666.77,-774.14 31719.75,-753.02"/>
<polygon fill="black" stroke="black" points="31721.13,-756.23 31729.12,-749.28 31718.54,-749.73 31721.13,-756.23"/>
</g>
<!-- layer2_stage1_qkv_proj_6 -->
<g id="node214" class="node">
<title>layer2_stage1_qkv_proj_6</title>
<polygon fill="none" stroke="black" points="32328.72,-749.24 32076.72,-749.24 32076.72,-686.24 32328.72,-686.24 32328.72,-749.24"/>
<text text-anchor="middle" x="32202.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_6</text>
<text text-anchor="middle" x="32202.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;6)</text>
<text text-anchor="middle" x="32202.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="32202.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="32202.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_6 -->
<g id="edge350" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_6</title>
<path fill="none" stroke="black" d="M31593.93,-833.33C31729.98,-807.72 31933.07,-769.49 32066.7,-744.34"/>
<polygon fill="black" stroke="black" points="32067.42,-747.77 32076.6,-742.48 32066.12,-740.89 32067.42,-747.77"/>
</g>
<!-- layer2_stage1_qkv_proj_7 -->
<g id="node215" class="node">
<title>layer2_stage1_qkv_proj_7</title>
<polygon fill="none" stroke="black" points="32746.72,-749.24 32494.72,-749.24 32494.72,-686.24 32746.72,-686.24 32746.72,-749.24"/>
<text text-anchor="middle" x="32620.72" y="-737.24" font-family="Arial" font-size="10.00">layer2_stage1_qkv_proj_7</text>
<text text-anchor="middle" x="32620.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;7)</text>
<text text-anchor="middle" x="32620.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="32620.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="32620.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_7 -->
<g id="edge351" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_qkv_proj_7</title>
<path fill="none" stroke="black" d="M31619.78,-843.77C31798.45,-825.81 32088.32,-795.24 32337.72,-762.29 32385.58,-755.96 32437.86,-748.17 32484.32,-740.93"/>
<polygon fill="black" stroke="black" points="32485.11,-744.35 32494.45,-739.35 32484.02,-737.43 32485.11,-744.35"/>
</g>
<!-- layer2_stage1_attention_residual -->
<g id="node241" class="node">
<title>layer2_stage1_attention_residual</title>
<ellipse fill="none" stroke="black" cx="32228.72" cy="-44.55" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="32228.72" y="-64.05" font-family="Arial" font-size="10.00">layer2_stage1_attention_residual</text>
<text text-anchor="middle" x="32228.72" y="-53.05" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="32228.72" y="-42.05" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="32228.72" y="-31.05" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="32228.72" y="-20.05" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_input_reshape&#45;&gt;layer2_stage1_attention_residual -->
<g id="edge384" class="edge">
<title>layer2_stage1_input_reshape&#45;&gt;layer2_stage1_attention_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31633.42,-855.95C31941.42,-847.08 32550.48,-822.36 32755.72,-762.29 32884.7,-724.53 33006.72,-728.04 33006.72,-593.64 33006.72,-593.64 33006.72,-593.64 33006.72,-349.1 33006.72,-214.54 32597.71,-115.53 32372.81,-71.25"/>
<polygon fill="black" stroke="black" points="32373.39,-67.8 32362.9,-69.31 32372.05,-74.67 32373.39,-67.8"/>
</g>
<!-- layer2_stage1_qkv_reshape_0 -->
<g id="node216" class="node">
<title>layer2_stage1_qkv_reshape_0</title>
<ellipse fill="none" stroke="black" cx="29694.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="29694.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_0</text>
<text text-anchor="middle" x="29694.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;0)</text>
<text text-anchor="middle" x="29694.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="29694.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="29694.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_0&#45;&gt;layer2_stage1_qkv_reshape_0 -->
<g id="edge352" class="edge">
<title>layer2_stage1_qkv_proj_0&#45;&gt;layer2_stage1_qkv_reshape_0</title>
<path fill="none" stroke="black" d="M29805.75,-685.99C29790.01,-672.9 29771.26,-657.31 29753.69,-642.69"/>
<polygon fill="black" stroke="black" points="29755.64,-639.76 29745.71,-636.06 29751.16,-645.14 29755.64,-639.76"/>
</g>
<!-- layer2_stage1_qkv_reshape_1 -->
<g id="node217" class="node">
<title>layer2_stage1_qkv_reshape_1</title>
<ellipse fill="none" stroke="black" cx="30133.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="30133.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_1</text>
<text text-anchor="middle" x="30133.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;1)</text>
<text text-anchor="middle" x="30133.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="30133.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="30133.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_1&#45;&gt;layer2_stage1_qkv_reshape_1 -->
<g id="edge353" class="edge">
<title>layer2_stage1_qkv_proj_1&#45;&gt;layer2_stage1_qkv_reshape_1</title>
<path fill="none" stroke="black" d="M30308.07,-686.15C30281.32,-671.96 30248.96,-654.79 30219.42,-639.12"/>
<polygon fill="black" stroke="black" points="30220.83,-635.9 30210.35,-634.31 30217.55,-642.08 30220.83,-635.9"/>
</g>
<!-- layer2_stage1_qkv_reshape_2 -->
<g id="node218" class="node">
<title>layer2_stage1_qkv_reshape_2</title>
<ellipse fill="none" stroke="black" cx="30572.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="30572.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_2</text>
<text text-anchor="middle" x="30572.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;2)</text>
<text text-anchor="middle" x="30572.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="30572.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="30572.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_2&#45;&gt;layer2_stage1_qkv_reshape_2 -->
<g id="edge354" class="edge">
<title>layer2_stage1_qkv_proj_2&#45;&gt;layer2_stage1_qkv_reshape_2</title>
<path fill="none" stroke="black" d="M30715.26,-685.99C30694.12,-672.29 30668.74,-655.85 30645.29,-640.66"/>
<polygon fill="black" stroke="black" points="30647.05,-637.63 30636.75,-635.13 30643.24,-643.5 30647.05,-637.63"/>
</g>
<!-- layer2_stage1_qkv_reshape_3 -->
<g id="node219" class="node">
<title>layer2_stage1_qkv_reshape_3</title>
<ellipse fill="none" stroke="black" cx="31011.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="31011.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_3</text>
<text text-anchor="middle" x="31011.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;3)</text>
<text text-anchor="middle" x="31011.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="31011.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="31011.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_3&#45;&gt;layer2_stage1_qkv_reshape_3 -->
<g id="edge355" class="edge">
<title>layer2_stage1_qkv_proj_3&#45;&gt;layer2_stage1_qkv_reshape_3</title>
<path fill="none" stroke="black" d="M31074.74,-685.99C31066.37,-673.73 31056.5,-659.26 31047.08,-645.47"/>
<polygon fill="black" stroke="black" points="31049.82,-643.28 31041.3,-636.99 31044.04,-647.22 31049.82,-643.28"/>
</g>
<!-- layer2_stage1_qkv_reshape_4 -->
<g id="node220" class="node">
<title>layer2_stage1_qkv_reshape_4</title>
<ellipse fill="none" stroke="black" cx="31450.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="31450.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_4</text>
<text text-anchor="middle" x="31450.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;4)</text>
<text text-anchor="middle" x="31450.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="31450.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="31450.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_4&#45;&gt;layer2_stage1_qkv_reshape_4 -->
<g id="edge356" class="edge">
<title>layer2_stage1_qkv_proj_4&#45;&gt;layer2_stage1_qkv_reshape_4</title>
<path fill="none" stroke="black" d="M31450.72,-685.99C31450.72,-674.42 31450.72,-660.89 31450.72,-647.8"/>
<polygon fill="black" stroke="black" points="31454.22,-647.46 31450.72,-637.46 31447.22,-647.46 31454.22,-647.46"/>
</g>
<!-- layer2_stage1_qkv_reshape_5 -->
<g id="node221" class="node">
<title>layer2_stage1_qkv_reshape_5</title>
<ellipse fill="none" stroke="black" cx="31889.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="31889.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_5</text>
<text text-anchor="middle" x="31889.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;5)</text>
<text text-anchor="middle" x="31889.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="31889.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="31889.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_5&#45;&gt;layer2_stage1_qkv_reshape_5 -->
<g id="edge357" class="edge">
<title>layer2_stage1_qkv_proj_5&#45;&gt;layer2_stage1_qkv_reshape_5</title>
<path fill="none" stroke="black" d="M31826.7,-685.99C31835.07,-673.73 31844.94,-659.26 31854.35,-645.47"/>
<polygon fill="black" stroke="black" points="31857.39,-647.22 31860.14,-636.99 31851.61,-643.28 31857.39,-647.22"/>
</g>
<!-- layer2_stage1_qkv_reshape_6 -->
<g id="node222" class="node">
<title>layer2_stage1_qkv_reshape_6</title>
<ellipse fill="none" stroke="black" cx="32328.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="32328.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_6</text>
<text text-anchor="middle" x="32328.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;6)</text>
<text text-anchor="middle" x="32328.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="32328.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="32328.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_6&#45;&gt;layer2_stage1_qkv_reshape_6 -->
<g id="edge358" class="edge">
<title>layer2_stage1_qkv_proj_6&#45;&gt;layer2_stage1_qkv_reshape_6</title>
<path fill="none" stroke="black" d="M32234.19,-685.99C32247.22,-673.26 32262.68,-658.15 32277.29,-643.89"/>
<polygon fill="black" stroke="black" points="32280.12,-646.01 32284.83,-636.52 32275.23,-641.01 32280.12,-646.01"/>
</g>
<!-- layer2_stage1_qkv_reshape_7 -->
<g id="node223" class="node">
<title>layer2_stage1_qkv_reshape_7</title>
<ellipse fill="none" stroke="black" cx="32767.72" cy="-592.64" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="32767.72" y="-612.14" font-family="Arial" font-size="10.00">layer2_stage1_qkv_reshape_7</text>
<text text-anchor="middle" x="32767.72" y="-601.14" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;7)</text>
<text text-anchor="middle" x="32767.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="32767.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="32767.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_proj_7&#45;&gt;layer2_stage1_qkv_reshape_7 -->
<g id="edge359" class="edge">
<title>layer2_stage1_qkv_proj_7&#45;&gt;layer2_stage1_qkv_reshape_7</title>
<path fill="none" stroke="black" d="M32657.43,-685.99C32673.07,-672.9 32691.69,-657.31 32709.15,-642.69"/>
<polygon fill="black" stroke="black" points="32711.65,-645.16 32717.07,-636.06 32707.15,-639.79 32711.65,-645.16"/>
</g>
<!-- layer2_stage1_attention_0 -->
<g id="node224" class="node">
<title>layer2_stage1_attention_0</title>
<polygon fill="none" stroke="black" points="29919.72,-512.1 29621.72,-512.1 29621.72,-449.1 29919.72,-449.1 29919.72,-512.1"/>
<text text-anchor="middle" x="29770.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_0</text>
<text text-anchor="middle" x="29770.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;0)</text>
<text text-anchor="middle" x="29770.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="29770.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="29770.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_0&#45;&gt;layer2_stage1_attention_0 -->
<g id="edge360" class="edge">
<title>layer2_stage1_qkv_reshape_0&#45;&gt;layer2_stage1_attention_0</title>
<path fill="none" stroke="black" d="M29724.54,-548.47C29730.84,-539.34 29737.46,-529.76 29743.65,-520.79"/>
<polygon fill="black" stroke="black" points="29746.63,-522.63 29749.44,-512.41 29740.87,-518.65 29746.63,-522.63"/>
</g>
<!-- layer2_stage1_attention_1 -->
<g id="node225" class="node">
<title>layer2_stage1_attention_1</title>
<polygon fill="none" stroke="black" points="30296.72,-512.1 29998.72,-512.1 29998.72,-449.1 30296.72,-449.1 30296.72,-512.1"/>
<text text-anchor="middle" x="30147.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_1</text>
<text text-anchor="middle" x="30147.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;1)</text>
<text text-anchor="middle" x="30147.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="30147.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="30147.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_1&#45;&gt;layer2_stage1_attention_1 -->
<g id="edge361" class="edge">
<title>layer2_stage1_qkv_reshape_1&#45;&gt;layer2_stage1_attention_1</title>
<path fill="none" stroke="black" d="M30139.29,-547.83C30140.35,-539.49 30141.46,-530.78 30142.51,-522.53"/>
<polygon fill="black" stroke="black" points="30146.01,-522.75 30143.8,-512.39 30139.07,-521.86 30146.01,-522.75"/>
</g>
<!-- layer2_stage1_attention_2 -->
<g id="node226" class="node">
<title>layer2_stage1_attention_2</title>
<polygon fill="none" stroke="black" points="30782.72,-512.1 30484.72,-512.1 30484.72,-449.1 30782.72,-449.1 30782.72,-512.1"/>
<text text-anchor="middle" x="30633.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_2</text>
<text text-anchor="middle" x="30633.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;2)</text>
<text text-anchor="middle" x="30633.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="30633.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="30633.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_2&#45;&gt;layer2_stage1_attention_2 -->
<g id="edge362" class="edge">
<title>layer2_stage1_qkv_reshape_2&#45;&gt;layer2_stage1_attention_2</title>
<path fill="none" stroke="black" d="M30596.83,-548.15C30601.77,-539.23 30606.95,-529.89 30611.81,-521.12"/>
<polygon fill="black" stroke="black" points="30614.95,-522.67 30616.74,-512.23 30608.83,-519.28 30614.95,-522.67"/>
</g>
<!-- layer2_stage1_attention_3 -->
<g id="node227" class="node">
<title>layer2_stage1_attention_3</title>
<polygon fill="none" stroke="black" points="31211.72,-512.1 30913.72,-512.1 30913.72,-449.1 31211.72,-449.1 31211.72,-512.1"/>
<text text-anchor="middle" x="31062.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_3</text>
<text text-anchor="middle" x="31062.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;3)</text>
<text text-anchor="middle" x="31062.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="31062.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="31062.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_3&#45;&gt;layer2_stage1_attention_3 -->
<g id="edge363" class="edge">
<title>layer2_stage1_qkv_reshape_3&#45;&gt;layer2_stage1_attention_3</title>
<path fill="none" stroke="black" d="M31031.87,-548.15C31035.96,-539.33 31040.25,-530.09 31044.27,-521.4"/>
<polygon fill="black" stroke="black" points="31047.49,-522.78 31048.52,-512.23 31041.14,-519.83 31047.49,-522.78"/>
</g>
<!-- layer2_stage1_attention_4 -->
<g id="node228" class="node">
<title>layer2_stage1_attention_4</title>
<polygon fill="none" stroke="black" points="31599.72,-512.1 31301.72,-512.1 31301.72,-449.1 31599.72,-449.1 31599.72,-512.1"/>
<text text-anchor="middle" x="31450.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_4</text>
<text text-anchor="middle" x="31450.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;4)</text>
<text text-anchor="middle" x="31450.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="31450.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="31450.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_4&#45;&gt;layer2_stage1_attention_4 -->
<g id="edge364" class="edge">
<title>layer2_stage1_qkv_reshape_4&#45;&gt;layer2_stage1_attention_4</title>
<path fill="none" stroke="black" d="M31450.72,-547.83C31450.72,-539.49 31450.72,-530.78 31450.72,-522.53"/>
<polygon fill="black" stroke="black" points="31454.22,-522.39 31450.72,-512.39 31447.22,-522.39 31454.22,-522.39"/>
</g>
<!-- layer2_stage1_attention_5 -->
<g id="node229" class="node">
<title>layer2_stage1_attention_5</title>
<polygon fill="none" stroke="black" points="31976.72,-512.1 31678.72,-512.1 31678.72,-449.1 31976.72,-449.1 31976.72,-512.1"/>
<text text-anchor="middle" x="31827.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_5</text>
<text text-anchor="middle" x="31827.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;5)</text>
<text text-anchor="middle" x="31827.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="31827.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="31827.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_5&#45;&gt;layer2_stage1_attention_5 -->
<g id="edge365" class="edge">
<title>layer2_stage1_qkv_reshape_5&#45;&gt;layer2_stage1_attention_5</title>
<path fill="none" stroke="black" d="M31865.21,-548.15C31860.19,-539.23 31854.93,-529.89 31849.99,-521.12"/>
<polygon fill="black" stroke="black" points="31852.94,-519.23 31844.98,-512.23 31846.84,-522.66 31852.94,-519.23"/>
</g>
<!-- layer2_stage1_attention_6 -->
<g id="node230" class="node">
<title>layer2_stage1_attention_6</title>
<polygon fill="none" stroke="black" points="32384.72,-512.1 32086.72,-512.1 32086.72,-449.1 32384.72,-449.1 32384.72,-512.1"/>
<text text-anchor="middle" x="32235.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_6</text>
<text text-anchor="middle" x="32235.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;6)</text>
<text text-anchor="middle" x="32235.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="32235.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="32235.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_6&#45;&gt;layer2_stage1_attention_6 -->
<g id="edge366" class="edge">
<title>layer2_stage1_qkv_reshape_6&#45;&gt;layer2_stage1_attention_6</title>
<path fill="none" stroke="black" d="M32292.23,-548.47C32284.36,-539.15 32276.08,-529.36 32268.37,-520.23"/>
<polygon fill="black" stroke="black" points="32270.89,-517.79 32261.76,-512.41 32265.54,-522.31 32270.89,-517.79"/>
</g>
<!-- layer2_stage1_attention_7 -->
<g id="node231" class="node">
<title>layer2_stage1_attention_7</title>
<polygon fill="none" stroke="black" points="32823.72,-512.1 32525.72,-512.1 32525.72,-449.1 32823.72,-449.1 32823.72,-512.1"/>
<text text-anchor="middle" x="32674.72" y="-500.1" font-family="Arial" font-size="10.00">layer2_stage1_attention_7</text>
<text text-anchor="middle" x="32674.72" y="-489.1" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;7)</text>
<text text-anchor="middle" x="32674.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="32674.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="32674.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer2_stage1_qkv_reshape_7&#45;&gt;layer2_stage1_attention_7 -->
<g id="edge367" class="edge">
<title>layer2_stage1_qkv_reshape_7&#45;&gt;layer2_stage1_attention_7</title>
<path fill="none" stroke="black" d="M32731.23,-548.47C32723.36,-539.15 32715.08,-529.36 32707.37,-520.23"/>
<polygon fill="black" stroke="black" points="32709.89,-517.79 32700.76,-512.41 32704.54,-522.31 32709.89,-517.79"/>
</g>
<!-- layer2_stage1_output_proj_0 -->
<g id="node232" class="node">
<title>layer2_stage1_output_proj_0</title>
<polygon fill="none" stroke="black" points="29930.72,-381.6 29640.72,-381.6 29640.72,-318.6 29930.72,-318.6 29930.72,-381.6"/>
<text text-anchor="middle" x="29785.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_0</text>
<text text-anchor="middle" x="29785.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;0)</text>
<text text-anchor="middle" x="29785.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="29785.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="29785.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_0&#45;&gt;layer2_stage1_output_proj_0 -->
<g id="edge368" class="edge">
<title>layer2_stage1_attention_0&#45;&gt;layer2_stage1_output_proj_0</title>
<path fill="none" stroke="black" d="M29774.31,-448.82C29776.31,-431.73 29778.81,-410.26 29780.97,-391.8"/>
<polygon fill="black" stroke="black" points="29784.47,-391.96 29782.15,-381.62 29777.52,-391.15 29784.47,-391.96"/>
</g>
<!-- layer2_stage1_output_proj_1 -->
<g id="node233" class="node">
<title>layer2_stage1_output_proj_1</title>
<polygon fill="none" stroke="black" points="30469.72,-381.6 30179.72,-381.6 30179.72,-318.6 30469.72,-318.6 30469.72,-381.6"/>
<text text-anchor="middle" x="30324.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_1</text>
<text text-anchor="middle" x="30324.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;1)</text>
<text text-anchor="middle" x="30324.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="30324.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="30324.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_1&#45;&gt;layer2_stage1_output_proj_1 -->
<g id="edge369" class="edge">
<title>layer2_stage1_attention_1&#45;&gt;layer2_stage1_output_proj_1</title>
<path fill="none" stroke="black" d="M30190.11,-448.82C30215.4,-430.46 30247.65,-407.04 30274.25,-387.74"/>
<polygon fill="black" stroke="black" points="30276.63,-390.33 30282.67,-381.62 30272.52,-384.67 30276.63,-390.33"/>
</g>
<!-- layer2_stage1_output_proj_2 -->
<g id="node234" class="node">
<title>layer2_stage1_output_proj_2</title>
<polygon fill="none" stroke="black" points="30892.72,-381.6 30602.72,-381.6 30602.72,-318.6 30892.72,-318.6 30892.72,-381.6"/>
<text text-anchor="middle" x="30747.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_2</text>
<text text-anchor="middle" x="30747.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;2)</text>
<text text-anchor="middle" x="30747.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="30747.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="30747.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_2&#45;&gt;layer2_stage1_output_proj_2 -->
<g id="edge370" class="edge">
<title>layer2_stage1_attention_2&#45;&gt;layer2_stage1_output_proj_2</title>
<path fill="none" stroke="black" d="M30661.02,-448.82C30676.89,-430.94 30697.01,-408.26 30713.87,-389.25"/>
<polygon fill="black" stroke="black" points="30716.62,-391.43 30720.63,-381.62 30711.38,-386.78 30716.62,-391.43"/>
</g>
<!-- layer2_stage1_output_proj_3 -->
<g id="node235" class="node">
<title>layer2_stage1_output_proj_3</title>
<polygon fill="none" stroke="black" points="31258.72,-381.6 30968.72,-381.6 30968.72,-318.6 31258.72,-318.6 31258.72,-381.6"/>
<text text-anchor="middle" x="31113.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_3</text>
<text text-anchor="middle" x="31113.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;3)</text>
<text text-anchor="middle" x="31113.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="31113.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="31113.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_3&#45;&gt;layer2_stage1_output_proj_3 -->
<g id="edge371" class="edge">
<title>layer2_stage1_attention_3&#45;&gt;layer2_stage1_output_proj_3</title>
<path fill="none" stroke="black" d="M31074.93,-448.82C31081.81,-431.49 31090.47,-409.66 31097.87,-391.03"/>
<polygon fill="black" stroke="black" points="31101.17,-392.21 31101.6,-381.62 31094.66,-389.63 31101.17,-392.21"/>
</g>
<!-- layer2_stage1_output_proj_4 -->
<g id="node236" class="node">
<title>layer2_stage1_output_proj_4</title>
<polygon fill="none" stroke="black" points="31595.72,-381.6 31305.72,-381.6 31305.72,-318.6 31595.72,-318.6 31595.72,-381.6"/>
<text text-anchor="middle" x="31450.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_4</text>
<text text-anchor="middle" x="31450.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;4)</text>
<text text-anchor="middle" x="31450.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="31450.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="31450.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_4&#45;&gt;layer2_stage1_output_proj_4 -->
<g id="edge372" class="edge">
<title>layer2_stage1_attention_4&#45;&gt;layer2_stage1_output_proj_4</title>
<path fill="none" stroke="black" d="M31450.72,-448.82C31450.72,-431.73 31450.72,-410.26 31450.72,-391.8"/>
<polygon fill="black" stroke="black" points="31454.22,-391.62 31450.72,-381.62 31447.22,-391.62 31454.22,-391.62"/>
</g>
<!-- layer2_stage1_output_proj_5 -->
<g id="node237" class="node">
<title>layer2_stage1_output_proj_5</title>
<polygon fill="none" stroke="black" points="31907.72,-381.6 31617.72,-381.6 31617.72,-318.6 31907.72,-318.6 31907.72,-381.6"/>
<text text-anchor="middle" x="31762.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_5</text>
<text text-anchor="middle" x="31762.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;5)</text>
<text text-anchor="middle" x="31762.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="31762.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="31762.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_5&#45;&gt;layer2_stage1_output_proj_5 -->
<g id="edge373" class="edge">
<title>layer2_stage1_attention_5&#45;&gt;layer2_stage1_output_proj_5</title>
<path fill="none" stroke="black" d="M31812.15,-448.82C31803.35,-431.41 31792.24,-409.46 31782.79,-390.78"/>
<polygon fill="black" stroke="black" points="31785.8,-388.97 31778.16,-381.62 31779.55,-392.13 31785.8,-388.97"/>
</g>
<!-- layer2_stage1_output_proj_6 -->
<g id="node238" class="node">
<title>layer2_stage1_output_proj_6</title>
<polygon fill="none" stroke="black" points="32221.72,-381.6 31931.72,-381.6 31931.72,-318.6 32221.72,-318.6 32221.72,-381.6"/>
<text text-anchor="middle" x="32076.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_6</text>
<text text-anchor="middle" x="32076.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;6)</text>
<text text-anchor="middle" x="32076.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="32076.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="32076.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_6&#45;&gt;layer2_stage1_output_proj_6 -->
<g id="edge374" class="edge">
<title>layer2_stage1_attention_6&#45;&gt;layer2_stage1_output_proj_6</title>
<path fill="none" stroke="black" d="M32197.63,-448.82C32175.02,-430.54 32146.2,-407.25 32122.37,-387.99"/>
<polygon fill="black" stroke="black" points="32124.47,-385.19 32114.49,-381.62 32120.07,-390.63 32124.47,-385.19"/>
</g>
<!-- layer2_stage1_output_proj_7 -->
<g id="node239" class="node">
<title>layer2_stage1_output_proj_7</title>
<polygon fill="none" stroke="black" points="32623.72,-381.6 32333.72,-381.6 32333.72,-318.6 32623.72,-318.6 32623.72,-381.6"/>
<text text-anchor="middle" x="32478.72" y="-369.6" font-family="Arial" font-size="10.00">layer2_stage1_output_proj_7</text>
<text text-anchor="middle" x="32478.72" y="-358.6" font-family="Arial" font-size="10.00">Output Projection (TP&#45;7)</text>
<text text-anchor="middle" x="32478.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="32478.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="32478.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer2_stage1_attention_7&#45;&gt;layer2_stage1_output_proj_7 -->
<g id="edge375" class="edge">
<title>layer2_stage1_attention_7&#45;&gt;layer2_stage1_output_proj_7</title>
<path fill="none" stroke="black" d="M32627.77,-448.82C32599.53,-430.3 32563.44,-406.64 32533.84,-387.24"/>
<polygon fill="black" stroke="black" points="32535.56,-384.18 32525.28,-381.62 32531.73,-390.03 32535.56,-384.18"/>
</g>
<!-- layer2_stage1_attention_allreduce -->
<g id="node240" class="node">
<title>layer2_stage1_attention_allreduce</title>
<polygon fill="none" stroke="black" points="31686.98,-251.1 31311.14,-251.1 31214.46,-125.1 31590.29,-125.1 31686.98,-251.1"/>
<text text-anchor="middle" x="31450.72" y="-207.6" font-family="Arial" font-size="10.00">layer2_stage1_attention_allreduce</text>
<text text-anchor="middle" x="31450.72" y="-196.6" font-family="Arial" font-size="10.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="31450.72" y="-185.6" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="31450.72" y="-174.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024 (x8)</text>
<text text-anchor="middle" x="31450.72" y="-163.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_output_proj_0&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge376" class="edge">
<title>layer2_stage1_output_proj_0&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M29931.12,-322.75C30003.02,-310.47 30091.22,-296.52 30170.72,-287.1 30556.15,-241.39 31009.52,-212.52 31260.04,-198.73"/>
<polygon fill="black" stroke="black" points="31260.55,-202.2 31270.34,-198.16 31260.16,-195.21 31260.55,-202.2"/>
</g>
<!-- layer2_stage1_output_proj_1&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge377" class="edge">
<title>layer2_stage1_output_proj_1&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M30443.98,-318.57C30490.47,-307.47 30544.36,-295.58 30593.72,-287.1 30823.19,-247.66 31090.05,-219.98 31264.23,-204.32"/>
<polygon fill="black" stroke="black" points="31264.62,-207.8 31274.27,-203.42 31264,-200.82 31264.62,-207.8"/>
</g>
<!-- layer2_stage1_output_proj_2&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge378" class="edge">
<title>layer2_stage1_output_proj_2&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M30845.39,-318.59C30881.17,-307.93 30922.1,-296.33 30959.72,-287.1 31063.87,-261.52 31181.69,-237.84 31275.8,-220.16"/>
<polygon fill="black" stroke="black" points="31276.51,-223.58 31285.7,-218.3 31275.22,-216.7 31276.51,-223.58"/>
</g>
<!-- layer2_stage1_output_proj_3&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge379" class="edge">
<title>layer2_stage1_output_proj_3&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M31178.3,-318.44C31215.92,-300.57 31264.89,-277.32 31310.92,-255.47"/>
<polygon fill="black" stroke="black" points="31312.55,-258.57 31320.08,-251.12 31309.55,-252.25 31312.55,-258.57"/>
</g>
<!-- layer2_stage1_output_proj_4&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge380" class="edge">
<title>layer2_stage1_output_proj_4&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M31450.72,-318.25C31450.72,-302.01 31450.72,-281.36 31450.72,-261.37"/>
<polygon fill="black" stroke="black" points="31454.22,-261.31 31450.72,-251.31 31447.22,-261.31 31454.22,-261.31"/>
</g>
<!-- layer2_stage1_output_proj_5&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge381" class="edge">
<title>layer2_stage1_output_proj_5&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M31702.93,-318.44C31668.24,-300.65 31623.14,-277.51 31580.68,-255.74"/>
<polygon fill="black" stroke="black" points="31582.16,-252.57 31571.66,-251.12 31578.97,-258.8 31582.16,-252.57"/>
</g>
<!-- layer2_stage1_output_proj_6&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge382" class="edge">
<title>layer2_stage1_output_proj_6&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M32005.1,-318.48C31977.78,-307.57 31946.13,-295.82 31916.72,-287.1 31840.3,-264.42 31755.34,-244.92 31679.11,-229.42"/>
<polygon fill="black" stroke="black" points="31679.39,-225.91 31668.9,-227.36 31678.01,-232.77 31679.39,-225.91"/>
</g>
<!-- layer2_stage1_output_proj_7&#45;&gt;layer2_stage1_attention_allreduce -->
<g id="edge383" class="edge">
<title>layer2_stage1_output_proj_7&#45;&gt;layer2_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M32368.54,-318.54C32325.76,-307.47 32276.2,-295.61 32230.72,-287.1 32040.54,-251.51 31821.8,-225.28 31664.45,-208.96"/>
<polygon fill="black" stroke="black" points="31664.48,-205.45 31654.18,-207.9 31663.76,-212.41 31664.48,-205.45"/>
</g>
<!-- layer2_stage1_attention_allreduce&#45;&gt;layer2_stage1_attention_residual -->
<g id="edge385" class="edge">
<title>layer2_stage1_attention_allreduce&#45;&gt;layer2_stage1_attention_residual</title>
<path fill="none" stroke="black" d="M31615.24,-157.16C31754.78,-131.78 31952.9,-95.73 32085.88,-71.53"/>
<polygon fill="black" stroke="black" points="32086.53,-74.97 32095.74,-69.74 32085.28,-68.09 32086.53,-74.97"/>
</g>
<!-- layer2_stage1_gating -->
<g id="node242" class="node">
<title>layer2_stage1_gating</title>
<polygon fill="none" stroke="black" points="39071.3,-1248.29 38721.99,-1248.29 38632.13,-1122.29 38981.44,-1122.29 39071.3,-1248.29"/>
<text text-anchor="middle" x="38851.72" y="-1204.79" font-family="Arial" font-size="10.00">layer2_stage1_gating</text>
<text text-anchor="middle" x="38851.72" y="-1193.79" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="38851.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="38851.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192</text>
<text text-anchor="middle" x="38851.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, num_experts=16</text>
</g>
<!-- layer2_stage1_expert_0_gpu8 -->
<g id="node243" class="node">
<title>layer2_stage1_expert_0_gpu8</title>
<polygon fill="none" stroke="black" points="31898.72,-1054.79 31692.72,-1054.79 31692.72,-991.79 31898.72,-991.79 31898.72,-1054.79"/>
<text text-anchor="middle" x="31795.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_0_gpu8</text>
<text text-anchor="middle" x="31795.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="31795.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="31795.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="31795.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_0_gpu8 -->
<g id="edge386" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38676.03,-1184.22C37628.86,-1183.55 32244.21,-1175.75 31907.72,-1086.29 31886.95,-1080.77 31865.9,-1070.57 31847.73,-1060.02"/>
<polygon fill="black" stroke="black" points="31849.44,-1056.97 31839.06,-1054.83 31845.85,-1062.97 31849.44,-1056.97"/>
</g>
<!-- layer2_stage1_expert_1_gpu8 -->
<g id="node244" class="node">
<title>layer2_stage1_expert_1_gpu8</title>
<polygon fill="none" stroke="black" points="32122.72,-1054.79 31916.72,-1054.79 31916.72,-991.79 32122.72,-991.79 32122.72,-1054.79"/>
<text text-anchor="middle" x="32019.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_1_gpu8</text>
<text text-anchor="middle" x="32019.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="32019.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="32019.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="32019.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_1_gpu8 -->
<g id="edge387" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.9,-1184.14C37648.59,-1182.97 32456.73,-1172.77 32131.72,-1086.29 32110.95,-1080.76 32089.9,-1070.57 32071.73,-1060.02"/>
<polygon fill="black" stroke="black" points="32073.44,-1056.96 32063.06,-1054.83 32069.85,-1062.97 32073.44,-1056.96"/>
</g>
<!-- layer2_stage1_expert_2_gpu8 -->
<g id="node245" class="node">
<title>layer2_stage1_expert_2_gpu8</title>
<polygon fill="none" stroke="black" points="32346.72,-1054.79 32140.72,-1054.79 32140.72,-991.79 32346.72,-991.79 32346.72,-1054.79"/>
<text text-anchor="middle" x="32243.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_2_gpu8</text>
<text text-anchor="middle" x="32243.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="32243.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="32243.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="32243.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_2_gpu8 -->
<g id="edge388" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38676.06,-1184.05C37669.66,-1182.36 32669.28,-1169.81 32355.72,-1086.29 32334.95,-1080.76 32313.9,-1070.56 32295.74,-1060.01"/>
<polygon fill="black" stroke="black" points="32297.44,-1056.95 32287.07,-1054.82 32293.85,-1062.96 32297.44,-1056.95"/>
</g>
<!-- layer2_stage1_expert_3_gpu8 -->
<g id="node246" class="node">
<title>layer2_stage1_expert_3_gpu8</title>
<polygon fill="none" stroke="black" points="32570.72,-1054.79 32364.72,-1054.79 32364.72,-991.79 32570.72,-991.79 32570.72,-1054.79"/>
<text text-anchor="middle" x="32467.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_3_gpu8</text>
<text text-anchor="middle" x="32467.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="32467.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="32467.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="32467.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_3_gpu8 -->
<g id="edge389" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.73,-1183.95C37689.46,-1181.73 32881.79,-1166.84 32579.72,-1086.29 32558.96,-1080.75 32537.9,-1070.55 32519.74,-1060"/>
<polygon fill="black" stroke="black" points="32521.45,-1056.95 32511.07,-1054.82 32517.85,-1062.95 32521.45,-1056.95"/>
</g>
<!-- layer2_stage1_expert_4_gpu8 -->
<g id="node247" class="node">
<title>layer2_stage1_expert_4_gpu8</title>
<polygon fill="none" stroke="black" points="32794.72,-1054.79 32588.72,-1054.79 32588.72,-991.79 32794.72,-991.79 32794.72,-1054.79"/>
<text text-anchor="middle" x="32691.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_4_gpu8</text>
<text text-anchor="middle" x="32691.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="32691.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="32691.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="32691.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_4_gpu8 -->
<g id="edge390" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.75,-1183.84C37710.8,-1181.08 33094.35,-1163.88 32803.72,-1086.29 32782.96,-1080.74 32761.9,-1070.55 32743.74,-1060"/>
<polygon fill="black" stroke="black" points="32745.45,-1056.94 32735.07,-1054.81 32741.85,-1062.95 32745.45,-1056.94"/>
</g>
<!-- layer2_stage1_expert_5_gpu8 -->
<g id="node248" class="node">
<title>layer2_stage1_expert_5_gpu8</title>
<polygon fill="none" stroke="black" points="33018.72,-1054.79 32812.72,-1054.79 32812.72,-991.79 33018.72,-991.79 33018.72,-1054.79"/>
<text text-anchor="middle" x="32915.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_5_gpu8</text>
<text text-anchor="middle" x="32915.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="32915.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="32915.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="32915.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_5_gpu8 -->
<g id="edge391" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.75,-1183.72C37732.46,-1180.41 33306.91,-1160.92 33027.72,-1086.29 33006.96,-1080.74 32985.91,-1070.54 32967.74,-1059.99"/>
<polygon fill="black" stroke="black" points="32969.45,-1056.93 32959.07,-1054.8 32965.86,-1062.94 32969.45,-1056.93"/>
</g>
<!-- layer2_stage1_expert_6_gpu8 -->
<g id="node249" class="node">
<title>layer2_stage1_expert_6_gpu8</title>
<polygon fill="none" stroke="black" points="33242.72,-1054.79 33036.72,-1054.79 33036.72,-991.79 33242.72,-991.79 33242.72,-1054.79"/>
<text text-anchor="middle" x="33139.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_6_gpu8</text>
<text text-anchor="middle" x="33139.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="33139.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="33139.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="33139.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_6_gpu8 -->
<g id="edge392" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.76,-1183.6C37754.59,-1179.71 33519.49,-1157.96 33251.72,-1086.29 33230.96,-1080.73 33209.91,-1070.53 33191.74,-1059.98"/>
<polygon fill="black" stroke="black" points="33193.45,-1056.92 33183.07,-1054.8 33189.86,-1062.93 33193.45,-1056.92"/>
</g>
<!-- layer2_stage1_expert_7_gpu8 -->
<g id="node250" class="node">
<title>layer2_stage1_expert_7_gpu8</title>
<polygon fill="none" stroke="black" points="33466.72,-1054.79 33260.72,-1054.79 33260.72,-991.79 33466.72,-991.79 33466.72,-1054.79"/>
<text text-anchor="middle" x="33363.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_7_gpu8</text>
<text text-anchor="middle" x="33363.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="33363.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="33363.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="33363.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_7_gpu8 -->
<g id="edge393" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.46,-1183.46C37776.22,-1178.97 33732.06,-1155 33475.72,-1086.29 33454.96,-1080.72 33433.91,-1070.52 33415.75,-1059.97"/>
<polygon fill="black" stroke="black" points="33417.45,-1056.92 33407.07,-1054.79 33413.86,-1062.92 33417.45,-1056.92"/>
</g>
<!-- layer2_stage1_expert_8_gpu9 -->
<g id="node251" class="node">
<title>layer2_stage1_expert_8_gpu9</title>
<polygon fill="none" stroke="black" points="33690.72,-1054.79 33484.72,-1054.79 33484.72,-991.79 33690.72,-991.79 33690.72,-1054.79"/>
<text text-anchor="middle" x="33587.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_8_gpu9</text>
<text text-anchor="middle" x="33587.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="33587.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="33587.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="33587.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_8_gpu9 -->
<g id="edge394" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_8_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.63,-1183.32C37799.75,-1178.21 33944.68,-1152.05 33699.72,-1086.29 33679.06,-1080.74 33658.1,-1070.6 33639.99,-1060.1"/>
<polygon fill="black" stroke="black" points="33641.72,-1057.06 33631.34,-1054.94 33638.14,-1063.07 33641.72,-1057.06"/>
</g>
<!-- layer2_stage1_expert_9_gpu9 -->
<g id="node252" class="node">
<title>layer2_stage1_expert_9_gpu9</title>
<polygon fill="none" stroke="black" points="33914.72,-1054.79 33708.72,-1054.79 33708.72,-991.79 33914.72,-991.79 33914.72,-1054.79"/>
<text text-anchor="middle" x="33811.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_9_gpu9</text>
<text text-anchor="middle" x="33811.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="33811.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="33811.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="33811.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_9_gpu9 -->
<g id="edge395" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.23,-1183.16C37822.15,-1177.4 34157.26,-1149.1 33923.72,-1086.29 33903.06,-1080.73 33882.1,-1070.59 33863.99,-1060.09"/>
<polygon fill="black" stroke="black" points="33865.73,-1057.05 33855.35,-1054.93 33862.14,-1063.06 33865.73,-1057.05"/>
</g>
<!-- layer2_stage1_expert_10_gpu9 -->
<g id="node253" class="node">
<title>layer2_stage1_expert_10_gpu9</title>
<polygon fill="none" stroke="black" points="34138.72,-1054.79 33932.72,-1054.79 33932.72,-991.79 34138.72,-991.79 34138.72,-1054.79"/>
<text text-anchor="middle" x="34035.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_10_gpu9</text>
<text text-anchor="middle" x="34035.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="34035.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="34035.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="34035.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_10_gpu9 -->
<g id="edge396" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_10_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.41,-1182.98C37846.73,-1176.57 34369.91,-1146.16 34147.72,-1086.29 34127.06,-1080.72 34106.11,-1070.58 34088,-1060.08"/>
<polygon fill="black" stroke="black" points="34089.73,-1057.04 34079.35,-1054.92 34086.14,-1063.05 34089.73,-1057.04"/>
</g>
<!-- layer2_stage1_expert_11_gpu9 -->
<g id="node254" class="node">
<title>layer2_stage1_expert_11_gpu9</title>
<polygon fill="none" stroke="black" points="34362.72,-1054.79 34156.72,-1054.79 34156.72,-991.79 34362.72,-991.79 34362.72,-1054.79"/>
<text text-anchor="middle" x="34259.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_11_gpu9</text>
<text text-anchor="middle" x="34259.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="34259.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="34259.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="34259.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_11_gpu9 -->
<g id="edge397" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_11_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.17,-1182.79C37870.75,-1175.68 34582.54,-1143.21 34371.72,-1086.29 34351.07,-1080.71 34330.11,-1070.56 34312,-1060.07"/>
<polygon fill="black" stroke="black" points="34313.73,-1057.03 34303.35,-1054.91 34310.15,-1063.04 34313.73,-1057.03"/>
</g>
<!-- layer2_stage1_expert_12_gpu9 -->
<g id="node255" class="node">
<title>layer2_stage1_expert_12_gpu9</title>
<polygon fill="none" stroke="black" points="34586.72,-1054.79 34380.72,-1054.79 34380.72,-991.79 34586.72,-991.79 34586.72,-1054.79"/>
<text text-anchor="middle" x="34483.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_12_gpu9</text>
<text text-anchor="middle" x="34483.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="34483.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="34483.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="34483.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_12_gpu9 -->
<g id="edge398" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_12_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38674.95,-1182.58C37895.49,-1174.74 34795.2,-1140.27 34595.72,-1086.29 34575.07,-1080.7 34554.12,-1070.55 34536,-1060.06"/>
<polygon fill="black" stroke="black" points="34537.74,-1057.01 34527.36,-1054.9 34534.15,-1063.03 34537.74,-1057.01"/>
</g>
<!-- layer2_stage1_expert_13_gpu9 -->
<g id="node256" class="node">
<title>layer2_stage1_expert_13_gpu9</title>
<polygon fill="none" stroke="black" points="34810.72,-1054.79 34604.72,-1054.79 34604.72,-991.79 34810.72,-991.79 34810.72,-1054.79"/>
<text text-anchor="middle" x="34707.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_13_gpu9</text>
<text text-anchor="middle" x="34707.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="34707.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="34707.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="34707.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_13_gpu9 -->
<g id="edge399" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_13_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38674.86,-1182.34C37921.24,-1173.74 35007.88,-1137.34 34819.72,-1086.29 34799.07,-1080.68 34778.12,-1070.53 34760.01,-1060.04"/>
<polygon fill="black" stroke="black" points="34761.74,-1057 34751.36,-1054.88 34758.16,-1063.01 34761.74,-1057"/>
</g>
<!-- layer2_stage1_expert_14_gpu9 -->
<g id="node257" class="node">
<title>layer2_stage1_expert_14_gpu9</title>
<polygon fill="none" stroke="black" points="35034.72,-1054.79 34828.72,-1054.79 34828.72,-991.79 35034.72,-991.79 35034.72,-1054.79"/>
<text text-anchor="middle" x="34931.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_14_gpu9</text>
<text text-anchor="middle" x="34931.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="34931.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="34931.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="34931.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_14_gpu9 -->
<g id="edge400" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_14_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38676.52,-1184.67C37975.86,-1185.55 35396.14,-1182.17 35043.72,-1086.29 35023.08,-1080.67 35002.12,-1070.51 34984.01,-1060.02"/>
<polygon fill="black" stroke="black" points="34985.75,-1056.98 34975.36,-1054.87 34982.16,-1062.99 34985.75,-1056.98"/>
</g>
<!-- layer2_stage1_expert_15_gpu9 -->
<g id="node258" class="node">
<title>layer2_stage1_expert_15_gpu9</title>
<polygon fill="none" stroke="black" points="35258.72,-1054.79 35052.72,-1054.79 35052.72,-991.79 35258.72,-991.79 35258.72,-1054.79"/>
<text text-anchor="middle" x="35155.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_15_gpu9</text>
<text text-anchor="middle" x="35155.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="35155.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="35155.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="35155.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_15_gpu9 -->
<g id="edge401" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_15_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38676.33,-1184.36C38002.01,-1184 35597.61,-1176.33 35267.72,-1086.29 35247.08,-1080.65 35226.13,-1070.49 35208.02,-1060"/>
<polygon fill="black" stroke="black" points="35209.75,-1056.96 35199.37,-1054.85 35206.17,-1062.97 35209.75,-1056.96"/>
</g>
<!-- layer2_stage1_expert_16_gpu10 -->
<g id="node259" class="node">
<title>layer2_stage1_expert_16_gpu10</title>
<polygon fill="none" stroke="black" points="35482.72,-1054.79 35276.72,-1054.79 35276.72,-991.79 35482.72,-991.79 35482.72,-1054.79"/>
<text text-anchor="middle" x="35379.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_16_gpu10</text>
<text text-anchor="middle" x="35379.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 16</text>
<text text-anchor="middle" x="35379.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="35379.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="35379.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_16_gpu10 -->
<g id="edge402" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_16_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38676.06,-1184.01C38028.88,-1182.35 35799.13,-1170.49 35491.72,-1086.29 35471.09,-1080.63 35450.14,-1070.47 35432.02,-1059.98"/>
<polygon fill="black" stroke="black" points="35433.76,-1056.94 35423.37,-1054.83 35430.17,-1062.95 35433.76,-1056.94"/>
</g>
<!-- layer2_stage1_expert_17_gpu10 -->
<g id="node260" class="node">
<title>layer2_stage1_expert_17_gpu10</title>
<polygon fill="none" stroke="black" points="35706.72,-1054.79 35500.72,-1054.79 35500.72,-991.79 35706.72,-991.79 35706.72,-1054.79"/>
<text text-anchor="middle" x="35603.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_17_gpu10</text>
<text text-anchor="middle" x="35603.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 17</text>
<text text-anchor="middle" x="35603.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="35603.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="35603.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_17_gpu10 -->
<g id="edge403" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_17_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.65,-1183.61C38056.4,-1180.58 36000.68,-1164.67 35715.72,-1086.29 35695.09,-1080.61 35674.14,-1070.44 35656.03,-1059.96"/>
<polygon fill="black" stroke="black" points="35657.76,-1056.91 35647.38,-1054.8 35654.18,-1062.93 35657.76,-1056.91"/>
</g>
<!-- layer2_stage1_expert_18_gpu10 -->
<g id="node261" class="node">
<title>layer2_stage1_expert_18_gpu10</title>
<polygon fill="none" stroke="black" points="35930.72,-1054.79 35724.72,-1054.79 35724.72,-991.79 35930.72,-991.79 35930.72,-1054.79"/>
<text text-anchor="middle" x="35827.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_18_gpu10</text>
<text text-anchor="middle" x="35827.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 18</text>
<text text-anchor="middle" x="35827.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="35827.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="35827.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_18_gpu10 -->
<g id="edge404" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_18_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.34,-1183.15C38085.25,-1178.69 36202.32,-1158.85 35939.72,-1086.29 35919.19,-1080.61 35898.34,-1070.5 35880.28,-1060.07"/>
<polygon fill="black" stroke="black" points="35882.04,-1057.04 35871.66,-1054.94 35878.46,-1063.06 35882.04,-1057.04"/>
</g>
<!-- layer2_stage1_expert_19_gpu10 -->
<g id="node262" class="node">
<title>layer2_stage1_expert_19_gpu10</title>
<polygon fill="none" stroke="black" points="36154.72,-1054.79 35948.72,-1054.79 35948.72,-991.79 36154.72,-991.79 36154.72,-1054.79"/>
<text text-anchor="middle" x="36051.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_19_gpu10</text>
<text text-anchor="middle" x="36051.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 19</text>
<text text-anchor="middle" x="36051.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="36051.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="36051.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_19_gpu10 -->
<g id="edge405" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_19_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38674.9,-1182.61C38115.04,-1176.63 36404.01,-1153.05 36163.72,-1086.29 36143.2,-1080.59 36122.35,-1070.47 36104.29,-1060.03"/>
<polygon fill="black" stroke="black" points="36106.05,-1057.01 36095.66,-1054.91 36102.47,-1063.02 36106.05,-1057.01"/>
</g>
<!-- layer2_stage1_expert_20_gpu10 -->
<g id="node263" class="node">
<title>layer2_stage1_expert_20_gpu10</title>
<polygon fill="none" stroke="black" points="36378.72,-1054.79 36172.72,-1054.79 36172.72,-991.79 36378.72,-991.79 36378.72,-1054.79"/>
<text text-anchor="middle" x="36275.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_20_gpu10</text>
<text text-anchor="middle" x="36275.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 20</text>
<text text-anchor="middle" x="36275.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="36275.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="36275.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_20_gpu10 -->
<g id="edge406" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_20_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38674.47,-1181.96C38146.25,-1174.39 36605.79,-1147.26 36387.72,-1086.29 36367.21,-1080.55 36346.36,-1070.42 36328.3,-1059.99"/>
<polygon fill="black" stroke="black" points="36330.06,-1056.97 36319.67,-1054.87 36326.48,-1062.99 36330.06,-1056.97"/>
</g>
<!-- layer2_stage1_expert_21_gpu10 -->
<g id="node264" class="node">
<title>layer2_stage1_expert_21_gpu10</title>
<polygon fill="none" stroke="black" points="36602.72,-1054.79 36396.72,-1054.79 36396.72,-991.79 36602.72,-991.79 36602.72,-1054.79"/>
<text text-anchor="middle" x="36499.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_21_gpu10</text>
<text text-anchor="middle" x="36499.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 21</text>
<text text-anchor="middle" x="36499.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="36499.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="36499.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_21_gpu10 -->
<g id="edge407" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_21_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38674.06,-1181.19C38179.06,-1171.91 36807.66,-1141.5 36611.72,-1086.29 36591.22,-1080.51 36570.38,-1070.37 36552.32,-1059.95"/>
<polygon fill="black" stroke="black" points="36554.07,-1056.92 36543.69,-1054.82 36550.5,-1062.94 36554.07,-1056.92"/>
</g>
<!-- layer2_stage1_expert_22_gpu10 -->
<g id="node265" class="node">
<title>layer2_stage1_expert_22_gpu10</title>
<polygon fill="none" stroke="black" points="36826.72,-1054.79 36620.72,-1054.79 36620.72,-991.79 36826.72,-991.79 36826.72,-1054.79"/>
<text text-anchor="middle" x="36723.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_22_gpu10</text>
<text text-anchor="middle" x="36723.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 22</text>
<text text-anchor="middle" x="36723.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="36723.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="36723.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_22_gpu10 -->
<g id="edge408" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_22_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38673.43,-1180.24C38213.3,-1169.15 37009.61,-1135.74 36835.72,-1086.29 36815.33,-1080.49 36794.58,-1070.4 36776.58,-1060.03"/>
<polygon fill="black" stroke="black" points="36778.36,-1057.02 36767.97,-1054.93 36774.79,-1063.04 36778.36,-1057.02"/>
</g>
<!-- layer2_stage1_expert_23_gpu10 -->
<g id="node266" class="node">
<title>layer2_stage1_expert_23_gpu10</title>
<polygon fill="none" stroke="black" points="37050.72,-1054.79 36844.72,-1054.79 36844.72,-991.79 37050.72,-991.79 37050.72,-1054.79"/>
<text text-anchor="middle" x="36947.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_23_gpu10</text>
<text text-anchor="middle" x="36947.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 23</text>
<text text-anchor="middle" x="36947.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="36947.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="36947.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_23_gpu10 -->
<g id="edge409" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_23_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38676.43,-1184.64C38286.78,-1183.81 37359.52,-1172.53 37059.72,-1086.29 37039.34,-1080.43 37018.6,-1070.32 37000.6,-1059.96"/>
<polygon fill="black" stroke="black" points="37002.38,-1056.94 36991.99,-1054.86 36998.81,-1062.97 37002.38,-1056.94"/>
</g>
<!-- layer2_stage1_expert_24_gpu11 -->
<g id="node267" class="node">
<title>layer2_stage1_expert_24_gpu11</title>
<polygon fill="none" stroke="black" points="37274.72,-1054.79 37068.72,-1054.79 37068.72,-991.79 37274.72,-991.79 37274.72,-1054.79"/>
<text text-anchor="middle" x="37171.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_24_gpu11</text>
<text text-anchor="middle" x="37171.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 24</text>
<text text-anchor="middle" x="37171.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="37171.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="37171.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_24_gpu11 -->
<g id="edge410" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_24_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38675.3,-1182.99C38322.13,-1178.82 37540.15,-1161.13 37283.72,-1086.29 37263.64,-1080.43 37243.19,-1070.5 37225.36,-1060.28"/>
<polygon fill="black" stroke="black" points="37226.68,-1057 37216.28,-1054.94 37223.12,-1063.03 37226.68,-1057"/>
</g>
<!-- layer2_stage1_expert_25_gpu11 -->
<g id="node268" class="node">
<title>layer2_stage1_expert_25_gpu11</title>
<polygon fill="none" stroke="black" points="37498.72,-1054.79 37292.72,-1054.79 37292.72,-991.79 37498.72,-991.79 37498.72,-1054.79"/>
<text text-anchor="middle" x="37395.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_25_gpu11</text>
<text text-anchor="middle" x="37395.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 25</text>
<text text-anchor="middle" x="37395.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="37395.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="37395.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_25_gpu11 -->
<g id="edge411" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_25_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38673.81,-1180.78C38359.99,-1173.03 37721.09,-1149.77 37507.72,-1086.29 37487.67,-1080.32 37467.23,-1070.37 37449.39,-1060.16"/>
<polygon fill="black" stroke="black" points="37450.71,-1056.87 37440.32,-1054.82 37447.16,-1062.91 37450.71,-1056.87"/>
</g>
<!-- layer2_stage1_expert_26_gpu11 -->
<g id="node269" class="node">
<title>layer2_stage1_expert_26_gpu11</title>
<polygon fill="none" stroke="black" points="37722.72,-1054.79 37516.72,-1054.79 37516.72,-991.79 37722.72,-991.79 37722.72,-1054.79"/>
<text text-anchor="middle" x="37619.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_26_gpu11</text>
<text text-anchor="middle" x="37619.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 26</text>
<text text-anchor="middle" x="37619.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="37619.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="37619.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_26_gpu11 -->
<g id="edge412" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_26_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38671.55,-1177.63C38400.77,-1166.08 37902.41,-1138.42 37731.72,-1086.29 37711.81,-1080.21 37691.47,-1070.27 37673.69,-1060.12"/>
<polygon fill="black" stroke="black" points="37675.03,-1056.85 37664.64,-1054.81 37671.49,-1062.89 37675.03,-1056.85"/>
</g>
<!-- layer2_stage1_expert_27_gpu11 -->
<g id="node270" class="node">
<title>layer2_stage1_expert_27_gpu11</title>
<polygon fill="none" stroke="black" points="37946.72,-1054.79 37740.72,-1054.79 37740.72,-991.79 37946.72,-991.79 37946.72,-1054.79"/>
<text text-anchor="middle" x="37843.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_27_gpu11</text>
<text text-anchor="middle" x="37843.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 27</text>
<text text-anchor="middle" x="37843.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="37843.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="37843.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_27_gpu11 -->
<g id="edge413" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_27_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38668.02,-1172.77C38445.41,-1157.32 38084.18,-1127.05 37955.72,-1086.29 37936.05,-1080.05 37915.93,-1070.18 37898.26,-1060.14"/>
<polygon fill="black" stroke="black" points="37899.66,-1056.9 37889.25,-1054.89 37896.13,-1062.95 37899.66,-1056.9"/>
</g>
<!-- layer2_stage1_expert_28_gpu11 -->
<g id="node271" class="node">
<title>layer2_stage1_expert_28_gpu11</title>
<polygon fill="none" stroke="black" points="38170.72,-1054.79 37964.72,-1054.79 37964.72,-991.79 38170.72,-991.79 38170.72,-1054.79"/>
<text text-anchor="middle" x="38067.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_28_gpu11</text>
<text text-anchor="middle" x="38067.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 28</text>
<text text-anchor="middle" x="38067.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="38067.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="38067.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_28_gpu11 -->
<g id="edge414" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_28_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38670.05,-1175.52C38532.44,-1164.67 38340.32,-1140.44 38179.72,-1086.29 38160.35,-1079.76 38140.44,-1069.92 38122.88,-1059.99"/>
<polygon fill="black" stroke="black" points="38124.34,-1056.78 38113.93,-1054.8 38120.83,-1062.84 38124.34,-1056.78"/>
</g>
<!-- layer2_stage1_expert_29_gpu11 -->
<g id="node272" class="node">
<title>layer2_stage1_expert_29_gpu11</title>
<polygon fill="none" stroke="black" points="38394.72,-1054.79 38188.72,-1054.79 38188.72,-991.79 38394.72,-991.79 38394.72,-1054.79"/>
<text text-anchor="middle" x="38291.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_29_gpu11</text>
<text text-anchor="middle" x="38291.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 29</text>
<text text-anchor="middle" x="38291.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="38291.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="38291.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_29_gpu11 -->
<g id="edge415" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_29_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38654.66,-1153.98C38575.2,-1138.49 38483.62,-1116.4 38403.72,-1086.29 38385.03,-1079.24 38365.67,-1069.51 38348.41,-1059.84"/>
<polygon fill="black" stroke="black" points="38350,-1056.72 38339.58,-1054.8 38346.53,-1062.8 38350,-1056.72"/>
</g>
<!-- layer2_stage1_expert_30_gpu11 -->
<g id="node273" class="node">
<title>layer2_stage1_expert_30_gpu11</title>
<polygon fill="none" stroke="black" points="38618.72,-1054.79 38412.72,-1054.79 38412.72,-991.79 38618.72,-991.79 38618.72,-1054.79"/>
<text text-anchor="middle" x="38515.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_30_gpu11</text>
<text text-anchor="middle" x="38515.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 30</text>
<text text-anchor="middle" x="38515.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="38515.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="38515.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_30_gpu11 -->
<g id="edge416" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_30_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38704.42,-1122.18C38678.66,-1110.66 38652.26,-1098.42 38627.72,-1086.29 38611.16,-1078.1 38593.55,-1068.7 38577.31,-1059.73"/>
<polygon fill="black" stroke="black" points="38578.89,-1056.6 38568.45,-1054.8 38575.49,-1062.72 38578.89,-1056.6"/>
</g>
<!-- layer2_stage1_expert_31_gpu11 -->
<g id="node274" class="node">
<title>layer2_stage1_expert_31_gpu11</title>
<polygon fill="none" stroke="black" points="38842.72,-1054.79 38636.72,-1054.79 38636.72,-991.79 38842.72,-991.79 38842.72,-1054.79"/>
<text text-anchor="middle" x="38739.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_31_gpu11</text>
<text text-anchor="middle" x="38739.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 31</text>
<text text-anchor="middle" x="38739.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="38739.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="38739.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_31_gpu11 -->
<g id="edge417" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_31_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38808.09,-1121.97C38794.27,-1102.21 38779.38,-1080.94 38767.03,-1063.31"/>
<polygon fill="black" stroke="black" points="38769.8,-1061.15 38761.19,-1054.97 38764.06,-1065.17 38769.8,-1061.15"/>
</g>
<!-- layer2_stage1_expert_32_gpu12 -->
<g id="node275" class="node">
<title>layer2_stage1_expert_32_gpu12</title>
<polygon fill="none" stroke="black" points="39066.72,-1054.79 38860.72,-1054.79 38860.72,-991.79 39066.72,-991.79 39066.72,-1054.79"/>
<text text-anchor="middle" x="38963.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_32_gpu12</text>
<text text-anchor="middle" x="38963.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 32</text>
<text text-anchor="middle" x="38963.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="38963.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="38963.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_32_gpu12 -->
<g id="edge418" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_32_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38895.34,-1121.97C38909.17,-1102.21 38924.06,-1080.94 38936.4,-1063.31"/>
<polygon fill="black" stroke="black" points="38939.37,-1065.17 38942.24,-1054.97 38933.64,-1061.15 38939.37,-1065.17"/>
</g>
<!-- layer2_stage1_expert_33_gpu12 -->
<g id="node276" class="node">
<title>layer2_stage1_expert_33_gpu12</title>
<polygon fill="none" stroke="black" points="39290.72,-1054.79 39084.72,-1054.79 39084.72,-991.79 39290.72,-991.79 39290.72,-1054.79"/>
<text text-anchor="middle" x="39187.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_33_gpu12</text>
<text text-anchor="middle" x="39187.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 33</text>
<text text-anchor="middle" x="39187.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="39187.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="39187.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_33_gpu12 -->
<g id="edge419" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_33_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38985.91,-1128.01C39015.72,-1114.83 39046.99,-1100.49 39075.72,-1086.29 39092.28,-1078.1 39109.89,-1068.7 39126.12,-1059.73"/>
<polygon fill="black" stroke="black" points="39127.95,-1062.72 39134.99,-1054.8 39124.55,-1056.6 39127.95,-1062.72"/>
</g>
<!-- layer2_stage1_expert_34_gpu12 -->
<g id="node277" class="node">
<title>layer2_stage1_expert_34_gpu12</title>
<polygon fill="none" stroke="black" points="39514.72,-1054.79 39308.72,-1054.79 39308.72,-991.79 39514.72,-991.79 39514.72,-1054.79"/>
<text text-anchor="middle" x="39411.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_34_gpu12</text>
<text text-anchor="middle" x="39411.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 34</text>
<text text-anchor="middle" x="39411.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="39411.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="39411.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_34_gpu12 -->
<g id="edge420" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_34_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39009.39,-1161.33C39096.73,-1145.77 39206.22,-1121.53 39299.72,-1086.29 39318.4,-1079.24 39337.77,-1069.51 39355.03,-1059.84"/>
<polygon fill="black" stroke="black" points="39356.9,-1062.8 39363.85,-1054.8 39353.43,-1056.72 39356.9,-1062.8"/>
</g>
<!-- layer2_stage1_expert_35_gpu12 -->
<g id="node278" class="node">
<title>layer2_stage1_expert_35_gpu12</title>
<polygon fill="none" stroke="black" points="39738.72,-1054.79 39532.72,-1054.79 39532.72,-991.79 39738.72,-991.79 39738.72,-1054.79"/>
<text text-anchor="middle" x="39635.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_35_gpu12</text>
<text text-anchor="middle" x="39635.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 35</text>
<text text-anchor="middle" x="39635.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="39635.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="39635.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_35_gpu12 -->
<g id="edge421" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_35_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39020.27,-1176.52C39158.6,-1166.2 39357.95,-1142.18 39523.72,-1086.29 39543.09,-1079.76 39562.99,-1069.92 39580.55,-1059.99"/>
<polygon fill="black" stroke="black" points="39582.6,-1062.84 39589.51,-1054.8 39579.1,-1056.78 39582.6,-1062.84"/>
</g>
<!-- layer2_stage1_expert_36_gpu12 -->
<g id="node279" class="node">
<title>layer2_stage1_expert_36_gpu12</title>
<polygon fill="none" stroke="black" points="39962.72,-1054.79 39756.72,-1054.79 39756.72,-991.79 39962.72,-991.79 39962.72,-1054.79"/>
<text text-anchor="middle" x="39859.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_36_gpu12</text>
<text text-anchor="middle" x="39859.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 36</text>
<text text-anchor="middle" x="39859.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="39859.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="39859.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_36_gpu12 -->
<g id="edge422" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_36_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39018.73,-1173.92C39239.52,-1158.86 39616,-1128.08 39747.72,-1086.29 39767.38,-1080.05 39787.51,-1070.18 39805.18,-1060.14"/>
<polygon fill="black" stroke="black" points="39807.31,-1062.95 39814.18,-1054.89 39803.78,-1056.9 39807.31,-1062.95"/>
</g>
<!-- layer2_stage1_expert_37_gpu12 -->
<g id="node280" class="node">
<title>layer2_stage1_expert_37_gpu12</title>
<polygon fill="none" stroke="black" points="40186.72,-1054.79 39980.72,-1054.79 39980.72,-991.79 40186.72,-991.79 40186.72,-1054.79"/>
<text text-anchor="middle" x="40083.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_37_gpu12</text>
<text text-anchor="middle" x="40083.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 37</text>
<text text-anchor="middle" x="40083.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="40083.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="40083.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_37_gpu12 -->
<g id="edge423" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_37_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39021.45,-1178.07C39289.66,-1166.79 39798.81,-1139.1 39971.72,-1086.29 39991.63,-1080.21 40011.96,-1070.27 40029.75,-1060.12"/>
<polygon fill="black" stroke="black" points="40031.94,-1062.89 40038.8,-1054.81 40028.4,-1056.85 40031.94,-1062.89"/>
</g>
<!-- layer2_stage1_expert_38_gpu12 -->
<g id="node281" class="node">
<title>layer2_stage1_expert_38_gpu12</title>
<polygon fill="none" stroke="black" points="40410.72,-1054.79 40204.72,-1054.79 40204.72,-991.79 40410.72,-991.79 40410.72,-1054.79"/>
<text text-anchor="middle" x="40307.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_38_gpu12</text>
<text text-anchor="middle" x="40307.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 38</text>
<text text-anchor="middle" x="40307.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="40307.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="40307.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_38_gpu12 -->
<g id="edge424" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_38_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39023.48,-1180.93C39335.04,-1173.33 39980.94,-1150.19 40195.72,-1086.29 40215.76,-1080.32 40236.2,-1070.37 40254.04,-1060.16"/>
<polygon fill="black" stroke="black" points="40256.27,-1062.91 40263.12,-1054.82 40252.72,-1056.87 40256.27,-1062.91"/>
</g>
<!-- layer2_stage1_expert_39_gpu12 -->
<g id="node282" class="node">
<title>layer2_stage1_expert_39_gpu12</title>
<polygon fill="none" stroke="black" points="40634.72,-1054.79 40428.72,-1054.79 40428.72,-991.79 40634.72,-991.79 40634.72,-1054.79"/>
<text text-anchor="middle" x="40531.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_39_gpu12</text>
<text text-anchor="middle" x="40531.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 39</text>
<text text-anchor="middle" x="40531.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="40531.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="40531.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_39_gpu12 -->
<g id="edge425" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_39_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.1,-1183.03C39376.81,-1178.92 40162.55,-1161.35 40419.72,-1086.29 40439.79,-1080.43 40460.24,-1070.5 40478.08,-1060.28"/>
<polygon fill="black" stroke="black" points="40480.31,-1063.03 40487.15,-1054.94 40476.76,-1057 40480.31,-1063.03"/>
</g>
<!-- layer2_stage1_expert_40_gpu13 -->
<g id="node283" class="node">
<title>layer2_stage1_expert_40_gpu13</title>
<polygon fill="none" stroke="black" points="40858.72,-1054.79 40652.72,-1054.79 40652.72,-991.79 40858.72,-991.79 40858.72,-1054.79"/>
<text text-anchor="middle" x="40755.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_40_gpu13</text>
<text text-anchor="middle" x="40755.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 40</text>
<text text-anchor="middle" x="40755.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="40755.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="40755.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_40_gpu13 -->
<g id="edge426" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_40_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.91,-1184.64C39414.91,-1183.84 40343.63,-1172.61 40643.72,-1086.29 40664.09,-1080.43 40684.83,-1070.32 40702.84,-1059.96"/>
<polygon fill="black" stroke="black" points="40704.62,-1062.97 40711.45,-1054.86 40701.06,-1056.94 40704.62,-1062.97"/>
</g>
<!-- layer2_stage1_expert_41_gpu13 -->
<g id="node284" class="node">
<title>layer2_stage1_expert_41_gpu13</title>
<polygon fill="none" stroke="black" points="41082.72,-1054.79 40876.72,-1054.79 40876.72,-991.79 41082.72,-991.79 41082.72,-1054.79"/>
<text text-anchor="middle" x="40979.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_41_gpu13</text>
<text text-anchor="middle" x="40979.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 41</text>
<text text-anchor="middle" x="40979.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="40979.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="40979.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_41_gpu13 -->
<g id="edge427" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_41_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39022.96,-1180.41C39477.72,-1169.49 40692.93,-1136 40867.72,-1086.29 40888.11,-1080.49 40908.86,-1070.4 40926.86,-1060.03"/>
<polygon fill="black" stroke="black" points="40928.65,-1063.04 40935.46,-1054.93 40925.08,-1057.02 40928.65,-1063.04"/>
</g>
<!-- layer2_stage1_expert_42_gpu13 -->
<g id="node285" class="node">
<title>layer2_stage1_expert_42_gpu13</title>
<polygon fill="none" stroke="black" points="41306.72,-1054.79 41100.72,-1054.79 41100.72,-991.79 41306.72,-991.79 41306.72,-1054.79"/>
<text text-anchor="middle" x="41203.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_42_gpu13</text>
<text text-anchor="middle" x="41203.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 42</text>
<text text-anchor="middle" x="41203.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="41203.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="41203.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_42_gpu13 -->
<g id="edge428" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_42_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39023.65,-1181.3C39513.7,-1172.15 40895.02,-1141.71 41091.72,-1086.29 41112.22,-1080.51 41133.06,-1070.37 41151.12,-1059.95"/>
<polygon fill="black" stroke="black" points="41152.94,-1062.94 41159.75,-1054.82 41149.36,-1056.92 41152.94,-1062.94"/>
</g>
<!-- layer2_stage1_expert_43_gpu13 -->
<g id="node286" class="node">
<title>layer2_stage1_expert_43_gpu13</title>
<polygon fill="none" stroke="black" points="41530.72,-1054.79 41324.72,-1054.79 41324.72,-991.79 41530.72,-991.79 41530.72,-1054.79"/>
<text text-anchor="middle" x="41427.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_43_gpu13</text>
<text text-anchor="middle" x="41427.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 43</text>
<text text-anchor="middle" x="41427.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="41427.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="41427.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_43_gpu13 -->
<g id="edge429" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_43_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39024.31,-1182.03C39548.08,-1174.55 41097.01,-1147.45 41315.72,-1086.29 41336.23,-1080.55 41357.07,-1070.42 41375.13,-1059.99"/>
<polygon fill="black" stroke="black" points="41376.95,-1062.99 41383.76,-1054.87 41373.38,-1056.97 41376.95,-1062.99"/>
</g>
<!-- layer2_stage1_expert_44_gpu13 -->
<g id="node287" class="node">
<title>layer2_stage1_expert_44_gpu13</title>
<polygon fill="none" stroke="black" points="41754.72,-1054.79 41548.72,-1054.79 41548.72,-991.79 41754.72,-991.79 41754.72,-1054.79"/>
<text text-anchor="middle" x="41651.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_44_gpu13</text>
<text text-anchor="middle" x="41651.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 44</text>
<text text-anchor="middle" x="41651.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="41651.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="41651.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_44_gpu13 -->
<g id="edge430" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_44_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39024.62,-1182.65C39580.38,-1176.74 41298.86,-1153.21 41539.72,-1086.29 41560.24,-1080.59 41581.09,-1070.47 41599.14,-1060.03"/>
<polygon fill="black" stroke="black" points="41600.96,-1063.02 41607.77,-1054.91 41597.39,-1057.01 41600.96,-1063.02"/>
</g>
<!-- layer2_stage1_expert_45_gpu13 -->
<g id="node288" class="node">
<title>layer2_stage1_expert_45_gpu13</title>
<polygon fill="none" stroke="black" points="41978.72,-1054.79 41772.72,-1054.79 41772.72,-991.79 41978.72,-991.79 41978.72,-1054.79"/>
<text text-anchor="middle" x="41875.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_45_gpu13</text>
<text text-anchor="middle" x="41875.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 45</text>
<text text-anchor="middle" x="41875.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="41875.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="41875.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_45_gpu13 -->
<g id="edge431" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_45_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.02,-1183.17C39611.63,-1178.76 41500.66,-1158.98 41763.72,-1086.29 41784.24,-1080.61 41805.1,-1070.5 41823.15,-1060.07"/>
<polygon fill="black" stroke="black" points="41824.97,-1063.06 41831.78,-1054.94 41821.4,-1057.04 41824.97,-1063.06"/>
</g>
<!-- layer2_stage1_expert_46_gpu13 -->
<g id="node289" class="node">
<title>layer2_stage1_expert_46_gpu13</title>
<polygon fill="none" stroke="black" points="42202.72,-1054.79 41996.72,-1054.79 41996.72,-991.79 42202.72,-991.79 42202.72,-1054.79"/>
<text text-anchor="middle" x="42099.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_46_gpu13</text>
<text text-anchor="middle" x="42099.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 46</text>
<text text-anchor="middle" x="42099.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="42099.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="42099.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_46_gpu13 -->
<g id="edge432" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_46_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.38,-1183.63C39641.7,-1180.62 41702.38,-1164.77 41987.72,-1086.29 42008.34,-1080.61 42029.29,-1070.44 42047.4,-1059.96"/>
<polygon fill="black" stroke="black" points="42049.26,-1062.93 42056.05,-1054.8 42045.67,-1056.91 42049.26,-1062.93"/>
</g>
<!-- layer2_stage1_expert_47_gpu13 -->
<g id="node290" class="node">
<title>layer2_stage1_expert_47_gpu13</title>
<polygon fill="none" stroke="black" points="42426.72,-1054.79 42220.72,-1054.79 42220.72,-991.79 42426.72,-991.79 42426.72,-1054.79"/>
<text text-anchor="middle" x="42323.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_47_gpu13</text>
<text text-anchor="middle" x="42323.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 47</text>
<text text-anchor="middle" x="42323.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="42323.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="42323.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_47_gpu13 -->
<g id="edge433" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_47_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.71,-1184.02C39670.73,-1182.37 41904.04,-1170.57 42211.72,-1086.29 42232.35,-1080.63 42253.3,-1070.47 42271.41,-1059.98"/>
<polygon fill="black" stroke="black" points="42273.26,-1062.95 42280.06,-1054.83 42269.68,-1056.94 42273.26,-1062.95"/>
</g>
<!-- layer2_stage1_expert_48_gpu14 -->
<g id="node291" class="node">
<title>layer2_stage1_expert_48_gpu14</title>
<polygon fill="none" stroke="black" points="42650.72,-1054.79 42444.72,-1054.79 42444.72,-991.79 42650.72,-991.79 42650.72,-1054.79"/>
<text text-anchor="middle" x="42547.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_48_gpu14</text>
<text text-anchor="middle" x="42547.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 48</text>
<text text-anchor="middle" x="42547.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="42547.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="42547.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_48_gpu14 -->
<g id="edge434" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_48_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.96,-1184.36C39698.69,-1184.01 42105.64,-1176.38 42435.72,-1086.29 42456.35,-1080.65 42477.31,-1070.49 42495.42,-1060"/>
<polygon fill="black" stroke="black" points="42497.27,-1062.97 42504.07,-1054.85 42493.68,-1056.96 42497.27,-1062.97"/>
</g>
<!-- layer2_stage1_expert_49_gpu14 -->
<g id="node292" class="node">
<title>layer2_stage1_expert_49_gpu14</title>
<polygon fill="none" stroke="black" points="42874.72,-1054.79 42668.72,-1054.79 42668.72,-991.79 42874.72,-991.79 42874.72,-1054.79"/>
<text text-anchor="middle" x="42771.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_49_gpu14</text>
<text text-anchor="middle" x="42771.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 49</text>
<text text-anchor="middle" x="42771.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="42771.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="42771.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_49_gpu14 -->
<g id="edge435" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_49_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39026.02,-1184.67C39725.38,-1185.55 42307.15,-1182.22 42659.72,-1086.29 42680.36,-1080.67 42701.31,-1070.51 42719.42,-1060.02"/>
<polygon fill="black" stroke="black" points="42721.28,-1062.99 42728.07,-1054.87 42717.69,-1056.98 42721.28,-1062.99"/>
</g>
<!-- layer2_stage1_expert_50_gpu14 -->
<g id="node293" class="node">
<title>layer2_stage1_expert_50_gpu14</title>
<polygon fill="none" stroke="black" points="43098.72,-1054.79 42892.72,-1054.79 42892.72,-991.79 43098.72,-991.79 43098.72,-1054.79"/>
<text text-anchor="middle" x="42995.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_50_gpu14</text>
<text text-anchor="middle" x="42995.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 50</text>
<text text-anchor="middle" x="42995.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="42995.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="42995.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_50_gpu14 -->
<g id="edge436" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_50_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39024.48,-1182.39C39771.56,-1173.88 42695.21,-1137.43 42883.72,-1086.29 42904.36,-1080.68 42925.32,-1070.53 42943.43,-1060.04"/>
<polygon fill="black" stroke="black" points="42945.28,-1063.01 42952.08,-1054.88 42941.69,-1057 42945.28,-1063.01"/>
</g>
<!-- layer2_stage1_expert_51_gpu14 -->
<g id="node294" class="node">
<title>layer2_stage1_expert_51_gpu14</title>
<polygon fill="none" stroke="black" points="43322.72,-1054.79 43116.72,-1054.79 43116.72,-991.79 43322.72,-991.79 43322.72,-1054.79"/>
<text text-anchor="middle" x="43219.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_51_gpu14</text>
<text text-anchor="middle" x="43219.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 51</text>
<text text-anchor="middle" x="43219.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="43219.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="43219.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_51_gpu14 -->
<g id="edge437" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_51_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39024.58,-1182.62C39797.54,-1174.85 42907.9,-1140.36 43107.72,-1086.29 43128.37,-1080.7 43149.32,-1070.55 43167.43,-1060.06"/>
<polygon fill="black" stroke="black" points="43169.29,-1063.03 43176.08,-1054.9 43165.7,-1057.01 43169.29,-1063.03"/>
</g>
<!-- layer2_stage1_expert_52_gpu14 -->
<g id="node295" class="node">
<title>layer2_stage1_expert_52_gpu14</title>
<polygon fill="none" stroke="black" points="43546.72,-1054.79 43340.72,-1054.79 43340.72,-991.79 43546.72,-991.79 43546.72,-1054.79"/>
<text text-anchor="middle" x="43443.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_52_gpu14</text>
<text text-anchor="middle" x="43443.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 52</text>
<text text-anchor="middle" x="43443.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="43443.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="43443.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_52_gpu14 -->
<g id="edge438" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_52_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39024.92,-1182.82C39823.53,-1175.77 43120.6,-1143.29 43331.72,-1086.29 43352.37,-1080.71 43373.32,-1070.56 43391.44,-1060.07"/>
<polygon fill="black" stroke="black" points="43393.29,-1063.04 43400.08,-1054.91 43389.7,-1057.03 43393.29,-1063.04"/>
</g>
<!-- layer2_stage1_expert_53_gpu14 -->
<g id="node296" class="node">
<title>layer2_stage1_expert_53_gpu14</title>
<polygon fill="none" stroke="black" points="43770.72,-1054.79 43564.72,-1054.79 43564.72,-991.79 43770.72,-991.79 43770.72,-1054.79"/>
<text text-anchor="middle" x="43667.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_53_gpu14</text>
<text text-anchor="middle" x="43667.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 53</text>
<text text-anchor="middle" x="43667.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="43667.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="43667.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_53_gpu14 -->
<g id="edge439" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_53_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39024.94,-1183.01C39848.02,-1176.64 43333.25,-1146.23 43555.72,-1086.29 43576.37,-1080.72 43597.33,-1070.58 43615.44,-1060.08"/>
<polygon fill="black" stroke="black" points="43617.29,-1063.05 43624.09,-1054.92 43613.71,-1057.04 43617.29,-1063.05"/>
</g>
<!-- layer2_stage1_expert_54_gpu14 -->
<g id="node297" class="node">
<title>layer2_stage1_expert_54_gpu14</title>
<polygon fill="none" stroke="black" points="43994.72,-1054.79 43788.72,-1054.79 43788.72,-991.79 43994.72,-991.79 43994.72,-1054.79"/>
<text text-anchor="middle" x="43891.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_54_gpu14</text>
<text text-anchor="middle" x="43891.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 54</text>
<text text-anchor="middle" x="43891.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="43891.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="43891.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_54_gpu14 -->
<g id="edge440" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_54_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.03,-1183.18C39872.17,-1177.47 43545.88,-1149.18 43779.72,-1086.29 43800.38,-1080.73 43821.33,-1070.59 43839.44,-1060.09"/>
<polygon fill="black" stroke="black" points="43841.3,-1063.06 43848.09,-1054.93 43837.71,-1057.05 43841.3,-1063.06"/>
</g>
<!-- layer2_stage1_expert_55_gpu14 -->
<g id="node298" class="node">
<title>layer2_stage1_expert_55_gpu14</title>
<polygon fill="none" stroke="black" points="44218.72,-1054.79 44012.72,-1054.79 44012.72,-991.79 44218.72,-991.79 44218.72,-1054.79"/>
<text text-anchor="middle" x="44115.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_55_gpu14</text>
<text text-anchor="middle" x="44115.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 55</text>
<text text-anchor="middle" x="44115.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="44115.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="44115.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_55_gpu14 -->
<g id="edge441" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_55_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.28,-1183.33C39896.25,-1178.26 43758.52,-1152.12 44003.72,-1086.29 44024.38,-1080.74 44045.33,-1070.6 44063.44,-1060.1"/>
<polygon fill="black" stroke="black" points="44065.3,-1063.07 44072.09,-1054.94 44061.71,-1057.06 44065.3,-1063.07"/>
</g>
<!-- layer2_stage1_expert_56_gpu15 -->
<g id="node299" class="node">
<title>layer2_stage1_expert_56_gpu15</title>
<polygon fill="none" stroke="black" points="44442.72,-1054.79 44236.72,-1054.79 44236.72,-991.79 44442.72,-991.79 44442.72,-1054.79"/>
<text text-anchor="middle" x="44339.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_56_gpu15</text>
<text text-anchor="middle" x="44339.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 56</text>
<text text-anchor="middle" x="44339.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="44339.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="44339.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_56_gpu15 -->
<g id="edge442" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_56_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.39,-1183.48C39919.44,-1179.02 43971.13,-1155.07 44227.72,-1086.29 44248.47,-1080.72 44269.52,-1070.52 44287.69,-1059.97"/>
<polygon fill="black" stroke="black" points="44289.57,-1062.92 44296.36,-1054.79 44285.98,-1056.92 44289.57,-1062.92"/>
</g>
<!-- layer2_stage1_expert_57_gpu15 -->
<g id="node300" class="node">
<title>layer2_stage1_expert_57_gpu15</title>
<polygon fill="none" stroke="black" points="44666.72,-1054.79 44460.72,-1054.79 44460.72,-991.79 44666.72,-991.79 44666.72,-1054.79"/>
<text text-anchor="middle" x="44563.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_57_gpu15</text>
<text text-anchor="middle" x="44563.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 57</text>
<text text-anchor="middle" x="44563.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="44563.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="44563.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_57_gpu15 -->
<g id="edge443" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_57_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.41,-1183.61C39941.88,-1179.74 44183.72,-1158.02 44451.72,-1086.29 44472.47,-1080.73 44493.53,-1070.53 44511.69,-1059.98"/>
<polygon fill="black" stroke="black" points="44513.58,-1062.93 44520.36,-1054.8 44509.98,-1056.92 44513.58,-1062.93"/>
</g>
<!-- layer2_stage1_expert_58_gpu15 -->
<g id="node301" class="node">
<title>layer2_stage1_expert_58_gpu15</title>
<polygon fill="none" stroke="black" points="44890.72,-1054.79 44684.72,-1054.79 44684.72,-991.79 44890.72,-991.79 44890.72,-1054.79"/>
<text text-anchor="middle" x="44787.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_58_gpu15</text>
<text text-anchor="middle" x="44787.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 58</text>
<text text-anchor="middle" x="44787.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="44787.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="44787.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_58_gpu15 -->
<g id="edge444" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_58_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.37,-1183.73C39963.71,-1180.44 44396.29,-1160.98 44675.72,-1086.29 44696.48,-1080.74 44717.53,-1070.54 44735.69,-1059.99"/>
<polygon fill="black" stroke="black" points="44737.58,-1062.94 44744.37,-1054.8 44733.99,-1056.93 44737.58,-1062.94"/>
</g>
<!-- layer2_stage1_expert_59_gpu15 -->
<g id="node302" class="node">
<title>layer2_stage1_expert_59_gpu15</title>
<polygon fill="none" stroke="black" points="45114.72,-1054.79 44908.72,-1054.79 44908.72,-991.79 45114.72,-991.79 45114.72,-1054.79"/>
<text text-anchor="middle" x="45011.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_59_gpu15</text>
<text text-anchor="middle" x="45011.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 59</text>
<text text-anchor="middle" x="45011.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="45011.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="45011.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_59_gpu15 -->
<g id="edge445" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_59_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.71,-1183.84C39986.34,-1181.11 44608.89,-1163.93 44899.72,-1086.29 44920.48,-1080.74 44941.53,-1070.55 44959.7,-1060"/>
<polygon fill="black" stroke="black" points="44961.58,-1062.95 44968.37,-1054.81 44957.99,-1056.94 44961.58,-1062.95"/>
</g>
<!-- layer2_stage1_expert_60_gpu15 -->
<g id="node303" class="node">
<title>layer2_stage1_expert_60_gpu15</title>
<polygon fill="none" stroke="black" points="45338.72,-1054.79 45132.72,-1054.79 45132.72,-991.79 45338.72,-991.79 45338.72,-1054.79"/>
<text text-anchor="middle" x="45235.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_60_gpu15</text>
<text text-anchor="middle" x="45235.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 60</text>
<text text-anchor="middle" x="45235.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="45235.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="45235.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_60_gpu15 -->
<g id="edge446" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_60_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.7,-1183.95C40007.43,-1181.75 44821.44,-1166.89 45123.72,-1086.29 45144.48,-1080.75 45165.53,-1070.55 45183.7,-1060"/>
<polygon fill="black" stroke="black" points="45185.58,-1062.95 45192.37,-1054.82 45181.99,-1056.95 45185.58,-1062.95"/>
</g>
<!-- layer2_stage1_expert_61_gpu15 -->
<g id="node304" class="node">
<title>layer2_stage1_expert_61_gpu15</title>
<polygon fill="none" stroke="black" points="45562.72,-1054.79 45356.72,-1054.79 45356.72,-991.79 45562.72,-991.79 45562.72,-1054.79"/>
<text text-anchor="middle" x="45459.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_61_gpu15</text>
<text text-anchor="middle" x="45459.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 61</text>
<text text-anchor="middle" x="45459.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="45459.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="45459.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_61_gpu15 -->
<g id="edge447" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_61_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.74,-1184.05C40028.34,-1182.38 45033.99,-1169.86 45347.72,-1086.29 45368.48,-1080.76 45389.54,-1070.56 45407.7,-1060.01"/>
<polygon fill="black" stroke="black" points="45409.59,-1062.96 45416.37,-1054.82 45405.99,-1056.95 45409.59,-1062.96"/>
</g>
<!-- layer2_stage1_expert_62_gpu15 -->
<g id="node305" class="node">
<title>layer2_stage1_expert_62_gpu15</title>
<polygon fill="none" stroke="black" points="45786.72,-1054.79 45580.72,-1054.79 45580.72,-991.79 45786.72,-991.79 45786.72,-1054.79"/>
<text text-anchor="middle" x="45683.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_62_gpu15</text>
<text text-anchor="middle" x="45683.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 62</text>
<text text-anchor="middle" x="45683.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="45683.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="45683.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_62_gpu15 -->
<g id="edge448" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_62_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.87,-1184.14C40049.22,-1182.98 45246.53,-1172.82 45571.72,-1086.29 45592.48,-1080.76 45613.54,-1070.57 45631.7,-1060.02"/>
<polygon fill="black" stroke="black" points="45633.59,-1062.97 45640.37,-1054.83 45629.99,-1056.96 45633.59,-1062.97"/>
</g>
<!-- layer2_stage1_expert_63_gpu15 -->
<g id="node306" class="node">
<title>layer2_stage1_expert_63_gpu15</title>
<polygon fill="none" stroke="black" points="46010.72,-1054.79 45804.72,-1054.79 45804.72,-991.79 46010.72,-991.79 46010.72,-1054.79"/>
<text text-anchor="middle" x="45907.72" y="-1042.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_63_gpu15</text>
<text text-anchor="middle" x="45907.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="45907.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="45907.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="45907.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_gating&#45;&gt;layer2_stage1_expert_63_gpu15 -->
<g id="edge449" class="edge">
<title>layer2_stage1_gating&#45;&gt;layer2_stage1_expert_63_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39025.71,-1184.23C40068.75,-1183.56 45459.04,-1175.79 45795.72,-1086.29 45816.48,-1080.77 45837.54,-1070.57 45855.7,-1060.02"/>
<polygon fill="black" stroke="black" points="45857.59,-1062.97 45864.37,-1054.83 45854,-1056.97 45857.59,-1062.97"/>
</g>
<!-- layer2_stage1_expert_aggregate -->
<g id="node307" class="node">
<title>layer2_stage1_expert_aggregate</title>
<polygon fill="none" stroke="black" points="39093.34,-924.29 38708.97,-924.29 38610.09,-798.29 38994.47,-798.29 39093.34,-924.29"/>
<text text-anchor="middle" x="38851.72" y="-880.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_aggregate</text>
<text text-anchor="middle" x="38851.72" y="-869.79" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="38851.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="38851.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x16)</text>
<text text-anchor="middle" x="38851.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_expert_0_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge450" class="edge">
<title>layer2_stage1_expert_0_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M31839.06,-991.74C31859,-979.46 31883.55,-966.71 31907.72,-960.29 32241.51,-871.55 37542.59,-863.15 38649.94,-862.37"/>
<polygon fill="black" stroke="black" points="38649.99,-865.87 38659.99,-862.36 38649.98,-858.87 38649.99,-865.87"/>
</g>
<!-- layer2_stage1_expert_1_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge451" class="edge">
<title>layer2_stage1_expert_1_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M32063.06,-991.74C32083,-979.47 32107.56,-966.72 32131.72,-960.29 32454.07,-874.51 37564.05,-863.78 38649.88,-862.47"/>
<polygon fill="black" stroke="black" points="38650.14,-865.97 38660.13,-862.45 38650.13,-858.97 38650.14,-865.97"/>
</g>
<!-- layer2_stage1_expert_2_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge452" class="edge">
<title>layer2_stage1_expert_2_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M32287.07,-991.75C32307,-979.47 32331.56,-966.72 32355.72,-960.29 32666.67,-877.46 37586.81,-864.42 38650.13,-862.57"/>
<polygon fill="black" stroke="black" points="38650.17,-866.07 38660.17,-862.55 38650.16,-859.07 38650.17,-866.07"/>
</g>
<!-- layer2_stage1_expert_3_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge453" class="edge">
<title>layer2_stage1_expert_3_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M32511.07,-991.76C32531,-979.48 32555.56,-966.73 32579.72,-960.29 32879.28,-880.4 37609.83,-865.09 38650.34,-862.68"/>
<polygon fill="black" stroke="black" points="38650.55,-866.18 38660.55,-862.66 38650.54,-859.18 38650.55,-866.18"/>
</g>
<!-- layer2_stage1_expert_4_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge454" class="edge">
<title>layer2_stage1_expert_4_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M32735.07,-991.76C32755.01,-979.49 32779.56,-966.74 32803.72,-960.29 33091.85,-883.36 37631.88,-865.79 38650.11,-862.81"/>
<polygon fill="black" stroke="black" points="38650.47,-866.31 38660.46,-862.78 38650.45,-859.31 38650.47,-866.31"/>
</g>
<!-- layer2_stage1_expert_5_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge455" class="edge">
<title>layer2_stage1_expert_5_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M32959.07,-991.77C32979.01,-979.5 33003.56,-966.74 33027.72,-960.29 33304.51,-886.3 37656.7,-866.5 38650.66,-862.94"/>
<polygon fill="black" stroke="black" points="38650.78,-866.44 38660.77,-862.9 38650.76,-859.44 38650.78,-866.44"/>
</g>
<!-- layer2_stage1_expert_6_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge456" class="edge">
<title>layer2_stage1_expert_6_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M33183.07,-991.78C33203.01,-979.51 33227.57,-966.75 33251.72,-960.29 33517.12,-889.25 37679.81,-867.25 38650.49,-863.08"/>
<polygon fill="black" stroke="black" points="38650.73,-866.58 38660.71,-863.04 38650.7,-859.58 38650.73,-866.58"/>
</g>
<!-- layer2_stage1_expert_7_gpu8&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge457" class="edge">
<title>layer2_stage1_expert_7_gpu8&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M33407.07,-991.79C33427.01,-979.52 33451.57,-966.76 33475.72,-960.29 33729.75,-892.19 37703.72,-868.04 38650.42,-863.23"/>
<polygon fill="black" stroke="black" points="38650.75,-866.73 38660.73,-863.18 38650.71,-859.73 38650.75,-866.73"/>
</g>
<!-- layer2_stage1_expert_8_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge458" class="edge">
<title>layer2_stage1_expert_8_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M33631.34,-991.63C33651.23,-979.41 33675.68,-966.74 33699.72,-960.29 33942.44,-895.12 37729.48,-868.84 38650.83,-863.4"/>
<polygon fill="black" stroke="black" points="38650.9,-866.9 38660.88,-863.34 38650.86,-859.9 38650.9,-866.9"/>
</g>
<!-- layer2_stage1_expert_9_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge459" class="edge">
<title>layer2_stage1_expert_9_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M33855.35,-991.64C33875.24,-979.43 33899.68,-966.75 33923.72,-960.29 34155.12,-898.05 37755.34,-869.69 38651.1,-863.58"/>
<polygon fill="black" stroke="black" points="38651.22,-867.08 38661.19,-863.51 38651.17,-860.08 38651.22,-867.08"/>
</g>
<!-- layer2_stage1_expert_10_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge460" class="edge">
<title>layer2_stage1_expert_10_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M34079.35,-991.65C34099.24,-979.44 34123.68,-966.76 34147.72,-960.29 34367.82,-900.98 37781.44,-870.58 38651.26,-863.78"/>
<polygon fill="black" stroke="black" points="38651.4,-867.27 38661.37,-863.7 38651.35,-860.28 38651.4,-867.27"/>
</g>
<!-- layer2_stage1_expert_11_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge461" class="edge">
<title>layer2_stage1_expert_11_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M34303.35,-991.66C34323.25,-979.45 34347.69,-966.78 34371.72,-960.29 34580.53,-903.9 37808.08,-871.52 38651.39,-863.99"/>
<polygon fill="black" stroke="black" points="38651.54,-867.49 38661.5,-863.9 38651.47,-860.49 38651.54,-867.49"/>
</g>
<!-- layer2_stage1_expert_12_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge462" class="edge">
<title>layer2_stage1_expert_12_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M34527.36,-991.68C34547.25,-979.47 34571.69,-966.79 34595.72,-960.29 34793.26,-906.83 37835.52,-872.51 38651.58,-864.23"/>
<polygon fill="black" stroke="black" points="38651.71,-867.73 38661.67,-864.13 38651.63,-860.73 38651.71,-867.73"/>
</g>
<!-- layer2_stage1_expert_13_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge463" class="edge">
<title>layer2_stage1_expert_13_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M34751.36,-991.69C34771.25,-979.49 34795.69,-966.8 34819.72,-960.29 35006,-909.75 37863.24,-873.56 38651.6,-864.5"/>
<polygon fill="black" stroke="black" points="38651.68,-868 38661.64,-864.38 38651.6,-861 38651.68,-868"/>
</g>
<!-- layer2_stage1_expert_14_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge464" class="edge">
<title>layer2_stage1_expert_14_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M34975.36,-991.71C34995.26,-979.51 35019.7,-966.82 35043.72,-960.29 35391.77,-865.59 37912.31,-861.12 38649.64,-861.87"/>
<polygon fill="black" stroke="black" points="38649.83,-865.37 38659.83,-861.88 38649.83,-858.37 38649.83,-865.37"/>
</g>
<!-- layer2_stage1_expert_15_gpu9&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge465" class="edge">
<title>layer2_stage1_expert_15_gpu9&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M35199.37,-991.73C35219.27,-979.53 35243.7,-966.84 35267.72,-960.29 35593.47,-871.37 37942.01,-862.78 38650.14,-862.23"/>
<polygon fill="black" stroke="black" points="38650.19,-865.73 38660.19,-862.22 38650.18,-858.73 38650.19,-865.73"/>
</g>
<!-- layer2_stage1_expert_16_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge466" class="edge">
<title>layer2_stage1_expert_16_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M35423.37,-991.75C35443.27,-979.55 35467.71,-966.86 35491.72,-960.29 35795.15,-877.17 37971.43,-864.54 38650.12,-862.63"/>
<polygon fill="black" stroke="black" points="38650.5,-866.13 38660.49,-862.6 38650.48,-859.13 38650.5,-866.13"/>
</g>
<!-- layer2_stage1_expert_17_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge467" class="edge">
<title>layer2_stage1_expert_17_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M35647.38,-991.77C35667.28,-979.58 35691.72,-966.89 35715.72,-960.29 35996.91,-882.95 38002.25,-866.42 38650.29,-863.09"/>
<polygon fill="black" stroke="black" points="38650.69,-866.58 38660.67,-863.03 38650.65,-859.58 38650.69,-866.58"/>
</g>
<!-- layer2_stage1_expert_18_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge468" class="edge">
<title>layer2_stage1_expert_18_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M35871.66,-991.63C35891.51,-979.5 35915.83,-966.89 35939.72,-960.29 36198.8,-888.69 38035.06,-868.43 38650.92,-863.61"/>
<polygon fill="black" stroke="black" points="38651.27,-867.11 38661.24,-863.53 38651.21,-860.11 38651.27,-867.11"/>
</g>
<!-- layer2_stage1_expert_19_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge469" class="edge">
<title>layer2_stage1_expert_19_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M36095.66,-991.67C36115.52,-979.54 36139.84,-966.92 36163.72,-960.29 36400.75,-894.43 38068.89,-870.59 38651.49,-864.22"/>
<polygon fill="black" stroke="black" points="38651.71,-867.72 38661.67,-864.11 38651.64,-860.72 38651.71,-867.72"/>
</g>
<!-- layer2_stage1_expert_20_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge470" class="edge">
<title>layer2_stage1_expert_20_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M36319.67,-991.7C36339.53,-979.58 36363.85,-966.96 36387.72,-960.29 36602.74,-900.16 38103.43,-872.95 38651.73,-864.94"/>
<polygon fill="black" stroke="black" points="38652.18,-868.43 38662.12,-864.79 38652.07,-861.43 38652.18,-868.43"/>
</g>
<!-- layer2_stage1_expert_21_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge471" class="edge">
<title>layer2_stage1_expert_21_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M36543.69,-991.75C36563.54,-979.64 36587.87,-967.01 36611.72,-960.29 36804.91,-905.85 38140.86,-875.52 38652.74,-865.78"/>
<polygon fill="black" stroke="black" points="38652.89,-869.28 38662.82,-865.59 38652.76,-862.28 38652.89,-869.28"/>
</g>
<!-- layer2_stage1_expert_22_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge472" class="edge">
<title>layer2_stage1_expert_22_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M36767.97,-991.64C36787.78,-979.59 36811.99,-967.03 36835.72,-960.29 37007.13,-911.54 38179.09,-878.38 38653.24,-866.82"/>
<polygon fill="black" stroke="black" points="38653.36,-870.32 38663.28,-866.58 38653.19,-863.32 38653.36,-870.32"/>
</g>
<!-- layer2_stage1_expert_23_gpu10&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge473" class="edge">
<title>layer2_stage1_expert_23_gpu10&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M36991.99,-991.71C37011.8,-979.67 37036.01,-967.11 37059.72,-960.29 37352.86,-875.96 38245.87,-863.3 38649.66,-862.01"/>
<polygon fill="black" stroke="black" points="38649.71,-865.51 38659.7,-861.98 38649.69,-858.51 38649.71,-865.51"/>
</g>
<!-- layer2_stage1_expert_24_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge474" class="edge">
<title>layer2_stage1_expert_24_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M37216.28,-991.64C37236.05,-979.66 37260.14,-967.17 37283.72,-960.29 37534.44,-887.1 38287.61,-868.57 38651.12,-863.88"/>
<polygon fill="black" stroke="black" points="38651.27,-867.38 38661.22,-863.75 38651.18,-860.38 38651.27,-867.38"/>
</g>
<!-- layer2_stage1_expert_25_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge475" class="edge">
<title>layer2_stage1_expert_25_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M37440.32,-991.76C37460.09,-979.8 37484.18,-967.29 37507.72,-960.29 37716.45,-898.18 38332.35,-874.58 38652.84,-866.32"/>
<polygon fill="black" stroke="black" points="38653.27,-869.81 38663.18,-866.06 38653.09,-862.81 38653.27,-869.81"/>
</g>
<!-- layer2_stage1_expert_26_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge476" class="edge">
<title>layer2_stage1_expert_26_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M37664.64,-991.76C37684.37,-979.88 37708.34,-967.43 37731.72,-960.29 37899.11,-909.16 38381.66,-881.57 38655.63,-869.63"/>
<polygon fill="black" stroke="black" points="38655.85,-873.13 38665.69,-869.2 38655.55,-866.13 38655.85,-873.13"/>
</g>
<!-- layer2_stage1_expert_27_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge477" class="edge">
<title>layer2_stage1_expert_27_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M37889.25,-991.68C37908.9,-979.94 37932.63,-967.61 37955.72,-960.29 38082.42,-920.08 38435.55,-890.08 38658.79,-874.45"/>
<polygon fill="black" stroke="black" points="38659.26,-877.92 38668.99,-873.73 38658.77,-870.94 38659.26,-877.92"/>
</g>
<!-- layer2_stage1_expert_28_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge478" class="edge">
<title>layer2_stage1_expert_28_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M38113.93,-991.77C38133.49,-980.19 38156.97,-967.96 38179.72,-960.29 38335.31,-907.83 38520.49,-883.44 38657.01,-872.11"/>
<polygon fill="black" stroke="black" points="38657.49,-875.58 38667.17,-871.28 38656.92,-868.61 38657.49,-875.58"/>
</g>
<!-- layer2_stage1_expert_29_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge479" class="edge">
<title>layer2_stage1_expert_29_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M38339.58,-991.77C38358.9,-980.54 38381.78,-968.56 38403.72,-960.29 38488.82,-928.21 38587.18,-905.24 38670.01,-889.65"/>
<polygon fill="black" stroke="black" points="38670.84,-893.05 38680.03,-887.78 38669.56,-886.17 38670.84,-893.05"/>
</g>
<!-- layer2_stage1_expert_30_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge480" class="edge">
<title>layer2_stage1_expert_30_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M38568.45,-991.77C38586.99,-981.4 38608.09,-969.99 38627.72,-960.29 38650.41,-949.07 38674.69,-937.76 38698.57,-927.02"/>
<polygon fill="black" stroke="black" points="38700.01,-930.21 38707.71,-922.92 38697.15,-923.82 38700.01,-930.21"/>
</g>
<!-- layer2_stage1_expert_31_gpu11&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge481" class="edge">
<title>layer2_stage1_expert_31_gpu11&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M38761.31,-991.44C38772.99,-974.76 38787.92,-953.42 38802.28,-932.92"/>
<polygon fill="black" stroke="black" points="38805.3,-934.7 38808.17,-924.5 38799.56,-930.69 38805.3,-934.7"/>
</g>
<!-- layer2_stage1_expert_32_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge482" class="edge">
<title>layer2_stage1_expert_32_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M38942.12,-991.44C38930.45,-974.76 38915.51,-953.42 38901.16,-932.92"/>
<polygon fill="black" stroke="black" points="38903.87,-930.69 38895.27,-924.5 38898.14,-934.7 38903.87,-930.69"/>
</g>
<!-- layer2_stage1_expert_33_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge483" class="edge">
<title>layer2_stage1_expert_33_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M39134.99,-991.77C39116.45,-981.4 39095.34,-969.99 39075.72,-960.29 39054.14,-949.63 39031.14,-938.88 39008.4,-928.61"/>
<polygon fill="black" stroke="black" points="39009.58,-925.3 38999.02,-924.39 39006.71,-931.69 39009.58,-925.3"/>
</g>
<!-- layer2_stage1_expert_34_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge484" class="edge">
<title>layer2_stage1_expert_34_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M39363.85,-991.77C39344.54,-980.54 39321.66,-968.56 39299.72,-960.29 39230.79,-934.3 39153.16,-914.3 39082.13,-899.35"/>
<polygon fill="black" stroke="black" points="39082.66,-895.89 39072.16,-897.27 39081.23,-902.74 39082.66,-895.89"/>
</g>
<!-- layer2_stage1_expert_35_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge485" class="edge">
<title>layer2_stage1_expert_35_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M39589.51,-991.77C39569.95,-980.19 39546.46,-967.96 39523.72,-960.29 39374.4,-909.94 39197.82,-885.45 39063.15,-873.54"/>
<polygon fill="black" stroke="black" points="39063.39,-870.05 39053.12,-872.67 39062.78,-877.03 39063.39,-870.05"/>
</g>
<!-- layer2_stage1_expert_36_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge486" class="edge">
<title>layer2_stage1_expert_36_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M39814.18,-991.68C39794.54,-979.94 39770.81,-967.61 39747.72,-960.29 39624.83,-921.29 39288.92,-891.89 39065.13,-875.89"/>
<polygon fill="black" stroke="black" points="39065.11,-872.38 39054.89,-875.17 39064.62,-879.37 39065.11,-872.38"/>
</g>
<!-- layer2_stage1_expert_37_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge487" class="edge">
<title>layer2_stage1_expert_37_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M40038.8,-991.76C40019.07,-979.88 39995.1,-967.43 39971.72,-960.29 39806.97,-909.97 39336.98,-882.45 39060.98,-870.21"/>
<polygon fill="black" stroke="black" points="39060.98,-866.71 39050.83,-869.76 39060.67,-873.7 39060.98,-866.71"/>
</g>
<!-- layer2_stage1_expert_38_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge488" class="edge">
<title>layer2_stage1_expert_38_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M40263.12,-991.76C40243.34,-979.8 40219.26,-967.29 40195.72,-960.29 39988.65,-898.68 39380.88,-874.96 39058.31,-866.52"/>
<polygon fill="black" stroke="black" points="39057.99,-863.01 39047.91,-866.25 39057.81,-870.01 39057.99,-863.01"/>
</g>
<!-- layer2_stage1_expert_39_gpu12&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge489" class="edge">
<title>layer2_stage1_expert_39_gpu12&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M40487.15,-991.64C40467.38,-979.66 40443.29,-967.17 40419.72,-960.29 40169.88,-887.36 39421.18,-868.7 39056.21,-863.93"/>
<polygon fill="black" stroke="black" points="39056.11,-860.43 39046.06,-863.8 39056.02,-867.43 39056.11,-860.43"/>
</g>
<!-- layer2_stage1_expert_40_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge490" class="edge">
<title>layer2_stage1_expert_40_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M40711.45,-991.71C40691.63,-979.67 40667.43,-967.11 40643.72,-960.29 40350.76,-876.01 39458.7,-863.31 39054.54,-862.01"/>
<polygon fill="black" stroke="black" points="39054.51,-858.51 39044.5,-861.98 39054.49,-865.51 39054.51,-858.51"/>
</g>
<!-- layer2_stage1_expert_41_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge491" class="edge">
<title>layer2_stage1_expert_41_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M40935.46,-991.64C40915.65,-979.59 40891.45,-967.03 40867.72,-960.29 40697.3,-911.82 39537.9,-878.77 39058.51,-867.02"/>
<polygon fill="black" stroke="black" points="39058.44,-863.52 39048.36,-866.78 39058.27,-870.52 39058.44,-863.52"/>
</g>
<!-- layer2_stage1_expert_42_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge492" class="edge">
<title>layer2_stage1_expert_42_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M41159.75,-991.75C41139.89,-979.64 41115.57,-967.01 41091.72,-960.29 40899.39,-906.09 39574.62,-875.79 39057.68,-865.92"/>
<polygon fill="black" stroke="black" points="39057.56,-862.41 39047.49,-865.72 39057.42,-869.41 39057.56,-862.41"/>
</g>
<!-- layer2_stage1_expert_43_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge493" class="edge">
<title>layer2_stage1_expert_43_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M41383.76,-991.7C41363.91,-979.58 41339.58,-966.96 41315.72,-960.29 41101.41,-900.36 39609.98,-873.13 39057.21,-865.02"/>
<polygon fill="black" stroke="black" points="39057.18,-861.52 39047.13,-864.87 39057.08,-868.52 39057.18,-861.52"/>
</g>
<!-- layer2_stage1_expert_44_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge494" class="edge">
<title>layer2_stage1_expert_44_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M41607.77,-991.67C41587.92,-979.54 41563.59,-966.92 41539.72,-960.29 41303.31,-894.6 39643.39,-870.72 39056.61,-864.27"/>
<polygon fill="black" stroke="black" points="39056.38,-860.77 39046.35,-864.16 39056.31,-867.77 39056.38,-860.77"/>
</g>
<!-- layer2_stage1_expert_45_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge495" class="edge">
<title>layer2_stage1_expert_45_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M41831.78,-991.63C41811.93,-979.5 41787.6,-966.89 41763.72,-960.29 41505.17,-888.84 39675.89,-868.51 39056.31,-863.64"/>
<polygon fill="black" stroke="black" points="39055.96,-860.14 39045.93,-863.56 39055.9,-867.14 39055.96,-860.14"/>
</g>
<!-- layer2_stage1_expert_46_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge496" class="edge">
<title>layer2_stage1_expert_46_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M42056.05,-991.77C42036.16,-979.58 42011.72,-966.89 41987.72,-960.29 41706.94,-883.06 39707.01,-866.47 39055.97,-863.1"/>
<polygon fill="black" stroke="black" points="39055.56,-859.6 39045.54,-863.05 39055.53,-866.6 39055.56,-859.6"/>
</g>
<!-- layer2_stage1_expert_47_gpu13&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge497" class="edge">
<title>layer2_stage1_expert_47_gpu13&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M42280.06,-991.75C42260.16,-979.55 42235.73,-966.86 42211.72,-960.29 41908.56,-877.24 39735.86,-864.57 39055.12,-862.63"/>
<polygon fill="black" stroke="black" points="39054.97,-859.13 39044.96,-862.6 39054.95,-866.13 39054.97,-859.13"/>
</g>
<!-- layer2_stage1_expert_48_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge498" class="edge">
<title>layer2_stage1_expert_48_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M42504.07,-991.73C42484.17,-979.53 42459.73,-966.84 42435.72,-960.29 42110.2,-871.44 39764.79,-862.79 39054.82,-862.23"/>
<polygon fill="black" stroke="black" points="39054.75,-858.73 39044.75,-862.22 39054.74,-865.73 39054.75,-858.73"/>
</g>
<!-- layer2_stage1_expert_49_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge499" class="edge">
<title>layer2_stage1_expert_49_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M42728.07,-991.71C42708.18,-979.51 42683.74,-966.82 42659.72,-960.29 42311.81,-865.63 39793.28,-861.13 39054.75,-861.87"/>
<polygon fill="black" stroke="black" points="39054.53,-858.37 39044.54,-861.88 39054.54,-865.37 39054.53,-858.37"/>
</g>
<!-- layer2_stage1_expert_50_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge500" class="edge">
<title>layer2_stage1_expert_50_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M42952.08,-991.69C42932.18,-979.49 42907.74,-966.8 42883.72,-960.29 42697.81,-909.85 39851.47,-873.7 39056.53,-864.55"/>
<polygon fill="black" stroke="black" points="39056.45,-861.05 39046.41,-864.44 39056.37,-868.05 39056.45,-861.05"/>
</g>
<!-- layer2_stage1_expert_51_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge501" class="edge">
<title>layer2_stage1_expert_51_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M43176.08,-991.68C43156.19,-979.47 43131.75,-966.79 43107.72,-960.29 42910.54,-906.92 39879.02,-872.63 39056.35,-864.28"/>
<polygon fill="black" stroke="black" points="39056.21,-860.78 39046.18,-864.17 39056.14,-867.78 39056.21,-860.78"/>
</g>
<!-- layer2_stage1_expert_52_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge502" class="edge">
<title>layer2_stage1_expert_52_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M43400.08,-991.66C43380.19,-979.45 43355.75,-966.78 43331.72,-960.29 43123.26,-904 39906.19,-871.63 39056.32,-864.03"/>
<polygon fill="black" stroke="black" points="39056.15,-860.53 39046.12,-863.94 39056.09,-867.53 39056.15,-860.53"/>
</g>
<!-- layer2_stage1_expert_53_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge503" class="edge">
<title>layer2_stage1_expert_53_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M43624.09,-991.65C43604.19,-979.44 43579.75,-966.76 43555.72,-960.29 43335.96,-901.07 39932.46,-870.68 39056.2,-863.81"/>
<polygon fill="black" stroke="black" points="39056.03,-860.31 39046,-863.73 39055.98,-867.31 39056.03,-860.31"/>
</g>
<!-- layer2_stage1_expert_54_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge504" class="edge">
<title>layer2_stage1_expert_54_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M43848.09,-991.64C43828.2,-979.43 43803.76,-966.75 43779.72,-960.29 43548.63,-898.14 39958.1,-869.77 39056.08,-863.6"/>
<polygon fill="black" stroke="black" points="39055.94,-860.1 39045.92,-863.53 39055.9,-867.1 39055.94,-860.1"/>
</g>
<!-- layer2_stage1_expert_55_gpu14&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge505" class="edge">
<title>layer2_stage1_expert_55_gpu14&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M44072.09,-991.63C44052.2,-979.41 44027.76,-966.74 44003.72,-960.29 43761.27,-895.19 39982.35,-868.9 39055.68,-863.42"/>
<polygon fill="black" stroke="black" points="39055.6,-859.92 39045.57,-863.36 39055.55,-866.92 39055.6,-859.92"/>
</g>
<!-- layer2_stage1_expert_56_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge506" class="edge">
<title>layer2_stage1_expert_56_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M44296.36,-991.79C44276.42,-979.52 44251.87,-966.76 44227.72,-960.29 43973.9,-892.25 40006.43,-868.08 39055.43,-863.25"/>
<polygon fill="black" stroke="black" points="39055.42,-859.75 39045.4,-863.2 39055.39,-866.75 39055.42,-859.75"/>
</g>
<!-- layer2_stage1_expert_57_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge507" class="edge">
<title>layer2_stage1_expert_57_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M44520.36,-991.78C44500.42,-979.51 44475.87,-966.75 44451.72,-960.29 44186.57,-889.31 40031.65,-867.3 39055.77,-863.09"/>
<polygon fill="black" stroke="black" points="39055.5,-859.59 39045.49,-863.05 39055.47,-866.59 39055.5,-859.59"/>
</g>
<!-- layer2_stage1_expert_58_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge508" class="edge">
<title>layer2_stage1_expert_58_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M44744.37,-991.77C44724.43,-979.5 44699.87,-966.74 44675.72,-960.29 44399.19,-886.37 40055.1,-866.54 39055.65,-862.95"/>
<polygon fill="black" stroke="black" points="39055.5,-859.45 39045.49,-862.91 39055.47,-866.45 39055.5,-859.45"/>
</g>
<!-- layer2_stage1_expert_59_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge509" class="edge">
<title>layer2_stage1_expert_59_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M44968.37,-991.76C44948.43,-979.49 44923.87,-966.74 44899.72,-960.29 44611.79,-883.42 40077.91,-865.81 39055.47,-862.81"/>
<polygon fill="black" stroke="black" points="39055.46,-859.31 39045.45,-862.78 39055.44,-866.31 39055.46,-859.31"/>
</g>
<!-- layer2_stage1_expert_60_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge510" class="edge">
<title>layer2_stage1_expert_60_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M45192.37,-991.76C45172.43,-979.48 45147.88,-966.73 45123.72,-960.29 44973.84,-920.32 40120.17,-873.85 39056.42,-864.12"/>
<polygon fill="black" stroke="black" points="39056.41,-860.62 39046.38,-864.03 39056.35,-867.62 39056.41,-860.62"/>
</g>
<!-- layer2_stage1_expert_61_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge511" class="edge">
<title>layer2_stage1_expert_61_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M45416.37,-991.75C45396.43,-979.47 45371.88,-966.72 45347.72,-960.29 45192.14,-918.84 40143.46,-873.34 39056.56,-864.01"/>
<polygon fill="black" stroke="black" points="39056.33,-860.51 39046.3,-863.93 39056.27,-867.51 39056.33,-860.51"/>
</g>
<!-- layer2_stage1_expert_62_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge512" class="edge">
<title>layer2_stage1_expert_62_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M45640.37,-991.74C45620.44,-979.47 45595.88,-966.72 45571.72,-960.29 45491.01,-938.81 40175.18,-877.31 39056.79,-864.6"/>
<polygon fill="black" stroke="black" points="39056.68,-861.1 39046.64,-864.49 39056.6,-868.1 39056.68,-861.1"/>
</g>
<!-- layer2_stage1_expert_63_gpu15&#45;&gt;layer2_stage1_expert_aggregate -->
<g id="edge513" class="edge">
<title>layer2_stage1_expert_63_gpu15&#45;&gt;layer2_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M45864.37,-991.74C45844.44,-979.46 45819.88,-966.71 45795.72,-960.29 45712.16,-938.07 40198.35,-876.93 39057.07,-864.51"/>
<polygon fill="black" stroke="black" points="39056.75,-861 39046.72,-864.39 39056.68,-868 39056.75,-861"/>
</g>
<!-- layer2_stage1_expert_residual -->
<g id="node308" class="node">
<title>layer2_stage1_expert_residual</title>
<ellipse fill="none" stroke="black" cx="46212.72" cy="-1185.29" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="46212.72" y="-1204.79" font-family="Arial" font-size="10.00">layer2_stage1_expert_residual</text>
<text text-anchor="middle" x="46212.72" y="-1193.79" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="46212.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="46212.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="46212.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_input_reshape -->
<g id="node309" class="node">
<title>layer3_stage1_input_reshape</title>
<ellipse fill="none" stroke="black" cx="46212.72" cy="-1023.29" rx="183.7" ry="44.6"/>
<text text-anchor="middle" x="46212.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_input_reshape</text>
<text text-anchor="middle" x="46212.72" y="-1031.79" font-family="Arial" font-size="10.00">Input Reshape</text>
<text text-anchor="middle" x="46212.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="46212.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
<text text-anchor="middle" x="46212.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer2_stage1_expert_residual&#45;&gt;layer3_stage1_input_reshape -->
<g id="edge685" class="edge">
<title>layer2_stage1_expert_residual&#45;&gt;layer3_stage1_input_reshape</title>
<path fill="none" stroke="black" d="M46212.72,-1140.57C46212.72,-1121.25 46212.72,-1098.36 46212.72,-1078.02"/>
<polygon fill="black" stroke="black" points="46216.22,-1077.95 46212.72,-1067.95 46209.22,-1077.95 46216.22,-1077.95"/>
</g>
<!-- layer3_stage1_qkv_proj_0 -->
<g id="node310" class="node">
<title>layer3_stage1_qkv_proj_0</title>
<polygon fill="none" stroke="black" points="44666.72,-892.79 44414.72,-892.79 44414.72,-829.79 44666.72,-829.79 44666.72,-892.79"/>
<text text-anchor="middle" x="44540.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_0</text>
<text text-anchor="middle" x="44540.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;0)</text>
<text text-anchor="middle" x="44540.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="44540.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="44540.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_0 -->
<g id="edge515" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_0</title>
<path fill="none" stroke="black" d="M46115.86,-985.33C46085.52,-975.34 46051.63,-965.79 46019.72,-960.29 45504.85,-871.52 45363.68,-984.71 44844.72,-924.29 44789.05,-917.81 44728.42,-906.35 44676.05,-895.04"/>
<polygon fill="black" stroke="black" points="44676.55,-891.56 44666.03,-892.85 44675.06,-898.4 44676.55,-891.56"/>
</g>
<!-- layer3_stage1_qkv_proj_1 -->
<g id="node311" class="node">
<title>layer3_stage1_qkv_proj_1</title>
<polygon fill="none" stroke="black" points="45105.72,-892.79 44853.72,-892.79 44853.72,-829.79 45105.72,-829.79 45105.72,-892.79"/>
<text text-anchor="middle" x="44979.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_1</text>
<text text-anchor="middle" x="44979.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;1)</text>
<text text-anchor="middle" x="44979.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="44979.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="44979.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_1 -->
<g id="edge516" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_1</title>
<path fill="none" stroke="black" d="M46114.81,-985.36C46084.72,-975.51 46051.23,-966.02 46019.72,-960.29 45697.5,-901.7 45608.66,-965.13 45283.72,-924.29 45228.36,-917.33 45168.04,-905.85 45115.83,-894.65"/>
<polygon fill="black" stroke="black" points="45116.35,-891.18 45105.84,-892.49 45114.87,-898.03 45116.35,-891.18"/>
</g>
<!-- layer3_stage1_qkv_proj_2 -->
<g id="node312" class="node">
<title>layer3_stage1_qkv_proj_2</title>
<polygon fill="none" stroke="black" points="45544.72,-892.79 45292.72,-892.79 45292.72,-829.79 45544.72,-829.79 45544.72,-892.79"/>
<text text-anchor="middle" x="45418.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_2</text>
<text text-anchor="middle" x="45418.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;2)</text>
<text text-anchor="middle" x="45418.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="45418.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="45418.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_2 -->
<g id="edge517" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_2</title>
<path fill="none" stroke="black" d="M46112.04,-985.95C46082.6,-976.42 46050.14,-966.95 46019.72,-960.29 45889.83,-931.82 45853.97,-945.59 45722.72,-924.29 45667.52,-915.33 45607.1,-903.44 45554.77,-892.47"/>
<polygon fill="black" stroke="black" points="45555.27,-889 45544.76,-890.36 45553.82,-895.85 45555.27,-889"/>
</g>
<!-- layer3_stage1_qkv_proj_3 -->
<g id="node313" class="node">
<title>layer3_stage1_qkv_proj_3</title>
<polygon fill="none" stroke="black" points="45983.72,-892.79 45731.72,-892.79 45731.72,-829.79 45983.72,-829.79 45983.72,-892.79"/>
<text text-anchor="middle" x="45857.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_3</text>
<text text-anchor="middle" x="45857.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;3)</text>
<text text-anchor="middle" x="45857.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="45857.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="45857.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_3 -->
<g id="edge518" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_3</title>
<path fill="none" stroke="black" d="M46127.23,-983.76C46068.64,-957.35 45991.55,-922.61 45934.84,-897.04"/>
<polygon fill="black" stroke="black" points="45936.12,-893.78 45925.56,-892.86 45933.24,-900.16 45936.12,-893.78"/>
</g>
<!-- layer3_stage1_qkv_proj_4 -->
<g id="node314" class="node">
<title>layer3_stage1_qkv_proj_4</title>
<polygon fill="none" stroke="black" points="46338.72,-892.79 46086.72,-892.79 46086.72,-829.79 46338.72,-829.79 46338.72,-892.79"/>
<text text-anchor="middle" x="46212.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_4</text>
<text text-anchor="middle" x="46212.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;4)</text>
<text text-anchor="middle" x="46212.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="46212.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="46212.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_4 -->
<g id="edge519" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_4</title>
<path fill="none" stroke="black" d="M46212.72,-978.57C46212.72,-955.14 46212.72,-926.44 46212.72,-903.42"/>
<polygon fill="black" stroke="black" points="46216.22,-903.28 46212.72,-893.28 46209.22,-903.28 46216.22,-903.28"/>
</g>
<!-- layer3_stage1_qkv_proj_5 -->
<g id="node315" class="node">
<title>layer3_stage1_qkv_proj_5</title>
<polygon fill="none" stroke="black" points="46693.72,-892.79 46441.72,-892.79 46441.72,-829.79 46693.72,-829.79 46693.72,-892.79"/>
<text text-anchor="middle" x="46567.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_5</text>
<text text-anchor="middle" x="46567.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;5)</text>
<text text-anchor="middle" x="46567.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="46567.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="46567.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_5 -->
<g id="edge520" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_5</title>
<path fill="none" stroke="black" d="M46298.2,-983.76C46356.8,-957.35 46433.88,-922.61 46490.6,-897.04"/>
<polygon fill="black" stroke="black" points="46492.2,-900.16 46499.88,-892.86 46489.32,-893.78 46492.2,-900.16"/>
</g>
<!-- layer3_stage1_qkv_proj_6 -->
<g id="node316" class="node">
<title>layer3_stage1_qkv_proj_6</title>
<polygon fill="none" stroke="black" points="47089.72,-892.79 46837.72,-892.79 46837.72,-829.79 47089.72,-829.79 47089.72,-892.79"/>
<text text-anchor="middle" x="46963.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_6</text>
<text text-anchor="middle" x="46963.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;6)</text>
<text text-anchor="middle" x="46963.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="46963.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="46963.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_6 -->
<g id="edge521" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_6</title>
<path fill="none" stroke="black" d="M46313.39,-985.95C46342.84,-976.42 46375.29,-966.95 46405.72,-960.29 46535.6,-931.82 46571.83,-947.69 46702.72,-924.29 46747.06,-916.36 46795.15,-905.57 46837.83,-895.22"/>
<polygon fill="black" stroke="black" points="46838.81,-898.58 46847.7,-892.81 46837.15,-891.78 46838.81,-898.58"/>
</g>
<!-- layer3_stage1_qkv_proj_7 -->
<g id="node317" class="node">
<title>layer3_stage1_qkv_proj_7</title>
<polygon fill="none" stroke="black" points="47507.72,-892.79 47255.72,-892.79 47255.72,-829.79 47507.72,-829.79 47507.72,-892.79"/>
<text text-anchor="middle" x="47381.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_qkv_proj_7</text>
<text text-anchor="middle" x="47381.72" y="-869.79" font-family="Arial" font-size="10.00">QKV Projection (TP&#45;7)</text>
<text text-anchor="middle" x="47381.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="47381.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024</text>
<text text-anchor="middle" x="47381.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, heads=2, head_dim=1536</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_7 -->
<g id="edge522" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_qkv_proj_7</title>
<path fill="none" stroke="black" d="M46310.64,-985.42C46340.72,-975.57 46374.22,-966.06 46405.72,-960.29 46709.07,-904.66 46793.06,-965.43 47098.72,-924.29 47149.67,-917.43 47205.04,-906.16 47253.19,-895.1"/>
<polygon fill="black" stroke="black" points="47254.08,-898.49 47263.04,-892.82 47252.5,-891.67 47254.08,-898.49"/>
</g>
<!-- layer3_stage1_attention_residual -->
<g id="node343" class="node">
<title>layer3_stage1_attention_residual</title>
<ellipse fill="none" stroke="black" cx="46990.72" cy="-188.1" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="46990.72" y="-207.6" font-family="Arial" font-size="10.00">layer3_stage1_attention_residual</text>
<text text-anchor="middle" x="46990.72" y="-196.6" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="46990.72" y="-185.6" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="46990.72" y="-174.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="46990.72" y="-163.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_input_reshape&#45;&gt;layer3_stage1_attention_residual -->
<g id="edge555" class="edge">
<title>layer3_stage1_input_reshape&#45;&gt;layer3_stage1_attention_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46309.58,-985.36C46339.92,-975.38 46373.82,-965.82 46405.72,-960.29 46649.11,-918.1 47282.24,-1001.98 47516.72,-924.29 47653.91,-878.83 47768.72,-863.27 47768.72,-718.74 47768.72,-718.74 47768.72,-718.74 47768.72,-479.6 47768.72,-346.5 47364.04,-254.28 47138.41,-213.21"/>
<polygon fill="black" stroke="black" points="47138.93,-209.74 47128.46,-211.41 47137.68,-216.63 47138.93,-209.74"/>
</g>
<!-- layer3_stage1_qkv_reshape_0 -->
<g id="node318" class="node">
<title>layer3_stage1_qkv_reshape_0</title>
<ellipse fill="none" stroke="black" cx="44456.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="44456.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_0</text>
<text text-anchor="middle" x="44456.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;0)</text>
<text text-anchor="middle" x="44456.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="44456.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="44456.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_0&#45;&gt;layer3_stage1_qkv_reshape_0 -->
<g id="edge523" class="edge">
<title>layer3_stage1_qkv_proj_0&#45;&gt;layer3_stage1_qkv_reshape_0</title>
<path fill="none" stroke="black" d="M44522.49,-829.57C44512.28,-812.36 44499.27,-790.44 44487.52,-770.64"/>
<polygon fill="black" stroke="black" points="44490.51,-768.82 44482.4,-762.01 44484.49,-772.4 44490.51,-768.82"/>
</g>
<!-- layer3_stage1_qkv_reshape_1 -->
<g id="node319" class="node">
<title>layer3_stage1_qkv_reshape_1</title>
<ellipse fill="none" stroke="black" cx="44895.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="44895.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_1</text>
<text text-anchor="middle" x="44895.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;1)</text>
<text text-anchor="middle" x="44895.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="44895.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="44895.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_1&#45;&gt;layer3_stage1_qkv_reshape_1 -->
<g id="edge524" class="edge">
<title>layer3_stage1_qkv_proj_1&#45;&gt;layer3_stage1_qkv_reshape_1</title>
<path fill="none" stroke="black" d="M44961.49,-829.57C44951.28,-812.36 44938.27,-790.44 44926.52,-770.64"/>
<polygon fill="black" stroke="black" points="44929.51,-768.82 44921.4,-762.01 44923.49,-772.4 44929.51,-768.82"/>
</g>
<!-- layer3_stage1_qkv_reshape_2 -->
<g id="node320" class="node">
<title>layer3_stage1_qkv_reshape_2</title>
<ellipse fill="none" stroke="black" cx="45334.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="45334.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_2</text>
<text text-anchor="middle" x="45334.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;2)</text>
<text text-anchor="middle" x="45334.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="45334.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="45334.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_2&#45;&gt;layer3_stage1_qkv_reshape_2 -->
<g id="edge525" class="edge">
<title>layer3_stage1_qkv_proj_2&#45;&gt;layer3_stage1_qkv_reshape_2</title>
<path fill="none" stroke="black" d="M45400.49,-829.57C45390.28,-812.36 45377.27,-790.44 45365.52,-770.64"/>
<polygon fill="black" stroke="black" points="45368.51,-768.82 45360.4,-762.01 45362.49,-772.4 45368.51,-768.82"/>
</g>
<!-- layer3_stage1_qkv_reshape_3 -->
<g id="node321" class="node">
<title>layer3_stage1_qkv_reshape_3</title>
<ellipse fill="none" stroke="black" cx="45773.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="45773.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_3</text>
<text text-anchor="middle" x="45773.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;3)</text>
<text text-anchor="middle" x="45773.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="45773.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="45773.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_3&#45;&gt;layer3_stage1_qkv_reshape_3 -->
<g id="edge526" class="edge">
<title>layer3_stage1_qkv_proj_3&#45;&gt;layer3_stage1_qkv_reshape_3</title>
<path fill="none" stroke="black" d="M45839.49,-829.57C45829.28,-812.36 45816.27,-790.44 45804.52,-770.64"/>
<polygon fill="black" stroke="black" points="45807.51,-768.82 45799.4,-762.01 45801.49,-772.4 45807.51,-768.82"/>
</g>
<!-- layer3_stage1_qkv_reshape_4 -->
<g id="node322" class="node">
<title>layer3_stage1_qkv_reshape_4</title>
<ellipse fill="none" stroke="black" cx="46212.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="46212.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_4</text>
<text text-anchor="middle" x="46212.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;4)</text>
<text text-anchor="middle" x="46212.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="46212.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="46212.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_4&#45;&gt;layer3_stage1_qkv_reshape_4 -->
<g id="edge527" class="edge">
<title>layer3_stage1_qkv_proj_4&#45;&gt;layer3_stage1_qkv_reshape_4</title>
<path fill="none" stroke="black" d="M46212.72,-829.57C46212.72,-812.96 46212.72,-791.96 46212.72,-772.72"/>
<polygon fill="black" stroke="black" points="46216.22,-772.55 46212.72,-762.55 46209.22,-772.55 46216.22,-772.55"/>
</g>
<!-- layer3_stage1_qkv_reshape_5 -->
<g id="node323" class="node">
<title>layer3_stage1_qkv_reshape_5</title>
<ellipse fill="none" stroke="black" cx="46651.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="46651.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_5</text>
<text text-anchor="middle" x="46651.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;5)</text>
<text text-anchor="middle" x="46651.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="46651.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="46651.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_5&#45;&gt;layer3_stage1_qkv_reshape_5 -->
<g id="edge528" class="edge">
<title>layer3_stage1_qkv_proj_5&#45;&gt;layer3_stage1_qkv_reshape_5</title>
<path fill="none" stroke="black" d="M46585.94,-829.57C46596.16,-812.36 46609.17,-790.44 46620.92,-770.64"/>
<polygon fill="black" stroke="black" points="46623.94,-772.4 46626.04,-762.01 46617.92,-768.82 46623.94,-772.4"/>
</g>
<!-- layer3_stage1_qkv_reshape_6 -->
<g id="node324" class="node">
<title>layer3_stage1_qkv_reshape_6</title>
<ellipse fill="none" stroke="black" cx="47090.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="47090.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_6</text>
<text text-anchor="middle" x="47090.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;6)</text>
<text text-anchor="middle" x="47090.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="47090.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="47090.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_6&#45;&gt;layer3_stage1_qkv_reshape_6 -->
<g id="edge529" class="edge">
<title>layer3_stage1_qkv_proj_6&#45;&gt;layer3_stage1_qkv_reshape_6</title>
<path fill="none" stroke="black" d="M46991.27,-829.57C47007.06,-811.98 47027.26,-789.46 47045.33,-769.33"/>
<polygon fill="black" stroke="black" points="47048.06,-771.52 47052.13,-761.74 47042.85,-766.85 47048.06,-771.52"/>
</g>
<!-- layer3_stage1_qkv_reshape_7 -->
<g id="node325" class="node">
<title>layer3_stage1_qkv_reshape_7</title>
<ellipse fill="none" stroke="black" cx="47529.72" cy="-717.74" rx="210.94" ry="44.6"/>
<text text-anchor="middle" x="47529.72" y="-737.24" font-family="Arial" font-size="10.00">layer3_stage1_qkv_reshape_7</text>
<text text-anchor="middle" x="47529.72" y="-726.24" font-family="Arial" font-size="10.00">QKV Reshape (TP&#45;7)</text>
<text text-anchor="middle" x="47529.72" y="-715.24" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="47529.72" y="-704.24" font-family="Arial" font-size="10.00">In: batch_size=10240000, heads=2, head_dim=1536</text>
<text text-anchor="middle" x="47529.72" y="-693.24" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_proj_7&#45;&gt;layer3_stage1_qkv_reshape_7 -->
<g id="edge530" class="edge">
<title>layer3_stage1_qkv_proj_7&#45;&gt;layer3_stage1_qkv_reshape_7</title>
<path fill="none" stroke="black" d="M47413.83,-829.57C47432.46,-811.75 47456.38,-788.88 47477.64,-768.55"/>
<polygon fill="black" stroke="black" points="47480.23,-770.91 47485.04,-761.47 47475.39,-765.86 47480.23,-770.91"/>
</g>
<!-- layer3_stage1_attention_0 -->
<g id="node326" class="node">
<title>layer3_stage1_attention_0</title>
<polygon fill="none" stroke="black" points="44700.72,-624.14 44402.72,-624.14 44402.72,-561.14 44700.72,-561.14 44700.72,-624.14"/>
<text text-anchor="middle" x="44551.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_0</text>
<text text-anchor="middle" x="44551.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;0)</text>
<text text-anchor="middle" x="44551.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="44551.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="44551.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_0&#45;&gt;layer3_stage1_attention_0 -->
<g id="edge531" class="edge">
<title>layer3_stage1_qkv_reshape_0&#45;&gt;layer3_stage1_attention_0</title>
<path fill="none" stroke="black" d="M44489.94,-673.69C44500.31,-660.25 44511.68,-645.52 44521.81,-632.4"/>
<polygon fill="black" stroke="black" points="44524.59,-634.52 44527.93,-624.46 44519.05,-630.24 44524.59,-634.52"/>
</g>
<!-- layer3_stage1_attention_1 -->
<g id="node327" class="node">
<title>layer3_stage1_attention_1</title>
<polygon fill="none" stroke="black" points="45077.72,-624.14 44779.72,-624.14 44779.72,-561.14 45077.72,-561.14 45077.72,-624.14"/>
<text text-anchor="middle" x="44928.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_1</text>
<text text-anchor="middle" x="44928.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;1)</text>
<text text-anchor="middle" x="44928.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="44928.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="44928.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_1&#45;&gt;layer3_stage1_attention_1 -->
<g id="edge532" class="edge">
<title>layer3_stage1_qkv_reshape_1&#45;&gt;layer3_stage1_attention_1</title>
<path fill="none" stroke="black" d="M44907.45,-672.99C44910.8,-660.47 44914.45,-646.87 44917.76,-634.52"/>
<polygon fill="black" stroke="black" points="44921.24,-635.06 44920.45,-624.5 44914.48,-633.25 44921.24,-635.06"/>
</g>
<!-- layer3_stage1_attention_2 -->
<g id="node328" class="node">
<title>layer3_stage1_attention_2</title>
<polygon fill="none" stroke="black" points="45516.72,-624.14 45218.72,-624.14 45218.72,-561.14 45516.72,-561.14 45516.72,-624.14"/>
<text text-anchor="middle" x="45367.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_2</text>
<text text-anchor="middle" x="45367.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;2)</text>
<text text-anchor="middle" x="45367.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="45367.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="45367.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_2&#45;&gt;layer3_stage1_attention_2 -->
<g id="edge533" class="edge">
<title>layer3_stage1_qkv_reshape_2&#45;&gt;layer3_stage1_attention_2</title>
<path fill="none" stroke="black" d="M45346.45,-672.99C45349.8,-660.47 45353.45,-646.87 45356.76,-634.52"/>
<polygon fill="black" stroke="black" points="45360.24,-635.06 45359.45,-624.5 45353.48,-633.25 45360.24,-635.06"/>
</g>
<!-- layer3_stage1_attention_3 -->
<g id="node329" class="node">
<title>layer3_stage1_attention_3</title>
<polygon fill="none" stroke="black" points="45955.72,-624.14 45657.72,-624.14 45657.72,-561.14 45955.72,-561.14 45955.72,-624.14"/>
<text text-anchor="middle" x="45806.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_3</text>
<text text-anchor="middle" x="45806.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;3)</text>
<text text-anchor="middle" x="45806.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="45806.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="45806.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_3&#45;&gt;layer3_stage1_attention_3 -->
<g id="edge534" class="edge">
<title>layer3_stage1_qkv_reshape_3&#45;&gt;layer3_stage1_attention_3</title>
<path fill="none" stroke="black" d="M45785.45,-672.99C45788.8,-660.47 45792.45,-646.87 45795.76,-634.52"/>
<polygon fill="black" stroke="black" points="45799.24,-635.06 45798.45,-624.5 45792.48,-633.25 45799.24,-635.06"/>
</g>
<!-- layer3_stage1_attention_4 -->
<g id="node330" class="node">
<title>layer3_stage1_attention_4</title>
<polygon fill="none" stroke="black" points="46361.72,-624.14 46063.72,-624.14 46063.72,-561.14 46361.72,-561.14 46361.72,-624.14"/>
<text text-anchor="middle" x="46212.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_4</text>
<text text-anchor="middle" x="46212.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;4)</text>
<text text-anchor="middle" x="46212.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="46212.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="46212.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_4&#45;&gt;layer3_stage1_attention_4 -->
<g id="edge535" class="edge">
<title>layer3_stage1_qkv_reshape_4&#45;&gt;layer3_stage1_attention_4</title>
<path fill="none" stroke="black" d="M46212.72,-672.99C46212.72,-660.47 46212.72,-646.87 46212.72,-634.52"/>
<polygon fill="black" stroke="black" points="46216.22,-634.5 46212.72,-624.5 46209.22,-634.5 46216.22,-634.5"/>
</g>
<!-- layer3_stage1_attention_5 -->
<g id="node331" class="node">
<title>layer3_stage1_attention_5</title>
<polygon fill="none" stroke="black" points="46739.72,-624.14 46441.72,-624.14 46441.72,-561.14 46739.72,-561.14 46739.72,-624.14"/>
<text text-anchor="middle" x="46590.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_5</text>
<text text-anchor="middle" x="46590.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;5)</text>
<text text-anchor="middle" x="46590.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="46590.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="46590.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_5&#45;&gt;layer3_stage1_attention_5 -->
<g id="edge536" class="edge">
<title>layer3_stage1_qkv_reshape_5&#45;&gt;layer3_stage1_attention_5</title>
<path fill="none" stroke="black" d="M46630.21,-673.34C46623.75,-660.31 46616.7,-646.08 46610.37,-633.3"/>
<polygon fill="black" stroke="black" points="46613.48,-631.7 46605.9,-624.29 46607.21,-634.8 46613.48,-631.7"/>
</g>
<!-- layer3_stage1_attention_6 -->
<g id="node332" class="node">
<title>layer3_stage1_attention_6</title>
<polygon fill="none" stroke="black" points="47147.72,-624.14 46849.72,-624.14 46849.72,-561.14 47147.72,-561.14 47147.72,-624.14"/>
<text text-anchor="middle" x="46998.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_6</text>
<text text-anchor="middle" x="46998.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;6)</text>
<text text-anchor="middle" x="46998.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="46998.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="46998.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_6&#45;&gt;layer3_stage1_attention_6 -->
<g id="edge537" class="edge">
<title>layer3_stage1_qkv_reshape_6&#45;&gt;layer3_stage1_attention_6</title>
<path fill="none" stroke="black" d="M47058.54,-673.69C47048.59,-660.38 47037.7,-645.8 47027.96,-632.77"/>
<polygon fill="black" stroke="black" points="47030.54,-630.38 47021.75,-624.46 47024.93,-634.57 47030.54,-630.38"/>
</g>
<!-- layer3_stage1_attention_7 -->
<g id="node333" class="node">
<title>layer3_stage1_attention_7</title>
<polygon fill="none" stroke="black" points="47571.72,-624.14 47273.72,-624.14 47273.72,-561.14 47571.72,-561.14 47571.72,-624.14"/>
<text text-anchor="middle" x="47422.72" y="-612.14" font-family="Arial" font-size="10.00">layer3_stage1_attention_7</text>
<text text-anchor="middle" x="47422.72" y="-601.14" font-family="Arial" font-size="10.00">Multi&#45;Head Attention (TP&#45;7)</text>
<text text-anchor="middle" x="47422.72" y="-590.14" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="47422.72" y="-579.14" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="47422.72" y="-568.14" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
</g>
<!-- layer3_stage1_qkv_reshape_7&#45;&gt;layer3_stage1_attention_7 -->
<g id="edge538" class="edge">
<title>layer3_stage1_qkv_reshape_7&#45;&gt;layer3_stage1_attention_7</title>
<path fill="none" stroke="black" d="M47492.29,-673.69C47480.51,-660.12 47467.57,-645.24 47456.08,-632.03"/>
<polygon fill="black" stroke="black" points="47458.71,-629.71 47449.51,-624.46 47453.43,-634.31 47458.71,-629.71"/>
</g>
<!-- layer3_stage1_output_proj_0 -->
<g id="node334" class="node">
<title>layer3_stage1_output_proj_0</title>
<polygon fill="none" stroke="black" points="44796.72,-512.1 44506.72,-512.1 44506.72,-449.1 44796.72,-449.1 44796.72,-512.1"/>
<text text-anchor="middle" x="44651.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_0</text>
<text text-anchor="middle" x="44651.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;0)</text>
<text text-anchor="middle" x="44651.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="44651.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="44651.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_0&#45;&gt;layer3_stage1_output_proj_0 -->
<g id="edge539" class="edge">
<title>layer3_stage1_attention_0&#45;&gt;layer3_stage1_output_proj_0</title>
<path fill="none" stroke="black" d="M44579.57,-560.99C44591.07,-548.34 44604.53,-533.53 44616.68,-520.15"/>
<polygon fill="black" stroke="black" points="44619.53,-522.22 44623.66,-512.47 44614.35,-517.51 44619.53,-522.22"/>
</g>
<!-- layer3_stage1_output_proj_1 -->
<g id="node335" class="node">
<title>layer3_stage1_output_proj_1</title>
<polygon fill="none" stroke="black" points="45138.72,-512.1 44848.72,-512.1 44848.72,-449.1 45138.72,-449.1 45138.72,-512.1"/>
<text text-anchor="middle" x="44993.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_1</text>
<text text-anchor="middle" x="44993.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;1)</text>
<text text-anchor="middle" x="44993.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="44993.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="44993.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_1&#45;&gt;layer3_stage1_output_proj_1 -->
<g id="edge540" class="edge">
<title>layer3_stage1_attention_1&#45;&gt;layer3_stage1_output_proj_1</title>
<path fill="none" stroke="black" d="M44946.82,-560.99C44954.09,-548.69 44962.55,-534.36 44970.28,-521.28"/>
<polygon fill="black" stroke="black" points="44973.41,-522.86 44975.48,-512.47 44967.38,-519.3 44973.41,-522.86"/>
</g>
<!-- layer3_stage1_output_proj_2 -->
<g id="node336" class="node">
<title>layer3_stage1_output_proj_2</title>
<polygon fill="none" stroke="black" points="45577.72,-512.1 45287.72,-512.1 45287.72,-449.1 45577.72,-449.1 45577.72,-512.1"/>
<text text-anchor="middle" x="45432.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_2</text>
<text text-anchor="middle" x="45432.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;2)</text>
<text text-anchor="middle" x="45432.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="45432.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="45432.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_2&#45;&gt;layer3_stage1_output_proj_2 -->
<g id="edge541" class="edge">
<title>layer3_stage1_attention_2&#45;&gt;layer3_stage1_output_proj_2</title>
<path fill="none" stroke="black" d="M45385.82,-560.99C45393.09,-548.69 45401.55,-534.36 45409.28,-521.28"/>
<polygon fill="black" stroke="black" points="45412.41,-522.86 45414.48,-512.47 45406.38,-519.3 45412.41,-522.86"/>
</g>
<!-- layer3_stage1_output_proj_3 -->
<g id="node337" class="node">
<title>layer3_stage1_output_proj_3</title>
<polygon fill="none" stroke="black" points="46016.72,-512.1 45726.72,-512.1 45726.72,-449.1 46016.72,-449.1 46016.72,-512.1"/>
<text text-anchor="middle" x="45871.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_3</text>
<text text-anchor="middle" x="45871.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;3)</text>
<text text-anchor="middle" x="45871.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="45871.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="45871.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_3&#45;&gt;layer3_stage1_output_proj_3 -->
<g id="edge542" class="edge">
<title>layer3_stage1_attention_3&#45;&gt;layer3_stage1_output_proj_3</title>
<path fill="none" stroke="black" d="M45824.82,-560.99C45832.09,-548.69 45840.55,-534.36 45848.28,-521.28"/>
<polygon fill="black" stroke="black" points="45851.41,-522.86 45853.48,-512.47 45845.38,-519.3 45851.41,-522.86"/>
</g>
<!-- layer3_stage1_output_proj_4 -->
<g id="node338" class="node">
<title>layer3_stage1_output_proj_4</title>
<polygon fill="none" stroke="black" points="46357.72,-512.1 46067.72,-512.1 46067.72,-449.1 46357.72,-449.1 46357.72,-512.1"/>
<text text-anchor="middle" x="46212.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_4</text>
<text text-anchor="middle" x="46212.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;4)</text>
<text text-anchor="middle" x="46212.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="46212.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="46212.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_4&#45;&gt;layer3_stage1_output_proj_4 -->
<g id="edge543" class="edge">
<title>layer3_stage1_attention_4&#45;&gt;layer3_stage1_output_proj_4</title>
<path fill="none" stroke="black" d="M46212.72,-560.99C46212.72,-549.16 46212.72,-535.46 46212.72,-522.79"/>
<polygon fill="black" stroke="black" points="46216.22,-522.47 46212.72,-512.47 46209.22,-522.47 46216.22,-522.47"/>
</g>
<!-- layer3_stage1_output_proj_5 -->
<g id="node339" class="node">
<title>layer3_stage1_output_proj_5</title>
<polygon fill="none" stroke="black" points="46700.72,-512.1 46410.72,-512.1 46410.72,-449.1 46700.72,-449.1 46700.72,-512.1"/>
<text text-anchor="middle" x="46555.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_5</text>
<text text-anchor="middle" x="46555.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;5)</text>
<text text-anchor="middle" x="46555.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="46555.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="46555.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_5&#45;&gt;layer3_stage1_output_proj_5 -->
<g id="edge544" class="edge">
<title>layer3_stage1_attention_5&#45;&gt;layer3_stage1_output_proj_5</title>
<path fill="none" stroke="black" d="M46580.97,-560.99C46577.13,-548.93 46572.67,-534.91 46568.58,-522.04"/>
<polygon fill="black" stroke="black" points="46571.9,-520.94 46565.54,-512.47 46565.23,-523.06 46571.9,-520.94"/>
</g>
<!-- layer3_stage1_output_proj_6 -->
<g id="node340" class="node">
<title>layer3_stage1_output_proj_6</title>
<polygon fill="none" stroke="black" points="47076.72,-512.1 46786.72,-512.1 46786.72,-449.1 47076.72,-449.1 47076.72,-512.1"/>
<text text-anchor="middle" x="46931.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_6</text>
<text text-anchor="middle" x="46931.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;6)</text>
<text text-anchor="middle" x="46931.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="46931.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="46931.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_6&#45;&gt;layer3_stage1_output_proj_6 -->
<g id="edge545" class="edge">
<title>layer3_stage1_attention_6&#45;&gt;layer3_stage1_output_proj_6</title>
<path fill="none" stroke="black" d="M46980.05,-560.99C46972.57,-548.69 46963.84,-534.36 46955.88,-521.28"/>
<polygon fill="black" stroke="black" points="46958.7,-519.19 46950.51,-512.47 46952.72,-522.83 46958.7,-519.19"/>
</g>
<!-- layer3_stage1_output_proj_7 -->
<g id="node341" class="node">
<title>layer3_stage1_output_proj_7</title>
<polygon fill="none" stroke="black" points="47476.72,-512.1 47186.72,-512.1 47186.72,-449.1 47476.72,-449.1 47476.72,-512.1"/>
<text text-anchor="middle" x="47331.72" y="-500.1" font-family="Arial" font-size="10.00">layer3_stage1_output_proj_7</text>
<text text-anchor="middle" x="47331.72" y="-489.1" font-family="Arial" font-size="10.00">Output Projection (TP&#45;7)</text>
<text text-anchor="middle" x="47331.72" y="-478.1" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="47331.72" y="-467.1" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, heads=2, head_dim=512</text>
<text text-anchor="middle" x="47331.72" y="-456.1" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=1024</text>
</g>
<!-- layer3_stage1_attention_7&#45;&gt;layer3_stage1_output_proj_7 -->
<g id="edge546" class="edge">
<title>layer3_stage1_attention_7&#45;&gt;layer3_stage1_output_proj_7</title>
<path fill="none" stroke="black" d="M47397.37,-560.99C47387,-548.45 47374.89,-533.8 47363.91,-520.53"/>
<polygon fill="black" stroke="black" points="47366.32,-517.94 47357.25,-512.47 47360.92,-522.4 47366.32,-517.94"/>
</g>
<!-- layer3_stage1_attention_allreduce -->
<g id="node342" class="node">
<title>layer3_stage1_attention_allreduce</title>
<polygon fill="none" stroke="black" points="46448.98,-413.1 46073.14,-413.1 45976.46,-287.1 46352.29,-287.1 46448.98,-413.1"/>
<text text-anchor="middle" x="46212.72" y="-369.6" font-family="Arial" font-size="10.00">layer3_stage1_attention_allreduce</text>
<text text-anchor="middle" x="46212.72" y="-358.6" font-family="Arial" font-size="10.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="46212.72" y="-347.6" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="46212.72" y="-336.6" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=1024 (x8)</text>
<text text-anchor="middle" x="46212.72" y="-325.6" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_output_proj_0&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge547" class="edge">
<title>layer3_stage1_output_proj_0&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M44796.77,-454.73C44811.25,-452.65 44825.76,-450.72 44839.72,-449.1 45259.94,-400.11 45755.58,-372.01 46021.36,-359.33"/>
<polygon fill="black" stroke="black" points="46021.67,-362.82 46031.49,-358.85 46021.34,-355.83 46021.67,-362.82"/>
</g>
<!-- layer3_stage1_output_proj_1&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge548" class="edge">
<title>layer3_stage1_output_proj_1&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M45139.06,-463.98C45183.85,-459.19 45233.32,-453.91 45278.72,-449.1 45539.35,-421.48 45840.93,-389.9 46029.27,-370.23"/>
<polygon fill="black" stroke="black" points="46029.69,-373.71 46039.28,-369.19 46028.97,-366.74 46029.69,-373.71"/>
</g>
<!-- layer3_stage1_output_proj_2&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge549" class="edge">
<title>layer3_stage1_output_proj_2&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M45578.06,-455.65C45707.83,-434.27 45898.23,-402.91 46036.61,-380.11"/>
<polygon fill="black" stroke="black" points="46037.19,-383.56 46046.48,-378.48 46036.05,-376.65 46037.19,-383.56"/>
</g>
<!-- layer3_stage1_output_proj_3&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge550" class="edge">
<title>layer3_stage1_output_proj_3&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M45952.96,-448.98C45984.43,-437.12 46021.54,-423.14 46057.72,-409.51"/>
<polygon fill="black" stroke="black" points="46059.26,-412.66 46067.39,-405.86 46056.79,-406.11 46059.26,-412.66"/>
</g>
<!-- layer3_stage1_output_proj_4&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge551" class="edge">
<title>layer3_stage1_output_proj_4&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M46212.72,-448.82C46212.72,-440.99 46212.72,-432.25 46212.72,-423.3"/>
<polygon fill="black" stroke="black" points="46216.22,-423.15 46212.72,-413.15 46209.22,-423.15 46216.22,-423.15"/>
</g>
<!-- layer3_stage1_output_proj_5&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge552" class="edge">
<title>layer3_stage1_output_proj_5&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M46474,-448.98C46447.98,-439.23 46418.13,-428.05 46388.11,-416.81"/>
<polygon fill="black" stroke="black" points="46388.96,-413.39 46378.37,-413.15 46386.51,-419.94 46388.96,-413.39"/>
</g>
<!-- layer3_stage1_output_proj_6&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge553" class="edge">
<title>layer3_stage1_output_proj_6&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M46786.65,-453.67C46687.8,-436 46554.86,-412.24 46441.82,-392.04"/>
<polygon fill="black" stroke="black" points="46442.1,-388.54 46431.64,-390.22 46440.87,-395.43 46442.1,-388.54"/>
</g>
<!-- layer3_stage1_output_proj_7&#45;&gt;layer3_stage1_attention_allreduce -->
<g id="edge554" class="edge">
<title>layer3_stage1_output_proj_7&#45;&gt;layer3_stage1_attention_allreduce</title>
<path fill="none" stroke="black" d="M47186.71,-461.33C47153.53,-457.23 47118.41,-452.96 47085.72,-449.1 46861.92,-422.66 46605.64,-394.09 46428.93,-374.66"/>
<polygon fill="black" stroke="black" points="46429.05,-371.16 46418.73,-373.54 46428.29,-378.11 46429.05,-371.16"/>
</g>
<!-- layer3_stage1_attention_allreduce&#45;&gt;layer3_stage1_attention_residual -->
<g id="edge556" class="edge">
<title>layer3_stage1_attention_allreduce&#45;&gt;layer3_stage1_attention_residual</title>
<path fill="none" stroke="black" d="M46374.39,-315.85C46515.88,-286.75 46719.17,-244.94 46853.04,-217.41"/>
<polygon fill="black" stroke="black" points="46853.87,-220.81 46862.96,-215.37 46852.46,-213.96 46853.87,-220.81"/>
</g>
<!-- layer3_stage1_gating -->
<g id="node344" class="node">
<title>layer3_stage1_gating</title>
<polygon fill="none" stroke="black" points="53793.3,-1248.29 53443.99,-1248.29 53354.13,-1122.29 53703.44,-1122.29 53793.3,-1248.29"/>
<text text-anchor="middle" x="53573.72" y="-1204.79" font-family="Arial" font-size="10.00">layer3_stage1_gating</text>
<text text-anchor="middle" x="53573.72" y="-1193.79" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="53573.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="53573.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192</text>
<text text-anchor="middle" x="53573.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, num_experts=16</text>
</g>
<!-- layer3_stage1_expert_0_gpu8 -->
<g id="node345" class="node">
<title>layer3_stage1_expert_0_gpu8</title>
<polygon fill="none" stroke="black" points="46620.72,-1054.79 46414.72,-1054.79 46414.72,-991.79 46620.72,-991.79 46620.72,-1054.79"/>
<text text-anchor="middle" x="46517.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_0_gpu8</text>
<text text-anchor="middle" x="46517.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="46517.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="46517.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="46517.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_0_gpu8 -->
<g id="edge557" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_0_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53398.03,-1184.22C52350.86,-1183.55 46966.21,-1175.75 46629.72,-1086.29 46608.95,-1080.77 46587.9,-1070.57 46569.73,-1060.02"/>
<polygon fill="black" stroke="black" points="46571.44,-1056.97 46561.06,-1054.83 46567.85,-1062.97 46571.44,-1056.97"/>
</g>
<!-- layer3_stage1_expert_1_gpu8 -->
<g id="node346" class="node">
<title>layer3_stage1_expert_1_gpu8</title>
<polygon fill="none" stroke="black" points="46844.72,-1054.79 46638.72,-1054.79 46638.72,-991.79 46844.72,-991.79 46844.72,-1054.79"/>
<text text-anchor="middle" x="46741.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_1_gpu8</text>
<text text-anchor="middle" x="46741.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="46741.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="46741.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="46741.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_1_gpu8 -->
<g id="edge558" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_1_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.9,-1184.14C52370.59,-1182.97 47178.73,-1172.77 46853.72,-1086.29 46832.95,-1080.76 46811.9,-1070.57 46793.73,-1060.02"/>
<polygon fill="black" stroke="black" points="46795.44,-1056.96 46785.06,-1054.83 46791.85,-1062.97 46795.44,-1056.96"/>
</g>
<!-- layer3_stage1_expert_2_gpu8 -->
<g id="node347" class="node">
<title>layer3_stage1_expert_2_gpu8</title>
<polygon fill="none" stroke="black" points="47068.72,-1054.79 46862.72,-1054.79 46862.72,-991.79 47068.72,-991.79 47068.72,-1054.79"/>
<text text-anchor="middle" x="46965.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_2_gpu8</text>
<text text-anchor="middle" x="46965.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="46965.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="46965.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="46965.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_2_gpu8 -->
<g id="edge559" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_2_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53398.06,-1184.05C52391.66,-1182.36 47391.28,-1169.81 47077.72,-1086.29 47056.95,-1080.76 47035.9,-1070.56 47017.74,-1060.01"/>
<polygon fill="black" stroke="black" points="47019.44,-1056.95 47009.07,-1054.82 47015.85,-1062.96 47019.44,-1056.95"/>
</g>
<!-- layer3_stage1_expert_3_gpu8 -->
<g id="node348" class="node">
<title>layer3_stage1_expert_3_gpu8</title>
<polygon fill="none" stroke="black" points="47292.72,-1054.79 47086.72,-1054.79 47086.72,-991.79 47292.72,-991.79 47292.72,-1054.79"/>
<text text-anchor="middle" x="47189.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_3_gpu8</text>
<text text-anchor="middle" x="47189.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="47189.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="47189.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="47189.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_3_gpu8 -->
<g id="edge560" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_3_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.73,-1183.95C52411.46,-1181.73 47603.79,-1166.84 47301.72,-1086.29 47280.96,-1080.75 47259.9,-1070.55 47241.74,-1060"/>
<polygon fill="black" stroke="black" points="47243.45,-1056.95 47233.07,-1054.82 47239.85,-1062.95 47243.45,-1056.95"/>
</g>
<!-- layer3_stage1_expert_4_gpu8 -->
<g id="node349" class="node">
<title>layer3_stage1_expert_4_gpu8</title>
<polygon fill="none" stroke="black" points="47516.72,-1054.79 47310.72,-1054.79 47310.72,-991.79 47516.72,-991.79 47516.72,-1054.79"/>
<text text-anchor="middle" x="47413.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_4_gpu8</text>
<text text-anchor="middle" x="47413.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="47413.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="47413.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="47413.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_4_gpu8 -->
<g id="edge561" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_4_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.75,-1183.84C52432.8,-1181.08 47816.35,-1163.88 47525.72,-1086.29 47504.96,-1080.74 47483.9,-1070.55 47465.74,-1060"/>
<polygon fill="black" stroke="black" points="47467.45,-1056.94 47457.07,-1054.81 47463.85,-1062.95 47467.45,-1056.94"/>
</g>
<!-- layer3_stage1_expert_5_gpu8 -->
<g id="node350" class="node">
<title>layer3_stage1_expert_5_gpu8</title>
<polygon fill="none" stroke="black" points="47740.72,-1054.79 47534.72,-1054.79 47534.72,-991.79 47740.72,-991.79 47740.72,-1054.79"/>
<text text-anchor="middle" x="47637.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_5_gpu8</text>
<text text-anchor="middle" x="47637.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="47637.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="47637.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="47637.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_5_gpu8 -->
<g id="edge562" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_5_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.75,-1183.72C52454.46,-1180.41 48028.91,-1160.92 47749.72,-1086.29 47728.96,-1080.74 47707.91,-1070.54 47689.74,-1059.99"/>
<polygon fill="black" stroke="black" points="47691.45,-1056.93 47681.07,-1054.8 47687.86,-1062.94 47691.45,-1056.93"/>
</g>
<!-- layer3_stage1_expert_6_gpu8 -->
<g id="node351" class="node">
<title>layer3_stage1_expert_6_gpu8</title>
<polygon fill="none" stroke="black" points="47964.72,-1054.79 47758.72,-1054.79 47758.72,-991.79 47964.72,-991.79 47964.72,-1054.79"/>
<text text-anchor="middle" x="47861.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_6_gpu8</text>
<text text-anchor="middle" x="47861.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="47861.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="47861.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="47861.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_6_gpu8 -->
<g id="edge563" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_6_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.76,-1183.6C52476.59,-1179.71 48241.49,-1157.96 47973.72,-1086.29 47952.96,-1080.73 47931.91,-1070.53 47913.74,-1059.98"/>
<polygon fill="black" stroke="black" points="47915.45,-1056.92 47905.07,-1054.8 47911.86,-1062.93 47915.45,-1056.92"/>
</g>
<!-- layer3_stage1_expert_7_gpu8 -->
<g id="node352" class="node">
<title>layer3_stage1_expert_7_gpu8</title>
<polygon fill="none" stroke="black" points="48188.72,-1054.79 47982.72,-1054.79 47982.72,-991.79 48188.72,-991.79 48188.72,-1054.79"/>
<text text-anchor="middle" x="48085.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_7_gpu8</text>
<text text-anchor="middle" x="48085.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="48085.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="48085.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="48085.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_7_gpu8 -->
<g id="edge564" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_7_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.46,-1183.46C52498.22,-1178.97 48454.06,-1155 48197.72,-1086.29 48176.96,-1080.72 48155.91,-1070.52 48137.75,-1059.97"/>
<polygon fill="black" stroke="black" points="48139.45,-1056.92 48129.07,-1054.79 48135.86,-1062.92 48139.45,-1056.92"/>
</g>
<!-- layer3_stage1_expert_8_gpu9 -->
<g id="node353" class="node">
<title>layer3_stage1_expert_8_gpu9</title>
<polygon fill="none" stroke="black" points="48412.72,-1054.79 48206.72,-1054.79 48206.72,-991.79 48412.72,-991.79 48412.72,-1054.79"/>
<text text-anchor="middle" x="48309.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_8_gpu9</text>
<text text-anchor="middle" x="48309.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="48309.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="48309.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="48309.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_8_gpu9 -->
<g id="edge565" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_8_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.63,-1183.32C52521.75,-1178.21 48666.68,-1152.05 48421.72,-1086.29 48401.06,-1080.74 48380.1,-1070.6 48361.99,-1060.1"/>
<polygon fill="black" stroke="black" points="48363.72,-1057.06 48353.34,-1054.94 48360.14,-1063.07 48363.72,-1057.06"/>
</g>
<!-- layer3_stage1_expert_9_gpu9 -->
<g id="node354" class="node">
<title>layer3_stage1_expert_9_gpu9</title>
<polygon fill="none" stroke="black" points="48636.72,-1054.79 48430.72,-1054.79 48430.72,-991.79 48636.72,-991.79 48636.72,-1054.79"/>
<text text-anchor="middle" x="48533.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_9_gpu9</text>
<text text-anchor="middle" x="48533.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="48533.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="48533.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="48533.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_9_gpu9 -->
<g id="edge566" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_9_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.23,-1183.16C52544.15,-1177.4 48879.26,-1149.1 48645.72,-1086.29 48625.06,-1080.73 48604.1,-1070.59 48585.99,-1060.09"/>
<polygon fill="black" stroke="black" points="48587.73,-1057.05 48577.35,-1054.93 48584.14,-1063.06 48587.73,-1057.05"/>
</g>
<!-- layer3_stage1_expert_10_gpu9 -->
<g id="node355" class="node">
<title>layer3_stage1_expert_10_gpu9</title>
<polygon fill="none" stroke="black" points="48860.72,-1054.79 48654.72,-1054.79 48654.72,-991.79 48860.72,-991.79 48860.72,-1054.79"/>
<text text-anchor="middle" x="48757.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_10_gpu9</text>
<text text-anchor="middle" x="48757.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="48757.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="48757.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="48757.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_10_gpu9 -->
<g id="edge567" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_10_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.41,-1182.98C52568.73,-1176.57 49091.91,-1146.16 48869.72,-1086.29 48849.06,-1080.72 48828.11,-1070.58 48810,-1060.08"/>
<polygon fill="black" stroke="black" points="48811.73,-1057.04 48801.35,-1054.92 48808.14,-1063.05 48811.73,-1057.04"/>
</g>
<!-- layer3_stage1_expert_11_gpu9 -->
<g id="node356" class="node">
<title>layer3_stage1_expert_11_gpu9</title>
<polygon fill="none" stroke="black" points="49084.72,-1054.79 48878.72,-1054.79 48878.72,-991.79 49084.72,-991.79 49084.72,-1054.79"/>
<text text-anchor="middle" x="48981.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_11_gpu9</text>
<text text-anchor="middle" x="48981.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="48981.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="48981.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="48981.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_11_gpu9 -->
<g id="edge568" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_11_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.17,-1182.79C52592.75,-1175.68 49304.54,-1143.21 49093.72,-1086.29 49073.07,-1080.71 49052.11,-1070.56 49034,-1060.07"/>
<polygon fill="black" stroke="black" points="49035.73,-1057.03 49025.35,-1054.91 49032.15,-1063.04 49035.73,-1057.03"/>
</g>
<!-- layer3_stage1_expert_12_gpu9 -->
<g id="node357" class="node">
<title>layer3_stage1_expert_12_gpu9</title>
<polygon fill="none" stroke="black" points="49308.72,-1054.79 49102.72,-1054.79 49102.72,-991.79 49308.72,-991.79 49308.72,-1054.79"/>
<text text-anchor="middle" x="49205.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_12_gpu9</text>
<text text-anchor="middle" x="49205.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="49205.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="49205.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="49205.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_12_gpu9 -->
<g id="edge569" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_12_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53396.95,-1182.58C52617.49,-1174.74 49517.2,-1140.27 49317.72,-1086.29 49297.07,-1080.7 49276.12,-1070.55 49258,-1060.06"/>
<polygon fill="black" stroke="black" points="49259.74,-1057.01 49249.36,-1054.9 49256.15,-1063.03 49259.74,-1057.01"/>
</g>
<!-- layer3_stage1_expert_13_gpu9 -->
<g id="node358" class="node">
<title>layer3_stage1_expert_13_gpu9</title>
<polygon fill="none" stroke="black" points="49532.72,-1054.79 49326.72,-1054.79 49326.72,-991.79 49532.72,-991.79 49532.72,-1054.79"/>
<text text-anchor="middle" x="49429.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_13_gpu9</text>
<text text-anchor="middle" x="49429.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="49429.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="49429.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="49429.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_13_gpu9 -->
<g id="edge570" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_13_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53396.86,-1182.34C52643.24,-1173.74 49729.88,-1137.34 49541.72,-1086.29 49521.07,-1080.68 49500.12,-1070.53 49482.01,-1060.04"/>
<polygon fill="black" stroke="black" points="49483.74,-1057 49473.36,-1054.88 49480.16,-1063.01 49483.74,-1057"/>
</g>
<!-- layer3_stage1_expert_14_gpu9 -->
<g id="node359" class="node">
<title>layer3_stage1_expert_14_gpu9</title>
<polygon fill="none" stroke="black" points="49756.72,-1054.79 49550.72,-1054.79 49550.72,-991.79 49756.72,-991.79 49756.72,-1054.79"/>
<text text-anchor="middle" x="49653.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_14_gpu9</text>
<text text-anchor="middle" x="49653.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="49653.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="49653.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="49653.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_14_gpu9 -->
<g id="edge571" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_14_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53398.52,-1184.67C52697.86,-1185.55 50118.14,-1182.17 49765.72,-1086.29 49745.08,-1080.67 49724.12,-1070.51 49706.01,-1060.02"/>
<polygon fill="black" stroke="black" points="49707.75,-1056.98 49697.36,-1054.87 49704.16,-1062.99 49707.75,-1056.98"/>
</g>
<!-- layer3_stage1_expert_15_gpu9 -->
<g id="node360" class="node">
<title>layer3_stage1_expert_15_gpu9</title>
<polygon fill="none" stroke="black" points="49980.72,-1054.79 49774.72,-1054.79 49774.72,-991.79 49980.72,-991.79 49980.72,-1054.79"/>
<text text-anchor="middle" x="49877.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_15_gpu9</text>
<text text-anchor="middle" x="49877.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="49877.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="49877.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="49877.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_15_gpu9 -->
<g id="edge572" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_15_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53398.33,-1184.36C52724.01,-1184 50319.61,-1176.33 49989.72,-1086.29 49969.08,-1080.65 49948.13,-1070.49 49930.02,-1060"/>
<polygon fill="black" stroke="black" points="49931.75,-1056.96 49921.37,-1054.85 49928.17,-1062.97 49931.75,-1056.96"/>
</g>
<!-- layer3_stage1_expert_16_gpu10 -->
<g id="node361" class="node">
<title>layer3_stage1_expert_16_gpu10</title>
<polygon fill="none" stroke="black" points="50204.72,-1054.79 49998.72,-1054.79 49998.72,-991.79 50204.72,-991.79 50204.72,-1054.79"/>
<text text-anchor="middle" x="50101.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_16_gpu10</text>
<text text-anchor="middle" x="50101.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 16</text>
<text text-anchor="middle" x="50101.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="50101.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="50101.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_16_gpu10 -->
<g id="edge573" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_16_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53398.06,-1184.01C52750.88,-1182.35 50521.13,-1170.49 50213.72,-1086.29 50193.09,-1080.63 50172.14,-1070.47 50154.02,-1059.98"/>
<polygon fill="black" stroke="black" points="50155.76,-1056.94 50145.37,-1054.83 50152.17,-1062.95 50155.76,-1056.94"/>
</g>
<!-- layer3_stage1_expert_17_gpu10 -->
<g id="node362" class="node">
<title>layer3_stage1_expert_17_gpu10</title>
<polygon fill="none" stroke="black" points="50428.72,-1054.79 50222.72,-1054.79 50222.72,-991.79 50428.72,-991.79 50428.72,-1054.79"/>
<text text-anchor="middle" x="50325.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_17_gpu10</text>
<text text-anchor="middle" x="50325.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 17</text>
<text text-anchor="middle" x="50325.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="50325.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="50325.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_17_gpu10 -->
<g id="edge574" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_17_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.65,-1183.61C52778.4,-1180.58 50722.68,-1164.67 50437.72,-1086.29 50417.09,-1080.61 50396.14,-1070.44 50378.03,-1059.96"/>
<polygon fill="black" stroke="black" points="50379.76,-1056.91 50369.38,-1054.8 50376.18,-1062.93 50379.76,-1056.91"/>
</g>
<!-- layer3_stage1_expert_18_gpu10 -->
<g id="node363" class="node">
<title>layer3_stage1_expert_18_gpu10</title>
<polygon fill="none" stroke="black" points="50652.72,-1054.79 50446.72,-1054.79 50446.72,-991.79 50652.72,-991.79 50652.72,-1054.79"/>
<text text-anchor="middle" x="50549.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_18_gpu10</text>
<text text-anchor="middle" x="50549.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 18</text>
<text text-anchor="middle" x="50549.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="50549.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="50549.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_18_gpu10 -->
<g id="edge575" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_18_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.34,-1183.15C52807.25,-1178.69 50924.32,-1158.85 50661.72,-1086.29 50641.19,-1080.61 50620.34,-1070.5 50602.28,-1060.07"/>
<polygon fill="black" stroke="black" points="50604.04,-1057.04 50593.66,-1054.94 50600.46,-1063.06 50604.04,-1057.04"/>
</g>
<!-- layer3_stage1_expert_19_gpu10 -->
<g id="node364" class="node">
<title>layer3_stage1_expert_19_gpu10</title>
<polygon fill="none" stroke="black" points="50876.72,-1054.79 50670.72,-1054.79 50670.72,-991.79 50876.72,-991.79 50876.72,-1054.79"/>
<text text-anchor="middle" x="50773.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_19_gpu10</text>
<text text-anchor="middle" x="50773.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 19</text>
<text text-anchor="middle" x="50773.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="50773.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="50773.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_19_gpu10 -->
<g id="edge576" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_19_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53396.9,-1182.61C52837.04,-1176.63 51126.01,-1153.05 50885.72,-1086.29 50865.2,-1080.59 50844.35,-1070.47 50826.29,-1060.03"/>
<polygon fill="black" stroke="black" points="50828.05,-1057.01 50817.66,-1054.91 50824.47,-1063.02 50828.05,-1057.01"/>
</g>
<!-- layer3_stage1_expert_20_gpu10 -->
<g id="node365" class="node">
<title>layer3_stage1_expert_20_gpu10</title>
<polygon fill="none" stroke="black" points="51100.72,-1054.79 50894.72,-1054.79 50894.72,-991.79 51100.72,-991.79 51100.72,-1054.79"/>
<text text-anchor="middle" x="50997.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_20_gpu10</text>
<text text-anchor="middle" x="50997.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 20</text>
<text text-anchor="middle" x="50997.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="50997.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="50997.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_20_gpu10 -->
<g id="edge577" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_20_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53396.47,-1181.96C52868.25,-1174.39 51327.79,-1147.26 51109.72,-1086.29 51089.21,-1080.55 51068.36,-1070.42 51050.3,-1059.99"/>
<polygon fill="black" stroke="black" points="51052.06,-1056.97 51041.67,-1054.87 51048.48,-1062.99 51052.06,-1056.97"/>
</g>
<!-- layer3_stage1_expert_21_gpu10 -->
<g id="node366" class="node">
<title>layer3_stage1_expert_21_gpu10</title>
<polygon fill="none" stroke="black" points="51324.72,-1054.79 51118.72,-1054.79 51118.72,-991.79 51324.72,-991.79 51324.72,-1054.79"/>
<text text-anchor="middle" x="51221.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_21_gpu10</text>
<text text-anchor="middle" x="51221.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 21</text>
<text text-anchor="middle" x="51221.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="51221.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="51221.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_21_gpu10 -->
<g id="edge578" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_21_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53396.06,-1181.19C52901.06,-1171.91 51529.66,-1141.5 51333.72,-1086.29 51313.22,-1080.51 51292.38,-1070.37 51274.32,-1059.95"/>
<polygon fill="black" stroke="black" points="51276.07,-1056.92 51265.69,-1054.82 51272.5,-1062.94 51276.07,-1056.92"/>
</g>
<!-- layer3_stage1_expert_22_gpu10 -->
<g id="node367" class="node">
<title>layer3_stage1_expert_22_gpu10</title>
<polygon fill="none" stroke="black" points="51548.72,-1054.79 51342.72,-1054.79 51342.72,-991.79 51548.72,-991.79 51548.72,-1054.79"/>
<text text-anchor="middle" x="51445.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_22_gpu10</text>
<text text-anchor="middle" x="51445.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 22</text>
<text text-anchor="middle" x="51445.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="51445.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="51445.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_22_gpu10 -->
<g id="edge579" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_22_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53395.43,-1180.24C52935.3,-1169.15 51731.61,-1135.74 51557.72,-1086.29 51537.33,-1080.49 51516.58,-1070.4 51498.58,-1060.03"/>
<polygon fill="black" stroke="black" points="51500.36,-1057.02 51489.97,-1054.93 51496.79,-1063.04 51500.36,-1057.02"/>
</g>
<!-- layer3_stage1_expert_23_gpu10 -->
<g id="node368" class="node">
<title>layer3_stage1_expert_23_gpu10</title>
<polygon fill="none" stroke="black" points="51772.72,-1054.79 51566.72,-1054.79 51566.72,-991.79 51772.72,-991.79 51772.72,-1054.79"/>
<text text-anchor="middle" x="51669.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_23_gpu10</text>
<text text-anchor="middle" x="51669.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 23</text>
<text text-anchor="middle" x="51669.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="51669.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="51669.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_23_gpu10 -->
<g id="edge580" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_23_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53398.43,-1184.64C53008.78,-1183.81 52081.52,-1172.53 51781.72,-1086.29 51761.34,-1080.43 51740.6,-1070.32 51722.6,-1059.96"/>
<polygon fill="black" stroke="black" points="51724.38,-1056.94 51713.99,-1054.86 51720.81,-1062.97 51724.38,-1056.94"/>
</g>
<!-- layer3_stage1_expert_24_gpu11 -->
<g id="node369" class="node">
<title>layer3_stage1_expert_24_gpu11</title>
<polygon fill="none" stroke="black" points="51996.72,-1054.79 51790.72,-1054.79 51790.72,-991.79 51996.72,-991.79 51996.72,-1054.79"/>
<text text-anchor="middle" x="51893.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_24_gpu11</text>
<text text-anchor="middle" x="51893.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 24</text>
<text text-anchor="middle" x="51893.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="51893.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="51893.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_24_gpu11 -->
<g id="edge581" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_24_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53397.3,-1182.99C53044.13,-1178.82 52262.15,-1161.13 52005.72,-1086.29 51985.64,-1080.43 51965.19,-1070.5 51947.36,-1060.28"/>
<polygon fill="black" stroke="black" points="51948.68,-1057 51938.28,-1054.94 51945.12,-1063.03 51948.68,-1057"/>
</g>
<!-- layer3_stage1_expert_25_gpu11 -->
<g id="node370" class="node">
<title>layer3_stage1_expert_25_gpu11</title>
<polygon fill="none" stroke="black" points="52220.72,-1054.79 52014.72,-1054.79 52014.72,-991.79 52220.72,-991.79 52220.72,-1054.79"/>
<text text-anchor="middle" x="52117.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_25_gpu11</text>
<text text-anchor="middle" x="52117.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 25</text>
<text text-anchor="middle" x="52117.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="52117.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="52117.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_25_gpu11 -->
<g id="edge582" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_25_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53395.81,-1180.78C53081.99,-1173.03 52443.09,-1149.77 52229.72,-1086.29 52209.67,-1080.32 52189.23,-1070.37 52171.39,-1060.16"/>
<polygon fill="black" stroke="black" points="52172.71,-1056.87 52162.32,-1054.82 52169.16,-1062.91 52172.71,-1056.87"/>
</g>
<!-- layer3_stage1_expert_26_gpu11 -->
<g id="node371" class="node">
<title>layer3_stage1_expert_26_gpu11</title>
<polygon fill="none" stroke="black" points="52444.72,-1054.79 52238.72,-1054.79 52238.72,-991.79 52444.72,-991.79 52444.72,-1054.79"/>
<text text-anchor="middle" x="52341.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_26_gpu11</text>
<text text-anchor="middle" x="52341.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 26</text>
<text text-anchor="middle" x="52341.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="52341.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="52341.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_26_gpu11 -->
<g id="edge583" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_26_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53393.55,-1177.63C53122.77,-1166.08 52624.41,-1138.42 52453.72,-1086.29 52433.81,-1080.21 52413.47,-1070.27 52395.69,-1060.12"/>
<polygon fill="black" stroke="black" points="52397.03,-1056.85 52386.64,-1054.81 52393.49,-1062.89 52397.03,-1056.85"/>
</g>
<!-- layer3_stage1_expert_27_gpu11 -->
<g id="node372" class="node">
<title>layer3_stage1_expert_27_gpu11</title>
<polygon fill="none" stroke="black" points="52668.72,-1054.79 52462.72,-1054.79 52462.72,-991.79 52668.72,-991.79 52668.72,-1054.79"/>
<text text-anchor="middle" x="52565.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_27_gpu11</text>
<text text-anchor="middle" x="52565.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 27</text>
<text text-anchor="middle" x="52565.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="52565.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="52565.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_27_gpu11 -->
<g id="edge584" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_27_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53390.02,-1172.77C53167.41,-1157.32 52806.18,-1127.05 52677.72,-1086.29 52658.05,-1080.05 52637.93,-1070.18 52620.26,-1060.14"/>
<polygon fill="black" stroke="black" points="52621.66,-1056.9 52611.25,-1054.89 52618.13,-1062.95 52621.66,-1056.9"/>
</g>
<!-- layer3_stage1_expert_28_gpu11 -->
<g id="node373" class="node">
<title>layer3_stage1_expert_28_gpu11</title>
<polygon fill="none" stroke="black" points="52892.72,-1054.79 52686.72,-1054.79 52686.72,-991.79 52892.72,-991.79 52892.72,-1054.79"/>
<text text-anchor="middle" x="52789.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_28_gpu11</text>
<text text-anchor="middle" x="52789.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 28</text>
<text text-anchor="middle" x="52789.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="52789.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="52789.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_28_gpu11 -->
<g id="edge585" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_28_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53392.05,-1175.52C53254.44,-1164.67 53062.32,-1140.44 52901.72,-1086.29 52882.35,-1079.76 52862.44,-1069.92 52844.88,-1059.99"/>
<polygon fill="black" stroke="black" points="52846.34,-1056.78 52835.93,-1054.8 52842.83,-1062.84 52846.34,-1056.78"/>
</g>
<!-- layer3_stage1_expert_29_gpu11 -->
<g id="node374" class="node">
<title>layer3_stage1_expert_29_gpu11</title>
<polygon fill="none" stroke="black" points="53116.72,-1054.79 52910.72,-1054.79 52910.72,-991.79 53116.72,-991.79 53116.72,-1054.79"/>
<text text-anchor="middle" x="53013.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_29_gpu11</text>
<text text-anchor="middle" x="53013.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 29</text>
<text text-anchor="middle" x="53013.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="53013.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="53013.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_29_gpu11 -->
<g id="edge586" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_29_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53376.66,-1153.98C53297.2,-1138.49 53205.62,-1116.4 53125.72,-1086.29 53107.03,-1079.24 53087.67,-1069.51 53070.41,-1059.84"/>
<polygon fill="black" stroke="black" points="53072,-1056.72 53061.58,-1054.8 53068.53,-1062.8 53072,-1056.72"/>
</g>
<!-- layer3_stage1_expert_30_gpu11 -->
<g id="node375" class="node">
<title>layer3_stage1_expert_30_gpu11</title>
<polygon fill="none" stroke="black" points="53340.72,-1054.79 53134.72,-1054.79 53134.72,-991.79 53340.72,-991.79 53340.72,-1054.79"/>
<text text-anchor="middle" x="53237.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_30_gpu11</text>
<text text-anchor="middle" x="53237.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 30</text>
<text text-anchor="middle" x="53237.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="53237.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="53237.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_30_gpu11 -->
<g id="edge587" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_30_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53426.42,-1122.18C53400.66,-1110.66 53374.26,-1098.42 53349.72,-1086.29 53333.16,-1078.1 53315.55,-1068.7 53299.31,-1059.73"/>
<polygon fill="black" stroke="black" points="53300.89,-1056.6 53290.45,-1054.8 53297.49,-1062.72 53300.89,-1056.6"/>
</g>
<!-- layer3_stage1_expert_31_gpu11 -->
<g id="node376" class="node">
<title>layer3_stage1_expert_31_gpu11</title>
<polygon fill="none" stroke="black" points="53564.72,-1054.79 53358.72,-1054.79 53358.72,-991.79 53564.72,-991.79 53564.72,-1054.79"/>
<text text-anchor="middle" x="53461.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_31_gpu11</text>
<text text-anchor="middle" x="53461.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 31</text>
<text text-anchor="middle" x="53461.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="53461.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="53461.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_31_gpu11 -->
<g id="edge588" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_31_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53530.09,-1121.97C53516.27,-1102.21 53501.38,-1080.94 53489.03,-1063.31"/>
<polygon fill="black" stroke="black" points="53491.8,-1061.15 53483.19,-1054.97 53486.06,-1065.17 53491.8,-1061.15"/>
</g>
<!-- layer3_stage1_expert_32_gpu12 -->
<g id="node377" class="node">
<title>layer3_stage1_expert_32_gpu12</title>
<polygon fill="none" stroke="black" points="53788.72,-1054.79 53582.72,-1054.79 53582.72,-991.79 53788.72,-991.79 53788.72,-1054.79"/>
<text text-anchor="middle" x="53685.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_32_gpu12</text>
<text text-anchor="middle" x="53685.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 32</text>
<text text-anchor="middle" x="53685.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="53685.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="53685.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_32_gpu12 -->
<g id="edge589" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_32_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53617.34,-1121.97C53631.17,-1102.21 53646.06,-1080.94 53658.4,-1063.31"/>
<polygon fill="black" stroke="black" points="53661.37,-1065.17 53664.24,-1054.97 53655.64,-1061.15 53661.37,-1065.17"/>
</g>
<!-- layer3_stage1_expert_33_gpu12 -->
<g id="node378" class="node">
<title>layer3_stage1_expert_33_gpu12</title>
<polygon fill="none" stroke="black" points="54012.72,-1054.79 53806.72,-1054.79 53806.72,-991.79 54012.72,-991.79 54012.72,-1054.79"/>
<text text-anchor="middle" x="53909.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_33_gpu12</text>
<text text-anchor="middle" x="53909.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 33</text>
<text text-anchor="middle" x="53909.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="53909.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="53909.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_33_gpu12 -->
<g id="edge590" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_33_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53707.91,-1128.01C53737.72,-1114.83 53768.99,-1100.49 53797.72,-1086.29 53814.28,-1078.1 53831.89,-1068.7 53848.12,-1059.73"/>
<polygon fill="black" stroke="black" points="53849.95,-1062.72 53856.99,-1054.8 53846.55,-1056.6 53849.95,-1062.72"/>
</g>
<!-- layer3_stage1_expert_34_gpu12 -->
<g id="node379" class="node">
<title>layer3_stage1_expert_34_gpu12</title>
<polygon fill="none" stroke="black" points="54236.72,-1054.79 54030.72,-1054.79 54030.72,-991.79 54236.72,-991.79 54236.72,-1054.79"/>
<text text-anchor="middle" x="54133.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_34_gpu12</text>
<text text-anchor="middle" x="54133.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 34</text>
<text text-anchor="middle" x="54133.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="54133.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="54133.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_34_gpu12 -->
<g id="edge591" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_34_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53731.39,-1161.33C53818.73,-1145.77 53928.22,-1121.53 54021.72,-1086.29 54040.4,-1079.24 54059.77,-1069.51 54077.03,-1059.84"/>
<polygon fill="black" stroke="black" points="54078.9,-1062.8 54085.85,-1054.8 54075.43,-1056.72 54078.9,-1062.8"/>
</g>
<!-- layer3_stage1_expert_35_gpu12 -->
<g id="node380" class="node">
<title>layer3_stage1_expert_35_gpu12</title>
<polygon fill="none" stroke="black" points="54460.72,-1054.79 54254.72,-1054.79 54254.72,-991.79 54460.72,-991.79 54460.72,-1054.79"/>
<text text-anchor="middle" x="54357.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_35_gpu12</text>
<text text-anchor="middle" x="54357.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 35</text>
<text text-anchor="middle" x="54357.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="54357.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="54357.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_35_gpu12 -->
<g id="edge592" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_35_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53742.27,-1176.52C53880.6,-1166.2 54079.95,-1142.18 54245.72,-1086.29 54265.09,-1079.76 54284.99,-1069.92 54302.55,-1059.99"/>
<polygon fill="black" stroke="black" points="54304.6,-1062.84 54311.51,-1054.8 54301.1,-1056.78 54304.6,-1062.84"/>
</g>
<!-- layer3_stage1_expert_36_gpu12 -->
<g id="node381" class="node">
<title>layer3_stage1_expert_36_gpu12</title>
<polygon fill="none" stroke="black" points="54684.72,-1054.79 54478.72,-1054.79 54478.72,-991.79 54684.72,-991.79 54684.72,-1054.79"/>
<text text-anchor="middle" x="54581.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_36_gpu12</text>
<text text-anchor="middle" x="54581.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 36</text>
<text text-anchor="middle" x="54581.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="54581.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="54581.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_36_gpu12 -->
<g id="edge593" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_36_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53740.73,-1173.92C53961.52,-1158.86 54338,-1128.08 54469.72,-1086.29 54489.38,-1080.05 54509.51,-1070.18 54527.18,-1060.14"/>
<polygon fill="black" stroke="black" points="54529.31,-1062.95 54536.18,-1054.89 54525.78,-1056.9 54529.31,-1062.95"/>
</g>
<!-- layer3_stage1_expert_37_gpu12 -->
<g id="node382" class="node">
<title>layer3_stage1_expert_37_gpu12</title>
<polygon fill="none" stroke="black" points="54908.72,-1054.79 54702.72,-1054.79 54702.72,-991.79 54908.72,-991.79 54908.72,-1054.79"/>
<text text-anchor="middle" x="54805.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_37_gpu12</text>
<text text-anchor="middle" x="54805.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 37</text>
<text text-anchor="middle" x="54805.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="54805.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="54805.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_37_gpu12 -->
<g id="edge594" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_37_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53743.45,-1178.07C54011.66,-1166.79 54520.81,-1139.1 54693.72,-1086.29 54713.63,-1080.21 54733.96,-1070.27 54751.75,-1060.12"/>
<polygon fill="black" stroke="black" points="54753.94,-1062.89 54760.8,-1054.81 54750.4,-1056.85 54753.94,-1062.89"/>
</g>
<!-- layer3_stage1_expert_38_gpu12 -->
<g id="node383" class="node">
<title>layer3_stage1_expert_38_gpu12</title>
<polygon fill="none" stroke="black" points="55132.72,-1054.79 54926.72,-1054.79 54926.72,-991.79 55132.72,-991.79 55132.72,-1054.79"/>
<text text-anchor="middle" x="55029.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_38_gpu12</text>
<text text-anchor="middle" x="55029.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 38</text>
<text text-anchor="middle" x="55029.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="55029.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="55029.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_38_gpu12 -->
<g id="edge595" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_38_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53745.48,-1180.93C54057.04,-1173.33 54702.94,-1150.19 54917.72,-1086.29 54937.76,-1080.32 54958.2,-1070.37 54976.04,-1060.16"/>
<polygon fill="black" stroke="black" points="54978.27,-1062.91 54985.12,-1054.82 54974.72,-1056.87 54978.27,-1062.91"/>
</g>
<!-- layer3_stage1_expert_39_gpu12 -->
<g id="node384" class="node">
<title>layer3_stage1_expert_39_gpu12</title>
<polygon fill="none" stroke="black" points="55356.72,-1054.79 55150.72,-1054.79 55150.72,-991.79 55356.72,-991.79 55356.72,-1054.79"/>
<text text-anchor="middle" x="55253.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_39_gpu12</text>
<text text-anchor="middle" x="55253.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 39</text>
<text text-anchor="middle" x="55253.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="55253.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="55253.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_39_gpu12 -->
<g id="edge596" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_39_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.1,-1183.03C54098.81,-1178.92 54884.55,-1161.35 55141.72,-1086.29 55161.79,-1080.43 55182.24,-1070.5 55200.08,-1060.28"/>
<polygon fill="black" stroke="black" points="55202.31,-1063.03 55209.15,-1054.94 55198.76,-1057 55202.31,-1063.03"/>
</g>
<!-- layer3_stage1_expert_40_gpu13 -->
<g id="node385" class="node">
<title>layer3_stage1_expert_40_gpu13</title>
<polygon fill="none" stroke="black" points="55580.72,-1054.79 55374.72,-1054.79 55374.72,-991.79 55580.72,-991.79 55580.72,-1054.79"/>
<text text-anchor="middle" x="55477.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_40_gpu13</text>
<text text-anchor="middle" x="55477.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 40</text>
<text text-anchor="middle" x="55477.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="55477.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="55477.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_40_gpu13 -->
<g id="edge597" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_40_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.91,-1184.64C54136.91,-1183.84 55065.63,-1172.61 55365.72,-1086.29 55386.09,-1080.43 55406.83,-1070.32 55424.84,-1059.96"/>
<polygon fill="black" stroke="black" points="55426.62,-1062.97 55433.45,-1054.86 55423.06,-1056.94 55426.62,-1062.97"/>
</g>
<!-- layer3_stage1_expert_41_gpu13 -->
<g id="node386" class="node">
<title>layer3_stage1_expert_41_gpu13</title>
<polygon fill="none" stroke="black" points="55804.72,-1054.79 55598.72,-1054.79 55598.72,-991.79 55804.72,-991.79 55804.72,-1054.79"/>
<text text-anchor="middle" x="55701.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_41_gpu13</text>
<text text-anchor="middle" x="55701.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 41</text>
<text text-anchor="middle" x="55701.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="55701.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="55701.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_41_gpu13 -->
<g id="edge598" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_41_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53744.96,-1180.41C54199.72,-1169.49 55414.93,-1136 55589.72,-1086.29 55610.11,-1080.49 55630.86,-1070.4 55648.86,-1060.03"/>
<polygon fill="black" stroke="black" points="55650.65,-1063.04 55657.46,-1054.93 55647.08,-1057.02 55650.65,-1063.04"/>
</g>
<!-- layer3_stage1_expert_42_gpu13 -->
<g id="node387" class="node">
<title>layer3_stage1_expert_42_gpu13</title>
<polygon fill="none" stroke="black" points="56028.72,-1054.79 55822.72,-1054.79 55822.72,-991.79 56028.72,-991.79 56028.72,-1054.79"/>
<text text-anchor="middle" x="55925.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_42_gpu13</text>
<text text-anchor="middle" x="55925.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 42</text>
<text text-anchor="middle" x="55925.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="55925.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="55925.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_42_gpu13 -->
<g id="edge599" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_42_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53745.65,-1181.3C54235.7,-1172.15 55617.02,-1141.71 55813.72,-1086.29 55834.22,-1080.51 55855.06,-1070.37 55873.12,-1059.95"/>
<polygon fill="black" stroke="black" points="55874.94,-1062.94 55881.75,-1054.82 55871.36,-1056.92 55874.94,-1062.94"/>
</g>
<!-- layer3_stage1_expert_43_gpu13 -->
<g id="node388" class="node">
<title>layer3_stage1_expert_43_gpu13</title>
<polygon fill="none" stroke="black" points="56252.72,-1054.79 56046.72,-1054.79 56046.72,-991.79 56252.72,-991.79 56252.72,-1054.79"/>
<text text-anchor="middle" x="56149.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_43_gpu13</text>
<text text-anchor="middle" x="56149.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 43</text>
<text text-anchor="middle" x="56149.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="56149.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="56149.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_43_gpu13 -->
<g id="edge600" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_43_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53746.31,-1182.03C54270.08,-1174.55 55819.01,-1147.45 56037.72,-1086.29 56058.23,-1080.55 56079.07,-1070.42 56097.13,-1059.99"/>
<polygon fill="black" stroke="black" points="56098.95,-1062.99 56105.76,-1054.87 56095.38,-1056.97 56098.95,-1062.99"/>
</g>
<!-- layer3_stage1_expert_44_gpu13 -->
<g id="node389" class="node">
<title>layer3_stage1_expert_44_gpu13</title>
<polygon fill="none" stroke="black" points="56476.72,-1054.79 56270.72,-1054.79 56270.72,-991.79 56476.72,-991.79 56476.72,-1054.79"/>
<text text-anchor="middle" x="56373.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_44_gpu13</text>
<text text-anchor="middle" x="56373.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 44</text>
<text text-anchor="middle" x="56373.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="56373.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="56373.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_44_gpu13 -->
<g id="edge601" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_44_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53746.62,-1182.65C54302.38,-1176.74 56020.86,-1153.21 56261.72,-1086.29 56282.24,-1080.59 56303.09,-1070.47 56321.14,-1060.03"/>
<polygon fill="black" stroke="black" points="56322.96,-1063.02 56329.77,-1054.91 56319.39,-1057.01 56322.96,-1063.02"/>
</g>
<!-- layer3_stage1_expert_45_gpu13 -->
<g id="node390" class="node">
<title>layer3_stage1_expert_45_gpu13</title>
<polygon fill="none" stroke="black" points="56700.72,-1054.79 56494.72,-1054.79 56494.72,-991.79 56700.72,-991.79 56700.72,-1054.79"/>
<text text-anchor="middle" x="56597.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_45_gpu13</text>
<text text-anchor="middle" x="56597.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 45</text>
<text text-anchor="middle" x="56597.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="56597.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="56597.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_45_gpu13 -->
<g id="edge602" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_45_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.02,-1183.17C54333.63,-1178.76 56222.66,-1158.98 56485.72,-1086.29 56506.24,-1080.61 56527.1,-1070.5 56545.15,-1060.07"/>
<polygon fill="black" stroke="black" points="56546.97,-1063.06 56553.78,-1054.94 56543.4,-1057.04 56546.97,-1063.06"/>
</g>
<!-- layer3_stage1_expert_46_gpu13 -->
<g id="node391" class="node">
<title>layer3_stage1_expert_46_gpu13</title>
<polygon fill="none" stroke="black" points="56924.72,-1054.79 56718.72,-1054.79 56718.72,-991.79 56924.72,-991.79 56924.72,-1054.79"/>
<text text-anchor="middle" x="56821.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_46_gpu13</text>
<text text-anchor="middle" x="56821.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 46</text>
<text text-anchor="middle" x="56821.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="56821.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="56821.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_46_gpu13 -->
<g id="edge603" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_46_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.38,-1183.63C54363.7,-1180.62 56424.38,-1164.77 56709.72,-1086.29 56730.34,-1080.61 56751.29,-1070.44 56769.4,-1059.96"/>
<polygon fill="black" stroke="black" points="56771.26,-1062.93 56778.05,-1054.8 56767.67,-1056.91 56771.26,-1062.93"/>
</g>
<!-- layer3_stage1_expert_47_gpu13 -->
<g id="node392" class="node">
<title>layer3_stage1_expert_47_gpu13</title>
<polygon fill="none" stroke="black" points="57148.72,-1054.79 56942.72,-1054.79 56942.72,-991.79 57148.72,-991.79 57148.72,-1054.79"/>
<text text-anchor="middle" x="57045.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_47_gpu13</text>
<text text-anchor="middle" x="57045.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 47</text>
<text text-anchor="middle" x="57045.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="57045.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="57045.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_47_gpu13 -->
<g id="edge604" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_47_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.71,-1184.02C54392.73,-1182.37 56626.04,-1170.57 56933.72,-1086.29 56954.35,-1080.63 56975.3,-1070.47 56993.41,-1059.98"/>
<polygon fill="black" stroke="black" points="56995.26,-1062.95 57002.06,-1054.83 56991.68,-1056.94 56995.26,-1062.95"/>
</g>
<!-- layer3_stage1_expert_48_gpu14 -->
<g id="node393" class="node">
<title>layer3_stage1_expert_48_gpu14</title>
<polygon fill="none" stroke="black" points="57372.72,-1054.79 57166.72,-1054.79 57166.72,-991.79 57372.72,-991.79 57372.72,-1054.79"/>
<text text-anchor="middle" x="57269.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_48_gpu14</text>
<text text-anchor="middle" x="57269.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 48</text>
<text text-anchor="middle" x="57269.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="57269.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="57269.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_48_gpu14 -->
<g id="edge605" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_48_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.96,-1184.36C54420.69,-1184.01 56827.64,-1176.38 57157.72,-1086.29 57178.35,-1080.65 57199.31,-1070.49 57217.42,-1060"/>
<polygon fill="black" stroke="black" points="57219.27,-1062.97 57226.07,-1054.85 57215.68,-1056.96 57219.27,-1062.97"/>
</g>
<!-- layer3_stage1_expert_49_gpu14 -->
<g id="node394" class="node">
<title>layer3_stage1_expert_49_gpu14</title>
<polygon fill="none" stroke="black" points="57596.72,-1054.79 57390.72,-1054.79 57390.72,-991.79 57596.72,-991.79 57596.72,-1054.79"/>
<text text-anchor="middle" x="57493.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_49_gpu14</text>
<text text-anchor="middle" x="57493.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 49</text>
<text text-anchor="middle" x="57493.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="57493.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="57493.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_49_gpu14 -->
<g id="edge606" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_49_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53748.02,-1184.67C54447.38,-1185.55 57029.15,-1182.22 57381.72,-1086.29 57402.36,-1080.67 57423.31,-1070.51 57441.42,-1060.02"/>
<polygon fill="black" stroke="black" points="57443.28,-1062.99 57450.07,-1054.87 57439.69,-1056.98 57443.28,-1062.99"/>
</g>
<!-- layer3_stage1_expert_50_gpu14 -->
<g id="node395" class="node">
<title>layer3_stage1_expert_50_gpu14</title>
<polygon fill="none" stroke="black" points="57820.72,-1054.79 57614.72,-1054.79 57614.72,-991.79 57820.72,-991.79 57820.72,-1054.79"/>
<text text-anchor="middle" x="57717.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_50_gpu14</text>
<text text-anchor="middle" x="57717.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 50</text>
<text text-anchor="middle" x="57717.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="57717.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="57717.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_50_gpu14 -->
<g id="edge607" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_50_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53746.48,-1182.39C54493.56,-1173.88 57417.21,-1137.43 57605.72,-1086.29 57626.36,-1080.68 57647.32,-1070.53 57665.43,-1060.04"/>
<polygon fill="black" stroke="black" points="57667.28,-1063.01 57674.08,-1054.88 57663.69,-1057 57667.28,-1063.01"/>
</g>
<!-- layer3_stage1_expert_51_gpu14 -->
<g id="node396" class="node">
<title>layer3_stage1_expert_51_gpu14</title>
<polygon fill="none" stroke="black" points="58044.72,-1054.79 57838.72,-1054.79 57838.72,-991.79 58044.72,-991.79 58044.72,-1054.79"/>
<text text-anchor="middle" x="57941.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_51_gpu14</text>
<text text-anchor="middle" x="57941.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 51</text>
<text text-anchor="middle" x="57941.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="57941.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="57941.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_51_gpu14 -->
<g id="edge608" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_51_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53746.58,-1182.62C54519.54,-1174.85 57629.9,-1140.36 57829.72,-1086.29 57850.37,-1080.7 57871.32,-1070.55 57889.43,-1060.06"/>
<polygon fill="black" stroke="black" points="57891.29,-1063.03 57898.08,-1054.9 57887.7,-1057.01 57891.29,-1063.03"/>
</g>
<!-- layer3_stage1_expert_52_gpu14 -->
<g id="node397" class="node">
<title>layer3_stage1_expert_52_gpu14</title>
<polygon fill="none" stroke="black" points="58268.72,-1054.79 58062.72,-1054.79 58062.72,-991.79 58268.72,-991.79 58268.72,-1054.79"/>
<text text-anchor="middle" x="58165.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_52_gpu14</text>
<text text-anchor="middle" x="58165.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 52</text>
<text text-anchor="middle" x="58165.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="58165.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="58165.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_52_gpu14 -->
<g id="edge609" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_52_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53746.92,-1182.82C54545.53,-1175.77 57842.6,-1143.29 58053.72,-1086.29 58074.37,-1080.71 58095.32,-1070.56 58113.44,-1060.07"/>
<polygon fill="black" stroke="black" points="58115.29,-1063.04 58122.08,-1054.91 58111.7,-1057.03 58115.29,-1063.04"/>
</g>
<!-- layer3_stage1_expert_53_gpu14 -->
<g id="node398" class="node">
<title>layer3_stage1_expert_53_gpu14</title>
<polygon fill="none" stroke="black" points="58492.72,-1054.79 58286.72,-1054.79 58286.72,-991.79 58492.72,-991.79 58492.72,-1054.79"/>
<text text-anchor="middle" x="58389.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_53_gpu14</text>
<text text-anchor="middle" x="58389.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 53</text>
<text text-anchor="middle" x="58389.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="58389.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="58389.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_53_gpu14 -->
<g id="edge610" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_53_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53746.94,-1183.01C54570.02,-1176.64 58055.25,-1146.23 58277.72,-1086.29 58298.37,-1080.72 58319.33,-1070.58 58337.44,-1060.08"/>
<polygon fill="black" stroke="black" points="58339.29,-1063.05 58346.09,-1054.92 58335.71,-1057.04 58339.29,-1063.05"/>
</g>
<!-- layer3_stage1_expert_54_gpu14 -->
<g id="node399" class="node">
<title>layer3_stage1_expert_54_gpu14</title>
<polygon fill="none" stroke="black" points="58716.72,-1054.79 58510.72,-1054.79 58510.72,-991.79 58716.72,-991.79 58716.72,-1054.79"/>
<text text-anchor="middle" x="58613.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_54_gpu14</text>
<text text-anchor="middle" x="58613.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 54</text>
<text text-anchor="middle" x="58613.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="58613.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="58613.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_54_gpu14 -->
<g id="edge611" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_54_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.03,-1183.18C54594.17,-1177.47 58267.88,-1149.18 58501.72,-1086.29 58522.38,-1080.73 58543.33,-1070.59 58561.44,-1060.09"/>
<polygon fill="black" stroke="black" points="58563.3,-1063.06 58570.09,-1054.93 58559.71,-1057.05 58563.3,-1063.06"/>
</g>
<!-- layer3_stage1_expert_55_gpu14 -->
<g id="node400" class="node">
<title>layer3_stage1_expert_55_gpu14</title>
<polygon fill="none" stroke="black" points="58940.72,-1054.79 58734.72,-1054.79 58734.72,-991.79 58940.72,-991.79 58940.72,-1054.79"/>
<text text-anchor="middle" x="58837.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_55_gpu14</text>
<text text-anchor="middle" x="58837.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 55</text>
<text text-anchor="middle" x="58837.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="58837.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="58837.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_55_gpu14 -->
<g id="edge612" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_55_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.28,-1183.33C54618.25,-1178.26 58480.52,-1152.12 58725.72,-1086.29 58746.38,-1080.74 58767.33,-1070.6 58785.44,-1060.1"/>
<polygon fill="black" stroke="black" points="58787.3,-1063.07 58794.09,-1054.94 58783.71,-1057.06 58787.3,-1063.07"/>
</g>
<!-- layer3_stage1_expert_56_gpu15 -->
<g id="node401" class="node">
<title>layer3_stage1_expert_56_gpu15</title>
<polygon fill="none" stroke="black" points="59164.72,-1054.79 58958.72,-1054.79 58958.72,-991.79 59164.72,-991.79 59164.72,-1054.79"/>
<text text-anchor="middle" x="59061.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_56_gpu15</text>
<text text-anchor="middle" x="59061.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 56</text>
<text text-anchor="middle" x="59061.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="59061.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="59061.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_56_gpu15 -->
<g id="edge613" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_56_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.39,-1183.48C54641.44,-1179.02 58693.13,-1155.07 58949.72,-1086.29 58970.47,-1080.72 58991.52,-1070.52 59009.69,-1059.97"/>
<polygon fill="black" stroke="black" points="59011.57,-1062.92 59018.36,-1054.79 59007.98,-1056.92 59011.57,-1062.92"/>
</g>
<!-- layer3_stage1_expert_57_gpu15 -->
<g id="node402" class="node">
<title>layer3_stage1_expert_57_gpu15</title>
<polygon fill="none" stroke="black" points="59388.72,-1054.79 59182.72,-1054.79 59182.72,-991.79 59388.72,-991.79 59388.72,-1054.79"/>
<text text-anchor="middle" x="59285.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_57_gpu15</text>
<text text-anchor="middle" x="59285.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 57</text>
<text text-anchor="middle" x="59285.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="59285.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="59285.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_57_gpu15 -->
<g id="edge614" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_57_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.41,-1183.61C54663.88,-1179.74 58905.72,-1158.02 59173.72,-1086.29 59194.47,-1080.73 59215.53,-1070.53 59233.69,-1059.98"/>
<polygon fill="black" stroke="black" points="59235.58,-1062.93 59242.36,-1054.8 59231.98,-1056.92 59235.58,-1062.93"/>
</g>
<!-- layer3_stage1_expert_58_gpu15 -->
<g id="node403" class="node">
<title>layer3_stage1_expert_58_gpu15</title>
<polygon fill="none" stroke="black" points="59612.72,-1054.79 59406.72,-1054.79 59406.72,-991.79 59612.72,-991.79 59612.72,-1054.79"/>
<text text-anchor="middle" x="59509.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_58_gpu15</text>
<text text-anchor="middle" x="59509.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 58</text>
<text text-anchor="middle" x="59509.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="59509.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="59509.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_58_gpu15 -->
<g id="edge615" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_58_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.37,-1183.73C54685.71,-1180.44 59118.29,-1160.98 59397.72,-1086.29 59418.48,-1080.74 59439.53,-1070.54 59457.69,-1059.99"/>
<polygon fill="black" stroke="black" points="59459.58,-1062.94 59466.37,-1054.8 59455.99,-1056.93 59459.58,-1062.94"/>
</g>
<!-- layer3_stage1_expert_59_gpu15 -->
<g id="node404" class="node">
<title>layer3_stage1_expert_59_gpu15</title>
<polygon fill="none" stroke="black" points="59836.72,-1054.79 59630.72,-1054.79 59630.72,-991.79 59836.72,-991.79 59836.72,-1054.79"/>
<text text-anchor="middle" x="59733.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_59_gpu15</text>
<text text-anchor="middle" x="59733.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 59</text>
<text text-anchor="middle" x="59733.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="59733.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="59733.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_59_gpu15 -->
<g id="edge616" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_59_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.71,-1183.84C54708.34,-1181.11 59330.89,-1163.93 59621.72,-1086.29 59642.48,-1080.74 59663.53,-1070.55 59681.7,-1060"/>
<polygon fill="black" stroke="black" points="59683.58,-1062.95 59690.37,-1054.81 59679.99,-1056.94 59683.58,-1062.95"/>
</g>
<!-- layer3_stage1_expert_60_gpu15 -->
<g id="node405" class="node">
<title>layer3_stage1_expert_60_gpu15</title>
<polygon fill="none" stroke="black" points="60060.72,-1054.79 59854.72,-1054.79 59854.72,-991.79 60060.72,-991.79 60060.72,-1054.79"/>
<text text-anchor="middle" x="59957.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_60_gpu15</text>
<text text-anchor="middle" x="59957.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 60</text>
<text text-anchor="middle" x="59957.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="59957.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="59957.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_60_gpu15 -->
<g id="edge617" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_60_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.7,-1183.95C54729.43,-1181.75 59543.44,-1166.89 59845.72,-1086.29 59866.48,-1080.75 59887.53,-1070.55 59905.7,-1060"/>
<polygon fill="black" stroke="black" points="59907.58,-1062.95 59914.37,-1054.82 59903.99,-1056.95 59907.58,-1062.95"/>
</g>
<!-- layer3_stage1_expert_61_gpu15 -->
<g id="node406" class="node">
<title>layer3_stage1_expert_61_gpu15</title>
<polygon fill="none" stroke="black" points="60284.72,-1054.79 60078.72,-1054.79 60078.72,-991.79 60284.72,-991.79 60284.72,-1054.79"/>
<text text-anchor="middle" x="60181.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_61_gpu15</text>
<text text-anchor="middle" x="60181.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 61</text>
<text text-anchor="middle" x="60181.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="60181.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="60181.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_61_gpu15 -->
<g id="edge618" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_61_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.74,-1184.05C54750.34,-1182.38 59755.99,-1169.86 60069.72,-1086.29 60090.48,-1080.76 60111.54,-1070.56 60129.7,-1060.01"/>
<polygon fill="black" stroke="black" points="60131.59,-1062.96 60138.37,-1054.82 60127.99,-1056.95 60131.59,-1062.96"/>
</g>
<!-- layer3_stage1_expert_62_gpu15 -->
<g id="node407" class="node">
<title>layer3_stage1_expert_62_gpu15</title>
<polygon fill="none" stroke="black" points="60508.72,-1054.79 60302.72,-1054.79 60302.72,-991.79 60508.72,-991.79 60508.72,-1054.79"/>
<text text-anchor="middle" x="60405.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_62_gpu15</text>
<text text-anchor="middle" x="60405.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 62</text>
<text text-anchor="middle" x="60405.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="60405.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="60405.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_62_gpu15 -->
<g id="edge619" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_62_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.87,-1184.14C54771.22,-1182.98 59968.53,-1172.82 60293.72,-1086.29 60314.48,-1080.76 60335.54,-1070.57 60353.7,-1060.02"/>
<polygon fill="black" stroke="black" points="60355.59,-1062.97 60362.37,-1054.83 60351.99,-1056.96 60355.59,-1062.97"/>
</g>
<!-- layer3_stage1_expert_63_gpu15 -->
<g id="node408" class="node">
<title>layer3_stage1_expert_63_gpu15</title>
<polygon fill="none" stroke="black" points="60732.72,-1054.79 60526.72,-1054.79 60526.72,-991.79 60732.72,-991.79 60732.72,-1054.79"/>
<text text-anchor="middle" x="60629.72" y="-1042.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_63_gpu15</text>
<text text-anchor="middle" x="60629.72" y="-1031.79" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="60629.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="60629.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=640000, hidden_dim=8192</text>
<text text-anchor="middle" x="60629.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=640000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_gating&#45;&gt;layer3_stage1_expert_63_gpu15 -->
<g id="edge620" class="edge">
<title>layer3_stage1_gating&#45;&gt;layer3_stage1_expert_63_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53747.71,-1184.23C54790.75,-1183.56 60181.04,-1175.79 60517.72,-1086.29 60538.48,-1080.77 60559.54,-1070.57 60577.7,-1060.02"/>
<polygon fill="black" stroke="black" points="60579.59,-1062.97 60586.37,-1054.83 60576,-1056.97 60579.59,-1062.97"/>
</g>
<!-- layer3_stage1_expert_aggregate -->
<g id="node409" class="node">
<title>layer3_stage1_expert_aggregate</title>
<polygon fill="none" stroke="black" points="53815.34,-924.29 53430.97,-924.29 53332.09,-798.29 53716.47,-798.29 53815.34,-924.29"/>
<text text-anchor="middle" x="53573.72" y="-880.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_aggregate</text>
<text text-anchor="middle" x="53573.72" y="-869.79" font-family="Arial" font-size="10.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="53573.72" y="-858.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="53573.72" y="-847.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x16)</text>
<text text-anchor="middle" x="53573.72" y="-836.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_expert_0_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge621" class="edge">
<title>layer3_stage1_expert_0_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M46561.06,-991.74C46581,-979.46 46605.55,-966.71 46629.72,-960.29 46713.4,-938.04 52243.56,-876.75 53373.44,-864.45"/>
<polygon fill="black" stroke="black" points="53373.74,-867.95 53383.7,-864.34 53373.66,-860.95 53373.74,-867.95"/>
</g>
<!-- layer3_stage1_expert_1_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge622" class="edge">
<title>layer3_stage1_expert_1_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M46785.06,-991.74C46805,-979.47 46829.56,-966.72 46853.72,-960.29 47015.2,-917.31 52271.68,-872.75 53372.72,-863.88"/>
<polygon fill="black" stroke="black" points="53373.14,-867.37 53383.11,-863.79 53373.08,-860.37 53373.14,-867.37"/>
</g>
<!-- layer3_stage1_expert_2_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge623" class="edge">
<title>layer3_stage1_expert_2_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M47009.07,-991.75C47029,-979.47 47053.56,-966.72 47077.72,-960.29 47233.51,-918.79 52295.76,-873.22 53373.3,-863.98"/>
<polygon fill="black" stroke="black" points="53373.5,-867.47 53383.47,-863.89 53373.44,-860.47 53373.5,-867.47"/>
</g>
<!-- layer3_stage1_expert_3_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge624" class="edge">
<title>layer3_stage1_expert_3_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M47233.07,-991.76C47253,-979.48 47277.56,-966.73 47301.72,-960.29 47601.28,-880.4 52331.83,-865.09 53372.34,-862.68"/>
<polygon fill="black" stroke="black" points="53372.55,-866.18 53382.55,-862.66 53372.54,-859.18 53372.55,-866.18"/>
</g>
<!-- layer3_stage1_expert_4_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge625" class="edge">
<title>layer3_stage1_expert_4_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M47457.07,-991.76C47477.01,-979.49 47501.56,-966.74 47525.72,-960.29 47813.85,-883.36 52353.88,-865.79 53372.11,-862.81"/>
<polygon fill="black" stroke="black" points="53372.47,-866.31 53382.46,-862.78 53372.45,-859.31 53372.47,-866.31"/>
</g>
<!-- layer3_stage1_expert_5_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge626" class="edge">
<title>layer3_stage1_expert_5_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M47681.07,-991.77C47701.01,-979.5 47725.56,-966.74 47749.72,-960.29 48026.51,-886.3 52378.7,-866.5 53372.66,-862.94"/>
<polygon fill="black" stroke="black" points="53372.78,-866.44 53382.77,-862.9 53372.76,-859.44 53372.78,-866.44"/>
</g>
<!-- layer3_stage1_expert_6_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge627" class="edge">
<title>layer3_stage1_expert_6_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M47905.07,-991.78C47925.01,-979.51 47949.57,-966.75 47973.72,-960.29 48239.12,-889.25 52401.81,-867.25 53372.49,-863.08"/>
<polygon fill="black" stroke="black" points="53372.73,-866.58 53382.71,-863.04 53372.7,-859.58 53372.73,-866.58"/>
</g>
<!-- layer3_stage1_expert_7_gpu8&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge628" class="edge">
<title>layer3_stage1_expert_7_gpu8&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M48129.07,-991.79C48149.01,-979.52 48173.57,-966.76 48197.72,-960.29 48451.75,-892.19 52425.72,-868.04 53372.42,-863.23"/>
<polygon fill="black" stroke="black" points="53372.75,-866.73 53382.73,-863.18 53372.71,-859.73 53372.75,-866.73"/>
</g>
<!-- layer3_stage1_expert_8_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge629" class="edge">
<title>layer3_stage1_expert_8_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M48353.34,-991.63C48373.23,-979.41 48397.68,-966.74 48421.72,-960.29 48664.44,-895.12 52451.48,-868.84 53372.83,-863.4"/>
<polygon fill="black" stroke="black" points="53372.9,-866.9 53382.88,-863.34 53372.86,-859.9 53372.9,-866.9"/>
</g>
<!-- layer3_stage1_expert_9_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge630" class="edge">
<title>layer3_stage1_expert_9_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M48577.35,-991.64C48597.24,-979.43 48621.68,-966.75 48645.72,-960.29 48877.12,-898.05 52477.34,-869.69 53373.1,-863.58"/>
<polygon fill="black" stroke="black" points="53373.22,-867.08 53383.19,-863.51 53373.17,-860.08 53373.22,-867.08"/>
</g>
<!-- layer3_stage1_expert_10_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge631" class="edge">
<title>layer3_stage1_expert_10_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M48801.35,-991.65C48821.24,-979.44 48845.68,-966.76 48869.72,-960.29 49089.82,-900.98 52503.44,-870.58 53373.26,-863.78"/>
<polygon fill="black" stroke="black" points="53373.4,-867.27 53383.37,-863.7 53373.35,-860.28 53373.4,-867.27"/>
</g>
<!-- layer3_stage1_expert_11_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge632" class="edge">
<title>layer3_stage1_expert_11_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M49025.35,-991.66C49045.25,-979.45 49069.69,-966.78 49093.72,-960.29 49302.53,-903.9 52530.08,-871.52 53373.39,-863.99"/>
<polygon fill="black" stroke="black" points="53373.54,-867.49 53383.5,-863.9 53373.47,-860.49 53373.54,-867.49"/>
</g>
<!-- layer3_stage1_expert_12_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge633" class="edge">
<title>layer3_stage1_expert_12_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M49249.36,-991.68C49269.25,-979.47 49293.69,-966.79 49317.72,-960.29 49515.26,-906.83 52557.52,-872.51 53373.58,-864.23"/>
<polygon fill="black" stroke="black" points="53373.71,-867.73 53383.67,-864.13 53373.63,-860.73 53373.71,-867.73"/>
</g>
<!-- layer3_stage1_expert_13_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge634" class="edge">
<title>layer3_stage1_expert_13_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M49473.36,-991.69C49493.25,-979.49 49517.69,-966.8 49541.72,-960.29 49728,-909.75 52585.24,-873.56 53373.6,-864.5"/>
<polygon fill="black" stroke="black" points="53373.68,-868 53383.64,-864.38 53373.6,-861 53373.68,-868"/>
</g>
<!-- layer3_stage1_expert_14_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge635" class="edge">
<title>layer3_stage1_expert_14_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M49697.36,-991.71C49717.26,-979.51 49741.7,-966.82 49765.72,-960.29 50113.77,-865.59 52634.31,-861.12 53371.64,-861.87"/>
<polygon fill="black" stroke="black" points="53371.83,-865.37 53381.83,-861.88 53371.83,-858.37 53371.83,-865.37"/>
</g>
<!-- layer3_stage1_expert_15_gpu9&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge636" class="edge">
<title>layer3_stage1_expert_15_gpu9&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M49921.37,-991.73C49941.27,-979.53 49965.7,-966.84 49989.72,-960.29 50315.47,-871.37 52664.01,-862.78 53372.14,-862.23"/>
<polygon fill="black" stroke="black" points="53372.19,-865.73 53382.19,-862.22 53372.18,-858.73 53372.19,-865.73"/>
</g>
<!-- layer3_stage1_expert_16_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge637" class="edge">
<title>layer3_stage1_expert_16_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M50145.37,-991.75C50165.27,-979.55 50189.71,-966.86 50213.72,-960.29 50517.15,-877.17 52693.43,-864.54 53372.12,-862.63"/>
<polygon fill="black" stroke="black" points="53372.5,-866.13 53382.49,-862.6 53372.48,-859.13 53372.5,-866.13"/>
</g>
<!-- layer3_stage1_expert_17_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge638" class="edge">
<title>layer3_stage1_expert_17_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M50369.38,-991.77C50389.28,-979.58 50413.72,-966.89 50437.72,-960.29 50718.91,-882.95 52724.25,-866.42 53372.29,-863.09"/>
<polygon fill="black" stroke="black" points="53372.69,-866.58 53382.67,-863.03 53372.65,-859.58 53372.69,-866.58"/>
</g>
<!-- layer3_stage1_expert_18_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge639" class="edge">
<title>layer3_stage1_expert_18_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M50593.66,-991.63C50613.51,-979.5 50637.83,-966.89 50661.72,-960.29 50920.8,-888.69 52757.06,-868.43 53372.92,-863.61"/>
<polygon fill="black" stroke="black" points="53373.27,-867.11 53383.24,-863.53 53373.21,-860.11 53373.27,-867.11"/>
</g>
<!-- layer3_stage1_expert_19_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge640" class="edge">
<title>layer3_stage1_expert_19_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M50817.66,-991.67C50837.52,-979.54 50861.84,-966.92 50885.72,-960.29 51122.75,-894.43 52790.89,-870.59 53373.49,-864.22"/>
<polygon fill="black" stroke="black" points="53373.71,-867.72 53383.67,-864.11 53373.64,-860.72 53373.71,-867.72"/>
</g>
<!-- layer3_stage1_expert_20_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge641" class="edge">
<title>layer3_stage1_expert_20_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M51041.67,-991.7C51061.53,-979.58 51085.85,-966.96 51109.72,-960.29 51324.74,-900.16 52825.43,-872.95 53373.73,-864.94"/>
<polygon fill="black" stroke="black" points="53374.18,-868.43 53384.12,-864.79 53374.07,-861.43 53374.18,-868.43"/>
</g>
<!-- layer3_stage1_expert_21_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge642" class="edge">
<title>layer3_stage1_expert_21_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M51265.69,-991.75C51285.54,-979.64 51309.87,-967.01 51333.72,-960.29 51526.91,-905.85 52862.86,-875.52 53374.74,-865.78"/>
<polygon fill="black" stroke="black" points="53374.89,-869.28 53384.82,-865.59 53374.76,-862.28 53374.89,-869.28"/>
</g>
<!-- layer3_stage1_expert_22_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge643" class="edge">
<title>layer3_stage1_expert_22_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M51489.97,-991.64C51509.78,-979.59 51533.99,-967.03 51557.72,-960.29 51729.13,-911.54 52901.09,-878.38 53375.24,-866.82"/>
<polygon fill="black" stroke="black" points="53375.36,-870.32 53385.28,-866.58 53375.19,-863.32 53375.36,-870.32"/>
</g>
<!-- layer3_stage1_expert_23_gpu10&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge644" class="edge">
<title>layer3_stage1_expert_23_gpu10&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M51713.99,-991.71C51733.8,-979.67 51758.01,-967.11 51781.72,-960.29 52074.86,-875.96 52967.87,-863.3 53371.66,-862.01"/>
<polygon fill="black" stroke="black" points="53371.71,-865.51 53381.7,-861.98 53371.69,-858.51 53371.71,-865.51"/>
</g>
<!-- layer3_stage1_expert_24_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge645" class="edge">
<title>layer3_stage1_expert_24_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M51938.28,-991.64C51958.05,-979.66 51982.14,-967.17 52005.72,-960.29 52256.44,-887.1 53009.61,-868.57 53373.12,-863.88"/>
<polygon fill="black" stroke="black" points="53373.27,-867.38 53383.22,-863.75 53373.18,-860.38 53373.27,-867.38"/>
</g>
<!-- layer3_stage1_expert_25_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge646" class="edge">
<title>layer3_stage1_expert_25_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M52162.32,-991.76C52182.09,-979.8 52206.18,-967.29 52229.72,-960.29 52438.45,-898.18 53054.35,-874.58 53374.84,-866.32"/>
<polygon fill="black" stroke="black" points="53375.27,-869.81 53385.18,-866.06 53375.09,-862.81 53375.27,-869.81"/>
</g>
<!-- layer3_stage1_expert_26_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge647" class="edge">
<title>layer3_stage1_expert_26_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M52386.64,-991.76C52406.37,-979.88 52430.34,-967.43 52453.72,-960.29 52621.11,-909.16 53103.66,-881.57 53377.63,-869.63"/>
<polygon fill="black" stroke="black" points="53377.85,-873.13 53387.69,-869.2 53377.55,-866.13 53377.85,-873.13"/>
</g>
<!-- layer3_stage1_expert_27_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge648" class="edge">
<title>layer3_stage1_expert_27_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M52611.25,-991.68C52630.9,-979.94 52654.63,-967.61 52677.72,-960.29 52804.42,-920.08 53157.55,-890.08 53380.79,-874.45"/>
<polygon fill="black" stroke="black" points="53381.26,-877.92 53390.99,-873.73 53380.77,-870.94 53381.26,-877.92"/>
</g>
<!-- layer3_stage1_expert_28_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge649" class="edge">
<title>layer3_stage1_expert_28_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M52835.93,-991.77C52855.49,-980.19 52878.97,-967.96 52901.72,-960.29 53057.31,-907.83 53242.49,-883.44 53379.01,-872.11"/>
<polygon fill="black" stroke="black" points="53379.49,-875.58 53389.17,-871.28 53378.92,-868.61 53379.49,-875.58"/>
</g>
<!-- layer3_stage1_expert_29_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge650" class="edge">
<title>layer3_stage1_expert_29_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M53061.58,-991.77C53080.9,-980.54 53103.78,-968.56 53125.72,-960.29 53210.82,-928.21 53309.18,-905.24 53392.01,-889.65"/>
<polygon fill="black" stroke="black" points="53392.84,-893.05 53402.03,-887.78 53391.56,-886.17 53392.84,-893.05"/>
</g>
<!-- layer3_stage1_expert_30_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge651" class="edge">
<title>layer3_stage1_expert_30_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M53290.45,-991.77C53308.99,-981.4 53330.09,-969.99 53349.72,-960.29 53372.41,-949.07 53396.69,-937.76 53420.57,-927.02"/>
<polygon fill="black" stroke="black" points="53422.01,-930.21 53429.71,-922.92 53419.15,-923.82 53422.01,-930.21"/>
</g>
<!-- layer3_stage1_expert_31_gpu11&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge652" class="edge">
<title>layer3_stage1_expert_31_gpu11&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M53483.31,-991.44C53494.99,-974.76 53509.92,-953.42 53524.28,-932.92"/>
<polygon fill="black" stroke="black" points="53527.3,-934.7 53530.17,-924.5 53521.56,-930.69 53527.3,-934.7"/>
</g>
<!-- layer3_stage1_expert_32_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge653" class="edge">
<title>layer3_stage1_expert_32_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M53664.12,-991.44C53652.45,-974.76 53637.51,-953.42 53623.16,-932.92"/>
<polygon fill="black" stroke="black" points="53625.87,-930.69 53617.27,-924.5 53620.14,-934.7 53625.87,-930.69"/>
</g>
<!-- layer3_stage1_expert_33_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge654" class="edge">
<title>layer3_stage1_expert_33_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M53856.99,-991.77C53838.45,-981.4 53817.34,-969.99 53797.72,-960.29 53776.14,-949.63 53753.14,-938.88 53730.4,-928.61"/>
<polygon fill="black" stroke="black" points="53731.58,-925.3 53721.02,-924.39 53728.71,-931.69 53731.58,-925.3"/>
</g>
<!-- layer3_stage1_expert_34_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge655" class="edge">
<title>layer3_stage1_expert_34_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M54085.85,-991.77C54066.54,-980.54 54043.66,-968.56 54021.72,-960.29 53952.79,-934.3 53875.16,-914.3 53804.13,-899.35"/>
<polygon fill="black" stroke="black" points="53804.66,-895.89 53794.16,-897.27 53803.23,-902.74 53804.66,-895.89"/>
</g>
<!-- layer3_stage1_expert_35_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge656" class="edge">
<title>layer3_stage1_expert_35_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M54311.51,-991.77C54291.95,-980.19 54268.46,-967.96 54245.72,-960.29 54096.4,-909.94 53919.82,-885.45 53785.15,-873.54"/>
<polygon fill="black" stroke="black" points="53785.39,-870.05 53775.12,-872.67 53784.78,-877.03 53785.39,-870.05"/>
</g>
<!-- layer3_stage1_expert_36_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge657" class="edge">
<title>layer3_stage1_expert_36_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M54536.18,-991.68C54516.54,-979.94 54492.81,-967.61 54469.72,-960.29 54346.83,-921.29 54010.92,-891.89 53787.13,-875.89"/>
<polygon fill="black" stroke="black" points="53787.11,-872.38 53776.89,-875.17 53786.62,-879.37 53787.11,-872.38"/>
</g>
<!-- layer3_stage1_expert_37_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge658" class="edge">
<title>layer3_stage1_expert_37_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M54760.8,-991.76C54741.07,-979.88 54717.1,-967.43 54693.72,-960.29 54528.97,-909.97 54058.98,-882.45 53782.98,-870.21"/>
<polygon fill="black" stroke="black" points="53782.98,-866.71 53772.83,-869.76 53782.67,-873.7 53782.98,-866.71"/>
</g>
<!-- layer3_stage1_expert_38_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge659" class="edge">
<title>layer3_stage1_expert_38_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M54985.12,-991.76C54965.34,-979.8 54941.26,-967.29 54917.72,-960.29 54710.65,-898.68 54102.88,-874.96 53780.31,-866.52"/>
<polygon fill="black" stroke="black" points="53779.99,-863.01 53769.91,-866.25 53779.81,-870.01 53779.99,-863.01"/>
</g>
<!-- layer3_stage1_expert_39_gpu12&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge660" class="edge">
<title>layer3_stage1_expert_39_gpu12&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M55209.15,-991.64C55189.38,-979.66 55165.29,-967.17 55141.72,-960.29 54891.88,-887.36 54143.18,-868.7 53778.21,-863.93"/>
<polygon fill="black" stroke="black" points="53778.11,-860.43 53768.06,-863.8 53778.02,-867.43 53778.11,-860.43"/>
</g>
<!-- layer3_stage1_expert_40_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge661" class="edge">
<title>layer3_stage1_expert_40_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M55433.45,-991.71C55413.63,-979.67 55389.43,-967.11 55365.72,-960.29 55072.76,-876.01 54180.7,-863.31 53776.54,-862.01"/>
<polygon fill="black" stroke="black" points="53776.51,-858.51 53766.5,-861.98 53776.49,-865.51 53776.51,-858.51"/>
</g>
<!-- layer3_stage1_expert_41_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge662" class="edge">
<title>layer3_stage1_expert_41_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M55657.46,-991.64C55637.65,-979.59 55613.45,-967.03 55589.72,-960.29 55419.3,-911.82 54259.9,-878.77 53780.51,-867.02"/>
<polygon fill="black" stroke="black" points="53780.44,-863.52 53770.36,-866.78 53780.27,-870.52 53780.44,-863.52"/>
</g>
<!-- layer3_stage1_expert_42_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge663" class="edge">
<title>layer3_stage1_expert_42_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M55881.75,-991.75C55861.89,-979.64 55837.57,-967.01 55813.72,-960.29 55621.39,-906.09 54296.62,-875.79 53779.68,-865.92"/>
<polygon fill="black" stroke="black" points="53779.56,-862.41 53769.49,-865.72 53779.42,-869.41 53779.56,-862.41"/>
</g>
<!-- layer3_stage1_expert_43_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge664" class="edge">
<title>layer3_stage1_expert_43_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M56105.76,-991.7C56085.91,-979.58 56061.58,-966.96 56037.72,-960.29 55823.41,-900.36 54331.98,-873.13 53779.21,-865.02"/>
<polygon fill="black" stroke="black" points="53779.18,-861.52 53769.13,-864.87 53779.08,-868.52 53779.18,-861.52"/>
</g>
<!-- layer3_stage1_expert_44_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge665" class="edge">
<title>layer3_stage1_expert_44_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M56329.77,-991.67C56309.92,-979.54 56285.59,-966.92 56261.72,-960.29 56025.31,-894.6 54365.39,-870.72 53778.61,-864.27"/>
<polygon fill="black" stroke="black" points="53778.38,-860.77 53768.35,-864.16 53778.31,-867.77 53778.38,-860.77"/>
</g>
<!-- layer3_stage1_expert_45_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge666" class="edge">
<title>layer3_stage1_expert_45_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M56553.78,-991.63C56533.93,-979.5 56509.6,-966.89 56485.72,-960.29 56227.17,-888.84 54397.89,-868.51 53778.31,-863.64"/>
<polygon fill="black" stroke="black" points="53777.96,-860.14 53767.93,-863.56 53777.9,-867.14 53777.96,-860.14"/>
</g>
<!-- layer3_stage1_expert_46_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge667" class="edge">
<title>layer3_stage1_expert_46_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M56778.05,-991.77C56758.16,-979.58 56733.72,-966.89 56709.72,-960.29 56428.94,-883.06 54429.01,-866.47 53777.97,-863.1"/>
<polygon fill="black" stroke="black" points="53777.56,-859.6 53767.54,-863.05 53777.53,-866.6 53777.56,-859.6"/>
</g>
<!-- layer3_stage1_expert_47_gpu13&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge668" class="edge">
<title>layer3_stage1_expert_47_gpu13&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M57002.06,-991.75C56982.16,-979.55 56957.73,-966.86 56933.72,-960.29 56630.56,-877.24 54457.86,-864.57 53777.12,-862.63"/>
<polygon fill="black" stroke="black" points="53776.97,-859.13 53766.96,-862.6 53776.95,-866.13 53776.97,-859.13"/>
</g>
<!-- layer3_stage1_expert_48_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge669" class="edge">
<title>layer3_stage1_expert_48_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M57226.07,-991.73C57206.17,-979.53 57181.73,-966.84 57157.72,-960.29 56832.2,-871.44 54486.79,-862.79 53776.82,-862.23"/>
<polygon fill="black" stroke="black" points="53776.75,-858.73 53766.75,-862.22 53776.74,-865.73 53776.75,-858.73"/>
</g>
<!-- layer3_stage1_expert_49_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge670" class="edge">
<title>layer3_stage1_expert_49_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M57450.07,-991.71C57430.18,-979.51 57405.74,-966.82 57381.72,-960.29 57033.81,-865.63 54515.28,-861.13 53776.75,-861.87"/>
<polygon fill="black" stroke="black" points="53776.53,-858.37 53766.54,-861.88 53776.54,-865.37 53776.53,-858.37"/>
</g>
<!-- layer3_stage1_expert_50_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge671" class="edge">
<title>layer3_stage1_expert_50_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M57674.08,-991.69C57654.18,-979.49 57629.74,-966.8 57605.72,-960.29 57419.81,-909.85 54573.47,-873.7 53778.53,-864.55"/>
<polygon fill="black" stroke="black" points="53778.45,-861.05 53768.41,-864.44 53778.37,-868.05 53778.45,-861.05"/>
</g>
<!-- layer3_stage1_expert_51_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge672" class="edge">
<title>layer3_stage1_expert_51_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M57898.08,-991.68C57878.19,-979.47 57853.75,-966.79 57829.72,-960.29 57632.54,-906.92 54601.02,-872.63 53778.35,-864.28"/>
<polygon fill="black" stroke="black" points="53778.21,-860.78 53768.18,-864.17 53778.14,-867.78 53778.21,-860.78"/>
</g>
<!-- layer3_stage1_expert_52_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge673" class="edge">
<title>layer3_stage1_expert_52_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M58122.08,-991.66C58102.19,-979.45 58077.75,-966.78 58053.72,-960.29 57845.26,-904 54628.19,-871.63 53778.32,-864.03"/>
<polygon fill="black" stroke="black" points="53778.15,-860.53 53768.12,-863.94 53778.09,-867.53 53778.15,-860.53"/>
</g>
<!-- layer3_stage1_expert_53_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge674" class="edge">
<title>layer3_stage1_expert_53_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M58346.09,-991.65C58326.19,-979.44 58301.75,-966.76 58277.72,-960.29 58057.96,-901.07 54654.46,-870.68 53778.2,-863.81"/>
<polygon fill="black" stroke="black" points="53778.03,-860.31 53768,-863.73 53777.98,-867.31 53778.03,-860.31"/>
</g>
<!-- layer3_stage1_expert_54_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge675" class="edge">
<title>layer3_stage1_expert_54_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M58570.09,-991.64C58550.2,-979.43 58525.76,-966.75 58501.72,-960.29 58270.63,-898.14 54680.1,-869.77 53778.08,-863.6"/>
<polygon fill="black" stroke="black" points="53777.94,-860.1 53767.92,-863.53 53777.9,-867.1 53777.94,-860.1"/>
</g>
<!-- layer3_stage1_expert_55_gpu14&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge676" class="edge">
<title>layer3_stage1_expert_55_gpu14&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M58794.09,-991.63C58774.2,-979.41 58749.76,-966.74 58725.72,-960.29 58483.27,-895.19 54704.35,-868.9 53777.68,-863.42"/>
<polygon fill="black" stroke="black" points="53777.6,-859.92 53767.57,-863.36 53777.55,-866.92 53777.6,-859.92"/>
</g>
<!-- layer3_stage1_expert_56_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge677" class="edge">
<title>layer3_stage1_expert_56_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M59018.36,-991.79C58998.42,-979.52 58973.87,-966.76 58949.72,-960.29 58695.9,-892.25 54728.43,-868.08 53777.43,-863.25"/>
<polygon fill="black" stroke="black" points="53777.42,-859.75 53767.4,-863.2 53777.39,-866.75 53777.42,-859.75"/>
</g>
<!-- layer3_stage1_expert_57_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge678" class="edge">
<title>layer3_stage1_expert_57_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M59242.36,-991.78C59222.42,-979.51 59197.87,-966.75 59173.72,-960.29 58908.57,-889.31 54753.65,-867.3 53777.77,-863.09"/>
<polygon fill="black" stroke="black" points="53777.5,-859.59 53767.49,-863.05 53777.47,-866.59 53777.5,-859.59"/>
</g>
<!-- layer3_stage1_expert_58_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge679" class="edge">
<title>layer3_stage1_expert_58_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M59466.37,-991.77C59446.43,-979.5 59421.87,-966.74 59397.72,-960.29 59121.19,-886.37 54777.1,-866.54 53777.65,-862.95"/>
<polygon fill="black" stroke="black" points="53777.5,-859.45 53767.49,-862.91 53777.47,-866.45 53777.5,-859.45"/>
</g>
<!-- layer3_stage1_expert_59_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge680" class="edge">
<title>layer3_stage1_expert_59_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M59690.37,-991.76C59670.43,-979.49 59645.87,-966.74 59621.72,-960.29 59333.79,-883.42 54799.91,-865.81 53777.47,-862.81"/>
<polygon fill="black" stroke="black" points="53777.46,-859.31 53767.45,-862.78 53777.44,-866.31 53777.46,-859.31"/>
</g>
<!-- layer3_stage1_expert_60_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge681" class="edge">
<title>layer3_stage1_expert_60_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M59914.37,-991.76C59894.43,-979.48 59869.88,-966.73 59845.72,-960.29 59546.41,-880.47 54823.37,-865.12 53777.66,-862.69"/>
<polygon fill="black" stroke="black" points="53777.42,-859.19 53767.41,-862.67 53777.4,-866.19 53777.42,-859.19"/>
</g>
<!-- layer3_stage1_expert_61_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge682" class="edge">
<title>layer3_stage1_expert_61_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M60138.37,-991.75C60118.43,-979.47 60093.88,-966.72 60069.72,-960.29 59758.94,-877.5 54844,-864.44 53777.05,-862.57"/>
<polygon fill="black" stroke="black" points="53776.98,-859.07 53766.98,-862.56 53776.97,-866.07 53776.98,-859.07"/>
</g>
<!-- layer3_stage1_expert_62_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge683" class="edge">
<title>layer3_stage1_expert_62_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M60362.37,-991.74C60342.44,-979.47 60317.88,-966.72 60293.72,-960.29 59971.54,-874.55 54866.95,-863.79 53777.33,-862.47"/>
<polygon fill="black" stroke="black" points="53777.05,-858.97 53767.05,-862.46 53777.04,-865.97 53777.05,-858.97"/>
</g>
<!-- layer3_stage1_expert_63_gpu15&#45;&gt;layer3_stage1_expert_aggregate -->
<g id="edge684" class="edge">
<title>layer3_stage1_expert_63_gpu15&#45;&gt;layer3_stage1_expert_aggregate</title>
<path fill="none" stroke="black" d="M60586.37,-991.74C60566.44,-979.46 60541.88,-966.71 60517.72,-960.29 60184.06,-871.58 54887.17,-863.16 53776.86,-862.37"/>
<polygon fill="black" stroke="black" points="53776.78,-858.87 53766.78,-862.36 53776.78,-865.87 53776.78,-858.87"/>
</g>
<!-- layer3_stage1_expert_residual -->
<g id="node410" class="node">
<title>layer3_stage1_expert_residual</title>
<ellipse fill="none" stroke="black" cx="60939.72" cy="-1185.29" rx="161.44" ry="44.6"/>
<text text-anchor="middle" x="60939.72" y="-1204.79" font-family="Arial" font-size="10.00">layer3_stage1_expert_residual</text>
<text text-anchor="middle" x="60939.72" y="-1193.79" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="60939.72" y="-1182.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="60939.72" y="-1171.79" font-family="Arial" font-size="10.00">In: batch_size=10240000, hidden_dim=8192 (x2)</text>
<text text-anchor="middle" x="60939.72" y="-1160.79" font-family="Arial" font-size="10.00">Out: batch_size=10240000, hidden_dim=8192</text>
</g>
<!-- model_output -->
<g id="node411" class="node">
<title>model_output</title>
<ellipse fill="none" stroke="black" cx="60939.72" cy="-1023.29" rx="188.6" ry="44.6"/>
<text text-anchor="middle" x="60939.72" y="-1042.79" font-family="Arial" font-size="10.00">model_output</text>
<text text-anchor="middle" x="60939.72" y="-1031.79" font-family="Arial" font-size="10.00">Model Output</text>
<text text-anchor="middle" x="60939.72" y="-1020.79" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="60939.72" y="-1009.79" font-family="Arial" font-size="10.00">In: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
<text text-anchor="middle" x="60939.72" y="-998.79" font-family="Arial" font-size="10.00">Out: batch_size=1024, seq_len=10000, hidden_dim=8192</text>
</g>
<!-- layer3_stage1_expert_residual&#45;&gt;model_output -->
<g id="edge686" class="edge">
<title>layer3_stage1_expert_residual&#45;&gt;model_output</title>
<path fill="none" stroke="black" d="M60939.72,-1140.57C60939.72,-1121.25 60939.72,-1098.36 60939.72,-1078.02"/>
<polygon fill="black" stroke="black" points="60943.22,-1077.95 60939.72,-1067.95 60936.22,-1077.95 60943.22,-1077.95"/>
</g>
</g>
</svg>
