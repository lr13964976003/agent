digraph MoE_Baseline_TP8_PP2 {
	graph [bgcolor=white rankdir=TB]
	node [fontname=Arial fontsize=10]
	model_input [label="model_input\nModel Input\nGPU: 0-15\nIn: batch_size=1024, seq_len=10000, hidden_dim=8192\nOut: batch_size=1024, seq_len=10000, hidden_dim=8192" color=black shape=ellipse]
	layer0_stage0_input_reshape [label="layer0_stage0_input_reshape\nInput Reshape\nGPU: 0-7\nIn: batch_size=1024, seq_len=10000, hidden_dim=8192\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer0_stage0_qkv_proj_0 [label="layer0_stage0_qkv_proj_0\nQKV Projection (TP-0)\nGPU: 0\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_0 [label="" style=solid]
	layer0_stage0_qkv_proj_1 [label="layer0_stage0_qkv_proj_1\nQKV Projection (TP-1)\nGPU: 1\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_1 [label="" style=solid]
	layer0_stage0_qkv_proj_2 [label="layer0_stage0_qkv_proj_2\nQKV Projection (TP-2)\nGPU: 2\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_2 [label="" style=solid]
	layer0_stage0_qkv_proj_3 [label="layer0_stage0_qkv_proj_3\nQKV Projection (TP-3)\nGPU: 3\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_3 [label="" style=solid]
	layer0_stage0_qkv_proj_4 [label="layer0_stage0_qkv_proj_4\nQKV Projection (TP-4)\nGPU: 4\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_4 [label="" style=solid]
	layer0_stage0_qkv_proj_5 [label="layer0_stage0_qkv_proj_5\nQKV Projection (TP-5)\nGPU: 5\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_5 [label="" style=solid]
	layer0_stage0_qkv_proj_6 [label="layer0_stage0_qkv_proj_6\nQKV Projection (TP-6)\nGPU: 6\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_6 [label="" style=solid]
	layer0_stage0_qkv_proj_7 [label="layer0_stage0_qkv_proj_7\nQKV Projection (TP-7)\nGPU: 7\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer0_stage0_input_reshape -> layer0_stage0_qkv_proj_7 [label="" style=solid]
	layer0_stage0_qkv_reshape_0 [label="layer0_stage0_qkv_reshape_0\nQKV Reshape (TP-0)\nGPU: 0\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_0 -> layer0_stage0_qkv_reshape_0 [label="" style=solid]
	layer0_stage0_qkv_reshape_1 [label="layer0_stage0_qkv_reshape_1\nQKV Reshape (TP-1)\nGPU: 1\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_1 -> layer0_stage0_qkv_reshape_1 [label="" style=solid]
	layer0_stage0_qkv_reshape_2 [label="layer0_stage0_qkv_reshape_2\nQKV Reshape (TP-2)\nGPU: 2\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_2 -> layer0_stage0_qkv_reshape_2 [label="" style=solid]
	layer0_stage0_qkv_reshape_3 [label="layer0_stage0_qkv_reshape_3\nQKV Reshape (TP-3)\nGPU: 3\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_3 -> layer0_stage0_qkv_reshape_3 [label="" style=solid]
	layer0_stage0_qkv_reshape_4 [label="layer0_stage0_qkv_reshape_4\nQKV Reshape (TP-4)\nGPU: 4\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_4 -> layer0_stage0_qkv_reshape_4 [label="" style=solid]
	layer0_stage0_qkv_reshape_5 [label="layer0_stage0_qkv_reshape_5\nQKV Reshape (TP-5)\nGPU: 5\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_5 -> layer0_stage0_qkv_reshape_5 [label="" style=solid]
	layer0_stage0_qkv_reshape_6 [label="layer0_stage0_qkv_reshape_6\nQKV Reshape (TP-6)\nGPU: 6\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_6 -> layer0_stage0_qkv_reshape_6 [label="" style=solid]
	layer0_stage0_qkv_reshape_7 [label="layer0_stage0_qkv_reshape_7\nQKV Reshape (TP-7)\nGPU: 7\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer0_stage0_qkv_proj_7 -> layer0_stage0_qkv_reshape_7 [label="" style=solid]
	layer0_stage0_attention_0 [label="layer0_stage0_attention_0\nMulti-Head Attention (TP-0)\nGPU: 0\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_0 -> layer0_stage0_attention_0 [label="" style=solid]
	layer0_stage0_attention_1 [label="layer0_stage0_attention_1\nMulti-Head Attention (TP-1)\nGPU: 1\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_1 -> layer0_stage0_attention_1 [label="" style=solid]
	layer0_stage0_attention_2 [label="layer0_stage0_attention_2\nMulti-Head Attention (TP-2)\nGPU: 2\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_2 -> layer0_stage0_attention_2 [label="" style=solid]
	layer0_stage0_attention_3 [label="layer0_stage0_attention_3\nMulti-Head Attention (TP-3)\nGPU: 3\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_3 -> layer0_stage0_attention_3 [label="" style=solid]
	layer0_stage0_attention_4 [label="layer0_stage0_attention_4\nMulti-Head Attention (TP-4)\nGPU: 4\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_4 -> layer0_stage0_attention_4 [label="" style=solid]
	layer0_stage0_attention_5 [label="layer0_stage0_attention_5\nMulti-Head Attention (TP-5)\nGPU: 5\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_5 -> layer0_stage0_attention_5 [label="" style=solid]
	layer0_stage0_attention_6 [label="layer0_stage0_attention_6\nMulti-Head Attention (TP-6)\nGPU: 6\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_6 -> layer0_stage0_attention_6 [label="" style=solid]
	layer0_stage0_attention_7 [label="layer0_stage0_attention_7\nMulti-Head Attention (TP-7)\nGPU: 7\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer0_stage0_qkv_reshape_7 -> layer0_stage0_attention_7 [label="" style=solid]
	layer0_stage0_output_proj_0 [label="layer0_stage0_output_proj_0\nOutput Projection (TP-0)\nGPU: 0\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_0 -> layer0_stage0_output_proj_0 [label="" style=solid]
	layer0_stage0_output_proj_1 [label="layer0_stage0_output_proj_1\nOutput Projection (TP-1)\nGPU: 1\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_1 -> layer0_stage0_output_proj_1 [label="" style=solid]
	layer0_stage0_output_proj_2 [label="layer0_stage0_output_proj_2\nOutput Projection (TP-2)\nGPU: 2\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_2 -> layer0_stage0_output_proj_2 [label="" style=solid]
	layer0_stage0_output_proj_3 [label="layer0_stage0_output_proj_3\nOutput Projection (TP-3)\nGPU: 3\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_3 -> layer0_stage0_output_proj_3 [label="" style=solid]
	layer0_stage0_output_proj_4 [label="layer0_stage0_output_proj_4\nOutput Projection (TP-4)\nGPU: 4\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_4 -> layer0_stage0_output_proj_4 [label="" style=solid]
	layer0_stage0_output_proj_5 [label="layer0_stage0_output_proj_5\nOutput Projection (TP-5)\nGPU: 5\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_5 -> layer0_stage0_output_proj_5 [label="" style=solid]
	layer0_stage0_output_proj_6 [label="layer0_stage0_output_proj_6\nOutput Projection (TP-6)\nGPU: 6\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_6 -> layer0_stage0_output_proj_6 [label="" style=solid]
	layer0_stage0_output_proj_7 [label="layer0_stage0_output_proj_7\nOutput Projection (TP-7)\nGPU: 7\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer0_stage0_attention_7 -> layer0_stage0_output_proj_7 [label="" style=solid]
	layer0_stage0_attention_allreduce [label="layer0_stage0_attention_allreduce\nAll-Reduce Sum\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=1024 (x8)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer0_stage0_output_proj_0 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_1 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_2 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_3 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_4 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_5 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_6 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_output_proj_7 -> layer0_stage0_attention_allreduce [label="" style=solid]
	layer0_stage0_attention_residual [label="layer0_stage0_attention_residual\nResidual Add\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer0_stage0_input_reshape -> layer0_stage0_attention_residual [label="" style=dashed]
	layer0_stage0_attention_allreduce -> layer0_stage0_attention_residual [label="" style=solid]
	layer0_stage0_gating [label="layer0_stage0_gating\nGating Network\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192\nOut: batch_size=10240000, num_experts=16" color=black shape=parallelogram]
	layer0_stage0_expert_0_gpu0 [label="layer0_stage0_expert_0_gpu0\nExpert 0\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_0_gpu0 [label="" style=dashed]
	layer0_stage0_expert_1_gpu0 [label="layer0_stage0_expert_1_gpu0\nExpert 1\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_1_gpu0 [label="" style=dashed]
	layer0_stage0_expert_2_gpu0 [label="layer0_stage0_expert_2_gpu0\nExpert 2\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_2_gpu0 [label="" style=dashed]
	layer0_stage0_expert_3_gpu0 [label="layer0_stage0_expert_3_gpu0\nExpert 3\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_3_gpu0 [label="" style=dashed]
	layer0_stage0_expert_4_gpu0 [label="layer0_stage0_expert_4_gpu0\nExpert 4\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_4_gpu0 [label="" style=dashed]
	layer0_stage0_expert_5_gpu0 [label="layer0_stage0_expert_5_gpu0\nExpert 5\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_5_gpu0 [label="" style=dashed]
	layer0_stage0_expert_6_gpu0 [label="layer0_stage0_expert_6_gpu0\nExpert 6\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_6_gpu0 [label="" style=dashed]
	layer0_stage0_expert_7_gpu0 [label="layer0_stage0_expert_7_gpu0\nExpert 7\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_7_gpu0 [label="" style=dashed]
	layer0_stage0_expert_8_gpu1 [label="layer0_stage0_expert_8_gpu1\nExpert 8\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_8_gpu1 [label="" style=dashed]
	layer0_stage0_expert_9_gpu1 [label="layer0_stage0_expert_9_gpu1\nExpert 9\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_9_gpu1 [label="" style=dashed]
	layer0_stage0_expert_10_gpu1 [label="layer0_stage0_expert_10_gpu1\nExpert 10\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_10_gpu1 [label="" style=dashed]
	layer0_stage0_expert_11_gpu1 [label="layer0_stage0_expert_11_gpu1\nExpert 11\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_11_gpu1 [label="" style=dashed]
	layer0_stage0_expert_12_gpu1 [label="layer0_stage0_expert_12_gpu1\nExpert 12\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_12_gpu1 [label="" style=dashed]
	layer0_stage0_expert_13_gpu1 [label="layer0_stage0_expert_13_gpu1\nExpert 13\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_13_gpu1 [label="" style=dashed]
	layer0_stage0_expert_14_gpu1 [label="layer0_stage0_expert_14_gpu1\nExpert 14\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_14_gpu1 [label="" style=dashed]
	layer0_stage0_expert_15_gpu1 [label="layer0_stage0_expert_15_gpu1\nExpert 15\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_15_gpu1 [label="" style=dashed]
	layer0_stage0_expert_16_gpu2 [label="layer0_stage0_expert_16_gpu2\nExpert 16\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_16_gpu2 [label="" style=dashed]
	layer0_stage0_expert_17_gpu2 [label="layer0_stage0_expert_17_gpu2\nExpert 17\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_17_gpu2 [label="" style=dashed]
	layer0_stage0_expert_18_gpu2 [label="layer0_stage0_expert_18_gpu2\nExpert 18\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_18_gpu2 [label="" style=dashed]
	layer0_stage0_expert_19_gpu2 [label="layer0_stage0_expert_19_gpu2\nExpert 19\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_19_gpu2 [label="" style=dashed]
	layer0_stage0_expert_20_gpu2 [label="layer0_stage0_expert_20_gpu2\nExpert 20\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_20_gpu2 [label="" style=dashed]
	layer0_stage0_expert_21_gpu2 [label="layer0_stage0_expert_21_gpu2\nExpert 21\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_21_gpu2 [label="" style=dashed]
	layer0_stage0_expert_22_gpu2 [label="layer0_stage0_expert_22_gpu2\nExpert 22\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_22_gpu2 [label="" style=dashed]
	layer0_stage0_expert_23_gpu2 [label="layer0_stage0_expert_23_gpu2\nExpert 23\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_23_gpu2 [label="" style=dashed]
	layer0_stage0_expert_24_gpu3 [label="layer0_stage0_expert_24_gpu3\nExpert 24\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_24_gpu3 [label="" style=dashed]
	layer0_stage0_expert_25_gpu3 [label="layer0_stage0_expert_25_gpu3\nExpert 25\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_25_gpu3 [label="" style=dashed]
	layer0_stage0_expert_26_gpu3 [label="layer0_stage0_expert_26_gpu3\nExpert 26\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_26_gpu3 [label="" style=dashed]
	layer0_stage0_expert_27_gpu3 [label="layer0_stage0_expert_27_gpu3\nExpert 27\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_27_gpu3 [label="" style=dashed]
	layer0_stage0_expert_28_gpu3 [label="layer0_stage0_expert_28_gpu3\nExpert 28\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_28_gpu3 [label="" style=dashed]
	layer0_stage0_expert_29_gpu3 [label="layer0_stage0_expert_29_gpu3\nExpert 29\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_29_gpu3 [label="" style=dashed]
	layer0_stage0_expert_30_gpu3 [label="layer0_stage0_expert_30_gpu3\nExpert 30\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_30_gpu3 [label="" style=dashed]
	layer0_stage0_expert_31_gpu3 [label="layer0_stage0_expert_31_gpu3\nExpert 31\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_31_gpu3 [label="" style=dashed]
	layer0_stage0_expert_32_gpu4 [label="layer0_stage0_expert_32_gpu4\nExpert 32\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_32_gpu4 [label="" style=dashed]
	layer0_stage0_expert_33_gpu4 [label="layer0_stage0_expert_33_gpu4\nExpert 33\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_33_gpu4 [label="" style=dashed]
	layer0_stage0_expert_34_gpu4 [label="layer0_stage0_expert_34_gpu4\nExpert 34\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_34_gpu4 [label="" style=dashed]
	layer0_stage0_expert_35_gpu4 [label="layer0_stage0_expert_35_gpu4\nExpert 35\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_35_gpu4 [label="" style=dashed]
	layer0_stage0_expert_36_gpu4 [label="layer0_stage0_expert_36_gpu4\nExpert 36\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_36_gpu4 [label="" style=dashed]
	layer0_stage0_expert_37_gpu4 [label="layer0_stage0_expert_37_gpu4\nExpert 37\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_37_gpu4 [label="" style=dashed]
	layer0_stage0_expert_38_gpu4 [label="layer0_stage0_expert_38_gpu4\nExpert 38\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_38_gpu4 [label="" style=dashed]
	layer0_stage0_expert_39_gpu4 [label="layer0_stage0_expert_39_gpu4\nExpert 39\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_39_gpu4 [label="" style=dashed]
	layer0_stage0_expert_40_gpu5 [label="layer0_stage0_expert_40_gpu5\nExpert 40\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_40_gpu5 [label="" style=dashed]
	layer0_stage0_expert_41_gpu5 [label="layer0_stage0_expert_41_gpu5\nExpert 41\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_41_gpu5 [label="" style=dashed]
	layer0_stage0_expert_42_gpu5 [label="layer0_stage0_expert_42_gpu5\nExpert 42\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_42_gpu5 [label="" style=dashed]
	layer0_stage0_expert_43_gpu5 [label="layer0_stage0_expert_43_gpu5\nExpert 43\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_43_gpu5 [label="" style=dashed]
	layer0_stage0_expert_44_gpu5 [label="layer0_stage0_expert_44_gpu5\nExpert 44\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_44_gpu5 [label="" style=dashed]
	layer0_stage0_expert_45_gpu5 [label="layer0_stage0_expert_45_gpu5\nExpert 45\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_45_gpu5 [label="" style=dashed]
	layer0_stage0_expert_46_gpu5 [label="layer0_stage0_expert_46_gpu5\nExpert 46\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_46_gpu5 [label="" style=dashed]
	layer0_stage0_expert_47_gpu5 [label="layer0_stage0_expert_47_gpu5\nExpert 47\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_47_gpu5 [label="" style=dashed]
	layer0_stage0_expert_48_gpu6 [label="layer0_stage0_expert_48_gpu6\nExpert 48\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_48_gpu6 [label="" style=dashed]
	layer0_stage0_expert_49_gpu6 [label="layer0_stage0_expert_49_gpu6\nExpert 49\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_49_gpu6 [label="" style=dashed]
	layer0_stage0_expert_50_gpu6 [label="layer0_stage0_expert_50_gpu6\nExpert 50\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_50_gpu6 [label="" style=dashed]
	layer0_stage0_expert_51_gpu6 [label="layer0_stage0_expert_51_gpu6\nExpert 51\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_51_gpu6 [label="" style=dashed]
	layer0_stage0_expert_52_gpu6 [label="layer0_stage0_expert_52_gpu6\nExpert 52\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_52_gpu6 [label="" style=dashed]
	layer0_stage0_expert_53_gpu6 [label="layer0_stage0_expert_53_gpu6\nExpert 53\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_53_gpu6 [label="" style=dashed]
	layer0_stage0_expert_54_gpu6 [label="layer0_stage0_expert_54_gpu6\nExpert 54\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_54_gpu6 [label="" style=dashed]
	layer0_stage0_expert_55_gpu6 [label="layer0_stage0_expert_55_gpu6\nExpert 55\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_55_gpu6 [label="" style=dashed]
	layer0_stage0_expert_56_gpu7 [label="layer0_stage0_expert_56_gpu7\nExpert 56\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_56_gpu7 [label="" style=dashed]
	layer0_stage0_expert_57_gpu7 [label="layer0_stage0_expert_57_gpu7\nExpert 57\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_57_gpu7 [label="" style=dashed]
	layer0_stage0_expert_58_gpu7 [label="layer0_stage0_expert_58_gpu7\nExpert 58\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_58_gpu7 [label="" style=dashed]
	layer0_stage0_expert_59_gpu7 [label="layer0_stage0_expert_59_gpu7\nExpert 59\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_59_gpu7 [label="" style=dashed]
	layer0_stage0_expert_60_gpu7 [label="layer0_stage0_expert_60_gpu7\nExpert 60\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_60_gpu7 [label="" style=dashed]
	layer0_stage0_expert_61_gpu7 [label="layer0_stage0_expert_61_gpu7\nExpert 61\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_61_gpu7 [label="" style=dashed]
	layer0_stage0_expert_62_gpu7 [label="layer0_stage0_expert_62_gpu7\nExpert 62\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_62_gpu7 [label="" style=dashed]
	layer0_stage0_expert_63_gpu7 [label="layer0_stage0_expert_63_gpu7\nExpert 63\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer0_stage0_gating -> layer0_stage0_expert_63_gpu7 [label="" style=dashed]
	layer0_stage0_expert_aggregate [label="layer0_stage0_expert_aggregate\nExpert Output Aggregation\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192 (x16)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer0_stage0_expert_0_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_1_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_2_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_3_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_4_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_5_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_6_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_7_gpu0 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_8_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_9_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_10_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_11_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_12_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_13_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_14_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_15_gpu1 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_16_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_17_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_18_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_19_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_20_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_21_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_22_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_23_gpu2 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_24_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_25_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_26_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_27_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_28_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_29_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_30_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_31_gpu3 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_32_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_33_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_34_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_35_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_36_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_37_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_38_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_39_gpu4 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_40_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_41_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_42_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_43_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_44_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_45_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_46_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_47_gpu5 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_48_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_49_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_50_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_51_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_52_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_53_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_54_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_55_gpu6 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_56_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_57_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_58_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_59_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_60_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_61_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_62_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_63_gpu7 -> layer0_stage0_expert_aggregate [label="" style=solid]
	layer0_stage0_expert_residual [label="layer0_stage0_expert_residual\nResidual Add\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	model_input -> layer0_stage0_input_reshape [label="" style=solid]
	layer1_stage0_input_reshape [label="layer1_stage0_input_reshape\nInput Reshape\nGPU: 0-7\nIn: batch_size=1024, seq_len=10000, hidden_dim=8192\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer1_stage0_qkv_proj_0 [label="layer1_stage0_qkv_proj_0\nQKV Projection (TP-0)\nGPU: 0\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_0 [label="" style=solid]
	layer1_stage0_qkv_proj_1 [label="layer1_stage0_qkv_proj_1\nQKV Projection (TP-1)\nGPU: 1\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_1 [label="" style=solid]
	layer1_stage0_qkv_proj_2 [label="layer1_stage0_qkv_proj_2\nQKV Projection (TP-2)\nGPU: 2\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_2 [label="" style=solid]
	layer1_stage0_qkv_proj_3 [label="layer1_stage0_qkv_proj_3\nQKV Projection (TP-3)\nGPU: 3\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_3 [label="" style=solid]
	layer1_stage0_qkv_proj_4 [label="layer1_stage0_qkv_proj_4\nQKV Projection (TP-4)\nGPU: 4\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_4 [label="" style=solid]
	layer1_stage0_qkv_proj_5 [label="layer1_stage0_qkv_proj_5\nQKV Projection (TP-5)\nGPU: 5\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_5 [label="" style=solid]
	layer1_stage0_qkv_proj_6 [label="layer1_stage0_qkv_proj_6\nQKV Projection (TP-6)\nGPU: 6\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_6 [label="" style=solid]
	layer1_stage0_qkv_proj_7 [label="layer1_stage0_qkv_proj_7\nQKV Projection (TP-7)\nGPU: 7\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer1_stage0_input_reshape -> layer1_stage0_qkv_proj_7 [label="" style=solid]
	layer1_stage0_qkv_reshape_0 [label="layer1_stage0_qkv_reshape_0\nQKV Reshape (TP-0)\nGPU: 0\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_0 -> layer1_stage0_qkv_reshape_0 [label="" style=solid]
	layer1_stage0_qkv_reshape_1 [label="layer1_stage0_qkv_reshape_1\nQKV Reshape (TP-1)\nGPU: 1\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_1 -> layer1_stage0_qkv_reshape_1 [label="" style=solid]
	layer1_stage0_qkv_reshape_2 [label="layer1_stage0_qkv_reshape_2\nQKV Reshape (TP-2)\nGPU: 2\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_2 -> layer1_stage0_qkv_reshape_2 [label="" style=solid]
	layer1_stage0_qkv_reshape_3 [label="layer1_stage0_qkv_reshape_3\nQKV Reshape (TP-3)\nGPU: 3\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_3 -> layer1_stage0_qkv_reshape_3 [label="" style=solid]
	layer1_stage0_qkv_reshape_4 [label="layer1_stage0_qkv_reshape_4\nQKV Reshape (TP-4)\nGPU: 4\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_4 -> layer1_stage0_qkv_reshape_4 [label="" style=solid]
	layer1_stage0_qkv_reshape_5 [label="layer1_stage0_qkv_reshape_5\nQKV Reshape (TP-5)\nGPU: 5\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_5 -> layer1_stage0_qkv_reshape_5 [label="" style=solid]
	layer1_stage0_qkv_reshape_6 [label="layer1_stage0_qkv_reshape_6\nQKV Reshape (TP-6)\nGPU: 6\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_6 -> layer1_stage0_qkv_reshape_6 [label="" style=solid]
	layer1_stage0_qkv_reshape_7 [label="layer1_stage0_qkv_reshape_7\nQKV Reshape (TP-7)\nGPU: 7\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer1_stage0_qkv_proj_7 -> layer1_stage0_qkv_reshape_7 [label="" style=solid]
	layer1_stage0_attention_0 [label="layer1_stage0_attention_0\nMulti-Head Attention (TP-0)\nGPU: 0\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_0 -> layer1_stage0_attention_0 [label="" style=solid]
	layer1_stage0_attention_1 [label="layer1_stage0_attention_1\nMulti-Head Attention (TP-1)\nGPU: 1\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_1 -> layer1_stage0_attention_1 [label="" style=solid]
	layer1_stage0_attention_2 [label="layer1_stage0_attention_2\nMulti-Head Attention (TP-2)\nGPU: 2\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_2 -> layer1_stage0_attention_2 [label="" style=solid]
	layer1_stage0_attention_3 [label="layer1_stage0_attention_3\nMulti-Head Attention (TP-3)\nGPU: 3\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_3 -> layer1_stage0_attention_3 [label="" style=solid]
	layer1_stage0_attention_4 [label="layer1_stage0_attention_4\nMulti-Head Attention (TP-4)\nGPU: 4\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_4 -> layer1_stage0_attention_4 [label="" style=solid]
	layer1_stage0_attention_5 [label="layer1_stage0_attention_5\nMulti-Head Attention (TP-5)\nGPU: 5\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_5 -> layer1_stage0_attention_5 [label="" style=solid]
	layer1_stage0_attention_6 [label="layer1_stage0_attention_6\nMulti-Head Attention (TP-6)\nGPU: 6\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_6 -> layer1_stage0_attention_6 [label="" style=solid]
	layer1_stage0_attention_7 [label="layer1_stage0_attention_7\nMulti-Head Attention (TP-7)\nGPU: 7\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer1_stage0_qkv_reshape_7 -> layer1_stage0_attention_7 [label="" style=solid]
	layer1_stage0_output_proj_0 [label="layer1_stage0_output_proj_0\nOutput Projection (TP-0)\nGPU: 0\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_0 -> layer1_stage0_output_proj_0 [label="" style=solid]
	layer1_stage0_output_proj_1 [label="layer1_stage0_output_proj_1\nOutput Projection (TP-1)\nGPU: 1\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_1 -> layer1_stage0_output_proj_1 [label="" style=solid]
	layer1_stage0_output_proj_2 [label="layer1_stage0_output_proj_2\nOutput Projection (TP-2)\nGPU: 2\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_2 -> layer1_stage0_output_proj_2 [label="" style=solid]
	layer1_stage0_output_proj_3 [label="layer1_stage0_output_proj_3\nOutput Projection (TP-3)\nGPU: 3\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_3 -> layer1_stage0_output_proj_3 [label="" style=solid]
	layer1_stage0_output_proj_4 [label="layer1_stage0_output_proj_4\nOutput Projection (TP-4)\nGPU: 4\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_4 -> layer1_stage0_output_proj_4 [label="" style=solid]
	layer1_stage0_output_proj_5 [label="layer1_stage0_output_proj_5\nOutput Projection (TP-5)\nGPU: 5\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_5 -> layer1_stage0_output_proj_5 [label="" style=solid]
	layer1_stage0_output_proj_6 [label="layer1_stage0_output_proj_6\nOutput Projection (TP-6)\nGPU: 6\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_6 -> layer1_stage0_output_proj_6 [label="" style=solid]
	layer1_stage0_output_proj_7 [label="layer1_stage0_output_proj_7\nOutput Projection (TP-7)\nGPU: 7\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer1_stage0_attention_7 -> layer1_stage0_output_proj_7 [label="" style=solid]
	layer1_stage0_attention_allreduce [label="layer1_stage0_attention_allreduce\nAll-Reduce Sum\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=1024 (x8)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer1_stage0_output_proj_0 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_1 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_2 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_3 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_4 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_5 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_6 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_output_proj_7 -> layer1_stage0_attention_allreduce [label="" style=solid]
	layer1_stage0_attention_residual [label="layer1_stage0_attention_residual\nResidual Add\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer1_stage0_input_reshape -> layer1_stage0_attention_residual [label="" style=dashed]
	layer1_stage0_attention_allreduce -> layer1_stage0_attention_residual [label="" style=solid]
	layer1_stage0_gating [label="layer1_stage0_gating\nGating Network\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192\nOut: batch_size=10240000, num_experts=16" color=black shape=parallelogram]
	layer1_stage0_expert_0_gpu0 [label="layer1_stage0_expert_0_gpu0\nExpert 0\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_0_gpu0 [label="" style=dashed]
	layer1_stage0_expert_1_gpu0 [label="layer1_stage0_expert_1_gpu0\nExpert 1\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_1_gpu0 [label="" style=dashed]
	layer1_stage0_expert_2_gpu0 [label="layer1_stage0_expert_2_gpu0\nExpert 2\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_2_gpu0 [label="" style=dashed]
	layer1_stage0_expert_3_gpu0 [label="layer1_stage0_expert_3_gpu0\nExpert 3\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_3_gpu0 [label="" style=dashed]
	layer1_stage0_expert_4_gpu0 [label="layer1_stage0_expert_4_gpu0\nExpert 4\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_4_gpu0 [label="" style=dashed]
	layer1_stage0_expert_5_gpu0 [label="layer1_stage0_expert_5_gpu0\nExpert 5\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_5_gpu0 [label="" style=dashed]
	layer1_stage0_expert_6_gpu0 [label="layer1_stage0_expert_6_gpu0\nExpert 6\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_6_gpu0 [label="" style=dashed]
	layer1_stage0_expert_7_gpu0 [label="layer1_stage0_expert_7_gpu0\nExpert 7\nGPU: 0\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_7_gpu0 [label="" style=dashed]
	layer1_stage0_expert_8_gpu1 [label="layer1_stage0_expert_8_gpu1\nExpert 8\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_8_gpu1 [label="" style=dashed]
	layer1_stage0_expert_9_gpu1 [label="layer1_stage0_expert_9_gpu1\nExpert 9\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_9_gpu1 [label="" style=dashed]
	layer1_stage0_expert_10_gpu1 [label="layer1_stage0_expert_10_gpu1\nExpert 10\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_10_gpu1 [label="" style=dashed]
	layer1_stage0_expert_11_gpu1 [label="layer1_stage0_expert_11_gpu1\nExpert 11\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_11_gpu1 [label="" style=dashed]
	layer1_stage0_expert_12_gpu1 [label="layer1_stage0_expert_12_gpu1\nExpert 12\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_12_gpu1 [label="" style=dashed]
	layer1_stage0_expert_13_gpu1 [label="layer1_stage0_expert_13_gpu1\nExpert 13\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_13_gpu1 [label="" style=dashed]
	layer1_stage0_expert_14_gpu1 [label="layer1_stage0_expert_14_gpu1\nExpert 14\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_14_gpu1 [label="" style=dashed]
	layer1_stage0_expert_15_gpu1 [label="layer1_stage0_expert_15_gpu1\nExpert 15\nGPU: 1\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_15_gpu1 [label="" style=dashed]
	layer1_stage0_expert_16_gpu2 [label="layer1_stage0_expert_16_gpu2\nExpert 16\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_16_gpu2 [label="" style=dashed]
	layer1_stage0_expert_17_gpu2 [label="layer1_stage0_expert_17_gpu2\nExpert 17\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_17_gpu2 [label="" style=dashed]
	layer1_stage0_expert_18_gpu2 [label="layer1_stage0_expert_18_gpu2\nExpert 18\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_18_gpu2 [label="" style=dashed]
	layer1_stage0_expert_19_gpu2 [label="layer1_stage0_expert_19_gpu2\nExpert 19\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_19_gpu2 [label="" style=dashed]
	layer1_stage0_expert_20_gpu2 [label="layer1_stage0_expert_20_gpu2\nExpert 20\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_20_gpu2 [label="" style=dashed]
	layer1_stage0_expert_21_gpu2 [label="layer1_stage0_expert_21_gpu2\nExpert 21\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_21_gpu2 [label="" style=dashed]
	layer1_stage0_expert_22_gpu2 [label="layer1_stage0_expert_22_gpu2\nExpert 22\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_22_gpu2 [label="" style=dashed]
	layer1_stage0_expert_23_gpu2 [label="layer1_stage0_expert_23_gpu2\nExpert 23\nGPU: 2\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_23_gpu2 [label="" style=dashed]
	layer1_stage0_expert_24_gpu3 [label="layer1_stage0_expert_24_gpu3\nExpert 24\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_24_gpu3 [label="" style=dashed]
	layer1_stage0_expert_25_gpu3 [label="layer1_stage0_expert_25_gpu3\nExpert 25\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_25_gpu3 [label="" style=dashed]
	layer1_stage0_expert_26_gpu3 [label="layer1_stage0_expert_26_gpu3\nExpert 26\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_26_gpu3 [label="" style=dashed]
	layer1_stage0_expert_27_gpu3 [label="layer1_stage0_expert_27_gpu3\nExpert 27\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_27_gpu3 [label="" style=dashed]
	layer1_stage0_expert_28_gpu3 [label="layer1_stage0_expert_28_gpu3\nExpert 28\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_28_gpu3 [label="" style=dashed]
	layer1_stage0_expert_29_gpu3 [label="layer1_stage0_expert_29_gpu3\nExpert 29\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_29_gpu3 [label="" style=dashed]
	layer1_stage0_expert_30_gpu3 [label="layer1_stage0_expert_30_gpu3\nExpert 30\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_30_gpu3 [label="" style=dashed]
	layer1_stage0_expert_31_gpu3 [label="layer1_stage0_expert_31_gpu3\nExpert 31\nGPU: 3\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_31_gpu3 [label="" style=dashed]
	layer1_stage0_expert_32_gpu4 [label="layer1_stage0_expert_32_gpu4\nExpert 32\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_32_gpu4 [label="" style=dashed]
	layer1_stage0_expert_33_gpu4 [label="layer1_stage0_expert_33_gpu4\nExpert 33\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_33_gpu4 [label="" style=dashed]
	layer1_stage0_expert_34_gpu4 [label="layer1_stage0_expert_34_gpu4\nExpert 34\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_34_gpu4 [label="" style=dashed]
	layer1_stage0_expert_35_gpu4 [label="layer1_stage0_expert_35_gpu4\nExpert 35\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_35_gpu4 [label="" style=dashed]
	layer1_stage0_expert_36_gpu4 [label="layer1_stage0_expert_36_gpu4\nExpert 36\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_36_gpu4 [label="" style=dashed]
	layer1_stage0_expert_37_gpu4 [label="layer1_stage0_expert_37_gpu4\nExpert 37\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_37_gpu4 [label="" style=dashed]
	layer1_stage0_expert_38_gpu4 [label="layer1_stage0_expert_38_gpu4\nExpert 38\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_38_gpu4 [label="" style=dashed]
	layer1_stage0_expert_39_gpu4 [label="layer1_stage0_expert_39_gpu4\nExpert 39\nGPU: 4\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_39_gpu4 [label="" style=dashed]
	layer1_stage0_expert_40_gpu5 [label="layer1_stage0_expert_40_gpu5\nExpert 40\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_40_gpu5 [label="" style=dashed]
	layer1_stage0_expert_41_gpu5 [label="layer1_stage0_expert_41_gpu5\nExpert 41\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_41_gpu5 [label="" style=dashed]
	layer1_stage0_expert_42_gpu5 [label="layer1_stage0_expert_42_gpu5\nExpert 42\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_42_gpu5 [label="" style=dashed]
	layer1_stage0_expert_43_gpu5 [label="layer1_stage0_expert_43_gpu5\nExpert 43\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_43_gpu5 [label="" style=dashed]
	layer1_stage0_expert_44_gpu5 [label="layer1_stage0_expert_44_gpu5\nExpert 44\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_44_gpu5 [label="" style=dashed]
	layer1_stage0_expert_45_gpu5 [label="layer1_stage0_expert_45_gpu5\nExpert 45\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_45_gpu5 [label="" style=dashed]
	layer1_stage0_expert_46_gpu5 [label="layer1_stage0_expert_46_gpu5\nExpert 46\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_46_gpu5 [label="" style=dashed]
	layer1_stage0_expert_47_gpu5 [label="layer1_stage0_expert_47_gpu5\nExpert 47\nGPU: 5\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_47_gpu5 [label="" style=dashed]
	layer1_stage0_expert_48_gpu6 [label="layer1_stage0_expert_48_gpu6\nExpert 48\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_48_gpu6 [label="" style=dashed]
	layer1_stage0_expert_49_gpu6 [label="layer1_stage0_expert_49_gpu6\nExpert 49\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_49_gpu6 [label="" style=dashed]
	layer1_stage0_expert_50_gpu6 [label="layer1_stage0_expert_50_gpu6\nExpert 50\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_50_gpu6 [label="" style=dashed]
	layer1_stage0_expert_51_gpu6 [label="layer1_stage0_expert_51_gpu6\nExpert 51\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_51_gpu6 [label="" style=dashed]
	layer1_stage0_expert_52_gpu6 [label="layer1_stage0_expert_52_gpu6\nExpert 52\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_52_gpu6 [label="" style=dashed]
	layer1_stage0_expert_53_gpu6 [label="layer1_stage0_expert_53_gpu6\nExpert 53\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_53_gpu6 [label="" style=dashed]
	layer1_stage0_expert_54_gpu6 [label="layer1_stage0_expert_54_gpu6\nExpert 54\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_54_gpu6 [label="" style=dashed]
	layer1_stage0_expert_55_gpu6 [label="layer1_stage0_expert_55_gpu6\nExpert 55\nGPU: 6\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_55_gpu6 [label="" style=dashed]
	layer1_stage0_expert_56_gpu7 [label="layer1_stage0_expert_56_gpu7\nExpert 56\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_56_gpu7 [label="" style=dashed]
	layer1_stage0_expert_57_gpu7 [label="layer1_stage0_expert_57_gpu7\nExpert 57\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_57_gpu7 [label="" style=dashed]
	layer1_stage0_expert_58_gpu7 [label="layer1_stage0_expert_58_gpu7\nExpert 58\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_58_gpu7 [label="" style=dashed]
	layer1_stage0_expert_59_gpu7 [label="layer1_stage0_expert_59_gpu7\nExpert 59\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_59_gpu7 [label="" style=dashed]
	layer1_stage0_expert_60_gpu7 [label="layer1_stage0_expert_60_gpu7\nExpert 60\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_60_gpu7 [label="" style=dashed]
	layer1_stage0_expert_61_gpu7 [label="layer1_stage0_expert_61_gpu7\nExpert 61\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_61_gpu7 [label="" style=dashed]
	layer1_stage0_expert_62_gpu7 [label="layer1_stage0_expert_62_gpu7\nExpert 62\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_62_gpu7 [label="" style=dashed]
	layer1_stage0_expert_63_gpu7 [label="layer1_stage0_expert_63_gpu7\nExpert 63\nGPU: 7\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer1_stage0_gating -> layer1_stage0_expert_63_gpu7 [label="" style=dashed]
	layer1_stage0_expert_aggregate [label="layer1_stage0_expert_aggregate\nExpert Output Aggregation\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192 (x16)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer1_stage0_expert_0_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_1_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_2_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_3_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_4_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_5_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_6_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_7_gpu0 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_8_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_9_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_10_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_11_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_12_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_13_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_14_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_15_gpu1 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_16_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_17_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_18_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_19_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_20_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_21_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_22_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_23_gpu2 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_24_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_25_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_26_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_27_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_28_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_29_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_30_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_31_gpu3 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_32_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_33_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_34_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_35_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_36_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_37_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_38_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_39_gpu4 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_40_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_41_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_42_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_43_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_44_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_45_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_46_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_47_gpu5 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_48_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_49_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_50_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_51_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_52_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_53_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_54_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_55_gpu6 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_56_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_57_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_58_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_59_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_60_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_61_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_62_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_63_gpu7 -> layer1_stage0_expert_aggregate [label="" style=solid]
	layer1_stage0_expert_residual [label="layer1_stage0_expert_residual\nResidual Add\nGPU: 0-7\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer0_stage0_expert_residual -> layer1_stage0_input_reshape [label="" style=solid]
	pipeline_comm_0_to_1 [label="pipeline_comm_0_to_1\nPipeline Communication\nGPU: 7-8\nIn: batch_size=10240000, hidden_dim=8192\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer1_stage0_expert_residual -> pipeline_comm_0_to_1 [label="" style=solid]
	layer2_stage1_input_reshape [label="layer2_stage1_input_reshape\nInput Reshape\nGPU: 8-15\nIn: batch_size=1024, seq_len=10000, hidden_dim=8192\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer2_stage1_qkv_proj_0 [label="layer2_stage1_qkv_proj_0\nQKV Projection (TP-0)\nGPU: 8\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_0 [label="" style=solid]
	layer2_stage1_qkv_proj_1 [label="layer2_stage1_qkv_proj_1\nQKV Projection (TP-1)\nGPU: 9\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_1 [label="" style=solid]
	layer2_stage1_qkv_proj_2 [label="layer2_stage1_qkv_proj_2\nQKV Projection (TP-2)\nGPU: 10\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_2 [label="" style=solid]
	layer2_stage1_qkv_proj_3 [label="layer2_stage1_qkv_proj_3\nQKV Projection (TP-3)\nGPU: 11\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_3 [label="" style=solid]
	layer2_stage1_qkv_proj_4 [label="layer2_stage1_qkv_proj_4\nQKV Projection (TP-4)\nGPU: 12\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_4 [label="" style=solid]
	layer2_stage1_qkv_proj_5 [label="layer2_stage1_qkv_proj_5\nQKV Projection (TP-5)\nGPU: 13\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_5 [label="" style=solid]
	layer2_stage1_qkv_proj_6 [label="layer2_stage1_qkv_proj_6\nQKV Projection (TP-6)\nGPU: 14\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_6 [label="" style=solid]
	layer2_stage1_qkv_proj_7 [label="layer2_stage1_qkv_proj_7\nQKV Projection (TP-7)\nGPU: 15\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer2_stage1_input_reshape -> layer2_stage1_qkv_proj_7 [label="" style=solid]
	layer2_stage1_qkv_reshape_0 [label="layer2_stage1_qkv_reshape_0\nQKV Reshape (TP-0)\nGPU: 8\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_0 -> layer2_stage1_qkv_reshape_0 [label="" style=solid]
	layer2_stage1_qkv_reshape_1 [label="layer2_stage1_qkv_reshape_1\nQKV Reshape (TP-1)\nGPU: 9\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_1 -> layer2_stage1_qkv_reshape_1 [label="" style=solid]
	layer2_stage1_qkv_reshape_2 [label="layer2_stage1_qkv_reshape_2\nQKV Reshape (TP-2)\nGPU: 10\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_2 -> layer2_stage1_qkv_reshape_2 [label="" style=solid]
	layer2_stage1_qkv_reshape_3 [label="layer2_stage1_qkv_reshape_3\nQKV Reshape (TP-3)\nGPU: 11\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_3 -> layer2_stage1_qkv_reshape_3 [label="" style=solid]
	layer2_stage1_qkv_reshape_4 [label="layer2_stage1_qkv_reshape_4\nQKV Reshape (TP-4)\nGPU: 12\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_4 -> layer2_stage1_qkv_reshape_4 [label="" style=solid]
	layer2_stage1_qkv_reshape_5 [label="layer2_stage1_qkv_reshape_5\nQKV Reshape (TP-5)\nGPU: 13\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_5 -> layer2_stage1_qkv_reshape_5 [label="" style=solid]
	layer2_stage1_qkv_reshape_6 [label="layer2_stage1_qkv_reshape_6\nQKV Reshape (TP-6)\nGPU: 14\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_6 -> layer2_stage1_qkv_reshape_6 [label="" style=solid]
	layer2_stage1_qkv_reshape_7 [label="layer2_stage1_qkv_reshape_7\nQKV Reshape (TP-7)\nGPU: 15\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer2_stage1_qkv_proj_7 -> layer2_stage1_qkv_reshape_7 [label="" style=solid]
	layer2_stage1_attention_0 [label="layer2_stage1_attention_0\nMulti-Head Attention (TP-0)\nGPU: 8\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_0 -> layer2_stage1_attention_0 [label="" style=solid]
	layer2_stage1_attention_1 [label="layer2_stage1_attention_1\nMulti-Head Attention (TP-1)\nGPU: 9\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_1 -> layer2_stage1_attention_1 [label="" style=solid]
	layer2_stage1_attention_2 [label="layer2_stage1_attention_2\nMulti-Head Attention (TP-2)\nGPU: 10\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_2 -> layer2_stage1_attention_2 [label="" style=solid]
	layer2_stage1_attention_3 [label="layer2_stage1_attention_3\nMulti-Head Attention (TP-3)\nGPU: 11\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_3 -> layer2_stage1_attention_3 [label="" style=solid]
	layer2_stage1_attention_4 [label="layer2_stage1_attention_4\nMulti-Head Attention (TP-4)\nGPU: 12\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_4 -> layer2_stage1_attention_4 [label="" style=solid]
	layer2_stage1_attention_5 [label="layer2_stage1_attention_5\nMulti-Head Attention (TP-5)\nGPU: 13\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_5 -> layer2_stage1_attention_5 [label="" style=solid]
	layer2_stage1_attention_6 [label="layer2_stage1_attention_6\nMulti-Head Attention (TP-6)\nGPU: 14\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_6 -> layer2_stage1_attention_6 [label="" style=solid]
	layer2_stage1_attention_7 [label="layer2_stage1_attention_7\nMulti-Head Attention (TP-7)\nGPU: 15\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer2_stage1_qkv_reshape_7 -> layer2_stage1_attention_7 [label="" style=solid]
	layer2_stage1_output_proj_0 [label="layer2_stage1_output_proj_0\nOutput Projection (TP-0)\nGPU: 8\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_0 -> layer2_stage1_output_proj_0 [label="" style=solid]
	layer2_stage1_output_proj_1 [label="layer2_stage1_output_proj_1\nOutput Projection (TP-1)\nGPU: 9\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_1 -> layer2_stage1_output_proj_1 [label="" style=solid]
	layer2_stage1_output_proj_2 [label="layer2_stage1_output_proj_2\nOutput Projection (TP-2)\nGPU: 10\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_2 -> layer2_stage1_output_proj_2 [label="" style=solid]
	layer2_stage1_output_proj_3 [label="layer2_stage1_output_proj_3\nOutput Projection (TP-3)\nGPU: 11\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_3 -> layer2_stage1_output_proj_3 [label="" style=solid]
	layer2_stage1_output_proj_4 [label="layer2_stage1_output_proj_4\nOutput Projection (TP-4)\nGPU: 12\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_4 -> layer2_stage1_output_proj_4 [label="" style=solid]
	layer2_stage1_output_proj_5 [label="layer2_stage1_output_proj_5\nOutput Projection (TP-5)\nGPU: 13\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_5 -> layer2_stage1_output_proj_5 [label="" style=solid]
	layer2_stage1_output_proj_6 [label="layer2_stage1_output_proj_6\nOutput Projection (TP-6)\nGPU: 14\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_6 -> layer2_stage1_output_proj_6 [label="" style=solid]
	layer2_stage1_output_proj_7 [label="layer2_stage1_output_proj_7\nOutput Projection (TP-7)\nGPU: 15\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer2_stage1_attention_7 -> layer2_stage1_output_proj_7 [label="" style=solid]
	layer2_stage1_attention_allreduce [label="layer2_stage1_attention_allreduce\nAll-Reduce Sum\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=1024 (x8)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer2_stage1_output_proj_0 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_1 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_2 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_3 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_4 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_5 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_6 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_output_proj_7 -> layer2_stage1_attention_allreduce [label="" style=solid]
	layer2_stage1_attention_residual [label="layer2_stage1_attention_residual\nResidual Add\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer2_stage1_input_reshape -> layer2_stage1_attention_residual [label="" style=dashed]
	layer2_stage1_attention_allreduce -> layer2_stage1_attention_residual [label="" style=solid]
	layer2_stage1_gating [label="layer2_stage1_gating\nGating Network\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192\nOut: batch_size=10240000, num_experts=16" color=black shape=parallelogram]
	layer2_stage1_expert_0_gpu8 [label="layer2_stage1_expert_0_gpu8\nExpert 0\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_0_gpu8 [label="" style=dashed]
	layer2_stage1_expert_1_gpu8 [label="layer2_stage1_expert_1_gpu8\nExpert 1\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_1_gpu8 [label="" style=dashed]
	layer2_stage1_expert_2_gpu8 [label="layer2_stage1_expert_2_gpu8\nExpert 2\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_2_gpu8 [label="" style=dashed]
	layer2_stage1_expert_3_gpu8 [label="layer2_stage1_expert_3_gpu8\nExpert 3\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_3_gpu8 [label="" style=dashed]
	layer2_stage1_expert_4_gpu8 [label="layer2_stage1_expert_4_gpu8\nExpert 4\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_4_gpu8 [label="" style=dashed]
	layer2_stage1_expert_5_gpu8 [label="layer2_stage1_expert_5_gpu8\nExpert 5\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_5_gpu8 [label="" style=dashed]
	layer2_stage1_expert_6_gpu8 [label="layer2_stage1_expert_6_gpu8\nExpert 6\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_6_gpu8 [label="" style=dashed]
	layer2_stage1_expert_7_gpu8 [label="layer2_stage1_expert_7_gpu8\nExpert 7\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_7_gpu8 [label="" style=dashed]
	layer2_stage1_expert_8_gpu9 [label="layer2_stage1_expert_8_gpu9\nExpert 8\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_8_gpu9 [label="" style=dashed]
	layer2_stage1_expert_9_gpu9 [label="layer2_stage1_expert_9_gpu9\nExpert 9\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_9_gpu9 [label="" style=dashed]
	layer2_stage1_expert_10_gpu9 [label="layer2_stage1_expert_10_gpu9\nExpert 10\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_10_gpu9 [label="" style=dashed]
	layer2_stage1_expert_11_gpu9 [label="layer2_stage1_expert_11_gpu9\nExpert 11\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_11_gpu9 [label="" style=dashed]
	layer2_stage1_expert_12_gpu9 [label="layer2_stage1_expert_12_gpu9\nExpert 12\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_12_gpu9 [label="" style=dashed]
	layer2_stage1_expert_13_gpu9 [label="layer2_stage1_expert_13_gpu9\nExpert 13\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_13_gpu9 [label="" style=dashed]
	layer2_stage1_expert_14_gpu9 [label="layer2_stage1_expert_14_gpu9\nExpert 14\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_14_gpu9 [label="" style=dashed]
	layer2_stage1_expert_15_gpu9 [label="layer2_stage1_expert_15_gpu9\nExpert 15\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_15_gpu9 [label="" style=dashed]
	layer2_stage1_expert_16_gpu10 [label="layer2_stage1_expert_16_gpu10\nExpert 16\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_16_gpu10 [label="" style=dashed]
	layer2_stage1_expert_17_gpu10 [label="layer2_stage1_expert_17_gpu10\nExpert 17\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_17_gpu10 [label="" style=dashed]
	layer2_stage1_expert_18_gpu10 [label="layer2_stage1_expert_18_gpu10\nExpert 18\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_18_gpu10 [label="" style=dashed]
	layer2_stage1_expert_19_gpu10 [label="layer2_stage1_expert_19_gpu10\nExpert 19\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_19_gpu10 [label="" style=dashed]
	layer2_stage1_expert_20_gpu10 [label="layer2_stage1_expert_20_gpu10\nExpert 20\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_20_gpu10 [label="" style=dashed]
	layer2_stage1_expert_21_gpu10 [label="layer2_stage1_expert_21_gpu10\nExpert 21\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_21_gpu10 [label="" style=dashed]
	layer2_stage1_expert_22_gpu10 [label="layer2_stage1_expert_22_gpu10\nExpert 22\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_22_gpu10 [label="" style=dashed]
	layer2_stage1_expert_23_gpu10 [label="layer2_stage1_expert_23_gpu10\nExpert 23\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_23_gpu10 [label="" style=dashed]
	layer2_stage1_expert_24_gpu11 [label="layer2_stage1_expert_24_gpu11\nExpert 24\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_24_gpu11 [label="" style=dashed]
	layer2_stage1_expert_25_gpu11 [label="layer2_stage1_expert_25_gpu11\nExpert 25\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_25_gpu11 [label="" style=dashed]
	layer2_stage1_expert_26_gpu11 [label="layer2_stage1_expert_26_gpu11\nExpert 26\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_26_gpu11 [label="" style=dashed]
	layer2_stage1_expert_27_gpu11 [label="layer2_stage1_expert_27_gpu11\nExpert 27\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_27_gpu11 [label="" style=dashed]
	layer2_stage1_expert_28_gpu11 [label="layer2_stage1_expert_28_gpu11\nExpert 28\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_28_gpu11 [label="" style=dashed]
	layer2_stage1_expert_29_gpu11 [label="layer2_stage1_expert_29_gpu11\nExpert 29\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_29_gpu11 [label="" style=dashed]
	layer2_stage1_expert_30_gpu11 [label="layer2_stage1_expert_30_gpu11\nExpert 30\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_30_gpu11 [label="" style=dashed]
	layer2_stage1_expert_31_gpu11 [label="layer2_stage1_expert_31_gpu11\nExpert 31\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_31_gpu11 [label="" style=dashed]
	layer2_stage1_expert_32_gpu12 [label="layer2_stage1_expert_32_gpu12\nExpert 32\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_32_gpu12 [label="" style=dashed]
	layer2_stage1_expert_33_gpu12 [label="layer2_stage1_expert_33_gpu12\nExpert 33\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_33_gpu12 [label="" style=dashed]
	layer2_stage1_expert_34_gpu12 [label="layer2_stage1_expert_34_gpu12\nExpert 34\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_34_gpu12 [label="" style=dashed]
	layer2_stage1_expert_35_gpu12 [label="layer2_stage1_expert_35_gpu12\nExpert 35\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_35_gpu12 [label="" style=dashed]
	layer2_stage1_expert_36_gpu12 [label="layer2_stage1_expert_36_gpu12\nExpert 36\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_36_gpu12 [label="" style=dashed]
	layer2_stage1_expert_37_gpu12 [label="layer2_stage1_expert_37_gpu12\nExpert 37\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_37_gpu12 [label="" style=dashed]
	layer2_stage1_expert_38_gpu12 [label="layer2_stage1_expert_38_gpu12\nExpert 38\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_38_gpu12 [label="" style=dashed]
	layer2_stage1_expert_39_gpu12 [label="layer2_stage1_expert_39_gpu12\nExpert 39\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_39_gpu12 [label="" style=dashed]
	layer2_stage1_expert_40_gpu13 [label="layer2_stage1_expert_40_gpu13\nExpert 40\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_40_gpu13 [label="" style=dashed]
	layer2_stage1_expert_41_gpu13 [label="layer2_stage1_expert_41_gpu13\nExpert 41\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_41_gpu13 [label="" style=dashed]
	layer2_stage1_expert_42_gpu13 [label="layer2_stage1_expert_42_gpu13\nExpert 42\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_42_gpu13 [label="" style=dashed]
	layer2_stage1_expert_43_gpu13 [label="layer2_stage1_expert_43_gpu13\nExpert 43\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_43_gpu13 [label="" style=dashed]
	layer2_stage1_expert_44_gpu13 [label="layer2_stage1_expert_44_gpu13\nExpert 44\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_44_gpu13 [label="" style=dashed]
	layer2_stage1_expert_45_gpu13 [label="layer2_stage1_expert_45_gpu13\nExpert 45\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_45_gpu13 [label="" style=dashed]
	layer2_stage1_expert_46_gpu13 [label="layer2_stage1_expert_46_gpu13\nExpert 46\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_46_gpu13 [label="" style=dashed]
	layer2_stage1_expert_47_gpu13 [label="layer2_stage1_expert_47_gpu13\nExpert 47\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_47_gpu13 [label="" style=dashed]
	layer2_stage1_expert_48_gpu14 [label="layer2_stage1_expert_48_gpu14\nExpert 48\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_48_gpu14 [label="" style=dashed]
	layer2_stage1_expert_49_gpu14 [label="layer2_stage1_expert_49_gpu14\nExpert 49\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_49_gpu14 [label="" style=dashed]
	layer2_stage1_expert_50_gpu14 [label="layer2_stage1_expert_50_gpu14\nExpert 50\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_50_gpu14 [label="" style=dashed]
	layer2_stage1_expert_51_gpu14 [label="layer2_stage1_expert_51_gpu14\nExpert 51\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_51_gpu14 [label="" style=dashed]
	layer2_stage1_expert_52_gpu14 [label="layer2_stage1_expert_52_gpu14\nExpert 52\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_52_gpu14 [label="" style=dashed]
	layer2_stage1_expert_53_gpu14 [label="layer2_stage1_expert_53_gpu14\nExpert 53\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_53_gpu14 [label="" style=dashed]
	layer2_stage1_expert_54_gpu14 [label="layer2_stage1_expert_54_gpu14\nExpert 54\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_54_gpu14 [label="" style=dashed]
	layer2_stage1_expert_55_gpu14 [label="layer2_stage1_expert_55_gpu14\nExpert 55\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_55_gpu14 [label="" style=dashed]
	layer2_stage1_expert_56_gpu15 [label="layer2_stage1_expert_56_gpu15\nExpert 56\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_56_gpu15 [label="" style=dashed]
	layer2_stage1_expert_57_gpu15 [label="layer2_stage1_expert_57_gpu15\nExpert 57\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_57_gpu15 [label="" style=dashed]
	layer2_stage1_expert_58_gpu15 [label="layer2_stage1_expert_58_gpu15\nExpert 58\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_58_gpu15 [label="" style=dashed]
	layer2_stage1_expert_59_gpu15 [label="layer2_stage1_expert_59_gpu15\nExpert 59\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_59_gpu15 [label="" style=dashed]
	layer2_stage1_expert_60_gpu15 [label="layer2_stage1_expert_60_gpu15\nExpert 60\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_60_gpu15 [label="" style=dashed]
	layer2_stage1_expert_61_gpu15 [label="layer2_stage1_expert_61_gpu15\nExpert 61\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_61_gpu15 [label="" style=dashed]
	layer2_stage1_expert_62_gpu15 [label="layer2_stage1_expert_62_gpu15\nExpert 62\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_62_gpu15 [label="" style=dashed]
	layer2_stage1_expert_63_gpu15 [label="layer2_stage1_expert_63_gpu15\nExpert 63\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer2_stage1_gating -> layer2_stage1_expert_63_gpu15 [label="" style=dashed]
	layer2_stage1_expert_aggregate [label="layer2_stage1_expert_aggregate\nExpert Output Aggregation\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192 (x16)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer2_stage1_expert_0_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_1_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_2_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_3_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_4_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_5_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_6_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_7_gpu8 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_8_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_9_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_10_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_11_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_12_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_13_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_14_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_15_gpu9 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_16_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_17_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_18_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_19_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_20_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_21_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_22_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_23_gpu10 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_24_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_25_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_26_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_27_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_28_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_29_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_30_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_31_gpu11 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_32_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_33_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_34_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_35_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_36_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_37_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_38_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_39_gpu12 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_40_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_41_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_42_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_43_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_44_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_45_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_46_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_47_gpu13 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_48_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_49_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_50_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_51_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_52_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_53_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_54_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_55_gpu14 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_56_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_57_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_58_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_59_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_60_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_61_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_62_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_63_gpu15 -> layer2_stage1_expert_aggregate [label="" style=solid]
	layer2_stage1_expert_residual [label="layer2_stage1_expert_residual\nResidual Add\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	pipeline_comm_0_to_1 -> layer2_stage1_input_reshape [label="" style=solid]
	layer3_stage1_input_reshape [label="layer3_stage1_input_reshape\nInput Reshape\nGPU: 8-15\nIn: batch_size=1024, seq_len=10000, hidden_dim=8192\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer3_stage1_qkv_proj_0 [label="layer3_stage1_qkv_proj_0\nQKV Projection (TP-0)\nGPU: 8\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_0 [label="" style=solid]
	layer3_stage1_qkv_proj_1 [label="layer3_stage1_qkv_proj_1\nQKV Projection (TP-1)\nGPU: 9\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_1 [label="" style=solid]
	layer3_stage1_qkv_proj_2 [label="layer3_stage1_qkv_proj_2\nQKV Projection (TP-2)\nGPU: 10\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_2 [label="" style=solid]
	layer3_stage1_qkv_proj_3 [label="layer3_stage1_qkv_proj_3\nQKV Projection (TP-3)\nGPU: 11\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_3 [label="" style=solid]
	layer3_stage1_qkv_proj_4 [label="layer3_stage1_qkv_proj_4\nQKV Projection (TP-4)\nGPU: 12\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_4 [label="" style=solid]
	layer3_stage1_qkv_proj_5 [label="layer3_stage1_qkv_proj_5\nQKV Projection (TP-5)\nGPU: 13\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_5 [label="" style=solid]
	layer3_stage1_qkv_proj_6 [label="layer3_stage1_qkv_proj_6\nQKV Projection (TP-6)\nGPU: 14\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_6 [label="" style=solid]
	layer3_stage1_qkv_proj_7 [label="layer3_stage1_qkv_proj_7\nQKV Projection (TP-7)\nGPU: 15\nIn: batch_size=10240000, hidden_dim=1024\nOut: batch_size=10240000, heads=2, head_dim=1536" color=black shape=rectangle]
	layer3_stage1_input_reshape -> layer3_stage1_qkv_proj_7 [label="" style=solid]
	layer3_stage1_qkv_reshape_0 [label="layer3_stage1_qkv_reshape_0\nQKV Reshape (TP-0)\nGPU: 8\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_0 -> layer3_stage1_qkv_reshape_0 [label="" style=solid]
	layer3_stage1_qkv_reshape_1 [label="layer3_stage1_qkv_reshape_1\nQKV Reshape (TP-1)\nGPU: 9\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_1 -> layer3_stage1_qkv_reshape_1 [label="" style=solid]
	layer3_stage1_qkv_reshape_2 [label="layer3_stage1_qkv_reshape_2\nQKV Reshape (TP-2)\nGPU: 10\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_2 -> layer3_stage1_qkv_reshape_2 [label="" style=solid]
	layer3_stage1_qkv_reshape_3 [label="layer3_stage1_qkv_reshape_3\nQKV Reshape (TP-3)\nGPU: 11\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_3 -> layer3_stage1_qkv_reshape_3 [label="" style=solid]
	layer3_stage1_qkv_reshape_4 [label="layer3_stage1_qkv_reshape_4\nQKV Reshape (TP-4)\nGPU: 12\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_4 -> layer3_stage1_qkv_reshape_4 [label="" style=solid]
	layer3_stage1_qkv_reshape_5 [label="layer3_stage1_qkv_reshape_5\nQKV Reshape (TP-5)\nGPU: 13\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_5 -> layer3_stage1_qkv_reshape_5 [label="" style=solid]
	layer3_stage1_qkv_reshape_6 [label="layer3_stage1_qkv_reshape_6\nQKV Reshape (TP-6)\nGPU: 14\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_6 -> layer3_stage1_qkv_reshape_6 [label="" style=solid]
	layer3_stage1_qkv_reshape_7 [label="layer3_stage1_qkv_reshape_7\nQKV Reshape (TP-7)\nGPU: 15\nIn: batch_size=10240000, heads=2, head_dim=1536\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=ellipse]
	layer3_stage1_qkv_proj_7 -> layer3_stage1_qkv_reshape_7 [label="" style=solid]
	layer3_stage1_attention_0 [label="layer3_stage1_attention_0\nMulti-Head Attention (TP-0)\nGPU: 8\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_0 -> layer3_stage1_attention_0 [label="" style=solid]
	layer3_stage1_attention_1 [label="layer3_stage1_attention_1\nMulti-Head Attention (TP-1)\nGPU: 9\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_1 -> layer3_stage1_attention_1 [label="" style=solid]
	layer3_stage1_attention_2 [label="layer3_stage1_attention_2\nMulti-Head Attention (TP-2)\nGPU: 10\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_2 -> layer3_stage1_attention_2 [label="" style=solid]
	layer3_stage1_attention_3 [label="layer3_stage1_attention_3\nMulti-Head Attention (TP-3)\nGPU: 11\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_3 -> layer3_stage1_attention_3 [label="" style=solid]
	layer3_stage1_attention_4 [label="layer3_stage1_attention_4\nMulti-Head Attention (TP-4)\nGPU: 12\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_4 -> layer3_stage1_attention_4 [label="" style=solid]
	layer3_stage1_attention_5 [label="layer3_stage1_attention_5\nMulti-Head Attention (TP-5)\nGPU: 13\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_5 -> layer3_stage1_attention_5 [label="" style=solid]
	layer3_stage1_attention_6 [label="layer3_stage1_attention_6\nMulti-Head Attention (TP-6)\nGPU: 14\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_6 -> layer3_stage1_attention_6 [label="" style=solid]
	layer3_stage1_attention_7 [label="layer3_stage1_attention_7\nMulti-Head Attention (TP-7)\nGPU: 15\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=1024, seq_len=10000, heads=2, head_dim=512" color=black shape=rectangle]
	layer3_stage1_qkv_reshape_7 -> layer3_stage1_attention_7 [label="" style=solid]
	layer3_stage1_output_proj_0 [label="layer3_stage1_output_proj_0\nOutput Projection (TP-0)\nGPU: 8\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_0 -> layer3_stage1_output_proj_0 [label="" style=solid]
	layer3_stage1_output_proj_1 [label="layer3_stage1_output_proj_1\nOutput Projection (TP-1)\nGPU: 9\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_1 -> layer3_stage1_output_proj_1 [label="" style=solid]
	layer3_stage1_output_proj_2 [label="layer3_stage1_output_proj_2\nOutput Projection (TP-2)\nGPU: 10\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_2 -> layer3_stage1_output_proj_2 [label="" style=solid]
	layer3_stage1_output_proj_3 [label="layer3_stage1_output_proj_3\nOutput Projection (TP-3)\nGPU: 11\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_3 -> layer3_stage1_output_proj_3 [label="" style=solid]
	layer3_stage1_output_proj_4 [label="layer3_stage1_output_proj_4\nOutput Projection (TP-4)\nGPU: 12\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_4 -> layer3_stage1_output_proj_4 [label="" style=solid]
	layer3_stage1_output_proj_5 [label="layer3_stage1_output_proj_5\nOutput Projection (TP-5)\nGPU: 13\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_5 -> layer3_stage1_output_proj_5 [label="" style=solid]
	layer3_stage1_output_proj_6 [label="layer3_stage1_output_proj_6\nOutput Projection (TP-6)\nGPU: 14\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_6 -> layer3_stage1_output_proj_6 [label="" style=solid]
	layer3_stage1_output_proj_7 [label="layer3_stage1_output_proj_7\nOutput Projection (TP-7)\nGPU: 15\nIn: batch_size=1024, seq_len=10000, heads=2, head_dim=512\nOut: batch_size=10240000, hidden_dim=1024" color=black shape=rectangle]
	layer3_stage1_attention_7 -> layer3_stage1_output_proj_7 [label="" style=solid]
	layer3_stage1_attention_allreduce [label="layer3_stage1_attention_allreduce\nAll-Reduce Sum\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=1024 (x8)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer3_stage1_output_proj_0 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_1 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_2 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_3 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_4 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_5 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_6 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_output_proj_7 -> layer3_stage1_attention_allreduce [label="" style=solid]
	layer3_stage1_attention_residual [label="layer3_stage1_attention_residual\nResidual Add\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer3_stage1_input_reshape -> layer3_stage1_attention_residual [label="" style=dashed]
	layer3_stage1_attention_allreduce -> layer3_stage1_attention_residual [label="" style=solid]
	layer3_stage1_gating [label="layer3_stage1_gating\nGating Network\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192\nOut: batch_size=10240000, num_experts=16" color=black shape=parallelogram]
	layer3_stage1_expert_0_gpu8 [label="layer3_stage1_expert_0_gpu8\nExpert 0\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_0_gpu8 [label="" style=dashed]
	layer3_stage1_expert_1_gpu8 [label="layer3_stage1_expert_1_gpu8\nExpert 1\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_1_gpu8 [label="" style=dashed]
	layer3_stage1_expert_2_gpu8 [label="layer3_stage1_expert_2_gpu8\nExpert 2\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_2_gpu8 [label="" style=dashed]
	layer3_stage1_expert_3_gpu8 [label="layer3_stage1_expert_3_gpu8\nExpert 3\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_3_gpu8 [label="" style=dashed]
	layer3_stage1_expert_4_gpu8 [label="layer3_stage1_expert_4_gpu8\nExpert 4\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_4_gpu8 [label="" style=dashed]
	layer3_stage1_expert_5_gpu8 [label="layer3_stage1_expert_5_gpu8\nExpert 5\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_5_gpu8 [label="" style=dashed]
	layer3_stage1_expert_6_gpu8 [label="layer3_stage1_expert_6_gpu8\nExpert 6\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_6_gpu8 [label="" style=dashed]
	layer3_stage1_expert_7_gpu8 [label="layer3_stage1_expert_7_gpu8\nExpert 7\nGPU: 8\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_7_gpu8 [label="" style=dashed]
	layer3_stage1_expert_8_gpu9 [label="layer3_stage1_expert_8_gpu9\nExpert 8\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_8_gpu9 [label="" style=dashed]
	layer3_stage1_expert_9_gpu9 [label="layer3_stage1_expert_9_gpu9\nExpert 9\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_9_gpu9 [label="" style=dashed]
	layer3_stage1_expert_10_gpu9 [label="layer3_stage1_expert_10_gpu9\nExpert 10\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_10_gpu9 [label="" style=dashed]
	layer3_stage1_expert_11_gpu9 [label="layer3_stage1_expert_11_gpu9\nExpert 11\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_11_gpu9 [label="" style=dashed]
	layer3_stage1_expert_12_gpu9 [label="layer3_stage1_expert_12_gpu9\nExpert 12\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_12_gpu9 [label="" style=dashed]
	layer3_stage1_expert_13_gpu9 [label="layer3_stage1_expert_13_gpu9\nExpert 13\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_13_gpu9 [label="" style=dashed]
	layer3_stage1_expert_14_gpu9 [label="layer3_stage1_expert_14_gpu9\nExpert 14\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_14_gpu9 [label="" style=dashed]
	layer3_stage1_expert_15_gpu9 [label="layer3_stage1_expert_15_gpu9\nExpert 15\nGPU: 9\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_15_gpu9 [label="" style=dashed]
	layer3_stage1_expert_16_gpu10 [label="layer3_stage1_expert_16_gpu10\nExpert 16\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_16_gpu10 [label="" style=dashed]
	layer3_stage1_expert_17_gpu10 [label="layer3_stage1_expert_17_gpu10\nExpert 17\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_17_gpu10 [label="" style=dashed]
	layer3_stage1_expert_18_gpu10 [label="layer3_stage1_expert_18_gpu10\nExpert 18\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_18_gpu10 [label="" style=dashed]
	layer3_stage1_expert_19_gpu10 [label="layer3_stage1_expert_19_gpu10\nExpert 19\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_19_gpu10 [label="" style=dashed]
	layer3_stage1_expert_20_gpu10 [label="layer3_stage1_expert_20_gpu10\nExpert 20\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_20_gpu10 [label="" style=dashed]
	layer3_stage1_expert_21_gpu10 [label="layer3_stage1_expert_21_gpu10\nExpert 21\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_21_gpu10 [label="" style=dashed]
	layer3_stage1_expert_22_gpu10 [label="layer3_stage1_expert_22_gpu10\nExpert 22\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_22_gpu10 [label="" style=dashed]
	layer3_stage1_expert_23_gpu10 [label="layer3_stage1_expert_23_gpu10\nExpert 23\nGPU: 10\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_23_gpu10 [label="" style=dashed]
	layer3_stage1_expert_24_gpu11 [label="layer3_stage1_expert_24_gpu11\nExpert 24\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_24_gpu11 [label="" style=dashed]
	layer3_stage1_expert_25_gpu11 [label="layer3_stage1_expert_25_gpu11\nExpert 25\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_25_gpu11 [label="" style=dashed]
	layer3_stage1_expert_26_gpu11 [label="layer3_stage1_expert_26_gpu11\nExpert 26\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_26_gpu11 [label="" style=dashed]
	layer3_stage1_expert_27_gpu11 [label="layer3_stage1_expert_27_gpu11\nExpert 27\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_27_gpu11 [label="" style=dashed]
	layer3_stage1_expert_28_gpu11 [label="layer3_stage1_expert_28_gpu11\nExpert 28\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_28_gpu11 [label="" style=dashed]
	layer3_stage1_expert_29_gpu11 [label="layer3_stage1_expert_29_gpu11\nExpert 29\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_29_gpu11 [label="" style=dashed]
	layer3_stage1_expert_30_gpu11 [label="layer3_stage1_expert_30_gpu11\nExpert 30\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_30_gpu11 [label="" style=dashed]
	layer3_stage1_expert_31_gpu11 [label="layer3_stage1_expert_31_gpu11\nExpert 31\nGPU: 11\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_31_gpu11 [label="" style=dashed]
	layer3_stage1_expert_32_gpu12 [label="layer3_stage1_expert_32_gpu12\nExpert 32\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_32_gpu12 [label="" style=dashed]
	layer3_stage1_expert_33_gpu12 [label="layer3_stage1_expert_33_gpu12\nExpert 33\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_33_gpu12 [label="" style=dashed]
	layer3_stage1_expert_34_gpu12 [label="layer3_stage1_expert_34_gpu12\nExpert 34\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_34_gpu12 [label="" style=dashed]
	layer3_stage1_expert_35_gpu12 [label="layer3_stage1_expert_35_gpu12\nExpert 35\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_35_gpu12 [label="" style=dashed]
	layer3_stage1_expert_36_gpu12 [label="layer3_stage1_expert_36_gpu12\nExpert 36\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_36_gpu12 [label="" style=dashed]
	layer3_stage1_expert_37_gpu12 [label="layer3_stage1_expert_37_gpu12\nExpert 37\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_37_gpu12 [label="" style=dashed]
	layer3_stage1_expert_38_gpu12 [label="layer3_stage1_expert_38_gpu12\nExpert 38\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_38_gpu12 [label="" style=dashed]
	layer3_stage1_expert_39_gpu12 [label="layer3_stage1_expert_39_gpu12\nExpert 39\nGPU: 12\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_39_gpu12 [label="" style=dashed]
	layer3_stage1_expert_40_gpu13 [label="layer3_stage1_expert_40_gpu13\nExpert 40\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_40_gpu13 [label="" style=dashed]
	layer3_stage1_expert_41_gpu13 [label="layer3_stage1_expert_41_gpu13\nExpert 41\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_41_gpu13 [label="" style=dashed]
	layer3_stage1_expert_42_gpu13 [label="layer3_stage1_expert_42_gpu13\nExpert 42\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_42_gpu13 [label="" style=dashed]
	layer3_stage1_expert_43_gpu13 [label="layer3_stage1_expert_43_gpu13\nExpert 43\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_43_gpu13 [label="" style=dashed]
	layer3_stage1_expert_44_gpu13 [label="layer3_stage1_expert_44_gpu13\nExpert 44\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_44_gpu13 [label="" style=dashed]
	layer3_stage1_expert_45_gpu13 [label="layer3_stage1_expert_45_gpu13\nExpert 45\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_45_gpu13 [label="" style=dashed]
	layer3_stage1_expert_46_gpu13 [label="layer3_stage1_expert_46_gpu13\nExpert 46\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_46_gpu13 [label="" style=dashed]
	layer3_stage1_expert_47_gpu13 [label="layer3_stage1_expert_47_gpu13\nExpert 47\nGPU: 13\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_47_gpu13 [label="" style=dashed]
	layer3_stage1_expert_48_gpu14 [label="layer3_stage1_expert_48_gpu14\nExpert 48\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_48_gpu14 [label="" style=dashed]
	layer3_stage1_expert_49_gpu14 [label="layer3_stage1_expert_49_gpu14\nExpert 49\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_49_gpu14 [label="" style=dashed]
	layer3_stage1_expert_50_gpu14 [label="layer3_stage1_expert_50_gpu14\nExpert 50\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_50_gpu14 [label="" style=dashed]
	layer3_stage1_expert_51_gpu14 [label="layer3_stage1_expert_51_gpu14\nExpert 51\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_51_gpu14 [label="" style=dashed]
	layer3_stage1_expert_52_gpu14 [label="layer3_stage1_expert_52_gpu14\nExpert 52\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_52_gpu14 [label="" style=dashed]
	layer3_stage1_expert_53_gpu14 [label="layer3_stage1_expert_53_gpu14\nExpert 53\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_53_gpu14 [label="" style=dashed]
	layer3_stage1_expert_54_gpu14 [label="layer3_stage1_expert_54_gpu14\nExpert 54\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_54_gpu14 [label="" style=dashed]
	layer3_stage1_expert_55_gpu14 [label="layer3_stage1_expert_55_gpu14\nExpert 55\nGPU: 14\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_55_gpu14 [label="" style=dashed]
	layer3_stage1_expert_56_gpu15 [label="layer3_stage1_expert_56_gpu15\nExpert 56\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_56_gpu15 [label="" style=dashed]
	layer3_stage1_expert_57_gpu15 [label="layer3_stage1_expert_57_gpu15\nExpert 57\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_57_gpu15 [label="" style=dashed]
	layer3_stage1_expert_58_gpu15 [label="layer3_stage1_expert_58_gpu15\nExpert 58\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_58_gpu15 [label="" style=dashed]
	layer3_stage1_expert_59_gpu15 [label="layer3_stage1_expert_59_gpu15\nExpert 59\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_59_gpu15 [label="" style=dashed]
	layer3_stage1_expert_60_gpu15 [label="layer3_stage1_expert_60_gpu15\nExpert 60\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_60_gpu15 [label="" style=dashed]
	layer3_stage1_expert_61_gpu15 [label="layer3_stage1_expert_61_gpu15\nExpert 61\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_61_gpu15 [label="" style=dashed]
	layer3_stage1_expert_62_gpu15 [label="layer3_stage1_expert_62_gpu15\nExpert 62\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_62_gpu15 [label="" style=dashed]
	layer3_stage1_expert_63_gpu15 [label="layer3_stage1_expert_63_gpu15\nExpert 63\nGPU: 15\nIn: batch_size=640000, hidden_dim=8192\nOut: batch_size=640000, hidden_dim=8192" color=black shape=rectangle]
	layer3_stage1_gating -> layer3_stage1_expert_63_gpu15 [label="" style=dashed]
	layer3_stage1_expert_aggregate [label="layer3_stage1_expert_aggregate\nExpert Output Aggregation\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192 (x16)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=parallelogram]
	layer3_stage1_expert_0_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_1_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_2_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_3_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_4_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_5_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_6_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_7_gpu8 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_8_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_9_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_10_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_11_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_12_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_13_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_14_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_15_gpu9 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_16_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_17_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_18_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_19_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_20_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_21_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_22_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_23_gpu10 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_24_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_25_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_26_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_27_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_28_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_29_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_30_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_31_gpu11 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_32_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_33_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_34_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_35_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_36_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_37_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_38_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_39_gpu12 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_40_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_41_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_42_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_43_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_44_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_45_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_46_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_47_gpu13 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_48_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_49_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_50_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_51_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_52_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_53_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_54_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_55_gpu14 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_56_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_57_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_58_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_59_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_60_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_61_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_62_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_63_gpu15 -> layer3_stage1_expert_aggregate [label="" style=solid]
	layer3_stage1_expert_residual [label="layer3_stage1_expert_residual\nResidual Add\nGPU: 8-15\nIn: batch_size=10240000, hidden_dim=8192 (x2)\nOut: batch_size=10240000, hidden_dim=8192" color=black shape=ellipse]
	layer2_stage1_expert_residual -> layer3_stage1_input_reshape [label="" style=solid]
	model_output [label="model_output\nModel Output\nGPU: 8-15\nIn: batch_size=1024, seq_len=10000, hidden_dim=8192\nOut: batch_size=1024, seq_len=10000, hidden_dim=8192" color=black shape=ellipse]
	layer3_stage1_expert_residual -> model_output [label="" style=solid]
}
