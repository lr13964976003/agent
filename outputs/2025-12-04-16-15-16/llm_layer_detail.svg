<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="4500pt" height="2495pt"
 viewBox="0.00 0.00 1080.00 598.89" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.77 1.77) rotate(0) translate(4 1402)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1402 2531.5,-1402 2531.5,4 -4,4"/>
<!-- layer_input -->
<g id="node1" class="node">
<title>layer_input</title>
<polygon fill="lightblue" stroke="black" points="176,-745.5 0,-745.5 0,-709.5 176,-709.5 176,-745.5"/>
<text text-anchor="middle" x="88" y="-730.5" font-family="Times,serif" font-size="10.00">Layer Input</text>
<text text-anchor="middle" x="88" y="-719.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=1024]</text>
</g>
<!-- tp_split_0 -->
<g id="node2" class="node">
<title>tp_split_0</title>
<polygon fill="yellow" stroke="black" points="564.74,-1318.5 283.98,-1318.5 211.75,-1258.5 492.52,-1258.5 564.74,-1318.5"/>
<text text-anchor="middle" x="388.25" y="-1291.5" font-family="Times,serif" font-size="10.00">TP Split 0</text>
<text text-anchor="middle" x="388.25" y="-1280.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_0 -->
<g id="edge1" class="edge">
<title>layer_input&#45;&gt;tp_split_0</title>
<path fill="none" stroke="black" d="M90.31,-745.71C95.55,-807.76 119.45,-1014.7 212,-1151.5 240.55,-1193.7 286.21,-1228.79 323.77,-1252.89"/>
<polygon fill="black" stroke="black" points="322.31,-1256.1 332.63,-1258.47 326.04,-1250.18 322.31,-1256.1"/>
</g>
<!-- tp_split_1 -->
<g id="node9" class="node">
<title>tp_split_1</title>
<polygon fill="yellow" stroke="black" points="564.74,-1142.5 283.98,-1142.5 211.75,-1082.5 492.52,-1082.5 564.74,-1142.5"/>
<text text-anchor="middle" x="388.25" y="-1115.5" font-family="Times,serif" font-size="10.00">TP Split 1</text>
<text text-anchor="middle" x="388.25" y="-1104.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_1 -->
<g id="edge14" class="edge">
<title>layer_input&#45;&gt;tp_split_1</title>
<path fill="none" stroke="black" d="M94.96,-745.81C109.66,-789.04 150.94,-899.43 212,-974.5 245.03,-1015.11 292.04,-1051.3 329.05,-1076.43"/>
<polygon fill="black" stroke="black" points="327.49,-1079.6 337.75,-1082.25 331.39,-1073.78 327.49,-1079.6"/>
</g>
<!-- tp_split_2 -->
<g id="node16" class="node">
<title>tp_split_2</title>
<polygon fill="yellow" stroke="black" points="564.74,-965.5 283.98,-965.5 211.75,-905.5 492.52,-905.5 564.74,-965.5"/>
<text text-anchor="middle" x="388.25" y="-938.5" font-family="Times,serif" font-size="10.00">TP Split 2</text>
<text text-anchor="middle" x="388.25" y="-927.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_2 -->
<g id="edge27" class="edge">
<title>layer_input&#45;&gt;tp_split_2</title>
<path fill="none" stroke="black" d="M114.95,-745.59C164.04,-779.84 271.37,-854.69 335.65,-899.51"/>
<polygon fill="black" stroke="black" points="333.83,-902.51 344.04,-905.36 337.84,-896.77 333.83,-902.51"/>
</g>
<!-- tp_split_3 -->
<g id="node23" class="node">
<title>tp_split_3</title>
<polygon fill="yellow" stroke="black" points="564.74,-788.5 283.98,-788.5 211.75,-728.5 492.52,-728.5 564.74,-788.5"/>
<text text-anchor="middle" x="388.25" y="-761.5" font-family="Times,serif" font-size="10.00">TP Split 3</text>
<text text-anchor="middle" x="388.25" y="-750.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_3 -->
<g id="edge40" class="edge">
<title>layer_input&#45;&gt;tp_split_3</title>
<path fill="none" stroke="black" d="M176.07,-736.55C189.34,-737.93 203.41,-739.39 217.73,-740.88"/>
<polygon fill="black" stroke="black" points="217.38,-744.36 227.69,-741.92 218.1,-737.4 217.38,-744.36"/>
</g>
<!-- tp_split_4 -->
<g id="node30" class="node">
<title>tp_split_4</title>
<polygon fill="yellow" stroke="black" points="564.74,-669.5 283.98,-669.5 211.75,-609.5 492.52,-609.5 564.74,-669.5"/>
<text text-anchor="middle" x="388.25" y="-642.5" font-family="Times,serif" font-size="10.00">TP Split 4</text>
<text text-anchor="middle" x="388.25" y="-631.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_4 -->
<g id="edge53" class="edge">
<title>layer_input&#45;&gt;tp_split_4</title>
<path fill="none" stroke="black" d="M150.07,-709.48C186.2,-698.82 233.07,-684.99 275.59,-672.44"/>
<polygon fill="black" stroke="black" points="276.84,-675.72 285.44,-669.54 274.86,-669.01 276.84,-675.72"/>
</g>
<!-- tp_split_5 -->
<g id="node37" class="node">
<title>tp_split_5</title>
<polygon fill="yellow" stroke="black" points="564.74,-492.5 283.98,-492.5 211.75,-432.5 492.52,-432.5 564.74,-492.5"/>
<text text-anchor="middle" x="388.25" y="-465.5" font-family="Times,serif" font-size="10.00">TP Split 5</text>
<text text-anchor="middle" x="388.25" y="-454.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_5 -->
<g id="edge66" class="edge">
<title>layer_input&#45;&gt;tp_split_5</title>
<path fill="none" stroke="black" d="M105.39,-709.08C128.31,-683.68 171.67,-636.9 212,-600.5 252.59,-563.87 301.71,-525.67 337.61,-498.77"/>
<polygon fill="black" stroke="black" points="340.05,-501.31 345.97,-492.53 335.86,-495.7 340.05,-501.31"/>
</g>
<!-- tp_split_6 -->
<g id="node44" class="node">
<title>tp_split_6</title>
<polygon fill="yellow" stroke="black" points="564.74,-316.5 283.98,-316.5 211.75,-256.5 492.52,-256.5 564.74,-316.5"/>
<text text-anchor="middle" x="388.25" y="-289.5" font-family="Times,serif" font-size="10.00">TP Split 6</text>
<text text-anchor="middle" x="388.25" y="-278.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_6 -->
<g id="edge79" class="edge">
<title>layer_input&#45;&gt;tp_split_6</title>
<path fill="none" stroke="black" d="M92.83,-709.42C104.07,-659.65 140.72,-518.07 212,-423.5 242.99,-382.39 289.23,-346.94 326.43,-322.41"/>
<polygon fill="black" stroke="black" points="328.71,-325.1 335.19,-316.72 324.89,-319.23 328.71,-325.1"/>
</g>
<!-- tp_split_7 -->
<g id="node51" class="node">
<title>tp_split_7</title>
<polygon fill="yellow" stroke="black" points="564.74,-139.5 283.98,-139.5 211.75,-79.5 492.52,-79.5 564.74,-139.5"/>
<text text-anchor="middle" x="388.25" y="-112.5" font-family="Times,serif" font-size="10.00">TP Split 7</text>
<text text-anchor="middle" x="388.25" y="-101.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- layer_input&#45;&gt;tp_split_7 -->
<g id="edge92" class="edge">
<title>layer_input&#45;&gt;tp_split_7</title>
<path fill="none" stroke="black" d="M89.56,-709.3C92.42,-642.23 109.65,-404.64 212,-247.5 239.88,-204.69 285.57,-169.36 323.3,-145.16"/>
<polygon fill="black" stroke="black" points="325.61,-147.84 332.21,-139.56 321.88,-141.92 325.61,-147.84"/>
</g>
<!-- attn_q_tp0 -->
<g id="node3" class="node">
<title>attn_q_tp0</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1398 600.5,-1398 600.5,-1357 770.5,-1357 770.5,-1398"/>
<text text-anchor="middle" x="685.5" y="-1386" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-1375" font-family="Times,serif" font-size="10.00">TP0</text>
<text text-anchor="middle" x="685.5" y="-1364" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_0&#45;&gt;attn_q_tp0 -->
<g id="edge2" class="edge">
<title>tp_split_0&#45;&gt;attn_q_tp0</title>
<path fill="none" stroke="black" d="M488.79,-1318.51C527.05,-1330.04 570.14,-1343.03 606.13,-1353.88"/>
<polygon fill="black" stroke="black" points="605.5,-1357.34 616.08,-1356.88 607.52,-1350.64 605.5,-1357.34"/>
</g>
<!-- attn_k_tp0 -->
<g id="node4" class="node">
<title>attn_k_tp0</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1339 600.5,-1339 600.5,-1298 770.5,-1298 770.5,-1339"/>
<text text-anchor="middle" x="685.5" y="-1327" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-1316" font-family="Times,serif" font-size="10.00">TP0</text>
<text text-anchor="middle" x="685.5" y="-1305" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_0&#45;&gt;attn_k_tp0 -->
<g id="edge3" class="edge">
<title>tp_split_0&#45;&gt;attn_k_tp0</title>
<path fill="none" stroke="black" d="M548.11,-1304.64C562.46,-1306.1 576.68,-1307.54 590.2,-1308.92"/>
<polygon fill="black" stroke="black" points="590.1,-1312.43 600.4,-1309.96 590.81,-1305.46 590.1,-1312.43"/>
</g>
<!-- attn_v_tp0 -->
<g id="node5" class="node">
<title>attn_v_tp0</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1280 600.5,-1280 600.5,-1239 770.5,-1239 770.5,-1280"/>
<text text-anchor="middle" x="685.5" y="-1268" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-1257" font-family="Times,serif" font-size="10.00">TP0</text>
<text text-anchor="middle" x="685.5" y="-1246" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_0&#45;&gt;attn_v_tp0 -->
<g id="edge4" class="edge">
<title>tp_split_0&#45;&gt;attn_v_tp0</title>
<path fill="none" stroke="black" d="M514.03,-1276.24C539.51,-1273.74 565.91,-1271.15 590.12,-1268.77"/>
<polygon fill="black" stroke="black" points="590.73,-1272.23 600.34,-1267.77 590.05,-1265.26 590.73,-1272.23"/>
</g>
<!-- expert_gate -->
<g id="node58" class="node">
<title>expert_gate</title>
<polygon fill="yellow" stroke="black" points="1150.8,-728.5 876.86,-728.5 806.39,-668.5 1080.33,-668.5 1150.8,-728.5"/>
<text text-anchor="middle" x="978.6" y="-701.5" font-family="Times,serif" font-size="10.00">Expert Gate</text>
<text text-anchor="middle" x="978.6" y="-690.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, experts=64]</text>
</g>
<!-- attn_q_tp0&#45;&gt;expert_gate -->
<g id="edge5" class="edge">
<title>attn_q_tp0&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M760.52,-1356.82C764.12,-1354.35 767.48,-1351.59 770.5,-1348.5 943.02,-1171.79 971.9,-851.69 976.67,-739.04"/>
<polygon fill="black" stroke="black" points="980.18,-738.93 977.06,-728.8 973.18,-738.66 980.18,-738.93"/>
</g>
<!-- attn_k_tp0&#45;&gt;expert_gate -->
<g id="edge6" class="edge">
<title>attn_k_tp0&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M760.03,-1297.98C763.79,-1295.47 767.33,-1292.66 770.5,-1289.5 929.36,-1131.37 966.67,-844.62 975.17,-738.99"/>
<polygon fill="black" stroke="black" points="978.68,-738.99 975.95,-728.75 971.7,-738.46 978.68,-738.99"/>
</g>
<!-- attn_v_tp0&#45;&gt;expert_gate -->
<g id="edge7" class="edge">
<title>attn_v_tp0&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M759.9,-1238.85C763.7,-1236.37 767.27,-1233.6 770.5,-1230.5 915.91,-1090.62 961.02,-836.77 973.39,-738.69"/>
<polygon fill="black" stroke="black" points="976.89,-738.95 974.62,-728.6 969.94,-738.1 976.89,-738.95"/>
</g>
<!-- attn_out_tp0 -->
<g id="node6" class="node">
<title>attn_out_tp0</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-926 1186.7,-926 1186.7,-885 1356.7,-885 1356.7,-926"/>
<text text-anchor="middle" x="1271.7" y="-914" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-903" font-family="Times,serif" font-size="10.00">TP0</text>
<text text-anchor="middle" x="1271.7" y="-892" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- allreduce_attn -->
<g id="node59" class="node">
<title>allreduce_attn</title>
<ellipse fill="lightgreen" stroke="black" cx="1517.15" cy="-698.5" rx="124.4" ry="28.98"/>
<text text-anchor="middle" x="1517.15" y="-707" font-family="Times,serif" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1517.15" y="-696" font-family="Times,serif" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1517.15" y="-685" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=1024]</text>
</g>
<!-- attn_out_tp0&#45;&gt;allreduce_attn -->
<g id="edge9" class="edge">
<title>attn_out_tp0&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1341.93,-884.87C1347.09,-882.36 1352.07,-879.57 1356.7,-876.5 1413.68,-838.64 1463.42,-775.7 1491.59,-735.7"/>
<polygon fill="black" stroke="black" points="1494.61,-737.49 1497.44,-727.28 1488.86,-733.5 1494.61,-737.49"/>
</g>
<!-- mlp_fc1_tp0 -->
<g id="node7" class="node">
<title>mlp_fc1_tp0</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-926 1677.6,-926 1677.6,-885 1824.6,-885 1824.6,-926"/>
<text text-anchor="middle" x="1751.1" y="-914" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-903" font-family="Times,serif" font-size="10.00">TP0</text>
<text text-anchor="middle" x="1751.1" y="-892" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp0 -->
<g id="node8" class="node">
<title>mlp_fc2_tp0</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-926 1860.6,-926 1860.6,-885 2030.6,-885 2030.6,-926"/>
<text text-anchor="middle" x="1945.6" y="-914" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-903" font-family="Times,serif" font-size="10.00">TP0</text>
<text text-anchor="middle" x="1945.6" y="-892" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp0&#45;&gt;mlp_fc2_tp0 -->
<g id="edge11" class="edge">
<title>mlp_fc1_tp0&#45;&gt;mlp_fc2_tp0</title>
<path fill="none" stroke="black" d="M1824.6,-905.5C1833.03,-905.5 1841.71,-905.5 1850.38,-905.5"/>
<polygon fill="black" stroke="black" points="1850.52,-909 1860.52,-905.5 1850.52,-902 1850.52,-909"/>
</g>
<!-- allreduce_mlp -->
<g id="node60" class="node">
<title>allreduce_mlp</title>
<ellipse fill="lightgreen" stroke="black" cx="2191.05" cy="-698.5" rx="124.4" ry="28.98"/>
<text text-anchor="middle" x="2191.05" y="-707" font-family="Times,serif" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2191.05" y="-696" font-family="Times,serif" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2191.05" y="-685" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=1024]</text>
</g>
<!-- mlp_fc2_tp0&#45;&gt;allreduce_mlp -->
<g id="edge12" class="edge">
<title>mlp_fc2_tp0&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2015.83,-884.87C2020.99,-882.36 2025.97,-879.57 2030.6,-876.5 2087.59,-838.64 2137.32,-775.7 2165.49,-735.7"/>
<polygon fill="black" stroke="black" points="2168.51,-737.49 2171.34,-727.28 2162.76,-733.5 2168.51,-737.49"/>
</g>
<!-- attn_q_tp1 -->
<g id="node10" class="node">
<title>attn_q_tp1</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1221 600.5,-1221 600.5,-1180 770.5,-1180 770.5,-1221"/>
<text text-anchor="middle" x="685.5" y="-1209" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-1198" font-family="Times,serif" font-size="10.00">TP1</text>
<text text-anchor="middle" x="685.5" y="-1187" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_1&#45;&gt;attn_q_tp1 -->
<g id="edge15" class="edge">
<title>tp_split_1&#45;&gt;attn_q_tp1</title>
<path fill="none" stroke="black" d="M490.03,-1142.54C527.75,-1153.78 570.01,-1166.38 605.48,-1176.95"/>
<polygon fill="black" stroke="black" points="604.72,-1180.37 615.3,-1179.88 606.71,-1173.66 604.72,-1180.37"/>
</g>
<!-- attn_k_tp1 -->
<g id="node11" class="node">
<title>attn_k_tp1</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1162 600.5,-1162 600.5,-1121 770.5,-1121 770.5,-1162"/>
<text text-anchor="middle" x="685.5" y="-1150" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-1139" font-family="Times,serif" font-size="10.00">TP1</text>
<text text-anchor="middle" x="685.5" y="-1128" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_1&#45;&gt;attn_k_tp1 -->
<g id="edge16" class="edge">
<title>tp_split_1&#45;&gt;attn_k_tp1</title>
<path fill="none" stroke="black" d="M547.68,-1128.06C562.17,-1129.49 576.53,-1130.9 590.19,-1132.24"/>
<polygon fill="black" stroke="black" points="590.19,-1135.75 600.48,-1133.25 590.87,-1128.79 590.19,-1135.75"/>
</g>
<!-- attn_v_tp1 -->
<g id="node12" class="node">
<title>attn_v_tp1</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1103 600.5,-1103 600.5,-1062 770.5,-1062 770.5,-1103"/>
<text text-anchor="middle" x="685.5" y="-1091" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-1080" font-family="Times,serif" font-size="10.00">TP1</text>
<text text-anchor="middle" x="685.5" y="-1069" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_1&#45;&gt;attn_v_tp1 -->
<g id="edge17" class="edge">
<title>tp_split_1&#45;&gt;attn_v_tp1</title>
<path fill="none" stroke="black" d="M513.6,-1099.86C539.11,-1097.27 565.58,-1094.58 589.84,-1092.12"/>
<polygon fill="black" stroke="black" points="590.5,-1095.57 600.09,-1091.08 589.79,-1088.61 590.5,-1095.57"/>
</g>
<!-- attn_q_tp1&#45;&gt;expert_gate -->
<g id="edge18" class="edge">
<title>attn_q_tp1&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M759.35,-1179.94C763.34,-1177.44 767.09,-1174.64 770.5,-1171.5 902.47,-1049.72 954.71,-828.91 971.2,-738.61"/>
<polygon fill="black" stroke="black" points="974.69,-738.97 972.99,-728.52 967.79,-737.75 974.69,-738.97"/>
</g>
<!-- attn_k_tp1&#45;&gt;expert_gate -->
<g id="edge19" class="edge">
<title>attn_k_tp1&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M758.76,-1120.98C762.94,-1118.47 766.9,-1115.65 770.5,-1112.5 889.16,-1008.49 947.63,-820.48 968.43,-738.51"/>
<polygon fill="black" stroke="black" points="971.88,-739.14 970.9,-728.59 965.09,-737.45 971.88,-739.14"/>
</g>
<!-- attn_v_tp1&#45;&gt;expert_gate -->
<g id="edge20" class="edge">
<title>attn_v_tp1&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M758.12,-1061.94C762.51,-1059.44 766.68,-1056.63 770.5,-1053.5 876.09,-966.78 939.59,-811.16 964.89,-738.24"/>
<polygon fill="black" stroke="black" points="968.29,-739.11 968.2,-728.52 961.66,-736.85 968.29,-739.11"/>
</g>
<!-- attn_out_tp1 -->
<g id="node13" class="node">
<title>attn_out_tp1</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-867 1186.7,-867 1186.7,-826 1356.7,-826 1356.7,-867"/>
<text text-anchor="middle" x="1271.7" y="-855" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-844" font-family="Times,serif" font-size="10.00">TP1</text>
<text text-anchor="middle" x="1271.7" y="-833" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp1&#45;&gt;allreduce_attn -->
<g id="edge22" class="edge">
<title>attn_out_tp1&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1338.65,-825.94C1344.86,-823.35 1350.97,-820.53 1356.7,-817.5 1400.7,-794.21 1445.69,-759.43 1476.62,-733.48"/>
<polygon fill="black" stroke="black" points="1479.19,-735.88 1484.56,-726.74 1474.67,-730.54 1479.19,-735.88"/>
</g>
<!-- mlp_fc1_tp1 -->
<g id="node14" class="node">
<title>mlp_fc1_tp1</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-867 1677.6,-867 1677.6,-826 1824.6,-826 1824.6,-867"/>
<text text-anchor="middle" x="1751.1" y="-855" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-844" font-family="Times,serif" font-size="10.00">TP1</text>
<text text-anchor="middle" x="1751.1" y="-833" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp1 -->
<g id="node15" class="node">
<title>mlp_fc2_tp1</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-867 1860.6,-867 1860.6,-826 2030.6,-826 2030.6,-867"/>
<text text-anchor="middle" x="1945.6" y="-855" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-844" font-family="Times,serif" font-size="10.00">TP1</text>
<text text-anchor="middle" x="1945.6" y="-833" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp1&#45;&gt;mlp_fc2_tp1 -->
<g id="edge24" class="edge">
<title>mlp_fc1_tp1&#45;&gt;mlp_fc2_tp1</title>
<path fill="none" stroke="black" d="M1824.6,-846.5C1833.03,-846.5 1841.71,-846.5 1850.38,-846.5"/>
<polygon fill="black" stroke="black" points="1850.52,-850 1860.52,-846.5 1850.52,-843 1850.52,-850"/>
</g>
<!-- mlp_fc2_tp1&#45;&gt;allreduce_mlp -->
<g id="edge25" class="edge">
<title>mlp_fc2_tp1&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2012.55,-825.94C2018.76,-823.35 2024.87,-820.53 2030.6,-817.5 2074.6,-794.21 2119.59,-759.43 2150.52,-733.48"/>
<polygon fill="black" stroke="black" points="2153.09,-735.88 2158.46,-726.74 2148.57,-730.54 2153.09,-735.88"/>
</g>
<!-- attn_q_tp2 -->
<g id="node17" class="node">
<title>attn_q_tp2</title>
<polygon fill="lightblue" stroke="black" points="770.5,-1044 600.5,-1044 600.5,-1003 770.5,-1003 770.5,-1044"/>
<text text-anchor="middle" x="685.5" y="-1032" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-1021" font-family="Times,serif" font-size="10.00">TP2</text>
<text text-anchor="middle" x="685.5" y="-1010" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_2&#45;&gt;attn_q_tp2 -->
<g id="edge28" class="edge">
<title>tp_split_2&#45;&gt;attn_q_tp2</title>
<path fill="none" stroke="black" d="M490.03,-965.54C527.75,-976.78 570.01,-989.38 605.48,-999.95"/>
<polygon fill="black" stroke="black" points="604.72,-1003.37 615.3,-1002.88 606.71,-996.66 604.72,-1003.37"/>
</g>
<!-- attn_k_tp2 -->
<g id="node18" class="node">
<title>attn_k_tp2</title>
<polygon fill="lightblue" stroke="black" points="770.5,-985 600.5,-985 600.5,-944 770.5,-944 770.5,-985"/>
<text text-anchor="middle" x="685.5" y="-973" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-962" font-family="Times,serif" font-size="10.00">TP2</text>
<text text-anchor="middle" x="685.5" y="-951" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_2&#45;&gt;attn_k_tp2 -->
<g id="edge29" class="edge">
<title>tp_split_2&#45;&gt;attn_k_tp2</title>
<path fill="none" stroke="black" d="M547.68,-951.06C562.17,-952.49 576.53,-953.9 590.19,-955.24"/>
<polygon fill="black" stroke="black" points="590.19,-958.75 600.48,-956.25 590.87,-951.79 590.19,-958.75"/>
</g>
<!-- attn_v_tp2 -->
<g id="node19" class="node">
<title>attn_v_tp2</title>
<polygon fill="lightblue" stroke="black" points="770.5,-926 600.5,-926 600.5,-885 770.5,-885 770.5,-926"/>
<text text-anchor="middle" x="685.5" y="-914" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-903" font-family="Times,serif" font-size="10.00">TP2</text>
<text text-anchor="middle" x="685.5" y="-892" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_2&#45;&gt;attn_v_tp2 -->
<g id="edge30" class="edge">
<title>tp_split_2&#45;&gt;attn_v_tp2</title>
<path fill="none" stroke="black" d="M513.6,-922.86C539.11,-920.27 565.58,-917.58 589.84,-915.12"/>
<polygon fill="black" stroke="black" points="590.5,-918.57 600.09,-914.08 589.79,-911.61 590.5,-918.57"/>
</g>
<!-- attn_q_tp2&#45;&gt;expert_gate -->
<g id="edge31" class="edge">
<title>attn_q_tp2&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M757.42,-1002.8C762.02,-1000.32 766.43,-997.57 770.5,-994.5 863.12,-924.62 930.03,-801.15 960.02,-738.05"/>
<polygon fill="black" stroke="black" points="963.27,-739.36 964.34,-728.82 956.93,-736.39 963.27,-739.36"/>
</g>
<!-- attn_k_tp2&#45;&gt;expert_gate -->
<g id="edge32" class="edge">
<title>attn_k_tp2&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M755.77,-943.93C760.92,-941.4 765.89,-938.6 770.5,-935.5 850.41,-881.7 918.48,-789.6 953.11,-737.47"/>
<polygon fill="black" stroke="black" points="956.22,-739.11 958.78,-728.84 950.37,-735.27 956.22,-739.11"/>
</g>
<!-- attn_v_tp2&#45;&gt;expert_gate -->
<g id="edge33" class="edge">
<title>attn_v_tp2&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M753.55,-884.97C759.41,-882.39 765.14,-879.57 770.5,-876.5 837.76,-837.88 903.63,-775.93 942.42,-736.24"/>
<polygon fill="black" stroke="black" points="945.36,-738.23 949.81,-728.61 940.33,-733.36 945.36,-738.23"/>
</g>
<!-- attn_out_tp2 -->
<g id="node20" class="node">
<title>attn_out_tp2</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-808 1186.7,-808 1186.7,-767 1356.7,-767 1356.7,-808"/>
<text text-anchor="middle" x="1271.7" y="-796" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-785" font-family="Times,serif" font-size="10.00">TP2</text>
<text text-anchor="middle" x="1271.7" y="-774" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp2&#45;&gt;allreduce_attn -->
<g id="edge35" class="edge">
<title>attn_out_tp2&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1332.88,-766.95C1340.9,-764.14 1349.01,-761.27 1356.7,-758.5 1384.58,-748.45 1415.06,-737.07 1441.83,-726.95"/>
<polygon fill="black" stroke="black" points="1443.41,-730.09 1451.52,-723.28 1440.93,-723.55 1443.41,-730.09"/>
</g>
<!-- mlp_fc1_tp2 -->
<g id="node21" class="node">
<title>mlp_fc1_tp2</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-808 1677.6,-808 1677.6,-767 1824.6,-767 1824.6,-808"/>
<text text-anchor="middle" x="1751.1" y="-796" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-785" font-family="Times,serif" font-size="10.00">TP2</text>
<text text-anchor="middle" x="1751.1" y="-774" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp2 -->
<g id="node22" class="node">
<title>mlp_fc2_tp2</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-808 1860.6,-808 1860.6,-767 2030.6,-767 2030.6,-808"/>
<text text-anchor="middle" x="1945.6" y="-796" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-785" font-family="Times,serif" font-size="10.00">TP2</text>
<text text-anchor="middle" x="1945.6" y="-774" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp2&#45;&gt;mlp_fc2_tp2 -->
<g id="edge37" class="edge">
<title>mlp_fc1_tp2&#45;&gt;mlp_fc2_tp2</title>
<path fill="none" stroke="black" d="M1824.6,-787.5C1833.03,-787.5 1841.71,-787.5 1850.38,-787.5"/>
<polygon fill="black" stroke="black" points="1850.52,-791 1860.52,-787.5 1850.52,-784 1850.52,-791"/>
</g>
<!-- mlp_fc2_tp2&#45;&gt;allreduce_mlp -->
<g id="edge38" class="edge">
<title>mlp_fc2_tp2&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2006.78,-766.95C2014.8,-764.14 2022.91,-761.27 2030.6,-758.5 2058.48,-748.45 2088.96,-737.07 2115.73,-726.95"/>
<polygon fill="black" stroke="black" points="2117.31,-730.09 2125.42,-723.28 2114.83,-723.55 2117.31,-730.09"/>
</g>
<!-- attn_q_tp3 -->
<g id="node24" class="node">
<title>attn_q_tp3</title>
<polygon fill="lightblue" stroke="black" points="770.5,-867 600.5,-867 600.5,-826 770.5,-826 770.5,-867"/>
<text text-anchor="middle" x="685.5" y="-855" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-844" font-family="Times,serif" font-size="10.00">TP3</text>
<text text-anchor="middle" x="685.5" y="-833" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_3&#45;&gt;attn_q_tp3 -->
<g id="edge41" class="edge">
<title>tp_split_3&#45;&gt;attn_q_tp3</title>
<path fill="none" stroke="black" d="M490.03,-788.54C527.75,-799.78 570.01,-812.38 605.48,-822.95"/>
<polygon fill="black" stroke="black" points="604.72,-826.37 615.3,-825.88 606.71,-819.66 604.72,-826.37"/>
</g>
<!-- attn_k_tp3 -->
<g id="node25" class="node">
<title>attn_k_tp3</title>
<polygon fill="lightblue" stroke="black" points="770.5,-808 600.5,-808 600.5,-767 770.5,-767 770.5,-808"/>
<text text-anchor="middle" x="685.5" y="-796" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-785" font-family="Times,serif" font-size="10.00">TP3</text>
<text text-anchor="middle" x="685.5" y="-774" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_3&#45;&gt;attn_k_tp3 -->
<g id="edge42" class="edge">
<title>tp_split_3&#45;&gt;attn_k_tp3</title>
<path fill="none" stroke="black" d="M547.68,-774.06C562.17,-775.49 576.53,-776.9 590.19,-778.24"/>
<polygon fill="black" stroke="black" points="590.19,-781.75 600.48,-779.25 590.87,-774.79 590.19,-781.75"/>
</g>
<!-- attn_v_tp3 -->
<g id="node26" class="node">
<title>attn_v_tp3</title>
<polygon fill="lightblue" stroke="black" points="770.5,-749 600.5,-749 600.5,-708 770.5,-708 770.5,-749"/>
<text text-anchor="middle" x="685.5" y="-737" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-726" font-family="Times,serif" font-size="10.00">TP3</text>
<text text-anchor="middle" x="685.5" y="-715" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_3&#45;&gt;attn_v_tp3 -->
<g id="edge43" class="edge">
<title>tp_split_3&#45;&gt;attn_v_tp3</title>
<path fill="none" stroke="black" d="M513.6,-745.86C539.11,-743.27 565.58,-740.58 589.84,-738.12"/>
<polygon fill="black" stroke="black" points="590.5,-741.57 600.09,-737.08 589.79,-734.61 590.5,-741.57"/>
</g>
<!-- attn_q_tp3&#45;&gt;expert_gate -->
<g id="edge44" class="edge">
<title>attn_q_tp3&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M750.29,-825.91C757.19,-823.26 764.04,-820.44 770.5,-817.5 823.95,-793.18 881.63,-759.35 922.52,-733.98"/>
<polygon fill="black" stroke="black" points="924.6,-736.8 931.23,-728.54 920.9,-730.86 924.6,-736.8"/>
</g>
<!-- attn_k_tp3&#45;&gt;expert_gate -->
<g id="edge45" class="edge">
<title>attn_k_tp3&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M753.65,-766.97C788.01,-756.46 830.68,-743.42 869.53,-731.54"/>
<polygon fill="black" stroke="black" points="870.78,-734.82 879.32,-728.55 868.73,-728.12 870.78,-734.82"/>
</g>
<!-- attn_v_tp3&#45;&gt;expert_gate -->
<g id="edge46" class="edge">
<title>attn_v_tp3&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M770.69,-719.82C794.26,-717.39 820.46,-714.69 846.07,-712.05"/>
<polygon fill="black" stroke="black" points="846.65,-715.51 856.24,-711.01 845.93,-708.55 846.65,-715.51"/>
</g>
<!-- attn_out_tp3 -->
<g id="node27" class="node">
<title>attn_out_tp3</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-749 1186.7,-749 1186.7,-708 1356.7,-708 1356.7,-749"/>
<text text-anchor="middle" x="1271.7" y="-737" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-726" font-family="Times,serif" font-size="10.00">TP3</text>
<text text-anchor="middle" x="1271.7" y="-715" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp3&#45;&gt;allreduce_attn -->
<g id="edge48" class="edge">
<title>attn_out_tp3&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1356.82,-718.13C1369.63,-716.55 1383.07,-714.9 1396.46,-713.25"/>
<polygon fill="black" stroke="black" points="1397.19,-716.69 1406.69,-711.99 1396.34,-709.74 1397.19,-716.69"/>
</g>
<!-- mlp_fc1_tp3 -->
<g id="node28" class="node">
<title>mlp_fc1_tp3</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-749 1677.6,-749 1677.6,-708 1824.6,-708 1824.6,-749"/>
<text text-anchor="middle" x="1751.1" y="-737" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-726" font-family="Times,serif" font-size="10.00">TP3</text>
<text text-anchor="middle" x="1751.1" y="-715" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp3 -->
<g id="node29" class="node">
<title>mlp_fc2_tp3</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-749 1860.6,-749 1860.6,-708 2030.6,-708 2030.6,-749"/>
<text text-anchor="middle" x="1945.6" y="-737" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-726" font-family="Times,serif" font-size="10.00">TP3</text>
<text text-anchor="middle" x="1945.6" y="-715" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp3&#45;&gt;mlp_fc2_tp3 -->
<g id="edge50" class="edge">
<title>mlp_fc1_tp3&#45;&gt;mlp_fc2_tp3</title>
<path fill="none" stroke="black" d="M1824.6,-728.5C1833.03,-728.5 1841.71,-728.5 1850.38,-728.5"/>
<polygon fill="black" stroke="black" points="1850.52,-732 1860.52,-728.5 1850.52,-725 1850.52,-732"/>
</g>
<!-- mlp_fc2_tp3&#45;&gt;allreduce_mlp -->
<g id="edge51" class="edge">
<title>mlp_fc2_tp3&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2030.72,-718.13C2043.54,-716.55 2056.97,-714.9 2070.36,-713.25"/>
<polygon fill="black" stroke="black" points="2071.1,-716.69 2080.59,-711.99 2070.24,-709.74 2071.1,-716.69"/>
</g>
<!-- attn_q_tp4 -->
<g id="node31" class="node">
<title>attn_q_tp4</title>
<polygon fill="lightblue" stroke="black" points="770.5,-690 600.5,-690 600.5,-649 770.5,-649 770.5,-690"/>
<text text-anchor="middle" x="685.5" y="-678" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-667" font-family="Times,serif" font-size="10.00">TP4</text>
<text text-anchor="middle" x="685.5" y="-656" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_4&#45;&gt;attn_q_tp4 -->
<g id="edge54" class="edge">
<title>tp_split_4&#45;&gt;attn_q_tp4</title>
<path fill="none" stroke="black" d="M548.11,-655.64C562.46,-657.1 576.68,-658.54 590.2,-659.92"/>
<polygon fill="black" stroke="black" points="590.1,-663.43 600.4,-660.96 590.81,-656.46 590.1,-663.43"/>
</g>
<!-- attn_k_tp4 -->
<g id="node32" class="node">
<title>attn_k_tp4</title>
<polygon fill="lightblue" stroke="black" points="770.5,-631 600.5,-631 600.5,-590 770.5,-590 770.5,-631"/>
<text text-anchor="middle" x="685.5" y="-619" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-608" font-family="Times,serif" font-size="10.00">TP4</text>
<text text-anchor="middle" x="685.5" y="-597" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_4&#45;&gt;attn_k_tp4 -->
<g id="edge55" class="edge">
<title>tp_split_4&#45;&gt;attn_k_tp4</title>
<path fill="none" stroke="black" d="M514.03,-627.24C539.51,-624.74 565.91,-622.15 590.12,-619.77"/>
<polygon fill="black" stroke="black" points="590.73,-623.23 600.34,-618.77 590.05,-616.26 590.73,-623.23"/>
</g>
<!-- attn_v_tp4 -->
<g id="node33" class="node">
<title>attn_v_tp4</title>
<polygon fill="lightblue" stroke="black" points="770.5,-572 600.5,-572 600.5,-531 770.5,-531 770.5,-572"/>
<text text-anchor="middle" x="685.5" y="-560" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-549" font-family="Times,serif" font-size="10.00">TP4</text>
<text text-anchor="middle" x="685.5" y="-538" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_4&#45;&gt;attn_v_tp4 -->
<g id="edge56" class="edge">
<title>tp_split_4&#45;&gt;attn_v_tp4</title>
<path fill="none" stroke="black" d="M490.03,-609.46C527.75,-598.22 570.01,-585.62 605.48,-575.05"/>
<polygon fill="black" stroke="black" points="606.71,-578.34 615.3,-572.12 604.72,-571.63 606.71,-578.34"/>
</g>
<!-- attn_q_tp4&#45;&gt;expert_gate -->
<g id="edge57" class="edge">
<title>attn_q_tp4&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M770.69,-677.89C784.2,-679.23 798.57,-680.67 813.2,-682.12"/>
<polygon fill="black" stroke="black" points="813.06,-685.63 823.36,-683.13 813.76,-678.66 813.06,-685.63"/>
</g>
<!-- attn_k_tp4&#45;&gt;expert_gate -->
<g id="edge58" class="edge">
<title>attn_k_tp4&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M754.38,-631.02C788.3,-641.27 830.17,-653.93 868.46,-665.51"/>
<polygon fill="black" stroke="black" points="867.52,-668.88 878.11,-668.42 869.55,-662.18 867.52,-668.88"/>
</g>
<!-- attn_v_tp4&#45;&gt;expert_gate -->
<g id="edge59" class="edge">
<title>attn_v_tp4&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M748,-572.09C755.66,-575.05 763.31,-578.22 770.5,-581.5 823.16,-605.57 880.26,-638.37 921.14,-663.12"/>
<polygon fill="black" stroke="black" points="919.51,-666.22 929.87,-668.43 923.15,-660.24 919.51,-666.22"/>
</g>
<!-- attn_out_tp4 -->
<g id="node34" class="node">
<title>attn_out_tp4</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-690 1186.7,-690 1186.7,-649 1356.7,-649 1356.7,-690"/>
<text text-anchor="middle" x="1271.7" y="-678" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-667" font-family="Times,serif" font-size="10.00">TP4</text>
<text text-anchor="middle" x="1271.7" y="-656" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp4&#45;&gt;allreduce_attn -->
<g id="edge61" class="edge">
<title>attn_out_tp4&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1356.82,-679.52C1369.42,-681.02 1382.61,-682.59 1395.78,-684.16"/>
<polygon fill="black" stroke="black" points="1395.49,-687.65 1405.83,-685.36 1396.32,-680.7 1395.49,-687.65"/>
</g>
<!-- mlp_fc1_tp4 -->
<g id="node35" class="node">
<title>mlp_fc1_tp4</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-690 1677.6,-690 1677.6,-649 1824.6,-649 1824.6,-690"/>
<text text-anchor="middle" x="1751.1" y="-678" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-667" font-family="Times,serif" font-size="10.00">TP4</text>
<text text-anchor="middle" x="1751.1" y="-656" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp4 -->
<g id="node36" class="node">
<title>mlp_fc2_tp4</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-690 1860.6,-690 1860.6,-649 2030.6,-649 2030.6,-690"/>
<text text-anchor="middle" x="1945.6" y="-678" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-667" font-family="Times,serif" font-size="10.00">TP4</text>
<text text-anchor="middle" x="1945.6" y="-656" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp4&#45;&gt;mlp_fc2_tp4 -->
<g id="edge63" class="edge">
<title>mlp_fc1_tp4&#45;&gt;mlp_fc2_tp4</title>
<path fill="none" stroke="black" d="M1824.6,-669.5C1833.03,-669.5 1841.71,-669.5 1850.38,-669.5"/>
<polygon fill="black" stroke="black" points="1850.52,-673 1860.52,-669.5 1850.52,-666 1850.52,-673"/>
</g>
<!-- mlp_fc2_tp4&#45;&gt;allreduce_mlp -->
<g id="edge64" class="edge">
<title>mlp_fc2_tp4&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2030.72,-679.52C2043.32,-681.02 2056.51,-682.59 2069.68,-684.16"/>
<polygon fill="black" stroke="black" points="2069.39,-687.65 2079.73,-685.36 2070.22,-680.7 2069.39,-687.65"/>
</g>
<!-- attn_q_tp5 -->
<g id="node38" class="node">
<title>attn_q_tp5</title>
<polygon fill="lightblue" stroke="black" points="770.5,-513 600.5,-513 600.5,-472 770.5,-472 770.5,-513"/>
<text text-anchor="middle" x="685.5" y="-501" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-490" font-family="Times,serif" font-size="10.00">TP5</text>
<text text-anchor="middle" x="685.5" y="-479" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_5&#45;&gt;attn_q_tp5 -->
<g id="edge67" class="edge">
<title>tp_split_5&#45;&gt;attn_q_tp5</title>
<path fill="none" stroke="black" d="M548.11,-478.64C562.46,-480.1 576.68,-481.54 590.2,-482.92"/>
<polygon fill="black" stroke="black" points="590.1,-486.43 600.4,-483.96 590.81,-479.46 590.1,-486.43"/>
</g>
<!-- attn_k_tp5 -->
<g id="node39" class="node">
<title>attn_k_tp5</title>
<polygon fill="lightblue" stroke="black" points="770.5,-454 600.5,-454 600.5,-413 770.5,-413 770.5,-454"/>
<text text-anchor="middle" x="685.5" y="-442" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-431" font-family="Times,serif" font-size="10.00">TP5</text>
<text text-anchor="middle" x="685.5" y="-420" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_5&#45;&gt;attn_k_tp5 -->
<g id="edge68" class="edge">
<title>tp_split_5&#45;&gt;attn_k_tp5</title>
<path fill="none" stroke="black" d="M514.03,-450.24C539.51,-447.74 565.91,-445.15 590.12,-442.77"/>
<polygon fill="black" stroke="black" points="590.73,-446.23 600.34,-441.77 590.05,-439.26 590.73,-446.23"/>
</g>
<!-- attn_v_tp5 -->
<g id="node40" class="node">
<title>attn_v_tp5</title>
<polygon fill="lightblue" stroke="black" points="770.5,-395 600.5,-395 600.5,-354 770.5,-354 770.5,-395"/>
<text text-anchor="middle" x="685.5" y="-383" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-372" font-family="Times,serif" font-size="10.00">TP5</text>
<text text-anchor="middle" x="685.5" y="-361" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_5&#45;&gt;attn_v_tp5 -->
<g id="edge69" class="edge">
<title>tp_split_5&#45;&gt;attn_v_tp5</title>
<path fill="none" stroke="black" d="M490.03,-432.46C527.75,-421.22 570.01,-408.62 605.48,-398.05"/>
<polygon fill="black" stroke="black" points="606.71,-401.34 615.3,-395.12 604.72,-394.63 606.71,-401.34"/>
</g>
<!-- attn_q_tp5&#45;&gt;expert_gate -->
<g id="edge70" class="edge">
<title>attn_q_tp5&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M751.77,-513.14C758.24,-515.97 764.6,-519.09 770.5,-522.5 836.96,-560.88 902.57,-621.54 941.58,-660.67"/>
<polygon fill="black" stroke="black" points="939.5,-663.55 949.02,-668.2 944.48,-658.63 939.5,-663.55"/>
</g>
<!-- attn_k_tp5&#45;&gt;expert_gate -->
<g id="edge71" class="edge">
<title>attn_k_tp5&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M754.03,-454.11C759.79,-456.9 765.37,-460.02 770.5,-463.5 849.64,-517.15 917.77,-607.96 952.67,-659.58"/>
<polygon fill="black" stroke="black" points="949.92,-661.76 958.39,-668.13 955.74,-657.87 949.92,-661.76"/>
</g>
<!-- attn_v_tp5&#45;&gt;expert_gate -->
<g id="edge72" class="edge">
<title>attn_v_tp5&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M755.73,-395.19C760.94,-397.94 765.94,-401.03 770.5,-404.5 862.44,-474.41 929.65,-596.82 959.86,-659.34"/>
<polygon fill="black" stroke="black" points="956.76,-660.95 964.22,-668.47 963.07,-657.94 956.76,-660.95"/>
</g>
<!-- attn_out_tp5 -->
<g id="node41" class="node">
<title>attn_out_tp5</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-631 1186.7,-631 1186.7,-590 1356.7,-590 1356.7,-631"/>
<text text-anchor="middle" x="1271.7" y="-619" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-608" font-family="Times,serif" font-size="10.00">TP5</text>
<text text-anchor="middle" x="1271.7" y="-597" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp5&#45;&gt;allreduce_attn -->
<g id="edge74" class="edge">
<title>attn_out_tp5&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1330.55,-631.11C1339.32,-634.25 1348.25,-637.45 1356.7,-640.5 1383.85,-650.29 1413.57,-661.08 1439.92,-670.67"/>
<polygon fill="black" stroke="black" points="1438.87,-674.01 1449.46,-674.14 1441.26,-667.43 1438.87,-674.01"/>
</g>
<!-- mlp_fc1_tp5 -->
<g id="node42" class="node">
<title>mlp_fc1_tp5</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-631 1677.6,-631 1677.6,-590 1824.6,-590 1824.6,-631"/>
<text text-anchor="middle" x="1751.1" y="-619" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-608" font-family="Times,serif" font-size="10.00">TP5</text>
<text text-anchor="middle" x="1751.1" y="-597" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp5 -->
<g id="node43" class="node">
<title>mlp_fc2_tp5</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-631 1860.6,-631 1860.6,-590 2030.6,-590 2030.6,-631"/>
<text text-anchor="middle" x="1945.6" y="-619" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-608" font-family="Times,serif" font-size="10.00">TP5</text>
<text text-anchor="middle" x="1945.6" y="-597" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp5&#45;&gt;mlp_fc2_tp5 -->
<g id="edge76" class="edge">
<title>mlp_fc1_tp5&#45;&gt;mlp_fc2_tp5</title>
<path fill="none" stroke="black" d="M1824.6,-610.5C1833.03,-610.5 1841.71,-610.5 1850.38,-610.5"/>
<polygon fill="black" stroke="black" points="1850.52,-614 1860.52,-610.5 1850.52,-607 1850.52,-614"/>
</g>
<!-- mlp_fc2_tp5&#45;&gt;allreduce_mlp -->
<g id="edge77" class="edge">
<title>mlp_fc2_tp5&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2004.45,-631.11C2013.22,-634.25 2022.15,-637.45 2030.6,-640.5 2057.75,-650.29 2087.47,-661.08 2113.82,-670.67"/>
<polygon fill="black" stroke="black" points="2112.77,-674.01 2123.36,-674.14 2115.16,-667.43 2112.77,-674.01"/>
</g>
<!-- attn_q_tp6 -->
<g id="node45" class="node">
<title>attn_q_tp6</title>
<polygon fill="lightblue" stroke="black" points="770.5,-336 600.5,-336 600.5,-295 770.5,-295 770.5,-336"/>
<text text-anchor="middle" x="685.5" y="-324" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-313" font-family="Times,serif" font-size="10.00">TP6</text>
<text text-anchor="middle" x="685.5" y="-302" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_6&#45;&gt;attn_q_tp6 -->
<g id="edge80" class="edge">
<title>tp_split_6&#45;&gt;attn_q_tp6</title>
<path fill="none" stroke="black" d="M547.68,-302.06C562.17,-303.49 576.53,-304.9 590.19,-306.24"/>
<polygon fill="black" stroke="black" points="590.19,-309.75 600.48,-307.25 590.87,-302.79 590.19,-309.75"/>
</g>
<!-- attn_k_tp6 -->
<g id="node46" class="node">
<title>attn_k_tp6</title>
<polygon fill="lightblue" stroke="black" points="770.5,-277 600.5,-277 600.5,-236 770.5,-236 770.5,-277"/>
<text text-anchor="middle" x="685.5" y="-265" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-254" font-family="Times,serif" font-size="10.00">TP6</text>
<text text-anchor="middle" x="685.5" y="-243" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_6&#45;&gt;attn_k_tp6 -->
<g id="edge81" class="edge">
<title>tp_split_6&#45;&gt;attn_k_tp6</title>
<path fill="none" stroke="black" d="M513.6,-273.86C539.11,-271.27 565.58,-268.58 589.84,-266.12"/>
<polygon fill="black" stroke="black" points="590.5,-269.57 600.09,-265.08 589.79,-262.61 590.5,-269.57"/>
</g>
<!-- attn_v_tp6 -->
<g id="node47" class="node">
<title>attn_v_tp6</title>
<polygon fill="lightblue" stroke="black" points="770.5,-218 600.5,-218 600.5,-177 770.5,-177 770.5,-218"/>
<text text-anchor="middle" x="685.5" y="-206" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-195" font-family="Times,serif" font-size="10.00">TP6</text>
<text text-anchor="middle" x="685.5" y="-184" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_6&#45;&gt;attn_v_tp6 -->
<g id="edge82" class="edge">
<title>tp_split_6&#45;&gt;attn_v_tp6</title>
<path fill="none" stroke="black" d="M488.79,-256.49C527.05,-244.96 570.14,-231.97 606.13,-221.12"/>
<polygon fill="black" stroke="black" points="607.52,-224.36 616.08,-218.12 605.5,-217.66 607.52,-224.36"/>
</g>
<!-- attn_q_tp6&#45;&gt;expert_gate -->
<g id="edge83" class="edge">
<title>attn_q_tp6&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M756.47,-336.01C761.46,-338.8 766.2,-341.94 770.5,-345.5 875.16,-432.17 939.03,-586.36 964.64,-658.81"/>
<polygon fill="black" stroke="black" points="961.41,-660.18 968,-668.48 968.02,-657.88 961.41,-660.18"/>
</g>
<!-- attn_k_tp6&#45;&gt;expert_gate -->
<g id="edge84" class="edge">
<title>attn_k_tp6&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M757.55,-277.18C762.17,-279.92 766.55,-283.01 770.5,-286.5 888.11,-390.5 947.06,-576.94 968.21,-658.48"/>
<polygon fill="black" stroke="black" points="964.86,-659.52 970.72,-668.35 971.65,-657.8 964.86,-659.52"/>
</g>
<!-- attn_v_tp6&#45;&gt;expert_gate -->
<g id="edge85" class="edge">
<title>attn_v_tp6&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M758.16,-218.21C762.58,-220.93 766.76,-224.02 770.5,-227.5 901.29,-349.3 954.14,-568.41 970.99,-658.33"/>
<polygon fill="black" stroke="black" points="967.59,-659.18 972.83,-668.39 974.47,-657.92 967.59,-659.18"/>
</g>
<!-- attn_out_tp6 -->
<g id="node48" class="node">
<title>attn_out_tp6</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-572 1186.7,-572 1186.7,-531 1356.7,-531 1356.7,-572"/>
<text text-anchor="middle" x="1271.7" y="-560" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-549" font-family="Times,serif" font-size="10.00">TP6</text>
<text text-anchor="middle" x="1271.7" y="-538" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp6&#45;&gt;allreduce_attn -->
<g id="edge87" class="edge">
<title>attn_out_tp6&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1336.39,-572.01C1343.37,-574.92 1350.27,-578.09 1356.7,-581.5 1400.13,-604.55 1444.86,-638.43 1475.85,-663.8"/>
<polygon fill="black" stroke="black" points="1473.88,-666.71 1483.82,-670.39 1478.34,-661.32 1473.88,-666.71"/>
</g>
<!-- mlp_fc1_tp6 -->
<g id="node49" class="node">
<title>mlp_fc1_tp6</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-572 1677.6,-572 1677.6,-531 1824.6,-531 1824.6,-572"/>
<text text-anchor="middle" x="1751.1" y="-560" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-549" font-family="Times,serif" font-size="10.00">TP6</text>
<text text-anchor="middle" x="1751.1" y="-538" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp6 -->
<g id="node50" class="node">
<title>mlp_fc2_tp6</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-572 1860.6,-572 1860.6,-531 2030.6,-531 2030.6,-572"/>
<text text-anchor="middle" x="1945.6" y="-560" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-549" font-family="Times,serif" font-size="10.00">TP6</text>
<text text-anchor="middle" x="1945.6" y="-538" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp6&#45;&gt;mlp_fc2_tp6 -->
<g id="edge89" class="edge">
<title>mlp_fc1_tp6&#45;&gt;mlp_fc2_tp6</title>
<path fill="none" stroke="black" d="M1824.6,-551.5C1833.03,-551.5 1841.71,-551.5 1850.38,-551.5"/>
<polygon fill="black" stroke="black" points="1850.52,-555 1860.52,-551.5 1850.52,-548 1850.52,-555"/>
</g>
<!-- mlp_fc2_tp6&#45;&gt;allreduce_mlp -->
<g id="edge90" class="edge">
<title>mlp_fc2_tp6&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2010.29,-572.01C2017.27,-574.92 2024.17,-578.09 2030.6,-581.5 2074.03,-604.55 2118.77,-638.43 2149.76,-663.8"/>
<polygon fill="black" stroke="black" points="2147.79,-666.71 2157.72,-670.39 2152.25,-661.32 2147.79,-666.71"/>
</g>
<!-- attn_q_tp7 -->
<g id="node52" class="node">
<title>attn_q_tp7</title>
<polygon fill="lightblue" stroke="black" points="770.5,-159 600.5,-159 600.5,-118 770.5,-118 770.5,-159"/>
<text text-anchor="middle" x="685.5" y="-147" font-family="Times,serif" font-size="10.00">Query</text>
<text text-anchor="middle" x="685.5" y="-136" font-family="Times,serif" font-size="10.00">TP7</text>
<text text-anchor="middle" x="685.5" y="-125" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_7&#45;&gt;attn_q_tp7 -->
<g id="edge93" class="edge">
<title>tp_split_7&#45;&gt;attn_q_tp7</title>
<path fill="none" stroke="black" d="M547.68,-125.06C562.17,-126.49 576.53,-127.9 590.19,-129.24"/>
<polygon fill="black" stroke="black" points="590.19,-132.75 600.48,-130.25 590.87,-125.79 590.19,-132.75"/>
</g>
<!-- attn_k_tp7 -->
<g id="node53" class="node">
<title>attn_k_tp7</title>
<polygon fill="lightblue" stroke="black" points="770.5,-100 600.5,-100 600.5,-59 770.5,-59 770.5,-100"/>
<text text-anchor="middle" x="685.5" y="-88" font-family="Times,serif" font-size="10.00">Key</text>
<text text-anchor="middle" x="685.5" y="-77" font-family="Times,serif" font-size="10.00">TP7</text>
<text text-anchor="middle" x="685.5" y="-66" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_7&#45;&gt;attn_k_tp7 -->
<g id="edge94" class="edge">
<title>tp_split_7&#45;&gt;attn_k_tp7</title>
<path fill="none" stroke="black" d="M513.6,-96.86C539.11,-94.27 565.58,-91.58 589.84,-89.12"/>
<polygon fill="black" stroke="black" points="590.5,-92.57 600.09,-88.08 589.79,-85.61 590.5,-92.57"/>
</g>
<!-- attn_v_tp7 -->
<g id="node54" class="node">
<title>attn_v_tp7</title>
<polygon fill="lightblue" stroke="black" points="770.5,-41 600.5,-41 600.5,0 770.5,0 770.5,-41"/>
<text text-anchor="middle" x="685.5" y="-29" font-family="Times,serif" font-size="10.00">Value</text>
<text text-anchor="middle" x="685.5" y="-18" font-family="Times,serif" font-size="10.00">TP7</text>
<text text-anchor="middle" x="685.5" y="-7" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- tp_split_7&#45;&gt;attn_v_tp7 -->
<g id="edge95" class="edge">
<title>tp_split_7&#45;&gt;attn_v_tp7</title>
<path fill="none" stroke="black" d="M488.79,-79.49C527.05,-67.96 570.14,-54.97 606.13,-44.12"/>
<polygon fill="black" stroke="black" points="607.52,-47.36 616.08,-41.12 605.5,-40.66 607.52,-47.36"/>
</g>
<!-- attn_q_tp7&#45;&gt;expert_gate -->
<g id="edge96" class="edge">
<title>attn_q_tp7&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M758.32,-159.03C762.71,-161.8 766.83,-164.94 770.5,-168.5 914.62,-308.43 960.45,-560.45 973.21,-658.21"/>
<polygon fill="black" stroke="black" points="969.75,-658.79 974.47,-668.27 976.7,-657.91 969.75,-658.79"/>
</g>
<!-- attn_k_tp7&#45;&gt;expert_gate -->
<g id="edge97" class="edge">
<title>attn_k_tp7&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M758.86,-100.14C763.07,-102.88 767,-105.99 770.5,-109.5 928.13,-267.91 966.19,-553.19 975.03,-658.24"/>
<polygon fill="black" stroke="black" points="971.56,-658.73 975.84,-668.42 978.53,-658.17 971.56,-658.73"/>
</g>
<!-- attn_v_tp7&#45;&gt;expert_gate -->
<g id="edge98" class="edge">
<title>attn_v_tp7&#45;&gt;expert_gate</title>
<path fill="none" stroke="black" d="M758.98,-41.03C763.16,-43.8 767.05,-46.94 770.5,-50.5 941.68,-227.55 971.4,-546.11 976.53,-658.17"/>
<polygon fill="black" stroke="black" points="973.04,-658.52 976.96,-668.36 980.04,-658.23 973.04,-658.52"/>
</g>
<!-- attn_out_tp7 -->
<g id="node55" class="node">
<title>attn_out_tp7</title>
<polygon fill="lightblue" stroke="black" points="1356.7,-513 1186.7,-513 1186.7,-472 1356.7,-472 1356.7,-513"/>
<text text-anchor="middle" x="1271.7" y="-501" font-family="Times,serif" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1271.7" y="-490" font-family="Times,serif" font-size="10.00">TP7</text>
<text text-anchor="middle" x="1271.7" y="-479" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- attn_out_tp7&#45;&gt;allreduce_attn -->
<g id="edge100" class="edge">
<title>attn_out_tp7&#45;&gt;allreduce_attn</title>
<path fill="none" stroke="black" d="M1340.19,-513.18C1345.96,-515.96 1351.55,-519.06 1356.7,-522.5 1412.96,-560.08 1462.61,-621.79 1491,-661.26"/>
<polygon fill="black" stroke="black" points="1488.43,-663.69 1497.08,-669.82 1494.14,-659.64 1488.43,-663.69"/>
</g>
<!-- mlp_fc1_tp7 -->
<g id="node56" class="node">
<title>mlp_fc1_tp7</title>
<polygon fill="lightblue" stroke="black" points="1824.6,-513 1677.6,-513 1677.6,-472 1824.6,-472 1824.6,-513"/>
<text text-anchor="middle" x="1751.1" y="-501" font-family="Times,serif" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="1751.1" y="-490" font-family="Times,serif" font-size="10.00">TP7</text>
<text text-anchor="middle" x="1751.1" y="-479" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, ffn=512]</text>
</g>
<!-- mlp_fc2_tp7 -->
<g id="node57" class="node">
<title>mlp_fc2_tp7</title>
<polygon fill="lightblue" stroke="black" points="2030.6,-513 1860.6,-513 1860.6,-472 2030.6,-472 2030.6,-513"/>
<text text-anchor="middle" x="1945.6" y="-501" font-family="Times,serif" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="1945.6" y="-490" font-family="Times,serif" font-size="10.00">TP7</text>
<text text-anchor="middle" x="1945.6" y="-479" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=128]</text>
</g>
<!-- mlp_fc1_tp7&#45;&gt;mlp_fc2_tp7 -->
<g id="edge102" class="edge">
<title>mlp_fc1_tp7&#45;&gt;mlp_fc2_tp7</title>
<path fill="none" stroke="black" d="M1824.6,-492.5C1833.03,-492.5 1841.71,-492.5 1850.38,-492.5"/>
<polygon fill="black" stroke="black" points="1850.52,-496 1860.52,-492.5 1850.52,-489 1850.52,-496"/>
</g>
<!-- mlp_fc2_tp7&#45;&gt;allreduce_mlp -->
<g id="edge103" class="edge">
<title>mlp_fc2_tp7&#45;&gt;allreduce_mlp</title>
<path fill="none" stroke="black" d="M2014.09,-513.18C2019.86,-515.96 2025.45,-519.06 2030.6,-522.5 2086.86,-560.08 2136.51,-621.79 2164.91,-661.26"/>
<polygon fill="black" stroke="black" points="2162.33,-663.69 2170.98,-669.82 2168.04,-659.64 2162.33,-663.69"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp0 -->
<g id="edge8" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp0</title>
<path fill="none" stroke="black" d="M1007.39,-728.61C1044.79,-767.57 1114.95,-835.31 1186.7,-876.5 1189.21,-877.94 1191.8,-879.33 1194.45,-880.66"/>
<polygon fill="black" stroke="black" points="1193.1,-883.89 1203.64,-884.97 1196.07,-877.55 1193.1,-883.89"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp1 -->
<g id="edge21" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp1</title>
<path fill="none" stroke="black" d="M1025.96,-728.54C1067.07,-754.34 1129.33,-791.4 1186.7,-817.5 1190.23,-819.11 1193.88,-820.68 1197.59,-822.21"/>
<polygon fill="black" stroke="black" points="1196.31,-825.47 1206.9,-825.91 1198.9,-818.96 1196.31,-825.47"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp2 -->
<g id="edge34" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp2</title>
<path fill="none" stroke="black" d="M1077.74,-728.51C1115.46,-740.04 1157.95,-753.03 1193.43,-763.88"/>
<polygon fill="black" stroke="black" points="1192.66,-767.3 1203.25,-766.88 1194.71,-760.61 1192.66,-767.3"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp3 -->
<g id="edge47" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp3</title>
<path fill="none" stroke="black" d="M1134.52,-714.47C1148.81,-715.94 1162.97,-717.4 1176.45,-718.79"/>
<polygon fill="black" stroke="black" points="1176.32,-722.29 1186.63,-719.84 1177.04,-715.33 1176.32,-722.29"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp4 -->
<g id="edge60" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp4</title>
<path fill="none" stroke="black" d="M1101.36,-686.37C1126.45,-683.87 1152.5,-681.28 1176.43,-678.89"/>
<polygon fill="black" stroke="black" points="1176.94,-682.36 1186.55,-677.88 1176.25,-675.39 1176.94,-682.36"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp5 -->
<g id="edge73" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp5</title>
<path fill="none" stroke="black" d="M1078.96,-668.46C1116.15,-657.22 1157.82,-644.62 1192.8,-634.05"/>
<polygon fill="black" stroke="black" points="1193.91,-637.37 1202.47,-631.12 1191.89,-630.67 1193.91,-637.37"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp6 -->
<g id="edge86" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp6</title>
<path fill="none" stroke="black" d="M1027.32,-668.43C1068.53,-643.23 1130.17,-607.33 1186.7,-581.5 1190.96,-579.55 1195.39,-577.64 1199.89,-575.79"/>
<polygon fill="black" stroke="black" points="1201.2,-579.04 1209.19,-572.09 1198.6,-572.54 1201.2,-579.04"/>
</g>
<!-- expert_gate&#45;&gt;attn_out_tp7 -->
<g id="edge99" class="edge">
<title>expert_gate&#45;&gt;attn_out_tp7</title>
<path fill="none" stroke="black" d="M1008.17,-668.2C1045.88,-629.73 1115.8,-563.44 1186.7,-522.5 1189.74,-520.74 1192.9,-519.06 1196.14,-517.46"/>
<polygon fill="black" stroke="black" points="1197.84,-520.53 1205.43,-513.14 1194.89,-514.18 1197.84,-520.53"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp0 -->
<g id="edge10" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp0</title>
<path fill="none" stroke="black" d="M1537.37,-727.19C1564.54,-765.82 1617.6,-834.53 1677.6,-876.5 1679.22,-877.64 1680.9,-878.74 1682.62,-879.8"/>
<polygon fill="black" stroke="black" points="1681.05,-882.94 1691.47,-884.85 1684.51,-876.86 1681.05,-882.94"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp1 -->
<g id="edge23" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp1</title>
<path fill="none" stroke="black" d="M1550.32,-726.48C1581.35,-752.48 1630.44,-791.07 1677.6,-817.5 1680.09,-818.9 1682.67,-820.26 1685.3,-821.59"/>
<polygon fill="black" stroke="black" points="1683.85,-824.78 1694.38,-825.95 1686.88,-818.47 1683.85,-824.78"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp2 -->
<g id="edge36" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp2</title>
<path fill="none" stroke="black" d="M1582.76,-723.29C1615.34,-735.79 1654.69,-750.89 1687.04,-763.3"/>
<polygon fill="black" stroke="black" points="1685.81,-766.58 1696.41,-766.9 1688.32,-760.05 1685.81,-766.58"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp3 -->
<g id="edge49" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp3</title>
<path fill="none" stroke="black" d="M1626.31,-712.49C1640.15,-714.28 1654.13,-716.09 1667.47,-717.81"/>
<polygon fill="black" stroke="black" points="1667.17,-721.3 1677.54,-719.11 1668.07,-714.36 1667.17,-721.3"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp4 -->
<g id="edge62" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp4</title>
<path fill="none" stroke="black" d="M1627.33,-684.85C1640.78,-683.17 1654.34,-681.47 1667.3,-679.85"/>
<polygon fill="black" stroke="black" points="1668.07,-683.28 1677.56,-678.57 1667.2,-676.34 1668.07,-683.28"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp5 -->
<g id="edge75" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp5</title>
<path fill="none" stroke="black" d="M1583.07,-673.87C1615.25,-661.66 1654,-646.96 1686.06,-634.8"/>
<polygon fill="black" stroke="black" points="1687.68,-637.93 1695.78,-631.11 1685.19,-631.38 1687.68,-637.93"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp6 -->
<g id="edge88" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp6</title>
<path fill="none" stroke="black" d="M1551.37,-670.43C1582.55,-644.99 1631.22,-607.61 1677.6,-581.5 1680.66,-579.78 1683.84,-578.1 1687.08,-576.47"/>
<polygon fill="black" stroke="black" points="1688.84,-579.51 1696.35,-572.02 1685.82,-573.19 1688.84,-579.51"/>
</g>
<!-- allreduce_attn&#45;&gt;mlp_fc1_tp7 -->
<g id="edge101" class="edge">
<title>allreduce_attn&#45;&gt;mlp_fc1_tp7</title>
<path fill="none" stroke="black" d="M1537.98,-669.59C1565.45,-631.42 1618.44,-564.16 1677.6,-522.5 1679.74,-520.99 1681.98,-519.54 1684.27,-518.14"/>
<polygon fill="black" stroke="black" points="1686.36,-520.99 1693.37,-513.05 1682.94,-514.88 1686.36,-520.99"/>
</g>
<!-- layer_output -->
<g id="node61" class="node">
<title>layer_output</title>
<polygon fill="lightblue" stroke="black" points="2527.5,-716.5 2351.5,-716.5 2351.5,-680.5 2527.5,-680.5 2527.5,-716.5"/>
<text text-anchor="middle" x="2439.5" y="-701.5" font-family="Times,serif" font-size="10.00">Layer Output</text>
<text text-anchor="middle" x="2439.5" y="-690.5" font-family="Times,serif" font-size="10.00">[batch=?, seq=?, hidden=1024]</text>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge13" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2214.36,-669.94C2263.47,-643.81 2379.98,-645.08 2422.56,-673.74"/>
<polygon fill="black" stroke="black" points="2420.53,-676.6 2430.47,-680.27 2424.99,-671.2 2420.53,-676.6"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge26" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2237.83,-671.56C2289.27,-660.99 2370.99,-662.72 2412.48,-676.77"/>
<polygon fill="black" stroke="black" points="2411.3,-680.06 2421.89,-680.49 2413.88,-673.56 2411.3,-680.06"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge39" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2282.77,-678.89C2309.67,-677.81 2338.79,-678.1 2364.5,-679.76"/>
<polygon fill="black" stroke="black" points="2364.31,-683.26 2374.54,-680.49 2364.82,-676.27 2364.31,-683.26"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge52" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2312.39,-691.75C2321.99,-691.74 2331.61,-691.78 2341.03,-691.88"/>
<polygon fill="black" stroke="black" points="2341.11,-695.38 2351.15,-692.01 2341.2,-688.38 2341.11,-695.38"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge65" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2312.39,-705.25C2321.99,-705.26 2331.61,-705.22 2341.03,-705.12"/>
<polygon fill="black" stroke="black" points="2341.2,-708.62 2351.15,-704.99 2341.11,-701.62 2341.2,-708.62"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge78" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2282.77,-718.11C2309.67,-719.19 2338.79,-718.9 2364.5,-717.24"/>
<polygon fill="black" stroke="black" points="2364.82,-720.73 2374.54,-716.51 2364.31,-713.74 2364.82,-720.73"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge91" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2237.83,-725.44C2289.27,-736.01 2370.99,-734.28 2412.48,-720.23"/>
<polygon fill="black" stroke="black" points="2413.88,-723.44 2421.89,-716.51 2411.3,-716.94 2413.88,-723.44"/>
</g>
<!-- allreduce_mlp&#45;&gt;layer_output -->
<g id="edge104" class="edge">
<title>allreduce_mlp&#45;&gt;layer_output</title>
<path fill="none" stroke="black" d="M2214.36,-727.06C2263.47,-753.19 2379.98,-751.92 2422.56,-723.26"/>
<polygon fill="black" stroke="black" points="2424.99,-725.8 2430.47,-716.73 2420.53,-720.4 2424.99,-725.8"/>
</g>
</g>
</svg>
