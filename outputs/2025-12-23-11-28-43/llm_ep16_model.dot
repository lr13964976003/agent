digraph G {
rankdir=TB;
node [fontsize=10];
// Styles
compute [shape=rectangle, style=filled, fillcolor=lightblue];
comm    [shape=ellipse,      style=filled, fillcolor=yellow];
router  [shape=parallelogram, style=filled, fillcolor=lightgreen];

input [label="INPUT\n[B=128, S=128, H=1024]",shape=octagon,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
input -> L0_qkv;
L0_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_qkv -> L0_attn;
L0_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_attn -> L0_outproj;
L0_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_outproj -> L0_gate;
L0_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_split;
L0_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert0 [style=dashed];
L0_split -> L0_expert0;
L0_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert1 [style=dashed];
L0_split -> L0_expert1;
L0_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert2 [style=dashed];
L0_split -> L0_expert2;
L0_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert3 [style=dashed];
L0_split -> L0_expert3;
L0_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert4 [style=dashed];
L0_split -> L0_expert4;
L0_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert5 [style=dashed];
L0_split -> L0_expert5;
L0_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert6 [style=dashed];
L0_split -> L0_expert6;
L0_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert7 [style=dashed];
L0_split -> L0_expert7;
L0_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert8 [style=dashed];
L0_split -> L0_expert8;
L0_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert9 [style=dashed];
L0_split -> L0_expert9;
L0_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert10 [style=dashed];
L0_split -> L0_expert10;
L0_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert11 [style=dashed];
L0_split -> L0_expert11;
L0_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert12 [style=dashed];
L0_split -> L0_expert12;
L0_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert13 [style=dashed];
L0_split -> L0_expert13;
L0_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert14 [style=dashed];
L0_split -> L0_expert14;
L0_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert15 [style=dashed];
L0_split -> L0_expert15;
L0_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert16 [style=dashed];
L0_split -> L0_expert16;
L0_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert17 [style=dashed];
L0_split -> L0_expert17;
L0_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert18 [style=dashed];
L0_split -> L0_expert18;
L0_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert19 [style=dashed];
L0_split -> L0_expert19;
L0_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert20 [style=dashed];
L0_split -> L0_expert20;
L0_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert21 [style=dashed];
L0_split -> L0_expert21;
L0_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert22 [style=dashed];
L0_split -> L0_expert22;
L0_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert23 [style=dashed];
L0_split -> L0_expert23;
L0_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert24 [style=dashed];
L0_split -> L0_expert24;
L0_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert25 [style=dashed];
L0_split -> L0_expert25;
L0_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert26 [style=dashed];
L0_split -> L0_expert26;
L0_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert27 [style=dashed];
L0_split -> L0_expert27;
L0_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert28 [style=dashed];
L0_split -> L0_expert28;
L0_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert29 [style=dashed];
L0_split -> L0_expert29;
L0_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert30 [style=dashed];
L0_split -> L0_expert30;
L0_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert31 [style=dashed];
L0_split -> L0_expert31;
L0_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert32 [style=dashed];
L0_split -> L0_expert32;
L0_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert33 [style=dashed];
L0_split -> L0_expert33;
L0_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert34 [style=dashed];
L0_split -> L0_expert34;
L0_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert35 [style=dashed];
L0_split -> L0_expert35;
L0_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert36 [style=dashed];
L0_split -> L0_expert36;
L0_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert37 [style=dashed];
L0_split -> L0_expert37;
L0_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert38 [style=dashed];
L0_split -> L0_expert38;
L0_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert39 [style=dashed];
L0_split -> L0_expert39;
L0_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert40 [style=dashed];
L0_split -> L0_expert40;
L0_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert41 [style=dashed];
L0_split -> L0_expert41;
L0_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert42 [style=dashed];
L0_split -> L0_expert42;
L0_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert43 [style=dashed];
L0_split -> L0_expert43;
L0_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert44 [style=dashed];
L0_split -> L0_expert44;
L0_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert45 [style=dashed];
L0_split -> L0_expert45;
L0_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert46 [style=dashed];
L0_split -> L0_expert46;
L0_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert47 [style=dashed];
L0_split -> L0_expert47;
L0_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert48 [style=dashed];
L0_split -> L0_expert48;
L0_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert49 [style=dashed];
L0_split -> L0_expert49;
L0_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert50 [style=dashed];
L0_split -> L0_expert50;
L0_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert51 [style=dashed];
L0_split -> L0_expert51;
L0_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert52 [style=dashed];
L0_split -> L0_expert52;
L0_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert53 [style=dashed];
L0_split -> L0_expert53;
L0_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert54 [style=dashed];
L0_split -> L0_expert54;
L0_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert55 [style=dashed];
L0_split -> L0_expert55;
L0_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert56 [style=dashed];
L0_split -> L0_expert56;
L0_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert57 [style=dashed];
L0_split -> L0_expert57;
L0_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert58 [style=dashed];
L0_split -> L0_expert58;
L0_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert59 [style=dashed];
L0_split -> L0_expert59;
L0_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert60 [style=dashed];
L0_split -> L0_expert60;
L0_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert61 [style=dashed];
L0_split -> L0_expert61;
L0_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert62 [style=dashed];
L0_split -> L0_expert62;
L0_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_gate -> L0_expert63 [style=dashed];
L0_split -> L0_expert63;
L0_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_expert0 -> L0_agg;
L0_expert1 -> L0_agg;
L0_expert2 -> L0_agg;
L0_expert3 -> L0_agg;
L0_expert4 -> L0_agg;
L0_expert5 -> L0_agg;
L0_expert6 -> L0_agg;
L0_expert7 -> L0_agg;
L0_expert8 -> L0_agg;
L0_expert9 -> L0_agg;
L0_expert10 -> L0_agg;
L0_expert11 -> L0_agg;
L0_expert12 -> L0_agg;
L0_expert13 -> L0_agg;
L0_expert14 -> L0_agg;
L0_expert15 -> L0_agg;
L0_expert16 -> L0_agg;
L0_expert17 -> L0_agg;
L0_expert18 -> L0_agg;
L0_expert19 -> L0_agg;
L0_expert20 -> L0_agg;
L0_expert21 -> L0_agg;
L0_expert22 -> L0_agg;
L0_expert23 -> L0_agg;
L0_expert24 -> L0_agg;
L0_expert25 -> L0_agg;
L0_expert26 -> L0_agg;
L0_expert27 -> L0_agg;
L0_expert28 -> L0_agg;
L0_expert29 -> L0_agg;
L0_expert30 -> L0_agg;
L0_expert31 -> L0_agg;
L0_expert32 -> L0_agg;
L0_expert33 -> L0_agg;
L0_expert34 -> L0_agg;
L0_expert35 -> L0_agg;
L0_expert36 -> L0_agg;
L0_expert37 -> L0_agg;
L0_expert38 -> L0_agg;
L0_expert39 -> L0_agg;
L0_expert40 -> L0_agg;
L0_expert41 -> L0_agg;
L0_expert42 -> L0_agg;
L0_expert43 -> L0_agg;
L0_expert44 -> L0_agg;
L0_expert45 -> L0_agg;
L0_expert46 -> L0_agg;
L0_expert47 -> L0_agg;
L0_expert48 -> L0_agg;
L0_expert49 -> L0_agg;
L0_expert50 -> L0_agg;
L0_expert51 -> L0_agg;
L0_expert52 -> L0_agg;
L0_expert53 -> L0_agg;
L0_expert54 -> L0_agg;
L0_expert55 -> L0_agg;
L0_expert56 -> L0_agg;
L0_expert57 -> L0_agg;
L0_expert58 -> L0_agg;
L0_expert59 -> L0_agg;
L0_expert60 -> L0_agg;
L0_expert61 -> L0_agg;
L0_expert62 -> L0_agg;
L0_expert63 -> L0_agg;
L0_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_agg -> L0_expert_ar;
L1_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L0_expert_ar -> L1_qkv;
L1_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_qkv -> L1_attn;
L1_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_attn -> L1_outproj;
L1_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_outproj -> L1_gate;
L1_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_split;
L1_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert0 [style=dashed];
L1_split -> L1_expert0;
L1_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert1 [style=dashed];
L1_split -> L1_expert1;
L1_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert2 [style=dashed];
L1_split -> L1_expert2;
L1_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert3 [style=dashed];
L1_split -> L1_expert3;
L1_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert4 [style=dashed];
L1_split -> L1_expert4;
L1_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert5 [style=dashed];
L1_split -> L1_expert5;
L1_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert6 [style=dashed];
L1_split -> L1_expert6;
L1_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert7 [style=dashed];
L1_split -> L1_expert7;
L1_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert8 [style=dashed];
L1_split -> L1_expert8;
L1_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert9 [style=dashed];
L1_split -> L1_expert9;
L1_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert10 [style=dashed];
L1_split -> L1_expert10;
L1_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert11 [style=dashed];
L1_split -> L1_expert11;
L1_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert12 [style=dashed];
L1_split -> L1_expert12;
L1_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert13 [style=dashed];
L1_split -> L1_expert13;
L1_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert14 [style=dashed];
L1_split -> L1_expert14;
L1_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert15 [style=dashed];
L1_split -> L1_expert15;
L1_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert16 [style=dashed];
L1_split -> L1_expert16;
L1_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert17 [style=dashed];
L1_split -> L1_expert17;
L1_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert18 [style=dashed];
L1_split -> L1_expert18;
L1_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert19 [style=dashed];
L1_split -> L1_expert19;
L1_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert20 [style=dashed];
L1_split -> L1_expert20;
L1_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert21 [style=dashed];
L1_split -> L1_expert21;
L1_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert22 [style=dashed];
L1_split -> L1_expert22;
L1_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert23 [style=dashed];
L1_split -> L1_expert23;
L1_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert24 [style=dashed];
L1_split -> L1_expert24;
L1_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert25 [style=dashed];
L1_split -> L1_expert25;
L1_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert26 [style=dashed];
L1_split -> L1_expert26;
L1_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert27 [style=dashed];
L1_split -> L1_expert27;
L1_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert28 [style=dashed];
L1_split -> L1_expert28;
L1_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert29 [style=dashed];
L1_split -> L1_expert29;
L1_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert30 [style=dashed];
L1_split -> L1_expert30;
L1_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert31 [style=dashed];
L1_split -> L1_expert31;
L1_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert32 [style=dashed];
L1_split -> L1_expert32;
L1_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert33 [style=dashed];
L1_split -> L1_expert33;
L1_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert34 [style=dashed];
L1_split -> L1_expert34;
L1_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert35 [style=dashed];
L1_split -> L1_expert35;
L1_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert36 [style=dashed];
L1_split -> L1_expert36;
L1_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert37 [style=dashed];
L1_split -> L1_expert37;
L1_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert38 [style=dashed];
L1_split -> L1_expert38;
L1_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert39 [style=dashed];
L1_split -> L1_expert39;
L1_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert40 [style=dashed];
L1_split -> L1_expert40;
L1_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert41 [style=dashed];
L1_split -> L1_expert41;
L1_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert42 [style=dashed];
L1_split -> L1_expert42;
L1_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert43 [style=dashed];
L1_split -> L1_expert43;
L1_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert44 [style=dashed];
L1_split -> L1_expert44;
L1_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert45 [style=dashed];
L1_split -> L1_expert45;
L1_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert46 [style=dashed];
L1_split -> L1_expert46;
L1_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert47 [style=dashed];
L1_split -> L1_expert47;
L1_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert48 [style=dashed];
L1_split -> L1_expert48;
L1_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert49 [style=dashed];
L1_split -> L1_expert49;
L1_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert50 [style=dashed];
L1_split -> L1_expert50;
L1_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert51 [style=dashed];
L1_split -> L1_expert51;
L1_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert52 [style=dashed];
L1_split -> L1_expert52;
L1_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert53 [style=dashed];
L1_split -> L1_expert53;
L1_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert54 [style=dashed];
L1_split -> L1_expert54;
L1_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert55 [style=dashed];
L1_split -> L1_expert55;
L1_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert56 [style=dashed];
L1_split -> L1_expert56;
L1_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert57 [style=dashed];
L1_split -> L1_expert57;
L1_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert58 [style=dashed];
L1_split -> L1_expert58;
L1_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert59 [style=dashed];
L1_split -> L1_expert59;
L1_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert60 [style=dashed];
L1_split -> L1_expert60;
L1_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert61 [style=dashed];
L1_split -> L1_expert61;
L1_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert62 [style=dashed];
L1_split -> L1_expert62;
L1_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_gate -> L1_expert63 [style=dashed];
L1_split -> L1_expert63;
L1_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_expert0 -> L1_agg;
L1_expert1 -> L1_agg;
L1_expert2 -> L1_agg;
L1_expert3 -> L1_agg;
L1_expert4 -> L1_agg;
L1_expert5 -> L1_agg;
L1_expert6 -> L1_agg;
L1_expert7 -> L1_agg;
L1_expert8 -> L1_agg;
L1_expert9 -> L1_agg;
L1_expert10 -> L1_agg;
L1_expert11 -> L1_agg;
L1_expert12 -> L1_agg;
L1_expert13 -> L1_agg;
L1_expert14 -> L1_agg;
L1_expert15 -> L1_agg;
L1_expert16 -> L1_agg;
L1_expert17 -> L1_agg;
L1_expert18 -> L1_agg;
L1_expert19 -> L1_agg;
L1_expert20 -> L1_agg;
L1_expert21 -> L1_agg;
L1_expert22 -> L1_agg;
L1_expert23 -> L1_agg;
L1_expert24 -> L1_agg;
L1_expert25 -> L1_agg;
L1_expert26 -> L1_agg;
L1_expert27 -> L1_agg;
L1_expert28 -> L1_agg;
L1_expert29 -> L1_agg;
L1_expert30 -> L1_agg;
L1_expert31 -> L1_agg;
L1_expert32 -> L1_agg;
L1_expert33 -> L1_agg;
L1_expert34 -> L1_agg;
L1_expert35 -> L1_agg;
L1_expert36 -> L1_agg;
L1_expert37 -> L1_agg;
L1_expert38 -> L1_agg;
L1_expert39 -> L1_agg;
L1_expert40 -> L1_agg;
L1_expert41 -> L1_agg;
L1_expert42 -> L1_agg;
L1_expert43 -> L1_agg;
L1_expert44 -> L1_agg;
L1_expert45 -> L1_agg;
L1_expert46 -> L1_agg;
L1_expert47 -> L1_agg;
L1_expert48 -> L1_agg;
L1_expert49 -> L1_agg;
L1_expert50 -> L1_agg;
L1_expert51 -> L1_agg;
L1_expert52 -> L1_agg;
L1_expert53 -> L1_agg;
L1_expert54 -> L1_agg;
L1_expert55 -> L1_agg;
L1_expert56 -> L1_agg;
L1_expert57 -> L1_agg;
L1_expert58 -> L1_agg;
L1_expert59 -> L1_agg;
L1_expert60 -> L1_agg;
L1_expert61 -> L1_agg;
L1_expert62 -> L1_agg;
L1_expert63 -> L1_agg;
L1_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_agg -> L1_expert_ar;
L2_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L1_expert_ar -> L2_qkv;
L2_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_qkv -> L2_attn;
L2_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_attn -> L2_outproj;
L2_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_outproj -> L2_gate;
L2_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_split;
L2_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert0 [style=dashed];
L2_split -> L2_expert0;
L2_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert1 [style=dashed];
L2_split -> L2_expert1;
L2_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert2 [style=dashed];
L2_split -> L2_expert2;
L2_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert3 [style=dashed];
L2_split -> L2_expert3;
L2_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert4 [style=dashed];
L2_split -> L2_expert4;
L2_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert5 [style=dashed];
L2_split -> L2_expert5;
L2_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert6 [style=dashed];
L2_split -> L2_expert6;
L2_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert7 [style=dashed];
L2_split -> L2_expert7;
L2_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert8 [style=dashed];
L2_split -> L2_expert8;
L2_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert9 [style=dashed];
L2_split -> L2_expert9;
L2_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert10 [style=dashed];
L2_split -> L2_expert10;
L2_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert11 [style=dashed];
L2_split -> L2_expert11;
L2_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert12 [style=dashed];
L2_split -> L2_expert12;
L2_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert13 [style=dashed];
L2_split -> L2_expert13;
L2_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert14 [style=dashed];
L2_split -> L2_expert14;
L2_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert15 [style=dashed];
L2_split -> L2_expert15;
L2_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert16 [style=dashed];
L2_split -> L2_expert16;
L2_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert17 [style=dashed];
L2_split -> L2_expert17;
L2_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert18 [style=dashed];
L2_split -> L2_expert18;
L2_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert19 [style=dashed];
L2_split -> L2_expert19;
L2_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert20 [style=dashed];
L2_split -> L2_expert20;
L2_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert21 [style=dashed];
L2_split -> L2_expert21;
L2_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert22 [style=dashed];
L2_split -> L2_expert22;
L2_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert23 [style=dashed];
L2_split -> L2_expert23;
L2_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert24 [style=dashed];
L2_split -> L2_expert24;
L2_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert25 [style=dashed];
L2_split -> L2_expert25;
L2_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert26 [style=dashed];
L2_split -> L2_expert26;
L2_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert27 [style=dashed];
L2_split -> L2_expert27;
L2_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert28 [style=dashed];
L2_split -> L2_expert28;
L2_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert29 [style=dashed];
L2_split -> L2_expert29;
L2_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert30 [style=dashed];
L2_split -> L2_expert30;
L2_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert31 [style=dashed];
L2_split -> L2_expert31;
L2_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert32 [style=dashed];
L2_split -> L2_expert32;
L2_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert33 [style=dashed];
L2_split -> L2_expert33;
L2_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert34 [style=dashed];
L2_split -> L2_expert34;
L2_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert35 [style=dashed];
L2_split -> L2_expert35;
L2_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert36 [style=dashed];
L2_split -> L2_expert36;
L2_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert37 [style=dashed];
L2_split -> L2_expert37;
L2_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert38 [style=dashed];
L2_split -> L2_expert38;
L2_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert39 [style=dashed];
L2_split -> L2_expert39;
L2_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert40 [style=dashed];
L2_split -> L2_expert40;
L2_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert41 [style=dashed];
L2_split -> L2_expert41;
L2_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert42 [style=dashed];
L2_split -> L2_expert42;
L2_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert43 [style=dashed];
L2_split -> L2_expert43;
L2_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert44 [style=dashed];
L2_split -> L2_expert44;
L2_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert45 [style=dashed];
L2_split -> L2_expert45;
L2_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert46 [style=dashed];
L2_split -> L2_expert46;
L2_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert47 [style=dashed];
L2_split -> L2_expert47;
L2_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert48 [style=dashed];
L2_split -> L2_expert48;
L2_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert49 [style=dashed];
L2_split -> L2_expert49;
L2_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert50 [style=dashed];
L2_split -> L2_expert50;
L2_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert51 [style=dashed];
L2_split -> L2_expert51;
L2_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert52 [style=dashed];
L2_split -> L2_expert52;
L2_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert53 [style=dashed];
L2_split -> L2_expert53;
L2_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert54 [style=dashed];
L2_split -> L2_expert54;
L2_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert55 [style=dashed];
L2_split -> L2_expert55;
L2_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert56 [style=dashed];
L2_split -> L2_expert56;
L2_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert57 [style=dashed];
L2_split -> L2_expert57;
L2_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert58 [style=dashed];
L2_split -> L2_expert58;
L2_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert59 [style=dashed];
L2_split -> L2_expert59;
L2_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert60 [style=dashed];
L2_split -> L2_expert60;
L2_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert61 [style=dashed];
L2_split -> L2_expert61;
L2_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert62 [style=dashed];
L2_split -> L2_expert62;
L2_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_gate -> L2_expert63 [style=dashed];
L2_split -> L2_expert63;
L2_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_expert0 -> L2_agg;
L2_expert1 -> L2_agg;
L2_expert2 -> L2_agg;
L2_expert3 -> L2_agg;
L2_expert4 -> L2_agg;
L2_expert5 -> L2_agg;
L2_expert6 -> L2_agg;
L2_expert7 -> L2_agg;
L2_expert8 -> L2_agg;
L2_expert9 -> L2_agg;
L2_expert10 -> L2_agg;
L2_expert11 -> L2_agg;
L2_expert12 -> L2_agg;
L2_expert13 -> L2_agg;
L2_expert14 -> L2_agg;
L2_expert15 -> L2_agg;
L2_expert16 -> L2_agg;
L2_expert17 -> L2_agg;
L2_expert18 -> L2_agg;
L2_expert19 -> L2_agg;
L2_expert20 -> L2_agg;
L2_expert21 -> L2_agg;
L2_expert22 -> L2_agg;
L2_expert23 -> L2_agg;
L2_expert24 -> L2_agg;
L2_expert25 -> L2_agg;
L2_expert26 -> L2_agg;
L2_expert27 -> L2_agg;
L2_expert28 -> L2_agg;
L2_expert29 -> L2_agg;
L2_expert30 -> L2_agg;
L2_expert31 -> L2_agg;
L2_expert32 -> L2_agg;
L2_expert33 -> L2_agg;
L2_expert34 -> L2_agg;
L2_expert35 -> L2_agg;
L2_expert36 -> L2_agg;
L2_expert37 -> L2_agg;
L2_expert38 -> L2_agg;
L2_expert39 -> L2_agg;
L2_expert40 -> L2_agg;
L2_expert41 -> L2_agg;
L2_expert42 -> L2_agg;
L2_expert43 -> L2_agg;
L2_expert44 -> L2_agg;
L2_expert45 -> L2_agg;
L2_expert46 -> L2_agg;
L2_expert47 -> L2_agg;
L2_expert48 -> L2_agg;
L2_expert49 -> L2_agg;
L2_expert50 -> L2_agg;
L2_expert51 -> L2_agg;
L2_expert52 -> L2_agg;
L2_expert53 -> L2_agg;
L2_expert54 -> L2_agg;
L2_expert55 -> L2_agg;
L2_expert56 -> L2_agg;
L2_expert57 -> L2_agg;
L2_expert58 -> L2_agg;
L2_expert59 -> L2_agg;
L2_expert60 -> L2_agg;
L2_expert61 -> L2_agg;
L2_expert62 -> L2_agg;
L2_expert63 -> L2_agg;
L2_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_agg -> L2_expert_ar;
L3_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L2_expert_ar -> L3_qkv;
L3_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_qkv -> L3_attn;
L3_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_attn -> L3_outproj;
L3_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_outproj -> L3_gate;
L3_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_split;
L3_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert0 [style=dashed];
L3_split -> L3_expert0;
L3_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert1 [style=dashed];
L3_split -> L3_expert1;
L3_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert2 [style=dashed];
L3_split -> L3_expert2;
L3_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert3 [style=dashed];
L3_split -> L3_expert3;
L3_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert4 [style=dashed];
L3_split -> L3_expert4;
L3_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert5 [style=dashed];
L3_split -> L3_expert5;
L3_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert6 [style=dashed];
L3_split -> L3_expert6;
L3_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert7 [style=dashed];
L3_split -> L3_expert7;
L3_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert8 [style=dashed];
L3_split -> L3_expert8;
L3_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert9 [style=dashed];
L3_split -> L3_expert9;
L3_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert10 [style=dashed];
L3_split -> L3_expert10;
L3_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert11 [style=dashed];
L3_split -> L3_expert11;
L3_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert12 [style=dashed];
L3_split -> L3_expert12;
L3_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert13 [style=dashed];
L3_split -> L3_expert13;
L3_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert14 [style=dashed];
L3_split -> L3_expert14;
L3_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert15 [style=dashed];
L3_split -> L3_expert15;
L3_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert16 [style=dashed];
L3_split -> L3_expert16;
L3_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert17 [style=dashed];
L3_split -> L3_expert17;
L3_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert18 [style=dashed];
L3_split -> L3_expert18;
L3_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert19 [style=dashed];
L3_split -> L3_expert19;
L3_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert20 [style=dashed];
L3_split -> L3_expert20;
L3_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert21 [style=dashed];
L3_split -> L3_expert21;
L3_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert22 [style=dashed];
L3_split -> L3_expert22;
L3_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert23 [style=dashed];
L3_split -> L3_expert23;
L3_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert24 [style=dashed];
L3_split -> L3_expert24;
L3_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert25 [style=dashed];
L3_split -> L3_expert25;
L3_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert26 [style=dashed];
L3_split -> L3_expert26;
L3_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert27 [style=dashed];
L3_split -> L3_expert27;
L3_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert28 [style=dashed];
L3_split -> L3_expert28;
L3_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert29 [style=dashed];
L3_split -> L3_expert29;
L3_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert30 [style=dashed];
L3_split -> L3_expert30;
L3_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert31 [style=dashed];
L3_split -> L3_expert31;
L3_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert32 [style=dashed];
L3_split -> L3_expert32;
L3_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert33 [style=dashed];
L3_split -> L3_expert33;
L3_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert34 [style=dashed];
L3_split -> L3_expert34;
L3_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert35 [style=dashed];
L3_split -> L3_expert35;
L3_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert36 [style=dashed];
L3_split -> L3_expert36;
L3_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert37 [style=dashed];
L3_split -> L3_expert37;
L3_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert38 [style=dashed];
L3_split -> L3_expert38;
L3_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert39 [style=dashed];
L3_split -> L3_expert39;
L3_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert40 [style=dashed];
L3_split -> L3_expert40;
L3_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert41 [style=dashed];
L3_split -> L3_expert41;
L3_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert42 [style=dashed];
L3_split -> L3_expert42;
L3_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert43 [style=dashed];
L3_split -> L3_expert43;
L3_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert44 [style=dashed];
L3_split -> L3_expert44;
L3_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert45 [style=dashed];
L3_split -> L3_expert45;
L3_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert46 [style=dashed];
L3_split -> L3_expert46;
L3_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert47 [style=dashed];
L3_split -> L3_expert47;
L3_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert48 [style=dashed];
L3_split -> L3_expert48;
L3_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert49 [style=dashed];
L3_split -> L3_expert49;
L3_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert50 [style=dashed];
L3_split -> L3_expert50;
L3_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert51 [style=dashed];
L3_split -> L3_expert51;
L3_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert52 [style=dashed];
L3_split -> L3_expert52;
L3_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert53 [style=dashed];
L3_split -> L3_expert53;
L3_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert54 [style=dashed];
L3_split -> L3_expert54;
L3_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert55 [style=dashed];
L3_split -> L3_expert55;
L3_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert56 [style=dashed];
L3_split -> L3_expert56;
L3_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert57 [style=dashed];
L3_split -> L3_expert57;
L3_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert58 [style=dashed];
L3_split -> L3_expert58;
L3_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert59 [style=dashed];
L3_split -> L3_expert59;
L3_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert60 [style=dashed];
L3_split -> L3_expert60;
L3_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert61 [style=dashed];
L3_split -> L3_expert61;
L3_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert62 [style=dashed];
L3_split -> L3_expert62;
L3_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_gate -> L3_expert63 [style=dashed];
L3_split -> L3_expert63;
L3_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_expert0 -> L3_agg;
L3_expert1 -> L3_agg;
L3_expert2 -> L3_agg;
L3_expert3 -> L3_agg;
L3_expert4 -> L3_agg;
L3_expert5 -> L3_agg;
L3_expert6 -> L3_agg;
L3_expert7 -> L3_agg;
L3_expert8 -> L3_agg;
L3_expert9 -> L3_agg;
L3_expert10 -> L3_agg;
L3_expert11 -> L3_agg;
L3_expert12 -> L3_agg;
L3_expert13 -> L3_agg;
L3_expert14 -> L3_agg;
L3_expert15 -> L3_agg;
L3_expert16 -> L3_agg;
L3_expert17 -> L3_agg;
L3_expert18 -> L3_agg;
L3_expert19 -> L3_agg;
L3_expert20 -> L3_agg;
L3_expert21 -> L3_agg;
L3_expert22 -> L3_agg;
L3_expert23 -> L3_agg;
L3_expert24 -> L3_agg;
L3_expert25 -> L3_agg;
L3_expert26 -> L3_agg;
L3_expert27 -> L3_agg;
L3_expert28 -> L3_agg;
L3_expert29 -> L3_agg;
L3_expert30 -> L3_agg;
L3_expert31 -> L3_agg;
L3_expert32 -> L3_agg;
L3_expert33 -> L3_agg;
L3_expert34 -> L3_agg;
L3_expert35 -> L3_agg;
L3_expert36 -> L3_agg;
L3_expert37 -> L3_agg;
L3_expert38 -> L3_agg;
L3_expert39 -> L3_agg;
L3_expert40 -> L3_agg;
L3_expert41 -> L3_agg;
L3_expert42 -> L3_agg;
L3_expert43 -> L3_agg;
L3_expert44 -> L3_agg;
L3_expert45 -> L3_agg;
L3_expert46 -> L3_agg;
L3_expert47 -> L3_agg;
L3_expert48 -> L3_agg;
L3_expert49 -> L3_agg;
L3_expert50 -> L3_agg;
L3_expert51 -> L3_agg;
L3_expert52 -> L3_agg;
L3_expert53 -> L3_agg;
L3_expert54 -> L3_agg;
L3_expert55 -> L3_agg;
L3_expert56 -> L3_agg;
L3_expert57 -> L3_agg;
L3_expert58 -> L3_agg;
L3_expert59 -> L3_agg;
L3_expert60 -> L3_agg;
L3_expert61 -> L3_agg;
L3_expert62 -> L3_agg;
L3_expert63 -> L3_agg;
L3_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_agg -> L3_expert_ar;
L4_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L3_expert_ar -> L4_qkv;
L4_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_qkv -> L4_attn;
L4_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_attn -> L4_outproj;
L4_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_outproj -> L4_gate;
L4_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_split;
L4_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert0 [style=dashed];
L4_split -> L4_expert0;
L4_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert1 [style=dashed];
L4_split -> L4_expert1;
L4_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert2 [style=dashed];
L4_split -> L4_expert2;
L4_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert3 [style=dashed];
L4_split -> L4_expert3;
L4_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert4 [style=dashed];
L4_split -> L4_expert4;
L4_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert5 [style=dashed];
L4_split -> L4_expert5;
L4_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert6 [style=dashed];
L4_split -> L4_expert6;
L4_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert7 [style=dashed];
L4_split -> L4_expert7;
L4_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert8 [style=dashed];
L4_split -> L4_expert8;
L4_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert9 [style=dashed];
L4_split -> L4_expert9;
L4_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert10 [style=dashed];
L4_split -> L4_expert10;
L4_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert11 [style=dashed];
L4_split -> L4_expert11;
L4_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert12 [style=dashed];
L4_split -> L4_expert12;
L4_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert13 [style=dashed];
L4_split -> L4_expert13;
L4_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert14 [style=dashed];
L4_split -> L4_expert14;
L4_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert15 [style=dashed];
L4_split -> L4_expert15;
L4_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert16 [style=dashed];
L4_split -> L4_expert16;
L4_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert17 [style=dashed];
L4_split -> L4_expert17;
L4_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert18 [style=dashed];
L4_split -> L4_expert18;
L4_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert19 [style=dashed];
L4_split -> L4_expert19;
L4_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert20 [style=dashed];
L4_split -> L4_expert20;
L4_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert21 [style=dashed];
L4_split -> L4_expert21;
L4_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert22 [style=dashed];
L4_split -> L4_expert22;
L4_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert23 [style=dashed];
L4_split -> L4_expert23;
L4_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert24 [style=dashed];
L4_split -> L4_expert24;
L4_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert25 [style=dashed];
L4_split -> L4_expert25;
L4_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert26 [style=dashed];
L4_split -> L4_expert26;
L4_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert27 [style=dashed];
L4_split -> L4_expert27;
L4_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert28 [style=dashed];
L4_split -> L4_expert28;
L4_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert29 [style=dashed];
L4_split -> L4_expert29;
L4_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert30 [style=dashed];
L4_split -> L4_expert30;
L4_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert31 [style=dashed];
L4_split -> L4_expert31;
L4_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert32 [style=dashed];
L4_split -> L4_expert32;
L4_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert33 [style=dashed];
L4_split -> L4_expert33;
L4_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert34 [style=dashed];
L4_split -> L4_expert34;
L4_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert35 [style=dashed];
L4_split -> L4_expert35;
L4_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert36 [style=dashed];
L4_split -> L4_expert36;
L4_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert37 [style=dashed];
L4_split -> L4_expert37;
L4_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert38 [style=dashed];
L4_split -> L4_expert38;
L4_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert39 [style=dashed];
L4_split -> L4_expert39;
L4_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert40 [style=dashed];
L4_split -> L4_expert40;
L4_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert41 [style=dashed];
L4_split -> L4_expert41;
L4_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert42 [style=dashed];
L4_split -> L4_expert42;
L4_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert43 [style=dashed];
L4_split -> L4_expert43;
L4_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert44 [style=dashed];
L4_split -> L4_expert44;
L4_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert45 [style=dashed];
L4_split -> L4_expert45;
L4_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert46 [style=dashed];
L4_split -> L4_expert46;
L4_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert47 [style=dashed];
L4_split -> L4_expert47;
L4_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert48 [style=dashed];
L4_split -> L4_expert48;
L4_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert49 [style=dashed];
L4_split -> L4_expert49;
L4_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert50 [style=dashed];
L4_split -> L4_expert50;
L4_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert51 [style=dashed];
L4_split -> L4_expert51;
L4_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert52 [style=dashed];
L4_split -> L4_expert52;
L4_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert53 [style=dashed];
L4_split -> L4_expert53;
L4_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert54 [style=dashed];
L4_split -> L4_expert54;
L4_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert55 [style=dashed];
L4_split -> L4_expert55;
L4_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert56 [style=dashed];
L4_split -> L4_expert56;
L4_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert57 [style=dashed];
L4_split -> L4_expert57;
L4_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert58 [style=dashed];
L4_split -> L4_expert58;
L4_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert59 [style=dashed];
L4_split -> L4_expert59;
L4_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert60 [style=dashed];
L4_split -> L4_expert60;
L4_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert61 [style=dashed];
L4_split -> L4_expert61;
L4_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert62 [style=dashed];
L4_split -> L4_expert62;
L4_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_gate -> L4_expert63 [style=dashed];
L4_split -> L4_expert63;
L4_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_expert0 -> L4_agg;
L4_expert1 -> L4_agg;
L4_expert2 -> L4_agg;
L4_expert3 -> L4_agg;
L4_expert4 -> L4_agg;
L4_expert5 -> L4_agg;
L4_expert6 -> L4_agg;
L4_expert7 -> L4_agg;
L4_expert8 -> L4_agg;
L4_expert9 -> L4_agg;
L4_expert10 -> L4_agg;
L4_expert11 -> L4_agg;
L4_expert12 -> L4_agg;
L4_expert13 -> L4_agg;
L4_expert14 -> L4_agg;
L4_expert15 -> L4_agg;
L4_expert16 -> L4_agg;
L4_expert17 -> L4_agg;
L4_expert18 -> L4_agg;
L4_expert19 -> L4_agg;
L4_expert20 -> L4_agg;
L4_expert21 -> L4_agg;
L4_expert22 -> L4_agg;
L4_expert23 -> L4_agg;
L4_expert24 -> L4_agg;
L4_expert25 -> L4_agg;
L4_expert26 -> L4_agg;
L4_expert27 -> L4_agg;
L4_expert28 -> L4_agg;
L4_expert29 -> L4_agg;
L4_expert30 -> L4_agg;
L4_expert31 -> L4_agg;
L4_expert32 -> L4_agg;
L4_expert33 -> L4_agg;
L4_expert34 -> L4_agg;
L4_expert35 -> L4_agg;
L4_expert36 -> L4_agg;
L4_expert37 -> L4_agg;
L4_expert38 -> L4_agg;
L4_expert39 -> L4_agg;
L4_expert40 -> L4_agg;
L4_expert41 -> L4_agg;
L4_expert42 -> L4_agg;
L4_expert43 -> L4_agg;
L4_expert44 -> L4_agg;
L4_expert45 -> L4_agg;
L4_expert46 -> L4_agg;
L4_expert47 -> L4_agg;
L4_expert48 -> L4_agg;
L4_expert49 -> L4_agg;
L4_expert50 -> L4_agg;
L4_expert51 -> L4_agg;
L4_expert52 -> L4_agg;
L4_expert53 -> L4_agg;
L4_expert54 -> L4_agg;
L4_expert55 -> L4_agg;
L4_expert56 -> L4_agg;
L4_expert57 -> L4_agg;
L4_expert58 -> L4_agg;
L4_expert59 -> L4_agg;
L4_expert60 -> L4_agg;
L4_expert61 -> L4_agg;
L4_expert62 -> L4_agg;
L4_expert63 -> L4_agg;
L4_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_agg -> L4_expert_ar;
L5_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L4_expert_ar -> L5_qkv;
L5_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_qkv -> L5_attn;
L5_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_attn -> L5_outproj;
L5_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_outproj -> L5_gate;
L5_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_split;
L5_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert0 [style=dashed];
L5_split -> L5_expert0;
L5_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert1 [style=dashed];
L5_split -> L5_expert1;
L5_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert2 [style=dashed];
L5_split -> L5_expert2;
L5_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert3 [style=dashed];
L5_split -> L5_expert3;
L5_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert4 [style=dashed];
L5_split -> L5_expert4;
L5_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert5 [style=dashed];
L5_split -> L5_expert5;
L5_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert6 [style=dashed];
L5_split -> L5_expert6;
L5_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert7 [style=dashed];
L5_split -> L5_expert7;
L5_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert8 [style=dashed];
L5_split -> L5_expert8;
L5_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert9 [style=dashed];
L5_split -> L5_expert9;
L5_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert10 [style=dashed];
L5_split -> L5_expert10;
L5_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert11 [style=dashed];
L5_split -> L5_expert11;
L5_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert12 [style=dashed];
L5_split -> L5_expert12;
L5_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert13 [style=dashed];
L5_split -> L5_expert13;
L5_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert14 [style=dashed];
L5_split -> L5_expert14;
L5_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert15 [style=dashed];
L5_split -> L5_expert15;
L5_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert16 [style=dashed];
L5_split -> L5_expert16;
L5_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert17 [style=dashed];
L5_split -> L5_expert17;
L5_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert18 [style=dashed];
L5_split -> L5_expert18;
L5_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert19 [style=dashed];
L5_split -> L5_expert19;
L5_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert20 [style=dashed];
L5_split -> L5_expert20;
L5_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert21 [style=dashed];
L5_split -> L5_expert21;
L5_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert22 [style=dashed];
L5_split -> L5_expert22;
L5_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert23 [style=dashed];
L5_split -> L5_expert23;
L5_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert24 [style=dashed];
L5_split -> L5_expert24;
L5_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert25 [style=dashed];
L5_split -> L5_expert25;
L5_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert26 [style=dashed];
L5_split -> L5_expert26;
L5_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert27 [style=dashed];
L5_split -> L5_expert27;
L5_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert28 [style=dashed];
L5_split -> L5_expert28;
L5_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert29 [style=dashed];
L5_split -> L5_expert29;
L5_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert30 [style=dashed];
L5_split -> L5_expert30;
L5_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert31 [style=dashed];
L5_split -> L5_expert31;
L5_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert32 [style=dashed];
L5_split -> L5_expert32;
L5_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert33 [style=dashed];
L5_split -> L5_expert33;
L5_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert34 [style=dashed];
L5_split -> L5_expert34;
L5_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert35 [style=dashed];
L5_split -> L5_expert35;
L5_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert36 [style=dashed];
L5_split -> L5_expert36;
L5_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert37 [style=dashed];
L5_split -> L5_expert37;
L5_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert38 [style=dashed];
L5_split -> L5_expert38;
L5_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert39 [style=dashed];
L5_split -> L5_expert39;
L5_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert40 [style=dashed];
L5_split -> L5_expert40;
L5_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert41 [style=dashed];
L5_split -> L5_expert41;
L5_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert42 [style=dashed];
L5_split -> L5_expert42;
L5_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert43 [style=dashed];
L5_split -> L5_expert43;
L5_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert44 [style=dashed];
L5_split -> L5_expert44;
L5_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert45 [style=dashed];
L5_split -> L5_expert45;
L5_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert46 [style=dashed];
L5_split -> L5_expert46;
L5_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert47 [style=dashed];
L5_split -> L5_expert47;
L5_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert48 [style=dashed];
L5_split -> L5_expert48;
L5_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert49 [style=dashed];
L5_split -> L5_expert49;
L5_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert50 [style=dashed];
L5_split -> L5_expert50;
L5_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert51 [style=dashed];
L5_split -> L5_expert51;
L5_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert52 [style=dashed];
L5_split -> L5_expert52;
L5_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert53 [style=dashed];
L5_split -> L5_expert53;
L5_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert54 [style=dashed];
L5_split -> L5_expert54;
L5_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert55 [style=dashed];
L5_split -> L5_expert55;
L5_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert56 [style=dashed];
L5_split -> L5_expert56;
L5_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert57 [style=dashed];
L5_split -> L5_expert57;
L5_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert58 [style=dashed];
L5_split -> L5_expert58;
L5_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert59 [style=dashed];
L5_split -> L5_expert59;
L5_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert60 [style=dashed];
L5_split -> L5_expert60;
L5_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert61 [style=dashed];
L5_split -> L5_expert61;
L5_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert62 [style=dashed];
L5_split -> L5_expert62;
L5_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_gate -> L5_expert63 [style=dashed];
L5_split -> L5_expert63;
L5_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_expert0 -> L5_agg;
L5_expert1 -> L5_agg;
L5_expert2 -> L5_agg;
L5_expert3 -> L5_agg;
L5_expert4 -> L5_agg;
L5_expert5 -> L5_agg;
L5_expert6 -> L5_agg;
L5_expert7 -> L5_agg;
L5_expert8 -> L5_agg;
L5_expert9 -> L5_agg;
L5_expert10 -> L5_agg;
L5_expert11 -> L5_agg;
L5_expert12 -> L5_agg;
L5_expert13 -> L5_agg;
L5_expert14 -> L5_agg;
L5_expert15 -> L5_agg;
L5_expert16 -> L5_agg;
L5_expert17 -> L5_agg;
L5_expert18 -> L5_agg;
L5_expert19 -> L5_agg;
L5_expert20 -> L5_agg;
L5_expert21 -> L5_agg;
L5_expert22 -> L5_agg;
L5_expert23 -> L5_agg;
L5_expert24 -> L5_agg;
L5_expert25 -> L5_agg;
L5_expert26 -> L5_agg;
L5_expert27 -> L5_agg;
L5_expert28 -> L5_agg;
L5_expert29 -> L5_agg;
L5_expert30 -> L5_agg;
L5_expert31 -> L5_agg;
L5_expert32 -> L5_agg;
L5_expert33 -> L5_agg;
L5_expert34 -> L5_agg;
L5_expert35 -> L5_agg;
L5_expert36 -> L5_agg;
L5_expert37 -> L5_agg;
L5_expert38 -> L5_agg;
L5_expert39 -> L5_agg;
L5_expert40 -> L5_agg;
L5_expert41 -> L5_agg;
L5_expert42 -> L5_agg;
L5_expert43 -> L5_agg;
L5_expert44 -> L5_agg;
L5_expert45 -> L5_agg;
L5_expert46 -> L5_agg;
L5_expert47 -> L5_agg;
L5_expert48 -> L5_agg;
L5_expert49 -> L5_agg;
L5_expert50 -> L5_agg;
L5_expert51 -> L5_agg;
L5_expert52 -> L5_agg;
L5_expert53 -> L5_agg;
L5_expert54 -> L5_agg;
L5_expert55 -> L5_agg;
L5_expert56 -> L5_agg;
L5_expert57 -> L5_agg;
L5_expert58 -> L5_agg;
L5_expert59 -> L5_agg;
L5_expert60 -> L5_agg;
L5_expert61 -> L5_agg;
L5_expert62 -> L5_agg;
L5_expert63 -> L5_agg;
L5_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_agg -> L5_expert_ar;
L6_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L5_expert_ar -> L6_qkv;
L6_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_qkv -> L6_attn;
L6_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_attn -> L6_outproj;
L6_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_outproj -> L6_gate;
L6_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_split;
L6_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert0 [style=dashed];
L6_split -> L6_expert0;
L6_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert1 [style=dashed];
L6_split -> L6_expert1;
L6_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert2 [style=dashed];
L6_split -> L6_expert2;
L6_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert3 [style=dashed];
L6_split -> L6_expert3;
L6_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert4 [style=dashed];
L6_split -> L6_expert4;
L6_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert5 [style=dashed];
L6_split -> L6_expert5;
L6_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert6 [style=dashed];
L6_split -> L6_expert6;
L6_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert7 [style=dashed];
L6_split -> L6_expert7;
L6_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert8 [style=dashed];
L6_split -> L6_expert8;
L6_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert9 [style=dashed];
L6_split -> L6_expert9;
L6_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert10 [style=dashed];
L6_split -> L6_expert10;
L6_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert11 [style=dashed];
L6_split -> L6_expert11;
L6_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert12 [style=dashed];
L6_split -> L6_expert12;
L6_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert13 [style=dashed];
L6_split -> L6_expert13;
L6_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert14 [style=dashed];
L6_split -> L6_expert14;
L6_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert15 [style=dashed];
L6_split -> L6_expert15;
L6_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert16 [style=dashed];
L6_split -> L6_expert16;
L6_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert17 [style=dashed];
L6_split -> L6_expert17;
L6_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert18 [style=dashed];
L6_split -> L6_expert18;
L6_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert19 [style=dashed];
L6_split -> L6_expert19;
L6_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert20 [style=dashed];
L6_split -> L6_expert20;
L6_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert21 [style=dashed];
L6_split -> L6_expert21;
L6_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert22 [style=dashed];
L6_split -> L6_expert22;
L6_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert23 [style=dashed];
L6_split -> L6_expert23;
L6_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert24 [style=dashed];
L6_split -> L6_expert24;
L6_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert25 [style=dashed];
L6_split -> L6_expert25;
L6_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert26 [style=dashed];
L6_split -> L6_expert26;
L6_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert27 [style=dashed];
L6_split -> L6_expert27;
L6_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert28 [style=dashed];
L6_split -> L6_expert28;
L6_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert29 [style=dashed];
L6_split -> L6_expert29;
L6_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert30 [style=dashed];
L6_split -> L6_expert30;
L6_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert31 [style=dashed];
L6_split -> L6_expert31;
L6_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert32 [style=dashed];
L6_split -> L6_expert32;
L6_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert33 [style=dashed];
L6_split -> L6_expert33;
L6_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert34 [style=dashed];
L6_split -> L6_expert34;
L6_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert35 [style=dashed];
L6_split -> L6_expert35;
L6_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert36 [style=dashed];
L6_split -> L6_expert36;
L6_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert37 [style=dashed];
L6_split -> L6_expert37;
L6_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert38 [style=dashed];
L6_split -> L6_expert38;
L6_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert39 [style=dashed];
L6_split -> L6_expert39;
L6_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert40 [style=dashed];
L6_split -> L6_expert40;
L6_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert41 [style=dashed];
L6_split -> L6_expert41;
L6_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert42 [style=dashed];
L6_split -> L6_expert42;
L6_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert43 [style=dashed];
L6_split -> L6_expert43;
L6_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert44 [style=dashed];
L6_split -> L6_expert44;
L6_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert45 [style=dashed];
L6_split -> L6_expert45;
L6_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert46 [style=dashed];
L6_split -> L6_expert46;
L6_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert47 [style=dashed];
L6_split -> L6_expert47;
L6_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert48 [style=dashed];
L6_split -> L6_expert48;
L6_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert49 [style=dashed];
L6_split -> L6_expert49;
L6_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert50 [style=dashed];
L6_split -> L6_expert50;
L6_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert51 [style=dashed];
L6_split -> L6_expert51;
L6_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert52 [style=dashed];
L6_split -> L6_expert52;
L6_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert53 [style=dashed];
L6_split -> L6_expert53;
L6_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert54 [style=dashed];
L6_split -> L6_expert54;
L6_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert55 [style=dashed];
L6_split -> L6_expert55;
L6_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert56 [style=dashed];
L6_split -> L6_expert56;
L6_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert57 [style=dashed];
L6_split -> L6_expert57;
L6_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert58 [style=dashed];
L6_split -> L6_expert58;
L6_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert59 [style=dashed];
L6_split -> L6_expert59;
L6_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert60 [style=dashed];
L6_split -> L6_expert60;
L6_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert61 [style=dashed];
L6_split -> L6_expert61;
L6_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert62 [style=dashed];
L6_split -> L6_expert62;
L6_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_gate -> L6_expert63 [style=dashed];
L6_split -> L6_expert63;
L6_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_expert0 -> L6_agg;
L6_expert1 -> L6_agg;
L6_expert2 -> L6_agg;
L6_expert3 -> L6_agg;
L6_expert4 -> L6_agg;
L6_expert5 -> L6_agg;
L6_expert6 -> L6_agg;
L6_expert7 -> L6_agg;
L6_expert8 -> L6_agg;
L6_expert9 -> L6_agg;
L6_expert10 -> L6_agg;
L6_expert11 -> L6_agg;
L6_expert12 -> L6_agg;
L6_expert13 -> L6_agg;
L6_expert14 -> L6_agg;
L6_expert15 -> L6_agg;
L6_expert16 -> L6_agg;
L6_expert17 -> L6_agg;
L6_expert18 -> L6_agg;
L6_expert19 -> L6_agg;
L6_expert20 -> L6_agg;
L6_expert21 -> L6_agg;
L6_expert22 -> L6_agg;
L6_expert23 -> L6_agg;
L6_expert24 -> L6_agg;
L6_expert25 -> L6_agg;
L6_expert26 -> L6_agg;
L6_expert27 -> L6_agg;
L6_expert28 -> L6_agg;
L6_expert29 -> L6_agg;
L6_expert30 -> L6_agg;
L6_expert31 -> L6_agg;
L6_expert32 -> L6_agg;
L6_expert33 -> L6_agg;
L6_expert34 -> L6_agg;
L6_expert35 -> L6_agg;
L6_expert36 -> L6_agg;
L6_expert37 -> L6_agg;
L6_expert38 -> L6_agg;
L6_expert39 -> L6_agg;
L6_expert40 -> L6_agg;
L6_expert41 -> L6_agg;
L6_expert42 -> L6_agg;
L6_expert43 -> L6_agg;
L6_expert44 -> L6_agg;
L6_expert45 -> L6_agg;
L6_expert46 -> L6_agg;
L6_expert47 -> L6_agg;
L6_expert48 -> L6_agg;
L6_expert49 -> L6_agg;
L6_expert50 -> L6_agg;
L6_expert51 -> L6_agg;
L6_expert52 -> L6_agg;
L6_expert53 -> L6_agg;
L6_expert54 -> L6_agg;
L6_expert55 -> L6_agg;
L6_expert56 -> L6_agg;
L6_expert57 -> L6_agg;
L6_expert58 -> L6_agg;
L6_expert59 -> L6_agg;
L6_expert60 -> L6_agg;
L6_expert61 -> L6_agg;
L6_expert62 -> L6_agg;
L6_expert63 -> L6_agg;
L6_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_agg -> L6_expert_ar;
L7_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L6_expert_ar -> L7_qkv;
L7_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_qkv -> L7_attn;
L7_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_attn -> L7_outproj;
L7_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_outproj -> L7_gate;
L7_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_split;
L7_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert0 [style=dashed];
L7_split -> L7_expert0;
L7_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert1 [style=dashed];
L7_split -> L7_expert1;
L7_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert2 [style=dashed];
L7_split -> L7_expert2;
L7_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert3 [style=dashed];
L7_split -> L7_expert3;
L7_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert4 [style=dashed];
L7_split -> L7_expert4;
L7_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert5 [style=dashed];
L7_split -> L7_expert5;
L7_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert6 [style=dashed];
L7_split -> L7_expert6;
L7_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert7 [style=dashed];
L7_split -> L7_expert7;
L7_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert8 [style=dashed];
L7_split -> L7_expert8;
L7_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert9 [style=dashed];
L7_split -> L7_expert9;
L7_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert10 [style=dashed];
L7_split -> L7_expert10;
L7_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert11 [style=dashed];
L7_split -> L7_expert11;
L7_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert12 [style=dashed];
L7_split -> L7_expert12;
L7_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert13 [style=dashed];
L7_split -> L7_expert13;
L7_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert14 [style=dashed];
L7_split -> L7_expert14;
L7_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert15 [style=dashed];
L7_split -> L7_expert15;
L7_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert16 [style=dashed];
L7_split -> L7_expert16;
L7_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert17 [style=dashed];
L7_split -> L7_expert17;
L7_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert18 [style=dashed];
L7_split -> L7_expert18;
L7_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert19 [style=dashed];
L7_split -> L7_expert19;
L7_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert20 [style=dashed];
L7_split -> L7_expert20;
L7_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert21 [style=dashed];
L7_split -> L7_expert21;
L7_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert22 [style=dashed];
L7_split -> L7_expert22;
L7_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert23 [style=dashed];
L7_split -> L7_expert23;
L7_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert24 [style=dashed];
L7_split -> L7_expert24;
L7_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert25 [style=dashed];
L7_split -> L7_expert25;
L7_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert26 [style=dashed];
L7_split -> L7_expert26;
L7_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert27 [style=dashed];
L7_split -> L7_expert27;
L7_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert28 [style=dashed];
L7_split -> L7_expert28;
L7_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert29 [style=dashed];
L7_split -> L7_expert29;
L7_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert30 [style=dashed];
L7_split -> L7_expert30;
L7_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert31 [style=dashed];
L7_split -> L7_expert31;
L7_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert32 [style=dashed];
L7_split -> L7_expert32;
L7_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert33 [style=dashed];
L7_split -> L7_expert33;
L7_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert34 [style=dashed];
L7_split -> L7_expert34;
L7_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert35 [style=dashed];
L7_split -> L7_expert35;
L7_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert36 [style=dashed];
L7_split -> L7_expert36;
L7_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert37 [style=dashed];
L7_split -> L7_expert37;
L7_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert38 [style=dashed];
L7_split -> L7_expert38;
L7_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert39 [style=dashed];
L7_split -> L7_expert39;
L7_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert40 [style=dashed];
L7_split -> L7_expert40;
L7_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert41 [style=dashed];
L7_split -> L7_expert41;
L7_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert42 [style=dashed];
L7_split -> L7_expert42;
L7_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert43 [style=dashed];
L7_split -> L7_expert43;
L7_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert44 [style=dashed];
L7_split -> L7_expert44;
L7_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert45 [style=dashed];
L7_split -> L7_expert45;
L7_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert46 [style=dashed];
L7_split -> L7_expert46;
L7_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert47 [style=dashed];
L7_split -> L7_expert47;
L7_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert48 [style=dashed];
L7_split -> L7_expert48;
L7_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert49 [style=dashed];
L7_split -> L7_expert49;
L7_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert50 [style=dashed];
L7_split -> L7_expert50;
L7_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert51 [style=dashed];
L7_split -> L7_expert51;
L7_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert52 [style=dashed];
L7_split -> L7_expert52;
L7_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert53 [style=dashed];
L7_split -> L7_expert53;
L7_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert54 [style=dashed];
L7_split -> L7_expert54;
L7_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert55 [style=dashed];
L7_split -> L7_expert55;
L7_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert56 [style=dashed];
L7_split -> L7_expert56;
L7_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert57 [style=dashed];
L7_split -> L7_expert57;
L7_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert58 [style=dashed];
L7_split -> L7_expert58;
L7_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert59 [style=dashed];
L7_split -> L7_expert59;
L7_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert60 [style=dashed];
L7_split -> L7_expert60;
L7_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert61 [style=dashed];
L7_split -> L7_expert61;
L7_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert62 [style=dashed];
L7_split -> L7_expert62;
L7_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_gate -> L7_expert63 [style=dashed];
L7_split -> L7_expert63;
L7_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_expert0 -> L7_agg;
L7_expert1 -> L7_agg;
L7_expert2 -> L7_agg;
L7_expert3 -> L7_agg;
L7_expert4 -> L7_agg;
L7_expert5 -> L7_agg;
L7_expert6 -> L7_agg;
L7_expert7 -> L7_agg;
L7_expert8 -> L7_agg;
L7_expert9 -> L7_agg;
L7_expert10 -> L7_agg;
L7_expert11 -> L7_agg;
L7_expert12 -> L7_agg;
L7_expert13 -> L7_agg;
L7_expert14 -> L7_agg;
L7_expert15 -> L7_agg;
L7_expert16 -> L7_agg;
L7_expert17 -> L7_agg;
L7_expert18 -> L7_agg;
L7_expert19 -> L7_agg;
L7_expert20 -> L7_agg;
L7_expert21 -> L7_agg;
L7_expert22 -> L7_agg;
L7_expert23 -> L7_agg;
L7_expert24 -> L7_agg;
L7_expert25 -> L7_agg;
L7_expert26 -> L7_agg;
L7_expert27 -> L7_agg;
L7_expert28 -> L7_agg;
L7_expert29 -> L7_agg;
L7_expert30 -> L7_agg;
L7_expert31 -> L7_agg;
L7_expert32 -> L7_agg;
L7_expert33 -> L7_agg;
L7_expert34 -> L7_agg;
L7_expert35 -> L7_agg;
L7_expert36 -> L7_agg;
L7_expert37 -> L7_agg;
L7_expert38 -> L7_agg;
L7_expert39 -> L7_agg;
L7_expert40 -> L7_agg;
L7_expert41 -> L7_agg;
L7_expert42 -> L7_agg;
L7_expert43 -> L7_agg;
L7_expert44 -> L7_agg;
L7_expert45 -> L7_agg;
L7_expert46 -> L7_agg;
L7_expert47 -> L7_agg;
L7_expert48 -> L7_agg;
L7_expert49 -> L7_agg;
L7_expert50 -> L7_agg;
L7_expert51 -> L7_agg;
L7_expert52 -> L7_agg;
L7_expert53 -> L7_agg;
L7_expert54 -> L7_agg;
L7_expert55 -> L7_agg;
L7_expert56 -> L7_agg;
L7_expert57 -> L7_agg;
L7_expert58 -> L7_agg;
L7_expert59 -> L7_agg;
L7_expert60 -> L7_agg;
L7_expert61 -> L7_agg;
L7_expert62 -> L7_agg;
L7_expert63 -> L7_agg;
L7_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_agg -> L7_expert_ar;
L8_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L7_expert_ar -> L8_qkv;
L8_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_qkv -> L8_attn;
L8_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_attn -> L8_outproj;
L8_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_outproj -> L8_gate;
L8_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_split;
L8_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert0 [style=dashed];
L8_split -> L8_expert0;
L8_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert1 [style=dashed];
L8_split -> L8_expert1;
L8_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert2 [style=dashed];
L8_split -> L8_expert2;
L8_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert3 [style=dashed];
L8_split -> L8_expert3;
L8_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert4 [style=dashed];
L8_split -> L8_expert4;
L8_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert5 [style=dashed];
L8_split -> L8_expert5;
L8_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert6 [style=dashed];
L8_split -> L8_expert6;
L8_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert7 [style=dashed];
L8_split -> L8_expert7;
L8_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert8 [style=dashed];
L8_split -> L8_expert8;
L8_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert9 [style=dashed];
L8_split -> L8_expert9;
L8_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert10 [style=dashed];
L8_split -> L8_expert10;
L8_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert11 [style=dashed];
L8_split -> L8_expert11;
L8_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert12 [style=dashed];
L8_split -> L8_expert12;
L8_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert13 [style=dashed];
L8_split -> L8_expert13;
L8_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert14 [style=dashed];
L8_split -> L8_expert14;
L8_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert15 [style=dashed];
L8_split -> L8_expert15;
L8_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert16 [style=dashed];
L8_split -> L8_expert16;
L8_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert17 [style=dashed];
L8_split -> L8_expert17;
L8_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert18 [style=dashed];
L8_split -> L8_expert18;
L8_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert19 [style=dashed];
L8_split -> L8_expert19;
L8_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert20 [style=dashed];
L8_split -> L8_expert20;
L8_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert21 [style=dashed];
L8_split -> L8_expert21;
L8_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert22 [style=dashed];
L8_split -> L8_expert22;
L8_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert23 [style=dashed];
L8_split -> L8_expert23;
L8_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert24 [style=dashed];
L8_split -> L8_expert24;
L8_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert25 [style=dashed];
L8_split -> L8_expert25;
L8_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert26 [style=dashed];
L8_split -> L8_expert26;
L8_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert27 [style=dashed];
L8_split -> L8_expert27;
L8_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert28 [style=dashed];
L8_split -> L8_expert28;
L8_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert29 [style=dashed];
L8_split -> L8_expert29;
L8_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert30 [style=dashed];
L8_split -> L8_expert30;
L8_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert31 [style=dashed];
L8_split -> L8_expert31;
L8_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert32 [style=dashed];
L8_split -> L8_expert32;
L8_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert33 [style=dashed];
L8_split -> L8_expert33;
L8_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert34 [style=dashed];
L8_split -> L8_expert34;
L8_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert35 [style=dashed];
L8_split -> L8_expert35;
L8_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert36 [style=dashed];
L8_split -> L8_expert36;
L8_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert37 [style=dashed];
L8_split -> L8_expert37;
L8_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert38 [style=dashed];
L8_split -> L8_expert38;
L8_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert39 [style=dashed];
L8_split -> L8_expert39;
L8_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert40 [style=dashed];
L8_split -> L8_expert40;
L8_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert41 [style=dashed];
L8_split -> L8_expert41;
L8_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert42 [style=dashed];
L8_split -> L8_expert42;
L8_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert43 [style=dashed];
L8_split -> L8_expert43;
L8_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert44 [style=dashed];
L8_split -> L8_expert44;
L8_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert45 [style=dashed];
L8_split -> L8_expert45;
L8_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert46 [style=dashed];
L8_split -> L8_expert46;
L8_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert47 [style=dashed];
L8_split -> L8_expert47;
L8_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert48 [style=dashed];
L8_split -> L8_expert48;
L8_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert49 [style=dashed];
L8_split -> L8_expert49;
L8_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert50 [style=dashed];
L8_split -> L8_expert50;
L8_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert51 [style=dashed];
L8_split -> L8_expert51;
L8_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert52 [style=dashed];
L8_split -> L8_expert52;
L8_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert53 [style=dashed];
L8_split -> L8_expert53;
L8_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert54 [style=dashed];
L8_split -> L8_expert54;
L8_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert55 [style=dashed];
L8_split -> L8_expert55;
L8_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert56 [style=dashed];
L8_split -> L8_expert56;
L8_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert57 [style=dashed];
L8_split -> L8_expert57;
L8_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert58 [style=dashed];
L8_split -> L8_expert58;
L8_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert59 [style=dashed];
L8_split -> L8_expert59;
L8_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert60 [style=dashed];
L8_split -> L8_expert60;
L8_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert61 [style=dashed];
L8_split -> L8_expert61;
L8_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert62 [style=dashed];
L8_split -> L8_expert62;
L8_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_gate -> L8_expert63 [style=dashed];
L8_split -> L8_expert63;
L8_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_expert0 -> L8_agg;
L8_expert1 -> L8_agg;
L8_expert2 -> L8_agg;
L8_expert3 -> L8_agg;
L8_expert4 -> L8_agg;
L8_expert5 -> L8_agg;
L8_expert6 -> L8_agg;
L8_expert7 -> L8_agg;
L8_expert8 -> L8_agg;
L8_expert9 -> L8_agg;
L8_expert10 -> L8_agg;
L8_expert11 -> L8_agg;
L8_expert12 -> L8_agg;
L8_expert13 -> L8_agg;
L8_expert14 -> L8_agg;
L8_expert15 -> L8_agg;
L8_expert16 -> L8_agg;
L8_expert17 -> L8_agg;
L8_expert18 -> L8_agg;
L8_expert19 -> L8_agg;
L8_expert20 -> L8_agg;
L8_expert21 -> L8_agg;
L8_expert22 -> L8_agg;
L8_expert23 -> L8_agg;
L8_expert24 -> L8_agg;
L8_expert25 -> L8_agg;
L8_expert26 -> L8_agg;
L8_expert27 -> L8_agg;
L8_expert28 -> L8_agg;
L8_expert29 -> L8_agg;
L8_expert30 -> L8_agg;
L8_expert31 -> L8_agg;
L8_expert32 -> L8_agg;
L8_expert33 -> L8_agg;
L8_expert34 -> L8_agg;
L8_expert35 -> L8_agg;
L8_expert36 -> L8_agg;
L8_expert37 -> L8_agg;
L8_expert38 -> L8_agg;
L8_expert39 -> L8_agg;
L8_expert40 -> L8_agg;
L8_expert41 -> L8_agg;
L8_expert42 -> L8_agg;
L8_expert43 -> L8_agg;
L8_expert44 -> L8_agg;
L8_expert45 -> L8_agg;
L8_expert46 -> L8_agg;
L8_expert47 -> L8_agg;
L8_expert48 -> L8_agg;
L8_expert49 -> L8_agg;
L8_expert50 -> L8_agg;
L8_expert51 -> L8_agg;
L8_expert52 -> L8_agg;
L8_expert53 -> L8_agg;
L8_expert54 -> L8_agg;
L8_expert55 -> L8_agg;
L8_expert56 -> L8_agg;
L8_expert57 -> L8_agg;
L8_expert58 -> L8_agg;
L8_expert59 -> L8_agg;
L8_expert60 -> L8_agg;
L8_expert61 -> L8_agg;
L8_expert62 -> L8_agg;
L8_expert63 -> L8_agg;
L8_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_agg -> L8_expert_ar;
L9_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L8_expert_ar -> L9_qkv;
L9_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_qkv -> L9_attn;
L9_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_attn -> L9_outproj;
L9_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_outproj -> L9_gate;
L9_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_split;
L9_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert0 [style=dashed];
L9_split -> L9_expert0;
L9_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert1 [style=dashed];
L9_split -> L9_expert1;
L9_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert2 [style=dashed];
L9_split -> L9_expert2;
L9_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert3 [style=dashed];
L9_split -> L9_expert3;
L9_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert4 [style=dashed];
L9_split -> L9_expert4;
L9_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert5 [style=dashed];
L9_split -> L9_expert5;
L9_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert6 [style=dashed];
L9_split -> L9_expert6;
L9_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert7 [style=dashed];
L9_split -> L9_expert7;
L9_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert8 [style=dashed];
L9_split -> L9_expert8;
L9_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert9 [style=dashed];
L9_split -> L9_expert9;
L9_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert10 [style=dashed];
L9_split -> L9_expert10;
L9_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert11 [style=dashed];
L9_split -> L9_expert11;
L9_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert12 [style=dashed];
L9_split -> L9_expert12;
L9_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert13 [style=dashed];
L9_split -> L9_expert13;
L9_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert14 [style=dashed];
L9_split -> L9_expert14;
L9_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert15 [style=dashed];
L9_split -> L9_expert15;
L9_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert16 [style=dashed];
L9_split -> L9_expert16;
L9_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert17 [style=dashed];
L9_split -> L9_expert17;
L9_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert18 [style=dashed];
L9_split -> L9_expert18;
L9_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert19 [style=dashed];
L9_split -> L9_expert19;
L9_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert20 [style=dashed];
L9_split -> L9_expert20;
L9_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert21 [style=dashed];
L9_split -> L9_expert21;
L9_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert22 [style=dashed];
L9_split -> L9_expert22;
L9_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert23 [style=dashed];
L9_split -> L9_expert23;
L9_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert24 [style=dashed];
L9_split -> L9_expert24;
L9_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert25 [style=dashed];
L9_split -> L9_expert25;
L9_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert26 [style=dashed];
L9_split -> L9_expert26;
L9_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert27 [style=dashed];
L9_split -> L9_expert27;
L9_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert28 [style=dashed];
L9_split -> L9_expert28;
L9_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert29 [style=dashed];
L9_split -> L9_expert29;
L9_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert30 [style=dashed];
L9_split -> L9_expert30;
L9_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert31 [style=dashed];
L9_split -> L9_expert31;
L9_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert32 [style=dashed];
L9_split -> L9_expert32;
L9_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert33 [style=dashed];
L9_split -> L9_expert33;
L9_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert34 [style=dashed];
L9_split -> L9_expert34;
L9_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert35 [style=dashed];
L9_split -> L9_expert35;
L9_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert36 [style=dashed];
L9_split -> L9_expert36;
L9_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert37 [style=dashed];
L9_split -> L9_expert37;
L9_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert38 [style=dashed];
L9_split -> L9_expert38;
L9_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert39 [style=dashed];
L9_split -> L9_expert39;
L9_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert40 [style=dashed];
L9_split -> L9_expert40;
L9_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert41 [style=dashed];
L9_split -> L9_expert41;
L9_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert42 [style=dashed];
L9_split -> L9_expert42;
L9_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert43 [style=dashed];
L9_split -> L9_expert43;
L9_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert44 [style=dashed];
L9_split -> L9_expert44;
L9_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert45 [style=dashed];
L9_split -> L9_expert45;
L9_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert46 [style=dashed];
L9_split -> L9_expert46;
L9_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert47 [style=dashed];
L9_split -> L9_expert47;
L9_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert48 [style=dashed];
L9_split -> L9_expert48;
L9_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert49 [style=dashed];
L9_split -> L9_expert49;
L9_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert50 [style=dashed];
L9_split -> L9_expert50;
L9_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert51 [style=dashed];
L9_split -> L9_expert51;
L9_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert52 [style=dashed];
L9_split -> L9_expert52;
L9_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert53 [style=dashed];
L9_split -> L9_expert53;
L9_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert54 [style=dashed];
L9_split -> L9_expert54;
L9_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert55 [style=dashed];
L9_split -> L9_expert55;
L9_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert56 [style=dashed];
L9_split -> L9_expert56;
L9_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert57 [style=dashed];
L9_split -> L9_expert57;
L9_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert58 [style=dashed];
L9_split -> L9_expert58;
L9_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert59 [style=dashed];
L9_split -> L9_expert59;
L9_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert60 [style=dashed];
L9_split -> L9_expert60;
L9_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert61 [style=dashed];
L9_split -> L9_expert61;
L9_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert62 [style=dashed];
L9_split -> L9_expert62;
L9_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_gate -> L9_expert63 [style=dashed];
L9_split -> L9_expert63;
L9_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_expert0 -> L9_agg;
L9_expert1 -> L9_agg;
L9_expert2 -> L9_agg;
L9_expert3 -> L9_agg;
L9_expert4 -> L9_agg;
L9_expert5 -> L9_agg;
L9_expert6 -> L9_agg;
L9_expert7 -> L9_agg;
L9_expert8 -> L9_agg;
L9_expert9 -> L9_agg;
L9_expert10 -> L9_agg;
L9_expert11 -> L9_agg;
L9_expert12 -> L9_agg;
L9_expert13 -> L9_agg;
L9_expert14 -> L9_agg;
L9_expert15 -> L9_agg;
L9_expert16 -> L9_agg;
L9_expert17 -> L9_agg;
L9_expert18 -> L9_agg;
L9_expert19 -> L9_agg;
L9_expert20 -> L9_agg;
L9_expert21 -> L9_agg;
L9_expert22 -> L9_agg;
L9_expert23 -> L9_agg;
L9_expert24 -> L9_agg;
L9_expert25 -> L9_agg;
L9_expert26 -> L9_agg;
L9_expert27 -> L9_agg;
L9_expert28 -> L9_agg;
L9_expert29 -> L9_agg;
L9_expert30 -> L9_agg;
L9_expert31 -> L9_agg;
L9_expert32 -> L9_agg;
L9_expert33 -> L9_agg;
L9_expert34 -> L9_agg;
L9_expert35 -> L9_agg;
L9_expert36 -> L9_agg;
L9_expert37 -> L9_agg;
L9_expert38 -> L9_agg;
L9_expert39 -> L9_agg;
L9_expert40 -> L9_agg;
L9_expert41 -> L9_agg;
L9_expert42 -> L9_agg;
L9_expert43 -> L9_agg;
L9_expert44 -> L9_agg;
L9_expert45 -> L9_agg;
L9_expert46 -> L9_agg;
L9_expert47 -> L9_agg;
L9_expert48 -> L9_agg;
L9_expert49 -> L9_agg;
L9_expert50 -> L9_agg;
L9_expert51 -> L9_agg;
L9_expert52 -> L9_agg;
L9_expert53 -> L9_agg;
L9_expert54 -> L9_agg;
L9_expert55 -> L9_agg;
L9_expert56 -> L9_agg;
L9_expert57 -> L9_agg;
L9_expert58 -> L9_agg;
L9_expert59 -> L9_agg;
L9_expert60 -> L9_agg;
L9_expert61 -> L9_agg;
L9_expert62 -> L9_agg;
L9_expert63 -> L9_agg;
L9_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_agg -> L9_expert_ar;
L10_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L9_expert_ar -> L10_qkv;
L10_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_qkv -> L10_attn;
L10_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_attn -> L10_outproj;
L10_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_outproj -> L10_gate;
L10_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_split;
L10_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert0 [style=dashed];
L10_split -> L10_expert0;
L10_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert1 [style=dashed];
L10_split -> L10_expert1;
L10_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert2 [style=dashed];
L10_split -> L10_expert2;
L10_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert3 [style=dashed];
L10_split -> L10_expert3;
L10_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert4 [style=dashed];
L10_split -> L10_expert4;
L10_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert5 [style=dashed];
L10_split -> L10_expert5;
L10_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert6 [style=dashed];
L10_split -> L10_expert6;
L10_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert7 [style=dashed];
L10_split -> L10_expert7;
L10_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert8 [style=dashed];
L10_split -> L10_expert8;
L10_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert9 [style=dashed];
L10_split -> L10_expert9;
L10_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert10 [style=dashed];
L10_split -> L10_expert10;
L10_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert11 [style=dashed];
L10_split -> L10_expert11;
L10_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert12 [style=dashed];
L10_split -> L10_expert12;
L10_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert13 [style=dashed];
L10_split -> L10_expert13;
L10_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert14 [style=dashed];
L10_split -> L10_expert14;
L10_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert15 [style=dashed];
L10_split -> L10_expert15;
L10_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert16 [style=dashed];
L10_split -> L10_expert16;
L10_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert17 [style=dashed];
L10_split -> L10_expert17;
L10_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert18 [style=dashed];
L10_split -> L10_expert18;
L10_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert19 [style=dashed];
L10_split -> L10_expert19;
L10_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert20 [style=dashed];
L10_split -> L10_expert20;
L10_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert21 [style=dashed];
L10_split -> L10_expert21;
L10_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert22 [style=dashed];
L10_split -> L10_expert22;
L10_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert23 [style=dashed];
L10_split -> L10_expert23;
L10_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert24 [style=dashed];
L10_split -> L10_expert24;
L10_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert25 [style=dashed];
L10_split -> L10_expert25;
L10_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert26 [style=dashed];
L10_split -> L10_expert26;
L10_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert27 [style=dashed];
L10_split -> L10_expert27;
L10_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert28 [style=dashed];
L10_split -> L10_expert28;
L10_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert29 [style=dashed];
L10_split -> L10_expert29;
L10_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert30 [style=dashed];
L10_split -> L10_expert30;
L10_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert31 [style=dashed];
L10_split -> L10_expert31;
L10_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert32 [style=dashed];
L10_split -> L10_expert32;
L10_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert33 [style=dashed];
L10_split -> L10_expert33;
L10_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert34 [style=dashed];
L10_split -> L10_expert34;
L10_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert35 [style=dashed];
L10_split -> L10_expert35;
L10_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert36 [style=dashed];
L10_split -> L10_expert36;
L10_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert37 [style=dashed];
L10_split -> L10_expert37;
L10_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert38 [style=dashed];
L10_split -> L10_expert38;
L10_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert39 [style=dashed];
L10_split -> L10_expert39;
L10_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert40 [style=dashed];
L10_split -> L10_expert40;
L10_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert41 [style=dashed];
L10_split -> L10_expert41;
L10_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert42 [style=dashed];
L10_split -> L10_expert42;
L10_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert43 [style=dashed];
L10_split -> L10_expert43;
L10_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert44 [style=dashed];
L10_split -> L10_expert44;
L10_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert45 [style=dashed];
L10_split -> L10_expert45;
L10_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert46 [style=dashed];
L10_split -> L10_expert46;
L10_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert47 [style=dashed];
L10_split -> L10_expert47;
L10_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert48 [style=dashed];
L10_split -> L10_expert48;
L10_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert49 [style=dashed];
L10_split -> L10_expert49;
L10_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert50 [style=dashed];
L10_split -> L10_expert50;
L10_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert51 [style=dashed];
L10_split -> L10_expert51;
L10_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert52 [style=dashed];
L10_split -> L10_expert52;
L10_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert53 [style=dashed];
L10_split -> L10_expert53;
L10_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert54 [style=dashed];
L10_split -> L10_expert54;
L10_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert55 [style=dashed];
L10_split -> L10_expert55;
L10_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert56 [style=dashed];
L10_split -> L10_expert56;
L10_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert57 [style=dashed];
L10_split -> L10_expert57;
L10_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert58 [style=dashed];
L10_split -> L10_expert58;
L10_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert59 [style=dashed];
L10_split -> L10_expert59;
L10_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert60 [style=dashed];
L10_split -> L10_expert60;
L10_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert61 [style=dashed];
L10_split -> L10_expert61;
L10_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert62 [style=dashed];
L10_split -> L10_expert62;
L10_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_gate -> L10_expert63 [style=dashed];
L10_split -> L10_expert63;
L10_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_expert0 -> L10_agg;
L10_expert1 -> L10_agg;
L10_expert2 -> L10_agg;
L10_expert3 -> L10_agg;
L10_expert4 -> L10_agg;
L10_expert5 -> L10_agg;
L10_expert6 -> L10_agg;
L10_expert7 -> L10_agg;
L10_expert8 -> L10_agg;
L10_expert9 -> L10_agg;
L10_expert10 -> L10_agg;
L10_expert11 -> L10_agg;
L10_expert12 -> L10_agg;
L10_expert13 -> L10_agg;
L10_expert14 -> L10_agg;
L10_expert15 -> L10_agg;
L10_expert16 -> L10_agg;
L10_expert17 -> L10_agg;
L10_expert18 -> L10_agg;
L10_expert19 -> L10_agg;
L10_expert20 -> L10_agg;
L10_expert21 -> L10_agg;
L10_expert22 -> L10_agg;
L10_expert23 -> L10_agg;
L10_expert24 -> L10_agg;
L10_expert25 -> L10_agg;
L10_expert26 -> L10_agg;
L10_expert27 -> L10_agg;
L10_expert28 -> L10_agg;
L10_expert29 -> L10_agg;
L10_expert30 -> L10_agg;
L10_expert31 -> L10_agg;
L10_expert32 -> L10_agg;
L10_expert33 -> L10_agg;
L10_expert34 -> L10_agg;
L10_expert35 -> L10_agg;
L10_expert36 -> L10_agg;
L10_expert37 -> L10_agg;
L10_expert38 -> L10_agg;
L10_expert39 -> L10_agg;
L10_expert40 -> L10_agg;
L10_expert41 -> L10_agg;
L10_expert42 -> L10_agg;
L10_expert43 -> L10_agg;
L10_expert44 -> L10_agg;
L10_expert45 -> L10_agg;
L10_expert46 -> L10_agg;
L10_expert47 -> L10_agg;
L10_expert48 -> L10_agg;
L10_expert49 -> L10_agg;
L10_expert50 -> L10_agg;
L10_expert51 -> L10_agg;
L10_expert52 -> L10_agg;
L10_expert53 -> L10_agg;
L10_expert54 -> L10_agg;
L10_expert55 -> L10_agg;
L10_expert56 -> L10_agg;
L10_expert57 -> L10_agg;
L10_expert58 -> L10_agg;
L10_expert59 -> L10_agg;
L10_expert60 -> L10_agg;
L10_expert61 -> L10_agg;
L10_expert62 -> L10_agg;
L10_expert63 -> L10_agg;
L10_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_agg -> L10_expert_ar;
L11_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L10_expert_ar -> L11_qkv;
L11_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_qkv -> L11_attn;
L11_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_attn -> L11_outproj;
L11_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_outproj -> L11_gate;
L11_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_split;
L11_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert0 [style=dashed];
L11_split -> L11_expert0;
L11_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert1 [style=dashed];
L11_split -> L11_expert1;
L11_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert2 [style=dashed];
L11_split -> L11_expert2;
L11_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert3 [style=dashed];
L11_split -> L11_expert3;
L11_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert4 [style=dashed];
L11_split -> L11_expert4;
L11_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert5 [style=dashed];
L11_split -> L11_expert5;
L11_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert6 [style=dashed];
L11_split -> L11_expert6;
L11_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert7 [style=dashed];
L11_split -> L11_expert7;
L11_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert8 [style=dashed];
L11_split -> L11_expert8;
L11_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert9 [style=dashed];
L11_split -> L11_expert9;
L11_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert10 [style=dashed];
L11_split -> L11_expert10;
L11_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert11 [style=dashed];
L11_split -> L11_expert11;
L11_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert12 [style=dashed];
L11_split -> L11_expert12;
L11_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert13 [style=dashed];
L11_split -> L11_expert13;
L11_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert14 [style=dashed];
L11_split -> L11_expert14;
L11_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert15 [style=dashed];
L11_split -> L11_expert15;
L11_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert16 [style=dashed];
L11_split -> L11_expert16;
L11_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert17 [style=dashed];
L11_split -> L11_expert17;
L11_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert18 [style=dashed];
L11_split -> L11_expert18;
L11_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert19 [style=dashed];
L11_split -> L11_expert19;
L11_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert20 [style=dashed];
L11_split -> L11_expert20;
L11_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert21 [style=dashed];
L11_split -> L11_expert21;
L11_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert22 [style=dashed];
L11_split -> L11_expert22;
L11_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert23 [style=dashed];
L11_split -> L11_expert23;
L11_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert24 [style=dashed];
L11_split -> L11_expert24;
L11_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert25 [style=dashed];
L11_split -> L11_expert25;
L11_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert26 [style=dashed];
L11_split -> L11_expert26;
L11_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert27 [style=dashed];
L11_split -> L11_expert27;
L11_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert28 [style=dashed];
L11_split -> L11_expert28;
L11_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert29 [style=dashed];
L11_split -> L11_expert29;
L11_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert30 [style=dashed];
L11_split -> L11_expert30;
L11_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert31 [style=dashed];
L11_split -> L11_expert31;
L11_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert32 [style=dashed];
L11_split -> L11_expert32;
L11_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert33 [style=dashed];
L11_split -> L11_expert33;
L11_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert34 [style=dashed];
L11_split -> L11_expert34;
L11_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert35 [style=dashed];
L11_split -> L11_expert35;
L11_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert36 [style=dashed];
L11_split -> L11_expert36;
L11_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert37 [style=dashed];
L11_split -> L11_expert37;
L11_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert38 [style=dashed];
L11_split -> L11_expert38;
L11_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert39 [style=dashed];
L11_split -> L11_expert39;
L11_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert40 [style=dashed];
L11_split -> L11_expert40;
L11_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert41 [style=dashed];
L11_split -> L11_expert41;
L11_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert42 [style=dashed];
L11_split -> L11_expert42;
L11_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert43 [style=dashed];
L11_split -> L11_expert43;
L11_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert44 [style=dashed];
L11_split -> L11_expert44;
L11_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert45 [style=dashed];
L11_split -> L11_expert45;
L11_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert46 [style=dashed];
L11_split -> L11_expert46;
L11_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert47 [style=dashed];
L11_split -> L11_expert47;
L11_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert48 [style=dashed];
L11_split -> L11_expert48;
L11_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert49 [style=dashed];
L11_split -> L11_expert49;
L11_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert50 [style=dashed];
L11_split -> L11_expert50;
L11_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert51 [style=dashed];
L11_split -> L11_expert51;
L11_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert52 [style=dashed];
L11_split -> L11_expert52;
L11_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert53 [style=dashed];
L11_split -> L11_expert53;
L11_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert54 [style=dashed];
L11_split -> L11_expert54;
L11_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert55 [style=dashed];
L11_split -> L11_expert55;
L11_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert56 [style=dashed];
L11_split -> L11_expert56;
L11_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert57 [style=dashed];
L11_split -> L11_expert57;
L11_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert58 [style=dashed];
L11_split -> L11_expert58;
L11_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert59 [style=dashed];
L11_split -> L11_expert59;
L11_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert60 [style=dashed];
L11_split -> L11_expert60;
L11_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert61 [style=dashed];
L11_split -> L11_expert61;
L11_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert62 [style=dashed];
L11_split -> L11_expert62;
L11_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_gate -> L11_expert63 [style=dashed];
L11_split -> L11_expert63;
L11_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_expert0 -> L11_agg;
L11_expert1 -> L11_agg;
L11_expert2 -> L11_agg;
L11_expert3 -> L11_agg;
L11_expert4 -> L11_agg;
L11_expert5 -> L11_agg;
L11_expert6 -> L11_agg;
L11_expert7 -> L11_agg;
L11_expert8 -> L11_agg;
L11_expert9 -> L11_agg;
L11_expert10 -> L11_agg;
L11_expert11 -> L11_agg;
L11_expert12 -> L11_agg;
L11_expert13 -> L11_agg;
L11_expert14 -> L11_agg;
L11_expert15 -> L11_agg;
L11_expert16 -> L11_agg;
L11_expert17 -> L11_agg;
L11_expert18 -> L11_agg;
L11_expert19 -> L11_agg;
L11_expert20 -> L11_agg;
L11_expert21 -> L11_agg;
L11_expert22 -> L11_agg;
L11_expert23 -> L11_agg;
L11_expert24 -> L11_agg;
L11_expert25 -> L11_agg;
L11_expert26 -> L11_agg;
L11_expert27 -> L11_agg;
L11_expert28 -> L11_agg;
L11_expert29 -> L11_agg;
L11_expert30 -> L11_agg;
L11_expert31 -> L11_agg;
L11_expert32 -> L11_agg;
L11_expert33 -> L11_agg;
L11_expert34 -> L11_agg;
L11_expert35 -> L11_agg;
L11_expert36 -> L11_agg;
L11_expert37 -> L11_agg;
L11_expert38 -> L11_agg;
L11_expert39 -> L11_agg;
L11_expert40 -> L11_agg;
L11_expert41 -> L11_agg;
L11_expert42 -> L11_agg;
L11_expert43 -> L11_agg;
L11_expert44 -> L11_agg;
L11_expert45 -> L11_agg;
L11_expert46 -> L11_agg;
L11_expert47 -> L11_agg;
L11_expert48 -> L11_agg;
L11_expert49 -> L11_agg;
L11_expert50 -> L11_agg;
L11_expert51 -> L11_agg;
L11_expert52 -> L11_agg;
L11_expert53 -> L11_agg;
L11_expert54 -> L11_agg;
L11_expert55 -> L11_agg;
L11_expert56 -> L11_agg;
L11_expert57 -> L11_agg;
L11_expert58 -> L11_agg;
L11_expert59 -> L11_agg;
L11_expert60 -> L11_agg;
L11_expert61 -> L11_agg;
L11_expert62 -> L11_agg;
L11_expert63 -> L11_agg;
L11_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_agg -> L11_expert_ar;
L12_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L11_expert_ar -> L12_qkv;
L12_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_qkv -> L12_attn;
L12_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_attn -> L12_outproj;
L12_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_outproj -> L12_gate;
L12_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_split;
L12_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert0 [style=dashed];
L12_split -> L12_expert0;
L12_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert1 [style=dashed];
L12_split -> L12_expert1;
L12_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert2 [style=dashed];
L12_split -> L12_expert2;
L12_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert3 [style=dashed];
L12_split -> L12_expert3;
L12_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert4 [style=dashed];
L12_split -> L12_expert4;
L12_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert5 [style=dashed];
L12_split -> L12_expert5;
L12_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert6 [style=dashed];
L12_split -> L12_expert6;
L12_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert7 [style=dashed];
L12_split -> L12_expert7;
L12_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert8 [style=dashed];
L12_split -> L12_expert8;
L12_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert9 [style=dashed];
L12_split -> L12_expert9;
L12_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert10 [style=dashed];
L12_split -> L12_expert10;
L12_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert11 [style=dashed];
L12_split -> L12_expert11;
L12_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert12 [style=dashed];
L12_split -> L12_expert12;
L12_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert13 [style=dashed];
L12_split -> L12_expert13;
L12_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert14 [style=dashed];
L12_split -> L12_expert14;
L12_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert15 [style=dashed];
L12_split -> L12_expert15;
L12_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert16 [style=dashed];
L12_split -> L12_expert16;
L12_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert17 [style=dashed];
L12_split -> L12_expert17;
L12_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert18 [style=dashed];
L12_split -> L12_expert18;
L12_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert19 [style=dashed];
L12_split -> L12_expert19;
L12_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert20 [style=dashed];
L12_split -> L12_expert20;
L12_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert21 [style=dashed];
L12_split -> L12_expert21;
L12_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert22 [style=dashed];
L12_split -> L12_expert22;
L12_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert23 [style=dashed];
L12_split -> L12_expert23;
L12_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert24 [style=dashed];
L12_split -> L12_expert24;
L12_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert25 [style=dashed];
L12_split -> L12_expert25;
L12_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert26 [style=dashed];
L12_split -> L12_expert26;
L12_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert27 [style=dashed];
L12_split -> L12_expert27;
L12_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert28 [style=dashed];
L12_split -> L12_expert28;
L12_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert29 [style=dashed];
L12_split -> L12_expert29;
L12_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert30 [style=dashed];
L12_split -> L12_expert30;
L12_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert31 [style=dashed];
L12_split -> L12_expert31;
L12_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert32 [style=dashed];
L12_split -> L12_expert32;
L12_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert33 [style=dashed];
L12_split -> L12_expert33;
L12_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert34 [style=dashed];
L12_split -> L12_expert34;
L12_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert35 [style=dashed];
L12_split -> L12_expert35;
L12_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert36 [style=dashed];
L12_split -> L12_expert36;
L12_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert37 [style=dashed];
L12_split -> L12_expert37;
L12_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert38 [style=dashed];
L12_split -> L12_expert38;
L12_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert39 [style=dashed];
L12_split -> L12_expert39;
L12_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert40 [style=dashed];
L12_split -> L12_expert40;
L12_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert41 [style=dashed];
L12_split -> L12_expert41;
L12_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert42 [style=dashed];
L12_split -> L12_expert42;
L12_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert43 [style=dashed];
L12_split -> L12_expert43;
L12_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert44 [style=dashed];
L12_split -> L12_expert44;
L12_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert45 [style=dashed];
L12_split -> L12_expert45;
L12_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert46 [style=dashed];
L12_split -> L12_expert46;
L12_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert47 [style=dashed];
L12_split -> L12_expert47;
L12_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert48 [style=dashed];
L12_split -> L12_expert48;
L12_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert49 [style=dashed];
L12_split -> L12_expert49;
L12_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert50 [style=dashed];
L12_split -> L12_expert50;
L12_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert51 [style=dashed];
L12_split -> L12_expert51;
L12_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert52 [style=dashed];
L12_split -> L12_expert52;
L12_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert53 [style=dashed];
L12_split -> L12_expert53;
L12_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert54 [style=dashed];
L12_split -> L12_expert54;
L12_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert55 [style=dashed];
L12_split -> L12_expert55;
L12_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert56 [style=dashed];
L12_split -> L12_expert56;
L12_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert57 [style=dashed];
L12_split -> L12_expert57;
L12_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert58 [style=dashed];
L12_split -> L12_expert58;
L12_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert59 [style=dashed];
L12_split -> L12_expert59;
L12_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert60 [style=dashed];
L12_split -> L12_expert60;
L12_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert61 [style=dashed];
L12_split -> L12_expert61;
L12_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert62 [style=dashed];
L12_split -> L12_expert62;
L12_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_gate -> L12_expert63 [style=dashed];
L12_split -> L12_expert63;
L12_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_expert0 -> L12_agg;
L12_expert1 -> L12_agg;
L12_expert2 -> L12_agg;
L12_expert3 -> L12_agg;
L12_expert4 -> L12_agg;
L12_expert5 -> L12_agg;
L12_expert6 -> L12_agg;
L12_expert7 -> L12_agg;
L12_expert8 -> L12_agg;
L12_expert9 -> L12_agg;
L12_expert10 -> L12_agg;
L12_expert11 -> L12_agg;
L12_expert12 -> L12_agg;
L12_expert13 -> L12_agg;
L12_expert14 -> L12_agg;
L12_expert15 -> L12_agg;
L12_expert16 -> L12_agg;
L12_expert17 -> L12_agg;
L12_expert18 -> L12_agg;
L12_expert19 -> L12_agg;
L12_expert20 -> L12_agg;
L12_expert21 -> L12_agg;
L12_expert22 -> L12_agg;
L12_expert23 -> L12_agg;
L12_expert24 -> L12_agg;
L12_expert25 -> L12_agg;
L12_expert26 -> L12_agg;
L12_expert27 -> L12_agg;
L12_expert28 -> L12_agg;
L12_expert29 -> L12_agg;
L12_expert30 -> L12_agg;
L12_expert31 -> L12_agg;
L12_expert32 -> L12_agg;
L12_expert33 -> L12_agg;
L12_expert34 -> L12_agg;
L12_expert35 -> L12_agg;
L12_expert36 -> L12_agg;
L12_expert37 -> L12_agg;
L12_expert38 -> L12_agg;
L12_expert39 -> L12_agg;
L12_expert40 -> L12_agg;
L12_expert41 -> L12_agg;
L12_expert42 -> L12_agg;
L12_expert43 -> L12_agg;
L12_expert44 -> L12_agg;
L12_expert45 -> L12_agg;
L12_expert46 -> L12_agg;
L12_expert47 -> L12_agg;
L12_expert48 -> L12_agg;
L12_expert49 -> L12_agg;
L12_expert50 -> L12_agg;
L12_expert51 -> L12_agg;
L12_expert52 -> L12_agg;
L12_expert53 -> L12_agg;
L12_expert54 -> L12_agg;
L12_expert55 -> L12_agg;
L12_expert56 -> L12_agg;
L12_expert57 -> L12_agg;
L12_expert58 -> L12_agg;
L12_expert59 -> L12_agg;
L12_expert60 -> L12_agg;
L12_expert61 -> L12_agg;
L12_expert62 -> L12_agg;
L12_expert63 -> L12_agg;
L12_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_agg -> L12_expert_ar;
L13_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L12_expert_ar -> L13_qkv;
L13_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_qkv -> L13_attn;
L13_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_attn -> L13_outproj;
L13_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_outproj -> L13_gate;
L13_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_split;
L13_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert0 [style=dashed];
L13_split -> L13_expert0;
L13_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert1 [style=dashed];
L13_split -> L13_expert1;
L13_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert2 [style=dashed];
L13_split -> L13_expert2;
L13_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert3 [style=dashed];
L13_split -> L13_expert3;
L13_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert4 [style=dashed];
L13_split -> L13_expert4;
L13_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert5 [style=dashed];
L13_split -> L13_expert5;
L13_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert6 [style=dashed];
L13_split -> L13_expert6;
L13_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert7 [style=dashed];
L13_split -> L13_expert7;
L13_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert8 [style=dashed];
L13_split -> L13_expert8;
L13_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert9 [style=dashed];
L13_split -> L13_expert9;
L13_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert10 [style=dashed];
L13_split -> L13_expert10;
L13_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert11 [style=dashed];
L13_split -> L13_expert11;
L13_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert12 [style=dashed];
L13_split -> L13_expert12;
L13_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert13 [style=dashed];
L13_split -> L13_expert13;
L13_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert14 [style=dashed];
L13_split -> L13_expert14;
L13_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert15 [style=dashed];
L13_split -> L13_expert15;
L13_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert16 [style=dashed];
L13_split -> L13_expert16;
L13_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert17 [style=dashed];
L13_split -> L13_expert17;
L13_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert18 [style=dashed];
L13_split -> L13_expert18;
L13_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert19 [style=dashed];
L13_split -> L13_expert19;
L13_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert20 [style=dashed];
L13_split -> L13_expert20;
L13_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert21 [style=dashed];
L13_split -> L13_expert21;
L13_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert22 [style=dashed];
L13_split -> L13_expert22;
L13_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert23 [style=dashed];
L13_split -> L13_expert23;
L13_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert24 [style=dashed];
L13_split -> L13_expert24;
L13_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert25 [style=dashed];
L13_split -> L13_expert25;
L13_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert26 [style=dashed];
L13_split -> L13_expert26;
L13_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert27 [style=dashed];
L13_split -> L13_expert27;
L13_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert28 [style=dashed];
L13_split -> L13_expert28;
L13_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert29 [style=dashed];
L13_split -> L13_expert29;
L13_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert30 [style=dashed];
L13_split -> L13_expert30;
L13_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert31 [style=dashed];
L13_split -> L13_expert31;
L13_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert32 [style=dashed];
L13_split -> L13_expert32;
L13_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert33 [style=dashed];
L13_split -> L13_expert33;
L13_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert34 [style=dashed];
L13_split -> L13_expert34;
L13_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert35 [style=dashed];
L13_split -> L13_expert35;
L13_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert36 [style=dashed];
L13_split -> L13_expert36;
L13_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert37 [style=dashed];
L13_split -> L13_expert37;
L13_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert38 [style=dashed];
L13_split -> L13_expert38;
L13_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert39 [style=dashed];
L13_split -> L13_expert39;
L13_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert40 [style=dashed];
L13_split -> L13_expert40;
L13_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert41 [style=dashed];
L13_split -> L13_expert41;
L13_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert42 [style=dashed];
L13_split -> L13_expert42;
L13_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert43 [style=dashed];
L13_split -> L13_expert43;
L13_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert44 [style=dashed];
L13_split -> L13_expert44;
L13_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert45 [style=dashed];
L13_split -> L13_expert45;
L13_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert46 [style=dashed];
L13_split -> L13_expert46;
L13_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert47 [style=dashed];
L13_split -> L13_expert47;
L13_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert48 [style=dashed];
L13_split -> L13_expert48;
L13_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert49 [style=dashed];
L13_split -> L13_expert49;
L13_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert50 [style=dashed];
L13_split -> L13_expert50;
L13_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert51 [style=dashed];
L13_split -> L13_expert51;
L13_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert52 [style=dashed];
L13_split -> L13_expert52;
L13_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert53 [style=dashed];
L13_split -> L13_expert53;
L13_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert54 [style=dashed];
L13_split -> L13_expert54;
L13_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert55 [style=dashed];
L13_split -> L13_expert55;
L13_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert56 [style=dashed];
L13_split -> L13_expert56;
L13_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert57 [style=dashed];
L13_split -> L13_expert57;
L13_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert58 [style=dashed];
L13_split -> L13_expert58;
L13_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert59 [style=dashed];
L13_split -> L13_expert59;
L13_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert60 [style=dashed];
L13_split -> L13_expert60;
L13_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert61 [style=dashed];
L13_split -> L13_expert61;
L13_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert62 [style=dashed];
L13_split -> L13_expert62;
L13_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_gate -> L13_expert63 [style=dashed];
L13_split -> L13_expert63;
L13_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_expert0 -> L13_agg;
L13_expert1 -> L13_agg;
L13_expert2 -> L13_agg;
L13_expert3 -> L13_agg;
L13_expert4 -> L13_agg;
L13_expert5 -> L13_agg;
L13_expert6 -> L13_agg;
L13_expert7 -> L13_agg;
L13_expert8 -> L13_agg;
L13_expert9 -> L13_agg;
L13_expert10 -> L13_agg;
L13_expert11 -> L13_agg;
L13_expert12 -> L13_agg;
L13_expert13 -> L13_agg;
L13_expert14 -> L13_agg;
L13_expert15 -> L13_agg;
L13_expert16 -> L13_agg;
L13_expert17 -> L13_agg;
L13_expert18 -> L13_agg;
L13_expert19 -> L13_agg;
L13_expert20 -> L13_agg;
L13_expert21 -> L13_agg;
L13_expert22 -> L13_agg;
L13_expert23 -> L13_agg;
L13_expert24 -> L13_agg;
L13_expert25 -> L13_agg;
L13_expert26 -> L13_agg;
L13_expert27 -> L13_agg;
L13_expert28 -> L13_agg;
L13_expert29 -> L13_agg;
L13_expert30 -> L13_agg;
L13_expert31 -> L13_agg;
L13_expert32 -> L13_agg;
L13_expert33 -> L13_agg;
L13_expert34 -> L13_agg;
L13_expert35 -> L13_agg;
L13_expert36 -> L13_agg;
L13_expert37 -> L13_agg;
L13_expert38 -> L13_agg;
L13_expert39 -> L13_agg;
L13_expert40 -> L13_agg;
L13_expert41 -> L13_agg;
L13_expert42 -> L13_agg;
L13_expert43 -> L13_agg;
L13_expert44 -> L13_agg;
L13_expert45 -> L13_agg;
L13_expert46 -> L13_agg;
L13_expert47 -> L13_agg;
L13_expert48 -> L13_agg;
L13_expert49 -> L13_agg;
L13_expert50 -> L13_agg;
L13_expert51 -> L13_agg;
L13_expert52 -> L13_agg;
L13_expert53 -> L13_agg;
L13_expert54 -> L13_agg;
L13_expert55 -> L13_agg;
L13_expert56 -> L13_agg;
L13_expert57 -> L13_agg;
L13_expert58 -> L13_agg;
L13_expert59 -> L13_agg;
L13_expert60 -> L13_agg;
L13_expert61 -> L13_agg;
L13_expert62 -> L13_agg;
L13_expert63 -> L13_agg;
L13_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_agg -> L13_expert_ar;
L14_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L13_expert_ar -> L14_qkv;
L14_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_qkv -> L14_attn;
L14_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_attn -> L14_outproj;
L14_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_outproj -> L14_gate;
L14_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_split;
L14_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert0 [style=dashed];
L14_split -> L14_expert0;
L14_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert1 [style=dashed];
L14_split -> L14_expert1;
L14_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert2 [style=dashed];
L14_split -> L14_expert2;
L14_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert3 [style=dashed];
L14_split -> L14_expert3;
L14_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert4 [style=dashed];
L14_split -> L14_expert4;
L14_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert5 [style=dashed];
L14_split -> L14_expert5;
L14_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert6 [style=dashed];
L14_split -> L14_expert6;
L14_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert7 [style=dashed];
L14_split -> L14_expert7;
L14_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert8 [style=dashed];
L14_split -> L14_expert8;
L14_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert9 [style=dashed];
L14_split -> L14_expert9;
L14_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert10 [style=dashed];
L14_split -> L14_expert10;
L14_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert11 [style=dashed];
L14_split -> L14_expert11;
L14_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert12 [style=dashed];
L14_split -> L14_expert12;
L14_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert13 [style=dashed];
L14_split -> L14_expert13;
L14_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert14 [style=dashed];
L14_split -> L14_expert14;
L14_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert15 [style=dashed];
L14_split -> L14_expert15;
L14_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert16 [style=dashed];
L14_split -> L14_expert16;
L14_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert17 [style=dashed];
L14_split -> L14_expert17;
L14_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert18 [style=dashed];
L14_split -> L14_expert18;
L14_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert19 [style=dashed];
L14_split -> L14_expert19;
L14_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert20 [style=dashed];
L14_split -> L14_expert20;
L14_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert21 [style=dashed];
L14_split -> L14_expert21;
L14_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert22 [style=dashed];
L14_split -> L14_expert22;
L14_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert23 [style=dashed];
L14_split -> L14_expert23;
L14_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert24 [style=dashed];
L14_split -> L14_expert24;
L14_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert25 [style=dashed];
L14_split -> L14_expert25;
L14_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert26 [style=dashed];
L14_split -> L14_expert26;
L14_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert27 [style=dashed];
L14_split -> L14_expert27;
L14_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert28 [style=dashed];
L14_split -> L14_expert28;
L14_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert29 [style=dashed];
L14_split -> L14_expert29;
L14_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert30 [style=dashed];
L14_split -> L14_expert30;
L14_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert31 [style=dashed];
L14_split -> L14_expert31;
L14_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert32 [style=dashed];
L14_split -> L14_expert32;
L14_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert33 [style=dashed];
L14_split -> L14_expert33;
L14_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert34 [style=dashed];
L14_split -> L14_expert34;
L14_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert35 [style=dashed];
L14_split -> L14_expert35;
L14_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert36 [style=dashed];
L14_split -> L14_expert36;
L14_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert37 [style=dashed];
L14_split -> L14_expert37;
L14_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert38 [style=dashed];
L14_split -> L14_expert38;
L14_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert39 [style=dashed];
L14_split -> L14_expert39;
L14_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert40 [style=dashed];
L14_split -> L14_expert40;
L14_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert41 [style=dashed];
L14_split -> L14_expert41;
L14_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert42 [style=dashed];
L14_split -> L14_expert42;
L14_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert43 [style=dashed];
L14_split -> L14_expert43;
L14_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert44 [style=dashed];
L14_split -> L14_expert44;
L14_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert45 [style=dashed];
L14_split -> L14_expert45;
L14_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert46 [style=dashed];
L14_split -> L14_expert46;
L14_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert47 [style=dashed];
L14_split -> L14_expert47;
L14_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert48 [style=dashed];
L14_split -> L14_expert48;
L14_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert49 [style=dashed];
L14_split -> L14_expert49;
L14_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert50 [style=dashed];
L14_split -> L14_expert50;
L14_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert51 [style=dashed];
L14_split -> L14_expert51;
L14_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert52 [style=dashed];
L14_split -> L14_expert52;
L14_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert53 [style=dashed];
L14_split -> L14_expert53;
L14_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert54 [style=dashed];
L14_split -> L14_expert54;
L14_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert55 [style=dashed];
L14_split -> L14_expert55;
L14_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert56 [style=dashed];
L14_split -> L14_expert56;
L14_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert57 [style=dashed];
L14_split -> L14_expert57;
L14_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert58 [style=dashed];
L14_split -> L14_expert58;
L14_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert59 [style=dashed];
L14_split -> L14_expert59;
L14_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert60 [style=dashed];
L14_split -> L14_expert60;
L14_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert61 [style=dashed];
L14_split -> L14_expert61;
L14_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert62 [style=dashed];
L14_split -> L14_expert62;
L14_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_gate -> L14_expert63 [style=dashed];
L14_split -> L14_expert63;
L14_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_expert0 -> L14_agg;
L14_expert1 -> L14_agg;
L14_expert2 -> L14_agg;
L14_expert3 -> L14_agg;
L14_expert4 -> L14_agg;
L14_expert5 -> L14_agg;
L14_expert6 -> L14_agg;
L14_expert7 -> L14_agg;
L14_expert8 -> L14_agg;
L14_expert9 -> L14_agg;
L14_expert10 -> L14_agg;
L14_expert11 -> L14_agg;
L14_expert12 -> L14_agg;
L14_expert13 -> L14_agg;
L14_expert14 -> L14_agg;
L14_expert15 -> L14_agg;
L14_expert16 -> L14_agg;
L14_expert17 -> L14_agg;
L14_expert18 -> L14_agg;
L14_expert19 -> L14_agg;
L14_expert20 -> L14_agg;
L14_expert21 -> L14_agg;
L14_expert22 -> L14_agg;
L14_expert23 -> L14_agg;
L14_expert24 -> L14_agg;
L14_expert25 -> L14_agg;
L14_expert26 -> L14_agg;
L14_expert27 -> L14_agg;
L14_expert28 -> L14_agg;
L14_expert29 -> L14_agg;
L14_expert30 -> L14_agg;
L14_expert31 -> L14_agg;
L14_expert32 -> L14_agg;
L14_expert33 -> L14_agg;
L14_expert34 -> L14_agg;
L14_expert35 -> L14_agg;
L14_expert36 -> L14_agg;
L14_expert37 -> L14_agg;
L14_expert38 -> L14_agg;
L14_expert39 -> L14_agg;
L14_expert40 -> L14_agg;
L14_expert41 -> L14_agg;
L14_expert42 -> L14_agg;
L14_expert43 -> L14_agg;
L14_expert44 -> L14_agg;
L14_expert45 -> L14_agg;
L14_expert46 -> L14_agg;
L14_expert47 -> L14_agg;
L14_expert48 -> L14_agg;
L14_expert49 -> L14_agg;
L14_expert50 -> L14_agg;
L14_expert51 -> L14_agg;
L14_expert52 -> L14_agg;
L14_expert53 -> L14_agg;
L14_expert54 -> L14_agg;
L14_expert55 -> L14_agg;
L14_expert56 -> L14_agg;
L14_expert57 -> L14_agg;
L14_expert58 -> L14_agg;
L14_expert59 -> L14_agg;
L14_expert60 -> L14_agg;
L14_expert61 -> L14_agg;
L14_expert62 -> L14_agg;
L14_expert63 -> L14_agg;
L14_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_agg -> L14_expert_ar;
L15_qkv [label="QKV Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L14_expert_ar -> L15_qkv;
L15_attn [label="Attention Core\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_qkv -> L15_attn;
L15_outproj [label="Out Proj\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_attn -> L15_outproj;
L15_gate [label="Gate (Top-K)\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_outproj -> L15_gate;
L15_split [label="Token Split\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_split;
L15_expert0 [label="Expert 0\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=4,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert0 [style=dashed];
L15_split -> L15_expert0;
L15_expert1 [label="Expert 1\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=5,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert1 [style=dashed];
L15_split -> L15_expert1;
L15_expert2 [label="Expert 2\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=6,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert2 [style=dashed];
L15_split -> L15_expert2;
L15_expert3 [label="Expert 3\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=7,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert3 [style=dashed];
L15_split -> L15_expert3;
L15_expert4 [label="Expert 4\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=8,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert4 [style=dashed];
L15_split -> L15_expert4;
L15_expert5 [label="Expert 5\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=9,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert5 [style=dashed];
L15_split -> L15_expert5;
L15_expert6 [label="Expert 6\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=10,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert6 [style=dashed];
L15_split -> L15_expert6;
L15_expert7 [label="Expert 7\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=11,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert7 [style=dashed];
L15_split -> L15_expert7;
L15_expert8 [label="Expert 8\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=12,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert8 [style=dashed];
L15_split -> L15_expert8;
L15_expert9 [label="Expert 9\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=13,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert9 [style=dashed];
L15_split -> L15_expert9;
L15_expert10 [label="Expert 10\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=14,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert10 [style=dashed];
L15_split -> L15_expert10;
L15_expert11 [label="Expert 11\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=15,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert11 [style=dashed];
L15_split -> L15_expert11;
L15_expert12 [label="Expert 12\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert12 [style=dashed];
L15_split -> L15_expert12;
L15_expert13 [label="Expert 13\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert13 [style=dashed];
L15_split -> L15_expert13;
L15_expert14 [label="Expert 14\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert14 [style=dashed];
L15_split -> L15_expert14;
L15_expert15 [label="Expert 15\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert15 [style=dashed];
L15_split -> L15_expert15;
L15_expert16 [label="Expert 16\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert16 [style=dashed];
L15_split -> L15_expert16;
L15_expert17 [label="Expert 17\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert17 [style=dashed];
L15_split -> L15_expert17;
L15_expert18 [label="Expert 18\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert18 [style=dashed];
L15_split -> L15_expert18;
L15_expert19 [label="Expert 19\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert19 [style=dashed];
L15_split -> L15_expert19;
L15_expert20 [label="Expert 20\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert20 [style=dashed];
L15_split -> L15_expert20;
L15_expert21 [label="Expert 21\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert21 [style=dashed];
L15_split -> L15_expert21;
L15_expert22 [label="Expert 22\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert22 [style=dashed];
L15_split -> L15_expert22;
L15_expert23 [label="Expert 23\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert23 [style=dashed];
L15_split -> L15_expert23;
L15_expert24 [label="Expert 24\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert24 [style=dashed];
L15_split -> L15_expert24;
L15_expert25 [label="Expert 25\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert25 [style=dashed];
L15_split -> L15_expert25;
L15_expert26 [label="Expert 26\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert26 [style=dashed];
L15_split -> L15_expert26;
L15_expert27 [label="Expert 27\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert27 [style=dashed];
L15_split -> L15_expert27;
L15_expert28 [label="Expert 28\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert28 [style=dashed];
L15_split -> L15_expert28;
L15_expert29 [label="Expert 29\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert29 [style=dashed];
L15_split -> L15_expert29;
L15_expert30 [label="Expert 30\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert30 [style=dashed];
L15_split -> L15_expert30;
L15_expert31 [label="Expert 31\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert31 [style=dashed];
L15_split -> L15_expert31;
L15_expert32 [label="Expert 32\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert32 [style=dashed];
L15_split -> L15_expert32;
L15_expert33 [label="Expert 33\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert33 [style=dashed];
L15_split -> L15_expert33;
L15_expert34 [label="Expert 34\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert34 [style=dashed];
L15_split -> L15_expert34;
L15_expert35 [label="Expert 35\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert35 [style=dashed];
L15_split -> L15_expert35;
L15_expert36 [label="Expert 36\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert36 [style=dashed];
L15_split -> L15_expert36;
L15_expert37 [label="Expert 37\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert37 [style=dashed];
L15_split -> L15_expert37;
L15_expert38 [label="Expert 38\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert38 [style=dashed];
L15_split -> L15_expert38;
L15_expert39 [label="Expert 39\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert39 [style=dashed];
L15_split -> L15_expert39;
L15_expert40 [label="Expert 40\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert40 [style=dashed];
L15_split -> L15_expert40;
L15_expert41 [label="Expert 41\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert41 [style=dashed];
L15_split -> L15_expert41;
L15_expert42 [label="Expert 42\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert42 [style=dashed];
L15_split -> L15_expert42;
L15_expert43 [label="Expert 43\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert43 [style=dashed];
L15_split -> L15_expert43;
L15_expert44 [label="Expert 44\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert44 [style=dashed];
L15_split -> L15_expert44;
L15_expert45 [label="Expert 45\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert45 [style=dashed];
L15_split -> L15_expert45;
L15_expert46 [label="Expert 46\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert46 [style=dashed];
L15_split -> L15_expert46;
L15_expert47 [label="Expert 47\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert47 [style=dashed];
L15_split -> L15_expert47;
L15_expert48 [label="Expert 48\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert48 [style=dashed];
L15_split -> L15_expert48;
L15_expert49 [label="Expert 49\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert49 [style=dashed];
L15_split -> L15_expert49;
L15_expert50 [label="Expert 50\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert50 [style=dashed];
L15_split -> L15_expert50;
L15_expert51 [label="Expert 51\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert51 [style=dashed];
L15_split -> L15_expert51;
L15_expert52 [label="Expert 52\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert52 [style=dashed];
L15_split -> L15_expert52;
L15_expert53 [label="Expert 53\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert53 [style=dashed];
L15_split -> L15_expert53;
L15_expert54 [label="Expert 54\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert54 [style=dashed];
L15_split -> L15_expert54;
L15_expert55 [label="Expert 55\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert55 [style=dashed];
L15_split -> L15_expert55;
L15_expert56 [label="Expert 56\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert56 [style=dashed];
L15_split -> L15_expert56;
L15_expert57 [label="Expert 57\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert57 [style=dashed];
L15_split -> L15_expert57;
L15_expert58 [label="Expert 58\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert58 [style=dashed];
L15_split -> L15_expert58;
L15_expert59 [label="Expert 59\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert59 [style=dashed];
L15_split -> L15_expert59;
L15_expert60 [label="Expert 60\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert60 [style=dashed];
L15_split -> L15_expert60;
L15_expert61 [label="Expert 61\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=1,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert61 [style=dashed];
L15_split -> L15_expert61;
L15_expert62 [label="Expert 62\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=2,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert62 [style=dashed];
L15_split -> L15_expert62;
L15_expert63 [label="Expert 63\n[B=128, S=128, H=1024]->[B=128, S=128, H=1024]",shape=rectangle,GPU=3,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_gate -> L15_expert63 [style=dashed];
L15_split -> L15_expert63;
L15_agg [label="Expert Agg\n[B=128, S=128, H=1024]",shape=router,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_expert0 -> L15_agg;
L15_expert1 -> L15_agg;
L15_expert2 -> L15_agg;
L15_expert3 -> L15_agg;
L15_expert4 -> L15_agg;
L15_expert5 -> L15_agg;
L15_expert6 -> L15_agg;
L15_expert7 -> L15_agg;
L15_expert8 -> L15_agg;
L15_expert9 -> L15_agg;
L15_expert10 -> L15_agg;
L15_expert11 -> L15_agg;
L15_expert12 -> L15_agg;
L15_expert13 -> L15_agg;
L15_expert14 -> L15_agg;
L15_expert15 -> L15_agg;
L15_expert16 -> L15_agg;
L15_expert17 -> L15_agg;
L15_expert18 -> L15_agg;
L15_expert19 -> L15_agg;
L15_expert20 -> L15_agg;
L15_expert21 -> L15_agg;
L15_expert22 -> L15_agg;
L15_expert23 -> L15_agg;
L15_expert24 -> L15_agg;
L15_expert25 -> L15_agg;
L15_expert26 -> L15_agg;
L15_expert27 -> L15_agg;
L15_expert28 -> L15_agg;
L15_expert29 -> L15_agg;
L15_expert30 -> L15_agg;
L15_expert31 -> L15_agg;
L15_expert32 -> L15_agg;
L15_expert33 -> L15_agg;
L15_expert34 -> L15_agg;
L15_expert35 -> L15_agg;
L15_expert36 -> L15_agg;
L15_expert37 -> L15_agg;
L15_expert38 -> L15_agg;
L15_expert39 -> L15_agg;
L15_expert40 -> L15_agg;
L15_expert41 -> L15_agg;
L15_expert42 -> L15_agg;
L15_expert43 -> L15_agg;
L15_expert44 -> L15_agg;
L15_expert45 -> L15_agg;
L15_expert46 -> L15_agg;
L15_expert47 -> L15_agg;
L15_expert48 -> L15_agg;
L15_expert49 -> L15_agg;
L15_expert50 -> L15_agg;
L15_expert51 -> L15_agg;
L15_expert52 -> L15_agg;
L15_expert53 -> L15_agg;
L15_expert54 -> L15_agg;
L15_expert55 -> L15_agg;
L15_expert56 -> L15_agg;
L15_expert57 -> L15_agg;
L15_expert58 -> L15_agg;
L15_expert59 -> L15_agg;
L15_expert60 -> L15_agg;
L15_expert61 -> L15_agg;
L15_expert62 -> L15_agg;
L15_expert63 -> L15_agg;
L15_expert_ar [label="AllReduce\n[B=128, S=128, H=1024]",shape=comm,GPU=0,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_agg -> L15_expert_ar;
output [label="OUTPUT\n[B=128, S=128, H=1024]",shape=octagon,INPUT=[B=128, S=128, H=1024],OUTPUT=[B=128, S=128, H=1024]];
L15_expert_ar -> output;
}