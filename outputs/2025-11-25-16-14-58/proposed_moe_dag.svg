<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_moe_dag Pages: 1 -->
<svg width="1805pt" height="1135pt"
 viewBox="0.00 0.00 1805.00 1134.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1130.95)">
<title>proposed_moe_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1130.95 1801,-1130.95 1801,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="8,-100.98 8,-1041.97 934,-1041.97 934,-100.98 8,-100.98"/>
<text text-anchor="middle" x="471" y="-1026.77" font-family="Times,serif" font-size="14.00">Layer 0 (16 Experts, 1 per GPU)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_experts</title>
<polygon fill="none" stroke="purple" stroke-dasharray="1,5" points="16,-358.97 16,-472.97 839,-472.97 839,-358.97 16,-358.97"/>
<text text-anchor="middle" x="427.5" y="-457.77" font-family="Times,serif" font-size="14.00">16 Experts Across GPUs</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_communication</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="942,-355.98 942,-475.97 1789,-475.97 1789,-355.98 942,-355.98"/>
<text text-anchor="middle" x="1365.5" y="-460.77" font-family="Times,serif" font-size="14.00">Cross&#45;GPU Communication (NCCL)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="743" cy="-1097.96" rx="212.68" ry="28.98"/>
<text text-anchor="middle" x="743" y="-1106.46" font-family="Times,serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="743" y="-1095.46" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="743" y="-1084.46" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- layer0_mha_qkv -->
<g id="node2" class="node">
<title>layer0_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="783.5,-987.97 558.5,-987.97 558.5,-935.97 783.5,-935.97 783.5,-987.97"/>
<text text-anchor="middle" x="671" y="-975.97" font-family="Times,serif" font-size="10.00">MHA QKV Linear</text>
<text text-anchor="middle" x="671" y="-964.97" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq=10000, 4096]</text>
<text text-anchor="middle" x="671" y="-953.97" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq=10000, 32×128]</text>
<text text-anchor="middle" x="671" y="-942.97" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_mha_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_mha_qkv</title>
<path fill="none" stroke="black" d="M671,-1070.44C671,-1070.44 671,-998.06 671,-998.06"/>
<polygon fill="black" stroke="black" points="674.5,-998.06 671,-988.06 667.5,-998.06 674.5,-998.06"/>
</g>
<!-- layer0_mha_res -->
<g id="node5" class="node">
<title>layer0_mha_res</title>
<polygon fill="lightcoral" stroke="black" points="884.5,-720.97 667.5,-720.97 667.5,-679.97 884.5,-679.97 884.5,-720.97"/>
<text text-anchor="middle" x="776" y="-708.97" font-family="Times,serif" font-size="10.00">MHA Residual Add</text>
<text text-anchor="middle" x="776" y="-697.97" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq=10000, 4096]×2</text>
<text text-anchor="middle" x="776" y="-686.97" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq=10000, 4096]</text>
</g>
<!-- input&#45;&gt;layer0_mha_res -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer0_mha_res</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M834,-1071.57C834,-1071.57 834,-731.16 834,-731.16"/>
<polygon fill="black" stroke="black" points="837.5,-731.16 834,-721.16 830.5,-731.16 837.5,-731.16"/>
<text text-anchor="middle" x="845" y="-869.27" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer0_mha_attn -->
<g id="node3" class="node">
<title>layer0_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="779.5,-898.97 554.5,-898.97 554.5,-846.97 779.5,-846.97 779.5,-898.97"/>
<text text-anchor="middle" x="667" y="-886.97" font-family="Times,serif" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="667" y="-875.97" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq=10000, 32×128]</text>
<text text-anchor="middle" x="667" y="-864.97" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq=10000, 32×128]</text>
<text text-anchor="middle" x="667" y="-853.97" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- layer0_mha_qkv&#45;&gt;layer0_mha_attn -->
<g id="edge2" class="edge">
<title>layer0_mha_qkv&#45;&gt;layer0_mha_attn</title>
<path fill="none" stroke="black" d="M669,-935.74C669,-935.74 669,-909 669,-909"/>
<polygon fill="black" stroke="black" points="672.5,-909 669,-899 665.5,-909 672.5,-909"/>
</g>
<!-- layer0_mha_out -->
<g id="node4" class="node">
<title>layer0_mha_out</title>
<polygon fill="lightgreen" stroke="black" points="781.5,-809.97 564.5,-809.97 564.5,-757.97 781.5,-757.97 781.5,-809.97"/>
<text text-anchor="middle" x="673" y="-797.97" font-family="Times,serif" font-size="10.00">MHA Output Linear</text>
<text text-anchor="middle" x="673" y="-786.97" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq=10000, 32×128]</text>
<text text-anchor="middle" x="673" y="-775.97" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq=10000, 4096]</text>
<text text-anchor="middle" x="673" y="-764.97" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- layer0_mha_attn&#45;&gt;layer0_mha_out -->
<g id="edge3" class="edge">
<title>layer0_mha_attn&#45;&gt;layer0_mha_out</title>
<path fill="none" stroke="black" d="M672,-846.74C672,-846.74 672,-820 672,-820"/>
<polygon fill="black" stroke="black" points="675.5,-820 672,-810 668.5,-820 675.5,-820"/>
</g>
<!-- layer0_mha_out&#45;&gt;layer0_mha_res -->
<g id="edge4" class="edge">
<title>layer0_mha_out&#45;&gt;layer0_mha_res</title>
<path fill="none" stroke="black" d="M724.5,-757.55C724.5,-757.55 724.5,-731.16 724.5,-731.16"/>
<polygon fill="black" stroke="black" points="728,-731.16 724.5,-721.16 721,-731.16 728,-731.16"/>
</g>
<!-- layer0_gate -->
<g id="node6" class="node">
<title>layer0_gate</title>
<polygon fill="lightyellow" stroke="black" points="884.32,-642.97 517.93,-642.97 423.68,-516.97 790.07,-516.97 884.32,-642.97"/>
<text text-anchor="middle" x="654" y="-599.47" font-family="Times,serif" font-size="10.00">Expert Gate</text>
<text text-anchor="middle" x="654" y="-588.47" font-family="Times,serif" font-size="10.00">Gating (Top&#45;2)</text>
<text text-anchor="middle" x="654" y="-577.47" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq=10000, 4096]</text>
<text text-anchor="middle" x="654" y="-566.47" font-family="Times,serif" font-size="10.00">Output: [routing=16, per_expert_tokens]</text>
<text text-anchor="middle" x="654" y="-555.47" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- layer0_mha_res&#45;&gt;layer0_gate -->
<g id="edge6" class="edge">
<title>layer0_mha_res&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M775.83,-679.75C775.83,-679.75 775.83,-653.16 775.83,-653.16"/>
<polygon fill="black" stroke="black" points="779.33,-653.16 775.83,-643.16 772.33,-653.16 779.33,-653.16"/>
</g>
<!-- layer0_exp_res -->
<g id="node12" class="node">
<title>layer0_exp_res</title>
<polygon fill="lightcoral" stroke="black" points="832.5,-149.98 615.5,-149.98 615.5,-108.98 832.5,-108.98 832.5,-149.98"/>
<text text-anchor="middle" x="724" y="-137.98" font-family="Times,serif" font-size="10.00">Expert Residual Add</text>
<text text-anchor="middle" x="724" y="-126.98" font-family="Times,serif" font-size="10.00">Input: [batch=128, seq=10000, 4096]×2</text>
<text text-anchor="middle" x="724" y="-115.98" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq=10000, 4096]</text>
</g>
<!-- layer0_mha_res&#45;&gt;layer0_exp_res -->
<g id="edge22" class="edge">
<title>layer0_mha_res&#45;&gt;layer0_exp_res</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M884.7,-700C900.02,-700 910.67,-700 910.67,-700 910.67,-700 910.67,-129 910.67,-129 910.67,-129 842.59,-129 842.59,-129"/>
<polygon fill="black" stroke="black" points="842.59,-125.5 832.59,-129 842.59,-132.5 842.59,-125.5"/>
<text text-anchor="middle" x="897" y="-389.27" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- layer0_exp0 -->
<g id="node7" class="node">
<title>layer0_exp0</title>
<polygon fill="lightblue" stroke="black" points="626.5,-418.97 439.5,-418.97 439.5,-366.97 626.5,-366.97 626.5,-418.97"/>
<text text-anchor="middle" x="533" y="-406.97" font-family="Times,serif" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="533" y="-395.97" font-family="Times,serif" font-size="10.00">Input: [tokens_to_exp0, 4096]</text>
<text text-anchor="middle" x="533" y="-384.97" font-family="Times,serif" font-size="10.00">Output: [tokens_from_exp0, 4096]</text>
<text text-anchor="middle" x="533" y="-373.97" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_exp0 -->
<g id="edge7" class="edge">
<title>layer0_gate&#45;&gt;layer0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M533,-516.92C533,-516.92 533,-429.31 533,-429.31"/>
<polygon fill="black" stroke="black" points="536.5,-429.31 533,-419.31 529.5,-429.31 536.5,-429.31"/>
<text text-anchor="middle" x="585.5" y="-487.77" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer0_exp1 -->
<g id="node8" class="node">
<title>layer0_exp1</title>
<polygon fill="lightblue" stroke="black" points="831.5,-418.97 644.5,-418.97 644.5,-366.97 831.5,-366.97 831.5,-418.97"/>
<text text-anchor="middle" x="738" y="-406.97" font-family="Times,serif" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="738" y="-395.97" font-family="Times,serif" font-size="10.00">Input: [tokens_to_exp1, 4096]</text>
<text text-anchor="middle" x="738" y="-384.97" font-family="Times,serif" font-size="10.00">Output: [tokens_from_exp1, 4096]</text>
<text text-anchor="middle" x="738" y="-373.97" font-family="Times,serif" font-size="10.00">GPU: 1</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_exp1 -->
<g id="edge8" class="edge">
<title>layer0_gate&#45;&gt;layer0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M738,-516.92C738,-516.92 738,-429.31 738,-429.31"/>
<polygon fill="black" stroke="black" points="741.5,-429.31 738,-419.31 734.5,-429.31 741.5,-429.31"/>
<text text-anchor="middle" x="725.5" y="-487.77" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer0_exp8 -->
<g id="node9" class="node">
<title>layer0_exp8</title>
<polygon fill="lightblue" stroke="black" points="210.5,-418.97 23.5,-418.97 23.5,-366.97 210.5,-366.97 210.5,-418.97"/>
<text text-anchor="middle" x="117" y="-406.97" font-family="Times,serif" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="117" y="-395.97" font-family="Times,serif" font-size="10.00">Input: [tokens_to_exp8, 4096]</text>
<text text-anchor="middle" x="117" y="-384.97" font-family="Times,serif" font-size="10.00">Output: [tokens_from_exp8, 4096]</text>
<text text-anchor="middle" x="117" y="-373.97" font-family="Times,serif" font-size="10.00">GPU: 8</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_exp8 -->
<g id="edge9" class="edge">
<title>layer0_gate&#45;&gt;layer0_exp8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M469.95,-579C314.5,-579 117,-579 117,-579 117,-579 117,-429.23 117,-429.23"/>
<polygon fill="black" stroke="black" points="120.5,-429.23 117,-419.23 113.5,-429.23 120.5,-429.23"/>
<text text-anchor="middle" x="236.5" y="-487.77" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer0_exp15 -->
<g id="node10" class="node">
<title>layer0_exp15</title>
<polygon fill="lightblue" stroke="black" points="421.5,-418.97 228.5,-418.97 228.5,-366.97 421.5,-366.97 421.5,-418.97"/>
<text text-anchor="middle" x="325" y="-406.97" font-family="Times,serif" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="325" y="-395.97" font-family="Times,serif" font-size="10.00">Input: [tokens_to_exp15, 4096]</text>
<text text-anchor="middle" x="325" y="-384.97" font-family="Times,serif" font-size="10.00">Output: [tokens_from_exp15, 4096]</text>
<text text-anchor="middle" x="325" y="-373.97" font-family="Times,serif" font-size="10.00">GPU: 15</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_exp15 -->
<g id="edge10" class="edge">
<title>layer0_gate&#45;&gt;layer0_exp15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M431.67,-579.83C431.67,-574.14 431.67,-392 431.67,-392 431.67,-392 430.69,-392 430.69,-392"/>
<polygon fill="black" stroke="black" points="431.83,-388.5 421.83,-392 431.83,-395.5 431.83,-388.5"/>
<text text-anchor="middle" x="424.5" y="-487.77" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- comm_0_to_1 -->
<g id="node13" class="node">
<title>comm_0_to_1</title>
<ellipse fill="orange" stroke="black" cx="1483" cy="-392.97" rx="93.18" ry="28.98"/>
<text text-anchor="middle" x="1483" y="-401.47" font-family="Times,serif" font-size="10.00">Token Send</text>
<text text-anchor="middle" x="1483" y="-390.47" font-family="Times,serif" font-size="10.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="1483" y="-379.47" font-family="Times,serif" font-size="10.00">[variable_tokens, 4096]</text>
</g>
<!-- layer0_gate&#45;&gt;comm_0_to_1 -->
<g id="edge11" class="edge">
<title>layer0_gate&#45;&gt;comm_0_to_1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M820.76,-558C1062.84,-558 1483,-558 1483,-558 1483,-558 1483,-432.1 1483,-432.1"/>
<polygon fill="black" stroke="black" points="1486.5,-432.1 1483,-422.1 1479.5,-432.1 1486.5,-432.1"/>
</g>
<!-- comm_0_to_8 -->
<g id="node14" class="node">
<title>comm_0_to_8</title>
<ellipse fill="orange" stroke="black" cx="1688" cy="-392.97" rx="93.18" ry="28.98"/>
<text text-anchor="middle" x="1688" y="-401.47" font-family="Times,serif" font-size="10.00">Token Send</text>
<text text-anchor="middle" x="1688" y="-390.47" font-family="Times,serif" font-size="10.00">GPU 0 → GPU 8</text>
<text text-anchor="middle" x="1688" y="-379.47" font-family="Times,serif" font-size="10.00">[variable_tokens, 4096]</text>
</g>
<!-- layer0_gate&#45;&gt;comm_0_to_8 -->
<g id="edge12" class="edge">
<title>layer0_gate&#45;&gt;comm_0_to_8</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M852.45,-600C1152.74,-600 1688,-600 1688,-600 1688,-600 1688,-432.2 1688,-432.2"/>
<polygon fill="black" stroke="black" points="1691.5,-432.2 1688,-422.2 1684.5,-432.2 1691.5,-432.2"/>
</g>
<!-- layer0_aggregate -->
<g id="node11" class="node">
<title>layer0_aggregate</title>
<polygon fill="lightyellow" stroke="black" points="848.51,-312.98 500.91,-312.98 411.49,-186.98 759.09,-186.98 848.51,-312.98"/>
<text text-anchor="middle" x="630" y="-269.48" font-family="Times,serif" font-size="10.00">Token Aggregation</text>
<text text-anchor="middle" x="630" y="-258.48" font-family="Times,serif" font-size="10.00">Gather from all experts</text>
<text text-anchor="middle" x="630" y="-247.48" font-family="Times,serif" font-size="10.00">Input: [per_expert_outputs]</text>
<text text-anchor="middle" x="630" y="-236.48" font-family="Times,serif" font-size="10.00">Output: [batch=128, seq=10000, 4096]</text>
<text text-anchor="middle" x="630" y="-225.48" font-family="Times,serif" font-size="10.00">GPU: 0</text>
</g>
<!-- layer0_exp0&#45;&gt;layer0_aggregate -->
<g id="edge19" class="edge">
<title>layer0_exp0&#45;&gt;layer0_aggregate</title>
<path fill="none" stroke="black" d="M533,-366.75C533,-366.75 533,-323.17 533,-323.17"/>
<polygon fill="black" stroke="black" points="536.5,-323.17 533,-313.17 529.5,-323.17 536.5,-323.17"/>
</g>
<!-- comm_1_to_0 -->
<g id="node15" class="node">
<title>comm_1_to_0</title>
<ellipse fill="orange" stroke="black" cx="1051" cy="-392.97" rx="101.23" ry="28.98"/>
<text text-anchor="middle" x="1051" y="-401.47" font-family="Times,serif" font-size="10.00">Expert Result</text>
<text text-anchor="middle" x="1051" y="-390.47" font-family="Times,serif" font-size="10.00">GPU 1 → GPU 0</text>
<text text-anchor="middle" x="1051" y="-379.47" font-family="Times,serif" font-size="10.00">[processed_tokens, 4096]</text>
</g>
<!-- layer0_exp1&#45;&gt;comm_1_to_0 -->
<g id="edge15" class="edge">
<title>layer0_exp1&#45;&gt;comm_1_to_0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M831.91,-401C831.91,-401 943.63,-401 943.63,-401"/>
<polygon fill="black" stroke="black" points="943.63,-404.5 953.63,-401 943.63,-397.5 943.63,-404.5"/>
</g>
<!-- comm_8_to_0 -->
<g id="node16" class="node">
<title>comm_8_to_0</title>
<ellipse fill="orange" stroke="black" cx="1271" cy="-392.97" rx="101.23" ry="28.98"/>
<text text-anchor="middle" x="1271" y="-401.47" font-family="Times,serif" font-size="10.00">Expert Result</text>
<text text-anchor="middle" x="1271" y="-390.47" font-family="Times,serif" font-size="10.00">GPU 8 → GPU 0</text>
<text text-anchor="middle" x="1271" y="-379.47" font-family="Times,serif" font-size="10.00">[processed_tokens, 4096]</text>
</g>
<!-- layer0_exp8&#45;&gt;comm_8_to_0 -->
<g id="edge16" class="edge">
<title>layer0_exp8&#45;&gt;comm_8_to_0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M148.17,-366.63C148.17,-358.2 148.17,-351 148.17,-351 148.17,-351 1237.29,-351 1237.29,-351 1237.29,-351 1237.29,-355.21 1237.29,-355.21"/>
<polygon fill="black" stroke="black" points="1233.79,-355.21 1237.29,-365.21 1240.79,-355.21 1233.79,-355.21"/>
</g>
<!-- layer0_exp15&#45;&gt;layer0_aggregate -->
<g id="edge20" class="edge">
<title>layer0_exp15&#45;&gt;layer0_aggregate</title>
<path fill="none" stroke="black" d="M416.37,-366.75C416.37,-366.75 416.37,-260.04 416.37,-260.04"/>
<polygon fill="black" stroke="black" points="419.87,-260.04 416.37,-250.04 412.87,-260.04 419.87,-260.04"/>
</g>
<!-- layer0_aggregate&#45;&gt;layer0_exp_res -->
<g id="edge21" class="edge">
<title>layer0_aggregate&#45;&gt;layer0_exp_res</title>
<path fill="none" stroke="black" d="M724,-186.91C724,-186.91 724,-160.1 724,-160.1"/>
<polygon fill="black" stroke="black" points="727.5,-160.1 724,-150.1 720.5,-160.1 727.5,-160.1"/>
</g>
<!-- output -->
<g id="node17" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="724" cy="-28.99" rx="212.68" ry="28.98"/>
<text text-anchor="middle" x="724" y="-37.49" font-family="Times,serif" font-size="10.00">Output</text>
<text text-anchor="middle" x="724" y="-26.49" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="724" y="-15.49" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden=4096]</text>
</g>
<!-- layer0_exp_res&#45;&gt;output -->
<g id="edge23" class="edge">
<title>layer0_exp_res&#45;&gt;output</title>
<path fill="none" stroke="black" d="M724,-108.66C724,-108.66 724,-68.17 724,-68.17"/>
<polygon fill="black" stroke="black" points="727.5,-68.17 724,-58.17 720.5,-68.17 727.5,-68.17"/>
<text text-anchor="middle" x="804.5" y="-79.78" font-family="Times,serif" font-size="14.00">After 16 similar layers</text>
</g>
<!-- comm_0_to_1&#45;&gt;layer0_exp1 -->
<g id="edge13" class="edge">
<title>comm_0_to_1&#45;&gt;layer0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M1483,-363.88C1483,-350.69 1483,-338 1483,-338 1483,-338 738,-338 738,-338 738,-338 738,-356.78 738,-356.78"/>
<polygon fill="black" stroke="black" points="734.5,-356.78 738,-366.78 741.5,-356.78 734.5,-356.78"/>
<text text-anchor="middle" x="873" y="-487.77" font-family="Times,serif" font-size="14.00">tokens</text>
</g>
<!-- comm_0_to_8&#45;&gt;layer0_exp8 -->
<g id="edge14" class="edge">
<title>comm_0_to_8&#45;&gt;layer0_exp8</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M1688,-363.75C1688,-345.33 1688,-325 1688,-325 1688,-325 85.83,-325 85.83,-325 85.83,-325 85.83,-356.89 85.83,-356.89"/>
<polygon fill="black" stroke="black" points="82.33,-356.89 85.83,-366.89 89.33,-356.89 82.33,-356.89"/>
<text text-anchor="middle" x="813" y="-487.77" font-family="Times,serif" font-size="14.00">tokens</text>
</g>
<!-- comm_1_to_0&#45;&gt;layer0_aggregate -->
<g id="edge17" class="edge">
<title>comm_1_to_0&#45;&gt;layer0_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M954.82,-384C899.2,-384 840.13,-384 840.13,-384 840.13,-384 840.13,-260.08 840.13,-260.08"/>
<polygon fill="black" stroke="black" points="843.63,-260.08 840.13,-250.08 836.63,-260.08 843.63,-260.08"/>
<text text-anchor="middle" x="996" y="-334.78" font-family="Times,serif" font-size="14.00">results</text>
</g>
<!-- comm_8_to_0&#45;&gt;layer0_aggregate -->
<g id="edge18" class="edge">
<title>comm_8_to_0&#45;&gt;layer0_aggregate</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M1304.71,-365.55C1304.71,-323.78 1304.71,-249 1304.71,-249 1304.71,-249 813.32,-249 813.32,-249"/>
<polygon fill="black" stroke="black" points="813.32,-245.5 803.32,-249 813.32,-252.5 813.32,-245.5"/>
<text text-anchor="middle" x="1182" y="-334.78" font-family="Times,serif" font-size="14.00">results</text>
</g>
<!-- note1 -->
<g id="node18" class="node">
<title>note1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1130.5,-1123.96 973.5,-1123.96 973.5,-1071.96 1136.5,-1071.96 1136.5,-1117.96 1130.5,-1123.96"/>
<polyline fill="none" stroke="black" stroke-dasharray="5,2" points="1130.5,-1123.96 1130.5,-1117.96 "/>
<polyline fill="none" stroke="black" stroke-dasharray="5,2" points="1136.5,-1117.96 1130.5,-1117.96 "/>
<text text-anchor="middle" x="1055" y="-1111.96" font-family="Times,serif" font-size="10.00">Note: Layer 1&#45;15</text>
<text text-anchor="middle" x="1055" y="-1100.96" font-family="Times,serif" font-size="10.00">repeat similar patterns</text>
<text text-anchor="middle" x="1055" y="-1089.96" font-family="Times,serif" font-size="10.00">with different GPU mappings</text>
<text text-anchor="middle" x="1055" y="-1078.96" font-family="Times,serif" font-size="10.00">(layer_x: GPUs 16&#45;31, etc.)</text>
</g>
<!-- note2 -->
<g id="node19" class="node">
<title>note2</title>
<polygon fill="lightgray" stroke="black" points="1349.5,-1118.46 1154.5,-1118.46 1154.5,-1077.46 1355.5,-1077.46 1355.5,-1112.46 1349.5,-1118.46"/>
<polyline fill="none" stroke="black" points="1349.5,-1118.46 1349.5,-1112.46 "/>
<polyline fill="none" stroke="black" points="1355.5,-1112.46 1349.5,-1112.46 "/>
<text text-anchor="middle" x="1255" y="-1106.46" font-family="Times,serif" font-size="10.00">Key Innovation: One expert per GPU</text>
<text text-anchor="middle" x="1255" y="-1095.46" font-family="Times,serif" font-size="10.00">Minimizes contention</text>
<text text-anchor="middle" x="1255" y="-1084.46" font-family="Times,serif" font-size="10.00">Enables async communication</text>
</g>
</g>
</svg>
