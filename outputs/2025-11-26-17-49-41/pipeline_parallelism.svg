<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Pipeline_Parallelism Pages: 1 -->
<svg width="3184pt" height="156pt"
 viewBox="0.00 0.00 3184.45 155.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 151.74)">
<title>Pipeline_Parallelism</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-151.74 3180.45,-151.74 3180.45,4 -4,4"/>
<text text-anchor="middle" x="1588.22" y="-7.8" font-family="Times,serif" font-size="14.00">Pipeline Parallelism Across Model Layers</text>
<!-- pp_input -->
<g id="node1" class="node">
<title>pp_input</title>
<ellipse fill="lightgrey" stroke="black" cx="145.66" cy="-49.87" rx="145.83" ry="26.74"/>
<text text-anchor="middle" x="145.66" y="-53.67" font-family="Times,serif" font-size="14.00">Input Batch</text>
<text text-anchor="middle" x="145.66" y="-38.67" font-family="Times,serif" font-size="14.00">Micro&#45;batched for pipeline</text>
</g>
<!-- pp_stage_0 -->
<g id="node2" class="node">
<title>pp_stage_0</title>
<polygon fill="lightblue" stroke="black" points="196.16,-147.37 95.16,-147.37 95.16,-94.37 196.16,-94.37 196.16,-147.37"/>
<text text-anchor="middle" x="145.66" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="145.66" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 1&#45;8</text>
<text text-anchor="middle" x="145.66" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 0&#45;231</text>
</g>
<!-- pp_comm_0 -->
<g id="node10" class="node">
<title>pp_comm_0</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="417.84" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="417.84" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="417.84" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_0&#45;&gt;pp_comm_0 -->
<g id="edge1" class="edge">
<title>pp_stage_0&#45;&gt;pp_comm_0</title>
<path fill="none" stroke="black" d="M196.22,-120.87C196.22,-120.87 317.07,-120.87 317.07,-120.87"/>
<polygon fill="black" stroke="black" points="317.07,-124.37 327.07,-120.87 317.07,-117.37 317.07,-124.37"/>
</g>
<!-- pp_stage_1 -->
<g id="node3" class="node">
<title>pp_stage_1</title>
<polygon fill="lightblue" stroke="black" points="663.35,-147.37 544.35,-147.37 544.35,-94.37 663.35,-94.37 663.35,-147.37"/>
<text text-anchor="middle" x="603.85" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="603.85" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 9&#45;16</text>
<text text-anchor="middle" x="603.85" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 232&#45;463</text>
</g>
<!-- pp_comm_1 -->
<g id="node11" class="node">
<title>pp_comm_1</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="789.86" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="789.86" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="789.86" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_1&#45;&gt;pp_comm_1 -->
<g id="edge3" class="edge">
<title>pp_stage_1&#45;&gt;pp_comm_1</title>
<path fill="none" stroke="black" d="M663.47,-120.87C663.47,-120.87 689.07,-120.87 689.07,-120.87"/>
<polygon fill="black" stroke="black" points="689.07,-124.37 699.07,-120.87 689.07,-117.37 689.07,-124.37"/>
</g>
<!-- pp_stage_2 -->
<g id="node4" class="node">
<title>pp_stage_2</title>
<polygon fill="lightblue" stroke="black" points="1035.37,-147.37 916.37,-147.37 916.37,-94.37 1035.37,-94.37 1035.37,-147.37"/>
<text text-anchor="middle" x="975.87" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="975.87" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 17&#45;24</text>
<text text-anchor="middle" x="975.87" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 464&#45;695</text>
</g>
<!-- pp_comm_2 -->
<g id="node12" class="node">
<title>pp_comm_2</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1161.88" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="1161.88" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="1161.88" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_2&#45;&gt;pp_comm_2 -->
<g id="edge5" class="edge">
<title>pp_stage_2&#45;&gt;pp_comm_2</title>
<path fill="none" stroke="black" d="M1035.49,-120.87C1035.49,-120.87 1061.08,-120.87 1061.08,-120.87"/>
<polygon fill="black" stroke="black" points="1061.08,-124.37 1071.08,-120.87 1061.08,-117.37 1061.08,-124.37"/>
</g>
<!-- pp_stage_3 -->
<g id="node5" class="node">
<title>pp_stage_3</title>
<polygon fill="lightblue" stroke="black" points="1407.39,-147.37 1288.39,-147.37 1288.39,-94.37 1407.39,-94.37 1407.39,-147.37"/>
<text text-anchor="middle" x="1347.89" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1347.89" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 25&#45;32</text>
<text text-anchor="middle" x="1347.89" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 696&#45;927</text>
</g>
<!-- pp_comm_3 -->
<g id="node13" class="node">
<title>pp_comm_3</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1533.9" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="1533.9" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="1533.9" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_3&#45;&gt;pp_comm_3 -->
<g id="edge7" class="edge">
<title>pp_stage_3&#45;&gt;pp_comm_3</title>
<path fill="none" stroke="black" d="M1407.51,-120.87C1407.51,-120.87 1433.1,-120.87 1433.1,-120.87"/>
<polygon fill="black" stroke="black" points="1433.1,-124.37 1443.1,-120.87 1433.1,-117.37 1433.1,-124.37"/>
</g>
<!-- pp_stage_4 -->
<g id="node6" class="node">
<title>pp_stage_4</title>
<polygon fill="lightblue" stroke="black" points="1788.41,-147.37 1660.41,-147.37 1660.41,-94.37 1788.41,-94.37 1788.41,-147.37"/>
<text text-anchor="middle" x="1724.41" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1724.41" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 33&#45;40</text>
<text text-anchor="middle" x="1724.41" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 928&#45;1159</text>
</g>
<!-- pp_comm_4 -->
<g id="node14" class="node">
<title>pp_comm_4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1914.92" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="1914.92" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="1914.92" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_4&#45;&gt;pp_comm_4 -->
<g id="edge9" class="edge">
<title>pp_stage_4&#45;&gt;pp_comm_4</title>
<path fill="none" stroke="black" d="M1788.64,-120.87C1788.64,-120.87 1814.23,-120.87 1814.23,-120.87"/>
<polygon fill="black" stroke="black" points="1814.23,-124.37 1824.23,-120.87 1814.23,-117.37 1814.23,-124.37"/>
</g>
<!-- pp_stage_5 -->
<g id="node7" class="node">
<title>pp_stage_5</title>
<polygon fill="lightblue" stroke="black" points="2178.42,-147.37 2041.42,-147.37 2041.42,-94.37 2178.42,-94.37 2178.42,-147.37"/>
<text text-anchor="middle" x="2109.92" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="2109.92" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 41&#45;48</text>
<text text-anchor="middle" x="2109.92" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 1160&#45;1391</text>
</g>
<!-- pp_comm_5 -->
<g id="node15" class="node">
<title>pp_comm_5</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2304.93" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="2304.93" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="2304.93" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_5&#45;&gt;pp_comm_5 -->
<g id="edge11" class="edge">
<title>pp_stage_5&#45;&gt;pp_comm_5</title>
<path fill="none" stroke="black" d="M2178.68,-120.87C2178.68,-120.87 2204.26,-120.87 2204.26,-120.87"/>
<polygon fill="black" stroke="black" points="2204.26,-124.37 2214.26,-120.87 2204.26,-117.37 2204.26,-124.37"/>
</g>
<!-- pp_stage_6 -->
<g id="node8" class="node">
<title>pp_stage_6</title>
<polygon fill="lightblue" stroke="black" points="2568.44,-147.37 2431.44,-147.37 2431.44,-94.37 2568.44,-94.37 2568.44,-147.37"/>
<text text-anchor="middle" x="2499.94" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="2499.94" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 49&#45;56</text>
<text text-anchor="middle" x="2499.94" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 1392&#45;1623</text>
</g>
<!-- pp_comm_6 -->
<g id="node16" class="node">
<title>pp_comm_6</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2694.95" cy="-120.87" rx="90.52" ry="26.74"/>
<text text-anchor="middle" x="2694.95" y="-124.67" font-family="Times,serif" font-size="14.00">Inter&#45;stage</text>
<text text-anchor="middle" x="2694.95" y="-109.67" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- pp_stage_6&#45;&gt;pp_comm_6 -->
<g id="edge13" class="edge">
<title>pp_stage_6&#45;&gt;pp_comm_6</title>
<path fill="none" stroke="black" d="M2568.7,-120.87C2568.7,-120.87 2594.28,-120.87 2594.28,-120.87"/>
<polygon fill="black" stroke="black" points="2594.28,-124.37 2604.28,-120.87 2594.28,-117.37 2594.28,-124.37"/>
</g>
<!-- pp_stage_7 -->
<g id="node9" class="node">
<title>pp_stage_7</title>
<polygon fill="lightblue" stroke="black" points="2958.46,-147.37 2821.46,-147.37 2821.46,-94.37 2958.46,-94.37 2958.46,-147.37"/>
<text text-anchor="middle" x="2889.96" y="-132.17" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="2889.96" y="-117.17" font-family="Times,serif" font-size="14.00">Layers 57&#45;64</text>
<text text-anchor="middle" x="2889.96" y="-102.17" font-family="Times,serif" font-size="14.00">GPUs 1624&#45;1855</text>
</g>
<!-- pp_output -->
<g id="node17" class="node">
<title>pp_output</title>
<ellipse fill="lightgrey" stroke="black" cx="3085.46" cy="-120.87" rx="90.98" ry="18"/>
<text text-anchor="middle" x="3085.46" y="-117.17" font-family="Times,serif" font-size="14.00">Output Sequence</text>
</g>
<!-- pp_stage_7&#45;&gt;pp_output -->
<g id="edge15" class="edge">
<title>pp_stage_7&#45;&gt;pp_output</title>
<path fill="none" stroke="black" d="M2958.61,-120.87C2958.61,-120.87 2984.33,-120.87 2984.33,-120.87"/>
<polygon fill="black" stroke="black" points="2984.33,-124.37 2994.33,-120.87 2984.33,-117.37 2984.33,-124.37"/>
</g>
<!-- pp_comm_0&#45;&gt;pp_stage_1 -->
<g id="edge2" class="edge">
<title>pp_comm_0&#45;&gt;pp_stage_1</title>
<path fill="none" stroke="black" d="M508.39,-120.87C508.39,-120.87 534.31,-120.87 534.31,-120.87"/>
<polygon fill="black" stroke="black" points="534.31,-124.37 544.31,-120.87 534.31,-117.37 534.31,-124.37"/>
</g>
<!-- pp_comm_1&#45;&gt;pp_stage_2 -->
<g id="edge4" class="edge">
<title>pp_comm_1&#45;&gt;pp_stage_2</title>
<path fill="none" stroke="black" d="M880.41,-120.87C880.41,-120.87 906.33,-120.87 906.33,-120.87"/>
<polygon fill="black" stroke="black" points="906.33,-124.37 916.33,-120.87 906.33,-117.37 906.33,-124.37"/>
</g>
<!-- pp_comm_2&#45;&gt;pp_stage_3 -->
<g id="edge6" class="edge">
<title>pp_comm_2&#45;&gt;pp_stage_3</title>
<path fill="none" stroke="black" d="M1252.43,-120.87C1252.43,-120.87 1278.35,-120.87 1278.35,-120.87"/>
<polygon fill="black" stroke="black" points="1278.35,-124.37 1288.35,-120.87 1278.35,-117.37 1278.35,-124.37"/>
</g>
<!-- pp_comm_3&#45;&gt;pp_stage_4 -->
<g id="edge8" class="edge">
<title>pp_comm_3&#45;&gt;pp_stage_4</title>
<path fill="none" stroke="black" d="M1624.41,-120.87C1624.41,-120.87 1650.22,-120.87 1650.22,-120.87"/>
<polygon fill="black" stroke="black" points="1650.22,-124.37 1660.22,-120.87 1650.22,-117.37 1650.22,-124.37"/>
</g>
<!-- pp_comm_4&#45;&gt;pp_stage_5 -->
<g id="edge10" class="edge">
<title>pp_comm_4&#45;&gt;pp_stage_5</title>
<path fill="none" stroke="black" d="M2005.57,-120.87C2005.57,-120.87 2031.36,-120.87 2031.36,-120.87"/>
<polygon fill="black" stroke="black" points="2031.36,-124.37 2041.36,-120.87 2031.36,-117.37 2031.36,-124.37"/>
</g>
<!-- pp_comm_5&#45;&gt;pp_stage_6 -->
<g id="edge12" class="edge">
<title>pp_comm_5&#45;&gt;pp_stage_6</title>
<path fill="none" stroke="black" d="M2395.59,-120.87C2395.59,-120.87 2421.38,-120.87 2421.38,-120.87"/>
<polygon fill="black" stroke="black" points="2421.38,-124.37 2431.38,-120.87 2421.38,-117.37 2421.38,-124.37"/>
</g>
<!-- pp_comm_6&#45;&gt;pp_stage_7 -->
<g id="edge14" class="edge">
<title>pp_comm_6&#45;&gt;pp_stage_7</title>
<path fill="none" stroke="black" d="M2785.61,-120.87C2785.61,-120.87 2811.39,-120.87 2811.39,-120.87"/>
<polygon fill="black" stroke="black" points="2811.39,-124.37 2821.39,-120.87 2811.39,-117.37 2811.39,-124.37"/>
</g>
</g>
</svg>
