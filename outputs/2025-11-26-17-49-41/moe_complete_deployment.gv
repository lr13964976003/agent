// Complete Large-Scale Cross-Node Expert Parallelism DAG
digraph MOE_Large_Scale_Deployment {
	graph [concentrate=true nodesep=0.8 rankdir=TB ranksep=2.0 splines=ortho]
	subgraph cluster_legend {
		color=lightgrey label=Legend style="rounded,filled"
		legend_compute [label="Computation
(MLP, Attention)" fillcolor=lightblue shape=rectangle style=filled]
		legend_comm [label="Communication
(Token Transfer)" fillcolor=lightgreen shape=ellipse style=filled]
		legend_route [label="Routing
(Gating, Aggregation)" fillcolor=lightyellow shape=parallelogram style=filled]
	}
	subgraph cluster_dense_layer_1 {
		color=lightblue label="Dense Layer 1" style="rounded,filled"
		mha_layer_1_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_1_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		ffn_layer_1_gpu_0 [label="Feed-Forward Network
GPU: 0
Input: [batch_size=4, seq_len=2048, dim=7168]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_1_gpu_0_ffn [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
	}
	subgraph cluster_dense_layer_2 {
		color=lightblue label="Dense Layer 2" style="rounded,filled"
		mha_layer_2_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_2_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		ffn_layer_2_gpu_0 [label="Feed-Forward Network
GPU: 0
Input: [batch_size=4, seq_len=2048, dim=7168]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_2_gpu_0_ffn [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
	}
	subgraph cluster_dense_layer_3 {
		color=lightblue label="Dense Layer 3" style="rounded,filled"
		mha_layer_3_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_3_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		ffn_layer_3_gpu_0 [label="Feed-Forward Network
GPU: 0
Input: [batch_size=4, seq_len=2048, dim=7168]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_3_gpu_0_ffn [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
	}
	subgraph cluster_moe_layer_4 {
		color=lightgreen label="MoE Layer 4 (32 Experts)" style="rounded,filled"
		mha_layer_4_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_4_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_4_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_4 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_4_gpu_0 [label="Expert 0
GPU: 0
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_4_gpu_1 [label="Expert 1
GPU: 1
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_4_gpu_2 [label="Expert 2
GPU: 2
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_4_gpu_3 [label="Expert 3
GPU: 3
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_4_gpu_4 [label="Expert 4
GPU: 4
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_4_gpu_5 [label="Expert 5
GPU: 5
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_4_gpu_6 [label="Expert 6
GPU: 6
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_4_gpu_7 [label="Expert 7
GPU: 7
Node: 0
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_4_gpu_8 [label="Expert 8
GPU: 8
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_4_gpu_9 [label="Expert 9
GPU: 9
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_4_gpu_10 [label="Expert 10
GPU: 10
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_4_gpu_11 [label="Expert 11
GPU: 11
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_4_gpu_12 [label="Expert 12
GPU: 12
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_4_gpu_13 [label="Expert 13
GPU: 13
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_4_gpu_14 [label="Expert 14
GPU: 14
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_4_gpu_15 [label="Expert 15
GPU: 15
Node: 1
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_4_gpu_16 [label="Expert 16
GPU: 16
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_4_gpu_17 [label="Expert 17
GPU: 17
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_4_gpu_18 [label="Expert 18
GPU: 18
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_4_gpu_19 [label="Expert 19
GPU: 19
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_4_gpu_20 [label="Expert 20
GPU: 20
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_4_gpu_21 [label="Expert 21
GPU: 21
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_4_gpu_22 [label="Expert 22
GPU: 22
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_4_gpu_23 [label="Expert 23
GPU: 23
Node: 2
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_4_gpu_24 [label="Expert 24
GPU: 24
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_4_gpu_25 [label="Expert 25
GPU: 25
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_4_gpu_26 [label="Expert 26
GPU: 26
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_4_gpu_27 [label="Expert 27
GPU: 27
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_4_gpu_28 [label="Expert 28
GPU: 28
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_4_gpu_29 [label="Expert 29
GPU: 29
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_4_gpu_30 [label="Expert 30
GPU: 30
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_4_gpu_31 [label="Expert 31
GPU: 31
Node: 3
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_4 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_5 {
		color=lightgreen label="MoE Layer 5 (32 Experts)" style="rounded,filled"
		mha_layer_5_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_5_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_5_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_5 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_5_gpu_32 [label="Expert 0
GPU: 32
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_5_gpu_33 [label="Expert 1
GPU: 33
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_5_gpu_34 [label="Expert 2
GPU: 34
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_5_gpu_35 [label="Expert 3
GPU: 35
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_5_gpu_36 [label="Expert 4
GPU: 36
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_5_gpu_37 [label="Expert 5
GPU: 37
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_5_gpu_38 [label="Expert 6
GPU: 38
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_5_gpu_39 [label="Expert 7
GPU: 39
Node: 4
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_5_gpu_40 [label="Expert 8
GPU: 40
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_5_gpu_41 [label="Expert 9
GPU: 41
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_5_gpu_42 [label="Expert 10
GPU: 42
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_5_gpu_43 [label="Expert 11
GPU: 43
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_5_gpu_44 [label="Expert 12
GPU: 44
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_5_gpu_45 [label="Expert 13
GPU: 45
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_5_gpu_46 [label="Expert 14
GPU: 46
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_5_gpu_47 [label="Expert 15
GPU: 47
Node: 5
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_5_gpu_48 [label="Expert 16
GPU: 48
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_5_gpu_49 [label="Expert 17
GPU: 49
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_5_gpu_50 [label="Expert 18
GPU: 50
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_5_gpu_51 [label="Expert 19
GPU: 51
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_5_gpu_52 [label="Expert 20
GPU: 52
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_5_gpu_53 [label="Expert 21
GPU: 53
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_5_gpu_54 [label="Expert 22
GPU: 54
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_5_gpu_55 [label="Expert 23
GPU: 55
Node: 6
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_5_gpu_56 [label="Expert 24
GPU: 56
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_5_gpu_57 [label="Expert 25
GPU: 57
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_5_gpu_58 [label="Expert 26
GPU: 58
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_5_gpu_59 [label="Expert 27
GPU: 59
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_5_gpu_60 [label="Expert 28
GPU: 60
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_5_gpu_61 [label="Expert 29
GPU: 61
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_5_gpu_62 [label="Expert 30
GPU: 62
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_5_gpu_63 [label="Expert 31
GPU: 63
Node: 7
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_5 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_6 {
		color=lightgreen label="MoE Layer 6 (32 Experts)" style="rounded,filled"
		mha_layer_6_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_6_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_6_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_6 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_6_gpu_64 [label="Expert 0
GPU: 64
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_6_gpu_65 [label="Expert 1
GPU: 65
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_6_gpu_66 [label="Expert 2
GPU: 66
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_6_gpu_67 [label="Expert 3
GPU: 67
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_6_gpu_68 [label="Expert 4
GPU: 68
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_6_gpu_69 [label="Expert 5
GPU: 69
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_6_gpu_70 [label="Expert 6
GPU: 70
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_6_gpu_71 [label="Expert 7
GPU: 71
Node: 8
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_6_gpu_72 [label="Expert 8
GPU: 72
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_6_gpu_73 [label="Expert 9
GPU: 73
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_6_gpu_74 [label="Expert 10
GPU: 74
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_6_gpu_75 [label="Expert 11
GPU: 75
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_6_gpu_76 [label="Expert 12
GPU: 76
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_6_gpu_77 [label="Expert 13
GPU: 77
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_6_gpu_78 [label="Expert 14
GPU: 78
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_6_gpu_79 [label="Expert 15
GPU: 79
Node: 9
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_6_gpu_80 [label="Expert 16
GPU: 80
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_6_gpu_81 [label="Expert 17
GPU: 81
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_6_gpu_82 [label="Expert 18
GPU: 82
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_6_gpu_83 [label="Expert 19
GPU: 83
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_6_gpu_84 [label="Expert 20
GPU: 84
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_6_gpu_85 [label="Expert 21
GPU: 85
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_6_gpu_86 [label="Expert 22
GPU: 86
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_6_gpu_87 [label="Expert 23
GPU: 87
Node: 10
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_6_gpu_88 [label="Expert 24
GPU: 88
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_6_gpu_89 [label="Expert 25
GPU: 89
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_6_gpu_90 [label="Expert 26
GPU: 90
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_6_gpu_91 [label="Expert 27
GPU: 91
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_6_gpu_92 [label="Expert 28
GPU: 92
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_6_gpu_93 [label="Expert 29
GPU: 93
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_6_gpu_94 [label="Expert 30
GPU: 94
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_6_gpu_95 [label="Expert 31
GPU: 95
Node: 11
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_6 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_7 {
		color=lightgreen label="MoE Layer 7 (32 Experts)" style="rounded,filled"
		mha_layer_7_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_7_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_7_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_7 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_7_gpu_96 [label="Expert 0
GPU: 96
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_7_gpu_97 [label="Expert 1
GPU: 97
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_7_gpu_98 [label="Expert 2
GPU: 98
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_7_gpu_99 [label="Expert 3
GPU: 99
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_7_gpu_100 [label="Expert 4
GPU: 100
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_7_gpu_101 [label="Expert 5
GPU: 101
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_7_gpu_102 [label="Expert 6
GPU: 102
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_7_gpu_103 [label="Expert 7
GPU: 103
Node: 12
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_7_gpu_104 [label="Expert 8
GPU: 104
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_7_gpu_105 [label="Expert 9
GPU: 105
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_7_gpu_106 [label="Expert 10
GPU: 106
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_7_gpu_107 [label="Expert 11
GPU: 107
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_7_gpu_108 [label="Expert 12
GPU: 108
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_7_gpu_109 [label="Expert 13
GPU: 109
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_7_gpu_110 [label="Expert 14
GPU: 110
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_7_gpu_111 [label="Expert 15
GPU: 111
Node: 13
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_7_gpu_112 [label="Expert 16
GPU: 112
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_7_gpu_113 [label="Expert 17
GPU: 113
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_7_gpu_114 [label="Expert 18
GPU: 114
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_7_gpu_115 [label="Expert 19
GPU: 115
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_7_gpu_116 [label="Expert 20
GPU: 116
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_7_gpu_117 [label="Expert 21
GPU: 117
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_7_gpu_118 [label="Expert 22
GPU: 118
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_7_gpu_119 [label="Expert 23
GPU: 119
Node: 14
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_7_gpu_120 [label="Expert 24
GPU: 120
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_7_gpu_121 [label="Expert 25
GPU: 121
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_7_gpu_122 [label="Expert 26
GPU: 122
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_7_gpu_123 [label="Expert 27
GPU: 123
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_7_gpu_124 [label="Expert 28
GPU: 124
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_7_gpu_125 [label="Expert 29
GPU: 125
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_7_gpu_126 [label="Expert 30
GPU: 126
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_7_gpu_127 [label="Expert 31
GPU: 127
Node: 15
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_7 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_8 {
		color=lightgreen label="MoE Layer 8 (32 Experts)" style="rounded,filled"
		mha_layer_8_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_8_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_8_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_8 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_8_gpu_128 [label="Expert 0
GPU: 128
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_8_gpu_129 [label="Expert 1
GPU: 129
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_8_gpu_130 [label="Expert 2
GPU: 130
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_8_gpu_131 [label="Expert 3
GPU: 131
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_8_gpu_132 [label="Expert 4
GPU: 132
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_8_gpu_133 [label="Expert 5
GPU: 133
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_8_gpu_134 [label="Expert 6
GPU: 134
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_8_gpu_135 [label="Expert 7
GPU: 135
Node: 16
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_8_gpu_136 [label="Expert 8
GPU: 136
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_8_gpu_137 [label="Expert 9
GPU: 137
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_8_gpu_138 [label="Expert 10
GPU: 138
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_8_gpu_139 [label="Expert 11
GPU: 139
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_8_gpu_140 [label="Expert 12
GPU: 140
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_8_gpu_141 [label="Expert 13
GPU: 141
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_8_gpu_142 [label="Expert 14
GPU: 142
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_8_gpu_143 [label="Expert 15
GPU: 143
Node: 17
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_8_gpu_144 [label="Expert 16
GPU: 144
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_8_gpu_145 [label="Expert 17
GPU: 145
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_8_gpu_146 [label="Expert 18
GPU: 146
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_8_gpu_147 [label="Expert 19
GPU: 147
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_8_gpu_148 [label="Expert 20
GPU: 148
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_8_gpu_149 [label="Expert 21
GPU: 149
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_8_gpu_150 [label="Expert 22
GPU: 150
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_8_gpu_151 [label="Expert 23
GPU: 151
Node: 18
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_8_gpu_152 [label="Expert 24
GPU: 152
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_8_gpu_153 [label="Expert 25
GPU: 153
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_8_gpu_154 [label="Expert 26
GPU: 154
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_8_gpu_155 [label="Expert 27
GPU: 155
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_8_gpu_156 [label="Expert 28
GPU: 156
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_8_gpu_157 [label="Expert 29
GPU: 157
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_8_gpu_158 [label="Expert 30
GPU: 158
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_8_gpu_159 [label="Expert 31
GPU: 159
Node: 19
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_8 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_9 {
		color=lightgreen label="MoE Layer 9 (32 Experts)" style="rounded,filled"
		mha_layer_9_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_9_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_9_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_9 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_9_gpu_160 [label="Expert 0
GPU: 160
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_9_gpu_161 [label="Expert 1
GPU: 161
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_9_gpu_162 [label="Expert 2
GPU: 162
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_9_gpu_163 [label="Expert 3
GPU: 163
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_9_gpu_164 [label="Expert 4
GPU: 164
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_9_gpu_165 [label="Expert 5
GPU: 165
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_9_gpu_166 [label="Expert 6
GPU: 166
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_9_gpu_167 [label="Expert 7
GPU: 167
Node: 20
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_9_gpu_168 [label="Expert 8
GPU: 168
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_9_gpu_169 [label="Expert 9
GPU: 169
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_9_gpu_170 [label="Expert 10
GPU: 170
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_9_gpu_171 [label="Expert 11
GPU: 171
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_9_gpu_172 [label="Expert 12
GPU: 172
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_9_gpu_173 [label="Expert 13
GPU: 173
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_9_gpu_174 [label="Expert 14
GPU: 174
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_9_gpu_175 [label="Expert 15
GPU: 175
Node: 21
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_9_gpu_176 [label="Expert 16
GPU: 176
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_9_gpu_177 [label="Expert 17
GPU: 177
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_9_gpu_178 [label="Expert 18
GPU: 178
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_9_gpu_179 [label="Expert 19
GPU: 179
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_9_gpu_180 [label="Expert 20
GPU: 180
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_9_gpu_181 [label="Expert 21
GPU: 181
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_9_gpu_182 [label="Expert 22
GPU: 182
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_9_gpu_183 [label="Expert 23
GPU: 183
Node: 22
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_9_gpu_184 [label="Expert 24
GPU: 184
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_9_gpu_185 [label="Expert 25
GPU: 185
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_9_gpu_186 [label="Expert 26
GPU: 186
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_9_gpu_187 [label="Expert 27
GPU: 187
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_9_gpu_188 [label="Expert 28
GPU: 188
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_9_gpu_189 [label="Expert 29
GPU: 189
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_9_gpu_190 [label="Expert 30
GPU: 190
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_9_gpu_191 [label="Expert 31
GPU: 191
Node: 23
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_9 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_10 {
		color=lightgreen label="MoE Layer 10 (32 Experts)" style="rounded,filled"
		mha_layer_10_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_10_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_10_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_10 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_10_gpu_192 [label="Expert 0
GPU: 192
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_10_gpu_193 [label="Expert 1
GPU: 193
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_10_gpu_194 [label="Expert 2
GPU: 194
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_10_gpu_195 [label="Expert 3
GPU: 195
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_10_gpu_196 [label="Expert 4
GPU: 196
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_10_gpu_197 [label="Expert 5
GPU: 197
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_10_gpu_198 [label="Expert 6
GPU: 198
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_10_gpu_199 [label="Expert 7
GPU: 199
Node: 24
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_10_gpu_200 [label="Expert 8
GPU: 200
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_10_gpu_201 [label="Expert 9
GPU: 201
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_10_gpu_202 [label="Expert 10
GPU: 202
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_10_gpu_203 [label="Expert 11
GPU: 203
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_10_gpu_204 [label="Expert 12
GPU: 204
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_10_gpu_205 [label="Expert 13
GPU: 205
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_10_gpu_206 [label="Expert 14
GPU: 206
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_10_gpu_207 [label="Expert 15
GPU: 207
Node: 25
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_10_gpu_208 [label="Expert 16
GPU: 208
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_10_gpu_209 [label="Expert 17
GPU: 209
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_10_gpu_210 [label="Expert 18
GPU: 210
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_10_gpu_211 [label="Expert 19
GPU: 211
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_10_gpu_212 [label="Expert 20
GPU: 212
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_10_gpu_213 [label="Expert 21
GPU: 213
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_10_gpu_214 [label="Expert 22
GPU: 214
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_10_gpu_215 [label="Expert 23
GPU: 215
Node: 26
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_10_gpu_216 [label="Expert 24
GPU: 216
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_10_gpu_217 [label="Expert 25
GPU: 217
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_10_gpu_218 [label="Expert 26
GPU: 218
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_10_gpu_219 [label="Expert 27
GPU: 219
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_10_gpu_220 [label="Expert 28
GPU: 220
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_10_gpu_221 [label="Expert 29
GPU: 221
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_10_gpu_222 [label="Expert 30
GPU: 222
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_10_gpu_223 [label="Expert 31
GPU: 223
Node: 27
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_10 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_11 {
		color=lightgreen label="MoE Layer 11 (32 Experts)" style="rounded,filled"
		mha_layer_11_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_11_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_11_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_11 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_11_gpu_224 [label="Expert 0
GPU: 224
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_11_gpu_225 [label="Expert 1
GPU: 225
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_11_gpu_226 [label="Expert 2
GPU: 226
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_11_gpu_227 [label="Expert 3
GPU: 227
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_11_gpu_228 [label="Expert 4
GPU: 228
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_11_gpu_229 [label="Expert 5
GPU: 229
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_11_gpu_230 [label="Expert 6
GPU: 230
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_11_gpu_231 [label="Expert 7
GPU: 231
Node: 28
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_11_gpu_232 [label="Expert 8
GPU: 232
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_11_gpu_233 [label="Expert 9
GPU: 233
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_11_gpu_234 [label="Expert 10
GPU: 234
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_11_gpu_235 [label="Expert 11
GPU: 235
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_11_gpu_236 [label="Expert 12
GPU: 236
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_11_gpu_237 [label="Expert 13
GPU: 237
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_11_gpu_238 [label="Expert 14
GPU: 238
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_11_gpu_239 [label="Expert 15
GPU: 239
Node: 29
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_11_gpu_240 [label="Expert 16
GPU: 240
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_11_gpu_241 [label="Expert 17
GPU: 241
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_11_gpu_242 [label="Expert 18
GPU: 242
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_11_gpu_243 [label="Expert 19
GPU: 243
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_11_gpu_244 [label="Expert 20
GPU: 244
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_11_gpu_245 [label="Expert 21
GPU: 245
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_11_gpu_246 [label="Expert 22
GPU: 246
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_11_gpu_247 [label="Expert 23
GPU: 247
Node: 30
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_11_gpu_248 [label="Expert 24
GPU: 248
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_11_gpu_249 [label="Expert 25
GPU: 249
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_11_gpu_250 [label="Expert 26
GPU: 250
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_11_gpu_251 [label="Expert 27
GPU: 251
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_11_gpu_252 [label="Expert 28
GPU: 252
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_11_gpu_253 [label="Expert 29
GPU: 253
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_11_gpu_254 [label="Expert 30
GPU: 254
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_11_gpu_255 [label="Expert 31
GPU: 255
Node: 31
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_11 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_12 {
		color=lightgreen label="MoE Layer 12 (32 Experts)" style="rounded,filled"
		mha_layer_12_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_12_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_12_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_12 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_12_gpu_256 [label="Expert 0
GPU: 256
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_12_gpu_257 [label="Expert 1
GPU: 257
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_12_gpu_258 [label="Expert 2
GPU: 258
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_12_gpu_259 [label="Expert 3
GPU: 259
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_12_gpu_260 [label="Expert 4
GPU: 260
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_12_gpu_261 [label="Expert 5
GPU: 261
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_12_gpu_262 [label="Expert 6
GPU: 262
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_12_gpu_263 [label="Expert 7
GPU: 263
Node: 32
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_12_gpu_264 [label="Expert 8
GPU: 264
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_12_gpu_265 [label="Expert 9
GPU: 265
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_12_gpu_266 [label="Expert 10
GPU: 266
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_12_gpu_267 [label="Expert 11
GPU: 267
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_12_gpu_268 [label="Expert 12
GPU: 268
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_12_gpu_269 [label="Expert 13
GPU: 269
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_12_gpu_270 [label="Expert 14
GPU: 270
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_12_gpu_271 [label="Expert 15
GPU: 271
Node: 33
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_12_gpu_272 [label="Expert 16
GPU: 272
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_12_gpu_273 [label="Expert 17
GPU: 273
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_12_gpu_274 [label="Expert 18
GPU: 274
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_12_gpu_275 [label="Expert 19
GPU: 275
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_12_gpu_276 [label="Expert 20
GPU: 276
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_12_gpu_277 [label="Expert 21
GPU: 277
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_12_gpu_278 [label="Expert 22
GPU: 278
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_12_gpu_279 [label="Expert 23
GPU: 279
Node: 34
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_12_gpu_280 [label="Expert 24
GPU: 280
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_12_gpu_281 [label="Expert 25
GPU: 281
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_12_gpu_282 [label="Expert 26
GPU: 282
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_12_gpu_283 [label="Expert 27
GPU: 283
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_12_gpu_284 [label="Expert 28
GPU: 284
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_12_gpu_285 [label="Expert 29
GPU: 285
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_12_gpu_286 [label="Expert 30
GPU: 286
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_12_gpu_287 [label="Expert 31
GPU: 287
Node: 35
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_12 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_13 {
		color=lightgreen label="MoE Layer 13 (32 Experts)" style="rounded,filled"
		mha_layer_13_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_13_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_13_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_13 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_13_gpu_288 [label="Expert 0
GPU: 288
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_13_gpu_289 [label="Expert 1
GPU: 289
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_13_gpu_290 [label="Expert 2
GPU: 290
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_13_gpu_291 [label="Expert 3
GPU: 291
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_13_gpu_292 [label="Expert 4
GPU: 292
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_13_gpu_293 [label="Expert 5
GPU: 293
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_13_gpu_294 [label="Expert 6
GPU: 294
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_13_gpu_295 [label="Expert 7
GPU: 295
Node: 36
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_13_gpu_296 [label="Expert 8
GPU: 296
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_13_gpu_297 [label="Expert 9
GPU: 297
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_13_gpu_298 [label="Expert 10
GPU: 298
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_13_gpu_299 [label="Expert 11
GPU: 299
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_13_gpu_300 [label="Expert 12
GPU: 300
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_13_gpu_301 [label="Expert 13
GPU: 301
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_13_gpu_302 [label="Expert 14
GPU: 302
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_13_gpu_303 [label="Expert 15
GPU: 303
Node: 37
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_13_gpu_304 [label="Expert 16
GPU: 304
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_13_gpu_305 [label="Expert 17
GPU: 305
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_13_gpu_306 [label="Expert 18
GPU: 306
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_13_gpu_307 [label="Expert 19
GPU: 307
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_13_gpu_308 [label="Expert 20
GPU: 308
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_13_gpu_309 [label="Expert 21
GPU: 309
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_13_gpu_310 [label="Expert 22
GPU: 310
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_13_gpu_311 [label="Expert 23
GPU: 311
Node: 38
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_13_gpu_312 [label="Expert 24
GPU: 312
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_13_gpu_313 [label="Expert 25
GPU: 313
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_13_gpu_314 [label="Expert 26
GPU: 314
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_13_gpu_315 [label="Expert 27
GPU: 315
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_13_gpu_316 [label="Expert 28
GPU: 316
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_13_gpu_317 [label="Expert 29
GPU: 317
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_13_gpu_318 [label="Expert 30
GPU: 318
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_13_gpu_319 [label="Expert 31
GPU: 319
Node: 39
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_13 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_14 {
		color=lightgreen label="MoE Layer 14 (32 Experts)" style="rounded,filled"
		mha_layer_14_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_14_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_14_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_14 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_14_gpu_320 [label="Expert 0
GPU: 320
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_14_gpu_321 [label="Expert 1
GPU: 321
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_14_gpu_322 [label="Expert 2
GPU: 322
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_14_gpu_323 [label="Expert 3
GPU: 323
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_14_gpu_324 [label="Expert 4
GPU: 324
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_14_gpu_325 [label="Expert 5
GPU: 325
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_14_gpu_326 [label="Expert 6
GPU: 326
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_14_gpu_327 [label="Expert 7
GPU: 327
Node: 40
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_14_gpu_328 [label="Expert 8
GPU: 328
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_14_gpu_329 [label="Expert 9
GPU: 329
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_14_gpu_330 [label="Expert 10
GPU: 330
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_14_gpu_331 [label="Expert 11
GPU: 331
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_14_gpu_332 [label="Expert 12
GPU: 332
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_14_gpu_333 [label="Expert 13
GPU: 333
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_14_gpu_334 [label="Expert 14
GPU: 334
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_14_gpu_335 [label="Expert 15
GPU: 335
Node: 41
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_14_gpu_336 [label="Expert 16
GPU: 336
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_14_gpu_337 [label="Expert 17
GPU: 337
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_14_gpu_338 [label="Expert 18
GPU: 338
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_14_gpu_339 [label="Expert 19
GPU: 339
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_14_gpu_340 [label="Expert 20
GPU: 340
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_14_gpu_341 [label="Expert 21
GPU: 341
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_14_gpu_342 [label="Expert 22
GPU: 342
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_14_gpu_343 [label="Expert 23
GPU: 343
Node: 42
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_14_gpu_344 [label="Expert 24
GPU: 344
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_14_gpu_345 [label="Expert 25
GPU: 345
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_14_gpu_346 [label="Expert 26
GPU: 346
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_14_gpu_347 [label="Expert 27
GPU: 347
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_14_gpu_348 [label="Expert 28
GPU: 348
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_14_gpu_349 [label="Expert 29
GPU: 349
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_14_gpu_350 [label="Expert 30
GPU: 350
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_14_gpu_351 [label="Expert 31
GPU: 351
Node: 43
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_14 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_15 {
		color=lightgreen label="MoE Layer 15 (32 Experts)" style="rounded,filled"
		mha_layer_15_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_15_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_15_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_15 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_15_gpu_352 [label="Expert 0
GPU: 352
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_15_gpu_353 [label="Expert 1
GPU: 353
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_15_gpu_354 [label="Expert 2
GPU: 354
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_15_gpu_355 [label="Expert 3
GPU: 355
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_15_gpu_356 [label="Expert 4
GPU: 356
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_15_gpu_357 [label="Expert 5
GPU: 357
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_15_gpu_358 [label="Expert 6
GPU: 358
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_15_gpu_359 [label="Expert 7
GPU: 359
Node: 44
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_15_gpu_360 [label="Expert 8
GPU: 360
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_15_gpu_361 [label="Expert 9
GPU: 361
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_15_gpu_362 [label="Expert 10
GPU: 362
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_15_gpu_363 [label="Expert 11
GPU: 363
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_15_gpu_364 [label="Expert 12
GPU: 364
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_15_gpu_365 [label="Expert 13
GPU: 365
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_15_gpu_366 [label="Expert 14
GPU: 366
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_15_gpu_367 [label="Expert 15
GPU: 367
Node: 45
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_15_gpu_368 [label="Expert 16
GPU: 368
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_15_gpu_369 [label="Expert 17
GPU: 369
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_15_gpu_370 [label="Expert 18
GPU: 370
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_15_gpu_371 [label="Expert 19
GPU: 371
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_15_gpu_372 [label="Expert 20
GPU: 372
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_15_gpu_373 [label="Expert 21
GPU: 373
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_15_gpu_374 [label="Expert 22
GPU: 374
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_15_gpu_375 [label="Expert 23
GPU: 375
Node: 46
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_15_gpu_376 [label="Expert 24
GPU: 376
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_15_gpu_377 [label="Expert 25
GPU: 377
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_15_gpu_378 [label="Expert 26
GPU: 378
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_15_gpu_379 [label="Expert 27
GPU: 379
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_15_gpu_380 [label="Expert 28
GPU: 380
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_15_gpu_381 [label="Expert 29
GPU: 381
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_15_gpu_382 [label="Expert 30
GPU: 382
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_15_gpu_383 [label="Expert 31
GPU: 383
Node: 47
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_15 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_16 {
		color=lightgreen label="MoE Layer 16 (32 Experts)" style="rounded,filled"
		mha_layer_16_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_16_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_16_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_16 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_16_gpu_384 [label="Expert 0
GPU: 384
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_16_gpu_385 [label="Expert 1
GPU: 385
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_16_gpu_386 [label="Expert 2
GPU: 386
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_16_gpu_387 [label="Expert 3
GPU: 387
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_16_gpu_388 [label="Expert 4
GPU: 388
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_16_gpu_389 [label="Expert 5
GPU: 389
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_16_gpu_390 [label="Expert 6
GPU: 390
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_16_gpu_391 [label="Expert 7
GPU: 391
Node: 48
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_16_gpu_392 [label="Expert 8
GPU: 392
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_16_gpu_393 [label="Expert 9
GPU: 393
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_16_gpu_394 [label="Expert 10
GPU: 394
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_16_gpu_395 [label="Expert 11
GPU: 395
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_16_gpu_396 [label="Expert 12
GPU: 396
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_16_gpu_397 [label="Expert 13
GPU: 397
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_16_gpu_398 [label="Expert 14
GPU: 398
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_16_gpu_399 [label="Expert 15
GPU: 399
Node: 49
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_16_gpu_400 [label="Expert 16
GPU: 400
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_16_gpu_401 [label="Expert 17
GPU: 401
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_16_gpu_402 [label="Expert 18
GPU: 402
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_16_gpu_403 [label="Expert 19
GPU: 403
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_16_gpu_404 [label="Expert 20
GPU: 404
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_16_gpu_405 [label="Expert 21
GPU: 405
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_16_gpu_406 [label="Expert 22
GPU: 406
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_16_gpu_407 [label="Expert 23
GPU: 407
Node: 50
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_16_gpu_408 [label="Expert 24
GPU: 408
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_16_gpu_409 [label="Expert 25
GPU: 409
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_16_gpu_410 [label="Expert 26
GPU: 410
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_16_gpu_411 [label="Expert 27
GPU: 411
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_16_gpu_412 [label="Expert 28
GPU: 412
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_16_gpu_413 [label="Expert 29
GPU: 413
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_16_gpu_414 [label="Expert 30
GPU: 414
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_16_gpu_415 [label="Expert 31
GPU: 415
Node: 51
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_16 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_17 {
		color=lightgreen label="MoE Layer 17 (32 Experts)" style="rounded,filled"
		mha_layer_17_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_17_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_17_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_17 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_17_gpu_416 [label="Expert 0
GPU: 416
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_17_gpu_417 [label="Expert 1
GPU: 417
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_17_gpu_418 [label="Expert 2
GPU: 418
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_17_gpu_419 [label="Expert 3
GPU: 419
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_17_gpu_420 [label="Expert 4
GPU: 420
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_17_gpu_421 [label="Expert 5
GPU: 421
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_17_gpu_422 [label="Expert 6
GPU: 422
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_17_gpu_423 [label="Expert 7
GPU: 423
Node: 52
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_17_gpu_424 [label="Expert 8
GPU: 424
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_17_gpu_425 [label="Expert 9
GPU: 425
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_17_gpu_426 [label="Expert 10
GPU: 426
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_17_gpu_427 [label="Expert 11
GPU: 427
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_17_gpu_428 [label="Expert 12
GPU: 428
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_17_gpu_429 [label="Expert 13
GPU: 429
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_17_gpu_430 [label="Expert 14
GPU: 430
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_17_gpu_431 [label="Expert 15
GPU: 431
Node: 53
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_17_gpu_432 [label="Expert 16
GPU: 432
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_17_gpu_433 [label="Expert 17
GPU: 433
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_17_gpu_434 [label="Expert 18
GPU: 434
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_17_gpu_435 [label="Expert 19
GPU: 435
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_17_gpu_436 [label="Expert 20
GPU: 436
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_17_gpu_437 [label="Expert 21
GPU: 437
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_17_gpu_438 [label="Expert 22
GPU: 438
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_17_gpu_439 [label="Expert 23
GPU: 439
Node: 54
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_17_gpu_440 [label="Expert 24
GPU: 440
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_17_gpu_441 [label="Expert 25
GPU: 441
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_17_gpu_442 [label="Expert 26
GPU: 442
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_17_gpu_443 [label="Expert 27
GPU: 443
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_17_gpu_444 [label="Expert 28
GPU: 444
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_17_gpu_445 [label="Expert 29
GPU: 445
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_17_gpu_446 [label="Expert 30
GPU: 446
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_17_gpu_447 [label="Expert 31
GPU: 447
Node: 55
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_17 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_18 {
		color=lightgreen label="MoE Layer 18 (32 Experts)" style="rounded,filled"
		mha_layer_18_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_18_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_18_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_18 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_18_gpu_448 [label="Expert 0
GPU: 448
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_18_gpu_449 [label="Expert 1
GPU: 449
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_18_gpu_450 [label="Expert 2
GPU: 450
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_18_gpu_451 [label="Expert 3
GPU: 451
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_18_gpu_452 [label="Expert 4
GPU: 452
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_18_gpu_453 [label="Expert 5
GPU: 453
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_18_gpu_454 [label="Expert 6
GPU: 454
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_18_gpu_455 [label="Expert 7
GPU: 455
Node: 56
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_18_gpu_456 [label="Expert 8
GPU: 456
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_18_gpu_457 [label="Expert 9
GPU: 457
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_18_gpu_458 [label="Expert 10
GPU: 458
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_18_gpu_459 [label="Expert 11
GPU: 459
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_18_gpu_460 [label="Expert 12
GPU: 460
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_18_gpu_461 [label="Expert 13
GPU: 461
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_18_gpu_462 [label="Expert 14
GPU: 462
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_18_gpu_463 [label="Expert 15
GPU: 463
Node: 57
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_18_gpu_464 [label="Expert 16
GPU: 464
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_18_gpu_465 [label="Expert 17
GPU: 465
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_18_gpu_466 [label="Expert 18
GPU: 466
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_18_gpu_467 [label="Expert 19
GPU: 467
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_18_gpu_468 [label="Expert 20
GPU: 468
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_18_gpu_469 [label="Expert 21
GPU: 469
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_18_gpu_470 [label="Expert 22
GPU: 470
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_18_gpu_471 [label="Expert 23
GPU: 471
Node: 58
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_18_gpu_472 [label="Expert 24
GPU: 472
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_18_gpu_473 [label="Expert 25
GPU: 473
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_18_gpu_474 [label="Expert 26
GPU: 474
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_18_gpu_475 [label="Expert 27
GPU: 475
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_18_gpu_476 [label="Expert 28
GPU: 476
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_18_gpu_477 [label="Expert 29
GPU: 477
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_18_gpu_478 [label="Expert 30
GPU: 478
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_18_gpu_479 [label="Expert 31
GPU: 479
Node: 59
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_18 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_19 {
		color=lightgreen label="MoE Layer 19 (32 Experts)" style="rounded,filled"
		mha_layer_19_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_19_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_19_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_19 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_19_gpu_480 [label="Expert 0
GPU: 480
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_19_gpu_481 [label="Expert 1
GPU: 481
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_19_gpu_482 [label="Expert 2
GPU: 482
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_19_gpu_483 [label="Expert 3
GPU: 483
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_19_gpu_484 [label="Expert 4
GPU: 484
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_19_gpu_485 [label="Expert 5
GPU: 485
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_19_gpu_486 [label="Expert 6
GPU: 486
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_19_gpu_487 [label="Expert 7
GPU: 487
Node: 60
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_19_gpu_488 [label="Expert 8
GPU: 488
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_19_gpu_489 [label="Expert 9
GPU: 489
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_19_gpu_490 [label="Expert 10
GPU: 490
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_19_gpu_491 [label="Expert 11
GPU: 491
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_19_gpu_492 [label="Expert 12
GPU: 492
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_19_gpu_493 [label="Expert 13
GPU: 493
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_19_gpu_494 [label="Expert 14
GPU: 494
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_19_gpu_495 [label="Expert 15
GPU: 495
Node: 61
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_19_gpu_496 [label="Expert 16
GPU: 496
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_19_gpu_497 [label="Expert 17
GPU: 497
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_19_gpu_498 [label="Expert 18
GPU: 498
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_19_gpu_499 [label="Expert 19
GPU: 499
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_19_gpu_500 [label="Expert 20
GPU: 500
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_19_gpu_501 [label="Expert 21
GPU: 501
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_19_gpu_502 [label="Expert 22
GPU: 502
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_19_gpu_503 [label="Expert 23
GPU: 503
Node: 62
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_19_gpu_504 [label="Expert 24
GPU: 504
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_19_gpu_505 [label="Expert 25
GPU: 505
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_19_gpu_506 [label="Expert 26
GPU: 506
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_19_gpu_507 [label="Expert 27
GPU: 507
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_19_gpu_508 [label="Expert 28
GPU: 508
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_19_gpu_509 [label="Expert 29
GPU: 509
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_19_gpu_510 [label="Expert 30
GPU: 510
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_19_gpu_511 [label="Expert 31
GPU: 511
Node: 63
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_19 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_20 {
		color=lightgreen label="MoE Layer 20 (32 Experts)" style="rounded,filled"
		mha_layer_20_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_20_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_20_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_20 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_20_gpu_512 [label="Expert 0
GPU: 512
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_20_gpu_513 [label="Expert 1
GPU: 513
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_20_gpu_514 [label="Expert 2
GPU: 514
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_20_gpu_515 [label="Expert 3
GPU: 515
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_20_gpu_516 [label="Expert 4
GPU: 516
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_20_gpu_517 [label="Expert 5
GPU: 517
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_20_gpu_518 [label="Expert 6
GPU: 518
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_20_gpu_519 [label="Expert 7
GPU: 519
Node: 64
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_20_gpu_520 [label="Expert 8
GPU: 520
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_20_gpu_521 [label="Expert 9
GPU: 521
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_20_gpu_522 [label="Expert 10
GPU: 522
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_20_gpu_523 [label="Expert 11
GPU: 523
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_20_gpu_524 [label="Expert 12
GPU: 524
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_20_gpu_525 [label="Expert 13
GPU: 525
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_20_gpu_526 [label="Expert 14
GPU: 526
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_20_gpu_527 [label="Expert 15
GPU: 527
Node: 65
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_20_gpu_528 [label="Expert 16
GPU: 528
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_20_gpu_529 [label="Expert 17
GPU: 529
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_20_gpu_530 [label="Expert 18
GPU: 530
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_20_gpu_531 [label="Expert 19
GPU: 531
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_20_gpu_532 [label="Expert 20
GPU: 532
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_20_gpu_533 [label="Expert 21
GPU: 533
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_20_gpu_534 [label="Expert 22
GPU: 534
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_20_gpu_535 [label="Expert 23
GPU: 535
Node: 66
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_20_gpu_536 [label="Expert 24
GPU: 536
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_20_gpu_537 [label="Expert 25
GPU: 537
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_20_gpu_538 [label="Expert 26
GPU: 538
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_20_gpu_539 [label="Expert 27
GPU: 539
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_20_gpu_540 [label="Expert 28
GPU: 540
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_20_gpu_541 [label="Expert 29
GPU: 541
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_20_gpu_542 [label="Expert 30
GPU: 542
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_20_gpu_543 [label="Expert 31
GPU: 543
Node: 67
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_20 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_21 {
		color=lightgreen label="MoE Layer 21 (32 Experts)" style="rounded,filled"
		mha_layer_21_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_21_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_21_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_21 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_21_gpu_544 [label="Expert 0
GPU: 544
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_21_gpu_545 [label="Expert 1
GPU: 545
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_21_gpu_546 [label="Expert 2
GPU: 546
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_21_gpu_547 [label="Expert 3
GPU: 547
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_21_gpu_548 [label="Expert 4
GPU: 548
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_21_gpu_549 [label="Expert 5
GPU: 549
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_21_gpu_550 [label="Expert 6
GPU: 550
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_21_gpu_551 [label="Expert 7
GPU: 551
Node: 68
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_21_gpu_552 [label="Expert 8
GPU: 552
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_21_gpu_553 [label="Expert 9
GPU: 553
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_21_gpu_554 [label="Expert 10
GPU: 554
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_21_gpu_555 [label="Expert 11
GPU: 555
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_21_gpu_556 [label="Expert 12
GPU: 556
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_21_gpu_557 [label="Expert 13
GPU: 557
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_21_gpu_558 [label="Expert 14
GPU: 558
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_21_gpu_559 [label="Expert 15
GPU: 559
Node: 69
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_21_gpu_560 [label="Expert 16
GPU: 560
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_21_gpu_561 [label="Expert 17
GPU: 561
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_21_gpu_562 [label="Expert 18
GPU: 562
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_21_gpu_563 [label="Expert 19
GPU: 563
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_21_gpu_564 [label="Expert 20
GPU: 564
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_21_gpu_565 [label="Expert 21
GPU: 565
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_21_gpu_566 [label="Expert 22
GPU: 566
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_21_gpu_567 [label="Expert 23
GPU: 567
Node: 70
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_21_gpu_568 [label="Expert 24
GPU: 568
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_21_gpu_569 [label="Expert 25
GPU: 569
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_21_gpu_570 [label="Expert 26
GPU: 570
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_21_gpu_571 [label="Expert 27
GPU: 571
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_21_gpu_572 [label="Expert 28
GPU: 572
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_21_gpu_573 [label="Expert 29
GPU: 573
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_21_gpu_574 [label="Expert 30
GPU: 574
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_21_gpu_575 [label="Expert 31
GPU: 575
Node: 71
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_21 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_22 {
		color=lightgreen label="MoE Layer 22 (32 Experts)" style="rounded,filled"
		mha_layer_22_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_22_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_22_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_22 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_22_gpu_576 [label="Expert 0
GPU: 576
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_22_gpu_577 [label="Expert 1
GPU: 577
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_22_gpu_578 [label="Expert 2
GPU: 578
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_22_gpu_579 [label="Expert 3
GPU: 579
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_22_gpu_580 [label="Expert 4
GPU: 580
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_22_gpu_581 [label="Expert 5
GPU: 581
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_22_gpu_582 [label="Expert 6
GPU: 582
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_22_gpu_583 [label="Expert 7
GPU: 583
Node: 72
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_22_gpu_584 [label="Expert 8
GPU: 584
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_22_gpu_585 [label="Expert 9
GPU: 585
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_22_gpu_586 [label="Expert 10
GPU: 586
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_22_gpu_587 [label="Expert 11
GPU: 587
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_22_gpu_588 [label="Expert 12
GPU: 588
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_22_gpu_589 [label="Expert 13
GPU: 589
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_22_gpu_590 [label="Expert 14
GPU: 590
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_22_gpu_591 [label="Expert 15
GPU: 591
Node: 73
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_22_gpu_592 [label="Expert 16
GPU: 592
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_22_gpu_593 [label="Expert 17
GPU: 593
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_22_gpu_594 [label="Expert 18
GPU: 594
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_22_gpu_595 [label="Expert 19
GPU: 595
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_22_gpu_596 [label="Expert 20
GPU: 596
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_22_gpu_597 [label="Expert 21
GPU: 597
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_22_gpu_598 [label="Expert 22
GPU: 598
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_22_gpu_599 [label="Expert 23
GPU: 599
Node: 74
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_22_gpu_600 [label="Expert 24
GPU: 600
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_22_gpu_601 [label="Expert 25
GPU: 601
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_22_gpu_602 [label="Expert 26
GPU: 602
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_22_gpu_603 [label="Expert 27
GPU: 603
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_22_gpu_604 [label="Expert 28
GPU: 604
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_22_gpu_605 [label="Expert 29
GPU: 605
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_22_gpu_606 [label="Expert 30
GPU: 606
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_22_gpu_607 [label="Expert 31
GPU: 607
Node: 75
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_22 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_23 {
		color=lightgreen label="MoE Layer 23 (32 Experts)" style="rounded,filled"
		mha_layer_23_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_23_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_23_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_23 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_23_gpu_608 [label="Expert 0
GPU: 608
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_23_gpu_609 [label="Expert 1
GPU: 609
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_23_gpu_610 [label="Expert 2
GPU: 610
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_23_gpu_611 [label="Expert 3
GPU: 611
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_23_gpu_612 [label="Expert 4
GPU: 612
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_23_gpu_613 [label="Expert 5
GPU: 613
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_23_gpu_614 [label="Expert 6
GPU: 614
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_23_gpu_615 [label="Expert 7
GPU: 615
Node: 76
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_23_gpu_616 [label="Expert 8
GPU: 616
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_23_gpu_617 [label="Expert 9
GPU: 617
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_23_gpu_618 [label="Expert 10
GPU: 618
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_23_gpu_619 [label="Expert 11
GPU: 619
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_23_gpu_620 [label="Expert 12
GPU: 620
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_23_gpu_621 [label="Expert 13
GPU: 621
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_23_gpu_622 [label="Expert 14
GPU: 622
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_23_gpu_623 [label="Expert 15
GPU: 623
Node: 77
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_23_gpu_624 [label="Expert 16
GPU: 624
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_23_gpu_625 [label="Expert 17
GPU: 625
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_23_gpu_626 [label="Expert 18
GPU: 626
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_23_gpu_627 [label="Expert 19
GPU: 627
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_23_gpu_628 [label="Expert 20
GPU: 628
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_23_gpu_629 [label="Expert 21
GPU: 629
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_23_gpu_630 [label="Expert 22
GPU: 630
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_23_gpu_631 [label="Expert 23
GPU: 631
Node: 78
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_23_gpu_632 [label="Expert 24
GPU: 632
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_23_gpu_633 [label="Expert 25
GPU: 633
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_23_gpu_634 [label="Expert 26
GPU: 634
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_23_gpu_635 [label="Expert 27
GPU: 635
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_23_gpu_636 [label="Expert 28
GPU: 636
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_23_gpu_637 [label="Expert 29
GPU: 637
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_23_gpu_638 [label="Expert 30
GPU: 638
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_23_gpu_639 [label="Expert 31
GPU: 639
Node: 79
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_23 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_24 {
		color=lightgreen label="MoE Layer 24 (32 Experts)" style="rounded,filled"
		mha_layer_24_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_24_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_24_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_24 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_24_gpu_640 [label="Expert 0
GPU: 640
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_24_gpu_641 [label="Expert 1
GPU: 641
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_24_gpu_642 [label="Expert 2
GPU: 642
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_24_gpu_643 [label="Expert 3
GPU: 643
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_24_gpu_644 [label="Expert 4
GPU: 644
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_24_gpu_645 [label="Expert 5
GPU: 645
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_24_gpu_646 [label="Expert 6
GPU: 646
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_24_gpu_647 [label="Expert 7
GPU: 647
Node: 80
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_24_gpu_648 [label="Expert 8
GPU: 648
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_24_gpu_649 [label="Expert 9
GPU: 649
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_24_gpu_650 [label="Expert 10
GPU: 650
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_24_gpu_651 [label="Expert 11
GPU: 651
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_24_gpu_652 [label="Expert 12
GPU: 652
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_24_gpu_653 [label="Expert 13
GPU: 653
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_24_gpu_654 [label="Expert 14
GPU: 654
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_24_gpu_655 [label="Expert 15
GPU: 655
Node: 81
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_24_gpu_656 [label="Expert 16
GPU: 656
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_24_gpu_657 [label="Expert 17
GPU: 657
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_24_gpu_658 [label="Expert 18
GPU: 658
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_24_gpu_659 [label="Expert 19
GPU: 659
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_24_gpu_660 [label="Expert 20
GPU: 660
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_24_gpu_661 [label="Expert 21
GPU: 661
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_24_gpu_662 [label="Expert 22
GPU: 662
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_24_gpu_663 [label="Expert 23
GPU: 663
Node: 82
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_24_gpu_664 [label="Expert 24
GPU: 664
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_24_gpu_665 [label="Expert 25
GPU: 665
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_24_gpu_666 [label="Expert 26
GPU: 666
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_24_gpu_667 [label="Expert 27
GPU: 667
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_24_gpu_668 [label="Expert 28
GPU: 668
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_24_gpu_669 [label="Expert 29
GPU: 669
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_24_gpu_670 [label="Expert 30
GPU: 670
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_24_gpu_671 [label="Expert 31
GPU: 671
Node: 83
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_24 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_25 {
		color=lightgreen label="MoE Layer 25 (32 Experts)" style="rounded,filled"
		mha_layer_25_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_25_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_25_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_25 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_25_gpu_672 [label="Expert 0
GPU: 672
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_25_gpu_673 [label="Expert 1
GPU: 673
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_25_gpu_674 [label="Expert 2
GPU: 674
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_25_gpu_675 [label="Expert 3
GPU: 675
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_25_gpu_676 [label="Expert 4
GPU: 676
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_25_gpu_677 [label="Expert 5
GPU: 677
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_25_gpu_678 [label="Expert 6
GPU: 678
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_25_gpu_679 [label="Expert 7
GPU: 679
Node: 84
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_25_gpu_680 [label="Expert 8
GPU: 680
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_25_gpu_681 [label="Expert 9
GPU: 681
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_25_gpu_682 [label="Expert 10
GPU: 682
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_25_gpu_683 [label="Expert 11
GPU: 683
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_25_gpu_684 [label="Expert 12
GPU: 684
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_25_gpu_685 [label="Expert 13
GPU: 685
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_25_gpu_686 [label="Expert 14
GPU: 686
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_25_gpu_687 [label="Expert 15
GPU: 687
Node: 85
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_25_gpu_688 [label="Expert 16
GPU: 688
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_25_gpu_689 [label="Expert 17
GPU: 689
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_25_gpu_690 [label="Expert 18
GPU: 690
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_25_gpu_691 [label="Expert 19
GPU: 691
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_25_gpu_692 [label="Expert 20
GPU: 692
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_25_gpu_693 [label="Expert 21
GPU: 693
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_25_gpu_694 [label="Expert 22
GPU: 694
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_25_gpu_695 [label="Expert 23
GPU: 695
Node: 86
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_25_gpu_696 [label="Expert 24
GPU: 696
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_25_gpu_697 [label="Expert 25
GPU: 697
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_25_gpu_698 [label="Expert 26
GPU: 698
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_25_gpu_699 [label="Expert 27
GPU: 699
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_25_gpu_700 [label="Expert 28
GPU: 700
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_25_gpu_701 [label="Expert 29
GPU: 701
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_25_gpu_702 [label="Expert 30
GPU: 702
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_25_gpu_703 [label="Expert 31
GPU: 703
Node: 87
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_25 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_26 {
		color=lightgreen label="MoE Layer 26 (32 Experts)" style="rounded,filled"
		mha_layer_26_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_26_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_26_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_26 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_26_gpu_704 [label="Expert 0
GPU: 704
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_26_gpu_705 [label="Expert 1
GPU: 705
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_26_gpu_706 [label="Expert 2
GPU: 706
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_26_gpu_707 [label="Expert 3
GPU: 707
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_26_gpu_708 [label="Expert 4
GPU: 708
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_26_gpu_709 [label="Expert 5
GPU: 709
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_26_gpu_710 [label="Expert 6
GPU: 710
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_26_gpu_711 [label="Expert 7
GPU: 711
Node: 88
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_26_gpu_712 [label="Expert 8
GPU: 712
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_26_gpu_713 [label="Expert 9
GPU: 713
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_26_gpu_714 [label="Expert 10
GPU: 714
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_26_gpu_715 [label="Expert 11
GPU: 715
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_26_gpu_716 [label="Expert 12
GPU: 716
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_26_gpu_717 [label="Expert 13
GPU: 717
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_26_gpu_718 [label="Expert 14
GPU: 718
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_26_gpu_719 [label="Expert 15
GPU: 719
Node: 89
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_26_gpu_720 [label="Expert 16
GPU: 720
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_26_gpu_721 [label="Expert 17
GPU: 721
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_26_gpu_722 [label="Expert 18
GPU: 722
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_26_gpu_723 [label="Expert 19
GPU: 723
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_26_gpu_724 [label="Expert 20
GPU: 724
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_26_gpu_725 [label="Expert 21
GPU: 725
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_26_gpu_726 [label="Expert 22
GPU: 726
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_26_gpu_727 [label="Expert 23
GPU: 727
Node: 90
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_26_gpu_728 [label="Expert 24
GPU: 728
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_26_gpu_729 [label="Expert 25
GPU: 729
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_26_gpu_730 [label="Expert 26
GPU: 730
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_26_gpu_731 [label="Expert 27
GPU: 731
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_26_gpu_732 [label="Expert 28
GPU: 732
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_26_gpu_733 [label="Expert 29
GPU: 733
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_26_gpu_734 [label="Expert 30
GPU: 734
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_26_gpu_735 [label="Expert 31
GPU: 735
Node: 91
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_26 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_27 {
		color=lightgreen label="MoE Layer 27 (32 Experts)" style="rounded,filled"
		mha_layer_27_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_27_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_27_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_27 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_27_gpu_736 [label="Expert 0
GPU: 736
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_27_gpu_737 [label="Expert 1
GPU: 737
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_27_gpu_738 [label="Expert 2
GPU: 738
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_27_gpu_739 [label="Expert 3
GPU: 739
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_27_gpu_740 [label="Expert 4
GPU: 740
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_27_gpu_741 [label="Expert 5
GPU: 741
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_27_gpu_742 [label="Expert 6
GPU: 742
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_27_gpu_743 [label="Expert 7
GPU: 743
Node: 92
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_27_gpu_744 [label="Expert 8
GPU: 744
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_27_gpu_745 [label="Expert 9
GPU: 745
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_27_gpu_746 [label="Expert 10
GPU: 746
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_27_gpu_747 [label="Expert 11
GPU: 747
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_27_gpu_748 [label="Expert 12
GPU: 748
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_27_gpu_749 [label="Expert 13
GPU: 749
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_27_gpu_750 [label="Expert 14
GPU: 750
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_27_gpu_751 [label="Expert 15
GPU: 751
Node: 93
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_27_gpu_752 [label="Expert 16
GPU: 752
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_27_gpu_753 [label="Expert 17
GPU: 753
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_27_gpu_754 [label="Expert 18
GPU: 754
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_27_gpu_755 [label="Expert 19
GPU: 755
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_27_gpu_756 [label="Expert 20
GPU: 756
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_27_gpu_757 [label="Expert 21
GPU: 757
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_27_gpu_758 [label="Expert 22
GPU: 758
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_27_gpu_759 [label="Expert 23
GPU: 759
Node: 94
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_27_gpu_760 [label="Expert 24
GPU: 760
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_27_gpu_761 [label="Expert 25
GPU: 761
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_27_gpu_762 [label="Expert 26
GPU: 762
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_27_gpu_763 [label="Expert 27
GPU: 763
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_27_gpu_764 [label="Expert 28
GPU: 764
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_27_gpu_765 [label="Expert 29
GPU: 765
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_27_gpu_766 [label="Expert 30
GPU: 766
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_27_gpu_767 [label="Expert 31
GPU: 767
Node: 95
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_27 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_28 {
		color=lightgreen label="MoE Layer 28 (32 Experts)" style="rounded,filled"
		mha_layer_28_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_28_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_28_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_28 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_28_gpu_768 [label="Expert 0
GPU: 768
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_28_gpu_769 [label="Expert 1
GPU: 769
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_28_gpu_770 [label="Expert 2
GPU: 770
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_28_gpu_771 [label="Expert 3
GPU: 771
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_28_gpu_772 [label="Expert 4
GPU: 772
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_28_gpu_773 [label="Expert 5
GPU: 773
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_28_gpu_774 [label="Expert 6
GPU: 774
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_28_gpu_775 [label="Expert 7
GPU: 775
Node: 96
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_28_gpu_776 [label="Expert 8
GPU: 776
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_28_gpu_777 [label="Expert 9
GPU: 777
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_28_gpu_778 [label="Expert 10
GPU: 778
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_28_gpu_779 [label="Expert 11
GPU: 779
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_28_gpu_780 [label="Expert 12
GPU: 780
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_28_gpu_781 [label="Expert 13
GPU: 781
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_28_gpu_782 [label="Expert 14
GPU: 782
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_28_gpu_783 [label="Expert 15
GPU: 783
Node: 97
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_28_gpu_784 [label="Expert 16
GPU: 784
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_28_gpu_785 [label="Expert 17
GPU: 785
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_28_gpu_786 [label="Expert 18
GPU: 786
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_28_gpu_787 [label="Expert 19
GPU: 787
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_28_gpu_788 [label="Expert 20
GPU: 788
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_28_gpu_789 [label="Expert 21
GPU: 789
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_28_gpu_790 [label="Expert 22
GPU: 790
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_28_gpu_791 [label="Expert 23
GPU: 791
Node: 98
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_28_gpu_792 [label="Expert 24
GPU: 792
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_28_gpu_793 [label="Expert 25
GPU: 793
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_28_gpu_794 [label="Expert 26
GPU: 794
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_28_gpu_795 [label="Expert 27
GPU: 795
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_28_gpu_796 [label="Expert 28
GPU: 796
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_28_gpu_797 [label="Expert 29
GPU: 797
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_28_gpu_798 [label="Expert 30
GPU: 798
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_28_gpu_799 [label="Expert 31
GPU: 799
Node: 99
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_28 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_29 {
		color=lightgreen label="MoE Layer 29 (32 Experts)" style="rounded,filled"
		mha_layer_29_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_29_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_29_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_29 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_29_gpu_800 [label="Expert 0
GPU: 800
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_29_gpu_801 [label="Expert 1
GPU: 801
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_29_gpu_802 [label="Expert 2
GPU: 802
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_29_gpu_803 [label="Expert 3
GPU: 803
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_29_gpu_804 [label="Expert 4
GPU: 804
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_29_gpu_805 [label="Expert 5
GPU: 805
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_29_gpu_806 [label="Expert 6
GPU: 806
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_29_gpu_807 [label="Expert 7
GPU: 807
Node: 100
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_29_gpu_808 [label="Expert 8
GPU: 808
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_29_gpu_809 [label="Expert 9
GPU: 809
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_29_gpu_810 [label="Expert 10
GPU: 810
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_29_gpu_811 [label="Expert 11
GPU: 811
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_29_gpu_812 [label="Expert 12
GPU: 812
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_29_gpu_813 [label="Expert 13
GPU: 813
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_29_gpu_814 [label="Expert 14
GPU: 814
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_29_gpu_815 [label="Expert 15
GPU: 815
Node: 101
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_29_gpu_816 [label="Expert 16
GPU: 816
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_29_gpu_817 [label="Expert 17
GPU: 817
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_29_gpu_818 [label="Expert 18
GPU: 818
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_29_gpu_819 [label="Expert 19
GPU: 819
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_29_gpu_820 [label="Expert 20
GPU: 820
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_29_gpu_821 [label="Expert 21
GPU: 821
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_29_gpu_822 [label="Expert 22
GPU: 822
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_29_gpu_823 [label="Expert 23
GPU: 823
Node: 102
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_29_gpu_824 [label="Expert 24
GPU: 824
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_29_gpu_825 [label="Expert 25
GPU: 825
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_29_gpu_826 [label="Expert 26
GPU: 826
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_29_gpu_827 [label="Expert 27
GPU: 827
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_29_gpu_828 [label="Expert 28
GPU: 828
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_29_gpu_829 [label="Expert 29
GPU: 829
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_29_gpu_830 [label="Expert 30
GPU: 830
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_29_gpu_831 [label="Expert 31
GPU: 831
Node: 103
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_29 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_30 {
		color=lightgreen label="MoE Layer 30 (32 Experts)" style="rounded,filled"
		mha_layer_30_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_30_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_30_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_30 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_30_gpu_832 [label="Expert 0
GPU: 832
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_30_gpu_833 [label="Expert 1
GPU: 833
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_30_gpu_834 [label="Expert 2
GPU: 834
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_30_gpu_835 [label="Expert 3
GPU: 835
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_30_gpu_836 [label="Expert 4
GPU: 836
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_30_gpu_837 [label="Expert 5
GPU: 837
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_30_gpu_838 [label="Expert 6
GPU: 838
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_30_gpu_839 [label="Expert 7
GPU: 839
Node: 104
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_30_gpu_840 [label="Expert 8
GPU: 840
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_30_gpu_841 [label="Expert 9
GPU: 841
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_30_gpu_842 [label="Expert 10
GPU: 842
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_30_gpu_843 [label="Expert 11
GPU: 843
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_30_gpu_844 [label="Expert 12
GPU: 844
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_30_gpu_845 [label="Expert 13
GPU: 845
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_30_gpu_846 [label="Expert 14
GPU: 846
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_30_gpu_847 [label="Expert 15
GPU: 847
Node: 105
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_30_gpu_848 [label="Expert 16
GPU: 848
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_30_gpu_849 [label="Expert 17
GPU: 849
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_30_gpu_850 [label="Expert 18
GPU: 850
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_30_gpu_851 [label="Expert 19
GPU: 851
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_30_gpu_852 [label="Expert 20
GPU: 852
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_30_gpu_853 [label="Expert 21
GPU: 853
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_30_gpu_854 [label="Expert 22
GPU: 854
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_30_gpu_855 [label="Expert 23
GPU: 855
Node: 106
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_30_gpu_856 [label="Expert 24
GPU: 856
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_30_gpu_857 [label="Expert 25
GPU: 857
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_30_gpu_858 [label="Expert 26
GPU: 858
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_30_gpu_859 [label="Expert 27
GPU: 859
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_30_gpu_860 [label="Expert 28
GPU: 860
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_30_gpu_861 [label="Expert 29
GPU: 861
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_30_gpu_862 [label="Expert 30
GPU: 862
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_30_gpu_863 [label="Expert 31
GPU: 863
Node: 107
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_30 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_31 {
		color=lightgreen label="MoE Layer 31 (32 Experts)" style="rounded,filled"
		mha_layer_31_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_31_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_31_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_31 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_31_gpu_864 [label="Expert 0
GPU: 864
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_31_gpu_865 [label="Expert 1
GPU: 865
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_31_gpu_866 [label="Expert 2
GPU: 866
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_31_gpu_867 [label="Expert 3
GPU: 867
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_31_gpu_868 [label="Expert 4
GPU: 868
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_31_gpu_869 [label="Expert 5
GPU: 869
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_31_gpu_870 [label="Expert 6
GPU: 870
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_31_gpu_871 [label="Expert 7
GPU: 871
Node: 108
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_31_gpu_872 [label="Expert 8
GPU: 872
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_31_gpu_873 [label="Expert 9
GPU: 873
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_31_gpu_874 [label="Expert 10
GPU: 874
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_31_gpu_875 [label="Expert 11
GPU: 875
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_31_gpu_876 [label="Expert 12
GPU: 876
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_31_gpu_877 [label="Expert 13
GPU: 877
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_31_gpu_878 [label="Expert 14
GPU: 878
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_31_gpu_879 [label="Expert 15
GPU: 879
Node: 109
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_31_gpu_880 [label="Expert 16
GPU: 880
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_31_gpu_881 [label="Expert 17
GPU: 881
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_31_gpu_882 [label="Expert 18
GPU: 882
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_31_gpu_883 [label="Expert 19
GPU: 883
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_31_gpu_884 [label="Expert 20
GPU: 884
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_31_gpu_885 [label="Expert 21
GPU: 885
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_31_gpu_886 [label="Expert 22
GPU: 886
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_31_gpu_887 [label="Expert 23
GPU: 887
Node: 110
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_31_gpu_888 [label="Expert 24
GPU: 888
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_31_gpu_889 [label="Expert 25
GPU: 889
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_31_gpu_890 [label="Expert 26
GPU: 890
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_31_gpu_891 [label="Expert 27
GPU: 891
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_31_gpu_892 [label="Expert 28
GPU: 892
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_31_gpu_893 [label="Expert 29
GPU: 893
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_31_gpu_894 [label="Expert 30
GPU: 894
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_31_gpu_895 [label="Expert 31
GPU: 895
Node: 111
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_31 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_32 {
		color=lightgreen label="MoE Layer 32 (32 Experts)" style="rounded,filled"
		mha_layer_32_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_32_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_32_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_32 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_32_gpu_896 [label="Expert 0
GPU: 896
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_32_gpu_897 [label="Expert 1
GPU: 897
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_32_gpu_898 [label="Expert 2
GPU: 898
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_32_gpu_899 [label="Expert 3
GPU: 899
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_32_gpu_900 [label="Expert 4
GPU: 900
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_32_gpu_901 [label="Expert 5
GPU: 901
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_32_gpu_902 [label="Expert 6
GPU: 902
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_32_gpu_903 [label="Expert 7
GPU: 903
Node: 112
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_32_gpu_904 [label="Expert 8
GPU: 904
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_32_gpu_905 [label="Expert 9
GPU: 905
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_32_gpu_906 [label="Expert 10
GPU: 906
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_32_gpu_907 [label="Expert 11
GPU: 907
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_32_gpu_908 [label="Expert 12
GPU: 908
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_32_gpu_909 [label="Expert 13
GPU: 909
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_32_gpu_910 [label="Expert 14
GPU: 910
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_32_gpu_911 [label="Expert 15
GPU: 911
Node: 113
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_32_gpu_912 [label="Expert 16
GPU: 912
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_32_gpu_913 [label="Expert 17
GPU: 913
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_32_gpu_914 [label="Expert 18
GPU: 914
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_32_gpu_915 [label="Expert 19
GPU: 915
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_32_gpu_916 [label="Expert 20
GPU: 916
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_32_gpu_917 [label="Expert 21
GPU: 917
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_32_gpu_918 [label="Expert 22
GPU: 918
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_32_gpu_919 [label="Expert 23
GPU: 919
Node: 114
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_32_gpu_920 [label="Expert 24
GPU: 920
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_32_gpu_921 [label="Expert 25
GPU: 921
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_32_gpu_922 [label="Expert 26
GPU: 922
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_32_gpu_923 [label="Expert 27
GPU: 923
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_32_gpu_924 [label="Expert 28
GPU: 924
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_32_gpu_925 [label="Expert 29
GPU: 925
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_32_gpu_926 [label="Expert 30
GPU: 926
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_32_gpu_927 [label="Expert 31
GPU: 927
Node: 115
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_32 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_33 {
		color=lightgreen label="MoE Layer 33 (32 Experts)" style="rounded,filled"
		mha_layer_33_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_33_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_33_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_33 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_33_gpu_928 [label="Expert 0
GPU: 928
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_33_gpu_929 [label="Expert 1
GPU: 929
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_33_gpu_930 [label="Expert 2
GPU: 930
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_33_gpu_931 [label="Expert 3
GPU: 931
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_33_gpu_932 [label="Expert 4
GPU: 932
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_33_gpu_933 [label="Expert 5
GPU: 933
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_33_gpu_934 [label="Expert 6
GPU: 934
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_33_gpu_935 [label="Expert 7
GPU: 935
Node: 116
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_33_gpu_936 [label="Expert 8
GPU: 936
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_33_gpu_937 [label="Expert 9
GPU: 937
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_33_gpu_938 [label="Expert 10
GPU: 938
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_33_gpu_939 [label="Expert 11
GPU: 939
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_33_gpu_940 [label="Expert 12
GPU: 940
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_33_gpu_941 [label="Expert 13
GPU: 941
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_33_gpu_942 [label="Expert 14
GPU: 942
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_33_gpu_943 [label="Expert 15
GPU: 943
Node: 117
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_33_gpu_944 [label="Expert 16
GPU: 944
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_33_gpu_945 [label="Expert 17
GPU: 945
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_33_gpu_946 [label="Expert 18
GPU: 946
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_33_gpu_947 [label="Expert 19
GPU: 947
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_33_gpu_948 [label="Expert 20
GPU: 948
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_33_gpu_949 [label="Expert 21
GPU: 949
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_33_gpu_950 [label="Expert 22
GPU: 950
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_33_gpu_951 [label="Expert 23
GPU: 951
Node: 118
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_33_gpu_952 [label="Expert 24
GPU: 952
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_33_gpu_953 [label="Expert 25
GPU: 953
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_33_gpu_954 [label="Expert 26
GPU: 954
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_33_gpu_955 [label="Expert 27
GPU: 955
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_33_gpu_956 [label="Expert 28
GPU: 956
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_33_gpu_957 [label="Expert 29
GPU: 957
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_33_gpu_958 [label="Expert 30
GPU: 958
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_33_gpu_959 [label="Expert 31
GPU: 959
Node: 119
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_33 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_34 {
		color=lightgreen label="MoE Layer 34 (32 Experts)" style="rounded,filled"
		mha_layer_34_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_34_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_34_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_34 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_34_gpu_960 [label="Expert 0
GPU: 960
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_34_gpu_961 [label="Expert 1
GPU: 961
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_34_gpu_962 [label="Expert 2
GPU: 962
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_34_gpu_963 [label="Expert 3
GPU: 963
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_34_gpu_964 [label="Expert 4
GPU: 964
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_34_gpu_965 [label="Expert 5
GPU: 965
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_34_gpu_966 [label="Expert 6
GPU: 966
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_34_gpu_967 [label="Expert 7
GPU: 967
Node: 120
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_34_gpu_968 [label="Expert 8
GPU: 968
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_34_gpu_969 [label="Expert 9
GPU: 969
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_34_gpu_970 [label="Expert 10
GPU: 970
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_34_gpu_971 [label="Expert 11
GPU: 971
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_34_gpu_972 [label="Expert 12
GPU: 972
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_34_gpu_973 [label="Expert 13
GPU: 973
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_34_gpu_974 [label="Expert 14
GPU: 974
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_34_gpu_975 [label="Expert 15
GPU: 975
Node: 121
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_34_gpu_976 [label="Expert 16
GPU: 976
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_34_gpu_977 [label="Expert 17
GPU: 977
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_34_gpu_978 [label="Expert 18
GPU: 978
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_34_gpu_979 [label="Expert 19
GPU: 979
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_34_gpu_980 [label="Expert 20
GPU: 980
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_34_gpu_981 [label="Expert 21
GPU: 981
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_34_gpu_982 [label="Expert 22
GPU: 982
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_34_gpu_983 [label="Expert 23
GPU: 983
Node: 122
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_34_gpu_984 [label="Expert 24
GPU: 984
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_34_gpu_985 [label="Expert 25
GPU: 985
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_34_gpu_986 [label="Expert 26
GPU: 986
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_34_gpu_987 [label="Expert 27
GPU: 987
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_34_gpu_988 [label="Expert 28
GPU: 988
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_34_gpu_989 [label="Expert 29
GPU: 989
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_34_gpu_990 [label="Expert 30
GPU: 990
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_34_gpu_991 [label="Expert 31
GPU: 991
Node: 123
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_34 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_35 {
		color=lightgreen label="MoE Layer 35 (32 Experts)" style="rounded,filled"
		mha_layer_35_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_35_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_35_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_35 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_35_gpu_992 [label="Expert 0
GPU: 992
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_35_gpu_993 [label="Expert 1
GPU: 993
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_35_gpu_994 [label="Expert 2
GPU: 994
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_35_gpu_995 [label="Expert 3
GPU: 995
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_35_gpu_996 [label="Expert 4
GPU: 996
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_35_gpu_997 [label="Expert 5
GPU: 997
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_35_gpu_998 [label="Expert 6
GPU: 998
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_35_gpu_999 [label="Expert 7
GPU: 999
Node: 124
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_35_gpu_1000 [label="Expert 8
GPU: 1000
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_35_gpu_1001 [label="Expert 9
GPU: 1001
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_35_gpu_1002 [label="Expert 10
GPU: 1002
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_35_gpu_1003 [label="Expert 11
GPU: 1003
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_35_gpu_1004 [label="Expert 12
GPU: 1004
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_35_gpu_1005 [label="Expert 13
GPU: 1005
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_35_gpu_1006 [label="Expert 14
GPU: 1006
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_35_gpu_1007 [label="Expert 15
GPU: 1007
Node: 125
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_35_gpu_1008 [label="Expert 16
GPU: 1008
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_35_gpu_1009 [label="Expert 17
GPU: 1009
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_35_gpu_1010 [label="Expert 18
GPU: 1010
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_35_gpu_1011 [label="Expert 19
GPU: 1011
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_35_gpu_1012 [label="Expert 20
GPU: 1012
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_35_gpu_1013 [label="Expert 21
GPU: 1013
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_35_gpu_1014 [label="Expert 22
GPU: 1014
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_35_gpu_1015 [label="Expert 23
GPU: 1015
Node: 126
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_35_gpu_1016 [label="Expert 24
GPU: 1016
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_35_gpu_1017 [label="Expert 25
GPU: 1017
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_35_gpu_1018 [label="Expert 26
GPU: 1018
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_35_gpu_1019 [label="Expert 27
GPU: 1019
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_35_gpu_1020 [label="Expert 28
GPU: 1020
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_35_gpu_1021 [label="Expert 29
GPU: 1021
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_35_gpu_1022 [label="Expert 30
GPU: 1022
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_35_gpu_1023 [label="Expert 31
GPU: 1023
Node: 127
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_35 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_36 {
		color=lightgreen label="MoE Layer 36 (32 Experts)" style="rounded,filled"
		mha_layer_36_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_36_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_36_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_36 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_36_gpu_1024 [label="Expert 0
GPU: 1024
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_36_gpu_1025 [label="Expert 1
GPU: 1025
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_36_gpu_1026 [label="Expert 2
GPU: 1026
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_36_gpu_1027 [label="Expert 3
GPU: 1027
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_36_gpu_1028 [label="Expert 4
GPU: 1028
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_36_gpu_1029 [label="Expert 5
GPU: 1029
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_36_gpu_1030 [label="Expert 6
GPU: 1030
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_36_gpu_1031 [label="Expert 7
GPU: 1031
Node: 128
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_36_gpu_1032 [label="Expert 8
GPU: 1032
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_36_gpu_1033 [label="Expert 9
GPU: 1033
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_36_gpu_1034 [label="Expert 10
GPU: 1034
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_36_gpu_1035 [label="Expert 11
GPU: 1035
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_36_gpu_1036 [label="Expert 12
GPU: 1036
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_36_gpu_1037 [label="Expert 13
GPU: 1037
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_36_gpu_1038 [label="Expert 14
GPU: 1038
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_36_gpu_1039 [label="Expert 15
GPU: 1039
Node: 129
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_36_gpu_1040 [label="Expert 16
GPU: 1040
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_36_gpu_1041 [label="Expert 17
GPU: 1041
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_36_gpu_1042 [label="Expert 18
GPU: 1042
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_36_gpu_1043 [label="Expert 19
GPU: 1043
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_36_gpu_1044 [label="Expert 20
GPU: 1044
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_36_gpu_1045 [label="Expert 21
GPU: 1045
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_36_gpu_1046 [label="Expert 22
GPU: 1046
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_36_gpu_1047 [label="Expert 23
GPU: 1047
Node: 130
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_36_gpu_1048 [label="Expert 24
GPU: 1048
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_36_gpu_1049 [label="Expert 25
GPU: 1049
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_36_gpu_1050 [label="Expert 26
GPU: 1050
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_36_gpu_1051 [label="Expert 27
GPU: 1051
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_36_gpu_1052 [label="Expert 28
GPU: 1052
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_36_gpu_1053 [label="Expert 29
GPU: 1053
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_36_gpu_1054 [label="Expert 30
GPU: 1054
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_36_gpu_1055 [label="Expert 31
GPU: 1055
Node: 131
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_36 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_37 {
		color=lightgreen label="MoE Layer 37 (32 Experts)" style="rounded,filled"
		mha_layer_37_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_37_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_37_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_37 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_37_gpu_1056 [label="Expert 0
GPU: 1056
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_37_gpu_1057 [label="Expert 1
GPU: 1057
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_37_gpu_1058 [label="Expert 2
GPU: 1058
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_37_gpu_1059 [label="Expert 3
GPU: 1059
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_37_gpu_1060 [label="Expert 4
GPU: 1060
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_37_gpu_1061 [label="Expert 5
GPU: 1061
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_37_gpu_1062 [label="Expert 6
GPU: 1062
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_37_gpu_1063 [label="Expert 7
GPU: 1063
Node: 132
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_37_gpu_1064 [label="Expert 8
GPU: 1064
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_37_gpu_1065 [label="Expert 9
GPU: 1065
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_37_gpu_1066 [label="Expert 10
GPU: 1066
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_37_gpu_1067 [label="Expert 11
GPU: 1067
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_37_gpu_1068 [label="Expert 12
GPU: 1068
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_37_gpu_1069 [label="Expert 13
GPU: 1069
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_37_gpu_1070 [label="Expert 14
GPU: 1070
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_37_gpu_1071 [label="Expert 15
GPU: 1071
Node: 133
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_37_gpu_1072 [label="Expert 16
GPU: 1072
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_37_gpu_1073 [label="Expert 17
GPU: 1073
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_37_gpu_1074 [label="Expert 18
GPU: 1074
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_37_gpu_1075 [label="Expert 19
GPU: 1075
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_37_gpu_1076 [label="Expert 20
GPU: 1076
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_37_gpu_1077 [label="Expert 21
GPU: 1077
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_37_gpu_1078 [label="Expert 22
GPU: 1078
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_37_gpu_1079 [label="Expert 23
GPU: 1079
Node: 134
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_37_gpu_1080 [label="Expert 24
GPU: 1080
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_37_gpu_1081 [label="Expert 25
GPU: 1081
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_37_gpu_1082 [label="Expert 26
GPU: 1082
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_37_gpu_1083 [label="Expert 27
GPU: 1083
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_37_gpu_1084 [label="Expert 28
GPU: 1084
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_37_gpu_1085 [label="Expert 29
GPU: 1085
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_37_gpu_1086 [label="Expert 30
GPU: 1086
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_37_gpu_1087 [label="Expert 31
GPU: 1087
Node: 135
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_37 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_38 {
		color=lightgreen label="MoE Layer 38 (32 Experts)" style="rounded,filled"
		mha_layer_38_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_38_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_38_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_38 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_38_gpu_1088 [label="Expert 0
GPU: 1088
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_38_gpu_1089 [label="Expert 1
GPU: 1089
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_38_gpu_1090 [label="Expert 2
GPU: 1090
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_38_gpu_1091 [label="Expert 3
GPU: 1091
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_38_gpu_1092 [label="Expert 4
GPU: 1092
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_38_gpu_1093 [label="Expert 5
GPU: 1093
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_38_gpu_1094 [label="Expert 6
GPU: 1094
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_38_gpu_1095 [label="Expert 7
GPU: 1095
Node: 136
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_38_gpu_1096 [label="Expert 8
GPU: 1096
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_38_gpu_1097 [label="Expert 9
GPU: 1097
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_38_gpu_1098 [label="Expert 10
GPU: 1098
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_38_gpu_1099 [label="Expert 11
GPU: 1099
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_38_gpu_1100 [label="Expert 12
GPU: 1100
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_38_gpu_1101 [label="Expert 13
GPU: 1101
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_38_gpu_1102 [label="Expert 14
GPU: 1102
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_38_gpu_1103 [label="Expert 15
GPU: 1103
Node: 137
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_38_gpu_1104 [label="Expert 16
GPU: 1104
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_38_gpu_1105 [label="Expert 17
GPU: 1105
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_38_gpu_1106 [label="Expert 18
GPU: 1106
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_38_gpu_1107 [label="Expert 19
GPU: 1107
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_38_gpu_1108 [label="Expert 20
GPU: 1108
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_38_gpu_1109 [label="Expert 21
GPU: 1109
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_38_gpu_1110 [label="Expert 22
GPU: 1110
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_38_gpu_1111 [label="Expert 23
GPU: 1111
Node: 138
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_38_gpu_1112 [label="Expert 24
GPU: 1112
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_38_gpu_1113 [label="Expert 25
GPU: 1113
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_38_gpu_1114 [label="Expert 26
GPU: 1114
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_38_gpu_1115 [label="Expert 27
GPU: 1115
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_38_gpu_1116 [label="Expert 28
GPU: 1116
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_38_gpu_1117 [label="Expert 29
GPU: 1117
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_38_gpu_1118 [label="Expert 30
GPU: 1118
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_38_gpu_1119 [label="Expert 31
GPU: 1119
Node: 139
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_38 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_39 {
		color=lightgreen label="MoE Layer 39 (32 Experts)" style="rounded,filled"
		mha_layer_39_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_39_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_39_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_39 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_39_gpu_1120 [label="Expert 0
GPU: 1120
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_39_gpu_1121 [label="Expert 1
GPU: 1121
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_39_gpu_1122 [label="Expert 2
GPU: 1122
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_39_gpu_1123 [label="Expert 3
GPU: 1123
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_39_gpu_1124 [label="Expert 4
GPU: 1124
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_39_gpu_1125 [label="Expert 5
GPU: 1125
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_39_gpu_1126 [label="Expert 6
GPU: 1126
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_39_gpu_1127 [label="Expert 7
GPU: 1127
Node: 140
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_39_gpu_1128 [label="Expert 8
GPU: 1128
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_39_gpu_1129 [label="Expert 9
GPU: 1129
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_39_gpu_1130 [label="Expert 10
GPU: 1130
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_39_gpu_1131 [label="Expert 11
GPU: 1131
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_39_gpu_1132 [label="Expert 12
GPU: 1132
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_39_gpu_1133 [label="Expert 13
GPU: 1133
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_39_gpu_1134 [label="Expert 14
GPU: 1134
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_39_gpu_1135 [label="Expert 15
GPU: 1135
Node: 141
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_39_gpu_1136 [label="Expert 16
GPU: 1136
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_39_gpu_1137 [label="Expert 17
GPU: 1137
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_39_gpu_1138 [label="Expert 18
GPU: 1138
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_39_gpu_1139 [label="Expert 19
GPU: 1139
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_39_gpu_1140 [label="Expert 20
GPU: 1140
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_39_gpu_1141 [label="Expert 21
GPU: 1141
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_39_gpu_1142 [label="Expert 22
GPU: 1142
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_39_gpu_1143 [label="Expert 23
GPU: 1143
Node: 142
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_39_gpu_1144 [label="Expert 24
GPU: 1144
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_39_gpu_1145 [label="Expert 25
GPU: 1145
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_39_gpu_1146 [label="Expert 26
GPU: 1146
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_39_gpu_1147 [label="Expert 27
GPU: 1147
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_39_gpu_1148 [label="Expert 28
GPU: 1148
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_39_gpu_1149 [label="Expert 29
GPU: 1149
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_39_gpu_1150 [label="Expert 30
GPU: 1150
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_39_gpu_1151 [label="Expert 31
GPU: 1151
Node: 143
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_39 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_40 {
		color=lightgreen label="MoE Layer 40 (32 Experts)" style="rounded,filled"
		mha_layer_40_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_40_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_40_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_40 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_40_gpu_1152 [label="Expert 0
GPU: 1152
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_40_gpu_1153 [label="Expert 1
GPU: 1153
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_40_gpu_1154 [label="Expert 2
GPU: 1154
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_40_gpu_1155 [label="Expert 3
GPU: 1155
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_40_gpu_1156 [label="Expert 4
GPU: 1156
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_40_gpu_1157 [label="Expert 5
GPU: 1157
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_40_gpu_1158 [label="Expert 6
GPU: 1158
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_40_gpu_1159 [label="Expert 7
GPU: 1159
Node: 144
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_40_gpu_1160 [label="Expert 8
GPU: 1160
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_40_gpu_1161 [label="Expert 9
GPU: 1161
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_40_gpu_1162 [label="Expert 10
GPU: 1162
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_40_gpu_1163 [label="Expert 11
GPU: 1163
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_40_gpu_1164 [label="Expert 12
GPU: 1164
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_40_gpu_1165 [label="Expert 13
GPU: 1165
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_40_gpu_1166 [label="Expert 14
GPU: 1166
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_40_gpu_1167 [label="Expert 15
GPU: 1167
Node: 145
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_40_gpu_1168 [label="Expert 16
GPU: 1168
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_40_gpu_1169 [label="Expert 17
GPU: 1169
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_40_gpu_1170 [label="Expert 18
GPU: 1170
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_40_gpu_1171 [label="Expert 19
GPU: 1171
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_40_gpu_1172 [label="Expert 20
GPU: 1172
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_40_gpu_1173 [label="Expert 21
GPU: 1173
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_40_gpu_1174 [label="Expert 22
GPU: 1174
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_40_gpu_1175 [label="Expert 23
GPU: 1175
Node: 146
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_40_gpu_1176 [label="Expert 24
GPU: 1176
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_40_gpu_1177 [label="Expert 25
GPU: 1177
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_40_gpu_1178 [label="Expert 26
GPU: 1178
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_40_gpu_1179 [label="Expert 27
GPU: 1179
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_40_gpu_1180 [label="Expert 28
GPU: 1180
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_40_gpu_1181 [label="Expert 29
GPU: 1181
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_40_gpu_1182 [label="Expert 30
GPU: 1182
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_40_gpu_1183 [label="Expert 31
GPU: 1183
Node: 147
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_40 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_41 {
		color=lightgreen label="MoE Layer 41 (32 Experts)" style="rounded,filled"
		mha_layer_41_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_41_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_41_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_41 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_41_gpu_1184 [label="Expert 0
GPU: 1184
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_41_gpu_1185 [label="Expert 1
GPU: 1185
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_41_gpu_1186 [label="Expert 2
GPU: 1186
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_41_gpu_1187 [label="Expert 3
GPU: 1187
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_41_gpu_1188 [label="Expert 4
GPU: 1188
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_41_gpu_1189 [label="Expert 5
GPU: 1189
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_41_gpu_1190 [label="Expert 6
GPU: 1190
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_41_gpu_1191 [label="Expert 7
GPU: 1191
Node: 148
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_41_gpu_1192 [label="Expert 8
GPU: 1192
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_41_gpu_1193 [label="Expert 9
GPU: 1193
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_41_gpu_1194 [label="Expert 10
GPU: 1194
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_41_gpu_1195 [label="Expert 11
GPU: 1195
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_41_gpu_1196 [label="Expert 12
GPU: 1196
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_41_gpu_1197 [label="Expert 13
GPU: 1197
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_41_gpu_1198 [label="Expert 14
GPU: 1198
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_41_gpu_1199 [label="Expert 15
GPU: 1199
Node: 149
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_41_gpu_1200 [label="Expert 16
GPU: 1200
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_41_gpu_1201 [label="Expert 17
GPU: 1201
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_41_gpu_1202 [label="Expert 18
GPU: 1202
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_41_gpu_1203 [label="Expert 19
GPU: 1203
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_41_gpu_1204 [label="Expert 20
GPU: 1204
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_41_gpu_1205 [label="Expert 21
GPU: 1205
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_41_gpu_1206 [label="Expert 22
GPU: 1206
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_41_gpu_1207 [label="Expert 23
GPU: 1207
Node: 150
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_41_gpu_1208 [label="Expert 24
GPU: 1208
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_41_gpu_1209 [label="Expert 25
GPU: 1209
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_41_gpu_1210 [label="Expert 26
GPU: 1210
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_41_gpu_1211 [label="Expert 27
GPU: 1211
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_41_gpu_1212 [label="Expert 28
GPU: 1212
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_41_gpu_1213 [label="Expert 29
GPU: 1213
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_41_gpu_1214 [label="Expert 30
GPU: 1214
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_41_gpu_1215 [label="Expert 31
GPU: 1215
Node: 151
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_41 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_42 {
		color=lightgreen label="MoE Layer 42 (32 Experts)" style="rounded,filled"
		mha_layer_42_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_42_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_42_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_42 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_42_gpu_1216 [label="Expert 0
GPU: 1216
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_42_gpu_1217 [label="Expert 1
GPU: 1217
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_42_gpu_1218 [label="Expert 2
GPU: 1218
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_42_gpu_1219 [label="Expert 3
GPU: 1219
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_42_gpu_1220 [label="Expert 4
GPU: 1220
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_42_gpu_1221 [label="Expert 5
GPU: 1221
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_42_gpu_1222 [label="Expert 6
GPU: 1222
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_42_gpu_1223 [label="Expert 7
GPU: 1223
Node: 152
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_42_gpu_1224 [label="Expert 8
GPU: 1224
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_42_gpu_1225 [label="Expert 9
GPU: 1225
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_42_gpu_1226 [label="Expert 10
GPU: 1226
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_42_gpu_1227 [label="Expert 11
GPU: 1227
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_42_gpu_1228 [label="Expert 12
GPU: 1228
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_42_gpu_1229 [label="Expert 13
GPU: 1229
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_42_gpu_1230 [label="Expert 14
GPU: 1230
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_42_gpu_1231 [label="Expert 15
GPU: 1231
Node: 153
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_42_gpu_1232 [label="Expert 16
GPU: 1232
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_42_gpu_1233 [label="Expert 17
GPU: 1233
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_42_gpu_1234 [label="Expert 18
GPU: 1234
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_42_gpu_1235 [label="Expert 19
GPU: 1235
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_42_gpu_1236 [label="Expert 20
GPU: 1236
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_42_gpu_1237 [label="Expert 21
GPU: 1237
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_42_gpu_1238 [label="Expert 22
GPU: 1238
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_42_gpu_1239 [label="Expert 23
GPU: 1239
Node: 154
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_42_gpu_1240 [label="Expert 24
GPU: 1240
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_42_gpu_1241 [label="Expert 25
GPU: 1241
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_42_gpu_1242 [label="Expert 26
GPU: 1242
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_42_gpu_1243 [label="Expert 27
GPU: 1243
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_42_gpu_1244 [label="Expert 28
GPU: 1244
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_42_gpu_1245 [label="Expert 29
GPU: 1245
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_42_gpu_1246 [label="Expert 30
GPU: 1246
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_42_gpu_1247 [label="Expert 31
GPU: 1247
Node: 155
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_42 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_43 {
		color=lightgreen label="MoE Layer 43 (32 Experts)" style="rounded,filled"
		mha_layer_43_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_43_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_43_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_43 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_43_gpu_1248 [label="Expert 0
GPU: 1248
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_43_gpu_1249 [label="Expert 1
GPU: 1249
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_43_gpu_1250 [label="Expert 2
GPU: 1250
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_43_gpu_1251 [label="Expert 3
GPU: 1251
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_43_gpu_1252 [label="Expert 4
GPU: 1252
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_43_gpu_1253 [label="Expert 5
GPU: 1253
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_43_gpu_1254 [label="Expert 6
GPU: 1254
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_43_gpu_1255 [label="Expert 7
GPU: 1255
Node: 156
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_43_gpu_1256 [label="Expert 8
GPU: 1256
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_43_gpu_1257 [label="Expert 9
GPU: 1257
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_43_gpu_1258 [label="Expert 10
GPU: 1258
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_43_gpu_1259 [label="Expert 11
GPU: 1259
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_43_gpu_1260 [label="Expert 12
GPU: 1260
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_43_gpu_1261 [label="Expert 13
GPU: 1261
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_43_gpu_1262 [label="Expert 14
GPU: 1262
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_43_gpu_1263 [label="Expert 15
GPU: 1263
Node: 157
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_43_gpu_1264 [label="Expert 16
GPU: 1264
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_43_gpu_1265 [label="Expert 17
GPU: 1265
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_43_gpu_1266 [label="Expert 18
GPU: 1266
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_43_gpu_1267 [label="Expert 19
GPU: 1267
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_43_gpu_1268 [label="Expert 20
GPU: 1268
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_43_gpu_1269 [label="Expert 21
GPU: 1269
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_43_gpu_1270 [label="Expert 22
GPU: 1270
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_43_gpu_1271 [label="Expert 23
GPU: 1271
Node: 158
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_43_gpu_1272 [label="Expert 24
GPU: 1272
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_43_gpu_1273 [label="Expert 25
GPU: 1273
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_43_gpu_1274 [label="Expert 26
GPU: 1274
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_43_gpu_1275 [label="Expert 27
GPU: 1275
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_43_gpu_1276 [label="Expert 28
GPU: 1276
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_43_gpu_1277 [label="Expert 29
GPU: 1277
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_43_gpu_1278 [label="Expert 30
GPU: 1278
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_43_gpu_1279 [label="Expert 31
GPU: 1279
Node: 159
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_43 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_44 {
		color=lightgreen label="MoE Layer 44 (32 Experts)" style="rounded,filled"
		mha_layer_44_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_44_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_44_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_44 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_44_gpu_1280 [label="Expert 0
GPU: 1280
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_44_gpu_1281 [label="Expert 1
GPU: 1281
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_44_gpu_1282 [label="Expert 2
GPU: 1282
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_44_gpu_1283 [label="Expert 3
GPU: 1283
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_44_gpu_1284 [label="Expert 4
GPU: 1284
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_44_gpu_1285 [label="Expert 5
GPU: 1285
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_44_gpu_1286 [label="Expert 6
GPU: 1286
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_44_gpu_1287 [label="Expert 7
GPU: 1287
Node: 160
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_44_gpu_1288 [label="Expert 8
GPU: 1288
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_44_gpu_1289 [label="Expert 9
GPU: 1289
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_44_gpu_1290 [label="Expert 10
GPU: 1290
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_44_gpu_1291 [label="Expert 11
GPU: 1291
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_44_gpu_1292 [label="Expert 12
GPU: 1292
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_44_gpu_1293 [label="Expert 13
GPU: 1293
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_44_gpu_1294 [label="Expert 14
GPU: 1294
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_44_gpu_1295 [label="Expert 15
GPU: 1295
Node: 161
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_44_gpu_1296 [label="Expert 16
GPU: 1296
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_44_gpu_1297 [label="Expert 17
GPU: 1297
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_44_gpu_1298 [label="Expert 18
GPU: 1298
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_44_gpu_1299 [label="Expert 19
GPU: 1299
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_44_gpu_1300 [label="Expert 20
GPU: 1300
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_44_gpu_1301 [label="Expert 21
GPU: 1301
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_44_gpu_1302 [label="Expert 22
GPU: 1302
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_44_gpu_1303 [label="Expert 23
GPU: 1303
Node: 162
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_44_gpu_1304 [label="Expert 24
GPU: 1304
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_44_gpu_1305 [label="Expert 25
GPU: 1305
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_44_gpu_1306 [label="Expert 26
GPU: 1306
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_44_gpu_1307 [label="Expert 27
GPU: 1307
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_44_gpu_1308 [label="Expert 28
GPU: 1308
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_44_gpu_1309 [label="Expert 29
GPU: 1309
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_44_gpu_1310 [label="Expert 30
GPU: 1310
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_44_gpu_1311 [label="Expert 31
GPU: 1311
Node: 163
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_44 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_45 {
		color=lightgreen label="MoE Layer 45 (32 Experts)" style="rounded,filled"
		mha_layer_45_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_45_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_45_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_45 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_45_gpu_1312 [label="Expert 0
GPU: 1312
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_45_gpu_1313 [label="Expert 1
GPU: 1313
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_45_gpu_1314 [label="Expert 2
GPU: 1314
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_45_gpu_1315 [label="Expert 3
GPU: 1315
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_45_gpu_1316 [label="Expert 4
GPU: 1316
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_45_gpu_1317 [label="Expert 5
GPU: 1317
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_45_gpu_1318 [label="Expert 6
GPU: 1318
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_45_gpu_1319 [label="Expert 7
GPU: 1319
Node: 164
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_45_gpu_1320 [label="Expert 8
GPU: 1320
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_45_gpu_1321 [label="Expert 9
GPU: 1321
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_45_gpu_1322 [label="Expert 10
GPU: 1322
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_45_gpu_1323 [label="Expert 11
GPU: 1323
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_45_gpu_1324 [label="Expert 12
GPU: 1324
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_45_gpu_1325 [label="Expert 13
GPU: 1325
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_45_gpu_1326 [label="Expert 14
GPU: 1326
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_45_gpu_1327 [label="Expert 15
GPU: 1327
Node: 165
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_45_gpu_1328 [label="Expert 16
GPU: 1328
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_45_gpu_1329 [label="Expert 17
GPU: 1329
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_45_gpu_1330 [label="Expert 18
GPU: 1330
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_45_gpu_1331 [label="Expert 19
GPU: 1331
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_45_gpu_1332 [label="Expert 20
GPU: 1332
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_45_gpu_1333 [label="Expert 21
GPU: 1333
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_45_gpu_1334 [label="Expert 22
GPU: 1334
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_45_gpu_1335 [label="Expert 23
GPU: 1335
Node: 166
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_45_gpu_1336 [label="Expert 24
GPU: 1336
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_45_gpu_1337 [label="Expert 25
GPU: 1337
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_45_gpu_1338 [label="Expert 26
GPU: 1338
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_45_gpu_1339 [label="Expert 27
GPU: 1339
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_45_gpu_1340 [label="Expert 28
GPU: 1340
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_45_gpu_1341 [label="Expert 29
GPU: 1341
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_45_gpu_1342 [label="Expert 30
GPU: 1342
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_45_gpu_1343 [label="Expert 31
GPU: 1343
Node: 167
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_45 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_46 {
		color=lightgreen label="MoE Layer 46 (32 Experts)" style="rounded,filled"
		mha_layer_46_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_46_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_46_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_46 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_46_gpu_1344 [label="Expert 0
GPU: 1344
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_46_gpu_1345 [label="Expert 1
GPU: 1345
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_46_gpu_1346 [label="Expert 2
GPU: 1346
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_46_gpu_1347 [label="Expert 3
GPU: 1347
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_46_gpu_1348 [label="Expert 4
GPU: 1348
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_46_gpu_1349 [label="Expert 5
GPU: 1349
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_46_gpu_1350 [label="Expert 6
GPU: 1350
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_46_gpu_1351 [label="Expert 7
GPU: 1351
Node: 168
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_46_gpu_1352 [label="Expert 8
GPU: 1352
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_46_gpu_1353 [label="Expert 9
GPU: 1353
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_46_gpu_1354 [label="Expert 10
GPU: 1354
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_46_gpu_1355 [label="Expert 11
GPU: 1355
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_46_gpu_1356 [label="Expert 12
GPU: 1356
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_46_gpu_1357 [label="Expert 13
GPU: 1357
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_46_gpu_1358 [label="Expert 14
GPU: 1358
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_46_gpu_1359 [label="Expert 15
GPU: 1359
Node: 169
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_46_gpu_1360 [label="Expert 16
GPU: 1360
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_46_gpu_1361 [label="Expert 17
GPU: 1361
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_46_gpu_1362 [label="Expert 18
GPU: 1362
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_46_gpu_1363 [label="Expert 19
GPU: 1363
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_46_gpu_1364 [label="Expert 20
GPU: 1364
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_46_gpu_1365 [label="Expert 21
GPU: 1365
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_46_gpu_1366 [label="Expert 22
GPU: 1366
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_46_gpu_1367 [label="Expert 23
GPU: 1367
Node: 170
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_46_gpu_1368 [label="Expert 24
GPU: 1368
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_46_gpu_1369 [label="Expert 25
GPU: 1369
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_46_gpu_1370 [label="Expert 26
GPU: 1370
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_46_gpu_1371 [label="Expert 27
GPU: 1371
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_46_gpu_1372 [label="Expert 28
GPU: 1372
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_46_gpu_1373 [label="Expert 29
GPU: 1373
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_46_gpu_1374 [label="Expert 30
GPU: 1374
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_46_gpu_1375 [label="Expert 31
GPU: 1375
Node: 171
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_46 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_47 {
		color=lightgreen label="MoE Layer 47 (32 Experts)" style="rounded,filled"
		mha_layer_47_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_47_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_47_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_47 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_47_gpu_1376 [label="Expert 0
GPU: 1376
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_47_gpu_1377 [label="Expert 1
GPU: 1377
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_47_gpu_1378 [label="Expert 2
GPU: 1378
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_47_gpu_1379 [label="Expert 3
GPU: 1379
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_47_gpu_1380 [label="Expert 4
GPU: 1380
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_47_gpu_1381 [label="Expert 5
GPU: 1381
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_47_gpu_1382 [label="Expert 6
GPU: 1382
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_47_gpu_1383 [label="Expert 7
GPU: 1383
Node: 172
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_47_gpu_1384 [label="Expert 8
GPU: 1384
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_47_gpu_1385 [label="Expert 9
GPU: 1385
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_47_gpu_1386 [label="Expert 10
GPU: 1386
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_47_gpu_1387 [label="Expert 11
GPU: 1387
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_47_gpu_1388 [label="Expert 12
GPU: 1388
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_47_gpu_1389 [label="Expert 13
GPU: 1389
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_47_gpu_1390 [label="Expert 14
GPU: 1390
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_47_gpu_1391 [label="Expert 15
GPU: 1391
Node: 173
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_47_gpu_1392 [label="Expert 16
GPU: 1392
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_47_gpu_1393 [label="Expert 17
GPU: 1393
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_47_gpu_1394 [label="Expert 18
GPU: 1394
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_47_gpu_1395 [label="Expert 19
GPU: 1395
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_47_gpu_1396 [label="Expert 20
GPU: 1396
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_47_gpu_1397 [label="Expert 21
GPU: 1397
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_47_gpu_1398 [label="Expert 22
GPU: 1398
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_47_gpu_1399 [label="Expert 23
GPU: 1399
Node: 174
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_47_gpu_1400 [label="Expert 24
GPU: 1400
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_47_gpu_1401 [label="Expert 25
GPU: 1401
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_47_gpu_1402 [label="Expert 26
GPU: 1402
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_47_gpu_1403 [label="Expert 27
GPU: 1403
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_47_gpu_1404 [label="Expert 28
GPU: 1404
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_47_gpu_1405 [label="Expert 29
GPU: 1405
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_47_gpu_1406 [label="Expert 30
GPU: 1406
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_47_gpu_1407 [label="Expert 31
GPU: 1407
Node: 175
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_47 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_48 {
		color=lightgreen label="MoE Layer 48 (32 Experts)" style="rounded,filled"
		mha_layer_48_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_48_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_48_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_48 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_48_gpu_1408 [label="Expert 0
GPU: 1408
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_48_gpu_1409 [label="Expert 1
GPU: 1409
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_48_gpu_1410 [label="Expert 2
GPU: 1410
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_48_gpu_1411 [label="Expert 3
GPU: 1411
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_48_gpu_1412 [label="Expert 4
GPU: 1412
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_48_gpu_1413 [label="Expert 5
GPU: 1413
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_48_gpu_1414 [label="Expert 6
GPU: 1414
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_48_gpu_1415 [label="Expert 7
GPU: 1415
Node: 176
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_48_gpu_1416 [label="Expert 8
GPU: 1416
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_48_gpu_1417 [label="Expert 9
GPU: 1417
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_48_gpu_1418 [label="Expert 10
GPU: 1418
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_48_gpu_1419 [label="Expert 11
GPU: 1419
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_48_gpu_1420 [label="Expert 12
GPU: 1420
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_48_gpu_1421 [label="Expert 13
GPU: 1421
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_48_gpu_1422 [label="Expert 14
GPU: 1422
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_48_gpu_1423 [label="Expert 15
GPU: 1423
Node: 177
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_48_gpu_1424 [label="Expert 16
GPU: 1424
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_48_gpu_1425 [label="Expert 17
GPU: 1425
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_48_gpu_1426 [label="Expert 18
GPU: 1426
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_48_gpu_1427 [label="Expert 19
GPU: 1427
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_48_gpu_1428 [label="Expert 20
GPU: 1428
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_48_gpu_1429 [label="Expert 21
GPU: 1429
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_48_gpu_1430 [label="Expert 22
GPU: 1430
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_48_gpu_1431 [label="Expert 23
GPU: 1431
Node: 178
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_48_gpu_1432 [label="Expert 24
GPU: 1432
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_48_gpu_1433 [label="Expert 25
GPU: 1433
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_48_gpu_1434 [label="Expert 26
GPU: 1434
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_48_gpu_1435 [label="Expert 27
GPU: 1435
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_48_gpu_1436 [label="Expert 28
GPU: 1436
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_48_gpu_1437 [label="Expert 29
GPU: 1437
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_48_gpu_1438 [label="Expert 30
GPU: 1438
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_48_gpu_1439 [label="Expert 31
GPU: 1439
Node: 179
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_48 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_49 {
		color=lightgreen label="MoE Layer 49 (32 Experts)" style="rounded,filled"
		mha_layer_49_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_49_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_49_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_49 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_49_gpu_1440 [label="Expert 0
GPU: 1440
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_49_gpu_1441 [label="Expert 1
GPU: 1441
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_49_gpu_1442 [label="Expert 2
GPU: 1442
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_49_gpu_1443 [label="Expert 3
GPU: 1443
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_49_gpu_1444 [label="Expert 4
GPU: 1444
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_49_gpu_1445 [label="Expert 5
GPU: 1445
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_49_gpu_1446 [label="Expert 6
GPU: 1446
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_49_gpu_1447 [label="Expert 7
GPU: 1447
Node: 180
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_49_gpu_1448 [label="Expert 8
GPU: 1448
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_49_gpu_1449 [label="Expert 9
GPU: 1449
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_49_gpu_1450 [label="Expert 10
GPU: 1450
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_49_gpu_1451 [label="Expert 11
GPU: 1451
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_49_gpu_1452 [label="Expert 12
GPU: 1452
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_49_gpu_1453 [label="Expert 13
GPU: 1453
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_49_gpu_1454 [label="Expert 14
GPU: 1454
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_49_gpu_1455 [label="Expert 15
GPU: 1455
Node: 181
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_49_gpu_1456 [label="Expert 16
GPU: 1456
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_49_gpu_1457 [label="Expert 17
GPU: 1457
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_49_gpu_1458 [label="Expert 18
GPU: 1458
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_49_gpu_1459 [label="Expert 19
GPU: 1459
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_49_gpu_1460 [label="Expert 20
GPU: 1460
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_49_gpu_1461 [label="Expert 21
GPU: 1461
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_49_gpu_1462 [label="Expert 22
GPU: 1462
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_49_gpu_1463 [label="Expert 23
GPU: 1463
Node: 182
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_49_gpu_1464 [label="Expert 24
GPU: 1464
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_49_gpu_1465 [label="Expert 25
GPU: 1465
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_49_gpu_1466 [label="Expert 26
GPU: 1466
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_49_gpu_1467 [label="Expert 27
GPU: 1467
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_49_gpu_1468 [label="Expert 28
GPU: 1468
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_49_gpu_1469 [label="Expert 29
GPU: 1469
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_49_gpu_1470 [label="Expert 30
GPU: 1470
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_49_gpu_1471 [label="Expert 31
GPU: 1471
Node: 183
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_49 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_50 {
		color=lightgreen label="MoE Layer 50 (32 Experts)" style="rounded,filled"
		mha_layer_50_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_50_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_50_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_50 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_50_gpu_1472 [label="Expert 0
GPU: 1472
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_50_gpu_1473 [label="Expert 1
GPU: 1473
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_50_gpu_1474 [label="Expert 2
GPU: 1474
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_50_gpu_1475 [label="Expert 3
GPU: 1475
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_50_gpu_1476 [label="Expert 4
GPU: 1476
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_50_gpu_1477 [label="Expert 5
GPU: 1477
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_50_gpu_1478 [label="Expert 6
GPU: 1478
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_50_gpu_1479 [label="Expert 7
GPU: 1479
Node: 184
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_50_gpu_1480 [label="Expert 8
GPU: 1480
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_50_gpu_1481 [label="Expert 9
GPU: 1481
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_50_gpu_1482 [label="Expert 10
GPU: 1482
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_50_gpu_1483 [label="Expert 11
GPU: 1483
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_50_gpu_1484 [label="Expert 12
GPU: 1484
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_50_gpu_1485 [label="Expert 13
GPU: 1485
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_50_gpu_1486 [label="Expert 14
GPU: 1486
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_50_gpu_1487 [label="Expert 15
GPU: 1487
Node: 185
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_50_gpu_1488 [label="Expert 16
GPU: 1488
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_50_gpu_1489 [label="Expert 17
GPU: 1489
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_50_gpu_1490 [label="Expert 18
GPU: 1490
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_50_gpu_1491 [label="Expert 19
GPU: 1491
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_50_gpu_1492 [label="Expert 20
GPU: 1492
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_50_gpu_1493 [label="Expert 21
GPU: 1493
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_50_gpu_1494 [label="Expert 22
GPU: 1494
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_50_gpu_1495 [label="Expert 23
GPU: 1495
Node: 186
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_50_gpu_1496 [label="Expert 24
GPU: 1496
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_50_gpu_1497 [label="Expert 25
GPU: 1497
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_50_gpu_1498 [label="Expert 26
GPU: 1498
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_50_gpu_1499 [label="Expert 27
GPU: 1499
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_50_gpu_1500 [label="Expert 28
GPU: 1500
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_50_gpu_1501 [label="Expert 29
GPU: 1501
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_50_gpu_1502 [label="Expert 30
GPU: 1502
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_50_gpu_1503 [label="Expert 31
GPU: 1503
Node: 187
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_50 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_51 {
		color=lightgreen label="MoE Layer 51 (32 Experts)" style="rounded,filled"
		mha_layer_51_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_51_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_51_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_51 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_51_gpu_1504 [label="Expert 0
GPU: 1504
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_51_gpu_1505 [label="Expert 1
GPU: 1505
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_51_gpu_1506 [label="Expert 2
GPU: 1506
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_51_gpu_1507 [label="Expert 3
GPU: 1507
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_51_gpu_1508 [label="Expert 4
GPU: 1508
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_51_gpu_1509 [label="Expert 5
GPU: 1509
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_51_gpu_1510 [label="Expert 6
GPU: 1510
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_51_gpu_1511 [label="Expert 7
GPU: 1511
Node: 188
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_51_gpu_1512 [label="Expert 8
GPU: 1512
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_51_gpu_1513 [label="Expert 9
GPU: 1513
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_51_gpu_1514 [label="Expert 10
GPU: 1514
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_51_gpu_1515 [label="Expert 11
GPU: 1515
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_51_gpu_1516 [label="Expert 12
GPU: 1516
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_51_gpu_1517 [label="Expert 13
GPU: 1517
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_51_gpu_1518 [label="Expert 14
GPU: 1518
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_51_gpu_1519 [label="Expert 15
GPU: 1519
Node: 189
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_51_gpu_1520 [label="Expert 16
GPU: 1520
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_51_gpu_1521 [label="Expert 17
GPU: 1521
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_51_gpu_1522 [label="Expert 18
GPU: 1522
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_51_gpu_1523 [label="Expert 19
GPU: 1523
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_51_gpu_1524 [label="Expert 20
GPU: 1524
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_51_gpu_1525 [label="Expert 21
GPU: 1525
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_51_gpu_1526 [label="Expert 22
GPU: 1526
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_51_gpu_1527 [label="Expert 23
GPU: 1527
Node: 190
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_51_gpu_1528 [label="Expert 24
GPU: 1528
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_51_gpu_1529 [label="Expert 25
GPU: 1529
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_51_gpu_1530 [label="Expert 26
GPU: 1530
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_51_gpu_1531 [label="Expert 27
GPU: 1531
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_51_gpu_1532 [label="Expert 28
GPU: 1532
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_51_gpu_1533 [label="Expert 29
GPU: 1533
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_51_gpu_1534 [label="Expert 30
GPU: 1534
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_51_gpu_1535 [label="Expert 31
GPU: 1535
Node: 191
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_51 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_52 {
		color=lightgreen label="MoE Layer 52 (32 Experts)" style="rounded,filled"
		mha_layer_52_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_52_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_52_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_52 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_52_gpu_1536 [label="Expert 0
GPU: 1536
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_52_gpu_1537 [label="Expert 1
GPU: 1537
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_52_gpu_1538 [label="Expert 2
GPU: 1538
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_52_gpu_1539 [label="Expert 3
GPU: 1539
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_52_gpu_1540 [label="Expert 4
GPU: 1540
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_52_gpu_1541 [label="Expert 5
GPU: 1541
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_52_gpu_1542 [label="Expert 6
GPU: 1542
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_52_gpu_1543 [label="Expert 7
GPU: 1543
Node: 192
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_52_gpu_1544 [label="Expert 8
GPU: 1544
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_52_gpu_1545 [label="Expert 9
GPU: 1545
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_52_gpu_1546 [label="Expert 10
GPU: 1546
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_52_gpu_1547 [label="Expert 11
GPU: 1547
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_52_gpu_1548 [label="Expert 12
GPU: 1548
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_52_gpu_1549 [label="Expert 13
GPU: 1549
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_52_gpu_1550 [label="Expert 14
GPU: 1550
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_52_gpu_1551 [label="Expert 15
GPU: 1551
Node: 193
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_52_gpu_1552 [label="Expert 16
GPU: 1552
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_52_gpu_1553 [label="Expert 17
GPU: 1553
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_52_gpu_1554 [label="Expert 18
GPU: 1554
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_52_gpu_1555 [label="Expert 19
GPU: 1555
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_52_gpu_1556 [label="Expert 20
GPU: 1556
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_52_gpu_1557 [label="Expert 21
GPU: 1557
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_52_gpu_1558 [label="Expert 22
GPU: 1558
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_52_gpu_1559 [label="Expert 23
GPU: 1559
Node: 194
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_52_gpu_1560 [label="Expert 24
GPU: 1560
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_52_gpu_1561 [label="Expert 25
GPU: 1561
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_52_gpu_1562 [label="Expert 26
GPU: 1562
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_52_gpu_1563 [label="Expert 27
GPU: 1563
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_52_gpu_1564 [label="Expert 28
GPU: 1564
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_52_gpu_1565 [label="Expert 29
GPU: 1565
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_52_gpu_1566 [label="Expert 30
GPU: 1566
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_52_gpu_1567 [label="Expert 31
GPU: 1567
Node: 195
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_52 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_53 {
		color=lightgreen label="MoE Layer 53 (32 Experts)" style="rounded,filled"
		mha_layer_53_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_53_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_53_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_53 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_53_gpu_1568 [label="Expert 0
GPU: 1568
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_53_gpu_1569 [label="Expert 1
GPU: 1569
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_53_gpu_1570 [label="Expert 2
GPU: 1570
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_53_gpu_1571 [label="Expert 3
GPU: 1571
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_53_gpu_1572 [label="Expert 4
GPU: 1572
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_53_gpu_1573 [label="Expert 5
GPU: 1573
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_53_gpu_1574 [label="Expert 6
GPU: 1574
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_53_gpu_1575 [label="Expert 7
GPU: 1575
Node: 196
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_53_gpu_1576 [label="Expert 8
GPU: 1576
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_53_gpu_1577 [label="Expert 9
GPU: 1577
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_53_gpu_1578 [label="Expert 10
GPU: 1578
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_53_gpu_1579 [label="Expert 11
GPU: 1579
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_53_gpu_1580 [label="Expert 12
GPU: 1580
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_53_gpu_1581 [label="Expert 13
GPU: 1581
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_53_gpu_1582 [label="Expert 14
GPU: 1582
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_53_gpu_1583 [label="Expert 15
GPU: 1583
Node: 197
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_53_gpu_1584 [label="Expert 16
GPU: 1584
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_53_gpu_1585 [label="Expert 17
GPU: 1585
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_53_gpu_1586 [label="Expert 18
GPU: 1586
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_53_gpu_1587 [label="Expert 19
GPU: 1587
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_53_gpu_1588 [label="Expert 20
GPU: 1588
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_53_gpu_1589 [label="Expert 21
GPU: 1589
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_53_gpu_1590 [label="Expert 22
GPU: 1590
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_53_gpu_1591 [label="Expert 23
GPU: 1591
Node: 198
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_53_gpu_1592 [label="Expert 24
GPU: 1592
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_53_gpu_1593 [label="Expert 25
GPU: 1593
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_53_gpu_1594 [label="Expert 26
GPU: 1594
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_53_gpu_1595 [label="Expert 27
GPU: 1595
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_53_gpu_1596 [label="Expert 28
GPU: 1596
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_53_gpu_1597 [label="Expert 29
GPU: 1597
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_53_gpu_1598 [label="Expert 30
GPU: 1598
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_53_gpu_1599 [label="Expert 31
GPU: 1599
Node: 199
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_53 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_54 {
		color=lightgreen label="MoE Layer 54 (32 Experts)" style="rounded,filled"
		mha_layer_54_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_54_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_54_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_54 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_54_gpu_1600 [label="Expert 0
GPU: 1600
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_54_gpu_1601 [label="Expert 1
GPU: 1601
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_54_gpu_1602 [label="Expert 2
GPU: 1602
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_54_gpu_1603 [label="Expert 3
GPU: 1603
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_54_gpu_1604 [label="Expert 4
GPU: 1604
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_54_gpu_1605 [label="Expert 5
GPU: 1605
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_54_gpu_1606 [label="Expert 6
GPU: 1606
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_54_gpu_1607 [label="Expert 7
GPU: 1607
Node: 200
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_54_gpu_1608 [label="Expert 8
GPU: 1608
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_54_gpu_1609 [label="Expert 9
GPU: 1609
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_54_gpu_1610 [label="Expert 10
GPU: 1610
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_54_gpu_1611 [label="Expert 11
GPU: 1611
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_54_gpu_1612 [label="Expert 12
GPU: 1612
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_54_gpu_1613 [label="Expert 13
GPU: 1613
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_54_gpu_1614 [label="Expert 14
GPU: 1614
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_54_gpu_1615 [label="Expert 15
GPU: 1615
Node: 201
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_54_gpu_1616 [label="Expert 16
GPU: 1616
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_54_gpu_1617 [label="Expert 17
GPU: 1617
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_54_gpu_1618 [label="Expert 18
GPU: 1618
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_54_gpu_1619 [label="Expert 19
GPU: 1619
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_54_gpu_1620 [label="Expert 20
GPU: 1620
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_54_gpu_1621 [label="Expert 21
GPU: 1621
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_54_gpu_1622 [label="Expert 22
GPU: 1622
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_54_gpu_1623 [label="Expert 23
GPU: 1623
Node: 202
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_54_gpu_1624 [label="Expert 24
GPU: 1624
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_54_gpu_1625 [label="Expert 25
GPU: 1625
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_54_gpu_1626 [label="Expert 26
GPU: 1626
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_54_gpu_1627 [label="Expert 27
GPU: 1627
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_54_gpu_1628 [label="Expert 28
GPU: 1628
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_54_gpu_1629 [label="Expert 29
GPU: 1629
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_54_gpu_1630 [label="Expert 30
GPU: 1630
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_54_gpu_1631 [label="Expert 31
GPU: 1631
Node: 203
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_54 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_55 {
		color=lightgreen label="MoE Layer 55 (32 Experts)" style="rounded,filled"
		mha_layer_55_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_55_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_55_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_55 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_55_gpu_1632 [label="Expert 0
GPU: 1632
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_55_gpu_1633 [label="Expert 1
GPU: 1633
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_55_gpu_1634 [label="Expert 2
GPU: 1634
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_55_gpu_1635 [label="Expert 3
GPU: 1635
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_55_gpu_1636 [label="Expert 4
GPU: 1636
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_55_gpu_1637 [label="Expert 5
GPU: 1637
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_55_gpu_1638 [label="Expert 6
GPU: 1638
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_55_gpu_1639 [label="Expert 7
GPU: 1639
Node: 204
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_55_gpu_1640 [label="Expert 8
GPU: 1640
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_55_gpu_1641 [label="Expert 9
GPU: 1641
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_55_gpu_1642 [label="Expert 10
GPU: 1642
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_55_gpu_1643 [label="Expert 11
GPU: 1643
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_55_gpu_1644 [label="Expert 12
GPU: 1644
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_55_gpu_1645 [label="Expert 13
GPU: 1645
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_55_gpu_1646 [label="Expert 14
GPU: 1646
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_55_gpu_1647 [label="Expert 15
GPU: 1647
Node: 205
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_55_gpu_1648 [label="Expert 16
GPU: 1648
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_55_gpu_1649 [label="Expert 17
GPU: 1649
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_55_gpu_1650 [label="Expert 18
GPU: 1650
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_55_gpu_1651 [label="Expert 19
GPU: 1651
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_55_gpu_1652 [label="Expert 20
GPU: 1652
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_55_gpu_1653 [label="Expert 21
GPU: 1653
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_55_gpu_1654 [label="Expert 22
GPU: 1654
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_55_gpu_1655 [label="Expert 23
GPU: 1655
Node: 206
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_55_gpu_1656 [label="Expert 24
GPU: 1656
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_55_gpu_1657 [label="Expert 25
GPU: 1657
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_55_gpu_1658 [label="Expert 26
GPU: 1658
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_55_gpu_1659 [label="Expert 27
GPU: 1659
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_55_gpu_1660 [label="Expert 28
GPU: 1660
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_55_gpu_1661 [label="Expert 29
GPU: 1661
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_55_gpu_1662 [label="Expert 30
GPU: 1662
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_55_gpu_1663 [label="Expert 31
GPU: 1663
Node: 207
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_55 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_56 {
		color=lightgreen label="MoE Layer 56 (32 Experts)" style="rounded,filled"
		mha_layer_56_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_56_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_56_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_56 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_56_gpu_1664 [label="Expert 0
GPU: 1664
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_56_gpu_1665 [label="Expert 1
GPU: 1665
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_56_gpu_1666 [label="Expert 2
GPU: 1666
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_56_gpu_1667 [label="Expert 3
GPU: 1667
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_56_gpu_1668 [label="Expert 4
GPU: 1668
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_56_gpu_1669 [label="Expert 5
GPU: 1669
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_56_gpu_1670 [label="Expert 6
GPU: 1670
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_56_gpu_1671 [label="Expert 7
GPU: 1671
Node: 208
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_56_gpu_1672 [label="Expert 8
GPU: 1672
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_56_gpu_1673 [label="Expert 9
GPU: 1673
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_56_gpu_1674 [label="Expert 10
GPU: 1674
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_56_gpu_1675 [label="Expert 11
GPU: 1675
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_56_gpu_1676 [label="Expert 12
GPU: 1676
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_56_gpu_1677 [label="Expert 13
GPU: 1677
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_56_gpu_1678 [label="Expert 14
GPU: 1678
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_56_gpu_1679 [label="Expert 15
GPU: 1679
Node: 209
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_56_gpu_1680 [label="Expert 16
GPU: 1680
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_56_gpu_1681 [label="Expert 17
GPU: 1681
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_56_gpu_1682 [label="Expert 18
GPU: 1682
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_56_gpu_1683 [label="Expert 19
GPU: 1683
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_56_gpu_1684 [label="Expert 20
GPU: 1684
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_56_gpu_1685 [label="Expert 21
GPU: 1685
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_56_gpu_1686 [label="Expert 22
GPU: 1686
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_56_gpu_1687 [label="Expert 23
GPU: 1687
Node: 210
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_56_gpu_1688 [label="Expert 24
GPU: 1688
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_56_gpu_1689 [label="Expert 25
GPU: 1689
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_56_gpu_1690 [label="Expert 26
GPU: 1690
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_56_gpu_1691 [label="Expert 27
GPU: 1691
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_56_gpu_1692 [label="Expert 28
GPU: 1692
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_56_gpu_1693 [label="Expert 29
GPU: 1693
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_56_gpu_1694 [label="Expert 30
GPU: 1694
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_56_gpu_1695 [label="Expert 31
GPU: 1695
Node: 211
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_56 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_57 {
		color=lightgreen label="MoE Layer 57 (32 Experts)" style="rounded,filled"
		mha_layer_57_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_57_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_57_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_57 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_57_gpu_1696 [label="Expert 0
GPU: 1696
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_57_gpu_1697 [label="Expert 1
GPU: 1697
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_57_gpu_1698 [label="Expert 2
GPU: 1698
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_57_gpu_1699 [label="Expert 3
GPU: 1699
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_57_gpu_1700 [label="Expert 4
GPU: 1700
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_57_gpu_1701 [label="Expert 5
GPU: 1701
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_57_gpu_1702 [label="Expert 6
GPU: 1702
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_57_gpu_1703 [label="Expert 7
GPU: 1703
Node: 212
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_57_gpu_1704 [label="Expert 8
GPU: 1704
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_57_gpu_1705 [label="Expert 9
GPU: 1705
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_57_gpu_1706 [label="Expert 10
GPU: 1706
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_57_gpu_1707 [label="Expert 11
GPU: 1707
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_57_gpu_1708 [label="Expert 12
GPU: 1708
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_57_gpu_1709 [label="Expert 13
GPU: 1709
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_57_gpu_1710 [label="Expert 14
GPU: 1710
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_57_gpu_1711 [label="Expert 15
GPU: 1711
Node: 213
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_57_gpu_1712 [label="Expert 16
GPU: 1712
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_57_gpu_1713 [label="Expert 17
GPU: 1713
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_57_gpu_1714 [label="Expert 18
GPU: 1714
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_57_gpu_1715 [label="Expert 19
GPU: 1715
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_57_gpu_1716 [label="Expert 20
GPU: 1716
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_57_gpu_1717 [label="Expert 21
GPU: 1717
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_57_gpu_1718 [label="Expert 22
GPU: 1718
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_57_gpu_1719 [label="Expert 23
GPU: 1719
Node: 214
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_57_gpu_1720 [label="Expert 24
GPU: 1720
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_57_gpu_1721 [label="Expert 25
GPU: 1721
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_57_gpu_1722 [label="Expert 26
GPU: 1722
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_57_gpu_1723 [label="Expert 27
GPU: 1723
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_57_gpu_1724 [label="Expert 28
GPU: 1724
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_57_gpu_1725 [label="Expert 29
GPU: 1725
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_57_gpu_1726 [label="Expert 30
GPU: 1726
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_57_gpu_1727 [label="Expert 31
GPU: 1727
Node: 215
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_57 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_58 {
		color=lightgreen label="MoE Layer 58 (32 Experts)" style="rounded,filled"
		mha_layer_58_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_58_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_58_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_58 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_58_gpu_1728 [label="Expert 0
GPU: 1728
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_58_gpu_1729 [label="Expert 1
GPU: 1729
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_58_gpu_1730 [label="Expert 2
GPU: 1730
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_58_gpu_1731 [label="Expert 3
GPU: 1731
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_58_gpu_1732 [label="Expert 4
GPU: 1732
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_58_gpu_1733 [label="Expert 5
GPU: 1733
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_58_gpu_1734 [label="Expert 6
GPU: 1734
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_58_gpu_1735 [label="Expert 7
GPU: 1735
Node: 216
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_58_gpu_1736 [label="Expert 8
GPU: 1736
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_58_gpu_1737 [label="Expert 9
GPU: 1737
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_58_gpu_1738 [label="Expert 10
GPU: 1738
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_58_gpu_1739 [label="Expert 11
GPU: 1739
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_58_gpu_1740 [label="Expert 12
GPU: 1740
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_58_gpu_1741 [label="Expert 13
GPU: 1741
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_58_gpu_1742 [label="Expert 14
GPU: 1742
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_58_gpu_1743 [label="Expert 15
GPU: 1743
Node: 217
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_58_gpu_1744 [label="Expert 16
GPU: 1744
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_58_gpu_1745 [label="Expert 17
GPU: 1745
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_58_gpu_1746 [label="Expert 18
GPU: 1746
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_58_gpu_1747 [label="Expert 19
GPU: 1747
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_58_gpu_1748 [label="Expert 20
GPU: 1748
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_58_gpu_1749 [label="Expert 21
GPU: 1749
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_58_gpu_1750 [label="Expert 22
GPU: 1750
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_58_gpu_1751 [label="Expert 23
GPU: 1751
Node: 218
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_58_gpu_1752 [label="Expert 24
GPU: 1752
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_58_gpu_1753 [label="Expert 25
GPU: 1753
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_58_gpu_1754 [label="Expert 26
GPU: 1754
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_58_gpu_1755 [label="Expert 27
GPU: 1755
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_58_gpu_1756 [label="Expert 28
GPU: 1756
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_58_gpu_1757 [label="Expert 29
GPU: 1757
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_58_gpu_1758 [label="Expert 30
GPU: 1758
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_58_gpu_1759 [label="Expert 31
GPU: 1759
Node: 219
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_58 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_59 {
		color=lightgreen label="MoE Layer 59 (32 Experts)" style="rounded,filled"
		mha_layer_59_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_59_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_59_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_59 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_59_gpu_1760 [label="Expert 0
GPU: 1760
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_59_gpu_1761 [label="Expert 1
GPU: 1761
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_59_gpu_1762 [label="Expert 2
GPU: 1762
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_59_gpu_1763 [label="Expert 3
GPU: 1763
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_59_gpu_1764 [label="Expert 4
GPU: 1764
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_59_gpu_1765 [label="Expert 5
GPU: 1765
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_59_gpu_1766 [label="Expert 6
GPU: 1766
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_59_gpu_1767 [label="Expert 7
GPU: 1767
Node: 220
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_59_gpu_1768 [label="Expert 8
GPU: 1768
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_59_gpu_1769 [label="Expert 9
GPU: 1769
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_59_gpu_1770 [label="Expert 10
GPU: 1770
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_59_gpu_1771 [label="Expert 11
GPU: 1771
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_59_gpu_1772 [label="Expert 12
GPU: 1772
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_59_gpu_1773 [label="Expert 13
GPU: 1773
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_59_gpu_1774 [label="Expert 14
GPU: 1774
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_59_gpu_1775 [label="Expert 15
GPU: 1775
Node: 221
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_59_gpu_1776 [label="Expert 16
GPU: 1776
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_59_gpu_1777 [label="Expert 17
GPU: 1777
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_59_gpu_1778 [label="Expert 18
GPU: 1778
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_59_gpu_1779 [label="Expert 19
GPU: 1779
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_59_gpu_1780 [label="Expert 20
GPU: 1780
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_59_gpu_1781 [label="Expert 21
GPU: 1781
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_59_gpu_1782 [label="Expert 22
GPU: 1782
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_59_gpu_1783 [label="Expert 23
GPU: 1783
Node: 222
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_59_gpu_1784 [label="Expert 24
GPU: 1784
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_59_gpu_1785 [label="Expert 25
GPU: 1785
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_59_gpu_1786 [label="Expert 26
GPU: 1786
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_59_gpu_1787 [label="Expert 27
GPU: 1787
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_59_gpu_1788 [label="Expert 28
GPU: 1788
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_59_gpu_1789 [label="Expert 29
GPU: 1789
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_59_gpu_1790 [label="Expert 30
GPU: 1790
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_59_gpu_1791 [label="Expert 31
GPU: 1791
Node: 223
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_59 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_60 {
		color=lightgreen label="MoE Layer 60 (32 Experts)" style="rounded,filled"
		mha_layer_60_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_60_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_60_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_60 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_60_gpu_1792 [label="Expert 0
GPU: 1792
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_60_gpu_1793 [label="Expert 1
GPU: 1793
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_60_gpu_1794 [label="Expert 2
GPU: 1794
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_60_gpu_1795 [label="Expert 3
GPU: 1795
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_60_gpu_1796 [label="Expert 4
GPU: 1796
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_60_gpu_1797 [label="Expert 5
GPU: 1797
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_60_gpu_1798 [label="Expert 6
GPU: 1798
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_60_gpu_1799 [label="Expert 7
GPU: 1799
Node: 224
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_60_gpu_1800 [label="Expert 8
GPU: 1800
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_60_gpu_1801 [label="Expert 9
GPU: 1801
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_60_gpu_1802 [label="Expert 10
GPU: 1802
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_60_gpu_1803 [label="Expert 11
GPU: 1803
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_60_gpu_1804 [label="Expert 12
GPU: 1804
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_60_gpu_1805 [label="Expert 13
GPU: 1805
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_60_gpu_1806 [label="Expert 14
GPU: 1806
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_60_gpu_1807 [label="Expert 15
GPU: 1807
Node: 225
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_60_gpu_1808 [label="Expert 16
GPU: 1808
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_60_gpu_1809 [label="Expert 17
GPU: 1809
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_60_gpu_1810 [label="Expert 18
GPU: 1810
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_60_gpu_1811 [label="Expert 19
GPU: 1811
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_60_gpu_1812 [label="Expert 20
GPU: 1812
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_60_gpu_1813 [label="Expert 21
GPU: 1813
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_60_gpu_1814 [label="Expert 22
GPU: 1814
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_60_gpu_1815 [label="Expert 23
GPU: 1815
Node: 226
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_60_gpu_1816 [label="Expert 24
GPU: 1816
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_60_gpu_1817 [label="Expert 25
GPU: 1817
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_60_gpu_1818 [label="Expert 26
GPU: 1818
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_60_gpu_1819 [label="Expert 27
GPU: 1819
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_60_gpu_1820 [label="Expert 28
GPU: 1820
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_60_gpu_1821 [label="Expert 29
GPU: 1821
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_60_gpu_1822 [label="Expert 30
GPU: 1822
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_60_gpu_1823 [label="Expert 31
GPU: 1823
Node: 227
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_60 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
	subgraph cluster_moe_layer_61 {
		color=lightgreen label="MoE Layer 61 (32 Experts)" style="rounded,filled"
		mha_layer_61_gpu_0 [label="Multi-Head Attention
GPU: 0
Input: [batch_size=4, seq_len=2048, heads=128, d_k=128]
Output: [batch_size=4, seq_len=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		residual_norm_layer_61_gpu_0 [label="Residual + LayerNorm
GPU: 0" fillcolor=orange shape=ellipse style=filled]
		gate_layer_61_gpu_0 [label="Gating
GPU: 0
Input: [bs=4, seq=2048, dim=7168]
Output: [bs=4, seq=2048, top_k=2]" fillcolor=lightyellow shape=parallelogram style=filled]
		route_layer_61 [label="Token Routing
All GPUs
Route tokens to 32 experts" fillcolor=lightyellow shape=parallelogram style="filled,dashed"]
		expert_0_layer_61_gpu_1824 [label="Expert 0
GPU: 1824
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_1_layer_61_gpu_1825 [label="Expert 1
GPU: 1825
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_2_layer_61_gpu_1826 [label="Expert 2
GPU: 1826
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_3_layer_61_gpu_1827 [label="Expert 3
GPU: 1827
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_4_layer_61_gpu_1828 [label="Expert 4
GPU: 1828
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_5_layer_61_gpu_1829 [label="Expert 5
GPU: 1829
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_6_layer_61_gpu_1830 [label="Expert 6
GPU: 1830
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_7_layer_61_gpu_1831 [label="Expert 7
GPU: 1831
Node: 228
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_8_layer_61_gpu_1832 [label="Expert 8
GPU: 1832
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_9_layer_61_gpu_1833 [label="Expert 9
GPU: 1833
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_10_layer_61_gpu_1834 [label="Expert 10
GPU: 1834
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_11_layer_61_gpu_1835 [label="Expert 11
GPU: 1835
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_12_layer_61_gpu_1836 [label="Expert 12
GPU: 1836
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_13_layer_61_gpu_1837 [label="Expert 13
GPU: 1837
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_14_layer_61_gpu_1838 [label="Expert 14
GPU: 1838
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_15_layer_61_gpu_1839 [label="Expert 15
GPU: 1839
Node: 229
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_16_layer_61_gpu_1840 [label="Expert 16
GPU: 1840
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_17_layer_61_gpu_1841 [label="Expert 17
GPU: 1841
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_18_layer_61_gpu_1842 [label="Expert 18
GPU: 1842
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_19_layer_61_gpu_1843 [label="Expert 19
GPU: 1843
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_20_layer_61_gpu_1844 [label="Expert 20
GPU: 1844
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_21_layer_61_gpu_1845 [label="Expert 21
GPU: 1845
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_22_layer_61_gpu_1846 [label="Expert 22
GPU: 1846
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_23_layer_61_gpu_1847 [label="Expert 23
GPU: 1847
Node: 230
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_24_layer_61_gpu_1848 [label="Expert 24
GPU: 1848
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_25_layer_61_gpu_1849 [label="Expert 25
GPU: 1849
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_26_layer_61_gpu_1850 [label="Expert 26
GPU: 1850
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_27_layer_61_gpu_1851 [label="Expert 27
GPU: 1851
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_28_layer_61_gpu_1852 [label="Expert 28
GPU: 1852
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_29_layer_61_gpu_1853 [label="Expert 29
GPU: 1853
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_30_layer_61_gpu_1854 [label="Expert 30
GPU: 1854
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		expert_31_layer_61_gpu_1855 [label="Expert 31
GPU: 1855
Node: 231
Input: [bs=?, seq=?, dim=7168]
Output: [bs=?, seq=?, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
		aggregate_layer_61 [label="Token Aggregation
All GPUs
Gather tokens from 32 experts" fillcolor=orange shape=parallelogram style=filled]
	}
}
