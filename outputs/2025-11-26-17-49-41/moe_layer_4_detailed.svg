<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Layer_4_Detailed Pages: 1 -->
<svg width="2812pt" height="3780pt"
 viewBox="0.00 0.00 2812.50 3780.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3776)">
<title>MoE_Layer_4_Detailed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3776 2808.5,-3776 2808.5,4 -4,4"/>
<!-- input_layer_4 -->
<g id="node1" class="node">
<title>input_layer_4</title>
<ellipse fill="lightgrey" stroke="black" cx="162.63" cy="-1885.5" rx="162.77" ry="37.45"/>
<text text-anchor="middle" x="162.63" y="-1896.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="162.63" y="-1881.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="162.63" y="-1866.8" font-family="Times,serif" font-size="14.00">[bs=4, seq=2048, dim=7168]</text>
</g>
<!-- mha_layer_4 -->
<g id="node2" class="node">
<title>mha_layer_4</title>
<polygon fill="lightblue" stroke="black" points="741.27,-1919.5 433.27,-1919.5 433.27,-1851.5 741.27,-1851.5 741.27,-1919.5"/>
<text text-anchor="middle" x="587.27" y="-1904.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="587.27" y="-1889.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="587.27" y="-1874.3" font-family="Times,serif" font-size="14.00">[bs=4, seq=2048, heads=128, d_k=128]</text>
<text text-anchor="middle" x="587.27" y="-1859.3" font-family="Times,serif" font-size="14.00">→ [bs=4, seq=2048, dim=7168]</text>
</g>
<!-- input_layer_4&#45;&gt;mha_layer_4 -->
<g id="edge1" class="edge">
<title>input_layer_4&#45;&gt;mha_layer_4</title>
<path fill="none" stroke="black" d="M325.29,-1885.5C325.29,-1885.5 423.26,-1885.5 423.26,-1885.5"/>
<polygon fill="black" stroke="black" points="423.26,-1889 433.26,-1885.5 423.26,-1882 423.26,-1889"/>
</g>
<!-- gate_layer_4 -->
<g id="node3" class="node">
<title>gate_layer_4</title>
<polygon fill="lightyellow" stroke="black" points="1239,-1953.5 929.08,-1953.5 849.36,-1817.5 1159.27,-1817.5 1239,-1953.5"/>
<text text-anchor="middle" x="1044.18" y="-1904.3" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1044.18" y="-1889.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="1044.18" y="-1874.3" font-family="Times,serif" font-size="14.00">Compute routing scores</text>
<text text-anchor="middle" x="1044.18" y="-1859.3" font-family="Times,serif" font-size="14.00">Select top&#45;2 experts</text>
</g>
<!-- mha_layer_4&#45;&gt;gate_layer_4 -->
<g id="edge2" class="edge">
<title>mha_layer_4&#45;&gt;gate_layer_4</title>
<path fill="none" stroke="black" d="M741.32,-1885.5C741.32,-1885.5 878.85,-1885.5 878.85,-1885.5"/>
<polygon fill="black" stroke="black" points="878.85,-1889 888.85,-1885.5 878.85,-1882 878.85,-1889"/>
</g>
<!-- distribute_layer_4 -->
<g id="node4" class="node">
<title>distribute_layer_4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="1494.87" cy="-1885.5" rx="147.57" ry="37.45"/>
<text text-anchor="middle" x="1494.87" y="-1896.8" font-family="Times,serif" font-size="14.00">Token Distribution</text>
<text text-anchor="middle" x="1494.87" y="-1881.8" font-family="Times,serif" font-size="14.00">Cross&#45;node communication</text>
<text text-anchor="middle" x="1494.87" y="-1866.8" font-family="Times,serif" font-size="14.00">Route tokens to 32 GPUs</text>
</g>
<!-- gate_layer_4&#45;&gt;distribute_layer_4 -->
<g id="edge3" class="edge">
<title>gate_layer_4&#45;&gt;distribute_layer_4</title>
<path fill="none" stroke="black" d="M1199.28,-1885.5C1199.28,-1885.5 1337.08,-1885.5 1337.08,-1885.5"/>
<polygon fill="black" stroke="black" points="1337.08,-1889 1347.08,-1885.5 1337.08,-1882 1337.08,-1889"/>
</g>
<!-- expert_0_layer_4_gpu_0 -->
<g id="node5" class="node">
<title>expert_0_layer_4_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3772 1750.66,-3772 1750.66,-3689 1967.66,-3689 1967.66,-3772"/>
<text text-anchor="middle" x="1859.16" y="-3756.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1859.16" y="-3741.8" font-family="Times,serif" font-size="14.00">GPU: 0 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3726.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-3711.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-3696.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_0_layer_4_gpu_0 -->
<g id="edge4" class="edge">
<title>distribute_layer_4&#45;&gt;expert_0_layer_4_gpu_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1366.5,-1904.36C1366.5,-2098.77 1366.5,-3730.5 1366.5,-3730.5 1366.5,-3730.5 1740.43,-3730.5 1740.43,-3730.5"/>
<polygon fill="black" stroke="black" points="1740.43,-3734 1750.43,-3730.5 1740.43,-3727 1740.43,-3734"/>
</g>
<!-- expert_1_layer_4_gpu_1 -->
<g id="node6" class="node">
<title>expert_1_layer_4_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3653 1750.66,-3653 1750.66,-3570 1967.66,-3570 1967.66,-3653"/>
<text text-anchor="middle" x="1859.16" y="-3637.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1859.16" y="-3622.8" font-family="Times,serif" font-size="14.00">GPU: 1 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3607.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-3592.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-3577.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_1_layer_4_gpu_1 -->
<g id="edge5" class="edge">
<title>distribute_layer_4&#45;&gt;expert_1_layer_4_gpu_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1384.5,-1910.56C1384.5,-2122.82 1384.5,-3611.5 1384.5,-3611.5 1384.5,-3611.5 1740.56,-3611.5 1740.56,-3611.5"/>
<polygon fill="black" stroke="black" points="1740.56,-3615 1750.56,-3611.5 1740.56,-3608 1740.56,-3615"/>
</g>
<!-- expert_2_layer_4_gpu_2 -->
<g id="node7" class="node">
<title>expert_2_layer_4_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3534 1750.66,-3534 1750.66,-3451 1967.66,-3451 1967.66,-3534"/>
<text text-anchor="middle" x="1859.16" y="-3518.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1859.16" y="-3503.8" font-family="Times,serif" font-size="14.00">GPU: 2 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3488.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-3473.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-3458.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_2_layer_4_gpu_2 -->
<g id="edge6" class="edge">
<title>distribute_layer_4&#45;&gt;expert_2_layer_4_gpu_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1403.5,-1915.11C1403.5,-2134.01 1403.5,-3492.5 1403.5,-3492.5 1403.5,-3492.5 1740.6,-3492.5 1740.6,-3492.5"/>
<polygon fill="black" stroke="black" points="1740.6,-3496 1750.6,-3492.5 1740.6,-3489 1740.6,-3496"/>
</g>
<!-- expert_3_layer_4_gpu_3 -->
<g id="node8" class="node">
<title>expert_3_layer_4_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3415 1750.66,-3415 1750.66,-3332 1967.66,-3332 1967.66,-3415"/>
<text text-anchor="middle" x="1859.16" y="-3399.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1859.16" y="-3384.8" font-family="Times,serif" font-size="14.00">GPU: 3 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3369.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-3354.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-3339.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_3_layer_4_gpu_3 -->
<g id="edge7" class="edge">
<title>distribute_layer_4&#45;&gt;expert_3_layer_4_gpu_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1421.5,-1918.31C1421.5,-2136.89 1421.5,-3373.5 1421.5,-3373.5 1421.5,-3373.5 1740.41,-3373.5 1740.41,-3373.5"/>
<polygon fill="black" stroke="black" points="1740.41,-3377 1750.41,-3373.5 1740.41,-3370 1740.41,-3377"/>
</g>
<!-- expert_4_layer_4_gpu_4 -->
<g id="node9" class="node">
<title>expert_4_layer_4_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3296 1750.66,-3296 1750.66,-3213 1967.66,-3213 1967.66,-3296"/>
<text text-anchor="middle" x="1859.16" y="-3280.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1859.16" y="-3265.8" font-family="Times,serif" font-size="14.00">GPU: 4 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3250.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-3235.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-3220.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_4_layer_4_gpu_4 -->
<g id="edge8" class="edge">
<title>distribute_layer_4&#45;&gt;expert_4_layer_4_gpu_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1439.5,-1920.37C1439.5,-2133.79 1439.5,-3254.5 1439.5,-3254.5 1439.5,-3254.5 1740.54,-3254.5 1740.54,-3254.5"/>
<polygon fill="black" stroke="black" points="1740.54,-3258 1750.54,-3254.5 1740.54,-3251 1740.54,-3258"/>
</g>
<!-- expert_5_layer_4_gpu_5 -->
<g id="node10" class="node">
<title>expert_5_layer_4_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3177 1750.66,-3177 1750.66,-3094 1967.66,-3094 1967.66,-3177"/>
<text text-anchor="middle" x="1859.16" y="-3161.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1859.16" y="-3146.8" font-family="Times,serif" font-size="14.00">GPU: 5 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3131.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-3116.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-3101.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_5_layer_4_gpu_5 -->
<g id="edge9" class="edge">
<title>distribute_layer_4&#45;&gt;expert_5_layer_4_gpu_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1458.5,-1921.9C1458.5,-2127.61 1458.5,-3135.5 1458.5,-3135.5 1458.5,-3135.5 1740.47,-3135.5 1740.47,-3135.5"/>
<polygon fill="black" stroke="black" points="1740.47,-3139 1750.47,-3135.5 1740.47,-3132 1740.47,-3139"/>
</g>
<!-- expert_6_layer_4_gpu_6 -->
<g id="node11" class="node">
<title>expert_6_layer_4_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-3058 1750.66,-3058 1750.66,-2975 1967.66,-2975 1967.66,-3058"/>
<text text-anchor="middle" x="1859.16" y="-3042.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1859.16" y="-3027.8" font-family="Times,serif" font-size="14.00">GPU: 6 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-3012.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2997.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2982.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_6_layer_4_gpu_6 -->
<g id="edge10" class="edge">
<title>distribute_layer_4&#45;&gt;expert_6_layer_4_gpu_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1476.5,-1922.81C1476.5,-2118.39 1476.5,-3016.5 1476.5,-3016.5 1476.5,-3016.5 1740.53,-3016.5 1740.53,-3016.5"/>
<polygon fill="black" stroke="black" points="1740.53,-3020 1750.53,-3016.5 1740.53,-3013 1740.53,-3020"/>
</g>
<!-- expert_7_layer_4_gpu_7 -->
<g id="node12" class="node">
<title>expert_7_layer_4_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2939 1750.66,-2939 1750.66,-2856 1967.66,-2856 1967.66,-2939"/>
<text text-anchor="middle" x="1859.16" y="-2923.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1859.16" y="-2908.8" font-family="Times,serif" font-size="14.00">GPU: 7 (Node 0)</text>
<text text-anchor="middle" x="1859.16" y="-2893.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2878.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2863.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_7_layer_4_gpu_7 -->
<g id="edge11" class="edge">
<title>distribute_layer_4&#45;&gt;expert_7_layer_4_gpu_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1495.5,-1923.02C1495.5,-2106.17 1495.5,-2897.5 1495.5,-2897.5 1495.5,-2897.5 1740.54,-2897.5 1740.54,-2897.5"/>
<polygon fill="black" stroke="black" points="1740.54,-2901 1750.54,-2897.5 1740.54,-2894 1740.54,-2901"/>
</g>
<!-- expert_8_layer_4_gpu_8 -->
<g id="node13" class="node">
<title>expert_8_layer_4_gpu_8</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2820 1750.66,-2820 1750.66,-2737 1967.66,-2737 1967.66,-2820"/>
<text text-anchor="middle" x="1859.16" y="-2804.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1859.16" y="-2789.8" font-family="Times,serif" font-size="14.00">GPU: 8 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2774.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2759.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2744.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_8_layer_4_gpu_8 -->
<g id="edge12" class="edge">
<title>distribute_layer_4&#45;&gt;expert_8_layer_4_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1513.5,-1922.73C1513.5,-2091.74 1513.5,-2778.5 1513.5,-2778.5 1513.5,-2778.5 1740.26,-2778.5 1740.26,-2778.5"/>
<polygon fill="black" stroke="black" points="1740.26,-2782 1750.26,-2778.5 1740.26,-2775 1740.26,-2782"/>
</g>
<!-- expert_9_layer_4_gpu_9 -->
<g id="node14" class="node">
<title>expert_9_layer_4_gpu_9</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2701 1750.66,-2701 1750.66,-2618 1967.66,-2618 1967.66,-2701"/>
<text text-anchor="middle" x="1859.16" y="-2685.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="1859.16" y="-2670.8" font-family="Times,serif" font-size="14.00">GPU: 9 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2655.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2640.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2625.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_9_layer_4_gpu_9 -->
<g id="edge13" class="edge">
<title>distribute_layer_4&#45;&gt;expert_9_layer_4_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1532.5,-1921.79C1532.5,-2074.82 1532.5,-2659.5 1532.5,-2659.5 1532.5,-2659.5 1740.39,-2659.5 1740.39,-2659.5"/>
<polygon fill="black" stroke="black" points="1740.39,-2663 1750.39,-2659.5 1740.39,-2656 1740.39,-2663"/>
</g>
<!-- expert_10_layer_4_gpu_10 -->
<g id="node15" class="node">
<title>expert_10_layer_4_gpu_10</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2582 1750.66,-2582 1750.66,-2499 1967.66,-2499 1967.66,-2582"/>
<text text-anchor="middle" x="1859.16" y="-2566.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="1859.16" y="-2551.8" font-family="Times,serif" font-size="14.00">GPU: 10 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2536.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2521.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2506.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_10_layer_4_gpu_10 -->
<g id="edge14" class="edge">
<title>distribute_layer_4&#45;&gt;expert_10_layer_4_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1550.5,-1920.25C1550.5,-2055.67 1550.5,-2540.5 1550.5,-2540.5 1550.5,-2540.5 1740.34,-2540.5 1740.34,-2540.5"/>
<polygon fill="black" stroke="black" points="1740.34,-2544 1750.34,-2540.5 1740.34,-2537 1740.34,-2544"/>
</g>
<!-- expert_11_layer_4_gpu_11 -->
<g id="node16" class="node">
<title>expert_11_layer_4_gpu_11</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2463 1750.66,-2463 1750.66,-2380 1967.66,-2380 1967.66,-2463"/>
<text text-anchor="middle" x="1859.16" y="-2447.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="1859.16" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU: 11 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2417.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2402.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2387.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_11_layer_4_gpu_11 -->
<g id="edge15" class="edge">
<title>distribute_layer_4&#45;&gt;expert_11_layer_4_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1569.5,-1918.22C1569.5,-2034.6 1569.5,-2421.5 1569.5,-2421.5 1569.5,-2421.5 1740.48,-2421.5 1740.48,-2421.5"/>
<polygon fill="black" stroke="black" points="1740.48,-2425 1750.48,-2421.5 1740.48,-2418 1740.48,-2425"/>
</g>
<!-- expert_12_layer_4_gpu_12 -->
<g id="node17" class="node">
<title>expert_12_layer_4_gpu_12</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2344 1750.66,-2344 1750.66,-2261 1967.66,-2261 1967.66,-2344"/>
<text text-anchor="middle" x="1859.16" y="-2328.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="1859.16" y="-2313.8" font-family="Times,serif" font-size="14.00">GPU: 12 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2298.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2283.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2268.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_12_layer_4_gpu_12 -->
<g id="edge16" class="edge">
<title>distribute_layer_4&#45;&gt;expert_12_layer_4_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1587.5,-1914.82C1587.5,-2009.74 1587.5,-2302.5 1587.5,-2302.5 1587.5,-2302.5 1740.62,-2302.5 1740.62,-2302.5"/>
<polygon fill="black" stroke="black" points="1740.62,-2306 1750.62,-2302.5 1740.62,-2299 1740.62,-2306"/>
</g>
<!-- expert_13_layer_4_gpu_13 -->
<g id="node18" class="node">
<title>expert_13_layer_4_gpu_13</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2225 1750.66,-2225 1750.66,-2142 1967.66,-2142 1967.66,-2225"/>
<text text-anchor="middle" x="1859.16" y="-2209.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="1859.16" y="-2194.8" font-family="Times,serif" font-size="14.00">GPU: 13 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2179.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2164.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2149.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_13_layer_4_gpu_13 -->
<g id="edge17" class="edge">
<title>distribute_layer_4&#45;&gt;expert_13_layer_4_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1606.5,-1910.14C1606.5,-1981.54 1606.5,-2183.5 1606.5,-2183.5 1606.5,-2183.5 1740.54,-2183.5 1740.54,-2183.5"/>
<polygon fill="black" stroke="black" points="1740.54,-2187 1750.54,-2183.5 1740.54,-2180 1740.54,-2187"/>
</g>
<!-- expert_14_layer_4_gpu_14 -->
<g id="node19" class="node">
<title>expert_14_layer_4_gpu_14</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-2106 1750.66,-2106 1750.66,-2023 1967.66,-2023 1967.66,-2106"/>
<text text-anchor="middle" x="1859.16" y="-2090.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="1859.16" y="-2075.8" font-family="Times,serif" font-size="14.00">GPU: 14 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-2060.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-2045.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-2030.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_14_layer_4_gpu_14 -->
<g id="edge18" class="edge">
<title>distribute_layer_4&#45;&gt;expert_14_layer_4_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1624.5,-1903.65C1624.5,-1949.16 1624.5,-2064.5 1624.5,-2064.5 1624.5,-2064.5 1740.42,-2064.5 1740.42,-2064.5"/>
<polygon fill="black" stroke="black" points="1740.42,-2068 1750.42,-2064.5 1740.42,-2061 1740.42,-2068"/>
</g>
<!-- expert_15_layer_4_gpu_15 -->
<g id="node20" class="node">
<title>expert_15_layer_4_gpu_15</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1987 1750.66,-1987 1750.66,-1904 1967.66,-1904 1967.66,-1987"/>
<text text-anchor="middle" x="1859.16" y="-1971.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="1859.16" y="-1956.8" font-family="Times,serif" font-size="14.00">GPU: 15 (Node 1)</text>
<text text-anchor="middle" x="1859.16" y="-1941.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1926.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1911.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_15_layer_4_gpu_15 -->
<g id="edge19" class="edge">
<title>distribute_layer_4&#45;&gt;expert_15_layer_4_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1593.45,-1913.49C1593.45,-1913.49 1740.57,-1913.49 1740.57,-1913.49"/>
<polygon fill="black" stroke="black" points="1740.57,-1916.99 1750.57,-1913.49 1740.57,-1909.99 1740.57,-1916.99"/>
</g>
<!-- expert_16_layer_4_gpu_16 -->
<g id="node21" class="node">
<title>expert_16_layer_4_gpu_16</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1868 1750.66,-1868 1750.66,-1785 1967.66,-1785 1967.66,-1868"/>
<text text-anchor="middle" x="1859.16" y="-1852.8" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="1859.16" y="-1837.8" font-family="Times,serif" font-size="14.00">GPU: 16 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1822.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1807.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1792.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_16_layer_4_gpu_16 -->
<g id="edge20" class="edge">
<title>distribute_layer_4&#45;&gt;expert_16_layer_4_gpu_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1595.38,-1858.01C1595.38,-1858.01 1740.36,-1858.01 1740.36,-1858.01"/>
<polygon fill="black" stroke="black" points="1740.36,-1861.51 1750.36,-1858.01 1740.36,-1854.51 1740.36,-1861.51"/>
</g>
<!-- expert_17_layer_4_gpu_17 -->
<g id="node22" class="node">
<title>expert_17_layer_4_gpu_17</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1749 1750.66,-1749 1750.66,-1666 1967.66,-1666 1967.66,-1749"/>
<text text-anchor="middle" x="1859.16" y="-1733.8" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="1859.16" y="-1718.8" font-family="Times,serif" font-size="14.00">GPU: 17 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1703.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1688.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1673.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_17_layer_4_gpu_17 -->
<g id="edge21" class="edge">
<title>distribute_layer_4&#45;&gt;expert_17_layer_4_gpu_17</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1624.5,-1867.45C1624.5,-1822.2 1624.5,-1707.5 1624.5,-1707.5 1624.5,-1707.5 1740.42,-1707.5 1740.42,-1707.5"/>
<polygon fill="black" stroke="black" points="1740.42,-1711 1750.42,-1707.5 1740.42,-1704 1740.42,-1711"/>
</g>
<!-- expert_18_layer_4_gpu_18 -->
<g id="node23" class="node">
<title>expert_18_layer_4_gpu_18</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1630 1750.66,-1630 1750.66,-1547 1967.66,-1547 1967.66,-1630"/>
<text text-anchor="middle" x="1859.16" y="-1614.8" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="1859.16" y="-1599.8" font-family="Times,serif" font-size="14.00">GPU: 18 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1584.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1569.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1554.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_18_layer_4_gpu_18 -->
<g id="edge22" class="edge">
<title>distribute_layer_4&#45;&gt;expert_18_layer_4_gpu_18</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1606.5,-1860.69C1606.5,-1789.31 1606.5,-1588.5 1606.5,-1588.5 1606.5,-1588.5 1740.54,-1588.5 1740.54,-1588.5"/>
<polygon fill="black" stroke="black" points="1740.54,-1592 1750.54,-1588.5 1740.54,-1585 1740.54,-1592"/>
</g>
<!-- expert_19_layer_4_gpu_19 -->
<g id="node24" class="node">
<title>expert_19_layer_4_gpu_19</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1511 1750.66,-1511 1750.66,-1428 1967.66,-1428 1967.66,-1511"/>
<text text-anchor="middle" x="1859.16" y="-1495.8" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="1859.16" y="-1480.8" font-family="Times,serif" font-size="14.00">GPU: 19 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1465.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1450.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1435.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_19_layer_4_gpu_19 -->
<g id="edge23" class="edge">
<title>distribute_layer_4&#45;&gt;expert_19_layer_4_gpu_19</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1587.5,-1856.25C1587.5,-1761.56 1587.5,-1469.5 1587.5,-1469.5 1587.5,-1469.5 1740.62,-1469.5 1740.62,-1469.5"/>
<polygon fill="black" stroke="black" points="1740.62,-1473 1750.62,-1469.5 1740.62,-1466 1740.62,-1473"/>
</g>
<!-- expert_20_layer_4_gpu_20 -->
<g id="node25" class="node">
<title>expert_20_layer_4_gpu_20</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1392 1750.66,-1392 1750.66,-1309 1967.66,-1309 1967.66,-1392"/>
<text text-anchor="middle" x="1859.16" y="-1376.8" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="1859.16" y="-1361.8" font-family="Times,serif" font-size="14.00">GPU: 20 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1346.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1331.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1316.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_20_layer_4_gpu_20 -->
<g id="edge24" class="edge">
<title>distribute_layer_4&#45;&gt;expert_20_layer_4_gpu_20</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1569.5,-1852.84C1569.5,-1736.68 1569.5,-1350.5 1569.5,-1350.5 1569.5,-1350.5 1740.48,-1350.5 1740.48,-1350.5"/>
<polygon fill="black" stroke="black" points="1740.48,-1354 1750.48,-1350.5 1740.48,-1347 1740.48,-1354"/>
</g>
<!-- expert_21_layer_4_gpu_21 -->
<g id="node26" class="node">
<title>expert_21_layer_4_gpu_21</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1273 1750.66,-1273 1750.66,-1190 1967.66,-1190 1967.66,-1273"/>
<text text-anchor="middle" x="1859.16" y="-1257.8" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="1859.16" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: 21 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1227.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1212.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1197.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_21_layer_4_gpu_21 -->
<g id="edge25" class="edge">
<title>distribute_layer_4&#45;&gt;expert_21_layer_4_gpu_21</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1550.5,-1850.34C1550.5,-1714.5 1550.5,-1231.5 1550.5,-1231.5 1550.5,-1231.5 1740.34,-1231.5 1740.34,-1231.5"/>
<polygon fill="black" stroke="black" points="1740.34,-1235 1750.34,-1231.5 1740.34,-1228 1740.34,-1235"/>
</g>
<!-- expert_22_layer_4_gpu_22 -->
<g id="node27" class="node">
<title>expert_22_layer_4_gpu_22</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1154 1750.66,-1154 1750.66,-1071 1967.66,-1071 1967.66,-1154"/>
<text text-anchor="middle" x="1859.16" y="-1138.8" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="1859.16" y="-1123.8" font-family="Times,serif" font-size="14.00">GPU: 22 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-1108.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-1093.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-1078.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_22_layer_4_gpu_22 -->
<g id="edge26" class="edge">
<title>distribute_layer_4&#45;&gt;expert_22_layer_4_gpu_22</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1532.5,-1849.25C1532.5,-1696.43 1532.5,-1112.5 1532.5,-1112.5 1532.5,-1112.5 1740.39,-1112.5 1740.39,-1112.5"/>
<polygon fill="black" stroke="black" points="1740.39,-1116 1750.39,-1112.5 1740.39,-1109 1740.39,-1116"/>
</g>
<!-- expert_23_layer_4_gpu_23 -->
<g id="node28" class="node">
<title>expert_23_layer_4_gpu_23</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-1035 1750.66,-1035 1750.66,-952 1967.66,-952 1967.66,-1035"/>
<text text-anchor="middle" x="1859.16" y="-1019.8" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="1859.16" y="-1004.8" font-family="Times,serif" font-size="14.00">GPU: 23 (Node 2)</text>
<text text-anchor="middle" x="1859.16" y="-989.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-974.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-959.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_23_layer_4_gpu_23 -->
<g id="edge27" class="edge">
<title>distribute_layer_4&#45;&gt;expert_23_layer_4_gpu_23</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1513.5,-1848.31C1513.5,-1679.49 1513.5,-993.5 1513.5,-993.5 1513.5,-993.5 1740.26,-993.5 1740.26,-993.5"/>
<polygon fill="black" stroke="black" points="1740.26,-997 1750.26,-993.5 1740.26,-990 1740.26,-997"/>
</g>
<!-- expert_24_layer_4_gpu_24 -->
<g id="node29" class="node">
<title>expert_24_layer_4_gpu_24</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-916 1750.66,-916 1750.66,-833 1967.66,-833 1967.66,-916"/>
<text text-anchor="middle" x="1859.16" y="-900.8" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="1859.16" y="-885.8" font-family="Times,serif" font-size="14.00">GPU: 24 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-870.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-855.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-840.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_24_layer_4_gpu_24 -->
<g id="edge28" class="edge">
<title>distribute_layer_4&#45;&gt;expert_24_layer_4_gpu_24</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1495.5,-1848.02C1495.5,-1665.05 1495.5,-874.5 1495.5,-874.5 1495.5,-874.5 1740.54,-874.5 1740.54,-874.5"/>
<polygon fill="black" stroke="black" points="1740.54,-878 1750.54,-874.5 1740.54,-871 1740.54,-878"/>
</g>
<!-- expert_25_layer_4_gpu_25 -->
<g id="node30" class="node">
<title>expert_25_layer_4_gpu_25</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-797 1750.66,-797 1750.66,-714 1967.66,-714 1967.66,-797"/>
<text text-anchor="middle" x="1859.16" y="-781.8" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="1859.16" y="-766.8" font-family="Times,serif" font-size="14.00">GPU: 25 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-751.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-736.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-721.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_25_layer_4_gpu_25 -->
<g id="edge29" class="edge">
<title>distribute_layer_4&#45;&gt;expert_25_layer_4_gpu_25</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1476.5,-1848.22C1476.5,-1652.81 1476.5,-755.5 1476.5,-755.5 1476.5,-755.5 1740.53,-755.5 1740.53,-755.5"/>
<polygon fill="black" stroke="black" points="1740.53,-759 1750.53,-755.5 1740.53,-752 1740.53,-759"/>
</g>
<!-- expert_26_layer_4_gpu_26 -->
<g id="node31" class="node">
<title>expert_26_layer_4_gpu_26</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-678 1750.66,-678 1750.66,-595 1967.66,-595 1967.66,-678"/>
<text text-anchor="middle" x="1859.16" y="-662.8" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="1859.16" y="-647.8" font-family="Times,serif" font-size="14.00">GPU: 26 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-632.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-617.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-602.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_26_layer_4_gpu_26 -->
<g id="edge30" class="edge">
<title>distribute_layer_4&#45;&gt;expert_26_layer_4_gpu_26</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1458.5,-1849.13C1458.5,-1643.58 1458.5,-636.5 1458.5,-636.5 1458.5,-636.5 1740.47,-636.5 1740.47,-636.5"/>
<polygon fill="black" stroke="black" points="1740.47,-640 1750.47,-636.5 1740.47,-633 1740.47,-640"/>
</g>
<!-- expert_27_layer_4_gpu_27 -->
<g id="node32" class="node">
<title>expert_27_layer_4_gpu_27</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-559 1750.66,-559 1750.66,-476 1967.66,-476 1967.66,-559"/>
<text text-anchor="middle" x="1859.16" y="-543.8" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="1859.16" y="-528.8" font-family="Times,serif" font-size="14.00">GPU: 27 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-513.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-498.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-483.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_27_layer_4_gpu_27 -->
<g id="edge31" class="edge">
<title>distribute_layer_4&#45;&gt;expert_27_layer_4_gpu_27</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1439.5,-1850.66C1439.5,-1637.39 1439.5,-517.5 1439.5,-517.5 1439.5,-517.5 1740.54,-517.5 1740.54,-517.5"/>
<polygon fill="black" stroke="black" points="1740.54,-521 1750.54,-517.5 1740.54,-514 1740.54,-521"/>
</g>
<!-- expert_28_layer_4_gpu_28 -->
<g id="node33" class="node">
<title>expert_28_layer_4_gpu_28</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-440 1750.66,-440 1750.66,-357 1967.66,-357 1967.66,-440"/>
<text text-anchor="middle" x="1859.16" y="-424.8" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="1859.16" y="-409.8" font-family="Times,serif" font-size="14.00">GPU: 28 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-394.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-379.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-364.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_28_layer_4_gpu_28 -->
<g id="edge32" class="edge">
<title>distribute_layer_4&#45;&gt;expert_28_layer_4_gpu_28</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1421.5,-1852.71C1421.5,-1634.28 1421.5,-398.5 1421.5,-398.5 1421.5,-398.5 1740.41,-398.5 1740.41,-398.5"/>
<polygon fill="black" stroke="black" points="1740.41,-402 1750.41,-398.5 1740.41,-395 1740.41,-402"/>
</g>
<!-- expert_29_layer_4_gpu_29 -->
<g id="node34" class="node">
<title>expert_29_layer_4_gpu_29</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-321 1750.66,-321 1750.66,-238 1967.66,-238 1967.66,-321"/>
<text text-anchor="middle" x="1859.16" y="-305.8" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="1859.16" y="-290.8" font-family="Times,serif" font-size="14.00">GPU: 29 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-275.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-260.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-245.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_29_layer_4_gpu_29 -->
<g id="edge33" class="edge">
<title>distribute_layer_4&#45;&gt;expert_29_layer_4_gpu_29</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1403.5,-1855.91C1403.5,-1637.15 1403.5,-279.5 1403.5,-279.5 1403.5,-279.5 1740.6,-279.5 1740.6,-279.5"/>
<polygon fill="black" stroke="black" points="1740.6,-283 1750.6,-279.5 1740.6,-276 1740.6,-283"/>
</g>
<!-- expert_30_layer_4_gpu_30 -->
<g id="node35" class="node">
<title>expert_30_layer_4_gpu_30</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-202 1750.66,-202 1750.66,-119 1967.66,-119 1967.66,-202"/>
<text text-anchor="middle" x="1859.16" y="-186.8" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="1859.16" y="-171.8" font-family="Times,serif" font-size="14.00">GPU: 30 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-156.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-141.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-126.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_30_layer_4_gpu_30 -->
<g id="edge34" class="edge">
<title>distribute_layer_4&#45;&gt;expert_30_layer_4_gpu_30</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1384.5,-1860.45C1384.5,-1648.32 1384.5,-160.5 1384.5,-160.5 1384.5,-160.5 1740.56,-160.5 1740.56,-160.5"/>
<polygon fill="black" stroke="black" points="1740.56,-164 1750.56,-160.5 1740.56,-157 1740.56,-164"/>
</g>
<!-- expert_31_layer_4_gpu_31 -->
<g id="node36" class="node">
<title>expert_31_layer_4_gpu_31</title>
<polygon fill="lightblue" stroke="black" points="1967.66,-83 1750.66,-83 1750.66,0 1967.66,0 1967.66,-83"/>
<text text-anchor="middle" x="1859.16" y="-67.8" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="1859.16" y="-52.8" font-family="Times,serif" font-size="14.00">GPU: 31 (Node 3)</text>
<text text-anchor="middle" x="1859.16" y="-37.8" font-family="Times,serif" font-size="14.00">MLP Processing</text>
<text text-anchor="middle" x="1859.16" y="-22.8" font-family="Times,serif" font-size="14.00">[bs=?, seq=?, dim=7168]</text>
<text text-anchor="middle" x="1859.16" y="-7.8" font-family="Times,serif" font-size="14.00">→ [bs=?, seq=?, dim=7168]</text>
</g>
<!-- distribute_layer_4&#45;&gt;expert_31_layer_4_gpu_31 -->
<g id="edge35" class="edge">
<title>distribute_layer_4&#45;&gt;expert_31_layer_4_gpu_31</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1366.5,-1866.65C1366.5,-1672.35 1366.5,-41.5 1366.5,-41.5 1366.5,-41.5 1740.43,-41.5 1740.43,-41.5"/>
<polygon fill="black" stroke="black" points="1740.43,-45 1750.43,-41.5 1740.43,-38 1740.43,-45"/>
</g>
<!-- aggregate_layer_4 -->
<g id="node37" class="node">
<title>aggregate_layer_4</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="2223.44" cy="-1885.5" rx="147.57" ry="37.45"/>
<text text-anchor="middle" x="2223.44" y="-1896.8" font-family="Times,serif" font-size="14.00">Token Aggregation</text>
<text text-anchor="middle" x="2223.44" y="-1881.8" font-family="Times,serif" font-size="14.00">Cross&#45;node communication</text>
<text text-anchor="middle" x="2223.44" y="-1866.8" font-family="Times,serif" font-size="14.00">Gather from 32 GPUs</text>
</g>
<!-- expert_0_layer_4_gpu_0&#45;&gt;aggregate_layer_4 -->
<g id="edge36" class="edge">
<title>expert_0_layer_4_gpu_0&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.95,-3730.5C2113.5,-3730.5 2353.5,-3730.5 2353.5,-3730.5 2353.5,-3730.5 2353.5,-1913.46 2353.5,-1913.46"/>
<polygon fill="black" stroke="black" points="2357,-1913.46 2353.5,-1903.46 2350,-1913.46 2357,-1913.46"/>
</g>
<!-- expert_1_layer_4_gpu_1&#45;&gt;aggregate_layer_4 -->
<g id="edge37" class="edge">
<title>expert_1_layer_4_gpu_1&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.91,-3611.5C2108.23,-3611.5 2334.5,-3611.5 2334.5,-3611.5 2334.5,-3611.5 2334.5,-1920.23 2334.5,-1920.23"/>
<polygon fill="black" stroke="black" points="2338,-1920.23 2334.5,-1910.23 2331,-1920.23 2338,-1920.23"/>
</g>
<!-- expert_2_layer_4_gpu_2&#45;&gt;aggregate_layer_4 -->
<g id="edge38" class="edge">
<title>expert_2_layer_4_gpu_2&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.83,-3492.5C2103.09,-3492.5 2316.5,-3492.5 2316.5,-3492.5 2316.5,-3492.5 2316.5,-1924.76 2316.5,-1924.76"/>
<polygon fill="black" stroke="black" points="2320,-1924.76 2316.5,-1914.76 2313,-1924.76 2320,-1924.76"/>
</g>
<!-- expert_3_layer_4_gpu_3&#45;&gt;aggregate_layer_4 -->
<g id="edge39" class="edge">
<title>expert_3_layer_4_gpu_3&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.79,-3373.5C2097.61,-3373.5 2297.5,-3373.5 2297.5,-3373.5 2297.5,-3373.5 2297.5,-1927.96 2297.5,-1927.96"/>
<polygon fill="black" stroke="black" points="2301,-1927.96 2297.5,-1917.96 2294,-1927.96 2301,-1927.96"/>
</g>
<!-- expert_4_layer_4_gpu_4&#45;&gt;aggregate_layer_4 -->
<g id="edge40" class="edge">
<title>expert_4_layer_4_gpu_4&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.68,-3254.5C2092.22,-3254.5 2279.5,-3254.5 2279.5,-3254.5 2279.5,-3254.5 2279.5,-1930.37 2279.5,-1930.37"/>
<polygon fill="black" stroke="black" points="2283,-1930.37 2279.5,-1920.37 2276,-1930.37 2283,-1930.37"/>
</g>
<!-- expert_5_layer_4_gpu_5&#45;&gt;aggregate_layer_4 -->
<g id="edge41" class="edge">
<title>expert_5_layer_4_gpu_5&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.77,-3135.5C2086.63,-3135.5 2260.5,-3135.5 2260.5,-3135.5 2260.5,-3135.5 2260.5,-1931.9 2260.5,-1931.9"/>
<polygon fill="black" stroke="black" points="2264,-1931.9 2260.5,-1921.9 2257,-1931.9 2264,-1931.9"/>
</g>
<!-- expert_6_layer_4_gpu_6&#45;&gt;aggregate_layer_4 -->
<g id="edge42" class="edge">
<title>expert_6_layer_4_gpu_6&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.73,-3016.5C2081.07,-3016.5 2242.5,-3016.5 2242.5,-3016.5 2242.5,-3016.5 2242.5,-1932.81 2242.5,-1932.81"/>
<polygon fill="black" stroke="black" points="2246,-1932.81 2242.5,-1922.81 2239,-1932.81 2246,-1932.81"/>
</g>
<!-- expert_7_layer_4_gpu_7&#45;&gt;aggregate_layer_4 -->
<g id="edge43" class="edge">
<title>expert_7_layer_4_gpu_7&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.98,-2897.5C2075.34,-2897.5 2223.5,-2897.5 2223.5,-2897.5 2223.5,-2897.5 2223.5,-1933.02 2223.5,-1933.02"/>
<polygon fill="black" stroke="black" points="2227,-1933.02 2223.5,-1923.02 2220,-1933.02 2227,-1933.02"/>
</g>
<!-- expert_8_layer_4_gpu_8&#45;&gt;aggregate_layer_4 -->
<g id="edge44" class="edge">
<title>expert_8_layer_4_gpu_8&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.79,-2778.5C2069.36,-2778.5 2205.5,-2778.5 2205.5,-2778.5 2205.5,-2778.5 2205.5,-1932.73 2205.5,-1932.73"/>
<polygon fill="black" stroke="black" points="2209,-1932.73 2205.5,-1922.73 2202,-1932.73 2209,-1932.73"/>
</g>
<!-- expert_9_layer_4_gpu_9&#45;&gt;aggregate_layer_4 -->
<g id="edge45" class="edge">
<title>expert_9_layer_4_gpu_9&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.7,-2659.5C2062.99,-2659.5 2186.5,-2659.5 2186.5,-2659.5 2186.5,-2659.5 2186.5,-1931.79 2186.5,-1931.79"/>
<polygon fill="black" stroke="black" points="2190,-1931.79 2186.5,-1921.79 2183,-1931.79 2190,-1931.79"/>
</g>
<!-- expert_10_layer_4_gpu_10&#45;&gt;aggregate_layer_4 -->
<g id="edge46" class="edge">
<title>expert_10_layer_4_gpu_10&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.79,-2540.5C2056.92,-2540.5 2168.5,-2540.5 2168.5,-2540.5 2168.5,-2540.5 2168.5,-1930.72 2168.5,-1930.72"/>
<polygon fill="black" stroke="black" points="2172,-1930.72 2168.5,-1920.72 2165,-1930.72 2172,-1930.72"/>
</g>
<!-- expert_11_layer_4_gpu_11&#45;&gt;aggregate_layer_4 -->
<g id="edge47" class="edge">
<title>expert_11_layer_4_gpu_11&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1968.06,-2421.5C2050.81,-2421.5 2150.5,-2421.5 2150.5,-2421.5 2150.5,-2421.5 2150.5,-1928.22 2150.5,-1928.22"/>
<polygon fill="black" stroke="black" points="2154,-1928.22 2150.5,-1918.22 2147,-1928.22 2154,-1928.22"/>
</g>
<!-- expert_12_layer_4_gpu_12&#45;&gt;aggregate_layer_4 -->
<g id="edge48" class="edge">
<title>expert_12_layer_4_gpu_12&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.97,-2302.5C2043.83,-2302.5 2131.5,-2302.5 2131.5,-2302.5 2131.5,-2302.5 2131.5,-1925.16 2131.5,-1925.16"/>
<polygon fill="black" stroke="black" points="2135,-1925.16 2131.5,-1915.16 2128,-1925.16 2135,-1925.16"/>
</g>
<!-- expert_13_layer_4_gpu_13&#45;&gt;aggregate_layer_4 -->
<g id="edge49" class="edge">
<title>expert_13_layer_4_gpu_13&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.76,-2183.5C2036.89,-2183.5 2113.5,-2183.5 2113.5,-2183.5 2113.5,-2183.5 2113.5,-1920.65 2113.5,-1920.65"/>
<polygon fill="black" stroke="black" points="2117,-1920.65 2113.5,-1910.65 2110,-1920.65 2117,-1920.65"/>
</g>
<!-- expert_14_layer_4_gpu_14&#45;&gt;aggregate_layer_4 -->
<g id="edge50" class="edge">
<title>expert_14_layer_4_gpu_14&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.87,-2064.5C2029.54,-2064.5 2094.5,-2064.5 2094.5,-2064.5 2094.5,-2064.5 2094.5,-1913.98 2094.5,-1913.98"/>
<polygon fill="black" stroke="black" points="2098,-1913.98 2094.5,-1903.98 2091,-1913.98 2098,-1913.98"/>
</g>
<!-- expert_15_layer_4_gpu_15&#45;&gt;aggregate_layer_4 -->
<g id="edge51" class="edge">
<title>expert_15_layer_4_gpu_15&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.96,-1913.49C1967.96,-1913.49 2115.12,-1913.49 2115.12,-1913.49"/>
<polygon fill="black" stroke="black" points="2115.12,-1916.99 2125.12,-1913.49 2115.12,-1909.99 2115.12,-1916.99"/>
</g>
<!-- expert_16_layer_4_gpu_16&#45;&gt;aggregate_layer_4 -->
<g id="edge52" class="edge">
<title>expert_16_layer_4_gpu_16&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.96,-1858.01C1967.96,-1858.01 2112.98,-1858.01 2112.98,-1858.01"/>
<polygon fill="black" stroke="black" points="2112.98,-1861.51 2122.98,-1858.01 2112.98,-1854.51 2112.98,-1861.51"/>
</g>
<!-- expert_17_layer_4_gpu_17&#45;&gt;aggregate_layer_4 -->
<g id="edge53" class="edge">
<title>expert_17_layer_4_gpu_17&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.87,-1707.5C2029.54,-1707.5 2094.5,-1707.5 2094.5,-1707.5 2094.5,-1707.5 2094.5,-1857.12 2094.5,-1857.12"/>
<polygon fill="black" stroke="black" points="2091,-1857.12 2094.5,-1867.12 2098,-1857.12 2091,-1857.12"/>
</g>
<!-- expert_18_layer_4_gpu_18&#45;&gt;aggregate_layer_4 -->
<g id="edge54" class="edge">
<title>expert_18_layer_4_gpu_18&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.76,-1588.5C2036.89,-1588.5 2113.5,-1588.5 2113.5,-1588.5 2113.5,-1588.5 2113.5,-1850.43 2113.5,-1850.43"/>
<polygon fill="black" stroke="black" points="2110,-1850.43 2113.5,-1860.43 2117,-1850.43 2110,-1850.43"/>
</g>
<!-- expert_19_layer_4_gpu_19&#45;&gt;aggregate_layer_4 -->
<g id="edge55" class="edge">
<title>expert_19_layer_4_gpu_19&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.97,-1469.5C2043.83,-1469.5 2131.5,-1469.5 2131.5,-1469.5 2131.5,-1469.5 2131.5,-1845.92 2131.5,-1845.92"/>
<polygon fill="black" stroke="black" points="2128,-1845.92 2131.5,-1855.92 2135,-1845.92 2128,-1845.92"/>
</g>
<!-- expert_20_layer_4_gpu_20&#45;&gt;aggregate_layer_4 -->
<g id="edge56" class="edge">
<title>expert_20_layer_4_gpu_20&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1968.06,-1350.5C2050.81,-1350.5 2150.5,-1350.5 2150.5,-1350.5 2150.5,-1350.5 2150.5,-1842.84 2150.5,-1842.84"/>
<polygon fill="black" stroke="black" points="2147,-1842.84 2150.5,-1852.84 2154,-1842.84 2147,-1842.84"/>
</g>
<!-- expert_21_layer_4_gpu_21&#45;&gt;aggregate_layer_4 -->
<g id="edge57" class="edge">
<title>expert_21_layer_4_gpu_21&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.79,-1231.5C2056.92,-1231.5 2168.5,-1231.5 2168.5,-1231.5 2168.5,-1231.5 2168.5,-1840.34 2168.5,-1840.34"/>
<polygon fill="black" stroke="black" points="2165,-1840.34 2168.5,-1850.34 2172,-1840.34 2165,-1840.34"/>
</g>
<!-- expert_22_layer_4_gpu_22&#45;&gt;aggregate_layer_4 -->
<g id="edge58" class="edge">
<title>expert_22_layer_4_gpu_22&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.7,-1112.5C2062.99,-1112.5 2186.5,-1112.5 2186.5,-1112.5 2186.5,-1112.5 2186.5,-1839 2186.5,-1839"/>
<polygon fill="black" stroke="black" points="2183,-1839 2186.5,-1849 2190,-1839 2183,-1839"/>
</g>
<!-- expert_23_layer_4_gpu_23&#45;&gt;aggregate_layer_4 -->
<g id="edge59" class="edge">
<title>expert_23_layer_4_gpu_23&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.79,-993.5C2069.36,-993.5 2205.5,-993.5 2205.5,-993.5 2205.5,-993.5 2205.5,-1838.03 2205.5,-1838.03"/>
<polygon fill="black" stroke="black" points="2202,-1838.03 2205.5,-1848.03 2209,-1838.03 2202,-1838.03"/>
</g>
<!-- expert_24_layer_4_gpu_24&#45;&gt;aggregate_layer_4 -->
<g id="edge60" class="edge">
<title>expert_24_layer_4_gpu_24&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.98,-874.5C2075.34,-874.5 2223.5,-874.5 2223.5,-874.5 2223.5,-874.5 2223.5,-1838.02 2223.5,-1838.02"/>
<polygon fill="black" stroke="black" points="2220,-1838.02 2223.5,-1848.02 2227,-1838.02 2220,-1838.02"/>
</g>
<!-- expert_25_layer_4_gpu_25&#45;&gt;aggregate_layer_4 -->
<g id="edge61" class="edge">
<title>expert_25_layer_4_gpu_25&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.73,-755.5C2081.07,-755.5 2242.5,-755.5 2242.5,-755.5 2242.5,-755.5 2242.5,-1838.22 2242.5,-1838.22"/>
<polygon fill="black" stroke="black" points="2239,-1838.22 2242.5,-1848.22 2246,-1838.22 2239,-1838.22"/>
</g>
<!-- expert_26_layer_4_gpu_26&#45;&gt;aggregate_layer_4 -->
<g id="edge62" class="edge">
<title>expert_26_layer_4_gpu_26&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.77,-636.5C2086.63,-636.5 2260.5,-636.5 2260.5,-636.5 2260.5,-636.5 2260.5,-1839.13 2260.5,-1839.13"/>
<polygon fill="black" stroke="black" points="2257,-1839.13 2260.5,-1849.13 2264,-1839.13 2257,-1839.13"/>
</g>
<!-- expert_27_layer_4_gpu_27&#45;&gt;aggregate_layer_4 -->
<g id="edge63" class="edge">
<title>expert_27_layer_4_gpu_27&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.68,-517.5C2092.22,-517.5 2279.5,-517.5 2279.5,-517.5 2279.5,-517.5 2279.5,-1840.66 2279.5,-1840.66"/>
<polygon fill="black" stroke="black" points="2276,-1840.66 2279.5,-1850.66 2283,-1840.66 2276,-1840.66"/>
</g>
<!-- expert_28_layer_4_gpu_28&#45;&gt;aggregate_layer_4 -->
<g id="edge64" class="edge">
<title>expert_28_layer_4_gpu_28&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.79,-398.5C2097.61,-398.5 2297.5,-398.5 2297.5,-398.5 2297.5,-398.5 2297.5,-1843.06 2297.5,-1843.06"/>
<polygon fill="black" stroke="black" points="2294,-1843.06 2297.5,-1853.06 2301,-1843.06 2294,-1843.06"/>
</g>
<!-- expert_29_layer_4_gpu_29&#45;&gt;aggregate_layer_4 -->
<g id="edge65" class="edge">
<title>expert_29_layer_4_gpu_29&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.83,-279.5C2103.09,-279.5 2316.5,-279.5 2316.5,-279.5 2316.5,-279.5 2316.5,-1846.25 2316.5,-1846.25"/>
<polygon fill="black" stroke="black" points="2313,-1846.25 2316.5,-1856.25 2320,-1846.25 2313,-1846.25"/>
</g>
<!-- expert_30_layer_4_gpu_30&#45;&gt;aggregate_layer_4 -->
<g id="edge66" class="edge">
<title>expert_30_layer_4_gpu_30&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.91,-160.5C2108.23,-160.5 2334.5,-160.5 2334.5,-160.5 2334.5,-160.5 2334.5,-1850.45 2334.5,-1850.45"/>
<polygon fill="black" stroke="black" points="2331,-1850.45 2334.5,-1860.45 2338,-1850.45 2331,-1850.45"/>
</g>
<!-- expert_31_layer_4_gpu_31&#45;&gt;aggregate_layer_4 -->
<g id="edge67" class="edge">
<title>expert_31_layer_4_gpu_31&#45;&gt;aggregate_layer_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1967.95,-41.5C2113.5,-41.5 2353.5,-41.5 2353.5,-41.5 2353.5,-41.5 2353.5,-1857.55 2353.5,-1857.55"/>
<polygon fill="black" stroke="black" points="2350,-1857.55 2353.5,-1867.55 2357,-1857.55 2350,-1857.55"/>
</g>
<!-- output_layer_4 -->
<g id="node38" class="node">
<title>output_layer_4</title>
<ellipse fill="lightgrey" stroke="black" cx="2641.86" cy="-1885.5" rx="162.77" ry="37.45"/>
<text text-anchor="middle" x="2641.86" y="-1896.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2641.86" y="-1881.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2641.86" y="-1866.8" font-family="Times,serif" font-size="14.00">[bs=4, seq=2048, dim=7168]</text>
</g>
<!-- aggregate_layer_4&#45;&gt;output_layer_4 -->
<g id="edge68" class="edge">
<title>aggregate_layer_4&#45;&gt;output_layer_4</title>
<path fill="none" stroke="black" d="M2371.26,-1885.5C2371.26,-1885.5 2469.16,-1885.5 2469.16,-1885.5"/>
<polygon fill="black" stroke="black" points="2469.16,-1889 2479.16,-1885.5 2469.16,-1882 2469.16,-1889"/>
</g>
</g>
</svg>
