<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Data_Parallel_Replicas Pages: 1 -->
<svg width="800pt" height="371pt"
 viewBox="0.00 0.00 800.00 371.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 367.22)">
<title>Data_Parallel_Replicas</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-367.22 796,-367.22 796,4 -4,4"/>
<text text-anchor="middle" x="396" y="-7.8" font-family="Times,serif" font-size="14.00">Data Parallelism Across Model Replicas</text>
<g id="clust1" class="cluster">
<title>cluster_replica_0</title>
<polygon fill="none" stroke="black" points="8,-194.48 8,-301.48 196,-301.48 196,-194.48 8,-194.48"/>
<text text-anchor="middle" x="102" y="-286.28" font-family="Times,serif" font-size="14.00">Model Replica 0</text>
<text text-anchor="middle" x="102" y="-271.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_replica_1</title>
<polygon fill="none" stroke="black" points="204,-194.48 204,-301.48 392,-301.48 392,-194.48 204,-194.48"/>
<text text-anchor="middle" x="298" y="-286.28" font-family="Times,serif" font-size="14.00">Model Replica 1</text>
<text text-anchor="middle" x="298" y="-271.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_replica_2</title>
<polygon fill="none" stroke="black" points="400,-194.48 400,-301.48 588,-301.48 588,-194.48 400,-194.48"/>
<text text-anchor="middle" x="494" y="-286.28" font-family="Times,serif" font-size="14.00">Model Replica 2</text>
<text text-anchor="middle" x="494" y="-271.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_replica_3</title>
<polygon fill="none" stroke="black" points="596,-194.48 596,-301.48 784,-301.48 784,-194.48 596,-194.48"/>
<text text-anchor="middle" x="690" y="-286.28" font-family="Times,serif" font-size="14.00">Model Replica 3</text>
<text text-anchor="middle" x="690" y="-271.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
</g>
<!-- dp_input -->
<g id="node1" class="node">
<title>dp_input</title>
<ellipse fill="lightgrey" stroke="black" cx="396" cy="-336.35" rx="131.54" ry="26.74"/>
<text text-anchor="middle" x="396" y="-340.15" font-family="Times,serif" font-size="14.00">Training Data</text>
<text text-anchor="middle" x="396" y="-325.15" font-family="Times,serif" font-size="14.00">Batched across replicas</text>
</g>
<!-- dp_replica_0_model -->
<g id="node2" class="node">
<title>dp_replica_0_model</title>
<polygon fill="lightblue" stroke="black" points="187.5,-255.48 16.5,-255.48 16.5,-202.48 187.5,-202.48 187.5,-255.48"/>
<text text-anchor="middle" x="102" y="-240.28" font-family="Times,serif" font-size="14.00">Complete MoE Model</text>
<text text-anchor="middle" x="102" y="-225.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
<text text-anchor="middle" x="102" y="-210.28" font-family="Times,serif" font-size="14.00">Processing batch 0</text>
</g>
<!-- dp_input&#45;&gt;dp_replica_0_model -->
<g id="edge1" class="edge">
<title>dp_input&#45;&gt;dp_replica_0_model</title>
<path fill="none" stroke="black" d="M264.48,-336C186.2,-336 102,-336 102,-336 102,-336 102,-265.71 102,-265.71"/>
<polygon fill="black" stroke="black" points="105.5,-265.71 102,-255.71 98.5,-265.71 105.5,-265.71"/>
</g>
<!-- dp_replica_1_model -->
<g id="node3" class="node">
<title>dp_replica_1_model</title>
<polygon fill="lightblue" stroke="black" points="383.5,-255.48 212.5,-255.48 212.5,-202.48 383.5,-202.48 383.5,-255.48"/>
<text text-anchor="middle" x="298" y="-240.28" font-family="Times,serif" font-size="14.00">Complete MoE Model</text>
<text text-anchor="middle" x="298" y="-225.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
<text text-anchor="middle" x="298" y="-210.28" font-family="Times,serif" font-size="14.00">Processing batch 1</text>
</g>
<!-- dp_input&#45;&gt;dp_replica_1_model -->
<g id="edge2" class="edge">
<title>dp_input&#45;&gt;dp_replica_1_model</title>
<path fill="none" stroke="black" d="M323.99,-313.84C323.99,-313.84 323.99,-265.63 323.99,-265.63"/>
<polygon fill="black" stroke="black" points="327.49,-265.63 323.99,-255.63 320.49,-265.63 327.49,-265.63"/>
</g>
<!-- dp_replica_2_model -->
<g id="node4" class="node">
<title>dp_replica_2_model</title>
<polygon fill="lightblue" stroke="black" points="579.5,-255.48 408.5,-255.48 408.5,-202.48 579.5,-202.48 579.5,-255.48"/>
<text text-anchor="middle" x="494" y="-240.28" font-family="Times,serif" font-size="14.00">Complete MoE Model</text>
<text text-anchor="middle" x="494" y="-225.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
<text text-anchor="middle" x="494" y="-210.28" font-family="Times,serif" font-size="14.00">Processing batch 2</text>
</g>
<!-- dp_input&#45;&gt;dp_replica_2_model -->
<g id="edge3" class="edge">
<title>dp_input&#45;&gt;dp_replica_2_model</title>
<path fill="none" stroke="black" d="M468.01,-313.84C468.01,-313.84 468.01,-265.63 468.01,-265.63"/>
<polygon fill="black" stroke="black" points="471.51,-265.63 468.01,-255.63 464.51,-265.63 471.51,-265.63"/>
</g>
<!-- dp_replica_3_model -->
<g id="node5" class="node">
<title>dp_replica_3_model</title>
<polygon fill="lightblue" stroke="black" points="775.5,-255.48 604.5,-255.48 604.5,-202.48 775.5,-202.48 775.5,-255.48"/>
<text text-anchor="middle" x="690" y="-240.28" font-family="Times,serif" font-size="14.00">Complete MoE Model</text>
<text text-anchor="middle" x="690" y="-225.28" font-family="Times,serif" font-size="14.00">1856 GPUs</text>
<text text-anchor="middle" x="690" y="-210.28" font-family="Times,serif" font-size="14.00">Processing batch 3</text>
</g>
<!-- dp_input&#45;&gt;dp_replica_3_model -->
<g id="edge4" class="edge">
<title>dp_input&#45;&gt;dp_replica_3_model</title>
<path fill="none" stroke="black" d="M527.52,-336C605.8,-336 690,-336 690,-336 690,-336 690,-265.71 690,-265.71"/>
<polygon fill="black" stroke="black" points="693.5,-265.71 690,-255.71 686.5,-265.71 693.5,-265.71"/>
</g>
<!-- dp_sync -->
<g id="node6" class="node">
<title>dp_sync</title>
<ellipse fill="lightgreen" stroke="black" stroke-dasharray="5,2" cx="396" cy="-139.61" rx="141.34" ry="26.74"/>
<text text-anchor="middle" x="396" y="-143.41" font-family="Times,serif" font-size="14.00">Gradient Synchronization</text>
<text text-anchor="middle" x="396" y="-128.41" font-family="Times,serif" font-size="14.00">All&#45;reduce across replicas</text>
</g>
<!-- dp_replica_0_model&#45;&gt;dp_sync -->
<g id="edge5" class="edge">
<title>dp_replica_0_model&#45;&gt;dp_sync</title>
<path fill="none" stroke="black" d="M102,-202.47C102,-175.93 102,-139 102,-139 102,-139 244.6,-139 244.6,-139"/>
<polygon fill="black" stroke="black" points="244.6,-142.5 254.6,-139 244.6,-135.5 244.6,-142.5"/>
</g>
<!-- dp_replica_1_model&#45;&gt;dp_sync -->
<g id="edge6" class="edge">
<title>dp_replica_1_model&#45;&gt;dp_sync</title>
<path fill="none" stroke="black" d="M319.04,-202.17C319.04,-202.17 319.04,-172.18 319.04,-172.18"/>
<polygon fill="black" stroke="black" points="322.54,-172.18 319.04,-162.18 315.54,-172.18 322.54,-172.18"/>
</g>
<!-- dp_replica_2_model&#45;&gt;dp_sync -->
<g id="edge7" class="edge">
<title>dp_replica_2_model&#45;&gt;dp_sync</title>
<path fill="none" stroke="black" d="M472.96,-202.17C472.96,-202.17 472.96,-172.18 472.96,-172.18"/>
<polygon fill="black" stroke="black" points="476.46,-172.18 472.96,-162.18 469.46,-172.18 476.46,-172.18"/>
</g>
<!-- dp_replica_3_model&#45;&gt;dp_sync -->
<g id="edge8" class="edge">
<title>dp_replica_3_model&#45;&gt;dp_sync</title>
<path fill="none" stroke="black" d="M690,-202.47C690,-175.93 690,-139 690,-139 690,-139 547.4,-139 547.4,-139"/>
<polygon fill="black" stroke="black" points="547.4,-135.5 537.4,-139 547.4,-142.5 547.4,-135.5"/>
</g>
<!-- dp_output -->
<g id="node7" class="node">
<title>dp_output</title>
<ellipse fill="lightgrey" stroke="black" cx="396" cy="-49.87" rx="114.6" ry="26.74"/>
<text text-anchor="middle" x="396" y="-53.67" font-family="Times,serif" font-size="14.00">Synchronized Model</text>
<text text-anchor="middle" x="396" y="-38.67" font-family="Times,serif" font-size="14.00">Updated Weights</text>
</g>
<!-- dp_sync&#45;&gt;dp_output -->
<g id="edge9" class="edge">
<title>dp_sync&#45;&gt;dp_output</title>
<path fill="none" stroke="black" d="M396,-112.69C396,-112.69 396,-86.78 396,-86.78"/>
<polygon fill="black" stroke="black" points="399.5,-86.78 396,-76.78 392.5,-86.78 399.5,-86.78"/>
</g>
</g>
</svg>
