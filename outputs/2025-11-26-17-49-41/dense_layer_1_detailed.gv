digraph Dense_Layer_1_Detailed {
	graph [concentrate=true nodesep=0.5 rankdir=TB ranksep=1.0 splines=ortho]
	input_dense_layer_1 [label="Input
Dense Layer 1
[bs=4, seq=2048, dim=7168]" fillcolor=lightgrey shape=ellipse style=filled]
	mha_q_dense_layer_1 [label="Query Projection
GPU: 0
[bs=4, seq=2048, dim=7168]
→ [bs=4, seq=2048, heads=128, d_k=128]" fillcolor=lightblue shape=rectangle style=filled]
	mha_k_dense_layer_1 [label="Key Projection
GPU: 0
[bs=4, seq=2048, dim=7168]
→ [bs=4, seq=2048, heads=128, d_k=128]" fillcolor=lightblue shape=rectangle style=filled]
	mha_v_dense_layer_1 [label="Value Projection
GPU: 0
[bs=4, seq=2048, dim=7168]
→ [bs=4, seq=2048, heads=128, d_k=128]" fillcolor=lightblue shape=rectangle style=filled]
	mha_attn_dense_layer_1 [label="Attention
GPU: 0
QK^T Softmax
[bs=4, heads=128, seq=2048, seq=2048]
→ [bs=4, heads=128, seq=2048, d_k=128]" fillcolor=lightblue shape=rectangle style=filled]
	mha_out_dense_layer_1 [label="Output Projection
GPU: 0
[bs=4, seq=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
	ffn1_dense_layer_1 [label="FFN Layer 1
GPU: 0
[bs=4, seq=2048, dim=7168]
→ [bs=4, seq=2048, dim=2048]" fillcolor=lightblue shape=rectangle style=filled]
	ffn_act_dense_layer_1 [label="GELU Activation
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
	ffn2_dense_layer_1 [label="FFN Layer 2
GPU: 0
[bs=4, seq=2048, dim=2048]
→ [bs=4, seq=2048, dim=7168]" fillcolor=lightblue shape=rectangle style=filled]
	output_dense_layer_1 [label="Output
Dense Layer 1
[bs=4, seq=2048, dim=7168]" fillcolor=lightgrey shape=ellipse style=filled]
	input_dense_layer_1 -> mha_q_dense_layer_1
	input_dense_layer_1 -> mha_k_dense_layer_1
	input_dense_layer_1 -> mha_v_dense_layer_1
	mha_q_dense_layer_1 -> mha_attn_dense_layer_1
	mha_k_dense_layer_1 -> mha_attn_dense_layer_1
	mha_v_dense_layer_1 -> mha_attn_dense_layer_1
	mha_attn_dense_layer_1 -> mha_out_dense_layer_1
	mha_out_dense_layer_1 -> ffn1_dense_layer_1
	ffn1_dense_layer_1 -> ffn_act_dense_layer_1
	ffn_act_dense_layer_1 -> ffn2_dense_layer_1
	ffn2_dense_layer_1 -> output_dense_layer_1
}
