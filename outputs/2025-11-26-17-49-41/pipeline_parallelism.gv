digraph Pipeline_Parallelism {
	graph [concentrate=true rankdir=LR splines=ortho]
	label="Pipeline Parallelism Across Model Layers"
	pp_input [label="Input Batch
Micro-batched for pipeline" fillcolor=lightgrey shape=ellipse style=filled]
	pp_stage_0 [label="Stage 0
Layers 1-8
GPUs 0-231" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_1 [label="Stage 1
Layers 9-16
GPUs 232-463" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_2 [label="Stage 2
Layers 17-24
GPUs 464-695" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_3 [label="Stage 3
Layers 25-32
GPUs 696-927" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_4 [label="Stage 4
Layers 33-40
GPUs 928-1159" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_5 [label="Stage 5
Layers 41-48
GPUs 1160-1391" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_6 [label="Stage 6
Layers 49-56
GPUs 1392-1623" fillcolor=lightblue shape=rectangle style=filled]
	pp_stage_7 [label="Stage 7
Layers 57-64
GPUs 1624-1855" fillcolor=lightblue shape=rectangle style=filled]
	pp_comm_0 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_0 -> pp_comm_0
	pp_comm_0 -> pp_stage_1
	pp_comm_1 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_1 -> pp_comm_1
	pp_comm_1 -> pp_stage_2
	pp_comm_2 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_2 -> pp_comm_2
	pp_comm_2 -> pp_stage_3
	pp_comm_3 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_3 -> pp_comm_3
	pp_comm_3 -> pp_stage_4
	pp_comm_4 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_4 -> pp_comm_4
	pp_comm_4 -> pp_stage_5
	pp_comm_5 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_5 -> pp_comm_5
	pp_comm_5 -> pp_stage_6
	pp_comm_6 [label="Inter-stage
Communication" fillcolor=lightgreen shape=ellipse style="filled,dashed"]
	pp_stage_6 -> pp_comm_6
	pp_comm_6 -> pp_stage_7
	pp_output [label="Output Sequence" fillcolor=lightgrey shape=ellipse style=filled]
	pp_stage_7 -> pp_output
}
