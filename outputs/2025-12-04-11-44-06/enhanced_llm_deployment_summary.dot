digraph EnhancedLLMDeploymentSummary {
  rankdir=TB;
  node [shape=record, fontname="Helvetica"];
  edge [fontname="Helvetica"];
  
  Input [shape=box, label="Input\n[batch=128, seq=10000, hidden=4096]", style=filled, fillcolor=lightblue];
  Layer0 [shape=box, label="Layer 0\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Input -> Layer0;
  Layer1 [shape=box, label="Layer 1\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer0 -> Layer1;
  Layer2 [shape=box, label="Layer 2\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer1 -> Layer2;
  Layer3 [shape=box, label="Layer 3\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer2 -> Layer3;
  Layer4 [shape=box, label="Layer 4\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer3 -> Layer4;
  Layer5 [shape=box, label="Layer 5\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer4 -> Layer5;
  Layer6 [shape=box, label="Layer 6\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer5 -> Layer6;
  Layer7 [shape=box, label="Layer 7\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer6 -> Layer7;
  Layer8 [shape=box, label="Layer 8\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer7 -> Layer8;
  Layer9 [shape=box, label="Layer 9\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer8 -> Layer9;
  Layer10 [shape=box, label="Layer 10\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer9 -> Layer10;
  Layer11 [shape=box, label="Layer 11\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer10 -> Layer11;
  Layer12 [shape=box, label="Layer 12\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer11 -> Layer12;
  Layer13 [shape=box, label="Layer 13\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer12 -> Layer13;
  Layer14 [shape=box, label="Layer 14\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer13 -> Layer14;
  Layer15 [shape=box, label="Layer 15\nRMSNorm + MHA + Residual\nRMSNorm + MoE + Residual\nTP=2, EP=64\n[batch=128, seq=10000, hidden=4096]"];
  Layer14 -> Layer15;
  FinalNorm [shape=box, label="Final RMSNorm\n[batch=128, seq=10000, hidden=4096]"];
  Output [shape=box, label="Output\n[batch=128, seq=10000, hidden=4096]", style=filled, fillcolor=lightgreen];
  Layer15 -> FinalNorm;
  FinalNorm -> Output;
}
