<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2160pt" height="5pt"
 viewBox="0.00 0.00 2160.00 4.88" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0 0) rotate(0) translate(4 1313)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1313 582665.4,-1313 582665.4,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="lightgray" stroke="black" d="M32056,-1158C32056,-1158 32624,-1158 32624,-1158 32630,-1158 32636,-1164 32636,-1170 32636,-1170 32636,-1289 32636,-1289 32636,-1295 32630,-1301 32624,-1301 32624,-1301 32056,-1301 32056,-1301 32050,-1301 32044,-1295 32044,-1289 32044,-1289 32044,-1170 32044,-1170 32044,-1164 32050,-1158 32056,-1158"/>
<text text-anchor="middle" x="32340" y="-1285.8" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pp_stage_0</title>
<path fill="lightcyan" stroke="black" d="M20,-8C20,-8 144160,-8 144160,-8 144166,-8 144172,-14 144172,-20 144172,-20 144172,-1119 144172,-1119 144172,-1125 144166,-1131 144160,-1131 144160,-1131 20,-1131 20,-1131 14,-1131 8,-1125 8,-1119 8,-1119 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="72090" y="-1115.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (GPUs 0&#45;127)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_0</title>
<path fill="white" stroke="black" d="M28,-447C28,-447 36035,-447 36035,-447 36041,-447 36047,-453 36047,-459 36047,-459 36047,-1088 36047,-1088 36047,-1094 36041,-1100 36035,-1100 36035,-1100 28,-1100 28,-1100 22,-1100 16,-1094 16,-1088 16,-1088 16,-459 16,-459 16,-453 22,-447 28,-447"/>
<text text-anchor="middle" x="18031.5" y="-1084.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_1</title>
<path fill="white" stroke="black" d="M36067,-298C36067,-298 72074,-298 72074,-298 72080,-298 72086,-304 72086,-310 72086,-310 72086,-918 72086,-918 72086,-924 72080,-930 72074,-930 72074,-930 36067,-930 36067,-930 36061,-930 36055,-924 36055,-918 36055,-918 36055,-310 36055,-310 36055,-304 36061,-298 36067,-298"/>
<text text-anchor="middle" x="54070.5" y="-914.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_2</title>
<path fill="white" stroke="black" d="M72106,-157C72106,-157 108113,-157 108113,-157 108119,-157 108125,-163 108125,-169 108125,-169 108125,-748 108125,-748 108125,-754 108119,-760 108113,-760 108113,-760 72106,-760 72106,-760 72100,-760 72094,-754 72094,-748 72094,-748 72094,-169 72094,-169 72094,-163 72100,-157 72106,-157"/>
<text text-anchor="middle" x="90109.5" y="-744.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_3</title>
<path fill="white" stroke="black" d="M108145,-16C108145,-16 144152,-16 144152,-16 144158,-16 144164,-22 144164,-28 144164,-28 144164,-578 144164,-578 144164,-584 144158,-590 144152,-590 144152,-590 108145,-590 108145,-590 108139,-590 108133,-584 108133,-578 108133,-578 108133,-28 108133,-28 108133,-22 108139,-16 108145,-16"/>
<text text-anchor="middle" x="126148.5" y="-574.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_pp_stage_1</title>
<path fill="lightcyan" stroke="black" d="M145867,-8C145867,-8 290007,-8 290007,-8 290013,-8 290019,-14 290019,-20 290019,-20 290019,-1119 290019,-1119 290019,-1125 290013,-1131 290007,-1131 290007,-1131 145867,-1131 145867,-1131 145861,-1131 145855,-1125 145855,-1119 145855,-1119 145855,-20 145855,-20 145855,-14 145861,-8 145867,-8"/>
<text text-anchor="middle" x="217937" y="-1115.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 128&#45;255)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_4</title>
<path fill="white" stroke="black" d="M253992,-447C253992,-447 289999,-447 289999,-447 290005,-447 290011,-453 290011,-459 290011,-459 290011,-1088 290011,-1088 290011,-1094 290005,-1100 289999,-1100 289999,-1100 253992,-1100 253992,-1100 253986,-1100 253980,-1094 253980,-1088 253980,-1088 253980,-459 253980,-459 253980,-453 253986,-447 253992,-447"/>
<text text-anchor="middle" x="271995.5" y="-1084.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_5</title>
<path fill="white" stroke="black" d="M217953,-298C217953,-298 253960,-298 253960,-298 253966,-298 253972,-304 253972,-310 253972,-310 253972,-918 253972,-918 253972,-924 253966,-930 253960,-930 253960,-930 217953,-930 217953,-930 217947,-930 217941,-924 217941,-918 217941,-918 217941,-310 217941,-310 217941,-304 217947,-298 217953,-298"/>
<text text-anchor="middle" x="235956.5" y="-914.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_6</title>
<path fill="white" stroke="black" d="M145875,-157C145875,-157 181882,-157 181882,-157 181888,-157 181894,-163 181894,-169 181894,-169 181894,-748 181894,-748 181894,-754 181888,-760 181882,-760 181882,-760 145875,-760 145875,-760 145869,-760 145863,-754 145863,-748 145863,-748 145863,-169 145863,-169 145863,-163 145869,-157 145875,-157"/>
<text text-anchor="middle" x="163878.5" y="-744.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_7</title>
<path fill="white" stroke="black" d="M181914,-16C181914,-16 217921,-16 217921,-16 217927,-16 217933,-22 217933,-28 217933,-28 217933,-578 217933,-578 217933,-584 217927,-590 217921,-590 217921,-590 181914,-590 181914,-590 181908,-590 181902,-584 181902,-578 181902,-578 181902,-28 181902,-28 181902,-22 181908,-16 181914,-16"/>
<text text-anchor="middle" x="199917.5" y="-574.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_pp_stage_2</title>
<path fill="lightcyan" stroke="black" d="M290173,-8C290173,-8 434313,-8 434313,-8 434319,-8 434325,-14 434325,-20 434325,-20 434325,-1119 434325,-1119 434325,-1125 434319,-1131 434313,-1131 434313,-1131 290173,-1131 290173,-1131 290167,-1131 290161,-1125 290161,-1119 290161,-1119 290161,-20 290161,-20 290161,-14 290167,-8 290173,-8"/>
<text text-anchor="middle" x="362243" y="-1115.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (GPUs 256&#45;383)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_8</title>
<path fill="white" stroke="black" d="M398298,-447C398298,-447 434305,-447 434305,-447 434311,-447 434317,-453 434317,-459 434317,-459 434317,-1088 434317,-1088 434317,-1094 434311,-1100 434305,-1100 434305,-1100 398298,-1100 398298,-1100 398292,-1100 398286,-1094 398286,-1088 398286,-1088 398286,-459 398286,-459 398286,-453 398292,-447 398298,-447"/>
<text text-anchor="middle" x="416301.5" y="-1084.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_9</title>
<path fill="white" stroke="black" d="M362259,-298C362259,-298 398266,-298 398266,-298 398272,-298 398278,-304 398278,-310 398278,-310 398278,-918 398278,-918 398278,-924 398272,-930 398266,-930 398266,-930 362259,-930 362259,-930 362253,-930 362247,-924 362247,-918 362247,-918 362247,-310 362247,-310 362247,-304 362253,-298 362259,-298"/>
<text text-anchor="middle" x="380262.5" y="-914.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_10</title>
<path fill="white" stroke="black" d="M290181,-157C290181,-157 326188,-157 326188,-157 326194,-157 326200,-163 326200,-169 326200,-169 326200,-748 326200,-748 326200,-754 326194,-760 326188,-760 326188,-760 290181,-760 290181,-760 290175,-760 290169,-754 290169,-748 290169,-748 290169,-169 290169,-169 290169,-163 290175,-157 290181,-157"/>
<text text-anchor="middle" x="308184.5" y="-744.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_11</title>
<path fill="white" stroke="black" d="M326220,-16C326220,-16 362227,-16 362227,-16 362233,-16 362239,-22 362239,-28 362239,-28 362239,-578 362239,-578 362239,-584 362233,-590 362227,-590 362227,-590 326220,-590 326220,-590 326214,-590 326208,-584 326208,-578 326208,-578 326208,-28 326208,-28 326208,-22 326214,-16 326220,-16"/>
<text text-anchor="middle" x="344223.5" y="-574.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_pp_stage_3</title>
<path fill="lightcyan" stroke="black" d="M434748,-8C434748,-8 578888,-8 578888,-8 578894,-8 578900,-14 578900,-20 578900,-20 578900,-1119 578900,-1119 578900,-1125 578894,-1131 578888,-1131 578888,-1131 434748,-1131 434748,-1131 434742,-1131 434736,-1125 434736,-1119 434736,-1119 434736,-20 434736,-20 434736,-14 434742,-8 434748,-8"/>
<text text-anchor="middle" x="506818" y="-1115.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (GPUs 384&#45;511)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer_12</title>
<path fill="white" stroke="black" d="M542873,-447C542873,-447 578880,-447 578880,-447 578886,-447 578892,-453 578892,-459 578892,-459 578892,-1088 578892,-1088 578892,-1094 578886,-1100 578880,-1100 578880,-1100 542873,-1100 542873,-1100 542867,-1100 542861,-1094 542861,-1088 542861,-1088 542861,-459 542861,-459 542861,-453 542867,-447 542873,-447"/>
<text text-anchor="middle" x="560876.5" y="-1084.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer_13</title>
<path fill="white" stroke="black" d="M506834,-298C506834,-298 542841,-298 542841,-298 542847,-298 542853,-304 542853,-310 542853,-310 542853,-918 542853,-918 542853,-924 542847,-930 542841,-930 542841,-930 506834,-930 506834,-930 506828,-930 506822,-924 506822,-918 506822,-918 506822,-310 506822,-310 506822,-304 506828,-298 506834,-298"/>
<text text-anchor="middle" x="524837.5" y="-914.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer_14</title>
<path fill="white" stroke="black" d="M434756,-157C434756,-157 470763,-157 470763,-157 470769,-157 470775,-163 470775,-169 470775,-169 470775,-748 470775,-748 470775,-754 470769,-760 470763,-760 470763,-760 434756,-760 434756,-760 434750,-760 434744,-754 434744,-748 434744,-748 434744,-169 434744,-169 434744,-163 434750,-157 434756,-157"/>
<text text-anchor="middle" x="452759.5" y="-744.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer_15</title>
<path fill="white" stroke="black" d="M470795,-16C470795,-16 506802,-16 506802,-16 506808,-16 506814,-22 506814,-28 506814,-28 506814,-578 506814,-578 506814,-584 506808,-590 506802,-590 506802,-590 470795,-590 470795,-590 470789,-590 470783,-584 470783,-578 470783,-578 470783,-28 470783,-28 470783,-22 470789,-16 470795,-16"/>
<text text-anchor="middle" x="488798.5" y="-574.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_output</title>
<path fill="lightgray" stroke="black" d="M578920,-957C578920,-957 579494,-957 579494,-957 579500,-957 579506,-963 579506,-969 579506,-969 579506,-1088 579506,-1088 579506,-1094 579500,-1100 579494,-1100 579494,-1100 578920,-1100 578920,-1100 578914,-1100 578908,-1094 578908,-1088 578908,-1088 578908,-969 578908,-969 578908,-963 578914,-957 578920,-957"/>
<text text-anchor="middle" x="579207" y="-1084.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="black" points="32628.43,-1270 32169.6,-1270 32051.57,-1166 32510.4,-1166 32628.43,-1270"/>
<text text-anchor="middle" x="32340" y="-1232" font-family="Arial" font-size="10.00">Input Embedding</text>
<text text-anchor="middle" x="32340" y="-1221" font-family="Arial" font-size="10.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="32340" y="-1210" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="32340" y="-1199" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_qkv_tp_0 -->
<g id="node2" class="node">
<title>layer_0_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="31576.7,-1069 31134.94,-1069 31021.3,-965 31463.06,-965 31576.7,-1069"/>
<text text-anchor="middle" x="31299" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="31299" y="-1020" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="31299" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="31299" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_tp_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv_tp_0</title>
<path fill="none" stroke="black" d="M32096.03,-1205.37C31946.98,-1194.29 31753.47,-1172.75 31586,-1131 31529.38,-1116.88 31468.96,-1094.31 31418.24,-1073.04"/>
<polygon fill="black" stroke="black" points="31419.46,-1069.75 31408.88,-1069.09 31416.73,-1076.2 31419.46,-1069.75"/>
<text text-anchor="middle" x="31677" y="-1141.6" font-family="Arial" font-size="8.00">Data Parallel Split</text>
</g>
<!-- layer_0_qkv_tp_1 -->
<g id="node3" class="node">
<title>layer_0_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="32150.7,-1069 31708.94,-1069 31595.3,-965 32037.06,-965 32150.7,-1069"/>
<text text-anchor="middle" x="31873" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="31873" y="-1020" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="31873" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="31873" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_tp_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer_0_qkv_tp_1</title>
<path fill="none" stroke="black" d="M32220.04,-1165.88C32153.45,-1137.51 32070.57,-1102.19 32002.51,-1073.19"/>
<polygon fill="black" stroke="black" points="32003.58,-1069.84 31993.01,-1069.14 32000.83,-1076.28 32003.58,-1069.84"/>
<text text-anchor="middle" x="32207" y="-1141.6" font-family="Arial" font-size="8.00">Data Parallel Split</text>
</g>
<!-- layer_0_qkv_tp_2 -->
<g id="node4" class="node">
<title>layer_0_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="33308.7,-1069 32866.94,-1069 32753.3,-965 33195.06,-965 33308.7,-1069"/>
<text text-anchor="middle" x="33031" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="33031" y="-1020" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="33031" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="33031" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_tp_2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer_0_qkv_tp_2</title>
<path fill="none" stroke="black" d="M32530.22,-1183.25C32598.28,-1169.4 32675.16,-1151.72 32744,-1131 32797.59,-1114.87 32855.26,-1093.07 32904.74,-1072.93"/>
<polygon fill="black" stroke="black" points="32906.28,-1076.08 32914.21,-1069.06 32903.63,-1069.6 32906.28,-1076.08"/>
<text text-anchor="middle" x="32743" y="-1141.6" font-family="Arial" font-size="8.00">Data Parallel Split</text>
</g>
<!-- layer_0_qkv_tp_3 -->
<g id="node5" class="node">
<title>layer_0_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="36038.7,-1069 35596.94,-1069 35483.3,-965 35925.06,-965 36038.7,-1069"/>
<text text-anchor="middle" x="35761" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="35761" y="-1020" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="35761" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="35761" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_tp_3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer_0_qkv_tp_3</title>
<path fill="none" stroke="black" d="M32566.5,-1215.32C33238.55,-1209.68 35192.13,-1188.51 35474,-1131 35533.27,-1118.91 35596.12,-1095.48 35647.85,-1073.08"/>
<polygon fill="black" stroke="black" points="35649.28,-1076.28 35657.04,-1069.06 35646.47,-1069.86 35649.28,-1076.28"/>
<text text-anchor="middle" x="35453" y="-1141.6" font-family="Arial" font-size="8.00">Data Parallel Split</text>
</g>
<!-- layer_{layer_id}_qkv_comm -->
<g id="node1651" class="node">
<title>layer_{layer_id}_qkv_comm</title>
<polygon fill="lightyellow" stroke="black" points="145369.26,-376 145182.72,-376 145134.74,-340 145321.28,-340 145369.26,-376"/>
<text text-anchor="middle" x="145252" y="-355.5" font-family="Arial" font-size="10.00">layer_{layer_id}_qkv_comm</text>
</g>
<!-- layer_0_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge5" class="edge">
<title>layer_0_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M31473.43,-974.27C31510.38,-967.08 31549.31,-960.73 31586,-957 31586,-957 145405,-947 145405,-947 145417.84,-943.05 145421.82,-940.66 145430,-930 145468.67,-879.59 145449.34,-852.19 145477,-795 145515.98,-714.42 145506.55,-668.11 145585,-625 145585,-625 470779,-607 470779,-607 470872.98,-606.99 578969.36,-644.4 579046,-590 579100.9,-551.03 579043.15,-488.71 579096,-447 579113.18,-433.44 579179.33,-453.25 579194,-437 579196.68,-434.03 579196.83,-430.83 579194,-428 579194,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_0_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge6" class="edge">
<title>layer_0_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M32047.43,-974.27C32084.38,-967.08 32123.31,-960.73 32160,-957 32160,-957 145463,-947 145463,-947 145522.3,-905.9 145472.54,-849.35 145520,-795 145541.58,-770.29 145564.48,-785.6 145585,-760 145623.98,-711.36 145573.31,-662.63 145623,-625 145623,-625 579084,-607 579084,-607 579142.88,-562.39 579072.41,-494.48 579129,-447 579146.11,-432.64 579214.01,-453.56 579229,-437 579231.68,-434.03 579231.83,-430.83 579229,-428 579229,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_0_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge7" class="edge">
<title>layer_0_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M33205.43,-974.27C33242.38,-967.08 33281.31,-960.73 33318,-957 33318,-957 145501,-947 145501,-947 145568.05,-907.9 145539.58,-856.45 145587,-795 145600.63,-777.33 145610.89,-778.74 145623,-760 145657.65,-706.39 145619.73,-661.64 145672,-625 145672,-625 579116,-607 579116,-607 579176.5,-564.19 579106.34,-494.78 579163,-447 579178.55,-433.89 579240.42,-452.15 579254,-437 579256.67,-434.02 579256.83,-430.83 579254,-428 579254,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_0_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge8" class="edge">
<title>layer_0_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M35980.92,-1015.95C41408.07,-1014.65 145468.31,-989.16 145551,-947 145708.61,-866.64 145627.37,-705.31 145785,-625 145785,-625 579151,-607 579151,-607 579161.58,-601.72 579275.25,-448.21 579279,-437 579280.27,-433.21 579281.83,-430.83 579279,-428 579279,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_0_qkv_comm -->
<g id="node6" class="node">
<title>layer_0_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="33520" cy="-1017" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="33520" y="-1031" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="33520" y="-1020" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="33520" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="33520" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_0_attn_tp_0 -->
<g id="node7" class="node">
<title>layer_0_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="28870.7,-1069 28428.94,-1069 28315.3,-965 28757.06,-965 28870.7,-1069"/>
<text text-anchor="middle" x="28593" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="28593" y="-1020" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="28593" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="28593" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_out_tp_0 -->
<g id="node11" class="node">
<title>layer_0_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="33816.7,-899 33374.94,-899 33261.3,-795 33703.06,-795 33816.7,-899"/>
<text text-anchor="middle" x="33539" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="33539" y="-850" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="33539" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="33539" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_tp_0&#45;&gt;layer_0_attn_out_tp_0 -->
<g id="edge13" class="edge">
<title>layer_0_attn_tp_0&#45;&gt;layer_0_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M28768.3,-975.07C28805.02,-967.87 28843.63,-961.32 28880,-957 29129.5,-927.38 29193.79,-942.53 29445,-938 29627.03,-934.72 32540.18,-939.32 32722,-930 32931.69,-919.25 33170.54,-893.72 33335.59,-873.98"/>
<polygon fill="black" stroke="black" points="33336.34,-877.42 33345.85,-872.75 33335.51,-870.47 33336.34,-877.42"/>
</g>
<!-- layer_0_attn_tp_1 -->
<g id="node8" class="node">
<title>layer_0_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="29444.7,-1069 29002.94,-1069 28889.3,-965 29331.06,-965 29444.7,-1069"/>
<text text-anchor="middle" x="29167" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="29167" y="-1020" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="29167" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="29167" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_out_tp_1 -->
<g id="node12" class="node">
<title>layer_0_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="34655.7,-899 34213.94,-899 34100.3,-795 34542.06,-795 34655.7,-899"/>
<text text-anchor="middle" x="34378" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="34378" y="-850" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="34378" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="34378" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_tp_1&#45;&gt;layer_0_attn_out_tp_1 -->
<g id="edge15" class="edge">
<title>layer_0_attn_tp_1&#45;&gt;layer_0_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M29342.3,-975.07C29379.02,-967.87 29417.63,-961.32 29454,-957 29703.5,-927.38 29767.79,-942.49 30019,-938 30124.73,-936.11 33720.55,-937.9 33826,-930 33945.92,-921.01 34079.32,-901.47 34184.93,-883.71"/>
<polygon fill="black" stroke="black" points="34185.79,-887.11 34195.06,-882 34184.62,-880.21 34185.79,-887.11"/>
</g>
<!-- layer_0_attn_tp_2 -->
<g id="node9" class="node">
<title>layer_0_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="30018.7,-1069 29576.94,-1069 29463.3,-965 29905.06,-965 30018.7,-1069"/>
<text text-anchor="middle" x="29741" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="29741" y="-1020" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="29741" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="29741" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_out_tp_2 -->
<g id="node13" class="node">
<title>layer_0_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="35361.7,-899 34919.94,-899 34806.3,-795 35248.06,-795 35361.7,-899"/>
<text text-anchor="middle" x="35084" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="35084" y="-850" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="35084" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="35084" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_tp_2&#45;&gt;layer_0_attn_out_tp_2 -->
<g id="edge17" class="edge">
<title>layer_0_attn_tp_2&#45;&gt;layer_0_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M29915.84,-974.5C29952.68,-967.33 29991.46,-960.92 30028,-957 30411.6,-915.86 31378.21,-940.64 31764,-938 31844.58,-937.45 34584.8,-937.89 34665,-930 34742.5,-922.38 34826.96,-907.2 34899.61,-891.96"/>
<polygon fill="black" stroke="black" points="34900.72,-895.3 34909.78,-889.81 34899.27,-888.45 34900.72,-895.3"/>
</g>
<!-- layer_0_attn_tp_3 -->
<g id="node10" class="node">
<title>layer_0_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="30592.7,-1069 30150.94,-1069 30037.3,-965 30479.06,-965 30592.7,-1069"/>
<text text-anchor="middle" x="30315" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="30315" y="-1020" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="30315" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="30315" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_out_tp_3 -->
<g id="node14" class="node">
<title>layer_0_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="36001.7,-899 35559.94,-899 35446.3,-795 35888.06,-795 36001.7,-899"/>
<text text-anchor="middle" x="35724" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="35724" y="-850" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="35724" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="35724" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_0_attn_tp_3&#45;&gt;layer_0_attn_out_tp_3 -->
<g id="edge19" class="edge">
<title>layer_0_attn_tp_3&#45;&gt;layer_0_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M30489.6,-974.3C30526.19,-967.17 30564.7,-960.83 30601,-957 30761.89,-940.05 33351.22,-938.88 33513,-938 33564.61,-937.72 35319.74,-935.99 35371,-930 35428.48,-923.29 35490.22,-910.81 35545.75,-897.58"/>
<polygon fill="black" stroke="black" points="35546.77,-900.94 35555.68,-895.19 35545.14,-894.13 35546.77,-900.94"/>
</g>
<!-- layer_{layer_id}_attn_allreduce -->
<g id="node1656" class="node">
<title>layer_{layer_id}_attn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="145238.7,-695 145033.97,-695 144981.3,-659 145186.03,-659 145238.7,-695"/>
<text text-anchor="middle" x="145110" y="-674.5" font-family="Arial" font-size="10.00">layer_{layer_id}_attn_allreduce</text>
</g>
<!-- layer_0_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge14" class="edge">
<title>layer_0_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M33734.45,-823.54C33839.9,-812.54 33972.39,-800.5 34091,-795 34091,-795 108129,-760 108129,-760 123862.23,-738.84 143360.52,-683.05 144999.23,-678.32"/>
<polygon fill="black" stroke="black" points="144999.52,-681.82 145009.51,-678.29 144999.5,-674.82 144999.52,-681.82"/>
</g>
<!-- layer_0_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge16" class="edge">
<title>layer_0_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M34567.36,-818.03C34639.12,-808.73 34721.66,-799.58 34797,-795 35052.51,-779.48 108265.01,-777.38 108521,-777 124083.51,-754.05 143369.25,-684.36 144999.17,-678.41"/>
<polygon fill="black" stroke="black" points="144999.41,-681.91 145009.39,-678.37 144999.38,-674.91 144999.41,-681.91"/>
</g>
<!-- layer_0_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge18" class="edge">
<title>layer_0_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M35269.41,-814.12C35323.29,-806.24 35382.34,-798.93 35437,-795 35595.12,-783.62 126588.48,-777.44 126747,-777 134412.72,-755.58 143878.31,-687.06 144999.84,-678.81"/>
<polygon fill="black" stroke="black" points="144999.93,-682.31 145009.91,-678.74 144999.88,-675.31 144999.93,-682.31"/>
</g>
<!-- layer_0_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge20" class="edge">
<title>layer_0_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M35907.17,-812.33C35953.9,-805.15 36004.17,-798.63 36051,-795 36223.78,-781.59 135699.7,-777.94 135873,-777 139626.7,-756.55 144238.09,-690.73 145000.83,-679.61"/>
<polygon fill="black" stroke="black" points="145001.03,-683.1 145010.98,-679.46 145000.93,-676.1 145001.03,-683.1"/>
</g>
<!-- layer_0_attn_allreduce -->
<g id="node15" class="node">
<title>layer_0_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="30807" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="30807" y="-1031" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="30807" y="-1020" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="30807" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="30807" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_gate_tp_0 -->
<g id="node16" class="node">
<title>layer_0_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="20659.99,-1069 20211.4,-1069 20096.01,-965 20544.6,-965 20659.99,-1069"/>
<text text-anchor="middle" x="20378" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="20378" y="-1020" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="20378" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="20378" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_0_route_ep_0 -->
<g id="node20" class="node">
<title>layer_0_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="8116.43,-899 7657.6,-899 7539.57,-795 7998.4,-795 8116.43,-899"/>
<text text-anchor="middle" x="7828" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="7828" y="-850" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="7828" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="7828" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_0 -->
<g id="edge21" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20147.11,-965C20126.86,-961.8 20106.61,-959.05 20087,-957 19946.09,-942.3 18953.64,-949.89 18812,-947 18690.63,-944.52 18660.38,-940.08 18539,-938 17824.22,-925.78 12819.85,-937.3 12105,-930 10572.86,-914.36 8732.4,-870.67 8075.67,-854.3"/>
<polygon fill="black" stroke="black" points="8075.7,-850.8 8065.61,-854.05 8075.52,-857.8 8075.7,-850.8"/>
<text text-anchor="middle" x="18838" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_1 -->
<g id="node21" class="node">
<title>layer_0_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="12690.43,-899 12231.6,-899 12113.57,-795 12572.4,-795 12690.43,-899"/>
<text text-anchor="middle" x="12402" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="12402" y="-850" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="12402" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="12402" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_1 -->
<g id="edge22" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20145.5,-964.96C20125.78,-961.82 20106.09,-959.09 20087,-957 19963.27,-943.47 19651.41,-950.76 19527,-947 19433.18,-944.16 19409.84,-940.14 19316,-938 18714.6,-924.29 17210.52,-936.75 16609,-930 15105.27,-913.12 13299.58,-870.37 12649.91,-854.26"/>
<polygon fill="black" stroke="black" points="12649.57,-850.75 12639.48,-854 12649.39,-857.75 12649.57,-850.75"/>
<text text-anchor="middle" x="19553" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_2 -->
<g id="node22" class="node">
<title>layer_0_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="28341.43,-899 27882.6,-899 27764.57,-795 28223.4,-795 28341.43,-899"/>
<text text-anchor="middle" x="28053" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="28053" y="-850" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="28053" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="28053" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_2 -->
<g id="edge23" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20555.28,-974.26C20592.63,-967.1 20631.95,-960.76 20669,-957 20792.78,-944.44 25023.6,-949.26 25148,-947 26146.13,-928.88 27336.37,-879.65 27825.77,-858.21"/>
<polygon fill="black" stroke="black" points="27825.94,-861.7 27835.78,-857.77 27825.63,-854.71 27825.94,-861.7"/>
<text text-anchor="middle" x="25569" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_3 -->
<g id="node23" class="node">
<title>layer_0_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="32713.43,-899 32254.6,-899 32136.57,-795 32595.4,-795 32713.43,-899"/>
<text text-anchor="middle" x="32425" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="32425" y="-850" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="32425" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="32425" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_3 -->
<g id="edge24" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20555.27,-974.23C20592.63,-967.07 20631.94,-960.74 20669,-957 20775.26,-946.27 28252.25,-950.47 28359,-947 28421.76,-944.96 28437.26,-940.72 28500,-938 29897.87,-877.39 31577.67,-856.11 32188.44,-850.06"/>
<polygon fill="black" stroke="black" points="32188.72,-853.56 32198.68,-849.96 32188.65,-846.56 32188.72,-853.56"/>
<text text-anchor="middle" x="28526" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_4 -->
<g id="node24" class="node">
<title>layer_0_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="20523.43,-899 20064.6,-899 19946.57,-795 20405.4,-795 20523.43,-899"/>
<text text-anchor="middle" x="20235" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="20235" y="-850" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="20235" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="20235" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_4 -->
<g id="edge25" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20334.32,-964.68C20318.73,-946.36 20301.04,-925.59 20284.96,-906.69"/>
<polygon fill="black" stroke="black" points="20287.56,-904.35 20278.41,-899 20282.23,-908.89 20287.56,-904.35"/>
<text text-anchor="middle" x="20341" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_5 -->
<g id="node25" class="node">
<title>layer_0_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="3612.43,-899 3153.6,-899 3035.57,-795 3494.4,-795 3612.43,-899"/>
<text text-anchor="middle" x="3324" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="3324" y="-850" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="3324" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="3324" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_5 -->
<g id="edge26" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20147.52,-964.95C20127.13,-961.74 20106.74,-959.01 20087,-957 19977.59,-945.88 16237.97,-947.33 16128,-947 14988,-943.56 14703,-940.76 13563,-938 12892.78,-936.38 8201.19,-936.98 7531,-930 6027.48,-914.35 4222.12,-870.86 3572.2,-854.41"/>
<polygon fill="black" stroke="black" points="3571.86,-850.9 3561.77,-854.15 3571.68,-857.9 3571.86,-850.9"/>
<text text-anchor="middle" x="16154" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_6 -->
<g id="node26" class="node">
<title>layer_0_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="23880.43,-899 23421.6,-899 23303.57,-795 23762.4,-795 23880.43,-899"/>
<text text-anchor="middle" x="23592" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="23592" y="-850" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="23592" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="23592" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_6 -->
<g id="edge27" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20556.15,-974.99C20593.26,-967.83 20632.27,-961.3 20669,-957 20801.94,-941.43 20836.25,-952.16 20970,-947 21061.13,-943.49 21083.88,-941.7 21175,-938 21978.43,-905.41 22932.28,-871.22 23361.98,-856.06"/>
<polygon fill="black" stroke="black" points="23362.16,-859.55 23372.03,-855.7 23361.91,-852.56 23362.16,-859.55"/>
<text text-anchor="middle" x="21201" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_route_ep_7 -->
<g id="node27" class="node">
<title>layer_0_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="17194.43,-899 16735.6,-899 16617.57,-795 17076.4,-795 17194.43,-899"/>
<text text-anchor="middle" x="16906" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="16906" y="-850" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="16906" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="16906" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_7 -->
<g id="edge28" class="edge">
<title>layer_0_gate_tp_0&#45;&gt;layer_0_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20139.03,-964.96C20121.47,-962.01 20103.98,-959.31 20087,-957 20023.87,-948.43 20007.54,-951.67 19944,-947 19891.99,-943.18 19879.08,-940.8 19827,-938 18835.77,-884.63 17653.49,-860.27 17151.18,-851.75"/>
<polygon fill="black" stroke="black" points="17150.96,-848.25 17140.9,-851.58 17150.84,-855.24 17150.96,-848.25"/>
<text text-anchor="middle" x="19970" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1 -->
<g id="node17" class="node">
<title>layer_0_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="20077.99,-1069 19629.4,-1069 19514.01,-965 19962.6,-965 20077.99,-1069"/>
<text text-anchor="middle" x="19796" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="19796" y="-1020" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="19796" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="19796" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_0 -->
<g id="edge29" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19565.12,-964.97C19544.86,-961.78 19524.61,-959.03 19505,-957 19425.67,-948.77 16713.75,-938.33 16634,-938 15627.56,-933.78 13111.39,-940.54 12105,-930 10572.87,-913.96 8732.4,-870.52 8075.67,-854.26"/>
<polygon fill="black" stroke="black" points="8075.7,-850.76 8065.61,-854.01 8075.52,-857.75 8075.7,-850.76"/>
<text text-anchor="middle" x="18509" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_1 -->
<g id="edge30" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19560.67,-964.99C19541.89,-961.93 19523.17,-959.2 19505,-957 19498.62,-956.23 19049.42,-938.14 19043,-938 18502.24,-926 17149.86,-936.16 16609,-930 15105.27,-912.88 13299.58,-870.27 12649.91,-854.23"/>
<polygon fill="black" stroke="black" points="12649.57,-850.73 12639.48,-853.98 12649.39,-857.72 12649.57,-850.73"/>
<text text-anchor="middle" x="19286" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_2 -->
<g id="edge31" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19973.29,-974.4C20010.64,-967.23 20049.96,-960.85 20087,-957 20100.13,-955.64 23875.8,-930.18 23889,-930 25387.44,-909.93 27188.88,-868.61 27820.57,-853.6"/>
<polygon fill="black" stroke="black" points="27820.79,-857.1 27830.7,-853.36 27820.62,-850.1 27820.79,-857.1"/>
<text text-anchor="middle" x="22682" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_3 -->
<g id="edge32" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19973.27,-974.23C20010.63,-967.08 20049.94,-960.74 20087,-957 20185.9,-947.01 27144.6,-947.83 27244,-947 27735.6,-942.88 27858.46,-938.72 28350,-930 29811.79,-904.06 31568.41,-866.58 32191.76,-853.08"/>
<polygon fill="black" stroke="black" points="32192.29,-856.57 32202.21,-852.85 32192.14,-849.57 32192.29,-856.57"/>
<text text-anchor="middle" x="27934" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_4 -->
<g id="edge33" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19976.49,-977.43C20012.99,-970.19 20051.16,-963.02 20087,-957 20120.16,-951.43 20133.05,-964.12 20162,-947 20178.21,-937.42 20191.91,-922.69 20202.91,-907.5"/>
<polygon fill="black" stroke="black" points="20205.95,-909.26 20208.74,-899.05 20200.18,-905.29 20205.95,-909.26"/>
<text text-anchor="middle" x="20198" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_5 -->
<g id="edge34" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19565.92,-964.99C19545.4,-961.77 19524.87,-959.01 19505,-957 19422.17,-948.62 13594.25,-947.19 13511,-947 12182.11,-944 8859.81,-944.84 7531,-930 6027.27,-913.21 4221.58,-870.4 3571.91,-854.27"/>
<polygon fill="black" stroke="black" points="3571.57,-850.76 3561.48,-854.01 3571.39,-857.76 3571.57,-850.76"/>
<text text-anchor="middle" x="13537" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_6 -->
<g id="edge35" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19973.31,-974.59C20010.66,-967.4 20049.97,-960.97 20087,-957 20248.53,-939.67 20655.77,-955.7 20818,-947 20860.79,-944.71 20871.23,-940.72 20914,-938 21815.55,-880.64 22890.3,-858.52 23356.72,-851.18"/>
<polygon fill="black" stroke="black" points="23357,-854.67 23366.95,-851.02 23356.89,-847.67 23357,-854.67"/>
<text text-anchor="middle" x="20940" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_7 -->
<g id="edge36" class="edge">
<title>layer_0_gate_tp_1&#45;&gt;layer_0_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19784.04,-964.72C19779.22,-954.26 19772.46,-944.49 19763,-938 19656.02,-864.65 17817.56,-851.08 17147.67,-848.57"/>
<polygon fill="black" stroke="black" points="17147.42,-845.07 17137.41,-848.53 17147.39,-852.07 17147.42,-845.07"/>
<text text-anchor="middle" x="19797" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2 -->
<g id="node18" class="node">
<title>layer_0_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="21241.99,-1069 20793.4,-1069 20678.01,-965 21126.6,-965 21241.99,-1069"/>
<text text-anchor="middle" x="20960" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="20960" y="-1020" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="20960" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="20960" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_0 -->
<g id="edge37" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20729.12,-964.95C20708.86,-961.76 20688.61,-959.02 20669,-957 20570.47,-946.83 18983.14,-966.38 18886,-947 18875.64,-944.93 18874.36,-940.04 18864,-938 18817.95,-928.92 12151.94,-930.48 12105,-930 10572.86,-914.41 8732.4,-870.69 8075.67,-854.31"/>
<polygon fill="black" stroke="black" points="8075.7,-850.81 8065.61,-854.05 8075.52,-857.8 8075.7,-850.81"/>
<text text-anchor="middle" x="18912" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_1 -->
<g id="edge38" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20728.71,-964.97C20708.59,-961.79 20688.48,-959.05 20669,-957 20609.99,-950.8 19659.17,-958.72 19601,-947 19590.64,-944.91 19589.36,-940.05 19579,-938 19538.54,-929.99 16650.25,-930.46 16609,-930 15105.26,-913.32 13299.58,-870.44 12649.91,-854.29"/>
<polygon fill="black" stroke="black" points="12649.57,-850.78 12639.48,-854.03 12649.39,-857.77 12649.57,-850.78"/>
<text text-anchor="middle" x="19627" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_2 -->
<g id="edge39" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21178.12,-1011.23C21720.82,-999.58 23175.57,-969.72 24389,-957 24684.87,-953.9 26756.5,-962.13 27052,-947 27325.99,-932.97 27640.66,-898.88 27842.91,-874.63"/>
<polygon fill="black" stroke="black" points="27843.54,-878.08 27853.05,-873.41 27842.71,-871.13 27843.54,-878.08"/>
<text text-anchor="middle" x="27214" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_3 -->
<g id="edge40" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21178.12,-1011.13C21720.81,-999.25 23175.56,-968.89 24389,-957 25314.96,-947.92 27630.09,-959.96 28556,-947 28647.25,-945.72 31371.57,-875.28 32192.88,-854.01"/>
<polygon fill="black" stroke="black" points="32193.15,-857.51 32203.05,-853.75 32192.96,-850.51 32193.15,-857.51"/>
<text text-anchor="middle" x="28883" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_4 -->
<g id="edge41" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20739.52,-964.91C20652.69,-944.79 20552.94,-921.67 20465.18,-901.34"/>
<polygon fill="black" stroke="black" points="20465.9,-897.91 20455.36,-899.06 20464.32,-904.73 20465.9,-897.91"/>
<text text-anchor="middle" x="20666" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_5 -->
<g id="edge42" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20729.52,-964.94C20709.13,-961.74 20688.74,-959 20669,-957 20607.28,-950.74 16262.86,-959.04 16202,-947 16191.64,-944.95 16190.36,-940.04 16180,-938 16150.54,-932.19 7561.03,-930.31 7531,-930 6027.48,-914.65 4222.12,-870.98 3572.2,-854.45"/>
<polygon fill="black" stroke="black" points="3571.86,-850.94 3561.77,-854.18 3571.68,-857.93 3571.86,-850.94"/>
<text text-anchor="middle" x="16228" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_6 -->
<g id="edge43" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21130.42,-968.44C21179.9,-956.45 21234.27,-945.01 21285,-938 21679.59,-883.49 22852.1,-859.37 23356.73,-851.31"/>
<polygon fill="black" stroke="black" points="23357.11,-854.81 23367.05,-851.15 23357,-847.81 23357.11,-854.81"/>
<text text-anchor="middle" x="21311" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_7 -->
<g id="edge44" class="edge">
<title>layer_0_gate_tp_2&#45;&gt;layer_0_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20727.9,-964.98C20708.05,-961.82 20688.22,-959.08 20669,-957 20528.25,-941.76 20172.37,-965.4 20032,-947 20015.65,-944.86 20012.34,-940.25 19996,-938 19447.29,-862.33 17774.5,-850.17 17147.1,-848.3"/>
<polygon fill="black" stroke="black" points="17147.04,-844.8 17137.03,-848.28 17147.02,-851.8 17147.04,-844.8"/>
<text text-anchor="middle" x="20058" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3 -->
<g id="node19" class="node">
<title>layer_0_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="19495.99,-1069 19047.4,-1069 18932.01,-965 19380.6,-965 19495.99,-1069"/>
<text text-anchor="middle" x="19214" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="19214" y="-1020" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="19214" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="19214" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_0 -->
<g id="edge45" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18988.21,-1015.72C17479.13,-1013.72 8899.67,-1000.04 8352,-947 8255.42,-937.65 8150.09,-919.36 8059.37,-901.02"/>
<polygon fill="black" stroke="black" points="8060.01,-897.58 8049.51,-899.02 8058.61,-904.44 8060.01,-897.58"/>
<text text-anchor="middle" x="8378" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_1 -->
<g id="edge46" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18981.2,-1009.62C18482.15,-995.98 17272.24,-963.22 16258,-938 14894.85,-904.11 13260.54,-867.19 12648.94,-853.5"/>
<polygon fill="black" stroke="black" points="12648.75,-850 12638.67,-853.27 12648.59,-857 12648.75,-850"/>
<text text-anchor="middle" x="16604" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_2 -->
<g id="edge47" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19391.3,-974.43C19428.65,-967.26 19467.96,-960.87 19505,-957 19636.62,-943.23 20564,-956.52 20696,-947 20725.53,-944.87 20732.47,-940.04 20762,-938 20935.31,-926.02 23715.29,-931.93 23889,-930 25387.71,-913.33 27189.44,-869.89 27820.86,-853.97"/>
<polygon fill="black" stroke="black" points="27821.08,-857.46 27830.99,-853.71 27820.9,-850.46 27821.08,-857.46"/>
<text text-anchor="middle" x="20788" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_3 -->
<g id="edge48" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19391.29,-974.35C19428.64,-967.18 19467.95,-960.82 19505,-957 19606.24,-946.56 21236.11,-960.41 21337,-947 21352.5,-944.94 21355.5,-940.03 21371,-938 21419.06,-931.72 28301.54,-930.52 28350,-930 29812.82,-914.45 31570.58,-870.54 32192.9,-854.21"/>
<polygon fill="black" stroke="black" points="32193.43,-857.7 32203.33,-853.94 32193.24,-850.7 32193.43,-857.7"/>
<text text-anchor="middle" x="21397" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_4 -->
<g id="edge49" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19392.65,-975.84C19429.64,-968.64 19468.47,-961.88 19505,-957 19572.1,-948.03 19589.77,-954.95 19657,-947 19676.14,-944.74 19874.94,-910.5 20034.12,-882.92"/>
<polygon fill="black" stroke="black" points="20034.81,-886.35 20044.06,-881.19 20033.61,-879.45 20034.81,-886.35"/>
<text text-anchor="middle" x="19733" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_5 -->
<g id="edge50" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18988.17,-1015.75C17841.94,-1014.24 12553.05,-1004.32 8224,-947 6439.75,-923.38 4290.48,-872.02 3571.63,-854.22"/>
<polygon fill="black" stroke="black" points="3571.49,-850.72 3561.41,-853.97 3571.32,-857.72 3571.49,-850.72"/>
<text text-anchor="middle" x="8250" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_6 -->
<g id="edge51" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19391.71,-974.61C19428.94,-967.45 19468.1,-961.02 19505,-957 19568.96,-950.02 20020.98,-959.96 20084,-947 20094.35,-944.87 20095.65,-940.14 20106,-938 20152.36,-928.43 20484.67,-931.08 20532,-930 21588.59,-905.92 22850.2,-869.77 23360.68,-854.83"/>
<polygon fill="black" stroke="black" points="23360.85,-858.33 23370.74,-854.54 23360.65,-851.33 23360.85,-858.33"/>
<text text-anchor="middle" x="20132" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_7 -->
<g id="edge52" class="edge">
<title>layer_0_gate_tp_3&#45;&gt;layer_0_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19059.73,-964.96C19021.64,-954.26 18980.67,-944.31 18942,-938 18604.24,-882.9 17614.35,-859.68 17150.77,-851.62"/>
<polygon fill="black" stroke="black" points="17150.66,-848.12 17140.6,-851.45 17150.54,-855.12 17150.66,-848.12"/>
<text text-anchor="middle" x="19013" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_0_expert_0_ep_0 -->
<g id="node28" class="node">
<title>layer_0_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="5073.83,-729 4639.82,-729 4528.17,-625 4962.18,-625 5073.83,-729"/>
<text text-anchor="middle" x="4801" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="4801" y="-680" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4801" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="4801" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_0_ep_0 -->
<g id="edge53" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M7597.54,-846.25C7027.64,-845.68 5563.58,-836.54 5082,-760 5041.78,-753.61 4999.2,-743.18 4959.68,-731.87"/>
<polygon fill="black" stroke="black" points="4960.55,-728.48 4949.97,-729.06 4958.6,-735.2 4960.55,-728.48"/>
</g>
<!-- layer_0_expert_1_ep_0 -->
<g id="node29" class="node">
<title>layer_0_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="5636.83,-729 5202.82,-729 5091.17,-625 5525.18,-625 5636.83,-729"/>
<text text-anchor="middle" x="5364" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="5364" y="-680" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="5364" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="5364" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_1_ep_0 -->
<g id="edge54" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M7595.11,-844.01C7111.85,-838.71 6014.43,-820.24 5645,-760 5605.12,-753.5 5562.9,-743.12 5523.65,-731.91"/>
<polygon fill="black" stroke="black" points="5524.32,-728.46 5513.74,-729.04 5522.37,-735.18 5524.32,-728.46"/>
</g>
<!-- layer_0_expert_2_ep_0 -->
<g id="node30" class="node">
<title>layer_0_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="6199.83,-729 5765.82,-729 5654.17,-625 6088.18,-625 6199.83,-729"/>
<text text-anchor="middle" x="5927" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="5927" y="-680" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="5927" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="5927" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_2_ep_0 -->
<g id="edge55" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M7590.72,-840.13C7206.88,-829.5 6466.66,-804 6208,-760 6168.63,-753.3 6126.95,-742.99 6088.08,-731.91"/>
<polygon fill="black" stroke="black" points="6088.85,-728.49 6078.27,-729.08 6086.91,-735.21 6088.85,-728.49"/>
</g>
<!-- layer_0_expert_3_ep_0 -->
<g id="node31" class="node">
<title>layer_0_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="6762.83,-729 6328.82,-729 6217.17,-625 6651.18,-625 6762.83,-729"/>
<text text-anchor="middle" x="6490" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="6490" y="-680" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="6490" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="6490" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_3_ep_0 -->
<g id="edge56" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M7591.1,-840.44C7375.69,-832.14 7049.82,-811.47 6771,-760 6732.53,-752.9 6691.79,-742.65 6653.62,-731.8"/>
<polygon fill="black" stroke="black" points="6654.55,-728.42 6643.98,-729.03 6652.62,-735.15 6654.55,-728.42"/>
</g>
<!-- layer_0_expert_4_ep_0 -->
<g id="node32" class="node">
<title>layer_0_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="7325.83,-729 6891.82,-729 6780.17,-625 7214.18,-625 7325.83,-729"/>
<text text-anchor="middle" x="7053" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="7053" y="-680" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="7053" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="7053" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_4_ep_0 -->
<g id="edge57" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M7548.33,-802.91C7478.05,-790.55 7403,-776.02 7334,-760 7298.93,-751.86 7261.76,-741.94 7226.32,-731.86"/>
<polygon fill="black" stroke="black" points="7226.95,-728.4 7216.38,-729.01 7225.03,-735.13 7226.95,-728.4"/>
</g>
<!-- layer_0_expert_5_ep_0 -->
<g id="node33" class="node">
<title>layer_0_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="7888.83,-729 7454.82,-729 7343.17,-625 7777.18,-625 7888.83,-729"/>
<text text-anchor="middle" x="7616" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="7616" y="-680" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="7616" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="7616" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_5_ep_0 -->
<g id="edge58" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M7763.53,-794.91C7739.89,-776.18 7712.97,-754.85 7688.66,-735.58"/>
<polygon fill="black" stroke="black" points="7690.54,-732.6 7680.53,-729.14 7686.19,-738.09 7690.54,-732.6"/>
</g>
<!-- layer_0_expert_6_ep_0 -->
<g id="node34" class="node">
<title>layer_0_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="8451.83,-729 8017.82,-729 7906.17,-625 8340.18,-625 8451.83,-729"/>
<text text-anchor="middle" x="8179" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="8179" y="-680" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="8179" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="8179" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_6_ep_0 -->
<g id="edge59" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M7934.74,-794.91C7975.33,-775.48 8021.74,-753.27 8063.14,-733.46"/>
<polygon fill="black" stroke="black" points="8064.65,-736.61 8072.16,-729.14 8061.63,-730.3 8064.65,-736.61"/>
</g>
<!-- layer_0_expert_7_ep_0 -->
<g id="node35" class="node">
<title>layer_0_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="9014.83,-729 8580.82,-729 8469.17,-625 8903.18,-625 9014.83,-729"/>
<text text-anchor="middle" x="8742" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="8742" y="-680" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="8742" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="8742" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_0&#45;&gt;layer_0_expert_7_ep_0 -->
<g id="edge60" class="edge">
<title>layer_0_route_ep_0&#45;&gt;layer_0_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M8033.52,-825.92C8158.02,-811.82 8319.57,-790.07 8461,-760 8497.39,-752.26 8535.95,-742.25 8572.46,-731.88"/>
<polygon fill="black" stroke="black" points="8573.54,-735.22 8582.19,-729.1 8571.61,-728.48 8573.54,-735.22"/>
</g>
<!-- layer_0_expert_0_ep_1 -->
<g id="node36" class="node">
<title>layer_0_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="9577.83,-729 9143.82,-729 9032.17,-625 9466.18,-625 9577.83,-729"/>
<text text-anchor="middle" x="9305" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="9305" y="-680" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="9305" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="9305" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_0_ep_1 -->
<g id="edge61" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M12171.79,-846.47C11591.81,-846.44 10081.61,-838.57 9586,-760 9545.77,-753.62 9503.2,-743.2 9463.68,-731.89"/>
<polygon fill="black" stroke="black" points="9464.55,-728.5 9453.97,-729.08 9462.6,-735.23 9464.55,-728.5"/>
</g>
<!-- layer_0_expert_1_ep_1 -->
<g id="node37" class="node">
<title>layer_0_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="10140.83,-729 9706.82,-729 9595.17,-625 10029.18,-625 10140.83,-729"/>
<text text-anchor="middle" x="9868" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="9868" y="-680" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="9868" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="9868" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_1_ep_1 -->
<g id="edge62" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M12169.17,-844.35C11674.39,-839.67 10532.23,-822.25 10149,-760 10109.12,-753.52 10066.9,-743.16 10027.65,-731.94"/>
<polygon fill="black" stroke="black" points="10028.31,-728.49 10017.73,-729.08 10026.37,-735.22 10028.31,-728.49"/>
</g>
<!-- layer_0_expert_2_ep_1 -->
<g id="node38" class="node">
<title>layer_0_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="10703.83,-729 10269.82,-729 10158.17,-625 10592.18,-625 10703.83,-729"/>
<text text-anchor="middle" x="10431" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="10431" y="-680" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="10431" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="10431" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_2_ep_1 -->
<g id="edge63" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M12165.26,-840.76C11768.09,-830.82 10984.3,-806.01 10712,-760 10672.5,-753.33 10630.69,-742.99 10591.73,-731.88"/>
<polygon fill="black" stroke="black" points="10592.47,-728.45 10581.89,-729.04 10590.53,-735.17 10592.47,-728.45"/>
</g>
<!-- layer_0_expert_3_ep_1 -->
<g id="node39" class="node">
<title>layer_0_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="11266.83,-729 10832.82,-729 10721.17,-625 11155.18,-625 11266.83,-729"/>
<text text-anchor="middle" x="10994" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="10994" y="-680" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="10994" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="10994" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_3_ep_1 -->
<g id="edge64" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M12167.08,-842.25C11937.84,-835.27 11580.03,-815.52 11275,-760 11236.4,-752.97 11195.52,-742.73 11157.25,-731.84"/>
<polygon fill="black" stroke="black" points="11158.16,-728.46 11147.58,-729.06 11156.23,-735.19 11158.16,-728.46"/>
</g>
<!-- layer_0_expert_4_ep_1 -->
<g id="node40" class="node">
<title>layer_0_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="11829.83,-729 11395.82,-729 11284.17,-625 11718.18,-625 11829.83,-729"/>
<text text-anchor="middle" x="11557" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="11557" y="-680" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="11557" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="11557" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_4_ep_1 -->
<g id="edge65" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M12133.12,-812.42C12039.25,-798.74 11933.5,-781.12 11838,-760 11802.13,-752.07 11764.11,-742.08 11728.02,-731.82"/>
<polygon fill="black" stroke="black" points="11728.97,-728.45 11718.39,-729.07 11727.04,-735.18 11728.97,-728.45"/>
</g>
<!-- layer_0_expert_5_ep_1 -->
<g id="node41" class="node">
<title>layer_0_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="12392.83,-729 11958.82,-729 11847.17,-625 12281.18,-625 12392.83,-729"/>
<text text-anchor="middle" x="12120" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="12120" y="-680" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="12120" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="12120" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_5_ep_1 -->
<g id="edge66" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M12316.24,-794.91C12284.11,-775.77 12247.44,-753.92 12214.55,-734.33"/>
<polygon fill="black" stroke="black" points="12216.22,-731.25 12205.84,-729.14 12212.64,-737.26 12216.22,-731.25"/>
</g>
<!-- layer_0_expert_6_ep_1 -->
<g id="node42" class="node">
<title>layer_0_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="12955.83,-729 12521.82,-729 12410.17,-625 12844.18,-625 12955.83,-729"/>
<text text-anchor="middle" x="12683" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="12683" y="-680" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="12683" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="12683" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_6_ep_1 -->
<g id="edge67" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M12487.45,-794.91C12519.47,-775.77 12556.02,-753.92 12588.78,-734.33"/>
<polygon fill="black" stroke="black" points="12590.68,-737.27 12597.47,-729.14 12587.09,-731.26 12590.68,-737.27"/>
</g>
<!-- layer_0_expert_7_ep_1 -->
<g id="node43" class="node">
<title>layer_0_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="13518.83,-729 13084.82,-729 12973.17,-625 13407.18,-625 13518.83,-729"/>
<text text-anchor="middle" x="13246" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="13246" y="-680" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="13246" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="13246" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_1&#45;&gt;layer_0_expert_7_ep_1 -->
<g id="edge68" class="edge">
<title>layer_0_route_ep_1&#45;&gt;layer_0_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M12603.18,-821.85C12711.1,-807.24 12846.01,-786.33 12965,-760 13000.87,-752.06 13038.89,-742.07 13074.98,-731.82"/>
<polygon fill="black" stroke="black" points="13075.96,-735.18 13084.61,-729.06 13074.03,-728.45 13075.96,-735.18"/>
</g>
<!-- layer_0_expert_0_ep_2 -->
<g id="node44" class="node">
<title>layer_0_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="27593.83,-729 27159.82,-729 27048.17,-625 27482.18,-625 27593.83,-729"/>
<text text-anchor="middle" x="27321" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="27321" y="-680" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="27321" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="27321" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_0_ep_2 -->
<g id="edge69" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M27764.92,-795.32C27710.6,-784.56 27654.41,-772.61 27602,-760 27567.56,-751.71 27531.05,-741.86 27496.14,-731.91"/>
<polygon fill="black" stroke="black" points="27496.92,-728.49 27486.34,-729.1 27494.99,-735.22 27496.92,-728.49"/>
</g>
<!-- layer_0_expert_1_ep_2 -->
<g id="node45" class="node">
<title>layer_0_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="28156.83,-729 27722.82,-729 27611.17,-625 28045.18,-625 28156.83,-729"/>
<text text-anchor="middle" x="27884" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="27884" y="-680" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="27884" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="27884" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_1_ep_2 -->
<g id="edge70" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M28001.38,-794.68C27982.78,-776.2 27961.68,-755.22 27942.54,-736.19"/>
<polygon fill="black" stroke="black" points="27944.87,-733.57 27935.31,-729 27939.93,-738.54 27944.87,-733.57"/>
</g>
<!-- layer_0_expert_2_ep_2 -->
<g id="node46" class="node">
<title>layer_0_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="28719.83,-729 28285.82,-729 28174.17,-625 28608.18,-625 28719.83,-729"/>
<text text-anchor="middle" x="28447" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="28447" y="-680" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="28447" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="28447" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_2_ep_2 -->
<g id="edge71" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M28172.82,-794.91C28218.66,-775.36 28271.13,-752.99 28317.82,-733.08"/>
<polygon fill="black" stroke="black" points="28319.25,-736.28 28327.07,-729.14 28316.5,-729.84 28319.25,-736.28"/>
</g>
<!-- layer_0_expert_3_ep_2 -->
<g id="node47" class="node">
<title>layer_0_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="29282.83,-729 28848.82,-729 28737.17,-625 29171.18,-625 29282.83,-729"/>
<text text-anchor="middle" x="29010" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="29010" y="-680" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="29010" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="29010" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_3_ep_2 -->
<g id="edge72" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M28261.13,-828.07C28395.52,-814.4 28573.65,-792.34 28729,-760 28765.77,-752.35 28804.72,-742.28 28841.54,-731.83"/>
<polygon fill="black" stroke="black" points="28842.7,-735.14 28851.35,-729.02 28840.77,-728.41 28842.7,-735.14"/>
</g>
<!-- layer_0_expert_4_ep_2 -->
<g id="node48" class="node">
<title>layer_0_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="29845.83,-729 29411.82,-729 29300.17,-625 29734.18,-625 29845.83,-729"/>
<text text-anchor="middle" x="29573" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="29573" y="-680" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="29573" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="29573" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_4_ep_2 -->
<g id="edge73" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M28280.02,-844.79C28529.86,-840.1 28942.42,-822.39 29292,-760 29330.86,-753.07 29372,-742.79 29410.47,-731.84"/>
<polygon fill="black" stroke="black" points="29411.54,-735.17 29420.19,-729.04 29409.61,-728.45 29411.54,-735.17"/>
</g>
<!-- layer_0_expert_5_ep_2 -->
<g id="node49" class="node">
<title>layer_0_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="30408.83,-729 29974.82,-729 29863.17,-625 30297.18,-625 30408.83,-729"/>
<text text-anchor="middle" x="30136" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="30136" y="-680" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="30136" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="30136" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_5_ep_2 -->
<g id="edge74" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M28276.94,-841.91C28690.28,-833.26 29557.97,-809.71 29855,-760 29894.62,-753.37 29936.57,-743.01 29975.63,-731.87"/>
<polygon fill="black" stroke="black" points="29976.85,-735.16 29985.49,-729.02 29974.91,-728.43 29976.85,-735.16"/>
</g>
<!-- layer_0_expert_6_ep_2 -->
<g id="node50" class="node">
<title>layer_0_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="30971.83,-729 30537.82,-729 30426.17,-625 30860.18,-625 30971.83,-729"/>
<text text-anchor="middle" x="30699" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="30699" y="-680" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="30699" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="30699" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_6_ep_2 -->
<g id="edge75" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M28280.46,-844.89C28790.22,-841.24 30011.25,-825.7 30418,-760 30458.01,-753.54 30500.35,-743.15 30539.7,-731.9"/>
<polygon fill="black" stroke="black" points="30541.01,-735.16 30549.64,-729.02 30539.06,-728.44 30541.01,-735.16"/>
</g>
<!-- layer_0_expert_7_ep_2 -->
<g id="node51" class="node">
<title>layer_0_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="31534.83,-729 31100.82,-729 30989.17,-625 31423.18,-625 31534.83,-729"/>
<text text-anchor="middle" x="31262" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="31262" y="-680" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="31262" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="31262" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_2&#45;&gt;layer_0_expert_7_ep_2 -->
<g id="edge76" class="edge">
<title>layer_0_route_ep_2&#45;&gt;layer_0_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M28282.26,-846.79C28877.67,-847.63 30462.74,-841.85 30981,-760 31021.35,-753.63 31064.05,-743.17 31103.67,-731.83"/>
<polygon fill="black" stroke="black" points="31104.77,-735.15 31113.4,-729.01 31102.82,-728.43 31104.77,-735.15"/>
</g>
<!-- layer_0_expert_0_ep_3 -->
<g id="node52" class="node">
<title>layer_0_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="32097.83,-729 31663.82,-729 31552.17,-625 31986.18,-625 32097.83,-729"/>
<text text-anchor="middle" x="31825" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="31825" y="-680" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="31825" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="31825" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_0_ep_3 -->
<g id="edge77" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M32232.94,-794.91C32191.06,-783.58 32147,-771.51 32106,-760 32074.16,-751.06 32040.35,-741.37 32007.63,-731.89"/>
<polygon fill="black" stroke="black" points="32008.55,-728.51 31997.97,-729.08 32006.6,-735.23 32008.55,-728.51"/>
</g>
<!-- layer_0_expert_1_ep_3 -->
<g id="node53" class="node">
<title>layer_0_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="32660.83,-729 32226.82,-729 32115.17,-625 32549.18,-625 32660.83,-729"/>
<text text-anchor="middle" x="32388" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="32388" y="-680" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="32388" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="32388" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_1_ep_3 -->
<g id="edge78" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M32413.7,-794.68C32409.82,-777.1 32405.45,-757.24 32401.43,-738.97"/>
<polygon fill="black" stroke="black" points="32404.8,-738.02 32399.23,-729 32397.97,-739.52 32404.8,-738.02"/>
</g>
<!-- layer_0_expert_2_ep_3 -->
<g id="node54" class="node">
<title>layer_0_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="33223.83,-729 32789.82,-729 32678.17,-625 33112.18,-625 33223.83,-729"/>
<text text-anchor="middle" x="32951" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="32951" y="-680" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="32951" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="32951" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_2_ep_3 -->
<g id="edge79" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M32584.96,-794.91C32647.06,-775.08 32718.26,-752.34 32781.26,-732.21"/>
<polygon fill="black" stroke="black" points="32782.43,-735.51 32790.89,-729.14 32780.3,-728.84 32782.43,-735.51"/>
</g>
<!-- layer_0_expert_3_ep_3 -->
<g id="node55" class="node">
<title>layer_0_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="33786.83,-729 33352.82,-729 33241.17,-625 33675.18,-625 33786.83,-729"/>
<text text-anchor="middle" x="33514" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="33514" y="-680" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="33514" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="33514" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_3_ep_3 -->
<g id="edge80" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M32639.63,-833.59C32803.36,-821.61 33033.88,-799.32 33233,-760 33270.41,-752.61 33310.04,-742.51 33347.37,-731.92"/>
<polygon fill="black" stroke="black" points="33348.66,-735.19 33357.31,-729.07 33346.74,-728.46 33348.66,-735.19"/>
</g>
<!-- layer_0_expert_4_ep_3 -->
<g id="node56" class="node">
<title>layer_0_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="34349.83,-729 33915.82,-729 33804.17,-625 34238.18,-625 34349.83,-729"/>
<text text-anchor="middle" x="34077" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="34077" y="-680" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="34077" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="34077" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_4_ep_3 -->
<g id="edge81" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M32638.27,-832.77C33021.79,-808.96 33788.95,-761.23 33796,-760 33835.11,-753.15 33876.52,-742.85 33915.19,-731.83"/>
<polygon fill="black" stroke="black" points="33916.31,-735.15 33924.95,-729.02 33914.37,-728.43 33916.31,-735.15"/>
</g>
<!-- layer_0_expert_5_ep_3 -->
<g id="node57" class="node">
<title>layer_0_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="34912.83,-729 34478.82,-729 34367.17,-625 34801.18,-625 34912.83,-729"/>
<text text-anchor="middle" x="34640" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="34640" y="-680" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="34640" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="34640" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_5_ep_3 -->
<g id="edge82" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M32636.51,-831.2C32803.54,-819.94 33042.57,-804.77 33252,-795 33497.86,-783.54 34115.93,-798.67 34359,-760 34399.22,-753.6 34441.8,-743.17 34481.32,-731.86"/>
<polygon fill="black" stroke="black" points="34482.39,-735.2 34491.03,-729.05 34480.45,-728.47 34482.39,-735.2"/>
</g>
<!-- layer_0_expert_6_ep_3 -->
<g id="node58" class="node">
<title>layer_0_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="35475.83,-729 35041.82,-729 34930.17,-625 35364.18,-625 35475.83,-729"/>
<text text-anchor="middle" x="35203" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="35203" y="-680" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="35203" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="35203" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_6_ep_3 -->
<g id="edge83" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M32636.05,-830.44C32803.08,-818.75 33042.33,-803.35 33252,-795 33622.9,-780.22 34555.23,-817.16 34922,-760 34962.47,-753.69 35005.32,-743.23 35045.03,-731.85"/>
<polygon fill="black" stroke="black" points="35046.15,-735.17 35054.78,-729.02 35044.2,-728.44 35046.15,-735.17"/>
</g>
<!-- layer_0_expert_7_ep_3 -->
<g id="node59" class="node">
<title>layer_0_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="36038.83,-729 35604.82,-729 35493.17,-625 35927.18,-625 36038.83,-729"/>
<text text-anchor="middle" x="35766" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="35766" y="-680" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="35766" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="35766" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_3&#45;&gt;layer_0_expert_7_ep_3 -->
<g id="edge84" class="edge">
<title>layer_0_route_ep_3&#45;&gt;layer_0_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M32635.6,-830.1C32802.65,-818.19 33042.12,-802.68 33252,-795 33945.36,-769.64 34119.29,-789.77 34813,-777 35111.71,-771.5 35189.8,-806.01 35485,-760 35525.47,-753.69 35568.32,-743.23 35608.03,-731.85"/>
<polygon fill="black" stroke="black" points="35609.15,-735.17 35617.78,-729.02 35607.2,-728.44 35609.15,-735.17"/>
</g>
<!-- layer_0_expert_0_ep_4 -->
<g id="node60" class="node">
<title>layer_0_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="18585.83,-729 18151.82,-729 18040.17,-625 18474.18,-625 18585.83,-729"/>
<text text-anchor="middle" x="18313" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="18313" y="-680" font-family="Arial" font-size="10.00">GPU: 64</text>
<text text-anchor="middle" x="18313" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="18313" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_0_ep_4 -->
<g id="edge85" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M19997.77,-840.32C19609.86,-829.9 18856.72,-804.6 18594,-760 18554.62,-753.32 18512.94,-743.01 18474.08,-731.93"/>
<polygon fill="black" stroke="black" points="18474.84,-728.51 18464.26,-729.1 18472.9,-735.23 18474.84,-728.51"/>
</g>
<!-- layer_0_expert_1_ep_4 -->
<g id="node61" class="node">
<title>layer_0_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="19148.83,-729 18714.82,-729 18603.17,-625 19037.18,-625 19148.83,-729"/>
<text text-anchor="middle" x="18876" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="18876" y="-680" font-family="Arial" font-size="10.00">GPU: 65</text>
<text text-anchor="middle" x="18876" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="18876" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_1_ep_4 -->
<g id="edge86" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M19998.73,-841.01C19779.11,-833.1 19443.68,-812.69 19157,-760 19118.53,-752.93 19077.78,-742.7 19039.61,-731.84"/>
<polygon fill="black" stroke="black" points="19040.55,-728.47 19029.97,-729.07 19038.61,-735.2 19040.55,-728.47"/>
</g>
<!-- layer_0_expert_2_ep_4 -->
<g id="node62" class="node">
<title>layer_0_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="19711.83,-729 19277.82,-729 19166.17,-625 19600.18,-625 19711.83,-729"/>
<text text-anchor="middle" x="19439" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="19439" y="-680" font-family="Arial" font-size="10.00">GPU: 66</text>
<text text-anchor="middle" x="19439" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="19439" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_2_ep_4 -->
<g id="edge87" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M19959.19,-806.13C19881.47,-793.22 19797.1,-777.62 19720,-760 19684.79,-751.95 19647.48,-742.05 19611.94,-731.95"/>
<polygon fill="black" stroke="black" points="19612.54,-728.48 19601.96,-729.1 19610.61,-735.21 19612.54,-728.48"/>
</g>
<!-- layer_0_expert_3_ep_4 -->
<g id="node63" class="node">
<title>layer_0_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="20274.83,-729 19840.82,-729 19729.17,-625 20163.18,-625 20274.83,-729"/>
<text text-anchor="middle" x="20002" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="20002" y="-680" font-family="Arial" font-size="10.00">GPU: 67</text>
<text text-anchor="middle" x="20002" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="20002" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_3_ep_4 -->
<g id="edge88" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M20164.14,-794.91C20137.94,-776.01 20108.07,-754.48 20081.17,-735.08"/>
<polygon fill="black" stroke="black" points="20083.08,-732.15 20072.92,-729.14 20078.99,-737.82 20083.08,-732.15"/>
</g>
<!-- layer_0_expert_4_ep_4 -->
<g id="node64" class="node">
<title>layer_0_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="20837.83,-729 20403.82,-729 20292.17,-625 20726.18,-625 20837.83,-729"/>
<text text-anchor="middle" x="20565" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="20565" y="-680" font-family="Arial" font-size="10.00">GPU: 68</text>
<text text-anchor="middle" x="20565" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="20565" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_4_ep_4 -->
<g id="edge89" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M20335.35,-794.91C20373.27,-775.61 20416.6,-753.55 20455.33,-733.83"/>
<polygon fill="black" stroke="black" points="20457.23,-736.79 20464.55,-729.14 20454.05,-730.55 20457.23,-736.79"/>
</g>
<!-- layer_0_expert_5_ep_4 -->
<g id="node65" class="node">
<title>layer_0_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="21400.83,-729 20966.82,-729 20855.17,-625 21289.18,-625 21400.83,-729"/>
<text text-anchor="middle" x="21128" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="21128" y="-680" font-family="Arial" font-size="10.00">GPU: 69</text>
<text text-anchor="middle" x="21128" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="21128" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_5_ep_4 -->
<g id="edge90" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M20439.25,-824.78C20558.84,-810.49 20712.34,-788.95 20847,-760 20883.26,-752.2 20921.68,-742.19 20958.09,-731.85"/>
<polygon fill="black" stroke="black" points="20959.14,-735.19 20967.79,-729.08 20957.22,-728.46 20959.14,-735.19"/>
</g>
<!-- layer_0_expert_6_ep_4 -->
<g id="node66" class="node">
<title>layer_0_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="21963.83,-729 21529.82,-729 21418.17,-625 21852.18,-625 21963.83,-729"/>
<text text-anchor="middle" x="21691" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="21691" y="-680" font-family="Arial" font-size="10.00">GPU: 70</text>
<text text-anchor="middle" x="21691" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="21691" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_6_ep_4 -->
<g id="edge91" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M20460.65,-843.56C20698.52,-837.72 21083.28,-818.95 21410,-760 21448.73,-753.01 21489.74,-742.75 21528.11,-731.83"/>
<polygon fill="black" stroke="black" points="21529.16,-735.17 21537.8,-729.04 21527.22,-728.44 21529.16,-735.17"/>
</g>
<!-- layer_0_expert_7_ep_4 -->
<g id="node67" class="node">
<title>layer_0_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="22526.83,-729 22092.82,-729 21981.17,-625 22415.18,-625 22526.83,-729"/>
<text text-anchor="middle" x="22254" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="22254" y="-680" font-family="Arial" font-size="10.00">GPU: 71</text>
<text text-anchor="middle" x="22254" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="22254" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_4&#45;&gt;layer_0_expert_7_ep_4 -->
<g id="edge92" class="edge">
<title>layer_0_route_ep_4&#45;&gt;layer_0_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M20458.43,-841.46C20859.97,-832.21 21688.3,-807.9 21973,-760 22012.5,-753.35 22054.32,-743.03 22093.28,-731.92"/>
<polygon fill="black" stroke="black" points="22094.48,-735.21 22103.12,-729.08 22092.54,-728.49 22094.48,-735.21"/>
</g>
<!-- layer_0_expert_0_ep_5 -->
<g id="node68" class="node">
<title>layer_0_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="569.83,-729 135.82,-729 24.17,-625 458.18,-625 569.83,-729"/>
<text text-anchor="middle" x="297" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="297" y="-680" font-family="Arial" font-size="10.00">GPU: 80</text>
<text text-anchor="middle" x="297" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="297" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_0_ep_5 -->
<g id="edge93" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M3093.54,-846.25C2523.64,-845.68 1059.58,-836.54 578,-760 537.78,-753.61 495.2,-743.18 455.68,-731.87"/>
<polygon fill="black" stroke="black" points="456.55,-728.48 445.97,-729.06 454.6,-735.2 456.55,-728.48"/>
</g>
<!-- layer_0_expert_1_ep_5 -->
<g id="node69" class="node">
<title>layer_0_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="1132.83,-729 698.82,-729 587.17,-625 1021.18,-625 1132.83,-729"/>
<text text-anchor="middle" x="860" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="860" y="-680" font-family="Arial" font-size="10.00">GPU: 81</text>
<text text-anchor="middle" x="860" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="860" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_1_ep_5 -->
<g id="edge94" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M3091.11,-844.01C2607.85,-838.71 1510.43,-820.24 1141,-760 1101.12,-753.5 1058.9,-743.12 1019.65,-731.91"/>
<polygon fill="black" stroke="black" points="1020.32,-728.46 1009.74,-729.04 1018.37,-735.18 1020.32,-728.46"/>
</g>
<!-- layer_0_expert_2_ep_5 -->
<g id="node70" class="node">
<title>layer_0_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="1695.83,-729 1261.82,-729 1150.17,-625 1584.18,-625 1695.83,-729"/>
<text text-anchor="middle" x="1423" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="1423" y="-680" font-family="Arial" font-size="10.00">GPU: 82</text>
<text text-anchor="middle" x="1423" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="1423" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_2_ep_5 -->
<g id="edge95" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M3086.72,-840.13C2702.88,-829.5 1962.66,-804 1704,-760 1664.63,-753.3 1622.95,-742.99 1584.08,-731.91"/>
<polygon fill="black" stroke="black" points="1584.85,-728.49 1574.27,-729.08 1582.91,-735.21 1584.85,-728.49"/>
</g>
<!-- layer_0_expert_3_ep_5 -->
<g id="node71" class="node">
<title>layer_0_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="2258.83,-729 1824.82,-729 1713.17,-625 2147.18,-625 2258.83,-729"/>
<text text-anchor="middle" x="1986" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="1986" y="-680" font-family="Arial" font-size="10.00">GPU: 83</text>
<text text-anchor="middle" x="1986" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="1986" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_3_ep_5 -->
<g id="edge96" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M3087.1,-840.44C2871.69,-832.14 2545.82,-811.47 2267,-760 2228.53,-752.9 2187.79,-742.65 2149.62,-731.8"/>
<polygon fill="black" stroke="black" points="2150.55,-728.42 2139.98,-729.03 2148.62,-735.15 2150.55,-728.42"/>
</g>
<!-- layer_0_expert_4_ep_5 -->
<g id="node72" class="node">
<title>layer_0_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="2821.83,-729 2387.82,-729 2276.17,-625 2710.18,-625 2821.83,-729"/>
<text text-anchor="middle" x="2549" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="2549" y="-680" font-family="Arial" font-size="10.00">GPU: 84</text>
<text text-anchor="middle" x="2549" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="2549" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_4_ep_5 -->
<g id="edge97" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M3044.33,-802.91C2974.05,-790.55 2899,-776.02 2830,-760 2794.93,-751.86 2757.76,-741.94 2722.32,-731.86"/>
<polygon fill="black" stroke="black" points="2722.95,-728.4 2712.38,-729.01 2721.03,-735.13 2722.95,-728.4"/>
</g>
<!-- layer_0_expert_5_ep_5 -->
<g id="node73" class="node">
<title>layer_0_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="3384.83,-729 2950.82,-729 2839.17,-625 3273.18,-625 3384.83,-729"/>
<text text-anchor="middle" x="3112" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="3112" y="-680" font-family="Arial" font-size="10.00">GPU: 85</text>
<text text-anchor="middle" x="3112" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="3112" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_5_ep_5 -->
<g id="edge98" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M3259.53,-794.91C3235.89,-776.18 3208.97,-754.85 3184.66,-735.58"/>
<polygon fill="black" stroke="black" points="3186.54,-732.6 3176.53,-729.14 3182.19,-738.09 3186.54,-732.6"/>
</g>
<!-- layer_0_expert_6_ep_5 -->
<g id="node74" class="node">
<title>layer_0_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="3947.83,-729 3513.82,-729 3402.17,-625 3836.18,-625 3947.83,-729"/>
<text text-anchor="middle" x="3675" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="3675" y="-680" font-family="Arial" font-size="10.00">GPU: 86</text>
<text text-anchor="middle" x="3675" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="3675" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_6_ep_5 -->
<g id="edge99" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M3430.74,-794.91C3471.33,-775.48 3517.74,-753.27 3559.14,-733.46"/>
<polygon fill="black" stroke="black" points="3560.65,-736.61 3568.16,-729.14 3557.63,-730.3 3560.65,-736.61"/>
</g>
<!-- layer_0_expert_7_ep_5 -->
<g id="node75" class="node">
<title>layer_0_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="4510.83,-729 4076.82,-729 3965.17,-625 4399.18,-625 4510.83,-729"/>
<text text-anchor="middle" x="4238" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="4238" y="-680" font-family="Arial" font-size="10.00">GPU: 87</text>
<text text-anchor="middle" x="4238" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="4238" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_5&#45;&gt;layer_0_expert_7_ep_5 -->
<g id="edge100" class="edge">
<title>layer_0_route_ep_5&#45;&gt;layer_0_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M3529.52,-825.92C3654.02,-811.82 3815.57,-790.07 3957,-760 3993.39,-752.26 4031.95,-742.25 4068.46,-731.88"/>
<polygon fill="black" stroke="black" points="4069.54,-735.22 4078.19,-729.1 4067.61,-728.48 4069.54,-735.22"/>
</g>
<!-- layer_0_expert_0_ep_6 -->
<g id="node76" class="node">
<title>layer_0_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="23089.83,-729 22655.82,-729 22544.17,-625 22978.18,-625 23089.83,-729"/>
<text text-anchor="middle" x="22817" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="22817" y="-680" font-family="Arial" font-size="10.00">GPU: 96</text>
<text text-anchor="middle" x="22817" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="22817" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_0_ep_6 -->
<g id="edge101" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M23312.33,-802.91C23242.05,-790.55 23167,-776.02 23098,-760 23062.93,-751.86 23025.76,-741.94 22990.32,-731.86"/>
<polygon fill="black" stroke="black" points="22990.95,-728.4 22980.38,-729.01 22989.03,-735.13 22990.95,-728.4"/>
</g>
<!-- layer_0_expert_1_ep_6 -->
<g id="node77" class="node">
<title>layer_0_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="23652.83,-729 23218.82,-729 23107.17,-625 23541.18,-625 23652.83,-729"/>
<text text-anchor="middle" x="23380" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="23380" y="-680" font-family="Arial" font-size="10.00">GPU: 97</text>
<text text-anchor="middle" x="23380" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="23380" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_1_ep_6 -->
<g id="edge102" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M23527.53,-794.91C23503.89,-776.18 23476.97,-754.85 23452.66,-735.58"/>
<polygon fill="black" stroke="black" points="23454.54,-732.6 23444.53,-729.14 23450.19,-738.09 23454.54,-732.6"/>
</g>
<!-- layer_0_expert_2_ep_6 -->
<g id="node78" class="node">
<title>layer_0_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="24215.83,-729 23781.82,-729 23670.17,-625 24104.18,-625 24215.83,-729"/>
<text text-anchor="middle" x="23943" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="23943" y="-680" font-family="Arial" font-size="10.00">GPU: 98</text>
<text text-anchor="middle" x="23943" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="23943" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_2_ep_6 -->
<g id="edge103" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M23698.74,-794.91C23739.33,-775.48 23785.74,-753.27 23827.14,-733.46"/>
<polygon fill="black" stroke="black" points="23828.65,-736.61 23836.16,-729.14 23825.63,-730.3 23828.65,-736.61"/>
</g>
<!-- layer_0_expert_3_ep_6 -->
<g id="node79" class="node">
<title>layer_0_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="24778.83,-729 24344.82,-729 24233.17,-625 24667.18,-625 24778.83,-729"/>
<text text-anchor="middle" x="24506" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="24506" y="-680" font-family="Arial" font-size="10.00">GPU: 99</text>
<text text-anchor="middle" x="24506" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="24506" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_3_ep_6 -->
<g id="edge104" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M23797.52,-825.92C23922.02,-811.82 24083.57,-790.07 24225,-760 24261.39,-752.26 24299.95,-742.25 24336.46,-731.88"/>
<polygon fill="black" stroke="black" points="24337.54,-735.22 24346.19,-729.1 24335.61,-728.48 24337.54,-735.22"/>
</g>
<!-- layer_0_expert_4_ep_6 -->
<g id="node80" class="node">
<title>layer_0_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="25341.83,-729 24907.82,-729 24796.17,-625 25230.18,-625 25341.83,-729"/>
<text text-anchor="middle" x="25069" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="25069" y="-680" font-family="Arial" font-size="10.00">GPU: 100</text>
<text text-anchor="middle" x="25069" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="25069" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_4_ep_6 -->
<g id="edge105" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M23818.06,-843.98C24059.87,-838.51 24453.77,-820.08 24788,-760 24826.73,-753.04 24867.74,-742.78 24906.11,-731.87"/>
<polygon fill="black" stroke="black" points="24907.16,-735.21 24915.81,-729.08 24905.23,-728.48 24907.16,-735.21"/>
</g>
<!-- layer_0_expert_5_ep_6 -->
<g id="node81" class="node">
<title>layer_0_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="25904.83,-729 25470.82,-729 25359.17,-625 25793.18,-625 25904.83,-729"/>
<text text-anchor="middle" x="25632" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="25632" y="-680" font-family="Arial" font-size="10.00">GPU: 101</text>
<text text-anchor="middle" x="25632" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="25632" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_5_ep_6 -->
<g id="edge106" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M23815.34,-841.62C24220.68,-832.57 25062.2,-808.5 25351,-760 25390.5,-753.37 25432.32,-743.04 25471.28,-731.93"/>
<polygon fill="black" stroke="black" points="25472.48,-735.23 25481.12,-729.09 25470.54,-728.5 25472.48,-735.23"/>
</g>
<!-- layer_0_expert_6_ep_6 -->
<g id="node82" class="node">
<title>layer_0_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="26467.83,-729 26033.82,-729 25922.17,-625 26356.18,-625 26467.83,-729"/>
<text text-anchor="middle" x="26195" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="26195" y="-680" font-family="Arial" font-size="10.00">GPU: 102</text>
<text text-anchor="middle" x="26195" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="26195" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_6_ep_6 -->
<g id="edge107" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M23819.09,-844.71C24321.8,-840.7 25515.66,-824.48 25914,-760 25954,-753.52 25996.35,-743.13 26035.7,-731.88"/>
<polygon fill="black" stroke="black" points="26037,-735.15 26045.64,-729 26035.06,-728.42 26037,-735.15"/>
</g>
<!-- layer_0_expert_7_ep_6 -->
<g id="node83" class="node">
<title>layer_0_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="27030.83,-729 26596.82,-729 26485.17,-625 26919.18,-625 27030.83,-729"/>
<text text-anchor="middle" x="26758" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="26758" y="-680" font-family="Arial" font-size="10.00">GPU: 103</text>
<text text-anchor="middle" x="26758" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="26758" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_6&#45;&gt;layer_0_expert_7_ep_6 -->
<g id="edge108" class="edge">
<title>layer_0_route_ep_6&#45;&gt;layer_0_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M23821.1,-846.67C24410.24,-847.18 25967.29,-840.62 26477,-760 26517.23,-753.64 26559.81,-743.22 26599.32,-731.92"/>
<polygon fill="black" stroke="black" points="26600.4,-735.25 26609.03,-729.1 26598.45,-728.52 26600.4,-735.25"/>
</g>
<!-- layer_0_expert_0_ep_7 -->
<g id="node84" class="node">
<title>layer_0_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="14081.83,-729 13647.82,-729 13536.17,-625 13970.18,-625 14081.83,-729"/>
<text text-anchor="middle" x="13809" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="13809" y="-680" font-family="Arial" font-size="10.00">GPU: 112</text>
<text text-anchor="middle" x="13809" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="13809" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_0_ep_7 -->
<g id="edge109" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M16675.79,-846.47C16095.81,-846.44 14585.61,-838.57 14090,-760 14049.77,-753.62 14007.2,-743.2 13967.68,-731.89"/>
<polygon fill="black" stroke="black" points="13968.55,-728.5 13957.97,-729.08 13966.6,-735.23 13968.55,-728.5"/>
</g>
<!-- layer_0_expert_1_ep_7 -->
<g id="node85" class="node">
<title>layer_0_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="14644.83,-729 14210.82,-729 14099.17,-625 14533.18,-625 14644.83,-729"/>
<text text-anchor="middle" x="14372" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="14372" y="-680" font-family="Arial" font-size="10.00">GPU: 113</text>
<text text-anchor="middle" x="14372" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="14372" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_1_ep_7 -->
<g id="edge110" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M16673.17,-844.35C16178.39,-839.67 15036.23,-822.25 14653,-760 14613.12,-753.52 14570.9,-743.16 14531.65,-731.94"/>
<polygon fill="black" stroke="black" points="14532.31,-728.49 14521.73,-729.08 14530.37,-735.22 14532.31,-728.49"/>
</g>
<!-- layer_0_expert_2_ep_7 -->
<g id="node86" class="node">
<title>layer_0_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="15207.83,-729 14773.82,-729 14662.17,-625 15096.18,-625 15207.83,-729"/>
<text text-anchor="middle" x="14935" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="14935" y="-680" font-family="Arial" font-size="10.00">GPU: 114</text>
<text text-anchor="middle" x="14935" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="14935" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_2_ep_7 -->
<g id="edge111" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M16669.26,-840.76C16272.09,-830.82 15488.3,-806.01 15216,-760 15176.5,-753.33 15134.69,-742.99 15095.73,-731.88"/>
<polygon fill="black" stroke="black" points="15096.47,-728.45 15085.89,-729.04 15094.53,-735.17 15096.47,-728.45"/>
</g>
<!-- layer_0_expert_3_ep_7 -->
<g id="node87" class="node">
<title>layer_0_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="15770.83,-729 15336.82,-729 15225.17,-625 15659.18,-625 15770.83,-729"/>
<text text-anchor="middle" x="15498" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="15498" y="-680" font-family="Arial" font-size="10.00">GPU: 115</text>
<text text-anchor="middle" x="15498" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="15498" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_3_ep_7 -->
<g id="edge112" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M16671.08,-842.25C16441.84,-835.27 16084.03,-815.52 15779,-760 15740.4,-752.97 15699.52,-742.73 15661.25,-731.84"/>
<polygon fill="black" stroke="black" points="15662.16,-728.46 15651.58,-729.06 15660.23,-735.19 15662.16,-728.46"/>
</g>
<!-- layer_0_expert_4_ep_7 -->
<g id="node88" class="node">
<title>layer_0_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="16333.83,-729 15899.82,-729 15788.17,-625 16222.18,-625 16333.83,-729"/>
<text text-anchor="middle" x="16061" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="16061" y="-680" font-family="Arial" font-size="10.00">GPU: 116</text>
<text text-anchor="middle" x="16061" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="16061" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_4_ep_7 -->
<g id="edge113" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M16637.12,-812.42C16543.25,-798.74 16437.5,-781.12 16342,-760 16306.13,-752.07 16268.11,-742.08 16232.02,-731.82"/>
<polygon fill="black" stroke="black" points="16232.97,-728.45 16222.39,-729.07 16231.04,-735.18 16232.97,-728.45"/>
</g>
<!-- layer_0_expert_5_ep_7 -->
<g id="node89" class="node">
<title>layer_0_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="16896.83,-729 16462.82,-729 16351.17,-625 16785.18,-625 16896.83,-729"/>
<text text-anchor="middle" x="16624" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="16624" y="-680" font-family="Arial" font-size="10.00">GPU: 117</text>
<text text-anchor="middle" x="16624" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="16624" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_5_ep_7 -->
<g id="edge114" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M16820.24,-794.91C16788.11,-775.77 16751.44,-753.92 16718.55,-734.33"/>
<polygon fill="black" stroke="black" points="16720.22,-731.25 16709.84,-729.14 16716.64,-737.26 16720.22,-731.25"/>
</g>
<!-- layer_0_expert_6_ep_7 -->
<g id="node90" class="node">
<title>layer_0_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="17459.83,-729 17025.82,-729 16914.17,-625 17348.18,-625 17459.83,-729"/>
<text text-anchor="middle" x="17187" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="17187" y="-680" font-family="Arial" font-size="10.00">GPU: 118</text>
<text text-anchor="middle" x="17187" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="17187" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_6_ep_7 -->
<g id="edge115" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M16991.45,-794.91C17023.47,-775.77 17060.02,-753.92 17092.78,-734.33"/>
<polygon fill="black" stroke="black" points="17094.68,-737.27 17101.47,-729.14 17091.09,-731.26 17094.68,-737.27"/>
</g>
<!-- layer_0_expert_7_ep_7 -->
<g id="node91" class="node">
<title>layer_0_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="18022.83,-729 17588.82,-729 17477.17,-625 17911.18,-625 18022.83,-729"/>
<text text-anchor="middle" x="17750" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="17750" y="-680" font-family="Arial" font-size="10.00">GPU: 119</text>
<text text-anchor="middle" x="17750" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="17750" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_0_route_ep_7&#45;&gt;layer_0_expert_7_ep_7 -->
<g id="edge116" class="edge">
<title>layer_0_route_ep_7&#45;&gt;layer_0_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M17107.18,-821.85C17215.1,-807.24 17350.01,-786.33 17469,-760 17504.87,-752.06 17542.89,-742.07 17578.98,-731.82"/>
<polygon fill="black" stroke="black" points="17579.96,-735.18 17588.61,-729.06 17578.03,-728.45 17579.96,-735.18"/>
</g>
<!-- layer_0_agg_ep_0 -->
<g id="node92" class="node">
<title>layer_0_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="7336.07,-559 6885.77,-559 6769.93,-455 7220.23,-455 7336.07,-559"/>
<text text-anchor="middle" x="7053" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="7053" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="7053" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="7053" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge117" class="edge">
<title>layer_0_expert_0_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M4978.89,-640.38C5013.01,-634.5 5048.52,-629.02 5082,-625 5709.39,-549.72 6455.2,-522.19 6823.6,-512.68"/>
<polygon fill="black" stroke="black" points="6823.94,-516.17 6833.85,-512.41 6823.76,-509.17 6823.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge118" class="edge">
<title>layer_0_expert_1_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M5542.35,-640.96C5576.34,-635.04 5611.7,-629.4 5645,-625 6062.36,-569.92 6552.96,-536.1 6831,-519.8"/>
<polygon fill="black" stroke="black" points="6831.43,-523.28 6841.21,-519.2 6831.02,-516.29 6831.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge119" class="edge">
<title>layer_0_expert_2_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M6106.69,-642.23C6140.32,-636.24 6175.2,-630.25 6208,-625 6425.23,-590.26 6674.86,-556.45 6846.16,-534.18"/>
<polygon fill="black" stroke="black" points="6846.83,-537.62 6856.3,-532.86 6845.93,-530.68 6846.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge120" class="edge">
<title>layer_0_expert_3_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M6653.6,-627.18C6722.9,-606.5 6803.84,-582.35 6874.67,-561.21"/>
<polygon fill="black" stroke="black" points="6876.01,-564.47 6884.59,-558.25 6874.01,-557.76 6876.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge121" class="edge">
<title>layer_0_expert_4_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M7053,-624.68C7053,-607.18 7053,-587.43 7053,-569.22"/>
<polygon fill="black" stroke="black" points="7056.5,-569 7053,-559 7049.5,-569 7056.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge122" class="edge">
<title>layer_0_expert_5_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M7444.79,-624.91C7378.19,-605.04 7301.8,-582.24 7234.26,-562.09"/>
<polygon fill="black" stroke="black" points="7234.95,-558.64 7224.37,-559.14 7232.95,-565.35 7234.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge123" class="edge">
<title>layer_0_expert_6_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M7907.6,-626.55C7904.38,-626.02 7901.18,-625.51 7898,-625 7707.84,-594.59 7492.86,-564.89 7327.33,-543.02"/>
<polygon fill="black" stroke="black" points="7327.37,-539.5 7317,-541.66 7326.45,-546.44 7327.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_0&#45;&gt;layer_0_agg_ep_0 -->
<g id="edge124" class="edge">
<title>layer_0_expert_7_ep_0&#45;&gt;layer_0_agg_ep_0</title>
<path fill="none" stroke="black" d="M8470.27,-626.25C8467.16,-625.82 8464.07,-625.41 8461,-625 8057.9,-571.8 7586.48,-538.44 7304.24,-521.53"/>
<polygon fill="black" stroke="black" points="7304.05,-518.01 7293.86,-520.91 7303.63,-525 7304.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_1 -->
<g id="node93" class="node">
<title>layer_0_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="11840.07,-559 11389.77,-559 11273.93,-455 11724.23,-455 11840.07,-559"/>
<text text-anchor="middle" x="11557" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="11557" y="-510" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="11557" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="11557" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge126" class="edge">
<title>layer_0_expert_0_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M9482.89,-640.38C9517.01,-634.5 9552.52,-629.02 9586,-625 10213.39,-549.72 10959.2,-522.19 11327.6,-512.68"/>
<polygon fill="black" stroke="black" points="11327.94,-516.17 11337.85,-512.41 11327.76,-509.17 11327.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge127" class="edge">
<title>layer_0_expert_1_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M10046.35,-640.96C10080.34,-635.04 10115.7,-629.4 10149,-625 10566.36,-569.92 11056.96,-536.1 11335,-519.8"/>
<polygon fill="black" stroke="black" points="11335.43,-523.28 11345.21,-519.2 11335.02,-516.29 11335.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge128" class="edge">
<title>layer_0_expert_2_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M10610.69,-642.23C10644.32,-636.24 10679.2,-630.25 10712,-625 10929.23,-590.26 11178.86,-556.45 11350.16,-534.18"/>
<polygon fill="black" stroke="black" points="11350.83,-537.62 11360.3,-532.86 11349.93,-530.68 11350.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge129" class="edge">
<title>layer_0_expert_3_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M11157.6,-627.18C11226.9,-606.5 11307.84,-582.35 11378.67,-561.21"/>
<polygon fill="black" stroke="black" points="11380.01,-564.47 11388.59,-558.25 11378.01,-557.76 11380.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge130" class="edge">
<title>layer_0_expert_4_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M11557,-624.68C11557,-607.18 11557,-587.43 11557,-569.22"/>
<polygon fill="black" stroke="black" points="11560.5,-569 11557,-559 11553.5,-569 11560.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge131" class="edge">
<title>layer_0_expert_5_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M11948.79,-624.91C11882.19,-605.04 11805.8,-582.24 11738.26,-562.09"/>
<polygon fill="black" stroke="black" points="11738.95,-558.64 11728.37,-559.14 11736.95,-565.35 11738.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge132" class="edge">
<title>layer_0_expert_6_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M12411.6,-626.55C12408.38,-626.02 12405.18,-625.51 12402,-625 12211.84,-594.59 11996.86,-564.89 11831.33,-543.02"/>
<polygon fill="black" stroke="black" points="11831.37,-539.5 11821,-541.66 11830.45,-546.44 11831.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_1&#45;&gt;layer_0_agg_ep_1 -->
<g id="edge133" class="edge">
<title>layer_0_expert_7_ep_1&#45;&gt;layer_0_agg_ep_1</title>
<path fill="none" stroke="black" d="M12974.27,-626.25C12971.16,-625.82 12968.07,-625.41 12965,-625 12561.9,-571.8 12090.48,-538.44 11808.24,-521.53"/>
<polygon fill="black" stroke="black" points="11808.05,-518.01 11797.86,-520.91 11807.63,-525 11808.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_2 -->
<g id="node94" class="node">
<title>layer_0_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="29856.07,-559 29405.77,-559 29289.93,-455 29740.23,-455 29856.07,-559"/>
<text text-anchor="middle" x="29573" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="29573" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="29573" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="29573" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge135" class="edge">
<title>layer_0_expert_0_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M27498.89,-640.38C27533.01,-634.5 27568.52,-629.02 27602,-625 28229.39,-549.72 28975.2,-522.19 29343.6,-512.68"/>
<polygon fill="black" stroke="black" points="29343.94,-516.17 29353.85,-512.41 29343.76,-509.17 29343.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge136" class="edge">
<title>layer_0_expert_1_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M28062.35,-640.96C28096.34,-635.04 28131.7,-629.4 28165,-625 28582.36,-569.92 29072.96,-536.1 29351,-519.8"/>
<polygon fill="black" stroke="black" points="29351.43,-523.28 29361.21,-519.2 29351.02,-516.29 29351.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge137" class="edge">
<title>layer_0_expert_2_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M28626.69,-642.23C28660.32,-636.24 28695.2,-630.25 28728,-625 28945.23,-590.26 29194.86,-556.45 29366.16,-534.18"/>
<polygon fill="black" stroke="black" points="29366.83,-537.62 29376.3,-532.86 29365.93,-530.68 29366.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge138" class="edge">
<title>layer_0_expert_3_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M29173.6,-627.18C29242.9,-606.5 29323.84,-582.35 29394.67,-561.21"/>
<polygon fill="black" stroke="black" points="29396.01,-564.47 29404.59,-558.25 29394.01,-557.76 29396.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge139" class="edge">
<title>layer_0_expert_4_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M29573,-624.68C29573,-607.18 29573,-587.43 29573,-569.22"/>
<polygon fill="black" stroke="black" points="29576.5,-569 29573,-559 29569.5,-569 29576.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge140" class="edge">
<title>layer_0_expert_5_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M29964.79,-624.91C29898.19,-605.04 29821.8,-582.24 29754.26,-562.09"/>
<polygon fill="black" stroke="black" points="29754.95,-558.64 29744.37,-559.14 29752.95,-565.35 29754.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge141" class="edge">
<title>layer_0_expert_6_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M30427.6,-626.55C30424.38,-626.02 30421.18,-625.51 30418,-625 30227.84,-594.59 30012.86,-564.89 29847.33,-543.02"/>
<polygon fill="black" stroke="black" points="29847.37,-539.5 29837,-541.66 29846.45,-546.44 29847.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_2&#45;&gt;layer_0_agg_ep_2 -->
<g id="edge142" class="edge">
<title>layer_0_expert_7_ep_2&#45;&gt;layer_0_agg_ep_2</title>
<path fill="none" stroke="black" d="M30990.27,-626.25C30987.16,-625.82 30984.07,-625.41 30981,-625 30577.9,-571.8 30106.48,-538.44 29824.24,-521.53"/>
<polygon fill="black" stroke="black" points="29824.05,-518.01 29813.86,-520.91 29823.63,-525 29824.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_3 -->
<g id="node95" class="node">
<title>layer_0_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="34360.07,-559 33909.77,-559 33793.93,-455 34244.23,-455 34360.07,-559"/>
<text text-anchor="middle" x="34077" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="34077" y="-510" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="34077" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="34077" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge144" class="edge">
<title>layer_0_expert_0_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M32002.89,-640.38C32037.01,-634.5 32072.52,-629.02 32106,-625 32733.39,-549.72 33479.2,-522.19 33847.6,-512.68"/>
<polygon fill="black" stroke="black" points="33847.94,-516.17 33857.85,-512.41 33847.76,-509.17 33847.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge145" class="edge">
<title>layer_0_expert_1_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M32566.35,-640.96C32600.34,-635.04 32635.7,-629.4 32669,-625 33086.36,-569.92 33576.96,-536.1 33855,-519.8"/>
<polygon fill="black" stroke="black" points="33855.43,-523.28 33865.21,-519.2 33855.02,-516.29 33855.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge146" class="edge">
<title>layer_0_expert_2_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M33130.69,-642.23C33164.32,-636.24 33199.2,-630.25 33232,-625 33449.23,-590.26 33698.86,-556.45 33870.16,-534.18"/>
<polygon fill="black" stroke="black" points="33870.83,-537.62 33880.3,-532.86 33869.93,-530.68 33870.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge147" class="edge">
<title>layer_0_expert_3_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M33677.6,-627.18C33746.9,-606.5 33827.84,-582.35 33898.67,-561.21"/>
<polygon fill="black" stroke="black" points="33900.01,-564.47 33908.59,-558.25 33898.01,-557.76 33900.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge148" class="edge">
<title>layer_0_expert_4_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M34077,-624.68C34077,-607.18 34077,-587.43 34077,-569.22"/>
<polygon fill="black" stroke="black" points="34080.5,-569 34077,-559 34073.5,-569 34080.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge149" class="edge">
<title>layer_0_expert_5_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M34468.79,-624.91C34402.19,-605.04 34325.8,-582.24 34258.26,-562.09"/>
<polygon fill="black" stroke="black" points="34258.95,-558.64 34248.37,-559.14 34256.95,-565.35 34258.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge150" class="edge">
<title>layer_0_expert_6_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M34931.6,-626.55C34928.38,-626.02 34925.18,-625.51 34922,-625 34731.84,-594.59 34516.86,-564.89 34351.33,-543.02"/>
<polygon fill="black" stroke="black" points="34351.37,-539.5 34341,-541.66 34350.45,-546.44 34351.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_3&#45;&gt;layer_0_agg_ep_3 -->
<g id="edge151" class="edge">
<title>layer_0_expert_7_ep_3&#45;&gt;layer_0_agg_ep_3</title>
<path fill="none" stroke="black" d="M35494.27,-626.25C35491.16,-625.82 35488.07,-625.41 35485,-625 35081.9,-571.8 34610.48,-538.44 34328.24,-521.53"/>
<polygon fill="black" stroke="black" points="34328.05,-518.01 34317.86,-520.91 34327.63,-525 34328.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_4 -->
<g id="node96" class="node">
<title>layer_0_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="20848.07,-559 20397.77,-559 20281.93,-455 20732.23,-455 20848.07,-559"/>
<text text-anchor="middle" x="20565" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="20565" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="20565" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="20565" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge153" class="edge">
<title>layer_0_expert_0_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M18490.89,-640.38C18525.01,-634.5 18560.52,-629.02 18594,-625 19221.39,-549.72 19967.2,-522.19 20335.6,-512.68"/>
<polygon fill="black" stroke="black" points="20335.94,-516.17 20345.85,-512.41 20335.76,-509.17 20335.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge154" class="edge">
<title>layer_0_expert_1_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M19054.35,-640.96C19088.34,-635.04 19123.7,-629.4 19157,-625 19574.36,-569.92 20064.96,-536.1 20343,-519.8"/>
<polygon fill="black" stroke="black" points="20343.43,-523.28 20353.21,-519.2 20343.02,-516.29 20343.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge155" class="edge">
<title>layer_0_expert_2_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M19618.69,-642.23C19652.32,-636.24 19687.2,-630.25 19720,-625 19937.23,-590.26 20186.86,-556.45 20358.16,-534.18"/>
<polygon fill="black" stroke="black" points="20358.83,-537.62 20368.3,-532.86 20357.93,-530.68 20358.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge156" class="edge">
<title>layer_0_expert_3_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M20165.6,-627.18C20234.9,-606.5 20315.84,-582.35 20386.67,-561.21"/>
<polygon fill="black" stroke="black" points="20388.01,-564.47 20396.59,-558.25 20386.01,-557.76 20388.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge157" class="edge">
<title>layer_0_expert_4_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M20565,-624.68C20565,-607.18 20565,-587.43 20565,-569.22"/>
<polygon fill="black" stroke="black" points="20568.5,-569 20565,-559 20561.5,-569 20568.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge158" class="edge">
<title>layer_0_expert_5_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M20956.79,-624.91C20890.19,-605.04 20813.8,-582.24 20746.26,-562.09"/>
<polygon fill="black" stroke="black" points="20746.95,-558.64 20736.37,-559.14 20744.95,-565.35 20746.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge159" class="edge">
<title>layer_0_expert_6_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M21419.6,-626.55C21416.38,-626.02 21413.18,-625.51 21410,-625 21219.84,-594.59 21004.86,-564.89 20839.33,-543.02"/>
<polygon fill="black" stroke="black" points="20839.37,-539.5 20829,-541.66 20838.45,-546.44 20839.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_4&#45;&gt;layer_0_agg_ep_4 -->
<g id="edge160" class="edge">
<title>layer_0_expert_7_ep_4&#45;&gt;layer_0_agg_ep_4</title>
<path fill="none" stroke="black" d="M21982.27,-626.25C21979.16,-625.82 21976.07,-625.41 21973,-625 21569.9,-571.8 21098.48,-538.44 20816.24,-521.53"/>
<polygon fill="black" stroke="black" points="20816.05,-518.01 20805.86,-520.91 20815.63,-525 20816.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_5 -->
<g id="node97" class="node">
<title>layer_0_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="2832.07,-559 2381.77,-559 2265.93,-455 2716.23,-455 2832.07,-559"/>
<text text-anchor="middle" x="2549" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2549" y="-510" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="2549" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="2549" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge162" class="edge">
<title>layer_0_expert_0_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M474.89,-640.38C509.01,-634.5 544.52,-629.02 578,-625 1205.39,-549.72 1951.2,-522.19 2319.6,-512.68"/>
<polygon fill="black" stroke="black" points="2319.94,-516.17 2329.85,-512.41 2319.76,-509.17 2319.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge163" class="edge">
<title>layer_0_expert_1_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M1038.35,-640.96C1072.34,-635.04 1107.7,-629.4 1141,-625 1558.36,-569.92 2048.96,-536.1 2327,-519.8"/>
<polygon fill="black" stroke="black" points="2327.43,-523.28 2337.21,-519.2 2327.02,-516.29 2327.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge164" class="edge">
<title>layer_0_expert_2_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M1602.69,-642.23C1636.32,-636.24 1671.2,-630.25 1704,-625 1921.23,-590.26 2170.86,-556.45 2342.16,-534.18"/>
<polygon fill="black" stroke="black" points="2342.83,-537.62 2352.3,-532.86 2341.93,-530.68 2342.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge165" class="edge">
<title>layer_0_expert_3_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M2149.6,-627.18C2218.9,-606.5 2299.84,-582.35 2370.67,-561.21"/>
<polygon fill="black" stroke="black" points="2372.01,-564.47 2380.59,-558.25 2370.01,-557.76 2372.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge166" class="edge">
<title>layer_0_expert_4_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M2549,-624.68C2549,-607.18 2549,-587.43 2549,-569.22"/>
<polygon fill="black" stroke="black" points="2552.5,-569 2549,-559 2545.5,-569 2552.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge167" class="edge">
<title>layer_0_expert_5_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M2940.79,-624.91C2874.19,-605.04 2797.8,-582.24 2730.26,-562.09"/>
<polygon fill="black" stroke="black" points="2730.95,-558.64 2720.37,-559.14 2728.95,-565.35 2730.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge168" class="edge">
<title>layer_0_expert_6_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M3403.6,-626.55C3400.38,-626.02 3397.18,-625.51 3394,-625 3203.84,-594.59 2988.86,-564.89 2823.33,-543.02"/>
<polygon fill="black" stroke="black" points="2823.37,-539.5 2813,-541.66 2822.45,-546.44 2823.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_5&#45;&gt;layer_0_agg_ep_5 -->
<g id="edge169" class="edge">
<title>layer_0_expert_7_ep_5&#45;&gt;layer_0_agg_ep_5</title>
<path fill="none" stroke="black" d="M3966.27,-626.25C3963.16,-625.82 3960.07,-625.41 3957,-625 3553.9,-571.8 3082.48,-538.44 2800.24,-521.53"/>
<polygon fill="black" stroke="black" points="2800.05,-518.01 2789.86,-520.91 2799.63,-525 2800.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_6 -->
<g id="node98" class="node">
<title>layer_0_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="25352.07,-559 24901.77,-559 24785.93,-455 25236.23,-455 25352.07,-559"/>
<text text-anchor="middle" x="25069" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="25069" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="25069" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="25069" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge171" class="edge">
<title>layer_0_expert_0_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M22994.89,-640.38C23029.01,-634.5 23064.52,-629.02 23098,-625 23725.39,-549.72 24471.2,-522.19 24839.6,-512.68"/>
<polygon fill="black" stroke="black" points="24839.94,-516.17 24849.85,-512.41 24839.76,-509.17 24839.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge172" class="edge">
<title>layer_0_expert_1_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M23558.35,-640.96C23592.34,-635.04 23627.7,-629.4 23661,-625 24078.36,-569.92 24568.96,-536.1 24847,-519.8"/>
<polygon fill="black" stroke="black" points="24847.43,-523.28 24857.21,-519.2 24847.02,-516.29 24847.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge173" class="edge">
<title>layer_0_expert_2_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M24122.69,-642.23C24156.32,-636.24 24191.2,-630.25 24224,-625 24441.23,-590.26 24690.86,-556.45 24862.16,-534.18"/>
<polygon fill="black" stroke="black" points="24862.83,-537.62 24872.3,-532.86 24861.93,-530.68 24862.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge174" class="edge">
<title>layer_0_expert_3_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M24669.6,-627.18C24738.9,-606.5 24819.84,-582.35 24890.67,-561.21"/>
<polygon fill="black" stroke="black" points="24892.01,-564.47 24900.59,-558.25 24890.01,-557.76 24892.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge175" class="edge">
<title>layer_0_expert_4_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M25069,-624.68C25069,-607.18 25069,-587.43 25069,-569.22"/>
<polygon fill="black" stroke="black" points="25072.5,-569 25069,-559 25065.5,-569 25072.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge176" class="edge">
<title>layer_0_expert_5_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M25460.79,-624.91C25394.19,-605.04 25317.8,-582.24 25250.26,-562.09"/>
<polygon fill="black" stroke="black" points="25250.95,-558.64 25240.37,-559.14 25248.95,-565.35 25250.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge177" class="edge">
<title>layer_0_expert_6_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M25923.6,-626.55C25920.38,-626.02 25917.18,-625.51 25914,-625 25723.84,-594.59 25508.86,-564.89 25343.33,-543.02"/>
<polygon fill="black" stroke="black" points="25343.37,-539.5 25333,-541.66 25342.45,-546.44 25343.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_6&#45;&gt;layer_0_agg_ep_6 -->
<g id="edge178" class="edge">
<title>layer_0_expert_7_ep_6&#45;&gt;layer_0_agg_ep_6</title>
<path fill="none" stroke="black" d="M26486.27,-626.25C26483.16,-625.82 26480.07,-625.41 26477,-625 26073.9,-571.8 25602.48,-538.44 25320.24,-521.53"/>
<polygon fill="black" stroke="black" points="25320.05,-518.01 25309.86,-520.91 25319.63,-525 25320.05,-518.01"/>
</g>
<!-- layer_0_agg_ep_7 -->
<g id="node99" class="node">
<title>layer_0_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="16344.07,-559 15893.77,-559 15777.93,-455 16228.23,-455 16344.07,-559"/>
<text text-anchor="middle" x="16061" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="16061" y="-510" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="16061" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="16061" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_expert_0_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge180" class="edge">
<title>layer_0_expert_0_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M13986.89,-640.38C14021.01,-634.5 14056.52,-629.02 14090,-625 14717.39,-549.72 15463.2,-522.19 15831.6,-512.68"/>
<polygon fill="black" stroke="black" points="15831.94,-516.17 15841.85,-512.41 15831.76,-509.17 15831.94,-516.17"/>
</g>
<!-- layer_0_expert_1_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge181" class="edge">
<title>layer_0_expert_1_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M14550.35,-640.96C14584.34,-635.04 14619.7,-629.4 14653,-625 15070.36,-569.92 15560.96,-536.1 15839,-519.8"/>
<polygon fill="black" stroke="black" points="15839.43,-523.28 15849.21,-519.2 15839.02,-516.29 15839.43,-523.28"/>
</g>
<!-- layer_0_expert_2_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge182" class="edge">
<title>layer_0_expert_2_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M15114.69,-642.23C15148.32,-636.24 15183.2,-630.25 15216,-625 15433.23,-590.26 15682.86,-556.45 15854.16,-534.18"/>
<polygon fill="black" stroke="black" points="15854.83,-537.62 15864.3,-532.86 15853.93,-530.68 15854.83,-537.62"/>
</g>
<!-- layer_0_expert_3_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge183" class="edge">
<title>layer_0_expert_3_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M15661.6,-627.18C15730.9,-606.5 15811.84,-582.35 15882.67,-561.21"/>
<polygon fill="black" stroke="black" points="15884.01,-564.47 15892.59,-558.25 15882.01,-557.76 15884.01,-564.47"/>
</g>
<!-- layer_0_expert_4_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge184" class="edge">
<title>layer_0_expert_4_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M16061,-624.68C16061,-607.18 16061,-587.43 16061,-569.22"/>
<polygon fill="black" stroke="black" points="16064.5,-569 16061,-559 16057.5,-569 16064.5,-569"/>
</g>
<!-- layer_0_expert_5_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge185" class="edge">
<title>layer_0_expert_5_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M16452.79,-624.91C16386.19,-605.04 16309.8,-582.24 16242.26,-562.09"/>
<polygon fill="black" stroke="black" points="16242.95,-558.64 16232.37,-559.14 16240.95,-565.35 16242.95,-558.64"/>
</g>
<!-- layer_0_expert_6_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge186" class="edge">
<title>layer_0_expert_6_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M16915.6,-626.55C16912.38,-626.02 16909.18,-625.51 16906,-625 16715.84,-594.59 16500.86,-564.89 16335.33,-543.02"/>
<polygon fill="black" stroke="black" points="16335.37,-539.5 16325,-541.66 16334.45,-546.44 16335.37,-539.5"/>
</g>
<!-- layer_0_expert_7_ep_7&#45;&gt;layer_0_agg_ep_7 -->
<g id="edge187" class="edge">
<title>layer_0_expert_7_ep_7&#45;&gt;layer_0_agg_ep_7</title>
<path fill="none" stroke="black" d="M17478.27,-626.25C17475.16,-625.82 17472.07,-625.41 17469,-625 17065.9,-571.8 16594.48,-538.44 16312.24,-521.53"/>
<polygon fill="black" stroke="black" points="16312.05,-518.01 16301.86,-520.91 16311.63,-525 16312.05,-518.01"/>
</g>
<!-- layer_{layer_id}_moe_alltoall -->
<g id="node1657" class="node">
<title>layer_{layer_id}_moe_alltoall</title>
<polygon fill="lightyellow" stroke="black" points="579149.67,-235 578957.71,-235 578908.33,-199 579100.29,-199 579149.67,-235"/>
<text text-anchor="middle" x="579029" y="-214.5" font-family="Arial" font-size="10.00">layer_{layer_id}_moe_alltoall</text>
</g>
<!-- layer_0_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge125" class="edge">
<title>layer_0_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M7272.51,-501.85C7896.95,-490.27 9736.8,-457.76 11265,-447 11265,-447 145231,-437 145231,-437 145243.91,-434.98 145246.22,-430.73 145259,-428 145294.64,-420.39 145393.15,-432.26 145422,-410 145464.22,-377.43 145422.31,-329.95 145465,-298 145471.07,-293.46 145593.43,-287.31 145601,-287 145914.3,-274.34 506504.44,-269.12 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge134" class="edge">
<title>layer_0_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M11776.51,-501.85C12400.95,-490.27 14240.8,-457.76 15769,-447 15769,-447 145256,-437 145256,-437 145268.91,-434.98 145271.2,-430.66 145284,-428 145323.57,-419.77 145433.06,-434.77 145465,-410 145506.89,-377.52 145463.9,-330.21 145506,-298 145517.25,-289.39 145618.85,-287.61 145633,-287 145946.24,-273.45 506504.47,-269.12 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge143" class="edge">
<title>layer_0_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M29792.51,-501.85C30416.95,-490.27 32256.8,-457.77 33785,-447 33785,-447 145356,-437 145356,-437 145368.91,-434.97 145371.17,-430.51 145384,-428 145436.05,-417.81 145580.09,-442.5 145622,-410 145663.54,-377.79 145619.55,-331.57 145660,-298 145673.3,-286.96 145719.76,-288.23 145737,-287 145737,-287 506818,-269 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge152" class="edge">
<title>layer_0_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M34291.65,-497.49C34654.15,-483.59 35410.78,-456.59 36051,-447 36051,-447 145381,-437 145381,-437 145393.91,-434.97 145396.17,-430.49 145409,-428 145436.45,-422.68 145637.87,-427.09 145660,-410 145701.6,-377.87 145658.56,-332.75 145698,-298 145707.19,-289.9 145739.82,-288.23 145752,-287 145752,-287 506818,-269 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge161" class="edge">
<title>layer_0_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M20784.51,-501.85C21408.95,-490.27 23248.8,-457.77 24777,-447 24777,-447 145306,-437 145306,-437 145318.91,-434.98 145321.18,-430.57 145334,-428 145380.14,-418.74 145507.84,-438.87 145545,-410 145586.63,-377.67 145542.69,-330.73 145584,-298 145593.19,-290.72 145677.29,-287.61 145689,-287 146002.05,-270.64 506504.52,-269.12 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge170" class="edge">
<title>layer_0_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M2768.51,-501.85C3392.95,-490.27 5232.8,-457.76 6761,-447 8669.38,-433.57 142259.69,-458.36 144168,-437 144235.23,-436.25 145322.86,-448.49 145378,-410 145421.85,-379.39 145378.9,-329.67 145422,-298 145428.96,-292.89 145568.37,-287.31 145577,-287 145890.38,-275.89 506504.42,-269.12 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge179" class="edge">
<title>layer_0_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M25288.51,-501.85C25912.95,-490.27 27752.8,-457.77 29281,-447 29281,-447 145331,-437 145331,-437 145343.91,-434.98 145346.18,-430.54 145359,-428 145408.21,-418.26 145544.43,-440.82 145584,-410 145625.47,-377.7 145581.33,-331.31 145622,-298 145629.37,-291.97 145697.5,-287.61 145707,-287 145707,-287 506818,-269 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge188" class="edge">
<title>layer_0_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M16280.51,-501.85C16904.95,-490.27 18744.8,-457.76 20273,-447 20273,-447 145281,-437 145281,-437 145293.91,-434.98 145296.19,-430.61 145309,-428 145352.07,-419.22 145471.36,-437.07 145506,-410 145547.53,-377.54 145503.49,-330.48 145545,-298 145555.46,-289.82 145650.74,-287.61 145664,-287 145977.17,-272.55 506504.5,-269.12 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_0_moe_alltoall -->
<g id="node100" class="node">
<title>layer_0_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="24595" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="24595" y="-1031" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="24595" y="-1020" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="24595" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="24595" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_0_ln_tp_0 -->
<g id="node101" class="node">
<title>layer_0_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="32735.07,-1069 32284.77,-1069 32168.93,-965 32619.23,-965 32735.07,-1069"/>
<text text-anchor="middle" x="32452" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="32452" y="-1020" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="32452" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="32452" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_qkv_tp_0 -->
<g id="node105" class="node">
<title>layer_1_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="70355.7,-899 69913.94,-899 69800.3,-795 70242.06,-795 70355.7,-899"/>
<text text-anchor="middle" x="70078" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="70078" y="-850" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="70078" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="70078" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_0_ln_tp_0&#45;&gt;layer_1_qkv_tp_0 -->
<g id="edge3077" class="edge">
<title>layer_0_ln_tp_0&#45;&gt;layer_1_qkv_tp_0</title>
<path fill="none" stroke="black" d="M32629.92,-974.52C32667.4,-967.34 32706.84,-960.93 32744,-957 33112.19,-918.05 34039.76,-940.15 34410,-938 34471.42,-937.64 69730.17,-938.53 69791,-930 69833.16,-924.09 69877.83,-913.53 69919.04,-901.91"/>
<polygon fill="black" stroke="black" points="69920.23,-905.21 69928.88,-899.09 69918.31,-898.48 69920.23,-905.21"/>
</g>
<!-- layer_0_ln_tp_1 -->
<g id="node102" class="node">
<title>layer_0_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="34297.07,-1069 33846.77,-1069 33730.93,-965 34181.23,-965 34297.07,-1069"/>
<text text-anchor="middle" x="34014" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="34014" y="-1020" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="34014" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="34014" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_qkv_tp_1 -->
<g id="node106" class="node">
<title>layer_1_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="70929.7,-899 70487.94,-899 70374.3,-795 70816.06,-795 70929.7,-899"/>
<text text-anchor="middle" x="70652" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="70652" y="-850" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="70652" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="70652" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_0_ln_tp_1&#45;&gt;layer_1_qkv_tp_1 -->
<g id="edge3078" class="edge">
<title>layer_0_ln_tp_1&#45;&gt;layer_1_qkv_tp_1</title>
<path fill="none" stroke="black" d="M34192.34,-974.74C34229.7,-967.57 34268.99,-961.11 34306,-957 34695.26,-913.82 34795.38,-942.27 35187,-938 35248.07,-937.33 70304.52,-938.48 70365,-930 70407.16,-924.09 70451.83,-913.53 70493.04,-901.91"/>
<polygon fill="black" stroke="black" points="70494.23,-905.21 70502.88,-899.09 70492.31,-898.48 70494.23,-905.21"/>
</g>
<!-- layer_0_ln_tp_2 -->
<g id="node103" class="node">
<title>layer_0_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="34881.07,-1069 34430.77,-1069 34314.93,-965 34765.23,-965 34881.07,-1069"/>
<text text-anchor="middle" x="34598" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="34598" y="-1020" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="34598" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="34598" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_qkv_tp_2 -->
<g id="node107" class="node">
<title>layer_1_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="71503.7,-899 71061.94,-899 70948.3,-795 71390.06,-795 71503.7,-899"/>
<text text-anchor="middle" x="71226" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="71226" y="-850" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="71226" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="71226" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_0_ln_tp_2&#45;&gt;layer_1_qkv_tp_2 -->
<g id="edge3079" class="edge">
<title>layer_0_ln_tp_2&#45;&gt;layer_1_qkv_tp_2</title>
<path fill="none" stroke="black" d="M34775.89,-974.27C34813.37,-967.11 34852.82,-960.77 34890,-957 35306.76,-914.79 42011.11,-938.59 42430,-938 42479.49,-937.93 70889.98,-936.87 70939,-930 70981.16,-924.09 71025.83,-913.53 71067.04,-901.9"/>
<polygon fill="black" stroke="black" points="71068.23,-905.2 71076.88,-899.09 71066.31,-898.47 71068.23,-905.2"/>
</g>
<!-- layer_0_ln_tp_3 -->
<g id="node104" class="node">
<title>layer_0_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="35465.07,-1069 35014.77,-1069 34898.93,-965 35349.23,-965 35465.07,-1069"/>
<text text-anchor="middle" x="35182" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="35182" y="-1020" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="35182" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="35182" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_qkv_tp_3 -->
<g id="node108" class="node">
<title>layer_1_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="72077.7,-899 71635.94,-899 71522.3,-795 71964.06,-795 72077.7,-899"/>
<text text-anchor="middle" x="71800" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="71800" y="-850" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="71800" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="71800" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_0_ln_tp_3&#45;&gt;layer_1_qkv_tp_3 -->
<g id="edge3080" class="edge">
<title>layer_0_ln_tp_3&#45;&gt;layer_1_qkv_tp_3</title>
<path fill="none" stroke="black" d="M35359.89,-974.21C35397.37,-967.06 35436.82,-960.73 35474,-957 35723.02,-932 71265.16,-964.81 71513,-930 71555.16,-924.08 71599.83,-913.51 71641.04,-901.89"/>
<polygon fill="black" stroke="black" points="71642.23,-905.19 71650.88,-899.08 71640.31,-898.46 71642.23,-905.19"/>
</g>
<!-- layer_1_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge197" class="edge">
<title>layer_1_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M70257.63,-809.1C70293.07,-803.23 70330.09,-798.08 70365,-795 70621.62,-772.34 144302.4,-780.21 144560,-777 144598.23,-776.52 145218.22,-783.98 145248,-760 145296.11,-721.26 145233.71,-664.73 145281,-625 145304.02,-605.66 145521.06,-609.79 145551,-607 145584.43,-603.88 145592.49,-600 145626,-598 145626,-598 578896,-590 578896,-590 578940.94,-545.06 578940.93,-491.95 578896,-447 578851.84,-402.83 507000.46,-428.01 506938,-428 506624.56,-427.95 146172.16,-423.14 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_1_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge198" class="edge">
<title>layer_1_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M70831.63,-809.1C70867.07,-803.23 70904.09,-798.08 70939,-795 71195.94,-772.32 144970.96,-815.55 145226,-777 145251.3,-773.18 145263.14,-778.32 145281,-760 145324.51,-715.37 145270.43,-664.07 145319,-625 145345.62,-603.58 145592.07,-611.03 145626,-607 145648.42,-604.33 145653.51,-600.01 145676,-598 145676,-598 578932,-590 578932,-590 578984.13,-549.91 578919.15,-488.7 578970,-447 578997.37,-424.55 579104.76,-462.81 579129,-437 579131.74,-434.08 579131.83,-430.83 579129,-428 579129,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_1_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge199" class="edge">
<title>layer_1_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M71405.63,-809.1C71441.07,-803.23 71478.09,-798.08 71513,-795 71640.56,-783.74 145150.2,-800.98 145276,-777 145296.19,-773.15 145303.51,-773.51 145319,-760 145370.89,-714.74 145336.7,-661.63 145395,-625 145421.49,-608.35 145644.9,-610.44 145676,-607 145701.49,-604.18 145707.43,-600.01 145733,-598 145733,-598 578970,-590 578970,-590 579022.13,-549.91 578957.27,-488.85 579008,-447 579033.09,-426.31 579131.8,-460.77 579154,-437 579156.73,-434.08 579156.83,-430.83 579154,-428 579154,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_1_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge200" class="edge">
<title>layer_1_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M72019.72,-845.92C76409.35,-844.4 145104.52,-819.8 145348,-777 145461.12,-757.12 145450.85,-668.87 145557,-625 145572.57,-618.57 145842.17,-598.75 145859,-598 145859,-598 579008,-590 579008,-590 579062.43,-550.86 579003.2,-488.32 579056,-447 579077.6,-430.1 579160.41,-457.16 579179,-437 579181.71,-434.06 579181.83,-430.83 579179,-428 579179,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_1_qkv_comm -->
<g id="node109" class="node">
<title>layer_1_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="69589" cy="-847" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="69589" y="-861" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="69589" y="-850" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="69589" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="69589" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_1_attn_tp_0 -->
<g id="node110" class="node">
<title>layer_1_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="66630.7,-899 66188.94,-899 66075.3,-795 66517.06,-795 66630.7,-899"/>
<text text-anchor="middle" x="66353" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="66353" y="-850" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="66353" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="66353" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_out_tp_0 -->
<g id="node114" class="node">
<title>layer_1_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="72040.7,-729 71598.94,-729 71485.3,-625 71927.06,-625 72040.7,-729"/>
<text text-anchor="middle" x="71763" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="71763" y="-680" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="71763" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="71763" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_tp_0&#45;&gt;layer_1_attn_out_tp_0 -->
<g id="edge205" class="edge">
<title>layer_1_attn_tp_0&#45;&gt;layer_1_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M66533.22,-809.66C66568.18,-803.8 66604.63,-798.51 66639,-795 67075.55,-750.36 67187.22,-774.46 67626,-768 67678.55,-767.23 71357.79,-766.04 71410,-760 71467.49,-753.35 71529.23,-740.89 71584.76,-727.66"/>
<polygon fill="black" stroke="black" points="71585.78,-731.01 71594.69,-725.27 71584.15,-724.21 71585.78,-731.01"/>
</g>
<!-- layer_1_attn_tp_1 -->
<g id="node111" class="node">
<title>layer_1_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="66056.7,-899 65614.94,-899 65501.3,-795 65943.06,-795 66056.7,-899"/>
<text text-anchor="middle" x="65779" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="65779" y="-850" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="65779" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="65779" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_out_tp_1 -->
<g id="node115" class="node">
<title>layer_1_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="71400.7,-729 70958.94,-729 70845.3,-625 71287.06,-625 71400.7,-729"/>
<text text-anchor="middle" x="71123" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="71123" y="-680" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="71123" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="71123" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_tp_1&#45;&gt;layer_1_attn_out_tp_1 -->
<g id="edge207" class="edge">
<title>layer_1_attn_tp_1&#45;&gt;layer_1_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M65959.49,-809.93C65994.69,-804.03 66031.4,-798.66 66066,-795 66407.86,-758.84 66495.29,-774.36 66839,-768 66946.34,-766.01 70597.15,-770.47 70704,-760 70781.5,-752.41 70865.96,-737.24 70938.61,-721.99"/>
<polygon fill="black" stroke="black" points="70939.72,-725.33 70948.78,-719.83 70938.27,-718.48 70939.72,-725.33"/>
</g>
<!-- layer_1_attn_tp_2 -->
<g id="node112" class="node">
<title>layer_1_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="65482.7,-899 65040.94,-899 64927.3,-795 65369.06,-795 65482.7,-899"/>
<text text-anchor="middle" x="65205" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="65205" y="-850" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="65205" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="65205" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_out_tp_2 -->
<g id="node116" class="node">
<title>layer_1_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="70694.7,-729 70252.94,-729 70139.3,-625 70581.06,-625 70694.7,-729"/>
<text text-anchor="middle" x="70417" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="70417" y="-680" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="70417" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="70417" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_tp_2&#45;&gt;layer_1_attn_out_tp_2 -->
<g id="edge209" class="edge">
<title>layer_1_attn_tp_2&#45;&gt;layer_1_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M65385.48,-809.89C65420.68,-803.99 65457.4,-798.63 65492,-795 65850.67,-757.36 65942.41,-774.41 66303,-768 66401.93,-766.24 69766.33,-767.4 69865,-760 69984.92,-751.01 70118.31,-731.46 70223.93,-713.7"/>
<polygon fill="black" stroke="black" points="70224.79,-717.11 70234.06,-711.99 70223.62,-710.21 70224.79,-717.11"/>
</g>
<!-- layer_1_attn_tp_3 -->
<g id="node113" class="node">
<title>layer_1_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="64908.7,-899 64466.94,-899 64353.3,-795 64795.06,-795 64908.7,-899"/>
<text text-anchor="middle" x="64631" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="64631" y="-850" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="64631" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="64631" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_out_tp_3 -->
<g id="node117" class="node">
<title>layer_1_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="69855.7,-729 69413.94,-729 69300.3,-625 69742.06,-625 69855.7,-729"/>
<text text-anchor="middle" x="69578" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="69578" y="-680" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="69578" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="69578" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_1_attn_tp_3&#45;&gt;layer_1_attn_out_tp_3 -->
<g id="edge211" class="edge">
<title>layer_1_attn_tp_3&#45;&gt;layer_1_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M64811.48,-809.87C64846.68,-803.97 64883.4,-798.62 64918,-795 65285.08,-756.61 65378.97,-774.49 65748,-768 65915.36,-765.06 68593.83,-768.59 68761,-760 68970.69,-749.22 69209.54,-723.7 69374.59,-703.97"/>
<polygon fill="black" stroke="black" points="69375.34,-707.41 69384.85,-702.74 69374.51,-700.46 69375.34,-707.41"/>
</g>
<!-- layer_1_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge206" class="edge">
<title>layer_1_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M71903.99,-729.12C71963.32,-748.42 72033.63,-767.93 72099,-777.5 72346.51,-813.72 107869.85,-777.84 108120,-777.5 123853.03,-756.13 143350.07,-683.62 144997.94,-677.42"/>
<polygon fill="black" stroke="black" points="144998,-680.92 145007.99,-677.39 144997.98,-673.92 144998,-680.92"/>
</g>
<!-- layer_1_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge208" class="edge">
<title>layer_1_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M71275.21,-729.13C71339.17,-748.44 71414.88,-767.95 71485,-777.5 71737.08,-811.84 107865.59,-777.85 108120,-777.5 123853.03,-756.13 143350.07,-683.62 144997.94,-677.42"/>
<polygon fill="black" stroke="black" points="144998,-680.92 145007.99,-677.39 144997.98,-673.92 144998,-680.92"/>
</g>
<!-- layer_1_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge210" class="edge">
<title>layer_1_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M70597.07,-729.02C70672.91,-748.38 70762.55,-767.95 70845,-777.5 71102.13,-807.28 107861.15,-777.85 108120,-777.5 123853.03,-756.13 143350.07,-683.62 144997.94,-677.42"/>
<polygon fill="black" stroke="black" points="144998,-680.92 145007.99,-677.39 144997.98,-673.92 144998,-680.92"/>
</g>
<!-- layer_1_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge212" class="edge">
<title>layer_1_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M69814.92,-729.05C69914.46,-748.41 70031.82,-767.98 70139,-777.5 70401.72,-800.85 107856.24,-777.86 108120,-777.5 123853.03,-756.13 143350.07,-683.62 144997.94,-677.42"/>
<polygon fill="black" stroke="black" points="144998,-680.92 145007.99,-677.39 144997.98,-673.92 144998,-680.92"/>
</g>
<!-- layer_1_attn_allreduce -->
<g id="node118" class="node">
<title>layer_1_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="66845" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="66845" y="-861" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="66845" y="-850" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="66845" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="66845" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_gate_tp_0 -->
<g id="node119" class="node">
<title>layer_1_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="56888.99,-899 56440.4,-899 56325.01,-795 56773.6,-795 56888.99,-899"/>
<text text-anchor="middle" x="56607" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="56607" y="-850" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="56607" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="56607" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_1_route_ep_0 -->
<g id="node123" class="node">
<title>layer_1_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="64580.43,-729 64121.6,-729 64003.57,-625 64462.4,-625 64580.43,-729"/>
<text text-anchor="middle" x="64292" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="64292" y="-680" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="64292" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="64292" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_0 -->
<g id="edge213" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56789.55,-809.14C56825.36,-803.29 56862.75,-798.14 56898,-795 57141.32,-773.34 61050.76,-781.53 61295,-777 62328.9,-757.81 63562.67,-708.8 64063.71,-687.8"/>
<polygon fill="black" stroke="black" points="64064.11,-691.28 64073.95,-687.37 64063.81,-684.29 64064.11,-691.28"/>
<text text-anchor="middle" x="61728" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_1 -->
<g id="node124" class="node">
<title>layer_1_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="59989.43,-729 59530.6,-729 59412.57,-625 59871.4,-625 59989.43,-729"/>
<text text-anchor="middle" x="59701" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="59701" y="-680" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="59701" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="59701" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_1 -->
<g id="edge214" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56790.43,-810.07C56826,-804.18 56863.07,-798.77 56898,-795 56929.9,-791.55 58809.64,-714.46 59472.59,-687.34"/>
<polygon fill="black" stroke="black" points="59472.89,-690.83 59482.74,-686.92 59472.61,-683.83 59472.89,-690.83"/>
<text text-anchor="middle" x="57477" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_2 -->
<g id="node125" class="node">
<title>layer_1_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="68752.43,-729 68293.6,-729 68175.57,-625 68634.4,-625 68752.43,-729"/>
<text text-anchor="middle" x="68464" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="68464" y="-680" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="68464" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="68464" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_2 -->
<g id="edge215" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56789.54,-809.09C56825.36,-803.25 56862.75,-798.11 56898,-795 57107.71,-776.51 64266.52,-781.37 64477,-777 64579.28,-774.88 64604.75,-771.23 64707,-768 66039.86,-725.96 67639.26,-693.68 68229.99,-682.37"/>
<polygon fill="black" stroke="black" points="68230.39,-685.87 68240.33,-682.18 68230.26,-678.87 68230.39,-685.87"/>
<text text-anchor="middle" x="64733" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_3 -->
<g id="node126" class="node">
<title>layer_1_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="39651.43,-729 39192.6,-729 39074.57,-625 39533.4,-625 39651.43,-729"/>
<text text-anchor="middle" x="39363" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="39363" y="-680" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="39363" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="39363" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_3 -->
<g id="edge216" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56326.02,-795.94C56322.66,-795.61 56319.32,-795.29 56316,-795 56003,-767.28 50973.81,-793.15 50660,-777 50619.85,-774.93 50610.15,-770.02 50570,-768 50371.5,-757.99 43613.74,-762.12 43415,-760 41973.86,-744.61 40244.82,-701.35 39611.21,-684.67"/>
<polygon fill="black" stroke="black" points="39611.13,-681.17 39601.04,-684.41 39610.94,-688.17 39611.13,-681.17"/>
<text text-anchor="middle" x="50686" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_4 -->
<g id="node127" class="node">
<title>layer_1_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="53451.43,-729 52992.6,-729 52874.57,-625 53333.4,-625 53451.43,-729"/>
<text text-anchor="middle" x="53163" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="53163" y="-680" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="53163" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="53163" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_4 -->
<g id="edge217" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56326.36,-796.4C56322.89,-795.92 56319.43,-795.46 56316,-795 56283.15,-790.64 56052.07,-770.02 56019,-768 55052.98,-708.92 53900.64,-687.62 53407.01,-680.83"/>
<polygon fill="black" stroke="black" points="53406.96,-677.33 53396.91,-680.69 53406.86,-684.33 53406.96,-677.33"/>
<text text-anchor="middle" x="56146" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_5 -->
<g id="node128" class="node">
<title>layer_1_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="44000.43,-729 43541.6,-729 43423.57,-625 43882.4,-625 44000.43,-729"/>
<text text-anchor="middle" x="43712" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="43712" y="-680" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="43712" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="43712" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_5 -->
<g id="edge218" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56326.02,-795.95C56322.66,-795.61 56319.32,-795.3 56316,-795 55955.67,-762.66 53421.62,-787.98 53060,-777 52987.48,-774.8 52969.53,-770.06 52897,-768 52361.33,-752.78 48609.86,-765.48 48074,-760 46507.42,-743.98 44624.76,-700.32 43959.47,-684.14"/>
<polygon fill="black" stroke="black" points="43959.37,-680.63 43949.28,-683.89 43959.19,-687.63 43959.37,-680.63"/>
<text text-anchor="middle" x="53086" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_6 -->
<g id="node129" class="node">
<title>layer_1_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="56748.43,-729 56289.6,-729 56171.57,-625 56630.4,-625 56748.43,-729"/>
<text text-anchor="middle" x="56460" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="56460" y="-680" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="56460" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="56460" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_6 -->
<g id="edge219" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56562.1,-794.68C56546.07,-776.36 56527.89,-755.59 56511.36,-736.69"/>
<polygon fill="black" stroke="black" points="56513.85,-734.23 56504.63,-729 56508.58,-738.83 56513.85,-734.23"/>
<text text-anchor="middle" x="56568" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_route_ep_7 -->
<g id="node130" class="node">
<title>layer_1_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="48659.43,-729 48200.6,-729 48082.57,-625 48541.4,-625 48659.43,-729"/>
<text text-anchor="middle" x="48371" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="48371" y="-680" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="48371" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="48371" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_7 -->
<g id="edge220" class="edge">
<title>layer_1_gate_tp_0&#45;&gt;layer_1_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56326.01,-796C56322.66,-795.65 56319.32,-795.32 56316,-795 56269.76,-790.6 54690.45,-768.48 54644,-768 53853.81,-759.84 53656.18,-768.98 52866,-760 51245.63,-741.58 49297.02,-699.1 48618.35,-683.71"/>
<polygon fill="black" stroke="black" points="48618.03,-680.2 48607.95,-683.47 48617.87,-687.2 48618.03,-680.2"/>
<text text-anchor="middle" x="55265" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1 -->
<g id="node120" class="node">
<title>layer_1_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="56306.99,-899 55858.4,-899 55743.01,-795 56191.6,-795 56306.99,-899"/>
<text text-anchor="middle" x="56025" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="56025" y="-850" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="56025" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="56025" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_0 -->
<g id="edge221" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56207.56,-809.29C56243.37,-803.43 56280.76,-798.23 56316,-795 56417.85,-785.65 59895.73,-761.46 59998,-760 61548.52,-737.83 63413.71,-697.56 64059.01,-683.23"/>
<polygon fill="black" stroke="black" points="64059.44,-686.73 64069.36,-683 64059.28,-679.73 64059.44,-686.73"/>
<text text-anchor="middle" x="58916" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_1 -->
<g id="edge222" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56207.98,-809.57C56243.67,-803.71 56280.91,-798.44 56316,-795 56682.78,-759.09 56776.9,-794.9 57145,-777 57197.98,-774.42 57211.04,-770.98 57264,-768 58073.19,-722.48 59034.89,-694.71 59468.54,-683.6"/>
<polygon fill="black" stroke="black" points="59468.77,-687.1 59478.68,-683.34 59468.59,-680.1 59468.77,-687.1"/>
<text text-anchor="middle" x="57290" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_2 -->
<g id="edge223" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56207.54,-809.1C56243.36,-803.25 56280.75,-798.11 56316,-795 56508.78,-777.98 63089.48,-778.51 63283,-777 63863.48,-772.47 64008.59,-769.92 64589,-760 65970.94,-736.38 67629.89,-697.88 68231.67,-683.58"/>
<polygon fill="black" stroke="black" points="68231.85,-687.07 68241.76,-683.34 68231.68,-680.07 68231.85,-687.07"/>
<text text-anchor="middle" x="64116" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_3 -->
<g id="edge224" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55744.02,-795.94C55740.66,-795.61 55737.32,-795.29 55734,-795 55589.68,-782.2 50662.89,-777.54 50518,-777 49511.78,-773.26 49260.23,-770.83 48254,-768 47178.67,-764.97 44490.27,-771.77 43415,-760 41973.86,-744.23 40244.82,-701.2 39611.21,-684.63"/>
<polygon fill="black" stroke="black" points="39611.13,-681.12 39601.04,-684.36 39610.94,-688.12 39611.13,-681.12"/>
<text text-anchor="middle" x="50544" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_4 -->
<g id="edge225" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55985.64,-794.74C55974.7,-784 55961.95,-774.1 55948,-768 55832.7,-717.6 54064.82,-689.67 53407.06,-680.98"/>
<polygon fill="black" stroke="black" points="53407.03,-677.48 53396.98,-680.85 53406.94,-684.48 53407.03,-677.48"/>
<text text-anchor="middle" x="55989" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_5 -->
<g id="edge226" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55744.02,-795.95C55740.66,-795.62 55737.32,-795.3 55734,-795 55414.29,-766.19 53165.95,-782.77 52845,-777 52710.3,-774.58 52676.71,-770.12 52542,-768 51549.23,-752.37 49066.84,-770.22 48074,-760 46507.42,-743.87 44624.76,-700.28 43959.47,-684.13"/>
<polygon fill="black" stroke="black" points="43959.37,-680.62 43949.28,-683.88 43959.2,-687.62 43959.37,-680.62"/>
<text text-anchor="middle" x="52871" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_6 -->
<g id="edge227" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56212.75,-813.75C56285.87,-800.2 56355.86,-785.62 56371,-777 56388.62,-766.97 56404.61,-752.19 56418.02,-737.09"/>
<polygon fill="black" stroke="black" points="56420.94,-739.06 56424.8,-729.19 56415.63,-734.51 56420.94,-739.06"/>
<text text-anchor="middle" x="56409" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_7 -->
<g id="edge228" class="edge">
<title>layer_1_gate_tp_1&#45;&gt;layer_1_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55744.01,-795.99C55740.66,-795.65 55737.32,-795.32 55734,-795 55228.65,-747.04 55097.54,-822.85 54592,-777 54567.77,-774.8 54562.24,-770.06 54538,-768 54445.45,-760.12 52958.88,-761.07 52866,-760 51245.63,-741.34 49297.02,-699.01 48618.35,-683.68"/>
<polygon fill="black" stroke="black" points="48618.03,-680.17 48607.95,-683.45 48617.87,-687.17 48618.03,-680.17"/>
<text text-anchor="middle" x="54618" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2 -->
<g id="node121" class="node">
<title>layer_1_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="57470.99,-899 57022.4,-899 56907.01,-795 57355.6,-795 57470.99,-899"/>
<text text-anchor="middle" x="57189" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="57189" y="-850" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="57189" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="57189" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_0 -->
<g id="edge229" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57408.33,-842.3C57961.37,-833.07 59457.6,-808.81 60705,-795 61228.32,-789.2 62537.16,-799.97 63060,-777 63417.33,-761.3 63831.66,-724.07 64077.26,-700.01"/>
<polygon fill="black" stroke="black" points="64077.76,-703.47 64087.37,-699.01 64077.08,-696.51 64077.76,-703.47"/>
<text text-anchor="middle" x="63253" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_1 -->
<g id="edge230" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57375.97,-813.29C57475.2,-797.13 57599.39,-778.83 57711,-768 58343.12,-706.64 59092.36,-687 59465.41,-680.8"/>
<polygon fill="black" stroke="black" points="59465.58,-684.3 59475.52,-680.63 59465.46,-677.3 59465.58,-684.3"/>
<text text-anchor="middle" x="57737" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_2 -->
<g id="edge231" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57407.82,-842.06C57960.44,-832.28 59457.19,-806.82 60705,-795 62508.49,-777.92 62959.68,-807.43 64763,-777 64899.48,-774.7 64933.55,-771.81 65070,-768 66259.17,-734.8 67682.8,-698.01 68232.1,-683.93"/>
<polygon fill="black" stroke="black" points="68232.21,-687.42 68242.12,-683.67 68232.03,-680.43 68232.21,-687.42"/>
<text text-anchor="middle" x="65096" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_3 -->
<g id="edge232" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56908.02,-795.94C56904.66,-795.61 56901.32,-795.3 56898,-795 56632.49,-771.41 52366.55,-778.36 52100,-777 51483.11,-773.84 51328.9,-770.34 50712,-768 49901.23,-764.93 44225.73,-768.65 43415,-760 41973.86,-744.63 40244.82,-701.36 39611.21,-684.68"/>
<polygon fill="black" stroke="black" points="39611.13,-681.17 39601.04,-684.41 39610.94,-688.17 39611.13,-681.17"/>
<text text-anchor="middle" x="52126" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_4 -->
<g id="edge233" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56908.01,-796.05C56904.65,-795.68 56901.32,-795.33 56898,-795 56607.36,-765.71 56532.12,-801.07 56241,-777 56211.93,-774.6 56205.06,-770.44 56176,-768 55640.83,-723.09 54027.05,-692.34 53408.21,-681.91"/>
<polygon fill="black" stroke="black" points="53407.88,-678.41 53397.82,-681.74 53407.76,-685.41 53407.88,-678.41"/>
<text text-anchor="middle" x="56267" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_5 -->
<g id="edge234" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56908.01,-795.95C56904.66,-795.62 56901.32,-795.3 56898,-795 56755.47,-782.1 54465.11,-778.03 54322,-777 53784.22,-773.12 53649.79,-770.43 53112,-768 51992.45,-762.95 49193.5,-771.41 48074,-760 46507.42,-744.03 44624.76,-700.34 43959.47,-684.14"/>
<polygon fill="black" stroke="black" points="43959.37,-680.64 43949.28,-683.9 43959.19,-687.64 43959.37,-680.64"/>
<text text-anchor="middle" x="54348" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_6 -->
<g id="edge235" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56967.31,-794.91C56879.99,-774.79 56779.69,-751.67 56691.45,-731.34"/>
<polygon fill="black" stroke="black" points="56692.11,-727.9 56681.58,-729.06 56690.54,-734.72 56692.11,-727.9"/>
<text text-anchor="middle" x="56894" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_7 -->
<g id="edge236" class="edge">
<title>layer_1_gate_tp_2&#45;&gt;layer_1_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56908.01,-796C56904.66,-795.65 56901.32,-795.32 56898,-795 56654.18,-771.79 56040.89,-781.2 55796,-777 55573.33,-773.18 55517.69,-770.37 55295,-768 54215.5,-756.53 53945.5,-771.62 52866,-760 51245.61,-742.55 49297.01,-699.47 48618.34,-683.81"/>
<polygon fill="black" stroke="black" points="48618.03,-680.3 48607.95,-683.57 48617.87,-687.3 48618.03,-680.3"/>
<text text-anchor="middle" x="55822" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3 -->
<g id="node122" class="node">
<title>layer_1_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="55724.99,-899 55276.4,-899 55161.01,-795 55609.6,-795 55724.99,-899"/>
<text text-anchor="middle" x="55443" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="55443" y="-850" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="55443" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="55443" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_0 -->
<g id="edge237" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55625.96,-809.39C55661.66,-803.54 55698.89,-798.32 55734,-795 55997.3,-770.09 56659.69,-786.2 56924,-777 56997.4,-774.44 57015.59,-770.1 57089,-768 57412.09,-758.75 59674.8,-763.53 59998,-760 61549.05,-743.06 63414.85,-699.5 64059.59,-683.77"/>
<polygon fill="black" stroke="black" points="64060.02,-687.26 64069.93,-683.52 64059.85,-680.27 64060.02,-687.26"/>
<text text-anchor="middle" x="57115" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_1 -->
<g id="edge238" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55626.4,-809.81C55661.97,-803.94 55699.05,-798.61 55734,-795 55857.63,-782.24 56171.45,-802.94 56293,-777 56303.33,-774.8 56304.65,-770.13 56315,-768 56363.11,-758.09 56707.89,-761.13 56757,-760 57767.92,-736.77 58973.86,-700.5 59470.21,-685.19"/>
<polygon fill="black" stroke="black" points="59470.47,-688.69 59480.35,-684.88 59470.25,-681.69 59470.47,-688.69"/>
<text text-anchor="middle" x="56341" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_2 -->
<g id="edge239" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55625.56,-809.28C55661.37,-803.41 55698.76,-798.22 55734,-795 55958.52,-774.47 57537.74,-786.23 57763,-777 57817.77,-774.76 57831.22,-770.03 57886,-768 58258.13,-754.18 64216.63,-764.16 64589,-760 65971.68,-744.55 67631.44,-701.07 68232.5,-684.51"/>
<polygon fill="black" stroke="black" points="68232.68,-688.01 68242.58,-684.23 68232.49,-681.01 68232.68,-688.01"/>
<text text-anchor="middle" x="57912" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_3 -->
<g id="edge240" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55216.66,-845.49C54006.76,-842.5 48179.67,-825.24 43415,-760 41973.47,-740.26 40243.79,-699.59 39610.64,-684.14"/>
<polygon fill="black" stroke="black" points="39610.56,-680.64 39600.47,-683.89 39610.39,-687.63 39610.56,-680.64"/>
<text text-anchor="middle" x="44745" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_4 -->
<g id="edge241" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55198.12,-828.53C55004.76,-814.69 54728.13,-794.79 54486,-777 54118.03,-749.97 53692.54,-718 53425.6,-697.86"/>
<polygon fill="black" stroke="black" points="53425.62,-694.35 53415.38,-697.09 53425.09,-701.33 53425.62,-694.35"/>
<text text-anchor="middle" x="54512" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_5 -->
<g id="edge242" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55216.24,-844.87C54323.62,-840.22 50965.87,-820.64 48202,-777 46584.17,-751.46 44638.83,-702.27 43960.04,-684.56"/>
<polygon fill="black" stroke="black" points="43959.98,-681.06 43949.89,-684.29 43959.8,-688.05 43959.98,-681.06"/>
<text text-anchor="middle" x="48228" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_6 -->
<g id="edge243" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55629.61,-812.9C55664.3,-806.86 55700.24,-800.68 55734,-795 55910.15,-765.37 56110.6,-733.18 56256.19,-710.08"/>
<polygon fill="black" stroke="black" points="56256.81,-713.53 56266.13,-708.5 56255.71,-706.61 56256.81,-713.53"/>
<text text-anchor="middle" x="55918" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_7 -->
<g id="edge244" class="edge">
<title>layer_1_gate_tp_3&#45;&gt;layer_1_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55211.38,-840.64C54713.4,-829.11 53503.8,-801.03 52490,-777 51021.45,-742.19 49258.41,-699.52 48618.37,-684"/>
<polygon fill="black" stroke="black" points="48618.18,-680.5 48608.1,-683.75 48618.01,-687.5 48618.18,-680.5"/>
<text text-anchor="middle" x="52516" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_1_expert_0_ep_0 -->
<g id="node131" class="node">
<title>layer_1_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="63632.83,-559 63198.82,-559 63087.17,-455 63521.18,-455 63632.83,-559"/>
<text text-anchor="middle" x="63360" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="63360" y="-510" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="63360" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="63360" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_0_ep_0 -->
<g id="edge245" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M64032.66,-650.93C63912.74,-637 63768.87,-616.94 63641,-590 63604.48,-582.31 63565.79,-572.28 63529.18,-561.89"/>
<polygon fill="black" stroke="black" points="63529.99,-558.48 63519.42,-559.1 63528.07,-565.21 63529.99,-558.48"/>
</g>
<!-- layer_1_expert_1_ep_0 -->
<g id="node132" class="node">
<title>layer_1_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="64195.83,-559 63761.82,-559 63650.17,-455 64084.18,-455 64195.83,-559"/>
<text text-anchor="middle" x="63923" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="63923" y="-510" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="63923" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="63923" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_1_ep_0 -->
<g id="edge246" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M64179.78,-624.91C64137.03,-605.44 64088.12,-583.17 64044.53,-563.33"/>
<polygon fill="black" stroke="black" points="64045.87,-560.09 64035.32,-559.14 64042.97,-566.47 64045.87,-560.09"/>
</g>
<!-- layer_1_expert_2_ep_0 -->
<g id="node133" class="node">
<title>layer_1_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="64758.83,-559 64324.82,-559 64213.17,-455 64647.18,-455 64758.83,-559"/>
<text text-anchor="middle" x="64486" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="64486" y="-510" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="64486" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="64486" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_2_ep_0 -->
<g id="edge247" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M64351,-624.91C64372.54,-606.26 64397.04,-585.03 64419.21,-565.83"/>
<polygon fill="black" stroke="black" points="64421.68,-568.33 64426.95,-559.14 64417.1,-563.04 64421.68,-568.33"/>
</g>
<!-- layer_1_expert_3_ep_0 -->
<g id="node134" class="node">
<title>layer_1_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="65321.83,-559 64887.82,-559 64776.17,-455 65210.18,-455 65321.83,-559"/>
<text text-anchor="middle" x="65049" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="65049" y="-510" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="65049" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="65049" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_3_ep_0 -->
<g id="edge248" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M64486.05,-645.7C64572.75,-630.93 64675.94,-611.69 64768,-590 64803.49,-581.64 64841.17,-571.52 64877.01,-561.29"/>
<polygon fill="black" stroke="black" points="64878.42,-564.53 64887.06,-558.41 64876.49,-557.8 64878.42,-564.53"/>
</g>
<!-- layer_1_expert_4_ep_0 -->
<g id="node135" class="node">
<title>layer_1_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="65884.83,-559 65450.82,-559 65339.17,-455 65773.18,-455 65884.83,-559"/>
<text text-anchor="middle" x="65612" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="65612" y="-510" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="65612" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="65612" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_4_ep_0 -->
<g id="edge249" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M64514.13,-670.54C64725.68,-662.3 65052.26,-641.66 65331,-590 65369.35,-582.89 65409.96,-572.68 65448.03,-561.86"/>
<polygon fill="black" stroke="black" points="65449,-565.22 65457.65,-559.09 65447.07,-558.49 65449,-565.22"/>
</g>
<!-- layer_1_expert_5_ep_0 -->
<g id="node136" class="node">
<title>layer_1_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="66447.83,-559 66013.82,-559 65902.17,-455 66336.18,-455 66447.83,-559"/>
<text text-anchor="middle" x="66175" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="66175" y="-510" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="66175" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="66175" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_5_ep_0 -->
<g id="edge250" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M64514.17,-670.39C64889.95,-659.85 65635.39,-634.07 65894,-590 65933.37,-583.29 65975.05,-572.97 66013.91,-561.89"/>
<polygon fill="black" stroke="black" points="66015.09,-565.2 66023.73,-559.06 66013.15,-558.47 66015.09,-565.2"/>
</g>
<!-- layer_1_expert_6_ep_0 -->
<g id="node137" class="node">
<title>layer_1_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="67010.83,-559 66576.82,-559 66465.17,-455 66899.18,-455 67010.83,-559"/>
<text text-anchor="middle" x="66738" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="66738" y="-510" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="66738" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="66738" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_6_ep_0 -->
<g id="edge251" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M64518.44,-674C64995.34,-668.63 66089.46,-650 66457,-590 66496.88,-583.49 66539.09,-573.11 66578.35,-561.9"/>
<polygon fill="black" stroke="black" points="66579.62,-565.17 66588.26,-559.03 66577.68,-558.45 66579.62,-565.17"/>
</g>
<!-- layer_1_expert_7_ep_0 -->
<g id="node138" class="node">
<title>layer_1_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="67573.83,-559 67139.82,-559 67028.17,-455 67462.18,-455 67573.83,-559"/>
<text text-anchor="middle" x="67301" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="67301" y="-510" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="67301" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="67301" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_0&#45;&gt;layer_1_expert_7_ep_0 -->
<g id="edge252" class="edge">
<title>layer_1_route_ep_0&#45;&gt;layer_1_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M64520.69,-676.2C65086.67,-675.5 66541.51,-666.1 67020,-590 67060.22,-583.6 67102.8,-573.17 67142.32,-561.87"/>
<polygon fill="black" stroke="black" points="67143.39,-565.2 67152.03,-559.05 67141.45,-558.47 67143.39,-565.2"/>
</g>
<!-- layer_1_expert_0_ep_1 -->
<g id="node139" class="node">
<title>layer_1_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="59128.83,-559 58694.82,-559 58583.17,-455 59017.18,-455 59128.83,-559"/>
<text text-anchor="middle" x="58856" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="58856" y="-510" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="58856" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="58856" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_0_ep_1 -->
<g id="edge253" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M59432.12,-642.42C59338.25,-628.74 59232.5,-611.12 59137,-590 59101.13,-582.07 59063.11,-572.08 59027.02,-561.82"/>
<polygon fill="black" stroke="black" points="59027.97,-558.45 59017.39,-559.07 59026.04,-565.18 59027.97,-558.45"/>
</g>
<!-- layer_1_expert_1_ep_1 -->
<g id="node140" class="node">
<title>layer_1_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="59691.83,-559 59257.82,-559 59146.17,-455 59580.18,-455 59691.83,-559"/>
<text text-anchor="middle" x="59419" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="59419" y="-510" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="59419" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="59419" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_1_ep_1 -->
<g id="edge254" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M59615.24,-624.91C59583.11,-605.77 59546.44,-583.92 59513.55,-564.33"/>
<polygon fill="black" stroke="black" points="59515.22,-561.25 59504.84,-559.14 59511.64,-567.26 59515.22,-561.25"/>
</g>
<!-- layer_1_expert_2_ep_1 -->
<g id="node141" class="node">
<title>layer_1_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="60254.83,-559 59820.82,-559 59709.17,-455 60143.18,-455 60254.83,-559"/>
<text text-anchor="middle" x="59982" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="59982" y="-510" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="59982" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="59982" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_2_ep_1 -->
<g id="edge255" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M59786.45,-624.91C59818.47,-605.77 59855.02,-583.92 59887.78,-564.33"/>
<polygon fill="black" stroke="black" points="59889.68,-567.27 59896.47,-559.14 59886.09,-561.26 59889.68,-567.27"/>
</g>
<!-- layer_1_expert_3_ep_1 -->
<g id="node142" class="node">
<title>layer_1_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="60817.83,-559 60383.82,-559 60272.17,-455 60706.18,-455 60817.83,-559"/>
<text text-anchor="middle" x="60545" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="60545" y="-510" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="60545" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="60545" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_3_ep_1 -->
<g id="edge256" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M59902.18,-651.85C60010.1,-637.24 60145.01,-616.33 60264,-590 60299.87,-582.06 60337.89,-572.07 60373.98,-561.82"/>
<polygon fill="black" stroke="black" points="60374.96,-565.18 60383.61,-559.06 60373.03,-558.45 60374.96,-565.18"/>
</g>
<!-- layer_1_expert_4_ep_1 -->
<g id="node143" class="node">
<title>layer_1_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="61380.83,-559 60946.82,-559 60835.17,-455 61269.18,-455 61380.83,-559"/>
<text text-anchor="middle" x="61108" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="61108" y="-510" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="61108" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="61108" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_4_ep_1 -->
<g id="edge257" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M59925.47,-672.54C60153.99,-665.82 60517.66,-646.32 60827,-590 60865.6,-582.97 60906.48,-572.73 60944.75,-561.84"/>
<polygon fill="black" stroke="black" points="60945.77,-565.19 60954.42,-559.06 60943.84,-558.46 60945.77,-565.19"/>
</g>
<!-- layer_1_expert_5_ep_1 -->
<g id="node144" class="node">
<title>layer_1_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="61943.83,-559 61509.82,-559 61398.17,-455 61832.18,-455 61943.83,-559"/>
<text text-anchor="middle" x="61671" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="61671" y="-510" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="61671" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="61671" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_5_ep_1 -->
<g id="edge258" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M59923.9,-671.09C60316.24,-661.39 61114.7,-636.52 61390,-590 61429.5,-583.33 61471.31,-572.99 61510.27,-561.88"/>
<polygon fill="black" stroke="black" points="61511.47,-565.17 61520.11,-559.04 61509.53,-558.45 61511.47,-565.17"/>
</g>
<!-- layer_1_expert_6_ep_1 -->
<g id="node145" class="node">
<title>layer_1_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="62506.83,-559 62072.82,-559 61961.17,-455 62395.18,-455 62506.83,-559"/>
<text text-anchor="middle" x="62234" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="62234" y="-510" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="62234" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="62234" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_6_ep_1 -->
<g id="edge259" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M59927.68,-674.41C60418.92,-669.8 61568.37,-652.49 61953,-590 61992.88,-583.52 62035.1,-573.16 62074.35,-561.94"/>
<polygon fill="black" stroke="black" points="62075.63,-565.22 62084.27,-559.08 62073.69,-558.49 62075.63,-565.22"/>
</g>
<!-- layer_1_expert_7_ep_1 -->
<g id="node146" class="node">
<title>layer_1_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="63069.83,-559 62635.82,-559 62524.17,-455 62958.18,-455 63069.83,-559"/>
<text text-anchor="middle" x="62797" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="62797" y="-510" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="62797" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="62797" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_1&#45;&gt;layer_1_expert_7_ep_1 -->
<g id="edge260" class="edge">
<title>layer_1_route_ep_1&#45;&gt;layer_1_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M59930.07,-676.46C60509.06,-676.44 62020.26,-668.6 62516,-590 62556.23,-583.62 62598.8,-573.2 62638.32,-561.89"/>
<polygon fill="black" stroke="black" points="62639.4,-565.23 62648.03,-559.08 62637.45,-558.5 62639.4,-565.23"/>
</g>
<!-- layer_1_expert_0_ep_2 -->
<g id="node147" class="node">
<title>layer_1_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="68136.83,-559 67702.82,-559 67591.17,-455 68025.18,-455 68136.83,-559"/>
<text text-anchor="middle" x="67864" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="67864" y="-510" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="67864" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="67864" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_0_ep_2 -->
<g id="edge261" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M68271.94,-624.91C68230.06,-613.58 68186,-601.51 68145,-590 68113.16,-581.06 68079.35,-571.37 68046.63,-561.89"/>
<polygon fill="black" stroke="black" points="68047.55,-558.51 68036.97,-559.08 68045.6,-565.23 68047.55,-558.51"/>
</g>
<!-- layer_1_expert_1_ep_2 -->
<g id="node148" class="node">
<title>layer_1_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="68699.83,-559 68265.82,-559 68154.17,-455 68588.18,-455 68699.83,-559"/>
<text text-anchor="middle" x="68427" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="68427" y="-510" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="68427" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="68427" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_1_ep_2 -->
<g id="edge262" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M68452.7,-624.68C68448.82,-607.1 68444.45,-587.24 68440.43,-568.97"/>
<polygon fill="black" stroke="black" points="68443.8,-568.02 68438.23,-559 68436.97,-569.52 68443.8,-568.02"/>
</g>
<!-- layer_1_expert_2_ep_2 -->
<g id="node149" class="node">
<title>layer_1_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="69262.83,-559 68828.82,-559 68717.17,-455 69151.18,-455 69262.83,-559"/>
<text text-anchor="middle" x="68990" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="68990" y="-510" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="68990" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="68990" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_2_ep_2 -->
<g id="edge263" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M68623.96,-624.91C68686.06,-605.08 68757.26,-582.34 68820.26,-562.21"/>
<polygon fill="black" stroke="black" points="68821.43,-565.51 68829.89,-559.14 68819.3,-558.84 68821.43,-565.51"/>
</g>
<!-- layer_1_expert_3_ep_2 -->
<g id="node150" class="node">
<title>layer_1_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="69825.83,-559 69391.82,-559 69280.17,-455 69714.18,-455 69825.83,-559"/>
<text text-anchor="middle" x="69553" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="69553" y="-510" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="69553" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="69553" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_3_ep_2 -->
<g id="edge264" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M68678.63,-663.59C68842.36,-651.61 69072.88,-629.32 69272,-590 69309.41,-582.61 69349.04,-572.51 69386.37,-561.92"/>
<polygon fill="black" stroke="black" points="69387.66,-565.19 69396.31,-559.07 69385.74,-558.46 69387.66,-565.19"/>
</g>
<!-- layer_1_expert_4_ep_2 -->
<g id="node151" class="node">
<title>layer_1_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="70388.83,-559 69954.82,-559 69843.17,-455 70277.18,-455 70388.83,-559"/>
<text text-anchor="middle" x="70116" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="70116" y="-510" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="70116" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="70116" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_4_ep_2 -->
<g id="edge265" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M68677.27,-662.77C69060.79,-638.96 69827.95,-591.23 69835,-590 69874.11,-583.15 69915.52,-572.85 69954.19,-561.83"/>
<polygon fill="black" stroke="black" points="69955.31,-565.15 69963.95,-559.02 69953.37,-558.43 69955.31,-565.15"/>
</g>
<!-- layer_1_expert_5_ep_2 -->
<g id="node152" class="node">
<title>layer_1_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="70951.83,-559 70517.82,-559 70406.17,-455 70840.18,-455 70951.83,-559"/>
<text text-anchor="middle" x="70679" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="70679" y="-510" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="70679" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="70679" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_5_ep_2 -->
<g id="edge266" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M68675.51,-661.2C68842.54,-649.94 69081.57,-634.77 69291,-625 69536.86,-613.54 70154.93,-628.67 70398,-590 70438.22,-583.6 70480.8,-573.17 70520.32,-561.86"/>
<polygon fill="black" stroke="black" points="70521.39,-565.2 70530.03,-559.05 70519.45,-558.47 70521.39,-565.2"/>
</g>
<!-- layer_1_expert_6_ep_2 -->
<g id="node153" class="node">
<title>layer_1_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="71514.83,-559 71080.82,-559 70969.17,-455 71403.18,-455 71514.83,-559"/>
<text text-anchor="middle" x="71242" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="71242" y="-510" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="71242" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="71242" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_6_ep_2 -->
<g id="edge267" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M68675.05,-660.44C68842.08,-648.75 69081.33,-633.35 69291,-625 69661.9,-610.22 70594.23,-647.16 70961,-590 71001.47,-583.69 71044.32,-573.23 71084.03,-561.85"/>
<polygon fill="black" stroke="black" points="71085.15,-565.17 71093.78,-559.02 71083.2,-558.44 71085.15,-565.17"/>
</g>
<!-- layer_1_expert_7_ep_2 -->
<g id="node154" class="node">
<title>layer_1_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="72077.83,-559 71643.82,-559 71532.17,-455 71966.18,-455 72077.83,-559"/>
<text text-anchor="middle" x="71805" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="71805" y="-510" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="71805" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="71805" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_2&#45;&gt;layer_1_expert_7_ep_2 -->
<g id="edge268" class="edge">
<title>layer_1_route_ep_2&#45;&gt;layer_1_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M68674.6,-660.1C68841.65,-648.19 69081.12,-632.68 69291,-625 69984.36,-599.64 70158.29,-619.77 70852,-607 71150.71,-601.5 71228.8,-636.01 71524,-590 71564.47,-583.69 71607.32,-573.23 71647.03,-561.85"/>
<polygon fill="black" stroke="black" points="71648.15,-565.17 71656.78,-559.02 71646.2,-558.44 71648.15,-565.17"/>
</g>
<!-- layer_1_expert_0_ep_3 -->
<g id="node155" class="node">
<title>layer_1_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="36608.83,-559 36174.82,-559 36063.17,-455 36497.18,-455 36608.83,-559"/>
<text text-anchor="middle" x="36336" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="36336" y="-510" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="36336" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="36336" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_0_ep_3 -->
<g id="edge269" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M39132.54,-676.25C38562.64,-675.68 37098.58,-666.54 36617,-590 36576.78,-583.61 36534.2,-573.18 36494.68,-561.87"/>
<polygon fill="black" stroke="black" points="36495.55,-558.48 36484.97,-559.06 36493.6,-565.2 36495.55,-558.48"/>
</g>
<!-- layer_1_expert_1_ep_3 -->
<g id="node156" class="node">
<title>layer_1_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="37171.83,-559 36737.82,-559 36626.17,-455 37060.18,-455 37171.83,-559"/>
<text text-anchor="middle" x="36899" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="36899" y="-510" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="36899" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="36899" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_1_ep_3 -->
<g id="edge270" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M39130.11,-674.01C38646.85,-668.71 37549.43,-650.24 37180,-590 37140.12,-583.5 37097.9,-573.12 37058.65,-561.91"/>
<polygon fill="black" stroke="black" points="37059.32,-558.46 37048.74,-559.04 37057.37,-565.18 37059.32,-558.46"/>
</g>
<!-- layer_1_expert_2_ep_3 -->
<g id="node157" class="node">
<title>layer_1_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="37734.83,-559 37300.82,-559 37189.17,-455 37623.18,-455 37734.83,-559"/>
<text text-anchor="middle" x="37462" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="37462" y="-510" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="37462" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="37462" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_2_ep_3 -->
<g id="edge271" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M39125.72,-670.13C38741.88,-659.5 38001.66,-634 37743,-590 37703.63,-583.3 37661.95,-572.99 37623.08,-561.91"/>
<polygon fill="black" stroke="black" points="37623.85,-558.49 37613.27,-559.08 37621.91,-565.21 37623.85,-558.49"/>
</g>
<!-- layer_1_expert_3_ep_3 -->
<g id="node158" class="node">
<title>layer_1_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="38297.83,-559 37863.82,-559 37752.17,-455 38186.18,-455 38297.83,-559"/>
<text text-anchor="middle" x="38025" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="38025" y="-510" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="38025" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="38025" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_3_ep_3 -->
<g id="edge272" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M39126.1,-670.44C38910.69,-662.14 38584.82,-641.47 38306,-590 38267.53,-582.9 38226.79,-572.65 38188.62,-561.8"/>
<polygon fill="black" stroke="black" points="38189.55,-558.42 38178.98,-559.03 38187.62,-565.15 38189.55,-558.42"/>
</g>
<!-- layer_1_expert_4_ep_3 -->
<g id="node159" class="node">
<title>layer_1_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="38860.83,-559 38426.82,-559 38315.17,-455 38749.18,-455 38860.83,-559"/>
<text text-anchor="middle" x="38588" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="38588" y="-510" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="38588" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="38588" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_4_ep_3 -->
<g id="edge273" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M39083.33,-632.91C39013.05,-620.55 38938,-606.02 38869,-590 38833.93,-581.86 38796.76,-571.94 38761.32,-561.86"/>
<polygon fill="black" stroke="black" points="38761.95,-558.4 38751.38,-559.01 38760.03,-565.13 38761.95,-558.4"/>
</g>
<!-- layer_1_expert_5_ep_3 -->
<g id="node160" class="node">
<title>layer_1_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="39423.83,-559 38989.82,-559 38878.17,-455 39312.18,-455 39423.83,-559"/>
<text text-anchor="middle" x="39151" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="39151" y="-510" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="39151" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="39151" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_5_ep_3 -->
<g id="edge274" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M39298.53,-624.91C39274.89,-606.18 39247.97,-584.85 39223.66,-565.58"/>
<polygon fill="black" stroke="black" points="39225.54,-562.6 39215.53,-559.14 39221.19,-568.09 39225.54,-562.6"/>
</g>
<!-- layer_1_expert_6_ep_3 -->
<g id="node161" class="node">
<title>layer_1_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="39986.83,-559 39552.82,-559 39441.17,-455 39875.18,-455 39986.83,-559"/>
<text text-anchor="middle" x="39714" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="39714" y="-510" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="39714" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="39714" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_6_ep_3 -->
<g id="edge275" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M39469.74,-624.91C39510.33,-605.48 39556.74,-583.27 39598.14,-563.46"/>
<polygon fill="black" stroke="black" points="39599.65,-566.61 39607.16,-559.14 39596.63,-560.3 39599.65,-566.61"/>
</g>
<!-- layer_1_expert_7_ep_3 -->
<g id="node162" class="node">
<title>layer_1_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="40549.83,-559 40115.82,-559 40004.17,-455 40438.18,-455 40549.83,-559"/>
<text text-anchor="middle" x="40277" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="40277" y="-510" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="40277" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="40277" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_3&#45;&gt;layer_1_expert_7_ep_3 -->
<g id="edge276" class="edge">
<title>layer_1_route_ep_3&#45;&gt;layer_1_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M39568.52,-655.92C39693.02,-641.82 39854.57,-620.07 39996,-590 40032.39,-582.26 40070.95,-572.25 40107.46,-561.88"/>
<polygon fill="black" stroke="black" points="40108.54,-565.22 40117.19,-559.1 40106.61,-558.48 40108.54,-565.22"/>
</g>
<!-- layer_1_expert_0_ep_4 -->
<g id="node163" class="node">
<title>layer_1_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="50120.83,-559 49686.82,-559 49575.17,-455 50009.18,-455 50120.83,-559"/>
<text text-anchor="middle" x="49848" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="49848" y="-510" font-family="Arial" font-size="10.00">GPU: 64</text>
<text text-anchor="middle" x="49848" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="49848" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_0_ep_4 -->
<g id="edge277" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M52928.72,-672.8C52264.94,-663.27 50402,-632.97 50129,-590 50088.65,-583.65 50045.94,-573.2 50006.33,-561.86"/>
<polygon fill="black" stroke="black" points="50007.17,-558.46 49996.6,-559.04 50005.22,-565.18 50007.17,-558.46"/>
</g>
<!-- layer_1_expert_1_ep_4 -->
<g id="node164" class="node">
<title>layer_1_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="50683.83,-559 50249.82,-559 50138.17,-455 50572.18,-455 50683.83,-559"/>
<text text-anchor="middle" x="50411" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="50411" y="-510" font-family="Arial" font-size="10.00">GPU: 65</text>
<text text-anchor="middle" x="50411" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="50411" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_1_ep_4 -->
<g id="edge278" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M52931.29,-675.29C52402.3,-672.47 51118.6,-658.56 50692,-590 50651.99,-583.57 50609.64,-573.19 50570.29,-561.94"/>
<polygon fill="black" stroke="black" points="50570.93,-558.48 50560.35,-559.07 50568.99,-565.21 50570.93,-558.48"/>
</g>
<!-- layer_1_expert_2_ep_4 -->
<g id="node165" class="node">
<title>layer_1_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="51246.83,-559 50812.82,-559 50701.17,-455 51135.18,-455 51246.83,-559"/>
<text text-anchor="middle" x="50974" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="50974" y="-510" font-family="Arial" font-size="10.00">GPU: 66</text>
<text text-anchor="middle" x="50974" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="50974" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_2_ep_4 -->
<g id="edge279" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M52928.02,-672.41C52491.23,-664.58 51570.05,-642.29 51255,-590 51215.37,-583.42 51173.42,-573.09 51134.36,-561.94"/>
<polygon fill="black" stroke="black" points="51135.08,-558.51 51124.5,-559.09 51133.13,-565.23 51135.08,-558.51"/>
</g>
<!-- layer_1_expert_3_ep_4 -->
<g id="node166" class="node">
<title>layer_1_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="51809.83,-559 51375.82,-559 51264.17,-455 51698.18,-455 51809.83,-559"/>
<text text-anchor="middle" x="51537" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="51537" y="-510" font-family="Arial" font-size="10.00">GPU: 67</text>
<text text-anchor="middle" x="51537" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="51537" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_3_ep_4 -->
<g id="edge280" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M52921.97,-666.96C52593.64,-653.55 52023.18,-626.04 51818,-590 51779.01,-583.15 51737.73,-572.88 51699.16,-561.9"/>
<polygon fill="black" stroke="black" points="51700,-558.5 51689.42,-559.09 51698.06,-565.22 51700,-558.5"/>
</g>
<!-- layer_1_expert_4_ep_4 -->
<g id="node167" class="node">
<title>layer_1_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="52372.83,-559 51938.82,-559 51827.17,-455 52261.18,-455 52372.83,-559"/>
<text text-anchor="middle" x="52100" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="52100" y="-510" font-family="Arial" font-size="10.00">GPU: 68</text>
<text text-anchor="middle" x="52100" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="52100" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_4_ep_4 -->
<g id="edge281" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M52913.89,-659.75C52759.43,-646.92 52557.48,-625.17 52381,-590 52343.71,-582.57 52304.22,-572.48 52267,-561.92"/>
<polygon fill="black" stroke="black" points="52267.65,-558.46 52257.07,-559.07 52265.72,-565.19 52267.65,-558.46"/>
</g>
<!-- layer_1_expert_5_ep_4 -->
<g id="node168" class="node">
<title>layer_1_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="52935.83,-559 52501.82,-559 52390.17,-455 52824.18,-455 52935.83,-559"/>
<text text-anchor="middle" x="52663" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="52663" y="-510" font-family="Arial" font-size="10.00">GPU: 69</text>
<text text-anchor="middle" x="52663" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="52663" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_5_ep_4 -->
<g id="edge282" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M53010.95,-624.91C52952.04,-605.12 52884.51,-582.43 52824.72,-562.34"/>
<polygon fill="black" stroke="black" points="52825.79,-559 52815.19,-559.14 52823.56,-565.64 52825.79,-559"/>
</g>
<!-- layer_1_expert_6_ep_4 -->
<g id="node169" class="node">
<title>layer_1_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="53498.83,-559 53064.82,-559 52953.17,-455 53387.18,-455 53498.83,-559"/>
<text text-anchor="middle" x="53226" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="53226" y="-510" font-family="Arial" font-size="10.00">GPU: 70</text>
<text text-anchor="middle" x="53226" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="53226" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_6_ep_4 -->
<g id="edge283" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M53182.24,-624.68C53188.9,-606.93 53196.42,-586.88 53203.33,-568.46"/>
<polygon fill="black" stroke="black" points="53206.64,-569.6 53206.87,-559 53200.08,-567.14 53206.64,-569.6"/>
</g>
<!-- layer_1_expert_7_ep_4 -->
<g id="node170" class="node">
<title>layer_1_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="54061.83,-559 53627.82,-559 53516.17,-455 53950.18,-455 54061.83,-559"/>
<text text-anchor="middle" x="53789" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="53789" y="-510" font-family="Arial" font-size="10.00">GPU: 71</text>
<text text-anchor="middle" x="53789" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="53789" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_4&#45;&gt;layer_1_expert_7_ep_4 -->
<g id="edge284" class="edge">
<title>layer_1_route_ep_4&#45;&gt;layer_1_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M53342.41,-632.71C53395.81,-619.44 53454.37,-604.5 53508,-590 53542.86,-580.57 53580.03,-570.06 53615.53,-559.79"/>
<polygon fill="black" stroke="black" points="53616.86,-563.05 53625.49,-556.9 53614.91,-556.32 53616.86,-563.05"/>
</g>
<!-- layer_1_expert_0_ep_5 -->
<g id="node171" class="node">
<title>layer_1_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="41112.83,-559 40678.82,-559 40567.17,-455 41001.18,-455 41112.83,-559"/>
<text text-anchor="middle" x="40840" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="40840" y="-510" font-family="Arial" font-size="10.00">GPU: 80</text>
<text text-anchor="middle" x="40840" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="40840" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_0_ep_5 -->
<g id="edge285" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M43481.06,-675.74C42934.06,-673.92 41571.61,-662.05 41121,-590 41080.78,-583.57 41038.21,-573.13 40998.69,-561.82"/>
<polygon fill="black" stroke="black" points="40999.56,-558.43 40988.98,-559.01 40997.61,-565.15 40999.56,-558.43"/>
</g>
<!-- layer_1_expert_1_ep_5 -->
<g id="node172" class="node">
<title>layer_1_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="41675.83,-559 41241.82,-559 41130.17,-455 41564.18,-455 41675.83,-559"/>
<text text-anchor="middle" x="41403" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="41403" y="-510" font-family="Arial" font-size="10.00">GPU: 81</text>
<text text-anchor="middle" x="41403" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="41403" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_1_ep_5 -->
<g id="edge286" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M43477.87,-673.17C43020.32,-666.46 42022.7,-645.76 41684,-590 41644.24,-583.46 41602.16,-573.1 41563.01,-561.92"/>
<polygon fill="black" stroke="black" points="41563.7,-558.48 41553.12,-559.06 41561.75,-565.2 41563.7,-558.48"/>
</g>
<!-- layer_1_expert_2_ep_5 -->
<g id="node173" class="node">
<title>layer_1_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="42238.83,-559 41804.82,-559 41693.17,-455 42127.18,-455 42238.83,-559"/>
<text text-anchor="middle" x="41966" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="41966" y="-510" font-family="Arial" font-size="10.00">GPU: 82</text>
<text text-anchor="middle" x="41966" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="41966" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_2_ep_5 -->
<g id="edge287" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M43472.8,-668.5C43119.53,-656.31 42475.46,-629.52 42247,-590 42207.76,-583.21 42166.22,-572.9 42127.45,-561.85"/>
<polygon fill="black" stroke="black" points="42128.24,-558.43 42117.66,-559.03 42126.3,-565.16 42128.24,-558.43"/>
</g>
<!-- layer_1_expert_3_ep_5 -->
<g id="node174" class="node">
<title>layer_1_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="42801.83,-559 42367.82,-559 42256.17,-455 42690.18,-455 42801.83,-559"/>
<text text-anchor="middle" x="42529" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="42529" y="-510" font-family="Arial" font-size="10.00">GPU: 83</text>
<text text-anchor="middle" x="42529" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="42529" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_3_ep_5 -->
<g id="edge288" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M43469.05,-665.29C43286.48,-654.24 43030.92,-632.37 42810,-590 42772.2,-582.75 42732.18,-572.61 42694.55,-561.93"/>
<polygon fill="black" stroke="black" points="42695.1,-558.45 42684.52,-559.06 42693.17,-565.18 42695.1,-558.45"/>
</g>
<!-- layer_1_expert_4_ep_5 -->
<g id="node175" class="node">
<title>layer_1_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="43364.83,-559 42930.82,-559 42819.17,-455 43253.18,-455 43364.83,-559"/>
<text text-anchor="middle" x="43092" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="43092" y="-510" font-family="Arial" font-size="10.00">GPU: 84</text>
<text text-anchor="middle" x="43092" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="43092" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_4_ep_5 -->
<g id="edge289" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M43505.98,-624.98C43462.02,-613.75 43415.91,-601.7 43373,-590 43340.65,-581.18 43306.3,-571.46 43273.14,-561.88"/>
<polygon fill="black" stroke="black" points="43273.94,-558.47 43263.36,-559.06 43272,-565.2 43273.94,-558.47"/>
</g>
<!-- layer_1_expert_5_ep_5 -->
<g id="node176" class="node">
<title>layer_1_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="43927.83,-559 43493.82,-559 43382.17,-455 43816.18,-455 43927.83,-559"/>
<text text-anchor="middle" x="43655" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="43655" y="-510" font-family="Arial" font-size="10.00">GPU: 85</text>
<text text-anchor="middle" x="43655" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="43655" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_5_ep_5 -->
<g id="edge290" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M43694.59,-624.68C43688.59,-607.01 43681.82,-587.06 43675.6,-568.72"/>
<polygon fill="black" stroke="black" points="43678.83,-567.35 43672.3,-559 43672.2,-569.6 43678.83,-567.35"/>
</g>
<!-- layer_1_expert_6_ep_5 -->
<g id="node177" class="node">
<title>layer_1_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="44490.83,-559 44056.82,-559 43945.17,-455 44379.18,-455 44490.83,-559"/>
<text text-anchor="middle" x="44218" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="44218" y="-510" font-family="Arial" font-size="10.00">GPU: 86</text>
<text text-anchor="middle" x="44218" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="44218" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_6_ep_5 -->
<g id="edge291" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M43865.88,-624.91C43925.49,-605.12 43993.83,-582.43 44054.34,-562.34"/>
<polygon fill="black" stroke="black" points="44055.59,-565.61 44063.98,-559.14 44053.39,-558.97 44055.59,-565.61"/>
</g>
<!-- layer_1_expert_7_ep_5 -->
<g id="node178" class="node">
<title>layer_1_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="45053.83,-559 44619.82,-559 44508.17,-455 44942.18,-455 45053.83,-559"/>
<text text-anchor="middle" x="44781" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="44781" y="-510" font-family="Arial" font-size="10.00">GPU: 87</text>
<text text-anchor="middle" x="44781" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="44781" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_5&#45;&gt;layer_1_expert_7_ep_5 -->
<g id="edge292" class="edge">
<title>layer_1_route_ep_5&#45;&gt;layer_1_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M43925.5,-662.87C44084.9,-650.61 44307.49,-628.29 44500,-590 44537.29,-582.58 44576.78,-572.5 44614.01,-561.94"/>
<polygon fill="black" stroke="black" points="44615.28,-565.22 44623.93,-559.1 44613.35,-558.49 44615.28,-565.22"/>
</g>
<!-- layer_1_expert_0_ep_6 -->
<g id="node179" class="node">
<title>layer_1_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="54624.83,-559 54190.82,-559 54079.17,-455 54513.18,-455 54624.83,-559"/>
<text text-anchor="middle" x="54352" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="54352" y="-510" font-family="Arial" font-size="10.00">GPU: 96</text>
<text text-anchor="middle" x="54352" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="54352" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_0_ep_6 -->
<g id="edge293" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M56224.72,-671.85C55802.47,-663.25 54932.2,-639.97 54633,-590 54593.38,-583.38 54551.43,-573.03 54512.37,-561.89"/>
<polygon fill="black" stroke="black" points="54513.09,-558.45 54502.51,-559.04 54511.14,-565.18 54513.09,-558.45"/>
</g>
<!-- layer_1_expert_1_ep_6 -->
<g id="node180" class="node">
<title>layer_1_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="55187.83,-559 54753.82,-559 54642.17,-455 55076.18,-455 55187.83,-559"/>
<text text-anchor="middle" x="54915" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="54915" y="-510" font-family="Arial" font-size="10.00">GPU: 97</text>
<text text-anchor="middle" x="54915" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="54915" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_1_ep_6 -->
<g id="edge294" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M56228.4,-675.18C55973.53,-670.82 55552.64,-653.4 55196,-590 55157.14,-583.09 55115.99,-572.83 55077.53,-561.88"/>
<polygon fill="black" stroke="black" points="55078.38,-558.48 55067.81,-559.08 55076.45,-565.21 55078.38,-558.48"/>
</g>
<!-- layer_1_expert_2_ep_6 -->
<g id="node181" class="node">
<title>layer_1_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="55750.83,-559 55316.82,-559 55205.17,-455 55639.18,-455 55750.83,-559"/>
<text text-anchor="middle" x="55478" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="55478" y="-510" font-family="Arial" font-size="10.00">GPU: 98</text>
<text text-anchor="middle" x="55478" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="55478" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_2_ep_6 -->
<g id="edge295" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M56205.3,-654.77C56071.59,-641.1 55905.52,-620.16 55759,-590 55722.1,-582.41 55683.01,-572.33 55646.1,-561.86"/>
<polygon fill="black" stroke="black" points="55646.83,-558.43 55636.25,-559.04 55644.9,-565.16 55646.83,-558.43"/>
</g>
<!-- layer_1_expert_3_ep_6 -->
<g id="node182" class="node">
<title>layer_1_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="56313.83,-559 55879.82,-559 55768.17,-455 56202.18,-455 56313.83,-559"/>
<text text-anchor="middle" x="56041" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="56041" y="-510" font-family="Arial" font-size="10.00">GPU: 99</text>
<text text-anchor="middle" x="56041" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="56041" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_3_ep_6 -->
<g id="edge296" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M56332.58,-624.91C56283.72,-605.32 56227.79,-582.9 56178.07,-562.96"/>
<polygon fill="black" stroke="black" points="56179.12,-559.61 56168.54,-559.14 56176.52,-566.11 56179.12,-559.61"/>
</g>
<!-- layer_1_expert_4_ep_6 -->
<g id="node183" class="node">
<title>layer_1_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="56876.83,-559 56442.82,-559 56331.17,-455 56765.18,-455 56876.83,-559"/>
<text text-anchor="middle" x="56604" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="56604" y="-510" font-family="Arial" font-size="10.00">GPU: 100</text>
<text text-anchor="middle" x="56604" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="56604" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_4_ep_6 -->
<g id="edge297" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M56503.99,-624.68C56519.69,-606.36 56537.5,-585.59 56553.69,-566.69"/>
<polygon fill="black" stroke="black" points="56556.43,-568.87 56560.28,-559 56551.12,-564.32 56556.43,-568.87"/>
</g>
<!-- layer_1_expert_5_ep_6 -->
<g id="node184" class="node">
<title>layer_1_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="57439.83,-559 57005.82,-559 56894.17,-455 57328.18,-455 57439.83,-559"/>
<text text-anchor="middle" x="57167" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="57167" y="-510" font-family="Arial" font-size="10.00">GPU: 101</text>
<text text-anchor="middle" x="57167" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="57167" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_5_ep_6 -->
<g id="edge298" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M56649.24,-641.37C56723.39,-626.87 56808.99,-608.97 56886,-590 56921.29,-581.3 56958.8,-571.07 56994.53,-560.83"/>
<polygon fill="black" stroke="black" points="56995.92,-564.07 57004.56,-557.94 56993.98,-557.34 56995.92,-564.07"/>
</g>
<!-- layer_1_expert_6_ep_6 -->
<g id="node185" class="node">
<title>layer_1_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="58002.83,-559 57568.82,-559 57457.17,-455 57891.18,-455 58002.83,-559"/>
<text text-anchor="middle" x="57730" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="57730" y="-510" font-family="Arial" font-size="10.00">GPU: 102</text>
<text text-anchor="middle" x="57730" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="57730" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_6_ep_6 -->
<g id="edge299" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M56680.68,-669.26C56882.23,-660.17 57187.7,-638.99 57449,-590 57487.06,-582.86 57527.35,-572.71 57565.18,-561.97"/>
<polygon fill="black" stroke="black" points="57566.61,-565.2 57575.26,-559.08 57564.68,-558.47 57566.61,-565.2"/>
</g>
<!-- layer_1_expert_7_ep_6 -->
<g id="node186" class="node">
<title>layer_1_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="58565.83,-559 58131.82,-559 58020.17,-455 58454.18,-455 58565.83,-559"/>
<text text-anchor="middle" x="58293" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="58293" y="-510" font-family="Arial" font-size="10.00">GPU: 103</text>
<text text-anchor="middle" x="58293" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="58293" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_6&#45;&gt;layer_1_expert_7_ep_6 -->
<g id="edge300" class="edge">
<title>layer_1_route_ep_6&#45;&gt;layer_1_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M56681.8,-669.95C57047.91,-658.92 57762.97,-632.66 58012,-590 58051.37,-583.26 58093.04,-572.93 58131.9,-561.85"/>
<polygon fill="black" stroke="black" points="58133.08,-565.15 58141.72,-559.01 58131.14,-558.42 58133.08,-565.15"/>
</g>
<!-- layer_1_expert_0_ep_7 -->
<g id="node187" class="node">
<title>layer_1_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="45616.83,-559 45182.82,-559 45071.17,-455 45505.18,-455 45616.83,-559"/>
<text text-anchor="middle" x="45344" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="45344" y="-510" font-family="Arial" font-size="10.00">GPU: 112</text>
<text text-anchor="middle" x="45344" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="45344" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_0_ep_7 -->
<g id="edge301" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M48140.54,-676.25C47570.64,-675.68 46106.58,-666.54 45625,-590 45584.78,-583.61 45542.2,-573.18 45502.68,-561.87"/>
<polygon fill="black" stroke="black" points="45503.55,-558.48 45492.97,-559.06 45501.6,-565.2 45503.55,-558.48"/>
</g>
<!-- layer_1_expert_1_ep_7 -->
<g id="node188" class="node">
<title>layer_1_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="46179.83,-559 45745.82,-559 45634.17,-455 46068.18,-455 46179.83,-559"/>
<text text-anchor="middle" x="45907" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="45907" y="-510" font-family="Arial" font-size="10.00">GPU: 113</text>
<text text-anchor="middle" x="45907" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="45907" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_1_ep_7 -->
<g id="edge302" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M48138.11,-674.01C47654.85,-668.71 46557.43,-650.24 46188,-590 46148.12,-583.5 46105.9,-573.12 46066.65,-561.91"/>
<polygon fill="black" stroke="black" points="46067.32,-558.46 46056.74,-559.04 46065.37,-565.18 46067.32,-558.46"/>
</g>
<!-- layer_1_expert_2_ep_7 -->
<g id="node189" class="node">
<title>layer_1_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="46742.83,-559 46308.82,-559 46197.17,-455 46631.18,-455 46742.83,-559"/>
<text text-anchor="middle" x="46470" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="46470" y="-510" font-family="Arial" font-size="10.00">GPU: 114</text>
<text text-anchor="middle" x="46470" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="46470" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_2_ep_7 -->
<g id="edge303" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M48133.72,-670.13C47749.88,-659.5 47009.66,-634 46751,-590 46711.63,-583.3 46669.95,-572.99 46631.08,-561.91"/>
<polygon fill="black" stroke="black" points="46631.85,-558.49 46621.27,-559.08 46629.91,-565.21 46631.85,-558.49"/>
</g>
<!-- layer_1_expert_3_ep_7 -->
<g id="node190" class="node">
<title>layer_1_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="47305.83,-559 46871.82,-559 46760.17,-455 47194.18,-455 47305.83,-559"/>
<text text-anchor="middle" x="47033" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="47033" y="-510" font-family="Arial" font-size="10.00">GPU: 115</text>
<text text-anchor="middle" x="47033" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="47033" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_3_ep_7 -->
<g id="edge304" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M48134.1,-670.44C47918.69,-662.14 47592.82,-641.47 47314,-590 47275.53,-582.9 47234.79,-572.65 47196.62,-561.8"/>
<polygon fill="black" stroke="black" points="47197.55,-558.42 47186.98,-559.03 47195.62,-565.15 47197.55,-558.42"/>
</g>
<!-- layer_1_expert_4_ep_7 -->
<g id="node191" class="node">
<title>layer_1_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="47868.83,-559 47434.82,-559 47323.17,-455 47757.18,-455 47868.83,-559"/>
<text text-anchor="middle" x="47596" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="47596" y="-510" font-family="Arial" font-size="10.00">GPU: 116</text>
<text text-anchor="middle" x="47596" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="47596" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_4_ep_7 -->
<g id="edge305" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M48091.33,-632.91C48021.05,-620.55 47946,-606.02 47877,-590 47841.93,-581.86 47804.76,-571.94 47769.32,-561.86"/>
<polygon fill="black" stroke="black" points="47769.95,-558.4 47759.38,-559.01 47768.03,-565.13 47769.95,-558.4"/>
</g>
<!-- layer_1_expert_5_ep_7 -->
<g id="node192" class="node">
<title>layer_1_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="48431.83,-559 47997.82,-559 47886.17,-455 48320.18,-455 48431.83,-559"/>
<text text-anchor="middle" x="48159" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="48159" y="-510" font-family="Arial" font-size="10.00">GPU: 117</text>
<text text-anchor="middle" x="48159" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="48159" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_5_ep_7 -->
<g id="edge306" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M48306.53,-624.91C48282.89,-606.18 48255.97,-584.85 48231.66,-565.58"/>
<polygon fill="black" stroke="black" points="48233.54,-562.6 48223.53,-559.14 48229.19,-568.09 48233.54,-562.6"/>
</g>
<!-- layer_1_expert_6_ep_7 -->
<g id="node193" class="node">
<title>layer_1_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="48994.83,-559 48560.82,-559 48449.17,-455 48883.18,-455 48994.83,-559"/>
<text text-anchor="middle" x="48722" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="48722" y="-510" font-family="Arial" font-size="10.00">GPU: 118</text>
<text text-anchor="middle" x="48722" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="48722" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_6_ep_7 -->
<g id="edge307" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M48477.74,-624.91C48518.33,-605.48 48564.74,-583.27 48606.14,-563.46"/>
<polygon fill="black" stroke="black" points="48607.65,-566.61 48615.16,-559.14 48604.63,-560.3 48607.65,-566.61"/>
</g>
<!-- layer_1_expert_7_ep_7 -->
<g id="node194" class="node">
<title>layer_1_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="49557.83,-559 49123.82,-559 49012.17,-455 49446.18,-455 49557.83,-559"/>
<text text-anchor="middle" x="49285" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="49285" y="-510" font-family="Arial" font-size="10.00">GPU: 119</text>
<text text-anchor="middle" x="49285" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="49285" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_1_route_ep_7&#45;&gt;layer_1_expert_7_ep_7 -->
<g id="edge308" class="edge">
<title>layer_1_route_ep_7&#45;&gt;layer_1_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M48576.52,-655.92C48701.02,-641.82 48862.57,-620.07 49004,-590 49040.39,-582.26 49078.95,-572.25 49115.46,-561.88"/>
<polygon fill="black" stroke="black" points="49116.54,-565.22 49125.19,-559.1 49114.61,-558.48 49116.54,-565.22"/>
</g>
<!-- layer_1_agg_ep_0 -->
<g id="node195" class="node">
<title>layer_1_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="65895.07,-410 65444.77,-410 65328.93,-306 65779.23,-306 65895.07,-410"/>
<text text-anchor="middle" x="65612" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="65612" y="-361" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="65612" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="65612" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge309" class="edge">
<title>layer_1_expert_0_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M63532.39,-465.2C63568.11,-458.05 63605.64,-451.47 63641,-447 63971.72,-405.18 64938.93,-376.08 65383.58,-364.54"/>
<polygon fill="black" stroke="black" points="65383.76,-368.03 65393.66,-364.27 65383.58,-361.03 65383.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge310" class="edge">
<title>layer_1_expert_1_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M64095.82,-465.62C64131.43,-458.45 64168.8,-451.77 64204,-447 64616.65,-391.08 65102.25,-370.62 65381.87,-363.19"/>
<polygon fill="black" stroke="black" points="65382.24,-366.68 65392.14,-362.92 65382.05,-359.68 65382.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge311" class="edge">
<title>layer_1_expert_2_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M64659.74,-466.6C64695.11,-459.4 64732.16,-452.46 64767,-447 64979.34,-413.74 65223.74,-389.83 65394.9,-375.41"/>
<polygon fill="black" stroke="black" points="65395.36,-378.88 65405.04,-374.55 65394.78,-371.9 65395.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge312" class="edge">
<title>layer_1_expert_3_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M65217.92,-461.9C65284.29,-444.56 65360.66,-424.62 65428.4,-406.94"/>
<polygon fill="black" stroke="black" points="65429.53,-410.26 65438.33,-404.35 65427.77,-403.49 65429.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge313" class="edge">
<title>layer_1_expert_4_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M65612,-455C65612,-443.95 65612,-432.15 65612,-420.75"/>
<polygon fill="black" stroke="black" points="65615.5,-420.41 65612,-410.41 65608.5,-420.41 65615.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge314" class="edge">
<title>layer_1_expert_5_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M65979.67,-455C65927.2,-441.3 65870.31,-426.44 65817.31,-412.61"/>
<polygon fill="black" stroke="black" points="65818.02,-409.18 65807.46,-410.04 65816.25,-415.95 65818.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge315" class="edge">
<title>layer_1_expert_6_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M66504.13,-455C66488.21,-452.11 66472.39,-449.41 66457,-447 66260.91,-416.29 66037.48,-393.55 65869.64,-378.88"/>
<polygon fill="black" stroke="black" points="65869.94,-375.4 65859.68,-378.02 65869.34,-382.37 65869.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_0&#45;&gt;layer_1_agg_ep_0 -->
<g id="edge316" class="edge">
<title>layer_1_expert_7_ep_0&#45;&gt;layer_1_agg_ep_0</title>
<path fill="none" stroke="black" d="M67071.44,-454.98C67054.09,-451.99 67036.79,-449.28 67020,-447 66612.89,-391.83 66134.79,-371.18 65853.51,-363.5"/>
<polygon fill="black" stroke="black" points="65853.26,-359.99 65843.17,-363.22 65853.07,-366.99 65853.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_1 -->
<g id="node196" class="node">
<title>layer_1_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="61391.07,-410 60940.77,-410 60824.93,-306 61275.23,-306 61391.07,-410"/>
<text text-anchor="middle" x="61108" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="61108" y="-361" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="61108" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="61108" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge318" class="edge">
<title>layer_1_expert_0_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M59028.39,-465.2C59064.11,-458.05 59101.64,-451.47 59137,-447 59467.72,-405.18 60434.93,-376.08 60879.58,-364.54"/>
<polygon fill="black" stroke="black" points="60879.76,-368.03 60889.66,-364.27 60879.58,-361.03 60879.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge319" class="edge">
<title>layer_1_expert_1_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M59591.82,-465.62C59627.43,-458.45 59664.8,-451.77 59700,-447 60112.65,-391.08 60598.25,-370.62 60877.87,-363.19"/>
<polygon fill="black" stroke="black" points="60878.24,-366.68 60888.14,-362.92 60878.05,-359.68 60878.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge320" class="edge">
<title>layer_1_expert_2_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M60155.74,-466.6C60191.11,-459.4 60228.16,-452.46 60263,-447 60475.34,-413.74 60719.74,-389.83 60890.9,-375.41"/>
<polygon fill="black" stroke="black" points="60891.36,-378.88 60901.04,-374.55 60890.78,-371.9 60891.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge321" class="edge">
<title>layer_1_expert_3_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M60713.92,-461.9C60780.29,-444.56 60856.66,-424.62 60924.4,-406.94"/>
<polygon fill="black" stroke="black" points="60925.53,-410.26 60934.33,-404.35 60923.77,-403.49 60925.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge322" class="edge">
<title>layer_1_expert_4_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M61108,-455C61108,-443.95 61108,-432.15 61108,-420.75"/>
<polygon fill="black" stroke="black" points="61111.5,-420.41 61108,-410.41 61104.5,-420.41 61111.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge323" class="edge">
<title>layer_1_expert_5_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M61475.67,-455C61423.2,-441.3 61366.31,-426.44 61313.31,-412.61"/>
<polygon fill="black" stroke="black" points="61314.02,-409.18 61303.46,-410.04 61312.25,-415.95 61314.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge324" class="edge">
<title>layer_1_expert_6_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M62000.13,-455C61984.21,-452.11 61968.39,-449.41 61953,-447 61756.91,-416.29 61533.48,-393.55 61365.64,-378.88"/>
<polygon fill="black" stroke="black" points="61365.94,-375.4 61355.68,-378.02 61365.34,-382.37 61365.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_1&#45;&gt;layer_1_agg_ep_1 -->
<g id="edge325" class="edge">
<title>layer_1_expert_7_ep_1&#45;&gt;layer_1_agg_ep_1</title>
<path fill="none" stroke="black" d="M62567.44,-454.98C62550.09,-451.99 62532.79,-449.28 62516,-447 62108.89,-391.83 61630.79,-371.18 61349.51,-363.5"/>
<polygon fill="black" stroke="black" points="61349.26,-359.99 61339.17,-363.22 61349.07,-366.99 61349.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_2 -->
<g id="node197" class="node">
<title>layer_1_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="70399.07,-410 69948.77,-410 69832.93,-306 70283.23,-306 70399.07,-410"/>
<text text-anchor="middle" x="70116" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="70116" y="-361" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="70116" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="70116" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge327" class="edge">
<title>layer_1_expert_0_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M68036.39,-465.2C68072.11,-458.05 68109.64,-451.47 68145,-447 68475.72,-405.18 69442.93,-376.08 69887.58,-364.54"/>
<polygon fill="black" stroke="black" points="69887.76,-368.03 69897.66,-364.27 69887.58,-361.03 69887.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge328" class="edge">
<title>layer_1_expert_1_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M68599.82,-465.62C68635.43,-458.45 68672.8,-451.77 68708,-447 69120.65,-391.08 69606.25,-370.62 69885.87,-363.19"/>
<polygon fill="black" stroke="black" points="69886.24,-366.68 69896.14,-362.92 69886.05,-359.68 69886.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge329" class="edge">
<title>layer_1_expert_2_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M69163.74,-466.6C69199.11,-459.4 69236.16,-452.46 69271,-447 69483.34,-413.74 69727.74,-389.83 69898.9,-375.41"/>
<polygon fill="black" stroke="black" points="69899.36,-378.88 69909.04,-374.55 69898.78,-371.9 69899.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge330" class="edge">
<title>layer_1_expert_3_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M69721.92,-461.9C69788.29,-444.56 69864.66,-424.62 69932.4,-406.94"/>
<polygon fill="black" stroke="black" points="69933.53,-410.26 69942.33,-404.35 69931.77,-403.49 69933.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge331" class="edge">
<title>layer_1_expert_4_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M70116,-455C70116,-443.95 70116,-432.15 70116,-420.75"/>
<polygon fill="black" stroke="black" points="70119.5,-420.41 70116,-410.41 70112.5,-420.41 70119.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge332" class="edge">
<title>layer_1_expert_5_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M70483.67,-455C70431.2,-441.3 70374.31,-426.44 70321.31,-412.61"/>
<polygon fill="black" stroke="black" points="70322.02,-409.18 70311.46,-410.04 70320.25,-415.95 70322.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge333" class="edge">
<title>layer_1_expert_6_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M71008.13,-455C70992.21,-452.11 70976.39,-449.41 70961,-447 70764.91,-416.29 70541.48,-393.55 70373.64,-378.88"/>
<polygon fill="black" stroke="black" points="70373.94,-375.4 70363.68,-378.02 70373.34,-382.37 70373.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_2&#45;&gt;layer_1_agg_ep_2 -->
<g id="edge334" class="edge">
<title>layer_1_expert_7_ep_2&#45;&gt;layer_1_agg_ep_2</title>
<path fill="none" stroke="black" d="M71575.44,-454.98C71558.09,-451.99 71540.79,-449.28 71524,-447 71116.89,-391.83 70638.79,-371.18 70357.51,-363.5"/>
<polygon fill="black" stroke="black" points="70357.26,-359.99 70347.17,-363.22 70357.07,-366.99 70357.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_3 -->
<g id="node198" class="node">
<title>layer_1_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="38871.07,-410 38420.77,-410 38304.93,-306 38755.23,-306 38871.07,-410"/>
<text text-anchor="middle" x="38588" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="38588" y="-361" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="38588" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="38588" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge336" class="edge">
<title>layer_1_expert_0_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M36508.39,-465.2C36544.11,-458.05 36581.64,-451.47 36617,-447 36947.72,-405.18 37914.93,-376.08 38359.58,-364.54"/>
<polygon fill="black" stroke="black" points="38359.76,-368.03 38369.66,-364.27 38359.58,-361.03 38359.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge337" class="edge">
<title>layer_1_expert_1_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M37071.82,-465.62C37107.43,-458.45 37144.8,-451.77 37180,-447 37592.65,-391.08 38078.25,-370.62 38357.87,-363.19"/>
<polygon fill="black" stroke="black" points="38358.24,-366.68 38368.14,-362.92 38358.05,-359.68 38358.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge338" class="edge">
<title>layer_1_expert_2_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M37635.74,-466.6C37671.11,-459.4 37708.16,-452.46 37743,-447 37955.34,-413.74 38199.74,-389.83 38370.9,-375.41"/>
<polygon fill="black" stroke="black" points="38371.36,-378.88 38381.04,-374.55 38370.78,-371.9 38371.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge339" class="edge">
<title>layer_1_expert_3_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M38193.92,-461.9C38260.29,-444.56 38336.66,-424.62 38404.4,-406.94"/>
<polygon fill="black" stroke="black" points="38405.53,-410.26 38414.33,-404.35 38403.77,-403.49 38405.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge340" class="edge">
<title>layer_1_expert_4_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M38588,-455C38588,-443.95 38588,-432.15 38588,-420.75"/>
<polygon fill="black" stroke="black" points="38591.5,-420.41 38588,-410.41 38584.5,-420.41 38591.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge341" class="edge">
<title>layer_1_expert_5_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M38955.67,-455C38903.2,-441.3 38846.31,-426.44 38793.31,-412.61"/>
<polygon fill="black" stroke="black" points="38794.02,-409.18 38783.46,-410.04 38792.25,-415.95 38794.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge342" class="edge">
<title>layer_1_expert_6_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M39480.13,-455C39464.21,-452.11 39448.39,-449.41 39433,-447 39236.91,-416.29 39013.48,-393.55 38845.64,-378.88"/>
<polygon fill="black" stroke="black" points="38845.94,-375.4 38835.68,-378.02 38845.34,-382.37 38845.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_3&#45;&gt;layer_1_agg_ep_3 -->
<g id="edge343" class="edge">
<title>layer_1_expert_7_ep_3&#45;&gt;layer_1_agg_ep_3</title>
<path fill="none" stroke="black" d="M40047.44,-454.98C40030.09,-451.99 40012.79,-449.28 39996,-447 39588.89,-391.83 39110.79,-371.18 38829.51,-363.5"/>
<polygon fill="black" stroke="black" points="38829.26,-359.99 38819.17,-363.22 38829.07,-366.99 38829.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_4 -->
<g id="node199" class="node">
<title>layer_1_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="52383.07,-410 51932.77,-410 51816.93,-306 52267.23,-306 52383.07,-410"/>
<text text-anchor="middle" x="52100" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="52100" y="-361" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="52100" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="52100" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge345" class="edge">
<title>layer_1_expert_0_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M50020.39,-465.2C50056.11,-458.05 50093.64,-451.47 50129,-447 50459.72,-405.18 51426.93,-376.08 51871.58,-364.54"/>
<polygon fill="black" stroke="black" points="51871.76,-368.03 51881.66,-364.27 51871.58,-361.03 51871.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge346" class="edge">
<title>layer_1_expert_1_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M50583.82,-465.62C50619.43,-458.45 50656.8,-451.77 50692,-447 51104.65,-391.08 51590.25,-370.62 51869.87,-363.19"/>
<polygon fill="black" stroke="black" points="51870.24,-366.68 51880.14,-362.92 51870.05,-359.68 51870.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge347" class="edge">
<title>layer_1_expert_2_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M51147.74,-466.6C51183.11,-459.4 51220.16,-452.46 51255,-447 51467.34,-413.74 51711.74,-389.83 51882.9,-375.41"/>
<polygon fill="black" stroke="black" points="51883.36,-378.88 51893.04,-374.55 51882.78,-371.9 51883.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge348" class="edge">
<title>layer_1_expert_3_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M51705.92,-461.9C51772.29,-444.56 51848.66,-424.62 51916.4,-406.94"/>
<polygon fill="black" stroke="black" points="51917.53,-410.26 51926.33,-404.35 51915.77,-403.49 51917.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge349" class="edge">
<title>layer_1_expert_4_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M52100,-455C52100,-443.95 52100,-432.15 52100,-420.75"/>
<polygon fill="black" stroke="black" points="52103.5,-420.41 52100,-410.41 52096.5,-420.41 52103.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge350" class="edge">
<title>layer_1_expert_5_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M52467.67,-455C52415.2,-441.3 52358.31,-426.44 52305.31,-412.61"/>
<polygon fill="black" stroke="black" points="52306.02,-409.18 52295.46,-410.04 52304.25,-415.95 52306.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge351" class="edge">
<title>layer_1_expert_6_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M52992.13,-455C52976.21,-452.11 52960.39,-449.41 52945,-447 52748.91,-416.29 52525.48,-393.55 52357.64,-378.88"/>
<polygon fill="black" stroke="black" points="52357.94,-375.4 52347.68,-378.02 52357.34,-382.37 52357.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_4&#45;&gt;layer_1_agg_ep_4 -->
<g id="edge352" class="edge">
<title>layer_1_expert_7_ep_4&#45;&gt;layer_1_agg_ep_4</title>
<path fill="none" stroke="black" d="M53559.44,-454.98C53542.09,-451.99 53524.79,-449.28 53508,-447 53100.89,-391.83 52622.79,-371.18 52341.51,-363.5"/>
<polygon fill="black" stroke="black" points="52341.26,-359.99 52331.17,-363.22 52341.07,-366.99 52341.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_5 -->
<g id="node200" class="node">
<title>layer_1_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="43375.07,-410 42924.77,-410 42808.93,-306 43259.23,-306 43375.07,-410"/>
<text text-anchor="middle" x="43092" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="43092" y="-361" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="43092" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="43092" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge354" class="edge">
<title>layer_1_expert_0_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M41012.39,-465.2C41048.11,-458.05 41085.64,-451.47 41121,-447 41451.72,-405.18 42418.93,-376.08 42863.58,-364.54"/>
<polygon fill="black" stroke="black" points="42863.76,-368.03 42873.66,-364.27 42863.58,-361.03 42863.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge355" class="edge">
<title>layer_1_expert_1_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M41575.82,-465.62C41611.43,-458.45 41648.8,-451.77 41684,-447 42096.65,-391.08 42582.25,-370.62 42861.87,-363.19"/>
<polygon fill="black" stroke="black" points="42862.24,-366.68 42872.14,-362.92 42862.05,-359.68 42862.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge356" class="edge">
<title>layer_1_expert_2_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M42139.74,-466.6C42175.11,-459.4 42212.16,-452.46 42247,-447 42459.34,-413.74 42703.74,-389.83 42874.9,-375.41"/>
<polygon fill="black" stroke="black" points="42875.36,-378.88 42885.04,-374.55 42874.78,-371.9 42875.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge357" class="edge">
<title>layer_1_expert_3_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M42697.92,-461.9C42764.29,-444.56 42840.66,-424.62 42908.4,-406.94"/>
<polygon fill="black" stroke="black" points="42909.53,-410.26 42918.33,-404.35 42907.77,-403.49 42909.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge358" class="edge">
<title>layer_1_expert_4_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M43092,-455C43092,-443.95 43092,-432.15 43092,-420.75"/>
<polygon fill="black" stroke="black" points="43095.5,-420.41 43092,-410.41 43088.5,-420.41 43095.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge359" class="edge">
<title>layer_1_expert_5_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M43459.67,-455C43407.2,-441.3 43350.31,-426.44 43297.31,-412.61"/>
<polygon fill="black" stroke="black" points="43298.02,-409.18 43287.46,-410.04 43296.25,-415.95 43298.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge360" class="edge">
<title>layer_1_expert_6_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M43984.13,-455C43968.21,-452.11 43952.39,-449.41 43937,-447 43740.91,-416.29 43517.48,-393.55 43349.64,-378.88"/>
<polygon fill="black" stroke="black" points="43349.94,-375.4 43339.68,-378.02 43349.34,-382.37 43349.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_5&#45;&gt;layer_1_agg_ep_5 -->
<g id="edge361" class="edge">
<title>layer_1_expert_7_ep_5&#45;&gt;layer_1_agg_ep_5</title>
<path fill="none" stroke="black" d="M44551.44,-454.98C44534.09,-451.99 44516.79,-449.28 44500,-447 44092.89,-391.83 43614.79,-371.18 43333.51,-363.5"/>
<polygon fill="black" stroke="black" points="43333.26,-359.99 43323.17,-363.22 43333.07,-366.99 43333.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_6 -->
<g id="node201" class="node">
<title>layer_1_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="56887.07,-410 56436.77,-410 56320.93,-306 56771.23,-306 56887.07,-410"/>
<text text-anchor="middle" x="56604" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="56604" y="-361" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="56604" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="56604" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge363" class="edge">
<title>layer_1_expert_0_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M54524.39,-465.2C54560.11,-458.05 54597.64,-451.47 54633,-447 54963.72,-405.18 55930.93,-376.08 56375.58,-364.54"/>
<polygon fill="black" stroke="black" points="56375.76,-368.03 56385.66,-364.27 56375.58,-361.03 56375.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge364" class="edge">
<title>layer_1_expert_1_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M55087.82,-465.62C55123.43,-458.45 55160.8,-451.77 55196,-447 55608.65,-391.08 56094.25,-370.62 56373.87,-363.19"/>
<polygon fill="black" stroke="black" points="56374.24,-366.68 56384.14,-362.92 56374.05,-359.68 56374.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge365" class="edge">
<title>layer_1_expert_2_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M55651.74,-466.6C55687.11,-459.4 55724.16,-452.46 55759,-447 55971.34,-413.74 56215.74,-389.83 56386.9,-375.41"/>
<polygon fill="black" stroke="black" points="56387.36,-378.88 56397.04,-374.55 56386.78,-371.9 56387.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge366" class="edge">
<title>layer_1_expert_3_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M56209.92,-461.9C56276.29,-444.56 56352.66,-424.62 56420.4,-406.94"/>
<polygon fill="black" stroke="black" points="56421.53,-410.26 56430.33,-404.35 56419.77,-403.49 56421.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge367" class="edge">
<title>layer_1_expert_4_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M56604,-455C56604,-443.95 56604,-432.15 56604,-420.75"/>
<polygon fill="black" stroke="black" points="56607.5,-420.41 56604,-410.41 56600.5,-420.41 56607.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge368" class="edge">
<title>layer_1_expert_5_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M56971.67,-455C56919.2,-441.3 56862.31,-426.44 56809.31,-412.61"/>
<polygon fill="black" stroke="black" points="56810.02,-409.18 56799.46,-410.04 56808.25,-415.95 56810.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge369" class="edge">
<title>layer_1_expert_6_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M57496.13,-455C57480.21,-452.11 57464.39,-449.41 57449,-447 57252.91,-416.29 57029.48,-393.55 56861.64,-378.88"/>
<polygon fill="black" stroke="black" points="56861.94,-375.4 56851.68,-378.02 56861.34,-382.37 56861.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_6&#45;&gt;layer_1_agg_ep_6 -->
<g id="edge370" class="edge">
<title>layer_1_expert_7_ep_6&#45;&gt;layer_1_agg_ep_6</title>
<path fill="none" stroke="black" d="M58063.44,-454.98C58046.09,-451.99 58028.79,-449.28 58012,-447 57604.89,-391.83 57126.79,-371.18 56845.51,-363.5"/>
<polygon fill="black" stroke="black" points="56845.26,-359.99 56835.17,-363.22 56845.07,-366.99 56845.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_7 -->
<g id="node202" class="node">
<title>layer_1_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="47879.07,-410 47428.77,-410 47312.93,-306 47763.23,-306 47879.07,-410"/>
<text text-anchor="middle" x="47596" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="47596" y="-361" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="47596" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="47596" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_expert_0_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge372" class="edge">
<title>layer_1_expert_0_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M45516.39,-465.2C45552.11,-458.05 45589.64,-451.47 45625,-447 45955.72,-405.18 46922.93,-376.08 47367.58,-364.54"/>
<polygon fill="black" stroke="black" points="47367.76,-368.03 47377.66,-364.27 47367.58,-361.03 47367.76,-368.03"/>
</g>
<!-- layer_1_expert_1_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge373" class="edge">
<title>layer_1_expert_1_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M46079.82,-465.62C46115.43,-458.45 46152.8,-451.77 46188,-447 46600.65,-391.08 47086.25,-370.62 47365.87,-363.19"/>
<polygon fill="black" stroke="black" points="47366.24,-366.68 47376.14,-362.92 47366.05,-359.68 47366.24,-366.68"/>
</g>
<!-- layer_1_expert_2_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge374" class="edge">
<title>layer_1_expert_2_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M46643.74,-466.6C46679.11,-459.4 46716.16,-452.46 46751,-447 46963.34,-413.74 47207.74,-389.83 47378.9,-375.41"/>
<polygon fill="black" stroke="black" points="47379.36,-378.88 47389.04,-374.55 47378.78,-371.9 47379.36,-378.88"/>
</g>
<!-- layer_1_expert_3_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge375" class="edge">
<title>layer_1_expert_3_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M47201.92,-461.9C47268.29,-444.56 47344.66,-424.62 47412.4,-406.94"/>
<polygon fill="black" stroke="black" points="47413.53,-410.26 47422.33,-404.35 47411.77,-403.49 47413.53,-410.26"/>
</g>
<!-- layer_1_expert_4_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge376" class="edge">
<title>layer_1_expert_4_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M47596,-455C47596,-443.95 47596,-432.15 47596,-420.75"/>
<polygon fill="black" stroke="black" points="47599.5,-420.41 47596,-410.41 47592.5,-420.41 47599.5,-420.41"/>
</g>
<!-- layer_1_expert_5_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge377" class="edge">
<title>layer_1_expert_5_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M47963.67,-455C47911.2,-441.3 47854.31,-426.44 47801.31,-412.61"/>
<polygon fill="black" stroke="black" points="47802.02,-409.18 47791.46,-410.04 47800.25,-415.95 47802.02,-409.18"/>
</g>
<!-- layer_1_expert_6_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge378" class="edge">
<title>layer_1_expert_6_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M48488.13,-455C48472.21,-452.11 48456.39,-449.41 48441,-447 48244.91,-416.29 48021.48,-393.55 47853.64,-378.88"/>
<polygon fill="black" stroke="black" points="47853.94,-375.4 47843.68,-378.02 47853.34,-382.37 47853.94,-375.4"/>
</g>
<!-- layer_1_expert_7_ep_7&#45;&gt;layer_1_agg_ep_7 -->
<g id="edge379" class="edge">
<title>layer_1_expert_7_ep_7&#45;&gt;layer_1_agg_ep_7</title>
<path fill="none" stroke="black" d="M49055.44,-454.98C49038.09,-451.99 49020.79,-449.28 49004,-447 48596.89,-391.83 48118.79,-371.18 47837.51,-363.5"/>
<polygon fill="black" stroke="black" points="47837.26,-359.99 47827.17,-363.22 47837.07,-366.99 47837.26,-359.99"/>
</g>
<!-- layer_1_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge317" class="edge">
<title>layer_1_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M65831.51,-352.85C66455.95,-341.28 68295.8,-308.8 69824,-298 70875,-290.57 144447.14,-306.83 145498,-288 145510.45,-287.78 145513.55,-287.22 145526,-287 146153.14,-275.79 506190.76,-269.24 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge326" class="edge">
<title>layer_1_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M61327.51,-352.85C61951.95,-341.28 63791.8,-308.8 65320,-298 66433.21,-290.13 144359.94,-307.94 145473,-288 145485.45,-287.78 145488.55,-287.22 145501,-287 146128.19,-275.79 506190.71,-269.24 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge335" class="edge">
<title>layer_1_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M70330.65,-348.49C70693.15,-334.6 71449.78,-307.61 72090,-298 73109.79,-282.69 144503.26,-306.27 145523,-288 145535.45,-287.78 145538.55,-287.22 145551,-287 146178.1,-275.79 506190.8,-269.24 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge344" class="edge">
<title>layer_1_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M38807.51,-352.85C39431.95,-341.28 41271.8,-308.79 42800,-298 48432.97,-258.24 138562.89,-287.45 144196,-287 184487.33,-283.81 466526.67,-284.23 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge353" class="edge">
<title>layer_1_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M52319.51,-352.85C52943.95,-341.28 54783.8,-308.79 56312,-298 56930.81,-293.63 144804.27,-299.08 145423,-288 145435.45,-287.78 145438.55,-287.22 145451,-287 146078.27,-275.79 506190.63,-269.24 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge362" class="edge">
<title>layer_1_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M43311.51,-352.85C43935.95,-341.27 45775.8,-308.78 47304,-298 48649.69,-288.51 142850.28,-290.17 144196,-288 144338.22,-287.77 144373.78,-287.23 144516,-287 154579.93,-271.03 496754.06,-272.8 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge371" class="edge">
<title>layer_1_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M56823.51,-352.85C57447.95,-341.28 59287.8,-308.79 60816,-298 61403.71,-293.85 144860.37,-298.52 145448,-288 145460.45,-287.78 145463.55,-287.22 145476,-287 146103.23,-275.79 506190.67,-269.24 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge380" class="edge">
<title>layer_1_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M47815.51,-352.85C48439.95,-341.28 50279.8,-308.79 51808,-298 53095.58,-288.91 143228.39,-288.78 144516,-288 144920.44,-287.76 145021.56,-287.23 145426,-287 185580.66,-263.94 466663.34,-284.18 506818,-269 537959.2,-257.23 576654.62,-220.28 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_1_moe_alltoall -->
<g id="node203" class="node">
<title>layer_1_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="60911" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="60911" y="-861" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="60911" y="-850" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="60911" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="60911" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_1_ln_tp_0 -->
<g id="node204" class="node">
<title>layer_1_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="67626.07,-899 67175.77,-899 67059.93,-795 67510.23,-795 67626.07,-899"/>
<text text-anchor="middle" x="67343" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="67343" y="-850" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="67343" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="67343" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_qkv_tp_0 -->
<g id="node208" class="node">
<title>layer_2_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="103654.7,-729 103212.94,-729 103099.3,-625 103541.06,-625 103654.7,-729"/>
<text text-anchor="middle" x="103377" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="103377" y="-680" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="103377" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="103377" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_1_ln_tp_0&#45;&gt;layer_2_qkv_tp_0 -->
<g id="edge3081" class="edge">
<title>layer_1_ln_tp_0&#45;&gt;layer_2_qkv_tp_0</title>
<path fill="none" stroke="black" d="M67527.04,-809.87C67562.73,-803.99 67599.94,-798.64 67635,-795 67983.55,-758.77 68072.62,-774.04 68423,-768 68483.18,-766.96 103031.4,-768.38 103091,-760 103133.03,-754.09 103177.54,-743.53 103218.61,-731.91"/>
<polygon fill="black" stroke="black" points="103219.77,-735.21 103228.42,-729.09 103217.84,-728.48 103219.77,-735.21"/>
</g>
<!-- layer_1_ln_tp_1 -->
<g id="node205" class="node">
<title>layer_1_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="68210.07,-899 67759.77,-899 67643.93,-795 68094.23,-795 68210.07,-899"/>
<text text-anchor="middle" x="67927" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="67927" y="-850" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="67927" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="67927" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_qkv_tp_1 -->
<g id="node209" class="node">
<title>layer_2_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="104228.7,-729 103786.94,-729 103673.3,-625 104115.06,-625 104228.7,-729"/>
<text text-anchor="middle" x="103951" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="103951" y="-680" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="103951" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="103951" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_1_ln_tp_1&#45;&gt;layer_2_qkv_tp_1 -->
<g id="edge3082" class="edge">
<title>layer_1_ln_tp_1&#45;&gt;layer_2_qkv_tp_1</title>
<path fill="none" stroke="black" d="M68111.47,-810.16C68147.04,-804.28 68184.09,-798.85 68219,-795 68473.29,-766.94 68538.23,-774.03 68794,-768 68854.52,-766.57 103604.05,-768.4 103664,-760 103706.16,-754.09 103750.83,-743.53 103792.04,-731.91"/>
<polygon fill="black" stroke="black" points="103793.23,-735.21 103801.88,-729.09 103791.31,-728.48 103793.23,-735.21"/>
</g>
<!-- layer_1_ln_tp_2 -->
<g id="node206" class="node">
<title>layer_1_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="68794.07,-899 68343.77,-899 68227.93,-795 68678.23,-795 68794.07,-899"/>
<text text-anchor="middle" x="68511" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="68511" y="-850" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="68511" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="68511" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_qkv_tp_2 -->
<g id="node210" class="node">
<title>layer_2_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="107542.7,-729 107100.94,-729 106987.3,-625 107429.06,-625 107542.7,-729"/>
<text text-anchor="middle" x="107265" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="107265" y="-680" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="107265" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="107265" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_1_ln_tp_2&#45;&gt;layer_2_qkv_tp_2 -->
<g id="edge3083" class="edge">
<title>layer_1_ln_tp_2&#45;&gt;layer_2_qkv_tp_2</title>
<path fill="none" stroke="black" d="M68694.17,-809.05C68730.11,-803.21 68767.63,-798.08 68803,-795 69331.21,-748.97 106452.95,-833.78 106978,-760 107020.16,-754.08 107064.82,-743.51 107106.04,-731.89"/>
<polygon fill="black" stroke="black" points="107107.23,-735.19 107115.88,-729.07 107105.3,-728.46 107107.23,-735.19"/>
</g>
<!-- layer_1_ln_tp_3 -->
<g id="node207" class="node">
<title>layer_1_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="69378.07,-899 68927.77,-899 68811.93,-795 69262.23,-795 69378.07,-899"/>
<text text-anchor="middle" x="69095" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="69095" y="-850" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="69095" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="69095" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_qkv_tp_3 -->
<g id="node211" class="node">
<title>layer_2_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="108116.7,-729 107674.94,-729 107561.3,-625 108003.06,-625 108116.7,-729"/>
<text text-anchor="middle" x="107839" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="107839" y="-680" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="107839" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="107839" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_1_ln_tp_3&#45;&gt;layer_2_qkv_tp_3 -->
<g id="edge3084" class="edge">
<title>layer_1_ln_tp_3&#45;&gt;layer_2_qkv_tp_3</title>
<path fill="none" stroke="black" d="M69278.17,-809.05C69314.11,-803.21 69351.63,-798.08 69387,-795 69915.07,-748.99 107027.09,-833.76 107552,-760 107594.16,-754.08 107638.82,-743.51 107680.04,-731.89"/>
<polygon fill="black" stroke="black" points="107681.23,-735.19 107689.88,-729.07 107679.3,-728.46 107681.23,-735.19"/>
</g>
<!-- layer_2_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge389" class="edge">
<title>layer_2_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M103556.63,-639.11C103592.07,-633.24 103629.09,-628.09 103664,-625 103804.09,-612.59 144035.62,-637.48 144168,-590 144262.22,-556.2 144247.98,-481.35 144342,-447 144383.02,-432.01 145086.12,-449.37 145128,-437 145164.66,-426.18 145201.01,-401.18 145224.78,-382.38"/>
<polygon fill="black" stroke="black" points="145227.07,-385.03 145232.64,-376.02 145222.67,-379.59 145227.07,-385.03"/>
</g>
<!-- layer_2_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge390" class="edge">
<title>layer_2_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M104130.63,-639.1C104166.07,-633.23 104203.09,-628.09 104238,-625 104376.47,-612.76 144135.67,-628.56 144273,-607 144285.91,-604.97 144288.34,-601.26 144301,-598 144318.98,-593.37 144325.27,-598.06 144342,-590 144430.34,-547.44 144418.15,-481.32 144510,-447 144536,-437.29 145489.48,-456.72 145509,-437 145560.7,-384.78 145451.35,-367.29 145359.65,-361.57"/>
<polygon fill="black" stroke="black" points="145359.61,-358.06 145349.42,-360.97 145359.2,-365.05 145359.61,-358.06"/>
</g>
<!-- layer_2_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge391" class="edge">
<title>layer_2_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M107444.63,-639.1C107480.07,-633.23 107517.09,-628.09 107552,-625 107806.21,-602.53 144046.01,-617.42 144301,-607 144394.12,-603.2 144423.37,-624.36 144510,-590 144604.65,-552.46 144593.1,-481.23 144689,-447 144711.68,-438.9 145539.07,-454.13 145556,-437 145585.49,-407.17 145469.55,-385.01 145372.44,-372.08"/>
<polygon fill="black" stroke="black" points="145372.88,-368.61 145362.51,-370.78 145371.97,-375.55 145372.88,-368.61"/>
</g>
<!-- layer_2_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge392" class="edge">
<title>layer_2_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M108058.85,-675.89C110996.56,-674.41 142418.17,-657.4 144351,-607 144501.36,-603.08 144542.21,-622.8 144689,-590 144894.89,-544 145122.13,-429.22 145212.14,-380.94"/>
<polygon fill="black" stroke="black" points="145214.03,-383.9 145221.18,-376.07 145210.71,-377.73 145214.03,-383.9"/>
</g>
<!-- layer_2_qkv_comm -->
<g id="node212" class="node">
<title>layer_2_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="105608" cy="-677" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="105608" y="-691" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="105608" y="-680" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="105608" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="105608" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_2_attn_tp_0 -->
<g id="node213" class="node">
<title>layer_2_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="100948.7,-729 100506.94,-729 100393.3,-625 100835.06,-625 100948.7,-729"/>
<text text-anchor="middle" x="100671" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="100671" y="-680" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="100671" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="100671" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_out_tp_0 -->
<g id="node217" class="node">
<title>layer_2_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="105432.7,-559 104990.94,-559 104877.3,-455 105319.06,-455 105432.7,-559"/>
<text text-anchor="middle" x="105155" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="105155" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="105155" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="105155" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_tp_0&#45;&gt;layer_2_attn_out_tp_0 -->
<g id="edge397" class="edge">
<title>layer_2_attn_tp_0&#45;&gt;layer_2_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M100851.91,-640.22C100886.99,-634.32 100923.55,-628.87 100958,-625 101207.83,-596.95 101271.68,-604.31 101523,-598 101614.92,-595.69 104741.78,-601.54 104833,-590 104881.32,-583.88 104932.8,-572.88 104980.09,-560.88"/>
<polygon fill="black" stroke="black" points="104980.98,-564.27 104989.8,-558.39 104979.24,-557.49 104980.98,-564.27"/>
</g>
<!-- layer_2_attn_tp_1 -->
<g id="node214" class="node">
<title>layer_2_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="101522.7,-729 101080.94,-729 100967.3,-625 101409.06,-625 101522.7,-729"/>
<text text-anchor="middle" x="101245" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="101245" y="-680" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="101245" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="101245" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_out_tp_1 -->
<g id="node218" class="node">
<title>layer_2_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="106536.7,-559 106094.94,-559 105981.3,-455 106423.06,-455 106536.7,-559"/>
<text text-anchor="middle" x="106259" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="106259" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="106259" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="106259" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_tp_1&#45;&gt;layer_2_attn_out_tp_1 -->
<g id="edge399" class="edge">
<title>layer_2_attn_tp_1&#45;&gt;layer_2_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M101425.46,-639.65C101460.66,-633.77 101497.38,-628.48 101532,-625 102017.7,-576.16 102141.9,-604.69 102630,-598 102786.21,-595.86 105285.98,-598.03 105442,-590 105651.69,-579.2 105890.54,-553.69 106055.59,-533.96"/>
<polygon fill="black" stroke="black" points="106056.34,-537.4 106065.85,-532.73 106055.51,-530.45 106056.34,-537.4"/>
</g>
<!-- layer_2_attn_tp_2 -->
<g id="node215" class="node">
<title>layer_2_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="102096.7,-729 101654.94,-729 101541.3,-625 101983.06,-625 102096.7,-729"/>
<text text-anchor="middle" x="101819" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="101819" y="-680" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="101819" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="101819" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_out_tp_2 -->
<g id="node219" class="node">
<title>layer_2_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="107375.7,-559 106933.94,-559 106820.3,-455 107262.06,-455 107375.7,-559"/>
<text text-anchor="middle" x="107098" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="107098" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="107098" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="107098" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_tp_2&#45;&gt;layer_2_attn_out_tp_2 -->
<g id="edge401" class="edge">
<title>layer_2_attn_tp_2&#45;&gt;layer_2_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M101999.05,-639.49C102034.37,-633.6 102071.24,-628.35 102106,-625 102467.7,-590.1 103377.63,-601.52 103741,-598 103896.83,-596.49 106390.61,-601.7 106546,-590 106665.92,-580.97 106799.31,-561.42 106904.93,-543.67"/>
<polygon fill="black" stroke="black" points="106905.78,-547.08 106915.06,-541.96 106904.62,-540.18 106905.78,-547.08"/>
</g>
<!-- layer_2_attn_tp_3 -->
<g id="node216" class="node">
<title>layer_2_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="102670.7,-729 102228.94,-729 102115.3,-625 102557.06,-625 102670.7,-729"/>
<text text-anchor="middle" x="102393" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="102393" y="-680" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="102393" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="102393" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_out_tp_3 -->
<g id="node220" class="node">
<title>layer_2_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="108081.7,-559 107639.94,-559 107526.3,-455 107968.06,-455 108081.7,-559"/>
<text text-anchor="middle" x="107804" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="107804" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="107804" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="107804" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_2_attn_tp_3&#45;&gt;layer_2_attn_out_tp_3 -->
<g id="edge403" class="edge">
<title>layer_2_attn_tp_3&#45;&gt;layer_2_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M102572.79,-639.31C102607.87,-633.47 102644.48,-628.27 102679,-625 102915.07,-602.61 104575.88,-599.87 104813,-598 104884.44,-597.44 107313.9,-597 107385,-590 107462.5,-582.37 107546.95,-567.19 107619.61,-551.94"/>
<polygon fill="black" stroke="black" points="107620.72,-555.29 107629.78,-549.79 107619.27,-548.44 107620.72,-555.29"/>
</g>
<!-- layer_2_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge398" class="edge">
<title>layer_2_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M105412.54,-540.36C105573.13,-558.93 105784.25,-580.4 105972,-590 107023.01,-643.77 142712.74,-674.03 144995.58,-675.91"/>
<polygon fill="black" stroke="black" points="144995.81,-679.41 145005.82,-675.92 144995.82,-672.41 144995.81,-679.41"/>
</g>
<!-- layer_2_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge400" class="edge">
<title>layer_2_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M106534.68,-557.1C106622.68,-570.58 106720.66,-583.32 106811,-590 107070.81,-609.22 144065.95,-582.42 144326,-598 144359.51,-600.01 144367.62,-603.37 144401,-607 144603.01,-628.95 144837.78,-651.15 144980.03,-664.23"/>
<polygon fill="black" stroke="black" points="144979.84,-667.73 144990.11,-665.16 144980.48,-660.76 144979.84,-667.73"/>
</g>
<!-- layer_2_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge402" class="edge">
<title>layer_2_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M107316.46,-559.02C107380.69,-571.78 107451.34,-583.63 107517,-590 107580.73,-596.18 144334.74,-588.08 144398,-598 144410.91,-600.03 144413.2,-604.33 144426,-607 144621.05,-647.71 144852.6,-664.67 144990.08,-671.54"/>
<polygon fill="black" stroke="black" points="144990.07,-675.04 145000.23,-672.04 144990.41,-668.05 144990.07,-675.04"/>
</g>
<!-- layer_2_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge404" class="edge">
<title>layer_2_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M107972.86,-559C108022.66,-571.75 108077.6,-583.61 108129,-590 108254.07,-605.55 144300.19,-590.46 144426,-598 144459.51,-600.01 144467.65,-603.11 144501,-607 144664.19,-626.04 144852.08,-647.21 144975.5,-661.02"/>
<polygon fill="black" stroke="black" points="144975.43,-664.53 144985.75,-662.17 144976.21,-657.58 144975.43,-664.53"/>
</g>
<!-- layer_2_attn_allreduce -->
<g id="node221" class="node">
<title>layer_2_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="102885" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="102885" y="-691" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="102885" y="-680" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="102885" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="102885" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_gate_tp_0 -->
<g id="node222" class="node">
<title>layer_2_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="91621.99,-729 91173.4,-729 91058.01,-625 91506.6,-625 91621.99,-729"/>
<text text-anchor="middle" x="91340" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="91340" y="-680" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="91340" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="91340" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_2_route_ep_0 -->
<g id="node226" class="node">
<title>layer_2_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="75760.43,-559 75301.6,-559 75183.57,-455 75642.4,-455 75760.43,-559"/>
<text text-anchor="middle" x="75472" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="75472" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="75472" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="75472" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_0 -->
<g id="edge405" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91113.88,-675.39C89922.1,-671.98 84249.04,-652.99 79609,-590 78133.22,-569.97 76361.63,-529.27 75719.56,-513.98"/>
<polygon fill="black" stroke="black" points="75719.34,-510.48 75709.26,-513.74 75719.17,-517.48 75719.34,-510.48"/>
<text text-anchor="middle" x="80907" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_1 -->
<g id="node227" class="node">
<title>layer_2_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="104824.43,-559 104365.6,-559 104247.57,-455 104706.4,-455 104824.43,-559"/>
<text text-anchor="middle" x="104536" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="104536" y="-510" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="104536" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="104536" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_1 -->
<g id="edge406" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91522.56,-639.31C91558.37,-633.45 91595.76,-628.24 91631,-625 91827.62,-606.9 93210.57,-610.18 93408,-607 93588.91,-604.08 93634.08,-600.11 93815,-598 95327.79,-580.39 99110.2,-606.74 100623,-590 102020.93,-574.53 103699.33,-530.96 104304.43,-514.45"/>
<polygon fill="black" stroke="black" points="104304.68,-517.95 104314.58,-514.17 104304.49,-510.95 104304.68,-517.95"/>
<text text-anchor="middle" x="93841" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_2 -->
<g id="node228" class="node">
<title>layer_2_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="89202.43,-559 88743.6,-559 88625.57,-455 89084.4,-455 89202.43,-559"/>
<text text-anchor="middle" x="88914" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="88914" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="88914" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="88914" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_2 -->
<g id="edge407" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91141.67,-624.92C91093.63,-614.31 91042.22,-604.43 90994,-598 90646.59,-551.7 89631.9,-523.9 89160.27,-513.14"/>
<polygon fill="black" stroke="black" points="89160.34,-509.64 89150.26,-512.91 89160.18,-516.64 89160.34,-509.64"/>
<text text-anchor="middle" x="91077" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_3 -->
<g id="node229" class="node">
<title>layer_2_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="80194.43,-559 79735.6,-559 79617.57,-455 80076.4,-455 80194.43,-559"/>
<text text-anchor="middle" x="79906" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="79906" y="-510" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="79906" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="79906" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_3 -->
<g id="edge408" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91112.15,-674.04C90218.99,-666.2 86870,-635.32 84113,-590 82608.69,-565.27 80801.98,-527.26 80153.04,-513.34"/>
<polygon fill="black" stroke="black" points="80152.7,-509.83 80142.63,-513.12 80152.55,-516.83 80152.7,-509.83"/>
<text text-anchor="middle" x="85121" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_4 -->
<g id="node230" class="node">
<title>layer_2_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="100614.43,-559 100155.6,-559 100037.57,-455 100496.4,-455 100614.43,-559"/>
<text text-anchor="middle" x="100326" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="100326" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="100326" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="100326" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_4 -->
<g id="edge409" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91522.97,-639.41C91558.66,-633.56 91595.9,-628.33 91631,-625 91756.01,-613.12 92637.98,-632.21 92761,-607 92771.35,-604.88 92772.64,-600.05 92783,-598 92826.38,-589.41 95922.78,-590.47 95967,-590 97544.11,-573.19 99441.8,-529.42 100093.29,-513.71"/>
<polygon fill="black" stroke="black" points="100093.83,-517.2 100103.74,-513.46 100093.66,-510.2 100093.83,-517.2"/>
<text text-anchor="middle" x="92809" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_5 -->
<g id="node231" class="node">
<title>layer_2_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="95958.43,-559 95499.6,-559 95381.57,-455 95840.4,-455 95958.43,-559"/>
<text text-anchor="middle" x="95670" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="95670" y="-510" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="95670" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="95670" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_5 -->
<g id="edge410" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91523.4,-639.77C91558.97,-633.91 91596.05,-628.59 91631,-625 91759.06,-611.86 92084.09,-633.8 92210,-607 92220.33,-604.8 92221.65,-600.14 92232,-598 92278.36,-588.43 92610.67,-591.09 92658,-590 93695.5,-566.14 94933.8,-530.01 95438.63,-514.96"/>
<polygon fill="black" stroke="black" points="95439.06,-518.45 95448.95,-514.66 95438.85,-511.46 95439.06,-518.45"/>
<text text-anchor="middle" x="92258" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_6 -->
<g id="node232" class="node">
<title>layer_2_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="92649.43,-559 92190.6,-559 92072.57,-455 92531.4,-455 92649.43,-559"/>
<text text-anchor="middle" x="92361" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="92361" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="92361" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="92361" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_6 -->
<g id="edge411" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91527.06,-643.16C91561.62,-637.11 91597.4,-630.85 91631,-625 91700.32,-612.93 91717.57,-609.45 91787,-598 91909.33,-577.82 92046.51,-556.28 92156.08,-539.32"/>
<polygon fill="black" stroke="black" points="92156.92,-542.74 92166.26,-537.75 92155.85,-535.82 92156.92,-542.74"/>
<text text-anchor="middle" x="91813" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_route_ep_7 -->
<g id="node233" class="node">
<title>layer_2_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="84698.43,-559 84239.6,-559 84121.57,-455 84580.4,-455 84698.43,-559"/>
<text text-anchor="middle" x="84410" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="84410" y="-510" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="84410" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="84410" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_7 -->
<g id="edge412" class="edge">
<title>layer_2_gate_tp_0&#45;&gt;layer_2_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91107.32,-669.79C90599.73,-656.3 89354.88,-623.46 88312,-598 86930.48,-564.27 85273.73,-527.17 84657.05,-513.47"/>
<polygon fill="black" stroke="black" points="84656.78,-509.96 84646.71,-513.24 84656.63,-516.96 84656.78,-509.96"/>
<text text-anchor="middle" x="88666" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1 -->
<g id="node223" class="node">
<title>layer_2_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="92785.99,-729 92337.4,-729 92222.01,-625 92670.6,-625 92785.99,-729"/>
<text text-anchor="middle" x="92504" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="92504" y="-680" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="92504" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="92504" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_0 -->
<g id="edge413" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92223.02,-625.94C92219.66,-625.61 92216.32,-625.3 92213,-625 91989.94,-605.1 88405.91,-610.77 88182,-607 88045.07,-604.69 88010.93,-600.07 87874,-598 86955.77,-584.14 80527.28,-599.54 79609,-590 78133.61,-574.67 76362.68,-531.15 75720.14,-514.55"/>
<polygon fill="black" stroke="black" points="75719.91,-511.04 75709.83,-514.28 75719.73,-518.04 75719.91,-511.04"/>
<text text-anchor="middle" x="88208" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_1 -->
<g id="edge414" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92686.54,-639.09C92722.36,-633.25 92759.75,-628.11 92795,-625 93215.98,-587.89 99979.68,-622.81 100402,-607 100457.22,-604.93 100470.81,-600.62 100526,-598 101957.1,-530.05 103678.01,-513.19 104298.52,-509.19"/>
<polygon fill="black" stroke="black" points="104298.95,-512.68 104308.92,-509.12 104298.9,-505.68 104298.95,-512.68"/>
<text text-anchor="middle" x="100552" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_2 -->
<g id="edge415" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92223.36,-626.39C92219.89,-625.92 92216.43,-625.45 92213,-625 92079.4,-607.35 92045.52,-606.03 91911,-598 90888.93,-537.02 89668.19,-516.61 89157.44,-510.43"/>
<polygon fill="black" stroke="black" points="89157.41,-506.93 89147.37,-510.31 89157.33,-513.93 89157.41,-506.93"/>
<text text-anchor="middle" x="92073" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_3 -->
<g id="edge416" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92223.01,-625.98C92219.66,-625.64 92216.32,-625.31 92213,-625 91914.5,-597.03 91163.77,-611.4 90864,-607 90614.22,-603.33 90551.8,-600.16 90302,-598 88926.72,-586.1 85488.26,-604.29 84113,-590 82609.48,-574.38 80804.12,-530.87 80154.2,-514.41"/>
<polygon fill="black" stroke="black" points="80153.86,-510.9 80143.77,-514.15 80153.68,-517.9 80153.86,-510.9"/>
<text text-anchor="middle" x="90890" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_4 -->
<g id="edge417" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92686.55,-639.14C92722.36,-633.29 92759.75,-628.14 92795,-625 93039.98,-603.19 96976.09,-611.42 97222,-607 98298.4,-587.65 99584.04,-538.26 100097.66,-517.46"/>
<polygon fill="black" stroke="black" points="100097.93,-520.95 100107.78,-517.05 100097.65,-513.96 100097.93,-520.95"/>
<text text-anchor="middle" x="97670" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_5 -->
<g id="edge418" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92687.87,-640.49C92723.32,-634.57 92760.23,-629.06 92795,-625 92845.74,-619.08 93202.97,-600.45 93254,-598 94056.05,-559.48 95008.57,-528.27 95438.77,-514.96"/>
<polygon fill="black" stroke="black" points="95438.95,-518.45 95448.84,-514.65 95438.73,-511.46 95438.95,-518.45"/>
<text text-anchor="middle" x="93280" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_6 -->
<g id="edge419" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92460.32,-624.68C92444.73,-606.36 92427.04,-585.59 92410.96,-566.69"/>
<polygon fill="black" stroke="black" points="92413.56,-564.35 92404.41,-559 92408.23,-568.89 92413.56,-564.35"/>
<text text-anchor="middle" x="92467" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_7 -->
<g id="edge420" class="edge">
<title>layer_2_gate_tp_1&#45;&gt;layer_2_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92223.01,-626.05C92219.65,-625.69 92216.32,-625.33 92213,-625 91925.46,-595.98 91851.36,-626.23 91563,-607 91525.1,-604.47 91515.93,-600.06 91478,-598 91319.29,-589.4 88775.94,-591.77 88617,-590 87113.26,-573.24 85307.58,-530.41 84657.91,-514.28"/>
<polygon fill="black" stroke="black" points="84657.57,-510.77 84647.48,-514.02 84657.39,-517.77 84657.57,-510.77"/>
<text text-anchor="middle" x="91589" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2 -->
<g id="node224" class="node">
<title>layer_2_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="93367.99,-729 92919.4,-729 92804.01,-625 93252.6,-625 93367.99,-729"/>
<text text-anchor="middle" x="93086" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="93086" y="-680" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="93086" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="93086" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_0 -->
<g id="edge421" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92805.02,-625.94C92801.66,-625.61 92798.32,-625.3 92795,-625 92669.41,-613.83 88379.67,-631.57 88256,-607 88245.64,-604.94 88244.36,-600.04 88234,-598 88204.62,-592.21 79638.95,-590.31 79609,-590 78133.61,-574.7 76362.68,-531.17 75720.14,-514.55"/>
<polygon fill="black" stroke="black" points="75719.91,-511.05 75709.83,-514.29 75719.73,-518.04 75719.91,-511.05"/>
<text text-anchor="middle" x="88282" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_1 -->
<g id="edge422" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93304.77,-671.88C93842.32,-661.94 95270.93,-636.61 96463,-625 98293.6,-607.18 98751.51,-633.91 100582,-607 101314.43,-596.23 103572.3,-534.65 104304.31,-514.43"/>
<polygon fill="black" stroke="black" points="104304.54,-517.93 104314.44,-514.15 104304.35,-510.93 104304.54,-517.93"/>
<text text-anchor="middle" x="101010" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_2 -->
<g id="edge423" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92805.01,-626.05C92801.65,-625.69 92798.32,-625.34 92795,-625 92513.22,-596.48 92439.94,-633.93 92158,-607 92133.34,-604.64 92127.66,-600.35 92103,-598 91532.58,-543.53 89800.94,-518.32 89157.86,-510.65"/>
<polygon fill="black" stroke="black" points="89157.58,-507.15 89147.53,-510.53 89157.49,-514.15 89157.58,-507.15"/>
<text text-anchor="middle" x="92184" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_3 -->
<g id="edge424" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92805.01,-625.97C92801.66,-625.63 92798.32,-625.3 92795,-625 92692.26,-615.56 91039.14,-627.4 90938,-607 90927.64,-604.91 90926.36,-600.04 90916,-598 90869.65,-588.86 84160.24,-590.49 84113,-590 82609.48,-574.46 80804.12,-530.9 80154.2,-514.42"/>
<polygon fill="black" stroke="black" points="80153.86,-510.91 80143.77,-514.16 80153.68,-517.91 80153.86,-510.91"/>
<text text-anchor="middle" x="90964" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_4 -->
<g id="edge425" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93305.27,-672.06C93843.2,-662.51 95271.31,-638.02 96463,-625 97055.2,-618.53 98536.35,-633.41 99128,-607 99472.91,-591.61 99872.35,-554.76 100111.79,-530.62"/>
<polygon fill="black" stroke="black" points="100112.41,-534.08 100122.01,-529.59 100111.71,-527.11 100112.41,-534.08"/>
<text text-anchor="middle" x="99317" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_5 -->
<g id="edge426" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93238.74,-624.91C93276.65,-614.17 93317.47,-604.22 93356,-598 93750.31,-534.34 94926.51,-515.28 95433.34,-509.94"/>
<polygon fill="black" stroke="black" points="95433.74,-513.44 95443.7,-509.83 95433.67,-506.44 95433.74,-513.44"/>
<text text-anchor="middle" x="93382" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_6 -->
<g id="edge427" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92805.2,-626.37C92765,-618.83 92730.14,-611.93 92709,-607 92653.02,-593.95 92592.6,-577.58 92538.06,-561.93"/>
<polygon fill="black" stroke="black" points="92538.88,-558.52 92528.31,-559.12 92536.95,-565.25 92538.88,-558.52"/>
<text text-anchor="middle" x="92735" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_7 -->
<g id="edge428" class="edge">
<title>layer_2_gate_tp_2&#45;&gt;layer_2_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92805.01,-626C92801.66,-625.65 92798.32,-625.32 92795,-625 92301.16,-578.04 92173.56,-645.61 91679,-607 91650.36,-604.76 91643.65,-600.04 91615,-598 91448.87,-586.15 88783.55,-591.85 88617,-590 87113.26,-573.34 85307.58,-530.45 84657.91,-514.29"/>
<polygon fill="black" stroke="black" points="84657.57,-510.78 84647.48,-514.03 84657.39,-517.78 84657.57,-510.78"/>
<text text-anchor="middle" x="91705" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3 -->
<g id="node225" class="node">
<title>layer_2_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="92203.99,-729 91755.4,-729 91640.01,-625 92088.6,-625 92203.99,-729"/>
<text text-anchor="middle" x="91922" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="91922" y="-680" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="91922" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="91922" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_0 -->
<g id="edge429" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91641.02,-625.94C91637.66,-625.61 91634.32,-625.3 91631,-625 91541.35,-617.02 85241,-598.25 85151,-598 83919.45,-594.55 80840.49,-603.09 79609,-590 78133.62,-574.31 76362.68,-531.01 75720.14,-514.51"/>
<polygon fill="black" stroke="black" points="75719.91,-511 75709.83,-514.24 75719.73,-518 75719.91,-511"/>
<text text-anchor="middle" x="87844" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_1 -->
<g id="edge430" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92104.54,-639.1C92140.36,-633.25 92177.75,-628.11 92213,-625 92410.4,-607.58 99148.84,-608.57 99347,-607 99914.14,-602.51 100055.92,-599.72 100623,-590 102019.96,-566.06 103697.25,-527.68 104303.32,-513.5"/>
<polygon fill="black" stroke="black" points="104303.57,-516.99 104313.48,-513.26 104303.4,-509.99 104303.57,-516.99"/>
<text text-anchor="middle" x="100162" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_2 -->
<g id="edge431" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91878.98,-624.67C91867.2,-613.94 91853.62,-604.05 91839,-598 91716.18,-547.15 89838.63,-519.28 89158.02,-510.81"/>
<polygon fill="black" stroke="black" points="89157.89,-507.31 89147.84,-510.69 89157.8,-514.31 89157.89,-507.31"/>
<text text-anchor="middle" x="91881" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_3 -->
<g id="edge432" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91641.01,-625.96C91637.66,-625.63 91634.32,-625.3 91631,-625 91468.62,-610.13 88859.06,-598.89 88696,-598 87677.57,-592.43 85131.39,-600.81 84113,-590 82609.26,-574.03 80803.57,-530.72 80153.91,-514.37"/>
<polygon fill="black" stroke="black" points="80153.57,-510.86 80143.48,-514.11 80153.39,-517.86 80153.57,-510.86"/>
<text text-anchor="middle" x="90272" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_4 -->
<g id="edge433" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92104.56,-639.29C92140.37,-633.42 92177.76,-628.23 92213,-625 92316.85,-615.48 95862.73,-591.47 95967,-590 97543.57,-567.82 99440.64,-527.44 100092.7,-513.17"/>
<polygon fill="black" stroke="black" points="100093.24,-516.66 100103.16,-512.94 100093.08,-509.66 100093.24,-516.66"/>
<text text-anchor="middle" x="94863" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_5 -->
<g id="edge434" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92105,-639.77C92140.69,-633.89 92177.92,-628.56 92213,-625 92489.92,-596.9 92560.86,-617.59 92839,-607 92923.48,-603.78 92944.53,-601.44 93029,-598 93919.73,-561.73 94979.87,-528.67 95439.04,-514.84"/>
<polygon fill="black" stroke="black" points="95439.22,-518.34 95449.11,-514.54 95439,-511.34 95439.22,-518.34"/>
<text text-anchor="middle" x="93055" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_6 -->
<g id="edge435" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92109.42,-643.67C92195.11,-628.36 92279.6,-612.28 92288,-607 92303.79,-597.08 92317.3,-582.41 92328.25,-567.38"/>
<polygon fill="black" stroke="black" points="92331.23,-569.23 92334.07,-559.02 92325.49,-565.23 92331.23,-569.23"/>
<text text-anchor="middle" x="92324" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_7 -->
<g id="edge436" class="edge">
<title>layer_2_gate_tp_3&#45;&gt;layer_2_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91640.99,-626.16C91637.65,-625.76 91634.31,-625.37 91631,-625 91399.28,-598.82 91340.11,-604.38 91107,-598 90553.87,-582.87 89170.3,-596.28 88617,-590 87113.27,-572.93 85307.58,-530.29 84657.91,-514.24"/>
<polygon fill="black" stroke="black" points="84657.57,-510.73 84647.48,-513.98 84657.39,-517.73 84657.57,-510.73"/>
<text text-anchor="middle" x="91448" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_2_expert_0_ep_0 -->
<g id="node234" class="node">
<title>layer_2_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="72647.83,-410 72213.82,-410 72102.17,-306 72536.18,-306 72647.83,-410"/>
<text text-anchor="middle" x="72375" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="72375" y="-361" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="72375" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="72375" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_0_ep_0 -->
<g id="edge437" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M75232.63,-498.3C74846.26,-485.81 74061.16,-460.19 73396,-437 73070.46,-425.65 72984.94,-445.07 72657.34,-410.1"/>
<polygon fill="black" stroke="black" points="72657.4,-406.59 72647.08,-409 72656.65,-413.55 72657.4,-406.59"/>
</g>
<!-- layer_2_expert_1_ep_0 -->
<g id="node235" class="node">
<title>layer_2_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="73210.83,-410 72776.82,-410 72665.17,-306 73099.18,-306 73210.83,-410"/>
<text text-anchor="middle" x="72938" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="72938" y="-361" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="72938" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="72938" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_1_ep_0 -->
<g id="edge438" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M75241.73,-506.57C74834.95,-505.28 73962.79,-492.18 73219.82,-410.05"/>
<polygon fill="black" stroke="black" points="73220.04,-406.55 73209.71,-408.93 73219.26,-413.51 73220.04,-406.55"/>
</g>
<!-- layer_2_expert_2_ep_0 -->
<g id="node236" class="node">
<title>layer_2_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="73773.83,-410 73339.82,-410 73228.17,-306 73662.18,-306 73773.83,-410"/>
<text text-anchor="middle" x="73501" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="73501" y="-361" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="73501" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="73501" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_2_ep_0 -->
<g id="edge439" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M75236.43,-501.74C74911.2,-493.8 74306.45,-471.62 73782.75,-410.05"/>
<polygon fill="black" stroke="black" points="73783.06,-406.56 73772.72,-408.87 73782.24,-413.52 73783.06,-406.56"/>
</g>
<!-- layer_2_expert_3_ep_0 -->
<g id="node237" class="node">
<title>layer_2_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="74336.83,-410 73902.82,-410 73791.17,-306 74225.18,-306 74336.83,-410"/>
<text text-anchor="middle" x="74064" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="74064" y="-361" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="74064" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="74064" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_3_ep_0 -->
<g id="edge440" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M75225.04,-491.71C74998.68,-477.02 74654.21,-450.71 74345.77,-410.07"/>
<polygon fill="black" stroke="black" points="74346.11,-406.59 74335.73,-408.74 74345.19,-413.53 74346.11,-406.59"/>
</g>
<!-- layer_2_expert_4_ep_0 -->
<g id="node238" class="node">
<title>layer_2_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="74899.83,-410 74465.82,-410 74354.17,-306 74788.18,-306 74899.83,-410"/>
<text text-anchor="middle" x="74627" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="74627" y="-361" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="74627" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="74627" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_4_ep_0 -->
<g id="edge441" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M75186.78,-458.08C75097.48,-442.9 74998.61,-425.93 74908,-410 74907.9,-409.98 74907.79,-409.96 74907.69,-409.95"/>
<polygon fill="black" stroke="black" points="74908.51,-406.54 74898.05,-408.25 74907.29,-413.43 74908.51,-406.54"/>
</g>
<!-- layer_2_expert_5_ep_0 -->
<g id="node239" class="node">
<title>layer_2_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="75462.83,-410 75028.82,-410 74917.17,-306 75351.18,-306 75462.83,-410"/>
<text text-anchor="middle" x="75190" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="75190" y="-361" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="75190" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="75190" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_5_ep_0 -->
<g id="edge442" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M75374.16,-455C75349.26,-442.02 75322.37,-428 75297.03,-414.79"/>
<polygon fill="black" stroke="black" points="75298.63,-411.68 75288.14,-410.16 75295.39,-417.89 75298.63,-411.68"/>
</g>
<!-- layer_2_expert_6_ep_0 -->
<g id="node240" class="node">
<title>layer_2_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="76025.83,-410 75591.82,-410 75480.17,-306 75914.18,-306 76025.83,-410"/>
<text text-anchor="middle" x="75753" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="75753" y="-361" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="75753" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="75753" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_6_ep_0 -->
<g id="edge443" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M75569.49,-455C75594.2,-442.07 75620.87,-428.12 75646.02,-414.97"/>
<polygon fill="black" stroke="black" points="75647.97,-417.9 75655.21,-410.16 75644.72,-411.69 75647.97,-417.9"/>
</g>
<!-- layer_2_expert_7_ep_0 -->
<g id="node241" class="node">
<title>layer_2_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="76588.83,-410 76154.82,-410 76043.17,-306 76477.18,-306 76588.83,-410"/>
<text text-anchor="middle" x="76316" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="76316" y="-361" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="76316" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="76316" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_0&#45;&gt;layer_2_expert_7_ep_0 -->
<g id="edge444" class="edge">
<title>layer_2_route_ep_0&#45;&gt;layer_2_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M75663.94,-473.79C75772.83,-455.39 75911.59,-431.72 76035,-410 76064.17,-404.87 76095.04,-399.35 76125.21,-393.91"/>
<polygon fill="black" stroke="black" points="76126.19,-397.29 76135.41,-392.07 76124.95,-390.4 76126.19,-397.29"/>
</g>
<!-- layer_2_expert_0_ep_1 -->
<g id="node242" class="node">
<title>layer_2_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="104175.83,-410 103741.82,-410 103630.17,-306 104064.18,-306 104175.83,-410"/>
<text text-anchor="middle" x="103903" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="103903" y="-361" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="103903" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="103903" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_0_ep_1 -->
<g id="edge445" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M104316.38,-455C104257.02,-441.21 104192.63,-426.26 104132.72,-412.35"/>
<polygon fill="black" stroke="black" points="104133.3,-408.89 104122.76,-410.04 104131.71,-415.71 104133.3,-408.89"/>
</g>
<!-- layer_2_expert_1_ep_1 -->
<g id="node243" class="node">
<title>layer_2_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="104738.83,-410 104304.82,-410 104193.17,-306 104627.18,-306 104738.83,-410"/>
<text text-anchor="middle" x="104466" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="104466" y="-361" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="104466" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="104466" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_1_ep_1 -->
<g id="edge446" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M104511.71,-455C104506.29,-443.61 104500.49,-431.43 104494.9,-419.7"/>
<polygon fill="black" stroke="black" points="104497.94,-417.93 104490.48,-410.41 104491.62,-420.94 104497.94,-417.93"/>
</g>
<!-- layer_2_expert_2_ep_1 -->
<g id="node244" class="node">
<title>layer_2_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="105301.83,-410 104867.82,-410 104756.17,-306 105190.18,-306 105301.83,-410"/>
<text text-anchor="middle" x="105029" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="105029" y="-361" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="105029" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="105029" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_2_ep_1 -->
<g id="edge447" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M104706.7,-455.1C104754.82,-440.75 104807.21,-425.13 104855.5,-410.73"/>
<polygon fill="black" stroke="black" points="104856.51,-414.08 104865.1,-407.87 104854.51,-407.38 104856.51,-414.08"/>
</g>
<!-- layer_2_expert_3_ep_1 -->
<g id="node245" class="node">
<title>layer_2_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="105864.83,-410 105430.82,-410 105319.17,-306 105753.18,-306 105864.83,-410"/>
<text text-anchor="middle" x="105592" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="105592" y="-361" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="105592" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="105592" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_3_ep_1 -->
<g id="edge448" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M104723.4,-469.57C104770.48,-461.29 104820.98,-453.13 104868,-447 105063.92,-421.47 105115.13,-435.89 105311,-410 105341.05,-406.03 105372.77,-401.04 105403.65,-395.76"/>
<polygon fill="black" stroke="black" points="105404.39,-399.18 105413.65,-394.03 105403.2,-392.29 105404.39,-399.18"/>
</g>
<!-- layer_2_expert_4_ep_1 -->
<g id="node246" class="node">
<title>layer_2_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="106427.83,-410 105993.82,-410 105882.17,-306 106316.18,-306 106427.83,-410"/>
<text text-anchor="middle" x="106155" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="106155" y="-361" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="106155" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="106155" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_4_ep_1 -->
<g id="edge449" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M104721.91,-468.27C104769.36,-459.93 104820.41,-452.08 104868,-447 104979.22,-435.13 105762.8,-422.07 105874,-410 105904.36,-406.7 105936.37,-402.04 105967.49,-396.86"/>
<polygon fill="black" stroke="black" points="105968.27,-400.28 105977.55,-395.16 105967.11,-393.38 105968.27,-400.28"/>
</g>
<!-- layer_2_expert_5_ep_1 -->
<g id="node247" class="node">
<title>layer_2_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="106990.83,-410 106556.82,-410 106445.17,-306 106879.18,-306 106990.83,-410"/>
<text text-anchor="middle" x="106718" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="106718" y="-361" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="106718" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="106718" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_5_ep_1 -->
<g id="edge450" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M104721.43,-467.91C104769,-459.55 104820.23,-451.78 104868,-447 104911.38,-442.66 106393.63,-414.42 106437,-410 106467.49,-406.89 106499.64,-402.31 106530.86,-397.15"/>
<polygon fill="black" stroke="black" points="106531.68,-400.56 106540.97,-395.46 106530.53,-393.66 106531.68,-400.56"/>
</g>
<!-- layer_2_expert_6_ep_1 -->
<g id="node248" class="node">
<title>layer_2_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="107553.83,-410 107119.82,-410 107008.17,-306 107442.18,-306 107553.83,-410"/>
<text text-anchor="middle" x="107281" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="107281" y="-361" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="107281" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="107281" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_6_ep_1 -->
<g id="edge451" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M104720.97,-467.74C104768.67,-459.36 104820.07,-451.62 104868,-447 105003.39,-433.95 105344,-439.32 105480,-437 106155.56,-425.48 106327.62,-476.55 107000,-410 107030.5,-406.98 107062.65,-402.45 107093.88,-397.31"/>
<polygon fill="black" stroke="black" points="107094.7,-400.72 107103.98,-395.62 107093.54,-393.81 107094.7,-400.72"/>
</g>
<!-- layer_2_expert_7_ep_1 -->
<g id="node249" class="node">
<title>layer_2_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="108116.83,-410 107682.82,-410 107571.17,-306 108005.18,-306 108116.83,-410"/>
<text text-anchor="middle" x="107844" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="107844" y="-361" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="107844" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="107844" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_1&#45;&gt;layer_2_expert_7_ep_1 -->
<g id="edge452" class="edge">
<title>layer_2_route_ep_1&#45;&gt;layer_2_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M104720.95,-467.46C104768.64,-459.09 104820.05,-451.42 104868,-447 105007.97,-434.1 105992.45,-438.88 106133,-437 106768.61,-428.49 106930.46,-472.96 107563,-410 107593.5,-406.96 107625.65,-402.42 107656.88,-397.28"/>
<polygon fill="black" stroke="black" points="107657.69,-400.69 107666.98,-395.59 107656.54,-393.78 107657.69,-400.69"/>
</g>
<!-- layer_2_expert_0_ep_2 -->
<g id="node250" class="node">
<title>layer_2_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="86159.83,-410 85725.82,-410 85614.17,-306 86048.18,-306 86159.83,-410"/>
<text text-anchor="middle" x="85887" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="85887" y="-361" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="85887" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="85887" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_0_ep_2 -->
<g id="edge453" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M88674.09,-497.96C88297.05,-485.27 87542.76,-459.73 86903,-437 86579.67,-425.51 86494.71,-444.87 86169.28,-410.1"/>
<polygon fill="black" stroke="black" points="86169.4,-406.59 86159.08,-409 86168.65,-413.55 86169.4,-406.59"/>
</g>
<!-- layer_2_expert_1_ep_2 -->
<g id="node251" class="node">
<title>layer_2_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="86722.83,-410 86288.82,-410 86177.17,-306 86611.18,-306 86722.83,-410"/>
<text text-anchor="middle" x="86450" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="86450" y="-361" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="86450" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="86450" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_1_ep_2 -->
<g id="edge454" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M88683.37,-506.11C88286.12,-504.02 87447.34,-489.64 86731.71,-410.04"/>
<polygon fill="black" stroke="black" points="86732.04,-406.56 86721.71,-408.92 86731.26,-413.51 86732.04,-406.56"/>
</g>
<!-- layer_2_expert_2_ep_2 -->
<g id="node252" class="node">
<title>layer_2_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="87285.83,-410 86851.82,-410 86740.17,-306 87174.18,-306 87285.83,-410"/>
<text text-anchor="middle" x="87013" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="87013" y="-361" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="87013" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="87013" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_2_ep_2 -->
<g id="edge455" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M88677.45,-500.89C88363.39,-492.09 87791.6,-469.05 87294.96,-410.08"/>
<polygon fill="black" stroke="black" points="87295.06,-406.57 87284.72,-408.86 87294.24,-413.52 87295.06,-406.57"/>
</g>
<!-- layer_2_expert_3_ep_2 -->
<g id="node253" class="node">
<title>layer_2_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="87848.83,-410 87414.82,-410 87303.17,-306 87737.18,-306 87848.83,-410"/>
<text text-anchor="middle" x="87576" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="87576" y="-361" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="87576" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="87576" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_3_ep_2 -->
<g id="edge456" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M88664.76,-489.65C88452.63,-474.25 88139.79,-448.04 87857.76,-410.07"/>
<polygon fill="black" stroke="black" points="87858.12,-406.59 87847.74,-408.72 87857.18,-413.53 87858.12,-406.59"/>
</g>
<!-- layer_2_expert_4_ep_2 -->
<g id="node254" class="node">
<title>layer_2_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="88411.83,-410 87977.82,-410 87866.17,-306 88300.18,-306 88411.83,-410"/>
<text text-anchor="middle" x="88139" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="88139" y="-361" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="88139" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="88139" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_4_ep_2 -->
<g id="edge457" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M88645.12,-455C88571.69,-441.07 88491.97,-425.95 88417.99,-411.92"/>
<polygon fill="black" stroke="black" points="88418.54,-408.46 88408.06,-410.04 88417.24,-415.34 88418.54,-408.46"/>
</g>
<!-- layer_2_expert_5_ep_2 -->
<g id="node255" class="node">
<title>layer_2_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="88974.83,-410 88540.82,-410 88429.17,-306 88863.18,-306 88974.83,-410"/>
<text text-anchor="middle" x="88702" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="88702" y="-361" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="88702" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="88702" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_5_ep_2 -->
<g id="edge458" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M88840.45,-455C88822.3,-442.41 88802.75,-428.86 88784.21,-416.01"/>
<polygon fill="black" stroke="black" points="88785.99,-412.98 88775.78,-410.16 88782,-418.73 88785.99,-412.98"/>
</g>
<!-- layer_2_expert_6_ep_2 -->
<g id="node256" class="node">
<title>layer_2_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="89537.83,-410 89103.82,-410 88992.17,-306 89426.18,-306 89537.83,-410"/>
<text text-anchor="middle" x="89265" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="89265" y="-361" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="89265" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="89265" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_6_ep_2 -->
<g id="edge459" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M89035.78,-455C89067.41,-441.75 89101.61,-427.43 89133.7,-413.99"/>
<polygon fill="black" stroke="black" points="89135.27,-417.13 89143.14,-410.04 89132.56,-410.67 89135.27,-417.13"/>
</g>
<!-- layer_2_expert_7_ep_2 -->
<g id="node257" class="node">
<title>layer_2_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="90100.83,-410 89666.82,-410 89555.17,-306 89989.18,-306 90100.83,-410"/>
<text text-anchor="middle" x="89828" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="89828" y="-361" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="89828" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="89828" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_2&#45;&gt;layer_2_expert_7_ep_2 -->
<g id="edge460" class="edge">
<title>layer_2_route_ep_2&#45;&gt;layer_2_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M89110.27,-477.73C89235.4,-459.34 89400.9,-434.33 89547,-410 89576.46,-405.09 89607.61,-399.67 89638.03,-394.25"/>
<polygon fill="black" stroke="black" points="89638.65,-397.7 89647.87,-392.49 89637.41,-390.81 89638.65,-397.7"/>
</g>
<!-- layer_2_expert_0_ep_3 -->
<g id="node258" class="node">
<title>layer_2_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="77151.83,-410 76717.82,-410 76606.17,-306 77040.18,-306 77151.83,-410"/>
<text text-anchor="middle" x="76879" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="76879" y="-361" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="76879" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="76879" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_0_ep_3 -->
<g id="edge461" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M79666.09,-497.96C79289.05,-485.27 78534.76,-459.73 77895,-437 77571.67,-425.51 77486.71,-444.87 77161.28,-410.1"/>
<polygon fill="black" stroke="black" points="77161.4,-406.59 77151.08,-409 77160.65,-413.55 77161.4,-406.59"/>
</g>
<!-- layer_2_expert_1_ep_3 -->
<g id="node259" class="node">
<title>layer_2_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="77714.83,-410 77280.82,-410 77169.17,-306 77603.18,-306 77714.83,-410"/>
<text text-anchor="middle" x="77442" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="77442" y="-361" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="77442" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="77442" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_1_ep_3 -->
<g id="edge462" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M79675.37,-506.11C79278.12,-504.02 78439.34,-489.64 77723.71,-410.04"/>
<polygon fill="black" stroke="black" points="77724.04,-406.56 77713.71,-408.92 77723.26,-413.51 77724.04,-406.56"/>
</g>
<!-- layer_2_expert_2_ep_3 -->
<g id="node260" class="node">
<title>layer_2_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="78277.83,-410 77843.82,-410 77732.17,-306 78166.18,-306 78277.83,-410"/>
<text text-anchor="middle" x="78005" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="78005" y="-361" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="78005" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="78005" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_2_ep_3 -->
<g id="edge463" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M79669.45,-500.89C79355.39,-492.09 78783.6,-469.05 78286.96,-410.08"/>
<polygon fill="black" stroke="black" points="78287.06,-406.57 78276.72,-408.86 78286.24,-413.52 78287.06,-406.57"/>
</g>
<!-- layer_2_expert_3_ep_3 -->
<g id="node261" class="node">
<title>layer_2_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="78840.83,-410 78406.82,-410 78295.17,-306 78729.18,-306 78840.83,-410"/>
<text text-anchor="middle" x="78568" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="78568" y="-361" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="78568" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="78568" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_3_ep_3 -->
<g id="edge464" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M79656.76,-489.65C79444.63,-474.25 79131.79,-448.04 78849.76,-410.07"/>
<polygon fill="black" stroke="black" points="78850.12,-406.59 78839.74,-408.72 78849.18,-413.53 78850.12,-406.59"/>
</g>
<!-- layer_2_expert_4_ep_3 -->
<g id="node262" class="node">
<title>layer_2_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="79403.83,-410 78969.82,-410 78858.17,-306 79292.18,-306 79403.83,-410"/>
<text text-anchor="middle" x="79131" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="79131" y="-361" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="79131" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="79131" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_4_ep_3 -->
<g id="edge465" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M79637.12,-455C79563.69,-441.07 79483.97,-425.95 79409.99,-411.92"/>
<polygon fill="black" stroke="black" points="79410.54,-408.46 79400.06,-410.04 79409.24,-415.34 79410.54,-408.46"/>
</g>
<!-- layer_2_expert_5_ep_3 -->
<g id="node263" class="node">
<title>layer_2_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="79966.83,-410 79532.82,-410 79421.17,-306 79855.18,-306 79966.83,-410"/>
<text text-anchor="middle" x="79694" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="79694" y="-361" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="79694" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="79694" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_5_ep_3 -->
<g id="edge466" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M79832.45,-455C79814.3,-442.41 79794.75,-428.86 79776.21,-416.01"/>
<polygon fill="black" stroke="black" points="79777.99,-412.98 79767.78,-410.16 79774,-418.73 79777.99,-412.98"/>
</g>
<!-- layer_2_expert_6_ep_3 -->
<g id="node264" class="node">
<title>layer_2_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="80529.83,-410 80095.82,-410 79984.17,-306 80418.18,-306 80529.83,-410"/>
<text text-anchor="middle" x="80257" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="80257" y="-361" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="80257" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="80257" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_6_ep_3 -->
<g id="edge467" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M80027.78,-455C80059.41,-441.75 80093.61,-427.43 80125.7,-413.99"/>
<polygon fill="black" stroke="black" points="80127.27,-417.13 80135.14,-410.04 80124.56,-410.67 80127.27,-417.13"/>
</g>
<!-- layer_2_expert_7_ep_3 -->
<g id="node265" class="node">
<title>layer_2_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="81092.83,-410 80658.82,-410 80547.17,-306 80981.18,-306 81092.83,-410"/>
<text text-anchor="middle" x="80820" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="80820" y="-361" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="80820" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="80820" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_3&#45;&gt;layer_2_expert_7_ep_3 -->
<g id="edge468" class="edge">
<title>layer_2_route_ep_3&#45;&gt;layer_2_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M80102.27,-477.73C80227.4,-459.34 80392.9,-434.33 80539,-410 80568.46,-405.09 80599.61,-399.67 80630.03,-394.25"/>
<polygon fill="black" stroke="black" points="80630.65,-397.7 80639.87,-392.49 80629.41,-390.81 80630.65,-397.7"/>
</g>
<!-- layer_2_expert_0_ep_4 -->
<g id="node266" class="node">
<title>layer_2_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="99671.83,-410 99237.82,-410 99126.17,-306 99560.18,-306 99671.83,-410"/>
<text text-anchor="middle" x="99399" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="99399" y="-361" font-family="Arial" font-size="10.00">GPU: 64</text>
<text text-anchor="middle" x="99399" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="99399" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_0_ep_4 -->
<g id="edge469" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M100051.04,-467.12C99939.14,-450.8 99808.35,-431.08 99680.4,-410.05"/>
<polygon fill="black" stroke="black" points="99680.84,-406.58 99670.4,-408.41 99679.7,-413.49 99680.84,-406.58"/>
</g>
<!-- layer_2_expert_1_ep_4 -->
<g id="node267" class="node">
<title>layer_2_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="100234.83,-410 99800.82,-410 99689.17,-306 100123.18,-306 100234.83,-410"/>
<text text-anchor="middle" x="99962" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="99962" y="-361" font-family="Arial" font-size="10.00">GPU: 65</text>
<text text-anchor="middle" x="99962" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="99962" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_1_ep_4 -->
<g id="edge470" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M100199.71,-455C100166.77,-441.7 100131.14,-427.31 100097.73,-413.81"/>
<polygon fill="black" stroke="black" points="100098.96,-410.53 100088.37,-410.04 100096.33,-417.03 100098.96,-410.53"/>
</g>
<!-- layer_2_expert_2_ep_4 -->
<g id="node268" class="node">
<title>layer_2_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="100797.83,-410 100363.82,-410 100252.17,-306 100686.18,-306 100797.83,-410"/>
<text text-anchor="middle" x="100525" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="100525" y="-361" font-family="Arial" font-size="10.00">GPU: 66</text>
<text text-anchor="middle" x="100525" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="100525" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_2_ep_4 -->
<g id="edge471" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M100395.04,-455C100411.92,-442.53 100430.1,-429.1 100447.36,-416.35"/>
<polygon fill="black" stroke="black" points="100449.78,-418.92 100455.74,-410.16 100445.62,-413.29 100449.78,-418.92"/>
</g>
<!-- layer_2_expert_3_ep_4 -->
<g id="node269" class="node">
<title>layer_2_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="101360.83,-410 100926.82,-410 100815.17,-306 101249.18,-306 101360.83,-410"/>
<text text-anchor="middle" x="101088" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="101088" y="-361" font-family="Arial" font-size="10.00">GPU: 67</text>
<text text-anchor="middle" x="101088" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="101088" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_3_ep_4 -->
<g id="edge472" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M100513.38,-469.85C100630.72,-447.22 100781.42,-418.14 100899.05,-395.45"/>
<polygon fill="black" stroke="black" points="100899.73,-398.88 100908.89,-393.55 100898.41,-392.01 100899.73,-398.88"/>
</g>
<!-- layer_2_expert_4_ep_4 -->
<g id="node270" class="node">
<title>layer_2_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="101923.83,-410 101489.82,-410 101378.17,-306 101812.18,-306 101923.83,-410"/>
<text text-anchor="middle" x="101651" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="101651" y="-361" font-family="Arial" font-size="10.00">GPU: 68</text>
<text text-anchor="middle" x="101651" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="101651" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_4_ep_4 -->
<g id="edge473" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M100538.57,-491.95C100749.97,-476.68 101083.25,-449.13 101370,-410 101399.92,-405.92 101431.51,-400.89 101462.28,-395.6"/>
<polygon fill="black" stroke="black" points="101462.99,-399.03 101472.24,-393.87 101461.79,-392.13 101462.99,-399.03"/>
</g>
<!-- layer_2_expert_5_ep_4 -->
<g id="node271" class="node">
<title>layer_2_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="102486.83,-410 102052.82,-410 101941.17,-306 102375.18,-306 102486.83,-410"/>
<text text-anchor="middle" x="102214" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="102214" y="-361" font-family="Arial" font-size="10.00">GPU: 69</text>
<text text-anchor="middle" x="102214" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="102214" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_5_ep_4 -->
<g id="edge474" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M100549.01,-501.12C100860.01,-492.39 101441.14,-469.11 101933,-410 101963.21,-406.37 101995.07,-401.55 102026.07,-396.32"/>
<polygon fill="black" stroke="black" points="102026.84,-399.74 102036.11,-394.61 102025.66,-392.84 102026.84,-399.74"/>
</g>
<!-- layer_2_expert_6_ep_4 -->
<g id="node272" class="node">
<title>layer_2_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="103049.83,-410 102615.82,-410 102504.17,-306 102938.18,-306 103049.83,-410"/>
<text text-anchor="middle" x="102777" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="102777" y="-361" font-family="Arial" font-size="10.00">GPU: 70</text>
<text text-anchor="middle" x="102777" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="102777" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_6_ep_4 -->
<g id="edge475" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M100554.46,-506.03C100950.87,-503.83 101791.24,-489.18 102496,-410 102526.34,-406.59 102558.35,-401.87 102589.46,-396.67"/>
<polygon fill="black" stroke="black" points="102590.26,-400.08 102599.53,-394.96 102589.09,-393.18 102590.26,-400.08"/>
</g>
<!-- layer_2_expert_7_ep_4 -->
<g id="node273" class="node">
<title>layer_2_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="103612.83,-410 103178.82,-410 103067.17,-306 103501.18,-306 103612.83,-410"/>
<text text-anchor="middle" x="103340" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="103340" y="-361" font-family="Arial" font-size="10.00">GPU: 71</text>
<text text-anchor="middle" x="103340" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="103340" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_4&#45;&gt;layer_2_expert_7_ep_4 -->
<g id="edge476" class="edge">
<title>layer_2_route_ep_4&#45;&gt;layer_2_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M100550.32,-502.31C101113.24,-492.36 102575.09,-462.2 103059,-410 103089.36,-406.73 103121.37,-402.07 103152.49,-396.9"/>
<polygon fill="black" stroke="black" points="103153.28,-400.32 103162.56,-395.2 103152.11,-393.41 103153.28,-400.32"/>
</g>
<!-- layer_2_expert_0_ep_5 -->
<g id="node274" class="node">
<title>layer_2_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="95167.83,-410 94733.82,-410 94622.17,-306 95056.18,-306 95167.83,-410"/>
<text text-anchor="middle" x="94895" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="94895" y="-361" font-family="Arial" font-size="10.00">GPU: 80</text>
<text text-anchor="middle" x="94895" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="94895" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_0_ep_5 -->
<g id="edge477" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M95401.12,-455C95327.69,-441.07 95247.97,-425.95 95173.99,-411.92"/>
<polygon fill="black" stroke="black" points="95174.54,-408.46 95164.06,-410.04 95173.24,-415.34 95174.54,-408.46"/>
</g>
<!-- layer_2_expert_1_ep_5 -->
<g id="node275" class="node">
<title>layer_2_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="95730.83,-410 95296.82,-410 95185.17,-306 95619.18,-306 95730.83,-410"/>
<text text-anchor="middle" x="95458" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="95458" y="-361" font-family="Arial" font-size="10.00">GPU: 81</text>
<text text-anchor="middle" x="95458" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="95458" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_1_ep_5 -->
<g id="edge478" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M95596.45,-455C95578.3,-442.41 95558.75,-428.86 95540.21,-416.01"/>
<polygon fill="black" stroke="black" points="95541.99,-412.98 95531.78,-410.16 95538,-418.73 95541.99,-412.98"/>
</g>
<!-- layer_2_expert_2_ep_5 -->
<g id="node276" class="node">
<title>layer_2_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="96293.83,-410 95859.82,-410 95748.17,-306 96182.18,-306 96293.83,-410"/>
<text text-anchor="middle" x="96021" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="96021" y="-361" font-family="Arial" font-size="10.00">GPU: 82</text>
<text text-anchor="middle" x="96021" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="96021" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_2_ep_5 -->
<g id="edge479" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M95791.78,-455C95823.41,-441.75 95857.61,-427.43 95889.7,-413.99"/>
<polygon fill="black" stroke="black" points="95891.27,-417.13 95899.14,-410.04 95888.56,-410.67 95891.27,-417.13"/>
</g>
<!-- layer_2_expert_3_ep_5 -->
<g id="node277" class="node">
<title>layer_2_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="96856.83,-410 96422.82,-410 96311.17,-306 96745.18,-306 96856.83,-410"/>
<text text-anchor="middle" x="96584" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="96584" y="-361" font-family="Arial" font-size="10.00">GPU: 83</text>
<text text-anchor="middle" x="96584" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="96584" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_3_ep_5 -->
<g id="edge480" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M95866.27,-477.73C95991.4,-459.34 96156.9,-434.33 96303,-410 96332.46,-405.09 96363.61,-399.67 96394.03,-394.25"/>
<polygon fill="black" stroke="black" points="96394.65,-397.7 96403.87,-392.49 96393.41,-390.81 96394.65,-397.7"/>
</g>
<!-- layer_2_expert_4_ep_5 -->
<g id="node278" class="node">
<title>layer_2_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="97419.83,-410 96985.82,-410 96874.17,-306 97308.18,-306 97419.83,-410"/>
<text text-anchor="middle" x="97147" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="97147" y="-361" font-family="Arial" font-size="10.00">GPU: 84</text>
<text text-anchor="middle" x="97147" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="97147" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_4_ep_5 -->
<g id="edge481" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M95886.19,-495.13C96126.26,-481.55 96524.93,-454.53 96866,-410 96896.06,-406.08 96927.78,-401.12 96958.67,-395.84"/>
<polygon fill="black" stroke="black" points="96959.4,-399.27 96968.66,-394.12 96958.21,-392.37 96959.4,-399.27"/>
</g>
<!-- layer_2_expert_5_ep_5 -->
<g id="node279" class="node">
<title>layer_2_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="97982.83,-410 97548.82,-410 97437.17,-306 97871.18,-306 97982.83,-410"/>
<text text-anchor="middle" x="97710" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="97710" y="-361" font-family="Arial" font-size="10.00">GPU: 85</text>
<text text-anchor="middle" x="97710" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="97710" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_5_ep_5 -->
<g id="edge482" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M95894.64,-502.72C96229.8,-495.79 96880.17,-474.52 97429,-410 97459.21,-406.45 97491.09,-401.67 97522.09,-396.45"/>
<polygon fill="black" stroke="black" points="97522.85,-399.88 97532.12,-394.75 97521.68,-392.97 97522.85,-399.88"/>
</g>
<!-- layer_2_expert_6_ep_5 -->
<g id="node280" class="node">
<title>layer_2_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="98545.83,-410 98111.82,-410 98000.17,-306 98434.18,-306 98545.83,-410"/>
<text text-anchor="middle" x="98273" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="98273" y="-361" font-family="Arial" font-size="10.00">GPU: 86</text>
<text text-anchor="middle" x="98273" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="98273" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_6_ep_5 -->
<g id="edge483" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M95892.47,-500.73C96391.87,-488.26 97589.74,-454.6 97992,-410 98022.35,-406.63 98054.36,-401.94 98085.47,-396.74"/>
<polygon fill="black" stroke="black" points="98086.26,-400.16 98095.54,-395.04 98085.1,-393.26 98086.26,-400.16"/>
</g>
<!-- layer_2_expert_7_ep_5 -->
<g id="node281" class="node">
<title>layer_2_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="99108.83,-410 98674.82,-410 98563.17,-306 98997.18,-306 99108.83,-410"/>
<text text-anchor="middle" x="98836" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="98836" y="-361" font-family="Arial" font-size="10.00">GPU: 87</text>
<text text-anchor="middle" x="98836" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="98836" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_5&#45;&gt;layer_2_expert_7_ep_5 -->
<g id="edge484" class="edge">
<title>layer_2_route_ep_5&#45;&gt;layer_2_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M95894.7,-502.78C96479.8,-493.7 98040.65,-464.94 98555,-410 98585.36,-406.76 98617.38,-402.12 98648.5,-396.95"/>
<polygon fill="black" stroke="black" points="98649.28,-400.37 98658.56,-395.26 98648.12,-393.47 98649.28,-400.37"/>
</g>
<!-- layer_2_expert_0_ep_6 -->
<g id="node282" class="node">
<title>layer_2_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="90663.83,-410 90229.82,-410 90118.17,-306 90552.18,-306 90663.83,-410"/>
<text text-anchor="middle" x="90391" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="90391" y="-361" font-family="Arial" font-size="10.00">GPU: 96</text>
<text text-anchor="middle" x="90391" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="90391" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_0_ep_6 -->
<g id="edge485" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M92125.57,-501.73C91800.53,-493.78 91196.14,-471.59 90672.74,-410.05"/>
<polygon fill="black" stroke="black" points="90673.06,-406.57 90662.72,-408.87 90672.24,-413.52 90673.06,-406.57"/>
</g>
<!-- layer_2_expert_1_ep_6 -->
<g id="node283" class="node">
<title>layer_2_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="91226.83,-410 90792.82,-410 90681.17,-306 91115.18,-306 91226.83,-410"/>
<text text-anchor="middle" x="90954" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="90954" y="-361" font-family="Arial" font-size="10.00">GPU: 97</text>
<text text-anchor="middle" x="90954" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="90954" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_1_ep_6 -->
<g id="edge486" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M92113.98,-491.68C91887.82,-476.98 91543.81,-450.67 91235.76,-410.07"/>
<polygon fill="black" stroke="black" points="91236.11,-406.59 91225.73,-408.74 91235.19,-413.53 91236.11,-406.59"/>
</g>
<!-- layer_2_expert_2_ep_6 -->
<g id="node284" class="node">
<title>layer_2_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="91789.83,-410 91355.82,-410 91244.17,-306 91678.18,-306 91789.83,-410"/>
<text text-anchor="middle" x="91517" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="91517" y="-361" font-family="Arial" font-size="10.00">GPU: 98</text>
<text text-anchor="middle" x="91517" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="91517" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_2_ep_6 -->
<g id="edge487" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M92075.93,-458C91986.89,-442.84 91888.33,-425.9 91798,-410 91797.9,-409.98 91797.79,-409.96 91797.69,-409.95"/>
<polygon fill="black" stroke="black" points="91798.51,-406.54 91788.05,-408.25 91797.29,-413.43 91798.51,-406.54"/>
</g>
<!-- layer_2_expert_3_ep_6 -->
<g id="node285" class="node">
<title>layer_2_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="92352.83,-410 91918.82,-410 91807.17,-306 92241.18,-306 92352.83,-410"/>
<text text-anchor="middle" x="92080" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="92080" y="-361" font-family="Arial" font-size="10.00">GPU: 99</text>
<text text-anchor="middle" x="92080" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="92080" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_3_ep_6 -->
<g id="edge488" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M92263.51,-455C92238.8,-442.07 92212.13,-428.12 92186.98,-414.97"/>
<polygon fill="black" stroke="black" points="92188.28,-411.69 92177.79,-410.16 92185.03,-417.9 92188.28,-411.69"/>
</g>
<!-- layer_2_expert_4_ep_6 -->
<g id="node286" class="node">
<title>layer_2_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="92915.83,-410 92481.82,-410 92370.17,-306 92804.18,-306 92915.83,-410"/>
<text text-anchor="middle" x="92643" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="92643" y="-361" font-family="Arial" font-size="10.00">GPU: 100</text>
<text text-anchor="middle" x="92643" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="92643" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_4_ep_6 -->
<g id="edge489" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M92458.84,-455C92483.74,-442.02 92510.63,-428 92535.97,-414.79"/>
<polygon fill="black" stroke="black" points="92537.61,-417.89 92544.86,-410.16 92534.37,-411.68 92537.61,-417.89"/>
</g>
<!-- layer_2_expert_5_ep_6 -->
<g id="node287" class="node">
<title>layer_2_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="93478.83,-410 93044.82,-410 92933.17,-306 93367.18,-306 93478.83,-410"/>
<text text-anchor="middle" x="93206" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="93206" y="-361" font-family="Arial" font-size="10.00">GPU: 101</text>
<text text-anchor="middle" x="93206" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="93206" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_5_ep_6 -->
<g id="edge490" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M92552.96,-473.86C92662.09,-455.46 92801.25,-431.76 92925,-410 92954.18,-404.87 92985.04,-399.36 93015.21,-393.92"/>
<polygon fill="black" stroke="black" points="93016.19,-397.3 93025.41,-392.08 93014.95,-390.41 93016.19,-397.3"/>
</g>
<!-- layer_2_expert_6_ep_6 -->
<g id="node288" class="node">
<title>layer_2_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="94041.83,-410 93607.82,-410 93496.17,-306 93930.18,-306 94041.83,-410"/>
<text text-anchor="middle" x="93769" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="93769" y="-361" font-family="Arial" font-size="10.00">GPU: 102</text>
<text text-anchor="middle" x="93769" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="93769" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_6_ep_6 -->
<g id="edge491" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M92575.61,-493.78C92802.85,-479.42 93171.69,-452.08 93488,-410 93517.94,-406.02 93549.53,-401.04 93580.31,-395.77"/>
<polygon fill="black" stroke="black" points="93581.01,-399.21 93590.27,-394.05 93579.82,-392.31 93581.01,-399.21"/>
</g>
<!-- layer_2_expert_7_ep_6 -->
<g id="node289" class="node">
<title>layer_2_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="94604.83,-410 94170.82,-410 94059.17,-306 94493.18,-306 94604.83,-410"/>
<text text-anchor="middle" x="94332" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="94332" y="-361" font-family="Arial" font-size="10.00">GPU: 103</text>
<text text-anchor="middle" x="94332" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="94332" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_6&#45;&gt;layer_2_expert_7_ep_6 -->
<g id="edge492" class="edge">
<title>layer_2_route_ep_6&#45;&gt;layer_2_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M92584.91,-502.02C92909.21,-494.28 93528.08,-472.07 94051,-410 94081.21,-406.41 94113.08,-401.62 94144.08,-396.4"/>
<polygon fill="black" stroke="black" points="94144.85,-399.82 94154.12,-394.69 94143.67,-392.92 94144.85,-399.82"/>
</g>
<!-- layer_2_expert_0_ep_7 -->
<g id="node290" class="node">
<title>layer_2_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="81655.83,-410 81221.82,-410 81110.17,-306 81544.18,-306 81655.83,-410"/>
<text text-anchor="middle" x="81383" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="81383" y="-361" font-family="Arial" font-size="10.00">GPU: 112</text>
<text text-anchor="middle" x="81383" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="81383" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_0_ep_7 -->
<g id="edge493" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M84170.09,-497.96C83793.05,-485.27 83038.76,-459.73 82399,-437 82075.67,-425.51 81990.71,-444.87 81665.28,-410.1"/>
<polygon fill="black" stroke="black" points="81665.4,-406.59 81655.08,-409 81664.65,-413.55 81665.4,-406.59"/>
</g>
<!-- layer_2_expert_1_ep_7 -->
<g id="node291" class="node">
<title>layer_2_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="82218.83,-410 81784.82,-410 81673.17,-306 82107.18,-306 82218.83,-410"/>
<text text-anchor="middle" x="81946" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="81946" y="-361" font-family="Arial" font-size="10.00">GPU: 113</text>
<text text-anchor="middle" x="81946" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="81946" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_1_ep_7 -->
<g id="edge494" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M84179.37,-506.11C83782.12,-504.02 82943.34,-489.64 82227.71,-410.04"/>
<polygon fill="black" stroke="black" points="82228.04,-406.56 82217.71,-408.92 82227.26,-413.51 82228.04,-406.56"/>
</g>
<!-- layer_2_expert_2_ep_7 -->
<g id="node292" class="node">
<title>layer_2_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="82781.83,-410 82347.82,-410 82236.17,-306 82670.18,-306 82781.83,-410"/>
<text text-anchor="middle" x="82509" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="82509" y="-361" font-family="Arial" font-size="10.00">GPU: 114</text>
<text text-anchor="middle" x="82509" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="82509" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_2_ep_7 -->
<g id="edge495" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M84173.45,-500.89C83859.39,-492.09 83287.6,-469.05 82790.96,-410.08"/>
<polygon fill="black" stroke="black" points="82791.06,-406.57 82780.72,-408.86 82790.24,-413.52 82791.06,-406.57"/>
</g>
<!-- layer_2_expert_3_ep_7 -->
<g id="node293" class="node">
<title>layer_2_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="83344.83,-410 82910.82,-410 82799.17,-306 83233.18,-306 83344.83,-410"/>
<text text-anchor="middle" x="83072" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="83072" y="-361" font-family="Arial" font-size="10.00">GPU: 115</text>
<text text-anchor="middle" x="83072" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="83072" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_3_ep_7 -->
<g id="edge496" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M84160.76,-489.65C83948.63,-474.25 83635.79,-448.04 83353.76,-410.07"/>
<polygon fill="black" stroke="black" points="83354.12,-406.59 83343.74,-408.72 83353.18,-413.53 83354.12,-406.59"/>
</g>
<!-- layer_2_expert_4_ep_7 -->
<g id="node294" class="node">
<title>layer_2_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="83907.83,-410 83473.82,-410 83362.17,-306 83796.18,-306 83907.83,-410"/>
<text text-anchor="middle" x="83635" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="83635" y="-361" font-family="Arial" font-size="10.00">GPU: 116</text>
<text text-anchor="middle" x="83635" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="83635" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_4_ep_7 -->
<g id="edge497" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M84141.12,-455C84067.69,-441.07 83987.97,-425.95 83913.99,-411.92"/>
<polygon fill="black" stroke="black" points="83914.54,-408.46 83904.06,-410.04 83913.24,-415.34 83914.54,-408.46"/>
</g>
<!-- layer_2_expert_5_ep_7 -->
<g id="node295" class="node">
<title>layer_2_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="84470.83,-410 84036.82,-410 83925.17,-306 84359.18,-306 84470.83,-410"/>
<text text-anchor="middle" x="84198" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="84198" y="-361" font-family="Arial" font-size="10.00">GPU: 117</text>
<text text-anchor="middle" x="84198" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="84198" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_5_ep_7 -->
<g id="edge498" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M84336.45,-455C84318.3,-442.41 84298.75,-428.86 84280.21,-416.01"/>
<polygon fill="black" stroke="black" points="84281.99,-412.98 84271.78,-410.16 84278,-418.73 84281.99,-412.98"/>
</g>
<!-- layer_2_expert_6_ep_7 -->
<g id="node296" class="node">
<title>layer_2_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="85033.83,-410 84599.82,-410 84488.17,-306 84922.18,-306 85033.83,-410"/>
<text text-anchor="middle" x="84761" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="84761" y="-361" font-family="Arial" font-size="10.00">GPU: 118</text>
<text text-anchor="middle" x="84761" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="84761" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_6_ep_7 -->
<g id="edge499" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M84531.78,-455C84563.41,-441.75 84597.61,-427.43 84629.7,-413.99"/>
<polygon fill="black" stroke="black" points="84631.27,-417.13 84639.14,-410.04 84628.56,-410.67 84631.27,-417.13"/>
</g>
<!-- layer_2_expert_7_ep_7 -->
<g id="node297" class="node">
<title>layer_2_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="85596.83,-410 85162.82,-410 85051.17,-306 85485.18,-306 85596.83,-410"/>
<text text-anchor="middle" x="85324" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="85324" y="-361" font-family="Arial" font-size="10.00">GPU: 119</text>
<text text-anchor="middle" x="85324" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="85324" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_2_route_ep_7&#45;&gt;layer_2_expert_7_ep_7 -->
<g id="edge500" class="edge">
<title>layer_2_route_ep_7&#45;&gt;layer_2_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M84606.27,-477.73C84731.4,-459.34 84896.9,-434.33 85043,-410 85072.46,-405.09 85103.61,-399.67 85134.03,-394.25"/>
<polygon fill="black" stroke="black" points="85134.65,-397.7 85143.87,-392.49 85133.41,-390.81 85134.65,-397.7"/>
</g>
<!-- layer_2_agg_ep_0 -->
<g id="node298" class="node">
<title>layer_2_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="74910.07,-269 74459.77,-269 74343.93,-165 74794.23,-165 74910.07,-269"/>
<text text-anchor="middle" x="74627" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="74627" y="-220" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="74627" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="74627" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge501" class="edge">
<title>layer_2_expert_0_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M72547.37,-316.09C72583.1,-308.94 72620.63,-302.4 72656,-298 72986.43,-256.9 73952.09,-232.08 74397.31,-222.52"/>
<polygon fill="black" stroke="black" points="74397.48,-226.02 74407.4,-222.31 74397.33,-219.02 74397.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge502" class="edge">
<title>layer_2_expert_1_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M73110.8,-316.46C73146.41,-309.31 73183.79,-302.67 73219,-298 73630.77,-243.39 74115.14,-226.03 74395.05,-220.53"/>
<polygon fill="black" stroke="black" points="74395.4,-224.02 74405.33,-220.33 74395.26,-217.02 74395.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge503" class="edge">
<title>layer_2_expert_2_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M73674.7,-317.34C73710.07,-310.17 73747.13,-303.29 73782,-298 73993.23,-265.93 74236.24,-244.53 74407.27,-231.99"/>
<polygon fill="black" stroke="black" points="74407.69,-235.47 74417.41,-231.25 74407.18,-228.49 74407.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge504" class="edge">
<title>layer_2_expert_3_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M74234.83,-314.82C74300.06,-298.72 74374.72,-280.29 74441.27,-263.86"/>
<polygon fill="black" stroke="black" points="74442.15,-267.24 74451.02,-261.45 74440.48,-260.45 74442.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge505" class="edge">
<title>layer_2_expert_4_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M74627,-305.64C74627,-297.08 74627,-288.12 74627,-279.34"/>
<polygon fill="black" stroke="black" points="74630.5,-279.15 74627,-269.15 74623.5,-279.15 74630.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge506" class="edge">
<title>layer_2_expert_5_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M74983.16,-305.93C74937.62,-294.69 74889.27,-282.75 74843.37,-271.42"/>
<polygon fill="black" stroke="black" points="74844.16,-268.01 74833.61,-269.01 74842.48,-274.81 74844.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge507" class="edge">
<title>layer_2_expert_6_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M75519.92,-305.97C75503.74,-303.07 75487.65,-300.38 75472,-298 75274.52,-268.02 75049.26,-247.36 74881.01,-234.55"/>
<polygon fill="black" stroke="black" points="74881.26,-231.06 74871.02,-233.8 74880.73,-238.04 74881.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_0&#45;&gt;layer_2_agg_ep_0 -->
<g id="edge508" class="edge">
<title>layer_2_expert_7_ep_0&#45;&gt;layer_2_agg_ep_0</title>
<path fill="none" stroke="black" d="M76086.84,-305.94C76069.35,-302.94 76051.92,-300.24 76035,-298 75626.97,-243.88 75147.66,-226.34 74866.64,-220.68"/>
<polygon fill="black" stroke="black" points="74866.38,-217.17 74856.32,-220.47 74866.24,-224.17 74866.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_1 -->
<g id="node299" class="node">
<title>layer_2_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="106438.07,-269 105987.77,-269 105871.93,-165 106322.23,-165 106438.07,-269"/>
<text text-anchor="middle" x="106155" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="106155" y="-220" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="106155" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="106155" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge510" class="edge">
<title>layer_2_expert_0_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M104075.37,-316.09C104111.1,-308.94 104148.63,-302.4 104184,-298 104514.43,-256.9 105480.09,-232.08 105925.31,-222.52"/>
<polygon fill="black" stroke="black" points="105925.48,-226.02 105935.4,-222.31 105925.33,-219.02 105925.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge511" class="edge">
<title>layer_2_expert_1_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M104638.8,-316.46C104674.41,-309.31 104711.79,-302.67 104747,-298 105158.77,-243.39 105643.14,-226.03 105923.05,-220.53"/>
<polygon fill="black" stroke="black" points="105923.4,-224.02 105933.33,-220.33 105923.26,-217.02 105923.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge512" class="edge">
<title>layer_2_expert_2_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M105202.7,-317.34C105238.07,-310.17 105275.13,-303.29 105310,-298 105521.23,-265.93 105764.24,-244.53 105935.27,-231.99"/>
<polygon fill="black" stroke="black" points="105935.69,-235.47 105945.41,-231.25 105935.18,-228.49 105935.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge513" class="edge">
<title>layer_2_expert_3_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M105762.83,-314.82C105828.06,-298.72 105902.72,-280.29 105969.27,-263.86"/>
<polygon fill="black" stroke="black" points="105970.15,-267.24 105979.02,-261.45 105968.48,-260.45 105970.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge514" class="edge">
<title>layer_2_expert_4_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M106155,-305.64C106155,-297.08 106155,-288.12 106155,-279.34"/>
<polygon fill="black" stroke="black" points="106158.5,-279.15 106155,-269.15 106151.5,-279.15 106158.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge515" class="edge">
<title>layer_2_expert_5_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M106511.16,-305.93C106465.62,-294.69 106417.27,-282.75 106371.37,-271.42"/>
<polygon fill="black" stroke="black" points="106372.16,-268.01 106361.61,-269.01 106370.48,-274.81 106372.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge516" class="edge">
<title>layer_2_expert_6_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M107047.92,-305.97C107031.74,-303.07 107015.65,-300.38 107000,-298 106802.52,-268.02 106577.26,-247.36 106409.01,-234.55"/>
<polygon fill="black" stroke="black" points="106409.26,-231.06 106399.02,-233.8 106408.73,-238.04 106409.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_1&#45;&gt;layer_2_agg_ep_1 -->
<g id="edge517" class="edge">
<title>layer_2_expert_7_ep_1&#45;&gt;layer_2_agg_ep_1</title>
<path fill="none" stroke="black" d="M107614.84,-305.94C107597.35,-302.94 107579.92,-300.24 107563,-298 107154.97,-243.88 106675.66,-226.34 106394.64,-220.68"/>
<polygon fill="black" stroke="black" points="106394.38,-217.17 106384.32,-220.47 106394.24,-224.17 106394.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_2 -->
<g id="node300" class="node">
<title>layer_2_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="88422.07,-269 87971.77,-269 87855.93,-165 88306.23,-165 88422.07,-269"/>
<text text-anchor="middle" x="88139" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="88139" y="-220" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="88139" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="88139" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge519" class="edge">
<title>layer_2_expert_0_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M86059.37,-316.09C86095.1,-308.94 86132.63,-302.4 86168,-298 86498.43,-256.9 87464.09,-232.08 87909.31,-222.52"/>
<polygon fill="black" stroke="black" points="87909.48,-226.02 87919.4,-222.31 87909.33,-219.02 87909.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge520" class="edge">
<title>layer_2_expert_1_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M86622.8,-316.46C86658.41,-309.31 86695.79,-302.67 86731,-298 87142.77,-243.39 87627.14,-226.03 87907.05,-220.53"/>
<polygon fill="black" stroke="black" points="87907.4,-224.02 87917.33,-220.33 87907.26,-217.02 87907.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge521" class="edge">
<title>layer_2_expert_2_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M87186.7,-317.34C87222.07,-310.17 87259.13,-303.29 87294,-298 87505.23,-265.93 87748.24,-244.53 87919.27,-231.99"/>
<polygon fill="black" stroke="black" points="87919.69,-235.47 87929.41,-231.25 87919.18,-228.49 87919.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge522" class="edge">
<title>layer_2_expert_3_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M87746.83,-314.82C87812.06,-298.72 87886.72,-280.29 87953.27,-263.86"/>
<polygon fill="black" stroke="black" points="87954.15,-267.24 87963.02,-261.45 87952.48,-260.45 87954.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge523" class="edge">
<title>layer_2_expert_4_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M88139,-305.64C88139,-297.08 88139,-288.12 88139,-279.34"/>
<polygon fill="black" stroke="black" points="88142.5,-279.15 88139,-269.15 88135.5,-279.15 88142.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge524" class="edge">
<title>layer_2_expert_5_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M88495.16,-305.93C88449.62,-294.69 88401.27,-282.75 88355.37,-271.42"/>
<polygon fill="black" stroke="black" points="88356.16,-268.01 88345.61,-269.01 88354.48,-274.81 88356.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge525" class="edge">
<title>layer_2_expert_6_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M89031.92,-305.97C89015.74,-303.07 88999.65,-300.38 88984,-298 88786.52,-268.02 88561.26,-247.36 88393.01,-234.55"/>
<polygon fill="black" stroke="black" points="88393.26,-231.06 88383.02,-233.8 88392.73,-238.04 88393.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_2&#45;&gt;layer_2_agg_ep_2 -->
<g id="edge526" class="edge">
<title>layer_2_expert_7_ep_2&#45;&gt;layer_2_agg_ep_2</title>
<path fill="none" stroke="black" d="M89598.84,-305.94C89581.35,-302.94 89563.92,-300.24 89547,-298 89138.97,-243.88 88659.66,-226.34 88378.64,-220.68"/>
<polygon fill="black" stroke="black" points="88378.38,-217.17 88368.32,-220.47 88378.24,-224.17 88378.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_3 -->
<g id="node301" class="node">
<title>layer_2_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="79414.07,-269 78963.77,-269 78847.93,-165 79298.23,-165 79414.07,-269"/>
<text text-anchor="middle" x="79131" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="79131" y="-220" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="79131" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="79131" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge528" class="edge">
<title>layer_2_expert_0_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M77051.37,-316.09C77087.1,-308.94 77124.63,-302.4 77160,-298 77490.43,-256.9 78456.09,-232.08 78901.31,-222.52"/>
<polygon fill="black" stroke="black" points="78901.48,-226.02 78911.4,-222.31 78901.33,-219.02 78901.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge529" class="edge">
<title>layer_2_expert_1_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M77614.8,-316.46C77650.41,-309.31 77687.79,-302.67 77723,-298 78134.77,-243.39 78619.14,-226.03 78899.05,-220.53"/>
<polygon fill="black" stroke="black" points="78899.4,-224.02 78909.33,-220.33 78899.26,-217.02 78899.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge530" class="edge">
<title>layer_2_expert_2_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M78178.7,-317.34C78214.07,-310.17 78251.13,-303.29 78286,-298 78497.23,-265.93 78740.24,-244.53 78911.27,-231.99"/>
<polygon fill="black" stroke="black" points="78911.69,-235.47 78921.41,-231.25 78911.18,-228.49 78911.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge531" class="edge">
<title>layer_2_expert_3_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M78738.83,-314.82C78804.06,-298.72 78878.72,-280.29 78945.27,-263.86"/>
<polygon fill="black" stroke="black" points="78946.15,-267.24 78955.02,-261.45 78944.48,-260.45 78946.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge532" class="edge">
<title>layer_2_expert_4_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M79131,-305.64C79131,-297.08 79131,-288.12 79131,-279.34"/>
<polygon fill="black" stroke="black" points="79134.5,-279.15 79131,-269.15 79127.5,-279.15 79134.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge533" class="edge">
<title>layer_2_expert_5_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M79487.16,-305.93C79441.62,-294.69 79393.27,-282.75 79347.37,-271.42"/>
<polygon fill="black" stroke="black" points="79348.16,-268.01 79337.61,-269.01 79346.48,-274.81 79348.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge534" class="edge">
<title>layer_2_expert_6_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M80023.92,-305.97C80007.74,-303.07 79991.65,-300.38 79976,-298 79778.52,-268.02 79553.26,-247.36 79385.01,-234.55"/>
<polygon fill="black" stroke="black" points="79385.26,-231.06 79375.02,-233.8 79384.73,-238.04 79385.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_3&#45;&gt;layer_2_agg_ep_3 -->
<g id="edge535" class="edge">
<title>layer_2_expert_7_ep_3&#45;&gt;layer_2_agg_ep_3</title>
<path fill="none" stroke="black" d="M80590.84,-305.94C80573.35,-302.94 80555.92,-300.24 80539,-298 80130.97,-243.88 79651.66,-226.34 79370.64,-220.68"/>
<polygon fill="black" stroke="black" points="79370.38,-217.17 79360.32,-220.47 79370.24,-224.17 79370.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_4 -->
<g id="node302" class="node">
<title>layer_2_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="101934.07,-269 101483.77,-269 101367.93,-165 101818.23,-165 101934.07,-269"/>
<text text-anchor="middle" x="101651" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="101651" y="-220" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="101651" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="101651" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge537" class="edge">
<title>layer_2_expert_0_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M99571.37,-316.09C99607.1,-308.94 99644.63,-302.4 99680,-298 100010.43,-256.9 100976.09,-232.08 101421.31,-222.52"/>
<polygon fill="black" stroke="black" points="101421.48,-226.02 101431.4,-222.31 101421.33,-219.02 101421.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge538" class="edge">
<title>layer_2_expert_1_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M100134.8,-316.46C100170.41,-309.31 100207.79,-302.67 100243,-298 100654.77,-243.39 101139.14,-226.03 101419.05,-220.53"/>
<polygon fill="black" stroke="black" points="101419.4,-224.02 101429.33,-220.33 101419.26,-217.02 101419.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge539" class="edge">
<title>layer_2_expert_2_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M100698.7,-317.34C100734.07,-310.17 100771.13,-303.29 100806,-298 101017.23,-265.93 101260.24,-244.53 101431.27,-231.99"/>
<polygon fill="black" stroke="black" points="101431.69,-235.47 101441.41,-231.25 101431.18,-228.49 101431.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge540" class="edge">
<title>layer_2_expert_3_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M101258.83,-314.82C101324.06,-298.72 101398.72,-280.29 101465.27,-263.86"/>
<polygon fill="black" stroke="black" points="101466.15,-267.24 101475.02,-261.45 101464.48,-260.45 101466.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge541" class="edge">
<title>layer_2_expert_4_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M101651,-305.64C101651,-297.08 101651,-288.12 101651,-279.34"/>
<polygon fill="black" stroke="black" points="101654.5,-279.15 101651,-269.15 101647.5,-279.15 101654.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge542" class="edge">
<title>layer_2_expert_5_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M102007.16,-305.93C101961.62,-294.69 101913.27,-282.75 101867.37,-271.42"/>
<polygon fill="black" stroke="black" points="101868.16,-268.01 101857.61,-269.01 101866.48,-274.81 101868.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge543" class="edge">
<title>layer_2_expert_6_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M102543.92,-305.97C102527.74,-303.07 102511.65,-300.38 102496,-298 102298.52,-268.02 102073.26,-247.36 101905.01,-234.55"/>
<polygon fill="black" stroke="black" points="101905.26,-231.06 101895.02,-233.8 101904.73,-238.04 101905.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_4&#45;&gt;layer_2_agg_ep_4 -->
<g id="edge544" class="edge">
<title>layer_2_expert_7_ep_4&#45;&gt;layer_2_agg_ep_4</title>
<path fill="none" stroke="black" d="M103110.84,-305.94C103093.35,-302.94 103075.92,-300.24 103059,-298 102650.97,-243.88 102171.66,-226.34 101890.64,-220.68"/>
<polygon fill="black" stroke="black" points="101890.38,-217.17 101880.32,-220.47 101890.24,-224.17 101890.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_5 -->
<g id="node303" class="node">
<title>layer_2_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="97430.07,-269 96979.77,-269 96863.93,-165 97314.23,-165 97430.07,-269"/>
<text text-anchor="middle" x="97147" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="97147" y="-220" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="97147" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="97147" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge546" class="edge">
<title>layer_2_expert_0_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M95067.37,-316.09C95103.1,-308.94 95140.63,-302.4 95176,-298 95506.43,-256.9 96472.09,-232.08 96917.31,-222.52"/>
<polygon fill="black" stroke="black" points="96917.48,-226.02 96927.4,-222.31 96917.33,-219.02 96917.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge547" class="edge">
<title>layer_2_expert_1_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M95630.8,-316.46C95666.41,-309.31 95703.79,-302.67 95739,-298 96150.77,-243.39 96635.14,-226.03 96915.05,-220.53"/>
<polygon fill="black" stroke="black" points="96915.4,-224.02 96925.33,-220.33 96915.26,-217.02 96915.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge548" class="edge">
<title>layer_2_expert_2_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M96194.7,-317.34C96230.07,-310.17 96267.13,-303.29 96302,-298 96513.23,-265.93 96756.24,-244.53 96927.27,-231.99"/>
<polygon fill="black" stroke="black" points="96927.69,-235.47 96937.41,-231.25 96927.18,-228.49 96927.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge549" class="edge">
<title>layer_2_expert_3_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M96754.83,-314.82C96820.06,-298.72 96894.72,-280.29 96961.27,-263.86"/>
<polygon fill="black" stroke="black" points="96962.15,-267.24 96971.02,-261.45 96960.48,-260.45 96962.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge550" class="edge">
<title>layer_2_expert_4_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M97147,-305.64C97147,-297.08 97147,-288.12 97147,-279.34"/>
<polygon fill="black" stroke="black" points="97150.5,-279.15 97147,-269.15 97143.5,-279.15 97150.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge551" class="edge">
<title>layer_2_expert_5_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M97503.16,-305.93C97457.62,-294.69 97409.27,-282.75 97363.37,-271.42"/>
<polygon fill="black" stroke="black" points="97364.16,-268.01 97353.61,-269.01 97362.48,-274.81 97364.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge552" class="edge">
<title>layer_2_expert_6_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M98039.92,-305.97C98023.74,-303.07 98007.65,-300.38 97992,-298 97794.52,-268.02 97569.26,-247.36 97401.01,-234.55"/>
<polygon fill="black" stroke="black" points="97401.26,-231.06 97391.02,-233.8 97400.73,-238.04 97401.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_5&#45;&gt;layer_2_agg_ep_5 -->
<g id="edge553" class="edge">
<title>layer_2_expert_7_ep_5&#45;&gt;layer_2_agg_ep_5</title>
<path fill="none" stroke="black" d="M98606.84,-305.94C98589.35,-302.94 98571.92,-300.24 98555,-298 98146.97,-243.88 97667.66,-226.34 97386.64,-220.68"/>
<polygon fill="black" stroke="black" points="97386.38,-217.17 97376.32,-220.47 97386.24,-224.17 97386.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_6 -->
<g id="node304" class="node">
<title>layer_2_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="92926.07,-269 92475.77,-269 92359.93,-165 92810.23,-165 92926.07,-269"/>
<text text-anchor="middle" x="92643" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="92643" y="-220" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="92643" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="92643" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge555" class="edge">
<title>layer_2_expert_0_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M90563.37,-316.09C90599.1,-308.94 90636.63,-302.4 90672,-298 91002.43,-256.9 91968.09,-232.08 92413.31,-222.52"/>
<polygon fill="black" stroke="black" points="92413.48,-226.02 92423.4,-222.31 92413.33,-219.02 92413.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge556" class="edge">
<title>layer_2_expert_1_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M91126.8,-316.46C91162.41,-309.31 91199.79,-302.67 91235,-298 91646.77,-243.39 92131.14,-226.03 92411.05,-220.53"/>
<polygon fill="black" stroke="black" points="92411.4,-224.02 92421.33,-220.33 92411.26,-217.02 92411.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge557" class="edge">
<title>layer_2_expert_2_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M91690.7,-317.34C91726.07,-310.17 91763.13,-303.29 91798,-298 92009.23,-265.93 92252.24,-244.53 92423.27,-231.99"/>
<polygon fill="black" stroke="black" points="92423.69,-235.47 92433.41,-231.25 92423.18,-228.49 92423.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge558" class="edge">
<title>layer_2_expert_3_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M92250.83,-314.82C92316.06,-298.72 92390.72,-280.29 92457.27,-263.86"/>
<polygon fill="black" stroke="black" points="92458.15,-267.24 92467.02,-261.45 92456.48,-260.45 92458.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge559" class="edge">
<title>layer_2_expert_4_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M92643,-305.64C92643,-297.08 92643,-288.12 92643,-279.34"/>
<polygon fill="black" stroke="black" points="92646.5,-279.15 92643,-269.15 92639.5,-279.15 92646.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge560" class="edge">
<title>layer_2_expert_5_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M92999.16,-305.93C92953.62,-294.69 92905.27,-282.75 92859.37,-271.42"/>
<polygon fill="black" stroke="black" points="92860.16,-268.01 92849.61,-269.01 92858.48,-274.81 92860.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge561" class="edge">
<title>layer_2_expert_6_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M93535.92,-305.97C93519.74,-303.07 93503.65,-300.38 93488,-298 93290.52,-268.02 93065.26,-247.36 92897.01,-234.55"/>
<polygon fill="black" stroke="black" points="92897.26,-231.06 92887.02,-233.8 92896.73,-238.04 92897.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_6&#45;&gt;layer_2_agg_ep_6 -->
<g id="edge562" class="edge">
<title>layer_2_expert_7_ep_6&#45;&gt;layer_2_agg_ep_6</title>
<path fill="none" stroke="black" d="M94102.84,-305.94C94085.35,-302.94 94067.92,-300.24 94051,-298 93642.97,-243.88 93163.66,-226.34 92882.64,-220.68"/>
<polygon fill="black" stroke="black" points="92882.38,-217.17 92872.32,-220.47 92882.24,-224.17 92882.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_7 -->
<g id="node305" class="node">
<title>layer_2_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="83918.07,-269 83467.77,-269 83351.93,-165 83802.23,-165 83918.07,-269"/>
<text text-anchor="middle" x="83635" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="83635" y="-220" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="83635" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="83635" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_expert_0_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge564" class="edge">
<title>layer_2_expert_0_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M81555.37,-316.09C81591.1,-308.94 81628.63,-302.4 81664,-298 81994.43,-256.9 82960.09,-232.08 83405.31,-222.52"/>
<polygon fill="black" stroke="black" points="83405.48,-226.02 83415.4,-222.31 83405.33,-219.02 83405.48,-226.02"/>
</g>
<!-- layer_2_expert_1_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge565" class="edge">
<title>layer_2_expert_1_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M82118.8,-316.46C82154.41,-309.31 82191.79,-302.67 82227,-298 82638.77,-243.39 83123.14,-226.03 83403.05,-220.53"/>
<polygon fill="black" stroke="black" points="83403.4,-224.02 83413.33,-220.33 83403.26,-217.02 83403.4,-224.02"/>
</g>
<!-- layer_2_expert_2_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge566" class="edge">
<title>layer_2_expert_2_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M82682.7,-317.34C82718.07,-310.17 82755.13,-303.29 82790,-298 83001.23,-265.93 83244.24,-244.53 83415.27,-231.99"/>
<polygon fill="black" stroke="black" points="83415.69,-235.47 83425.41,-231.25 83415.18,-228.49 83415.69,-235.47"/>
</g>
<!-- layer_2_expert_3_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge567" class="edge">
<title>layer_2_expert_3_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M83242.83,-314.82C83308.06,-298.72 83382.72,-280.29 83449.27,-263.86"/>
<polygon fill="black" stroke="black" points="83450.15,-267.24 83459.02,-261.45 83448.48,-260.45 83450.15,-267.24"/>
</g>
<!-- layer_2_expert_4_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge568" class="edge">
<title>layer_2_expert_4_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M83635,-305.64C83635,-297.08 83635,-288.12 83635,-279.34"/>
<polygon fill="black" stroke="black" points="83638.5,-279.15 83635,-269.15 83631.5,-279.15 83638.5,-279.15"/>
</g>
<!-- layer_2_expert_5_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge569" class="edge">
<title>layer_2_expert_5_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M83991.16,-305.93C83945.62,-294.69 83897.27,-282.75 83851.37,-271.42"/>
<polygon fill="black" stroke="black" points="83852.16,-268.01 83841.61,-269.01 83850.48,-274.81 83852.16,-268.01"/>
</g>
<!-- layer_2_expert_6_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge570" class="edge">
<title>layer_2_expert_6_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M84527.92,-305.97C84511.74,-303.07 84495.65,-300.38 84480,-298 84282.52,-268.02 84057.26,-247.36 83889.01,-234.55"/>
<polygon fill="black" stroke="black" points="83889.26,-231.06 83879.02,-233.8 83888.73,-238.04 83889.26,-231.06"/>
</g>
<!-- layer_2_expert_7_ep_7&#45;&gt;layer_2_agg_ep_7 -->
<g id="edge571" class="edge">
<title>layer_2_expert_7_ep_7&#45;&gt;layer_2_agg_ep_7</title>
<path fill="none" stroke="black" d="M85094.84,-305.94C85077.35,-302.94 85059.92,-300.24 85043,-298 84634.97,-243.88 84155.66,-226.34 83874.64,-220.68"/>
<polygon fill="black" stroke="black" points="83874.38,-217.17 83864.32,-220.47 83874.24,-224.17 83874.38,-217.17"/>
</g>
<!-- layer_2_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge509" class="edge">
<title>layer_2_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M74857.76,-221.91C75493.69,-235.17 77325.21,-271.51 78848,-283.5 81819.86,-306.91 503837.05,-284.87 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge518" class="edge">
<title>layer_2_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M106391.88,-227.51C106763.7,-243.43 107507.07,-272.92 108138,-283.5 109522.08,-306.7 505424.73,-284.14 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge527" class="edge">
<title>layer_2_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M88369.76,-221.91C89005.69,-235.17 90837.21,-271.51 92360,-283.5 95238.03,-306.17 503930.88,-284.83 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge536" class="edge">
<title>layer_2_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M79361.76,-221.91C79997.69,-235.17 81829.21,-271.51 83352,-283.5 86292.58,-306.66 503868.33,-284.85 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge545" class="edge">
<title>layer_2_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M101881.76,-221.91C102517.69,-235.17 104349.21,-271.51 105872,-283.5 108656.2,-305.43 504024.72,-284.78 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge554" class="edge">
<title>layer_2_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M97377.76,-221.91C98013.69,-235.17 99845.21,-271.51 101368,-283.5 104183.48,-305.68 503993.44,-284.8 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge563" class="edge">
<title>layer_2_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M92873.76,-221.91C93509.69,-235.17 95341.21,-271.51 96864,-283.5 99710.75,-305.92 503962.16,-284.81 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge572" class="edge">
<title>layer_2_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M83865.76,-221.91C84501.69,-235.17 86333.21,-271.51 87856,-283.5 90765.31,-306.42 503899.6,-284.84 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_2_moe_alltoall -->
<g id="node306" class="node">
<title>layer_2_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="96669" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="96669" y="-691" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="96669" y="-680" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="96669" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="96669" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_2_ln_tp_0 -->
<g id="node307" class="node">
<title>layer_2_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="104813.07,-729 104362.77,-729 104246.93,-625 104697.23,-625 104813.07,-729"/>
<text text-anchor="middle" x="104530" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="104530" y="-680" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="104530" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="104530" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_qkv_tp_0 -->
<g id="node311" class="node">
<title>layer_3_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="139693.7,-559 139251.94,-559 139138.3,-455 139580.06,-455 139693.7,-559"/>
<text text-anchor="middle" x="139416" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="139416" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="139416" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="139416" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_2_ln_tp_0&#45;&gt;layer_3_qkv_tp_0 -->
<g id="edge3085" class="edge">
<title>layer_2_ln_tp_0&#45;&gt;layer_3_qkv_tp_0</title>
<path fill="none" stroke="black" d="M104713.17,-639.06C104749.11,-633.22 104786.63,-628.09 104822,-625 105369.36,-577.18 124052.56,-598.53 124602,-598 124652.44,-597.95 139080.05,-597.03 139130,-590 139172.03,-584.08 139216.54,-573.52 139257.61,-561.9"/>
<polygon fill="black" stroke="black" points="139258.77,-565.2 139267.41,-559.08 139256.84,-558.48 139258.77,-565.2"/>
</g>
<!-- layer_2_ln_tp_1 -->
<g id="node308" class="node">
<title>layer_2_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="105397.07,-729 104946.77,-729 104830.93,-625 105281.23,-625 105397.07,-729"/>
<text text-anchor="middle" x="105114" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="105114" y="-680" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="105114" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="105114" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_qkv_tp_1 -->
<g id="node312" class="node">
<title>layer_3_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="140267.7,-559 139825.94,-559 139712.3,-455 140154.06,-455 140267.7,-559"/>
<text text-anchor="middle" x="139990" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="139990" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="139990" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="139990" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_2_ln_tp_1&#45;&gt;layer_3_qkv_tp_1 -->
<g id="edge3086" class="edge">
<title>layer_2_ln_tp_1&#45;&gt;layer_3_qkv_tp_1</title>
<path fill="none" stroke="black" d="M105297.17,-639.05C105333.11,-633.21 105370.63,-628.08 105406,-625 105435.66,-622.41 139673.52,-594.14 139703,-590 139745.16,-584.07 139789.82,-573.5 139831.04,-561.88"/>
<polygon fill="black" stroke="black" points="139832.23,-565.18 139840.88,-559.07 139830.3,-558.45 139832.23,-565.18"/>
</g>
<!-- layer_2_ln_tp_2 -->
<g id="node309" class="node">
<title>layer_2_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="106385.07,-729 105934.77,-729 105818.93,-625 106269.23,-625 106385.07,-729"/>
<text text-anchor="middle" x="106102" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="106102" y="-680" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="106102" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="106102" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_qkv_tp_2 -->
<g id="node313" class="node">
<title>layer_3_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="140841.7,-559 140399.94,-559 140286.3,-455 140728.06,-455 140841.7,-559"/>
<text text-anchor="middle" x="140564" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="140564" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="140564" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="140564" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_2_ln_tp_2&#45;&gt;layer_3_qkv_tp_2 -->
<g id="edge3087" class="edge">
<title>layer_2_ln_tp_2&#45;&gt;layer_3_qkv_tp_2</title>
<path fill="none" stroke="black" d="M106285.17,-639.06C106321.11,-633.21 106358.63,-628.08 106394,-625 106628.41,-604.56 140043.99,-622.76 140277,-590 140319.16,-584.07 140363.82,-573.5 140405.04,-561.88"/>
<polygon fill="black" stroke="black" points="140406.23,-565.18 140414.88,-559.07 140404.3,-558.45 140406.23,-565.18"/>
</g>
<!-- layer_2_ln_tp_3 -->
<g id="node310" class="node">
<title>layer_2_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="106969.07,-729 106518.77,-729 106402.93,-625 106853.23,-625 106969.07,-729"/>
<text text-anchor="middle" x="106686" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="106686" y="-680" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="106686" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="106686" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_qkv_tp_3 -->
<g id="node314" class="node">
<title>layer_3_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="141415.7,-559 140973.94,-559 140860.3,-455 141302.06,-455 141415.7,-559"/>
<text text-anchor="middle" x="141138" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="141138" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="141138" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="141138" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_2_ln_tp_3&#45;&gt;layer_3_qkv_tp_3 -->
<g id="edge3088" class="edge">
<title>layer_2_ln_tp_3&#45;&gt;layer_3_qkv_tp_3</title>
<path fill="none" stroke="black" d="M106869.17,-639.06C106905.11,-633.21 106942.63,-628.08 106978,-625 107446.68,-584.13 140385.12,-655.49 140851,-590 140893.16,-584.07 140937.82,-573.5 140979.04,-561.88"/>
<polygon fill="black" stroke="black" points="140980.23,-565.18 140988.88,-559.07 140978.3,-558.45 140980.23,-565.18"/>
</g>
<!-- layer_3_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge581" class="edge">
<title>layer_3_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M139590.84,-464.44C139627.68,-457.27 139666.45,-450.88 139703,-447 140179.89,-396.37 141381.44,-431.98 141861,-428 142886.33,-419.49 143143.02,-438.1 144168,-410 144533.47,-399.98 144967.74,-375.85 145156.5,-364.75"/>
<polygon fill="black" stroke="black" points="145156.89,-368.24 145166.67,-364.15 145156.48,-361.25 145156.89,-368.24"/>
</g>
<!-- layer_3_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge582" class="edge">
<title>layer_3_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M140164.45,-464.45C140201.4,-457.25 140240.32,-450.85 140277,-447 140364.52,-437.82 141773,-437.79 141861,-437 142886.36,-427.76 143143.04,-440.1 144168,-410 144533.45,-399.27 144967.73,-375.5 145156.5,-364.63"/>
<polygon fill="black" stroke="black" points="145156.89,-368.11 145166.67,-364.04 145156.48,-361.12 145156.89,-368.11"/>
</g>
<!-- layer_3_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge583" class="edge">
<title>layer_3_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M140738.44,-464.34C140775.39,-457.15 140814.31,-450.78 140851,-447 140964.76,-435.29 144854.68,-452.42 144968,-437 145048.7,-426.02 145138.92,-398.51 145195.58,-379.28"/>
<polygon fill="black" stroke="black" points="145196.74,-382.59 145205.07,-376.04 145194.47,-375.96 145196.74,-382.59"/>
</g>
<!-- layer_3_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge584" class="edge">
<title>layer_3_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M141312.44,-464.35C141349.39,-457.15 141388.31,-450.78 141425,-447 141475.79,-441.76 145051.4,-449.12 145101,-437 145144.64,-426.33 145189.78,-400.76 145219.2,-381.79"/>
<polygon fill="black" stroke="black" points="145221.37,-384.56 145227.81,-376.14 145217.53,-378.7 145221.37,-384.56"/>
</g>
<!-- layer_3_qkv_comm -->
<g id="node315" class="node">
<title>layer_3_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="141627" cy="-507" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="141627" y="-521" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="141627" y="-510" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="141627" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="141627" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_3_attn_tp_0 -->
<g id="node316" class="node">
<title>layer_3_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="136987.7,-559 136545.94,-559 136432.3,-455 136874.06,-455 136987.7,-559"/>
<text text-anchor="middle" x="136710" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="136710" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="136710" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="136710" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_out_tp_0 -->
<g id="node320" class="node">
<title>layer_3_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="141471.7,-410 141029.94,-410 140916.3,-306 141358.06,-306 141471.7,-410"/>
<text text-anchor="middle" x="141194" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="141194" y="-361" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="141194" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="141194" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_tp_0&#45;&gt;layer_3_attn_out_tp_0 -->
<g id="edge589" class="edge">
<title>layer_3_attn_tp_0&#45;&gt;layer_3_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M136884.84,-464.47C136921.68,-457.29 136960.45,-450.9 136997,-447 137425.15,-401.36 140442.92,-445.81 140872,-410 140913.9,-406.5 140958.61,-400.74 141000.95,-394.32"/>
<polygon fill="black" stroke="black" points="141001.74,-397.74 141011.09,-392.77 141000.67,-390.82 141001.74,-397.74"/>
</g>
<!-- layer_3_attn_tp_1 -->
<g id="node317" class="node">
<title>layer_3_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="137561.7,-559 137119.94,-559 137006.3,-455 137448.06,-455 137561.7,-559"/>
<text text-anchor="middle" x="137284" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="137284" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="137284" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="137284" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_out_tp_1 -->
<g id="node321" class="node">
<title>layer_3_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="142575.7,-410 142133.94,-410 142020.3,-306 142462.06,-306 142575.7,-410"/>
<text text-anchor="middle" x="142298" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="142298" y="-361" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="142298" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="142298" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_tp_1&#45;&gt;layer_3_attn_out_tp_1 -->
<g id="edge591" class="edge">
<title>layer_3_attn_tp_1&#45;&gt;layer_3_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M137458.84,-464.46C137495.68,-457.29 137534.45,-450.89 137571,-447 138003.02,-400.99 141046.82,-425.6 141481,-410 141686.19,-402.63 141919.99,-387.34 142084.76,-375.41"/>
<polygon fill="black" stroke="black" points="142085.3,-378.88 142095.02,-374.66 142084.79,-371.9 142085.3,-378.88"/>
</g>
<!-- layer_3_attn_tp_2 -->
<g id="node318" class="node">
<title>layer_3_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="138135.7,-559 137693.94,-559 137580.3,-455 138022.06,-455 138135.7,-559"/>
<text text-anchor="middle" x="137858" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="137858" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="137858" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="137858" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_out_tp_2 -->
<g id="node322" class="node">
<title>layer_3_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="143414.7,-410 142972.94,-410 142859.3,-306 143301.06,-306 143414.7,-410"/>
<text text-anchor="middle" x="143137" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="143137" y="-361" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="143137" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="143137" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_tp_2&#45;&gt;layer_3_attn_out_tp_2 -->
<g id="edge593" class="edge">
<title>layer_3_attn_tp_2&#45;&gt;layer_3_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M138032.45,-464.5C138069.41,-457.3 138108.33,-450.89 138145,-447 138635.61,-395.03 142092.27,-434.77 142585,-410 142699.77,-404.23 142827.55,-392.75 142931.25,-382.14"/>
<polygon fill="black" stroke="black" points="142931.62,-385.62 142941.21,-381.11 142930.91,-378.66 142931.62,-385.62"/>
</g>
<!-- layer_3_attn_tp_3 -->
<g id="node319" class="node">
<title>layer_3_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="138709.7,-559 138267.94,-559 138154.3,-455 138596.06,-455 138709.7,-559"/>
<text text-anchor="middle" x="138432" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="138432" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="138432" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="138432" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_out_tp_3 -->
<g id="node323" class="node">
<title>layer_3_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="144120.7,-410 143678.94,-410 143565.3,-306 144007.06,-306 144120.7,-410"/>
<text text-anchor="middle" x="143843" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="143843" y="-361" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="143843" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="143843" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_3_attn_tp_3&#45;&gt;layer_3_attn_out_tp_3 -->
<g id="edge595" class="edge">
<title>layer_3_attn_tp_3&#45;&gt;layer_3_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M138606.6,-464.34C138643.2,-457.2 138681.7,-450.85 138718,-447 139237.99,-391.86 142902.18,-443.7 143424,-410 143495.7,-405.37 143573.95,-396.8 143643.2,-388"/>
<polygon fill="black" stroke="black" points="143643.88,-391.44 143653.36,-386.7 143642.99,-384.5 143643.88,-391.44"/>
</g>
<!-- layer_3_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge590" class="edge">
<title>layer_3_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M141435.61,-376.95C141598.16,-388.33 141817.34,-402.3 142011,-410 142250.18,-419.51 143928.69,-408.86 144165,-447 144400.36,-484.99 144444.89,-552.54 144677,-607 144775.2,-630.04 144887.74,-647.71 144973.48,-659.41"/>
<polygon fill="black" stroke="black" points="144973.15,-662.89 144983.53,-660.77 144974.09,-655.96 144973.15,-662.89"/>
</g>
<!-- layer_3_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge592" class="edge">
<title>layer_3_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M142550.5,-386.71C142644.42,-395.86 142751.96,-404.98 142850,-410 142874.46,-411.25 144593.09,-413.75 144613,-428 144675.06,-472.43 144613.48,-538.7 144670,-590 144715.04,-630.88 144869.07,-653.9 144982.23,-665.63"/>
<polygon fill="black" stroke="black" points="144982.06,-669.13 144992.36,-666.66 144982.77,-662.16 144982.06,-669.13"/>
</g>
<!-- layer_3_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge594" class="edge">
<title>layer_3_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M143398.66,-395.13C143450.7,-401.1 143505.01,-406.49 143556,-410 143586.35,-412.09 144624.98,-412.23 144651,-428 144729.88,-475.8 144674.57,-563.68 144756,-607 144827.52,-645.05 144917.18,-662.27 144988.36,-669.99"/>
<polygon fill="black" stroke="black" points="144988.42,-673.51 144998.73,-671.06 144989.14,-666.55 144988.42,-673.51"/>
</g>
<!-- layer_3_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge596" class="edge">
<title>layer_3_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M144069.44,-362.89C144314.88,-369.26 144678.3,-385.77 144727,-428 144788.58,-481.41 144708.75,-549.98 144767,-607 144797.34,-636.7 144896.86,-654.54 144980.93,-664.62"/>
<polygon fill="black" stroke="black" points="144980.76,-668.12 144991.1,-665.81 144981.58,-661.17 144980.76,-668.12"/>
</g>
<!-- layer_3_attn_allreduce -->
<g id="node324" class="node">
<title>layer_3_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="138924" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="138924" y="-521" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="138924" y="-510" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="138924" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="138924" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_gate_tp_0 -->
<g id="node325" class="node">
<title>layer_3_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="127408.99,-559 126960.4,-559 126845.01,-455 127293.6,-455 127408.99,-559"/>
<text text-anchor="middle" x="127127" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="127127" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="127127" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="127127" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_3_route_ep_0 -->
<g id="node329" class="node">
<title>layer_3_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="120807.43,-410 120348.6,-410 120230.57,-306 120689.4,-306 120807.43,-410"/>
<text text-anchor="middle" x="120519" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="120519" y="-361" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="120519" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="120519" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_0 -->
<g id="edge597" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126895.69,-500.85C125879.25,-478.24 121813.28,-387.79 120766.03,-364.5"/>
<polygon fill="black" stroke="black" points="120765.81,-360.99 120755.74,-364.27 120765.66,-367.99 120765.81,-360.99"/>
<text text-anchor="middle" x="124047" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_1 -->
<g id="node330" class="node">
<title>layer_3_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="116303.43,-410 115844.6,-410 115726.57,-306 116185.4,-306 116303.43,-410"/>
<text text-anchor="middle" x="116015" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="116015" y="-361" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="116015" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="116015" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_1 -->
<g id="edge598" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126899.37,-504.23C126051.23,-497.49 122994.03,-472.11 120474,-437 118867.4,-414.62 116935.37,-377.27 116261.28,-363.92"/>
<polygon fill="black" stroke="black" points="116261.03,-360.42 116250.96,-363.72 116260.89,-367.42 116261.03,-360.42"/>
<text text-anchor="middle" x="120500" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_2 -->
<g id="node331" class="node">
<title>layer_3_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="128453.43,-410 127994.6,-410 127876.57,-306 128335.4,-306 128453.43,-410"/>
<text text-anchor="middle" x="128165" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="128165" y="-361" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="128165" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="128165" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_2 -->
<g id="edge599" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127307.04,-467.11C127343.66,-459.87 127381.99,-452.78 127418,-447 127595.87,-418.46 127798.97,-395.12 127948.45,-379.67"/>
<polygon fill="black" stroke="black" points="127949.07,-383.12 127958.66,-378.62 127948.36,-376.16 127949.07,-383.12"/>
<text text-anchor="middle" x="127565" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_3 -->
<g id="node332" class="node">
<title>layer_3_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="125506.43,-410 125047.6,-410 124929.57,-306 125388.4,-306 125506.43,-410"/>
<text text-anchor="middle" x="125218" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="125218" y="-361" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="125218" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="125218" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_3 -->
<g id="edge600" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126899.45,-504.21C126509.28,-499.88 125728.6,-485.27 125459,-437 125427.52,-431.36 125394.47,-422.63 125363.29,-413.02"/>
<polygon fill="black" stroke="black" points="125364.27,-409.66 125353.68,-410.02 125362.18,-416.34 125364.27,-409.66"/>
<text text-anchor="middle" x="125485" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_4 -->
<g id="node333" class="node">
<title>layer_3_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="132067.43,-410 131608.6,-410 131490.57,-306 131949.4,-306 132067.43,-410"/>
<text text-anchor="middle" x="131779" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="131779" y="-361" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="131779" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="131779" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_4 -->
<g id="edge601" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127304.71,-464.61C127341.94,-457.45 127381.1,-451.02 127418,-447 127481.96,-440.02 127933.98,-449.96 127997,-437 128007.35,-434.87 128008.65,-430.13 128019,-428 128105.51,-410.16 130734.24,-373.15 131543.95,-362.15"/>
<polygon fill="black" stroke="black" points="131544.03,-365.65 131553.98,-362.01 131543.93,-358.65 131544.03,-365.65"/>
<text text-anchor="middle" x="128045" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_5 -->
<g id="node334" class="node">
<title>layer_3_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="136659.43,-410 136200.6,-410 136082.57,-306 136541.4,-306 136659.43,-410"/>
<text text-anchor="middle" x="136371" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="136371" y="-361" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="136371" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="136371" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_5 -->
<g id="edge602" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127304.3,-464.44C127341.65,-457.26 127380.96,-450.88 127418,-447 127483.09,-440.19 128531.65,-448.95 128596,-437 128607.2,-434.92 128608.8,-430.06 128620,-428 128714.42,-410.63 131980,-410.82 132076,-410 133625.18,-396.77 135488.58,-371.42 136135.92,-362.34"/>
<polygon fill="black" stroke="black" points="136136.35,-365.84 136146.3,-362.2 136136.25,-358.84 136136.35,-365.84"/>
<text text-anchor="middle" x="128646" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_6 -->
<g id="node335" class="node">
<title>layer_3_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="140863.43,-410 140404.6,-410 140286.57,-306 140745.4,-306 140863.43,-410"/>
<text text-anchor="middle" x="140575" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="140575" y="-361" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="140575" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="140575" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_6 -->
<g id="edge603" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127304.29,-464.35C127341.64,-457.18 127380.95,-450.82 127418,-447 127518.3,-436.66 129134.11,-456.73 129233,-437 129243.36,-434.93 129244.64,-430.05 129255,-428 129356,-408.01 136565.04,-410.8 136668,-410 138061.32,-399.21 139733.98,-372.9 140340.75,-362.93"/>
<polygon fill="black" stroke="black" points="140340.98,-366.42 140350.92,-362.76 140340.87,-359.42 140340.98,-366.42"/>
<text text-anchor="middle" x="129281" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_route_ep_7 -->
<g id="node336" class="node">
<title>layer_3_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="111729.43,-410 111270.6,-410 111152.57,-306 111611.4,-306 111729.43,-410"/>
<text text-anchor="middle" x="111441" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="111441" y="-361" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="111441" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="111441" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_7 -->
<g id="edge604" class="edge">
<title>layer_3_gate_tp_0&#45;&gt;layer_3_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M126899.4,-504.38C125723.86,-495.96 120220.99,-455.79 115718,-410 114183.26,-394.39 112338.81,-370.74 111685.14,-362.21"/>
<polygon fill="black" stroke="black" points="111685.17,-358.71 111675.13,-362.08 111685.08,-365.71 111685.17,-358.71"/>
<text text-anchor="middle" x="118560" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1 -->
<g id="node326" class="node">
<title>layer_3_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="127990.99,-559 127542.4,-559 127427.01,-455 127875.6,-455 127990.99,-559"/>
<text text-anchor="middle" x="127709" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="127709" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="127709" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="127709" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_0 -->
<g id="edge605" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127477.31,-454.94C127457.32,-451.78 127437.35,-449.05 127418,-447 127318.88,-436.49 126620.67,-438.2 126521,-437 124284.75,-410 121579.89,-373.46 120763.63,-362.34"/>
<polygon fill="black" stroke="black" points="120763.57,-358.84 120753.52,-362.2 120763.47,-365.84 120763.57,-358.84"/>
<text text-anchor="middle" x="126547" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_1 -->
<g id="edge606" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127478.52,-454.98C127458.13,-451.77 127437.74,-449.02 127418,-447 127348.86,-439.92 124985.5,-437.51 124916,-437 124543.1,-434.25 124449.9,-430.87 124077,-428 122363.7,-414.81 121935.29,-424.38 120222,-410 118716.13,-397.36 116907.18,-372 116259.99,-362.61"/>
<polygon fill="black" stroke="black" points="116259.65,-359.1 116249.6,-362.46 116259.55,-366.1 116259.65,-359.1"/>
<text text-anchor="middle" x="124942" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_2 -->
<g id="edge607" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127889.49,-467.43C127925.99,-460.19 127964.16,-453.02 128000,-447 128033.16,-441.43 128044.34,-450.81 128075,-437 128086.72,-431.72 128098.05,-424.41 128108.49,-416.36"/>
<polygon fill="black" stroke="black" points="128110.7,-419.07 128116.3,-410.08 128106.31,-413.62 128110.7,-419.07"/>
<text text-anchor="middle" x="128115" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_3 -->
<g id="edge608" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127647.91,-454.91C127631.67,-444.02 127613.47,-434.01 127595,-428 127396.03,-363.27 126021.59,-357.79 125458.14,-358.31"/>
<polygon fill="black" stroke="black" points="125457.85,-354.81 125447.85,-358.32 125457.86,-361.81 125457.85,-354.81"/>
<text text-anchor="middle" x="127641" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_4 -->
<g id="edge609" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127886.31,-464.62C127923.66,-457.43 127962.97,-450.99 128000,-447 128149.37,-430.89 128525.91,-443.64 128676,-437 128730.32,-434.6 128743.69,-430.63 128798,-428 129818.33,-378.59 131036.87,-364.35 131541.82,-360.43"/>
<polygon fill="black" stroke="black" points="131542.17,-363.92 131552.14,-360.35 131542.12,-356.92 131542.17,-363.92"/>
<text text-anchor="middle" x="128824" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_5 -->
<g id="edge610" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127886.29,-464.41C127923.64,-457.24 127962.96,-450.86 128000,-447 128072.44,-439.45 129238.17,-437.63 129311,-437 130539.9,-426.31 130847.12,-423.3 132076,-410 133624.69,-393.24 135487.45,-370.11 136135.33,-361.97"/>
<polygon fill="black" stroke="black" points="136135.77,-365.47 136145.72,-361.84 136135.68,-358.47 136135.77,-365.47"/>
<text text-anchor="middle" x="130343" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_6 -->
<g id="edge611" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127886.27,-464.23C127923.63,-457.07 127962.94,-450.74 128000,-447 128100,-436.89 135136.49,-437.8 135237,-437 136253.49,-428.87 139447.16,-377.41 140340.66,-362.84"/>
<polygon fill="black" stroke="black" points="140340.8,-366.34 140350.74,-362.67 140340.68,-359.34 140340.8,-366.34"/>
<text text-anchor="middle" x="136031" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_7 -->
<g id="edge612" class="edge">
<title>layer_3_gate_tp_1&#45;&gt;layer_3_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127478.52,-454.94C127458.13,-451.74 127437.74,-449 127418,-447 127352.1,-440.32 122715.24,-437.21 122649,-437 121705.44,-434.01 121469.56,-431.77 120526,-428 118389.11,-419.47 117854.84,-426.74 115718,-410 114183.69,-397.98 112339.91,-372.14 111685.73,-362.62"/>
<polygon fill="black" stroke="black" points="111685.76,-359.12 111675.71,-362.47 111685.66,-366.12 111685.76,-359.12"/>
<text text-anchor="middle" x="122675" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2 -->
<g id="node327" class="node">
<title>layer_3_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="128572.99,-559 128124.4,-559 128009.01,-455 128457.6,-455 128572.99,-559"/>
<text text-anchor="middle" x="128291" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="128291" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="128291" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="128291" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_0 -->
<g id="edge613" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128059.31,-454.94C128039.32,-451.78 128019.35,-449.05 128000,-447 127899.45,-436.35 127191.11,-438.44 127090,-437 126860.21,-433.74 126802.79,-431.25 126573,-428 125838.81,-417.61 125655.22,-418.25 124921,-410 123335.73,-392.18 121429.35,-369.75 120763.04,-361.89"/>
<polygon fill="black" stroke="black" points="120762.88,-358.38 120752.84,-361.77 120762.79,-365.38 120762.88,-358.38"/>
<text text-anchor="middle" x="127116" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_1 -->
<g id="edge614" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128060.52,-454.97C128040.13,-451.76 128019.74,-449.02 128000,-447 127840.94,-430.76 125281.81,-441.94 125122,-437 125053.47,-434.88 125036.53,-430.13 124968,-428 124440.92,-411.61 120749.32,-414.2 120222,-410 118716.12,-398.02 116907.17,-372.26 116259.99,-362.68"/>
<polygon fill="black" stroke="black" points="116259.65,-359.18 116249.6,-362.53 116259.55,-366.18 116259.65,-359.18"/>
<text text-anchor="middle" x="125148" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_2 -->
<g id="edge615" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128247.28,-455C128237.14,-443.16 128226.26,-430.47 128215.83,-418.31"/>
<polygon fill="black" stroke="black" points="128218.23,-415.72 128209.06,-410.41 128212.92,-420.28 128218.23,-415.72"/>
<text text-anchor="middle" x="128257" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_3 -->
<g id="edge616" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128054.06,-454.94C128035.82,-451.93 128017.64,-449.23 128000,-447 127914.35,-436.17 127892.19,-442.09 127806,-437 127745.97,-433.45 127731.07,-430.85 127671,-428 126863.01,-389.72 125904.24,-370.27 125462.78,-362.77"/>
<polygon fill="black" stroke="black" points="125462.83,-359.27 125452.77,-362.6 125462.71,-366.27 125462.83,-359.27"/>
<text text-anchor="middle" x="127832" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_4 -->
<g id="edge617" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128469.16,-465.1C128506.27,-457.92 128545.27,-451.37 128582,-447 128702.12,-432.71 128733.12,-441.71 128854,-437 128951.34,-433.21 128975.64,-431.24 129073,-428 129987.71,-397.54 131076.75,-373.49 131545.5,-363.73"/>
<polygon fill="black" stroke="black" points="131545.85,-367.22 131555.78,-363.52 131545.71,-360.22 131545.85,-367.22"/>
<text text-anchor="middle" x="129099" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_5 -->
<g id="edge618" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128468.28,-464.26C128505.63,-457.1 128544.95,-450.76 128582,-447 128705.31,-434.49 132920.07,-438.59 133044,-437 134207.16,-422.06 135598.64,-382.37 136139.82,-366.11"/>
<polygon fill="black" stroke="black" points="136140.2,-369.6 136150.09,-365.8 136139.99,-362.6 136140.2,-369.6"/>
<text text-anchor="middle" x="133614" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_6 -->
<g id="edge619" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128468.27,-464.23C128505.63,-457.07 128544.94,-450.74 128582,-447 128686.25,-436.47 136021.23,-438.06 136126,-437 136337.58,-434.86 136390.44,-431.84 136602,-428 138021.76,-402.25 139726.95,-373.3 140340.69,-362.94"/>
<polygon fill="black" stroke="black" points="140341.04,-366.44 140350.98,-362.77 140340.92,-359.44 140341.04,-366.44"/>
<text text-anchor="middle" x="136628" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_7 -->
<g id="edge620" class="edge">
<title>layer_3_gate_tp_2&#45;&gt;layer_3_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128060.92,-455C128040.4,-451.77 128019.87,-449.01 128000,-447 127857.76,-432.59 122995.91,-441.37 122853,-437 122785.36,-434.93 122768.64,-430.09 122701,-428 121925.48,-404.06 116493.87,-415.63 115718,-410 114183.69,-398.87 112339.9,-372.48 111685.73,-362.72"/>
<polygon fill="black" stroke="black" points="111685.76,-359.22 111675.71,-362.57 111685.65,-366.22 111685.76,-359.22"/>
<text text-anchor="middle" x="122879" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3 -->
<g id="node328" class="node">
<title>layer_3_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="129154.99,-559 128706.4,-559 128591.01,-455 129039.6,-455 129154.99,-559"/>
<text text-anchor="middle" x="128873" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="128873" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="128873" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="128873" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_0 -->
<g id="edge621" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128641.71,-454.96C128621.59,-451.78 128601.48,-449.04 128582,-447 128456.02,-433.8 127568.65,-439.45 127442,-437 127308.63,-434.41 127275.37,-430.54 127142,-428 126155.04,-409.2 125908.1,-419.72 124921,-410 123335.95,-394.4 121429.91,-370.6 120763.34,-362.13"/>
<polygon fill="black" stroke="black" points="120763.17,-358.63 120753.13,-362 120763.08,-365.63 120763.17,-358.63"/>
<text text-anchor="middle" x="127468" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_1 -->
<g id="edge622" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128642.52,-454.96C128622.13,-451.75 128601.74,-449.01 128582,-447 128493.02,-437.93 125451.42,-439.28 125362,-437 125278.38,-434.87 125257.62,-430.15 125174,-428 124073.91,-399.68 121322.42,-418.67 120222,-410 118716.12,-398.14 116907.17,-372.3 116259.99,-362.7"/>
<polygon fill="black" stroke="black" points="116259.65,-359.19 116249.6,-362.54 116259.55,-366.19 116259.65,-359.19"/>
<text text-anchor="middle" x="125388" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_2 -->
<g id="edge623" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128627.36,-455C128560.56,-441.13 128488.05,-426.07 128420.7,-412.09"/>
<polygon fill="black" stroke="black" points="128421.3,-408.64 128410.8,-410.04 128419.88,-415.5 128421.3,-408.64"/>
<text text-anchor="middle" x="128566" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_3 -->
<g id="edge624" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128640.9,-454.98C128621.05,-451.82 128601.22,-449.08 128582,-447 128441.25,-431.76 128086.32,-445.4 127945,-437 127906.2,-434.69 127896.79,-430.51 127858,-428 126975.18,-370.89 125923.4,-360.67 125458.87,-359.1"/>
<polygon fill="black" stroke="black" points="125458.7,-355.6 125448.69,-359.07 125458.68,-362.6 125458.7,-355.6"/>
<text text-anchor="middle" x="127971" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_4 -->
<g id="edge625" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M129041.12,-456.27C129086.16,-444.92 129135.1,-434.34 129181,-428 129632.1,-365.68 130987.05,-358.74 131540.04,-358.59"/>
<polygon fill="black" stroke="black" points="131540.13,-362.09 131550.13,-358.59 131540.13,-355.09 131540.13,-362.09"/>
<text text-anchor="middle" x="129207" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_5 -->
<g id="edge626" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M129091.31,-501.53C129655.91,-490.17 131210.73,-460.17 132506,-447 133048.64,-441.48 134405.56,-452.97 134948,-437 135373.38,-424.48 135869.52,-393.57 136149.31,-374.64"/>
<polygon fill="black" stroke="black" points="136149.84,-378.11 136159.58,-373.94 136149.37,-371.13 136149.84,-378.11"/>
<text text-anchor="middle" x="135207" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_6 -->
<g id="edge627" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M129091.3,-501.4C129655.91,-489.74 131210.72,-459.08 132506,-447 134351.26,-429.8 134812.78,-457.59 136658,-437 136750.43,-435.97 139511.65,-380.42 140341.43,-363.71"/>
<polygon fill="black" stroke="black" points="140341.78,-367.2 140351.7,-363.5 140341.63,-360.2 140341.78,-367.2"/>
<text text-anchor="middle" x="137133" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_7 -->
<g id="edge628" class="edge">
<title>layer_3_gate_tp_3&#45;&gt;layer_3_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128642.92,-455C128622.4,-451.77 128601.87,-449.01 128582,-447 128512.72,-439.98 123637.64,-437.54 123568,-437 123273.32,-434.71 123199.68,-430.37 122905,-428 119710.87,-402.32 118912.15,-433.04 115718,-410 114183.69,-398.93 112339.9,-372.51 111685.73,-362.72"/>
<polygon fill="black" stroke="black" points="111685.76,-359.22 111675.71,-362.57 111685.65,-366.22 111685.76,-359.22"/>
<text text-anchor="middle" x="123594" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_3_expert_0_ep_0 -->
<g id="node337" class="node">
<title>layer_3_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="117694.83,-269 117260.82,-269 117149.17,-165 117583.18,-165 117694.83,-269"/>
<text text-anchor="middle" x="117422" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="117422" y="-220" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="117422" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="117422" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_0_ep_0 -->
<g id="edge629" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M120285.21,-354.16C119707.12,-346.43 118220.66,-321.99 117704.23,-269.08"/>
<polygon fill="black" stroke="black" points="117704.39,-265.58 117694.08,-268.02 117703.66,-272.54 117704.39,-265.58"/>
</g>
<!-- layer_3_expert_1_ep_0 -->
<g id="node338" class="node">
<title>layer_3_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="118257.83,-269 117823.82,-269 117712.17,-165 118146.18,-165 118257.83,-269"/>
<text text-anchor="middle" x="117985" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="117985" y="-220" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="117985" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="117985" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_1_ep_0 -->
<g id="edge630" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M120282.37,-351.97C119790.27,-340.83 118669.66,-311.72 118266.68,-269.02"/>
<polygon fill="black" stroke="black" points="118267.03,-265.54 118256.71,-267.95 118266.28,-272.5 118267.03,-265.54"/>
</g>
<!-- layer_3_expert_2_ep_0 -->
<g id="node339" class="node">
<title>layer_3_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="118820.83,-269 118386.82,-269 118275.17,-165 118709.18,-165 118820.83,-269"/>
<text text-anchor="middle" x="118548" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="118548" y="-220" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="118548" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="118548" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_2_ep_0 -->
<g id="edge631" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M120285.16,-354.23C119960.36,-348.26 119354.39,-329.44 118829.76,-269.05"/>
<polygon fill="black" stroke="black" points="118830.05,-265.56 118819.72,-267.89 118829.25,-272.51 118830.05,-265.56"/>
</g>
<!-- layer_3_expert_3_ep_0 -->
<g id="node340" class="node">
<title>layer_3_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="119383.83,-269 118949.82,-269 118838.17,-165 119272.18,-165 119383.83,-269"/>
<text text-anchor="middle" x="119111" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="119111" y="-220" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="119111" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="119111" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_3_ep_0 -->
<g id="edge632" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M120274.79,-345.11C120048.47,-332.41 119702.42,-308.72 119392.8,-269.07"/>
<polygon fill="black" stroke="black" points="119393.1,-265.58 119382.73,-267.77 119392.2,-272.52 119393.1,-265.58"/>
</g>
<!-- layer_3_expert_4_ep_0 -->
<g id="node341" class="node">
<title>layer_3_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="119946.83,-269 119512.82,-269 119401.17,-165 119835.18,-165 119946.83,-269"/>
<text text-anchor="middle" x="119674" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="119674" y="-220" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="119674" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="119674" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_4_ep_0 -->
<g id="edge633" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M120240.52,-314.95C120149.44,-300.82 120047.83,-284.66 119955,-269 119954.9,-268.98 119954.79,-268.97 119954.69,-268.95"/>
<polygon fill="black" stroke="black" points="119955.48,-265.53 119945.04,-267.31 119954.31,-272.43 119955.48,-265.53"/>
</g>
<!-- layer_3_expert_5_ep_0 -->
<g id="node342" class="node">
<title>layer_3_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="120509.83,-269 120075.82,-269 119964.17,-165 120398.18,-165 120509.83,-269"/>
<text text-anchor="middle" x="120237" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="120237" y="-220" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="120237" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="120237" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_5_ep_0 -->
<g id="edge634" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M120415.19,-305.83C120393.9,-295.34 120371.38,-284.24 120349.78,-273.59"/>
<polygon fill="black" stroke="black" points="120351.1,-270.34 120340.59,-269.06 120348.01,-276.62 120351.1,-270.34"/>
</g>
<!-- layer_3_expert_6_ep_0 -->
<g id="node343" class="node">
<title>layer_3_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="121072.83,-269 120638.82,-269 120527.17,-165 120961.18,-165 121072.83,-269"/>
<text text-anchor="middle" x="120800" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="120800" y="-220" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="120800" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="120800" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_6_ep_0 -->
<g id="edge635" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M120622.44,-305.83C120643.66,-295.34 120666.1,-284.24 120687.62,-273.59"/>
<polygon fill="black" stroke="black" points="120689.37,-276.63 120696.78,-269.06 120686.27,-270.35 120689.37,-276.63"/>
</g>
<!-- layer_3_expert_7_ep_0 -->
<g id="node344" class="node">
<title>layer_3_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="121635.83,-269 121201.82,-269 121090.17,-165 121524.18,-165 121635.83,-269"/>
<text text-anchor="middle" x="121363" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="121363" y="-220" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="121363" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="121363" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_0&#45;&gt;layer_3_expert_7_ep_0 -->
<g id="edge636" class="edge">
<title>layer_3_route_ep_0&#45;&gt;layer_3_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M120714.28,-327.68C120822.7,-311.1 120959.94,-289.61 121082,-269 121111.45,-264.03 121142.59,-258.57 121173.01,-253.13"/>
<polygon fill="black" stroke="black" points="121173.63,-256.58 121182.85,-251.37 121172.39,-249.69 121173.63,-256.58"/>
</g>
<!-- layer_3_expert_0_ep_1 -->
<g id="node345" class="node">
<title>layer_3_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="113190.83,-269 112756.82,-269 112645.17,-165 113079.18,-165 113190.83,-269"/>
<text text-anchor="middle" x="112918" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="112918" y="-220" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="112918" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="112918" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_0_ep_1 -->
<g id="edge637" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M115781.21,-354.16C115203.12,-346.43 113716.66,-321.99 113200.23,-269.08"/>
<polygon fill="black" stroke="black" points="113200.39,-265.58 113190.08,-268.02 113199.66,-272.54 113200.39,-265.58"/>
</g>
<!-- layer_3_expert_1_ep_1 -->
<g id="node346" class="node">
<title>layer_3_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="113753.83,-269 113319.82,-269 113208.17,-165 113642.18,-165 113753.83,-269"/>
<text text-anchor="middle" x="113481" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="113481" y="-220" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="113481" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="113481" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_1_ep_1 -->
<g id="edge638" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M115778.37,-351.97C115286.27,-340.83 114165.66,-311.72 113762.68,-269.02"/>
<polygon fill="black" stroke="black" points="113763.03,-265.54 113752.71,-267.95 113762.28,-272.5 113763.03,-265.54"/>
</g>
<!-- layer_3_expert_2_ep_1 -->
<g id="node347" class="node">
<title>layer_3_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="114316.83,-269 113882.82,-269 113771.17,-165 114205.18,-165 114316.83,-269"/>
<text text-anchor="middle" x="114044" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="114044" y="-220" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="114044" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="114044" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_2_ep_1 -->
<g id="edge639" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M115781.16,-354.23C115456.36,-348.26 114850.39,-329.44 114325.76,-269.05"/>
<polygon fill="black" stroke="black" points="114326.05,-265.56 114315.72,-267.89 114325.25,-272.51 114326.05,-265.56"/>
</g>
<!-- layer_3_expert_3_ep_1 -->
<g id="node348" class="node">
<title>layer_3_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="114879.83,-269 114445.82,-269 114334.17,-165 114768.18,-165 114879.83,-269"/>
<text text-anchor="middle" x="114607" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="114607" y="-220" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="114607" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="114607" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_3_ep_1 -->
<g id="edge640" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M115770.79,-345.11C115544.47,-332.41 115198.42,-308.72 114888.8,-269.07"/>
<polygon fill="black" stroke="black" points="114889.1,-265.58 114878.73,-267.77 114888.2,-272.52 114889.1,-265.58"/>
</g>
<!-- layer_3_expert_4_ep_1 -->
<g id="node349" class="node">
<title>layer_3_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="115442.83,-269 115008.82,-269 114897.17,-165 115331.18,-165 115442.83,-269"/>
<text text-anchor="middle" x="115170" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="115170" y="-220" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="115170" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="115170" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_4_ep_1 -->
<g id="edge641" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M115736.52,-314.95C115645.44,-300.82 115543.83,-284.66 115451,-269 115450.9,-268.98 115450.79,-268.97 115450.69,-268.95"/>
<polygon fill="black" stroke="black" points="115451.48,-265.53 115441.04,-267.31 115450.31,-272.43 115451.48,-265.53"/>
</g>
<!-- layer_3_expert_5_ep_1 -->
<g id="node350" class="node">
<title>layer_3_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="116005.83,-269 115571.82,-269 115460.17,-165 115894.18,-165 116005.83,-269"/>
<text text-anchor="middle" x="115733" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="115733" y="-220" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="115733" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="115733" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_5_ep_1 -->
<g id="edge642" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M115911.19,-305.83C115889.9,-295.34 115867.38,-284.24 115845.78,-273.59"/>
<polygon fill="black" stroke="black" points="115847.1,-270.34 115836.59,-269.06 115844.01,-276.62 115847.1,-270.34"/>
</g>
<!-- layer_3_expert_6_ep_1 -->
<g id="node351" class="node">
<title>layer_3_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="116568.83,-269 116134.82,-269 116023.17,-165 116457.18,-165 116568.83,-269"/>
<text text-anchor="middle" x="116296" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="116296" y="-220" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="116296" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="116296" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_6_ep_1 -->
<g id="edge643" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M116118.44,-305.83C116139.66,-295.34 116162.1,-284.24 116183.62,-273.59"/>
<polygon fill="black" stroke="black" points="116185.37,-276.63 116192.78,-269.06 116182.27,-270.35 116185.37,-276.63"/>
</g>
<!-- layer_3_expert_7_ep_1 -->
<g id="node352" class="node">
<title>layer_3_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="117131.83,-269 116697.82,-269 116586.17,-165 117020.18,-165 117131.83,-269"/>
<text text-anchor="middle" x="116859" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="116859" y="-220" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="116859" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="116859" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_1&#45;&gt;layer_3_expert_7_ep_1 -->
<g id="edge644" class="edge">
<title>layer_3_route_ep_1&#45;&gt;layer_3_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M116210.28,-327.68C116318.7,-311.1 116455.94,-289.61 116578,-269 116607.45,-264.03 116638.59,-258.57 116669.01,-253.13"/>
<polygon fill="black" stroke="black" points="116669.63,-256.58 116678.85,-251.37 116668.39,-249.69 116669.63,-256.58"/>
</g>
<!-- layer_3_expert_0_ep_2 -->
<g id="node353" class="node">
<title>layer_3_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="126702.83,-269 126268.82,-269 126157.17,-165 126591.18,-165 126702.83,-269"/>
<text text-anchor="middle" x="126430" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="126430" y="-220" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="126430" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="126430" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_0_ep_2 -->
<g id="edge645" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M127927.8,-351.31C127641.58,-342.47 127145.8,-320.82 126711.96,-269.08"/>
<polygon fill="black" stroke="black" points="126712.07,-265.57 126701.72,-267.85 126711.23,-272.52 126712.07,-265.57"/>
</g>
<!-- layer_3_expert_1_ep_2 -->
<g id="node354" class="node">
<title>layer_3_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="127265.83,-269 126831.82,-269 126720.17,-165 127154.18,-165 127265.83,-269"/>
<text text-anchor="middle" x="126993" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="126993" y="-220" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="126993" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="126993" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_1_ep_2 -->
<g id="edge646" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M127912.32,-337.54C127736.29,-322.66 127495.96,-299.72 127274.56,-269.05"/>
<polygon fill="black" stroke="black" points="127274.76,-265.54 127264.37,-267.63 127273.79,-272.48 127274.76,-265.54"/>
</g>
<!-- layer_3_expert_2_ep_2 -->
<g id="node355" class="node">
<title>layer_3_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="127828.83,-269 127394.82,-269 127283.17,-165 127717.18,-165 127828.83,-269"/>
<text text-anchor="middle" x="127556" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="127556" y="-220" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="127556" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="127556" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_2_ep_2 -->
<g id="edge647" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M127941.26,-305.93C127891.79,-294.64 127839.26,-282.65 127789.42,-271.28"/>
<polygon fill="black" stroke="black" points="127790.02,-267.82 127779.49,-269.01 127788.46,-274.65 127790.02,-267.82"/>
</g>
<!-- layer_3_expert_3_ep_2 -->
<g id="node356" class="node">
<title>layer_3_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="128391.83,-269 127957.82,-269 127846.17,-165 128280.18,-165 128391.83,-269"/>
<text text-anchor="middle" x="128119" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="128119" y="-220" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="128119" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="128119" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_3_ep_2 -->
<g id="edge648" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M128148,-305.64C128145.11,-296.89 128142.08,-287.73 128139.11,-278.77"/>
<polygon fill="black" stroke="black" points="128142.39,-277.55 128135.93,-269.15 128135.75,-279.75 128142.39,-277.55"/>
</g>
<!-- layer_3_expert_4_ep_2 -->
<g id="node357" class="node">
<title>layer_3_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="128954.83,-269 128520.82,-269 128409.17,-165 128843.18,-165 128954.83,-269"/>
<text text-anchor="middle" x="128682" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="128682" y="-220" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="128682" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="128682" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_4_ep_2 -->
<g id="edge649" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M128340.03,-309.94C128392.98,-295.71 128451.16,-280.06 128504.29,-265.78"/>
<polygon fill="black" stroke="black" points="128505.4,-269.11 128514.14,-263.13 128503.58,-262.35 128505.4,-269.11"/>
</g>
<!-- layer_3_expert_5_ep_2 -->
<g id="node358" class="node">
<title>layer_3_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="129517.83,-269 129083.82,-269 128972.17,-165 129406.18,-165 129517.83,-269"/>
<text text-anchor="middle" x="129245" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="129245" y="-220" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="129245" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="129245" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_5_ep_2 -->
<g id="edge650" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M128372.02,-338.2C128533.63,-322.56 128763.59,-298.19 128964,-269 128993.77,-264.66 129025.22,-259.52 129055.88,-254.19"/>
<polygon fill="black" stroke="black" points="129056.55,-257.62 129065.8,-252.45 129055.34,-250.73 129056.55,-257.62"/>
</g>
<!-- layer_3_expert_6_ep_2 -->
<g id="node359" class="node">
<title>layer_3_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="130080.83,-269 129646.82,-269 129535.17,-165 129969.18,-165 130080.83,-269"/>
<text text-anchor="middle" x="129808" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="129808" y="-220" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="129808" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="129808" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_6_ep_2 -->
<g id="edge651" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M128386,-350.53C128656.03,-340.83 129126.44,-318.12 129527,-269 129557.2,-265.3 129589.06,-260.44 129620.06,-255.19"/>
<polygon fill="black" stroke="black" points="129620.82,-258.61 129630.09,-253.48 129619.64,-251.71 129620.82,-258.61"/>
</g>
<!-- layer_3_expert_7_ep_2 -->
<g id="node360" class="node">
<title>layer_3_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="130643.83,-269 130209.82,-269 130098.17,-165 130532.18,-165 130643.83,-269"/>
<text text-anchor="middle" x="130371" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="130371" y="-220" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="130371" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="130371" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_2&#45;&gt;layer_3_expert_7_ep_2 -->
<g id="edge652" class="edge">
<title>layer_3_route_ep_2&#45;&gt;layer_3_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M128392.85,-356.43C128753.94,-353.32 129479.37,-338.06 130090,-269 130120.34,-265.57 130152.35,-260.84 130183.46,-255.63"/>
<polygon fill="black" stroke="black" points="130184.25,-259.04 130193.53,-253.92 130183.08,-252.14 130184.25,-259.04"/>
</g>
<!-- layer_3_expert_0_ep_3 -->
<g id="node361" class="node">
<title>layer_3_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="122198.83,-269 121764.82,-269 121653.17,-165 122087.18,-165 122198.83,-269"/>
<text text-anchor="middle" x="121926" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="121926" y="-220" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="121926" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="121926" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_0_ep_3 -->
<g id="edge653" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M124984.6,-354.72C124378.55,-348.07 122764.05,-325.55 122208.2,-269.07"/>
<polygon fill="black" stroke="black" points="122208.39,-265.58 122198.08,-268.03 122207.67,-272.54 122208.39,-265.58"/>
</g>
<!-- layer_3_expert_1_ep_3 -->
<g id="node362" class="node">
<title>layer_3_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="122761.83,-269 122327.82,-269 122216.17,-165 122650.18,-165 122761.83,-269"/>
<text text-anchor="middle" x="122489" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="122489" y="-220" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="122489" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="122489" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_1_ep_3 -->
<g id="edge654" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M124982.48,-352.85C124459.4,-342.93 123212.92,-315.27 122771.05,-269.06"/>
<polygon fill="black" stroke="black" points="122771.4,-265.58 122761.08,-268 122770.66,-272.54 122771.4,-265.58"/>
</g>
<!-- layer_3_expert_2_ep_3 -->
<g id="node363" class="node">
<title>layer_3_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="123324.83,-269 122890.82,-269 122779.17,-165 123213.18,-165 123324.83,-269"/>
<text text-anchor="middle" x="123052" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="123052" y="-220" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="123052" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="123052" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_2_ep_3 -->
<g id="edge655" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M124986.15,-356.07C124631.7,-352.43 123933.95,-336.54 123333.87,-269.06"/>
<polygon fill="black" stroke="black" points="123334.04,-265.56 123323.71,-267.91 123333.26,-272.51 123334.04,-265.56"/>
</g>
<!-- layer_3_expert_3_ep_3 -->
<g id="node364" class="node">
<title>layer_3_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="123887.83,-269 123453.82,-269 123342.17,-165 123776.18,-165 123887.83,-269"/>
<text text-anchor="middle" x="123615" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="123615" y="-220" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="123615" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="123615" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_3_ep_3 -->
<g id="edge656" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M124978.41,-349.2C124715.31,-338.76 124280.39,-315.97 123896.91,-269.08"/>
<polygon fill="black" stroke="black" points="123897.08,-265.57 123886.72,-267.82 123896.22,-272.52 123897.08,-265.57"/>
</g>
<!-- layer_3_expert_4_ep_3 -->
<g id="node365" class="node">
<title>layer_3_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="124450.83,-269 124016.82,-269 123905.17,-165 124339.18,-165 124450.83,-269"/>
<text text-anchor="middle" x="124178" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="124178" y="-220" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="124178" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="124178" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_4_ep_3 -->
<g id="edge657" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M124957.94,-331.02C124813.94,-315.61 124631.59,-294.41 124459.4,-269.04"/>
<polygon fill="black" stroke="black" points="124459.79,-265.56 124449.38,-267.55 124458.76,-272.48 124459.79,-265.56"/>
</g>
<!-- layer_3_expert_5_ep_3 -->
<g id="node366" class="node">
<title>layer_3_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="125013.83,-269 124579.82,-269 124468.17,-165 124902.18,-165 125013.83,-269"/>
<text text-anchor="middle" x="124741" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="124741" y="-220" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="124741" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="124741" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_5_ep_3 -->
<g id="edge658" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M125042.75,-305.93C125004.66,-294.83 124964.24,-283.05 124925.78,-271.85"/>
<polygon fill="black" stroke="black" points="124926.63,-268.45 124916.05,-269.01 124924.67,-275.17 124926.63,-268.45"/>
</g>
<!-- layer_3_expert_6_ep_3 -->
<g id="node367" class="node">
<title>layer_3_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="125576.83,-269 125142.82,-269 125031.17,-165 125465.18,-165 125576.83,-269"/>
<text text-anchor="middle" x="125304" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="125304" y="-220" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="125304" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="125304" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_6_ep_3 -->
<g id="edge659" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M125249.78,-305.64C125255.36,-296.61 125261.22,-287.15 125266.93,-277.91"/>
<polygon fill="black" stroke="black" points="125270.07,-279.5 125272.35,-269.15 125264.11,-275.81 125270.07,-279.5"/>
</g>
<!-- layer_3_expert_7_ep_3 -->
<g id="node368" class="node">
<title>layer_3_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="126139.83,-269 125705.82,-269 125594.17,-165 126028.18,-165 126139.83,-269"/>
<text text-anchor="middle" x="125867" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="125867" y="-220" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="125867" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="125867" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_3&#45;&gt;layer_3_expert_7_ep_3 -->
<g id="edge660" class="edge">
<title>layer_3_route_ep_3&#45;&gt;layer_3_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M125401.81,-317.63C125489.32,-298.89 125593.76,-276.52 125681.5,-257.73"/>
<polygon fill="black" stroke="black" points="125682.24,-261.15 125691.29,-255.63 125680.78,-254.3 125682.24,-261.15"/>
</g>
<!-- layer_3_expert_0_ep_4 -->
<g id="node369" class="node">
<title>layer_3_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="131206.83,-269 130772.82,-269 130661.17,-165 131095.18,-165 131206.83,-269"/>
<text text-anchor="middle" x="130934" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="130934" y="-220" font-family="Arial" font-size="10.00">GPU: 64</text>
<text text-anchor="middle" x="130934" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="130934" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_0_ep_4 -->
<g id="edge661" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M131500.52,-314.95C131409.44,-300.82 131307.83,-284.66 131215,-269 131214.9,-268.98 131214.79,-268.97 131214.69,-268.95"/>
<polygon fill="black" stroke="black" points="131215.48,-265.53 131205.04,-267.31 131214.31,-272.43 131215.48,-265.53"/>
</g>
<!-- layer_3_expert_1_ep_4 -->
<g id="node370" class="node">
<title>layer_3_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="131769.83,-269 131335.82,-269 131224.17,-165 131658.18,-165 131769.83,-269"/>
<text text-anchor="middle" x="131497" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="131497" y="-220" font-family="Arial" font-size="10.00">GPU: 65</text>
<text text-anchor="middle" x="131497" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="131497" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_1_ep_4 -->
<g id="edge662" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M131675.19,-305.83C131653.9,-295.34 131631.38,-284.24 131609.78,-273.59"/>
<polygon fill="black" stroke="black" points="131611.1,-270.34 131600.59,-269.06 131608.01,-276.62 131611.1,-270.34"/>
</g>
<!-- layer_3_expert_2_ep_4 -->
<g id="node371" class="node">
<title>layer_3_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="132332.83,-269 131898.82,-269 131787.17,-165 132221.18,-165 132332.83,-269"/>
<text text-anchor="middle" x="132060" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="132060" y="-220" font-family="Arial" font-size="10.00">GPU: 66</text>
<text text-anchor="middle" x="132060" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="132060" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_2_ep_4 -->
<g id="edge663" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M131882.44,-305.83C131903.66,-295.34 131926.1,-284.24 131947.62,-273.59"/>
<polygon fill="black" stroke="black" points="131949.37,-276.63 131956.78,-269.06 131946.27,-270.35 131949.37,-276.63"/>
</g>
<!-- layer_3_expert_3_ep_4 -->
<g id="node372" class="node">
<title>layer_3_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="132895.83,-269 132461.82,-269 132350.17,-165 132784.18,-165 132895.83,-269"/>
<text text-anchor="middle" x="132623" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="132623" y="-220" font-family="Arial" font-size="10.00">GPU: 67</text>
<text text-anchor="middle" x="132623" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="132623" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_3_ep_4 -->
<g id="edge664" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M131974.28,-327.68C132082.7,-311.1 132219.94,-289.61 132342,-269 132371.45,-264.03 132402.59,-258.57 132433.01,-253.13"/>
<polygon fill="black" stroke="black" points="132433.63,-256.58 132442.85,-251.37 132432.39,-249.69 132433.63,-256.58"/>
</g>
<!-- layer_3_expert_4_ep_4 -->
<g id="node373" class="node">
<title>layer_3_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="133458.83,-269 133024.82,-269 132913.17,-165 133347.18,-165 133458.83,-269"/>
<text text-anchor="middle" x="133186" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="133186" y="-220" font-family="Arial" font-size="10.00">GPU: 68</text>
<text text-anchor="middle" x="133186" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="133186" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_4_ep_4 -->
<g id="edge665" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M131995.53,-346.62C132222.75,-334.2 132589.98,-309.79 132905,-269 132935.06,-265.11 132966.79,-260.17 132997.67,-254.9"/>
<polygon fill="black" stroke="black" points="132998.41,-258.32 133007.67,-253.18 132997.22,-251.42 132998.41,-258.32"/>
</g>
<!-- layer_3_expert_5_ep_4 -->
<g id="node374" class="node">
<title>layer_3_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="134021.83,-269 133587.82,-269 133476.17,-165 133910.18,-165 134021.83,-269"/>
<text text-anchor="middle" x="133749" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="133749" y="-220" font-family="Arial" font-size="10.00">GPU: 69</text>
<text text-anchor="middle" x="133749" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="133749" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_5_ep_4 -->
<g id="edge666" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M132004.47,-354.37C132329.04,-348.53 132946.29,-329.68 133468,-269 133498.22,-265.48 133530.1,-260.73 133561.1,-255.52"/>
<polygon fill="black" stroke="black" points="133561.86,-258.94 133571.13,-253.81 133560.69,-252.04 133561.86,-258.94"/>
</g>
<!-- layer_3_expert_6_ep_4 -->
<g id="node375" class="node">
<title>layer_3_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="134584.83,-269 134150.82,-269 134039.17,-165 134473.18,-165 134584.83,-269"/>
<text text-anchor="middle" x="134312" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="134312" y="-220" font-family="Arial" font-size="10.00">GPU: 70</text>
<text text-anchor="middle" x="134312" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="134312" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_6_ep_4 -->
<g id="edge667" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M132002.05,-352.27C132490.66,-341.27 133642.79,-311.6 134031,-269 134061.35,-265.67 134093.36,-260.99 134124.48,-255.8"/>
<polygon fill="black" stroke="black" points="134125.27,-259.22 134134.55,-254.1 134124.1,-252.32 134125.27,-259.22"/>
</g>
<!-- layer_3_expert_7_ep_4 -->
<g id="node376" class="node">
<title>layer_3_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="135147.83,-269 134713.82,-269 134602.17,-165 135036.18,-165 135147.83,-269"/>
<text text-anchor="middle" x="134875" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="134875" y="-220" font-family="Arial" font-size="10.00">GPU: 71</text>
<text text-anchor="middle" x="134875" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="134875" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_4&#45;&gt;layer_3_expert_7_ep_4 -->
<g id="edge668" class="edge">
<title>layer_3_route_ep_4&#45;&gt;layer_3_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M132004.24,-354.27C132579.73,-346.61 134093.86,-321.91 134594,-269 134624.48,-265.78 134656.62,-261.14 134687.84,-255.95"/>
<polygon fill="black" stroke="black" points="134688.67,-259.36 134697.95,-254.25 134687.5,-252.46 134688.67,-259.36"/>
</g>
<!-- layer_3_expert_0_ep_5 -->
<g id="node377" class="node">
<title>layer_3_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="135710.83,-269 135276.82,-269 135165.17,-165 135599.18,-165 135710.83,-269"/>
<text text-anchor="middle" x="135438" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="135438" y="-220" font-family="Arial" font-size="10.00">GPU: 80</text>
<text text-anchor="middle" x="135438" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="135438" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_0_ep_5 -->
<g id="edge669" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M136102.15,-323.5C135987.26,-308.48 135851.46,-289.81 135719.31,-269.03"/>
<polygon fill="black" stroke="black" points="135719.82,-265.57 135709.39,-267.47 135718.73,-272.48 135719.82,-265.57"/>
</g>
<!-- layer_3_expert_1_ep_5 -->
<g id="node378" class="node">
<title>layer_3_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="136273.83,-269 135839.82,-269 135728.17,-165 136162.18,-165 136273.83,-269"/>
<text text-anchor="middle" x="136001" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="136001" y="-220" font-family="Arial" font-size="10.00">GPU: 81</text>
<text text-anchor="middle" x="136001" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="136001" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_1_ep_5 -->
<g id="edge670" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M136235.06,-305.93C136206.14,-295.07 136175.49,-283.55 136146.23,-272.56"/>
<polygon fill="black" stroke="black" points="136147.38,-269.25 136136.78,-269.01 136144.91,-275.8 136147.38,-269.25"/>
</g>
<!-- layer_3_expert_2_ep_5 -->
<g id="node379" class="node">
<title>layer_3_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="136836.83,-269 136402.82,-269 136291.17,-165 136725.18,-165 136836.83,-269"/>
<text text-anchor="middle" x="136564" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="136564" y="-220" font-family="Arial" font-size="10.00">GPU: 82</text>
<text text-anchor="middle" x="136564" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="136564" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_2_ep_5 -->
<g id="edge671" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M136442.04,-305.83C136455.97,-295.8 136470.66,-285.23 136484.83,-275.02"/>
<polygon fill="black" stroke="black" points="136487.04,-277.74 136493.11,-269.06 136482.95,-272.06 136487.04,-277.74"/>
</g>
<!-- layer_3_expert_3_ep_5 -->
<g id="node380" class="node">
<title>layer_3_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="137399.83,-269 136965.82,-269 136854.17,-165 137288.18,-165 137399.83,-269"/>
<text text-anchor="middle" x="137127" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="137127" y="-220" font-family="Arial" font-size="10.00">GPU: 83</text>
<text text-anchor="middle" x="137127" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="137127" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_3_ep_5 -->
<g id="edge672" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M136560.31,-322.19C136675.16,-301.08 136821.27,-274.21 136936.36,-253.05"/>
<polygon fill="black" stroke="black" points="136937.14,-256.47 136946.34,-251.22 136935.87,-249.58 136937.14,-256.47"/>
</g>
<!-- layer_3_expert_4_ep_5 -->
<g id="node381" class="node">
<title>layer_3_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="137962.83,-269 137528.82,-269 137417.17,-165 137851.18,-165 137962.83,-269"/>
<text text-anchor="middle" x="137690" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="137690" y="-220" font-family="Arial" font-size="10.00">GPU: 84</text>
<text text-anchor="middle" x="137690" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="137690" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_4_ep_5 -->
<g id="edge673" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M136585.85,-344.76C136796.21,-331.37 137125.51,-306.66 137409,-269 137438.94,-265.02 137470.53,-260.05 137501.31,-254.78"/>
<polygon fill="black" stroke="black" points="137502.01,-258.22 137511.27,-253.06 137500.82,-251.32 137502.01,-258.22"/>
</g>
<!-- layer_3_expert_5_ep_5 -->
<g id="node382" class="node">
<title>layer_3_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="138525.83,-269 138091.82,-269 137980.17,-165 138414.18,-165 138525.83,-269"/>
<text text-anchor="middle" x="138253" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="138253" y="-220" font-family="Arial" font-size="10.00">GPU: 85</text>
<text text-anchor="middle" x="138253" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="138253" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_5_ep_5 -->
<g id="edge674" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M136595.48,-353.47C136905.87,-346.59 137483.18,-326.57 137972,-269 138002.21,-265.44 138034.09,-260.66 138065.09,-255.44"/>
<polygon fill="black" stroke="black" points="138065.85,-258.87 138075.12,-253.74 138064.68,-251.96 138065.85,-258.87"/>
</g>
<!-- layer_3_expert_6_ep_5 -->
<g id="node383" class="node">
<title>layer_3_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="139088.83,-269 138654.82,-269 138543.17,-165 138977.18,-165 139088.83,-269"/>
<text text-anchor="middle" x="138816" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="138816" y="-220" font-family="Arial" font-size="10.00">GPU: 86</text>
<text text-anchor="middle" x="138816" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="138816" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_6_ep_5 -->
<g id="edge675" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M136593.78,-351.87C137068,-340.31 138164.19,-309.99 138535,-269 138565.35,-265.65 138597.36,-260.95 138628.47,-255.76"/>
<polygon fill="black" stroke="black" points="138629.27,-259.18 138638.54,-254.06 138628.1,-252.27 138629.27,-259.18"/>
</g>
<!-- layer_3_expert_7_ep_5 -->
<g id="node384" class="node">
<title>layer_3_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="139651.83,-269 139217.82,-269 139106.17,-165 139540.18,-165 139651.83,-269"/>
<text text-anchor="middle" x="139379" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="139379" y="-220" font-family="Arial" font-size="10.00">GPU: 87</text>
<text text-anchor="middle" x="139379" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="139379" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_5&#45;&gt;layer_3_expert_7_ep_5 -->
<g id="edge676" class="edge">
<title>layer_3_route_ep_5&#45;&gt;layer_3_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M136596.11,-354.01C137158.72,-345.85 138615.49,-320.29 139098,-269 139128.48,-265.76 139160.62,-261.11 139191.84,-255.92"/>
<polygon fill="black" stroke="black" points="139192.66,-259.34 139201.94,-254.22 139191.5,-252.43 139192.66,-259.34"/>
</g>
<!-- layer_3_expert_0_ep_6 -->
<g id="node385" class="node">
<title>layer_3_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="140214.83,-269 139780.82,-269 139669.17,-165 140103.18,-165 140214.83,-269"/>
<text text-anchor="middle" x="139942" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="139942" y="-220" font-family="Arial" font-size="10.00">GPU: 96</text>
<text text-anchor="middle" x="139942" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="139942" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_0_ep_6 -->
<g id="edge677" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M140342.44,-305.93C140290.92,-294.62 140236.2,-282.6 140184.3,-271.21"/>
<polygon fill="black" stroke="black" points="140184.82,-267.74 140174.3,-269.01 140183.32,-274.57 140184.82,-267.74"/>
</g>
<!-- layer_3_expert_1_ep_6 -->
<g id="node386" class="node">
<title>layer_3_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="140777.83,-269 140343.82,-269 140232.17,-165 140666.18,-165 140777.83,-269"/>
<text text-anchor="middle" x="140505" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="140505" y="-220" font-family="Arial" font-size="10.00">GPU: 97</text>
<text text-anchor="middle" x="140505" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="140505" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_1_ep_6 -->
<g id="edge678" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M140549.13,-305.64C140544.64,-296.7 140539.92,-287.34 140535.32,-278.2"/>
<polygon fill="black" stroke="black" points="140538.38,-276.51 140530.76,-269.15 140532.13,-279.66 140538.38,-276.51"/>
</g>
<!-- layer_3_expert_2_ep_6 -->
<g id="node387" class="node">
<title>layer_3_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="141340.83,-269 140906.82,-269 140795.17,-165 141229.18,-165 141340.83,-269"/>
<text text-anchor="middle" x="141068" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="141068" y="-220" font-family="Arial" font-size="10.00">GPU: 98</text>
<text text-anchor="middle" x="141068" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="141068" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_2_ep_6 -->
<g id="edge679" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M140748.12,-308.19C140794.84,-295.02 140845.43,-280.75 140892.3,-267.54"/>
<polygon fill="black" stroke="black" points="140893.25,-270.91 140901.92,-264.82 140891.35,-264.17 140893.25,-270.91"/>
</g>
<!-- layer_3_expert_3_ep_6 -->
<g id="node388" class="node">
<title>layer_3_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="141903.83,-269 141469.82,-269 141358.17,-165 141792.18,-165 141903.83,-269"/>
<text text-anchor="middle" x="141631" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="141631" y="-220" font-family="Arial" font-size="10.00">GPU: 99</text>
<text text-anchor="middle" x="141631" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="141631" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_3_ep_6 -->
<g id="edge680" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M140761.46,-320.13C140808.78,-311.81 140859.63,-303.74 140907,-298 141102.88,-274.26 141154.17,-293.1 141350,-269 141380.2,-265.28 141412.06,-260.42 141443.06,-255.17"/>
<polygon fill="black" stroke="black" points="141443.82,-258.59 141453.09,-253.45 141442.64,-251.69 141443.82,-258.59"/>
</g>
<!-- layer_3_expert_4_ep_6 -->
<g id="node389" class="node">
<title>layer_3_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="142466.83,-269 142032.82,-269 141921.17,-165 142355.18,-165 142466.83,-269"/>
<text text-anchor="middle" x="142194" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="142194" y="-220" font-family="Arial" font-size="10.00">GPU: 100</text>
<text text-anchor="middle" x="142194" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="142194" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_4_ep_6 -->
<g id="edge681" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M140760.45,-319.08C140808.02,-310.72 140859.25,-302.9 140907,-298 141129.48,-275.15 141690.56,-292.26 141913,-269 141943.48,-265.81 141975.62,-261.19 142006.85,-256.01"/>
<polygon fill="black" stroke="black" points="142007.67,-259.43 142016.95,-254.32 142006.51,-252.52 142007.67,-259.43"/>
</g>
<!-- layer_3_expert_5_ep_6 -->
<g id="node390" class="node">
<title>layer_3_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="143029.83,-269 142595.82,-269 142484.17,-165 142918.18,-165 143029.83,-269"/>
<text text-anchor="middle" x="142757" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="142757" y="-220" font-family="Arial" font-size="10.00">GPU: 101</text>
<text text-anchor="middle" x="142757" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="142757" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_5_ep_6 -->
<g id="edge682" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M140759.98,-318.81C140807.68,-310.43 140859.08,-302.67 140907,-298 141080.54,-281.08 142302.49,-286.24 142476,-269 142506.5,-265.97 142538.65,-261.43 142569.88,-256.29"/>
<polygon fill="black" stroke="black" points="142570.7,-259.7 142579.98,-254.6 142569.54,-252.79 142570.7,-259.7"/>
</g>
<!-- layer_3_expert_6_ep_6 -->
<g id="node391" class="node">
<title>layer_3_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="143592.83,-269 143158.82,-269 143047.17,-165 143481.18,-165 143592.83,-269"/>
<text text-anchor="middle" x="143320" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="143320" y="-220" font-family="Arial" font-size="10.00">GPU: 102</text>
<text text-anchor="middle" x="143320" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="143320" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_6_ep_6 -->
<g id="edge683" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M140759.96,-318.65C140807.66,-310.27 140859.07,-302.55 140907,-298 141024.92,-286.79 142921.1,-280.42 143039,-269 143069.62,-266.03 143101.89,-261.51 143133.23,-256.36"/>
<polygon fill="black" stroke="black" points="143134.08,-259.77 143143.37,-254.67 143132.93,-252.86 143134.08,-259.77"/>
</g>
<!-- layer_3_expert_7_ep_6 -->
<g id="node392" class="node">
<title>layer_3_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="144155.83,-269 143721.82,-269 143610.17,-165 144044.18,-165 144155.83,-269"/>
<text text-anchor="middle" x="143883" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="143883" y="-220" font-family="Arial" font-size="10.00">GPU: 103</text>
<text text-anchor="middle" x="143883" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="143883" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_6&#45;&gt;layer_3_expert_7_ep_6 -->
<g id="edge684" class="edge">
<title>layer_3_route_ep_6&#45;&gt;layer_3_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M140759.96,-318.56C140807.65,-310.18 140859.06,-302.49 140907,-298 141056.08,-284.05 143452.95,-283.23 143602,-269 143632.62,-266.08 143664.9,-261.58 143696.24,-256.43"/>
<polygon fill="black" stroke="black" points="143697.09,-259.84 143706.38,-254.74 143695.94,-252.94 143697.09,-259.84"/>
</g>
<!-- layer_3_expert_0_ep_7 -->
<g id="node393" class="node">
<title>layer_3_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="108686.83,-269 108252.82,-269 108141.17,-165 108575.18,-165 108686.83,-269"/>
<text text-anchor="middle" x="108414" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="108414" y="-220" font-family="Arial" font-size="10.00">GPU: 112</text>
<text text-anchor="middle" x="108414" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="108414" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_0_ep_7 -->
<g id="edge685" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M111206.75,-353.94C110638.74,-345.8 109198.59,-320.71 108696.32,-269.09"/>
<polygon fill="black" stroke="black" points="108696.39,-265.58 108686.08,-268.02 108695.66,-272.54 108696.39,-265.58"/>
</g>
<!-- layer_3_expert_1_ep_7 -->
<g id="node394" class="node">
<title>layer_3_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="109249.83,-269 108815.82,-269 108704.17,-165 109138.18,-165 109249.83,-269"/>
<text text-anchor="middle" x="108977" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="108977" y="-220" font-family="Arial" font-size="10.00">GPU: 113</text>
<text text-anchor="middle" x="108977" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="108977" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_1_ep_7 -->
<g id="edge686" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M111203.92,-351.62C110723.39,-340.03 109648,-310.46 109258.9,-269.04"/>
<polygon fill="black" stroke="black" points="109259.03,-265.54 109248.71,-267.94 109258.28,-272.5 109259.03,-265.54"/>
</g>
<!-- layer_3_expert_2_ep_7 -->
<g id="node395" class="node">
<title>layer_3_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="109812.83,-269 109378.82,-269 109267.17,-165 109701.18,-165 109812.83,-269"/>
<text text-anchor="middle" x="109540" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="109540" y="-220" font-family="Arial" font-size="10.00">GPU: 114</text>
<text text-anchor="middle" x="109540" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="109540" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_2_ep_7 -->
<g id="edge687" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M111206.14,-353.46C110892.45,-346.64 110319.5,-326.89 109821.98,-269.08"/>
<polygon fill="black" stroke="black" points="109822.06,-265.56 109811.72,-267.88 109821.24,-272.52 109822.06,-265.56"/>
</g>
<!-- layer_3_expert_3_ep_7 -->
<g id="node396" class="node">
<title>layer_3_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="110375.83,-269 109941.82,-269 109830.17,-165 110264.18,-165 110375.83,-269"/>
<text text-anchor="middle" x="110103" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="110103" y="-220" font-family="Arial" font-size="10.00">GPU: 115</text>
<text text-anchor="middle" x="110103" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="110103" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_3_ep_7 -->
<g id="edge688" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M111194.66,-343.24C110982.5,-329.8 110668.05,-306.09 110384.8,-269.07"/>
<polygon fill="black" stroke="black" points="110385.1,-265.58 110374.73,-267.75 110384.19,-272.52 110385.1,-265.58"/>
</g>
<!-- layer_3_expert_4_ep_7 -->
<g id="node397" class="node">
<title>layer_3_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="110938.83,-269 110504.82,-269 110393.17,-165 110827.18,-165 110938.83,-269"/>
<text text-anchor="middle" x="110666" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="110666" y="-220" font-family="Arial" font-size="10.00">GPU: 116</text>
<text text-anchor="middle" x="110666" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="110666" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_4_ep_7 -->
<g id="edge689" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M111153.63,-305.97C111085.86,-293.89 111013.88,-281.03 110947,-269 110946.9,-268.98 110946.79,-268.96 110946.69,-268.94"/>
<polygon fill="black" stroke="black" points="110947.52,-265.54 110937.06,-267.21 110946.28,-272.43 110947.52,-265.54"/>
</g>
<!-- layer_3_expert_5_ep_7 -->
<g id="node398" class="node">
<title>layer_3_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="111501.83,-269 111067.82,-269 110956.17,-165 111390.18,-165 111501.83,-269"/>
<text text-anchor="middle" x="111229" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="111229" y="-220" font-family="Arial" font-size="10.00">GPU: 117</text>
<text text-anchor="middle" x="111229" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="111229" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_5_ep_7 -->
<g id="edge690" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M111362.96,-305.83C111347.52,-295.71 111331.23,-285.03 111315.53,-274.73"/>
<polygon fill="black" stroke="black" points="111317.15,-271.61 111306.87,-269.06 111313.32,-277.47 111317.15,-271.61"/>
</g>
<!-- layer_3_expert_6_ep_7 -->
<g id="node399" class="node">
<title>layer_3_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="112064.83,-269 111630.82,-269 111519.17,-165 111953.18,-165 112064.83,-269"/>
<text text-anchor="middle" x="111792" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="111792" y="-220" font-family="Arial" font-size="10.00">GPU: 118</text>
<text text-anchor="middle" x="111792" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="111792" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_6_ep_7 -->
<g id="edge691" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M111570.2,-305.83C111597.31,-295.1 111626,-283.74 111653.42,-272.88"/>
<polygon fill="black" stroke="black" points="111655.06,-275.99 111663.07,-269.06 111652.48,-269.49 111655.06,-275.99"/>
</g>
<!-- layer_3_expert_7_ep_7 -->
<g id="node400" class="node">
<title>layer_3_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="112627.83,-269 112193.82,-269 112082.17,-165 112516.18,-165 112627.83,-269"/>
<text text-anchor="middle" x="112355" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="112355" y="-220" font-family="Arial" font-size="10.00">GPU: 119</text>
<text text-anchor="middle" x="112355" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="112355" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_3_route_ep_7&#45;&gt;layer_3_expert_7_ep_7 -->
<g id="edge692" class="edge">
<title>layer_3_route_ep_7&#45;&gt;layer_3_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M111640.53,-331.41C111765.3,-314.88 111929.25,-292.19 112074,-269 112103.6,-264.26 112134.89,-258.91 112165.42,-253.51"/>
<polygon fill="black" stroke="black" points="112166.07,-256.95 112175.3,-251.76 112164.85,-250.06 112166.07,-256.95"/>
</g>
<!-- layer_3_agg_ep_0 -->
<g id="node401" class="node">
<title>layer_3_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="119957.07,-128 119506.77,-128 119390.93,-24 119841.23,-24 119957.07,-128"/>
<text text-anchor="middle" x="119674" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="119674" y="-79" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="119674" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="119674" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge693" class="edge">
<title>layer_3_expert_0_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M117594.37,-175.09C117630.1,-167.94 117667.63,-161.4 117703,-157 118033.43,-115.9 118999.09,-91.08 119444.31,-81.52"/>
<polygon fill="black" stroke="black" points="119444.48,-85.02 119454.4,-81.31 119444.33,-78.02 119444.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge694" class="edge">
<title>layer_3_expert_1_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M118157.8,-175.46C118193.41,-168.31 118230.79,-161.67 118266,-157 118677.77,-102.39 119162.14,-85.03 119442.05,-79.53"/>
<polygon fill="black" stroke="black" points="119442.4,-83.02 119452.33,-79.33 119442.26,-76.02 119442.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge695" class="edge">
<title>layer_3_expert_2_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M118721.7,-176.34C118757.07,-169.17 118794.13,-162.29 118829,-157 119040.23,-124.93 119283.24,-103.53 119454.27,-90.99"/>
<polygon fill="black" stroke="black" points="119454.69,-94.47 119464.41,-90.25 119454.18,-87.49 119454.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge696" class="edge">
<title>layer_3_expert_3_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M119281.83,-173.82C119347.06,-157.72 119421.72,-139.29 119488.27,-122.86"/>
<polygon fill="black" stroke="black" points="119489.15,-126.24 119498.02,-120.45 119487.48,-119.45 119489.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge697" class="edge">
<title>layer_3_expert_4_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M119674,-164.64C119674,-156.08 119674,-147.12 119674,-138.34"/>
<polygon fill="black" stroke="black" points="119677.5,-138.15 119674,-128.15 119670.5,-138.15 119677.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge698" class="edge">
<title>layer_3_expert_5_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M120030.16,-164.93C119984.62,-153.69 119936.27,-141.75 119890.37,-130.42"/>
<polygon fill="black" stroke="black" points="119891.16,-127.01 119880.61,-128.01 119889.48,-133.81 119891.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge699" class="edge">
<title>layer_3_expert_6_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M120566.92,-164.97C120550.74,-162.07 120534.65,-159.38 120519,-157 120321.52,-127.02 120096.26,-106.36 119928.01,-93.55"/>
<polygon fill="black" stroke="black" points="119928.26,-90.06 119918.02,-92.8 119927.73,-97.04 119928.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_0&#45;&gt;layer_3_agg_ep_0 -->
<g id="edge700" class="edge">
<title>layer_3_expert_7_ep_0&#45;&gt;layer_3_agg_ep_0</title>
<path fill="none" stroke="black" d="M121133.84,-164.94C121116.35,-161.94 121098.92,-159.24 121082,-157 120673.97,-102.88 120194.66,-85.34 119913.64,-79.68"/>
<polygon fill="black" stroke="black" points="119913.38,-76.17 119903.32,-79.47 119913.24,-83.17 119913.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_1 -->
<g id="node402" class="node">
<title>layer_3_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="115453.07,-128 115002.77,-128 114886.93,-24 115337.23,-24 115453.07,-128"/>
<text text-anchor="middle" x="115170" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="115170" y="-79" font-family="Arial" font-size="10.00">GPU: 16&#45;31</text>
<text text-anchor="middle" x="115170" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="115170" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge702" class="edge">
<title>layer_3_expert_0_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M113090.37,-175.09C113126.1,-167.94 113163.63,-161.4 113199,-157 113529.43,-115.9 114495.09,-91.08 114940.31,-81.52"/>
<polygon fill="black" stroke="black" points="114940.48,-85.02 114950.4,-81.31 114940.33,-78.02 114940.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge703" class="edge">
<title>layer_3_expert_1_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M113653.8,-175.46C113689.41,-168.31 113726.79,-161.67 113762,-157 114173.77,-102.39 114658.14,-85.03 114938.05,-79.53"/>
<polygon fill="black" stroke="black" points="114938.4,-83.02 114948.33,-79.33 114938.26,-76.02 114938.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge704" class="edge">
<title>layer_3_expert_2_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M114217.7,-176.34C114253.07,-169.17 114290.13,-162.29 114325,-157 114536.23,-124.93 114779.24,-103.53 114950.27,-90.99"/>
<polygon fill="black" stroke="black" points="114950.69,-94.47 114960.41,-90.25 114950.18,-87.49 114950.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge705" class="edge">
<title>layer_3_expert_3_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M114777.83,-173.82C114843.06,-157.72 114917.72,-139.29 114984.27,-122.86"/>
<polygon fill="black" stroke="black" points="114985.15,-126.24 114994.02,-120.45 114983.48,-119.45 114985.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge706" class="edge">
<title>layer_3_expert_4_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M115170,-164.64C115170,-156.08 115170,-147.12 115170,-138.34"/>
<polygon fill="black" stroke="black" points="115173.5,-138.15 115170,-128.15 115166.5,-138.15 115173.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge707" class="edge">
<title>layer_3_expert_5_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M115526.16,-164.93C115480.62,-153.69 115432.27,-141.75 115386.37,-130.42"/>
<polygon fill="black" stroke="black" points="115387.16,-127.01 115376.61,-128.01 115385.48,-133.81 115387.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge708" class="edge">
<title>layer_3_expert_6_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M116062.92,-164.97C116046.74,-162.07 116030.65,-159.38 116015,-157 115817.52,-127.02 115592.26,-106.36 115424.01,-93.55"/>
<polygon fill="black" stroke="black" points="115424.26,-90.06 115414.02,-92.8 115423.73,-97.04 115424.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_1&#45;&gt;layer_3_agg_ep_1 -->
<g id="edge709" class="edge">
<title>layer_3_expert_7_ep_1&#45;&gt;layer_3_agg_ep_1</title>
<path fill="none" stroke="black" d="M116629.84,-164.94C116612.35,-161.94 116594.92,-159.24 116578,-157 116169.97,-102.88 115690.66,-85.34 115409.64,-79.68"/>
<polygon fill="black" stroke="black" points="115409.38,-76.17 115399.32,-79.47 115409.24,-83.17 115409.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_2 -->
<g id="node403" class="node">
<title>layer_3_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="128965.07,-128 128514.77,-128 128398.93,-24 128849.23,-24 128965.07,-128"/>
<text text-anchor="middle" x="128682" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="128682" y="-79" font-family="Arial" font-size="10.00">GPU: 32&#45;47</text>
<text text-anchor="middle" x="128682" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="128682" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge711" class="edge">
<title>layer_3_expert_0_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M126602.37,-175.09C126638.1,-167.94 126675.63,-161.4 126711,-157 127041.43,-115.9 128007.09,-91.08 128452.31,-81.52"/>
<polygon fill="black" stroke="black" points="128452.48,-85.02 128462.4,-81.31 128452.33,-78.02 128452.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge712" class="edge">
<title>layer_3_expert_1_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M127165.8,-175.46C127201.41,-168.31 127238.79,-161.67 127274,-157 127685.77,-102.39 128170.14,-85.03 128450.05,-79.53"/>
<polygon fill="black" stroke="black" points="128450.4,-83.02 128460.33,-79.33 128450.26,-76.02 128450.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge713" class="edge">
<title>layer_3_expert_2_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M127729.7,-176.34C127765.07,-169.17 127802.13,-162.29 127837,-157 128048.23,-124.93 128291.24,-103.53 128462.27,-90.99"/>
<polygon fill="black" stroke="black" points="128462.69,-94.47 128472.41,-90.25 128462.18,-87.49 128462.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge714" class="edge">
<title>layer_3_expert_3_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M128289.83,-173.82C128355.06,-157.72 128429.72,-139.29 128496.27,-122.86"/>
<polygon fill="black" stroke="black" points="128497.15,-126.24 128506.02,-120.45 128495.48,-119.45 128497.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge715" class="edge">
<title>layer_3_expert_4_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M128682,-164.64C128682,-156.08 128682,-147.12 128682,-138.34"/>
<polygon fill="black" stroke="black" points="128685.5,-138.15 128682,-128.15 128678.5,-138.15 128685.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge716" class="edge">
<title>layer_3_expert_5_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M129038.16,-164.93C128992.62,-153.69 128944.27,-141.75 128898.37,-130.42"/>
<polygon fill="black" stroke="black" points="128899.16,-127.01 128888.61,-128.01 128897.48,-133.81 128899.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge717" class="edge">
<title>layer_3_expert_6_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M129574.92,-164.97C129558.74,-162.07 129542.65,-159.38 129527,-157 129329.52,-127.02 129104.26,-106.36 128936.01,-93.55"/>
<polygon fill="black" stroke="black" points="128936.26,-90.06 128926.02,-92.8 128935.73,-97.04 128936.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_2&#45;&gt;layer_3_agg_ep_2 -->
<g id="edge718" class="edge">
<title>layer_3_expert_7_ep_2&#45;&gt;layer_3_agg_ep_2</title>
<path fill="none" stroke="black" d="M130141.84,-164.94C130124.35,-161.94 130106.92,-159.24 130090,-157 129681.97,-102.88 129202.66,-85.34 128921.64,-79.68"/>
<polygon fill="black" stroke="black" points="128921.38,-76.17 128911.32,-79.47 128921.24,-83.17 128921.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_3 -->
<g id="node404" class="node">
<title>layer_3_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="124461.07,-128 124010.77,-128 123894.93,-24 124345.23,-24 124461.07,-128"/>
<text text-anchor="middle" x="124178" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="124178" y="-79" font-family="Arial" font-size="10.00">GPU: 48&#45;63</text>
<text text-anchor="middle" x="124178" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="124178" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge720" class="edge">
<title>layer_3_expert_0_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M122098.37,-175.09C122134.1,-167.94 122171.63,-161.4 122207,-157 122537.43,-115.9 123503.09,-91.08 123948.31,-81.52"/>
<polygon fill="black" stroke="black" points="123948.48,-85.02 123958.4,-81.31 123948.33,-78.02 123948.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge721" class="edge">
<title>layer_3_expert_1_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M122661.8,-175.46C122697.41,-168.31 122734.79,-161.67 122770,-157 123181.77,-102.39 123666.14,-85.03 123946.05,-79.53"/>
<polygon fill="black" stroke="black" points="123946.4,-83.02 123956.33,-79.33 123946.26,-76.02 123946.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge722" class="edge">
<title>layer_3_expert_2_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M123225.7,-176.34C123261.07,-169.17 123298.13,-162.29 123333,-157 123544.23,-124.93 123787.24,-103.53 123958.27,-90.99"/>
<polygon fill="black" stroke="black" points="123958.69,-94.47 123968.41,-90.25 123958.18,-87.49 123958.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge723" class="edge">
<title>layer_3_expert_3_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M123785.83,-173.82C123851.06,-157.72 123925.72,-139.29 123992.27,-122.86"/>
<polygon fill="black" stroke="black" points="123993.15,-126.24 124002.02,-120.45 123991.48,-119.45 123993.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge724" class="edge">
<title>layer_3_expert_4_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M124178,-164.64C124178,-156.08 124178,-147.12 124178,-138.34"/>
<polygon fill="black" stroke="black" points="124181.5,-138.15 124178,-128.15 124174.5,-138.15 124181.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge725" class="edge">
<title>layer_3_expert_5_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M124534.16,-164.93C124488.62,-153.69 124440.27,-141.75 124394.37,-130.42"/>
<polygon fill="black" stroke="black" points="124395.16,-127.01 124384.61,-128.01 124393.48,-133.81 124395.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge726" class="edge">
<title>layer_3_expert_6_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M125070.92,-164.97C125054.74,-162.07 125038.65,-159.38 125023,-157 124825.52,-127.02 124600.26,-106.36 124432.01,-93.55"/>
<polygon fill="black" stroke="black" points="124432.26,-90.06 124422.02,-92.8 124431.73,-97.04 124432.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_3&#45;&gt;layer_3_agg_ep_3 -->
<g id="edge727" class="edge">
<title>layer_3_expert_7_ep_3&#45;&gt;layer_3_agg_ep_3</title>
<path fill="none" stroke="black" d="M125637.84,-164.94C125620.35,-161.94 125602.92,-159.24 125586,-157 125177.97,-102.88 124698.66,-85.34 124417.64,-79.68"/>
<polygon fill="black" stroke="black" points="124417.38,-76.17 124407.32,-79.47 124417.24,-83.17 124417.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_4 -->
<g id="node405" class="node">
<title>layer_3_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="133469.07,-128 133018.77,-128 132902.93,-24 133353.23,-24 133469.07,-128"/>
<text text-anchor="middle" x="133186" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="133186" y="-79" font-family="Arial" font-size="10.00">GPU: 64&#45;79</text>
<text text-anchor="middle" x="133186" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="133186" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge729" class="edge">
<title>layer_3_expert_0_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M131106.37,-175.09C131142.1,-167.94 131179.63,-161.4 131215,-157 131545.43,-115.9 132511.09,-91.08 132956.31,-81.52"/>
<polygon fill="black" stroke="black" points="132956.48,-85.02 132966.4,-81.31 132956.33,-78.02 132956.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge730" class="edge">
<title>layer_3_expert_1_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M131669.8,-175.46C131705.41,-168.31 131742.79,-161.67 131778,-157 132189.77,-102.39 132674.14,-85.03 132954.05,-79.53"/>
<polygon fill="black" stroke="black" points="132954.4,-83.02 132964.33,-79.33 132954.26,-76.02 132954.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge731" class="edge">
<title>layer_3_expert_2_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M132233.7,-176.34C132269.07,-169.17 132306.13,-162.29 132341,-157 132552.23,-124.93 132795.24,-103.53 132966.27,-90.99"/>
<polygon fill="black" stroke="black" points="132966.69,-94.47 132976.41,-90.25 132966.18,-87.49 132966.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge732" class="edge">
<title>layer_3_expert_3_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M132793.83,-173.82C132859.06,-157.72 132933.72,-139.29 133000.27,-122.86"/>
<polygon fill="black" stroke="black" points="133001.15,-126.24 133010.02,-120.45 132999.48,-119.45 133001.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge733" class="edge">
<title>layer_3_expert_4_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M133186,-164.64C133186,-156.08 133186,-147.12 133186,-138.34"/>
<polygon fill="black" stroke="black" points="133189.5,-138.15 133186,-128.15 133182.5,-138.15 133189.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge734" class="edge">
<title>layer_3_expert_5_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M133542.16,-164.93C133496.62,-153.69 133448.27,-141.75 133402.37,-130.42"/>
<polygon fill="black" stroke="black" points="133403.16,-127.01 133392.61,-128.01 133401.48,-133.81 133403.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge735" class="edge">
<title>layer_3_expert_6_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M134078.92,-164.97C134062.74,-162.07 134046.65,-159.38 134031,-157 133833.52,-127.02 133608.26,-106.36 133440.01,-93.55"/>
<polygon fill="black" stroke="black" points="133440.26,-90.06 133430.02,-92.8 133439.73,-97.04 133440.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_4&#45;&gt;layer_3_agg_ep_4 -->
<g id="edge736" class="edge">
<title>layer_3_expert_7_ep_4&#45;&gt;layer_3_agg_ep_4</title>
<path fill="none" stroke="black" d="M134645.84,-164.94C134628.35,-161.94 134610.92,-159.24 134594,-157 134185.97,-102.88 133706.66,-85.34 133425.64,-79.68"/>
<polygon fill="black" stroke="black" points="133425.38,-76.17 133415.32,-79.47 133425.24,-83.17 133425.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_5 -->
<g id="node406" class="node">
<title>layer_3_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="137973.07,-128 137522.77,-128 137406.93,-24 137857.23,-24 137973.07,-128"/>
<text text-anchor="middle" x="137690" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="137690" y="-79" font-family="Arial" font-size="10.00">GPU: 80&#45;95</text>
<text text-anchor="middle" x="137690" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="137690" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge738" class="edge">
<title>layer_3_expert_0_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M135610.37,-175.09C135646.1,-167.94 135683.63,-161.4 135719,-157 136049.43,-115.9 137015.09,-91.08 137460.31,-81.52"/>
<polygon fill="black" stroke="black" points="137460.48,-85.02 137470.4,-81.31 137460.33,-78.02 137460.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge739" class="edge">
<title>layer_3_expert_1_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M136173.8,-175.46C136209.41,-168.31 136246.79,-161.67 136282,-157 136693.77,-102.39 137178.14,-85.03 137458.05,-79.53"/>
<polygon fill="black" stroke="black" points="137458.4,-83.02 137468.33,-79.33 137458.26,-76.02 137458.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge740" class="edge">
<title>layer_3_expert_2_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M136737.7,-176.34C136773.07,-169.17 136810.13,-162.29 136845,-157 137056.23,-124.93 137299.24,-103.53 137470.27,-90.99"/>
<polygon fill="black" stroke="black" points="137470.69,-94.47 137480.41,-90.25 137470.18,-87.49 137470.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge741" class="edge">
<title>layer_3_expert_3_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M137297.83,-173.82C137363.06,-157.72 137437.72,-139.29 137504.27,-122.86"/>
<polygon fill="black" stroke="black" points="137505.15,-126.24 137514.02,-120.45 137503.48,-119.45 137505.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge742" class="edge">
<title>layer_3_expert_4_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M137690,-164.64C137690,-156.08 137690,-147.12 137690,-138.34"/>
<polygon fill="black" stroke="black" points="137693.5,-138.15 137690,-128.15 137686.5,-138.15 137693.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge743" class="edge">
<title>layer_3_expert_5_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M138046.16,-164.93C138000.62,-153.69 137952.27,-141.75 137906.37,-130.42"/>
<polygon fill="black" stroke="black" points="137907.16,-127.01 137896.61,-128.01 137905.48,-133.81 137907.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge744" class="edge">
<title>layer_3_expert_6_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M138582.92,-164.97C138566.74,-162.07 138550.65,-159.38 138535,-157 138337.52,-127.02 138112.26,-106.36 137944.01,-93.55"/>
<polygon fill="black" stroke="black" points="137944.26,-90.06 137934.02,-92.8 137943.73,-97.04 137944.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_5&#45;&gt;layer_3_agg_ep_5 -->
<g id="edge745" class="edge">
<title>layer_3_expert_7_ep_5&#45;&gt;layer_3_agg_ep_5</title>
<path fill="none" stroke="black" d="M139149.84,-164.94C139132.35,-161.94 139114.92,-159.24 139098,-157 138689.97,-102.88 138210.66,-85.34 137929.64,-79.68"/>
<polygon fill="black" stroke="black" points="137929.38,-76.17 137919.32,-79.47 137929.24,-83.17 137929.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_6 -->
<g id="node407" class="node">
<title>layer_3_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="142477.07,-128 142026.77,-128 141910.93,-24 142361.23,-24 142477.07,-128"/>
<text text-anchor="middle" x="142194" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="142194" y="-79" font-family="Arial" font-size="10.00">GPU: 96&#45;111</text>
<text text-anchor="middle" x="142194" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="142194" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge747" class="edge">
<title>layer_3_expert_0_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M140114.37,-175.09C140150.1,-167.94 140187.63,-161.4 140223,-157 140553.43,-115.9 141519.09,-91.08 141964.31,-81.52"/>
<polygon fill="black" stroke="black" points="141964.48,-85.02 141974.4,-81.31 141964.33,-78.02 141964.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge748" class="edge">
<title>layer_3_expert_1_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M140677.8,-175.46C140713.41,-168.31 140750.79,-161.67 140786,-157 141197.77,-102.39 141682.14,-85.03 141962.05,-79.53"/>
<polygon fill="black" stroke="black" points="141962.4,-83.02 141972.33,-79.33 141962.26,-76.02 141962.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge749" class="edge">
<title>layer_3_expert_2_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M141241.7,-176.34C141277.07,-169.17 141314.13,-162.29 141349,-157 141560.23,-124.93 141803.24,-103.53 141974.27,-90.99"/>
<polygon fill="black" stroke="black" points="141974.69,-94.47 141984.41,-90.25 141974.18,-87.49 141974.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge750" class="edge">
<title>layer_3_expert_3_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M141801.83,-173.82C141867.06,-157.72 141941.72,-139.29 142008.27,-122.86"/>
<polygon fill="black" stroke="black" points="142009.15,-126.24 142018.02,-120.45 142007.48,-119.45 142009.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge751" class="edge">
<title>layer_3_expert_4_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M142194,-164.64C142194,-156.08 142194,-147.12 142194,-138.34"/>
<polygon fill="black" stroke="black" points="142197.5,-138.15 142194,-128.15 142190.5,-138.15 142197.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge752" class="edge">
<title>layer_3_expert_5_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M142550.16,-164.93C142504.62,-153.69 142456.27,-141.75 142410.37,-130.42"/>
<polygon fill="black" stroke="black" points="142411.16,-127.01 142400.61,-128.01 142409.48,-133.81 142411.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge753" class="edge">
<title>layer_3_expert_6_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M143086.92,-164.97C143070.74,-162.07 143054.65,-159.38 143039,-157 142841.52,-127.02 142616.26,-106.36 142448.01,-93.55"/>
<polygon fill="black" stroke="black" points="142448.26,-90.06 142438.02,-92.8 142447.73,-97.04 142448.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_6&#45;&gt;layer_3_agg_ep_6 -->
<g id="edge754" class="edge">
<title>layer_3_expert_7_ep_6&#45;&gt;layer_3_agg_ep_6</title>
<path fill="none" stroke="black" d="M143653.84,-164.94C143636.35,-161.94 143618.92,-159.24 143602,-157 143193.97,-102.88 142714.66,-85.34 142433.64,-79.68"/>
<polygon fill="black" stroke="black" points="142433.38,-76.17 142423.32,-79.47 142433.24,-83.17 142433.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_7 -->
<g id="node408" class="node">
<title>layer_3_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="110949.07,-128 110498.77,-128 110382.93,-24 110833.23,-24 110949.07,-128"/>
<text text-anchor="middle" x="110666" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="110666" y="-79" font-family="Arial" font-size="10.00">GPU: 112&#45;127</text>
<text text-anchor="middle" x="110666" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="110666" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_expert_0_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge756" class="edge">
<title>layer_3_expert_0_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M108586.37,-175.09C108622.1,-167.94 108659.63,-161.4 108695,-157 109025.43,-115.9 109991.09,-91.08 110436.31,-81.52"/>
<polygon fill="black" stroke="black" points="110436.48,-85.02 110446.4,-81.31 110436.33,-78.02 110436.48,-85.02"/>
</g>
<!-- layer_3_expert_1_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge757" class="edge">
<title>layer_3_expert_1_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M109149.8,-175.46C109185.41,-168.31 109222.79,-161.67 109258,-157 109669.77,-102.39 110154.14,-85.03 110434.05,-79.53"/>
<polygon fill="black" stroke="black" points="110434.4,-83.02 110444.33,-79.33 110434.26,-76.02 110434.4,-83.02"/>
</g>
<!-- layer_3_expert_2_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge758" class="edge">
<title>layer_3_expert_2_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M109713.7,-176.34C109749.07,-169.17 109786.13,-162.29 109821,-157 110032.23,-124.93 110275.24,-103.53 110446.27,-90.99"/>
<polygon fill="black" stroke="black" points="110446.69,-94.47 110456.41,-90.25 110446.18,-87.49 110446.69,-94.47"/>
</g>
<!-- layer_3_expert_3_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge759" class="edge">
<title>layer_3_expert_3_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M110273.83,-173.82C110339.06,-157.72 110413.72,-139.29 110480.27,-122.86"/>
<polygon fill="black" stroke="black" points="110481.15,-126.24 110490.02,-120.45 110479.48,-119.45 110481.15,-126.24"/>
</g>
<!-- layer_3_expert_4_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge760" class="edge">
<title>layer_3_expert_4_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M110666,-164.64C110666,-156.08 110666,-147.12 110666,-138.34"/>
<polygon fill="black" stroke="black" points="110669.5,-138.15 110666,-128.15 110662.5,-138.15 110669.5,-138.15"/>
</g>
<!-- layer_3_expert_5_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge761" class="edge">
<title>layer_3_expert_5_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M111022.16,-164.93C110976.62,-153.69 110928.27,-141.75 110882.37,-130.42"/>
<polygon fill="black" stroke="black" points="110883.16,-127.01 110872.61,-128.01 110881.48,-133.81 110883.16,-127.01"/>
</g>
<!-- layer_3_expert_6_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge762" class="edge">
<title>layer_3_expert_6_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M111558.92,-164.97C111542.74,-162.07 111526.65,-159.38 111511,-157 111313.52,-127.02 111088.26,-106.36 110920.01,-93.55"/>
<polygon fill="black" stroke="black" points="110920.26,-90.06 110910.02,-92.8 110919.73,-97.04 110920.26,-90.06"/>
</g>
<!-- layer_3_expert_7_ep_7&#45;&gt;layer_3_agg_ep_7 -->
<g id="edge763" class="edge">
<title>layer_3_expert_7_ep_7&#45;&gt;layer_3_agg_ep_7</title>
<path fill="none" stroke="black" d="M112125.84,-164.94C112108.35,-161.94 112090.92,-159.24 112074,-157 111665.97,-102.88 111186.66,-85.34 110905.64,-79.68"/>
<polygon fill="black" stroke="black" points="110905.38,-76.17 110895.32,-79.47 110905.24,-83.17 110905.38,-76.17"/>
</g>
<!-- layer_3_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge701" class="edge">
<title>layer_3_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M119904.57,-80.7C120539.42,-90.7 122366.75,-118.16 123886,-128 128608.57,-158.59 140415.34,-138.99 145138,-146 145347.33,-146.31 145399.67,-146.77 145609,-147 155642.58,-157.79 496784.42,-152.76 506818,-157 537943.56,-170.15 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge710" class="edge">
<title>layer_3_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M115400.57,-80.71C116035.42,-90.74 117862.75,-118.26 119382,-128 122178.5,-145.93 141754.45,-142.62 144551,-146 144811.89,-146.32 144877.11,-146.77 145138,-147 165231.33,-164.39 486724.67,-148.51 506818,-157 537943.56,-170.15 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge719" class="edge">
<title>layer_3_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M128912.57,-80.67C129547.42,-90.59 131374.75,-117.86 132894,-128 134600.07,-139.38 146542.89,-145.92 148249,-147 168169.5,-159.6 486897.5,-148.58 506818,-157 537943.56,-170.15 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge728" class="edge">
<title>layer_3_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M124408.57,-80.69C125043.42,-90.65 126870.75,-118.02 128390,-128 128899.24,-131.35 146213.75,-146.73 146723,-147 186733.55,-168.29 466807.45,-140.1 506818,-157 537943.56,-170.15 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge737" class="edge">
<title>layer_3_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M133416.57,-80.66C134051.42,-90.56 135878.75,-117.78 137398,-128 140527.71,-149.06 148352.22,-144.84 151482,-147 171222.88,-160.59 487077.11,-148.66 506818,-157 537943.56,-170.15 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge746" class="edge">
<title>layer_3_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M137920.57,-80.74C138555.41,-90.85 140382.75,-118.54 141902,-128 147926.44,-165.53 190098.44,-145.85 196123,-147 230644.67,-153.6 472296.34,-142.34 506818,-157 537943.56,-170.22 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge755" class="edge">
<title>layer_3_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M142420.82,-77.41C145219.83,-82.39 173373.27,-131.87 196127,-147 230648.21,-169.96 472296.78,-142.34 506818,-157 537943.56,-170.22 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge764" class="edge">
<title>layer_3_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M110896.57,-80.72C111531.42,-90.76 113358.75,-118.32 114878,-128 121471.87,-170.03 137957,-144.8 144551,-147 184802.89,-160.44 466566.11,-140 506818,-157 537943.56,-170.15 576615.74,-213.29 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_3_moe_alltoall -->
<g id="node409" class="node">
<title>layer_3_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="132712" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="132712" y="-521" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="132712" y="-510" font-family="Arial" font-size="10.00">GPUs: 0&#45;127</text>
<text text-anchor="middle" x="132712" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="132712" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_3_ln_tp_0 -->
<g id="node410" class="node">
<title>layer_3_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="142404.07,-559 141953.77,-559 141837.93,-455 142288.23,-455 142404.07,-559"/>
<text text-anchor="middle" x="142121" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="142121" y="-510" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="142121" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="142121" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_qkv_tp_0 -->
<g id="node414" class="node">
<title>layer_4_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="288280.7,-1069 287838.94,-1069 287725.3,-965 288167.06,-965 288280.7,-1069"/>
<text text-anchor="middle" x="288003" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="288003" y="-1020" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="288003" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="288003" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_3_ln_tp_0&#45;&gt;layer_4_qkv_tp_0 -->
<g id="edge3089" class="edge">
<title>layer_3_ln_tp_0&#45;&gt;layer_4_qkv_tp_0</title>
<path fill="none" stroke="black" d="M142272.77,-559.1C142317.42,-571.81 142366.71,-583.62 142413,-590 142413,-590 470779,-598 470779,-598 470872.85,-598.01 578813.2,-580.82 578896,-625 578976.26,-667.83 578983.52,-707.97 579010,-795 579029.99,-860.72 579048.15,-928.49 578982,-947 578982,-947 288290,-957 288290,-957 288256.61,-960.4 288221.36,-965.96 288187.43,-972.35"/>
<polygon fill="black" stroke="black" points="288186.59,-968.95 288177.43,-974.27 288187.91,-975.83 288186.59,-968.95"/>
</g>
<!-- layer_3_ln_tp_1 -->
<g id="node411" class="node">
<title>layer_3_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="142988.07,-559 142537.77,-559 142421.93,-455 142872.23,-455 142988.07,-559"/>
<text text-anchor="middle" x="142705" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="142705" y="-510" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="142705" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="142705" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_qkv_tp_1 -->
<g id="node415" class="node">
<title>layer_4_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="288854.7,-1069 288412.94,-1069 288299.3,-965 288741.06,-965 288854.7,-1069"/>
<text text-anchor="middle" x="288577" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="288577" y="-1020" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="288577" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="288577" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_3_ln_tp_1&#45;&gt;layer_4_qkv_tp_1 -->
<g id="edge3090" class="edge">
<title>layer_3_ln_tp_1&#45;&gt;layer_4_qkv_tp_1</title>
<path fill="none" stroke="black" d="M142856.77,-559.1C142901.42,-571.81 142950.71,-583.62 142997,-590 142997,-590 579059,-598 579059,-598 579156.03,-599.5 579843,-586.31 579932,-625 580009.53,-658.7 579988.12,-727.12 580066,-760 580086.93,-768.84 580868.01,-751.85 580884,-768 580943.26,-827.84 580575.16,-746.95 580506,-795 580445.66,-836.92 580502.32,-906.53 580441,-947 580441,-947 288864,-957 288864,-957 288830.61,-960.4 288795.36,-965.96 288761.43,-972.35"/>
<polygon fill="black" stroke="black" points="288760.59,-968.95 288751.43,-974.27 288761.91,-975.83 288760.59,-968.95"/>
</g>
<!-- layer_3_ln_tp_2 -->
<g id="node412" class="node">
<title>layer_3_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="143572.07,-559 143121.77,-559 143005.93,-455 143456.23,-455 143572.07,-559"/>
<text text-anchor="middle" x="143289" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="143289" y="-510" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="143289" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="143289" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_qkv_tp_2 -->
<g id="node416" class="node">
<title>layer_4_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="289428.7,-1069 288986.94,-1069 288873.3,-965 289315.06,-965 289428.7,-1069"/>
<text text-anchor="middle" x="289151" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="289151" y="-1020" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="289151" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="289151" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_3_ln_tp_2&#45;&gt;layer_4_qkv_tp_2 -->
<g id="edge3091" class="edge">
<title>layer_3_ln_tp_2&#45;&gt;layer_4_qkv_tp_2</title>
<path fill="none" stroke="black" d="M143440.77,-559.1C143485.42,-571.81 143534.71,-583.62 143581,-590 143581,-590 579983,-598 579983,-598 580155.38,-634.81 580172.88,-722.01 580345,-760 580360.9,-763.51 580919.57,-756.41 580931,-768 580970.4,-807.94 580732.68,-775.71 580680,-795 580571.47,-834.74 580579.77,-914 580469,-947 580469,-947 289438,-957 289438,-957 289404.61,-960.4 289369.36,-965.96 289335.43,-972.35"/>
<polygon fill="black" stroke="black" points="289334.59,-968.95 289325.43,-974.27 289335.91,-975.83 289334.59,-968.95"/>
</g>
<!-- layer_3_ln_tp_3 -->
<g id="node413" class="node">
<title>layer_3_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="144156.07,-559 143705.77,-559 143589.93,-455 144040.23,-455 144156.07,-559"/>
<text text-anchor="middle" x="143873" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="143873" y="-510" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="143873" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="143873" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_qkv_tp_3 -->
<g id="node417" class="node">
<title>layer_4_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="290002.7,-1069 289560.94,-1069 289447.3,-965 289889.06,-965 290002.7,-1069"/>
<text text-anchor="middle" x="289725" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="289725" y="-1020" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="289725" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="289725" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_3_ln_tp_3&#45;&gt;layer_4_qkv_tp_3 -->
<g id="edge3092" class="edge">
<title>layer_3_ln_tp_3&#45;&gt;layer_4_qkv_tp_3</title>
<path fill="none" stroke="black" d="M144114.03,-521.16C144487.63,-540.84 145229.14,-577 145859,-590 145859,-590 580168,-598 580168,-598 580487.36,-631.07 580555.18,-707.97 580872,-760 580881.25,-761.52 580949.69,-761.06 580956,-768 581077.55,-901.68 580767.4,-907.93 580591,-947 580591,-947 398282,-957 398282,-957 351767.48,-970.92 294042.03,-1012.84 289955.08,-1015.83"/>
<polygon fill="black" stroke="black" points="289954.71,-1012.33 289944.72,-1015.84 289954.72,-1019.33 289954.71,-1012.33"/>
</g>
<!-- layer_4_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge773" class="edge">
<title>layer_4_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M288177.43,-974.27C288214.38,-967.08 288253.31,-960.73 288290,-957 288290,-957 579006,-947 579006,-947 579225.14,-937.54 581094.12,-950.21 580972,-768 580941.09,-721.88 580223.38,-464.09 580146,-447 580040.65,-423.73 580011.8,-432.23 579904,-428 579151.03,-398.47 146611.89,-441.59 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_4_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge774" class="edge">
<title>layer_4_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M288751.43,-974.27C288788.38,-967.08 288827.31,-960.73 288864,-957 288864,-957 579307,-947 579307,-947 579562.58,-945.11 580204.21,-967.67 580457,-930 580700.62,-893.7 581088.97,-992.21 580987,-768 580797,-350.25 580470.76,-440.38 580012,-428 579258.54,-407.66 146612.08,-441.6 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_4_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge775" class="edge">
<title>layer_4_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M289325.43,-974.27C289362.38,-967.08 289401.31,-960.73 289438,-957 289438,-957 579861,-947 579861,-947 580117.64,-944.53 581040.97,-1021.68 581002,-768 580974.5,-589 580919.39,-513.65 580751,-447 580655.67,-409.26 580392.51,-430.11 580290,-428 579535.94,-412.45 146612.56,-441.62 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_4_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge776" class="edge">
<title>layer_4_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M289944.72,-1015.84C293943.29,-1012.91 351727.7,-970.93 398282,-957 398913.99,-956.81 579662.08,-955.94 580294,-947 580360.91,-946.05 580836.25,-960.12 580896,-930 581023.38,-865.78 581050.52,-756.83 580996,-625 580958.16,-533.49 580949.36,-493.62 580862,-447 580726.13,-374.49 580669.95,-432.23 580516,-428 579761.67,-407.29 146612.95,-441.63 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_4_qkv_comm -->
<g id="node418" class="node">
<title>layer_4_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="287368" cy="-1017" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="287368" y="-1031" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="287368" y="-1020" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="287368" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="287368" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_4_attn_tp_0 -->
<g id="node419" class="node">
<title>layer_4_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="254543.7,-1069 254101.94,-1069 253988.3,-965 254430.06,-965 254543.7,-1069"/>
<text text-anchor="middle" x="254266" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="254266" y="-1020" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="254266" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="254266" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_out_tp_0 -->
<g id="node423" class="node">
<title>layer_4_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="254543.7,-899 254101.94,-899 253988.3,-795 254430.06,-795 254543.7,-899"/>
<text text-anchor="middle" x="254266" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="254266" y="-850" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="254266" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="254266" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_tp_0&#45;&gt;layer_4_attn_out_tp_0 -->
<g id="edge781" class="edge">
<title>layer_4_attn_tp_0&#45;&gt;layer_4_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M254266,-964.68C254266,-947.18 254266,-927.43 254266,-909.22"/>
<polygon fill="black" stroke="black" points="254269.5,-909 254266,-899 254262.5,-909 254269.5,-909"/>
</g>
<!-- layer_4_attn_tp_1 -->
<g id="node420" class="node">
<title>layer_4_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="255117.7,-1069 254675.94,-1069 254562.3,-965 255004.06,-965 255117.7,-1069"/>
<text text-anchor="middle" x="254840" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="254840" y="-1020" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="254840" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="254840" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_out_tp_1 -->
<g id="node424" class="node">
<title>layer_4_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="255117.7,-899 254675.94,-899 254562.3,-795 255004.06,-795 255117.7,-899"/>
<text text-anchor="middle" x="254840" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="254840" y="-850" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="254840" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="254840" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_tp_1&#45;&gt;layer_4_attn_out_tp_1 -->
<g id="edge783" class="edge">
<title>layer_4_attn_tp_1&#45;&gt;layer_4_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M254840,-964.68C254840,-947.18 254840,-927.43 254840,-909.22"/>
<polygon fill="black" stroke="black" points="254843.5,-909 254840,-899 254836.5,-909 254843.5,-909"/>
</g>
<!-- layer_4_attn_tp_2 -->
<g id="node421" class="node">
<title>layer_4_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="255691.7,-1069 255249.94,-1069 255136.3,-965 255578.06,-965 255691.7,-1069"/>
<text text-anchor="middle" x="255414" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="255414" y="-1020" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="255414" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="255414" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_out_tp_2 -->
<g id="node425" class="node">
<title>layer_4_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="255691.7,-899 255249.94,-899 255136.3,-795 255578.06,-795 255691.7,-899"/>
<text text-anchor="middle" x="255414" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="255414" y="-850" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="255414" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="255414" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_tp_2&#45;&gt;layer_4_attn_out_tp_2 -->
<g id="edge785" class="edge">
<title>layer_4_attn_tp_2&#45;&gt;layer_4_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M255414,-964.68C255414,-947.18 255414,-927.43 255414,-909.22"/>
<polygon fill="black" stroke="black" points="255417.5,-909 255414,-899 255410.5,-909 255417.5,-909"/>
</g>
<!-- layer_4_attn_tp_3 -->
<g id="node422" class="node">
<title>layer_4_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="256265.7,-1069 255823.94,-1069 255710.3,-965 256152.06,-965 256265.7,-1069"/>
<text text-anchor="middle" x="255988" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="255988" y="-1020" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="255988" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="255988" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_out_tp_3 -->
<g id="node426" class="node">
<title>layer_4_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="256265.7,-899 255823.94,-899 255710.3,-795 256152.06,-795 256265.7,-899"/>
<text text-anchor="middle" x="255988" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="255988" y="-850" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="255988" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="255988" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_4_attn_tp_3&#45;&gt;layer_4_attn_out_tp_3 -->
<g id="edge787" class="edge">
<title>layer_4_attn_tp_3&#45;&gt;layer_4_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M255988,-964.68C255988,-947.18 255988,-927.43 255988,-909.22"/>
<polygon fill="black" stroke="black" points="255991.5,-909 255988,-899 255984.5,-909 255991.5,-909"/>
</g>
<!-- layer_4_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge782" class="edge">
<title>layer_4_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M253989.46,-796.26C253984.95,-795.81 253980.46,-795.39 253976,-795 253788.74,-778.64 145886.71,-806.13 145701,-777 145688.09,-774.97 145685.71,-771.04 145673,-768 145528.62,-733.47 145360.18,-708.51 145245.43,-693.76"/>
<polygon fill="black" stroke="black" points="145245.55,-690.24 145235.19,-692.45 145244.66,-697.19 145245.55,-690.24"/>
</g>
<!-- layer_4_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge784" class="edge">
<title>layer_4_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M254563.27,-795.96C254559.83,-795.62 254556.4,-795.3 254553,-795 254364.8,-778.39 145912.65,-806.28 145726,-777 145713.09,-774.97 145710.72,-771 145698,-768 145543.65,-731.62 145362.9,-706.51 145242.96,-692.23"/>
<polygon fill="black" stroke="black" points="145243.34,-688.75 145232.99,-691.05 145242.51,-695.7 145243.34,-688.75"/>
</g>
<!-- layer_4_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge786" class="edge">
<title>layer_4_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M255137.27,-795.96C255133.83,-795.62 255130.4,-795.3 255127,-795 254937.85,-778.31 145938.6,-806.42 145751,-777 145738.09,-774.97 145735.73,-770.96 145723,-768 145558.89,-729.85 145366.12,-704.7 145241.2,-690.91"/>
<polygon fill="black" stroke="black" points="145241.52,-687.43 145231.2,-689.82 145240.76,-694.38 145241.52,-687.43"/>
</g>
<!-- layer_4_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge788" class="edge">
<title>layer_4_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M255711.27,-795.96C255707.83,-795.62 255704.4,-795.3 255701,-795 255511.04,-778.22 146049.41,-770.42 145859,-760 145640.5,-748.04 145387.74,-716.7 145238.79,-696.41"/>
<polygon fill="black" stroke="black" points="145239.07,-692.92 145228.69,-695.03 145238.13,-699.85 145239.07,-692.92"/>
</g>
<!-- layer_4_attn_allreduce -->
<g id="node427" class="node">
<title>layer_4_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="275573" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="275573" y="-1031" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="275573" y="-1020" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="275573" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="275573" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_gate_tp_0 -->
<g id="node428" class="node">
<title>layer_4_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="274165.99,-1069 273717.4,-1069 273602.01,-965 274050.6,-965 274165.99,-1069"/>
<text text-anchor="middle" x="273884" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="273884" y="-1020" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="273884" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="273884" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_4_route_ep_0 -->
<g id="node432" class="node">
<title>layer_4_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="257576.43,-899 257117.6,-899 256999.57,-795 257458.4,-795 257576.43,-899"/>
<text text-anchor="middle" x="257288" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="257288" y="-850" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="257288" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="257288" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_0 -->
<g id="edge789" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273653.92,-964.98C273633.4,-961.75 273612.87,-959 273593,-957 273457.34,-943.32 263912.34,-948.19 263776,-947 263532.42,-944.88 263471.57,-940.59 263228,-938 262488.48,-930.15 262303.51,-938.87 261564,-930 260032.02,-911.63 258191.64,-869.6 257535.32,-853.99"/>
<polygon fill="black" stroke="black" points="257535.35,-850.49 257525.27,-853.75 257535.18,-857.48 257535.35,-850.49"/>
<text text-anchor="middle" x="263802" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_1 -->
<g id="node433" class="node">
<title>layer_4_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="277914.43,-899 277455.6,-899 277337.57,-795 277796.4,-795 277914.43,-899"/>
<text text-anchor="middle" x="277626" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="277626" y="-850" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="277626" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="277626" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_1 -->
<g id="edge790" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274062.19,-975.33C274099.3,-968.14 274138.29,-961.52 274175,-957 274186.62,-955.57 274584.3,-938.44 274596,-938 275639.57,-898.96 276885.84,-866.37 277393.57,-853.68"/>
<polygon fill="black" stroke="black" points="277393.67,-857.18 277403.58,-853.43 277393.49,-850.18 277393.67,-857.18"/>
<text text-anchor="middle" x="274622" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_2 -->
<g id="node434" class="node">
<title>layer_4_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="262149.43,-899 261690.6,-899 261572.57,-795 262031.4,-795 262149.43,-899"/>
<text text-anchor="middle" x="261861" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="261861" y="-850" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="261861" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="261861" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_2 -->
<g id="edge791" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273653.52,-964.95C273633.13,-961.75 273612.74,-959.01 273593,-957 273494.01,-946.93 270110.5,-947.51 270011,-947 269471.88,-944.25 269337.12,-940.77 268798,-938 267558.46,-931.62 267248.48,-944.03 266009,-930 264529.03,-913.25 262752.44,-870.56 262108.92,-854.36"/>
<polygon fill="black" stroke="black" points="262108.68,-850.85 262098.6,-854.1 262108.51,-857.85 262108.68,-850.85"/>
<text text-anchor="middle" x="270037" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_3 -->
<g id="node435" class="node">
<title>layer_4_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="274269.43,-899 273810.6,-899 273692.57,-795 274151.4,-795 274269.43,-899"/>
<text text-anchor="middle" x="273981" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="273981" y="-850" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="273981" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="273981" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_3 -->
<g id="edge792" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273901.41,-964.74C273905.15,-955.63 273909.38,-946.39 273914,-938 273919.65,-927.74 273926.35,-917.33 273933.29,-907.41"/>
<polygon fill="black" stroke="black" points="273936.18,-909.37 273939.15,-899.2 273930.49,-905.3 273936.18,-909.37"/>
<text text-anchor="middle" x="273940" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_4 -->
<g id="node436" class="node">
<title>layer_4_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="271178.43,-899 270719.6,-899 270601.57,-795 271060.4,-795 271178.43,-899"/>
<text text-anchor="middle" x="270890" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="270890" y="-850" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="270890" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="270890" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_4 -->
<g id="edge793" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273636.9,-964.99C273622.06,-962.21 273607.34,-959.53 273593,-957 273536.79,-947.1 273522.83,-943.23 273466,-938 272609.22,-859.2 271586.35,-848 271130.16,-847.31"/>
<polygon fill="black" stroke="black" points="271130.16,-843.81 271120.16,-847.29 271130.15,-850.81 271130.16,-843.81"/>
<text text-anchor="middle" x="273562" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_5 -->
<g id="node437" class="node">
<title>layer_4_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="266594.43,-899 266135.6,-899 266017.57,-795 266476.4,-795 266594.43,-899"/>
<text text-anchor="middle" x="266306" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="266306" y="-850" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="266306" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="266306" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_5 -->
<g id="edge794" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273653.12,-964.97C273632.86,-961.77 273612.61,-959.03 273593,-957 273505.13,-947.9 272091.33,-948.15 272003,-947 271800.31,-944.36 271749.69,-940.85 271547,-938 271123.03,-932.04 271016.97,-935.83 270593,-930 269056.19,-908.86 267209.76,-868.48 266552.77,-853.65"/>
<polygon fill="black" stroke="black" points="266552.79,-850.15 266542.71,-853.42 266552.63,-857.15 266552.79,-850.15"/>
<text text-anchor="middle" x="272029" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_6 -->
<g id="node438" class="node">
<title>layer_4_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="286922.43,-899 286463.6,-899 286345.57,-795 286804.4,-795 286922.43,-899"/>
<text text-anchor="middle" x="286634" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="286634" y="-850" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="286634" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="286634" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_6 -->
<g id="edge795" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274061.28,-974.29C274098.63,-967.13 274137.95,-960.78 274175,-957 274232.01,-951.18 282369.7,-930.65 282427,-930 283942.99,-912.75 285765.89,-869.58 286401.75,-853.85"/>
<polygon fill="black" stroke="black" points="286402.04,-857.34 286411.95,-853.6 286401.87,-850.35 286402.04,-857.34"/>
<text text-anchor="middle" x="279539" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_route_ep_7 -->
<g id="node439" class="node">
<title>layer_4_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="282418.43,-899 281959.6,-899 281841.57,-795 282300.4,-795 282418.43,-899"/>
<text text-anchor="middle" x="282130" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="282130" y="-850" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="282130" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="282130" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_7 -->
<g id="edge796" class="edge">
<title>layer_4_gate_tp_0&#45;&gt;layer_4_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274061.71,-974.62C274098.94,-967.46 274138.1,-961.03 274175,-957 274300.27,-943.31 274616.46,-957.96 274742,-947 274767.55,-944.77 274773.43,-940.04 274799,-938 274885.5,-931.1 277836.23,-930.96 277923,-930 279439,-913.29 281261.89,-869.78 281897.75,-853.91"/>
<polygon fill="black" stroke="black" points="281898.04,-857.4 281907.95,-853.65 281897.87,-850.4 281898.04,-857.4"/>
<text text-anchor="middle" x="274825" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1 -->
<g id="node429" class="node">
<title>layer_4_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="274747.99,-1069 274299.4,-1069 274184.01,-965 274632.6,-965 274747.99,-1069"/>
<text text-anchor="middle" x="274466" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="274466" y="-1020" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="274466" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="274466" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_0 -->
<g id="edge797" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274235.92,-964.98C274215.4,-961.75 274194.87,-959 274175,-957 274035.97,-942.98 264253.72,-949.27 264114,-947 263986.84,-944.94 263955.15,-940.22 263828,-938 262821.93,-920.4 262570.16,-941.42 261564,-930 260032.01,-912.61 258191.64,-869.98 257535.32,-854.1"/>
<polygon fill="black" stroke="black" points="257535.35,-850.6 257525.27,-853.85 257535.18,-857.59 257535.35,-850.6"/>
<text text-anchor="middle" x="264140" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_1 -->
<g id="edge798" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274590.93,-964.99C274622.73,-954.1 274657.2,-944.07 274690,-938 274951.81,-889.58 276740.38,-860.27 277390.46,-851.11"/>
<polygon fill="black" stroke="black" points="277390.94,-854.6 277400.89,-850.96 277390.84,-847.6 277390.94,-854.6"/>
<text text-anchor="middle" x="274716" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_2 -->
<g id="edge799" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274235.52,-964.95C274215.13,-961.75 274194.74,-959.01 274175,-957 274072.17,-946.54 270557.35,-948.33 270454,-947 270280.19,-944.77 270236.81,-940.17 270063,-938 269162.18,-926.74 266909.84,-939.79 266009,-930 264529.03,-913.91 262752.44,-870.82 262108.92,-854.44"/>
<polygon fill="black" stroke="black" points="262108.68,-850.93 262098.6,-854.18 262108.5,-857.93 262108.68,-850.93"/>
<text text-anchor="middle" x="270480" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_3 -->
<g id="edge800" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274225.41,-964.95C274208.39,-962.04 274191.46,-959.35 274175,-957 274148.51,-953.22 274078.41,-959.97 274055,-947 274038.29,-937.74 274024.26,-922.95 274013.06,-907.6"/>
<polygon fill="black" stroke="black" points="274015.7,-905.27 274007.12,-899.04 274009.94,-909.25 274015.7,-905.27"/>
<text text-anchor="middle" x="274081" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_4 -->
<g id="edge801" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274233.5,-964.98C274213.78,-961.83 274194.09,-959.1 274175,-957 273939.49,-931.13 273877.78,-970.28 273642,-947 273619.53,-944.78 273614.45,-940.38 273592,-938 273119.95,-887.92 271706.95,-860.79 271134.68,-851.61"/>
<polygon fill="black" stroke="black" points="271134.7,-848.11 271124.65,-851.45 271134.59,-855.11 271134.7,-848.11"/>
<text text-anchor="middle" x="273668" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_5 -->
<g id="edge802" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274235.12,-964.94C274214.86,-961.76 274194.61,-959.02 274175,-957 274071.1,-946.29 272399.42,-949.24 272295,-947 272188.28,-944.72 272161.72,-940.29 272055,-938 271405.36,-924.05 271242.74,-937.99 270593,-930 269056.39,-911.1 267210.3,-869.36 266553.07,-853.91"/>
<polygon fill="black" stroke="black" points="266553.08,-850.41 266543,-853.67 266552.91,-857.4 266553.08,-850.41"/>
<text text-anchor="middle" x="272321" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_6 -->
<g id="edge803" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274643.27,-974.23C274680.63,-967.07 274719.94,-960.74 274757,-957 274871.68,-945.42 282940.75,-948.66 283056,-947 284320.84,-928.74 285836.49,-876.92 286404.34,-856.46"/>
<polygon fill="black" stroke="black" points="286404.83,-859.95 286414.69,-856.09 286404.57,-852.95 286404.83,-859.95"/>
<text text-anchor="middle" x="283568" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_7 -->
<g id="edge804" class="edge">
<title>layer_4_gate_tp_1&#45;&gt;layer_4_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274643.75,-974.93C274680.98,-967.74 274720.13,-961.23 274757,-957 275054.73,-922.88 275131.36,-942.7 275431,-938 276538.42,-920.62 276815.51,-942.57 277923,-930 279438.99,-912.79 281261.89,-869.59 281897.75,-853.85"/>
<polygon fill="black" stroke="black" points="281898.04,-857.35 281907.95,-853.6 281897.87,-850.35 281898.04,-857.35"/>
<text text-anchor="middle" x="275457" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2 -->
<g id="node430" class="node">
<title>layer_4_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="273583.99,-1069 273135.4,-1069 273020.01,-965 273468.6,-965 273583.99,-1069"/>
<text text-anchor="middle" x="273302" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="273302" y="-1020" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="273302" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="273302" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_0 -->
<g id="edge805" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273074.56,-1014.24C272096.39,-1006.7 268150.04,-976.63 264908,-957 264033.34,-951.7 263814.64,-954.63 262940,-947 262328.42,-941.67 262175.53,-939.64 261564,-930 260031.41,-905.84 258190.01,-867.32 257534.44,-853.31"/>
<polygon fill="black" stroke="black" points="257534.47,-849.81 257524.4,-853.1 257534.32,-856.81 257534.47,-849.81"/>
<text text-anchor="middle" x="262966" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_1 -->
<g id="edge806" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273480.61,-975.48C273517.6,-968.3 273556.44,-961.65 273593,-957 273676.45,-946.39 273698.22,-954.52 273782,-947 273813.68,-944.16 273821.28,-940.3 273853,-938 274041.43,-924.32 274089.12,-934.09 274278,-930 275448.72,-904.64 276849.56,-868.43 277393.84,-854.14"/>
<polygon fill="black" stroke="black" points="277394.27,-857.63 277404.17,-853.87 277394.08,-850.63 277394.27,-857.63"/>
<text text-anchor="middle" x="273879" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_2 -->
<g id="edge807" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273074.56,-1014.3C272096.38,-1006.99 268150.03,-977.75 264908,-957 264523.11,-954.54 263560.58,-962.57 263176,-947 262813.36,-932.32 262395.6,-897.86 262130.04,-873.74"/>
<polygon fill="black" stroke="black" points="262130.15,-870.24 262119.87,-872.82 262129.51,-877.21 262130.15,-870.24"/>
<text text-anchor="middle" x="263202" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_3 -->
<g id="edge808" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273364.87,-964.92C273380.2,-954.59 273397.08,-944.82 273414,-938 273521.59,-894.67 273648.53,-872.13 273754.99,-860.44"/>
<polygon fill="black" stroke="black" points="273755.66,-863.89 273765.23,-859.35 273754.91,-856.93 273755.66,-863.89"/>
<text text-anchor="middle" x="273440" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_4 -->
<g id="edge809" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273076.72,-1016.35C272734.21,-1014.87 272062.34,-1004.03 271495,-947 271387.28,-936.17 271269.65,-918.32 271166.99,-900.73"/>
<polygon fill="black" stroke="black" points="271167.55,-897.28 271157.1,-899.03 271166.36,-904.18 271167.55,-897.28"/>
<text text-anchor="middle" x="271521" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_5 -->
<g id="edge810" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273075,-1014.6C272409.76,-1010.06 270407.08,-993.27 268746,-947 267948.2,-924.78 267004.3,-881.7 266560.59,-860.46"/>
<polygon fill="black" stroke="black" points="266560.68,-856.96 266550.52,-859.98 266560.34,-863.95 266560.68,-856.96"/>
<text text-anchor="middle" x="268772" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_6 -->
<g id="edge811" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273479.31,-974.6C273516.66,-967.41 273555.97,-960.98 273593,-957 273750.55,-940.07 274148.94,-967.99 274306,-947 274321.92,-944.87 274325.07,-940.02 274341,-938 274396.71,-930.92 282370.85,-930.57 282427,-930 283943.24,-914.47 285766.44,-870.22 286402.04,-854.03"/>
<polygon fill="black" stroke="black" points="286402.33,-857.52 286412.23,-853.77 286402.15,-850.52 286402.33,-857.52"/>
<text text-anchor="middle" x="274367" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_7 -->
<g id="edge812" class="edge">
<title>layer_4_gate_tp_2&#45;&gt;layer_4_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273479.32,-974.65C273516.67,-967.47 273555.97,-961.02 273593,-957 273730.43,-942.09 274077.78,-963.75 274215,-947 274232.66,-944.85 274236.33,-940.03 274254,-938 274304.62,-932.18 277872.04,-930.55 277923,-930 279439,-913.57 281261.89,-869.89 281897.75,-853.94"/>
<polygon fill="black" stroke="black" points="281898.04,-857.43 281907.95,-853.68 281897.87,-850.43 281898.04,-857.43"/>
<text text-anchor="middle" x="274280" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3 -->
<g id="node431" class="node">
<title>layer_4_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="275329.99,-1069 274881.4,-1069 274766.01,-965 275214.6,-965 275329.99,-1069"/>
<text text-anchor="middle" x="275048" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="275048" y="-1020" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="275048" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="275048" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_0 -->
<g id="edge813" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274817.92,-964.99C274797.4,-961.76 274776.87,-959.01 274757,-957 274669.5,-948.15 268512.94,-947.18 268425,-947 268043.83,-946.23 261945.15,-934.13 261564,-930 260032.23,-913.42 258192.19,-870.3 257535.61,-854.19"/>
<polygon fill="black" stroke="black" points="257535.64,-850.69 257525.56,-853.95 257535.47,-857.69 257535.64,-850.69"/>
<text text-anchor="middle" x="268451" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_1 -->
<g id="edge814" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275229.55,-978.05C275274.31,-969.9 275322.24,-962.19 275367,-957 276100.45,-871.87 276975.31,-852.99 277388.05,-848.97"/>
<polygon fill="black" stroke="black" points="277388.36,-852.47 277398.32,-848.87 277388.29,-845.47 277388.36,-852.47"/>
<text text-anchor="middle" x="275513" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_2 -->
<g id="edge815" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274817.52,-964.96C274797.13,-961.75 274776.74,-959.01 274757,-957 274663.46,-947.47 271466.03,-947.63 271372,-947 270987.1,-944.43 270890.9,-940.34 270506,-938 269506.68,-931.92 267008.28,-940.77 266009,-930 264529.03,-914.06 262752.43,-870.88 262108.92,-854.46"/>
<polygon fill="black" stroke="black" points="262108.68,-850.95 262098.6,-854.19 262108.5,-857.95 262108.68,-850.95"/>
<text text-anchor="middle" x="271398" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_3 -->
<g id="edge816" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274815.9,-965C274796.05,-961.84 274776.22,-959.09 274757,-957 274691.38,-949.86 274226.83,-963.81 274163,-947 274128.81,-938 274094.04,-921.31 274064.18,-904.17"/>
<polygon fill="black" stroke="black" points="274065.89,-901.11 274055.49,-899.09 274062.35,-907.16 274065.89,-901.11"/>
<text text-anchor="middle" x="274189" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_4 -->
<g id="edge817" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274816.71,-964.98C274796.59,-961.79 274776.48,-959.05 274757,-957 274643.51,-945.05 273843.19,-961.49 273730,-947 273713.64,-944.91 273710.33,-940.28 273694,-938 273202.82,-869.52 271718.74,-853.04 271132.24,-849.16"/>
<polygon fill="black" stroke="black" points="271131.99,-845.66 271121.97,-849.09 271131.95,-852.66 271131.99,-845.66"/>
<text text-anchor="middle" x="273756" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_5 -->
<g id="edge818" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274817.12,-964.98C274796.86,-961.78 274776.61,-959.04 274757,-957 274678.75,-948.87 273419.67,-947.63 273341,-947 272899.22,-943.44 272788.79,-941.01 272347,-938 271567.45,-932.69 271372.51,-939.23 270593,-930 269056.61,-911.8 267210.86,-869.64 266553.36,-853.99"/>
<polygon fill="black" stroke="black" points="266553.37,-850.49 266543.29,-853.75 266553.21,-857.49 266553.37,-850.49"/>
<text text-anchor="middle" x="273367" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_6 -->
<g id="edge819" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275228.14,-976.78C275273.26,-968.59 275321.71,-961.18 275367,-957 275500.81,-944.66 284907.69,-951.24 285042,-947 285532.91,-931.5 286107.75,-889.96 286414.59,-865.9"/>
<polygon fill="black" stroke="black" points="286415.24,-869.36 286424.94,-865.08 286414.7,-862.38 286415.24,-869.36"/>
<text text-anchor="middle" x="285284" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_7 -->
<g id="edge820" class="edge">
<title>layer_4_gate_tp_3&#45;&gt;layer_4_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M275228.16,-977.08C275273.28,-968.88 275321.73,-961.39 275367,-957 275649.69,-929.57 277639.02,-934.27 277923,-930 279438.46,-907.23 281260.77,-867.51 281897.17,-853.27"/>
<polygon fill="black" stroke="black" points="281897.46,-856.76 281907.38,-853.04 281897.3,-849.76 281897.46,-856.76"/>
<text text-anchor="middle" x="276139" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_4_expert_0_ep_0 -->
<g id="node440" class="node">
<title>layer_4_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="254533.83,-729 254099.82,-729 253988.17,-625 254422.18,-625 254533.83,-729"/>
<text text-anchor="middle" x="254261" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="254261" y="-680" font-family="Arial" font-size="10.00">GPU: 128</text>
<text text-anchor="middle" x="254261" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="254261" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_0_ep_0 -->
<g id="edge821" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M257040.39,-831.18C256835.36,-819.47 256536.35,-803.7 256275,-795 255783.65,-778.64 255660.51,-787.66 255169,-777 254890.3,-770.95 254817.4,-803.18 254542,-760 254501.65,-753.67 254458.94,-743.24 254419.32,-731.89"/>
<polygon fill="black" stroke="black" points="254420.17,-728.5 254409.59,-729.07 254418.22,-735.22 254420.17,-728.5"/>
</g>
<!-- layer_4_expert_1_ep_0 -->
<g id="node441" class="node">
<title>layer_4_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="255096.83,-729 254662.82,-729 254551.17,-625 254985.18,-625 255096.83,-729"/>
<text text-anchor="middle" x="254824" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="254824" y="-680" font-family="Arial" font-size="10.00">GPU: 129</text>
<text text-anchor="middle" x="254824" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="254824" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_1_ep_0 -->
<g id="edge822" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M257041.65,-832.19C256836.56,-821.03 256536.83,-805.51 256275,-795 256015.09,-784.57 255361.92,-800.65 255105,-760 255064.77,-753.64 255022.19,-743.22 254982.68,-731.91"/>
<polygon fill="black" stroke="black" points="254983.55,-728.52 254972.97,-729.1 254981.6,-735.24 254983.55,-728.52"/>
</g>
<!-- layer_4_expert_2_ep_0 -->
<g id="node442" class="node">
<title>layer_4_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="255659.83,-729 255225.82,-729 255114.17,-625 255548.18,-625 255659.83,-729"/>
<text text-anchor="middle" x="255387" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="255387" y="-680" font-family="Arial" font-size="10.00">GPU: 130</text>
<text text-anchor="middle" x="255387" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="255387" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_2_ep_0 -->
<g id="edge823" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M257043.29,-833.73C256598.82,-811.36 255701.37,-765.68 255668,-760 255628.63,-753.3 255586.95,-742.99 255548.08,-731.91"/>
<polygon fill="black" stroke="black" points="255548.85,-728.49 255538.27,-729.08 255546.91,-735.21 255548.85,-728.49"/>
</g>
<!-- layer_4_expert_3_ep_0 -->
<g id="node443" class="node">
<title>layer_4_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="256222.83,-729 255788.82,-729 255677.17,-625 256111.18,-625 256222.83,-729"/>
<text text-anchor="middle" x="255950" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="255950" y="-680" font-family="Arial" font-size="10.00">GPU: 131</text>
<text text-anchor="middle" x="255950" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="255950" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_3_ep_0 -->
<g id="edge824" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M257051.1,-840.44C256835.69,-832.14 256509.82,-811.47 256231,-760 256192.53,-752.9 256151.79,-742.65 256113.62,-731.8"/>
<polygon fill="black" stroke="black" points="256114.55,-728.42 256103.98,-729.03 256112.62,-735.15 256114.55,-728.42"/>
</g>
<!-- layer_4_expert_4_ep_0 -->
<g id="node444" class="node">
<title>layer_4_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="256785.83,-729 256351.82,-729 256240.17,-625 256674.18,-625 256785.83,-729"/>
<text text-anchor="middle" x="256513" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="256513" y="-680" font-family="Arial" font-size="10.00">GPU: 132</text>
<text text-anchor="middle" x="256513" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="256513" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_4_ep_0 -->
<g id="edge825" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M257008.33,-802.91C256938.05,-790.55 256863,-776.02 256794,-760 256758.93,-751.86 256721.76,-741.94 256686.32,-731.86"/>
<polygon fill="black" stroke="black" points="256686.95,-728.4 256676.38,-729.01 256685.03,-735.13 256686.95,-728.4"/>
</g>
<!-- layer_4_expert_5_ep_0 -->
<g id="node445" class="node">
<title>layer_4_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="257348.83,-729 256914.82,-729 256803.17,-625 257237.18,-625 257348.83,-729"/>
<text text-anchor="middle" x="257076" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="257076" y="-680" font-family="Arial" font-size="10.00">GPU: 133</text>
<text text-anchor="middle" x="257076" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="257076" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_5_ep_0 -->
<g id="edge826" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M257223.53,-794.91C257199.89,-776.18 257172.97,-754.85 257148.66,-735.58"/>
<polygon fill="black" stroke="black" points="257150.54,-732.6 257140.53,-729.14 257146.19,-738.09 257150.54,-732.6"/>
</g>
<!-- layer_4_expert_6_ep_0 -->
<g id="node446" class="node">
<title>layer_4_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="257911.83,-729 257477.82,-729 257366.17,-625 257800.18,-625 257911.83,-729"/>
<text text-anchor="middle" x="257639" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="257639" y="-680" font-family="Arial" font-size="10.00">GPU: 134</text>
<text text-anchor="middle" x="257639" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="257639" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_6_ep_0 -->
<g id="edge827" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M257394.74,-794.91C257435.33,-775.48 257481.74,-753.27 257523.14,-733.46"/>
<polygon fill="black" stroke="black" points="257524.65,-736.61 257532.16,-729.14 257521.63,-730.3 257524.65,-736.61"/>
</g>
<!-- layer_4_expert_7_ep_0 -->
<g id="node447" class="node">
<title>layer_4_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="258474.83,-729 258040.82,-729 257929.17,-625 258363.18,-625 258474.83,-729"/>
<text text-anchor="middle" x="258202" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="258202" y="-680" font-family="Arial" font-size="10.00">GPU: 135</text>
<text text-anchor="middle" x="258202" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="258202" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_0&#45;&gt;layer_4_expert_7_ep_0 -->
<g id="edge828" class="edge">
<title>layer_4_route_ep_0&#45;&gt;layer_4_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M257493.52,-825.92C257618.02,-811.82 257779.57,-790.07 257921,-760 257957.39,-752.26 257995.95,-742.25 258032.46,-731.88"/>
<polygon fill="black" stroke="black" points="258033.54,-735.22 258042.19,-729.1 258031.61,-728.48 258033.54,-735.22"/>
</g>
<!-- layer_4_expert_0_ep_1 -->
<g id="node448" class="node">
<title>layer_4_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="277053.83,-729 276619.82,-729 276508.17,-625 276942.18,-625 277053.83,-729"/>
<text text-anchor="middle" x="276781" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="276781" y="-680" font-family="Arial" font-size="10.00">GPU: 144</text>
<text text-anchor="middle" x="276781" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="276781" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_0_ep_1 -->
<g id="edge829" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M277357.12,-812.42C277263.25,-798.74 277157.5,-781.12 277062,-760 277026.13,-752.07 276988.11,-742.08 276952.02,-731.82"/>
<polygon fill="black" stroke="black" points="276952.97,-728.45 276942.39,-729.07 276951.04,-735.18 276952.97,-728.45"/>
</g>
<!-- layer_4_expert_1_ep_1 -->
<g id="node449" class="node">
<title>layer_4_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="277616.83,-729 277182.82,-729 277071.17,-625 277505.18,-625 277616.83,-729"/>
<text text-anchor="middle" x="277344" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="277344" y="-680" font-family="Arial" font-size="10.00">GPU: 145</text>
<text text-anchor="middle" x="277344" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="277344" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_1_ep_1 -->
<g id="edge830" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M277540.24,-794.91C277508.11,-775.77 277471.44,-753.92 277438.55,-734.33"/>
<polygon fill="black" stroke="black" points="277440.22,-731.25 277429.84,-729.14 277436.64,-737.26 277440.22,-731.25"/>
</g>
<!-- layer_4_expert_2_ep_1 -->
<g id="node450" class="node">
<title>layer_4_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="278179.83,-729 277745.82,-729 277634.17,-625 278068.18,-625 278179.83,-729"/>
<text text-anchor="middle" x="277907" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="277907" y="-680" font-family="Arial" font-size="10.00">GPU: 146</text>
<text text-anchor="middle" x="277907" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="277907" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_2_ep_1 -->
<g id="edge831" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M277711.45,-794.91C277743.47,-775.77 277780.02,-753.92 277812.78,-734.33"/>
<polygon fill="black" stroke="black" points="277814.68,-737.27 277821.47,-729.14 277811.09,-731.26 277814.68,-737.27"/>
</g>
<!-- layer_4_expert_3_ep_1 -->
<g id="node451" class="node">
<title>layer_4_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="278742.83,-729 278308.82,-729 278197.17,-625 278631.18,-625 278742.83,-729"/>
<text text-anchor="middle" x="278470" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="278470" y="-680" font-family="Arial" font-size="10.00">GPU: 147</text>
<text text-anchor="middle" x="278470" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="278470" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_3_ep_1 -->
<g id="edge832" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M277827.18,-821.85C277935.1,-807.24 278070.01,-786.33 278189,-760 278224.87,-752.06 278262.89,-742.07 278298.98,-731.82"/>
<polygon fill="black" stroke="black" points="278299.96,-735.18 278308.61,-729.06 278298.03,-728.45 278299.96,-735.18"/>
</g>
<!-- layer_4_expert_4_ep_1 -->
<g id="node452" class="node">
<title>layer_4_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="279305.83,-729 278871.82,-729 278760.17,-625 279194.18,-625 279305.83,-729"/>
<text text-anchor="middle" x="279033" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="279033" y="-680" font-family="Arial" font-size="10.00">GPU: 148</text>
<text text-anchor="middle" x="279033" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="279033" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_4_ep_1 -->
<g id="edge833" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M277850.47,-842.54C278078.99,-835.82 278442.66,-816.32 278752,-760 278790.6,-752.97 278831.48,-742.73 278869.75,-731.84"/>
<polygon fill="black" stroke="black" points="278870.77,-735.19 278879.42,-729.06 278868.84,-728.46 278870.77,-735.19"/>
</g>
<!-- layer_4_expert_5_ep_1 -->
<g id="node453" class="node">
<title>layer_4_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="279868.83,-729 279434.82,-729 279323.17,-625 279757.18,-625 279868.83,-729"/>
<text text-anchor="middle" x="279596" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="279596" y="-680" font-family="Arial" font-size="10.00">GPU: 149</text>
<text text-anchor="middle" x="279596" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="279596" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_5_ep_1 -->
<g id="edge834" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M277848.9,-841.09C278241.24,-831.39 279039.7,-806.52 279315,-760 279354.5,-753.33 279396.31,-742.99 279435.27,-731.88"/>
<polygon fill="black" stroke="black" points="279436.47,-735.17 279445.11,-729.04 279434.53,-728.45 279436.47,-735.17"/>
</g>
<!-- layer_4_expert_6_ep_1 -->
<g id="node454" class="node">
<title>layer_4_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="280431.83,-729 279997.82,-729 279886.17,-625 280320.18,-625 280431.83,-729"/>
<text text-anchor="middle" x="280159" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="280159" y="-680" font-family="Arial" font-size="10.00">GPU: 150</text>
<text text-anchor="middle" x="280159" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="280159" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_6_ep_1 -->
<g id="edge835" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M277852.68,-844.41C278343.92,-839.8 279493.37,-822.49 279878,-760 279917.88,-753.52 279960.1,-743.16 279999.35,-731.94"/>
<polygon fill="black" stroke="black" points="280000.63,-735.22 280009.27,-729.08 279998.69,-728.49 280000.63,-735.22"/>
</g>
<!-- layer_4_expert_7_ep_1 -->
<g id="node455" class="node">
<title>layer_4_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="280994.83,-729 280560.82,-729 280449.17,-625 280883.18,-625 280994.83,-729"/>
<text text-anchor="middle" x="280722" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="280722" y="-680" font-family="Arial" font-size="10.00">GPU: 151</text>
<text text-anchor="middle" x="280722" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="280722" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_1&#45;&gt;layer_4_expert_7_ep_1 -->
<g id="edge836" class="edge">
<title>layer_4_route_ep_1&#45;&gt;layer_4_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M277855.07,-846.46C278434.06,-846.44 279945.26,-838.6 280441,-760 280481.23,-753.62 280523.8,-743.2 280563.32,-731.89"/>
<polygon fill="black" stroke="black" points="280564.4,-735.23 280573.03,-729.08 280562.45,-728.5 280564.4,-735.23"/>
</g>
<!-- layer_4_expert_0_ep_2 -->
<g id="node456" class="node">
<title>layer_4_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="259037.83,-729 258603.82,-729 258492.17,-625 258926.18,-625 259037.83,-729"/>
<text text-anchor="middle" x="258765" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="258765" y="-680" font-family="Arial" font-size="10.00">GPU: 160</text>
<text text-anchor="middle" x="258765" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="258765" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_0_ep_2 -->
<g id="edge837" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M261630.87,-846.46C261051.1,-846.43 259541.44,-838.55 259046,-760 259005.77,-753.62 258963.2,-743.2 258923.68,-731.89"/>
<polygon fill="black" stroke="black" points="258924.55,-728.5 258913.97,-729.08 258922.6,-735.23 258924.55,-728.5"/>
</g>
<!-- layer_4_expert_1_ep_2 -->
<g id="node457" class="node">
<title>layer_4_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="259600.83,-729 259166.82,-729 259055.17,-625 259489.18,-625 259600.83,-729"/>
<text text-anchor="middle" x="259328" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="259328" y="-680" font-family="Arial" font-size="10.00">GPU: 161</text>
<text text-anchor="middle" x="259328" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="259328" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_1_ep_2 -->
<g id="edge838" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M261628.28,-844.35C261133.72,-839.66 259992.06,-822.23 259609,-760 259569.12,-753.52 259526.9,-743.16 259487.65,-731.94"/>
<polygon fill="black" stroke="black" points="259488.31,-728.49 259477.73,-729.08 259486.37,-735.22 259488.31,-728.49"/>
</g>
<!-- layer_4_expert_2_ep_2 -->
<g id="node458" class="node">
<title>layer_4_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="260163.83,-729 259729.82,-729 259618.17,-625 260052.18,-625 260163.83,-729"/>
<text text-anchor="middle" x="259891" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="259891" y="-680" font-family="Arial" font-size="10.00">GPU: 162</text>
<text text-anchor="middle" x="259891" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="259891" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_2_ep_2 -->
<g id="edge839" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M261624.4,-840.75C261227.46,-830.81 260444.13,-805.99 260172,-760 260132.5,-753.33 260090.69,-742.99 260051.73,-731.88"/>
<polygon fill="black" stroke="black" points="260052.47,-728.45 260041.89,-729.04 260050.53,-735.17 260052.47,-728.45"/>
</g>
<!-- layer_4_expert_3_ep_2 -->
<g id="node459" class="node">
<title>layer_4_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="260726.83,-729 260292.82,-729 260181.17,-625 260615.18,-625 260726.83,-729"/>
<text text-anchor="middle" x="260454" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="260454" y="-680" font-family="Arial" font-size="10.00">GPU: 163</text>
<text text-anchor="middle" x="260454" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="260454" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_3_ep_2 -->
<g id="edge840" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M261626.02,-842.22C261396.96,-835.22 261039.64,-815.46 260735,-760 260696.4,-752.97 260655.52,-742.73 260617.25,-731.84"/>
<polygon fill="black" stroke="black" points="260618.16,-728.46 260607.58,-729.06 260616.23,-735.19 260618.16,-728.46"/>
</g>
<!-- layer_4_expert_4_ep_2 -->
<g id="node460" class="node">
<title>layer_4_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="261289.83,-729 260855.82,-729 260744.17,-625 261178.18,-625 261289.83,-729"/>
<text text-anchor="middle" x="261017" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="261017" y="-680" font-family="Arial" font-size="10.00">GPU: 164</text>
<text text-anchor="middle" x="261017" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="261017" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_4_ep_2 -->
<g id="edge841" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M261592.25,-812.34C261498.63,-798.67 261393.21,-781.07 261298,-760 261262.13,-752.06 261224.11,-742.07 261188.02,-731.82"/>
<polygon fill="black" stroke="black" points="261188.97,-728.45 261178.39,-729.06 261187.04,-735.18 261188.97,-728.45"/>
</g>
<!-- layer_4_expert_5_ep_2 -->
<g id="node461" class="node">
<title>layer_4_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="261852.83,-729 261418.82,-729 261307.17,-625 261741.18,-625 261852.83,-729"/>
<text text-anchor="middle" x="261580" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="261580" y="-680" font-family="Arial" font-size="10.00">GPU: 165</text>
<text text-anchor="middle" x="261580" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="261580" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_5_ep_2 -->
<g id="edge842" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M261775.55,-794.91C261743.53,-775.77 261706.98,-753.92 261674.22,-734.33"/>
<polygon fill="black" stroke="black" points="261675.91,-731.26 261665.53,-729.14 261672.32,-737.27 261675.91,-731.26"/>
</g>
<!-- layer_4_expert_6_ep_2 -->
<g id="node462" class="node">
<title>layer_4_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="262415.83,-729 261981.82,-729 261870.17,-625 262304.18,-625 262415.83,-729"/>
<text text-anchor="middle" x="262143" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="262143" y="-680" font-family="Arial" font-size="10.00">GPU: 166</text>
<text text-anchor="middle" x="262143" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="262143" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_6_ep_2 -->
<g id="edge843" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M261946.76,-794.91C261978.89,-775.77 262015.56,-753.92 262048.45,-734.33"/>
<polygon fill="black" stroke="black" points="262050.36,-737.26 262057.16,-729.14 262046.78,-731.25 262050.36,-737.26"/>
</g>
<!-- layer_4_expert_7_ep_2 -->
<g id="node463" class="node">
<title>layer_4_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="262978.83,-729 262544.82,-729 262433.17,-625 262867.18,-625 262978.83,-729"/>
<text text-anchor="middle" x="262706" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="262706" y="-680" font-family="Arial" font-size="10.00">GPU: 167</text>
<text text-anchor="middle" x="262706" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="262706" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_2&#45;&gt;layer_4_expert_7_ep_2 -->
<g id="edge844" class="edge">
<title>layer_4_route_ep_2&#45;&gt;layer_4_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M262062.2,-821.91C262170.38,-807.31 262305.68,-786.38 262425,-760 262460.87,-752.07 262498.89,-742.08 262534.98,-731.82"/>
<polygon fill="black" stroke="black" points="262535.96,-735.18 262544.61,-729.07 262534.03,-728.45 262535.96,-735.18"/>
</g>
<!-- layer_4_expert_0_ep_3 -->
<g id="node464" class="node">
<title>layer_4_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="271986.83,-729 271552.82,-729 271441.17,-625 271875.18,-625 271986.83,-729"/>
<text text-anchor="middle" x="271714" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="271714" y="-680" font-family="Arial" font-size="10.00">GPU: 176</text>
<text text-anchor="middle" x="271714" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="271714" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_0_ep_3 -->
<g id="edge845" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M273746.95,-842.92C273296.75,-835.83 272325.5,-814.56 271995,-760 271955.25,-753.44 271913.17,-743.08 271874.01,-731.9"/>
<polygon fill="black" stroke="black" points="271874.7,-728.45 271864.12,-729.04 271872.76,-735.18 271874.7,-728.45"/>
</g>
<!-- layer_4_expert_1_ep_3 -->
<g id="node465" class="node">
<title>layer_4_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="272549.83,-729 272115.82,-729 272004.17,-625 272438.18,-625 272549.83,-729"/>
<text text-anchor="middle" x="272277" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="272277" y="-680" font-family="Arial" font-size="10.00">GPU: 177</text>
<text text-anchor="middle" x="272277" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="272277" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_1_ep_3 -->
<g id="edge846" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M273741.19,-837.99C273396.51,-825.38 272778.3,-798.3 272558,-760 272518.88,-753.2 272477.47,-742.91 272438.8,-731.9"/>
<polygon fill="black" stroke="black" points="272439.61,-728.49 272429.04,-729.09 272437.68,-735.22 272439.61,-728.49"/>
</g>
<!-- layer_4_expert_2_ep_3 -->
<g id="node466" class="node">
<title>layer_4_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="273112.83,-729 272678.82,-729 272567.17,-625 273001.18,-625 273112.83,-729"/>
<text text-anchor="middle" x="272840" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="272840" y="-680" font-family="Arial" font-size="10.00">GPU: 178</text>
<text text-anchor="middle" x="272840" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="272840" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_2_ep_3 -->
<g id="edge847" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M273735.99,-833.54C273562.96,-821.81 273326.3,-799.87 273121,-760 273083.33,-752.69 273043.44,-742.55 273005.91,-731.9"/>
<polygon fill="black" stroke="black" points="273006.49,-728.43 272995.91,-729.03 273004.56,-735.15 273006.49,-728.43"/>
</g>
<!-- layer_4_expert_3_ep_3 -->
<g id="node467" class="node">
<title>layer_4_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="274238.83,-729 273804.82,-729 273693.17,-625 274127.18,-625 274238.83,-729"/>
<text text-anchor="middle" x="273966" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="273966" y="-680" font-family="Arial" font-size="10.00">GPU: 179</text>
<text text-anchor="middle" x="273966" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="273966" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_3_ep_3 -->
<g id="edge848" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M273976.42,-794.68C273974.85,-777.1 273973.08,-757.24 273971.44,-738.97"/>
<polygon fill="black" stroke="black" points="273974.93,-738.65 273970.55,-729 273967.96,-739.28 273974.93,-738.65"/>
</g>
<!-- layer_4_expert_4_ep_3 -->
<g id="node468" class="node">
<title>layer_4_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="274801.83,-729 274367.82,-729 274256.17,-625 274690.18,-625 274801.83,-729"/>
<text text-anchor="middle" x="274529" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="274529" y="-680" font-family="Arial" font-size="10.00">GPU: 180</text>
<text text-anchor="middle" x="274529" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="274529" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_4_ep_3 -->
<g id="edge849" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M274147.65,-794.91C274213.83,-774.62 274289.93,-751.29 274356.66,-730.83"/>
<polygon fill="black" stroke="black" points="274357.9,-734.11 274366.44,-727.84 274355.85,-727.42 274357.9,-734.11"/>
</g>
<!-- layer_4_expert_5_ep_3 -->
<g id="node469" class="node">
<title>layer_4_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="275364.83,-729 274930.82,-729 274819.17,-625 275253.18,-625 275364.83,-729"/>
<text text-anchor="middle" x="275092" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="275092" y="-680" font-family="Arial" font-size="10.00">GPU: 181</text>
<text text-anchor="middle" x="275092" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="275092" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_5_ep_3 -->
<g id="edge850" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M274196.24,-834.4C274364.73,-822.75 274604.33,-800.52 274811,-760 274848.54,-752.64 274888.3,-742.52 274925.72,-731.9"/>
<polygon fill="black" stroke="black" points="274927.05,-735.16 274935.7,-729.04 274925.12,-728.43 274927.05,-735.16"/>
</g>
<!-- layer_4_expert_6_ep_3 -->
<g id="node470" class="node">
<title>layer_4_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="275927.83,-729 275493.82,-729 275382.17,-625 275816.18,-625 275927.83,-729"/>
<text text-anchor="middle" x="275655" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="275655" y="-680" font-family="Arial" font-size="10.00">GPU: 182</text>
<text text-anchor="middle" x="275655" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="275655" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_6_ep_3 -->
<g id="edge851" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M274200.88,-838.39C274535.08,-825.8 275155.15,-798.2 275374,-760 275413.11,-753.17 275454.53,-742.88 275493.19,-731.86"/>
<polygon fill="black" stroke="black" points="275494.32,-735.18 275502.96,-729.05 275492.38,-728.45 275494.32,-735.18"/>
</g>
<!-- layer_4_expert_7_ep_3 -->
<g id="node471" class="node">
<title>layer_4_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="276490.83,-729 276056.82,-729 275945.17,-625 276379.18,-625 276490.83,-729"/>
<text text-anchor="middle" x="276218" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="276218" y="-680" font-family="Arial" font-size="10.00">GPU: 183</text>
<text text-anchor="middle" x="276218" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="276218" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_3&#45;&gt;layer_4_expert_7_ep_3 -->
<g id="edge852" class="edge">
<title>layer_4_route_ep_3&#45;&gt;layer_4_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M274205.98,-842.88C274646.89,-835.66 275610.13,-814.07 275937,-760 275976.75,-753.42 276018.83,-743.06 276057.98,-731.88"/>
<polygon fill="black" stroke="black" points="276059.24,-735.16 276067.87,-729.02 276057.29,-728.43 276059.24,-735.16"/>
</g>
<!-- layer_4_expert_0_ep_4 -->
<g id="node472" class="node">
<title>layer_4_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="268045.83,-729 267611.82,-729 267500.17,-625 267934.18,-625 268045.83,-729"/>
<text text-anchor="middle" x="267773" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="267773" y="-680" font-family="Arial" font-size="10.00">GPU: 192</text>
<text text-anchor="middle" x="267773" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="267773" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_0_ep_4 -->
<g id="edge853" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M270660.02,-846.53C270077.3,-846.66 268553.67,-839.16 268054,-760 268013.77,-753.63 267971.19,-743.21 267931.68,-731.9"/>
<polygon fill="black" stroke="black" points="267932.55,-728.51 267921.97,-729.09 267930.6,-735.23 267932.55,-728.51"/>
</g>
<!-- layer_4_expert_1_ep_4 -->
<g id="node473" class="node">
<title>layer_4_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="268608.83,-729 268174.82,-729 268063.17,-625 268497.18,-625 268608.83,-729"/>
<text text-anchor="middle" x="268336" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="268336" y="-680" font-family="Arial" font-size="10.00">GPU: 193</text>
<text text-anchor="middle" x="268336" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="268336" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_1_ep_4 -->
<g id="edge854" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M270657.46,-844.45C270159.57,-839.94 269004.24,-822.84 268617,-760 268577.11,-753.53 268534.9,-743.17 268495.65,-731.95"/>
<polygon fill="black" stroke="black" points="268496.31,-728.5 268485.73,-729.09 268494.37,-735.23 268496.31,-728.5"/>
</g>
<!-- layer_4_expert_2_ep_4 -->
<g id="node474" class="node">
<title>layer_4_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="269171.83,-729 268737.82,-729 268626.17,-625 269060.18,-625 269171.83,-729"/>
<text text-anchor="middle" x="268899" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="268899" y="-680" font-family="Arial" font-size="10.00">GPU: 194</text>
<text text-anchor="middle" x="268899" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="268899" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_2_ep_4 -->
<g id="edge855" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M270653.66,-840.93C270252.81,-831.2 269456.26,-806.59 269180,-760 269140.5,-753.34 269098.69,-743.01 269059.73,-731.89"/>
<polygon fill="black" stroke="black" points="269060.47,-728.46 269049.89,-729.05 269058.53,-735.19 269060.47,-728.46"/>
</g>
<!-- layer_4_expert_3_ep_4 -->
<g id="node475" class="node">
<title>layer_4_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="269734.83,-729 269300.82,-729 269189.17,-625 269623.18,-625 269734.83,-729"/>
<text text-anchor="middle" x="269462" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="269462" y="-680" font-family="Arial" font-size="10.00">GPU: 195</text>
<text text-anchor="middle" x="269462" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="269462" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_3_ep_4 -->
<g id="edge856" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M270655.6,-842.72C270422.5,-836.12 270055.54,-816.67 269743,-760 269704.39,-753 269663.51,-742.76 269625.25,-731.88"/>
<polygon fill="black" stroke="black" points="269626.15,-728.5 269615.58,-729.1 269624.22,-735.23 269626.15,-728.5"/>
</g>
<!-- layer_4_expert_4_ep_4 -->
<g id="node476" class="node">
<title>layer_4_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="270297.83,-729 269863.82,-729 269752.17,-625 270186.18,-625 270297.83,-729"/>
<text text-anchor="middle" x="270025" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="270025" y="-680" font-family="Arial" font-size="10.00">GPU: 196</text>
<text text-anchor="middle" x="270025" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="270025" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_4_ep_4 -->
<g id="edge857" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M270623.68,-814.65C270523.53,-800.8 270409,-782.5 270306,-760 270270,-752.13 270231.84,-742.15 270195.64,-731.87"/>
<polygon fill="black" stroke="black" points="270196.56,-728.49 270185.99,-729.11 270194.64,-735.22 270196.56,-728.49"/>
</g>
<!-- layer_4_expert_5_ep_4 -->
<g id="node477" class="node">
<title>layer_4_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="270860.83,-729 270426.82,-729 270315.17,-625 270749.18,-625 270860.83,-729"/>
<text text-anchor="middle" x="270588" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="270588" y="-680" font-family="Arial" font-size="10.00">GPU: 197</text>
<text text-anchor="middle" x="270588" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="270588" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_5_ep_4 -->
<g id="edge858" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M270798.16,-794.91C270763.6,-775.69 270724.14,-753.73 270688.81,-734.08"/>
<polygon fill="black" stroke="black" points="270690.36,-730.94 270679.92,-729.14 270686.96,-737.06 270690.36,-730.94"/>
</g>
<!-- layer_4_expert_6_ep_4 -->
<g id="node478" class="node">
<title>layer_4_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="271423.83,-729 270989.82,-729 270878.17,-625 271312.18,-625 271423.83,-729"/>
<text text-anchor="middle" x="271151" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="271151" y="-680" font-family="Arial" font-size="10.00">GPU: 198</text>
<text text-anchor="middle" x="271151" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="271151" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_6_ep_4 -->
<g id="edge859" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M270969.37,-794.91C270998.98,-775.85 271032.76,-754.11 271063.1,-734.58"/>
<polygon fill="black" stroke="black" points="271065.04,-737.49 271071.56,-729.14 271061.25,-731.61 271065.04,-737.49"/>
</g>
<!-- layer_4_expert_7_ep_4 -->
<g id="node479" class="node">
<title>layer_4_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="273675.83,-729 273241.82,-729 273130.17,-625 273564.18,-625 273675.83,-729"/>
<text text-anchor="middle" x="273403" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="273403" y="-680" font-family="Arial" font-size="10.00">GPU: 199</text>
<text text-anchor="middle" x="273403" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="273403" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_4&#45;&gt;layer_4_expert_7_ep_4 -->
<g id="edge860" class="edge">
<title>layer_4_route_ep_4&#45;&gt;layer_4_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M271116.5,-844.32C271604.4,-839.54 272741.27,-821.92 273122,-760 273161.88,-753.51 273204.1,-743.15 273243.35,-731.93"/>
<polygon fill="black" stroke="black" points="273244.63,-735.21 273253.26,-729.07 273242.68,-728.48 273244.63,-735.21"/>
</g>
<!-- layer_4_expert_0_ep_5 -->
<g id="node480" class="node">
<title>layer_4_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="263541.83,-729 263107.82,-729 262996.17,-625 263430.18,-625 263541.83,-729"/>
<text text-anchor="middle" x="263269" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="263269" y="-680" font-family="Arial" font-size="10.00">GPU: 208</text>
<text text-anchor="middle" x="263269" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="263269" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_0_ep_5 -->
<g id="edge861" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M266075.75,-846.28C265504.52,-845.79 264033.63,-836.84 263550,-760 263509.78,-753.61 263467.2,-743.18 263427.68,-731.88"/>
<polygon fill="black" stroke="black" points="263428.55,-728.48 263417.97,-729.06 263426.6,-735.21 263428.55,-728.48"/>
</g>
<!-- layer_4_expert_1_ep_5 -->
<g id="node481" class="node">
<title>layer_4_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="264104.83,-729 263670.82,-729 263559.17,-625 263993.18,-625 264104.83,-729"/>
<text text-anchor="middle" x="263832" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="263832" y="-680" font-family="Arial" font-size="10.00">GPU: 209</text>
<text text-anchor="middle" x="263832" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="263832" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_1_ep_5 -->
<g id="edge862" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M266072.96,-844.06C265587.97,-838.85 264484.36,-820.53 264113,-760 264073.12,-753.5 264030.9,-743.13 263991.65,-731.91"/>
<polygon fill="black" stroke="black" points="263992.32,-728.46 263981.74,-729.05 263990.37,-735.19 263992.32,-728.46"/>
</g>
<!-- layer_4_expert_2_ep_5 -->
<g id="node482" class="node">
<title>layer_4_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="264667.83,-729 264233.82,-729 264122.17,-625 264556.18,-625 264667.83,-729"/>
<text text-anchor="middle" x="264395" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="264395" y="-680" font-family="Arial" font-size="10.00">GPU: 210</text>
<text text-anchor="middle" x="264395" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="264395" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_2_ep_5 -->
<g id="edge863" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M266068.81,-840.23C265683.05,-829.7 264936.6,-804.28 264676,-760 264636.63,-753.31 264594.94,-743 264556.08,-731.92"/>
<polygon fill="black" stroke="black" points="264556.84,-728.5 264546.27,-729.09 264554.9,-735.22 264556.84,-728.5"/>
</g>
<!-- layer_4_expert_3_ep_5 -->
<g id="node483" class="node">
<title>layer_4_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="265230.83,-729 264796.82,-729 264685.17,-625 265119.18,-625 265230.83,-729"/>
<text text-anchor="middle" x="264958" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="264958" y="-680" font-family="Arial" font-size="10.00">GPU: 211</text>
<text text-anchor="middle" x="264958" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="264958" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_3_ep_5 -->
<g id="edge864" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M266069.24,-840.71C265851.82,-832.59 265521.49,-812.04 265239,-760 265200.53,-752.91 265159.79,-742.67 265121.62,-731.82"/>
<polygon fill="black" stroke="black" points="265122.55,-728.45 265111.97,-729.05 265120.62,-735.17 265122.55,-728.45"/>
</g>
<!-- layer_4_expert_4_ep_5 -->
<g id="node484" class="node">
<title>layer_4_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="265793.83,-729 265359.82,-729 265248.17,-625 265682.18,-625 265793.83,-729"/>
<text text-anchor="middle" x="265521" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="265521" y="-680" font-family="Arial" font-size="10.00">GPU: 212</text>
<text text-anchor="middle" x="265521" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="265521" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_4_ep_5 -->
<g id="edge865" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M266028.24,-804.49C265954.37,-791.85 265874.87,-776.79 265802,-760 265766.92,-751.92 265729.74,-742.03 265694.3,-731.95"/>
<polygon fill="black" stroke="black" points="265694.93,-728.49 265684.36,-729.11 265693.01,-735.22 265694.93,-728.49"/>
</g>
<!-- layer_4_expert_5_ep_5 -->
<g id="node485" class="node">
<title>layer_4_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="266356.83,-729 265922.82,-729 265811.17,-625 266245.18,-625 266356.83,-729"/>
<text text-anchor="middle" x="266084" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="266084" y="-680" font-family="Arial" font-size="10.00">GPU: 213</text>
<text text-anchor="middle" x="266084" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="266084" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_5_ep_5 -->
<g id="edge866" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M266238.49,-794.91C266213.63,-776.09 266185.3,-754.66 266159.76,-735.33"/>
<polygon fill="black" stroke="black" points="266161.66,-732.38 266151.57,-729.14 266157.43,-737.96 266161.66,-732.38"/>
</g>
<!-- layer_4_expert_6_ep_5 -->
<g id="node486" class="node">
<title>layer_4_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="266919.83,-729 266485.82,-729 266374.17,-625 266808.18,-625 266919.83,-729"/>
<text text-anchor="middle" x="266647" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="266647" y="-680" font-family="Arial" font-size="10.00">GPU: 214</text>
<text text-anchor="middle" x="266647" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="266647" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_6_ep_5 -->
<g id="edge867" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M266409.7,-794.91C266449.05,-775.52 266494.03,-753.36 266534.18,-733.58"/>
<polygon fill="black" stroke="black" points="266535.78,-736.7 266543.21,-729.14 266532.69,-730.42 266535.78,-736.7"/>
</g>
<!-- layer_4_expert_7_ep_5 -->
<g id="node487" class="node">
<title>layer_4_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="267482.83,-729 267048.82,-729 266937.17,-625 267371.18,-625 267482.83,-729"/>
<text text-anchor="middle" x="267210" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="267210" y="-680" font-family="Arial" font-size="10.00">GPU: 215</text>
<text text-anchor="middle" x="267210" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="267210" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_5&#45;&gt;layer_4_expert_7_ep_5 -->
<g id="edge868" class="edge">
<title>layer_4_route_ep_5&#45;&gt;layer_4_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M266511.09,-825.36C266633.23,-811.17 266790.86,-789.52 266929,-760 266965.38,-752.22 267003.94,-742.19 267040.44,-731.82"/>
<polygon fill="black" stroke="black" points="267041.53,-735.16 267050.18,-729.04 267039.6,-728.43 267041.53,-735.16"/>
</g>
<!-- layer_4_expert_0_ep_6 -->
<g id="node488" class="node">
<title>layer_4_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="286061.83,-729 285627.82,-729 285516.17,-625 285950.18,-625 286061.83,-729"/>
<text text-anchor="middle" x="285789" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="285789" y="-680" font-family="Arial" font-size="10.00">GPU: 224</text>
<text text-anchor="middle" x="285789" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="285789" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_0_ep_6 -->
<g id="edge869" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M286365.12,-812.42C286271.25,-798.74 286165.5,-781.12 286070,-760 286034.13,-752.07 285996.11,-742.08 285960.02,-731.82"/>
<polygon fill="black" stroke="black" points="285960.97,-728.45 285950.39,-729.07 285959.04,-735.18 285960.97,-728.45"/>
</g>
<!-- layer_4_expert_1_ep_6 -->
<g id="node489" class="node">
<title>layer_4_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="286624.83,-729 286190.82,-729 286079.17,-625 286513.18,-625 286624.83,-729"/>
<text text-anchor="middle" x="286352" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="286352" y="-680" font-family="Arial" font-size="10.00">GPU: 225</text>
<text text-anchor="middle" x="286352" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="286352" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_1_ep_6 -->
<g id="edge870" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M286548.24,-794.91C286516.11,-775.77 286479.44,-753.92 286446.55,-734.33"/>
<polygon fill="black" stroke="black" points="286448.22,-731.25 286437.84,-729.14 286444.64,-737.26 286448.22,-731.25"/>
</g>
<!-- layer_4_expert_2_ep_6 -->
<g id="node490" class="node">
<title>layer_4_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="287187.83,-729 286753.82,-729 286642.17,-625 287076.18,-625 287187.83,-729"/>
<text text-anchor="middle" x="286915" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="286915" y="-680" font-family="Arial" font-size="10.00">GPU: 226</text>
<text text-anchor="middle" x="286915" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="286915" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_2_ep_6 -->
<g id="edge871" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M286719.45,-794.91C286751.47,-775.77 286788.02,-753.92 286820.78,-734.33"/>
<polygon fill="black" stroke="black" points="286822.68,-737.27 286829.47,-729.14 286819.09,-731.26 286822.68,-737.27"/>
</g>
<!-- layer_4_expert_3_ep_6 -->
<g id="node491" class="node">
<title>layer_4_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="287750.83,-729 287316.82,-729 287205.17,-625 287639.18,-625 287750.83,-729"/>
<text text-anchor="middle" x="287478" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="287478" y="-680" font-family="Arial" font-size="10.00">GPU: 227</text>
<text text-anchor="middle" x="287478" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="287478" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_3_ep_6 -->
<g id="edge872" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M286835.18,-821.85C286943.1,-807.24 287078.01,-786.33 287197,-760 287232.87,-752.06 287270.89,-742.07 287306.98,-731.82"/>
<polygon fill="black" stroke="black" points="287307.96,-735.18 287316.61,-729.06 287306.03,-728.45 287307.96,-735.18"/>
</g>
<!-- layer_4_expert_4_ep_6 -->
<g id="node492" class="node">
<title>layer_4_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="288313.83,-729 287879.82,-729 287768.17,-625 288202.18,-625 288313.83,-729"/>
<text text-anchor="middle" x="288041" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="288041" y="-680" font-family="Arial" font-size="10.00">GPU: 228</text>
<text text-anchor="middle" x="288041" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="288041" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_4_ep_6 -->
<g id="edge873" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M286858.47,-842.54C287086.99,-835.82 287450.66,-816.32 287760,-760 287798.6,-752.97 287839.48,-742.73 287877.75,-731.84"/>
<polygon fill="black" stroke="black" points="287878.77,-735.19 287887.42,-729.06 287876.84,-728.46 287878.77,-735.19"/>
</g>
<!-- layer_4_expert_5_ep_6 -->
<g id="node493" class="node">
<title>layer_4_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="288876.83,-729 288442.82,-729 288331.17,-625 288765.18,-625 288876.83,-729"/>
<text text-anchor="middle" x="288604" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="288604" y="-680" font-family="Arial" font-size="10.00">GPU: 229</text>
<text text-anchor="middle" x="288604" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="288604" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_5_ep_6 -->
<g id="edge874" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M286856.9,-841.09C287249.24,-831.39 288047.7,-806.52 288323,-760 288362.5,-753.33 288404.31,-742.99 288443.27,-731.88"/>
<polygon fill="black" stroke="black" points="288444.47,-735.17 288453.11,-729.04 288442.53,-728.45 288444.47,-735.17"/>
</g>
<!-- layer_4_expert_6_ep_6 -->
<g id="node494" class="node">
<title>layer_4_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="289439.83,-729 289005.82,-729 288894.17,-625 289328.18,-625 289439.83,-729"/>
<text text-anchor="middle" x="289167" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="289167" y="-680" font-family="Arial" font-size="10.00">GPU: 230</text>
<text text-anchor="middle" x="289167" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="289167" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_6_ep_6 -->
<g id="edge875" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M286860.68,-844.41C287351.92,-839.8 288501.37,-822.49 288886,-760 288925.88,-753.52 288968.1,-743.16 289007.35,-731.94"/>
<polygon fill="black" stroke="black" points="289008.63,-735.22 289017.27,-729.08 289006.69,-728.49 289008.63,-735.22"/>
</g>
<!-- layer_4_expert_7_ep_6 -->
<g id="node495" class="node">
<title>layer_4_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="290002.83,-729 289568.82,-729 289457.17,-625 289891.18,-625 290002.83,-729"/>
<text text-anchor="middle" x="289730" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="289730" y="-680" font-family="Arial" font-size="10.00">GPU: 231</text>
<text text-anchor="middle" x="289730" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="289730" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_6&#45;&gt;layer_4_expert_7_ep_6 -->
<g id="edge876" class="edge">
<title>layer_4_route_ep_6&#45;&gt;layer_4_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M286863.07,-846.46C287442.06,-846.44 288953.26,-838.6 289449,-760 289489.23,-753.62 289531.8,-743.2 289571.32,-731.89"/>
<polygon fill="black" stroke="black" points="289572.4,-735.23 289581.03,-729.08 289570.45,-728.5 289572.4,-735.23"/>
</g>
<!-- layer_4_expert_0_ep_7 -->
<g id="node496" class="node">
<title>layer_4_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="281557.83,-729 281123.82,-729 281012.17,-625 281446.18,-625 281557.83,-729"/>
<text text-anchor="middle" x="281285" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="281285" y="-680" font-family="Arial" font-size="10.00">GPU: 240</text>
<text text-anchor="middle" x="281285" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="281285" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_0_ep_7 -->
<g id="edge877" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M281861.12,-812.42C281767.25,-798.74 281661.5,-781.12 281566,-760 281530.13,-752.07 281492.11,-742.08 281456.02,-731.82"/>
<polygon fill="black" stroke="black" points="281456.97,-728.45 281446.39,-729.07 281455.04,-735.18 281456.97,-728.45"/>
</g>
<!-- layer_4_expert_1_ep_7 -->
<g id="node497" class="node">
<title>layer_4_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="282120.83,-729 281686.82,-729 281575.17,-625 282009.18,-625 282120.83,-729"/>
<text text-anchor="middle" x="281848" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="281848" y="-680" font-family="Arial" font-size="10.00">GPU: 241</text>
<text text-anchor="middle" x="281848" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="281848" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_1_ep_7 -->
<g id="edge878" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M282044.24,-794.91C282012.11,-775.77 281975.44,-753.92 281942.55,-734.33"/>
<polygon fill="black" stroke="black" points="281944.22,-731.25 281933.84,-729.14 281940.64,-737.26 281944.22,-731.25"/>
</g>
<!-- layer_4_expert_2_ep_7 -->
<g id="node498" class="node">
<title>layer_4_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="282683.83,-729 282249.82,-729 282138.17,-625 282572.18,-625 282683.83,-729"/>
<text text-anchor="middle" x="282411" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="282411" y="-680" font-family="Arial" font-size="10.00">GPU: 242</text>
<text text-anchor="middle" x="282411" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="282411" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_2_ep_7 -->
<g id="edge879" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M282215.45,-794.91C282247.47,-775.77 282284.02,-753.92 282316.78,-734.33"/>
<polygon fill="black" stroke="black" points="282318.68,-737.27 282325.47,-729.14 282315.09,-731.26 282318.68,-737.27"/>
</g>
<!-- layer_4_expert_3_ep_7 -->
<g id="node499" class="node">
<title>layer_4_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="283246.83,-729 282812.82,-729 282701.17,-625 283135.18,-625 283246.83,-729"/>
<text text-anchor="middle" x="282974" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="282974" y="-680" font-family="Arial" font-size="10.00">GPU: 243</text>
<text text-anchor="middle" x="282974" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="282974" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_3_ep_7 -->
<g id="edge880" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M282331.18,-821.85C282439.1,-807.24 282574.01,-786.33 282693,-760 282728.87,-752.06 282766.89,-742.07 282802.98,-731.82"/>
<polygon fill="black" stroke="black" points="282803.96,-735.18 282812.61,-729.06 282802.03,-728.45 282803.96,-735.18"/>
</g>
<!-- layer_4_expert_4_ep_7 -->
<g id="node500" class="node">
<title>layer_4_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="283809.83,-729 283375.82,-729 283264.17,-625 283698.18,-625 283809.83,-729"/>
<text text-anchor="middle" x="283537" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="283537" y="-680" font-family="Arial" font-size="10.00">GPU: 244</text>
<text text-anchor="middle" x="283537" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="283537" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_4_ep_7 -->
<g id="edge881" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M282354.47,-842.54C282582.99,-835.82 282946.66,-816.32 283256,-760 283294.6,-752.97 283335.48,-742.73 283373.75,-731.84"/>
<polygon fill="black" stroke="black" points="283374.77,-735.19 283383.42,-729.06 283372.84,-728.46 283374.77,-735.19"/>
</g>
<!-- layer_4_expert_5_ep_7 -->
<g id="node501" class="node">
<title>layer_4_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="284372.83,-729 283938.82,-729 283827.17,-625 284261.18,-625 284372.83,-729"/>
<text text-anchor="middle" x="284100" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="284100" y="-680" font-family="Arial" font-size="10.00">GPU: 245</text>
<text text-anchor="middle" x="284100" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="284100" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_5_ep_7 -->
<g id="edge882" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M282352.9,-841.09C282745.24,-831.39 283543.7,-806.52 283819,-760 283858.5,-753.33 283900.31,-742.99 283939.27,-731.88"/>
<polygon fill="black" stroke="black" points="283940.47,-735.17 283949.11,-729.04 283938.53,-728.45 283940.47,-735.17"/>
</g>
<!-- layer_4_expert_6_ep_7 -->
<g id="node502" class="node">
<title>layer_4_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="284935.83,-729 284501.82,-729 284390.17,-625 284824.18,-625 284935.83,-729"/>
<text text-anchor="middle" x="284663" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="284663" y="-680" font-family="Arial" font-size="10.00">GPU: 246</text>
<text text-anchor="middle" x="284663" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="284663" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_6_ep_7 -->
<g id="edge883" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M282356.68,-844.41C282847.92,-839.8 283997.37,-822.49 284382,-760 284421.88,-753.52 284464.1,-743.16 284503.35,-731.94"/>
<polygon fill="black" stroke="black" points="284504.63,-735.22 284513.27,-729.08 284502.69,-728.49 284504.63,-735.22"/>
</g>
<!-- layer_4_expert_7_ep_7 -->
<g id="node503" class="node">
<title>layer_4_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="285498.83,-729 285064.82,-729 284953.17,-625 285387.18,-625 285498.83,-729"/>
<text text-anchor="middle" x="285226" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="285226" y="-680" font-family="Arial" font-size="10.00">GPU: 247</text>
<text text-anchor="middle" x="285226" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="285226" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_4_route_ep_7&#45;&gt;layer_4_expert_7_ep_7 -->
<g id="edge884" class="edge">
<title>layer_4_route_ep_7&#45;&gt;layer_4_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M282359.07,-846.46C282938.06,-846.44 284449.26,-838.6 284945,-760 284985.23,-753.62 285027.8,-743.2 285067.32,-731.89"/>
<polygon fill="black" stroke="black" points="285068.4,-735.23 285077.03,-729.08 285066.45,-728.5 285068.4,-735.23"/>
</g>
<!-- layer_4_agg_ep_0 -->
<g id="node504" class="node">
<title>layer_4_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="256796.07,-559 256345.77,-559 256229.93,-455 256680.23,-455 256796.07,-559"/>
<text text-anchor="middle" x="256513" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="256513" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="256513" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="256513" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge885" class="edge">
<title>layer_4_expert_0_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M254438.89,-640.38C254473.01,-634.5 254508.52,-629.02 254542,-625 255169.39,-549.72 255915.2,-522.19 256283.6,-512.68"/>
<polygon fill="black" stroke="black" points="256283.94,-516.17 256293.85,-512.41 256283.76,-509.17 256283.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge886" class="edge">
<title>layer_4_expert_1_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M255002.35,-640.96C255036.34,-635.04 255071.7,-629.4 255105,-625 255522.36,-569.92 256012.96,-536.1 256291,-519.8"/>
<polygon fill="black" stroke="black" points="256291.43,-523.28 256301.21,-519.2 256291.02,-516.29 256291.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge887" class="edge">
<title>layer_4_expert_2_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M255566.69,-642.23C255600.32,-636.24 255635.2,-630.25 255668,-625 255885.23,-590.26 256134.86,-556.45 256306.16,-534.18"/>
<polygon fill="black" stroke="black" points="256306.83,-537.62 256316.3,-532.86 256305.93,-530.68 256306.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge888" class="edge">
<title>layer_4_expert_3_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M256113.6,-627.18C256182.9,-606.5 256263.84,-582.35 256334.67,-561.21"/>
<polygon fill="black" stroke="black" points="256336.01,-564.47 256344.59,-558.25 256334.01,-557.76 256336.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge889" class="edge">
<title>layer_4_expert_4_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M256513,-624.68C256513,-607.18 256513,-587.43 256513,-569.22"/>
<polygon fill="black" stroke="black" points="256516.5,-569 256513,-559 256509.5,-569 256516.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge890" class="edge">
<title>layer_4_expert_5_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M256904.79,-624.91C256838.19,-605.04 256761.8,-582.24 256694.26,-562.09"/>
<polygon fill="black" stroke="black" points="256694.95,-558.64 256684.37,-559.14 256692.95,-565.35 256694.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge891" class="edge">
<title>layer_4_expert_6_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M257367.6,-626.55C257364.38,-626.02 257361.18,-625.51 257358,-625 257167.84,-594.59 256952.86,-564.89 256787.33,-543.02"/>
<polygon fill="black" stroke="black" points="256787.37,-539.5 256777,-541.66 256786.45,-546.44 256787.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_0&#45;&gt;layer_4_agg_ep_0 -->
<g id="edge892" class="edge">
<title>layer_4_expert_7_ep_0&#45;&gt;layer_4_agg_ep_0</title>
<path fill="none" stroke="black" d="M257930.27,-626.25C257927.16,-625.82 257924.07,-625.41 257921,-625 257517.9,-571.8 257046.48,-538.44 256764.24,-521.53"/>
<polygon fill="black" stroke="black" points="256764.05,-518.01 256753.86,-520.91 256763.63,-525 256764.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_1 -->
<g id="node505" class="node">
<title>layer_4_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="279316.07,-559 278865.77,-559 278749.93,-455 279200.23,-455 279316.07,-559"/>
<text text-anchor="middle" x="279033" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="279033" y="-510" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="279033" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="279033" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge894" class="edge">
<title>layer_4_expert_0_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M276958.89,-640.38C276993.01,-634.5 277028.52,-629.02 277062,-625 277689.39,-549.72 278435.2,-522.19 278803.6,-512.68"/>
<polygon fill="black" stroke="black" points="278803.94,-516.17 278813.85,-512.41 278803.76,-509.17 278803.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge895" class="edge">
<title>layer_4_expert_1_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M277522.35,-640.96C277556.34,-635.04 277591.7,-629.4 277625,-625 278042.36,-569.92 278532.96,-536.1 278811,-519.8"/>
<polygon fill="black" stroke="black" points="278811.43,-523.28 278821.21,-519.2 278811.02,-516.29 278811.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge896" class="edge">
<title>layer_4_expert_2_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M278086.69,-642.23C278120.32,-636.24 278155.2,-630.25 278188,-625 278405.23,-590.26 278654.86,-556.45 278826.16,-534.18"/>
<polygon fill="black" stroke="black" points="278826.83,-537.62 278836.3,-532.86 278825.93,-530.68 278826.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge897" class="edge">
<title>layer_4_expert_3_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M278633.6,-627.18C278702.9,-606.5 278783.84,-582.35 278854.67,-561.21"/>
<polygon fill="black" stroke="black" points="278856.01,-564.47 278864.59,-558.25 278854.01,-557.76 278856.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge898" class="edge">
<title>layer_4_expert_4_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M279033,-624.68C279033,-607.18 279033,-587.43 279033,-569.22"/>
<polygon fill="black" stroke="black" points="279036.5,-569 279033,-559 279029.5,-569 279036.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge899" class="edge">
<title>layer_4_expert_5_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M279424.79,-624.91C279358.19,-605.04 279281.8,-582.24 279214.26,-562.09"/>
<polygon fill="black" stroke="black" points="279214.95,-558.64 279204.37,-559.14 279212.95,-565.35 279214.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge900" class="edge">
<title>layer_4_expert_6_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M279887.6,-626.55C279884.38,-626.02 279881.18,-625.51 279878,-625 279687.84,-594.59 279472.86,-564.89 279307.33,-543.02"/>
<polygon fill="black" stroke="black" points="279307.37,-539.5 279297,-541.66 279306.45,-546.44 279307.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_1&#45;&gt;layer_4_agg_ep_1 -->
<g id="edge901" class="edge">
<title>layer_4_expert_7_ep_1&#45;&gt;layer_4_agg_ep_1</title>
<path fill="none" stroke="black" d="M280450.27,-626.25C280447.16,-625.82 280444.07,-625.41 280441,-625 280037.9,-571.8 279566.48,-538.44 279284.24,-521.53"/>
<polygon fill="black" stroke="black" points="279284.05,-518.01 279273.86,-520.91 279283.63,-525 279284.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_2 -->
<g id="node506" class="node">
<title>layer_4_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="261300.07,-559 260849.77,-559 260733.93,-455 261184.23,-455 261300.07,-559"/>
<text text-anchor="middle" x="261017" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="261017" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="261017" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="261017" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge903" class="edge">
<title>layer_4_expert_0_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M258942.89,-640.38C258977.01,-634.5 259012.52,-629.02 259046,-625 259673.39,-549.72 260419.2,-522.19 260787.6,-512.68"/>
<polygon fill="black" stroke="black" points="260787.94,-516.17 260797.85,-512.41 260787.76,-509.17 260787.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge904" class="edge">
<title>layer_4_expert_1_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M259506.35,-640.96C259540.34,-635.04 259575.7,-629.4 259609,-625 260026.36,-569.92 260516.96,-536.1 260795,-519.8"/>
<polygon fill="black" stroke="black" points="260795.43,-523.28 260805.21,-519.2 260795.02,-516.29 260795.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge905" class="edge">
<title>layer_4_expert_2_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M260070.69,-642.23C260104.32,-636.24 260139.2,-630.25 260172,-625 260389.23,-590.26 260638.86,-556.45 260810.16,-534.18"/>
<polygon fill="black" stroke="black" points="260810.83,-537.62 260820.3,-532.86 260809.93,-530.68 260810.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge906" class="edge">
<title>layer_4_expert_3_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M260617.6,-627.18C260686.9,-606.5 260767.84,-582.35 260838.67,-561.21"/>
<polygon fill="black" stroke="black" points="260840.01,-564.47 260848.59,-558.25 260838.01,-557.76 260840.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge907" class="edge">
<title>layer_4_expert_4_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M261017,-624.68C261017,-607.18 261017,-587.43 261017,-569.22"/>
<polygon fill="black" stroke="black" points="261020.5,-569 261017,-559 261013.5,-569 261020.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge908" class="edge">
<title>layer_4_expert_5_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M261408.79,-624.91C261342.19,-605.04 261265.8,-582.24 261198.26,-562.09"/>
<polygon fill="black" stroke="black" points="261198.95,-558.64 261188.37,-559.14 261196.95,-565.35 261198.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge909" class="edge">
<title>layer_4_expert_6_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M261871.6,-626.55C261868.38,-626.02 261865.18,-625.51 261862,-625 261671.84,-594.59 261456.86,-564.89 261291.33,-543.02"/>
<polygon fill="black" stroke="black" points="261291.37,-539.5 261281,-541.66 261290.45,-546.44 261291.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_2&#45;&gt;layer_4_agg_ep_2 -->
<g id="edge910" class="edge">
<title>layer_4_expert_7_ep_2&#45;&gt;layer_4_agg_ep_2</title>
<path fill="none" stroke="black" d="M262434.27,-626.25C262431.16,-625.82 262428.07,-625.41 262425,-625 262021.9,-571.8 261550.48,-538.44 261268.24,-521.53"/>
<polygon fill="black" stroke="black" points="261268.05,-518.01 261257.86,-520.91 261267.63,-525 261268.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_3 -->
<g id="node507" class="node">
<title>layer_4_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="274812.07,-559 274361.77,-559 274245.93,-455 274696.23,-455 274812.07,-559"/>
<text text-anchor="middle" x="274529" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="274529" y="-510" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="274529" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="274529" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge912" class="edge">
<title>layer_4_expert_0_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M271891.48,-640.09C271925.71,-634.21 271961.38,-628.81 271995,-625 272837.79,-529.49 273846.69,-511.47 274294.76,-508.4"/>
<polygon fill="black" stroke="black" points="274294.93,-511.9 274304.91,-508.33 274294.89,-504.9 274294.93,-511.9"/>
</g>
<!-- layer_4_expert_1_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge913" class="edge">
<title>layer_4_expert_1_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M272454.89,-640.38C272489.01,-634.5 272524.52,-629.02 272558,-625 273185.39,-549.72 273931.2,-522.19 274299.6,-512.68"/>
<polygon fill="black" stroke="black" points="274299.94,-516.17 274309.85,-512.41 274299.76,-509.17 274299.94,-516.17"/>
</g>
<!-- layer_4_expert_2_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge914" class="edge">
<title>layer_4_expert_2_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M273018.35,-640.96C273052.34,-635.04 273087.7,-629.4 273121,-625 273538.36,-569.92 274028.96,-536.1 274307,-519.8"/>
<polygon fill="black" stroke="black" points="274307.43,-523.28 274317.21,-519.2 274307.02,-516.29 274307.43,-523.28"/>
</g>
<!-- layer_4_expert_3_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge915" class="edge">
<title>layer_4_expert_3_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M274129.6,-627.18C274198.9,-606.5 274279.84,-582.35 274350.67,-561.21"/>
<polygon fill="black" stroke="black" points="274352.01,-564.47 274360.59,-558.25 274350.01,-557.76 274352.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge916" class="edge">
<title>layer_4_expert_4_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M274529,-624.68C274529,-607.18 274529,-587.43 274529,-569.22"/>
<polygon fill="black" stroke="black" points="274532.5,-569 274529,-559 274525.5,-569 274532.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge917" class="edge">
<title>layer_4_expert_5_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M274920.79,-624.91C274854.19,-605.04 274777.8,-582.24 274710.26,-562.09"/>
<polygon fill="black" stroke="black" points="274710.95,-558.64 274700.37,-559.14 274708.95,-565.35 274710.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge918" class="edge">
<title>layer_4_expert_6_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M275383.6,-626.55C275380.38,-626.02 275377.18,-625.51 275374,-625 275183.84,-594.59 274968.86,-564.89 274803.33,-543.02"/>
<polygon fill="black" stroke="black" points="274803.37,-539.5 274793,-541.66 274802.45,-546.44 274803.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_3&#45;&gt;layer_4_agg_ep_3 -->
<g id="edge919" class="edge">
<title>layer_4_expert_7_ep_3&#45;&gt;layer_4_agg_ep_3</title>
<path fill="none" stroke="black" d="M275946.27,-626.25C275943.16,-625.82 275940.07,-625.41 275937,-625 275533.9,-571.8 275062.48,-538.44 274780.24,-521.53"/>
<polygon fill="black" stroke="black" points="274780.05,-518.01 274769.86,-520.91 274779.63,-525 274780.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_4 -->
<g id="node508" class="node">
<title>layer_4_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="270308.07,-559 269857.77,-559 269741.93,-455 270192.23,-455 270308.07,-559"/>
<text text-anchor="middle" x="270025" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="270025" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="270025" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="270025" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge921" class="edge">
<title>layer_4_expert_0_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M267950.89,-640.38C267985.01,-634.5 268020.52,-629.02 268054,-625 268681.39,-549.72 269427.2,-522.19 269795.6,-512.68"/>
<polygon fill="black" stroke="black" points="269795.94,-516.17 269805.85,-512.41 269795.76,-509.17 269795.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge922" class="edge">
<title>layer_4_expert_1_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M268514.35,-640.96C268548.34,-635.04 268583.7,-629.4 268617,-625 269034.36,-569.92 269524.96,-536.1 269803,-519.8"/>
<polygon fill="black" stroke="black" points="269803.43,-523.28 269813.21,-519.2 269803.02,-516.29 269803.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge923" class="edge">
<title>layer_4_expert_2_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M269078.69,-642.23C269112.32,-636.24 269147.2,-630.25 269180,-625 269397.23,-590.26 269646.86,-556.45 269818.16,-534.18"/>
<polygon fill="black" stroke="black" points="269818.83,-537.62 269828.3,-532.86 269817.93,-530.68 269818.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge924" class="edge">
<title>layer_4_expert_3_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M269625.6,-627.18C269694.9,-606.5 269775.84,-582.35 269846.67,-561.21"/>
<polygon fill="black" stroke="black" points="269848.01,-564.47 269856.59,-558.25 269846.01,-557.76 269848.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge925" class="edge">
<title>layer_4_expert_4_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M270025,-624.68C270025,-607.18 270025,-587.43 270025,-569.22"/>
<polygon fill="black" stroke="black" points="270028.5,-569 270025,-559 270021.5,-569 270028.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge926" class="edge">
<title>layer_4_expert_5_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M270416.79,-624.91C270350.19,-605.04 270273.8,-582.24 270206.26,-562.09"/>
<polygon fill="black" stroke="black" points="270206.95,-558.64 270196.37,-559.14 270204.95,-565.35 270206.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge927" class="edge">
<title>layer_4_expert_6_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M270879.6,-626.55C270876.38,-626.02 270873.18,-625.51 270870,-625 270679.84,-594.59 270464.86,-564.89 270299.33,-543.02"/>
<polygon fill="black" stroke="black" points="270299.37,-539.5 270289,-541.66 270298.45,-546.44 270299.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_4&#45;&gt;layer_4_agg_ep_4 -->
<g id="edge928" class="edge">
<title>layer_4_expert_7_ep_4&#45;&gt;layer_4_agg_ep_4</title>
<path fill="none" stroke="black" d="M273131.29,-626.05C273128.18,-625.69 273125.08,-625.34 273122,-625 272569.95,-564.78 270894.66,-525.61 270266.41,-512.69"/>
<polygon fill="black" stroke="black" points="270266.39,-509.19 270256.32,-512.48 270266.25,-516.19 270266.39,-509.19"/>
</g>
<!-- layer_4_agg_ep_5 -->
<g id="node509" class="node">
<title>layer_4_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="265804.07,-559 265353.77,-559 265237.93,-455 265688.23,-455 265804.07,-559"/>
<text text-anchor="middle" x="265521" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="265521" y="-510" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="265521" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="265521" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge930" class="edge">
<title>layer_4_expert_0_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M263446.89,-640.38C263481.01,-634.5 263516.52,-629.02 263550,-625 264177.39,-549.72 264923.2,-522.19 265291.6,-512.68"/>
<polygon fill="black" stroke="black" points="265291.94,-516.17 265301.85,-512.41 265291.76,-509.17 265291.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge931" class="edge">
<title>layer_4_expert_1_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M264010.35,-640.96C264044.34,-635.04 264079.7,-629.4 264113,-625 264530.36,-569.92 265020.96,-536.1 265299,-519.8"/>
<polygon fill="black" stroke="black" points="265299.43,-523.28 265309.21,-519.2 265299.02,-516.29 265299.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge932" class="edge">
<title>layer_4_expert_2_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M264574.69,-642.23C264608.32,-636.24 264643.2,-630.25 264676,-625 264893.23,-590.26 265142.86,-556.45 265314.16,-534.18"/>
<polygon fill="black" stroke="black" points="265314.83,-537.62 265324.3,-532.86 265313.93,-530.68 265314.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge933" class="edge">
<title>layer_4_expert_3_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M265121.6,-627.18C265190.9,-606.5 265271.84,-582.35 265342.67,-561.21"/>
<polygon fill="black" stroke="black" points="265344.01,-564.47 265352.59,-558.25 265342.01,-557.76 265344.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge934" class="edge">
<title>layer_4_expert_4_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M265521,-624.68C265521,-607.18 265521,-587.43 265521,-569.22"/>
<polygon fill="black" stroke="black" points="265524.5,-569 265521,-559 265517.5,-569 265524.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge935" class="edge">
<title>layer_4_expert_5_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M265912.79,-624.91C265846.19,-605.04 265769.8,-582.24 265702.26,-562.09"/>
<polygon fill="black" stroke="black" points="265702.95,-558.64 265692.37,-559.14 265700.95,-565.35 265702.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge936" class="edge">
<title>layer_4_expert_6_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M266375.6,-626.55C266372.38,-626.02 266369.18,-625.51 266366,-625 266175.84,-594.59 265960.86,-564.89 265795.33,-543.02"/>
<polygon fill="black" stroke="black" points="265795.37,-539.5 265785,-541.66 265794.45,-546.44 265795.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_5&#45;&gt;layer_4_agg_ep_5 -->
<g id="edge937" class="edge">
<title>layer_4_expert_7_ep_5&#45;&gt;layer_4_agg_ep_5</title>
<path fill="none" stroke="black" d="M266938.27,-626.25C266935.16,-625.82 266932.07,-625.41 266929,-625 266525.9,-571.8 266054.48,-538.44 265772.24,-521.53"/>
<polygon fill="black" stroke="black" points="265772.05,-518.01 265761.86,-520.91 265771.63,-525 265772.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_6 -->
<g id="node510" class="node">
<title>layer_4_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="288324.07,-559 287873.77,-559 287757.93,-455 288208.23,-455 288324.07,-559"/>
<text text-anchor="middle" x="288041" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="288041" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="288041" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="288041" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge939" class="edge">
<title>layer_4_expert_0_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M285966.89,-640.38C286001.01,-634.5 286036.52,-629.02 286070,-625 286697.39,-549.72 287443.2,-522.19 287811.6,-512.68"/>
<polygon fill="black" stroke="black" points="287811.94,-516.17 287821.85,-512.41 287811.76,-509.17 287811.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge940" class="edge">
<title>layer_4_expert_1_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M286530.35,-640.96C286564.34,-635.04 286599.7,-629.4 286633,-625 287050.36,-569.92 287540.96,-536.1 287819,-519.8"/>
<polygon fill="black" stroke="black" points="287819.43,-523.28 287829.21,-519.2 287819.02,-516.29 287819.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge941" class="edge">
<title>layer_4_expert_2_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M287094.69,-642.23C287128.32,-636.24 287163.2,-630.25 287196,-625 287413.23,-590.26 287662.86,-556.45 287834.16,-534.18"/>
<polygon fill="black" stroke="black" points="287834.83,-537.62 287844.3,-532.86 287833.93,-530.68 287834.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge942" class="edge">
<title>layer_4_expert_3_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M287641.6,-627.18C287710.9,-606.5 287791.84,-582.35 287862.67,-561.21"/>
<polygon fill="black" stroke="black" points="287864.01,-564.47 287872.59,-558.25 287862.01,-557.76 287864.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge943" class="edge">
<title>layer_4_expert_4_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M288041,-624.68C288041,-607.18 288041,-587.43 288041,-569.22"/>
<polygon fill="black" stroke="black" points="288044.5,-569 288041,-559 288037.5,-569 288044.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge944" class="edge">
<title>layer_4_expert_5_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M288432.79,-624.91C288366.19,-605.04 288289.8,-582.24 288222.26,-562.09"/>
<polygon fill="black" stroke="black" points="288222.95,-558.64 288212.37,-559.14 288220.95,-565.35 288222.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge945" class="edge">
<title>layer_4_expert_6_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M288895.6,-626.55C288892.38,-626.02 288889.18,-625.51 288886,-625 288695.84,-594.59 288480.86,-564.89 288315.33,-543.02"/>
<polygon fill="black" stroke="black" points="288315.37,-539.5 288305,-541.66 288314.45,-546.44 288315.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_6&#45;&gt;layer_4_agg_ep_6 -->
<g id="edge946" class="edge">
<title>layer_4_expert_7_ep_6&#45;&gt;layer_4_agg_ep_6</title>
<path fill="none" stroke="black" d="M289458.27,-626.25C289455.16,-625.82 289452.07,-625.41 289449,-625 289045.9,-571.8 288574.48,-538.44 288292.24,-521.53"/>
<polygon fill="black" stroke="black" points="288292.05,-518.01 288281.86,-520.91 288291.63,-525 288292.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_7 -->
<g id="node511" class="node">
<title>layer_4_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="283820.07,-559 283369.77,-559 283253.93,-455 283704.23,-455 283820.07,-559"/>
<text text-anchor="middle" x="283537" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="283537" y="-510" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="283537" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="283537" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_expert_0_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge948" class="edge">
<title>layer_4_expert_0_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M281462.89,-640.38C281497.01,-634.5 281532.52,-629.02 281566,-625 282193.39,-549.72 282939.2,-522.19 283307.6,-512.68"/>
<polygon fill="black" stroke="black" points="283307.94,-516.17 283317.85,-512.41 283307.76,-509.17 283307.94,-516.17"/>
</g>
<!-- layer_4_expert_1_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge949" class="edge">
<title>layer_4_expert_1_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M282026.35,-640.96C282060.34,-635.04 282095.7,-629.4 282129,-625 282546.36,-569.92 283036.96,-536.1 283315,-519.8"/>
<polygon fill="black" stroke="black" points="283315.43,-523.28 283325.21,-519.2 283315.02,-516.29 283315.43,-523.28"/>
</g>
<!-- layer_4_expert_2_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge950" class="edge">
<title>layer_4_expert_2_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M282590.69,-642.23C282624.32,-636.24 282659.2,-630.25 282692,-625 282909.23,-590.26 283158.86,-556.45 283330.16,-534.18"/>
<polygon fill="black" stroke="black" points="283330.83,-537.62 283340.3,-532.86 283329.93,-530.68 283330.83,-537.62"/>
</g>
<!-- layer_4_expert_3_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge951" class="edge">
<title>layer_4_expert_3_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M283137.6,-627.18C283206.9,-606.5 283287.84,-582.35 283358.67,-561.21"/>
<polygon fill="black" stroke="black" points="283360.01,-564.47 283368.59,-558.25 283358.01,-557.76 283360.01,-564.47"/>
</g>
<!-- layer_4_expert_4_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge952" class="edge">
<title>layer_4_expert_4_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M283537,-624.68C283537,-607.18 283537,-587.43 283537,-569.22"/>
<polygon fill="black" stroke="black" points="283540.5,-569 283537,-559 283533.5,-569 283540.5,-569"/>
</g>
<!-- layer_4_expert_5_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge953" class="edge">
<title>layer_4_expert_5_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M283928.79,-624.91C283862.19,-605.04 283785.8,-582.24 283718.26,-562.09"/>
<polygon fill="black" stroke="black" points="283718.95,-558.64 283708.37,-559.14 283716.95,-565.35 283718.95,-558.64"/>
</g>
<!-- layer_4_expert_6_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge954" class="edge">
<title>layer_4_expert_6_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M284391.6,-626.55C284388.38,-626.02 284385.18,-625.51 284382,-625 284191.84,-594.59 283976.86,-564.89 283811.33,-543.02"/>
<polygon fill="black" stroke="black" points="283811.37,-539.5 283801,-541.66 283810.45,-546.44 283811.37,-539.5"/>
</g>
<!-- layer_4_expert_7_ep_7&#45;&gt;layer_4_agg_ep_7 -->
<g id="edge955" class="edge">
<title>layer_4_expert_7_ep_7&#45;&gt;layer_4_agg_ep_7</title>
<path fill="none" stroke="black" d="M284954.27,-626.25C284951.16,-625.82 284948.07,-625.41 284945,-625 284541.9,-571.8 284070.48,-538.44 283788.24,-521.53"/>
<polygon fill="black" stroke="black" points="283788.05,-518.01 283777.86,-520.91 283787.63,-525 283788.05,-518.01"/>
</g>
<!-- layer_4_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge893" class="edge">
<title>layer_4_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M256732.51,-501.84C257356.95,-490.25 259196.8,-457.73 260725,-447 260725,-447 580329,-437 580329,-437 580331.83,-434.17 580331.78,-430.88 580329,-428 580290.95,-388.54 579880.35,-442.22 579836,-410 579788.91,-375.79 579837.16,-322.47 579791,-287 579740.66,-248.32 579340.55,-228.93 579141.15,-221.59"/>
<polygon fill="black" stroke="black" points="579141.05,-218.09 579130.93,-221.22 579140.8,-225.08 579141.05,-218.09"/>
</g>
<!-- layer_4_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge902" class="edge">
<title>layer_4_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M279252.51,-501.84C279876.95,-490.25 281716.8,-457.73 283245,-447 283245,-447 580454,-437 580454,-437 580456.83,-434.17 580456.77,-430.89 580454,-428 580421.06,-393.64 580064.43,-438.08 580026,-410 579979,-375.66 580027.47,-322.05 579981,-287 579915.05,-237.25 579374.21,-223.14 579138.32,-219.33"/>
<polygon fill="black" stroke="black" points="579138.06,-215.83 579128.01,-219.17 579137.95,-222.83 579138.06,-215.83"/>
</g>
<!-- layer_4_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge911" class="edge">
<title>layer_4_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M261236.51,-501.84C261860.95,-490.25 263700.8,-457.73 265229,-447 265229,-447 580354,-437 580354,-437 580356.83,-434.17 580356.77,-430.88 580354,-428 580316.97,-389.56 579917.16,-441.39 579874,-410 579826.92,-375.76 579875.23,-322.37 579829,-287 579775.55,-246.11 579347.5,-227.64 579140.43,-221.04"/>
<polygon fill="black" stroke="black" points="579140.24,-217.53 579130.13,-220.72 579140.02,-224.53 579140.24,-217.53"/>
</g>
<!-- layer_4_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge920" class="edge">
<title>layer_4_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M274748.51,-501.84C275372.95,-490.25 277212.8,-457.73 278741,-447 278741,-447 580404,-437 580404,-437 580469.5,-371.49 580068.84,-455.24 579988,-410 579930.45,-377.79 579961.97,-320.22 579905,-287 579840.47,-249.37 579361.9,-228.93 579140.62,-221.4"/>
<polygon fill="black" stroke="black" points="579140.72,-217.91 579130.6,-221.07 579140.48,-224.9 579140.72,-217.91"/>
</g>
<!-- layer_4_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge929" class="edge">
<title>layer_4_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M270244.51,-501.84C270868.95,-490.25 272708.8,-457.73 274237,-447 274237,-447 580407,-437 580407,-437 580472.97,-371.02 580067.48,-458.87 579988,-410 579934.6,-377.17 579971.82,-320.74 579919,-287 579854.81,-245.99 579364.29,-227.28 579140.13,-220.8"/>
<polygon fill="black" stroke="black" points="579140.08,-217.29 579129.99,-220.51 579139.88,-224.29 579140.08,-217.29"/>
</g>
<!-- layer_4_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge938" class="edge">
<title>layer_4_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M265740.51,-501.84C266364.95,-490.25 268204.8,-457.73 269733,-447 269733,-447 580379,-437 580379,-437 580381.83,-434.17 580381.77,-430.88 580379,-428 580343.31,-390.9 579958.04,-439.72 579916,-410 579867.95,-376.04 579914.31,-322 579867,-287 579809.85,-244.72 579354.53,-226.84 579140.04,-220.7"/>
<polygon fill="black" stroke="black" points="579140.1,-217.2 579130.01,-220.41 579139.9,-224.2 579140.1,-217.2"/>
</g>
<!-- layer_4_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge947" class="edge">
<title>layer_4_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M288256.53,-498.04C288640.2,-484.3 289466.94,-456.71 290165,-447 290165,-447 580504,-437 580504,-437 580567.15,-373.85 580175.23,-462.54 580103,-410 580055.8,-375.67 580103.82,-321.85 580057,-287 579984.56,-233.07 579386.67,-221.29 579137.44,-218.72"/>
<polygon fill="black" stroke="black" points="579137.31,-215.22 579127.27,-218.61 579137.24,-222.21 579137.31,-215.22"/>
</g>
<!-- layer_4_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge956" class="edge">
<title>layer_4_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M283756.51,-501.84C284380.95,-490.25 286220.8,-457.73 287749,-447 287749,-447 580479,-437 580479,-437 580544.19,-371.81 580139.59,-464.18 580065,-410 580017.78,-375.7 580065.77,-321.91 580019,-287 579949.75,-235.31 579381.05,-222.26 579138.23,-219.03"/>
<polygon fill="black" stroke="black" points="579138.01,-215.53 579127.97,-218.9 579137.92,-222.53 579138.01,-215.53"/>
</g>
<!-- layer_4_moe_alltoall -->
<g id="node512" class="node">
<title>layer_4_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="264702" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="264702" y="-1031" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="264702" y="-1020" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="264702" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="264702" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_4_ln_tp_0 -->
<g id="node513" class="node">
<title>layer_4_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="281025.07,-1069 280574.77,-1069 280458.93,-965 280909.23,-965 281025.07,-1069"/>
<text text-anchor="middle" x="280742" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="280742" y="-1020" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="280742" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="280742" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_qkv_tp_0 -->
<g id="node517" class="node">
<title>layer_5_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="252241.7,-899 251799.94,-899 251686.3,-795 252128.06,-795 252241.7,-899"/>
<text text-anchor="middle" x="251964" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="251964" y="-850" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="251964" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="251964" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_4_ln_tp_0&#45;&gt;layer_5_qkv_tp_0 -->
<g id="edge3093" class="edge">
<title>layer_4_ln_tp_0&#45;&gt;layer_5_qkv_tp_0</title>
<path fill="none" stroke="black" d="M280511.33,-1012.32C279804.03,-1001.24 277603.06,-968.25 275779,-957 273267.38,-941.52 255685.56,-970.68 253174,-947 252968.86,-945.07 252453.89,-960.32 252251,-930 252209.48,-923.8 252165.5,-913.31 252124.78,-901.87"/>
<polygon fill="black" stroke="black" points="252125.63,-898.47 252115.05,-899.1 252123.71,-905.2 252125.63,-898.47"/>
</g>
<!-- layer_4_ln_tp_1 -->
<g id="node514" class="node">
<title>layer_4_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="283945.07,-1069 283494.77,-1069 283378.93,-965 283829.23,-965 283945.07,-1069"/>
<text text-anchor="middle" x="283662" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="283662" y="-1020" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="283662" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="283662" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_qkv_tp_1 -->
<g id="node518" class="node">
<title>layer_5_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="252815.7,-899 252373.94,-899 252260.3,-795 252702.06,-795 252815.7,-899"/>
<text text-anchor="middle" x="252538" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="252538" y="-850" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="252538" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="252538" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_4_ln_tp_1&#45;&gt;layer_5_qkv_tp_1 -->
<g id="edge3094" class="edge">
<title>layer_4_ln_tp_1&#45;&gt;layer_5_qkv_tp_1</title>
<path fill="none" stroke="black" d="M283427.79,-1009.01C282968.63,-995.68 281917.86,-967.08 281034,-957 279522.32,-939.76 255333.72,-960.17 253822,-947 253600.42,-945.07 253044.18,-962.6 252825,-930 252783.36,-923.81 252739.25,-913.29 252698.42,-901.81"/>
<polygon fill="black" stroke="black" points="252699.25,-898.4 252688.67,-899.03 252697.33,-905.14 252699.25,-898.4"/>
</g>
<!-- layer_4_ln_tp_2 -->
<g id="node515" class="node">
<title>layer_4_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="285697.07,-1069 285246.77,-1069 285130.93,-965 285581.23,-965 285697.07,-1069"/>
<text text-anchor="middle" x="285414" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="285414" y="-1020" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="285414" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="285414" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_qkv_tp_2 -->
<g id="node519" class="node">
<title>layer_5_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="253963.7,-899 253521.94,-899 253408.3,-795 253850.06,-795 253963.7,-899"/>
<text text-anchor="middle" x="253686" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="253686" y="-850" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="253686" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="253686" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_4_ln_tp_2&#45;&gt;layer_5_qkv_tp_2 -->
<g id="edge3095" class="edge">
<title>layer_4_ln_tp_2&#45;&gt;layer_5_qkv_tp_2</title>
<path fill="none" stroke="black" d="M285173.5,-1003.34C284884.19,-988.78 284383.74,-965.78 283954,-957 283347.29,-944.61 262714.83,-947.77 262108,-947 261882.11,-946.71 254199.72,-961.26 253976,-930 253933.34,-924.04 253888.12,-913.43 253846.4,-901.78"/>
<polygon fill="black" stroke="black" points="253847.29,-898.39 253836.72,-899.04 253845.39,-905.13 253847.29,-898.39"/>
</g>
<!-- layer_4_ln_tp_3 -->
<g id="node516" class="node">
<title>layer_4_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="286865.07,-1069 286414.77,-1069 286298.93,-965 286749.23,-965 286865.07,-1069"/>
<text text-anchor="middle" x="286582" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="286582" y="-1020" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="286582" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="286582" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_qkv_tp_3 -->
<g id="node520" class="node">
<title>layer_5_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="253389.7,-899 252947.94,-899 252834.3,-795 253276.06,-795 253389.7,-899"/>
<text text-anchor="middle" x="253112" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="253112" y="-850" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="253112" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="253112" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_4_ln_tp_3&#45;&gt;layer_5_qkv_tp_3 -->
<g id="edge3096" class="edge">
<title>layer_4_ln_tp_3&#45;&gt;layer_5_qkv_tp_3</title>
<path fill="none" stroke="black" d="M286331.59,-994.67C286156.52,-980.86 285917.18,-964.15 285706,-957 285378.44,-945.91 262435.75,-947.39 262108,-947 261866.08,-946.71 253638.55,-963.79 253399,-930 253356.84,-924.05 253312.18,-913.48 253270.97,-901.86"/>
<polygon fill="black" stroke="black" points="253271.7,-898.43 253261.12,-899.04 253269.78,-905.16 253271.7,-898.43"/>
</g>
<!-- layer_5_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge965" class="edge">
<title>layer_5_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M252143.63,-809.09C252179.07,-803.22 252216.09,-798.08 252251,-795 252251,-795 542857,-777 542857,-777 543357.54,-776.87 578398.65,-816.43 578896,-760 579234.62,-721.58 579760.32,-745.57 579596,-447 579588.39,-433.17 579581.16,-432.4 579566,-428 579566,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_5_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge966" class="edge">
<title>layer_5_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M252717.63,-809.09C252753.07,-803.22 252790.09,-798.08 252825,-795 252825,-795 560705,-777 560705,-777 560962.69,-776.87 579006.34,-810.68 579259,-760 579432.27,-725.25 579527.99,-754.05 579626,-607 579646.99,-575.5 579975.89,-1040.54 579625,-447 579616.19,-432.1 579607.75,-432.36 579591,-428 579591,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_5_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge967" class="edge">
<title>layer_5_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M253865.97,-809.35C253902.25,-803.37 253940.22,-798.12 253976,-795 253976,-795 574657,-777 574657,-777 574726.06,-776.88 579569.11,-794.39 579629,-760 579753.71,-688.39 579797.52,-561.87 579711,-447 579695.44,-426.34 579681.51,-432.28 579656,-428 579656,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_5_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge968" class="edge">
<title>layer_5_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M253291.63,-809.09C253327.07,-803.22 253364.09,-798.08 253399,-795 253399,-795 569875,-777 569875,-777 570009.18,-776.88 579412.51,-812.49 579536,-760 579676.76,-700.18 579771.96,-568.45 579679,-447 579661.48,-424.11 579645.5,-432.27 579617,-428 579617,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_5_qkv_comm -->
<g id="node521" class="node">
<title>layer_5_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="251475" cy="-847" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="251475" y="-861" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="251475" y="-850" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="251475" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="251475" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_5_attn_tp_0 -->
<g id="node522" class="node">
<title>layer_5_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="248516.7,-899 248074.94,-899 247961.3,-795 248403.06,-795 248516.7,-899"/>
<text text-anchor="middle" x="248239" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="248239" y="-850" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="248239" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="248239" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_out_tp_0 -->
<g id="node526" class="node">
<title>layer_5_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="248516.7,-729 248074.94,-729 247961.3,-625 248403.06,-625 248516.7,-729"/>
<text text-anchor="middle" x="248239" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="248239" y="-680" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="248239" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="248239" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_tp_0&#45;&gt;layer_5_attn_out_tp_0 -->
<g id="edge973" class="edge">
<title>layer_5_attn_tp_0&#45;&gt;layer_5_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M248239,-794.68C248239,-777.18 248239,-757.43 248239,-739.22"/>
<polygon fill="black" stroke="black" points="248242.5,-739 248239,-729 248235.5,-739 248242.5,-739"/>
</g>
<!-- layer_5_attn_tp_1 -->
<g id="node523" class="node">
<title>layer_5_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="247942.7,-899 247500.94,-899 247387.3,-795 247829.06,-795 247942.7,-899"/>
<text text-anchor="middle" x="247665" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="247665" y="-850" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="247665" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="247665" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_out_tp_1 -->
<g id="node527" class="node">
<title>layer_5_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="247942.7,-729 247500.94,-729 247387.3,-625 247829.06,-625 247942.7,-729"/>
<text text-anchor="middle" x="247665" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="247665" y="-680" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="247665" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="247665" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_tp_1&#45;&gt;layer_5_attn_out_tp_1 -->
<g id="edge975" class="edge">
<title>layer_5_attn_tp_1&#45;&gt;layer_5_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M247665,-794.68C247665,-777.18 247665,-757.43 247665,-739.22"/>
<polygon fill="black" stroke="black" points="247668.5,-739 247665,-729 247661.5,-739 247668.5,-739"/>
</g>
<!-- layer_5_attn_tp_2 -->
<g id="node524" class="node">
<title>layer_5_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="247368.7,-899 246926.94,-899 246813.3,-795 247255.06,-795 247368.7,-899"/>
<text text-anchor="middle" x="247091" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="247091" y="-850" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="247091" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="247091" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_out_tp_2 -->
<g id="node528" class="node">
<title>layer_5_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="247368.7,-729 246926.94,-729 246813.3,-625 247255.06,-625 247368.7,-729"/>
<text text-anchor="middle" x="247091" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="247091" y="-680" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="247091" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="247091" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_tp_2&#45;&gt;layer_5_attn_out_tp_2 -->
<g id="edge977" class="edge">
<title>layer_5_attn_tp_2&#45;&gt;layer_5_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M247091,-794.68C247091,-777.18 247091,-757.43 247091,-739.22"/>
<polygon fill="black" stroke="black" points="247094.5,-739 247091,-729 247087.5,-739 247094.5,-739"/>
</g>
<!-- layer_5_attn_tp_3 -->
<g id="node525" class="node">
<title>layer_5_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="246794.7,-899 246352.94,-899 246239.3,-795 246681.06,-795 246794.7,-899"/>
<text text-anchor="middle" x="246517" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="246517" y="-850" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="246517" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="246517" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_out_tp_3 -->
<g id="node529" class="node">
<title>layer_5_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="246794.7,-729 246352.94,-729 246239.3,-625 246681.06,-625 246794.7,-729"/>
<text text-anchor="middle" x="246517" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="246517" y="-680" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="246517" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="246517" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_5_attn_tp_3&#45;&gt;layer_5_attn_out_tp_3 -->
<g id="edge979" class="edge">
<title>layer_5_attn_tp_3&#45;&gt;layer_5_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M246517,-794.68C246517,-777.18 246517,-757.43 246517,-739.22"/>
<polygon fill="black" stroke="black" points="246520.5,-739 246517,-729 246513.5,-739 246520.5,-739"/>
</g>
<!-- layer_5_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge974" class="edge">
<title>layer_5_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M248115.3,-729.09C248063.12,-748.39 248001.1,-767.91 247943,-777.5 247855.06,-792.02 145347.36,-803.17 145262,-777.5 145212.99,-762.76 145165.21,-726.51 145136.69,-701.83"/>
<polygon fill="black" stroke="black" points="145138.99,-699.19 145129.17,-695.2 145134.36,-704.44 145138.99,-699.19"/>
</g>
<!-- layer_5_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge976" class="edge">
<title>layer_5_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M247541.3,-729.09C247489.12,-748.39 247427.1,-767.91 247369,-777.5 247281.55,-791.94 145346.88,-803.02 145262,-777.5 145212.99,-762.76 145165.21,-726.51 145136.69,-701.83"/>
<polygon fill="black" stroke="black" points="145138.99,-699.19 145129.17,-695.2 145134.36,-704.44 145138.99,-699.19"/>
</g>
<!-- layer_5_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge978" class="edge">
<title>layer_5_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M246967.3,-729.09C246915.12,-748.39 246853.1,-767.91 246795,-777.5 246708.04,-791.86 145346.4,-802.88 145262,-777.5 145212.99,-762.76 145165.21,-726.51 145136.69,-701.83"/>
<polygon fill="black" stroke="black" points="145138.99,-699.19 145129.17,-695.2 145134.36,-704.44 145138.99,-699.19"/>
</g>
<!-- layer_5_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge980" class="edge">
<title>layer_5_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M246393.3,-729.09C246341.12,-748.39 246279.1,-767.91 246221,-777.5 246134.53,-791.78 145345.93,-802.74 145262,-777.5 145212.99,-762.76 145165.21,-726.51 145136.69,-701.83"/>
<polygon fill="black" stroke="black" points="145138.99,-699.19 145129.17,-695.2 145134.36,-704.44 145138.99,-699.19"/>
</g>
<!-- layer_5_attn_allreduce -->
<g id="node530" class="node">
<title>layer_5_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="248731" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="248731" y="-861" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="248731" y="-850" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="248731" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="248731" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_gate_tp_0 -->
<g id="node531" class="node">
<title>layer_5_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="233159.99,-899 232711.4,-899 232596.01,-795 233044.6,-795 233159.99,-899"/>
<text text-anchor="middle" x="232878" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="232878" y="-850" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="232878" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="232878" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_5_route_ep_0 -->
<g id="node535" class="node">
<title>layer_5_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="221607.43,-729 221148.6,-729 221030.57,-625 221489.4,-625 221607.43,-729"/>
<text text-anchor="middle" x="221319" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="221319" y="-680" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="221319" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="221319" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_0 -->
<g id="edge981" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232597.02,-795.94C232593.66,-795.61 232590.32,-795.3 232587,-795 232362.61,-774.98 228757.27,-778.84 228532,-777 228196.43,-774.26 228112.57,-770.58 227777,-768 226745.47,-760.07 226487.49,-772 225456,-760 223980.41,-742.83 222209.15,-700.42 221566.85,-684.33"/>
<polygon fill="black" stroke="black" points="221566.63,-680.82 221556.54,-684.07 221566.45,-687.82 221566.63,-680.82"/>
<text text-anchor="middle" x="228558" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_1 -->
<g id="node536" class="node">
<title>layer_5_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="226041.43,-729 225582.6,-729 225464.57,-625 225923.4,-625 226041.43,-729"/>
<text text-anchor="middle" x="225753" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="225753" y="-680" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="225753" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="225753" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_1 -->
<g id="edge982" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232597,-796.08C232593.65,-795.71 232590.32,-795.35 232587,-795 232414.28,-776.97 231979.63,-771.39 231806,-768 231016.81,-752.58 230819.29,-769.34 230030,-760 228497.66,-741.86 226656.86,-699.69 226000.38,-684.01"/>
<polygon fill="black" stroke="black" points="226000.4,-680.51 225990.32,-683.77 226000.24,-687.51 226000.4,-680.51"/>
<text text-anchor="middle" x="232241" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_2 -->
<g id="node537" class="node">
<title>layer_5_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="230615.43,-729 230156.6,-729 230038.57,-625 230497.4,-625 230615.43,-729"/>
<text text-anchor="middle" x="230327" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="230327" y="-680" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="230327" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="230327" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_2 -->
<g id="edge983" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232794.21,-794.81C232772.7,-784 232749.1,-774.04 232726,-768 232521.96,-714.63 231140.8,-689.39 230571.52,-681.16"/>
<polygon fill="black" stroke="black" points="230571.17,-677.66 230561.12,-681.01 230571.07,-684.66 230571.17,-677.66"/>
<text text-anchor="middle" x="232778" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_3 -->
<g id="node538" class="node">
<title>layer_5_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="233742.43,-729 233283.6,-729 233165.57,-625 233624.4,-625 233742.43,-729"/>
<text text-anchor="middle" x="233454" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="233454" y="-680" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="233454" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="233454" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_3 -->
<g id="edge984" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233063.64,-811.81C233098.59,-805.85 233134.87,-799.97 233169,-795 233237.63,-785.01 233259.68,-802.93 233324,-777 233348.39,-767.17 233372.16,-751.48 233392.56,-735.46"/>
<polygon fill="black" stroke="black" points="233394.9,-738.07 233400.5,-729.07 233390.52,-732.61 233394.9,-738.07"/>
<text text-anchor="middle" x="233366" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_4 -->
<g id="node539" class="node">
<title>layer_5_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="237371.43,-729 236912.6,-729 236794.57,-625 237253.4,-625 237371.43,-729"/>
<text text-anchor="middle" x="237083" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="237083" y="-680" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="237083" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="237083" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_4 -->
<g id="edge985" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233061,-809.79C233096.69,-803.9 233133.92,-798.57 233169,-795 233441.49,-767.29 233511.32,-787.76 233785,-777 233865.93,-773.82 233886.07,-771.17 233967,-768 235044.12,-725.82 236331.42,-694.79 236849.81,-683.1"/>
<polygon fill="black" stroke="black" points="236850.1,-686.59 236860.02,-682.87 236849.95,-679.59 236850.1,-686.59"/>
<text text-anchor="middle" x="233993" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_5 -->
<g id="node540" class="node">
<title>layer_5_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="241875.43,-729 241416.6,-729 241298.57,-625 241757.4,-625 241875.43,-729"/>
<text text-anchor="middle" x="241587" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="241587" y="-680" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="241587" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="241587" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_5 -->
<g id="edge986" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233060.55,-809.16C233096.36,-803.31 233133.75,-798.15 233169,-795 233373.19,-776.74 236654.01,-779.65 236859,-777 238586.57,-754.7 240668.72,-702.17 241355.17,-684.17"/>
<polygon fill="black" stroke="black" points="241355.27,-687.67 241365.17,-683.91 241355.09,-680.67 241355.27,-687.67"/>
<text text-anchor="middle" x="237397" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_6 -->
<g id="node541" class="node">
<title>layer_5_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="245627.43,-729 245168.6,-729 245050.57,-625 245509.4,-625 245627.43,-729"/>
<text text-anchor="middle" x="245339" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="245339" y="-680" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="245339" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="245339" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_6 -->
<g id="edge987" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233060.54,-809.1C233096.36,-803.26 233133.75,-798.11 233169,-795 233348.99,-779.1 239496.75,-812.11 239674,-777 239684.36,-774.95 239685.64,-770.06 239696,-768 239725.81,-762.08 241853.61,-760.42 241884,-760 243098.54,-743.37 244552.79,-701.76 245108.1,-685.08"/>
<polygon fill="black" stroke="black" points="245108.34,-688.58 245118.23,-684.78 245108.13,-681.58 245108.34,-688.58"/>
<text text-anchor="middle" x="239722" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_route_ep_7 -->
<g id="node542" class="node">
<title>layer_5_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="246221.43,-729 245762.6,-729 245644.57,-625 246103.4,-625 246221.43,-729"/>
<text text-anchor="middle" x="245933" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="245933" y="-680" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="245933" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="245933" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_7 -->
<g id="edge988" class="edge">
<title>layer_5_gate_tp_0&#45;&gt;layer_5_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233060.54,-809.09C233096.36,-803.25 233133.75,-798.11 233169,-795 233273.77,-785.76 240638.82,-797.42 240742,-777 240752.36,-774.95 240753.64,-770.05 240764,-768 240830.38,-754.89 245568.95,-769.14 245636,-760 245679.73,-754.04 245726.13,-743.4 245768.92,-731.72"/>
<polygon fill="black" stroke="black" points="245769.86,-735.09 245778.57,-729.05 245768,-728.35 245769.86,-735.09"/>
<text text-anchor="middle" x="240790" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1 -->
<g id="node532" class="node">
<title>layer_5_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="232577.99,-899 232129.4,-899 232014.01,-795 232462.6,-795 232577.99,-899"/>
<text text-anchor="middle" x="232296" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="232296" y="-850" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="232296" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="232296" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_0 -->
<g id="edge989" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232067.93,-843.73C231204.39,-835.02 228052.78,-802.06 225456,-760 223979.83,-736.09 222207.58,-697.72 221565.99,-683.52"/>
<polygon fill="black" stroke="black" points="221565.77,-680.01 221555.69,-683.29 221565.61,-687.01 221565.77,-680.01"/>
<text text-anchor="middle" x="226412" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_1 -->
<g id="edge990" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232069.72,-845.39C231403.72,-842.99 229392.55,-831.43 227725,-777 227110.05,-756.93 226388.02,-716.34 226011.36,-693.86"/>
<polygon fill="black" stroke="black" points="226011.34,-690.36 226001.15,-693.25 226010.92,-697.34 226011.34,-690.36"/>
<text text-anchor="middle" x="227751" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_2 -->
<g id="edge991" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232030.37,-809.89C231917.56,-795.41 231784.51,-779.48 231664,-768 231288.01,-732.17 230851.19,-705.59 230581.91,-690.94"/>
<polygon fill="black" stroke="black" points="230581.78,-687.42 230571.61,-690.38 230581.4,-694.41 230581.78,-687.42"/>
<text text-anchor="middle" x="231776" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_3 -->
<g id="edge992" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232474.7,-805.74C232537.49,-792.49 232608.67,-778.49 232674,-768 232863.15,-737.63 233079.7,-713.48 233236.56,-697.88"/>
<polygon fill="black" stroke="black" points="233237.2,-701.33 233246.8,-696.86 233236.51,-694.36 233237.2,-701.33"/>
<text text-anchor="middle" x="232700" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_4 -->
<g id="edge993" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232479,-809.73C232514.69,-803.85 232551.92,-798.53 232587,-795 232732.76,-780.32 233102.65,-807.23 233246,-777 233256.34,-774.82 233257.65,-770.12 233268,-768 233320.58,-757.21 233697.34,-761.1 233751,-760 234915.44,-736.03 236308.56,-699.06 236850.95,-684.35"/>
<polygon fill="black" stroke="black" points="236851.34,-687.84 236861.25,-684.07 236851.15,-680.85 236851.34,-687.84"/>
<text text-anchor="middle" x="233294" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_5 -->
<g id="edge994" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232478.97,-809.42C232514.66,-803.56 232551.9,-798.34 232587,-795 232710.9,-783.22 233585.07,-801.99 233707,-777 233717.35,-774.88 233718.64,-770.05 233729,-768 233778.74,-758.16 237329.29,-760.55 237380,-760 238896,-743.57 240718.89,-699.89 241354.75,-683.94"/>
<polygon fill="black" stroke="black" points="241355.04,-687.43 241364.95,-683.68 241354.87,-680.43 241355.04,-687.43"/>
<text text-anchor="middle" x="233755" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_6 -->
<g id="edge995" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232478.55,-809.2C232514.36,-803.35 232551.75,-798.18 232587,-795 232744.64,-780.79 235277.72,-778.02 235436,-777 236043.56,-773.08 236195.44,-770.48 236803,-768 237932.1,-763.39 240754.98,-774.29 241884,-760 243098.75,-744.63 244553.25,-702.28 245108.36,-685.24"/>
<polygon fill="black" stroke="black" points="245108.6,-688.73 245118.49,-684.93 245108.38,-681.74 245108.6,-688.73"/>
<text text-anchor="middle" x="236829" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_7 -->
<g id="edge996" class="edge">
<title>layer_5_gate_tp_1&#45;&gt;layer_5_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232478.54,-809.1C232514.36,-803.25 232551.75,-798.11 232587,-795 232774.3,-778.46 239168,-780.48 239356,-777 239472.49,-774.84 239501.51,-770.08 239618,-768 239701.57,-766.51 245553.18,-771.28 245636,-760 245679.73,-754.04 245726.13,-743.41 245768.92,-731.73"/>
<polygon fill="black" stroke="black" points="245769.86,-735.1 245778.57,-729.06 245768,-728.35 245769.86,-735.1"/>
<text text-anchor="middle" x="239644" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2 -->
<g id="node533" class="node">
<title>layer_5_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="233741.99,-899 233293.4,-899 233178.01,-795 233626.6,-795 233741.99,-899"/>
<text text-anchor="middle" x="233460" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="233460" y="-850" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="233460" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="233460" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_0 -->
<g id="edge997" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233179.02,-795.95C233175.66,-795.61 233172.32,-795.3 233169,-795 233042.15,-783.59 228711.36,-768.54 228584,-768 227193.79,-762.13 226846.14,-775.55 225456,-760 223980.4,-743.49 222209.15,-700.68 221566.85,-684.4"/>
<polygon fill="black" stroke="black" points="221566.63,-680.9 221556.54,-684.14 221566.45,-687.9 221566.63,-680.9"/>
<text text-anchor="middle" x="230769" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_1 -->
<g id="edge998" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233179.01,-796.03C233175.65,-795.67 233172.32,-795.33 233169,-795 232814.62,-760.17 232723.5,-797.46 232368,-777 232324.78,-774.51 232314.25,-770.08 232271,-768 232022.29,-756.04 230278.99,-762.83 230030,-760 228497.65,-742.58 226656.85,-699.97 226000.38,-684.09"/>
<polygon fill="black" stroke="black" points="226000.4,-680.59 225990.32,-683.85 226000.23,-687.59 226000.4,-680.59"/>
<text text-anchor="middle" x="232394" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_2 -->
<g id="edge999" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233179.37,-796.32C233175.89,-795.87 233172.44,-795.43 233169,-795 233009.34,-775.09 232968.65,-776.92 232808,-768 231990.65,-722.63 231020.5,-695.04 230574.16,-683.82"/>
<polygon fill="black" stroke="black" points="230574.12,-680.32 230564.04,-683.57 230573.95,-687.32 230574.12,-680.32"/>
<text text-anchor="middle" x="233002" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_3 -->
<g id="edge1000" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233458.17,-794.68C233457.54,-777.18 233456.84,-757.43 233456.19,-739.22"/>
<polygon fill="black" stroke="black" points="233459.68,-738.87 233455.82,-729 233452.68,-739.12 233459.68,-738.87"/>
<text text-anchor="middle" x="233483" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_4 -->
<g id="edge1001" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233643.41,-809.89C233678.98,-804.01 233716.06,-798.66 233751,-795 234352.82,-732 236194.13,-693.87 236848.88,-682"/>
<polygon fill="black" stroke="black" points="236848.97,-685.5 236858.91,-681.82 236848.85,-678.5 236848.97,-685.5"/>
<text text-anchor="middle" x="234114" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_5 -->
<g id="edge1002" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233642.55,-809.14C233678.36,-803.29 233715.75,-798.14 233751,-795 234001.4,-772.72 238024.65,-781.26 238276,-777 239434.41,-757.38 240820.11,-707.33 241357.95,-686.89"/>
<polygon fill="black" stroke="black" points="241358.29,-690.38 241368.15,-686.51 241358.02,-683.39 241358.29,-690.38"/>
<text text-anchor="middle" x="238752" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_6 -->
<g id="edge1003" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233642.54,-809.11C233678.36,-803.26 233715.75,-798.12 233751,-795 234083.09,-765.62 239418.76,-787.17 239752,-777 239820.97,-774.9 239838.03,-770.14 239907,-768 240346.13,-754.37 241444.71,-766.1 241884,-760 243098.54,-743.13 244552.79,-701.66 245108.1,-685.05"/>
<polygon fill="black" stroke="black" points="245108.34,-688.54 245118.23,-684.75 245108.13,-681.55 245108.34,-688.54"/>
<text text-anchor="middle" x="239933" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_7 -->
<g id="edge1004" class="edge">
<title>layer_5_gate_tp_2&#45;&gt;layer_5_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233642.54,-809.1C233678.36,-803.25 233715.75,-798.11 233751,-795 233946.6,-777.74 240623.64,-777.6 240820,-777 240886.89,-776.8 245569.73,-769.1 245636,-760 245679.51,-754.03 245725.66,-743.45 245768.28,-731.84"/>
<polygon fill="black" stroke="black" points="245769.47,-735.14 245778.18,-729.11 245767.61,-728.39 245769.47,-735.14"/>
<text text-anchor="middle" x="244482" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3 -->
<g id="node534" class="node">
<title>layer_5_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="234323.99,-899 233875.4,-899 233760.01,-795 234208.6,-795 234323.99,-899"/>
<text text-anchor="middle" x="234042" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="234042" y="-850" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="234042" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="234042" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_0 -->
<g id="edge1005" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233761.01,-795.96C233757.66,-795.62 233754.32,-795.3 233751,-795 233513.86,-773.37 231846.11,-779.32 231608,-777 231248.44,-773.49 231158.57,-770.27 230799,-768 229611.69,-760.51 226643.27,-772.65 225456,-760 223980.62,-744.27 222209.68,-701 221567.14,-684.5"/>
<polygon fill="black" stroke="black" points="221566.91,-681 221556.83,-684.24 221566.73,-687.99 221566.91,-681"/>
<text text-anchor="middle" x="231634" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_1 -->
<g id="edge1006" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233761.01,-795.99C233757.66,-795.65 233754.32,-795.31 233751,-795 233488.81,-770.19 232829.17,-787.1 232566,-777 232501.04,-774.51 232484.98,-770.11 232420,-768 232154.58,-759.38 230295.54,-762.99 230030,-760 228497.65,-742.75 226656.85,-700.03 226000.38,-684.11"/>
<polygon fill="black" stroke="black" points="226000.4,-680.61 225990.32,-683.87 226000.23,-687.61 226000.4,-680.61"/>
<text text-anchor="middle" x="232592" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_2 -->
<g id="edge1007" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233761,-796.07C233757.65,-795.7 233754.32,-795.34 233751,-795 233504.63,-769.56 233441.45,-787.87 233194,-777 233121.96,-773.84 233104.04,-771.2 233032,-768 232126.91,-727.81 231050.73,-697.1 230574.61,-684.4"/>
<polygon fill="black" stroke="black" points="230574.61,-680.9 230564.52,-684.13 230574.42,-687.89 230574.61,-680.9"/>
<text text-anchor="middle" x="233220" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_3 -->
<g id="edge1008" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233761.8,-796.73C233703.56,-786.35 233658.5,-778.15 233655,-777 233620.77,-765.77 233585,-749.71 233553.29,-733.78"/>
<polygon fill="black" stroke="black" points="233554.52,-730.48 233544.02,-729.07 233551.35,-736.72 233554.52,-730.48"/>
<text text-anchor="middle" x="233681" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_4 -->
<g id="edge1009" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M234252.52,-834.37C234804.38,-803.88 236289.41,-721.84 236857.63,-690.45"/>
<polygon fill="black" stroke="black" points="236858.2,-693.92 236867.99,-689.88 236857.81,-686.94 236858.2,-693.92"/>
<text text-anchor="middle" x="235406" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_5 -->
<g id="edge1010" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M234264.16,-844.88C234963.8,-840.93 237184.13,-825.19 239022,-777 239885.79,-754.35 240912.55,-709.22 241359.89,-688.65"/>
<polygon fill="black" stroke="black" points="241360.19,-692.14 241370.02,-688.19 241359.87,-685.15 241360.19,-692.14"/>
<text text-anchor="middle" x="239326" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_6 -->
<g id="edge1011" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M234262.59,-843.4C235405.87,-829.95 240607.82,-768.76 240690,-768 241220.66,-763.11 241353.38,-768.07 241884,-760 243098.33,-741.52 244552.34,-701 245107.84,-684.85"/>
<polygon fill="black" stroke="black" points="245108.08,-688.34 245117.98,-684.55 245107.88,-681.34 245108.08,-688.34"/>
<text text-anchor="middle" x="240716" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_7 -->
<g id="edge1012" class="edge">
<title>layer_5_gate_tp_3&#45;&gt;layer_5_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M234263.24,-843.95C235051.14,-836.68 237794.15,-811.7 240058,-795 240367.89,-792.71 245329.04,-802.58 245636,-760 245679.5,-753.97 245725.65,-743.37 245768.27,-731.75"/>
<polygon fill="black" stroke="black" points="245769.46,-735.06 245778.17,-729.02 245767.59,-728.31 245769.46,-735.06"/>
<text text-anchor="middle" x="245503" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_5_expert_0_ep_0 -->
<g id="node543" class="node">
<title>layer_5_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="218494.83,-559 218060.82,-559 217949.17,-455 218383.18,-455 218494.83,-559"/>
<text text-anchor="middle" x="218222" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="218222" y="-510" font-family="Arial" font-size="10.00">GPU: 128</text>
<text text-anchor="middle" x="218222" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="218222" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_0_ep_0 -->
<g id="edge1013" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M221088.79,-676.47C220508.81,-676.44 218998.61,-668.57 218503,-590 218462.77,-583.62 218420.2,-573.2 218380.68,-561.89"/>
<polygon fill="black" stroke="black" points="218381.55,-558.5 218370.97,-559.08 218379.6,-565.23 218381.55,-558.5"/>
</g>
<!-- layer_5_expert_1_ep_0 -->
<g id="node544" class="node">
<title>layer_5_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="219057.83,-559 218623.82,-559 218512.17,-455 218946.18,-455 219057.83,-559"/>
<text text-anchor="middle" x="218785" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="218785" y="-510" font-family="Arial" font-size="10.00">GPU: 129</text>
<text text-anchor="middle" x="218785" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="218785" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_1_ep_0 -->
<g id="edge1014" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M221086.17,-674.35C220591.39,-669.67 219449.23,-652.25 219066,-590 219026.12,-583.52 218983.9,-573.16 218944.65,-561.94"/>
<polygon fill="black" stroke="black" points="218945.31,-558.49 218934.73,-559.08 218943.37,-565.22 218945.31,-558.49"/>
</g>
<!-- layer_5_expert_2_ep_0 -->
<g id="node545" class="node">
<title>layer_5_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="219620.83,-559 219186.82,-559 219075.17,-455 219509.18,-455 219620.83,-559"/>
<text text-anchor="middle" x="219348" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="219348" y="-510" font-family="Arial" font-size="10.00">GPU: 130</text>
<text text-anchor="middle" x="219348" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="219348" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_2_ep_0 -->
<g id="edge1015" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M221082.26,-670.76C220685.09,-660.82 219901.3,-636.01 219629,-590 219589.5,-583.33 219547.69,-572.99 219508.73,-561.88"/>
<polygon fill="black" stroke="black" points="219509.47,-558.45 219498.89,-559.04 219507.53,-565.17 219509.47,-558.45"/>
</g>
<!-- layer_5_expert_3_ep_0 -->
<g id="node546" class="node">
<title>layer_5_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="220183.83,-559 219749.82,-559 219638.17,-455 220072.18,-455 220183.83,-559"/>
<text text-anchor="middle" x="219911" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="219911" y="-510" font-family="Arial" font-size="10.00">GPU: 131</text>
<text text-anchor="middle" x="219911" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="219911" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_3_ep_0 -->
<g id="edge1016" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M221084.08,-672.25C220854.84,-665.27 220497.03,-645.52 220192,-590 220153.4,-582.97 220112.52,-572.73 220074.25,-561.84"/>
<polygon fill="black" stroke="black" points="220075.16,-558.46 220064.58,-559.06 220073.23,-565.19 220075.16,-558.46"/>
</g>
<!-- layer_5_expert_4_ep_0 -->
<g id="node547" class="node">
<title>layer_5_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="220746.83,-559 220312.82,-559 220201.17,-455 220635.18,-455 220746.83,-559"/>
<text text-anchor="middle" x="220474" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="220474" y="-510" font-family="Arial" font-size="10.00">GPU: 132</text>
<text text-anchor="middle" x="220474" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="220474" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_4_ep_0 -->
<g id="edge1017" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M221050.12,-642.42C220956.25,-628.74 220850.5,-611.12 220755,-590 220719.13,-582.07 220681.11,-572.08 220645.02,-561.82"/>
<polygon fill="black" stroke="black" points="220645.97,-558.45 220635.39,-559.07 220644.04,-565.18 220645.97,-558.45"/>
</g>
<!-- layer_5_expert_5_ep_0 -->
<g id="node548" class="node">
<title>layer_5_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="221309.83,-559 220875.82,-559 220764.17,-455 221198.18,-455 221309.83,-559"/>
<text text-anchor="middle" x="221037" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="221037" y="-510" font-family="Arial" font-size="10.00">GPU: 133</text>
<text text-anchor="middle" x="221037" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="221037" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_5_ep_0 -->
<g id="edge1018" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M221233.24,-624.91C221201.11,-605.77 221164.44,-583.92 221131.55,-564.33"/>
<polygon fill="black" stroke="black" points="221133.22,-561.25 221122.84,-559.14 221129.64,-567.26 221133.22,-561.25"/>
</g>
<!-- layer_5_expert_6_ep_0 -->
<g id="node549" class="node">
<title>layer_5_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="221872.83,-559 221438.82,-559 221327.17,-455 221761.18,-455 221872.83,-559"/>
<text text-anchor="middle" x="221600" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="221600" y="-510" font-family="Arial" font-size="10.00">GPU: 134</text>
<text text-anchor="middle" x="221600" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="221600" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_6_ep_0 -->
<g id="edge1019" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M221404.45,-624.91C221436.47,-605.77 221473.02,-583.92 221505.78,-564.33"/>
<polygon fill="black" stroke="black" points="221507.68,-567.27 221514.47,-559.14 221504.09,-561.26 221507.68,-567.27"/>
</g>
<!-- layer_5_expert_7_ep_0 -->
<g id="node550" class="node">
<title>layer_5_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="222435.83,-559 222001.82,-559 221890.17,-455 222324.18,-455 222435.83,-559"/>
<text text-anchor="middle" x="222163" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="222163" y="-510" font-family="Arial" font-size="10.00">GPU: 135</text>
<text text-anchor="middle" x="222163" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="222163" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_0&#45;&gt;layer_5_expert_7_ep_0 -->
<g id="edge1020" class="edge">
<title>layer_5_route_ep_0&#45;&gt;layer_5_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M221520.18,-651.85C221628.1,-637.24 221763.01,-616.33 221882,-590 221917.87,-582.06 221955.89,-572.07 221991.98,-561.82"/>
<polygon fill="black" stroke="black" points="221992.96,-565.18 222001.61,-559.06 221991.03,-558.45 221992.96,-565.18"/>
</g>
<!-- layer_5_expert_0_ep_1 -->
<g id="node551" class="node">
<title>layer_5_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="222998.83,-559 222564.82,-559 222453.17,-455 222887.18,-455 222998.83,-559"/>
<text text-anchor="middle" x="222726" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="222726" y="-510" font-family="Arial" font-size="10.00">GPU: 144</text>
<text text-anchor="middle" x="222726" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="222726" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_0_ep_1 -->
<g id="edge1021" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M225522.54,-676.25C224952.64,-675.68 223488.58,-666.54 223007,-590 222966.78,-583.61 222924.2,-573.18 222884.68,-561.87"/>
<polygon fill="black" stroke="black" points="222885.55,-558.48 222874.97,-559.06 222883.6,-565.2 222885.55,-558.48"/>
</g>
<!-- layer_5_expert_1_ep_1 -->
<g id="node552" class="node">
<title>layer_5_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="223561.83,-559 223127.82,-559 223016.17,-455 223450.18,-455 223561.83,-559"/>
<text text-anchor="middle" x="223289" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="223289" y="-510" font-family="Arial" font-size="10.00">GPU: 145</text>
<text text-anchor="middle" x="223289" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="223289" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_1_ep_1 -->
<g id="edge1022" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M225520.11,-674.01C225036.85,-668.71 223939.43,-650.24 223570,-590 223530.12,-583.5 223487.9,-573.12 223448.65,-561.91"/>
<polygon fill="black" stroke="black" points="223449.32,-558.46 223438.74,-559.04 223447.37,-565.18 223449.32,-558.46"/>
</g>
<!-- layer_5_expert_2_ep_1 -->
<g id="node553" class="node">
<title>layer_5_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="224124.83,-559 223690.82,-559 223579.17,-455 224013.18,-455 224124.83,-559"/>
<text text-anchor="middle" x="223852" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="223852" y="-510" font-family="Arial" font-size="10.00">GPU: 146</text>
<text text-anchor="middle" x="223852" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="223852" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_2_ep_1 -->
<g id="edge1023" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M225515.72,-670.13C225131.88,-659.5 224391.66,-634 224133,-590 224093.63,-583.3 224051.95,-572.99 224013.08,-561.91"/>
<polygon fill="black" stroke="black" points="224013.85,-558.49 224003.27,-559.08 224011.91,-565.21 224013.85,-558.49"/>
</g>
<!-- layer_5_expert_3_ep_1 -->
<g id="node554" class="node">
<title>layer_5_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="224687.83,-559 224253.82,-559 224142.17,-455 224576.18,-455 224687.83,-559"/>
<text text-anchor="middle" x="224415" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="224415" y="-510" font-family="Arial" font-size="10.00">GPU: 147</text>
<text text-anchor="middle" x="224415" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="224415" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_3_ep_1 -->
<g id="edge1024" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M225516.1,-670.44C225300.69,-662.14 224974.82,-641.47 224696,-590 224657.53,-582.9 224616.79,-572.65 224578.62,-561.8"/>
<polygon fill="black" stroke="black" points="224579.55,-558.42 224568.98,-559.03 224577.62,-565.15 224579.55,-558.42"/>
</g>
<!-- layer_5_expert_4_ep_1 -->
<g id="node555" class="node">
<title>layer_5_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="225250.83,-559 224816.82,-559 224705.17,-455 225139.18,-455 225250.83,-559"/>
<text text-anchor="middle" x="224978" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="224978" y="-510" font-family="Arial" font-size="10.00">GPU: 148</text>
<text text-anchor="middle" x="224978" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="224978" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_4_ep_1 -->
<g id="edge1025" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M225473.33,-632.91C225403.05,-620.55 225328,-606.02 225259,-590 225223.93,-581.86 225186.76,-571.94 225151.32,-561.86"/>
<polygon fill="black" stroke="black" points="225151.95,-558.4 225141.38,-559.01 225150.03,-565.13 225151.95,-558.4"/>
</g>
<!-- layer_5_expert_5_ep_1 -->
<g id="node556" class="node">
<title>layer_5_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="225813.83,-559 225379.82,-559 225268.17,-455 225702.18,-455 225813.83,-559"/>
<text text-anchor="middle" x="225541" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="225541" y="-510" font-family="Arial" font-size="10.00">GPU: 149</text>
<text text-anchor="middle" x="225541" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="225541" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_5_ep_1 -->
<g id="edge1026" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M225688.53,-624.91C225664.89,-606.18 225637.97,-584.85 225613.66,-565.58"/>
<polygon fill="black" stroke="black" points="225615.54,-562.6 225605.53,-559.14 225611.19,-568.09 225615.54,-562.6"/>
</g>
<!-- layer_5_expert_6_ep_1 -->
<g id="node557" class="node">
<title>layer_5_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="226376.83,-559 225942.82,-559 225831.17,-455 226265.18,-455 226376.83,-559"/>
<text text-anchor="middle" x="226104" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="226104" y="-510" font-family="Arial" font-size="10.00">GPU: 150</text>
<text text-anchor="middle" x="226104" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="226104" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_6_ep_1 -->
<g id="edge1027" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M225859.74,-624.91C225900.33,-605.48 225946.74,-583.27 225988.14,-563.46"/>
<polygon fill="black" stroke="black" points="225989.65,-566.61 225997.16,-559.14 225986.63,-560.3 225989.65,-566.61"/>
</g>
<!-- layer_5_expert_7_ep_1 -->
<g id="node558" class="node">
<title>layer_5_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="226939.83,-559 226505.82,-559 226394.17,-455 226828.18,-455 226939.83,-559"/>
<text text-anchor="middle" x="226667" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="226667" y="-510" font-family="Arial" font-size="10.00">GPU: 151</text>
<text text-anchor="middle" x="226667" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="226667" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_1&#45;&gt;layer_5_expert_7_ep_1 -->
<g id="edge1028" class="edge">
<title>layer_5_route_ep_1&#45;&gt;layer_5_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M225958.52,-655.92C226083.02,-641.82 226244.57,-620.07 226386,-590 226422.39,-582.26 226460.95,-572.25 226497.46,-561.88"/>
<polygon fill="black" stroke="black" points="226498.54,-565.22 226507.19,-559.1 226496.61,-558.48 226498.54,-565.22"/>
</g>
<!-- layer_5_expert_0_ep_2 -->
<g id="node559" class="node">
<title>layer_5_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="227502.83,-559 227068.82,-559 226957.17,-455 227391.18,-455 227502.83,-559"/>
<text text-anchor="middle" x="227230" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="227230" y="-510" font-family="Arial" font-size="10.00">GPU: 160</text>
<text text-anchor="middle" x="227230" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="227230" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_0_ep_2 -->
<g id="edge1029" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M230096.79,-676.47C229516.81,-676.44 228006.61,-668.57 227511,-590 227470.77,-583.62 227428.2,-573.2 227388.68,-561.89"/>
<polygon fill="black" stroke="black" points="227389.55,-558.5 227378.97,-559.08 227387.6,-565.23 227389.55,-558.5"/>
</g>
<!-- layer_5_expert_1_ep_2 -->
<g id="node560" class="node">
<title>layer_5_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="228065.83,-559 227631.82,-559 227520.17,-455 227954.18,-455 228065.83,-559"/>
<text text-anchor="middle" x="227793" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="227793" y="-510" font-family="Arial" font-size="10.00">GPU: 161</text>
<text text-anchor="middle" x="227793" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="227793" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_1_ep_2 -->
<g id="edge1030" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M230094.17,-674.35C229599.39,-669.67 228457.23,-652.25 228074,-590 228034.12,-583.52 227991.9,-573.16 227952.65,-561.94"/>
<polygon fill="black" stroke="black" points="227953.31,-558.49 227942.73,-559.08 227951.37,-565.22 227953.31,-558.49"/>
</g>
<!-- layer_5_expert_2_ep_2 -->
<g id="node561" class="node">
<title>layer_5_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="228628.83,-559 228194.82,-559 228083.17,-455 228517.18,-455 228628.83,-559"/>
<text text-anchor="middle" x="228356" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="228356" y="-510" font-family="Arial" font-size="10.00">GPU: 162</text>
<text text-anchor="middle" x="228356" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="228356" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_2_ep_2 -->
<g id="edge1031" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M230090.26,-670.76C229693.09,-660.82 228909.3,-636.01 228637,-590 228597.5,-583.33 228555.69,-572.99 228516.73,-561.88"/>
<polygon fill="black" stroke="black" points="228517.47,-558.45 228506.89,-559.04 228515.53,-565.17 228517.47,-558.45"/>
</g>
<!-- layer_5_expert_3_ep_2 -->
<g id="node562" class="node">
<title>layer_5_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="229191.83,-559 228757.82,-559 228646.17,-455 229080.18,-455 229191.83,-559"/>
<text text-anchor="middle" x="228919" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="228919" y="-510" font-family="Arial" font-size="10.00">GPU: 163</text>
<text text-anchor="middle" x="228919" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="228919" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_3_ep_2 -->
<g id="edge1032" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M230092.08,-672.25C229862.84,-665.27 229505.03,-645.52 229200,-590 229161.4,-582.97 229120.52,-572.73 229082.25,-561.84"/>
<polygon fill="black" stroke="black" points="229083.16,-558.46 229072.58,-559.06 229081.23,-565.19 229083.16,-558.46"/>
</g>
<!-- layer_5_expert_4_ep_2 -->
<g id="node563" class="node">
<title>layer_5_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="229754.83,-559 229320.82,-559 229209.17,-455 229643.18,-455 229754.83,-559"/>
<text text-anchor="middle" x="229482" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="229482" y="-510" font-family="Arial" font-size="10.00">GPU: 164</text>
<text text-anchor="middle" x="229482" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="229482" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_4_ep_2 -->
<g id="edge1033" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M230058.12,-642.42C229964.25,-628.74 229858.5,-611.12 229763,-590 229727.13,-582.07 229689.11,-572.08 229653.02,-561.82"/>
<polygon fill="black" stroke="black" points="229653.97,-558.45 229643.39,-559.07 229652.04,-565.18 229653.97,-558.45"/>
</g>
<!-- layer_5_expert_5_ep_2 -->
<g id="node564" class="node">
<title>layer_5_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="230317.83,-559 229883.82,-559 229772.17,-455 230206.18,-455 230317.83,-559"/>
<text text-anchor="middle" x="230045" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="230045" y="-510" font-family="Arial" font-size="10.00">GPU: 165</text>
<text text-anchor="middle" x="230045" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="230045" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_5_ep_2 -->
<g id="edge1034" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M230241.24,-624.91C230209.11,-605.77 230172.44,-583.92 230139.55,-564.33"/>
<polygon fill="black" stroke="black" points="230141.22,-561.25 230130.84,-559.14 230137.64,-567.26 230141.22,-561.25"/>
</g>
<!-- layer_5_expert_6_ep_2 -->
<g id="node565" class="node">
<title>layer_5_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="230880.83,-559 230446.82,-559 230335.17,-455 230769.18,-455 230880.83,-559"/>
<text text-anchor="middle" x="230608" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="230608" y="-510" font-family="Arial" font-size="10.00">GPU: 166</text>
<text text-anchor="middle" x="230608" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="230608" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_6_ep_2 -->
<g id="edge1035" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M230412.45,-624.91C230444.47,-605.77 230481.02,-583.92 230513.78,-564.33"/>
<polygon fill="black" stroke="black" points="230515.68,-567.27 230522.47,-559.14 230512.09,-561.26 230515.68,-567.27"/>
</g>
<!-- layer_5_expert_7_ep_2 -->
<g id="node566" class="node">
<title>layer_5_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="231443.83,-559 231009.82,-559 230898.17,-455 231332.18,-455 231443.83,-559"/>
<text text-anchor="middle" x="231171" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="231171" y="-510" font-family="Arial" font-size="10.00">GPU: 167</text>
<text text-anchor="middle" x="231171" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="231171" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_2&#45;&gt;layer_5_expert_7_ep_2 -->
<g id="edge1036" class="edge">
<title>layer_5_route_ep_2&#45;&gt;layer_5_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M230528.18,-651.85C230636.1,-637.24 230771.01,-616.33 230890,-590 230925.87,-582.06 230963.89,-572.07 230999.98,-561.82"/>
<polygon fill="black" stroke="black" points="231000.96,-565.18 231009.61,-559.06 230999.03,-558.45 231000.96,-565.18"/>
</g>
<!-- layer_5_expert_0_ep_3 -->
<g id="node567" class="node">
<title>layer_5_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="232006.83,-559 231572.82,-559 231461.17,-455 231895.18,-455 232006.83,-559"/>
<text text-anchor="middle" x="231734" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="231734" y="-510" font-family="Arial" font-size="10.00">GPU: 176</text>
<text text-anchor="middle" x="231734" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="231734" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_0_ep_3 -->
<g id="edge1037" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M233214.38,-668.19C232866.4,-655.74 232238.39,-628.76 232015,-590 231975.88,-583.21 231934.47,-572.93 231895.8,-561.92"/>
<polygon fill="black" stroke="black" points="231896.61,-558.51 231886.03,-559.1 231894.67,-565.24 231896.61,-558.51"/>
</g>
<!-- layer_5_expert_1_ep_3 -->
<g id="node568" class="node">
<title>layer_5_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="232569.83,-559 232135.82,-559 232024.17,-455 232458.18,-455 232569.83,-559"/>
<text text-anchor="middle" x="232297" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="232297" y="-510" font-family="Arial" font-size="10.00">GPU: 177</text>
<text text-anchor="middle" x="232297" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="232297" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_1_ep_3 -->
<g id="edge1038" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M233210.1,-664.25C233033.38,-652.78 232789.37,-630.85 232578,-590 232540.33,-582.72 232500.43,-572.6 232462.91,-561.95"/>
<polygon fill="black" stroke="black" points="232463.48,-558.48 232452.9,-559.09 232461.55,-565.2 232463.48,-558.48"/>
</g>
<!-- layer_5_expert_2_ep_3 -->
<g id="node569" class="node">
<title>layer_5_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="233132.83,-559 232698.82,-559 232587.17,-455 233021.18,-455 233132.83,-559"/>
<text text-anchor="middle" x="232860" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="232860" y="-510" font-family="Arial" font-size="10.00">GPU: 178</text>
<text text-anchor="middle" x="232860" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="232860" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_2_ep_3 -->
<g id="edge1039" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M233266.42,-624.98C233225.08,-613.59 233181.53,-601.48 233141,-590 233109.29,-581.02 233075.62,-571.32 233043.01,-561.86"/>
<polygon fill="black" stroke="black" points="233043.96,-558.49 233033.38,-559.06 233042.01,-565.21 233043.96,-558.49"/>
</g>
<!-- layer_5_expert_3_ep_3 -->
<g id="node570" class="node">
<title>layer_5_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="233695.83,-559 233261.82,-559 233150.17,-455 233584.18,-455 233695.83,-559"/>
<text text-anchor="middle" x="233423" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="233423" y="-510" font-family="Arial" font-size="10.00">GPU: 179</text>
<text text-anchor="middle" x="233423" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="233423" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_3_ep_3 -->
<g id="edge1040" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M233444.53,-624.68C233441.29,-607.1 233437.62,-587.24 233434.25,-568.97"/>
<polygon fill="black" stroke="black" points="233437.67,-568.2 233432.41,-559 233430.78,-569.47 233437.67,-568.2"/>
</g>
<!-- layer_5_expert_4_ep_3 -->
<g id="node571" class="node">
<title>layer_5_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="234258.83,-559 233824.82,-559 233713.17,-455 234147.18,-455 234258.83,-559"/>
<text text-anchor="middle" x="233986" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="233986" y="-510" font-family="Arial" font-size="10.00">GPU: 180</text>
<text text-anchor="middle" x="233986" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="233986" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_4_ep_3 -->
<g id="edge1041" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M233615.78,-624.91C233678.74,-605.03 233750.94,-582.23 233814.77,-562.07"/>
<polygon fill="black" stroke="black" points="233816.05,-565.34 233824.53,-558.99 233813.94,-558.67 233816.05,-565.34"/>
</g>
<!-- layer_5_expert_5_ep_3 -->
<g id="node572" class="node">
<title>layer_5_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="234821.83,-559 234387.82,-559 234276.17,-455 234710.18,-455 234821.83,-559"/>
<text text-anchor="middle" x="234549" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="234549" y="-510" font-family="Arial" font-size="10.00">GPU: 181</text>
<text text-anchor="middle" x="234549" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="234549" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_5_ep_3 -->
<g id="edge1042" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M233668.51,-663.84C233833.56,-651.95 234066.71,-629.67 234268,-590 234305.42,-582.63 234345.04,-572.53 234382.37,-561.94"/>
<polygon fill="black" stroke="black" points="234383.67,-565.21 234392.32,-559.09 234381.74,-558.48 234383.67,-565.21"/>
</g>
<!-- layer_5_expert_6_ep_3 -->
<g id="node573" class="node">
<title>layer_5_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="235384.83,-559 234950.82,-559 234839.17,-455 235273.18,-455 235384.83,-559"/>
<text text-anchor="middle" x="235112" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="235112" y="-510" font-family="Arial" font-size="10.00">GPU: 182</text>
<text text-anchor="middle" x="235112" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="235112" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_6_ep_3 -->
<g id="edge1043" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M233673.73,-668.21C234004.64,-655.46 234615.18,-627.75 234831,-590 234870.11,-583.16 234911.52,-572.86 234950.19,-561.84"/>
<polygon fill="black" stroke="black" points="234951.31,-565.16 234959.95,-559.03 234949.38,-558.43 234951.31,-565.16"/>
</g>
<!-- layer_5_expert_7_ep_3 -->
<g id="node574" class="node">
<title>layer_5_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="235947.83,-559 235513.82,-559 235402.17,-455 235836.18,-455 235947.83,-559"/>
<text text-anchor="middle" x="235675" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="235675" y="-510" font-family="Arial" font-size="10.00">GPU: 183</text>
<text text-anchor="middle" x="235675" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="235675" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_3&#45;&gt;layer_5_expert_7_ep_3 -->
<g id="edge1044" class="edge">
<title>layer_5_route_ep_3&#45;&gt;layer_5_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M233678.82,-672.79C234116.9,-665.42 235070.23,-643.62 235394,-590 235433.75,-583.42 235475.83,-573.05 235514.98,-561.87"/>
<polygon fill="black" stroke="black" points="235516.24,-565.15 235524.87,-559.01 235514.29,-558.42 235516.24,-565.15"/>
</g>
<!-- layer_5_expert_0_ep_4 -->
<g id="node575" class="node">
<title>layer_5_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="236510.83,-559 236076.82,-559 235965.17,-455 236399.18,-455 236510.83,-559"/>
<text text-anchor="middle" x="236238" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="236238" y="-510" font-family="Arial" font-size="10.00">GPU: 192</text>
<text text-anchor="middle" x="236238" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="236238" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_0_ep_4 -->
<g id="edge1045" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M236814.12,-642.42C236720.25,-628.74 236614.5,-611.12 236519,-590 236483.13,-582.07 236445.11,-572.08 236409.02,-561.82"/>
<polygon fill="black" stroke="black" points="236409.97,-558.45 236399.39,-559.07 236408.04,-565.18 236409.97,-558.45"/>
</g>
<!-- layer_5_expert_1_ep_4 -->
<g id="node576" class="node">
<title>layer_5_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="237073.83,-559 236639.82,-559 236528.17,-455 236962.18,-455 237073.83,-559"/>
<text text-anchor="middle" x="236801" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="236801" y="-510" font-family="Arial" font-size="10.00">GPU: 193</text>
<text text-anchor="middle" x="236801" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="236801" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_1_ep_4 -->
<g id="edge1046" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M236997.24,-624.91C236965.11,-605.77 236928.44,-583.92 236895.55,-564.33"/>
<polygon fill="black" stroke="black" points="236897.22,-561.25 236886.84,-559.14 236893.64,-567.26 236897.22,-561.25"/>
</g>
<!-- layer_5_expert_2_ep_4 -->
<g id="node577" class="node">
<title>layer_5_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="237636.83,-559 237202.82,-559 237091.17,-455 237525.18,-455 237636.83,-559"/>
<text text-anchor="middle" x="237364" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="237364" y="-510" font-family="Arial" font-size="10.00">GPU: 194</text>
<text text-anchor="middle" x="237364" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="237364" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_2_ep_4 -->
<g id="edge1047" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M237168.45,-624.91C237200.47,-605.77 237237.02,-583.92 237269.78,-564.33"/>
<polygon fill="black" stroke="black" points="237271.68,-567.27 237278.47,-559.14 237268.09,-561.26 237271.68,-567.27"/>
</g>
<!-- layer_5_expert_3_ep_4 -->
<g id="node578" class="node">
<title>layer_5_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="238199.83,-559 237765.82,-559 237654.17,-455 238088.18,-455 238199.83,-559"/>
<text text-anchor="middle" x="237927" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="237927" y="-510" font-family="Arial" font-size="10.00">GPU: 195</text>
<text text-anchor="middle" x="237927" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="237927" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_3_ep_4 -->
<g id="edge1048" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M237284.18,-651.85C237392.1,-637.24 237527.01,-616.33 237646,-590 237681.87,-582.06 237719.89,-572.07 237755.98,-561.82"/>
<polygon fill="black" stroke="black" points="237756.96,-565.18 237765.61,-559.06 237755.03,-558.45 237756.96,-565.18"/>
</g>
<!-- layer_5_expert_4_ep_4 -->
<g id="node579" class="node">
<title>layer_5_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="238762.83,-559 238328.82,-559 238217.17,-455 238651.18,-455 238762.83,-559"/>
<text text-anchor="middle" x="238490" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="238490" y="-510" font-family="Arial" font-size="10.00">GPU: 196</text>
<text text-anchor="middle" x="238490" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="238490" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_4_ep_4 -->
<g id="edge1049" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M237307.47,-672.54C237535.99,-665.82 237899.66,-646.32 238209,-590 238247.6,-582.97 238288.48,-572.73 238326.75,-561.84"/>
<polygon fill="black" stroke="black" points="238327.77,-565.19 238336.42,-559.06 238325.84,-558.46 238327.77,-565.19"/>
</g>
<!-- layer_5_expert_5_ep_4 -->
<g id="node580" class="node">
<title>layer_5_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="239325.83,-559 238891.82,-559 238780.17,-455 239214.18,-455 239325.83,-559"/>
<text text-anchor="middle" x="239053" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="239053" y="-510" font-family="Arial" font-size="10.00">GPU: 197</text>
<text text-anchor="middle" x="239053" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="239053" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_5_ep_4 -->
<g id="edge1050" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M237305.9,-671.09C237698.24,-661.39 238496.7,-636.52 238772,-590 238811.5,-583.33 238853.31,-572.99 238892.27,-561.88"/>
<polygon fill="black" stroke="black" points="238893.47,-565.17 238902.11,-559.04 238891.53,-558.45 238893.47,-565.17"/>
</g>
<!-- layer_5_expert_6_ep_4 -->
<g id="node581" class="node">
<title>layer_5_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="239888.83,-559 239454.82,-559 239343.17,-455 239777.18,-455 239888.83,-559"/>
<text text-anchor="middle" x="239616" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="239616" y="-510" font-family="Arial" font-size="10.00">GPU: 198</text>
<text text-anchor="middle" x="239616" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="239616" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_6_ep_4 -->
<g id="edge1051" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M237309.68,-674.41C237800.92,-669.8 238950.37,-652.49 239335,-590 239374.88,-583.52 239417.1,-573.16 239456.35,-561.94"/>
<polygon fill="black" stroke="black" points="239457.63,-565.22 239466.27,-559.08 239455.69,-558.49 239457.63,-565.22"/>
</g>
<!-- layer_5_expert_7_ep_4 -->
<g id="node582" class="node">
<title>layer_5_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="240451.83,-559 240017.82,-559 239906.17,-455 240340.18,-455 240451.83,-559"/>
<text text-anchor="middle" x="240179" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="240179" y="-510" font-family="Arial" font-size="10.00">GPU: 199</text>
<text text-anchor="middle" x="240179" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="240179" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_4&#45;&gt;layer_5_expert_7_ep_4 -->
<g id="edge1052" class="edge">
<title>layer_5_route_ep_4&#45;&gt;layer_5_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M237312.07,-676.46C237891.06,-676.44 239402.26,-668.6 239898,-590 239938.23,-583.62 239980.8,-573.2 240020.32,-561.89"/>
<polygon fill="black" stroke="black" points="240021.4,-565.23 240030.03,-559.08 240019.45,-558.5 240021.4,-565.23"/>
</g>
<!-- layer_5_expert_0_ep_5 -->
<g id="node583" class="node">
<title>layer_5_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="241014.83,-559 240580.82,-559 240469.17,-455 240903.18,-455 241014.83,-559"/>
<text text-anchor="middle" x="240742" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="240742" y="-510" font-family="Arial" font-size="10.00">GPU: 208</text>
<text text-anchor="middle" x="240742" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="240742" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_0_ep_5 -->
<g id="edge1053" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M241318.12,-642.42C241224.25,-628.74 241118.5,-611.12 241023,-590 240987.13,-582.07 240949.11,-572.08 240913.02,-561.82"/>
<polygon fill="black" stroke="black" points="240913.97,-558.45 240903.39,-559.07 240912.04,-565.18 240913.97,-558.45"/>
</g>
<!-- layer_5_expert_1_ep_5 -->
<g id="node584" class="node">
<title>layer_5_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="241577.83,-559 241143.82,-559 241032.17,-455 241466.18,-455 241577.83,-559"/>
<text text-anchor="middle" x="241305" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="241305" y="-510" font-family="Arial" font-size="10.00">GPU: 209</text>
<text text-anchor="middle" x="241305" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="241305" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_1_ep_5 -->
<g id="edge1054" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M241501.24,-624.91C241469.11,-605.77 241432.44,-583.92 241399.55,-564.33"/>
<polygon fill="black" stroke="black" points="241401.22,-561.25 241390.84,-559.14 241397.64,-567.26 241401.22,-561.25"/>
</g>
<!-- layer_5_expert_2_ep_5 -->
<g id="node585" class="node">
<title>layer_5_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="242140.83,-559 241706.82,-559 241595.17,-455 242029.18,-455 242140.83,-559"/>
<text text-anchor="middle" x="241868" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="241868" y="-510" font-family="Arial" font-size="10.00">GPU: 210</text>
<text text-anchor="middle" x="241868" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="241868" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_2_ep_5 -->
<g id="edge1055" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M241672.45,-624.91C241704.47,-605.77 241741.02,-583.92 241773.78,-564.33"/>
<polygon fill="black" stroke="black" points="241775.68,-567.27 241782.47,-559.14 241772.09,-561.26 241775.68,-567.27"/>
</g>
<!-- layer_5_expert_3_ep_5 -->
<g id="node586" class="node">
<title>layer_5_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="242703.83,-559 242269.82,-559 242158.17,-455 242592.18,-455 242703.83,-559"/>
<text text-anchor="middle" x="242431" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="242431" y="-510" font-family="Arial" font-size="10.00">GPU: 211</text>
<text text-anchor="middle" x="242431" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="242431" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_3_ep_5 -->
<g id="edge1056" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M241788.18,-651.85C241896.1,-637.24 242031.01,-616.33 242150,-590 242185.87,-582.06 242223.89,-572.07 242259.98,-561.82"/>
<polygon fill="black" stroke="black" points="242260.96,-565.18 242269.61,-559.06 242259.03,-558.45 242260.96,-565.18"/>
</g>
<!-- layer_5_expert_4_ep_5 -->
<g id="node587" class="node">
<title>layer_5_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="243266.83,-559 242832.82,-559 242721.17,-455 243155.18,-455 243266.83,-559"/>
<text text-anchor="middle" x="242994" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="242994" y="-510" font-family="Arial" font-size="10.00">GPU: 212</text>
<text text-anchor="middle" x="242994" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="242994" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_4_ep_5 -->
<g id="edge1057" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M241811.47,-672.54C242039.99,-665.82 242403.66,-646.32 242713,-590 242751.6,-582.97 242792.48,-572.73 242830.75,-561.84"/>
<polygon fill="black" stroke="black" points="242831.77,-565.19 242840.42,-559.06 242829.84,-558.46 242831.77,-565.19"/>
</g>
<!-- layer_5_expert_5_ep_5 -->
<g id="node588" class="node">
<title>layer_5_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="243829.83,-559 243395.82,-559 243284.17,-455 243718.18,-455 243829.83,-559"/>
<text text-anchor="middle" x="243557" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="243557" y="-510" font-family="Arial" font-size="10.00">GPU: 213</text>
<text text-anchor="middle" x="243557" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="243557" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_5_ep_5 -->
<g id="edge1058" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M241809.9,-671.09C242202.24,-661.39 243000.7,-636.52 243276,-590 243315.5,-583.33 243357.31,-572.99 243396.27,-561.88"/>
<polygon fill="black" stroke="black" points="243397.47,-565.17 243406.11,-559.04 243395.53,-558.45 243397.47,-565.17"/>
</g>
<!-- layer_5_expert_6_ep_5 -->
<g id="node589" class="node">
<title>layer_5_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="244392.83,-559 243958.82,-559 243847.17,-455 244281.18,-455 244392.83,-559"/>
<text text-anchor="middle" x="244120" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="244120" y="-510" font-family="Arial" font-size="10.00">GPU: 214</text>
<text text-anchor="middle" x="244120" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="244120" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_6_ep_5 -->
<g id="edge1059" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M241813.68,-674.41C242304.92,-669.8 243454.37,-652.49 243839,-590 243878.88,-583.52 243921.1,-573.16 243960.35,-561.94"/>
<polygon fill="black" stroke="black" points="243961.63,-565.22 243970.27,-559.08 243959.69,-558.49 243961.63,-565.22"/>
</g>
<!-- layer_5_expert_7_ep_5 -->
<g id="node590" class="node">
<title>layer_5_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="244955.83,-559 244521.82,-559 244410.17,-455 244844.18,-455 244955.83,-559"/>
<text text-anchor="middle" x="244683" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="244683" y="-510" font-family="Arial" font-size="10.00">GPU: 215</text>
<text text-anchor="middle" x="244683" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="244683" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_5&#45;&gt;layer_5_expert_7_ep_5 -->
<g id="edge1060" class="edge">
<title>layer_5_route_ep_5&#45;&gt;layer_5_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M241816.07,-676.46C242395.06,-676.44 243906.26,-668.6 244402,-590 244442.23,-583.62 244484.8,-573.2 244524.32,-561.89"/>
<polygon fill="black" stroke="black" points="244525.4,-565.23 244534.03,-559.08 244523.45,-558.5 244525.4,-565.23"/>
</g>
<!-- layer_5_expert_0_ep_6 -->
<g id="node591" class="node">
<title>layer_5_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="245518.83,-559 245084.82,-559 244973.17,-455 245407.18,-455 245518.83,-559"/>
<text text-anchor="middle" x="245246" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="245246" y="-510" font-family="Arial" font-size="10.00">GPU: 224</text>
<text text-anchor="middle" x="245246" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="245246" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_0_ep_6 -->
<g id="edge1061" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M245310.59,-624.68C245300.68,-606.77 245289.46,-586.51 245279.19,-567.96"/>
<polygon fill="black" stroke="black" points="245282.14,-566.06 245274.23,-559 245276.02,-569.45 245282.14,-566.06"/>
</g>
<!-- layer_5_expert_1_ep_6 -->
<g id="node592" class="node">
<title>layer_5_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="246081.83,-559 245647.82,-559 245536.17,-455 245970.18,-455 246081.83,-559"/>
<text text-anchor="middle" x="245809" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="245809" y="-510" font-family="Arial" font-size="10.00">GPU: 225</text>
<text text-anchor="middle" x="245809" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="245809" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_1_ep_6 -->
<g id="edge1062" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M245481.93,-624.91C245537.07,-605.2 245600.25,-582.62 245656.29,-562.59"/>
<polygon fill="black" stroke="black" points="245657.7,-565.8 245665.94,-559.14 245655.35,-559.21 245657.7,-565.8"/>
</g>
<!-- layer_5_expert_2_ep_6 -->
<g id="node593" class="node">
<title>layer_5_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="246644.83,-559 246210.82,-559 246099.17,-455 246533.18,-455 246644.83,-559"/>
<text text-anchor="middle" x="246372" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="246372" y="-510" font-family="Arial" font-size="10.00">GPU: 226</text>
<text text-anchor="middle" x="246372" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="246372" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_2_ep_6 -->
<g id="edge1063" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M245528.42,-641.42C245564.09,-635.5 245601.14,-629.73 245636,-625 245755.5,-608.78 245785.71,-606.61 245906,-598 245988.09,-592.13 246009.8,-603.4 246091,-590 246130.75,-583.44 246172.83,-573.08 246211.99,-561.9"/>
<polygon fill="black" stroke="black" points="246213.24,-565.18 246221.88,-559.04 246211.3,-558.45 246213.24,-565.18"/>
</g>
<!-- layer_5_expert_3_ep_6 -->
<g id="node594" class="node">
<title>layer_5_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="247207.83,-559 246773.82,-559 246662.17,-455 247096.18,-455 247207.83,-559"/>
<text text-anchor="middle" x="246935" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="246935" y="-510" font-family="Arial" font-size="10.00">GPU: 227</text>
<text text-anchor="middle" x="246935" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="246935" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_3_ep_6 -->
<g id="edge1064" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M245527.55,-640.94C245563.47,-635.02 245600.83,-629.39 245636,-625 245674.15,-620.24 245942.59,-599.73 245981,-598 246055.71,-594.64 246580.03,-601.02 246654,-590 246694.86,-583.91 246738.11,-573.42 246778.11,-561.94"/>
<polygon fill="black" stroke="black" points="246779.31,-565.23 246787.93,-559.08 246777.35,-558.51 246779.31,-565.23"/>
</g>
<!-- layer_5_expert_4_ep_6 -->
<g id="node595" class="node">
<title>layer_5_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="247770.83,-559 247336.82,-559 247225.17,-455 247659.18,-455 247770.83,-559"/>
<text text-anchor="middle" x="247498" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="247498" y="-510" font-family="Arial" font-size="10.00">GPU: 228</text>
<text text-anchor="middle" x="247498" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="247498" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_4_ep_6 -->
<g id="edge1065" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M245527.1,-640.57C245563.15,-634.67 245600.67,-629.13 245636,-625 245762.5,-610.2 245795.01,-616.71 245922,-607 245966.49,-603.6 245977.43,-600.15 246022,-598 246088.31,-594.8 247151.31,-599.61 247217,-590 247258.2,-583.97 247301.81,-573.4 247342.07,-561.82"/>
<polygon fill="black" stroke="black" points="247343.06,-565.17 247351.68,-559.01 247341.1,-558.45 247343.06,-565.17"/>
</g>
<!-- layer_5_expert_5_ep_6 -->
<g id="node596" class="node">
<title>layer_5_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="248333.83,-559 247899.82,-559 247788.17,-455 248222.18,-455 248333.83,-559"/>
<text text-anchor="middle" x="248061" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="248061" y="-510" font-family="Arial" font-size="10.00">GPU: 229</text>
<text text-anchor="middle" x="248061" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="248061" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_5_ep_6 -->
<g id="edge1066" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M245527.06,-640.28C245563.12,-634.41 245600.64,-628.95 245636,-625 245786.83,-608.13 245825.86,-620.82 245977,-607 246007.8,-604.18 246015.14,-600.08 246046,-598 246142.12,-591.54 247684.67,-603.85 247780,-590 247821.2,-584.01 247864.82,-573.46 247905.08,-561.88"/>
<polygon fill="black" stroke="black" points="247906.07,-565.23 247914.69,-559.07 247904.11,-558.51 247906.07,-565.23"/>
</g>
<!-- layer_5_expert_6_ep_6 -->
<g id="node597" class="node">
<title>layer_5_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="248896.83,-559 248462.82,-559 248351.17,-455 248785.18,-455 248896.83,-559"/>
<text text-anchor="middle" x="248624" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="248624" y="-510" font-family="Arial" font-size="10.00">GPU: 230</text>
<text text-anchor="middle" x="248624" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="248624" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_6_ep_6 -->
<g id="edge1067" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M245526.65,-640.19C245562.83,-634.31 245600.5,-628.87 245636,-625 245804.08,-606.66 245848.14,-627.29 246016,-607 246036.68,-604.5 246041.27,-600.05 246062,-598 246188.11,-585.56 248217.58,-608.15 248343,-590 248384.21,-584.04 248427.82,-573.49 248468.08,-561.91"/>
<polygon fill="black" stroke="black" points="248469.08,-565.26 248477.7,-559.1 248467.12,-558.54 248469.08,-565.26"/>
</g>
<!-- layer_5_expert_7_ep_6 -->
<g id="node598" class="node">
<title>layer_5_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="249459.83,-559 249025.82,-559 248914.17,-455 249348.18,-455 249459.83,-559"/>
<text text-anchor="middle" x="249187" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="249187" y="-510" font-family="Arial" font-size="10.00">GPU: 231</text>
<text text-anchor="middle" x="249187" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="249187" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_6&#45;&gt;layer_5_expert_7_ep_6 -->
<g id="edge1068" class="edge">
<title>layer_5_route_ep_6&#45;&gt;layer_5_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M245526.2,-639.71C245562.5,-633.85 245600.34,-628.55 245636,-625 245741.63,-614.49 246484.86,-599.68 246591,-598 246655.3,-596.98 248842.36,-599.21 248906,-590 248947.21,-584.04 248990.82,-573.49 249031.08,-561.91"/>
<polygon fill="black" stroke="black" points="249032.08,-565.26 249040.7,-559.1 249030.12,-558.54 249032.08,-565.26"/>
</g>
<!-- layer_5_expert_0_ep_7 -->
<g id="node599" class="node">
<title>layer_5_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="250022.83,-559 249588.82,-559 249477.17,-455 249911.18,-455 250022.83,-559"/>
<text text-anchor="middle" x="249750" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="249750" y="-510" font-family="Arial" font-size="10.00">GPU: 240</text>
<text text-anchor="middle" x="249750" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="249750" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_0_ep_7 -->
<g id="edge1069" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M246119.75,-639.32C246156.18,-633.47 246194.18,-628.28 246230,-625 246712.91,-580.83 247927.1,-602.84 248412,-598 248470.72,-597.41 249410.9,-598.53 249469,-590 249509.99,-583.98 249553.38,-573.48 249593.47,-561.96"/>
<polygon fill="black" stroke="black" points="249594.69,-565.25 249603.31,-559.09 249592.73,-558.53 249594.69,-565.25"/>
</g>
<!-- layer_5_expert_1_ep_7 -->
<g id="node600" class="node">
<title>layer_5_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="250585.83,-559 250151.82,-559 250040.17,-455 250474.18,-455 250585.83,-559"/>
<text text-anchor="middle" x="250313" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="250313" y="-510" font-family="Arial" font-size="10.00">GPU: 241</text>
<text text-anchor="middle" x="250313" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="250313" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_1_ep_7 -->
<g id="edge1070" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M246119.75,-639.23C246156.17,-633.39 246194.18,-628.22 246230,-625 246335.19,-615.55 249927.52,-605.42 250032,-590 250072.99,-583.95 250116.37,-573.44 250156.46,-561.92"/>
<polygon fill="black" stroke="black" points="250157.69,-565.2 250166.31,-559.05 250155.73,-558.48 250157.69,-565.2"/>
</g>
<!-- layer_5_expert_2_ep_7 -->
<g id="node601" class="node">
<title>layer_5_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="251148.83,-559 250714.82,-559 250603.17,-455 251037.18,-455 251148.83,-559"/>
<text text-anchor="middle" x="250876" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="250876" y="-510" font-family="Arial" font-size="10.00">GPU: 242</text>
<text text-anchor="middle" x="250876" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="250876" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_2_ep_7 -->
<g id="edge1071" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M246119.74,-639.14C246156.17,-633.31 246194.17,-628.17 246230,-625 246388.44,-610.99 248933.95,-608.4 249093,-607 249426.79,-604.06 250264.83,-639.1 250595,-590 250635.87,-583.92 250679.11,-573.44 250719.11,-561.95"/>
<polygon fill="black" stroke="black" points="250720.31,-565.25 250728.94,-559.09 250718.36,-558.53 250720.31,-565.25"/>
</g>
<!-- layer_5_expert_3_ep_7 -->
<g id="node602" class="node">
<title>layer_5_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="251711.83,-559 251277.82,-559 251166.17,-455 251600.18,-455 251711.83,-559"/>
<text text-anchor="middle" x="251439" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="251439" y="-510" font-family="Arial" font-size="10.00">GPU: 243</text>
<text text-anchor="middle" x="251439" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="251439" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_3_ep_7 -->
<g id="edge1072" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M246119.74,-639.11C246156.16,-633.28 246194.17,-628.14 246230,-625 246427.8,-607.64 249605.45,-608.75 249804,-607 250104.9,-604.35 250860.39,-634.44 251158,-590 251198.86,-583.9 251242.11,-573.4 251282.11,-561.92"/>
<polygon fill="black" stroke="black" points="251283.31,-565.21 251291.93,-559.06 251281.35,-558.49 251283.31,-565.21"/>
</g>
<!-- layer_5_expert_4_ep_7 -->
<g id="node603" class="node">
<title>layer_5_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="252274.83,-559 251840.82,-559 251729.17,-455 252163.18,-455 252274.83,-559"/>
<text text-anchor="middle" x="252002" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="252002" y="-510" font-family="Arial" font-size="10.00">GPU: 244</text>
<text text-anchor="middle" x="252002" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="252002" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_4_ep_7 -->
<g id="edge1073" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M246119.73,-639.08C246156.16,-633.26 246194.17,-628.13 246230,-625 246463.34,-604.61 250211.78,-609.06 250446,-607 250729.35,-604.51 251440.77,-631.96 251721,-590 251761.86,-583.88 251805.11,-573.38 251845.1,-561.9"/>
<polygon fill="black" stroke="black" points="251846.3,-565.19 251854.93,-559.04 251844.35,-558.47 251846.3,-565.19"/>
</g>
<!-- layer_5_expert_5_ep_7 -->
<g id="node604" class="node">
<title>layer_5_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="252837.83,-559 252403.82,-559 252292.17,-455 252726.18,-455 252837.83,-559"/>
<text text-anchor="middle" x="252565" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="252565" y="-510" font-family="Arial" font-size="10.00">GPU: 245</text>
<text text-anchor="middle" x="252565" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="252565" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_5_ep_7 -->
<g id="edge1074" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M246119.73,-639.07C246156.16,-633.24 246194.17,-628.12 246230,-625 246496.77,-601.76 250782.23,-609.34 251050,-607 251324.24,-604.6 252012.78,-630.67 252284,-590 252324.86,-583.87 252368.1,-573.37 252408.1,-561.88"/>
<polygon fill="black" stroke="black" points="252409.3,-565.18 252417.92,-559.02 252407.35,-558.46 252409.3,-565.18"/>
</g>
<!-- layer_5_expert_6_ep_7 -->
<g id="node605" class="node">
<title>layer_5_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="253400.83,-559 252966.82,-559 252855.17,-455 253289.18,-455 253400.83,-559"/>
<text text-anchor="middle" x="253128" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="253128" y="-510" font-family="Arial" font-size="10.00">GPU: 246</text>
<text text-anchor="middle" x="253128" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="253128" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_6_ep_7 -->
<g id="edge1075" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M246119.73,-639.06C246156.16,-633.23 246194.17,-628.11 246230,-625 246379.58,-612 251484.87,-608.3 251635,-607 251904.35,-604.66 252580.62,-629.98 252847,-590 252887.86,-583.87 252931.1,-573.36 252971.1,-561.88"/>
<polygon fill="black" stroke="black" points="252972.3,-565.17 252980.92,-559.02 252970.34,-558.45 252972.3,-565.17"/>
</g>
<!-- layer_5_expert_7_ep_7 -->
<g id="node606" class="node">
<title>layer_5_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="253963.83,-559 253529.82,-559 253418.17,-455 253852.18,-455 253963.83,-559"/>
<text text-anchor="middle" x="253691" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="253691" y="-510" font-family="Arial" font-size="10.00">GPU: 247</text>
<text text-anchor="middle" x="253691" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="253691" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_5_route_ep_7&#45;&gt;layer_5_expert_7_ep_7 -->
<g id="edge1076" class="edge">
<title>layer_5_route_ep_7&#45;&gt;layer_5_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M246119.73,-639.05C246156.16,-633.23 246194.17,-628.11 246230,-625 246395.49,-610.64 252043.89,-608.43 252210,-607 252476.68,-604.71 253146.26,-629.6 253410,-590 253450.86,-583.86 253494.1,-573.36 253534.1,-561.87"/>
<polygon fill="black" stroke="black" points="253535.3,-565.17 253543.92,-559.01 253533.34,-558.45 253535.3,-565.17"/>
</g>
<!-- layer_5_agg_ep_0 -->
<g id="node607" class="node">
<title>layer_5_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="220757.07,-410 220306.77,-410 220190.93,-306 220641.23,-306 220757.07,-410"/>
<text text-anchor="middle" x="220474" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="220474" y="-361" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="220474" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="220474" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1077" class="edge">
<title>layer_5_expert_0_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M218394.39,-465.2C218430.11,-458.05 218467.64,-451.47 218503,-447 218833.72,-405.18 219800.93,-376.08 220245.58,-364.54"/>
<polygon fill="black" stroke="black" points="220245.76,-368.03 220255.66,-364.27 220245.58,-361.03 220245.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1078" class="edge">
<title>layer_5_expert_1_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M218957.82,-465.62C218993.43,-458.45 219030.8,-451.77 219066,-447 219478.65,-391.08 219964.25,-370.62 220243.87,-363.19"/>
<polygon fill="black" stroke="black" points="220244.24,-366.68 220254.14,-362.92 220244.05,-359.68 220244.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1079" class="edge">
<title>layer_5_expert_2_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M219521.74,-466.6C219557.11,-459.4 219594.16,-452.46 219629,-447 219841.34,-413.74 220085.74,-389.83 220256.9,-375.41"/>
<polygon fill="black" stroke="black" points="220257.36,-378.88 220267.04,-374.55 220256.78,-371.9 220257.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1080" class="edge">
<title>layer_5_expert_3_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M220079.92,-461.9C220146.29,-444.56 220222.66,-424.62 220290.4,-406.94"/>
<polygon fill="black" stroke="black" points="220291.53,-410.26 220300.33,-404.35 220289.77,-403.49 220291.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1081" class="edge">
<title>layer_5_expert_4_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M220474,-455C220474,-443.95 220474,-432.15 220474,-420.75"/>
<polygon fill="black" stroke="black" points="220477.5,-420.41 220474,-410.41 220470.5,-420.41 220477.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1082" class="edge">
<title>layer_5_expert_5_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M220841.67,-455C220789.2,-441.3 220732.31,-426.44 220679.31,-412.61"/>
<polygon fill="black" stroke="black" points="220680.02,-409.18 220669.46,-410.04 220678.25,-415.95 220680.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1083" class="edge">
<title>layer_5_expert_6_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M221366.13,-455C221350.21,-452.11 221334.39,-449.41 221319,-447 221122.91,-416.29 220899.48,-393.55 220731.64,-378.88"/>
<polygon fill="black" stroke="black" points="220731.94,-375.4 220721.68,-378.02 220731.34,-382.37 220731.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_0&#45;&gt;layer_5_agg_ep_0 -->
<g id="edge1084" class="edge">
<title>layer_5_expert_7_ep_0&#45;&gt;layer_5_agg_ep_0</title>
<path fill="none" stroke="black" d="M221933.44,-454.98C221916.09,-451.99 221898.79,-449.28 221882,-447 221474.89,-391.83 220996.79,-371.18 220715.51,-363.5"/>
<polygon fill="black" stroke="black" points="220715.26,-359.99 220705.17,-363.22 220715.07,-366.99 220715.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_1 -->
<g id="node608" class="node">
<title>layer_5_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="225261.07,-410 224810.77,-410 224694.93,-306 225145.23,-306 225261.07,-410"/>
<text text-anchor="middle" x="224978" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="224978" y="-361" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="224978" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="224978" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1086" class="edge">
<title>layer_5_expert_0_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M222898.39,-465.2C222934.11,-458.05 222971.64,-451.47 223007,-447 223337.72,-405.18 224304.93,-376.08 224749.58,-364.54"/>
<polygon fill="black" stroke="black" points="224749.76,-368.03 224759.66,-364.27 224749.58,-361.03 224749.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1087" class="edge">
<title>layer_5_expert_1_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M223461.82,-465.62C223497.43,-458.45 223534.8,-451.77 223570,-447 223982.65,-391.08 224468.25,-370.62 224747.87,-363.19"/>
<polygon fill="black" stroke="black" points="224748.24,-366.68 224758.14,-362.92 224748.05,-359.68 224748.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1088" class="edge">
<title>layer_5_expert_2_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M224025.74,-466.6C224061.11,-459.4 224098.16,-452.46 224133,-447 224345.34,-413.74 224589.74,-389.83 224760.9,-375.41"/>
<polygon fill="black" stroke="black" points="224761.36,-378.88 224771.04,-374.55 224760.78,-371.9 224761.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1089" class="edge">
<title>layer_5_expert_3_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M224583.92,-461.9C224650.29,-444.56 224726.66,-424.62 224794.4,-406.94"/>
<polygon fill="black" stroke="black" points="224795.53,-410.26 224804.33,-404.35 224793.77,-403.49 224795.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1090" class="edge">
<title>layer_5_expert_4_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M224978,-455C224978,-443.95 224978,-432.15 224978,-420.75"/>
<polygon fill="black" stroke="black" points="224981.5,-420.41 224978,-410.41 224974.5,-420.41 224981.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1091" class="edge">
<title>layer_5_expert_5_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M225345.67,-455C225293.2,-441.3 225236.31,-426.44 225183.31,-412.61"/>
<polygon fill="black" stroke="black" points="225184.02,-409.18 225173.46,-410.04 225182.25,-415.95 225184.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1092" class="edge">
<title>layer_5_expert_6_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M225870.13,-455C225854.21,-452.11 225838.39,-449.41 225823,-447 225626.91,-416.29 225403.48,-393.55 225235.64,-378.88"/>
<polygon fill="black" stroke="black" points="225235.94,-375.4 225225.68,-378.02 225235.34,-382.37 225235.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_1&#45;&gt;layer_5_agg_ep_1 -->
<g id="edge1093" class="edge">
<title>layer_5_expert_7_ep_1&#45;&gt;layer_5_agg_ep_1</title>
<path fill="none" stroke="black" d="M226437.44,-454.98C226420.09,-451.99 226402.79,-449.28 226386,-447 225978.89,-391.83 225500.79,-371.18 225219.51,-363.5"/>
<polygon fill="black" stroke="black" points="225219.26,-359.99 225209.17,-363.22 225219.07,-366.99 225219.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_2 -->
<g id="node609" class="node">
<title>layer_5_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="229765.07,-410 229314.77,-410 229198.93,-306 229649.23,-306 229765.07,-410"/>
<text text-anchor="middle" x="229482" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="229482" y="-361" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="229482" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="229482" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1095" class="edge">
<title>layer_5_expert_0_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M227402.39,-465.2C227438.11,-458.05 227475.64,-451.47 227511,-447 227841.72,-405.18 228808.93,-376.08 229253.58,-364.54"/>
<polygon fill="black" stroke="black" points="229253.76,-368.03 229263.66,-364.27 229253.58,-361.03 229253.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1096" class="edge">
<title>layer_5_expert_1_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M227965.82,-465.62C228001.43,-458.45 228038.8,-451.77 228074,-447 228486.65,-391.08 228972.25,-370.62 229251.87,-363.19"/>
<polygon fill="black" stroke="black" points="229252.24,-366.68 229262.14,-362.92 229252.05,-359.68 229252.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1097" class="edge">
<title>layer_5_expert_2_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M228529.74,-466.6C228565.11,-459.4 228602.16,-452.46 228637,-447 228849.34,-413.74 229093.74,-389.83 229264.9,-375.41"/>
<polygon fill="black" stroke="black" points="229265.36,-378.88 229275.04,-374.55 229264.78,-371.9 229265.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1098" class="edge">
<title>layer_5_expert_3_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M229087.92,-461.9C229154.29,-444.56 229230.66,-424.62 229298.4,-406.94"/>
<polygon fill="black" stroke="black" points="229299.53,-410.26 229308.33,-404.35 229297.77,-403.49 229299.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1099" class="edge">
<title>layer_5_expert_4_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M229482,-455C229482,-443.95 229482,-432.15 229482,-420.75"/>
<polygon fill="black" stroke="black" points="229485.5,-420.41 229482,-410.41 229478.5,-420.41 229485.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1100" class="edge">
<title>layer_5_expert_5_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M229849.67,-455C229797.2,-441.3 229740.31,-426.44 229687.31,-412.61"/>
<polygon fill="black" stroke="black" points="229688.02,-409.18 229677.46,-410.04 229686.25,-415.95 229688.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1101" class="edge">
<title>layer_5_expert_6_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M230374.13,-455C230358.21,-452.11 230342.39,-449.41 230327,-447 230130.91,-416.29 229907.48,-393.55 229739.64,-378.88"/>
<polygon fill="black" stroke="black" points="229739.94,-375.4 229729.68,-378.02 229739.34,-382.37 229739.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_2&#45;&gt;layer_5_agg_ep_2 -->
<g id="edge1102" class="edge">
<title>layer_5_expert_7_ep_2&#45;&gt;layer_5_agg_ep_2</title>
<path fill="none" stroke="black" d="M230941.44,-454.98C230924.09,-451.99 230906.79,-449.28 230890,-447 230482.89,-391.83 230004.79,-371.18 229723.51,-363.5"/>
<polygon fill="black" stroke="black" points="229723.26,-359.99 229713.17,-363.22 229723.07,-366.99 229723.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_3 -->
<g id="node610" class="node">
<title>layer_5_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="234269.07,-410 233818.77,-410 233702.93,-306 234153.23,-306 234269.07,-410"/>
<text text-anchor="middle" x="233986" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="233986" y="-361" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="233986" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="233986" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1104" class="edge">
<title>layer_5_expert_0_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M231906.39,-465.2C231942.11,-458.05 231979.64,-451.47 232015,-447 232345.72,-405.18 233312.93,-376.08 233757.58,-364.54"/>
<polygon fill="black" stroke="black" points="233757.76,-368.03 233767.66,-364.27 233757.58,-361.03 233757.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1105" class="edge">
<title>layer_5_expert_1_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M232469.82,-465.62C232505.43,-458.45 232542.8,-451.77 232578,-447 232990.65,-391.08 233476.25,-370.62 233755.87,-363.19"/>
<polygon fill="black" stroke="black" points="233756.24,-366.68 233766.14,-362.92 233756.05,-359.68 233756.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1106" class="edge">
<title>layer_5_expert_2_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M233033.74,-466.6C233069.11,-459.4 233106.16,-452.46 233141,-447 233353.34,-413.74 233597.74,-389.83 233768.9,-375.41"/>
<polygon fill="black" stroke="black" points="233769.36,-378.88 233779.04,-374.55 233768.78,-371.9 233769.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1107" class="edge">
<title>layer_5_expert_3_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M233591.92,-461.9C233658.29,-444.56 233734.66,-424.62 233802.4,-406.94"/>
<polygon fill="black" stroke="black" points="233803.53,-410.26 233812.33,-404.35 233801.77,-403.49 233803.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1108" class="edge">
<title>layer_5_expert_4_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M233986,-455C233986,-443.95 233986,-432.15 233986,-420.75"/>
<polygon fill="black" stroke="black" points="233989.5,-420.41 233986,-410.41 233982.5,-420.41 233989.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1109" class="edge">
<title>layer_5_expert_5_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M234353.67,-455C234301.2,-441.3 234244.31,-426.44 234191.31,-412.61"/>
<polygon fill="black" stroke="black" points="234192.02,-409.18 234181.46,-410.04 234190.25,-415.95 234192.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1110" class="edge">
<title>layer_5_expert_6_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M234878.13,-455C234862.21,-452.11 234846.39,-449.41 234831,-447 234634.91,-416.29 234411.48,-393.55 234243.64,-378.88"/>
<polygon fill="black" stroke="black" points="234243.94,-375.4 234233.68,-378.02 234243.34,-382.37 234243.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_3&#45;&gt;layer_5_agg_ep_3 -->
<g id="edge1111" class="edge">
<title>layer_5_expert_7_ep_3&#45;&gt;layer_5_agg_ep_3</title>
<path fill="none" stroke="black" d="M235445.44,-454.98C235428.09,-451.99 235410.79,-449.28 235394,-447 234986.89,-391.83 234508.79,-371.18 234227.51,-363.5"/>
<polygon fill="black" stroke="black" points="234227.26,-359.99 234217.17,-363.22 234227.07,-366.99 234227.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_4 -->
<g id="node611" class="node">
<title>layer_5_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="238773.07,-410 238322.77,-410 238206.93,-306 238657.23,-306 238773.07,-410"/>
<text text-anchor="middle" x="238490" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="238490" y="-361" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="238490" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="238490" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1113" class="edge">
<title>layer_5_expert_0_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M236410.39,-465.2C236446.11,-458.05 236483.64,-451.47 236519,-447 236849.72,-405.18 237816.93,-376.08 238261.58,-364.54"/>
<polygon fill="black" stroke="black" points="238261.76,-368.03 238271.66,-364.27 238261.58,-361.03 238261.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1114" class="edge">
<title>layer_5_expert_1_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M236973.82,-465.62C237009.43,-458.45 237046.8,-451.77 237082,-447 237494.65,-391.08 237980.25,-370.62 238259.87,-363.19"/>
<polygon fill="black" stroke="black" points="238260.24,-366.68 238270.14,-362.92 238260.05,-359.68 238260.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1115" class="edge">
<title>layer_5_expert_2_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M237537.74,-466.6C237573.11,-459.4 237610.16,-452.46 237645,-447 237857.34,-413.74 238101.74,-389.83 238272.9,-375.41"/>
<polygon fill="black" stroke="black" points="238273.36,-378.88 238283.04,-374.55 238272.78,-371.9 238273.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1116" class="edge">
<title>layer_5_expert_3_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M238095.92,-461.9C238162.29,-444.56 238238.66,-424.62 238306.4,-406.94"/>
<polygon fill="black" stroke="black" points="238307.53,-410.26 238316.33,-404.35 238305.77,-403.49 238307.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1117" class="edge">
<title>layer_5_expert_4_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M238490,-455C238490,-443.95 238490,-432.15 238490,-420.75"/>
<polygon fill="black" stroke="black" points="238493.5,-420.41 238490,-410.41 238486.5,-420.41 238493.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1118" class="edge">
<title>layer_5_expert_5_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M238857.67,-455C238805.2,-441.3 238748.31,-426.44 238695.31,-412.61"/>
<polygon fill="black" stroke="black" points="238696.02,-409.18 238685.46,-410.04 238694.25,-415.95 238696.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1119" class="edge">
<title>layer_5_expert_6_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M239382.13,-455C239366.21,-452.11 239350.39,-449.41 239335,-447 239138.91,-416.29 238915.48,-393.55 238747.64,-378.88"/>
<polygon fill="black" stroke="black" points="238747.94,-375.4 238737.68,-378.02 238747.34,-382.37 238747.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_4&#45;&gt;layer_5_agg_ep_4 -->
<g id="edge1120" class="edge">
<title>layer_5_expert_7_ep_4&#45;&gt;layer_5_agg_ep_4</title>
<path fill="none" stroke="black" d="M239949.44,-454.98C239932.09,-451.99 239914.79,-449.28 239898,-447 239490.89,-391.83 239012.79,-371.18 238731.51,-363.5"/>
<polygon fill="black" stroke="black" points="238731.26,-359.99 238721.17,-363.22 238731.07,-366.99 238731.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_5 -->
<g id="node612" class="node">
<title>layer_5_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="243277.07,-410 242826.77,-410 242710.93,-306 243161.23,-306 243277.07,-410"/>
<text text-anchor="middle" x="242994" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="242994" y="-361" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="242994" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="242994" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1122" class="edge">
<title>layer_5_expert_0_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M240914.39,-465.2C240950.11,-458.05 240987.64,-451.47 241023,-447 241353.72,-405.18 242320.93,-376.08 242765.58,-364.54"/>
<polygon fill="black" stroke="black" points="242765.76,-368.03 242775.66,-364.27 242765.58,-361.03 242765.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1123" class="edge">
<title>layer_5_expert_1_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M241477.82,-465.62C241513.43,-458.45 241550.8,-451.77 241586,-447 241998.65,-391.08 242484.25,-370.62 242763.87,-363.19"/>
<polygon fill="black" stroke="black" points="242764.24,-366.68 242774.14,-362.92 242764.05,-359.68 242764.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1124" class="edge">
<title>layer_5_expert_2_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M242041.74,-466.6C242077.11,-459.4 242114.16,-452.46 242149,-447 242361.34,-413.74 242605.74,-389.83 242776.9,-375.41"/>
<polygon fill="black" stroke="black" points="242777.36,-378.88 242787.04,-374.55 242776.78,-371.9 242777.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1125" class="edge">
<title>layer_5_expert_3_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M242599.92,-461.9C242666.29,-444.56 242742.66,-424.62 242810.4,-406.94"/>
<polygon fill="black" stroke="black" points="242811.53,-410.26 242820.33,-404.35 242809.77,-403.49 242811.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1126" class="edge">
<title>layer_5_expert_4_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M242994,-455C242994,-443.95 242994,-432.15 242994,-420.75"/>
<polygon fill="black" stroke="black" points="242997.5,-420.41 242994,-410.41 242990.5,-420.41 242997.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1127" class="edge">
<title>layer_5_expert_5_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M243361.67,-455C243309.2,-441.3 243252.31,-426.44 243199.31,-412.61"/>
<polygon fill="black" stroke="black" points="243200.02,-409.18 243189.46,-410.04 243198.25,-415.95 243200.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1128" class="edge">
<title>layer_5_expert_6_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M243886.13,-455C243870.21,-452.11 243854.39,-449.41 243839,-447 243642.91,-416.29 243419.48,-393.55 243251.64,-378.88"/>
<polygon fill="black" stroke="black" points="243251.94,-375.4 243241.68,-378.02 243251.34,-382.37 243251.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_5&#45;&gt;layer_5_agg_ep_5 -->
<g id="edge1129" class="edge">
<title>layer_5_expert_7_ep_5&#45;&gt;layer_5_agg_ep_5</title>
<path fill="none" stroke="black" d="M244453.44,-454.98C244436.09,-451.99 244418.79,-449.28 244402,-447 243994.89,-391.83 243516.79,-371.18 243235.51,-363.5"/>
<polygon fill="black" stroke="black" points="243235.26,-359.99 243225.17,-363.22 243235.07,-366.99 243235.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_6 -->
<g id="node613" class="node">
<title>layer_5_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="247781.07,-410 247330.77,-410 247214.93,-306 247665.23,-306 247781.07,-410"/>
<text text-anchor="middle" x="247498" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="247498" y="-361" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="247498" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="247498" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1131" class="edge">
<title>layer_5_expert_0_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M245418.39,-465.2C245454.11,-458.05 245491.64,-451.47 245527,-447 245857.72,-405.18 246824.93,-376.08 247269.58,-364.54"/>
<polygon fill="black" stroke="black" points="247269.76,-368.03 247279.66,-364.27 247269.58,-361.03 247269.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1132" class="edge">
<title>layer_5_expert_1_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M245981.82,-465.62C246017.43,-458.45 246054.8,-451.77 246090,-447 246502.65,-391.08 246988.25,-370.62 247267.87,-363.19"/>
<polygon fill="black" stroke="black" points="247268.24,-366.68 247278.14,-362.92 247268.05,-359.68 247268.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1133" class="edge">
<title>layer_5_expert_2_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M246545.74,-466.6C246581.11,-459.4 246618.16,-452.46 246653,-447 246865.34,-413.74 247109.74,-389.83 247280.9,-375.41"/>
<polygon fill="black" stroke="black" points="247281.36,-378.88 247291.04,-374.55 247280.78,-371.9 247281.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1134" class="edge">
<title>layer_5_expert_3_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M247103.92,-461.9C247170.29,-444.56 247246.66,-424.62 247314.4,-406.94"/>
<polygon fill="black" stroke="black" points="247315.53,-410.26 247324.33,-404.35 247313.77,-403.49 247315.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1135" class="edge">
<title>layer_5_expert_4_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M247498,-455C247498,-443.95 247498,-432.15 247498,-420.75"/>
<polygon fill="black" stroke="black" points="247501.5,-420.41 247498,-410.41 247494.5,-420.41 247501.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1136" class="edge">
<title>layer_5_expert_5_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M247865.67,-455C247813.2,-441.3 247756.31,-426.44 247703.31,-412.61"/>
<polygon fill="black" stroke="black" points="247704.02,-409.18 247693.46,-410.04 247702.25,-415.95 247704.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1137" class="edge">
<title>layer_5_expert_6_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M248390.13,-455C248374.21,-452.11 248358.39,-449.41 248343,-447 248146.91,-416.29 247923.48,-393.55 247755.64,-378.88"/>
<polygon fill="black" stroke="black" points="247755.94,-375.4 247745.68,-378.02 247755.34,-382.37 247755.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_6&#45;&gt;layer_5_agg_ep_6 -->
<g id="edge1138" class="edge">
<title>layer_5_expert_7_ep_6&#45;&gt;layer_5_agg_ep_6</title>
<path fill="none" stroke="black" d="M248957.44,-454.98C248940.09,-451.99 248922.79,-449.28 248906,-447 248498.89,-391.83 248020.79,-371.18 247739.51,-363.5"/>
<polygon fill="black" stroke="black" points="247739.26,-359.99 247729.17,-363.22 247739.07,-366.99 247739.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_7 -->
<g id="node614" class="node">
<title>layer_5_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="252285.07,-410 251834.77,-410 251718.93,-306 252169.23,-306 252285.07,-410"/>
<text text-anchor="middle" x="252002" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="252002" y="-361" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="252002" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="252002" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_expert_0_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1140" class="edge">
<title>layer_5_expert_0_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M249922.39,-465.2C249958.11,-458.05 249995.64,-451.47 250031,-447 250361.72,-405.18 251328.93,-376.08 251773.58,-364.54"/>
<polygon fill="black" stroke="black" points="251773.76,-368.03 251783.66,-364.27 251773.58,-361.03 251773.76,-368.03"/>
</g>
<!-- layer_5_expert_1_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1141" class="edge">
<title>layer_5_expert_1_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M250485.82,-465.62C250521.43,-458.45 250558.8,-451.77 250594,-447 251006.65,-391.08 251492.25,-370.62 251771.87,-363.19"/>
<polygon fill="black" stroke="black" points="251772.24,-366.68 251782.14,-362.92 251772.05,-359.68 251772.24,-366.68"/>
</g>
<!-- layer_5_expert_2_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1142" class="edge">
<title>layer_5_expert_2_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M251049.74,-466.6C251085.11,-459.4 251122.16,-452.46 251157,-447 251369.34,-413.74 251613.74,-389.83 251784.9,-375.41"/>
<polygon fill="black" stroke="black" points="251785.36,-378.88 251795.04,-374.55 251784.78,-371.9 251785.36,-378.88"/>
</g>
<!-- layer_5_expert_3_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1143" class="edge">
<title>layer_5_expert_3_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M251607.92,-461.9C251674.29,-444.56 251750.66,-424.62 251818.4,-406.94"/>
<polygon fill="black" stroke="black" points="251819.53,-410.26 251828.33,-404.35 251817.77,-403.49 251819.53,-410.26"/>
</g>
<!-- layer_5_expert_4_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1144" class="edge">
<title>layer_5_expert_4_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M252002,-455C252002,-443.95 252002,-432.15 252002,-420.75"/>
<polygon fill="black" stroke="black" points="252005.5,-420.41 252002,-410.41 251998.5,-420.41 252005.5,-420.41"/>
</g>
<!-- layer_5_expert_5_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1145" class="edge">
<title>layer_5_expert_5_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M252369.67,-455C252317.2,-441.3 252260.31,-426.44 252207.31,-412.61"/>
<polygon fill="black" stroke="black" points="252208.02,-409.18 252197.46,-410.04 252206.25,-415.95 252208.02,-409.18"/>
</g>
<!-- layer_5_expert_6_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1146" class="edge">
<title>layer_5_expert_6_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M252894.13,-455C252878.21,-452.11 252862.39,-449.41 252847,-447 252650.91,-416.29 252427.48,-393.55 252259.64,-378.88"/>
<polygon fill="black" stroke="black" points="252259.94,-375.4 252249.68,-378.02 252259.34,-382.37 252259.94,-375.4"/>
</g>
<!-- layer_5_expert_7_ep_7&#45;&gt;layer_5_agg_ep_7 -->
<g id="edge1147" class="edge">
<title>layer_5_expert_7_ep_7&#45;&gt;layer_5_agg_ep_7</title>
<path fill="none" stroke="black" d="M253461.44,-454.98C253444.09,-451.99 253426.79,-449.28 253410,-447 253002.89,-391.83 252524.79,-371.18 252243.51,-363.5"/>
<polygon fill="black" stroke="black" points="252243.26,-359.99 252233.17,-363.22 252243.07,-366.99 252243.26,-359.99"/>
</g>
<!-- layer_5_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1085" class="edge">
<title>layer_5_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M220693.51,-352.85C221317.95,-341.27 223157.8,-308.78 224686,-298 228604.4,-270.36 502899.5,-270.59 506818,-269 537959.2,-256.4 576654.62,-220.23 578924.23,-218.1"/>
<polygon fill="black" stroke="black" points="578924.39,-221.6 578934.38,-218.09 578924.38,-214.6 578924.39,-221.6"/>
</g>
<!-- layer_5_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1094" class="edge">
<title>layer_5_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M225197.51,-352.85C225821.95,-341.26 227661.8,-308.74 229190,-298 229902.36,-292.99 433641.74,-300.73 434354,-288 434366.45,-287.78 434369.55,-287.22 434382,-287 435387.89,-268.92 505811.94,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1103" class="edge">
<title>layer_5_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M229701.51,-352.85C230325.95,-341.26 232165.8,-308.74 233694,-298 234390.81,-293.1 433682.29,-300.45 434379,-288 434391.45,-287.78 434394.55,-287.22 434407,-287 435412.55,-268.92 505812.29,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1112" class="edge">
<title>layer_5_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M234205.51,-352.85C234829.95,-341.26 236669.8,-308.74 238198,-298 238879.25,-293.21 433722.84,-300.18 434404,-288 434416.45,-287.78 434419.55,-287.22 434432,-287 435437.2,-268.93 505812.64,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1121" class="edge">
<title>layer_5_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M238709.51,-352.85C239333.95,-341.26 241173.8,-308.74 242702,-298 243367.7,-293.32 433763.39,-299.9 434429,-288 434441.45,-287.78 434444.55,-287.22 434457,-287 435461.85,-268.94 505812.99,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1130" class="edge">
<title>layer_5_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M243213.51,-352.85C243837.95,-341.26 245677.8,-308.74 247206,-298 247856.15,-293.43 433803.94,-299.62 434454,-288 434466.45,-287.78 434469.55,-287.22 434482,-287 435486.5,-268.94 505813.33,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1139" class="edge">
<title>layer_5_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M247717.51,-352.85C248341.95,-341.26 250181.8,-308.74 251710,-298 252344.6,-293.54 433844.49,-299.34 434479,-288 434491.45,-287.78 434494.55,-287.22 434507,-287 435511.16,-268.95 505813.68,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1148" class="edge">
<title>layer_5_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M252225.91,-356.53C254533.39,-351.67 274222.33,-310.88 290165,-298 290666.18,-297.6 434002.9,-296.96 434504,-288 434516.45,-287.78 434519.55,-287.22 434532,-287 435535.81,-268.96 505814.03,-269.48 506818,-269 537959.2,-254.13 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_5_moe_alltoall -->
<g id="node615" class="node">
<title>layer_5_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="240264" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="240264" y="-861" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="240264" y="-850" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="240264" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="240264" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_5_ln_tp_0 -->
<g id="node616" class="node">
<title>layer_5_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="249512.07,-899 249061.77,-899 248945.93,-795 249396.23,-795 249512.07,-899"/>
<text text-anchor="middle" x="249229" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="249229" y="-850" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="249229" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="249229" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_qkv_tp_0 -->
<g id="node620" class="node">
<title>layer_6_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="180163.7,-729 179721.94,-729 179608.3,-625 180050.06,-625 180163.7,-729"/>
<text text-anchor="middle" x="179886" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="179886" y="-680" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="179886" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="179886" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_5_ln_tp_0&#45;&gt;layer_6_qkv_tp_0 -->
<g id="edge3097" class="edge">
<title>layer_5_ln_tp_0&#45;&gt;layer_6_qkv_tp_0</title>
<path fill="none" stroke="black" d="M248946.66,-795.88C248943.43,-795.57 248940.2,-795.28 248937,-795 248719.84,-776.15 186377.98,-777.34 186160,-777 185827.39,-776.48 180502.33,-806.6 180173,-760 180130.84,-754.03 180086.18,-743.45 180044.97,-731.83"/>
<polygon fill="black" stroke="black" points="180045.7,-728.4 180035.13,-729.02 180043.78,-735.13 180045.7,-728.4"/>
</g>
<!-- layer_5_ln_tp_1 -->
<g id="node617" class="node">
<title>layer_5_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="250096.07,-899 249645.77,-899 249529.93,-795 249980.23,-795 250096.07,-899"/>
<text text-anchor="middle" x="249813" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="249813" y="-850" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="249813" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="249813" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_qkv_tp_1 -->
<g id="node621" class="node">
<title>layer_6_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="180737.7,-729 180295.94,-729 180182.3,-625 180624.06,-625 180737.7,-729"/>
<text text-anchor="middle" x="180460" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="180460" y="-680" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="180460" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="180460" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_5_ln_tp_1&#45;&gt;layer_6_qkv_tp_1 -->
<g id="edge3098" class="edge">
<title>layer_5_ln_tp_1&#45;&gt;layer_6_qkv_tp_1</title>
<path fill="none" stroke="black" d="M249530.66,-795.88C249527.43,-795.57 249524.2,-795.28 249521,-795 249321.58,-777.68 192072.17,-777.18 191872,-777 191833.37,-776.96 180785.25,-765.39 180747,-760 180704.84,-754.06 180660.18,-743.49 180618.96,-731.87"/>
<polygon fill="black" stroke="black" points="180619.7,-728.44 180609.12,-729.05 180617.77,-735.17 180619.7,-728.44"/>
</g>
<!-- layer_5_ln_tp_2 -->
<g id="node618" class="node">
<title>layer_5_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="250680.07,-899 250229.77,-899 250113.93,-795 250564.23,-795 250680.07,-899"/>
<text text-anchor="middle" x="250397" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="250397" y="-850" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="250397" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="250397" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_qkv_tp_2 -->
<g id="node622" class="node">
<title>layer_6_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="181311.7,-729 180869.94,-729 180756.3,-625 181198.06,-625 181311.7,-729"/>
<text text-anchor="middle" x="181034" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="181034" y="-680" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="181034" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="181034" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_5_ln_tp_2&#45;&gt;layer_6_qkv_tp_2 -->
<g id="edge3099" class="edge">
<title>layer_5_ln_tp_2&#45;&gt;layer_6_qkv_tp_2</title>
<path fill="none" stroke="black" d="M250114.66,-795.88C250111.43,-795.57 250108.2,-795.28 250105,-795 249941.1,-780.76 202887.52,-777.1 202723,-777 202685.84,-776.98 181357.8,-765.17 181321,-760 181278.84,-754.08 181234.17,-743.51 181192.96,-731.89"/>
<polygon fill="black" stroke="black" points="181193.69,-728.46 181183.12,-729.08 181191.77,-735.19 181193.69,-728.46"/>
</g>
<!-- layer_5_ln_tp_3 -->
<g id="node619" class="node">
<title>layer_5_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="251264.07,-899 250813.77,-899 250697.93,-795 251148.23,-795 251264.07,-899"/>
<text text-anchor="middle" x="250981" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="250981" y="-850" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="250981" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="250981" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_qkv_tp_3 -->
<g id="node623" class="node">
<title>layer_6_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="181885.7,-729 181443.94,-729 181330.3,-625 181772.06,-625 181885.7,-729"/>
<text text-anchor="middle" x="181608" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="181608" y="-680" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="181608" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="181608" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_5_ln_tp_3&#45;&gt;layer_6_qkv_tp_3 -->
<g id="edge3100" class="edge">
<title>layer_5_ln_tp_3&#45;&gt;layer_6_qkv_tp_3</title>
<path fill="none" stroke="black" d="M250698.66,-795.89C250695.43,-795.57 250692.2,-795.28 250689,-795 250518.24,-780.14 226177.41,-777.24 226006,-777 207393.33,-750.61 184391.61,-685.92 181840.89,-678.67"/>
<polygon fill="black" stroke="black" points="181840.73,-675.16 181830.72,-678.64 181840.71,-682.16 181840.73,-675.16"/>
</g>
<!-- layer_6_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1157" class="edge">
<title>layer_6_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M180065.63,-639.09C180101.07,-633.22 180138.09,-628.08 180173,-625 180173,-625 579225,-607 579225,-607 579247.73,-603.17 579258.88,-607.4 579274,-590 579322.02,-534.72 579355.78,-479.78 579304,-428 579304,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_6_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1158" class="edge">
<title>layer_6_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M180639.63,-639.09C180675.07,-633.22 180712.09,-628.08 180747,-625 180747,-625 579259,-607 579259,-607 579284.73,-603.18 579299.1,-610.59 579315,-590 579359.04,-532.98 579371.95,-478.95 579321,-428 579321,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_6_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1159" class="edge">
<title>layer_6_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M181213.63,-639.09C181249.07,-633.22 181286.09,-628.08 181321,-625 181321,-625 579297,-607 579297,-607 579320.58,-603.17 579334.03,-609.38 579348,-590 579385.16,-538.44 579363.25,-508.7 579348,-447 579345.71,-437.74 579346.17,-432.93 579338,-428 579338,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_6_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1160" class="edge">
<title>layer_6_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M181827.62,-675.58C184054.25,-671.31 202775.27,-636.02 217937,-625 217937,-625 579332,-607 579332,-607 579350.93,-603.14 579361.34,-606.11 579372,-590 579407.07,-536.99 579394.68,-506.37 579372,-447 579367.96,-436.42 579365.34,-432.63 579355,-428 579355,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_6_qkv_comm -->
<g id="node624" class="node">
<title>layer_6_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="179397" cy="-677" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="179397" y="-691" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="179397" y="-680" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="179397" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="179397" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_6_attn_tp_0 -->
<g id="node625" class="node">
<title>layer_6_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="146426.7,-729 145984.94,-729 145871.3,-625 146313.06,-625 146426.7,-729"/>
<text text-anchor="middle" x="146149" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="146149" y="-680" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="146149" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="146149" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_out_tp_0 -->
<g id="node629" class="node">
<title>layer_6_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="146426.7,-559 145984.94,-559 145871.3,-455 146313.06,-455 146426.7,-559"/>
<text text-anchor="middle" x="146149" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="146149" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="146149" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="146149" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_tp_0&#45;&gt;layer_6_attn_out_tp_0 -->
<g id="edge1165" class="edge">
<title>layer_6_attn_tp_0&#45;&gt;layer_6_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M146149,-624.68C146149,-607.18 146149,-587.43 146149,-569.22"/>
<polygon fill="black" stroke="black" points="146152.5,-569 146149,-559 146145.5,-569 146152.5,-569"/>
</g>
<!-- layer_6_attn_tp_1 -->
<g id="node626" class="node">
<title>layer_6_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="147000.7,-729 146558.94,-729 146445.3,-625 146887.06,-625 147000.7,-729"/>
<text text-anchor="middle" x="146723" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="146723" y="-680" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="146723" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="146723" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_out_tp_1 -->
<g id="node630" class="node">
<title>layer_6_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="147000.7,-559 146558.94,-559 146445.3,-455 146887.06,-455 147000.7,-559"/>
<text text-anchor="middle" x="146723" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="146723" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="146723" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="146723" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_tp_1&#45;&gt;layer_6_attn_out_tp_1 -->
<g id="edge1167" class="edge">
<title>layer_6_attn_tp_1&#45;&gt;layer_6_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M146723,-624.68C146723,-607.18 146723,-587.43 146723,-569.22"/>
<polygon fill="black" stroke="black" points="146726.5,-569 146723,-559 146719.5,-569 146726.5,-569"/>
</g>
<!-- layer_6_attn_tp_2 -->
<g id="node627" class="node">
<title>layer_6_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="147574.7,-729 147132.94,-729 147019.3,-625 147461.06,-625 147574.7,-729"/>
<text text-anchor="middle" x="147297" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="147297" y="-680" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="147297" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="147297" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_out_tp_2 -->
<g id="node631" class="node">
<title>layer_6_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="147574.7,-559 147132.94,-559 147019.3,-455 147461.06,-455 147574.7,-559"/>
<text text-anchor="middle" x="147297" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="147297" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="147297" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="147297" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_tp_2&#45;&gt;layer_6_attn_out_tp_2 -->
<g id="edge1169" class="edge">
<title>layer_6_attn_tp_2&#45;&gt;layer_6_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M147297,-624.68C147297,-607.18 147297,-587.43 147297,-569.22"/>
<polygon fill="black" stroke="black" points="147300.5,-569 147297,-559 147293.5,-569 147300.5,-569"/>
</g>
<!-- layer_6_attn_tp_3 -->
<g id="node628" class="node">
<title>layer_6_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="148148.7,-729 147706.94,-729 147593.3,-625 148035.06,-625 148148.7,-729"/>
<text text-anchor="middle" x="147871" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="147871" y="-680" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="147871" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="147871" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_out_tp_3 -->
<g id="node632" class="node">
<title>layer_6_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="148148.7,-559 147706.94,-559 147593.3,-455 148035.06,-455 148148.7,-559"/>
<text text-anchor="middle" x="147871" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="147871" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="147871" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="147871" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_6_attn_tp_3&#45;&gt;layer_6_attn_out_tp_3 -->
<g id="edge1171" class="edge">
<title>layer_6_attn_tp_3&#45;&gt;layer_6_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M147871,-624.68C147871,-607.18 147871,-587.43 147871,-569.22"/>
<polygon fill="black" stroke="black" points="147874.5,-569 147871,-559 147867.5,-569 147874.5,-569"/>
</g>
<!-- layer_6_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1166" class="edge">
<title>layer_6_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M145979.52,-554.41C145919.51,-568.73 145851.2,-582.66 145788,-590 145774.04,-591.62 144785.9,-588.02 144776,-598 144743.39,-630.87 144873.66,-652.59 144980.96,-664.58"/>
<polygon fill="black" stroke="black" points="144980.61,-668.06 144990.93,-665.67 144981.37,-661.1 144980.61,-668.06"/>
</g>
<!-- layer_6_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1168" class="edge">
<title>layer_6_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M146573.49,-559.06C146529.71,-571.73 146481.4,-583.53 146436,-590 146424.76,-591.6 144809.01,-589.95 144801,-598 144772.02,-627.12 144880.63,-648.7 144976.96,-661.69"/>
<polygon fill="black" stroke="black" points="144976.76,-665.2 144987.13,-663.04 144977.68,-658.26 144976.76,-665.2"/>
</g>
<!-- layer_6_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1170" class="edge">
<title>layer_6_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M147147.5,-559.1C147103.72,-571.77 147055.41,-583.56 147010,-590 146994.98,-592.13 144836.7,-587.26 144826,-598 144768.2,-656.01 144893.89,-671.97 144996.1,-675.78"/>
<polygon fill="black" stroke="black" points="144996.11,-679.28 145006.22,-676.12 144996.35,-672.29 144996.11,-679.28"/>
</g>
<!-- layer_6_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1172" class="edge">
<title>layer_6_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M147721.87,-559.01C147677.99,-571.72 147629.54,-583.55 147584,-590 147574.6,-591.33 144857.7,-591.28 144851,-598 144800.42,-648.72 144902.07,-666.69 144992.49,-672.93"/>
<polygon fill="black" stroke="black" points="144992.4,-676.43 145002.6,-673.59 144992.85,-669.45 144992.4,-676.43"/>
</g>
<!-- layer_6_attn_allreduce -->
<g id="node633" class="node">
<title>layer_6_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="169689" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="169689" y="-691" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="169689" y="-680" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="169689" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="169689" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_gate_tp_0 -->
<g id="node634" class="node">
<title>layer_6_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="160721.99,-729 160273.4,-729 160158.01,-625 160606.6,-625 160721.99,-729"/>
<text text-anchor="middle" x="160440" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="160440" y="-680" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="160440" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="160440" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_6_route_ep_0 -->
<g id="node638" class="node">
<title>layer_6_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="169727.43,-559 169268.6,-559 169150.57,-455 169609.4,-455 169727.43,-559"/>
<text text-anchor="middle" x="169439" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="169439" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="169439" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="169439" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_0 -->
<g id="edge1173" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160622.99,-639.61C160658.68,-633.74 160695.91,-628.46 160731,-625 161078.74,-590.74 161167.96,-623.45 161517,-607 161573.08,-604.36 161586.9,-600.06 161643,-598 162041.51,-583.34 164833.24,-594.33 165232,-590 166748,-573.54 168570.89,-529.88 169206.75,-513.93"/>
<polygon fill="black" stroke="black" points="169207.04,-517.43 169216.95,-513.68 169206.87,-510.43 169207.04,-517.43"/>
<text text-anchor="middle" x="161669" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_1 -->
<g id="node639" class="node">
<title>layer_6_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="161663.43,-559 161204.6,-559 161086.57,-455 161545.4,-455 161663.43,-559"/>
<text text-anchor="middle" x="161375" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="161375" y="-510" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="161375" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="161375" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_1 -->
<g id="edge1174" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160497.5,-624.88C160512.11,-614.35 160528.4,-604.5 160545,-598 160651.3,-556.34 160941.11,-531.87 161148.3,-519.21"/>
<polygon fill="black" stroke="black" points="161148.65,-522.7 161158.42,-518.6 161148.22,-515.71 161148.65,-522.7"/>
<text text-anchor="middle" x="160571" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_2 -->
<g id="node640" class="node">
<title>layer_6_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="178805.43,-559 178346.6,-559 178228.57,-455 178687.4,-455 178805.43,-559"/>
<text text-anchor="middle" x="178517" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="178517" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="178517" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="178517" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_2 -->
<g id="edge1175" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160622.54,-639.1C160658.36,-633.25 160695.75,-628.11 160731,-625 160924.61,-607.91 167533.64,-608.35 167728,-607 168082.24,-604.54 168170.76,-600.25 168525,-598 169794.98,-589.94 172970.07,-603.06 174240,-590 175784.23,-574.12 177641.66,-529.94 178284.65,-513.91"/>
<polygon fill="black" stroke="black" points="178285.05,-517.4 178294.96,-513.65 178284.88,-510.4 178285.05,-517.4"/>
<text text-anchor="middle" x="168551" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_3 -->
<g id="node641" class="node">
<title>layer_6_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="149459.43,-559 149000.6,-559 148882.57,-455 149341.4,-455 149459.43,-559"/>
<text text-anchor="middle" x="149171" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="149171" y="-510" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="149171" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="149171" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_3 -->
<g id="edge1176" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160211.76,-673.76C159336.11,-665.06 156107.43,-631.85 153448,-590 151915.05,-565.88 150073.22,-527.34 149417.5,-513.32"/>
<polygon fill="black" stroke="black" points="149417.53,-509.82 149407.45,-513.1 149417.38,-516.82 149417.53,-509.82"/>
<text text-anchor="middle" x="154424" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_4 -->
<g id="node642" class="node">
<title>layer_6_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="158614.43,-559 158155.6,-559 158037.57,-455 158496.4,-455 158614.43,-559"/>
<text text-anchor="middle" x="158326" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="158326" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="158326" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="158326" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_4 -->
<g id="edge1177" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160199.48,-662.39C159983.93,-649.72 159659.18,-629.44 159377,-607 159111.62,-585.89 158809.03,-556.87 158596.89,-535.7"/>
<polygon fill="black" stroke="black" points="158597.15,-532.21 158586.86,-534.7 158596.46,-539.18 158597.15,-532.21"/>
<text text-anchor="middle" x="159403" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_5 -->
<g id="node643" class="node">
<title>layer_6_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="174231.43,-559 173772.6,-559 173654.57,-455 174113.4,-455 174231.43,-559"/>
<text text-anchor="middle" x="173943" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="173943" y="-510" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="173943" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="173943" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_5 -->
<g id="edge1178" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160622.55,-639.21C160658.37,-633.35 160695.75,-628.18 160731,-625 161032,-597.82 163148.91,-616.18 163451,-607 163524.85,-604.75 163543.14,-600.05 163617,-598 163956.81,-588.57 169396.07,-593.53 169736,-590 171252.24,-574.23 173075.44,-530.13 173711.04,-514"/>
<polygon fill="black" stroke="black" points="173711.32,-517.5 173721.23,-513.74 173711.15,-510.5 173711.32,-517.5"/>
<text text-anchor="middle" x="163643" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_6 -->
<g id="node644" class="node">
<title>layer_6_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="165223.43,-559 164764.6,-559 164646.57,-455 165105.4,-455 165223.43,-559"/>
<text text-anchor="middle" x="164935" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="164935" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="164935" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="164935" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_6 -->
<g id="edge1179" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160623.84,-640.18C160659.28,-634.3 160696.21,-628.87 160731,-625 160897.28,-606.52 160943.66,-643.2 161107,-607 161117.31,-604.71 161118.65,-600.11 161129,-598 161158.56,-591.96 161641.84,-590.6 161672,-590 162809.19,-567.33 164169.04,-529.8 164703.32,-514.65"/>
<polygon fill="black" stroke="black" points="164703.56,-518.14 164713.46,-514.36 164703.36,-511.15 164703.56,-518.14"/>
<text text-anchor="middle" x="161155" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_route_ep_7 -->
<g id="node645" class="node">
<title>layer_6_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="154033.43,-559 153574.6,-559 153456.57,-455 153915.4,-455 154033.43,-559"/>
<text text-anchor="middle" x="153745" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="153745" y="-510" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="153745" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="153745" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_7 -->
<g id="edge1180" class="edge">
<title>layer_6_gate_tp_0&#45;&gt;layer_6_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160212.44,-674.26C159575.92,-668.97 157723.01,-650.7 156184,-607 155386.54,-584.35 154443.02,-541.48 153999.49,-520.37"/>
<polygon fill="black" stroke="black" points="153999.58,-516.87 153989.43,-519.89 153999.25,-523.87 153999.58,-516.87"/>
<text text-anchor="middle" x="156210" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1 -->
<g id="node635" class="node">
<title>layer_6_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="161885.99,-729 161437.4,-729 161322.01,-625 161770.6,-625 161885.99,-729"/>
<text text-anchor="middle" x="161604" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="161604" y="-680" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="161604" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="161604" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_0 -->
<g id="edge1181" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161786.56,-639.3C161822.37,-633.43 161859.76,-628.24 161895,-625 162100.37,-606.14 163544.78,-609.18 163751,-607 164409.23,-600.03 164573.81,-600.19 165232,-590 166747.23,-566.54 168569.22,-527.26 169205.89,-513.2"/>
<polygon fill="black" stroke="black" points="169206.18,-516.69 169216.1,-512.97 169206.02,-509.7 169206.18,-516.69"/>
<text text-anchor="middle" x="164667" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_1 -->
<g id="edge1182" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161404.98,-624.86C161398.46,-619.48 161392.42,-613.55 161387,-607 161378.2,-596.38 161373.72,-582.78 161371.71,-569.09"/>
<polygon fill="black" stroke="black" points="161375.19,-568.72 161370.67,-559.14 161368.23,-569.45 161375.19,-568.72"/>
<text text-anchor="middle" x="161413" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_2 -->
<g id="edge1183" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161786.54,-639.1C161822.36,-633.25 161859.75,-628.11 161895,-625 162096.27,-607.24 168966.94,-607.59 169169,-607 171422.78,-600.43 171986.35,-615.38 174240,-590 175783.98,-572.61 177641.1,-529.38 178284.36,-513.75"/>
<polygon fill="black" stroke="black" points="178284.76,-517.24 178294.68,-513.5 178284.59,-510.25 178284.76,-517.24"/>
<text text-anchor="middle" x="173409" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_3 -->
<g id="edge1184" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161323.02,-625.95C161319.66,-625.61 161316.32,-625.3 161313,-625 161136.26,-609.13 158296.44,-608.79 158119,-607 157844.32,-604.23 157775.69,-600.27 157501,-598 155699.72,-583.11 155249.24,-609.04 153448,-590 151915.87,-573.8 150075.4,-530.45 149418.67,-514.24"/>
<polygon fill="black" stroke="black" points="149418.7,-510.74 149408.61,-513.99 149418.52,-517.74 149418.7,-510.74"/>
<text text-anchor="middle" x="158145" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_4 -->
<g id="edge1185" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161323,-626.13C161319.65,-625.74 161316.31,-625.36 161313,-625 161246.44,-617.71 160777.9,-600.76 160711,-598 159932.59,-565.86 159011.08,-532.38 158576.55,-516.87"/>
<polygon fill="black" stroke="black" points="158576.5,-513.36 158566.38,-516.51 158576.25,-520.36 158576.5,-513.36"/>
<text text-anchor="middle" x="160958" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_5 -->
<g id="edge1186" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161786.54,-639.1C161822.36,-633.25 161859.75,-628.11 161895,-625 162269.32,-591.94 168283.35,-616.78 168659,-607 168739.96,-604.89 168760.05,-600.36 168841,-598 169238.62,-586.4 169338.25,-595.65 169736,-590 171251.48,-568.46 173073.77,-527.97 173710.17,-513.4"/>
<polygon fill="black" stroke="black" points="173710.46,-516.89 173720.38,-513.17 173710.3,-509.9 173710.46,-516.89"/>
<text text-anchor="middle" x="168867" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_6 -->
<g id="edge1187" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161787.42,-639.98C161822.99,-634.1 161860.06,-628.72 161895,-625 162438.06,-567.23 164087.54,-526.44 164701.49,-512.9"/>
<polygon fill="black" stroke="black" points="164701.87,-516.39 164711.79,-512.67 164701.71,-509.4 164701.87,-516.39"/>
<text text-anchor="middle" x="162229" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_7 -->
<g id="edge1188" class="edge">
<title>layer_6_gate_tp_1&#45;&gt;layer_6_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161323.01,-625.99C161319.66,-625.65 161316.32,-625.31 161313,-625 161054.79,-600.54 160405.27,-613.86 160146,-607 160039.3,-604.18 160012.72,-600.23 159906,-598 159071.95,-580.59 158863.17,-599.76 158029,-590 156493.69,-572.04 154649.22,-529.73 153992.19,-514.02"/>
<polygon fill="black" stroke="black" points="153992.21,-510.52 153982.13,-513.78 153992.04,-517.52 153992.21,-510.52"/>
<text text-anchor="middle" x="160172" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2 -->
<g id="node636" class="node">
<title>layer_6_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="162467.99,-729 162019.4,-729 161904.01,-625 162352.6,-625 162467.99,-729"/>
<text text-anchor="middle" x="162186" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="162186" y="-680" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="162186" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="162186" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_0 -->
<g id="edge1189" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162409.24,-676.02C163136.2,-675.44 165501.48,-668.62 167457,-607 168095.4,-586.88 168848.59,-543.98 169215.52,-521.85"/>
<polygon fill="black" stroke="black" points="169215.96,-525.33 169225.73,-521.23 169215.54,-518.34 169215.96,-525.33"/>
<text text-anchor="middle" x="167698" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_1 -->
<g id="edge1190" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161905,-626.12C161901.65,-625.73 161898.31,-625.36 161895,-625 161847.46,-619.86 161508.32,-627.26 161465,-607 161445.74,-597.99 161428.75,-582.77 161414.87,-566.93"/>
<polygon fill="black" stroke="black" points="161417.42,-564.53 161408.3,-559.13 161412.06,-569.04 161417.42,-564.53"/>
<text text-anchor="middle" x="161491" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_2 -->
<g id="edge1191" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162407.27,-674.18C163295.68,-666.94 166689.98,-639.83 169483,-625 171687.87,-613.29 172239.31,-637.79 174444,-607 175907.06,-586.57 177665.14,-534.51 178286.14,-515.28"/>
<polygon fill="black" stroke="black" points="178286.67,-518.77 178296.55,-514.96 178286.45,-511.77 178286.67,-518.77"/>
<text text-anchor="middle" x="175024" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_3 -->
<g id="edge1192" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161905.01,-625.95C161901.66,-625.62 161898.32,-625.3 161895,-625 161747.82,-611.7 159382.78,-608.12 159235,-607 158762.11,-603.4 158643.9,-600.4 158171,-598 157121.46,-592.67 154497.5,-600.95 153448,-590 151915.87,-574.02 150075.4,-530.54 149418.67,-514.26"/>
<polygon fill="black" stroke="black" points="149418.7,-510.76 149408.61,-514.01 149418.52,-517.76 149418.7,-510.76"/>
<text text-anchor="middle" x="159261" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_4 -->
<g id="edge1193" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161905.01,-626.02C161901.66,-625.67 161898.32,-625.32 161895,-625 161523.35,-588.66 161427.3,-635.9 161055,-607 161025.04,-604.67 161017.94,-600.51 160988,-598 160097.74,-523.34 159035.07,-510.11 158567.27,-508.11"/>
<polygon fill="black" stroke="black" points="158567.02,-504.61 158557.01,-508.07 158567,-511.61 158567.02,-504.61"/>
<text text-anchor="middle" x="161081" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_5 -->
<g id="edge1194" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162408.56,-675.3C163420.09,-671.88 167590.9,-655.07 168897,-607 168960.19,-604.67 168975.81,-600.36 169039,-598 169348.58,-586.42 169426.24,-594.8 169736,-590 171251.23,-566.54 173073.22,-527.26 173709.89,-513.2"/>
<polygon fill="black" stroke="black" points="173710.18,-516.69 173720.1,-512.97 173710.02,-509.7 173710.18,-516.69"/>
<text text-anchor="middle" x="169065" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_6 -->
<g id="edge1195" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162395.16,-663.22C162901.51,-632.27 164189.81,-553.54 164711.03,-521.69"/>
<polygon fill="black" stroke="black" points="164711.54,-525.16 164721.31,-521.06 164711.11,-518.18 164711.54,-525.16"/>
<text text-anchor="middle" x="163421" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_7 -->
<g id="edge1196" class="edge">
<title>layer_6_gate_tp_2&#45;&gt;layer_6_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161905.01,-625.98C161901.66,-625.64 161898.32,-625.31 161895,-625 161580.12,-595.61 160788.17,-614.19 160472,-607 160350.19,-604.23 160319.82,-600.22 160198,-598 159234.15,-580.4 158992.94,-601 158029,-590 156493.91,-572.48 154649.78,-529.92 153992.48,-514.07"/>
<polygon fill="black" stroke="black" points="153992.5,-510.57 153982.42,-513.83 153992.33,-517.57 153992.5,-510.57"/>
<text text-anchor="middle" x="160498" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3 -->
<g id="node637" class="node">
<title>layer_6_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="161303.99,-729 160855.4,-729 160740.01,-625 161188.6,-625 161303.99,-729"/>
<text text-anchor="middle" x="161022" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="161022" y="-680" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="161022" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="161022" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_0 -->
<g id="edge1197" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161204.56,-639.24C161240.37,-633.38 161277.75,-628.2 161313,-625 161443.58,-613.14 163544.45,-632.79 163673,-607 163683.36,-604.92 163684.64,-600.07 163695,-598 163736.87,-589.65 165189.31,-590.53 165232,-590 166747.75,-571.28 168570.33,-529.03 169206.46,-513.7"/>
<polygon fill="black" stroke="black" points="169206.75,-517.19 169216.67,-513.45 169206.58,-510.19 169206.75,-517.19"/>
<text text-anchor="middle" x="163721" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_1 -->
<g id="edge1198" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161145.73,-624.85C161159.05,-618.98 161172.35,-612.96 161185,-607 161213.39,-593.62 161243.7,-578.31 161271.59,-563.79"/>
<polygon fill="black" stroke="black" points="161273.31,-566.84 161280.55,-559.11 161270.07,-560.64 161273.31,-566.84"/>
<text text-anchor="middle" x="161226" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_2 -->
<g id="edge1199" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161204.54,-639.09C161240.36,-633.24 161277.75,-628.11 161313,-625 161420.61,-615.52 168985.03,-627.97 169091,-607 169101.36,-604.95 169102.64,-600.05 169113,-598 169147.93,-591.1 174204.4,-590.37 174240,-590 175784.22,-573.99 177641.66,-529.89 178284.65,-513.89"/>
<polygon fill="black" stroke="black" points="178285.05,-517.38 178294.96,-513.64 178284.88,-510.39 178285.05,-517.38"/>
<text text-anchor="middle" x="169139" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_3 -->
<g id="edge1200" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160741.02,-625.95C160737.66,-625.61 160734.32,-625.3 160731,-625 160549.39,-608.7 157631.33,-608.18 157449,-607 156909.89,-603.52 156775.12,-600.77 156236,-598 154996.9,-591.63 154687.04,-603.65 153448,-590 151915.64,-573.11 150074.85,-530.18 149418.38,-514.15"/>
<polygon fill="black" stroke="black" points="149418.4,-510.65 149408.32,-513.91 149418.23,-517.65 149418.4,-510.65"/>
<text text-anchor="middle" x="157475" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_4 -->
<g id="edge1201" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160777.35,-624.98C160718.52,-614.41 160655.72,-604.52 160597,-598 160211.28,-555.18 159077.47,-525.03 158572.96,-513.36"/>
<polygon fill="black" stroke="black" points="158572.71,-509.85 158562.63,-513.12 158572.55,-516.85 158572.71,-509.85"/>
<text text-anchor="middle" x="160681" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_5 -->
<g id="edge1202" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161204.54,-639.1C161240.36,-633.25 161277.75,-628.11 161313,-625 161413.55,-616.13 168481.98,-626.6 168581,-607 168591.36,-604.95 168592.64,-600.07 168603,-598 168633.86,-591.82 169704.53,-590.42 169736,-590 171251.73,-569.88 173074.33,-528.5 173710.46,-513.55"/>
<polygon fill="black" stroke="black" points="173710.75,-517.04 173720.66,-513.31 173710.59,-510.04 173710.75,-517.04"/>
<text text-anchor="middle" x="168629" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_6 -->
<g id="edge1203" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M161205.41,-639.88C161240.98,-634 161278.06,-628.65 161313,-625 161484.17,-607.1 161914.99,-603.72 162087,-598 163059.63,-565.67 164219.2,-529.88 164704.06,-515.04"/>
<polygon fill="black" stroke="black" points="164704.44,-518.53 164714.33,-514.73 164704.23,-511.53 164704.44,-518.53"/>
<text text-anchor="middle" x="162113" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_7 -->
<g id="edge1204" class="edge">
<title>layer_6_gate_tp_3&#45;&gt;layer_6_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160741.01,-626.02C160737.66,-625.66 160734.32,-625.32 160731,-625 160729.87,-624.89 159430.13,-598.01 159429,-598 158806.82,-589.77 158651.18,-597.73 158029,-590 156493.7,-570.92 154649.23,-529.3 153992.19,-513.89"/>
<polygon fill="black" stroke="black" points="153992.21,-510.39 153982.13,-513.66 153992.04,-517.39 153992.21,-510.39"/>
<text text-anchor="middle" x="159876" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_6_expert_0_ep_0 -->
<g id="node646" class="node">
<title>layer_6_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="168936.83,-410 168502.82,-410 168391.17,-306 168825.18,-306 168936.83,-410"/>
<text text-anchor="middle" x="168664" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="168664" y="-361" font-family="Arial" font-size="10.00">GPU: 128</text>
<text text-anchor="middle" x="168664" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="168664" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_0_ep_0 -->
<g id="edge1205" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M169170.12,-455C169096.69,-441.07 169016.97,-425.95 168942.99,-411.92"/>
<polygon fill="black" stroke="black" points="168943.54,-408.46 168933.06,-410.04 168942.24,-415.34 168943.54,-408.46"/>
</g>
<!-- layer_6_expert_1_ep_0 -->
<g id="node647" class="node">
<title>layer_6_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="169499.83,-410 169065.82,-410 168954.17,-306 169388.18,-306 169499.83,-410"/>
<text text-anchor="middle" x="169227" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="169227" y="-361" font-family="Arial" font-size="10.00">GPU: 129</text>
<text text-anchor="middle" x="169227" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="169227" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_1_ep_0 -->
<g id="edge1206" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M169365.45,-455C169347.3,-442.41 169327.75,-428.86 169309.21,-416.01"/>
<polygon fill="black" stroke="black" points="169310.99,-412.98 169300.78,-410.16 169307,-418.73 169310.99,-412.98"/>
</g>
<!-- layer_6_expert_2_ep_0 -->
<g id="node648" class="node">
<title>layer_6_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="170062.83,-410 169628.82,-410 169517.17,-306 169951.18,-306 170062.83,-410"/>
<text text-anchor="middle" x="169790" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="169790" y="-361" font-family="Arial" font-size="10.00">GPU: 130</text>
<text text-anchor="middle" x="169790" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="169790" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_2_ep_0 -->
<g id="edge1207" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M169560.78,-455C169592.41,-441.75 169626.61,-427.43 169658.7,-413.99"/>
<polygon fill="black" stroke="black" points="169660.27,-417.13 169668.14,-410.04 169657.56,-410.67 169660.27,-417.13"/>
</g>
<!-- layer_6_expert_3_ep_0 -->
<g id="node649" class="node">
<title>layer_6_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="170625.83,-410 170191.82,-410 170080.17,-306 170514.18,-306 170625.83,-410"/>
<text text-anchor="middle" x="170353" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="170353" y="-361" font-family="Arial" font-size="10.00">GPU: 131</text>
<text text-anchor="middle" x="170353" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="170353" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_3_ep_0 -->
<g id="edge1208" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M169635.27,-477.73C169760.4,-459.34 169925.9,-434.33 170072,-410 170101.46,-405.09 170132.61,-399.67 170163.03,-394.25"/>
<polygon fill="black" stroke="black" points="170163.65,-397.7 170172.87,-392.49 170162.41,-390.81 170163.65,-397.7"/>
</g>
<!-- layer_6_expert_4_ep_0 -->
<g id="node650" class="node">
<title>layer_6_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="171188.83,-410 170754.82,-410 170643.17,-306 171077.18,-306 171188.83,-410"/>
<text text-anchor="middle" x="170916" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="170916" y="-361" font-family="Arial" font-size="10.00">GPU: 132</text>
<text text-anchor="middle" x="170916" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="170916" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_4_ep_0 -->
<g id="edge1209" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M169655.19,-495.13C169895.26,-481.55 170293.93,-454.53 170635,-410 170665.06,-406.08 170696.78,-401.12 170727.67,-395.84"/>
<polygon fill="black" stroke="black" points="170728.4,-399.27 170737.66,-394.12 170727.21,-392.37 170728.4,-399.27"/>
</g>
<!-- layer_6_expert_5_ep_0 -->
<g id="node651" class="node">
<title>layer_6_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="171751.83,-410 171317.82,-410 171206.17,-306 171640.18,-306 171751.83,-410"/>
<text text-anchor="middle" x="171479" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="171479" y="-361" font-family="Arial" font-size="10.00">GPU: 133</text>
<text text-anchor="middle" x="171479" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="171479" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_5_ep_0 -->
<g id="edge1210" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M169663.64,-502.72C169998.8,-495.79 170649.17,-474.52 171198,-410 171228.21,-406.45 171260.09,-401.67 171291.09,-396.45"/>
<polygon fill="black" stroke="black" points="171291.85,-399.88 171301.12,-394.75 171290.68,-392.97 171291.85,-399.88"/>
</g>
<!-- layer_6_expert_6_ep_0 -->
<g id="node652" class="node">
<title>layer_6_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="172314.83,-410 171880.82,-410 171769.17,-306 172203.18,-306 172314.83,-410"/>
<text text-anchor="middle" x="172042" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="172042" y="-361" font-family="Arial" font-size="10.00">GPU: 134</text>
<text text-anchor="middle" x="172042" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="172042" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_6_ep_0 -->
<g id="edge1211" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M169661.47,-500.73C170160.87,-488.26 171358.74,-454.6 171761,-410 171791.35,-406.63 171823.36,-401.94 171854.47,-396.74"/>
<polygon fill="black" stroke="black" points="171855.26,-400.16 171864.54,-395.04 171854.1,-393.26 171855.26,-400.16"/>
</g>
<!-- layer_6_expert_7_ep_0 -->
<g id="node653" class="node">
<title>layer_6_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="172877.83,-410 172443.82,-410 172332.17,-306 172766.18,-306 172877.83,-410"/>
<text text-anchor="middle" x="172605" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="172605" y="-361" font-family="Arial" font-size="10.00">GPU: 135</text>
<text text-anchor="middle" x="172605" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="172605" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_0&#45;&gt;layer_6_expert_7_ep_0 -->
<g id="edge1212" class="edge">
<title>layer_6_route_ep_0&#45;&gt;layer_6_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M169663.7,-502.78C170248.8,-493.7 171809.65,-464.94 172324,-410 172354.36,-406.76 172386.38,-402.12 172417.5,-396.95"/>
<polygon fill="black" stroke="black" points="172418.28,-400.37 172427.56,-395.26 172417.12,-393.47 172418.28,-400.37"/>
</g>
<!-- layer_6_expert_0_ep_1 -->
<g id="node654" class="node">
<title>layer_6_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="159928.83,-410 159494.82,-410 159383.17,-306 159817.18,-306 159928.83,-410"/>
<text text-anchor="middle" x="159656" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="159656" y="-361" font-family="Arial" font-size="10.00">GPU: 144</text>
<text text-anchor="middle" x="159656" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="159656" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_0_ep_1 -->
<g id="edge1213" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M161135.68,-498.29C160851.88,-487.25 160364.65,-462.35 159937.8,-410.06"/>
<polygon fill="black" stroke="black" points="159938.08,-406.57 159927.72,-408.82 159937.22,-413.52 159938.08,-406.57"/>
</g>
<!-- layer_6_expert_1_ep_1 -->
<g id="node655" class="node">
<title>layer_6_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="160491.83,-410 160057.82,-410 159946.17,-306 160380.18,-306 160491.83,-410"/>
<text text-anchor="middle" x="160219" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="160219" y="-361" font-family="Arial" font-size="10.00">GPU: 145</text>
<text text-anchor="middle" x="160219" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="160219" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_1_ep_1 -->
<g id="edge1214" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M161117.87,-482.59C160945.94,-465.77 160714.55,-440.92 160500.55,-410.06"/>
<polygon fill="black" stroke="black" points="160500.78,-406.55 160490.38,-408.58 160499.77,-413.48 160500.78,-406.55"/>
</g>
<!-- layer_6_expert_2_ep_1 -->
<g id="node656" class="node">
<title>layer_6_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="161054.83,-410 160620.82,-410 160509.17,-306 160943.18,-306 161054.83,-410"/>
<text text-anchor="middle" x="160782" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="160782" y="-361" font-family="Arial" font-size="10.00">GPU: 146</text>
<text text-anchor="middle" x="160782" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="160782" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_2_ep_1 -->
<g id="edge1215" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M161169.26,-455C161113.88,-441.27 161053.82,-426.38 160997.9,-412.52"/>
<polygon fill="black" stroke="black" points="160998.42,-409.04 160987.88,-410.04 160996.74,-415.84 160998.42,-409.04"/>
</g>
<!-- layer_6_expert_3_ep_1 -->
<g id="node657" class="node">
<title>layer_6_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="161617.83,-410 161183.82,-410 161072.17,-306 161506.18,-306 161617.83,-410"/>
<text text-anchor="middle" x="161345" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="161345" y="-361" font-family="Arial" font-size="10.00">GPU: 147</text>
<text text-anchor="middle" x="161345" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="161345" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_3_ep_1 -->
<g id="edge1216" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M161364.59,-455C161362.31,-443.84 161359.88,-431.91 161357.53,-420.4"/>
<polygon fill="black" stroke="black" points="161360.92,-419.51 161355.49,-410.41 161354.06,-420.91 161360.92,-419.51"/>
</g>
<!-- layer_6_expert_4_ep_1 -->
<g id="node658" class="node">
<title>layer_6_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="162180.83,-410 161746.82,-410 161635.17,-306 162069.18,-306 162180.83,-410"/>
<text text-anchor="middle" x="161908" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="161908" y="-361" font-family="Arial" font-size="10.00">GPU: 148</text>
<text text-anchor="middle" x="161908" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="161908" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_4_ep_1 -->
<g id="edge1217" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M161549.16,-457.97C161607.55,-441.86 161672.7,-423.89 161731.3,-407.73"/>
<polygon fill="black" stroke="black" points="161732.31,-411.09 161741.02,-405.05 161730.45,-404.34 161732.31,-411.09"/>
</g>
<!-- layer_6_expert_5_ep_1 -->
<g id="node659" class="node">
<title>layer_6_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="162743.83,-410 162309.82,-410 162198.17,-306 162632.18,-306 162743.83,-410"/>
<text text-anchor="middle" x="162471" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="162471" y="-361" font-family="Arial" font-size="10.00">GPU: 149</text>
<text text-anchor="middle" x="162471" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="162471" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_5_ep_1 -->
<g id="edge1218" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M161580.2,-485.41C161745.29,-467.98 161983.05,-440.94 162190,-410 162219.76,-405.55 162251.2,-400.35 162281.85,-394.99"/>
<polygon fill="black" stroke="black" points="162282.52,-398.43 162291.77,-393.25 162281.31,-391.53 162282.52,-398.43"/>
</g>
<!-- layer_6_expert_6_ep_1 -->
<g id="node660" class="node">
<title>layer_6_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="163306.83,-410 162872.82,-410 162761.17,-306 163195.18,-306 163306.83,-410"/>
<text text-anchor="middle" x="163034" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="163034" y="-361" font-family="Arial" font-size="10.00">GPU: 150</text>
<text text-anchor="middle" x="163034" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="163034" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_6_ep_1 -->
<g id="edge1219" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M161594.39,-498.16C161866.9,-486.72 162345.65,-461 162753,-410 162783.08,-406.23 162814.81,-401.36 162845.7,-396.12"/>
<polygon fill="black" stroke="black" points="162846.43,-399.54 162855.7,-394.41 162845.25,-392.65 162846.43,-399.54"/>
</g>
<!-- layer_6_expert_7_ep_1 -->
<g id="node661" class="node">
<title>layer_6_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="163869.83,-410 163435.82,-410 163324.17,-306 163758.18,-306 163869.83,-410"/>
<text text-anchor="middle" x="163597" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="163597" y="-361" font-family="Arial" font-size="10.00">GPU: 151</text>
<text text-anchor="middle" x="163597" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="163597" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_1&#45;&gt;layer_6_expert_7_ep_1 -->
<g id="edge1220" class="edge">
<title>layer_6_route_ep_1&#45;&gt;layer_6_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M161601.41,-504.34C161964.37,-499.53 162698.43,-481.01 163316,-410 163346.34,-406.51 163378.34,-401.75 163409.45,-396.53"/>
<polygon fill="black" stroke="black" points="163410.24,-399.95 163419.51,-394.82 163409.07,-393.04 163410.24,-399.95"/>
</g>
<!-- layer_6_expert_0_ep_2 -->
<g id="node662" class="node">
<title>layer_6_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="177944.83,-410 177510.82,-410 177399.17,-306 177833.18,-306 177944.83,-410"/>
<text text-anchor="middle" x="177672" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="177672" y="-361" font-family="Arial" font-size="10.00">GPU: 160</text>
<text text-anchor="middle" x="177672" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="177672" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_0_ep_2 -->
<g id="edge1221" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M178231.78,-458.08C178142.48,-442.9 178043.61,-425.93 177953,-410 177952.9,-409.98 177952.79,-409.96 177952.69,-409.95"/>
<polygon fill="black" stroke="black" points="177953.51,-406.54 177943.05,-408.25 177952.29,-413.43 177953.51,-406.54"/>
</g>
<!-- layer_6_expert_1_ep_2 -->
<g id="node663" class="node">
<title>layer_6_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="178507.83,-410 178073.82,-410 177962.17,-306 178396.18,-306 178507.83,-410"/>
<text text-anchor="middle" x="178235" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="178235" y="-361" font-family="Arial" font-size="10.00">GPU: 161</text>
<text text-anchor="middle" x="178235" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="178235" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_1_ep_2 -->
<g id="edge1222" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M178419.16,-455C178394.26,-442.02 178367.37,-428 178342.03,-414.79"/>
<polygon fill="black" stroke="black" points="178343.63,-411.68 178333.14,-410.16 178340.39,-417.89 178343.63,-411.68"/>
</g>
<!-- layer_6_expert_2_ep_2 -->
<g id="node664" class="node">
<title>layer_6_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="179070.83,-410 178636.82,-410 178525.17,-306 178959.18,-306 179070.83,-410"/>
<text text-anchor="middle" x="178798" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="178798" y="-361" font-family="Arial" font-size="10.00">GPU: 162</text>
<text text-anchor="middle" x="178798" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="178798" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_2_ep_2 -->
<g id="edge1223" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M178614.49,-455C178639.2,-442.07 178665.87,-428.12 178691.02,-414.97"/>
<polygon fill="black" stroke="black" points="178692.97,-417.9 178700.21,-410.16 178689.72,-411.69 178692.97,-417.9"/>
</g>
<!-- layer_6_expert_3_ep_2 -->
<g id="node665" class="node">
<title>layer_6_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="179633.83,-410 179199.82,-410 179088.17,-306 179522.18,-306 179633.83,-410"/>
<text text-anchor="middle" x="179361" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="179361" y="-361" font-family="Arial" font-size="10.00">GPU: 163</text>
<text text-anchor="middle" x="179361" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="179361" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_3_ep_2 -->
<g id="edge1224" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M178708.94,-473.79C178817.83,-455.39 178956.59,-431.72 179080,-410 179109.17,-404.87 179140.04,-399.35 179170.21,-393.91"/>
<polygon fill="black" stroke="black" points="179171.19,-397.29 179180.41,-392.07 179169.95,-390.4 179171.19,-397.29"/>
</g>
<!-- layer_6_expert_4_ep_2 -->
<g id="node666" class="node">
<title>layer_6_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="180196.83,-410 179762.82,-410 179651.17,-306 180085.18,-306 180196.83,-410"/>
<text text-anchor="middle" x="179924" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="179924" y="-361" font-family="Arial" font-size="10.00">GPU: 164</text>
<text text-anchor="middle" x="179924" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="179924" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_4_ep_2 -->
<g id="edge1225" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M178731.42,-493.77C178958.45,-479.4 179326.97,-452.06 179643,-410 179672.94,-406.02 179704.53,-401.04 179735.31,-395.77"/>
<polygon fill="black" stroke="black" points="179736.01,-399.2 179745.27,-394.05 179734.82,-392.31 179736.01,-399.2"/>
</g>
<!-- layer_6_expert_5_ep_2 -->
<g id="node667" class="node">
<title>layer_6_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="180759.83,-410 180325.82,-410 180214.17,-306 180648.18,-306 180759.83,-410"/>
<text text-anchor="middle" x="180487" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="180487" y="-361" font-family="Arial" font-size="10.00">GPU: 165</text>
<text text-anchor="middle" x="180487" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="180487" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_5_ep_2 -->
<g id="edge1226" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M178740.78,-502.01C179064.89,-494.26 179683.39,-472.04 180206,-410 180236.21,-406.41 180268.08,-401.62 180299.08,-396.4"/>
<polygon fill="black" stroke="black" points="180299.85,-399.82 180309.12,-394.69 180298.67,-392.92 180299.85,-399.82"/>
</g>
<!-- layer_6_expert_6_ep_2 -->
<g id="node668" class="node">
<title>layer_6_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="181322.83,-410 180888.82,-410 180777.17,-306 181211.18,-306 181322.83,-410"/>
<text text-anchor="middle" x="181050" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="181050" y="-361" font-family="Arial" font-size="10.00">GPU: 166</text>
<text text-anchor="middle" x="181050" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="181050" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_6_ep_2 -->
<g id="edge1227" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M178745.95,-506.57C179153.87,-505.28 180032.73,-492.12 180769,-410 180799.35,-406.62 180831.35,-401.91 180862.47,-396.71"/>
<polygon fill="black" stroke="black" points="180863.26,-400.13 180872.54,-395.01 180862.09,-393.22 180863.26,-400.13"/>
</g>
<!-- layer_6_expert_7_ep_2 -->
<g id="node669" class="node">
<title>layer_6_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="181885.83,-410 181451.82,-410 181340.17,-306 181774.18,-306 181885.83,-410"/>
<text text-anchor="middle" x="181613" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="181613" y="-361" font-family="Arial" font-size="10.00">GPU: 167</text>
<text text-anchor="middle" x="181613" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="181613" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_2&#45;&gt;layer_6_expert_7_ep_2 -->
<g id="edge1228" class="edge">
<title>layer_6_route_ep_2&#45;&gt;layer_6_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M178737.05,-498.66C179111.59,-486.15 179896.98,-459.83 180561,-437 180903.67,-425.22 180991.09,-446.71 181332,-410 181362.36,-406.73 181394.37,-402.08 181425.49,-396.91"/>
<polygon fill="black" stroke="black" points="181426.28,-400.33 181435.56,-395.21 181425.12,-393.42 181426.28,-400.33"/>
</g>
<!-- layer_6_expert_0_ep_3 -->
<g id="node670" class="node">
<title>layer_6_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="146416.83,-410 145982.82,-410 145871.17,-306 146305.18,-306 146416.83,-410"/>
<text text-anchor="middle" x="146144" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="146144" y="-361" font-family="Arial" font-size="10.00">GPU: 176</text>
<text text-anchor="middle" x="146144" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="146144" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_0_ep_3 -->
<g id="edge1229" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M148919.81,-488.03C148714.92,-474.18 148417.91,-455.93 148158,-447 147776.32,-433.89 146824.44,-450.87 146426.25,-410.08"/>
<polygon fill="black" stroke="black" points="146426.39,-406.57 146416.08,-409.01 146425.66,-413.53 146426.39,-406.57"/>
</g>
<!-- layer_6_expert_1_ep_3 -->
<g id="node671" class="node">
<title>layer_6_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="146979.83,-410 146545.82,-410 146434.17,-306 146868.18,-306 146979.83,-410"/>
<text text-anchor="middle" x="146707" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="146707" y="-361" font-family="Arial" font-size="10.00">GPU: 177</text>
<text text-anchor="middle" x="146707" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="146707" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_1_ep_3 -->
<g id="edge1230" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M148921.83,-489.64C148716.84,-476.62 148418.68,-458.71 148158,-447 147641.56,-423.8 147507.07,-464.31 146989.05,-410.07"/>
<polygon fill="black" stroke="black" points="146989.39,-406.59 146979.08,-409.02 146988.66,-413.55 146989.39,-406.59"/>
</g>
<!-- layer_6_expert_2_ep_3 -->
<g id="node672" class="node">
<title>layer_6_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="147542.83,-410 147108.82,-410 146997.17,-306 147431.18,-306 147542.83,-410"/>
<text text-anchor="middle" x="147270" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="147270" y="-361" font-family="Arial" font-size="10.00">GPU: 178</text>
<text text-anchor="middle" x="147270" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="147270" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_2_ep_3 -->
<g id="edge1231" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M148923.66,-491.53C148496.56,-466.52 147656.97,-417.25 147552,-409.69"/>
<polygon fill="black" stroke="black" points="147551.97,-406.18 147541.72,-408.86 147551.4,-413.15 147551.97,-406.18"/>
</g>
<!-- layer_6_expert_3_ep_3 -->
<g id="node673" class="node">
<title>layer_6_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="148105.83,-410 147671.82,-410 147560.17,-306 147994.18,-306 148105.83,-410"/>
<text text-anchor="middle" x="147833" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="147833" y="-361" font-family="Arial" font-size="10.00">GPU: 179</text>
<text text-anchor="middle" x="147833" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="147833" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_3_ep_3 -->
<g id="edge1232" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M148921.76,-489.65C148709.63,-474.25 148396.79,-448.04 148114.76,-410.07"/>
<polygon fill="black" stroke="black" points="148115.12,-406.59 148104.74,-408.72 148114.18,-413.53 148115.12,-406.59"/>
</g>
<!-- layer_6_expert_4_ep_3 -->
<g id="node674" class="node">
<title>layer_6_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="148668.83,-410 148234.82,-410 148123.17,-306 148557.18,-306 148668.83,-410"/>
<text text-anchor="middle" x="148396" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="148396" y="-361" font-family="Arial" font-size="10.00">GPU: 180</text>
<text text-anchor="middle" x="148396" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="148396" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_4_ep_3 -->
<g id="edge1233" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M148902.12,-455C148828.69,-441.07 148748.97,-425.95 148674.99,-411.92"/>
<polygon fill="black" stroke="black" points="148675.54,-408.46 148665.06,-410.04 148674.24,-415.34 148675.54,-408.46"/>
</g>
<!-- layer_6_expert_5_ep_3 -->
<g id="node675" class="node">
<title>layer_6_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="149231.83,-410 148797.82,-410 148686.17,-306 149120.18,-306 149231.83,-410"/>
<text text-anchor="middle" x="148959" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="148959" y="-361" font-family="Arial" font-size="10.00">GPU: 181</text>
<text text-anchor="middle" x="148959" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="148959" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_5_ep_3 -->
<g id="edge1234" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M149097.45,-455C149079.3,-442.41 149059.75,-428.86 149041.21,-416.01"/>
<polygon fill="black" stroke="black" points="149042.99,-412.98 149032.78,-410.16 149039,-418.73 149042.99,-412.98"/>
</g>
<!-- layer_6_expert_6_ep_3 -->
<g id="node676" class="node">
<title>layer_6_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="149794.83,-410 149360.82,-410 149249.17,-306 149683.18,-306 149794.83,-410"/>
<text text-anchor="middle" x="149522" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="149522" y="-361" font-family="Arial" font-size="10.00">GPU: 182</text>
<text text-anchor="middle" x="149522" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="149522" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_6_ep_3 -->
<g id="edge1235" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M149292.78,-455C149324.41,-441.75 149358.61,-427.43 149390.7,-413.99"/>
<polygon fill="black" stroke="black" points="149392.27,-417.13 149400.14,-410.04 149389.56,-410.67 149392.27,-417.13"/>
</g>
<!-- layer_6_expert_7_ep_3 -->
<g id="node677" class="node">
<title>layer_6_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="150357.83,-410 149923.82,-410 149812.17,-306 150246.18,-306 150357.83,-410"/>
<text text-anchor="middle" x="150085" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="150085" y="-361" font-family="Arial" font-size="10.00">GPU: 183</text>
<text text-anchor="middle" x="150085" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="150085" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_3&#45;&gt;layer_6_expert_7_ep_3 -->
<g id="edge1236" class="edge">
<title>layer_6_route_ep_3&#45;&gt;layer_6_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M149367.27,-477.73C149492.4,-459.34 149657.9,-434.33 149804,-410 149833.46,-405.09 149864.61,-399.67 149895.03,-394.25"/>
<polygon fill="black" stroke="black" points="149895.65,-397.7 149904.87,-392.49 149894.41,-390.81 149895.65,-397.7"/>
</g>
<!-- layer_6_expert_0_ep_4 -->
<g id="node678" class="node">
<title>layer_6_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="155424.83,-410 154990.82,-410 154879.17,-306 155313.18,-306 155424.83,-410"/>
<text text-anchor="middle" x="155152" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="155152" y="-361" font-family="Arial" font-size="10.00">GPU: 192</text>
<text text-anchor="middle" x="155152" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="155152" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_0_ep_4 -->
<g id="edge1237" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M158086.48,-498.21C157696.87,-485.51 156901.6,-459.52 156228,-437 155877.94,-425.3 155786.22,-447.25 155434.04,-410.07"/>
<polygon fill="black" stroke="black" points="155434.4,-406.59 155424.08,-409.01 155433.65,-413.55 155434.4,-406.59"/>
</g>
<!-- layer_6_expert_1_ep_4 -->
<g id="node679" class="node">
<title>layer_6_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="155987.83,-410 155553.82,-410 155442.17,-306 155876.18,-306 155987.83,-410"/>
<text text-anchor="middle" x="155715" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="155715" y="-361" font-family="Arial" font-size="10.00">GPU: 193</text>
<text text-anchor="middle" x="155715" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="155715" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_1_ep_4 -->
<g id="edge1238" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M158089.01,-500.4C157584.1,-487.81 156415.04,-454.86 155996.75,-410.03"/>
<polygon fill="black" stroke="black" points="155997.03,-406.54 155986.71,-408.94 155996.27,-413.5 155997.03,-406.54"/>
</g>
<!-- layer_6_expert_2_ep_4 -->
<g id="node680" class="node">
<title>layer_6_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="156550.83,-410 156116.82,-410 156005.17,-306 156439.18,-306 156550.83,-410"/>
<text text-anchor="middle" x="156278" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="156278" y="-361" font-family="Arial" font-size="10.00">GPU: 194</text>
<text text-anchor="middle" x="156278" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="156278" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_2_ep_4 -->
<g id="edge1239" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M158091.53,-502.59C157754.43,-495.6 157113.44,-474.45 156559.91,-410.07"/>
<polygon fill="black" stroke="black" points="156560.06,-406.56 156549.72,-408.88 156559.24,-413.52 156560.06,-406.56"/>
</g>
<!-- layer_6_expert_3_ep_4 -->
<g id="node681" class="node">
<title>layer_6_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="157113.83,-410 156679.82,-410 156568.17,-306 157002.18,-306 157113.83,-410"/>
<text text-anchor="middle" x="156841" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="156841" y="-361" font-family="Arial" font-size="10.00">GPU: 195</text>
<text text-anchor="middle" x="156841" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="156841" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_3_ep_4 -->
<g id="edge1240" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M158081.39,-493.68C157839.98,-479.85 157460.38,-453.63 157122.71,-410.06"/>
<polygon fill="black" stroke="black" points="157123.1,-406.58 157112.73,-408.77 157122.2,-413.52 157123.1,-406.58"/>
</g>
<!-- layer_6_expert_4_ep_4 -->
<g id="node682" class="node">
<title>layer_6_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="157676.83,-410 157242.82,-410 157131.17,-306 157565.18,-306 157676.83,-410"/>
<text text-anchor="middle" x="157404" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="157404" y="-361" font-family="Arial" font-size="10.00">GPU: 196</text>
<text text-anchor="middle" x="157404" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="157404" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_4_ep_4 -->
<g id="edge1241" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M158050.82,-466.69C157940.4,-450.43 157811.74,-430.89 157685.64,-410.1"/>
<polygon fill="black" stroke="black" points="157685.84,-406.58 157675.41,-408.4 157684.7,-413.49 157685.84,-406.58"/>
</g>
<!-- layer_6_expert_5_ep_4 -->
<g id="node683" class="node">
<title>layer_6_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="158239.83,-410 157805.82,-410 157694.17,-306 158128.18,-306 158239.83,-410"/>
<text text-anchor="middle" x="157967" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="157967" y="-361" font-family="Arial" font-size="10.00">GPU: 197</text>
<text text-anchor="middle" x="157967" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="157967" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_5_ep_4 -->
<g id="edge1242" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M158201.45,-455C158169.1,-441.75 158134.12,-427.43 158101.29,-413.99"/>
<polygon fill="black" stroke="black" points="158102.22,-410.59 158091.64,-410.04 158099.56,-417.06 158102.22,-410.59"/>
</g>
<!-- layer_6_expert_6_ep_4 -->
<g id="node684" class="node">
<title>layer_6_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="158802.83,-410 158368.82,-410 158257.17,-306 158691.18,-306 158802.83,-410"/>
<text text-anchor="middle" x="158530" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="158530" y="-361" font-family="Arial" font-size="10.00">GPU: 198</text>
<text text-anchor="middle" x="158530" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="158530" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_6_ep_4 -->
<g id="edge1243" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M158396.78,-455C158414.24,-442.41 158433.06,-428.86 158450.89,-416.01"/>
<polygon fill="black" stroke="black" points="158452.94,-418.85 158459,-410.16 158448.84,-413.17 158452.94,-418.85"/>
</g>
<!-- layer_6_expert_7_ep_4 -->
<g id="node685" class="node">
<title>layer_6_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="159365.83,-410 158931.82,-410 158820.17,-306 159254.18,-306 159365.83,-410"/>
<text text-anchor="middle" x="159093" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="159093" y="-361" font-family="Arial" font-size="10.00">GPU: 199</text>
<text text-anchor="middle" x="159093" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="159093" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_4&#45;&gt;layer_6_expert_7_ep_4 -->
<g id="edge1244" class="edge">
<title>layer_6_route_ep_4&#45;&gt;layer_6_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M158513.63,-470.04C158632.26,-447.3 158785.06,-418.02 158903.96,-395.23"/>
<polygon fill="black" stroke="black" points="158904.74,-398.64 158913.9,-393.33 158903.42,-391.77 158904.74,-398.64"/>
</g>
<!-- layer_6_expert_0_ep_5 -->
<g id="node686" class="node">
<title>layer_6_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="173440.83,-410 173006.82,-410 172895.17,-306 173329.18,-306 173440.83,-410"/>
<text text-anchor="middle" x="173168" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="173168" y="-361" font-family="Arial" font-size="10.00">GPU: 208</text>
<text text-anchor="middle" x="173168" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="173168" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_0_ep_5 -->
<g id="edge1245" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M173674.12,-455C173600.69,-441.07 173520.97,-425.95 173446.99,-411.92"/>
<polygon fill="black" stroke="black" points="173447.54,-408.46 173437.06,-410.04 173446.24,-415.34 173447.54,-408.46"/>
</g>
<!-- layer_6_expert_1_ep_5 -->
<g id="node687" class="node">
<title>layer_6_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="174003.83,-410 173569.82,-410 173458.17,-306 173892.18,-306 174003.83,-410"/>
<text text-anchor="middle" x="173731" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="173731" y="-361" font-family="Arial" font-size="10.00">GPU: 209</text>
<text text-anchor="middle" x="173731" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="173731" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_1_ep_5 -->
<g id="edge1246" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M173869.45,-455C173851.3,-442.41 173831.75,-428.86 173813.21,-416.01"/>
<polygon fill="black" stroke="black" points="173814.99,-412.98 173804.78,-410.16 173811,-418.73 173814.99,-412.98"/>
</g>
<!-- layer_6_expert_2_ep_5 -->
<g id="node688" class="node">
<title>layer_6_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="174566.83,-410 174132.82,-410 174021.17,-306 174455.18,-306 174566.83,-410"/>
<text text-anchor="middle" x="174294" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="174294" y="-361" font-family="Arial" font-size="10.00">GPU: 210</text>
<text text-anchor="middle" x="174294" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="174294" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_2_ep_5 -->
<g id="edge1247" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M174064.78,-455C174096.41,-441.75 174130.61,-427.43 174162.7,-413.99"/>
<polygon fill="black" stroke="black" points="174164.27,-417.13 174172.14,-410.04 174161.56,-410.67 174164.27,-417.13"/>
</g>
<!-- layer_6_expert_3_ep_5 -->
<g id="node689" class="node">
<title>layer_6_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="175129.83,-410 174695.82,-410 174584.17,-306 175018.18,-306 175129.83,-410"/>
<text text-anchor="middle" x="174857" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="174857" y="-361" font-family="Arial" font-size="10.00">GPU: 211</text>
<text text-anchor="middle" x="174857" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="174857" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_3_ep_5 -->
<g id="edge1248" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M174139.27,-477.73C174264.4,-459.34 174429.9,-434.33 174576,-410 174605.46,-405.09 174636.61,-399.67 174667.03,-394.25"/>
<polygon fill="black" stroke="black" points="174667.65,-397.7 174676.87,-392.49 174666.41,-390.81 174667.65,-397.7"/>
</g>
<!-- layer_6_expert_4_ep_5 -->
<g id="node690" class="node">
<title>layer_6_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="175692.83,-410 175258.82,-410 175147.17,-306 175581.18,-306 175692.83,-410"/>
<text text-anchor="middle" x="175420" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="175420" y="-361" font-family="Arial" font-size="10.00">GPU: 212</text>
<text text-anchor="middle" x="175420" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="175420" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_4_ep_5 -->
<g id="edge1249" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M174159.19,-495.13C174399.26,-481.55 174797.93,-454.53 175139,-410 175169.06,-406.08 175200.78,-401.12 175231.67,-395.84"/>
<polygon fill="black" stroke="black" points="175232.4,-399.27 175241.66,-394.12 175231.21,-392.37 175232.4,-399.27"/>
</g>
<!-- layer_6_expert_5_ep_5 -->
<g id="node691" class="node">
<title>layer_6_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="176255.83,-410 175821.82,-410 175710.17,-306 176144.18,-306 176255.83,-410"/>
<text text-anchor="middle" x="175983" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="175983" y="-361" font-family="Arial" font-size="10.00">GPU: 213</text>
<text text-anchor="middle" x="175983" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="175983" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_5_ep_5 -->
<g id="edge1250" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M174167.64,-502.72C174502.8,-495.79 175153.17,-474.52 175702,-410 175732.21,-406.45 175764.09,-401.67 175795.09,-396.45"/>
<polygon fill="black" stroke="black" points="175795.85,-399.88 175805.12,-394.75 175794.68,-392.97 175795.85,-399.88"/>
</g>
<!-- layer_6_expert_6_ep_5 -->
<g id="node692" class="node">
<title>layer_6_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="176818.83,-410 176384.82,-410 176273.17,-306 176707.18,-306 176818.83,-410"/>
<text text-anchor="middle" x="176546" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="176546" y="-361" font-family="Arial" font-size="10.00">GPU: 214</text>
<text text-anchor="middle" x="176546" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="176546" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_6_ep_5 -->
<g id="edge1251" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M174165.47,-500.73C174664.87,-488.26 175862.74,-454.6 176265,-410 176295.35,-406.63 176327.36,-401.94 176358.47,-396.74"/>
<polygon fill="black" stroke="black" points="176359.26,-400.16 176368.54,-395.04 176358.1,-393.26 176359.26,-400.16"/>
</g>
<!-- layer_6_expert_7_ep_5 -->
<g id="node693" class="node">
<title>layer_6_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="177381.83,-410 176947.82,-410 176836.17,-306 177270.18,-306 177381.83,-410"/>
<text text-anchor="middle" x="177109" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="177109" y="-361" font-family="Arial" font-size="10.00">GPU: 215</text>
<text text-anchor="middle" x="177109" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="177109" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_5&#45;&gt;layer_6_expert_7_ep_5 -->
<g id="edge1252" class="edge">
<title>layer_6_route_ep_5&#45;&gt;layer_6_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M174167.7,-502.78C174752.8,-493.7 176313.65,-464.94 176828,-410 176858.36,-406.76 176890.38,-402.12 176921.5,-396.95"/>
<polygon fill="black" stroke="black" points="176922.28,-400.37 176931.56,-395.26 176921.12,-393.47 176922.28,-400.37"/>
</g>
<!-- layer_6_expert_0_ep_6 -->
<g id="node694" class="node">
<title>layer_6_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="164432.83,-410 163998.82,-410 163887.17,-306 164321.18,-306 164432.83,-410"/>
<text text-anchor="middle" x="164160" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="164160" y="-361" font-family="Arial" font-size="10.00">GPU: 224</text>
<text text-anchor="middle" x="164160" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="164160" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_0_ep_6 -->
<g id="edge1253" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M164666.12,-455C164592.69,-441.07 164512.97,-425.95 164438.99,-411.92"/>
<polygon fill="black" stroke="black" points="164439.54,-408.46 164429.06,-410.04 164438.24,-415.34 164439.54,-408.46"/>
</g>
<!-- layer_6_expert_1_ep_6 -->
<g id="node695" class="node">
<title>layer_6_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="164995.83,-410 164561.82,-410 164450.17,-306 164884.18,-306 164995.83,-410"/>
<text text-anchor="middle" x="164723" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="164723" y="-361" font-family="Arial" font-size="10.00">GPU: 225</text>
<text text-anchor="middle" x="164723" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="164723" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_1_ep_6 -->
<g id="edge1254" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M164861.45,-455C164843.3,-442.41 164823.75,-428.86 164805.21,-416.01"/>
<polygon fill="black" stroke="black" points="164806.99,-412.98 164796.78,-410.16 164803,-418.73 164806.99,-412.98"/>
</g>
<!-- layer_6_expert_2_ep_6 -->
<g id="node696" class="node">
<title>layer_6_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="165558.83,-410 165124.82,-410 165013.17,-306 165447.18,-306 165558.83,-410"/>
<text text-anchor="middle" x="165286" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="165286" y="-361" font-family="Arial" font-size="10.00">GPU: 226</text>
<text text-anchor="middle" x="165286" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="165286" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_2_ep_6 -->
<g id="edge1255" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M165056.78,-455C165088.41,-441.75 165122.61,-427.43 165154.7,-413.99"/>
<polygon fill="black" stroke="black" points="165156.27,-417.13 165164.14,-410.04 165153.56,-410.67 165156.27,-417.13"/>
</g>
<!-- layer_6_expert_3_ep_6 -->
<g id="node697" class="node">
<title>layer_6_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="166121.83,-410 165687.82,-410 165576.17,-306 166010.18,-306 166121.83,-410"/>
<text text-anchor="middle" x="165849" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="165849" y="-361" font-family="Arial" font-size="10.00">GPU: 227</text>
<text text-anchor="middle" x="165849" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="165849" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_3_ep_6 -->
<g id="edge1256" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M165131.27,-477.73C165256.4,-459.34 165421.9,-434.33 165568,-410 165597.46,-405.09 165628.61,-399.67 165659.03,-394.25"/>
<polygon fill="black" stroke="black" points="165659.65,-397.7 165668.87,-392.49 165658.41,-390.81 165659.65,-397.7"/>
</g>
<!-- layer_6_expert_4_ep_6 -->
<g id="node698" class="node">
<title>layer_6_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="166684.83,-410 166250.82,-410 166139.17,-306 166573.18,-306 166684.83,-410"/>
<text text-anchor="middle" x="166412" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="166412" y="-361" font-family="Arial" font-size="10.00">GPU: 228</text>
<text text-anchor="middle" x="166412" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="166412" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_4_ep_6 -->
<g id="edge1257" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M165151.19,-495.13C165391.26,-481.55 165789.93,-454.53 166131,-410 166161.06,-406.08 166192.78,-401.12 166223.67,-395.84"/>
<polygon fill="black" stroke="black" points="166224.4,-399.27 166233.66,-394.12 166223.21,-392.37 166224.4,-399.27"/>
</g>
<!-- layer_6_expert_5_ep_6 -->
<g id="node699" class="node">
<title>layer_6_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="167247.83,-410 166813.82,-410 166702.17,-306 167136.18,-306 167247.83,-410"/>
<text text-anchor="middle" x="166975" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="166975" y="-361" font-family="Arial" font-size="10.00">GPU: 229</text>
<text text-anchor="middle" x="166975" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="166975" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_5_ep_6 -->
<g id="edge1258" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M165159.64,-502.72C165494.8,-495.79 166145.17,-474.52 166694,-410 166724.21,-406.45 166756.09,-401.67 166787.09,-396.45"/>
<polygon fill="black" stroke="black" points="166787.85,-399.88 166797.12,-394.75 166786.68,-392.97 166787.85,-399.88"/>
</g>
<!-- layer_6_expert_6_ep_6 -->
<g id="node700" class="node">
<title>layer_6_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="167810.83,-410 167376.82,-410 167265.17,-306 167699.18,-306 167810.83,-410"/>
<text text-anchor="middle" x="167538" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="167538" y="-361" font-family="Arial" font-size="10.00">GPU: 230</text>
<text text-anchor="middle" x="167538" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="167538" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_6_ep_6 -->
<g id="edge1259" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M165157.47,-500.73C165656.87,-488.26 166854.74,-454.6 167257,-410 167287.35,-406.63 167319.36,-401.94 167350.47,-396.74"/>
<polygon fill="black" stroke="black" points="167351.26,-400.16 167360.54,-395.04 167350.1,-393.26 167351.26,-400.16"/>
</g>
<!-- layer_6_expert_7_ep_6 -->
<g id="node701" class="node">
<title>layer_6_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="168373.83,-410 167939.82,-410 167828.17,-306 168262.18,-306 168373.83,-410"/>
<text text-anchor="middle" x="168101" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="168101" y="-361" font-family="Arial" font-size="10.00">GPU: 231</text>
<text text-anchor="middle" x="168101" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="168101" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_6&#45;&gt;layer_6_expert_7_ep_6 -->
<g id="edge1260" class="edge">
<title>layer_6_route_ep_6&#45;&gt;layer_6_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M165159.7,-502.78C165744.8,-493.7 167305.65,-464.94 167820,-410 167850.36,-406.76 167882.38,-402.12 167913.5,-396.95"/>
<polygon fill="black" stroke="black" points="167914.28,-400.37 167923.56,-395.26 167913.12,-393.47 167914.28,-400.37"/>
</g>
<!-- layer_6_expert_0_ep_7 -->
<g id="node702" class="node">
<title>layer_6_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="150920.83,-410 150486.82,-410 150375.17,-306 150809.18,-306 150920.83,-410"/>
<text text-anchor="middle" x="150648" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="150648" y="-361" font-family="Arial" font-size="10.00">GPU: 240</text>
<text text-anchor="middle" x="150648" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="150648" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_0_ep_7 -->
<g id="edge1261" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M153505.63,-498.3C153119.26,-485.81 152334.16,-460.19 151669,-437 151343.46,-425.65 151257.94,-445.07 150930.34,-410.1"/>
<polygon fill="black" stroke="black" points="150930.4,-406.59 150920.08,-409 150929.65,-413.55 150930.4,-406.59"/>
</g>
<!-- layer_6_expert_1_ep_7 -->
<g id="node703" class="node">
<title>layer_6_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="151483.83,-410 151049.82,-410 150938.17,-306 151372.18,-306 151483.83,-410"/>
<text text-anchor="middle" x="151211" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="151211" y="-361" font-family="Arial" font-size="10.00">GPU: 241</text>
<text text-anchor="middle" x="151211" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="151211" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_1_ep_7 -->
<g id="edge1262" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M153514.73,-506.57C153107.95,-505.28 152235.79,-492.18 151492.82,-410.05"/>
<polygon fill="black" stroke="black" points="151493.04,-406.55 151482.71,-408.93 151492.26,-413.51 151493.04,-406.55"/>
</g>
<!-- layer_6_expert_2_ep_7 -->
<g id="node704" class="node">
<title>layer_6_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="152046.83,-410 151612.82,-410 151501.17,-306 151935.18,-306 152046.83,-410"/>
<text text-anchor="middle" x="151774" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="151774" y="-361" font-family="Arial" font-size="10.00">GPU: 242</text>
<text text-anchor="middle" x="151774" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="151774" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_2_ep_7 -->
<g id="edge1263" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M153509.43,-501.74C153184.2,-493.8 152579.45,-471.62 152055.75,-410.05"/>
<polygon fill="black" stroke="black" points="152056.06,-406.56 152045.72,-408.87 152055.24,-413.52 152056.06,-406.56"/>
</g>
<!-- layer_6_expert_3_ep_7 -->
<g id="node705" class="node">
<title>layer_6_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="152609.83,-410 152175.82,-410 152064.17,-306 152498.18,-306 152609.83,-410"/>
<text text-anchor="middle" x="152337" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="152337" y="-361" font-family="Arial" font-size="10.00">GPU: 243</text>
<text text-anchor="middle" x="152337" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="152337" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_3_ep_7 -->
<g id="edge1264" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M153498.04,-491.71C153271.68,-477.02 152927.21,-450.71 152618.77,-410.07"/>
<polygon fill="black" stroke="black" points="152619.11,-406.59 152608.73,-408.74 152618.19,-413.53 152619.11,-406.59"/>
</g>
<!-- layer_6_expert_4_ep_7 -->
<g id="node706" class="node">
<title>layer_6_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="153172.83,-410 152738.82,-410 152627.17,-306 153061.18,-306 153172.83,-410"/>
<text text-anchor="middle" x="152900" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="152900" y="-361" font-family="Arial" font-size="10.00">GPU: 244</text>
<text text-anchor="middle" x="152900" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="152900" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_4_ep_7 -->
<g id="edge1265" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M153459.78,-458.08C153370.48,-442.9 153271.61,-425.93 153181,-410 153180.9,-409.98 153180.79,-409.96 153180.69,-409.95"/>
<polygon fill="black" stroke="black" points="153181.51,-406.54 153171.05,-408.25 153180.29,-413.43 153181.51,-406.54"/>
</g>
<!-- layer_6_expert_5_ep_7 -->
<g id="node707" class="node">
<title>layer_6_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="153735.83,-410 153301.82,-410 153190.17,-306 153624.18,-306 153735.83,-410"/>
<text text-anchor="middle" x="153463" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="153463" y="-361" font-family="Arial" font-size="10.00">GPU: 245</text>
<text text-anchor="middle" x="153463" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="153463" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_5_ep_7 -->
<g id="edge1266" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M153647.16,-455C153622.26,-442.02 153595.37,-428 153570.03,-414.79"/>
<polygon fill="black" stroke="black" points="153571.63,-411.68 153561.14,-410.16 153568.39,-417.89 153571.63,-411.68"/>
</g>
<!-- layer_6_expert_6_ep_7 -->
<g id="node708" class="node">
<title>layer_6_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="154298.83,-410 153864.82,-410 153753.17,-306 154187.18,-306 154298.83,-410"/>
<text text-anchor="middle" x="154026" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="154026" y="-361" font-family="Arial" font-size="10.00">GPU: 246</text>
<text text-anchor="middle" x="154026" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="154026" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_6_ep_7 -->
<g id="edge1267" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M153842.49,-455C153867.2,-442.07 153893.87,-428.12 153919.02,-414.97"/>
<polygon fill="black" stroke="black" points="153920.97,-417.9 153928.21,-410.16 153917.72,-411.69 153920.97,-417.9"/>
</g>
<!-- layer_6_expert_7_ep_7 -->
<g id="node709" class="node">
<title>layer_6_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="154861.83,-410 154427.82,-410 154316.17,-306 154750.18,-306 154861.83,-410"/>
<text text-anchor="middle" x="154589" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="154589" y="-361" font-family="Arial" font-size="10.00">GPU: 247</text>
<text text-anchor="middle" x="154589" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="154589" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_6_route_ep_7&#45;&gt;layer_6_expert_7_ep_7 -->
<g id="edge1268" class="edge">
<title>layer_6_route_ep_7&#45;&gt;layer_6_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M153936.94,-473.79C154045.83,-455.39 154184.59,-431.72 154308,-410 154337.17,-404.87 154368.04,-399.35 154398.21,-393.91"/>
<polygon fill="black" stroke="black" points="154399.19,-397.29 154408.41,-392.07 154397.95,-390.4 154399.19,-397.29"/>
</g>
<!-- layer_6_agg_ep_0 -->
<g id="node710" class="node">
<title>layer_6_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="171199.07,-269 170748.77,-269 170632.93,-165 171083.23,-165 171199.07,-269"/>
<text text-anchor="middle" x="170916" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="170916" y="-220" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="170916" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="170916" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1269" class="edge">
<title>layer_6_expert_0_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M168836.37,-316.09C168872.1,-308.94 168909.63,-302.4 168945,-298 169275.43,-256.9 170241.09,-232.08 170686.31,-222.52"/>
<polygon fill="black" stroke="black" points="170686.48,-226.02 170696.4,-222.31 170686.33,-219.02 170686.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1270" class="edge">
<title>layer_6_expert_1_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M169399.8,-316.46C169435.41,-309.31 169472.79,-302.67 169508,-298 169919.77,-243.39 170404.14,-226.03 170684.05,-220.53"/>
<polygon fill="black" stroke="black" points="170684.4,-224.02 170694.33,-220.33 170684.26,-217.02 170684.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1271" class="edge">
<title>layer_6_expert_2_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M169963.7,-317.34C169999.07,-310.17 170036.13,-303.29 170071,-298 170282.23,-265.93 170525.24,-244.53 170696.27,-231.99"/>
<polygon fill="black" stroke="black" points="170696.69,-235.47 170706.41,-231.25 170696.18,-228.49 170696.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1272" class="edge">
<title>layer_6_expert_3_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M170523.83,-314.82C170589.06,-298.72 170663.72,-280.29 170730.27,-263.86"/>
<polygon fill="black" stroke="black" points="170731.15,-267.24 170740.02,-261.45 170729.48,-260.45 170731.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1273" class="edge">
<title>layer_6_expert_4_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M170916,-305.64C170916,-297.08 170916,-288.12 170916,-279.34"/>
<polygon fill="black" stroke="black" points="170919.5,-279.15 170916,-269.15 170912.5,-279.15 170919.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1274" class="edge">
<title>layer_6_expert_5_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M171272.16,-305.93C171226.62,-294.69 171178.27,-282.75 171132.37,-271.42"/>
<polygon fill="black" stroke="black" points="171133.16,-268.01 171122.61,-269.01 171131.48,-274.81 171133.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1275" class="edge">
<title>layer_6_expert_6_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M171808.92,-305.97C171792.74,-303.07 171776.65,-300.38 171761,-298 171563.52,-268.02 171338.26,-247.36 171170.01,-234.55"/>
<polygon fill="black" stroke="black" points="171170.26,-231.06 171160.02,-233.8 171169.73,-238.04 171170.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_0&#45;&gt;layer_6_agg_ep_0 -->
<g id="edge1276" class="edge">
<title>layer_6_expert_7_ep_0&#45;&gt;layer_6_agg_ep_0</title>
<path fill="none" stroke="black" d="M172375.84,-305.94C172358.35,-302.94 172340.92,-300.24 172324,-298 171915.97,-243.88 171436.66,-226.34 171155.64,-220.68"/>
<polygon fill="black" stroke="black" points="171155.38,-217.17 171145.32,-220.47 171155.24,-224.17 171155.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_1 -->
<g id="node711" class="node">
<title>layer_6_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="162191.07,-269 161740.77,-269 161624.93,-165 162075.23,-165 162191.07,-269"/>
<text text-anchor="middle" x="161908" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="161908" y="-220" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="161908" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="161908" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1278" class="edge">
<title>layer_6_expert_0_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M159828.37,-316.09C159864.1,-308.94 159901.63,-302.4 159937,-298 160267.43,-256.9 161233.09,-232.08 161678.31,-222.52"/>
<polygon fill="black" stroke="black" points="161678.48,-226.02 161688.4,-222.31 161678.33,-219.02 161678.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1279" class="edge">
<title>layer_6_expert_1_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M160391.8,-316.46C160427.41,-309.31 160464.79,-302.67 160500,-298 160911.77,-243.39 161396.14,-226.03 161676.05,-220.53"/>
<polygon fill="black" stroke="black" points="161676.4,-224.02 161686.33,-220.33 161676.26,-217.02 161676.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1280" class="edge">
<title>layer_6_expert_2_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M160955.7,-317.34C160991.07,-310.17 161028.13,-303.29 161063,-298 161274.23,-265.93 161517.24,-244.53 161688.27,-231.99"/>
<polygon fill="black" stroke="black" points="161688.69,-235.47 161698.41,-231.25 161688.18,-228.49 161688.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1281" class="edge">
<title>layer_6_expert_3_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M161515.83,-314.82C161581.06,-298.72 161655.72,-280.29 161722.27,-263.86"/>
<polygon fill="black" stroke="black" points="161723.15,-267.24 161732.02,-261.45 161721.48,-260.45 161723.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1282" class="edge">
<title>layer_6_expert_4_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M161908,-305.64C161908,-297.08 161908,-288.12 161908,-279.34"/>
<polygon fill="black" stroke="black" points="161911.5,-279.15 161908,-269.15 161904.5,-279.15 161911.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1283" class="edge">
<title>layer_6_expert_5_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M162264.16,-305.93C162218.62,-294.69 162170.27,-282.75 162124.37,-271.42"/>
<polygon fill="black" stroke="black" points="162125.16,-268.01 162114.61,-269.01 162123.48,-274.81 162125.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1284" class="edge">
<title>layer_6_expert_6_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M162800.92,-305.97C162784.74,-303.07 162768.65,-300.38 162753,-298 162555.52,-268.02 162330.26,-247.36 162162.01,-234.55"/>
<polygon fill="black" stroke="black" points="162162.26,-231.06 162152.02,-233.8 162161.73,-238.04 162162.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_1&#45;&gt;layer_6_agg_ep_1 -->
<g id="edge1285" class="edge">
<title>layer_6_expert_7_ep_1&#45;&gt;layer_6_agg_ep_1</title>
<path fill="none" stroke="black" d="M163367.84,-305.94C163350.35,-302.94 163332.92,-300.24 163316,-298 162907.97,-243.88 162428.66,-226.34 162147.64,-220.68"/>
<polygon fill="black" stroke="black" points="162147.38,-217.17 162137.32,-220.47 162147.24,-224.17 162147.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_2 -->
<g id="node712" class="node">
<title>layer_6_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="180207.07,-269 179756.77,-269 179640.93,-165 180091.23,-165 180207.07,-269"/>
<text text-anchor="middle" x="179924" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="179924" y="-220" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="179924" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="179924" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1287" class="edge">
<title>layer_6_expert_0_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M177844.37,-316.09C177880.1,-308.94 177917.63,-302.4 177953,-298 178283.43,-256.9 179249.09,-232.08 179694.31,-222.52"/>
<polygon fill="black" stroke="black" points="179694.48,-226.02 179704.4,-222.31 179694.33,-219.02 179694.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1288" class="edge">
<title>layer_6_expert_1_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M178407.8,-316.46C178443.41,-309.31 178480.79,-302.67 178516,-298 178927.77,-243.39 179412.14,-226.03 179692.05,-220.53"/>
<polygon fill="black" stroke="black" points="179692.4,-224.02 179702.33,-220.33 179692.26,-217.02 179692.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1289" class="edge">
<title>layer_6_expert_2_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M178971.7,-317.34C179007.07,-310.17 179044.13,-303.29 179079,-298 179290.23,-265.93 179533.24,-244.53 179704.27,-231.99"/>
<polygon fill="black" stroke="black" points="179704.69,-235.47 179714.41,-231.25 179704.18,-228.49 179704.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1290" class="edge">
<title>layer_6_expert_3_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M179531.83,-314.82C179597.06,-298.72 179671.72,-280.29 179738.27,-263.86"/>
<polygon fill="black" stroke="black" points="179739.15,-267.24 179748.02,-261.45 179737.48,-260.45 179739.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1291" class="edge">
<title>layer_6_expert_4_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M179924,-305.64C179924,-297.08 179924,-288.12 179924,-279.34"/>
<polygon fill="black" stroke="black" points="179927.5,-279.15 179924,-269.15 179920.5,-279.15 179927.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1292" class="edge">
<title>layer_6_expert_5_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M180280.16,-305.93C180234.62,-294.69 180186.27,-282.75 180140.37,-271.42"/>
<polygon fill="black" stroke="black" points="180141.16,-268.01 180130.61,-269.01 180139.48,-274.81 180141.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1293" class="edge">
<title>layer_6_expert_6_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M180816.92,-305.97C180800.74,-303.07 180784.65,-300.38 180769,-298 180571.52,-268.02 180346.26,-247.36 180178.01,-234.55"/>
<polygon fill="black" stroke="black" points="180178.26,-231.06 180168.02,-233.8 180177.73,-238.04 180178.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_2&#45;&gt;layer_6_agg_ep_2 -->
<g id="edge1294" class="edge">
<title>layer_6_expert_7_ep_2&#45;&gt;layer_6_agg_ep_2</title>
<path fill="none" stroke="black" d="M181383.84,-305.94C181366.35,-302.94 181348.92,-300.24 181332,-298 180923.97,-243.88 180444.66,-226.34 180163.64,-220.68"/>
<polygon fill="black" stroke="black" points="180163.38,-217.17 180153.32,-220.47 180163.24,-224.17 180163.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_3 -->
<g id="node713" class="node">
<title>layer_6_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="148679.07,-269 148228.77,-269 148112.93,-165 148563.23,-165 148679.07,-269"/>
<text text-anchor="middle" x="148396" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="148396" y="-220" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="148396" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="148396" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1296" class="edge">
<title>layer_6_expert_0_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M146316.37,-316.09C146352.1,-308.94 146389.63,-302.4 146425,-298 146755.43,-256.9 147721.09,-232.08 148166.31,-222.52"/>
<polygon fill="black" stroke="black" points="148166.48,-226.02 148176.4,-222.31 148166.33,-219.02 148166.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1297" class="edge">
<title>layer_6_expert_1_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M146879.8,-316.46C146915.41,-309.31 146952.79,-302.67 146988,-298 147399.77,-243.39 147884.14,-226.03 148164.05,-220.53"/>
<polygon fill="black" stroke="black" points="148164.4,-224.02 148174.33,-220.33 148164.26,-217.02 148164.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1298" class="edge">
<title>layer_6_expert_2_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M147443.7,-317.34C147479.07,-310.17 147516.13,-303.29 147551,-298 147762.23,-265.93 148005.24,-244.53 148176.27,-231.99"/>
<polygon fill="black" stroke="black" points="148176.69,-235.47 148186.41,-231.25 148176.18,-228.49 148176.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1299" class="edge">
<title>layer_6_expert_3_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M148003.83,-314.82C148069.06,-298.72 148143.72,-280.29 148210.27,-263.86"/>
<polygon fill="black" stroke="black" points="148211.15,-267.24 148220.02,-261.45 148209.48,-260.45 148211.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1300" class="edge">
<title>layer_6_expert_4_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M148396,-305.64C148396,-297.08 148396,-288.12 148396,-279.34"/>
<polygon fill="black" stroke="black" points="148399.5,-279.15 148396,-269.15 148392.5,-279.15 148399.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1301" class="edge">
<title>layer_6_expert_5_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M148752.16,-305.93C148706.62,-294.69 148658.27,-282.75 148612.37,-271.42"/>
<polygon fill="black" stroke="black" points="148613.16,-268.01 148602.61,-269.01 148611.48,-274.81 148613.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1302" class="edge">
<title>layer_6_expert_6_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M149288.92,-305.97C149272.74,-303.07 149256.65,-300.38 149241,-298 149043.52,-268.02 148818.26,-247.36 148650.01,-234.55"/>
<polygon fill="black" stroke="black" points="148650.26,-231.06 148640.02,-233.8 148649.73,-238.04 148650.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_3&#45;&gt;layer_6_agg_ep_3 -->
<g id="edge1303" class="edge">
<title>layer_6_expert_7_ep_3&#45;&gt;layer_6_agg_ep_3</title>
<path fill="none" stroke="black" d="M149855.84,-305.94C149838.35,-302.94 149820.92,-300.24 149804,-298 149395.97,-243.88 148916.66,-226.34 148635.64,-220.68"/>
<polygon fill="black" stroke="black" points="148635.38,-217.17 148625.32,-220.47 148635.24,-224.17 148635.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_4 -->
<g id="node714" class="node">
<title>layer_6_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="157687.07,-269 157236.77,-269 157120.93,-165 157571.23,-165 157687.07,-269"/>
<text text-anchor="middle" x="157404" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="157404" y="-220" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="157404" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="157404" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1305" class="edge">
<title>layer_6_expert_0_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M155324.37,-316.09C155360.1,-308.94 155397.63,-302.4 155433,-298 155763.43,-256.9 156729.09,-232.08 157174.31,-222.52"/>
<polygon fill="black" stroke="black" points="157174.48,-226.02 157184.4,-222.31 157174.33,-219.02 157174.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1306" class="edge">
<title>layer_6_expert_1_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M155887.8,-316.46C155923.41,-309.31 155960.79,-302.67 155996,-298 156407.77,-243.39 156892.14,-226.03 157172.05,-220.53"/>
<polygon fill="black" stroke="black" points="157172.4,-224.02 157182.33,-220.33 157172.26,-217.02 157172.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1307" class="edge">
<title>layer_6_expert_2_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M156451.7,-317.34C156487.07,-310.17 156524.13,-303.29 156559,-298 156770.23,-265.93 157013.24,-244.53 157184.27,-231.99"/>
<polygon fill="black" stroke="black" points="157184.69,-235.47 157194.41,-231.25 157184.18,-228.49 157184.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1308" class="edge">
<title>layer_6_expert_3_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M157011.83,-314.82C157077.06,-298.72 157151.72,-280.29 157218.27,-263.86"/>
<polygon fill="black" stroke="black" points="157219.15,-267.24 157228.02,-261.45 157217.48,-260.45 157219.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1309" class="edge">
<title>layer_6_expert_4_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M157404,-305.64C157404,-297.08 157404,-288.12 157404,-279.34"/>
<polygon fill="black" stroke="black" points="157407.5,-279.15 157404,-269.15 157400.5,-279.15 157407.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1310" class="edge">
<title>layer_6_expert_5_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M157760.16,-305.93C157714.62,-294.69 157666.27,-282.75 157620.37,-271.42"/>
<polygon fill="black" stroke="black" points="157621.16,-268.01 157610.61,-269.01 157619.48,-274.81 157621.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1311" class="edge">
<title>layer_6_expert_6_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M158296.92,-305.97C158280.74,-303.07 158264.65,-300.38 158249,-298 158051.52,-268.02 157826.26,-247.36 157658.01,-234.55"/>
<polygon fill="black" stroke="black" points="157658.26,-231.06 157648.02,-233.8 157657.73,-238.04 157658.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_4&#45;&gt;layer_6_agg_ep_4 -->
<g id="edge1312" class="edge">
<title>layer_6_expert_7_ep_4&#45;&gt;layer_6_agg_ep_4</title>
<path fill="none" stroke="black" d="M158863.84,-305.94C158846.35,-302.94 158828.92,-300.24 158812,-298 158403.97,-243.88 157924.66,-226.34 157643.64,-220.68"/>
<polygon fill="black" stroke="black" points="157643.38,-217.17 157633.32,-220.47 157643.24,-224.17 157643.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_5 -->
<g id="node715" class="node">
<title>layer_6_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="175703.07,-269 175252.77,-269 175136.93,-165 175587.23,-165 175703.07,-269"/>
<text text-anchor="middle" x="175420" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="175420" y="-220" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="175420" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="175420" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1314" class="edge">
<title>layer_6_expert_0_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M173340.37,-316.09C173376.1,-308.94 173413.63,-302.4 173449,-298 173779.43,-256.9 174745.09,-232.08 175190.31,-222.52"/>
<polygon fill="black" stroke="black" points="175190.48,-226.02 175200.4,-222.31 175190.33,-219.02 175190.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1315" class="edge">
<title>layer_6_expert_1_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M173903.8,-316.46C173939.41,-309.31 173976.79,-302.67 174012,-298 174423.77,-243.39 174908.14,-226.03 175188.05,-220.53"/>
<polygon fill="black" stroke="black" points="175188.4,-224.02 175198.33,-220.33 175188.26,-217.02 175188.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1316" class="edge">
<title>layer_6_expert_2_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M174467.7,-317.34C174503.07,-310.17 174540.13,-303.29 174575,-298 174786.23,-265.93 175029.24,-244.53 175200.27,-231.99"/>
<polygon fill="black" stroke="black" points="175200.69,-235.47 175210.41,-231.25 175200.18,-228.49 175200.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1317" class="edge">
<title>layer_6_expert_3_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M175027.83,-314.82C175093.06,-298.72 175167.72,-280.29 175234.27,-263.86"/>
<polygon fill="black" stroke="black" points="175235.15,-267.24 175244.02,-261.45 175233.48,-260.45 175235.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1318" class="edge">
<title>layer_6_expert_4_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M175420,-305.64C175420,-297.08 175420,-288.12 175420,-279.34"/>
<polygon fill="black" stroke="black" points="175423.5,-279.15 175420,-269.15 175416.5,-279.15 175423.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1319" class="edge">
<title>layer_6_expert_5_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M175776.16,-305.93C175730.62,-294.69 175682.27,-282.75 175636.37,-271.42"/>
<polygon fill="black" stroke="black" points="175637.16,-268.01 175626.61,-269.01 175635.48,-274.81 175637.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1320" class="edge">
<title>layer_6_expert_6_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M176312.92,-305.97C176296.74,-303.07 176280.65,-300.38 176265,-298 176067.52,-268.02 175842.26,-247.36 175674.01,-234.55"/>
<polygon fill="black" stroke="black" points="175674.26,-231.06 175664.02,-233.8 175673.73,-238.04 175674.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_5&#45;&gt;layer_6_agg_ep_5 -->
<g id="edge1321" class="edge">
<title>layer_6_expert_7_ep_5&#45;&gt;layer_6_agg_ep_5</title>
<path fill="none" stroke="black" d="M176879.84,-305.94C176862.35,-302.94 176844.92,-300.24 176828,-298 176419.97,-243.88 175940.66,-226.34 175659.64,-220.68"/>
<polygon fill="black" stroke="black" points="175659.38,-217.17 175649.32,-220.47 175659.24,-224.17 175659.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_6 -->
<g id="node716" class="node">
<title>layer_6_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="166695.07,-269 166244.77,-269 166128.93,-165 166579.23,-165 166695.07,-269"/>
<text text-anchor="middle" x="166412" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="166412" y="-220" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="166412" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="166412" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1323" class="edge">
<title>layer_6_expert_0_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M164332.37,-316.09C164368.1,-308.94 164405.63,-302.4 164441,-298 164771.43,-256.9 165737.09,-232.08 166182.31,-222.52"/>
<polygon fill="black" stroke="black" points="166182.48,-226.02 166192.4,-222.31 166182.33,-219.02 166182.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1324" class="edge">
<title>layer_6_expert_1_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M164895.8,-316.46C164931.41,-309.31 164968.79,-302.67 165004,-298 165415.77,-243.39 165900.14,-226.03 166180.05,-220.53"/>
<polygon fill="black" stroke="black" points="166180.4,-224.02 166190.33,-220.33 166180.26,-217.02 166180.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1325" class="edge">
<title>layer_6_expert_2_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M165459.7,-317.34C165495.07,-310.17 165532.13,-303.29 165567,-298 165778.23,-265.93 166021.24,-244.53 166192.27,-231.99"/>
<polygon fill="black" stroke="black" points="166192.69,-235.47 166202.41,-231.25 166192.18,-228.49 166192.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1326" class="edge">
<title>layer_6_expert_3_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M166019.83,-314.82C166085.06,-298.72 166159.72,-280.29 166226.27,-263.86"/>
<polygon fill="black" stroke="black" points="166227.15,-267.24 166236.02,-261.45 166225.48,-260.45 166227.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1327" class="edge">
<title>layer_6_expert_4_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M166412,-305.64C166412,-297.08 166412,-288.12 166412,-279.34"/>
<polygon fill="black" stroke="black" points="166415.5,-279.15 166412,-269.15 166408.5,-279.15 166415.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1328" class="edge">
<title>layer_6_expert_5_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M166768.16,-305.93C166722.62,-294.69 166674.27,-282.75 166628.37,-271.42"/>
<polygon fill="black" stroke="black" points="166629.16,-268.01 166618.61,-269.01 166627.48,-274.81 166629.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1329" class="edge">
<title>layer_6_expert_6_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M167304.92,-305.97C167288.74,-303.07 167272.65,-300.38 167257,-298 167059.52,-268.02 166834.26,-247.36 166666.01,-234.55"/>
<polygon fill="black" stroke="black" points="166666.26,-231.06 166656.02,-233.8 166665.73,-238.04 166666.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_6&#45;&gt;layer_6_agg_ep_6 -->
<g id="edge1330" class="edge">
<title>layer_6_expert_7_ep_6&#45;&gt;layer_6_agg_ep_6</title>
<path fill="none" stroke="black" d="M167871.84,-305.94C167854.35,-302.94 167836.92,-300.24 167820,-298 167411.97,-243.88 166932.66,-226.34 166651.64,-220.68"/>
<polygon fill="black" stroke="black" points="166651.38,-217.17 166641.32,-220.47 166651.24,-224.17 166651.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_7 -->
<g id="node717" class="node">
<title>layer_6_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="153183.07,-269 152732.77,-269 152616.93,-165 153067.23,-165 153183.07,-269"/>
<text text-anchor="middle" x="152900" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="152900" y="-220" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="152900" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="152900" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_expert_0_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1332" class="edge">
<title>layer_6_expert_0_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M150820.37,-316.09C150856.1,-308.94 150893.63,-302.4 150929,-298 151259.43,-256.9 152225.09,-232.08 152670.31,-222.52"/>
<polygon fill="black" stroke="black" points="152670.48,-226.02 152680.4,-222.31 152670.33,-219.02 152670.48,-226.02"/>
</g>
<!-- layer_6_expert_1_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1333" class="edge">
<title>layer_6_expert_1_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M151383.8,-316.46C151419.41,-309.31 151456.79,-302.67 151492,-298 151903.77,-243.39 152388.14,-226.03 152668.05,-220.53"/>
<polygon fill="black" stroke="black" points="152668.4,-224.02 152678.33,-220.33 152668.26,-217.02 152668.4,-224.02"/>
</g>
<!-- layer_6_expert_2_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1334" class="edge">
<title>layer_6_expert_2_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M151947.7,-317.34C151983.07,-310.17 152020.13,-303.29 152055,-298 152266.23,-265.93 152509.24,-244.53 152680.27,-231.99"/>
<polygon fill="black" stroke="black" points="152680.69,-235.47 152690.41,-231.25 152680.18,-228.49 152680.69,-235.47"/>
</g>
<!-- layer_6_expert_3_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1335" class="edge">
<title>layer_6_expert_3_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M152507.83,-314.82C152573.06,-298.72 152647.72,-280.29 152714.27,-263.86"/>
<polygon fill="black" stroke="black" points="152715.15,-267.24 152724.02,-261.45 152713.48,-260.45 152715.15,-267.24"/>
</g>
<!-- layer_6_expert_4_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1336" class="edge">
<title>layer_6_expert_4_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M152900,-305.64C152900,-297.08 152900,-288.12 152900,-279.34"/>
<polygon fill="black" stroke="black" points="152903.5,-279.15 152900,-269.15 152896.5,-279.15 152903.5,-279.15"/>
</g>
<!-- layer_6_expert_5_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1337" class="edge">
<title>layer_6_expert_5_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M153256.16,-305.93C153210.62,-294.69 153162.27,-282.75 153116.37,-271.42"/>
<polygon fill="black" stroke="black" points="153117.16,-268.01 153106.61,-269.01 153115.48,-274.81 153117.16,-268.01"/>
</g>
<!-- layer_6_expert_6_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1338" class="edge">
<title>layer_6_expert_6_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M153792.92,-305.97C153776.74,-303.07 153760.65,-300.38 153745,-298 153547.52,-268.02 153322.26,-247.36 153154.01,-234.55"/>
<polygon fill="black" stroke="black" points="153154.26,-231.06 153144.02,-233.8 153153.73,-238.04 153154.26,-231.06"/>
</g>
<!-- layer_6_expert_7_ep_7&#45;&gt;layer_6_agg_ep_7 -->
<g id="edge1339" class="edge">
<title>layer_6_expert_7_ep_7&#45;&gt;layer_6_agg_ep_7</title>
<path fill="none" stroke="black" d="M154359.84,-305.94C154342.35,-302.94 154324.92,-300.24 154308,-298 153899.97,-243.88 153420.66,-226.34 153139.64,-220.68"/>
<polygon fill="black" stroke="black" points="153139.38,-217.17 153129.32,-220.47 153139.24,-224.17 153139.38,-217.17"/>
</g>
<!-- layer_6_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1277" class="edge">
<title>layer_6_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M171146.76,-221.91C171782.69,-235.17 173614.21,-271.51 175137,-283.5 177440.21,-301.64 504505.72,-284.56 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1286" class="edge">
<title>layer_6_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M162138.76,-221.91C162774.69,-235.17 164606.21,-271.51 166129,-283.5 168494.76,-302.13 504443.17,-284.59 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1295" class="edge">
<title>layer_6_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M180160.88,-227.51C180532.7,-243.43 181276.07,-272.92 181907,-283.5 183034.97,-302.41 505680.87,-284.02 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1304" class="edge">
<title>layer_6_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M148626.76,-221.91C149262.69,-235.17 151094.21,-271.51 152617,-283.5 155076.59,-302.87 504349.33,-284.63 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1313" class="edge">
<title>layer_6_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M157634.76,-221.91C158270.69,-235.17 160102.21,-271.51 161625,-283.5 164022.04,-302.38 504411.89,-284.6 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1322" class="edge">
<title>layer_6_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M175650.76,-221.91C176286.69,-235.17 178118.21,-271.51 179641,-283.5 181912.93,-301.4 504537,-284.55 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1331" class="edge">
<title>layer_6_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M166642.76,-221.91C167278.69,-235.17 169110.21,-271.51 170633,-283.5 172967.48,-301.89 504474.44,-284.57 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1340" class="edge">
<title>layer_6_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M153130.76,-221.91C153766.69,-235.17 155598.21,-271.51 157121,-283.5 159549.31,-302.63 504380.61,-284.62 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_6_moe_alltoall -->
<g id="node718" class="node">
<title>layer_6_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="154173" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="154173" y="-691" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="154173" y="-680" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="154173" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="154173" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_6_ln_tp_0 -->
<g id="node719" class="node">
<title>layer_6_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="177434.07,-729 176983.77,-729 176867.93,-625 177318.23,-625 177434.07,-729"/>
<text text-anchor="middle" x="177151" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="177151" y="-680" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="177151" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="177151" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_qkv_tp_0 -->
<g id="node723" class="node">
<title>layer_7_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="182465.7,-559 182023.94,-559 181910.3,-455 182352.06,-455 182465.7,-559"/>
<text text-anchor="middle" x="182188" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="182188" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="182188" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="182188" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_6_ln_tp_0&#45;&gt;layer_7_qkv_tp_0 -->
<g id="edge3101" class="edge">
<title>layer_6_ln_tp_0&#45;&gt;layer_7_qkv_tp_0</title>
<path fill="none" stroke="black" d="M177334.19,-639.25C177370.12,-633.39 177407.64,-628.21 177443,-625 177935.99,-580.32 181407.95,-659.91 181898,-590 181940.41,-583.95 181985.35,-573.38 182026.87,-561.81"/>
<polygon fill="black" stroke="black" points="182027.84,-565.17 182036.51,-559.08 182025.93,-558.43 182027.84,-565.17"/>
</g>
<!-- layer_6_ln_tp_1 -->
<g id="node720" class="node">
<title>layer_6_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="179186.07,-729 178735.77,-729 178619.93,-625 179070.23,-625 179186.07,-729"/>
<text text-anchor="middle" x="178903" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="178903" y="-680" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="178903" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="178903" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_qkv_tp_1 -->
<g id="node724" class="node">
<title>layer_7_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="184187.7,-559 183745.94,-559 183632.3,-455 184074.06,-455 184187.7,-559"/>
<text text-anchor="middle" x="183910" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="183910" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="183910" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="183910" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_6_ln_tp_1&#45;&gt;layer_7_qkv_tp_1 -->
<g id="edge3102" class="edge">
<title>layer_6_ln_tp_1&#45;&gt;layer_7_qkv_tp_1</title>
<path fill="none" stroke="black" d="M179086.19,-639.25C179122.12,-633.39 179159.64,-628.21 179195,-625 179685.01,-580.58 183136.01,-660.17 183623,-590 183664.9,-583.96 183709.29,-573.43 183750.31,-561.88"/>
<polygon fill="black" stroke="black" points="183751.45,-565.19 183760.11,-559.08 183749.53,-558.46 183751.45,-565.19"/>
</g>
<!-- layer_6_ln_tp_2 -->
<g id="node721" class="node">
<title>layer_6_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="178018.07,-729 177567.77,-729 177451.93,-625 177902.23,-625 178018.07,-729"/>
<text text-anchor="middle" x="177735" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="177735" y="-680" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="177735" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="177735" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_qkv_tp_2 -->
<g id="node725" class="node">
<title>layer_7_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="183039.7,-559 182597.94,-559 182484.3,-455 182926.06,-455 183039.7,-559"/>
<text text-anchor="middle" x="182762" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="182762" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="182762" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="182762" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_6_ln_tp_2&#45;&gt;layer_7_qkv_tp_2 -->
<g id="edge3103" class="edge">
<title>layer_6_ln_tp_2&#45;&gt;layer_7_qkv_tp_2</title>
<path fill="none" stroke="black" d="M177918.19,-639.25C177954.12,-633.39 177991.64,-628.21 178027,-625 178519.22,-580.39 181985.81,-660.48 182475,-590 182516.9,-583.96 182561.29,-573.43 182602.31,-561.88"/>
<polygon fill="black" stroke="black" points="182603.45,-565.19 182612.11,-559.08 182601.53,-558.46 182603.45,-565.19"/>
</g>
<!-- layer_6_ln_tp_3 -->
<g id="node722" class="node">
<title>layer_6_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="178602.07,-729 178151.77,-729 178035.93,-625 178486.23,-625 178602.07,-729"/>
<text text-anchor="middle" x="178319" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="178319" y="-680" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="178319" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="178319" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_qkv_tp_3 -->
<g id="node726" class="node">
<title>layer_7_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="183613.7,-559 183171.94,-559 183058.3,-455 183500.06,-455 183613.7,-559"/>
<text text-anchor="middle" x="183336" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="183336" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="183336" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="183336" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_6_ln_tp_3&#45;&gt;layer_7_qkv_tp_3 -->
<g id="edge3104" class="edge">
<title>layer_6_ln_tp_3&#45;&gt;layer_7_qkv_tp_3</title>
<path fill="none" stroke="black" d="M178502.19,-639.25C178538.12,-633.39 178575.64,-628.21 178611,-625 179102.11,-580.48 182560.91,-660.32 183049,-590 183090.9,-583.96 183135.29,-573.43 183176.31,-561.88"/>
<polygon fill="black" stroke="black" points="183177.45,-565.19 183186.11,-559.08 183175.53,-558.46 183177.45,-565.19"/>
</g>
<!-- layer_7_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1349" class="edge">
<title>layer_7_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M181958.72,-454.96C181938.27,-451.74 181917.81,-449 181898,-447 181772.8,-434.38 145783.31,-456.5 145659,-437 145646.09,-434.97 145643.68,-431.18 145631,-428 145547.51,-407.08 145452.18,-389.75 145378.01,-377.7"/>
<polygon fill="black" stroke="black" points="145378.12,-374.17 145367.69,-376.03 145377.01,-381.08 145378.12,-374.17"/>
</g>
<!-- layer_7_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1350" class="edge">
<title>layer_7_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M183683.1,-454.98C183662.86,-451.75 183642.61,-449 183623,-447 183101.22,-393.66 146383.03,-432.23 145859,-410 145690.07,-402.83 145495.39,-384.73 145373.01,-372.14"/>
<polygon fill="black" stroke="black" points="145373.17,-368.64 145362.87,-371.09 145372.45,-375.6 145373.17,-368.64"/>
</g>
<!-- layer_7_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1351" class="edge">
<title>layer_7_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M182535.1,-454.96C182514.86,-451.74 182494.61,-449 182475,-447 182348.25,-434.09 145908.07,-446.33 145781,-437 145629.65,-425.88 145455.88,-397.16 145350.04,-377.84"/>
<polygon fill="black" stroke="black" points="145350.48,-374.37 145340.01,-376.01 145349.22,-381.25 145350.48,-374.37"/>
</g>
<!-- layer_7_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1352" class="edge">
<title>layer_7_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M183109.1,-454.96C183088.86,-451.74 183068.61,-449 183049,-447 182920.44,-433.9 145959.94,-445.66 145831,-437 145787.03,-434.05 145535.87,-399.15 145379.13,-377.04"/>
<polygon fill="black" stroke="black" points="145379.33,-373.54 145368.94,-375.61 145378.35,-380.47 145379.33,-373.54"/>
</g>
<!-- layer_7_qkv_comm -->
<g id="node727" class="node">
<title>layer_7_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="215396" cy="-507" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="215396" y="-521" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="215396" y="-510" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="215396" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="215396" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_7_attn_tp_0 -->
<g id="node728" class="node">
<title>layer_7_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="213462.7,-559 213020.94,-559 212907.3,-455 213349.06,-455 213462.7,-559"/>
<text text-anchor="middle" x="213185" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="213185" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="213185" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="213185" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_out_tp_0 -->
<g id="node732" class="node">
<title>layer_7_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="215702.7,-410 215260.94,-410 215147.3,-306 215589.06,-306 215702.7,-410"/>
<text text-anchor="middle" x="215425" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="215425" y="-361" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="215425" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="215425" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_tp_0&#45;&gt;layer_7_attn_out_tp_0 -->
<g id="edge1357" class="edge">
<title>layer_7_attn_tp_0&#45;&gt;layer_7_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M213360.3,-465.07C213397.02,-457.87 213435.63,-451.32 213472,-447 213973.63,-387.44 214103.4,-433.7 214608,-410 214812.58,-400.39 215045.72,-385.44 215210.45,-374.21"/>
<polygon fill="black" stroke="black" points="215210.97,-377.68 215220.7,-373.51 215210.49,-370.7 215210.97,-377.68"/>
</g>
<!-- layer_7_attn_tp_1 -->
<g id="node729" class="node">
<title>layer_7_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="214036.7,-559 213594.94,-559 213481.3,-455 213923.06,-455 214036.7,-559"/>
<text text-anchor="middle" x="213759" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="213759" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="213759" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="213759" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_out_tp_1 -->
<g id="node733" class="node">
<title>layer_7_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="216541.7,-410 216099.94,-410 215986.3,-306 216428.06,-306 216541.7,-410"/>
<text text-anchor="middle" x="216264" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="216264" y="-361" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="216264" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="216264" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_tp_1&#45;&gt;layer_7_attn_out_tp_1 -->
<g id="edge1359" class="edge">
<title>layer_7_attn_tp_1&#45;&gt;layer_7_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M213934.3,-465.07C213971.02,-457.87 214009.63,-451.32 214046,-447 214295.5,-417.38 214359.83,-434.28 214611,-428 215100.25,-415.78 215223.32,-436.53 215712,-410 215826.63,-403.78 215954.27,-392.28 216057.92,-381.78"/>
<polygon fill="black" stroke="black" points="216058.28,-385.26 216067.87,-380.76 216057.57,-378.29 216058.28,-385.26"/>
</g>
<!-- layer_7_attn_tp_2 -->
<g id="node730" class="node">
<title>layer_7_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="214610.7,-559 214168.94,-559 214055.3,-455 214497.06,-455 214610.7,-559"/>
<text text-anchor="middle" x="214333" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="214333" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="214333" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="214333" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_out_tp_2 -->
<g id="node734" class="node">
<title>layer_7_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="217247.7,-410 216805.94,-410 216692.3,-306 217134.06,-306 217247.7,-410"/>
<text text-anchor="middle" x="216970" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="216970" y="-361" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="216970" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="216970" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_tp_2&#45;&gt;layer_7_attn_out_tp_2 -->
<g id="edge1361" class="edge">
<title>layer_7_attn_tp_2&#45;&gt;layer_7_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M214507.87,-464.74C214544.7,-457.54 214583.47,-451.07 214620,-447 215046.55,-399.48 216122.87,-440.08 216551,-410 216622.5,-404.98 216700.53,-396.35 216769.67,-387.6"/>
<polygon fill="black" stroke="black" points="216770.32,-391.04 216779.8,-386.31 216769.44,-384.1 216770.32,-391.04"/>
</g>
<!-- layer_7_attn_tp_3 -->
<g id="node731" class="node">
<title>layer_7_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="215184.7,-559 214742.94,-559 214629.3,-455 215071.06,-455 215184.7,-559"/>
<text text-anchor="middle" x="214907" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="214907" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="214907" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="214907" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_out_tp_3 -->
<g id="node735" class="node">
<title>layer_7_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="217887.7,-410 217445.94,-410 217332.3,-306 217774.06,-306 217887.7,-410"/>
<text text-anchor="middle" x="217610" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="217610" y="-361" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="217610" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="217610" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_7_attn_tp_3&#45;&gt;layer_7_attn_out_tp_3 -->
<g id="edge1363" class="edge">
<title>layer_7_attn_tp_3&#45;&gt;layer_7_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M215081.86,-464.7C215118.7,-457.51 215157.47,-451.05 215194,-447 215649.73,-396.51 216799.97,-446.97 217257,-410 217308.06,-405.87 217362.99,-399.08 217413.95,-391.79"/>
<polygon fill="black" stroke="black" points="217414.69,-395.22 217424.09,-390.32 217413.69,-388.29 217414.69,-395.22"/>
</g>
<!-- layer_7_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1358" class="edge">
<title>layer_7_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M215678.17,-387.32C215771.91,-396.51 215879.18,-405.49 215977,-410 215977,-410 506818,-428 506818,-428 506820.83,-430.83 506820.83,-434.17 506818,-437 506818,-437 290053,-447 290053,-447 290000.87,-487.09 290067.13,-549.91 290015,-590 290015,-590 144976,-598 144976,-598 144951.33,-622.67 144985.99,-642.35 145026.22,-655.78"/>
<polygon fill="black" stroke="black" points="145025.39,-659.18 145035.98,-658.88 145027.51,-652.51 145025.39,-659.18"/>
</g>
<!-- layer_7_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1360" class="edge">
<title>layer_7_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M216526.46,-395.89C216578.24,-401.77 216632.26,-406.92 216683,-410 216683,-410 506833,-428 506833,-428 506835.83,-430.83 506835.83,-434.17 506833,-437 506833,-437 290091,-447 290091,-447 290037.74,-486.6 290101.26,-550.4 290048,-590 290048,-590 145001,-598 145001,-598 144978.72,-620.28 145010.5,-640.81 145045.39,-655.21"/>
<polygon fill="black" stroke="black" points="145044.19,-658.5 145054.78,-658.92 145046.77,-651.99 145044.19,-658.5"/>
</g>
<!-- layer_7_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1362" class="edge">
<title>layer_7_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M217238.91,-401.92C217267.24,-405.23 217295.67,-408.04 217323,-410 217323,-410 506848,-428 506848,-428 506850.83,-430.83 506850.83,-434.17 506848,-437 506848,-437 290129,-447 290129,-447 290075.05,-486.32 290136.95,-550.68 290083,-590 290083,-590 145026,-598 145026,-598 145006.51,-617.49 145032.7,-638.73 145060.85,-654.11"/>
<polygon fill="black" stroke="black" points="145059.51,-657.36 145070,-658.89 145062.75,-651.16 145059.51,-657.36"/>
</g>
<!-- layer_7_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1364" class="edge">
<title>layer_7_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M217882.18,-404.7C217900.69,-406.8 217919.1,-408.61 217937,-410 217937,-410 506863,-428 506863,-428 506865.83,-430.83 506865.83,-434.17 506863,-437 506863,-437 290165,-447 290165,-447 290111.28,-486.41 290173.72,-550.59 290120,-590 290120,-590 145066,-598 145066,-598 145050.75,-613.25 145064.95,-634.89 145081.17,-651.5"/>
<polygon fill="black" stroke="black" points="145079.03,-654.31 145088.66,-658.74 145083.9,-649.28 145079.03,-654.31"/>
</g>
<!-- layer_7_attn_allreduce -->
<g id="node736" class="node">
<title>layer_7_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="206113" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="206113" y="-521" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="206113" y="-510" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="206113" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="206113" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_gate_tp_0 -->
<g id="node737" class="node">
<title>layer_7_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="197220.99,-559 196772.4,-559 196657.01,-455 197105.6,-455 197220.99,-559"/>
<text text-anchor="middle" x="196939" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="196939" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="196939" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="196939" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_7_route_ep_0 -->
<g id="node741" class="node">
<title>layer_7_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="201332.43,-410 200873.6,-410 200755.57,-306 201214.4,-306 201332.43,-410"/>
<text text-anchor="middle" x="201044" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="201044" y="-361" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="201044" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="201044" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_0 -->
<g id="edge1365" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197117.62,-465.58C197154.61,-458.4 197193.45,-451.71 197230,-447 197308.15,-436.92 197328.41,-442.69 197407,-437 197452.39,-433.72 197463.56,-430.45 197509,-428 198153.56,-393.31 200124.98,-369.05 200808.05,-361.49"/>
<polygon fill="black" stroke="black" points="200808.3,-364.99 200818.26,-361.38 200808.22,-357.99 200808.3,-364.99"/>
<text text-anchor="middle" x="197535" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_1 -->
<g id="node742" class="node">
<title>layer_7_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="197904.43,-410 197445.6,-410 197327.57,-306 197786.4,-306 197904.43,-410"/>
<text text-anchor="middle" x="197616" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="197616" y="-361" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="197616" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="197616" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_1 -->
<g id="edge1366" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M196999.88,-454.86C197015.1,-444.4 197031.97,-434.59 197049,-428 197110.92,-404.06 197263.16,-386.29 197394.31,-374.78"/>
<polygon fill="black" stroke="black" points="197394.85,-378.25 197404.51,-373.89 197394.25,-371.27 197394.85,-378.25"/>
<text text-anchor="middle" x="197075" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_2 -->
<g id="node743" class="node">
<title>layer_7_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="190002.43,-410 189543.6,-410 189425.57,-306 189884.4,-306 190002.43,-410"/>
<text text-anchor="middle" x="189714" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="189714" y="-361" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="189714" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="189714" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_2 -->
<g id="edge1367" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M196713.7,-506.25C195951.59,-506.45 193400.22,-501.9 191293,-437 190827.06,-422.65 190284.35,-393.01 189971.83,-374.68"/>
<polygon fill="black" stroke="black" points="189971.92,-371.18 189961.73,-374.09 189971.51,-378.17 189971.92,-371.18"/>
<text text-anchor="middle" x="191319" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_3 -->
<g id="node744" class="node">
<title>layer_7_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="205836.43,-410 205377.6,-410 205259.57,-306 205718.4,-306 205836.43,-410"/>
<text text-anchor="middle" x="205548" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="205548" y="-361" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="205548" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="205548" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_3 -->
<g id="edge1368" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197116.31,-464.61C197153.66,-457.43 197192.97,-450.99 197230,-447 197380.48,-430.78 197759.86,-444.97 197911,-437 197955.12,-434.67 197965.87,-430.12 198010,-428 198379.69,-410.23 200970.9,-413.24 201341,-410 202854.81,-396.73 204674.92,-371.52 205313.16,-362.4"/>
<polygon fill="black" stroke="black" points="205313.45,-365.9 205323.4,-362.25 205313.35,-358.9 205313.45,-365.9"/>
<text text-anchor="middle" x="198036" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_4 -->
<g id="node745" class="node">
<title>layer_7_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="210340.43,-410 209881.6,-410 209763.57,-306 210222.4,-306 210340.43,-410"/>
<text text-anchor="middle" x="210052" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="210052" y="-361" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="210052" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="210052" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_4 -->
<g id="edge1369" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197116.28,-464.3C197153.63,-457.13 197192.95,-450.79 197230,-447 197306.3,-439.2 199914.31,-437.82 199991,-437 200215.91,-434.59 200272.09,-430.38 200497,-428 202873.77,-402.86 203468.17,-428.41 205845,-410 207358.82,-398.28 209178.93,-372.11 209817.16,-362.57"/>
<polygon fill="black" stroke="black" points="209817.45,-366.06 209827.4,-362.41 209817.35,-359.06 209817.45,-366.06"/>
<text text-anchor="middle" x="200523" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_5 -->
<g id="node746" class="node">
<title>layer_7_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="214599.43,-410 214140.6,-410 214022.57,-306 214481.4,-306 214599.43,-410"/>
<text text-anchor="middle" x="214311" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="214311" y="-361" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="214311" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="214311" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_5 -->
<g id="edge1370" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197116.27,-464.23C197153.63,-457.07 197192.94,-450.74 197230,-447 197333.35,-436.56 204605.13,-437.32 204709,-437 205962.34,-433.16 209095.7,-421.07 210349,-410 211764.06,-397.51 213463.27,-372.16 214076.23,-362.68"/>
<polygon fill="black" stroke="black" points="214076.57,-366.18 214086.51,-362.53 214076.46,-359.18 214076.57,-366.18"/>
<text text-anchor="middle" x="207030" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_6 -->
<g id="node747" class="node">
<title>layer_7_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="185568.43,-410 185109.6,-410 184991.57,-306 185450.4,-306 185568.43,-410"/>
<text text-anchor="middle" x="185280" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="185280" y="-361" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="185280" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="185280" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_6 -->
<g id="edge1371" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M196710.55,-503.49C195921.57,-494.81 193238.28,-464.98 191022,-437 188892.19,-410.12 186318.07,-373.78 185524.62,-362.49"/>
<polygon fill="black" stroke="black" points="185524.55,-358.99 185514.5,-362.35 185524.45,-365.99 185524.55,-358.99"/>
<text text-anchor="middle" x="191048" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_route_ep_7 -->
<g id="node748" class="node">
<title>layer_7_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="194512.43,-410 194053.6,-410 193935.57,-306 194394.4,-306 194512.43,-410"/>
<text text-anchor="middle" x="194224" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="194224" y="-361" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="194224" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="194224" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_7 -->
<g id="edge1372" class="edge">
<title>layer_7_gate_tp_0&#45;&gt;layer_7_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M196698.96,-493C196189.47,-465.42 195003.85,-401.22 194480.31,-372.88"/>
<polygon fill="black" stroke="black" points="194480.15,-369.36 194469.98,-372.32 194479.77,-376.35 194480.15,-369.36"/>
<text text-anchor="middle" x="195688" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1 -->
<g id="node738" class="node">
<title>layer_7_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="197802.99,-559 197354.4,-559 197239.01,-455 197687.6,-455 197802.99,-559"/>
<text text-anchor="middle" x="197521" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="197521" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="197521" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="197521" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_0 -->
<g id="edge1373" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197698.75,-464.96C197735.98,-457.77 197775.13,-451.25 197812,-447 197883.34,-438.78 198386.22,-430.01 198458,-428 199326.53,-403.64 200359.21,-376.69 200811.92,-364.98"/>
<polygon fill="black" stroke="black" points="200812.27,-368.47 200822.18,-364.71 200812.09,-361.47 200812.27,-368.47"/>
<text text-anchor="middle" x="198484" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_1 -->
<g id="edge1374" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197553.96,-455C197561.46,-443.39 197569.5,-430.95 197577.22,-419"/>
<polygon fill="black" stroke="black" points="197580.29,-420.71 197582.78,-410.41 197574.41,-416.91 197580.29,-420.71"/>
<text text-anchor="middle" x="197597" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_2 -->
<g id="edge1375" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197289.72,-454.94C197269.59,-451.76 197249.48,-449.03 197230,-447 197092.63,-432.66 196125.09,-439.86 195987,-437 195867.4,-434.52 195837.59,-430.6 195718,-428 194922.15,-410.69 194722.99,-418.82 193927,-410 192418.34,-393.29 190605.83,-370.4 189958.46,-362.13"/>
<polygon fill="black" stroke="black" points="189958.12,-358.63 189948.08,-362 189958.03,-365.63 189958.12,-358.63"/>
<text text-anchor="middle" x="196013" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_3 -->
<g id="edge1376" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197698.28,-464.3C197735.63,-457.14 197774.95,-450.79 197812,-447 197887.74,-439.26 200476.86,-437.73 200553,-437 201498.55,-427.89 204457.31,-377.71 205313.64,-363.03"/>
<polygon fill="black" stroke="black" points="205313.99,-366.53 205323.93,-362.86 205313.87,-359.53 205313.99,-366.53"/>
<text text-anchor="middle" x="201297" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_4 -->
<g id="edge1377" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197698.27,-464.22C197735.63,-457.07 197774.94,-450.74 197812,-447 197943.06,-433.78 207164.29,-438.93 207296,-437 208233.68,-423.24 209350.28,-384.86 209822.77,-367.6"/>
<polygon fill="black" stroke="black" points="209822.91,-371.1 209832.78,-367.23 209822.66,-364.1 209822.91,-371.1"/>
<text text-anchor="middle" x="207773" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_5 -->
<g id="edge1378" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197698.27,-464.22C197735.63,-457.06 197774.94,-450.73 197812,-447 197891.68,-438.97 209263.92,-437.66 209344,-437 211167.61,-421.89 213367.5,-378.52 214077.84,-363.89"/>
<polygon fill="black" stroke="black" points="214078,-367.39 214087.93,-363.68 214077.86,-360.39 214078,-367.39"/>
<text text-anchor="middle" x="210182" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_6 -->
<g id="edge1379" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197290.92,-455C197270.4,-451.77 197249.87,-449.01 197230,-447 197156.25,-439.53 191967.12,-437.68 191893,-437 191649.42,-434.77 191588.57,-431.14 191345,-428 190488.14,-416.96 190273.88,-419.28 189417,-410 187938.9,-393.99 186163.78,-370.76 185524.38,-362.27"/>
<polygon fill="black" stroke="black" points="185524.17,-358.76 185514.12,-362.13 185524.07,-365.76 185524.17,-358.76"/>
<text text-anchor="middle" x="191919" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_7 -->
<g id="edge1380" class="edge">
<title>layer_7_gate_tp_1&#45;&gt;layer_7_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197273.91,-454.95C197259.07,-452.18 197244.34,-449.51 197230,-447 197172.91,-437.02 197158.74,-432.93 197101,-428 196592.6,-384.63 195064.01,-366.54 194466.82,-361"/>
<polygon fill="black" stroke="black" points="194466.82,-357.5 194456.79,-360.91 194466.76,-364.5 194466.82,-357.5"/>
<text text-anchor="middle" x="197198" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2 -->
<g id="node739" class="node">
<title>layer_7_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="198384.99,-559 197936.4,-559 197821.01,-455 198269.6,-455 198384.99,-559"/>
<text text-anchor="middle" x="198103" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="198103" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="198103" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="198103" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_0 -->
<g id="edge1381" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198281.15,-464.99C198318.26,-457.83 198357.26,-451.3 198394,-447 198857.64,-392.69 200249.95,-369.2 200808.44,-361.78"/>
<polygon fill="black" stroke="black" points="200808.68,-365.28 200818.63,-361.65 200808.59,-358.28 200808.68,-365.28"/>
<text text-anchor="middle" x="198587" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_1 -->
<g id="edge1382" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197852.65,-454.96C197838.9,-452.24 197825.28,-449.58 197812,-447 197788.04,-442.35 197780.99,-445.2 197758,-437 197741.12,-430.98 197723.85,-423.12 197707.43,-414.72"/>
<polygon fill="black" stroke="black" points="197708.89,-411.53 197698.4,-410.01 197705.65,-417.74 197708.89,-411.53"/>
<text text-anchor="middle" x="197784" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_2 -->
<g id="edge1383" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197871.71,-454.95C197851.59,-451.78 197831.48,-449.04 197812,-447 197685.47,-433.74 196794.22,-438.47 196667,-437 196387.88,-433.78 196318.12,-431.19 196039,-428 195100.36,-417.27 194865.65,-419.68 193927,-410 192418.55,-394.44 190606.37,-370.85 189958.75,-362.27"/>
<polygon fill="black" stroke="black" points="189958.41,-358.76 189948.36,-362.13 189958.32,-365.76 189958.41,-358.76"/>
<text text-anchor="middle" x="196693" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_3 -->
<g id="edge1384" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198280.28,-464.29C198317.63,-457.13 198356.95,-450.78 198394,-447 198476.6,-438.57 201299.98,-437.92 201383,-437 202881.82,-420.46 204683.68,-379.58 205315.52,-364.61"/>
<polygon fill="black" stroke="black" points="205315.74,-368.1 205325.65,-364.37 205315.57,-361.11 205315.74,-368.1"/>
<text text-anchor="middle" x="202090" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_4 -->
<g id="edge1385" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198280.27,-464.22C198317.63,-457.06 198356.94,-450.74 198394,-447 198533.87,-432.89 208375.46,-440.64 208516,-437 208983.8,-424.9 209530.99,-392.81 209829.61,-373.77"/>
<polygon fill="black" stroke="black" points="209829.93,-377.26 209839.69,-373.13 209829.48,-370.27 209829.93,-377.26"/>
<text text-anchor="middle" x="208793" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_5 -->
<g id="edge1386" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198280.27,-464.22C198317.63,-457.06 198356.94,-450.73 198394,-447 198486.01,-437.73 211618.53,-438.42 211711,-437 212587.36,-423.53 213629.32,-385.65 214082.08,-368.12"/>
<polygon fill="black" stroke="black" points="214082.48,-371.6 214092.34,-367.72 214082.21,-364.61 214082.48,-371.6"/>
<text text-anchor="middle" x="212162" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_6 -->
<g id="edge1387" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197872.52,-454.95C197852.13,-451.75 197831.74,-449.01 197812,-447 197708.59,-436.48 194173.94,-437.44 194070,-437 193035.99,-432.62 190450.97,-419.37 189417,-410 187939.32,-396.6 186164.84,-371.8 185524.96,-362.58"/>
<polygon fill="black" stroke="black" points="185524.74,-359.07 185514.69,-362.43 185524.64,-366.07 185524.74,-359.07"/>
<text text-anchor="middle" x="194096" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_7 -->
<g id="edge1388" class="edge">
<title>layer_7_gate_tp_2&#45;&gt;layer_7_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M197870.5,-454.97C197850.78,-451.83 197831.09,-449.1 197812,-447 197575.6,-421.04 197513.63,-460.78 197277,-437 197254.97,-434.79 197250.03,-430.26 197228,-428 196694.56,-373.23 195080.51,-361.93 194465.52,-359.6"/>
<polygon fill="black" stroke="black" points="194465.21,-356.1 194455.2,-359.56 194465.19,-363.1 194465.21,-356.1"/>
<text text-anchor="middle" x="197303" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3 -->
<g id="node740" class="node">
<title>layer_7_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="198966.99,-559 198518.4,-559 198403.01,-455 198851.6,-455 198966.99,-559"/>
<text text-anchor="middle" x="198685" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="198685" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="198685" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="198685" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_0 -->
<g id="edge1389" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198893.83,-492.99C199336.38,-465.41 200365.22,-401.3 200820.45,-372.93"/>
<polygon fill="black" stroke="black" points="200821,-376.4 200830.76,-372.29 200820.56,-369.42 200821,-376.4"/>
<text text-anchor="middle" x="199961" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_1 -->
<g id="edge1390" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198452.5,-454.97C198432.78,-451.83 198413.09,-449.1 198394,-447 198275.8,-434.02 197976.3,-456.49 197859,-437 197826.72,-431.64 197792.84,-422.87 197760.96,-413.12"/>
<polygon fill="black" stroke="black" points="197761.73,-409.7 197751.14,-410.07 197759.65,-416.38 197761.73,-409.7"/>
<text text-anchor="middle" x="197885" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_2 -->
<g id="edge1391" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198454.12,-454.98C198433.86,-451.78 198413.61,-449.04 198394,-447 198237.28,-430.71 197133.52,-440.31 196976,-437 196861.73,-434.6 196833.27,-430.37 196719,-428 195478.35,-402.28 195167.86,-421.51 193927,-410 192418.54,-396.01 190606.36,-371.46 189958.75,-362.45"/>
<polygon fill="black" stroke="black" points="189958.41,-358.94 189948.36,-362.3 189958.31,-365.94 189958.41,-358.94"/>
<text text-anchor="middle" x="197002" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_3 -->
<g id="edge1392" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198907.33,-505.16C199830.27,-501.42 203363.35,-484.22 204478,-437 204773.84,-424.47 205114.88,-397.42 205330.9,-378.72"/>
<polygon fill="black" stroke="black" points="205331.43,-382.19 205341.09,-377.83 205330.83,-375.21 205331.43,-382.19"/>
<text text-anchor="middle" x="204679" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_4 -->
<g id="edge1393" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198905.87,-503.79C199788.03,-495.03 203144.63,-462.56 205907,-447 206086.55,-445.99 208959.62,-444.93 209139,-437 209379.13,-426.39 209653.85,-401.13 209838.68,-382.21"/>
<polygon fill="black" stroke="black" points="209839.2,-385.68 209848.79,-381.18 209838.49,-378.72 209839.2,-385.68"/>
<text text-anchor="middle" x="209314" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_5 -->
<g id="edge1394" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198905.87,-503.66C199788.03,-494.41 203144.62,-460.31 205907,-447 206284.94,-445.18 212332.17,-446.48 212710,-437 213202.03,-424.66 213778.38,-392.14 214087.68,-373.21"/>
<polygon fill="black" stroke="black" points="214088.35,-376.68 214098.12,-372.57 214087.92,-369.69 214088.35,-376.68"/>
<text text-anchor="middle" x="212998" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_6 -->
<g id="edge1395" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198454.52,-454.97C198434.13,-451.76 198413.74,-449.02 198394,-447 198312.48,-438.68 195525.94,-437.42 195444,-437 194856.44,-434 194709.56,-431.12 194122,-428 192030.9,-416.88 191508.06,-426.89 189417,-410 187939.3,-398.07 186164.84,-372.38 185524.96,-362.75"/>
<polygon fill="black" stroke="black" points="185524.74,-359.24 185514.69,-362.59 185524.63,-366.24 185524.74,-359.24"/>
<text text-anchor="middle" x="195470" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_7 -->
<g id="edge1396" class="edge">
<title>layer_7_gate_tp_3&#45;&gt;layer_7_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198453.71,-454.97C198433.59,-451.79 198413.48,-449.05 198394,-447 198336.37,-440.94 197407.8,-448.45 197351,-437 197340.64,-434.91 197339.34,-430.15 197329,-428 197052.31,-370.39 195146.12,-360.86 194465.15,-359.3"/>
<polygon fill="black" stroke="black" points="194464.97,-355.8 194454.97,-359.28 194464.96,-362.8 194464.97,-355.8"/>
<text text-anchor="middle" x="197377" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_7_expert_0_ep_0 -->
<g id="node749" class="node">
<title>layer_7_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="200471.83,-269 200037.82,-269 199926.17,-165 200360.18,-165 200471.83,-269"/>
<text text-anchor="middle" x="200199" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="200199" y="-220" font-family="Arial" font-size="10.00">GPU: 128</text>
<text text-anchor="middle" x="200199" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="200199" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_0_ep_0 -->
<g id="edge1397" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M200765.52,-314.95C200674.44,-300.82 200572.83,-284.66 200480,-269 200479.9,-268.98 200479.79,-268.97 200479.69,-268.95"/>
<polygon fill="black" stroke="black" points="200480.48,-265.53 200470.04,-267.31 200479.31,-272.43 200480.48,-265.53"/>
</g>
<!-- layer_7_expert_1_ep_0 -->
<g id="node750" class="node">
<title>layer_7_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="201034.83,-269 200600.82,-269 200489.17,-165 200923.18,-165 201034.83,-269"/>
<text text-anchor="middle" x="200762" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="200762" y="-220" font-family="Arial" font-size="10.00">GPU: 129</text>
<text text-anchor="middle" x="200762" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="200762" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_1_ep_0 -->
<g id="edge1398" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M200940.19,-305.83C200918.9,-295.34 200896.38,-284.24 200874.78,-273.59"/>
<polygon fill="black" stroke="black" points="200876.1,-270.34 200865.59,-269.06 200873.01,-276.62 200876.1,-270.34"/>
</g>
<!-- layer_7_expert_2_ep_0 -->
<g id="node751" class="node">
<title>layer_7_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="201597.83,-269 201163.82,-269 201052.17,-165 201486.18,-165 201597.83,-269"/>
<text text-anchor="middle" x="201325" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="201325" y="-220" font-family="Arial" font-size="10.00">GPU: 130</text>
<text text-anchor="middle" x="201325" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="201325" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_2_ep_0 -->
<g id="edge1399" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M201147.44,-305.83C201168.66,-295.34 201191.1,-284.24 201212.62,-273.59"/>
<polygon fill="black" stroke="black" points="201214.37,-276.63 201221.78,-269.06 201211.27,-270.35 201214.37,-276.63"/>
</g>
<!-- layer_7_expert_3_ep_0 -->
<g id="node752" class="node">
<title>layer_7_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="202160.83,-269 201726.82,-269 201615.17,-165 202049.18,-165 202160.83,-269"/>
<text text-anchor="middle" x="201888" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="201888" y="-220" font-family="Arial" font-size="10.00">GPU: 131</text>
<text text-anchor="middle" x="201888" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="201888" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_3_ep_0 -->
<g id="edge1400" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M201239.28,-327.68C201347.7,-311.1 201484.94,-289.61 201607,-269 201636.45,-264.03 201667.59,-258.57 201698.01,-253.13"/>
<polygon fill="black" stroke="black" points="201698.63,-256.58 201707.85,-251.37 201697.39,-249.69 201698.63,-256.58"/>
</g>
<!-- layer_7_expert_4_ep_0 -->
<g id="node753" class="node">
<title>layer_7_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="202723.83,-269 202289.82,-269 202178.17,-165 202612.18,-165 202723.83,-269"/>
<text text-anchor="middle" x="202451" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="202451" y="-220" font-family="Arial" font-size="10.00">GPU: 132</text>
<text text-anchor="middle" x="202451" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="202451" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_4_ep_0 -->
<g id="edge1401" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M201260.53,-346.62C201487.75,-334.2 201854.98,-309.79 202170,-269 202200.06,-265.11 202231.79,-260.17 202262.67,-254.9"/>
<polygon fill="black" stroke="black" points="202263.41,-258.32 202272.67,-253.18 202262.22,-251.42 202263.41,-258.32"/>
</g>
<!-- layer_7_expert_5_ep_0 -->
<g id="node754" class="node">
<title>layer_7_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="203286.83,-269 202852.82,-269 202741.17,-165 203175.18,-165 203286.83,-269"/>
<text text-anchor="middle" x="203014" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="203014" y="-220" font-family="Arial" font-size="10.00">GPU: 133</text>
<text text-anchor="middle" x="203014" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="203014" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_5_ep_0 -->
<g id="edge1402" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M201269.47,-354.37C201594.04,-348.53 202211.29,-329.68 202733,-269 202763.22,-265.48 202795.1,-260.73 202826.1,-255.52"/>
<polygon fill="black" stroke="black" points="202826.86,-258.94 202836.13,-253.81 202825.69,-252.04 202826.86,-258.94"/>
</g>
<!-- layer_7_expert_6_ep_0 -->
<g id="node755" class="node">
<title>layer_7_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="203849.83,-269 203415.82,-269 203304.17,-165 203738.18,-165 203849.83,-269"/>
<text text-anchor="middle" x="203577" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="203577" y="-220" font-family="Arial" font-size="10.00">GPU: 134</text>
<text text-anchor="middle" x="203577" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="203577" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_6_ep_0 -->
<g id="edge1403" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M201267.05,-352.27C201755.66,-341.27 202907.79,-311.6 203296,-269 203326.35,-265.67 203358.36,-260.99 203389.48,-255.8"/>
<polygon fill="black" stroke="black" points="203390.27,-259.22 203399.55,-254.1 203389.1,-252.32 203390.27,-259.22"/>
</g>
<!-- layer_7_expert_7_ep_0 -->
<g id="node756" class="node">
<title>layer_7_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="204412.83,-269 203978.82,-269 203867.17,-165 204301.18,-165 204412.83,-269"/>
<text text-anchor="middle" x="204140" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="204140" y="-220" font-family="Arial" font-size="10.00">GPU: 135</text>
<text text-anchor="middle" x="204140" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="204140" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_0&#45;&gt;layer_7_expert_7_ep_0 -->
<g id="edge1404" class="edge">
<title>layer_7_route_ep_0&#45;&gt;layer_7_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M201269.24,-354.27C201844.73,-346.61 203358.86,-321.91 203859,-269 203889.48,-265.78 203921.62,-261.14 203952.84,-255.95"/>
<polygon fill="black" stroke="black" points="203953.67,-259.36 203962.95,-254.25 203952.5,-252.46 203953.67,-259.36"/>
</g>
<!-- layer_7_expert_0_ep_1 -->
<g id="node757" class="node">
<title>layer_7_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="195967.83,-269 195533.82,-269 195422.17,-165 195856.18,-165 195967.83,-269"/>
<text text-anchor="middle" x="195695" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="195695" y="-220" font-family="Arial" font-size="10.00">GPU: 144</text>
<text text-anchor="middle" x="195695" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="195695" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_0_ep_1 -->
<g id="edge1405" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M197381.65,-353.69C197064.78,-347.12 196482.17,-327.63 195976.77,-269.05"/>
<polygon fill="black" stroke="black" points="195977.06,-265.56 195966.72,-267.88 195976.25,-272.52 195977.06,-265.56"/>
</g>
<!-- layer_7_expert_1_ep_1 -->
<g id="node758" class="node">
<title>layer_7_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="196530.83,-269 196096.82,-269 195985.17,-165 196419.18,-165 196530.83,-269"/>
<text text-anchor="middle" x="196258" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="196258" y="-220" font-family="Arial" font-size="10.00">GPU: 145</text>
<text text-anchor="middle" x="196258" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="196258" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_1_ep_1 -->
<g id="edge1406" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M197370.39,-343.81C197154.19,-330.57 196830.81,-306.86 196540.06,-269.11"/>
<polygon fill="black" stroke="black" points="196540.1,-265.58 196529.73,-267.76 196539.2,-272.52 196540.1,-265.58"/>
</g>
<!-- layer_7_expert_2_ep_1 -->
<g id="node759" class="node">
<title>layer_7_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="197093.83,-269 196659.82,-269 196548.17,-165 196982.18,-165 197093.83,-269"/>
<text text-anchor="middle" x="196821" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="196821" y="-220" font-family="Arial" font-size="10.00">GPU: 146</text>
<text text-anchor="middle" x="196821" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="196821" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_2_ep_1 -->
<g id="edge1407" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M197330.44,-308.63C197256.05,-295.89 197176,-282.05 197102,-269 197101.9,-268.98 197101.79,-268.96 197101.69,-268.95"/>
<polygon fill="black" stroke="black" points="197102.51,-265.54 197092.05,-267.24 197101.29,-272.43 197102.51,-265.54"/>
</g>
<!-- layer_7_expert_3_ep_1 -->
<g id="node760" class="node">
<title>layer_7_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="197656.83,-269 197222.82,-269 197111.17,-165 197545.18,-165 197656.83,-269"/>
<text text-anchor="middle" x="197384" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="197384" y="-220" font-family="Arial" font-size="10.00">GPU: 147</text>
<text text-anchor="middle" x="197384" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="197384" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_3_ep_1 -->
<g id="edge1408" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M197530.6,-305.83C197513.55,-295.62 197495.54,-284.83 197478.21,-274.45"/>
<polygon fill="black" stroke="black" points="197479.6,-271.2 197469.22,-269.06 197476,-277.2 197479.6,-271.2"/>
</g>
<!-- layer_7_expert_4_ep_1 -->
<g id="node761" class="node">
<title>layer_7_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="198219.83,-269 197785.82,-269 197674.17,-165 198108.18,-165 198219.83,-269"/>
<text text-anchor="middle" x="197947" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="197947" y="-220" font-family="Arial" font-size="10.00">GPU: 148</text>
<text text-anchor="middle" x="197947" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="197947" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_4_ep_1 -->
<g id="edge1409" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M197737.84,-305.83C197763.29,-295.15 197790.22,-283.84 197815.98,-273.02"/>
<polygon fill="black" stroke="black" points="197817.55,-276.16 197825.42,-269.06 197814.84,-269.7 197817.55,-276.16"/>
</g>
<!-- layer_7_expert_5_ep_1 -->
<g id="node762" class="node">
<title>layer_7_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="198782.83,-269 198348.82,-269 198237.17,-165 198671.18,-165 198782.83,-269"/>
<text text-anchor="middle" x="198510" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="198510" y="-220" font-family="Arial" font-size="10.00">GPU: 149</text>
<text text-anchor="middle" x="198510" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="198510" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_5_ep_1 -->
<g id="edge1410" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M197814.36,-330.42C197934.52,-313.84 198090.77,-291.46 198229,-269 198258.48,-264.21 198289.64,-258.85 198320.06,-253.46"/>
<polygon fill="black" stroke="black" points="198320.68,-256.9 198329.91,-251.7 198319.45,-250.01 198320.68,-256.9"/>
</g>
<!-- layer_7_expert_6_ep_1 -->
<g id="node763" class="node">
<title>layer_7_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="199345.83,-269 198911.82,-269 198800.17,-165 199234.18,-165 199345.83,-269"/>
<text text-anchor="middle" x="199073" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="199073" y="-220" font-family="Arial" font-size="10.00">GPU: 150</text>
<text text-anchor="middle" x="199073" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="199073" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_6_ep_1 -->
<g id="edge1411" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M197833.7,-347.55C198070.28,-335.69 198459.07,-311.55 198792,-269 198822.07,-265.16 198853.8,-260.24 198884.68,-254.98"/>
<polygon fill="black" stroke="black" points="198885.42,-258.41 198894.68,-253.27 198884.23,-251.51 198885.42,-258.41"/>
</g>
<!-- layer_7_expert_7_ep_1 -->
<g id="node764" class="node">
<title>layer_7_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="199908.83,-269 199474.82,-269 199363.17,-165 199797.18,-165 199908.83,-269"/>
<text text-anchor="middle" x="199636" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="199636" y="-220" font-family="Arial" font-size="10.00">GPU: 151</text>
<text text-anchor="middle" x="199636" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="199636" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_1&#45;&gt;layer_7_expert_7_ep_1 -->
<g id="edge1412" class="edge">
<title>layer_7_route_ep_1&#45;&gt;layer_7_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M197841.88,-354.85C198174.32,-349.59 198814.46,-331.46 199355,-269 199385.22,-265.51 199417.1,-260.76 199448.1,-255.56"/>
<polygon fill="black" stroke="black" points="199448.86,-258.98 199458.13,-253.85 199447.69,-252.08 199448.86,-258.98"/>
</g>
<!-- layer_7_expert_0_ep_2 -->
<g id="node765" class="node">
<title>layer_7_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="186959.83,-269 186525.82,-269 186414.17,-165 186848.18,-165 186959.83,-269"/>
<text text-anchor="middle" x="186687" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="186687" y="-220" font-family="Arial" font-size="10.00">GPU: 160</text>
<text text-anchor="middle" x="186687" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="186687" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_0_ep_2 -->
<g id="edge1413" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M189479.75,-353.94C188911.74,-345.8 187471.59,-320.71 186969.32,-269.09"/>
<polygon fill="black" stroke="black" points="186969.39,-265.58 186959.08,-268.02 186968.66,-272.54 186969.39,-265.58"/>
</g>
<!-- layer_7_expert_1_ep_2 -->
<g id="node766" class="node">
<title>layer_7_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="187522.83,-269 187088.82,-269 186977.17,-165 187411.18,-165 187522.83,-269"/>
<text text-anchor="middle" x="187250" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="187250" y="-220" font-family="Arial" font-size="10.00">GPU: 161</text>
<text text-anchor="middle" x="187250" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="187250" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_1_ep_2 -->
<g id="edge1414" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M189476.92,-351.62C188996.39,-340.03 187921,-310.46 187531.9,-269.04"/>
<polygon fill="black" stroke="black" points="187532.03,-265.54 187521.71,-267.94 187531.28,-272.5 187532.03,-265.54"/>
</g>
<!-- layer_7_expert_2_ep_2 -->
<g id="node767" class="node">
<title>layer_7_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="188085.83,-269 187651.82,-269 187540.17,-165 187974.18,-165 188085.83,-269"/>
<text text-anchor="middle" x="187813" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="187813" y="-220" font-family="Arial" font-size="10.00">GPU: 162</text>
<text text-anchor="middle" x="187813" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="187813" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_2_ep_2 -->
<g id="edge1415" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M189479.14,-353.46C189165.45,-346.64 188592.5,-326.89 188094.98,-269.08"/>
<polygon fill="black" stroke="black" points="188095.06,-265.56 188084.72,-267.88 188094.24,-272.52 188095.06,-265.56"/>
</g>
<!-- layer_7_expert_3_ep_2 -->
<g id="node768" class="node">
<title>layer_7_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="188648.83,-269 188214.82,-269 188103.17,-165 188537.18,-165 188648.83,-269"/>
<text text-anchor="middle" x="188376" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="188376" y="-220" font-family="Arial" font-size="10.00">GPU: 163</text>
<text text-anchor="middle" x="188376" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="188376" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_3_ep_2 -->
<g id="edge1416" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M189467.66,-343.24C189255.5,-329.8 188941.05,-306.09 188657.8,-269.07"/>
<polygon fill="black" stroke="black" points="188658.1,-265.58 188647.73,-267.75 188657.19,-272.52 188658.1,-265.58"/>
</g>
<!-- layer_7_expert_4_ep_2 -->
<g id="node769" class="node">
<title>layer_7_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="189211.83,-269 188777.82,-269 188666.17,-165 189100.18,-165 189211.83,-269"/>
<text text-anchor="middle" x="188939" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="188939" y="-220" font-family="Arial" font-size="10.00">GPU: 164</text>
<text text-anchor="middle" x="188939" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="188939" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_4_ep_2 -->
<g id="edge1417" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M189426.63,-305.97C189358.86,-293.89 189286.88,-281.03 189220,-269 189219.9,-268.98 189219.79,-268.96 189219.69,-268.94"/>
<polygon fill="black" stroke="black" points="189220.52,-265.54 189210.06,-267.21 189219.28,-272.43 189220.52,-265.54"/>
</g>
<!-- layer_7_expert_5_ep_2 -->
<g id="node770" class="node">
<title>layer_7_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="189774.83,-269 189340.82,-269 189229.17,-165 189663.18,-165 189774.83,-269"/>
<text text-anchor="middle" x="189502" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="189502" y="-220" font-family="Arial" font-size="10.00">GPU: 165</text>
<text text-anchor="middle" x="189502" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="189502" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_5_ep_2 -->
<g id="edge1418" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M189635.96,-305.83C189620.52,-295.71 189604.23,-285.03 189588.53,-274.73"/>
<polygon fill="black" stroke="black" points="189590.15,-271.61 189579.87,-269.06 189586.32,-277.47 189590.15,-271.61"/>
</g>
<!-- layer_7_expert_6_ep_2 -->
<g id="node771" class="node">
<title>layer_7_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="190337.83,-269 189903.82,-269 189792.17,-165 190226.18,-165 190337.83,-269"/>
<text text-anchor="middle" x="190065" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="190065" y="-220" font-family="Arial" font-size="10.00">GPU: 166</text>
<text text-anchor="middle" x="190065" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="190065" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_6_ep_2 -->
<g id="edge1419" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M189843.2,-305.83C189870.31,-295.1 189899,-283.74 189926.42,-272.88"/>
<polygon fill="black" stroke="black" points="189928.06,-275.99 189936.07,-269.06 189925.48,-269.49 189928.06,-275.99"/>
</g>
<!-- layer_7_expert_7_ep_2 -->
<g id="node772" class="node">
<title>layer_7_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="190900.83,-269 190466.82,-269 190355.17,-165 190789.18,-165 190900.83,-269"/>
<text text-anchor="middle" x="190628" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="190628" y="-220" font-family="Arial" font-size="10.00">GPU: 167</text>
<text text-anchor="middle" x="190628" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="190628" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_2&#45;&gt;layer_7_expert_7_ep_2 -->
<g id="edge1420" class="edge">
<title>layer_7_route_ep_2&#45;&gt;layer_7_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M189913.53,-331.41C190038.3,-314.88 190202.25,-292.19 190347,-269 190376.6,-264.26 190407.89,-258.91 190438.42,-253.51"/>
<polygon fill="black" stroke="black" points="190439.07,-256.95 190448.3,-251.76 190437.85,-250.06 190439.07,-256.95"/>
</g>
<!-- layer_7_expert_0_ep_3 -->
<g id="node773" class="node">
<title>layer_7_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="204975.83,-269 204541.82,-269 204430.17,-165 204864.18,-165 204975.83,-269"/>
<text text-anchor="middle" x="204703" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="204703" y="-220" font-family="Arial" font-size="10.00">GPU: 176</text>
<text text-anchor="middle" x="204703" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="204703" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_0_ep_3 -->
<g id="edge1421" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M205269.52,-314.95C205178.44,-300.82 205076.83,-284.66 204984,-269 204983.9,-268.98 204983.79,-268.97 204983.69,-268.95"/>
<polygon fill="black" stroke="black" points="204984.48,-265.53 204974.04,-267.31 204983.31,-272.43 204984.48,-265.53"/>
</g>
<!-- layer_7_expert_1_ep_3 -->
<g id="node774" class="node">
<title>layer_7_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="205538.83,-269 205104.82,-269 204993.17,-165 205427.18,-165 205538.83,-269"/>
<text text-anchor="middle" x="205266" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="205266" y="-220" font-family="Arial" font-size="10.00">GPU: 177</text>
<text text-anchor="middle" x="205266" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="205266" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_1_ep_3 -->
<g id="edge1422" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M205444.19,-305.83C205422.9,-295.34 205400.38,-284.24 205378.78,-273.59"/>
<polygon fill="black" stroke="black" points="205380.1,-270.34 205369.59,-269.06 205377.01,-276.62 205380.1,-270.34"/>
</g>
<!-- layer_7_expert_2_ep_3 -->
<g id="node775" class="node">
<title>layer_7_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="206101.83,-269 205667.82,-269 205556.17,-165 205990.18,-165 206101.83,-269"/>
<text text-anchor="middle" x="205829" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="205829" y="-220" font-family="Arial" font-size="10.00">GPU: 178</text>
<text text-anchor="middle" x="205829" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="205829" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_2_ep_3 -->
<g id="edge1423" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M205651.44,-305.83C205672.66,-295.34 205695.1,-284.24 205716.62,-273.59"/>
<polygon fill="black" stroke="black" points="205718.37,-276.63 205725.78,-269.06 205715.27,-270.35 205718.37,-276.63"/>
</g>
<!-- layer_7_expert_3_ep_3 -->
<g id="node776" class="node">
<title>layer_7_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="206664.83,-269 206230.82,-269 206119.17,-165 206553.18,-165 206664.83,-269"/>
<text text-anchor="middle" x="206392" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="206392" y="-220" font-family="Arial" font-size="10.00">GPU: 179</text>
<text text-anchor="middle" x="206392" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="206392" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_3_ep_3 -->
<g id="edge1424" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M205743.28,-327.68C205851.7,-311.1 205988.94,-289.61 206111,-269 206140.45,-264.03 206171.59,-258.57 206202.01,-253.13"/>
<polygon fill="black" stroke="black" points="206202.63,-256.58 206211.85,-251.37 206201.39,-249.69 206202.63,-256.58"/>
</g>
<!-- layer_7_expert_4_ep_3 -->
<g id="node777" class="node">
<title>layer_7_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="207227.83,-269 206793.82,-269 206682.17,-165 207116.18,-165 207227.83,-269"/>
<text text-anchor="middle" x="206955" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="206955" y="-220" font-family="Arial" font-size="10.00">GPU: 180</text>
<text text-anchor="middle" x="206955" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="206955" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_4_ep_3 -->
<g id="edge1425" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M205764.53,-346.62C205991.75,-334.2 206358.98,-309.79 206674,-269 206704.06,-265.11 206735.79,-260.17 206766.67,-254.9"/>
<polygon fill="black" stroke="black" points="206767.41,-258.32 206776.67,-253.18 206766.22,-251.42 206767.41,-258.32"/>
</g>
<!-- layer_7_expert_5_ep_3 -->
<g id="node778" class="node">
<title>layer_7_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="207790.83,-269 207356.82,-269 207245.17,-165 207679.18,-165 207790.83,-269"/>
<text text-anchor="middle" x="207518" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="207518" y="-220" font-family="Arial" font-size="10.00">GPU: 181</text>
<text text-anchor="middle" x="207518" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="207518" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_5_ep_3 -->
<g id="edge1426" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M205773.47,-354.37C206098.04,-348.53 206715.29,-329.68 207237,-269 207267.22,-265.48 207299.1,-260.73 207330.1,-255.52"/>
<polygon fill="black" stroke="black" points="207330.86,-258.94 207340.13,-253.81 207329.69,-252.04 207330.86,-258.94"/>
</g>
<!-- layer_7_expert_6_ep_3 -->
<g id="node779" class="node">
<title>layer_7_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="208353.83,-269 207919.82,-269 207808.17,-165 208242.18,-165 208353.83,-269"/>
<text text-anchor="middle" x="208081" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="208081" y="-220" font-family="Arial" font-size="10.00">GPU: 182</text>
<text text-anchor="middle" x="208081" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="208081" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_6_ep_3 -->
<g id="edge1427" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M205771.05,-352.27C206259.66,-341.27 207411.79,-311.6 207800,-269 207830.35,-265.67 207862.36,-260.99 207893.48,-255.8"/>
<polygon fill="black" stroke="black" points="207894.27,-259.22 207903.55,-254.1 207893.1,-252.32 207894.27,-259.22"/>
</g>
<!-- layer_7_expert_7_ep_3 -->
<g id="node780" class="node">
<title>layer_7_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="208916.83,-269 208482.82,-269 208371.17,-165 208805.18,-165 208916.83,-269"/>
<text text-anchor="middle" x="208644" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="208644" y="-220" font-family="Arial" font-size="10.00">GPU: 183</text>
<text text-anchor="middle" x="208644" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="208644" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_3&#45;&gt;layer_7_expert_7_ep_3 -->
<g id="edge1428" class="edge">
<title>layer_7_route_ep_3&#45;&gt;layer_7_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M205773.24,-354.27C206348.73,-346.61 207862.86,-321.91 208363,-269 208393.48,-265.78 208425.62,-261.14 208456.84,-255.95"/>
<polygon fill="black" stroke="black" points="208457.67,-259.36 208466.95,-254.25 208456.5,-252.46 208457.67,-259.36"/>
</g>
<!-- layer_7_expert_0_ep_4 -->
<g id="node781" class="node">
<title>layer_7_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="209479.83,-269 209045.82,-269 208934.17,-165 209368.18,-165 209479.83,-269"/>
<text text-anchor="middle" x="209207" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="209207" y="-220" font-family="Arial" font-size="10.00">GPU: 192</text>
<text text-anchor="middle" x="209207" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="209207" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_0_ep_4 -->
<g id="edge1429" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M209773.52,-314.95C209682.44,-300.82 209580.83,-284.66 209488,-269 209487.9,-268.98 209487.79,-268.97 209487.69,-268.95"/>
<polygon fill="black" stroke="black" points="209488.48,-265.53 209478.04,-267.31 209487.31,-272.43 209488.48,-265.53"/>
</g>
<!-- layer_7_expert_1_ep_4 -->
<g id="node782" class="node">
<title>layer_7_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="210042.83,-269 209608.82,-269 209497.17,-165 209931.18,-165 210042.83,-269"/>
<text text-anchor="middle" x="209770" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="209770" y="-220" font-family="Arial" font-size="10.00">GPU: 193</text>
<text text-anchor="middle" x="209770" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="209770" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_1_ep_4 -->
<g id="edge1430" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M209948.19,-305.83C209926.9,-295.34 209904.38,-284.24 209882.78,-273.59"/>
<polygon fill="black" stroke="black" points="209884.1,-270.34 209873.59,-269.06 209881.01,-276.62 209884.1,-270.34"/>
</g>
<!-- layer_7_expert_2_ep_4 -->
<g id="node783" class="node">
<title>layer_7_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="210605.83,-269 210171.82,-269 210060.17,-165 210494.18,-165 210605.83,-269"/>
<text text-anchor="middle" x="210333" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="210333" y="-220" font-family="Arial" font-size="10.00">GPU: 194</text>
<text text-anchor="middle" x="210333" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="210333" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_2_ep_4 -->
<g id="edge1431" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M210155.44,-305.83C210176.66,-295.34 210199.1,-284.24 210220.62,-273.59"/>
<polygon fill="black" stroke="black" points="210222.37,-276.63 210229.78,-269.06 210219.27,-270.35 210222.37,-276.63"/>
</g>
<!-- layer_7_expert_3_ep_4 -->
<g id="node784" class="node">
<title>layer_7_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="211168.83,-269 210734.82,-269 210623.17,-165 211057.18,-165 211168.83,-269"/>
<text text-anchor="middle" x="210896" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="210896" y="-220" font-family="Arial" font-size="10.00">GPU: 195</text>
<text text-anchor="middle" x="210896" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="210896" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_3_ep_4 -->
<g id="edge1432" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M210247.28,-327.68C210355.7,-311.1 210492.94,-289.61 210615,-269 210644.45,-264.03 210675.59,-258.57 210706.01,-253.13"/>
<polygon fill="black" stroke="black" points="210706.63,-256.58 210715.85,-251.37 210705.39,-249.69 210706.63,-256.58"/>
</g>
<!-- layer_7_expert_4_ep_4 -->
<g id="node785" class="node">
<title>layer_7_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="211731.83,-269 211297.82,-269 211186.17,-165 211620.18,-165 211731.83,-269"/>
<text text-anchor="middle" x="211459" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="211459" y="-220" font-family="Arial" font-size="10.00">GPU: 196</text>
<text text-anchor="middle" x="211459" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="211459" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_4_ep_4 -->
<g id="edge1433" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M210268.53,-346.62C210495.75,-334.2 210862.98,-309.79 211178,-269 211208.06,-265.11 211239.79,-260.17 211270.67,-254.9"/>
<polygon fill="black" stroke="black" points="211271.41,-258.32 211280.67,-253.18 211270.22,-251.42 211271.41,-258.32"/>
</g>
<!-- layer_7_expert_5_ep_4 -->
<g id="node786" class="node">
<title>layer_7_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="212294.83,-269 211860.82,-269 211749.17,-165 212183.18,-165 212294.83,-269"/>
<text text-anchor="middle" x="212022" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="212022" y="-220" font-family="Arial" font-size="10.00">GPU: 197</text>
<text text-anchor="middle" x="212022" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="212022" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_5_ep_4 -->
<g id="edge1434" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M210277.47,-354.37C210602.04,-348.53 211219.29,-329.68 211741,-269 211771.22,-265.48 211803.1,-260.73 211834.1,-255.52"/>
<polygon fill="black" stroke="black" points="211834.86,-258.94 211844.13,-253.81 211833.69,-252.04 211834.86,-258.94"/>
</g>
<!-- layer_7_expert_6_ep_4 -->
<g id="node787" class="node">
<title>layer_7_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="212857.83,-269 212423.82,-269 212312.17,-165 212746.18,-165 212857.83,-269"/>
<text text-anchor="middle" x="212585" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="212585" y="-220" font-family="Arial" font-size="10.00">GPU: 198</text>
<text text-anchor="middle" x="212585" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="212585" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_6_ep_4 -->
<g id="edge1435" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M210275.05,-352.27C210763.66,-341.27 211915.79,-311.6 212304,-269 212334.35,-265.67 212366.36,-260.99 212397.48,-255.8"/>
<polygon fill="black" stroke="black" points="212398.27,-259.22 212407.55,-254.1 212397.1,-252.32 212398.27,-259.22"/>
</g>
<!-- layer_7_expert_7_ep_4 -->
<g id="node788" class="node">
<title>layer_7_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="213420.83,-269 212986.82,-269 212875.17,-165 213309.18,-165 213420.83,-269"/>
<text text-anchor="middle" x="213148" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="213148" y="-220" font-family="Arial" font-size="10.00">GPU: 199</text>
<text text-anchor="middle" x="213148" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="213148" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_4&#45;&gt;layer_7_expert_7_ep_4 -->
<g id="edge1436" class="edge">
<title>layer_7_route_ep_4&#45;&gt;layer_7_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M210277.24,-354.27C210852.73,-346.61 212366.86,-321.91 212867,-269 212897.48,-265.78 212929.62,-261.14 212960.84,-255.95"/>
<polygon fill="black" stroke="black" points="212961.67,-259.36 212970.95,-254.25 212960.5,-252.46 212961.67,-259.36"/>
</g>
<!-- layer_7_expert_0_ep_5 -->
<g id="node789" class="node">
<title>layer_7_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="213983.83,-269 213549.82,-269 213438.17,-165 213872.18,-165 213983.83,-269"/>
<text text-anchor="middle" x="213711" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="213711" y="-220" font-family="Arial" font-size="10.00">GPU: 208</text>
<text text-anchor="middle" x="213711" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="213711" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_0_ep_5 -->
<g id="edge1437" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M214090.56,-305.93C214041.83,-294.64 213990.08,-282.65 213940.97,-271.28"/>
<polygon fill="black" stroke="black" points="213941.72,-267.86 213931.19,-269.01 213940.14,-274.68 213941.72,-267.86"/>
</g>
<!-- layer_7_expert_1_ep_5 -->
<g id="node790" class="node">
<title>layer_7_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="214546.83,-269 214112.82,-269 214001.17,-165 214435.18,-165 214546.83,-269"/>
<text text-anchor="middle" x="214274" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="214274" y="-220" font-family="Arial" font-size="10.00">GPU: 209</text>
<text text-anchor="middle" x="214274" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="214274" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_1_ep_5 -->
<g id="edge1438" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M214297.33,-305.64C214295.02,-296.98 214292.61,-287.93 214290.25,-279.06"/>
<polygon fill="black" stroke="black" points="214293.57,-277.92 214287.62,-269.15 214286.81,-279.72 214293.57,-277.92"/>
</g>
<!-- layer_7_expert_2_ep_5 -->
<g id="node791" class="node">
<title>layer_7_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="215109.83,-269 214675.82,-269 214564.17,-165 214998.18,-165 215109.83,-269"/>
<text text-anchor="middle" x="214837" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="214837" y="-220" font-family="Arial" font-size="10.00">GPU: 210</text>
<text text-anchor="middle" x="214837" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="214837" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_2_ep_5 -->
<g id="edge1439" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M214486.88,-310.52C214542.1,-295.93 214603.1,-279.81 214658.5,-265.17"/>
<polygon fill="black" stroke="black" points="214659.64,-268.49 214668.42,-262.55 214657.85,-261.72 214659.64,-268.49"/>
</g>
<!-- layer_7_expert_3_ep_5 -->
<g id="node792" class="node">
<title>layer_7_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="215672.83,-269 215238.82,-269 215127.17,-165 215561.18,-165 215672.83,-269"/>
<text text-anchor="middle" x="215400" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="215400" y="-220" font-family="Arial" font-size="10.00">GPU: 211</text>
<text text-anchor="middle" x="215400" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="215400" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_3_ep_5 -->
<g id="edge1440" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M214518.67,-338.48C214682.18,-322.91 214915.64,-298.49 215119,-269 215148.78,-264.68 215180.22,-259.55 215210.88,-254.22"/>
<polygon fill="black" stroke="black" points="215211.55,-257.66 215220.8,-252.49 215210.35,-250.76 215211.55,-257.66"/>
</g>
<!-- layer_7_expert_4_ep_5 -->
<g id="node793" class="node">
<title>layer_7_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="216235.83,-269 215801.82,-269 215690.17,-165 216124.18,-165 216235.83,-269"/>
<text text-anchor="middle" x="215963" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="215963" y="-220" font-family="Arial" font-size="10.00">GPU: 212</text>
<text text-anchor="middle" x="215963" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="215963" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_4_ep_5 -->
<g id="edge1441" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M214521.25,-340.95C214688.35,-328.45 214928.07,-311.08 215138,-298 215379.65,-282.94 215441.52,-297.12 215682,-269 215712.22,-265.47 215744.09,-260.7 215775.09,-255.49"/>
<polygon fill="black" stroke="black" points="215775.85,-258.91 215785.13,-253.78 215774.68,-252.01 215775.85,-258.91"/>
</g>
<!-- layer_7_expert_5_ep_5 -->
<g id="node794" class="node">
<title>layer_7_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="216798.83,-269 216364.82,-269 216253.17,-165 216687.18,-165 216798.83,-269"/>
<text text-anchor="middle" x="216526" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="216526" y="-220" font-family="Arial" font-size="10.00">GPU: 213</text>
<text text-anchor="middle" x="216526" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="216526" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_5_ep_5 -->
<g id="edge1442" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M214519.45,-339.52C214686.58,-326.14 214927.2,-308.28 215138,-298 215629.59,-274.04 215755.43,-319.54 216245,-269 216275.48,-265.85 216307.63,-261.25 216338.86,-256.08"/>
<polygon fill="black" stroke="black" points="216339.68,-259.5 216348.96,-254.39 216338.52,-252.59 216339.68,-259.5"/>
</g>
<!-- layer_7_expert_6_ep_5 -->
<g id="node795" class="node">
<title>layer_7_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="217361.83,-269 216927.82,-269 216816.17,-165 217250.18,-165 217361.83,-269"/>
<text text-anchor="middle" x="217089" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="217089" y="-220" font-family="Arial" font-size="10.00">GPU: 214</text>
<text text-anchor="middle" x="217089" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="217089" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_6_ep_5 -->
<g id="edge1443" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M214518.98,-338.7C214686.1,-324.83 214926.95,-306.72 215138,-298 215508.85,-282.67 216438.75,-306.71 216808,-269 216838.49,-265.89 216870.64,-261.3 216901.86,-256.14"/>
<polygon fill="black" stroke="black" points="216902.68,-259.55 216911.97,-254.45 216901.52,-252.65 216902.68,-259.55"/>
</g>
<!-- layer_7_expert_7_ep_5 -->
<g id="node796" class="node">
<title>layer_7_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="217924.83,-269 217490.82,-269 217379.17,-165 217813.18,-165 217924.83,-269"/>
<text text-anchor="middle" x="217652" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="217652" y="-220" font-family="Arial" font-size="10.00">GPU: 215</text>
<text text-anchor="middle" x="217652" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="217652" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_5&#45;&gt;layer_7_expert_7_ep_5 -->
<g id="edge1444" class="edge">
<title>layer_7_route_ep_5&#45;&gt;layer_7_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M214518.54,-338.53C214685.68,-324.53 214926.75,-306.34 215138,-298 215633.88,-278.41 216877.21,-318.48 217371,-269 217401.49,-265.94 217433.64,-261.39 217464.87,-256.24"/>
<polygon fill="black" stroke="black" points="217465.69,-259.65 217474.98,-254.55 217464.54,-252.75 217465.69,-259.65"/>
</g>
<!-- layer_7_expert_0_ep_6 -->
<g id="node797" class="node">
<title>layer_7_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="182455.83,-269 182021.82,-269 181910.17,-165 182344.18,-165 182455.83,-269"/>
<text text-anchor="middle" x="182183" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="182183" y="-220" font-family="Arial" font-size="10.00">GPU: 224</text>
<text text-anchor="middle" x="182183" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="182183" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_0_ep_6 -->
<g id="edge1445" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M185046.21,-354.16C184468.12,-346.43 182981.66,-321.99 182465.23,-269.08"/>
<polygon fill="black" stroke="black" points="182465.39,-265.58 182455.08,-268.02 182464.66,-272.54 182465.39,-265.58"/>
</g>
<!-- layer_7_expert_1_ep_6 -->
<g id="node798" class="node">
<title>layer_7_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="183018.83,-269 182584.82,-269 182473.17,-165 182907.18,-165 183018.83,-269"/>
<text text-anchor="middle" x="182746" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="182746" y="-220" font-family="Arial" font-size="10.00">GPU: 225</text>
<text text-anchor="middle" x="182746" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="182746" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_1_ep_6 -->
<g id="edge1446" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M185043.37,-351.97C184551.27,-340.83 183430.66,-311.72 183027.68,-269.02"/>
<polygon fill="black" stroke="black" points="183028.03,-265.54 183017.71,-267.95 183027.28,-272.5 183028.03,-265.54"/>
</g>
<!-- layer_7_expert_2_ep_6 -->
<g id="node799" class="node">
<title>layer_7_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="183581.83,-269 183147.82,-269 183036.17,-165 183470.18,-165 183581.83,-269"/>
<text text-anchor="middle" x="183309" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="183309" y="-220" font-family="Arial" font-size="10.00">GPU: 226</text>
<text text-anchor="middle" x="183309" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="183309" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_2_ep_6 -->
<g id="edge1447" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M185046.16,-354.23C184721.36,-348.26 184115.39,-329.44 183590.76,-269.05"/>
<polygon fill="black" stroke="black" points="183591.05,-265.56 183580.72,-267.89 183590.25,-272.51 183591.05,-265.56"/>
</g>
<!-- layer_7_expert_3_ep_6 -->
<g id="node800" class="node">
<title>layer_7_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="184144.83,-269 183710.82,-269 183599.17,-165 184033.18,-165 184144.83,-269"/>
<text text-anchor="middle" x="183872" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="183872" y="-220" font-family="Arial" font-size="10.00">GPU: 227</text>
<text text-anchor="middle" x="183872" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="183872" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_3_ep_6 -->
<g id="edge1448" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M185035.79,-345.11C184809.47,-332.41 184463.42,-308.72 184153.8,-269.07"/>
<polygon fill="black" stroke="black" points="184154.1,-265.58 184143.73,-267.77 184153.2,-272.52 184154.1,-265.58"/>
</g>
<!-- layer_7_expert_4_ep_6 -->
<g id="node801" class="node">
<title>layer_7_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="184707.83,-269 184273.82,-269 184162.17,-165 184596.18,-165 184707.83,-269"/>
<text text-anchor="middle" x="184435" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="184435" y="-220" font-family="Arial" font-size="10.00">GPU: 228</text>
<text text-anchor="middle" x="184435" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="184435" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_4_ep_6 -->
<g id="edge1449" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M185001.52,-314.95C184910.44,-300.82 184808.83,-284.66 184716,-269 184715.9,-268.98 184715.79,-268.97 184715.69,-268.95"/>
<polygon fill="black" stroke="black" points="184716.48,-265.53 184706.04,-267.31 184715.31,-272.43 184716.48,-265.53"/>
</g>
<!-- layer_7_expert_5_ep_6 -->
<g id="node802" class="node">
<title>layer_7_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="185270.83,-269 184836.82,-269 184725.17,-165 185159.18,-165 185270.83,-269"/>
<text text-anchor="middle" x="184998" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="184998" y="-220" font-family="Arial" font-size="10.00">GPU: 229</text>
<text text-anchor="middle" x="184998" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="184998" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_5_ep_6 -->
<g id="edge1450" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M185176.19,-305.83C185154.9,-295.34 185132.38,-284.24 185110.78,-273.59"/>
<polygon fill="black" stroke="black" points="185112.1,-270.34 185101.59,-269.06 185109.01,-276.62 185112.1,-270.34"/>
</g>
<!-- layer_7_expert_6_ep_6 -->
<g id="node803" class="node">
<title>layer_7_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="185833.83,-269 185399.82,-269 185288.17,-165 185722.18,-165 185833.83,-269"/>
<text text-anchor="middle" x="185561" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="185561" y="-220" font-family="Arial" font-size="10.00">GPU: 230</text>
<text text-anchor="middle" x="185561" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="185561" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_6_ep_6 -->
<g id="edge1451" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M185383.44,-305.83C185404.66,-295.34 185427.1,-284.24 185448.62,-273.59"/>
<polygon fill="black" stroke="black" points="185450.37,-276.63 185457.78,-269.06 185447.27,-270.35 185450.37,-276.63"/>
</g>
<!-- layer_7_expert_7_ep_6 -->
<g id="node804" class="node">
<title>layer_7_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="186396.83,-269 185962.82,-269 185851.17,-165 186285.18,-165 186396.83,-269"/>
<text text-anchor="middle" x="186124" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="186124" y="-220" font-family="Arial" font-size="10.00">GPU: 231</text>
<text text-anchor="middle" x="186124" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="186124" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_6&#45;&gt;layer_7_expert_7_ep_6 -->
<g id="edge1452" class="edge">
<title>layer_7_route_ep_6&#45;&gt;layer_7_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M185475.28,-327.68C185583.7,-311.1 185720.94,-289.61 185843,-269 185872.45,-264.03 185903.59,-258.57 185934.01,-253.13"/>
<polygon fill="black" stroke="black" points="185934.63,-256.58 185943.85,-251.37 185933.39,-249.69 185934.63,-256.58"/>
</g>
<!-- layer_7_expert_0_ep_7 -->
<g id="node805" class="node">
<title>layer_7_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="191463.83,-269 191029.82,-269 190918.17,-165 191352.18,-165 191463.83,-269"/>
<text text-anchor="middle" x="191191" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="191191" y="-220" font-family="Arial" font-size="10.00">GPU: 240</text>
<text text-anchor="middle" x="191191" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="191191" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_0_ep_7 -->
<g id="edge1453" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M193989.77,-353.96C193420.88,-345.85 191976.85,-320.82 191473.34,-269.09"/>
<polygon fill="black" stroke="black" points="191473.39,-265.58 191463.08,-268.02 191472.66,-272.54 191473.39,-265.58"/>
</g>
<!-- layer_7_expert_1_ep_7 -->
<g id="node806" class="node">
<title>layer_7_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="192026.83,-269 191592.82,-269 191481.17,-165 191915.18,-165 192026.83,-269"/>
<text text-anchor="middle" x="191754" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="191754" y="-220" font-family="Arial" font-size="10.00">GPU: 241</text>
<text text-anchor="middle" x="191754" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="191754" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_1_ep_7 -->
<g id="edge1454" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M193987.19,-351.65C193505.8,-340.11 192426.33,-310.57 192035.93,-269.05"/>
<polygon fill="black" stroke="black" points="192036.03,-265.54 192025.71,-267.94 192035.28,-272.5 192036.03,-265.54"/>
</g>
<!-- layer_7_expert_2_ep_7 -->
<g id="node807" class="node">
<title>layer_7_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="192589.83,-269 192155.82,-269 192044.17,-165 192478.18,-165 192589.83,-269"/>
<text text-anchor="middle" x="192317" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="192317" y="-220" font-family="Arial" font-size="10.00">GPU: 242</text>
<text text-anchor="middle" x="192317" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="192317" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_2_ep_7 -->
<g id="edge1455" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M193989.29,-353.53C193674.58,-346.78 193098.6,-327.1 192598.66,-269.04"/>
<polygon fill="black" stroke="black" points="192599.06,-265.56 192588.72,-267.88 192598.24,-272.52 192599.06,-265.56"/>
</g>
<!-- layer_7_expert_3_ep_7 -->
<g id="node808" class="node">
<title>layer_7_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="193152.83,-269 192718.82,-269 192607.17,-165 193041.18,-165 193152.83,-269"/>
<text text-anchor="middle" x="192880" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="192880" y="-220" font-family="Arial" font-size="10.00">GPU: 243</text>
<text text-anchor="middle" x="192880" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="192880" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_3_ep_7 -->
<g id="edge1456" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M193977.87,-343.41C193764.48,-330.03 193447.36,-306.32 193161.88,-269.08"/>
<polygon fill="black" stroke="black" points="193162.1,-265.58 193151.73,-267.75 193161.19,-272.52 193162.1,-265.58"/>
</g>
<!-- layer_7_expert_4_ep_7 -->
<g id="node809" class="node">
<title>layer_7_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="193715.83,-269 193281.82,-269 193170.17,-165 193604.18,-165 193715.83,-269"/>
<text text-anchor="middle" x="193443" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="193443" y="-220" font-family="Arial" font-size="10.00">GPU: 244</text>
<text text-anchor="middle" x="193443" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="193443" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_4_ep_7 -->
<g id="edge1457" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M193936.09,-306.6C193866.63,-294.36 193792.65,-281.27 193724,-269 193723.9,-268.98 193723.79,-268.96 193723.69,-268.94"/>
<polygon fill="black" stroke="black" points="193724.52,-265.54 193714.05,-267.22 193723.28,-272.43 193724.52,-265.54"/>
</g>
<!-- layer_7_expert_5_ep_7 -->
<g id="node810" class="node">
<title>layer_7_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="194278.83,-269 193844.82,-269 193733.17,-165 194167.18,-165 194278.83,-269"/>
<text text-anchor="middle" x="194006" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="194006" y="-220" font-family="Arial" font-size="10.00">GPU: 245</text>
<text text-anchor="middle" x="194006" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="194006" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_5_ep_7 -->
<g id="edge1458" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M194143.75,-305.83C194127.73,-295.62 194110.81,-284.83 194094.53,-274.45"/>
<polygon fill="black" stroke="black" points="194096.39,-271.48 194086.08,-269.06 194092.63,-277.39 194096.39,-271.48"/>
</g>
<!-- layer_7_expert_6_ep_7 -->
<g id="node811" class="node">
<title>layer_7_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="194841.83,-269 194407.82,-269 194296.17,-165 194730.18,-165 194841.83,-269"/>
<text text-anchor="middle" x="194569" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="194569" y="-220" font-family="Arial" font-size="10.00">GPU: 246</text>
<text text-anchor="middle" x="194569" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="194569" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_6_ep_7 -->
<g id="edge1459" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M194351,-305.83C194377.63,-295.1 194405.83,-283.74 194432.79,-272.88"/>
<polygon fill="black" stroke="black" points="194434.31,-276.04 194442.27,-269.06 194431.69,-269.55 194434.31,-276.04"/>
</g>
<!-- layer_7_expert_7_ep_7 -->
<g id="node812" class="node">
<title>layer_7_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="195404.83,-269 194970.82,-269 194859.17,-165 195293.18,-165 195404.83,-269"/>
<text text-anchor="middle" x="195132" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="195132" y="-220" font-family="Arial" font-size="10.00">GPU: 247</text>
<text text-anchor="middle" x="195132" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="195132" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_7_route_ep_7&#45;&gt;layer_7_expert_7_ep_7 -->
<g id="edge1460" class="edge">
<title>layer_7_route_ep_7&#45;&gt;layer_7_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M194423.03,-331.14C194546.44,-314.59 194708.15,-291.98 194851,-269 194880.48,-264.26 194911.65,-258.92 194942.07,-253.54"/>
<polygon fill="black" stroke="black" points="194942.69,-256.98 194951.92,-251.79 194941.46,-250.09 194942.69,-256.98"/>
</g>
<!-- layer_7_agg_ep_0 -->
<g id="node813" class="node">
<title>layer_7_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="202734.07,-128 202283.77,-128 202167.93,-24 202618.23,-24 202734.07,-128"/>
<text text-anchor="middle" x="202451" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="202451" y="-79" font-family="Arial" font-size="10.00">GPU: 128&#45;143</text>
<text text-anchor="middle" x="202451" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="202451" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1461" class="edge">
<title>layer_7_expert_0_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M200371.37,-175.09C200407.1,-167.94 200444.63,-161.4 200480,-157 200810.43,-115.9 201776.09,-91.08 202221.31,-81.52"/>
<polygon fill="black" stroke="black" points="202221.48,-85.02 202231.4,-81.31 202221.33,-78.02 202221.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1462" class="edge">
<title>layer_7_expert_1_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M200934.8,-175.46C200970.41,-168.31 201007.79,-161.67 201043,-157 201454.77,-102.39 201939.14,-85.03 202219.05,-79.53"/>
<polygon fill="black" stroke="black" points="202219.4,-83.02 202229.33,-79.33 202219.26,-76.02 202219.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1463" class="edge">
<title>layer_7_expert_2_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M201498.7,-176.34C201534.07,-169.17 201571.13,-162.29 201606,-157 201817.23,-124.93 202060.24,-103.53 202231.27,-90.99"/>
<polygon fill="black" stroke="black" points="202231.69,-94.47 202241.41,-90.25 202231.18,-87.49 202231.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1464" class="edge">
<title>layer_7_expert_3_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M202058.83,-173.82C202124.06,-157.72 202198.72,-139.29 202265.27,-122.86"/>
<polygon fill="black" stroke="black" points="202266.15,-126.24 202275.02,-120.45 202264.48,-119.45 202266.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1465" class="edge">
<title>layer_7_expert_4_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M202451,-164.64C202451,-156.08 202451,-147.12 202451,-138.34"/>
<polygon fill="black" stroke="black" points="202454.5,-138.15 202451,-128.15 202447.5,-138.15 202454.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1466" class="edge">
<title>layer_7_expert_5_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M202807.16,-164.93C202761.62,-153.69 202713.27,-141.75 202667.37,-130.42"/>
<polygon fill="black" stroke="black" points="202668.16,-127.01 202657.61,-128.01 202666.48,-133.81 202668.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1467" class="edge">
<title>layer_7_expert_6_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M203343.92,-164.97C203327.74,-162.07 203311.65,-159.38 203296,-157 203098.52,-127.02 202873.26,-106.36 202705.01,-93.55"/>
<polygon fill="black" stroke="black" points="202705.26,-90.06 202695.02,-92.8 202704.73,-97.04 202705.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_0&#45;&gt;layer_7_agg_ep_0 -->
<g id="edge1468" class="edge">
<title>layer_7_expert_7_ep_0&#45;&gt;layer_7_agg_ep_0</title>
<path fill="none" stroke="black" d="M203910.84,-164.94C203893.35,-161.94 203875.92,-159.24 203859,-157 203450.97,-102.88 202971.66,-85.34 202690.64,-79.68"/>
<polygon fill="black" stroke="black" points="202690.38,-76.17 202680.32,-79.47 202690.24,-83.17 202690.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_1 -->
<g id="node814" class="node">
<title>layer_7_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="198230.07,-128 197779.77,-128 197663.93,-24 198114.23,-24 198230.07,-128"/>
<text text-anchor="middle" x="197947" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="197947" y="-79" font-family="Arial" font-size="10.00">GPU: 144&#45;159</text>
<text text-anchor="middle" x="197947" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="197947" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1470" class="edge">
<title>layer_7_expert_0_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M195867.37,-175.09C195903.1,-167.94 195940.63,-161.4 195976,-157 196306.43,-115.9 197272.09,-91.08 197717.31,-81.52"/>
<polygon fill="black" stroke="black" points="197717.48,-85.02 197727.4,-81.31 197717.33,-78.02 197717.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1471" class="edge">
<title>layer_7_expert_1_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M196430.8,-175.46C196466.41,-168.31 196503.79,-161.67 196539,-157 196950.77,-102.39 197435.14,-85.03 197715.05,-79.53"/>
<polygon fill="black" stroke="black" points="197715.4,-83.02 197725.33,-79.33 197715.26,-76.02 197715.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1472" class="edge">
<title>layer_7_expert_2_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M196994.7,-176.34C197030.07,-169.17 197067.13,-162.29 197102,-157 197313.23,-124.93 197556.24,-103.53 197727.27,-90.99"/>
<polygon fill="black" stroke="black" points="197727.69,-94.47 197737.41,-90.25 197727.18,-87.49 197727.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1473" class="edge">
<title>layer_7_expert_3_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M197554.83,-173.82C197620.06,-157.72 197694.72,-139.29 197761.27,-122.86"/>
<polygon fill="black" stroke="black" points="197762.15,-126.24 197771.02,-120.45 197760.48,-119.45 197762.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1474" class="edge">
<title>layer_7_expert_4_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M197947,-164.64C197947,-156.08 197947,-147.12 197947,-138.34"/>
<polygon fill="black" stroke="black" points="197950.5,-138.15 197947,-128.15 197943.5,-138.15 197950.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1475" class="edge">
<title>layer_7_expert_5_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M198303.16,-164.93C198257.62,-153.69 198209.27,-141.75 198163.37,-130.42"/>
<polygon fill="black" stroke="black" points="198164.16,-127.01 198153.61,-128.01 198162.48,-133.81 198164.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1476" class="edge">
<title>layer_7_expert_6_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M198839.92,-164.97C198823.74,-162.07 198807.65,-159.38 198792,-157 198594.52,-127.02 198369.26,-106.36 198201.01,-93.55"/>
<polygon fill="black" stroke="black" points="198201.26,-90.06 198191.02,-92.8 198200.73,-97.04 198201.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_1&#45;&gt;layer_7_agg_ep_1 -->
<g id="edge1477" class="edge">
<title>layer_7_expert_7_ep_1&#45;&gt;layer_7_agg_ep_1</title>
<path fill="none" stroke="black" d="M199406.84,-164.94C199389.35,-161.94 199371.92,-159.24 199355,-157 198946.97,-102.88 198467.66,-85.34 198186.64,-79.68"/>
<polygon fill="black" stroke="black" points="198186.38,-76.17 198176.32,-79.47 198186.24,-83.17 198186.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_2 -->
<g id="node815" class="node">
<title>layer_7_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="189222.07,-128 188771.77,-128 188655.93,-24 189106.23,-24 189222.07,-128"/>
<text text-anchor="middle" x="188939" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="188939" y="-79" font-family="Arial" font-size="10.00">GPU: 160&#45;175</text>
<text text-anchor="middle" x="188939" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="188939" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1479" class="edge">
<title>layer_7_expert_0_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M186859.37,-175.09C186895.1,-167.94 186932.63,-161.4 186968,-157 187298.43,-115.9 188264.09,-91.08 188709.31,-81.52"/>
<polygon fill="black" stroke="black" points="188709.48,-85.02 188719.4,-81.31 188709.33,-78.02 188709.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1480" class="edge">
<title>layer_7_expert_1_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M187422.8,-175.46C187458.41,-168.31 187495.79,-161.67 187531,-157 187942.77,-102.39 188427.14,-85.03 188707.05,-79.53"/>
<polygon fill="black" stroke="black" points="188707.4,-83.02 188717.33,-79.33 188707.26,-76.02 188707.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1481" class="edge">
<title>layer_7_expert_2_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M187986.7,-176.34C188022.07,-169.17 188059.13,-162.29 188094,-157 188305.23,-124.93 188548.24,-103.53 188719.27,-90.99"/>
<polygon fill="black" stroke="black" points="188719.69,-94.47 188729.41,-90.25 188719.18,-87.49 188719.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1482" class="edge">
<title>layer_7_expert_3_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M188546.83,-173.82C188612.06,-157.72 188686.72,-139.29 188753.27,-122.86"/>
<polygon fill="black" stroke="black" points="188754.15,-126.24 188763.02,-120.45 188752.48,-119.45 188754.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1483" class="edge">
<title>layer_7_expert_4_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M188939,-164.64C188939,-156.08 188939,-147.12 188939,-138.34"/>
<polygon fill="black" stroke="black" points="188942.5,-138.15 188939,-128.15 188935.5,-138.15 188942.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1484" class="edge">
<title>layer_7_expert_5_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M189295.16,-164.93C189249.62,-153.69 189201.27,-141.75 189155.37,-130.42"/>
<polygon fill="black" stroke="black" points="189156.16,-127.01 189145.61,-128.01 189154.48,-133.81 189156.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1485" class="edge">
<title>layer_7_expert_6_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M189831.92,-164.97C189815.74,-162.07 189799.65,-159.38 189784,-157 189586.52,-127.02 189361.26,-106.36 189193.01,-93.55"/>
<polygon fill="black" stroke="black" points="189193.26,-90.06 189183.02,-92.8 189192.73,-97.04 189193.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_2&#45;&gt;layer_7_agg_ep_2 -->
<g id="edge1486" class="edge">
<title>layer_7_expert_7_ep_2&#45;&gt;layer_7_agg_ep_2</title>
<path fill="none" stroke="black" d="M190398.84,-164.94C190381.35,-161.94 190363.92,-159.24 190347,-157 189938.97,-102.88 189459.66,-85.34 189178.64,-79.68"/>
<polygon fill="black" stroke="black" points="189178.38,-76.17 189168.32,-79.47 189178.24,-83.17 189178.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_3 -->
<g id="node816" class="node">
<title>layer_7_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="207238.07,-128 206787.77,-128 206671.93,-24 207122.23,-24 207238.07,-128"/>
<text text-anchor="middle" x="206955" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="206955" y="-79" font-family="Arial" font-size="10.00">GPU: 176&#45;191</text>
<text text-anchor="middle" x="206955" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="206955" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1488" class="edge">
<title>layer_7_expert_0_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M204875.37,-175.09C204911.1,-167.94 204948.63,-161.4 204984,-157 205314.43,-115.9 206280.09,-91.08 206725.31,-81.52"/>
<polygon fill="black" stroke="black" points="206725.48,-85.02 206735.4,-81.31 206725.33,-78.02 206725.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1489" class="edge">
<title>layer_7_expert_1_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M205438.8,-175.46C205474.41,-168.31 205511.79,-161.67 205547,-157 205958.77,-102.39 206443.14,-85.03 206723.05,-79.53"/>
<polygon fill="black" stroke="black" points="206723.4,-83.02 206733.33,-79.33 206723.26,-76.02 206723.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1490" class="edge">
<title>layer_7_expert_2_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M206002.7,-176.34C206038.07,-169.17 206075.13,-162.29 206110,-157 206321.23,-124.93 206564.24,-103.53 206735.27,-90.99"/>
<polygon fill="black" stroke="black" points="206735.69,-94.47 206745.41,-90.25 206735.18,-87.49 206735.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1491" class="edge">
<title>layer_7_expert_3_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M206562.83,-173.82C206628.06,-157.72 206702.72,-139.29 206769.27,-122.86"/>
<polygon fill="black" stroke="black" points="206770.15,-126.24 206779.02,-120.45 206768.48,-119.45 206770.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1492" class="edge">
<title>layer_7_expert_4_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M206955,-164.64C206955,-156.08 206955,-147.12 206955,-138.34"/>
<polygon fill="black" stroke="black" points="206958.5,-138.15 206955,-128.15 206951.5,-138.15 206958.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1493" class="edge">
<title>layer_7_expert_5_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M207311.16,-164.93C207265.62,-153.69 207217.27,-141.75 207171.37,-130.42"/>
<polygon fill="black" stroke="black" points="207172.16,-127.01 207161.61,-128.01 207170.48,-133.81 207172.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1494" class="edge">
<title>layer_7_expert_6_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M207847.92,-164.97C207831.74,-162.07 207815.65,-159.38 207800,-157 207602.52,-127.02 207377.26,-106.36 207209.01,-93.55"/>
<polygon fill="black" stroke="black" points="207209.26,-90.06 207199.02,-92.8 207208.73,-97.04 207209.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_3&#45;&gt;layer_7_agg_ep_3 -->
<g id="edge1495" class="edge">
<title>layer_7_expert_7_ep_3&#45;&gt;layer_7_agg_ep_3</title>
<path fill="none" stroke="black" d="M208414.84,-164.94C208397.35,-161.94 208379.92,-159.24 208363,-157 207954.97,-102.88 207475.66,-85.34 207194.64,-79.68"/>
<polygon fill="black" stroke="black" points="207194.38,-76.17 207184.32,-79.47 207194.24,-83.17 207194.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_4 -->
<g id="node817" class="node">
<title>layer_7_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="211742.07,-128 211291.77,-128 211175.93,-24 211626.23,-24 211742.07,-128"/>
<text text-anchor="middle" x="211459" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="211459" y="-79" font-family="Arial" font-size="10.00">GPU: 192&#45;207</text>
<text text-anchor="middle" x="211459" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="211459" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1497" class="edge">
<title>layer_7_expert_0_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M209379.37,-175.09C209415.1,-167.94 209452.63,-161.4 209488,-157 209818.43,-115.9 210784.09,-91.08 211229.31,-81.52"/>
<polygon fill="black" stroke="black" points="211229.48,-85.02 211239.4,-81.31 211229.33,-78.02 211229.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1498" class="edge">
<title>layer_7_expert_1_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M209942.8,-175.46C209978.41,-168.31 210015.79,-161.67 210051,-157 210462.77,-102.39 210947.14,-85.03 211227.05,-79.53"/>
<polygon fill="black" stroke="black" points="211227.4,-83.02 211237.33,-79.33 211227.26,-76.02 211227.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1499" class="edge">
<title>layer_7_expert_2_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M210506.7,-176.34C210542.07,-169.17 210579.13,-162.29 210614,-157 210825.23,-124.93 211068.24,-103.53 211239.27,-90.99"/>
<polygon fill="black" stroke="black" points="211239.69,-94.47 211249.41,-90.25 211239.18,-87.49 211239.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1500" class="edge">
<title>layer_7_expert_3_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M211066.83,-173.82C211132.06,-157.72 211206.72,-139.29 211273.27,-122.86"/>
<polygon fill="black" stroke="black" points="211274.15,-126.24 211283.02,-120.45 211272.48,-119.45 211274.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1501" class="edge">
<title>layer_7_expert_4_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M211459,-164.64C211459,-156.08 211459,-147.12 211459,-138.34"/>
<polygon fill="black" stroke="black" points="211462.5,-138.15 211459,-128.15 211455.5,-138.15 211462.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1502" class="edge">
<title>layer_7_expert_5_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M211815.16,-164.93C211769.62,-153.69 211721.27,-141.75 211675.37,-130.42"/>
<polygon fill="black" stroke="black" points="211676.16,-127.01 211665.61,-128.01 211674.48,-133.81 211676.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1503" class="edge">
<title>layer_7_expert_6_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M212351.92,-164.97C212335.74,-162.07 212319.65,-159.38 212304,-157 212106.52,-127.02 211881.26,-106.36 211713.01,-93.55"/>
<polygon fill="black" stroke="black" points="211713.26,-90.06 211703.02,-92.8 211712.73,-97.04 211713.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_4&#45;&gt;layer_7_agg_ep_4 -->
<g id="edge1504" class="edge">
<title>layer_7_expert_7_ep_4&#45;&gt;layer_7_agg_ep_4</title>
<path fill="none" stroke="black" d="M212918.84,-164.94C212901.35,-161.94 212883.92,-159.24 212867,-157 212458.97,-102.88 211979.66,-85.34 211698.64,-79.68"/>
<polygon fill="black" stroke="black" points="211698.38,-76.17 211688.32,-79.47 211698.24,-83.17 211698.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_5 -->
<g id="node818" class="node">
<title>layer_7_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="216246.07,-128 215795.77,-128 215679.93,-24 216130.23,-24 216246.07,-128"/>
<text text-anchor="middle" x="215963" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="215963" y="-79" font-family="Arial" font-size="10.00">GPU: 208&#45;223</text>
<text text-anchor="middle" x="215963" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="215963" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1506" class="edge">
<title>layer_7_expert_0_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M213883.37,-175.09C213919.1,-167.94 213956.63,-161.4 213992,-157 214322.43,-115.9 215288.09,-91.08 215733.31,-81.52"/>
<polygon fill="black" stroke="black" points="215733.48,-85.02 215743.4,-81.31 215733.33,-78.02 215733.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1507" class="edge">
<title>layer_7_expert_1_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M214446.8,-175.46C214482.41,-168.31 214519.79,-161.67 214555,-157 214966.77,-102.39 215451.14,-85.03 215731.05,-79.53"/>
<polygon fill="black" stroke="black" points="215731.4,-83.02 215741.33,-79.33 215731.26,-76.02 215731.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1508" class="edge">
<title>layer_7_expert_2_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M215010.7,-176.34C215046.07,-169.17 215083.13,-162.29 215118,-157 215329.23,-124.93 215572.24,-103.53 215743.27,-90.99"/>
<polygon fill="black" stroke="black" points="215743.69,-94.47 215753.41,-90.25 215743.18,-87.49 215743.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1509" class="edge">
<title>layer_7_expert_3_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M215570.83,-173.82C215636.06,-157.72 215710.72,-139.29 215777.27,-122.86"/>
<polygon fill="black" stroke="black" points="215778.15,-126.24 215787.02,-120.45 215776.48,-119.45 215778.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1510" class="edge">
<title>layer_7_expert_4_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M215963,-164.64C215963,-156.08 215963,-147.12 215963,-138.34"/>
<polygon fill="black" stroke="black" points="215966.5,-138.15 215963,-128.15 215959.5,-138.15 215966.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1511" class="edge">
<title>layer_7_expert_5_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M216319.16,-164.93C216273.62,-153.69 216225.27,-141.75 216179.37,-130.42"/>
<polygon fill="black" stroke="black" points="216180.16,-127.01 216169.61,-128.01 216178.48,-133.81 216180.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1512" class="edge">
<title>layer_7_expert_6_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M216855.92,-164.97C216839.74,-162.07 216823.65,-159.38 216808,-157 216610.52,-127.02 216385.26,-106.36 216217.01,-93.55"/>
<polygon fill="black" stroke="black" points="216217.26,-90.06 216207.02,-92.8 216216.73,-97.04 216217.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_5&#45;&gt;layer_7_agg_ep_5 -->
<g id="edge1513" class="edge">
<title>layer_7_expert_7_ep_5&#45;&gt;layer_7_agg_ep_5</title>
<path fill="none" stroke="black" d="M217422.84,-164.94C217405.35,-161.94 217387.92,-159.24 217371,-157 216962.97,-102.88 216483.66,-85.34 216202.64,-79.68"/>
<polygon fill="black" stroke="black" points="216202.38,-76.17 216192.32,-79.47 216202.24,-83.17 216202.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_6 -->
<g id="node819" class="node">
<title>layer_7_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="184718.07,-128 184267.77,-128 184151.93,-24 184602.23,-24 184718.07,-128"/>
<text text-anchor="middle" x="184435" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="184435" y="-79" font-family="Arial" font-size="10.00">GPU: 224&#45;239</text>
<text text-anchor="middle" x="184435" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="184435" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1515" class="edge">
<title>layer_7_expert_0_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M182355.37,-175.09C182391.1,-167.94 182428.63,-161.4 182464,-157 182794.43,-115.9 183760.09,-91.08 184205.31,-81.52"/>
<polygon fill="black" stroke="black" points="184205.48,-85.02 184215.4,-81.31 184205.33,-78.02 184205.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1516" class="edge">
<title>layer_7_expert_1_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M182918.8,-175.46C182954.41,-168.31 182991.79,-161.67 183027,-157 183438.77,-102.39 183923.14,-85.03 184203.05,-79.53"/>
<polygon fill="black" stroke="black" points="184203.4,-83.02 184213.33,-79.33 184203.26,-76.02 184203.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1517" class="edge">
<title>layer_7_expert_2_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M183482.7,-176.34C183518.07,-169.17 183555.13,-162.29 183590,-157 183801.23,-124.93 184044.24,-103.53 184215.27,-90.99"/>
<polygon fill="black" stroke="black" points="184215.69,-94.47 184225.41,-90.25 184215.18,-87.49 184215.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1518" class="edge">
<title>layer_7_expert_3_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M184042.83,-173.82C184108.06,-157.72 184182.72,-139.29 184249.27,-122.86"/>
<polygon fill="black" stroke="black" points="184250.15,-126.24 184259.02,-120.45 184248.48,-119.45 184250.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1519" class="edge">
<title>layer_7_expert_4_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M184435,-164.64C184435,-156.08 184435,-147.12 184435,-138.34"/>
<polygon fill="black" stroke="black" points="184438.5,-138.15 184435,-128.15 184431.5,-138.15 184438.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1520" class="edge">
<title>layer_7_expert_5_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M184791.16,-164.93C184745.62,-153.69 184697.27,-141.75 184651.37,-130.42"/>
<polygon fill="black" stroke="black" points="184652.16,-127.01 184641.61,-128.01 184650.48,-133.81 184652.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1521" class="edge">
<title>layer_7_expert_6_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M185327.92,-164.97C185311.74,-162.07 185295.65,-159.38 185280,-157 185082.52,-127.02 184857.26,-106.36 184689.01,-93.55"/>
<polygon fill="black" stroke="black" points="184689.26,-90.06 184679.02,-92.8 184688.73,-97.04 184689.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_6&#45;&gt;layer_7_agg_ep_6 -->
<g id="edge1522" class="edge">
<title>layer_7_expert_7_ep_6&#45;&gt;layer_7_agg_ep_6</title>
<path fill="none" stroke="black" d="M185894.84,-164.94C185877.35,-161.94 185859.92,-159.24 185843,-157 185434.97,-102.88 184955.66,-85.34 184674.64,-79.68"/>
<polygon fill="black" stroke="black" points="184674.38,-76.17 184664.32,-79.47 184674.24,-83.17 184674.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_7 -->
<g id="node820" class="node">
<title>layer_7_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="193726.07,-128 193275.77,-128 193159.93,-24 193610.23,-24 193726.07,-128"/>
<text text-anchor="middle" x="193443" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="193443" y="-79" font-family="Arial" font-size="10.00">GPU: 240&#45;255</text>
<text text-anchor="middle" x="193443" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="193443" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_expert_0_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1524" class="edge">
<title>layer_7_expert_0_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M191363.37,-175.09C191399.1,-167.94 191436.63,-161.4 191472,-157 191802.43,-115.9 192768.09,-91.08 193213.31,-81.52"/>
<polygon fill="black" stroke="black" points="193213.48,-85.02 193223.4,-81.31 193213.33,-78.02 193213.48,-85.02"/>
</g>
<!-- layer_7_expert_1_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1525" class="edge">
<title>layer_7_expert_1_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M191926.8,-175.46C191962.41,-168.31 191999.79,-161.67 192035,-157 192446.77,-102.39 192931.14,-85.03 193211.05,-79.53"/>
<polygon fill="black" stroke="black" points="193211.4,-83.02 193221.33,-79.33 193211.26,-76.02 193211.4,-83.02"/>
</g>
<!-- layer_7_expert_2_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1526" class="edge">
<title>layer_7_expert_2_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M192490.7,-176.34C192526.07,-169.17 192563.13,-162.29 192598,-157 192809.23,-124.93 193052.24,-103.53 193223.27,-90.99"/>
<polygon fill="black" stroke="black" points="193223.69,-94.47 193233.41,-90.25 193223.18,-87.49 193223.69,-94.47"/>
</g>
<!-- layer_7_expert_3_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1527" class="edge">
<title>layer_7_expert_3_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M193050.83,-173.82C193116.06,-157.72 193190.72,-139.29 193257.27,-122.86"/>
<polygon fill="black" stroke="black" points="193258.15,-126.24 193267.02,-120.45 193256.48,-119.45 193258.15,-126.24"/>
</g>
<!-- layer_7_expert_4_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1528" class="edge">
<title>layer_7_expert_4_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M193443,-164.64C193443,-156.08 193443,-147.12 193443,-138.34"/>
<polygon fill="black" stroke="black" points="193446.5,-138.15 193443,-128.15 193439.5,-138.15 193446.5,-138.15"/>
</g>
<!-- layer_7_expert_5_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1529" class="edge">
<title>layer_7_expert_5_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M193799.16,-164.93C193753.62,-153.69 193705.27,-141.75 193659.37,-130.42"/>
<polygon fill="black" stroke="black" points="193660.16,-127.01 193649.61,-128.01 193658.48,-133.81 193660.16,-127.01"/>
</g>
<!-- layer_7_expert_6_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1530" class="edge">
<title>layer_7_expert_6_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M194335.92,-164.97C194319.74,-162.07 194303.65,-159.38 194288,-157 194090.52,-127.02 193865.26,-106.36 193697.01,-93.55"/>
<polygon fill="black" stroke="black" points="193697.26,-90.06 193687.02,-92.8 193696.73,-97.04 193697.26,-90.06"/>
</g>
<!-- layer_7_expert_7_ep_7&#45;&gt;layer_7_agg_ep_7 -->
<g id="edge1531" class="edge">
<title>layer_7_expert_7_ep_7&#45;&gt;layer_7_agg_ep_7</title>
<path fill="none" stroke="black" d="M194902.84,-164.94C194885.35,-161.94 194867.92,-159.24 194851,-157 194442.97,-102.88 193963.66,-85.34 193682.64,-79.68"/>
<polygon fill="black" stroke="black" points="193682.38,-76.17 193672.32,-79.47 193682.24,-83.17 193682.38,-76.17"/>
</g>
<!-- layer_7_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1469" class="edge">
<title>layer_7_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M202681.57,-80.75C203316.41,-90.88 205143.75,-118.63 206663,-128 208853.07,-141.51 283316.89,-145.3 285507,-146 286596.33,-146.35 286868.67,-146.75 287958,-147 336593.55,-158.03 458182.45,-136.02 506818,-157 537943.56,-170.43 576615.74,-213.3 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1478" class="edge">
<title>layer_7_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M198177.57,-80.75C198812.41,-90.88 200639.75,-118.63 202159,-128 202231.35,-128.45 285434.65,-146.99 285507,-147 310097.11,-150.36 482227.89,-146.4 506818,-157 537943.56,-170.42 576615.74,-213.3 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1487" class="edge">
<title>layer_7_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M189169.57,-80.75C189804.41,-90.88 191631.75,-118.63 193151,-128 195424.46,-142.03 272723.5,-146.69 274997,-147 300754.89,-150.55 481060.11,-145.92 506818,-157 537943.56,-170.39 576615.74,-213.3 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1496" class="edge">
<title>layer_7_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M207185.57,-80.75C207820.41,-90.88 209647.75,-118.62 211167,-128 211307.9,-128.87 292185.1,-146.98 292326,-147 316158.44,-150.35 482985.56,-146.71 506818,-157 537943.56,-170.44 576615.74,-213.3 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1505" class="edge">
<title>layer_7_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M211689.57,-80.76C212324.41,-90.9 214151.75,-118.69 215671,-128 219129.32,-149.2 336714.61,-146.63 340173,-147 377205.22,-150.94 469785.78,-140.76 506818,-157 537943.56,-170.65 576615.74,-213.32 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1514" class="edge">
<title>layer_7_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M216189.85,-77.17C220547.07,-80.48 286810.53,-130.36 340177,-147 377208.33,-158.55 469786.67,-140.76 506818,-157 537943.56,-170.65 576615.74,-213.32 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1523" class="edge">
<title>layer_7_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M184665.57,-80.75C185300.41,-90.87 187127.75,-118.61 188647,-128 197041.17,-179.87 255801.67,-145.77 264196,-147 291154,-150.95 479860,-145.43 506818,-157 537943.56,-170.36 576615.74,-213.3 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1532" class="edge">
<title>layer_7_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M193673.57,-80.75C194308.41,-90.88 196135.75,-118.63 197655,-128 198813.1,-135.14 279881.87,-146.84 281040,-147 306126.44,-150.41 481731.56,-146.2 506818,-157 537943.56,-170.4 576615.74,-213.3 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_7_moe_alltoall -->
<g id="node821" class="node">
<title>layer_7_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="190247" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="190247" y="-521" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="190247" y="-510" font-family="Arial" font-size="10.00">GPUs: 128&#45;255</text>
<text text-anchor="middle" x="190247" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="190247" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_7_ln_tp_0 -->
<g id="node822" class="node">
<title>layer_7_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="216173.07,-559 215722.77,-559 215606.93,-455 216057.23,-455 216173.07,-559"/>
<text text-anchor="middle" x="215890" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="215890" y="-510" font-family="Arial" font-size="10.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="215890" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="215890" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_qkv_tp_0 -->
<g id="node826" class="node">
<title>layer_8_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="432586.7,-1069 432144.94,-1069 432031.3,-965 432473.06,-965 432586.7,-1069"/>
<text text-anchor="middle" x="432309" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="432309" y="-1020" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="432309" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="432309" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_7_ln_tp_0&#45;&gt;layer_8_qkv_tp_0 -->
<g id="edge3105" class="edge">
<title>layer_7_ln_tp_0&#45;&gt;layer_8_qkv_tp_0</title>
<path fill="none" stroke="black" d="M216041.77,-559.1C216086.42,-571.81 216135.71,-583.62 216182,-590 216182,-590 580216,-598 580216,-598 580263.68,-600 580275.4,-603.58 580323,-607 580389.84,-611.81 580559.2,-607.95 580624,-625 580756.06,-659.75 580768.87,-721.9 580900,-760 580915.46,-764.49 580961.26,-756 580972,-768 581032.47,-835.56 580929.66,-890.59 580848,-930 580759.39,-972.77 579175.39,-946.52 579077,-947 579077,-947 432596,-957 432596,-957 432562.61,-960.4 432527.36,-965.96 432493.43,-972.36"/>
<polygon fill="black" stroke="black" points="432492.59,-968.95 432483.43,-974.27 432493.91,-975.83 432492.59,-968.95"/>
</g>
<!-- layer_7_ln_tp_1 -->
<g id="node823" class="node">
<title>layer_7_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="216757.07,-559 216306.77,-559 216190.93,-455 216641.23,-455 216757.07,-559"/>
<text text-anchor="middle" x="216474" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="216474" y="-510" font-family="Arial" font-size="10.00">GPU: 160&#45;191</text>
<text text-anchor="middle" x="216474" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="216474" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_qkv_tp_1 -->
<g id="node827" class="node">
<title>layer_8_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="433160.7,-1069 432718.94,-1069 432605.3,-965 433047.06,-965 433160.7,-1069"/>
<text text-anchor="middle" x="432883" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="432883" y="-1020" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="432883" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="432883" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_7_ln_tp_1&#45;&gt;layer_8_qkv_tp_1 -->
<g id="edge3106" class="edge">
<title>layer_7_ln_tp_1&#45;&gt;layer_8_qkv_tp_1</title>
<path fill="none" stroke="black" d="M216625.77,-559.1C216670.42,-571.81 216719.71,-583.62 216766,-590 216766,-590 580320,-598 580320,-598 580332.91,-600.02 580335.12,-604.77 580348,-607 580408.46,-617.49 580844.77,-598.25 580900,-625 580970.68,-659.23 580960.45,-702.56 581014,-760 581029.22,-776.32 581038.06,-776.15 581050,-795 581153.64,-958.56 581106.16,-939.84 581099,-947 581099,-947 433170,-957 433170,-957 433136.61,-960.4 433101.36,-965.96 433067.43,-972.36"/>
<polygon fill="black" stroke="black" points="433066.59,-968.95 433057.43,-974.27 433067.91,-975.83 433066.59,-968.95"/>
</g>
<!-- layer_7_ln_tp_2 -->
<g id="node824" class="node">
<title>layer_7_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="217341.07,-559 216890.77,-559 216774.93,-455 217225.23,-455 217341.07,-559"/>
<text text-anchor="middle" x="217058" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="217058" y="-510" font-family="Arial" font-size="10.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="217058" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="217058" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_qkv_tp_2 -->
<g id="node828" class="node">
<title>layer_8_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="433734.7,-1069 433292.94,-1069 433179.3,-965 433621.06,-965 433734.7,-1069"/>
<text text-anchor="middle" x="433457" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="433457" y="-1020" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="433457" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="433457" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_7_ln_tp_2&#45;&gt;layer_8_qkv_tp_2 -->
<g id="edge3107" class="edge">
<title>layer_7_ln_tp_2&#45;&gt;layer_8_qkv_tp_2</title>
<path fill="none" stroke="black" d="M217209.77,-559.1C217254.42,-571.81 217303.71,-583.62 217350,-590 217350,-590 580348,-598 580348,-598 580414.76,-600 580431.29,-603.84 580498,-607 580555.3,-609.72 580959.66,-606.61 581014,-625 581112.12,-658.21 581110.06,-716.33 581204,-760 581216.9,-766 581225.29,-757.6 581235,-768 581284.14,-820.67 581280.74,-870.59 581240,-930 581237.04,-934.32 581201.15,-946.04 581196,-947 581196,-947 433744,-957 433744,-957 433710.61,-960.4 433675.36,-965.96 433641.43,-972.36"/>
<polygon fill="black" stroke="black" points="433640.59,-968.95 433631.43,-974.27 433641.91,-975.83 433640.59,-968.95"/>
</g>
<!-- layer_7_ln_tp_3 -->
<g id="node825" class="node">
<title>layer_7_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="217925.07,-559 217474.77,-559 217358.93,-455 217809.23,-455 217925.07,-559"/>
<text text-anchor="middle" x="217642" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="217642" y="-510" font-family="Arial" font-size="10.00">GPU: 224&#45;255</text>
<text text-anchor="middle" x="217642" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="217642" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_qkv_tp_3 -->
<g id="node829" class="node">
<title>layer_8_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="434308.7,-1069 433866.94,-1069 433753.3,-965 434195.06,-965 434308.7,-1069"/>
<text text-anchor="middle" x="434031" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="434031" y="-1020" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="434031" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="434031" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_7_ln_tp_3&#45;&gt;layer_8_qkv_tp_3 -->
<g id="edge3108" class="edge">
<title>layer_7_ln_tp_3&#45;&gt;layer_8_qkv_tp_3</title>
<path fill="none" stroke="black" d="M217795.36,-559.1C217840.47,-571.81 217890.26,-583.62 217937,-590 217937,-590 580495,-598 580495,-598 580504.85,-598.19 581195.41,-620.16 581204,-625 581282.83,-669.42 581290.02,-708.33 581316,-795 581333.23,-852.47 581354.38,-883.88 581316,-930 581289.4,-961.96 581265.41,-943.2 581224,-947 581157.67,-953.09 542923.61,-956.97 542857,-957 496224.32,-975.72 438351.54,-1013.19 434260.89,-1015.85"/>
<polygon fill="black" stroke="black" points="434260.88,-1012.35 434250.88,-1015.86 434260.88,-1019.35 434260.88,-1012.35"/>
</g>
<!-- layer_8_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1541" class="edge">
<title>layer_8_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M432483.43,-974.27C432520.38,-967.08 432559.31,-960.73 432596,-957 432724.29,-943.95 581017.1,-950.39 581146,-947 581181.93,-946.05 581444.26,-956.07 581469,-930 581510.3,-886.47 581497.59,-847.75 581469,-795 581287.03,-459.22 581073.63,-442.9 580692,-428 579937.66,-398.54 146613.25,-441.65 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_8_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1542" class="edge">
<title>layer_8_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M433057.43,-974.27C433094.38,-967.08 433133.31,-960.73 433170,-957 433297.9,-943.98 581145.53,-951.92 581274,-947 581323.44,-945.11 581462.38,-966.3 581496,-930 581591.55,-826.85 581503.57,-731.7 581412,-625 581322.22,-520.39 581288.34,-491.88 581158,-447 581004.41,-394.11 580955.39,-432.23 580793,-428 580038.16,-408.35 146613.43,-441.65 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_8_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1543" class="edge">
<title>layer_8_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M433631.43,-974.27C433668.38,-967.08 433707.31,-960.73 433744,-957 433871.51,-944.02 581265.08,-954.91 581393,-947 581502.36,-940.24 581876,-957.56 581876,-848 581876,-848 581876,-848 581876,-601.5 581876,-396.94 581176.46,-434.24 580972,-428 580216.95,-404.94 146613.74,-441.67 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_8_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1544" class="edge">
<title>layer_8_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M434250.88,-1015.86C438256.08,-1013.25 496185.86,-975.68 542857,-957 543125.6,-956.89 581266.52,-955.03 581535,-947 581598.42,-945.1 581767.66,-965.86 581820,-930 581944.41,-844.77 581948.62,-736.94 581890,-598 581852.62,-509.39 581823.4,-484.87 581735,-447 581630.55,-402.25 581337.61,-430.11 581224,-428 580468.29,-413.94 146614.18,-441.68 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_8_qkv_comm -->
<g id="node830" class="node">
<title>layer_8_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="431820" cy="-1017" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="431820" y="-1031" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="431820" y="-1020" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="431820" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="431820" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_8_attn_tp_0 -->
<g id="node831" class="node">
<title>layer_8_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="427139.7,-1069 426697.94,-1069 426584.3,-965 427026.06,-965 427139.7,-1069"/>
<text text-anchor="middle" x="426862" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="426862" y="-1020" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="426862" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="426862" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_out_tp_0 -->
<g id="node835" class="node">
<title>layer_8_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="432086.7,-899 431644.94,-899 431531.3,-795 431973.06,-795 432086.7,-899"/>
<text text-anchor="middle" x="431809" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="431809" y="-850" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="431809" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="431809" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_tp_0&#45;&gt;layer_8_attn_out_tp_0 -->
<g id="edge1549" class="edge">
<title>layer_8_attn_tp_0&#45;&gt;layer_8_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M427036.45,-974.47C427073.4,-967.27 427112.32,-960.86 427149,-957 427255.17,-945.82 430885.4,-935.71 430992,-930 431201.67,-918.77 431440.52,-893.31 431605.57,-873.72"/>
<polygon fill="black" stroke="black" points="431606.33,-877.16 431615.84,-872.5 431605.5,-870.21 431606.33,-877.16"/>
</g>
<!-- layer_8_attn_tp_1 -->
<g id="node832" class="node">
<title>layer_8_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="429876.7,-1069 429434.94,-1069 429321.3,-965 429763.06,-965 429876.7,-1069"/>
<text text-anchor="middle" x="429599" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="429599" y="-1020" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="429599" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="429599" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_out_tp_1 -->
<g id="node836" class="node">
<title>layer_8_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="432925.7,-899 432483.94,-899 432370.3,-795 432812.06,-795 432925.7,-899"/>
<text text-anchor="middle" x="432648" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="432648" y="-850" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="432648" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="432648" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_tp_1&#45;&gt;layer_8_attn_out_tp_1 -->
<g id="edge1551" class="edge">
<title>layer_8_attn_tp_1&#45;&gt;layer_8_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M429773.88,-974.82C429810.71,-967.62 429849.48,-961.12 429886,-957 430264.58,-914.25 430362.06,-943.35 430743,-938 430893.32,-935.89 431946.11,-941.52 432096,-930 432215.9,-920.79 432349.3,-901.23 432454.92,-883.53"/>
<polygon fill="black" stroke="black" points="432455.77,-886.93 432465.05,-881.82 432454.61,-880.03 432455.77,-886.93"/>
</g>
<!-- layer_8_attn_tp_2 -->
<g id="node833" class="node">
<title>layer_8_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="430450.7,-1069 430008.94,-1069 429895.3,-965 430337.06,-965 430450.7,-1069"/>
<text text-anchor="middle" x="430173" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="430173" y="-1020" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="430173" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="430173" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_out_tp_2 -->
<g id="node837" class="node">
<title>layer_8_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="433631.7,-899 433189.94,-899 433076.3,-795 433518.06,-795 433631.7,-899"/>
<text text-anchor="middle" x="433354" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="433354" y="-850" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="433354" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="433354" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_tp_2&#45;&gt;layer_8_attn_out_tp_2 -->
<g id="edge1553" class="edge">
<title>layer_8_attn_tp_2&#45;&gt;layer_8_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M430347.85,-974.61C430384.69,-967.42 430423.46,-960.99 430460,-957 430748.76,-925.5 431476.54,-941.11 431767,-938 431831.89,-937.31 432870.43,-936.48 432935,-930 433012.4,-922.23 433096.74,-907.05 433169.34,-891.84"/>
<polygon fill="black" stroke="black" points="433170.44,-895.19 433179.51,-889.7 433169,-888.34 433170.44,-895.19"/>
</g>
<!-- layer_8_attn_tp_3 -->
<g id="node834" class="node">
<title>layer_8_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="431608.7,-1069 431166.94,-1069 431053.3,-965 431495.06,-965 431608.7,-1069"/>
<text text-anchor="middle" x="431331" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="431331" y="-1020" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="431331" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="431331" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_out_tp_3 -->
<g id="node838" class="node">
<title>layer_8_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="434271.7,-899 433829.94,-899 433716.3,-795 434158.06,-795 434271.7,-899"/>
<text text-anchor="middle" x="433994" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="433994" y="-850" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="433994" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="433994" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_8_attn_tp_3&#45;&gt;layer_8_attn_out_tp_3 -->
<g id="edge1555" class="edge">
<title>layer_8_attn_tp_3&#45;&gt;layer_8_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M431505.85,-974.57C431542.69,-967.39 431581.46,-960.96 431618,-957 432064.97,-908.52 433194.68,-984.18 433641,-930 433698.3,-923.04 433759.87,-910.54 433815.28,-897.36"/>
<polygon fill="black" stroke="black" points="433816.29,-900.72 433825.19,-894.98 433814.65,-893.92 433816.29,-900.72"/>
</g>
<!-- layer_8_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1550" class="edge">
<title>layer_8_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M432004.45,-823.53C432109.9,-812.52 432242.39,-800.48 432361,-795 432361,-795 542917,-777 542917,-777 542919.83,-774.17 542919.83,-770.83 542917,-768 542917,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_8_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1552" class="edge">
<title>layer_8_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M432837.36,-818.03C432909.12,-808.72 432991.66,-799.57 433067,-795 433067,-795 542932,-777 542932,-777 542934.83,-774.17 542934.83,-770.83 542932,-768 542932,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_8_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1554" class="edge">
<title>layer_8_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M433539.41,-814.12C433593.29,-806.24 433652.34,-798.93 433707,-795 433707,-795 542947,-777 542947,-777 542949.83,-774.17 542949.83,-770.83 542947,-768 542947,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_8_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1556" class="edge">
<title>layer_8_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M434213.62,-845.83C437451,-843.31 475840.54,-813.56 506818,-795 506818,-795 542962,-777 542962,-777 542964.83,-774.17 542964.83,-770.83 542962,-768 542962,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_8_attn_allreduce -->
<g id="node839" class="node">
<title>layer_8_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="429107" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="429107" y="-1031" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="429107" y="-1020" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="429107" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="429107" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_gate_tp_0 -->
<g id="node840" class="node">
<title>layer_8_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="418298.99,-1069 417850.4,-1069 417735.01,-965 418183.6,-965 418298.99,-1069"/>
<text text-anchor="middle" x="418017" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="418017" y="-1020" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="418017" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="418017" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_8_route_ep_0 -->
<g id="node844" class="node">
<title>layer_8_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="401882.43,-899 401423.6,-899 401305.57,-795 401764.4,-795 401882.43,-899"/>
<text text-anchor="middle" x="401594" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="401594" y="-850" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="401594" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="401594" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_0 -->
<g id="edge1557" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417786.52,-964.95C417766.13,-961.75 417745.74,-959.01 417726,-957 417628.81,-947.11 414306.69,-947.29 414209,-947 412929.44,-943.18 412609.56,-940.91 411330,-938 410085.78,-935.17 406975.15,-943.22 405731,-930 404255.62,-914.33 402484.68,-871.02 401842.14,-854.51"/>
<polygon fill="black" stroke="black" points="401841.91,-851 401831.83,-854.24 401841.73,-858 401841.91,-851"/>
<text text-anchor="middle" x="414235" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_1 -->
<g id="node845" class="node">
<title>layer_8_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="422186.43,-899 421727.6,-899 421609.57,-795 422068.4,-795 422186.43,-899"/>
<text text-anchor="middle" x="421898" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="421898" y="-850" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="421898" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="421898" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_1 -->
<g id="edge1558" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418194.3,-974.43C418231.65,-967.26 418270.96,-960.87 418308,-957 418441.06,-943.09 419378.26,-950.33 419512,-947 420306.5,-927.22 421248.99,-881.55 421672.36,-859.86"/>
<polygon fill="black" stroke="black" points="421672.77,-863.34 421682.58,-859.33 421672.41,-856.35 421672.77,-863.34"/>
<text text-anchor="middle" x="419796" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_2 -->
<g id="node846" class="node">
<title>layer_8_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="406316.43,-899 405857.6,-899 405739.57,-795 406198.4,-795 406316.43,-899"/>
<text text-anchor="middle" x="406028" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="406028" y="-850" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="406028" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="406028" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_2 -->
<g id="edge1559" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417786.12,-964.97C417765.86,-961.78 417745.61,-959.03 417726,-957 417645.9,-948.7 414907.53,-938.34 414827,-938 413822.12,-933.82 411309.84,-940.52 410305,-930 408772.87,-913.96 406932.4,-870.52 406275.67,-854.26"/>
<polygon fill="black" stroke="black" points="406275.7,-850.75 406265.61,-854.01 406275.52,-857.75 406275.7,-850.75"/>
<text text-anchor="middle" x="416720" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_3 -->
<g id="node847" class="node">
<title>layer_8_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="418771.43,-899 418312.6,-899 418194.57,-795 418653.4,-795 418771.43,-899"/>
<text text-anchor="middle" x="418483" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="418483" y="-850" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="418483" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="418483" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_3 -->
<g id="edge1560" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418197.49,-977.43C418233.99,-970.19 418272.16,-963.02 418308,-957 418341.16,-951.43 418352.81,-961.82 418383,-947 418402.69,-937.33 418420.88,-922.26 418436.18,-906.77"/>
<polygon fill="black" stroke="black" points="418439.08,-908.8 418443.46,-899.16 418434.02,-903.97 418439.08,-908.8"/>
<text text-anchor="middle" x="418422" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_4 -->
<g id="node848" class="node">
<title>layer_8_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="415394.43,-899 414935.6,-899 414817.57,-795 415276.4,-795 415394.43,-899"/>
<text text-anchor="middle" x="415106" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="415106" y="-850" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="415106" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="415106" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_4 -->
<g id="edge1561" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418006.37,-964.78C418001.82,-954.32 417995.3,-944.53 417986,-938 417878.84,-862.8 416020.78,-850.41 415347.29,-848.39"/>
<polygon fill="black" stroke="black" points="415346.98,-844.88 415336.97,-848.36 415346.96,-851.88 415346.98,-844.88"/>
<text text-anchor="middle" x="418020" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_5 -->
<g id="node849" class="node">
<title>layer_8_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="410890.43,-899 410431.6,-899 410313.57,-795 410772.4,-795 410890.43,-899"/>
<text text-anchor="middle" x="410602" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="410602" y="-850" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="410602" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="410602" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_5 -->
<g id="edge1562" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417780.46,-964.97C417762.08,-961.95 417743.77,-959.23 417726,-957 417642.11,-946.46 417430.52,-940.25 417346,-938 416782.42,-923.03 415372.74,-936.38 414809,-930 413305.27,-912.98 411499.58,-870.31 410849.91,-854.25"/>
<polygon fill="black" stroke="black" points="410849.57,-850.74 410839.48,-853.99 410849.39,-857.73 410849.57,-850.74"/>
<text text-anchor="middle" x="417615" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_6 -->
<g id="node850" class="node">
<title>layer_8_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="430983.43,-899 430524.6,-899 430406.57,-795 430865.4,-795 430983.43,-899"/>
<text text-anchor="middle" x="430695" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="430695" y="-850" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="430695" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="430695" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_6 -->
<g id="edge1563" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418194.28,-974.26C418231.63,-967.1 418270.95,-960.76 418308,-957 418421.06,-945.51 422285.36,-947.37 422399,-947 422872.78,-945.48 426189.25,-935.76 426663,-930 428108.41,-912.42 429844.89,-869.86 430462.84,-854.05"/>
<polygon fill="black" stroke="black" points="430463.3,-857.54 430473.2,-853.78 430463.12,-850.54 430463.3,-857.54"/>
<text text-anchor="middle" x="425119" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_route_ep_7 -->
<g id="node851" class="node">
<title>layer_8_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="426654.43,-899 426195.6,-899 426077.57,-795 426536.4,-795 426654.43,-899"/>
<text text-anchor="middle" x="426366" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="426366" y="-850" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="426366" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="426366" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_7 -->
<g id="edge1564" class="edge">
<title>layer_8_gate_tp_0&#45;&gt;layer_8_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418194.29,-974.34C418231.64,-967.18 418270.95,-960.82 418308,-957 418517.56,-935.41 419993.65,-958.53 420204,-947 420242.37,-944.9 420251.63,-940.08 420290,-938 420501.36,-926.53 421983.35,-932.52 422195,-930 423696.44,-912.09 425501.52,-869.41 426133.75,-853.83"/>
<polygon fill="black" stroke="black" points="426133.98,-857.32 426143.89,-853.58 426133.81,-850.32 426133.98,-857.32"/>
<text text-anchor="middle" x="420316" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1 -->
<g id="node841" class="node">
<title>layer_8_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="418880.99,-1069 418432.4,-1069 418317.01,-965 418765.6,-965 418880.99,-1069"/>
<text text-anchor="middle" x="418599" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="418599" y="-1020" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="418599" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="418599" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_0 -->
<g id="edge1565" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418368.52,-964.95C418348.13,-961.74 418327.74,-959.01 418308,-957 418087.47,-934.59 414538.97,-964.62 414318,-947 414292.43,-944.96 414286.57,-940.02 414261,-938 414142.9,-928.68 405849.47,-931.23 405731,-930 404255.61,-914.69 402484.68,-871.16 401842.14,-854.55"/>
<polygon fill="black" stroke="black" points="401841.91,-851.04 401831.83,-854.29 401841.73,-858.04 401841.91,-851.04"/>
<text text-anchor="middle" x="414344" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_1 -->
<g id="edge1566" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418776.3,-974.47C418813.65,-967.29 418852.96,-960.9 418890,-957 419005.48,-944.85 419818.94,-950.48 419935,-947 420566.27,-928.07 421310.79,-884.77 421674.85,-862.23"/>
<polygon fill="black" stroke="black" points="421675.21,-865.71 421684.98,-861.6 421674.78,-858.72 421675.21,-865.71"/>
<text text-anchor="middle" x="420174" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_2 -->
<g id="edge1567" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418367.71,-964.95C418347.59,-961.77 418327.48,-959.04 418308,-957 418177.82,-943.38 417260.88,-949.11 417130,-947 416961.09,-944.28 416918.92,-940.1 416750,-938 415317.89,-920.15 411737.15,-944.62 410305,-930 408772.86,-914.36 406932.4,-870.67 406275.67,-854.3"/>
<polygon fill="black" stroke="black" points="406275.7,-850.8 406265.61,-854.05 406275.52,-857.8 406275.7,-850.8"/>
<text text-anchor="middle" x="417156" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_3 -->
<g id="edge1568" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418537.44,-964.83C418532.2,-959.12 418527.28,-953.14 418523,-947 418514.9,-935.38 418508.06,-921.87 418502.47,-908.63"/>
<polygon fill="black" stroke="black" points="418505.6,-907.04 418498.61,-899.08 418499.11,-909.66 418505.6,-907.04"/>
<text text-anchor="middle" x="418549" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_4 -->
<g id="edge1569" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418360.03,-964.96C418342.47,-962.01 418324.98,-959.31 418308,-957 418244.87,-948.43 418228.54,-951.71 418165,-947 418113.87,-943.21 418101.19,-940.78 418050,-938 417049.74,-883.6 415856.37,-859.76 415351.19,-851.56"/>
<polygon fill="black" stroke="black" points="415350.91,-848.05 415340.86,-851.39 415350.8,-855.05 415350.91,-848.05"/>
<text text-anchor="middle" x="418191" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_5 -->
<g id="edge1570" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418366.5,-964.96C418346.78,-961.82 418327.09,-959.09 418308,-957 418184.27,-943.47 417872.29,-953.53 417748,-947 417702.11,-944.59 417690.91,-940.07 417645,-938 417487.6,-930.91 414966.55,-931.76 414809,-930 413305.26,-913.23 411499.58,-870.41 410849.91,-854.27"/>
<polygon fill="black" stroke="black" points="410849.57,-850.77 410839.48,-854.02 410849.39,-857.76 410849.57,-850.77"/>
<text text-anchor="middle" x="417774" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_6 -->
<g id="edge1571" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418776.28,-974.24C418813.63,-967.08 418852.95,-960.75 418890,-957 418979.2,-947.98 425255.35,-947.65 425345,-947 425930.81,-942.77 426077.25,-939.73 426663,-930 428107.66,-905.99 429843.28,-867.41 430461.99,-853.34"/>
<polygon fill="black" stroke="black" points="430462.45,-856.84 430472.37,-853.11 430462.29,-849.84 430462.45,-856.84"/>
<text text-anchor="middle" x="426186" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_7 -->
<g id="edge1572" class="edge">
<title>layer_8_gate_tp_1&#45;&gt;layer_8_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418776.29,-974.39C418813.64,-967.22 418852.96,-960.85 418890,-957 419050.92,-940.29 420184.67,-959.02 420346,-947 420374.21,-944.9 420380.79,-940.07 420409,-938 420507.96,-930.74 422095.78,-931.2 422195,-930 423696.44,-911.88 425501.52,-869.33 426133.75,-853.8"/>
<polygon fill="black" stroke="black" points="426133.98,-857.3 426143.89,-853.55 426133.81,-850.3 426133.98,-857.3"/>
<text text-anchor="middle" x="420435" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2 -->
<g id="node842" class="node">
<title>layer_8_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="417716.99,-1069 417268.4,-1069 417153.01,-965 417601.6,-965 417716.99,-1069"/>
<text text-anchor="middle" x="417435" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="417435" y="-1020" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="417435" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="417435" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_0 -->
<g id="edge1573" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417208.91,-1015.39C416018.81,-1011.95 410359.72,-992.88 405731,-930 404255.22,-909.95 402483.63,-869.27 401841.56,-853.98"/>
<polygon fill="black" stroke="black" points="401841.34,-850.48 401831.26,-853.74 401841.17,-857.48 401841.34,-850.48"/>
<text text-anchor="middle" x="407026" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_1 -->
<g id="edge1574" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417612.71,-974.61C417649.94,-967.45 417689.1,-961.02 417726,-957 417789.96,-950.02 418241.98,-959.96 418305,-947 418315.35,-944.87 418316.65,-940.13 418327,-938 418376.31,-927.85 418729.67,-931.11 418780,-930 419859.65,-906.27 421149.36,-869.75 421666.66,-854.77"/>
<polygon fill="black" stroke="black" points="421666.96,-858.26 421676.86,-854.47 421666.76,-851.26 421666.96,-858.26"/>
<text text-anchor="middle" x="418353" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_2 -->
<g id="edge1575" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417207.19,-1014.07C416321.51,-1006.38 413021.88,-976.13 410305,-930 408771.85,-903.97 406929.68,-866.59 406274.2,-853.1"/>
<polygon fill="black" stroke="black" points="406274.24,-849.6 406264.17,-852.89 406274.09,-856.6 406274.24,-849.6"/>
<text text-anchor="middle" x="411300" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_3 -->
<g id="edge1576" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417613.65,-975.84C417650.64,-968.64 417689.47,-961.88 417726,-957 417793.1,-948.03 417810.74,-954.7 417878,-947 417898.35,-944.67 418112.97,-909.35 418280.88,-881.55"/>
<polygon fill="black" stroke="black" points="418281.56,-884.99 418290.85,-879.9 418280.42,-878.08 418281.56,-884.99"/>
<text text-anchor="middle" x="417956" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_4 -->
<g id="edge1577" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417337.78,-964.91C417313.05,-954.1 417286.07,-944.12 417260,-938 417078.79,-895.47 415878.69,-864.7 415352.5,-853.09"/>
<polygon fill="black" stroke="black" points="415352.58,-849.59 415342.5,-852.87 415352.42,-856.58 415352.58,-849.59"/>
<text text-anchor="middle" x="417316" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_5 -->
<g id="edge1578" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417202.62,-1009.72C416700.12,-996.18 415474.82,-963.42 414448,-938 413088.8,-904.35 411459.31,-867.31 410848.85,-853.54"/>
<polygon fill="black" stroke="black" points="410848.69,-850.04 410838.61,-853.31 410848.53,-857.04 410848.69,-850.04"/>
<text text-anchor="middle" x="414797" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_6 -->
<g id="edge1579" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417612.29,-974.36C417649.64,-967.19 417688.95,-960.83 417726,-957 417820.39,-947.25 419340.95,-965.58 419434,-947 419444.36,-944.93 419445.64,-940.04 419456,-938 419505.1,-928.32 426612.95,-930.54 426663,-930 428108.65,-914.5 429845.42,-870.65 430463.12,-854.28"/>
<polygon fill="black" stroke="black" points="430463.58,-857.76 430473.48,-854 430463.39,-850.77 430463.58,-857.76"/>
<text text-anchor="middle" x="419482" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_7 -->
<g id="edge1580" class="edge">
<title>layer_8_gate_tp_2&#45;&gt;layer_8_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417612.3,-974.5C417649.65,-967.32 417688.96,-960.92 417726,-957 417829.54,-946.05 418558.89,-948.21 418663,-947 418982.56,-943.29 419062.43,-940.45 419382,-938 420632.19,-928.4 420944.85,-944.07 422195,-930 423696.45,-913.11 425501.53,-869.8 426133.75,-853.94"/>
<polygon fill="black" stroke="black" points="426133.98,-857.43 426143.89,-853.68 426133.81,-850.43 426133.98,-857.43"/>
<text text-anchor="middle" x="419408" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3 -->
<g id="node843" class="node">
<title>layer_8_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="419462.99,-1069 419014.4,-1069 418899.01,-965 419347.6,-965 419462.99,-1069"/>
<text text-anchor="middle" x="419181" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="419181" y="-1020" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="419181" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="419181" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_0 -->
<g id="edge1581" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418950.52,-964.94C418930.13,-961.74 418909.74,-959 418890,-957 418827.85,-950.69 414453.29,-959.12 414392,-947 414381.64,-944.95 414380.36,-940.04 414370,-938 414340.57,-932.2 405760.99,-930.31 405731,-930 404255.61,-914.7 402484.68,-871.17 401842.14,-854.55"/>
<polygon fill="black" stroke="black" points="401841.91,-851.05 401831.83,-854.29 401841.73,-858.04 401841.91,-851.05"/>
<text text-anchor="middle" x="414418" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_1 -->
<g id="edge1582" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M419392.92,-1005.61C419647.53,-992.89 420087.6,-970.18 420465,-947 420894.2,-920.64 421395.34,-884.88 421676.79,-864.34"/>
<polygon fill="black" stroke="black" points="421677.41,-867.8 421687.13,-863.58 421676.9,-860.82 421677.41,-867.8"/>
<text text-anchor="middle" x="420607" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_2 -->
<g id="edge1583" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418950.12,-964.96C418929.86,-961.77 418909.61,-959.03 418890,-957 418796.83,-947.37 417295.85,-965.35 417204,-947 417193.64,-944.93 417192.36,-940.04 417182,-938 417135.15,-928.76 410352.75,-930.49 410305,-930 408772.86,-914.42 406932.4,-870.7 406275.67,-854.31"/>
<polygon fill="black" stroke="black" points="406275.7,-850.81 406265.61,-854.06 406275.52,-857.81 406275.7,-850.81"/>
<text text-anchor="middle" x="417230" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_3 -->
<g id="edge1584" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418946.08,-964.95C418927.17,-961.88 418908.3,-959.17 418890,-957 418859.2,-953.35 418640.17,-957.55 418611,-947 418586.05,-937.97 418562.08,-922.13 418541.77,-905.73"/>
<polygon fill="black" stroke="black" points="418543.81,-902.87 418533.88,-899.18 418539.34,-908.26 418543.81,-902.87"/>
<text text-anchor="middle" x="418637" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_4 -->
<g id="edge1585" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418948.9,-964.98C418929.05,-961.82 418909.22,-959.08 418890,-957 418749.25,-941.76 418393.37,-965.4 418253,-947 418236.65,-944.86 418233.34,-940.25 418217,-938 417664.06,-861.8 415977.36,-849.97 415347.03,-848.25"/>
<polygon fill="black" stroke="black" points="415346.92,-844.75 415336.91,-848.22 415346.9,-851.75 415346.92,-844.75"/>
<text text-anchor="middle" x="418279" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_5 -->
<g id="edge1586" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M418949.71,-964.97C418929.59,-961.79 418909.48,-959.05 418890,-957 418830.99,-950.8 417880.17,-958.72 417822,-947 417811.64,-944.91 417810.36,-940.05 417800,-938 417759.25,-929.93 414850.54,-930.46 414809,-930 413305.26,-913.34 411499.58,-870.45 410849.91,-854.29"/>
<polygon fill="black" stroke="black" points="410849.57,-850.78 410839.48,-854.03 410849.39,-857.78 410849.57,-850.78"/>
<text text-anchor="middle" x="417848" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_6 -->
<g id="edge1587" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M419398.96,-1011.19C419946.38,-999.34 421423.37,-968.88 422655,-957 423616.07,-947.73 426018.99,-960.91 426980,-947 428299.77,-927.89 429882.61,-876.1 430465.27,-856.07"/>
<polygon fill="black" stroke="black" points="430465.6,-859.56 430475.47,-855.72 430465.36,-852.56 430465.6,-859.56"/>
<text text-anchor="middle" x="427511" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_7 -->
<g id="edge1588" class="edge">
<title>layer_8_gate_tp_3&#45;&gt;layer_8_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M419398.97,-1010.9C420456.15,-986.18 425043.13,-878.93 426133.03,-853.45"/>
<polygon fill="black" stroke="black" points="426133.42,-856.94 426143.33,-853.21 426133.26,-849.94 426133.42,-856.94"/>
<text text-anchor="middle" x="422369" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_8_expert_0_ep_0 -->
<g id="node852" class="node">
<title>layer_8_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="398839.83,-729 398405.82,-729 398294.17,-625 398728.18,-625 398839.83,-729"/>
<text text-anchor="middle" x="398567" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="398567" y="-680" font-family="Arial" font-size="10.00">GPU: 256</text>
<text text-anchor="middle" x="398567" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="398567" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_0_ep_0 -->
<g id="edge1589" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M401363.54,-846.25C400793.64,-845.68 399329.58,-836.54 398848,-760 398807.78,-753.61 398765.2,-743.18 398725.68,-731.87"/>
<polygon fill="black" stroke="black" points="398726.55,-728.48 398715.97,-729.06 398724.6,-735.2 398726.55,-728.48"/>
</g>
<!-- layer_8_expert_1_ep_0 -->
<g id="node853" class="node">
<title>layer_8_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="399402.83,-729 398968.82,-729 398857.17,-625 399291.18,-625 399402.83,-729"/>
<text text-anchor="middle" x="399130" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="399130" y="-680" font-family="Arial" font-size="10.00">GPU: 257</text>
<text text-anchor="middle" x="399130" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="399130" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_1_ep_0 -->
<g id="edge1590" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M401361.11,-844.01C400877.85,-838.71 399780.43,-820.24 399411,-760 399371.12,-753.5 399328.9,-743.12 399289.65,-731.91"/>
<polygon fill="black" stroke="black" points="399290.32,-728.46 399279.74,-729.04 399288.37,-735.18 399290.32,-728.46"/>
</g>
<!-- layer_8_expert_2_ep_0 -->
<g id="node854" class="node">
<title>layer_8_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="399965.83,-729 399531.82,-729 399420.17,-625 399854.18,-625 399965.83,-729"/>
<text text-anchor="middle" x="399693" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="399693" y="-680" font-family="Arial" font-size="10.00">GPU: 258</text>
<text text-anchor="middle" x="399693" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="399693" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_2_ep_0 -->
<g id="edge1591" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M401356.72,-840.13C400972.88,-829.5 400232.66,-804 399974,-760 399934.63,-753.3 399892.95,-742.99 399854.08,-731.91"/>
<polygon fill="black" stroke="black" points="399854.85,-728.49 399844.27,-729.08 399852.91,-735.21 399854.85,-728.49"/>
</g>
<!-- layer_8_expert_3_ep_0 -->
<g id="node855" class="node">
<title>layer_8_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="400528.83,-729 400094.82,-729 399983.17,-625 400417.18,-625 400528.83,-729"/>
<text text-anchor="middle" x="400256" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="400256" y="-680" font-family="Arial" font-size="10.00">GPU: 259</text>
<text text-anchor="middle" x="400256" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="400256" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_3_ep_0 -->
<g id="edge1592" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M401357.1,-840.44C401141.69,-832.14 400815.82,-811.47 400537,-760 400498.53,-752.9 400457.79,-742.65 400419.62,-731.8"/>
<polygon fill="black" stroke="black" points="400420.55,-728.42 400409.98,-729.03 400418.62,-735.15 400420.55,-728.42"/>
</g>
<!-- layer_8_expert_4_ep_0 -->
<g id="node856" class="node">
<title>layer_8_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="401091.83,-729 400657.82,-729 400546.17,-625 400980.18,-625 401091.83,-729"/>
<text text-anchor="middle" x="400819" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="400819" y="-680" font-family="Arial" font-size="10.00">GPU: 260</text>
<text text-anchor="middle" x="400819" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="400819" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_4_ep_0 -->
<g id="edge1593" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M401314.33,-802.91C401244.05,-790.55 401169,-776.02 401100,-760 401064.93,-751.86 401027.76,-741.94 400992.32,-731.86"/>
<polygon fill="black" stroke="black" points="400992.95,-728.4 400982.38,-729.01 400991.03,-735.13 400992.95,-728.4"/>
</g>
<!-- layer_8_expert_5_ep_0 -->
<g id="node857" class="node">
<title>layer_8_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="401654.83,-729 401220.82,-729 401109.17,-625 401543.18,-625 401654.83,-729"/>
<text text-anchor="middle" x="401382" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="401382" y="-680" font-family="Arial" font-size="10.00">GPU: 261</text>
<text text-anchor="middle" x="401382" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="401382" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_5_ep_0 -->
<g id="edge1594" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M401529.53,-794.91C401505.89,-776.18 401478.97,-754.85 401454.66,-735.58"/>
<polygon fill="black" stroke="black" points="401456.54,-732.6 401446.53,-729.14 401452.19,-738.09 401456.54,-732.6"/>
</g>
<!-- layer_8_expert_6_ep_0 -->
<g id="node858" class="node">
<title>layer_8_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="402217.83,-729 401783.82,-729 401672.17,-625 402106.18,-625 402217.83,-729"/>
<text text-anchor="middle" x="401945" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="401945" y="-680" font-family="Arial" font-size="10.00">GPU: 262</text>
<text text-anchor="middle" x="401945" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="401945" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_6_ep_0 -->
<g id="edge1595" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M401700.74,-794.91C401741.33,-775.48 401787.74,-753.27 401829.14,-733.46"/>
<polygon fill="black" stroke="black" points="401830.65,-736.61 401838.16,-729.14 401827.63,-730.3 401830.65,-736.61"/>
</g>
<!-- layer_8_expert_7_ep_0 -->
<g id="node859" class="node">
<title>layer_8_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="402780.83,-729 402346.82,-729 402235.17,-625 402669.18,-625 402780.83,-729"/>
<text text-anchor="middle" x="402508" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="402508" y="-680" font-family="Arial" font-size="10.00">GPU: 263</text>
<text text-anchor="middle" x="402508" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="402508" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_0&#45;&gt;layer_8_expert_7_ep_0 -->
<g id="edge1596" class="edge">
<title>layer_8_route_ep_0&#45;&gt;layer_8_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M401799.52,-825.92C401924.02,-811.82 402085.57,-790.07 402227,-760 402263.39,-752.26 402301.95,-742.25 402338.46,-731.88"/>
<polygon fill="black" stroke="black" points="402339.54,-735.22 402348.19,-729.1 402337.61,-728.48 402339.54,-735.22"/>
</g>
<!-- layer_8_expert_0_ep_1 -->
<g id="node860" class="node">
<title>layer_8_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="421359.83,-729 420925.82,-729 420814.17,-625 421248.18,-625 421359.83,-729"/>
<text text-anchor="middle" x="421087" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="421087" y="-680" font-family="Arial" font-size="10.00">GPU: 272</text>
<text text-anchor="middle" x="421087" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="421087" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_0_ep_1 -->
<g id="edge1597" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M421624.41,-808.19C421541.63,-794.99 421450.74,-778.71 421368,-760 421332.55,-751.98 421294.97,-742.04 421259.22,-731.88"/>
<polygon fill="black" stroke="black" points="421259.77,-728.4 421249.19,-729.01 421257.84,-735.13 421259.77,-728.4"/>
</g>
<!-- layer_8_expert_1_ep_1 -->
<g id="node861" class="node">
<title>layer_8_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="421922.83,-729 421488.82,-729 421377.17,-625 421811.18,-625 421922.83,-729"/>
<text text-anchor="middle" x="421650" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="421650" y="-680" font-family="Arial" font-size="10.00">GPU: 273</text>
<text text-anchor="middle" x="421650" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="421650" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_1_ep_1 -->
<g id="edge1598" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M421822.58,-794.91C421794.57,-775.93 421762.62,-754.29 421733.89,-734.83"/>
<polygon fill="black" stroke="black" points="421735.73,-731.85 421725.49,-729.14 421731.8,-737.64 421735.73,-731.85"/>
</g>
<!-- layer_8_expert_2_ep_1 -->
<g id="node862" class="node">
<title>layer_8_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="422485.83,-729 422051.82,-729 421940.17,-625 422374.18,-625 422485.83,-729"/>
<text text-anchor="middle" x="422213" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="422213" y="-680" font-family="Arial" font-size="10.00">GPU: 274</text>
<text text-anchor="middle" x="422213" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="422213" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_2_ep_1 -->
<g id="edge1599" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M421993.79,-794.91C422029.84,-775.69 422071,-753.73 422107.85,-734.08"/>
<polygon fill="black" stroke="black" points="422109.94,-736.93 422117.12,-729.14 422106.65,-730.75 422109.94,-736.93"/>
</g>
<!-- layer_8_expert_3_ep_1 -->
<g id="node863" class="node">
<title>layer_8_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="423048.83,-729 422614.82,-729 422503.17,-625 422937.18,-625 423048.83,-729"/>
<text text-anchor="middle" x="422776" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="422776" y="-680" font-family="Arial" font-size="10.00">GPU: 275</text>
<text text-anchor="middle" x="422776" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="422776" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_3_ep_1 -->
<g id="edge1600" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M422101.33,-823.92C422217.38,-809.52 422365.16,-788.15 422495,-760 422531.13,-752.17 422569.42,-742.16 422605.72,-731.86"/>
<polygon fill="black" stroke="black" points="422606.75,-735.2 422615.4,-729.09 422604.83,-728.47 422606.75,-735.2"/>
</g>
<!-- layer_8_expert_4_ep_1 -->
<g id="node864" class="node">
<title>layer_8_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="423611.83,-729 423177.82,-729 423066.17,-625 423500.18,-625 423611.83,-729"/>
<text text-anchor="middle" x="423339" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="423339" y="-680" font-family="Arial" font-size="10.00">GPU: 276</text>
<text text-anchor="middle" x="423339" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="423339" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_4_ep_1 -->
<g id="edge1601" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M422123.22,-843.26C422358.24,-837.15 422736.58,-818.15 423058,-760 423096.72,-752.99 423137.73,-742.72 423176.1,-731.81"/>
<polygon fill="black" stroke="black" points="423177.15,-735.14 423185.8,-729.02 423175.22,-728.42 423177.15,-735.14"/>
</g>
<!-- layer_8_expert_5_ep_1 -->
<g id="node865" class="node">
<title>layer_8_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="424174.83,-729 423740.82,-729 423629.17,-625 424063.18,-625 424174.83,-729"/>
<text text-anchor="middle" x="423902" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="423902" y="-680" font-family="Arial" font-size="10.00">GPU: 277</text>
<text text-anchor="middle" x="423902" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="423902" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_5_ep_1 -->
<g id="edge1602" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M422121.06,-841.35C422519.73,-831.97 423339.13,-807.49 423621,-760 423660.5,-753.35 423702.31,-743.02 423741.27,-731.9"/>
<polygon fill="black" stroke="black" points="423742.48,-735.2 423751.11,-729.06 423740.54,-728.47 423742.48,-735.2"/>
</g>
<!-- layer_8_expert_6_ep_1 -->
<g id="node866" class="node">
<title>layer_8_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="424737.83,-729 424303.82,-729 424192.17,-625 424626.18,-625 424737.83,-729"/>
<text text-anchor="middle" x="424465" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="424465" y="-680" font-family="Arial" font-size="10.00">GPU: 278</text>
<text text-anchor="middle" x="424465" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="424465" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_6_ep_1 -->
<g id="edge1603" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M422124.82,-844.56C422621.62,-840.24 423792.7,-823.46 424184,-760 424223.89,-753.53 424266.1,-743.17 424305.36,-731.96"/>
<polygon fill="black" stroke="black" points="424306.63,-735.23 424315.27,-729.09 424304.69,-728.51 424306.63,-735.23"/>
</g>
<!-- layer_8_expert_7_ep_1 -->
<g id="node867" class="node">
<title>layer_8_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="425300.83,-729 424866.82,-729 424755.17,-625 425189.18,-625 425300.83,-729"/>
<text text-anchor="middle" x="425028" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="425028" y="-680" font-family="Arial" font-size="10.00">GPU: 279</text>
<text text-anchor="middle" x="425028" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="425028" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_1&#45;&gt;layer_8_expert_7_ep_1 -->
<g id="edge1604" class="edge">
<title>layer_8_route_ep_1&#45;&gt;layer_8_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M422127.16,-846.56C422711.16,-846.8 424244.5,-839.57 424747,-760 424787.23,-753.63 424829.81,-743.21 424869.32,-731.9"/>
<polygon fill="black" stroke="black" points="424870.4,-735.24 424879.03,-729.09 424868.45,-728.51 424870.4,-735.24"/>
</g>
<!-- layer_8_expert_0_ep_2 -->
<g id="node868" class="node">
<title>layer_8_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="403343.83,-729 402909.82,-729 402798.17,-625 403232.18,-625 403343.83,-729"/>
<text text-anchor="middle" x="403071" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="403071" y="-680" font-family="Arial" font-size="10.00">GPU: 288</text>
<text text-anchor="middle" x="403071" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="403071" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_0_ep_2 -->
<g id="edge1605" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M405797.26,-846.03C405237.58,-844.89 403819.57,-834.51 403352,-760 403311.78,-753.59 403269.2,-743.16 403229.69,-731.85"/>
<polygon fill="black" stroke="black" points="403230.56,-728.46 403219.98,-729.04 403228.61,-735.18 403230.56,-728.46"/>
</g>
<!-- layer_8_expert_1_ep_2 -->
<g id="node869" class="node">
<title>layer_8_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="403906.83,-729 403472.82,-729 403361.17,-625 403795.18,-625 403906.83,-729"/>
<text text-anchor="middle" x="403634" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="403634" y="-680" font-family="Arial" font-size="10.00">GPU: 289</text>
<text text-anchor="middle" x="403634" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="403634" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_1_ep_2 -->
<g id="edge1606" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M405794.52,-843.65C405322.72,-837.72 404270.53,-818.22 403915,-760 403875.12,-753.47 403832.91,-743.09 403793.66,-731.87"/>
<polygon fill="black" stroke="black" points="403794.33,-728.42 403783.75,-729.01 403792.38,-735.15 403794.33,-728.42"/>
</g>
<!-- layer_8_expert_2_ep_2 -->
<g id="node870" class="node">
<title>layer_8_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="404469.83,-729 404035.82,-729 403924.17,-625 404358.18,-625 404469.83,-729"/>
<text text-anchor="middle" x="404197" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="404197" y="-680" font-family="Arial" font-size="10.00">GPU: 290</text>
<text text-anchor="middle" x="404197" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="404197" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_2_ep_2 -->
<g id="edge1607" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M405789.78,-839.44C405419.5,-828.1 404722.97,-801.97 404478,-760 404438.63,-753.26 404396.96,-742.92 404358.1,-731.84"/>
<polygon fill="black" stroke="black" points="404358.86,-728.42 404348.28,-729.01 404356.92,-735.15 404358.86,-728.42"/>
</g>
<!-- layer_8_expert_3_ep_2 -->
<g id="node871" class="node">
<title>layer_8_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="405032.83,-729 404598.82,-729 404487.17,-625 404921.18,-625 405032.83,-729"/>
<text text-anchor="middle" x="404760" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="404760" y="-680" font-family="Arial" font-size="10.00">GPU: 291</text>
<text text-anchor="middle" x="404760" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="404760" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_3_ep_2 -->
<g id="edge1608" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M405788.64,-838.33C405587.64,-828.76 405293.63,-807.39 405041,-760 405002.94,-752.86 404962.65,-742.71 404924.82,-731.97"/>
<polygon fill="black" stroke="black" points="404925.32,-728.47 404914.74,-729.08 404923.39,-735.2 404925.32,-728.47"/>
</g>
<!-- layer_8_expert_4_ep_2 -->
<g id="node872" class="node">
<title>layer_8_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="405595.83,-729 405161.82,-729 405050.17,-625 405484.18,-625 405595.83,-729"/>
<text text-anchor="middle" x="405323" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="405323" y="-680" font-family="Arial" font-size="10.00">GPU: 292</text>
<text text-anchor="middle" x="405323" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="405323" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_4_ep_2 -->
<g id="edge1609" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M405758.93,-794.96C405707.33,-784.18 405653.86,-772.31 405604,-760 405569.95,-751.59 405533.84,-741.76 405499.25,-731.88"/>
<polygon fill="black" stroke="black" points="405500.12,-728.49 405489.54,-729.1 405498.18,-735.22 405500.12,-728.49"/>
</g>
<!-- layer_8_expert_5_ep_2 -->
<g id="node873" class="node">
<title>layer_8_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="406158.83,-729 405724.82,-729 405613.17,-625 406047.18,-625 406158.83,-729"/>
<text text-anchor="middle" x="405886" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="405886" y="-680" font-family="Arial" font-size="10.00">GPU: 293</text>
<text text-anchor="middle" x="405886" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="405886" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_5_ep_2 -->
<g id="edge1610" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M405984.62,-794.68C405969.14,-776.36 405951.58,-755.59 405935.61,-736.69"/>
<polygon fill="black" stroke="black" points="405938.24,-734.38 405929.11,-729 405932.89,-738.9 405938.24,-734.38"/>
</g>
<!-- layer_8_expert_6_ep_2 -->
<g id="node874" class="node">
<title>layer_8_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="406721.83,-729 406287.82,-729 406176.17,-625 406610.18,-625 406721.83,-729"/>
<text text-anchor="middle" x="406449" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="406449" y="-680" font-family="Arial" font-size="10.00">GPU: 294</text>
<text text-anchor="middle" x="406449" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="406449" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_6_ep_2 -->
<g id="edge1611" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M406156.03,-794.91C406205.12,-775.32 406261.32,-752.9 406311.28,-732.96"/>
<polygon fill="black" stroke="black" points="406312.86,-736.09 406320.86,-729.14 406310.27,-729.59 406312.86,-736.09"/>
</g>
<!-- layer_8_expert_7_ep_2 -->
<g id="node875" class="node">
<title>layer_8_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="407284.83,-729 406850.82,-729 406739.17,-625 407173.18,-625 407284.83,-729"/>
<text text-anchor="middle" x="407012" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="407012" y="-680" font-family="Arial" font-size="10.00">GPU: 295</text>
<text text-anchor="middle" x="407012" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="407012" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_2&#45;&gt;layer_8_expert_7_ep_2 -->
<g id="edge1612" class="edge">
<title>layer_8_route_ep_2&#45;&gt;layer_8_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M406237.46,-829.34C406378,-815.97 406566.75,-793.78 406731,-760 406767.9,-752.41 406806.99,-742.34 406843.91,-731.87"/>
<polygon fill="black" stroke="black" points="406845.1,-735.17 406853.75,-729.05 406843.17,-728.44 406845.1,-735.17"/>
</g>
<!-- layer_8_expert_0_ep_3 -->
<g id="node876" class="node">
<title>layer_8_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="416292.83,-729 415858.82,-729 415747.17,-625 416181.18,-625 416292.83,-729"/>
<text text-anchor="middle" x="416020" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="416020" y="-680" font-family="Arial" font-size="10.00">GPU: 304</text>
<text text-anchor="middle" x="416020" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="416020" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_0_ep_3 -->
<g id="edge1613" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M418249.76,-844C417766.49,-838.69 416670.14,-820.2 416301,-760 416261.12,-753.5 416218.9,-743.12 416179.65,-731.91"/>
<polygon fill="black" stroke="black" points="416180.32,-728.46 416169.74,-729.04 416178.37,-735.18 416180.32,-728.46"/>
</g>
<!-- layer_8_expert_1_ep_3 -->
<g id="node877" class="node">
<title>layer_8_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="416855.83,-729 416421.82,-729 416310.17,-625 416744.18,-625 416855.83,-729"/>
<text text-anchor="middle" x="416583" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="416583" y="-680" font-family="Arial" font-size="10.00">GPU: 305</text>
<text text-anchor="middle" x="416583" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="416583" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_1_ep_3 -->
<g id="edge1614" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M418245.48,-840.12C417861.77,-829.48 417122.41,-803.96 416864,-760 416824.63,-753.3 416782.95,-742.99 416744.08,-731.91"/>
<polygon fill="black" stroke="black" points="416744.85,-728.49 416734.27,-729.08 416742.91,-735.21 416744.85,-728.49"/>
</g>
<!-- layer_8_expert_2_ep_3 -->
<g id="node878" class="node">
<title>layer_8_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="417418.83,-729 416984.82,-729 416873.17,-625 417307.18,-625 417418.83,-729"/>
<text text-anchor="middle" x="417146" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="417146" y="-680" font-family="Arial" font-size="10.00">GPU: 306</text>
<text text-anchor="middle" x="417146" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="417146" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_2_ep_3 -->
<g id="edge1615" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M418246.07,-840.41C418030.85,-832.09 417705.45,-811.42 417427,-760 417388.53,-752.9 417347.79,-742.65 417309.62,-731.8"/>
<polygon fill="black" stroke="black" points="417310.55,-728.42 417299.98,-729.02 417308.62,-735.15 417310.55,-728.42"/>
</g>
<!-- layer_8_expert_3_ep_3 -->
<g id="node879" class="node">
<title>layer_8_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="418544.83,-729 418110.82,-729 417999.17,-625 418433.18,-625 418544.83,-729"/>
<text text-anchor="middle" x="418272" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="418272" y="-680" font-family="Arial" font-size="10.00">GPU: 307</text>
<text text-anchor="middle" x="418272" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="418272" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_3_ep_3 -->
<g id="edge1616" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M418418.83,-794.91C418395.3,-776.18 418368.52,-754.85 418344.32,-735.58"/>
<polygon fill="black" stroke="black" points="418346.23,-732.63 418336.22,-729.14 418341.87,-738.1 418346.23,-732.63"/>
</g>
<!-- layer_8_expert_4_ep_3 -->
<g id="node880" class="node">
<title>layer_8_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="419107.83,-729 418673.82,-729 418562.17,-625 418996.18,-625 419107.83,-729"/>
<text text-anchor="middle" x="418835" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="418835" y="-680" font-family="Arial" font-size="10.00">GPU: 308</text>
<text text-anchor="middle" x="418835" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="418835" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_4_ep_3 -->
<g id="edge1617" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M418590.05,-794.91C418630.75,-775.48 418677.3,-753.27 418718.81,-733.46"/>
<polygon fill="black" stroke="black" points="418720.34,-736.6 418727.86,-729.14 418717.33,-730.28 418720.34,-736.6"/>
</g>
<!-- layer_8_expert_5_ep_3 -->
<g id="node881" class="node">
<title>layer_8_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="419670.83,-729 419236.82,-729 419125.17,-625 419559.18,-625 419670.83,-729"/>
<text text-anchor="middle" x="419398" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="419398" y="-680" font-family="Arial" font-size="10.00">GPU: 309</text>
<text text-anchor="middle" x="419398" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="419398" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_5_ep_3 -->
<g id="edge1618" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M418688.84,-825.94C418813.54,-811.85 418975.35,-790.1 419117,-760 419153.39,-752.27 419191.95,-742.25 419228.46,-731.89"/>
<polygon fill="black" stroke="black" points="419229.54,-735.22 419238.19,-729.11 419227.62,-728.49 419229.54,-735.22"/>
</g>
<!-- layer_8_expert_6_ep_3 -->
<g id="node882" class="node">
<title>layer_8_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="420233.83,-729 419799.82,-729 419688.17,-625 420122.18,-625 420233.83,-729"/>
<text text-anchor="middle" x="419961" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="419961" y="-680" font-family="Arial" font-size="10.00">GPU: 310</text>
<text text-anchor="middle" x="419961" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="419961" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_6_ep_3 -->
<g id="edge1619" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M418709.25,-843.99C418951.26,-838.54 419345.49,-820.12 419680,-760 419718.73,-753.04 419759.74,-742.79 419798.11,-731.87"/>
<polygon fill="black" stroke="black" points="419799.16,-735.21 419807.81,-729.08 419797.23,-728.48 419799.16,-735.21"/>
</g>
<!-- layer_8_expert_7_ep_3 -->
<g id="node883" class="node">
<title>layer_8_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="420796.83,-729 420362.82,-729 420251.17,-625 420685.18,-625 420796.83,-729"/>
<text text-anchor="middle" x="420524" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="420524" y="-680" font-family="Arial" font-size="10.00">GPU: 311</text>
<text text-anchor="middle" x="420524" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="420524" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_3&#45;&gt;layer_8_expert_7_ep_3 -->
<g id="edge1620" class="edge">
<title>layer_8_route_ep_3&#45;&gt;layer_8_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M418706.47,-841.62C419112.03,-832.58 419954.03,-808.53 420243,-760 420282.5,-753.37 420324.32,-743.04 420363.28,-731.93"/>
<polygon fill="black" stroke="black" points="420364.48,-735.23 420373.12,-729.09 420362.54,-728.5 420364.48,-735.23"/>
</g>
<!-- layer_8_expert_0_ep_4 -->
<g id="node884" class="node">
<title>layer_8_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="412351.83,-729 411917.82,-729 411806.17,-625 412240.18,-625 412351.83,-729"/>
<text text-anchor="middle" x="412079" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="412079" y="-680" font-family="Arial" font-size="10.00">GPU: 320</text>
<text text-anchor="middle" x="412079" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="412079" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_0_ep_4 -->
<g id="edge1621" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M414875.54,-846.25C414305.64,-845.68 412841.58,-836.54 412360,-760 412319.78,-753.61 412277.2,-743.18 412237.68,-731.87"/>
<polygon fill="black" stroke="black" points="412238.55,-728.48 412227.97,-729.06 412236.6,-735.2 412238.55,-728.48"/>
</g>
<!-- layer_8_expert_1_ep_4 -->
<g id="node885" class="node">
<title>layer_8_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="412914.83,-729 412480.82,-729 412369.17,-625 412803.18,-625 412914.83,-729"/>
<text text-anchor="middle" x="412642" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="412642" y="-680" font-family="Arial" font-size="10.00">GPU: 321</text>
<text text-anchor="middle" x="412642" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="412642" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_1_ep_4 -->
<g id="edge1622" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M414873.11,-844.01C414389.85,-838.71 413292.43,-820.24 412923,-760 412883.12,-753.5 412840.9,-743.12 412801.65,-731.91"/>
<polygon fill="black" stroke="black" points="412802.32,-728.46 412791.74,-729.04 412800.37,-735.18 412802.32,-728.46"/>
</g>
<!-- layer_8_expert_2_ep_4 -->
<g id="node886" class="node">
<title>layer_8_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="413477.83,-729 413043.82,-729 412932.17,-625 413366.18,-625 413477.83,-729"/>
<text text-anchor="middle" x="413205" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="413205" y="-680" font-family="Arial" font-size="10.00">GPU: 322</text>
<text text-anchor="middle" x="413205" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="413205" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_2_ep_4 -->
<g id="edge1623" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M414868.72,-840.13C414484.88,-829.5 413744.66,-804 413486,-760 413446.63,-753.3 413404.95,-742.99 413366.08,-731.91"/>
<polygon fill="black" stroke="black" points="413366.85,-728.49 413356.27,-729.08 413364.91,-735.21 413366.85,-728.49"/>
</g>
<!-- layer_8_expert_3_ep_4 -->
<g id="node887" class="node">
<title>layer_8_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="414040.83,-729 413606.82,-729 413495.17,-625 413929.18,-625 414040.83,-729"/>
<text text-anchor="middle" x="413768" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="413768" y="-680" font-family="Arial" font-size="10.00">GPU: 323</text>
<text text-anchor="middle" x="413768" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="413768" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_3_ep_4 -->
<g id="edge1624" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M414869.1,-840.44C414653.69,-832.14 414327.82,-811.47 414049,-760 414010.53,-752.9 413969.79,-742.65 413931.62,-731.8"/>
<polygon fill="black" stroke="black" points="413932.55,-728.42 413921.98,-729.03 413930.62,-735.15 413932.55,-728.42"/>
</g>
<!-- layer_8_expert_4_ep_4 -->
<g id="node888" class="node">
<title>layer_8_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="414603.83,-729 414169.82,-729 414058.17,-625 414492.18,-625 414603.83,-729"/>
<text text-anchor="middle" x="414331" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="414331" y="-680" font-family="Arial" font-size="10.00">GPU: 324</text>
<text text-anchor="middle" x="414331" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="414331" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_4_ep_4 -->
<g id="edge1625" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M414826.33,-802.91C414756.05,-790.55 414681,-776.02 414612,-760 414576.93,-751.86 414539.76,-741.94 414504.32,-731.86"/>
<polygon fill="black" stroke="black" points="414504.95,-728.4 414494.38,-729.01 414503.03,-735.13 414504.95,-728.4"/>
</g>
<!-- layer_8_expert_5_ep_4 -->
<g id="node889" class="node">
<title>layer_8_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="415166.83,-729 414732.82,-729 414621.17,-625 415055.18,-625 415166.83,-729"/>
<text text-anchor="middle" x="414894" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="414894" y="-680" font-family="Arial" font-size="10.00">GPU: 325</text>
<text text-anchor="middle" x="414894" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="414894" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_5_ep_4 -->
<g id="edge1626" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M415041.53,-794.91C415017.89,-776.18 414990.97,-754.85 414966.66,-735.58"/>
<polygon fill="black" stroke="black" points="414968.54,-732.6 414958.53,-729.14 414964.19,-738.09 414968.54,-732.6"/>
</g>
<!-- layer_8_expert_6_ep_4 -->
<g id="node890" class="node">
<title>layer_8_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="415729.83,-729 415295.82,-729 415184.17,-625 415618.18,-625 415729.83,-729"/>
<text text-anchor="middle" x="415457" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="415457" y="-680" font-family="Arial" font-size="10.00">GPU: 326</text>
<text text-anchor="middle" x="415457" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="415457" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_6_ep_4 -->
<g id="edge1627" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M415212.74,-794.91C415253.33,-775.48 415299.74,-753.27 415341.14,-733.46"/>
<polygon fill="black" stroke="black" points="415342.65,-736.61 415350.16,-729.14 415339.63,-730.3 415342.65,-736.61"/>
</g>
<!-- layer_8_expert_7_ep_4 -->
<g id="node891" class="node">
<title>layer_8_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="417981.83,-729 417547.82,-729 417436.17,-625 417870.18,-625 417981.83,-729"/>
<text text-anchor="middle" x="417709" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="417709" y="-680" font-family="Arial" font-size="10.00">GPU: 327</text>
<text text-anchor="middle" x="417709" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="417709" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_4&#45;&gt;layer_8_expert_7_ep_4 -->
<g id="edge1628" class="edge">
<title>layer_8_route_ep_4&#45;&gt;layer_8_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M415333.09,-844.71C415835.8,-840.7 417029.66,-824.48 417428,-760 417468,-753.52 417510.35,-743.13 417549.7,-731.88"/>
<polygon fill="black" stroke="black" points="417551,-735.15 417559.64,-729 417549.06,-728.42 417551,-735.15"/>
</g>
<!-- layer_8_expert_0_ep_5 -->
<g id="node892" class="node">
<title>layer_8_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="407847.83,-729 407413.82,-729 407302.17,-625 407736.18,-625 407847.83,-729"/>
<text text-anchor="middle" x="407575" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="407575" y="-680" font-family="Arial" font-size="10.00">GPU: 336</text>
<text text-anchor="middle" x="407575" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="407575" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_0_ep_5 -->
<g id="edge1629" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M410371.54,-846.25C409801.64,-845.68 408337.58,-836.54 407856,-760 407815.78,-753.61 407773.2,-743.18 407733.68,-731.87"/>
<polygon fill="black" stroke="black" points="407734.55,-728.48 407723.97,-729.06 407732.6,-735.2 407734.55,-728.48"/>
</g>
<!-- layer_8_expert_1_ep_5 -->
<g id="node893" class="node">
<title>layer_8_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="408410.83,-729 407976.82,-729 407865.17,-625 408299.18,-625 408410.83,-729"/>
<text text-anchor="middle" x="408138" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="408138" y="-680" font-family="Arial" font-size="10.00">GPU: 337</text>
<text text-anchor="middle" x="408138" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="408138" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_1_ep_5 -->
<g id="edge1630" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M410369.11,-844.01C409885.85,-838.71 408788.43,-820.24 408419,-760 408379.12,-753.5 408336.9,-743.12 408297.65,-731.91"/>
<polygon fill="black" stroke="black" points="408298.32,-728.46 408287.74,-729.04 408296.37,-735.18 408298.32,-728.46"/>
</g>
<!-- layer_8_expert_2_ep_5 -->
<g id="node894" class="node">
<title>layer_8_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="408973.83,-729 408539.82,-729 408428.17,-625 408862.18,-625 408973.83,-729"/>
<text text-anchor="middle" x="408701" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="408701" y="-680" font-family="Arial" font-size="10.00">GPU: 338</text>
<text text-anchor="middle" x="408701" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="408701" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_2_ep_5 -->
<g id="edge1631" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M410364.72,-840.13C409980.88,-829.5 409240.66,-804 408982,-760 408942.63,-753.3 408900.95,-742.99 408862.08,-731.91"/>
<polygon fill="black" stroke="black" points="408862.85,-728.49 408852.27,-729.08 408860.91,-735.21 408862.85,-728.49"/>
</g>
<!-- layer_8_expert_3_ep_5 -->
<g id="node895" class="node">
<title>layer_8_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="409536.83,-729 409102.82,-729 408991.17,-625 409425.18,-625 409536.83,-729"/>
<text text-anchor="middle" x="409264" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="409264" y="-680" font-family="Arial" font-size="10.00">GPU: 339</text>
<text text-anchor="middle" x="409264" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="409264" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_3_ep_5 -->
<g id="edge1632" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M410365.1,-840.44C410149.69,-832.14 409823.82,-811.47 409545,-760 409506.53,-752.9 409465.79,-742.65 409427.62,-731.8"/>
<polygon fill="black" stroke="black" points="409428.55,-728.42 409417.98,-729.03 409426.62,-735.15 409428.55,-728.42"/>
</g>
<!-- layer_8_expert_4_ep_5 -->
<g id="node896" class="node">
<title>layer_8_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="410099.83,-729 409665.82,-729 409554.17,-625 409988.18,-625 410099.83,-729"/>
<text text-anchor="middle" x="409827" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="409827" y="-680" font-family="Arial" font-size="10.00">GPU: 340</text>
<text text-anchor="middle" x="409827" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="409827" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_4_ep_5 -->
<g id="edge1633" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M410322.33,-802.91C410252.05,-790.55 410177,-776.02 410108,-760 410072.93,-751.86 410035.76,-741.94 410000.32,-731.86"/>
<polygon fill="black" stroke="black" points="410000.95,-728.4 409990.38,-729.01 409999.03,-735.13 410000.95,-728.4"/>
</g>
<!-- layer_8_expert_5_ep_5 -->
<g id="node897" class="node">
<title>layer_8_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="410662.83,-729 410228.82,-729 410117.17,-625 410551.18,-625 410662.83,-729"/>
<text text-anchor="middle" x="410390" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="410390" y="-680" font-family="Arial" font-size="10.00">GPU: 341</text>
<text text-anchor="middle" x="410390" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="410390" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_5_ep_5 -->
<g id="edge1634" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M410537.53,-794.91C410513.89,-776.18 410486.97,-754.85 410462.66,-735.58"/>
<polygon fill="black" stroke="black" points="410464.54,-732.6 410454.53,-729.14 410460.19,-738.09 410464.54,-732.6"/>
</g>
<!-- layer_8_expert_6_ep_5 -->
<g id="node898" class="node">
<title>layer_8_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="411225.83,-729 410791.82,-729 410680.17,-625 411114.18,-625 411225.83,-729"/>
<text text-anchor="middle" x="410953" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="410953" y="-680" font-family="Arial" font-size="10.00">GPU: 342</text>
<text text-anchor="middle" x="410953" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="410953" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_6_ep_5 -->
<g id="edge1635" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M410708.74,-794.91C410749.33,-775.48 410795.74,-753.27 410837.14,-733.46"/>
<polygon fill="black" stroke="black" points="410838.65,-736.61 410846.16,-729.14 410835.63,-730.3 410838.65,-736.61"/>
</g>
<!-- layer_8_expert_7_ep_5 -->
<g id="node899" class="node">
<title>layer_8_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="411788.83,-729 411354.82,-729 411243.17,-625 411677.18,-625 411788.83,-729"/>
<text text-anchor="middle" x="411516" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="411516" y="-680" font-family="Arial" font-size="10.00">GPU: 343</text>
<text text-anchor="middle" x="411516" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="411516" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_5&#45;&gt;layer_8_expert_7_ep_5 -->
<g id="edge1636" class="edge">
<title>layer_8_route_ep_5&#45;&gt;layer_8_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M410807.52,-825.92C410932.02,-811.82 411093.57,-790.07 411235,-760 411271.39,-752.26 411309.95,-742.25 411346.46,-731.88"/>
<polygon fill="black" stroke="black" points="411347.54,-735.22 411356.19,-729.1 411345.61,-728.48 411347.54,-735.22"/>
</g>
<!-- layer_8_expert_0_ep_6 -->
<g id="node900" class="node">
<title>layer_8_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="430367.83,-729 429933.82,-729 429822.17,-625 430256.18,-625 430367.83,-729"/>
<text text-anchor="middle" x="430095" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="430095" y="-680" font-family="Arial" font-size="10.00">GPU: 352</text>
<text text-anchor="middle" x="430095" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="430095" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_0_ep_6 -->
<g id="edge1637" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M430502.94,-794.91C430461.06,-783.58 430417,-771.51 430376,-760 430344.16,-751.06 430310.35,-741.37 430277.63,-731.89"/>
<polygon fill="black" stroke="black" points="430278.55,-728.51 430267.97,-729.08 430276.6,-735.23 430278.55,-728.51"/>
</g>
<!-- layer_8_expert_1_ep_6 -->
<g id="node901" class="node">
<title>layer_8_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="430930.83,-729 430496.82,-729 430385.17,-625 430819.18,-625 430930.83,-729"/>
<text text-anchor="middle" x="430658" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="430658" y="-680" font-family="Arial" font-size="10.00">GPU: 353</text>
<text text-anchor="middle" x="430658" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="430658" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_1_ep_6 -->
<g id="edge1638" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M430683.7,-794.68C430679.82,-777.1 430675.45,-757.24 430671.43,-738.97"/>
<polygon fill="black" stroke="black" points="430674.8,-738.02 430669.23,-729 430667.97,-739.52 430674.8,-738.02"/>
</g>
<!-- layer_8_expert_2_ep_6 -->
<g id="node902" class="node">
<title>layer_8_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="431493.83,-729 431059.82,-729 430948.17,-625 431382.18,-625 431493.83,-729"/>
<text text-anchor="middle" x="431221" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="431221" y="-680" font-family="Arial" font-size="10.00">GPU: 354</text>
<text text-anchor="middle" x="431221" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="431221" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_2_ep_6 -->
<g id="edge1639" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M430854.96,-794.91C430917.06,-775.08 430988.26,-752.34 431051.26,-732.21"/>
<polygon fill="black" stroke="black" points="431052.43,-735.51 431060.89,-729.14 431050.3,-728.84 431052.43,-735.51"/>
</g>
<!-- layer_8_expert_3_ep_6 -->
<g id="node903" class="node">
<title>layer_8_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="432056.83,-729 431622.82,-729 431511.17,-625 431945.18,-625 432056.83,-729"/>
<text text-anchor="middle" x="431784" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="431784" y="-680" font-family="Arial" font-size="10.00">GPU: 355</text>
<text text-anchor="middle" x="431784" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="431784" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_3_ep_6 -->
<g id="edge1640" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M430909.63,-833.59C431073.36,-821.61 431303.88,-799.32 431503,-760 431540.41,-752.61 431580.04,-742.51 431617.37,-731.92"/>
<polygon fill="black" stroke="black" points="431618.66,-735.19 431627.31,-729.07 431616.74,-728.46 431618.66,-735.19"/>
</g>
<!-- layer_8_expert_4_ep_6 -->
<g id="node904" class="node">
<title>layer_8_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="432619.83,-729 432185.82,-729 432074.17,-625 432508.18,-625 432619.83,-729"/>
<text text-anchor="middle" x="432347" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="432347" y="-680" font-family="Arial" font-size="10.00">GPU: 356</text>
<text text-anchor="middle" x="432347" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="432347" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_4_ep_6 -->
<g id="edge1641" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M430908.27,-832.77C431291.79,-808.96 432058.95,-761.23 432066,-760 432105.11,-753.15 432146.52,-742.85 432185.19,-731.83"/>
<polygon fill="black" stroke="black" points="432186.31,-735.15 432194.95,-729.02 432184.37,-728.43 432186.31,-735.15"/>
</g>
<!-- layer_8_expert_5_ep_6 -->
<g id="node905" class="node">
<title>layer_8_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="433182.83,-729 432748.82,-729 432637.17,-625 433071.18,-625 433182.83,-729"/>
<text text-anchor="middle" x="432910" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="432910" y="-680" font-family="Arial" font-size="10.00">GPU: 357</text>
<text text-anchor="middle" x="432910" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="432910" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_5_ep_6 -->
<g id="edge1642" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M430906.51,-831.2C431073.54,-819.94 431312.57,-804.77 431522,-795 431767.86,-783.54 432385.93,-798.67 432629,-760 432669.22,-753.6 432711.8,-743.17 432751.32,-731.86"/>
<polygon fill="black" stroke="black" points="432752.39,-735.2 432761.03,-729.05 432750.45,-728.47 432752.39,-735.2"/>
</g>
<!-- layer_8_expert_6_ep_6 -->
<g id="node906" class="node">
<title>layer_8_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="433745.83,-729 433311.82,-729 433200.17,-625 433634.18,-625 433745.83,-729"/>
<text text-anchor="middle" x="433473" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="433473" y="-680" font-family="Arial" font-size="10.00">GPU: 358</text>
<text text-anchor="middle" x="433473" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="433473" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_6_ep_6 -->
<g id="edge1643" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M430906.05,-830.44C431073.08,-818.75 431312.33,-803.35 431522,-795 431892.9,-780.22 432825.23,-817.16 433192,-760 433232.47,-753.69 433275.32,-743.23 433315.03,-731.85"/>
<polygon fill="black" stroke="black" points="433316.15,-735.17 433324.78,-729.02 433314.2,-728.44 433316.15,-735.17"/>
</g>
<!-- layer_8_expert_7_ep_6 -->
<g id="node907" class="node">
<title>layer_8_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="434308.83,-729 433874.82,-729 433763.17,-625 434197.18,-625 434308.83,-729"/>
<text text-anchor="middle" x="434036" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="434036" y="-680" font-family="Arial" font-size="10.00">GPU: 359</text>
<text text-anchor="middle" x="434036" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="434036" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_6&#45;&gt;layer_8_expert_7_ep_6 -->
<g id="edge1644" class="edge">
<title>layer_8_route_ep_6&#45;&gt;layer_8_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M430905.6,-830.1C431072.65,-818.19 431312.12,-802.68 431522,-795 432215.36,-769.64 432389.29,-789.77 433083,-777 433381.71,-771.5 433459.8,-806.01 433755,-760 433795.47,-753.69 433838.32,-743.23 433878.03,-731.85"/>
<polygon fill="black" stroke="black" points="433879.15,-735.17 433887.78,-729.02 433877.2,-728.44 433879.15,-735.17"/>
</g>
<!-- layer_8_expert_0_ep_7 -->
<g id="node908" class="node">
<title>layer_8_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="425863.83,-729 425429.82,-729 425318.17,-625 425752.18,-625 425863.83,-729"/>
<text text-anchor="middle" x="425591" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="425591" y="-680" font-family="Arial" font-size="10.00">GPU: 368</text>
<text text-anchor="middle" x="425591" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="425591" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_0_ep_7 -->
<g id="edge1645" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M426086.33,-802.91C426016.05,-790.55 425941,-776.02 425872,-760 425836.93,-751.86 425799.76,-741.94 425764.32,-731.86"/>
<polygon fill="black" stroke="black" points="425764.95,-728.4 425754.38,-729.01 425763.03,-735.13 425764.95,-728.4"/>
</g>
<!-- layer_8_expert_1_ep_7 -->
<g id="node909" class="node">
<title>layer_8_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="426426.83,-729 425992.82,-729 425881.17,-625 426315.18,-625 426426.83,-729"/>
<text text-anchor="middle" x="426154" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="426154" y="-680" font-family="Arial" font-size="10.00">GPU: 369</text>
<text text-anchor="middle" x="426154" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="426154" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_1_ep_7 -->
<g id="edge1646" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M426301.53,-794.91C426277.89,-776.18 426250.97,-754.85 426226.66,-735.58"/>
<polygon fill="black" stroke="black" points="426228.54,-732.6 426218.53,-729.14 426224.19,-738.09 426228.54,-732.6"/>
</g>
<!-- layer_8_expert_2_ep_7 -->
<g id="node910" class="node">
<title>layer_8_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="426989.83,-729 426555.82,-729 426444.17,-625 426878.18,-625 426989.83,-729"/>
<text text-anchor="middle" x="426717" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="426717" y="-680" font-family="Arial" font-size="10.00">GPU: 370</text>
<text text-anchor="middle" x="426717" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="426717" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_2_ep_7 -->
<g id="edge1647" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M426472.74,-794.91C426513.33,-775.48 426559.74,-753.27 426601.14,-733.46"/>
<polygon fill="black" stroke="black" points="426602.65,-736.61 426610.16,-729.14 426599.63,-730.3 426602.65,-736.61"/>
</g>
<!-- layer_8_expert_3_ep_7 -->
<g id="node911" class="node">
<title>layer_8_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="427552.83,-729 427118.82,-729 427007.17,-625 427441.18,-625 427552.83,-729"/>
<text text-anchor="middle" x="427280" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="427280" y="-680" font-family="Arial" font-size="10.00">GPU: 371</text>
<text text-anchor="middle" x="427280" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="427280" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_3_ep_7 -->
<g id="edge1648" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M426571.52,-825.92C426696.02,-811.82 426857.57,-790.07 426999,-760 427035.39,-752.26 427073.95,-742.25 427110.46,-731.88"/>
<polygon fill="black" stroke="black" points="427111.54,-735.22 427120.19,-729.1 427109.61,-728.48 427111.54,-735.22"/>
</g>
<!-- layer_8_expert_4_ep_7 -->
<g id="node912" class="node">
<title>layer_8_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="428115.83,-729 427681.82,-729 427570.17,-625 428004.18,-625 428115.83,-729"/>
<text text-anchor="middle" x="427843" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="427843" y="-680" font-family="Arial" font-size="10.00">GPU: 372</text>
<text text-anchor="middle" x="427843" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="427843" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_4_ep_7 -->
<g id="edge1649" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M426592.06,-843.98C426833.87,-838.51 427227.77,-820.08 427562,-760 427600.73,-753.04 427641.74,-742.78 427680.11,-731.87"/>
<polygon fill="black" stroke="black" points="427681.16,-735.21 427689.81,-729.08 427679.23,-728.48 427681.16,-735.21"/>
</g>
<!-- layer_8_expert_5_ep_7 -->
<g id="node913" class="node">
<title>layer_8_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="428678.83,-729 428244.82,-729 428133.17,-625 428567.18,-625 428678.83,-729"/>
<text text-anchor="middle" x="428406" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="428406" y="-680" font-family="Arial" font-size="10.00">GPU: 373</text>
<text text-anchor="middle" x="428406" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="428406" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_5_ep_7 -->
<g id="edge1650" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M426589.34,-841.62C426994.68,-832.57 427836.2,-808.5 428125,-760 428164.5,-753.37 428206.32,-743.04 428245.28,-731.93"/>
<polygon fill="black" stroke="black" points="428246.48,-735.23 428255.12,-729.09 428244.54,-728.5 428246.48,-735.23"/>
</g>
<!-- layer_8_expert_6_ep_7 -->
<g id="node914" class="node">
<title>layer_8_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="429241.83,-729 428807.82,-729 428696.17,-625 429130.18,-625 429241.83,-729"/>
<text text-anchor="middle" x="428969" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="428969" y="-680" font-family="Arial" font-size="10.00">GPU: 374</text>
<text text-anchor="middle" x="428969" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="428969" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_6_ep_7 -->
<g id="edge1651" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M426593.09,-844.71C427095.8,-840.7 428289.66,-824.48 428688,-760 428728,-753.52 428770.35,-743.13 428809.7,-731.88"/>
<polygon fill="black" stroke="black" points="428811,-735.15 428819.64,-729 428809.06,-728.42 428811,-735.15"/>
</g>
<!-- layer_8_expert_7_ep_7 -->
<g id="node915" class="node">
<title>layer_8_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="429804.83,-729 429370.82,-729 429259.17,-625 429693.18,-625 429804.83,-729"/>
<text text-anchor="middle" x="429532" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="429532" y="-680" font-family="Arial" font-size="10.00">GPU: 375</text>
<text text-anchor="middle" x="429532" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="429532" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_8_route_ep_7&#45;&gt;layer_8_expert_7_ep_7 -->
<g id="edge1652" class="edge">
<title>layer_8_route_ep_7&#45;&gt;layer_8_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M426595.1,-846.67C427184.24,-847.18 428741.29,-840.62 429251,-760 429291.23,-753.64 429333.81,-743.22 429373.32,-731.92"/>
<polygon fill="black" stroke="black" points="429374.4,-735.25 429383.03,-729.1 429372.45,-728.52 429374.4,-735.25"/>
</g>
<!-- layer_8_agg_ep_0 -->
<g id="node916" class="node">
<title>layer_8_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="401102.07,-559 400651.77,-559 400535.93,-455 400986.23,-455 401102.07,-559"/>
<text text-anchor="middle" x="400819" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="400819" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="400819" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="400819" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1653" class="edge">
<title>layer_8_expert_0_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M398744.89,-640.38C398779.01,-634.5 398814.52,-629.02 398848,-625 399475.39,-549.72 400221.2,-522.19 400589.6,-512.68"/>
<polygon fill="black" stroke="black" points="400589.94,-516.17 400599.85,-512.41 400589.76,-509.17 400589.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1654" class="edge">
<title>layer_8_expert_1_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M399308.35,-640.96C399342.34,-635.04 399377.7,-629.4 399411,-625 399828.36,-569.92 400318.96,-536.1 400597,-519.8"/>
<polygon fill="black" stroke="black" points="400597.43,-523.28 400607.21,-519.2 400597.02,-516.29 400597.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1655" class="edge">
<title>layer_8_expert_2_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M399872.69,-642.23C399906.32,-636.24 399941.2,-630.25 399974,-625 400191.23,-590.26 400440.86,-556.45 400612.16,-534.18"/>
<polygon fill="black" stroke="black" points="400612.83,-537.62 400622.3,-532.86 400611.93,-530.68 400612.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1656" class="edge">
<title>layer_8_expert_3_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M400419.6,-627.18C400488.9,-606.5 400569.84,-582.35 400640.67,-561.21"/>
<polygon fill="black" stroke="black" points="400642.01,-564.47 400650.59,-558.25 400640.01,-557.76 400642.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1657" class="edge">
<title>layer_8_expert_4_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M400819,-624.68C400819,-607.18 400819,-587.43 400819,-569.22"/>
<polygon fill="black" stroke="black" points="400822.5,-569 400819,-559 400815.5,-569 400822.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1658" class="edge">
<title>layer_8_expert_5_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M401210.79,-624.91C401144.19,-605.04 401067.8,-582.24 401000.26,-562.09"/>
<polygon fill="black" stroke="black" points="401000.95,-558.64 400990.37,-559.14 400998.95,-565.35 401000.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1659" class="edge">
<title>layer_8_expert_6_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M401673.6,-626.55C401670.38,-626.02 401667.18,-625.51 401664,-625 401473.84,-594.59 401258.86,-564.89 401093.33,-543.02"/>
<polygon fill="black" stroke="black" points="401093.37,-539.5 401083,-541.66 401092.45,-546.44 401093.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_0&#45;&gt;layer_8_agg_ep_0 -->
<g id="edge1660" class="edge">
<title>layer_8_expert_7_ep_0&#45;&gt;layer_8_agg_ep_0</title>
<path fill="none" stroke="black" d="M402236.27,-626.25C402233.16,-625.82 402230.07,-625.41 402227,-625 401823.9,-571.8 401352.48,-538.44 401070.24,-521.53"/>
<polygon fill="black" stroke="black" points="401070.05,-518.01 401059.86,-520.91 401069.63,-525 401070.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_1 -->
<g id="node917" class="node">
<title>layer_8_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="423622.07,-559 423171.77,-559 423055.93,-455 423506.23,-455 423622.07,-559"/>
<text text-anchor="middle" x="423339" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="423339" y="-510" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="423339" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="423339" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1662" class="edge">
<title>layer_8_expert_0_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M421264.89,-640.38C421299.01,-634.5 421334.52,-629.02 421368,-625 421995.39,-549.72 422741.2,-522.19 423109.6,-512.68"/>
<polygon fill="black" stroke="black" points="423109.94,-516.17 423119.85,-512.41 423109.76,-509.17 423109.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1663" class="edge">
<title>layer_8_expert_1_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M421828.35,-640.96C421862.34,-635.04 421897.7,-629.4 421931,-625 422348.36,-569.92 422838.96,-536.1 423117,-519.8"/>
<polygon fill="black" stroke="black" points="423117.43,-523.28 423127.21,-519.2 423117.02,-516.29 423117.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1664" class="edge">
<title>layer_8_expert_2_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M422392.69,-642.23C422426.32,-636.24 422461.2,-630.25 422494,-625 422711.23,-590.26 422960.86,-556.45 423132.16,-534.18"/>
<polygon fill="black" stroke="black" points="423132.83,-537.62 423142.3,-532.86 423131.93,-530.68 423132.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1665" class="edge">
<title>layer_8_expert_3_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M422939.6,-627.18C423008.9,-606.5 423089.84,-582.35 423160.67,-561.21"/>
<polygon fill="black" stroke="black" points="423162.01,-564.47 423170.59,-558.25 423160.01,-557.76 423162.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1666" class="edge">
<title>layer_8_expert_4_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M423339,-624.68C423339,-607.18 423339,-587.43 423339,-569.22"/>
<polygon fill="black" stroke="black" points="423342.5,-569 423339,-559 423335.5,-569 423342.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1667" class="edge">
<title>layer_8_expert_5_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M423730.79,-624.91C423664.19,-605.04 423587.8,-582.24 423520.26,-562.09"/>
<polygon fill="black" stroke="black" points="423520.95,-558.64 423510.37,-559.14 423518.95,-565.35 423520.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1668" class="edge">
<title>layer_8_expert_6_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M424193.6,-626.55C424190.38,-626.02 424187.18,-625.51 424184,-625 423993.84,-594.59 423778.86,-564.89 423613.33,-543.02"/>
<polygon fill="black" stroke="black" points="423613.37,-539.5 423603,-541.66 423612.45,-546.44 423613.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_1&#45;&gt;layer_8_agg_ep_1 -->
<g id="edge1669" class="edge">
<title>layer_8_expert_7_ep_1&#45;&gt;layer_8_agg_ep_1</title>
<path fill="none" stroke="black" d="M424756.27,-626.25C424753.16,-625.82 424750.07,-625.41 424747,-625 424343.9,-571.8 423872.48,-538.44 423590.24,-521.53"/>
<polygon fill="black" stroke="black" points="423590.05,-518.01 423579.86,-520.91 423589.63,-525 423590.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_2 -->
<g id="node918" class="node">
<title>layer_8_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="405606.07,-559 405155.77,-559 405039.93,-455 405490.23,-455 405606.07,-559"/>
<text text-anchor="middle" x="405323" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="405323" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="405323" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="405323" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1671" class="edge">
<title>layer_8_expert_0_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M403248.89,-640.38C403283.01,-634.5 403318.52,-629.02 403352,-625 403979.39,-549.72 404725.2,-522.19 405093.6,-512.68"/>
<polygon fill="black" stroke="black" points="405093.94,-516.17 405103.85,-512.41 405093.76,-509.17 405093.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1672" class="edge">
<title>layer_8_expert_1_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M403812.35,-640.96C403846.34,-635.04 403881.7,-629.4 403915,-625 404332.36,-569.92 404822.96,-536.1 405101,-519.8"/>
<polygon fill="black" stroke="black" points="405101.43,-523.28 405111.21,-519.2 405101.02,-516.29 405101.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1673" class="edge">
<title>layer_8_expert_2_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M404376.69,-642.23C404410.32,-636.24 404445.2,-630.25 404478,-625 404695.23,-590.26 404944.86,-556.45 405116.16,-534.18"/>
<polygon fill="black" stroke="black" points="405116.83,-537.62 405126.3,-532.86 405115.93,-530.68 405116.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1674" class="edge">
<title>layer_8_expert_3_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M404923.6,-627.18C404992.9,-606.5 405073.84,-582.35 405144.67,-561.21"/>
<polygon fill="black" stroke="black" points="405146.01,-564.47 405154.59,-558.25 405144.01,-557.76 405146.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1675" class="edge">
<title>layer_8_expert_4_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M405323,-624.68C405323,-607.18 405323,-587.43 405323,-569.22"/>
<polygon fill="black" stroke="black" points="405326.5,-569 405323,-559 405319.5,-569 405326.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1676" class="edge">
<title>layer_8_expert_5_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M405714.79,-624.91C405648.19,-605.04 405571.8,-582.24 405504.26,-562.09"/>
<polygon fill="black" stroke="black" points="405504.95,-558.64 405494.37,-559.14 405502.95,-565.35 405504.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1677" class="edge">
<title>layer_8_expert_6_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M406177.6,-626.55C406174.38,-626.02 406171.18,-625.51 406168,-625 405977.84,-594.59 405762.86,-564.89 405597.33,-543.02"/>
<polygon fill="black" stroke="black" points="405597.37,-539.5 405587,-541.66 405596.45,-546.44 405597.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_2&#45;&gt;layer_8_agg_ep_2 -->
<g id="edge1678" class="edge">
<title>layer_8_expert_7_ep_2&#45;&gt;layer_8_agg_ep_2</title>
<path fill="none" stroke="black" d="M406740.27,-626.25C406737.16,-625.82 406734.07,-625.41 406731,-625 406327.9,-571.8 405856.48,-538.44 405574.24,-521.53"/>
<polygon fill="black" stroke="black" points="405574.05,-518.01 405563.86,-520.91 405573.63,-525 405574.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_3 -->
<g id="node919" class="node">
<title>layer_8_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="419118.07,-559 418667.77,-559 418551.93,-455 419002.23,-455 419118.07,-559"/>
<text text-anchor="middle" x="418835" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="418835" y="-510" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="418835" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="418835" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1680" class="edge">
<title>layer_8_expert_0_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M416197.48,-640.09C416231.71,-634.21 416267.38,-628.81 416301,-625 417143.79,-529.49 418152.69,-511.47 418600.76,-508.4"/>
<polygon fill="black" stroke="black" points="418600.93,-511.9 418610.91,-508.33 418600.89,-504.9 418600.93,-511.9"/>
</g>
<!-- layer_8_expert_1_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1681" class="edge">
<title>layer_8_expert_1_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M416760.89,-640.38C416795.01,-634.5 416830.52,-629.02 416864,-625 417491.39,-549.72 418237.2,-522.19 418605.6,-512.68"/>
<polygon fill="black" stroke="black" points="418605.94,-516.17 418615.85,-512.41 418605.76,-509.17 418605.94,-516.17"/>
</g>
<!-- layer_8_expert_2_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1682" class="edge">
<title>layer_8_expert_2_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M417324.35,-640.96C417358.34,-635.04 417393.7,-629.4 417427,-625 417844.36,-569.92 418334.96,-536.1 418613,-519.8"/>
<polygon fill="black" stroke="black" points="418613.43,-523.28 418623.21,-519.2 418613.02,-516.29 418613.43,-523.28"/>
</g>
<!-- layer_8_expert_3_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1683" class="edge">
<title>layer_8_expert_3_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M418435.6,-627.18C418504.9,-606.5 418585.84,-582.35 418656.67,-561.21"/>
<polygon fill="black" stroke="black" points="418658.01,-564.47 418666.59,-558.25 418656.01,-557.76 418658.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1684" class="edge">
<title>layer_8_expert_4_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M418835,-624.68C418835,-607.18 418835,-587.43 418835,-569.22"/>
<polygon fill="black" stroke="black" points="418838.5,-569 418835,-559 418831.5,-569 418838.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1685" class="edge">
<title>layer_8_expert_5_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M419226.79,-624.91C419160.19,-605.04 419083.8,-582.24 419016.26,-562.09"/>
<polygon fill="black" stroke="black" points="419016.95,-558.64 419006.37,-559.14 419014.95,-565.35 419016.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1686" class="edge">
<title>layer_8_expert_6_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M419689.6,-626.55C419686.38,-626.02 419683.18,-625.51 419680,-625 419489.84,-594.59 419274.86,-564.89 419109.33,-543.02"/>
<polygon fill="black" stroke="black" points="419109.37,-539.5 419099,-541.66 419108.45,-546.44 419109.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_3&#45;&gt;layer_8_agg_ep_3 -->
<g id="edge1687" class="edge">
<title>layer_8_expert_7_ep_3&#45;&gt;layer_8_agg_ep_3</title>
<path fill="none" stroke="black" d="M420252.27,-626.25C420249.16,-625.82 420246.07,-625.41 420243,-625 419839.9,-571.8 419368.48,-538.44 419086.24,-521.53"/>
<polygon fill="black" stroke="black" points="419086.05,-518.01 419075.86,-520.91 419085.63,-525 419086.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_4 -->
<g id="node920" class="node">
<title>layer_8_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="414614.07,-559 414163.77,-559 414047.93,-455 414498.23,-455 414614.07,-559"/>
<text text-anchor="middle" x="414331" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="414331" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="414331" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="414331" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1689" class="edge">
<title>layer_8_expert_0_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M412256.89,-640.38C412291.01,-634.5 412326.52,-629.02 412360,-625 412987.39,-549.72 413733.2,-522.19 414101.6,-512.68"/>
<polygon fill="black" stroke="black" points="414101.94,-516.17 414111.85,-512.41 414101.76,-509.17 414101.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1690" class="edge">
<title>layer_8_expert_1_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M412820.35,-640.96C412854.34,-635.04 412889.7,-629.4 412923,-625 413340.36,-569.92 413830.96,-536.1 414109,-519.8"/>
<polygon fill="black" stroke="black" points="414109.43,-523.28 414119.21,-519.2 414109.02,-516.29 414109.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1691" class="edge">
<title>layer_8_expert_2_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M413384.69,-642.23C413418.32,-636.24 413453.2,-630.25 413486,-625 413703.23,-590.26 413952.86,-556.45 414124.16,-534.18"/>
<polygon fill="black" stroke="black" points="414124.83,-537.62 414134.3,-532.86 414123.93,-530.68 414124.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1692" class="edge">
<title>layer_8_expert_3_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M413931.6,-627.18C414000.9,-606.5 414081.84,-582.35 414152.67,-561.21"/>
<polygon fill="black" stroke="black" points="414154.01,-564.47 414162.59,-558.25 414152.01,-557.76 414154.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1693" class="edge">
<title>layer_8_expert_4_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M414331,-624.68C414331,-607.18 414331,-587.43 414331,-569.22"/>
<polygon fill="black" stroke="black" points="414334.5,-569 414331,-559 414327.5,-569 414334.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1694" class="edge">
<title>layer_8_expert_5_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M414722.79,-624.91C414656.19,-605.04 414579.8,-582.24 414512.26,-562.09"/>
<polygon fill="black" stroke="black" points="414512.95,-558.64 414502.37,-559.14 414510.95,-565.35 414512.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1695" class="edge">
<title>layer_8_expert_6_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M415185.6,-626.55C415182.38,-626.02 415179.18,-625.51 415176,-625 414985.84,-594.59 414770.86,-564.89 414605.33,-543.02"/>
<polygon fill="black" stroke="black" points="414605.37,-539.5 414595,-541.66 414604.45,-546.44 414605.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_4&#45;&gt;layer_8_agg_ep_4 -->
<g id="edge1696" class="edge">
<title>layer_8_expert_7_ep_4&#45;&gt;layer_8_agg_ep_4</title>
<path fill="none" stroke="black" d="M417437.29,-626.05C417434.18,-625.69 417431.08,-625.34 417428,-625 416875.95,-564.78 415200.66,-525.61 414572.41,-512.69"/>
<polygon fill="black" stroke="black" points="414572.39,-509.19 414562.32,-512.48 414572.25,-516.19 414572.39,-509.19"/>
</g>
<!-- layer_8_agg_ep_5 -->
<g id="node921" class="node">
<title>layer_8_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="410110.07,-559 409659.77,-559 409543.93,-455 409994.23,-455 410110.07,-559"/>
<text text-anchor="middle" x="409827" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="409827" y="-510" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="409827" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="409827" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1698" class="edge">
<title>layer_8_expert_0_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M407752.89,-640.38C407787.01,-634.5 407822.52,-629.02 407856,-625 408483.39,-549.72 409229.2,-522.19 409597.6,-512.68"/>
<polygon fill="black" stroke="black" points="409597.94,-516.17 409607.85,-512.41 409597.76,-509.17 409597.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1699" class="edge">
<title>layer_8_expert_1_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M408316.35,-640.96C408350.34,-635.04 408385.7,-629.4 408419,-625 408836.36,-569.92 409326.96,-536.1 409605,-519.8"/>
<polygon fill="black" stroke="black" points="409605.43,-523.28 409615.21,-519.2 409605.02,-516.29 409605.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1700" class="edge">
<title>layer_8_expert_2_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M408880.69,-642.23C408914.32,-636.24 408949.2,-630.25 408982,-625 409199.23,-590.26 409448.86,-556.45 409620.16,-534.18"/>
<polygon fill="black" stroke="black" points="409620.83,-537.62 409630.3,-532.86 409619.93,-530.68 409620.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1701" class="edge">
<title>layer_8_expert_3_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M409427.6,-627.18C409496.9,-606.5 409577.84,-582.35 409648.67,-561.21"/>
<polygon fill="black" stroke="black" points="409650.01,-564.47 409658.59,-558.25 409648.01,-557.76 409650.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1702" class="edge">
<title>layer_8_expert_4_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M409827,-624.68C409827,-607.18 409827,-587.43 409827,-569.22"/>
<polygon fill="black" stroke="black" points="409830.5,-569 409827,-559 409823.5,-569 409830.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1703" class="edge">
<title>layer_8_expert_5_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M410218.79,-624.91C410152.19,-605.04 410075.8,-582.24 410008.26,-562.09"/>
<polygon fill="black" stroke="black" points="410008.95,-558.64 409998.37,-559.14 410006.95,-565.35 410008.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1704" class="edge">
<title>layer_8_expert_6_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M410681.6,-626.55C410678.38,-626.02 410675.18,-625.51 410672,-625 410481.84,-594.59 410266.86,-564.89 410101.33,-543.02"/>
<polygon fill="black" stroke="black" points="410101.37,-539.5 410091,-541.66 410100.45,-546.44 410101.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_5&#45;&gt;layer_8_agg_ep_5 -->
<g id="edge1705" class="edge">
<title>layer_8_expert_7_ep_5&#45;&gt;layer_8_agg_ep_5</title>
<path fill="none" stroke="black" d="M411244.27,-626.25C411241.16,-625.82 411238.07,-625.41 411235,-625 410831.9,-571.8 410360.48,-538.44 410078.24,-521.53"/>
<polygon fill="black" stroke="black" points="410078.05,-518.01 410067.86,-520.91 410077.63,-525 410078.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_6 -->
<g id="node922" class="node">
<title>layer_8_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="432630.07,-559 432179.77,-559 432063.93,-455 432514.23,-455 432630.07,-559"/>
<text text-anchor="middle" x="432347" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="432347" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="432347" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="432347" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1707" class="edge">
<title>layer_8_expert_0_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M430272.89,-640.38C430307.01,-634.5 430342.52,-629.02 430376,-625 431003.39,-549.72 431749.2,-522.19 432117.6,-512.68"/>
<polygon fill="black" stroke="black" points="432117.94,-516.17 432127.85,-512.41 432117.76,-509.17 432117.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1708" class="edge">
<title>layer_8_expert_1_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M430836.35,-640.96C430870.34,-635.04 430905.7,-629.4 430939,-625 431356.36,-569.92 431846.96,-536.1 432125,-519.8"/>
<polygon fill="black" stroke="black" points="432125.43,-523.28 432135.21,-519.2 432125.02,-516.29 432125.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1709" class="edge">
<title>layer_8_expert_2_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M431400.69,-642.23C431434.32,-636.24 431469.2,-630.25 431502,-625 431719.23,-590.26 431968.86,-556.45 432140.16,-534.18"/>
<polygon fill="black" stroke="black" points="432140.83,-537.62 432150.3,-532.86 432139.93,-530.68 432140.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1710" class="edge">
<title>layer_8_expert_3_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M431947.6,-627.18C432016.9,-606.5 432097.84,-582.35 432168.67,-561.21"/>
<polygon fill="black" stroke="black" points="432170.01,-564.47 432178.59,-558.25 432168.01,-557.76 432170.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1711" class="edge">
<title>layer_8_expert_4_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M432347,-624.68C432347,-607.18 432347,-587.43 432347,-569.22"/>
<polygon fill="black" stroke="black" points="432350.5,-569 432347,-559 432343.5,-569 432350.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1712" class="edge">
<title>layer_8_expert_5_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M432738.79,-624.91C432672.19,-605.04 432595.8,-582.24 432528.26,-562.09"/>
<polygon fill="black" stroke="black" points="432528.95,-558.64 432518.37,-559.14 432526.95,-565.35 432528.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1713" class="edge">
<title>layer_8_expert_6_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M433201.6,-626.55C433198.38,-626.02 433195.18,-625.51 433192,-625 433001.84,-594.59 432786.86,-564.89 432621.33,-543.02"/>
<polygon fill="black" stroke="black" points="432621.37,-539.5 432611,-541.66 432620.45,-546.44 432621.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_6&#45;&gt;layer_8_agg_ep_6 -->
<g id="edge1714" class="edge">
<title>layer_8_expert_7_ep_6&#45;&gt;layer_8_agg_ep_6</title>
<path fill="none" stroke="black" d="M433764.27,-626.25C433761.16,-625.82 433758.07,-625.41 433755,-625 433351.9,-571.8 432880.48,-538.44 432598.24,-521.53"/>
<polygon fill="black" stroke="black" points="432598.05,-518.01 432587.86,-520.91 432597.63,-525 432598.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_7 -->
<g id="node923" class="node">
<title>layer_8_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="428126.07,-559 427675.77,-559 427559.93,-455 428010.23,-455 428126.07,-559"/>
<text text-anchor="middle" x="427843" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="427843" y="-510" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="427843" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="427843" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_expert_0_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1716" class="edge">
<title>layer_8_expert_0_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M425768.89,-640.38C425803.01,-634.5 425838.52,-629.02 425872,-625 426499.39,-549.72 427245.2,-522.19 427613.6,-512.68"/>
<polygon fill="black" stroke="black" points="427613.94,-516.17 427623.85,-512.41 427613.76,-509.17 427613.94,-516.17"/>
</g>
<!-- layer_8_expert_1_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1717" class="edge">
<title>layer_8_expert_1_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M426332.35,-640.96C426366.34,-635.04 426401.7,-629.4 426435,-625 426852.36,-569.92 427342.96,-536.1 427621,-519.8"/>
<polygon fill="black" stroke="black" points="427621.43,-523.28 427631.21,-519.2 427621.02,-516.29 427621.43,-523.28"/>
</g>
<!-- layer_8_expert_2_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1718" class="edge">
<title>layer_8_expert_2_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M426896.69,-642.23C426930.32,-636.24 426965.2,-630.25 426998,-625 427215.23,-590.26 427464.86,-556.45 427636.16,-534.18"/>
<polygon fill="black" stroke="black" points="427636.83,-537.62 427646.3,-532.86 427635.93,-530.68 427636.83,-537.62"/>
</g>
<!-- layer_8_expert_3_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1719" class="edge">
<title>layer_8_expert_3_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M427443.6,-627.18C427512.9,-606.5 427593.84,-582.35 427664.67,-561.21"/>
<polygon fill="black" stroke="black" points="427666.01,-564.47 427674.59,-558.25 427664.01,-557.76 427666.01,-564.47"/>
</g>
<!-- layer_8_expert_4_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1720" class="edge">
<title>layer_8_expert_4_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M427843,-624.68C427843,-607.18 427843,-587.43 427843,-569.22"/>
<polygon fill="black" stroke="black" points="427846.5,-569 427843,-559 427839.5,-569 427846.5,-569"/>
</g>
<!-- layer_8_expert_5_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1721" class="edge">
<title>layer_8_expert_5_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M428234.79,-624.91C428168.19,-605.04 428091.8,-582.24 428024.26,-562.09"/>
<polygon fill="black" stroke="black" points="428024.95,-558.64 428014.37,-559.14 428022.95,-565.35 428024.95,-558.64"/>
</g>
<!-- layer_8_expert_6_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1722" class="edge">
<title>layer_8_expert_6_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M428697.6,-626.55C428694.38,-626.02 428691.18,-625.51 428688,-625 428497.84,-594.59 428282.86,-564.89 428117.33,-543.02"/>
<polygon fill="black" stroke="black" points="428117.37,-539.5 428107,-541.66 428116.45,-546.44 428117.37,-539.5"/>
</g>
<!-- layer_8_expert_7_ep_7&#45;&gt;layer_8_agg_ep_7 -->
<g id="edge1723" class="edge">
<title>layer_8_expert_7_ep_7&#45;&gt;layer_8_agg_ep_7</title>
<path fill="none" stroke="black" d="M429260.27,-626.25C429257.16,-625.82 429254.07,-625.41 429251,-625 428847.9,-571.8 428376.48,-538.44 428094.24,-521.53"/>
<polygon fill="black" stroke="black" points="428094.05,-518.01 428083.86,-520.91 428093.63,-525 428094.05,-518.01"/>
</g>
<!-- layer_8_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1661" class="edge">
<title>layer_8_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M401038.51,-501.85C401662.95,-490.26 403502.8,-457.75 405031,-447 405031,-447 580629,-437 580629,-437 580681.97,-384.03 580353.38,-454.33 580293,-410 580245.95,-375.46 580294,-321.61 580247,-287 580158.77,-222.02 579417.27,-217.01 579136.32,-217.47"/>
<polygon fill="black" stroke="black" points="579136.11,-213.97 579126.12,-217.49 579136.12,-220.97 579136.11,-213.97"/>
</g>
<!-- layer_8_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1670" class="edge">
<title>layer_8_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M423558.51,-501.85C424182.95,-490.26 426022.8,-457.75 427551,-447 427551,-447 580754,-437 580754,-437 580796.79,-394.2 580531.56,-446.12 580483,-410 580436.17,-375.16 580484.13,-321.43 580437,-287 580384.87,-248.92 579461.99,-226.73 579139.29,-220.11"/>
<polygon fill="black" stroke="black" points="579139.07,-216.61 579129,-219.9 579138.92,-223.61 579139.07,-216.61"/>
</g>
<!-- layer_8_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1679" class="edge">
<title>layer_8_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M405542.51,-501.85C406166.95,-490.26 408006.8,-457.75 409535,-447 409535,-447 580654,-437 580654,-437 580704.93,-386.07 580389.02,-452.68 580331,-410 580283.99,-375.41 580332.03,-321.57 580285,-287 580193.59,-219.8 579422.96,-216.23 579136.06,-217.27"/>
<polygon fill="black" stroke="black" points="579135.63,-213.77 579125.65,-217.31 579135.66,-220.77 579135.63,-213.77"/>
</g>
<!-- layer_8_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1688" class="edge">
<title>layer_8_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M419054.51,-501.85C419678.95,-490.26 421518.8,-457.75 423047,-447 423047,-447 580704,-437 580704,-437 580744.92,-396.08 580495.2,-438.78 580445,-410 580387.57,-377.08 580418.72,-319.41 580361,-287 580255.56,-227.79 579435.26,-219.27 579136.98,-218.13"/>
<polygon fill="black" stroke="black" points="579136.6,-214.63 579126.59,-218.1 579136.57,-221.63 579136.6,-214.63"/>
</g>
<!-- layer_8_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1697" class="edge">
<title>layer_8_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M414550.51,-501.85C415174.95,-490.26 417014.8,-457.75 418543,-447 418543,-447 580707,-437 580707,-437 580748.39,-395.61 580494.56,-441.14 580445,-410 580391.74,-376.54 580428.55,-320 580375,-287 580270.7,-222.72 579436.19,-217.44 579136.05,-217.64"/>
<polygon fill="black" stroke="black" points="579136.03,-214.14 579126.03,-217.65 579136.04,-221.14 579136.03,-214.14"/>
</g>
<!-- layer_8_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1706" class="edge">
<title>layer_8_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M410046.51,-501.85C410670.95,-490.26 412510.8,-457.75 414039,-447 414039,-447 580679,-437 580679,-437 580727.27,-388.73 580428.49,-449.76 580373,-410 580325.03,-375.63 580371.06,-321.24 580323,-287 580227.42,-218.91 579428.05,-215.98 579135.62,-217.22"/>
<polygon fill="black" stroke="black" points="579135.41,-213.72 579125.43,-217.27 579135.45,-220.72 579135.41,-213.72"/>
</g>
<!-- layer_8_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1715" class="edge">
<title>layer_8_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M432563.51,-498.88C432983.29,-485.47 433937.22,-456.92 434740,-447 434740,-447 580804,-437 580804,-437 580842.73,-398.27 580602.83,-442.85 580559,-410 580512.3,-375 580560.17,-321.37 580513,-287 580457.67,-246.68 579472.94,-225.77 579138.84,-219.82"/>
<polygon fill="black" stroke="black" points="579138.72,-216.31 579128.66,-219.64 579138.6,-223.31 579138.72,-216.31"/>
</g>
<!-- layer_8_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1724" class="edge">
<title>layer_8_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M428062.51,-501.85C428686.95,-490.26 430526.8,-457.75 432055,-447 432055,-447 580779,-437 580779,-437 580819.76,-396.24 580567.19,-444.49 580521,-410 580474.23,-375.08 580522.15,-321.4 580475,-287 580421.26,-247.79 579467.16,-226.24 579138.89,-219.96"/>
<polygon fill="black" stroke="black" points="579138.95,-216.46 579128.89,-219.77 579138.82,-223.46 579138.95,-216.46"/>
</g>
<!-- layer_8_moe_alltoall -->
<g id="node924" class="node">
<title>layer_8_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="422861" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="422861" y="-1031" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="422861" y="-1020" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="422861" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="422861" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_8_ln_tp_0 -->
<g id="node925" class="node">
<title>layer_8_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="427724.07,-1069 427273.77,-1069 427157.93,-965 427608.23,-965 427724.07,-1069"/>
<text text-anchor="middle" x="427441" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="427441" y="-1020" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="427441" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="427441" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_qkv_tp_0 -->
<g id="node929" class="node">
<title>layer_9_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="396547.7,-899 396105.94,-899 395992.3,-795 396434.06,-795 396547.7,-899"/>
<text text-anchor="middle" x="396270" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="396270" y="-850" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="396270" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="396270" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_8_ln_tp_0&#45;&gt;layer_9_qkv_tp_0 -->
<g id="edge3109" class="edge">
<title>layer_8_ln_tp_0&#45;&gt;layer_9_qkv_tp_0</title>
<path fill="none" stroke="black" d="M427210.13,-964.96C427189.54,-961.74 427168.94,-959 427149,-957 427045.75,-946.66 397367.76,-948.26 397264,-947 396949.71,-943.17 396867.73,-977.33 396557,-930 396515.62,-923.7 396471.78,-913.21 396431.15,-901.8"/>
<polygon fill="black" stroke="black" points="396432.02,-898.41 396421.45,-899.04 396430.11,-905.14 396432.02,-898.41"/>
</g>
<!-- layer_8_ln_tp_1 -->
<g id="node926" class="node">
<title>layer_8_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="428308.07,-1069 427857.77,-1069 427741.93,-965 428192.23,-965 428308.07,-1069"/>
<text text-anchor="middle" x="428025" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="428025" y="-1020" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="428025" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="428025" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_qkv_tp_1 -->
<g id="node930" class="node">
<title>layer_9_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="397121.7,-899 396679.94,-899 396566.3,-795 397008.06,-795 397121.7,-899"/>
<text text-anchor="middle" x="396844" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="396844" y="-850" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="396844" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="396844" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_8_ln_tp_1&#45;&gt;layer_9_qkv_tp_1 -->
<g id="edge3110" class="edge">
<title>layer_8_ln_tp_1&#45;&gt;layer_9_qkv_tp_1</title>
<path fill="none" stroke="black" d="M427794.13,-964.96C427773.54,-961.74 427752.94,-959 427733,-957 427629.22,-946.6 397800.28,-948.59 397696,-947 397444.8,-943.18 397379.24,-968.58 397131,-930 397089.88,-923.61 397046.31,-913.16 397005.88,-901.82"/>
<polygon fill="black" stroke="black" points="397006.79,-898.44 396996.22,-899.08 397004.88,-905.18 397006.79,-898.44"/>
</g>
<!-- layer_8_ln_tp_2 -->
<g id="node927" class="node">
<title>layer_8_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="431035.07,-1069 430584.77,-1069 430468.93,-965 430919.23,-965 431035.07,-1069"/>
<text text-anchor="middle" x="430752" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="430752" y="-1020" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="430752" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="430752" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_qkv_tp_2 -->
<g id="node931" class="node">
<title>layer_9_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="398269.7,-899 397827.94,-899 397714.3,-795 398156.06,-795 398269.7,-899"/>
<text text-anchor="middle" x="397992" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="397992" y="-850" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="397992" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="397992" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_8_ln_tp_2&#45;&gt;layer_9_qkv_tp_2 -->
<g id="edge3111" class="edge">
<title>layer_8_ln_tp_2&#45;&gt;layer_9_qkv_tp_2</title>
<path fill="none" stroke="black" d="M430521.13,-964.96C430500.54,-961.74 430479.94,-959 430460,-957 430376.72,-948.65 406439.69,-947.11 406356,-947 406299.93,-946.93 398337.53,-937.76 398282,-930 398239.34,-924.04 398194.12,-913.43 398152.4,-901.78"/>
<polygon fill="black" stroke="black" points="398153.29,-898.39 398142.72,-899.04 398151.39,-905.13 398153.29,-898.39"/>
</g>
<!-- layer_8_ln_tp_3 -->
<g id="node928" class="node">
<title>layer_8_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="428892.07,-1069 428441.77,-1069 428325.93,-965 428776.23,-965 428892.07,-1069"/>
<text text-anchor="middle" x="428609" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="428609" y="-1020" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="428609" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="428609" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_qkv_tp_3 -->
<g id="node932" class="node">
<title>layer_9_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="397695.7,-899 397253.94,-899 397140.3,-795 397582.06,-795 397695.7,-899"/>
<text text-anchor="middle" x="397418" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="397418" y="-850" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="397418" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="397418" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_8_ln_tp_3&#45;&gt;layer_9_qkv_tp_3 -->
<g id="edge3112" class="edge">
<title>layer_8_ln_tp_3&#45;&gt;layer_9_qkv_tp_3</title>
<path fill="none" stroke="black" d="M428378.13,-964.96C428357.54,-961.74 428336.94,-959 428317,-957 428222.21,-947.5 400977.26,-947.27 400882,-947 400705.5,-946.5 397879.73,-954.95 397705,-930 397662.97,-924 397618.44,-913.44 397577.33,-901.85"/>
<polygon fill="black" stroke="black" points="397578.08,-898.43 397567.51,-899.05 397576.16,-905.16 397578.08,-898.43"/>
</g>
<!-- layer_9_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1733" class="edge">
<title>layer_9_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M396449.63,-809.09C396485.07,-803.22 396522.09,-798.08 396557,-795 396713.11,-781.23 576934.29,-777.52 577091,-777 577163.5,-776.76 579640.56,-800.04 579701,-760 579818.22,-682.35 579835.95,-555.89 579747,-447 579738.82,-436.99 579704.75,-430.14 579692,-428 579692,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_9_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1734" class="edge">
<title>layer_9_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M397023.63,-809.09C397059.07,-803.22 397096.09,-798.08 397131,-795 397287.73,-781.18 578224.67,-777.98 578382,-777 578458.78,-776.52 579701.85,-805.1 579764,-760 579876.95,-678.04 579882.24,-550.84 579789,-447 579787.74,-445.6 579725.86,-428.27 579724,-428 579724,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_9_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1735" class="edge">
<title>layer_9_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M398171.97,-809.35C398208.25,-803.37 398246.22,-798.12 398282,-795 398595.34,-767.64 579136.53,-783.29 579451,-777 579545.72,-775.11 579802.47,-818.49 579877,-760 579986.47,-674.1 579987.7,-539.77 579884,-447 579871.14,-435.5 579823.84,-440.77 579807,-437 579794.24,-434.15 579791.91,-430.02 579779,-428 579779,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_9_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1736" class="edge">
<title>layer_9_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M397597.63,-809.09C397633.07,-803.22 397670.09,-798.08 397705,-795 397861.83,-781.17 578914.57,-778.79 579072,-777 579155.35,-776.05 579755.68,-810.49 579822,-760 579932.78,-675.66 579934.85,-544.03 579835,-447 579817.81,-430.29 579805.26,-442.78 579782,-437 579768.9,-433.74 579766.34,-430.02 579753,-428 579753,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_9_qkv_comm -->
<g id="node933" class="node">
<title>layer_9_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="395781" cy="-847" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="395781" y="-861" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="395781" y="-850" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="395781" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="395781" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_9_attn_tp_0 -->
<g id="node934" class="node">
<title>layer_9_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="392822.7,-899 392380.94,-899 392267.3,-795 392709.06,-795 392822.7,-899"/>
<text text-anchor="middle" x="392545" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="392545" y="-850" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="392545" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="392545" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_out_tp_0 -->
<g id="node938" class="node">
<title>layer_9_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="392822.7,-729 392380.94,-729 392267.3,-625 392709.06,-625 392822.7,-729"/>
<text text-anchor="middle" x="392545" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="392545" y="-680" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="392545" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="392545" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_tp_0&#45;&gt;layer_9_attn_out_tp_0 -->
<g id="edge1741" class="edge">
<title>layer_9_attn_tp_0&#45;&gt;layer_9_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M392545,-794.68C392545,-777.18 392545,-757.43 392545,-739.22"/>
<polygon fill="black" stroke="black" points="392548.5,-739 392545,-729 392541.5,-739 392548.5,-739"/>
</g>
<!-- layer_9_attn_tp_1 -->
<g id="node935" class="node">
<title>layer_9_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="392248.7,-899 391806.94,-899 391693.3,-795 392135.06,-795 392248.7,-899"/>
<text text-anchor="middle" x="391971" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="391971" y="-850" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="391971" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="391971" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_out_tp_1 -->
<g id="node939" class="node">
<title>layer_9_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="392248.7,-729 391806.94,-729 391693.3,-625 392135.06,-625 392248.7,-729"/>
<text text-anchor="middle" x="391971" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="391971" y="-680" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="391971" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="391971" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_tp_1&#45;&gt;layer_9_attn_out_tp_1 -->
<g id="edge1743" class="edge">
<title>layer_9_attn_tp_1&#45;&gt;layer_9_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M391971,-794.68C391971,-777.18 391971,-757.43 391971,-739.22"/>
<polygon fill="black" stroke="black" points="391974.5,-739 391971,-729 391967.5,-739 391974.5,-739"/>
</g>
<!-- layer_9_attn_tp_2 -->
<g id="node936" class="node">
<title>layer_9_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="391674.7,-899 391232.94,-899 391119.3,-795 391561.06,-795 391674.7,-899"/>
<text text-anchor="middle" x="391397" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="391397" y="-850" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="391397" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="391397" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_out_tp_2 -->
<g id="node940" class="node">
<title>layer_9_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="391674.7,-729 391232.94,-729 391119.3,-625 391561.06,-625 391674.7,-729"/>
<text text-anchor="middle" x="391397" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="391397" y="-680" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="391397" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="391397" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_tp_2&#45;&gt;layer_9_attn_out_tp_2 -->
<g id="edge1745" class="edge">
<title>layer_9_attn_tp_2&#45;&gt;layer_9_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M391397,-794.68C391397,-777.18 391397,-757.43 391397,-739.22"/>
<polygon fill="black" stroke="black" points="391400.5,-739 391397,-729 391393.5,-739 391400.5,-739"/>
</g>
<!-- layer_9_attn_tp_3 -->
<g id="node937" class="node">
<title>layer_9_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="391100.7,-899 390658.94,-899 390545.3,-795 390987.06,-795 391100.7,-899"/>
<text text-anchor="middle" x="390823" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="390823" y="-850" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="390823" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="390823" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_out_tp_3 -->
<g id="node941" class="node">
<title>layer_9_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="391100.7,-729 390658.94,-729 390545.3,-625 390987.06,-625 391100.7,-729"/>
<text text-anchor="middle" x="390823" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="390823" y="-680" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="390823" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="390823" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_9_attn_tp_3&#45;&gt;layer_9_attn_out_tp_3 -->
<g id="edge1747" class="edge">
<title>layer_9_attn_tp_3&#45;&gt;layer_9_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M390823,-794.68C390823,-777.18 390823,-757.43 390823,-739.22"/>
<polygon fill="black" stroke="black" points="390826.5,-739 390823,-729 390819.5,-739 390826.5,-739"/>
</g>
<!-- layer_9_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1742" class="edge">
<title>layer_9_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M392421.3,-729.09C392369.12,-748.39 392307.1,-767.91 392249,-777.5 392249,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_9_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1744" class="edge">
<title>layer_9_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M391847.3,-729.09C391795.12,-748.39 391733.1,-767.91 391675,-777.5 391675,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_9_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1746" class="edge">
<title>layer_9_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M391273.3,-729.09C391221.12,-748.39 391159.1,-767.91 391101,-777.5 391101,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_9_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1748" class="edge">
<title>layer_9_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M390699.3,-729.09C390647.12,-748.39 390585.1,-767.91 390527,-777.5 390527,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_9_attn_allreduce -->
<g id="node942" class="node">
<title>layer_9_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="393037" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="393037" y="-861" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="393037" y="-850" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="393037" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="393037" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_gate_tp_0 -->
<g id="node943" class="node">
<title>layer_9_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="382345.99,-899 381897.4,-899 381782.01,-795 382230.6,-795 382345.99,-899"/>
<text text-anchor="middle" x="382064" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="382064" y="-850" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="382064" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="382064" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_9_route_ep_0 -->
<g id="node947" class="node">
<title>layer_9_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="365913.43,-729 365454.6,-729 365336.57,-625 365795.4,-625 365913.43,-729"/>
<text text-anchor="middle" x="365625" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="365625" y="-680" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="365625" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="365625" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_0 -->
<g id="edge1749" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381783.02,-795.93C381779.66,-795.6 381776.32,-795.29 381773,-795 381553.07,-775.62 374045.78,-777.72 373825,-777 372880.55,-773.93 372644.44,-771.95 371700,-768 370838.67,-764.4 370623.28,-770.31 369762,-760 368286.42,-742.33 366515.15,-700.22 365872.85,-684.27"/>
<polygon fill="black" stroke="black" points="365872.63,-680.76 365862.54,-684.01 365872.45,-687.76 365872.63,-680.76"/>
<text text-anchor="middle" x="373851" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_1 -->
<g id="node948" class="node">
<title>layer_9_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="370347.43,-729 369888.6,-729 369770.57,-625 370229.4,-625 370347.43,-729"/>
<text text-anchor="middle" x="370059" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="370059" y="-680" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="370059" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="370059" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_1 -->
<g id="edge1750" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381783.02,-795.94C381779.66,-795.61 381776.32,-795.3 381773,-795 381721.07,-790.36 374318.13,-760.63 374266,-760 372762.28,-741.84 370956.58,-699.86 370306.91,-684.12"/>
<polygon fill="black" stroke="black" points="370306.57,-680.61 370296.49,-683.86 370306.4,-687.6 370306.57,-680.61"/>
<text text-anchor="middle" x="378269" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_2 -->
<g id="node949" class="node">
<title>layer_9_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="374851.43,-729 374392.6,-729 374274.57,-625 374733.4,-625 374851.43,-729"/>
<text text-anchor="middle" x="374563" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="374563" y="-680" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="374563" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="374563" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_2 -->
<g id="edge1751" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381783.01,-796.02C381779.66,-795.66 381776.32,-795.32 381773,-795 381485.85,-767.02 380763.48,-771.68 380475,-768 379717.28,-758.34 379527.73,-769.16 378770,-760 377266.28,-741.82 375460.58,-699.85 374810.91,-684.11"/>
<polygon fill="black" stroke="black" points="374810.57,-680.6 374800.49,-683.86 374810.4,-687.6 374810.57,-680.6"/>
<text text-anchor="middle" x="381418" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_3 -->
<g id="node950" class="node">
<title>layer_9_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="379355.43,-729 378896.6,-729 378778.57,-625 379237.4,-625 379355.43,-729"/>
<text text-anchor="middle" x="379067" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="379067" y="-680" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="379067" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="379067" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_3 -->
<g id="edge1752" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382025.26,-794.73C382014.46,-783.99 382001.84,-774.09 381988,-768 381866.48,-714.52 379990.23,-688.32 379310.5,-680.55"/>
<polygon fill="black" stroke="black" points="379310.37,-677.05 379300.34,-680.43 379310.29,-684.05 379310.37,-677.05"/>
<text text-anchor="middle" x="382029" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_4 -->
<g id="node951" class="node">
<title>layer_9_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="382791.43,-729 382332.6,-729 382214.57,-625 382673.4,-625 382791.43,-729"/>
<text text-anchor="middle" x="382503" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="382503" y="-680" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="382503" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="382503" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_4 -->
<g id="edge1753" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382251.42,-813.67C382337.11,-798.36 382421.6,-782.28 382430,-777 382445.79,-767.08 382459.3,-752.41 382470.25,-737.38"/>
<polygon fill="black" stroke="black" points="382473.23,-739.23 382476.07,-729.02 382467.49,-735.23 382473.23,-739.23"/>
<text text-anchor="middle" x="382466" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_5 -->
<g id="node952" class="node">
<title>layer_9_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="386111.43,-729 385652.6,-729 385534.57,-625 385993.4,-625 386111.43,-729"/>
<text text-anchor="middle" x="385823" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="385823" y="-680" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="385823" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="385823" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_5 -->
<g id="edge1754" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382247,-809.79C382282.69,-803.9 382319.92,-798.57 382355,-795 382627.05,-767.33 382697.03,-793.14 382970,-777 383014.99,-774.34 383026.02,-770.74 383071,-768 384001.96,-711.34 385112.41,-688.77 385587.99,-681.24"/>
<polygon fill="black" stroke="black" points="385588.12,-684.74 385598.06,-681.08 385588.01,-677.74 385588.12,-684.74"/>
<text text-anchor="middle" x="383097" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_6 -->
<g id="node953" class="node">
<title>layer_9_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="389933.43,-729 389474.6,-729 389356.57,-625 389815.4,-625 389933.43,-729"/>
<text text-anchor="middle" x="389645" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="389645" y="-680" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="389645" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="389645" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_6 -->
<g id="edge1755" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382246.56,-809.31C382282.37,-803.44 382319.76,-798.24 382355,-795 382505.59,-781.15 384925.78,-769.33 385077,-768 385540.55,-763.92 385656.49,-767.17 386120,-760 387362.15,-740.79 388850.13,-700.51 389413.57,-684.63"/>
<polygon fill="black" stroke="black" points="389413.95,-688.12 389423.85,-684.34 389413.76,-681.13 389413.95,-688.12"/>
<text text-anchor="middle" x="385103" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_route_ep_7 -->
<g id="node954" class="node">
<title>layer_9_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="390527.43,-729 390068.6,-729 389950.57,-625 390409.4,-625 390527.43,-729"/>
<text text-anchor="middle" x="390239" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="390239" y="-680" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="390239" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="390239" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_7 -->
<g id="edge1756" class="edge">
<title>layer_9_gate_tp_0&#45;&gt;layer_9_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382246.55,-809.15C382282.36,-803.3 382319.75,-798.15 382355,-795 382576.68,-775.22 386138.45,-778.51 386361,-777 386803.67,-774.01 386914.32,-770.69 387357,-768 387428.8,-767.56 389870.86,-769.75 389942,-760 389985.73,-754.01 390032.12,-743.36 390074.92,-731.68"/>
<polygon fill="black" stroke="black" points="390075.86,-735.05 390084.56,-729.01 390073.99,-728.3 390075.86,-735.05"/>
<text text-anchor="middle" x="387383" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1 -->
<g id="node944" class="node">
<title>layer_9_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="382927.99,-899 382479.4,-899 382364.01,-795 382812.6,-795 382927.99,-899"/>
<text text-anchor="middle" x="382646" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="382646" y="-850" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="382646" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="382646" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_0 -->
<g id="edge1757" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382365.02,-795.93C382361.66,-795.6 382358.32,-795.29 382355,-795 382135.9,-775.7 374656.94,-779.02 374437,-777 374188.09,-774.72 374125.91,-770.24 373877,-768 372048.18,-751.53 371590.78,-779.9 369762,-760 368286.62,-743.95 366515.68,-700.87 365873.14,-684.46"/>
<polygon fill="black" stroke="black" points="365872.91,-680.96 365862.83,-684.2 365872.74,-687.96 365872.91,-680.96"/>
<text text-anchor="middle" x="374463" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_1 -->
<g id="edge1758" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382365.02,-795.95C382361.66,-795.62 382358.32,-795.3 382355,-795 382298.89,-789.93 378355.33,-768.24 378299,-768 377402.78,-764.13 375162.17,-769.62 374266,-760 372762.26,-743.85 370956.58,-700.65 370306.91,-684.35"/>
<polygon fill="black" stroke="black" points="370306.57,-680.84 370296.48,-684.09 370306.39,-687.84 370306.57,-680.84"/>
<text text-anchor="middle" x="379877" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_2 -->
<g id="edge1759" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382365.01,-796.02C382361.66,-795.67 382358.32,-795.33 382355,-795 381994.42,-759.63 381901.66,-798.65 381540,-777 381498.99,-774.54 381489.03,-770.06 381448,-768 381299.41,-760.53 378918.77,-761.67 378770,-760 377266.27,-743.1 375460.58,-700.36 374810.91,-684.26"/>
<polygon fill="black" stroke="black" points="374810.57,-680.75 374800.48,-684 374810.39,-687.75 374810.57,-680.75"/>
<text text-anchor="middle" x="381566" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_3 -->
<g id="edge1760" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382365.36,-796.4C382361.89,-795.92 382358.43,-795.46 382355,-795 382224.05,-777.58 382190.86,-775.99 382059,-768 381039.01,-706.2 379820.72,-686.24 379310.53,-680.3"/>
<polygon fill="black" stroke="black" points="379310.51,-676.8 379300.47,-680.19 379310.43,-683.8 379310.51,-676.8"/>
<text text-anchor="middle" x="382218" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_4 -->
<g id="edge1761" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382602.32,-794.68C382586.73,-776.36 382569.04,-755.59 382552.96,-736.69"/>
<polygon fill="black" stroke="black" points="382555.56,-734.35 382546.41,-729 382550.23,-738.89 382555.56,-734.35"/>
<text text-anchor="middle" x="382609" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_5 -->
<g id="edge1762" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382830.75,-811.14C382865.94,-805.21 382902.54,-799.51 382937,-795 383005.56,-786.02 383177.98,-772.21 383247,-768 384109.19,-715.43 385135.73,-690.97 385588.58,-682.11"/>
<polygon fill="black" stroke="black" points="385588.91,-685.61 385598.84,-681.92 385588.78,-678.61 385588.91,-685.61"/>
<text text-anchor="middle" x="383273" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_6 -->
<g id="edge1763" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382828.56,-809.26C382864.37,-803.4 382901.76,-798.21 382937,-795 383180,-772.86 384889.01,-780.1 385133,-777 386773.24,-756.15 388748.34,-703.19 389413.6,-684.59"/>
<polygon fill="black" stroke="black" points="389413.88,-688.08 389423.78,-684.3 389413.68,-681.08 389413.88,-688.08"/>
<text text-anchor="middle" x="385772" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_7 -->
<g id="edge1764" class="edge">
<title>layer_9_gate_tp_1&#45;&gt;layer_9_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382828.55,-809.14C382864.36,-803.29 382901.75,-798.14 382937,-795 383184.69,-772.96 387164.33,-778.34 387413,-777 387448.13,-776.81 389907.21,-764.83 389942,-760 389985.5,-753.96 390031.65,-743.35 390074.27,-731.74"/>
<polygon fill="black" stroke="black" points="390075.46,-735.04 390084.16,-729.01 390073.59,-728.3 390075.46,-735.04"/>
<text text-anchor="middle" x="389072" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2 -->
<g id="node945" class="node">
<title>layer_9_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="381763.99,-899 381315.4,-899 381200.01,-795 381648.6,-795 381763.99,-899"/>
<text text-anchor="middle" x="381482" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="381482" y="-850" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="381482" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="381482" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_0 -->
<g id="edge1765" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381256.09,-845.66C380065.41,-843.6 374397.58,-830.37 369762,-760 368286.03,-737.59 366514.1,-698.33 365872.27,-683.7"/>
<polygon fill="black" stroke="black" points="365872.05,-680.2 365861.97,-683.47 365871.89,-687.19 365872.05,-680.2"/>
<text text-anchor="middle" x="370737" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_1 -->
<g id="edge1766" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381256.67,-846.11C379976.7,-846.5 373609.06,-844.92 371648,-777 371181.05,-760.83 370637.94,-722.85 370322.85,-698.91"/>
<polygon fill="black" stroke="black" points="370322.9,-695.41 370312.67,-698.14 370322.37,-702.39 370322.9,-695.41"/>
<text text-anchor="middle" x="371674" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_2 -->
<g id="edge1767" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381255.18,-844.89C380221.16,-839.64 375978.84,-815.9 375386,-777 375207.54,-765.29 375008.41,-741.62 374850.72,-720.36"/>
<polygon fill="black" stroke="black" points="374850.77,-716.84 374840.39,-718.96 374849.84,-723.77 374850.77,-716.84"/>
<text text-anchor="middle" x="375412" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_3 -->
<g id="edge1768" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381237.71,-829.01C380780.15,-797.18 379797.89,-728.84 379327.93,-696.15"/>
<polygon fill="black" stroke="black" points="379327.83,-692.64 379317.61,-695.43 379327.35,-699.62 379327.83,-692.64"/>
<text text-anchor="middle" x="380445" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_4 -->
<g id="edge1769" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381668.61,-812.88C381703.29,-806.84 381739.24,-800.66 381773,-795 381950.41,-765.24 382152.37,-732.99 382298.82,-709.91"/>
<polygon fill="black" stroke="black" points="382299.5,-713.35 382308.83,-708.33 382298.41,-706.43 382299.5,-713.35"/>
<text text-anchor="middle" x="381958" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_5 -->
<g id="edge1770" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381665.4,-809.77C381700.97,-803.91 381738.05,-798.59 381773,-795 381901.06,-781.86 382226.09,-803.8 382352,-777 382362.33,-774.8 382363.65,-770.14 382374,-768 382420.36,-758.43 382752.67,-761.09 382800,-760 383841.93,-736.09 385085.66,-699.95 385591.74,-684.93"/>
<polygon fill="black" stroke="black" points="385592.19,-688.42 385602.08,-684.62 385591.98,-681.42 385592.19,-688.42"/>
<text text-anchor="middle" x="382400" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_6 -->
<g id="edge1771" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381664.97,-809.42C381700.66,-803.56 381737.9,-798.34 381773,-795 381896.79,-783.23 382770.18,-801.97 382892,-777 382902.35,-774.88 382903.64,-770.05 382914,-768 382957.68,-759.35 386075.48,-760.57 386120,-760 387362.38,-744 388850.61,-701.82 389413.84,-685.04"/>
<polygon fill="black" stroke="black" points="389414.22,-688.53 389424.11,-684.73 389414.01,-681.53 389414.22,-688.53"/>
<text text-anchor="middle" x="382940" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_7 -->
<g id="edge1772" class="edge">
<title>layer_9_gate_tp_2&#45;&gt;layer_9_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381664.56,-809.34C381700.38,-803.47 381737.76,-798.26 381773,-795 381950.03,-778.6 383195.25,-780.8 383373,-777 383500.15,-774.28 383531.84,-770.08 383659,-768 383746.25,-766.57 389855.53,-771.77 389942,-760 389985.73,-754.05 390032.13,-743.41 390074.92,-731.73"/>
<polygon fill="black" stroke="black" points="390075.86,-735.1 390084.57,-729.07 390074,-728.36 390075.86,-735.1"/>
<text text-anchor="middle" x="383685" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3 -->
<g id="node946" class="node">
<title>layer_9_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="383509.99,-899 383061.4,-899 382946.01,-795 383394.6,-795 383509.99,-899"/>
<text text-anchor="middle" x="383228" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="383228" y="-850" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="383228" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="383228" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_0 -->
<g id="edge1773" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382947.02,-795.93C382943.66,-795.6 382940.32,-795.29 382937,-795 382723.38,-776.17 375431.44,-778.58 375217,-777 374893.43,-774.62 374812.57,-770.27 374489,-768 373438.58,-760.62 370812.39,-771.3 369762,-760 368286.62,-744.13 366515.68,-700.94 365873.14,-684.49"/>
<polygon fill="black" stroke="black" points="365872.91,-680.98 365862.83,-684.22 365872.73,-687.98 365872.91,-680.98"/>
<text text-anchor="middle" x="375243" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_1 -->
<g id="edge1774" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382947.01,-795.95C382943.66,-795.62 382940.32,-795.3 382937,-795 382652.16,-769.22 380648.98,-780.82 380363,-777 380160.31,-774.29 380109.69,-770.14 379907,-768 378653.51,-754.74 375519.49,-773.1 374266,-760 372762.48,-744.28 370957.12,-700.83 370307.2,-684.4"/>
<polygon fill="black" stroke="black" points="370306.86,-680.89 370296.77,-684.14 370306.68,-687.89 370306.86,-680.89"/>
<text text-anchor="middle" x="380389" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_2 -->
<g id="edge1775" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382947.01,-796C382943.66,-795.65 382940.32,-795.32 382937,-795 382693.4,-771.81 382080.61,-783.51 381836,-777 381727.52,-774.11 381700.5,-770.15 381592,-768 380965.01,-755.55 379397.07,-767 378770,-760 377266.26,-743.21 375460.58,-700.4 374810.91,-684.27"/>
<polygon fill="black" stroke="black" points="374810.57,-680.76 374800.48,-684.01 374810.39,-687.76 374810.57,-680.76"/>
<text text-anchor="middle" x="381862" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_3 -->
<g id="edge1776" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382947.01,-796.05C382943.65,-795.69 382940.32,-795.34 382937,-795 382655.22,-766.48 382581.81,-805.22 382300,-777 382276.66,-774.66 382271.34,-770.34 382248,-768 381679.35,-711.04 379952.34,-687.37 379310.56,-680.38"/>
<polygon fill="black" stroke="black" points="379310.3,-676.87 379300.26,-680.27 379310.22,-683.87 379310.3,-676.87"/>
<text text-anchor="middle" x="382326" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_4 -->
<g id="edge1777" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382947.88,-796.73C382891.43,-786.69 382847.01,-778.65 382840,-777 382785.37,-764.16 382726.48,-747.76 382673.43,-732.02"/>
<polygon fill="black" stroke="black" points="382674.18,-728.59 382663.6,-729.09 382672.18,-735.3 382674.18,-728.59"/>
<text text-anchor="middle" x="382866" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_5 -->
<g id="edge1778" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M383277.12,-794.67C383290.28,-783.93 383305.26,-774.05 383321,-768 383528.31,-688.32 384999.45,-678.5 385584.2,-677.78"/>
<polygon fill="black" stroke="black" points="385584.45,-681.28 385594.45,-677.77 385584.45,-674.28 385584.45,-681.28"/>
<text text-anchor="middle" x="383347" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_6 -->
<g id="edge1779" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M383445.85,-840.78C383914.88,-829.5 385055.28,-801.87 386011,-777 387296.62,-743.55 388837.99,-700.63 389413.45,-684.5"/>
<polygon fill="black" stroke="black" points="389413.63,-688 389423.52,-684.22 389413.43,-681 389413.63,-688"/>
<text text-anchor="middle" x="386331" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_7 -->
<g id="edge1780" class="edge">
<title>layer_9_gate_tp_3&#45;&gt;layer_9_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M383446.99,-842.09C383985.91,-832.61 385419.7,-808.19 386616,-795 387758.63,-782.4 388044.43,-793.86 389187,-777 389522.6,-772.05 389609.93,-808.81 389942,-760 389984.84,-753.7 390030.28,-743.19 390072.39,-731.76"/>
<polygon fill="black" stroke="black" points="390073.46,-735.09 390082.17,-729.07 390071.6,-728.34 390073.46,-735.09"/>
<text text-anchor="middle" x="389892" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_9_expert_0_ep_0 -->
<g id="node955" class="node">
<title>layer_9_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="362800.83,-559 362366.82,-559 362255.17,-455 362689.18,-455 362800.83,-559"/>
<text text-anchor="middle" x="362528" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="362528" y="-510" font-family="Arial" font-size="10.00">GPU: 256</text>
<text text-anchor="middle" x="362528" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="362528" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_0_ep_0 -->
<g id="edge1781" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M365394.79,-676.47C364814.81,-676.44 363304.61,-668.57 362809,-590 362768.77,-583.62 362726.2,-573.2 362686.68,-561.89"/>
<polygon fill="black" stroke="black" points="362687.55,-558.5 362676.97,-559.08 362685.6,-565.23 362687.55,-558.5"/>
</g>
<!-- layer_9_expert_1_ep_0 -->
<g id="node956" class="node">
<title>layer_9_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="363363.83,-559 362929.82,-559 362818.17,-455 363252.18,-455 363363.83,-559"/>
<text text-anchor="middle" x="363091" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="363091" y="-510" font-family="Arial" font-size="10.00">GPU: 257</text>
<text text-anchor="middle" x="363091" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="363091" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_1_ep_0 -->
<g id="edge1782" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M365392.17,-674.35C364897.39,-669.67 363755.23,-652.25 363372,-590 363332.12,-583.52 363289.9,-573.16 363250.65,-561.94"/>
<polygon fill="black" stroke="black" points="363251.31,-558.49 363240.73,-559.08 363249.37,-565.22 363251.31,-558.49"/>
</g>
<!-- layer_9_expert_2_ep_0 -->
<g id="node957" class="node">
<title>layer_9_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="363926.83,-559 363492.82,-559 363381.17,-455 363815.18,-455 363926.83,-559"/>
<text text-anchor="middle" x="363654" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="363654" y="-510" font-family="Arial" font-size="10.00">GPU: 258</text>
<text text-anchor="middle" x="363654" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="363654" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_2_ep_0 -->
<g id="edge1783" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M365388.26,-670.76C364991.09,-660.82 364207.3,-636.01 363935,-590 363895.5,-583.33 363853.69,-572.99 363814.73,-561.88"/>
<polygon fill="black" stroke="black" points="363815.47,-558.45 363804.89,-559.04 363813.53,-565.17 363815.47,-558.45"/>
</g>
<!-- layer_9_expert_3_ep_0 -->
<g id="node958" class="node">
<title>layer_9_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="364489.83,-559 364055.82,-559 363944.17,-455 364378.18,-455 364489.83,-559"/>
<text text-anchor="middle" x="364217" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="364217" y="-510" font-family="Arial" font-size="10.00">GPU: 259</text>
<text text-anchor="middle" x="364217" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="364217" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_3_ep_0 -->
<g id="edge1784" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M365390.08,-672.25C365160.84,-665.27 364803.03,-645.52 364498,-590 364459.4,-582.97 364418.52,-572.73 364380.25,-561.84"/>
<polygon fill="black" stroke="black" points="364381.16,-558.46 364370.58,-559.06 364379.23,-565.19 364381.16,-558.46"/>
</g>
<!-- layer_9_expert_4_ep_0 -->
<g id="node959" class="node">
<title>layer_9_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="365052.83,-559 364618.82,-559 364507.17,-455 364941.18,-455 365052.83,-559"/>
<text text-anchor="middle" x="364780" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="364780" y="-510" font-family="Arial" font-size="10.00">GPU: 260</text>
<text text-anchor="middle" x="364780" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="364780" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_4_ep_0 -->
<g id="edge1785" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M365356.12,-642.42C365262.25,-628.74 365156.5,-611.12 365061,-590 365025.13,-582.07 364987.11,-572.08 364951.02,-561.82"/>
<polygon fill="black" stroke="black" points="364951.97,-558.45 364941.39,-559.07 364950.04,-565.18 364951.97,-558.45"/>
</g>
<!-- layer_9_expert_5_ep_0 -->
<g id="node960" class="node">
<title>layer_9_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="365615.83,-559 365181.82,-559 365070.17,-455 365504.18,-455 365615.83,-559"/>
<text text-anchor="middle" x="365343" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="365343" y="-510" font-family="Arial" font-size="10.00">GPU: 261</text>
<text text-anchor="middle" x="365343" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="365343" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_5_ep_0 -->
<g id="edge1786" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M365539.24,-624.91C365507.11,-605.77 365470.44,-583.92 365437.55,-564.33"/>
<polygon fill="black" stroke="black" points="365439.22,-561.25 365428.84,-559.14 365435.64,-567.26 365439.22,-561.25"/>
</g>
<!-- layer_9_expert_6_ep_0 -->
<g id="node961" class="node">
<title>layer_9_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="366178.83,-559 365744.82,-559 365633.17,-455 366067.18,-455 366178.83,-559"/>
<text text-anchor="middle" x="365906" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="365906" y="-510" font-family="Arial" font-size="10.00">GPU: 262</text>
<text text-anchor="middle" x="365906" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="365906" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_6_ep_0 -->
<g id="edge1787" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M365710.45,-624.91C365742.47,-605.77 365779.02,-583.92 365811.78,-564.33"/>
<polygon fill="black" stroke="black" points="365813.68,-567.27 365820.47,-559.14 365810.09,-561.26 365813.68,-567.27"/>
</g>
<!-- layer_9_expert_7_ep_0 -->
<g id="node962" class="node">
<title>layer_9_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="366741.83,-559 366307.82,-559 366196.17,-455 366630.18,-455 366741.83,-559"/>
<text text-anchor="middle" x="366469" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="366469" y="-510" font-family="Arial" font-size="10.00">GPU: 263</text>
<text text-anchor="middle" x="366469" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="366469" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_0&#45;&gt;layer_9_expert_7_ep_0 -->
<g id="edge1788" class="edge">
<title>layer_9_route_ep_0&#45;&gt;layer_9_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M365826.18,-651.85C365934.1,-637.24 366069.01,-616.33 366188,-590 366223.87,-582.06 366261.89,-572.07 366297.98,-561.82"/>
<polygon fill="black" stroke="black" points="366298.96,-565.18 366307.61,-559.06 366297.03,-558.45 366298.96,-565.18"/>
</g>
<!-- layer_9_expert_0_ep_1 -->
<g id="node963" class="node">
<title>layer_9_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="367304.83,-559 366870.82,-559 366759.17,-455 367193.18,-455 367304.83,-559"/>
<text text-anchor="middle" x="367032" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="367032" y="-510" font-family="Arial" font-size="10.00">GPU: 272</text>
<text text-anchor="middle" x="367032" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="367032" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_0_ep_1 -->
<g id="edge1789" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M369828.54,-676.25C369258.64,-675.68 367794.58,-666.54 367313,-590 367272.78,-583.61 367230.2,-573.18 367190.68,-561.87"/>
<polygon fill="black" stroke="black" points="367191.55,-558.48 367180.97,-559.06 367189.6,-565.2 367191.55,-558.48"/>
</g>
<!-- layer_9_expert_1_ep_1 -->
<g id="node964" class="node">
<title>layer_9_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="367867.83,-559 367433.82,-559 367322.17,-455 367756.18,-455 367867.83,-559"/>
<text text-anchor="middle" x="367595" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="367595" y="-510" font-family="Arial" font-size="10.00">GPU: 273</text>
<text text-anchor="middle" x="367595" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="367595" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_1_ep_1 -->
<g id="edge1790" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M369826.11,-674.01C369342.85,-668.71 368245.43,-650.24 367876,-590 367836.12,-583.5 367793.9,-573.12 367754.65,-561.91"/>
<polygon fill="black" stroke="black" points="367755.32,-558.46 367744.74,-559.04 367753.37,-565.18 367755.32,-558.46"/>
</g>
<!-- layer_9_expert_2_ep_1 -->
<g id="node965" class="node">
<title>layer_9_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="368430.83,-559 367996.82,-559 367885.17,-455 368319.18,-455 368430.83,-559"/>
<text text-anchor="middle" x="368158" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="368158" y="-510" font-family="Arial" font-size="10.00">GPU: 274</text>
<text text-anchor="middle" x="368158" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="368158" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_2_ep_1 -->
<g id="edge1791" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M369821.72,-670.13C369437.88,-659.5 368697.66,-634 368439,-590 368399.63,-583.3 368357.95,-572.99 368319.08,-561.91"/>
<polygon fill="black" stroke="black" points="368319.85,-558.49 368309.27,-559.08 368317.91,-565.21 368319.85,-558.49"/>
</g>
<!-- layer_9_expert_3_ep_1 -->
<g id="node966" class="node">
<title>layer_9_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="368993.83,-559 368559.82,-559 368448.17,-455 368882.18,-455 368993.83,-559"/>
<text text-anchor="middle" x="368721" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="368721" y="-510" font-family="Arial" font-size="10.00">GPU: 275</text>
<text text-anchor="middle" x="368721" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="368721" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_3_ep_1 -->
<g id="edge1792" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M369822.1,-670.44C369606.69,-662.14 369280.82,-641.47 369002,-590 368963.53,-582.9 368922.79,-572.65 368884.62,-561.8"/>
<polygon fill="black" stroke="black" points="368885.55,-558.42 368874.98,-559.03 368883.62,-565.15 368885.55,-558.42"/>
</g>
<!-- layer_9_expert_4_ep_1 -->
<g id="node967" class="node">
<title>layer_9_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="369556.83,-559 369122.82,-559 369011.17,-455 369445.18,-455 369556.83,-559"/>
<text text-anchor="middle" x="369284" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="369284" y="-510" font-family="Arial" font-size="10.00">GPU: 276</text>
<text text-anchor="middle" x="369284" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="369284" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_4_ep_1 -->
<g id="edge1793" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M369779.33,-632.91C369709.05,-620.55 369634,-606.02 369565,-590 369529.93,-581.86 369492.76,-571.94 369457.32,-561.86"/>
<polygon fill="black" stroke="black" points="369457.95,-558.4 369447.38,-559.01 369456.03,-565.13 369457.95,-558.4"/>
</g>
<!-- layer_9_expert_5_ep_1 -->
<g id="node968" class="node">
<title>layer_9_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="370119.83,-559 369685.82,-559 369574.17,-455 370008.18,-455 370119.83,-559"/>
<text text-anchor="middle" x="369847" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="369847" y="-510" font-family="Arial" font-size="10.00">GPU: 277</text>
<text text-anchor="middle" x="369847" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="369847" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_5_ep_1 -->
<g id="edge1794" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M369994.53,-624.91C369970.89,-606.18 369943.97,-584.85 369919.66,-565.58"/>
<polygon fill="black" stroke="black" points="369921.54,-562.6 369911.53,-559.14 369917.19,-568.09 369921.54,-562.6"/>
</g>
<!-- layer_9_expert_6_ep_1 -->
<g id="node969" class="node">
<title>layer_9_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="370682.83,-559 370248.82,-559 370137.17,-455 370571.18,-455 370682.83,-559"/>
<text text-anchor="middle" x="370410" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="370410" y="-510" font-family="Arial" font-size="10.00">GPU: 278</text>
<text text-anchor="middle" x="370410" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="370410" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_6_ep_1 -->
<g id="edge1795" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M370165.74,-624.91C370206.33,-605.48 370252.74,-583.27 370294.14,-563.46"/>
<polygon fill="black" stroke="black" points="370295.65,-566.61 370303.16,-559.14 370292.63,-560.3 370295.65,-566.61"/>
</g>
<!-- layer_9_expert_7_ep_1 -->
<g id="node970" class="node">
<title>layer_9_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="371245.83,-559 370811.82,-559 370700.17,-455 371134.18,-455 371245.83,-559"/>
<text text-anchor="middle" x="370973" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="370973" y="-510" font-family="Arial" font-size="10.00">GPU: 279</text>
<text text-anchor="middle" x="370973" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="370973" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_1&#45;&gt;layer_9_expert_7_ep_1 -->
<g id="edge1796" class="edge">
<title>layer_9_route_ep_1&#45;&gt;layer_9_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M370264.52,-655.92C370389.02,-641.82 370550.57,-620.07 370692,-590 370728.39,-582.26 370766.95,-572.25 370803.46,-561.88"/>
<polygon fill="black" stroke="black" points="370804.54,-565.22 370813.19,-559.1 370802.61,-558.48 370804.54,-565.22"/>
</g>
<!-- layer_9_expert_0_ep_2 -->
<g id="node971" class="node">
<title>layer_9_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="371808.83,-559 371374.82,-559 371263.17,-455 371697.18,-455 371808.83,-559"/>
<text text-anchor="middle" x="371536" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="371536" y="-510" font-family="Arial" font-size="10.00">GPU: 288</text>
<text text-anchor="middle" x="371536" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="371536" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_0_ep_2 -->
<g id="edge1797" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M374332.54,-676.25C373762.64,-675.68 372298.58,-666.54 371817,-590 371776.78,-583.61 371734.2,-573.18 371694.68,-561.87"/>
<polygon fill="black" stroke="black" points="371695.55,-558.48 371684.97,-559.06 371693.6,-565.2 371695.55,-558.48"/>
</g>
<!-- layer_9_expert_1_ep_2 -->
<g id="node972" class="node">
<title>layer_9_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="372371.83,-559 371937.82,-559 371826.17,-455 372260.18,-455 372371.83,-559"/>
<text text-anchor="middle" x="372099" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="372099" y="-510" font-family="Arial" font-size="10.00">GPU: 289</text>
<text text-anchor="middle" x="372099" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="372099" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_1_ep_2 -->
<g id="edge1798" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M374330.11,-674.01C373846.85,-668.71 372749.43,-650.24 372380,-590 372340.12,-583.5 372297.9,-573.12 372258.65,-561.91"/>
<polygon fill="black" stroke="black" points="372259.32,-558.46 372248.74,-559.04 372257.37,-565.18 372259.32,-558.46"/>
</g>
<!-- layer_9_expert_2_ep_2 -->
<g id="node973" class="node">
<title>layer_9_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="372934.83,-559 372500.82,-559 372389.17,-455 372823.18,-455 372934.83,-559"/>
<text text-anchor="middle" x="372662" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="372662" y="-510" font-family="Arial" font-size="10.00">GPU: 290</text>
<text text-anchor="middle" x="372662" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="372662" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_2_ep_2 -->
<g id="edge1799" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M374325.72,-670.13C373941.88,-659.5 373201.66,-634 372943,-590 372903.63,-583.3 372861.95,-572.99 372823.08,-561.91"/>
<polygon fill="black" stroke="black" points="372823.85,-558.49 372813.27,-559.08 372821.91,-565.21 372823.85,-558.49"/>
</g>
<!-- layer_9_expert_3_ep_2 -->
<g id="node974" class="node">
<title>layer_9_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="373497.83,-559 373063.82,-559 372952.17,-455 373386.18,-455 373497.83,-559"/>
<text text-anchor="middle" x="373225" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="373225" y="-510" font-family="Arial" font-size="10.00">GPU: 291</text>
<text text-anchor="middle" x="373225" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="373225" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_3_ep_2 -->
<g id="edge1800" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M374326.1,-670.44C374110.69,-662.14 373784.82,-641.47 373506,-590 373467.53,-582.9 373426.79,-572.65 373388.62,-561.8"/>
<polygon fill="black" stroke="black" points="373389.55,-558.42 373378.98,-559.03 373387.62,-565.15 373389.55,-558.42"/>
</g>
<!-- layer_9_expert_4_ep_2 -->
<g id="node975" class="node">
<title>layer_9_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="374060.83,-559 373626.82,-559 373515.17,-455 373949.18,-455 374060.83,-559"/>
<text text-anchor="middle" x="373788" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="373788" y="-510" font-family="Arial" font-size="10.00">GPU: 292</text>
<text text-anchor="middle" x="373788" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="373788" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_4_ep_2 -->
<g id="edge1801" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M374283.33,-632.91C374213.05,-620.55 374138,-606.02 374069,-590 374033.93,-581.86 373996.76,-571.94 373961.32,-561.86"/>
<polygon fill="black" stroke="black" points="373961.95,-558.4 373951.38,-559.01 373960.03,-565.13 373961.95,-558.4"/>
</g>
<!-- layer_9_expert_5_ep_2 -->
<g id="node976" class="node">
<title>layer_9_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="374623.83,-559 374189.82,-559 374078.17,-455 374512.18,-455 374623.83,-559"/>
<text text-anchor="middle" x="374351" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="374351" y="-510" font-family="Arial" font-size="10.00">GPU: 293</text>
<text text-anchor="middle" x="374351" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="374351" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_5_ep_2 -->
<g id="edge1802" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M374498.53,-624.91C374474.89,-606.18 374447.97,-584.85 374423.66,-565.58"/>
<polygon fill="black" stroke="black" points="374425.54,-562.6 374415.53,-559.14 374421.19,-568.09 374425.54,-562.6"/>
</g>
<!-- layer_9_expert_6_ep_2 -->
<g id="node977" class="node">
<title>layer_9_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="375186.83,-559 374752.82,-559 374641.17,-455 375075.18,-455 375186.83,-559"/>
<text text-anchor="middle" x="374914" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="374914" y="-510" font-family="Arial" font-size="10.00">GPU: 294</text>
<text text-anchor="middle" x="374914" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="374914" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_6_ep_2 -->
<g id="edge1803" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M374669.74,-624.91C374710.33,-605.48 374756.74,-583.27 374798.14,-563.46"/>
<polygon fill="black" stroke="black" points="374799.65,-566.61 374807.16,-559.14 374796.63,-560.3 374799.65,-566.61"/>
</g>
<!-- layer_9_expert_7_ep_2 -->
<g id="node978" class="node">
<title>layer_9_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="375749.83,-559 375315.82,-559 375204.17,-455 375638.18,-455 375749.83,-559"/>
<text text-anchor="middle" x="375477" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="375477" y="-510" font-family="Arial" font-size="10.00">GPU: 295</text>
<text text-anchor="middle" x="375477" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="375477" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_2&#45;&gt;layer_9_expert_7_ep_2 -->
<g id="edge1804" class="edge">
<title>layer_9_route_ep_2&#45;&gt;layer_9_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M374768.52,-655.92C374893.02,-641.82 375054.57,-620.07 375196,-590 375232.39,-582.26 375270.95,-572.25 375307.46,-561.88"/>
<polygon fill="black" stroke="black" points="375308.54,-565.22 375317.19,-559.1 375306.61,-558.48 375308.54,-565.22"/>
</g>
<!-- layer_9_expert_0_ep_3 -->
<g id="node979" class="node">
<title>layer_9_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="376312.83,-559 375878.82,-559 375767.17,-455 376201.18,-455 376312.83,-559"/>
<text text-anchor="middle" x="376040" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="376040" y="-510" font-family="Arial" font-size="10.00">GPU: 304</text>
<text text-anchor="middle" x="376040" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="376040" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_0_ep_3 -->
<g id="edge1805" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M378836.54,-676.25C378266.64,-675.68 376802.58,-666.54 376321,-590 376280.78,-583.61 376238.2,-573.18 376198.68,-561.87"/>
<polygon fill="black" stroke="black" points="376199.55,-558.48 376188.97,-559.06 376197.6,-565.2 376199.55,-558.48"/>
</g>
<!-- layer_9_expert_1_ep_3 -->
<g id="node980" class="node">
<title>layer_9_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="376875.83,-559 376441.82,-559 376330.17,-455 376764.18,-455 376875.83,-559"/>
<text text-anchor="middle" x="376603" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="376603" y="-510" font-family="Arial" font-size="10.00">GPU: 305</text>
<text text-anchor="middle" x="376603" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="376603" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_1_ep_3 -->
<g id="edge1806" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M378834.11,-674.01C378350.85,-668.71 377253.43,-650.24 376884,-590 376844.12,-583.5 376801.9,-573.12 376762.65,-561.91"/>
<polygon fill="black" stroke="black" points="376763.32,-558.46 376752.74,-559.04 376761.37,-565.18 376763.32,-558.46"/>
</g>
<!-- layer_9_expert_2_ep_3 -->
<g id="node981" class="node">
<title>layer_9_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="377438.83,-559 377004.82,-559 376893.17,-455 377327.18,-455 377438.83,-559"/>
<text text-anchor="middle" x="377166" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="377166" y="-510" font-family="Arial" font-size="10.00">GPU: 306</text>
<text text-anchor="middle" x="377166" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="377166" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_2_ep_3 -->
<g id="edge1807" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M378829.72,-670.13C378445.88,-659.5 377705.66,-634 377447,-590 377407.63,-583.3 377365.95,-572.99 377327.08,-561.91"/>
<polygon fill="black" stroke="black" points="377327.85,-558.49 377317.27,-559.08 377325.91,-565.21 377327.85,-558.49"/>
</g>
<!-- layer_9_expert_3_ep_3 -->
<g id="node982" class="node">
<title>layer_9_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="378001.83,-559 377567.82,-559 377456.17,-455 377890.18,-455 378001.83,-559"/>
<text text-anchor="middle" x="377729" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="377729" y="-510" font-family="Arial" font-size="10.00">GPU: 307</text>
<text text-anchor="middle" x="377729" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="377729" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_3_ep_3 -->
<g id="edge1808" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M378830.1,-670.44C378614.69,-662.14 378288.82,-641.47 378010,-590 377971.53,-582.9 377930.79,-572.65 377892.62,-561.8"/>
<polygon fill="black" stroke="black" points="377893.55,-558.42 377882.98,-559.03 377891.62,-565.15 377893.55,-558.42"/>
</g>
<!-- layer_9_expert_4_ep_3 -->
<g id="node983" class="node">
<title>layer_9_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="378564.83,-559 378130.82,-559 378019.17,-455 378453.18,-455 378564.83,-559"/>
<text text-anchor="middle" x="378292" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="378292" y="-510" font-family="Arial" font-size="10.00">GPU: 308</text>
<text text-anchor="middle" x="378292" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="378292" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_4_ep_3 -->
<g id="edge1809" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M378787.33,-632.91C378717.05,-620.55 378642,-606.02 378573,-590 378537.93,-581.86 378500.76,-571.94 378465.32,-561.86"/>
<polygon fill="black" stroke="black" points="378465.95,-558.4 378455.38,-559.01 378464.03,-565.13 378465.95,-558.4"/>
</g>
<!-- layer_9_expert_5_ep_3 -->
<g id="node984" class="node">
<title>layer_9_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="379127.83,-559 378693.82,-559 378582.17,-455 379016.18,-455 379127.83,-559"/>
<text text-anchor="middle" x="378855" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="378855" y="-510" font-family="Arial" font-size="10.00">GPU: 309</text>
<text text-anchor="middle" x="378855" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="378855" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_5_ep_3 -->
<g id="edge1810" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M379002.53,-624.91C378978.89,-606.18 378951.97,-584.85 378927.66,-565.58"/>
<polygon fill="black" stroke="black" points="378929.54,-562.6 378919.53,-559.14 378925.19,-568.09 378929.54,-562.6"/>
</g>
<!-- layer_9_expert_6_ep_3 -->
<g id="node985" class="node">
<title>layer_9_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="379690.83,-559 379256.82,-559 379145.17,-455 379579.18,-455 379690.83,-559"/>
<text text-anchor="middle" x="379418" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="379418" y="-510" font-family="Arial" font-size="10.00">GPU: 310</text>
<text text-anchor="middle" x="379418" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="379418" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_6_ep_3 -->
<g id="edge1811" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M379173.74,-624.91C379214.33,-605.48 379260.74,-583.27 379302.14,-563.46"/>
<polygon fill="black" stroke="black" points="379303.65,-566.61 379311.16,-559.14 379300.63,-560.3 379303.65,-566.61"/>
</g>
<!-- layer_9_expert_7_ep_3 -->
<g id="node986" class="node">
<title>layer_9_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="380253.83,-559 379819.82,-559 379708.17,-455 380142.18,-455 380253.83,-559"/>
<text text-anchor="middle" x="379981" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="379981" y="-510" font-family="Arial" font-size="10.00">GPU: 311</text>
<text text-anchor="middle" x="379981" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="379981" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_3&#45;&gt;layer_9_expert_7_ep_3 -->
<g id="edge1812" class="edge">
<title>layer_9_route_ep_3&#45;&gt;layer_9_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M379272.52,-655.92C379397.02,-641.82 379558.57,-620.07 379700,-590 379736.39,-582.26 379774.95,-572.25 379811.46,-561.88"/>
<polygon fill="black" stroke="black" points="379812.54,-565.22 379821.19,-559.1 379810.61,-558.48 379812.54,-565.22"/>
</g>
<!-- layer_9_expert_0_ep_4 -->
<g id="node987" class="node">
<title>layer_9_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="380816.83,-559 380382.82,-559 380271.17,-455 380705.18,-455 380816.83,-559"/>
<text text-anchor="middle" x="380544" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="380544" y="-510" font-family="Arial" font-size="10.00">GPU: 320</text>
<text text-anchor="middle" x="380544" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="380544" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_0_ep_4 -->
<g id="edge1813" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M382266.37,-670.66C381871.52,-660.61 381095,-635.67 380825,-590 380785.51,-583.32 380743.69,-572.98 380704.73,-561.87"/>
<polygon fill="black" stroke="black" points="380705.47,-558.44 380694.89,-559.03 380703.53,-565.16 380705.47,-558.44"/>
</g>
<!-- layer_9_expert_1_ep_4 -->
<g id="node988" class="node">
<title>layer_9_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="381379.83,-559 380945.82,-559 380834.17,-455 381268.18,-455 381379.83,-559"/>
<text text-anchor="middle" x="381107" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="381107" y="-510" font-family="Arial" font-size="10.00">GPU: 321</text>
<text text-anchor="middle" x="381107" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="381107" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_1_ep_4 -->
<g id="edge1814" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M382267.61,-671.95C382040.7,-664.74 381688.46,-644.82 381388,-590 381349.4,-582.96 381308.53,-572.71 381270.26,-561.82"/>
<polygon fill="black" stroke="black" points="381271.16,-558.44 381260.59,-559.04 381269.23,-565.17 381271.16,-558.44"/>
</g>
<!-- layer_9_expert_2_ep_4 -->
<g id="node989" class="node">
<title>layer_9_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="381942.83,-559 381508.82,-559 381397.17,-455 381831.18,-455 381942.83,-559"/>
<text text-anchor="middle" x="381670" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="381670" y="-510" font-family="Arial" font-size="10.00">GPU: 322</text>
<text text-anchor="middle" x="381670" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="381670" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_2_ep_4 -->
<g id="edge1815" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M382232.51,-640.99C382142.49,-627.45 382042,-610.28 381951,-590 381915.41,-582.07 381877.69,-572.14 381841.84,-561.96"/>
<polygon fill="black" stroke="black" points="381842.36,-558.47 381831.78,-559.08 381840.43,-565.2 381842.36,-558.47"/>
</g>
<!-- layer_9_expert_3_ep_4 -->
<g id="node990" class="node">
<title>layer_9_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="382505.83,-559 382071.82,-559 381960.17,-455 382394.18,-455 382505.83,-559"/>
<text text-anchor="middle" x="382233" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="382233" y="-510" font-family="Arial" font-size="10.00">GPU: 323</text>
<text text-anchor="middle" x="382233" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="382233" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_3_ep_4 -->
<g id="edge1816" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M382420.89,-624.91C382390.26,-605.85 382355.31,-584.11 382323.93,-564.58"/>
<polygon fill="black" stroke="black" points="382325.52,-561.45 382315.18,-559.14 382321.82,-567.39 382325.52,-561.45"/>
</g>
<!-- layer_9_expert_4_ep_4 -->
<g id="node991" class="node">
<title>layer_9_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="383068.83,-559 382634.82,-559 382523.17,-455 382957.18,-455 383068.83,-559"/>
<text text-anchor="middle" x="382796" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="382796" y="-510" font-family="Arial" font-size="10.00">GPU: 324</text>
<text text-anchor="middle" x="382796" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="382796" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_4_ep_4 -->
<g id="edge1817" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M382592.1,-624.91C382625.49,-605.77 382663.59,-583.92 382697.76,-564.33"/>
<polygon fill="black" stroke="black" points="382699.88,-567.15 382706.82,-559.14 382696.4,-561.07 382699.88,-567.15"/>
</g>
<!-- layer_9_expert_5_ep_4 -->
<g id="node992" class="node">
<title>layer_9_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="383631.83,-559 383197.82,-559 383086.17,-455 383520.18,-455 383631.83,-559"/>
<text text-anchor="middle" x="383359" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="383359" y="-510" font-family="Arial" font-size="10.00">GPU: 325</text>
<text text-anchor="middle" x="383359" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="383359" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_5_ep_4 -->
<g id="edge1818" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M382704.8,-652.62C382815.63,-638.08 382955.14,-616.98 383078,-590 383114,-582.09 383152.15,-572.09 383188.35,-561.8"/>
<polygon fill="black" stroke="black" points="383189.35,-565.16 383198,-559.04 383187.42,-558.43 383189.35,-565.16"/>
</g>
<!-- layer_9_expert_6_ep_4 -->
<g id="node993" class="node">
<title>layer_9_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="384194.83,-559 383760.82,-559 383649.17,-455 384083.18,-455 384194.83,-559"/>
<text text-anchor="middle" x="383922" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="383922" y="-510" font-family="Arial" font-size="10.00">GPU: 326</text>
<text text-anchor="middle" x="383922" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="383922" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_6_ep_4 -->
<g id="edge1819" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M382727.71,-672.8C382958.53,-666.3 383327.39,-646.96 383641,-590 383679.6,-582.99 383720.48,-572.75 383758.75,-561.86"/>
<polygon fill="black" stroke="black" points="383759.78,-565.21 383768.42,-559.08 383757.84,-558.48 383759.78,-565.21"/>
</g>
<!-- layer_9_expert_7_ep_4 -->
<g id="node994" class="node">
<title>layer_9_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="384757.83,-559 384323.82,-559 384212.17,-455 384646.18,-455 384757.83,-559"/>
<text text-anchor="middle" x="384485" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="384485" y="-510" font-family="Arial" font-size="10.00">GPU: 327</text>
<text text-anchor="middle" x="384485" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="384485" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_4&#45;&gt;layer_9_expert_7_ep_4 -->
<g id="edge1820" class="edge">
<title>layer_9_route_ep_4&#45;&gt;layer_9_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M382725.93,-671.19C383120.5,-661.59 383926.38,-636.86 384204,-590 384243.5,-583.33 384285.31,-573 384324.27,-561.89"/>
<polygon fill="black" stroke="black" points="384325.47,-565.18 384334.11,-559.05 384323.53,-558.46 384325.47,-565.18"/>
</g>
<!-- layer_9_expert_0_ep_5 -->
<g id="node995" class="node">
<title>layer_9_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="385320.83,-559 384886.82,-559 384775.17,-455 385209.18,-455 385320.83,-559"/>
<text text-anchor="middle" x="385048" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="385048" y="-510" font-family="Arial" font-size="10.00">GPU: 336</text>
<text text-anchor="middle" x="385048" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="385048" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_0_ep_5 -->
<g id="edge1821" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M385543.33,-632.91C385473.05,-620.55 385398,-606.02 385329,-590 385293.93,-581.86 385256.76,-571.94 385221.32,-561.86"/>
<polygon fill="black" stroke="black" points="385221.95,-558.4 385211.38,-559.01 385220.03,-565.13 385221.95,-558.4"/>
</g>
<!-- layer_9_expert_1_ep_5 -->
<g id="node996" class="node">
<title>layer_9_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="385883.83,-559 385449.82,-559 385338.17,-455 385772.18,-455 385883.83,-559"/>
<text text-anchor="middle" x="385611" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="385611" y="-510" font-family="Arial" font-size="10.00">GPU: 337</text>
<text text-anchor="middle" x="385611" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="385611" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_1_ep_5 -->
<g id="edge1822" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M385758.53,-624.91C385734.89,-606.18 385707.97,-584.85 385683.66,-565.58"/>
<polygon fill="black" stroke="black" points="385685.54,-562.6 385675.53,-559.14 385681.19,-568.09 385685.54,-562.6"/>
</g>
<!-- layer_9_expert_2_ep_5 -->
<g id="node997" class="node">
<title>layer_9_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="386446.83,-559 386012.82,-559 385901.17,-455 386335.18,-455 386446.83,-559"/>
<text text-anchor="middle" x="386174" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="386174" y="-510" font-family="Arial" font-size="10.00">GPU: 338</text>
<text text-anchor="middle" x="386174" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="386174" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_2_ep_5 -->
<g id="edge1823" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M385929.74,-624.91C385970.33,-605.48 386016.74,-583.27 386058.14,-563.46"/>
<polygon fill="black" stroke="black" points="386059.65,-566.61 386067.16,-559.14 386056.63,-560.3 386059.65,-566.61"/>
</g>
<!-- layer_9_expert_3_ep_5 -->
<g id="node998" class="node">
<title>layer_9_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="387009.83,-559 386575.82,-559 386464.17,-455 386898.18,-455 387009.83,-559"/>
<text text-anchor="middle" x="386737" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="386737" y="-510" font-family="Arial" font-size="10.00">GPU: 339</text>
<text text-anchor="middle" x="386737" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="386737" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_3_ep_5 -->
<g id="edge1824" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M386028.52,-655.92C386153.02,-641.82 386314.57,-620.07 386456,-590 386492.39,-582.26 386530.95,-572.25 386567.46,-561.88"/>
<polygon fill="black" stroke="black" points="386568.54,-565.22 386577.19,-559.1 386566.61,-558.48 386568.54,-565.22"/>
</g>
<!-- layer_9_expert_4_ep_5 -->
<g id="node999" class="node">
<title>layer_9_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="387572.83,-559 387138.82,-559 387027.17,-455 387461.18,-455 387572.83,-559"/>
<text text-anchor="middle" x="387300" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="387300" y="-510" font-family="Arial" font-size="10.00">GPU: 340</text>
<text text-anchor="middle" x="387300" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="387300" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_4_ep_5 -->
<g id="edge1825" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M386049.06,-673.98C386290.87,-668.51 386684.77,-650.08 387019,-590 387057.73,-583.04 387098.74,-572.78 387137.11,-561.87"/>
<polygon fill="black" stroke="black" points="387138.16,-565.21 387146.81,-559.08 387136.23,-558.48 387138.16,-565.21"/>
</g>
<!-- layer_9_expert_5_ep_5 -->
<g id="node1000" class="node">
<title>layer_9_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="388135.83,-559 387701.82,-559 387590.17,-455 388024.18,-455 388135.83,-559"/>
<text text-anchor="middle" x="387863" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="387863" y="-510" font-family="Arial" font-size="10.00">GPU: 341</text>
<text text-anchor="middle" x="387863" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="387863" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_5_ep_5 -->
<g id="edge1826" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M386046.34,-671.62C386451.68,-662.57 387293.2,-638.5 387582,-590 387621.5,-583.37 387663.32,-573.04 387702.28,-561.93"/>
<polygon fill="black" stroke="black" points="387703.48,-565.23 387712.12,-559.09 387701.54,-558.5 387703.48,-565.23"/>
</g>
<!-- layer_9_expert_6_ep_5 -->
<g id="node1001" class="node">
<title>layer_9_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="388698.83,-559 388264.82,-559 388153.17,-455 388587.18,-455 388698.83,-559"/>
<text text-anchor="middle" x="388426" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="388426" y="-510" font-family="Arial" font-size="10.00">GPU: 342</text>
<text text-anchor="middle" x="388426" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="388426" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_6_ep_5 -->
<g id="edge1827" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M386050.09,-674.71C386552.8,-670.7 387746.66,-654.48 388145,-590 388185,-583.52 388227.35,-573.13 388266.7,-561.88"/>
<polygon fill="black" stroke="black" points="388268,-565.15 388276.64,-559 388266.06,-558.42 388268,-565.15"/>
</g>
<!-- layer_9_expert_7_ep_5 -->
<g id="node1002" class="node">
<title>layer_9_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="389261.83,-559 388827.82,-559 388716.17,-455 389150.18,-455 389261.83,-559"/>
<text text-anchor="middle" x="388989" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="388989" y="-510" font-family="Arial" font-size="10.00">GPU: 343</text>
<text text-anchor="middle" x="388989" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="388989" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_5&#45;&gt;layer_9_expert_7_ep_5 -->
<g id="edge1828" class="edge">
<title>layer_9_route_ep_5&#45;&gt;layer_9_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M386052.1,-676.67C386641.24,-677.18 388198.29,-670.62 388708,-590 388748.23,-583.64 388790.81,-573.22 388830.32,-561.92"/>
<polygon fill="black" stroke="black" points="388831.4,-565.25 388840.03,-559.1 388829.45,-558.52 388831.4,-565.25"/>
</g>
<!-- layer_9_expert_0_ep_6 -->
<g id="node1003" class="node">
<title>layer_9_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="389824.83,-559 389390.82,-559 389279.17,-455 389713.18,-455 389824.83,-559"/>
<text text-anchor="middle" x="389552" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="389552" y="-510" font-family="Arial" font-size="10.00">GPU: 352</text>
<text text-anchor="middle" x="389552" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="389552" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_0_ep_6 -->
<g id="edge1829" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M389616.59,-624.68C389606.68,-606.77 389595.46,-586.51 389585.19,-567.96"/>
<polygon fill="black" stroke="black" points="389588.14,-566.06 389580.23,-559 389582.02,-569.45 389588.14,-566.06"/>
</g>
<!-- layer_9_expert_1_ep_6 -->
<g id="node1004" class="node">
<title>layer_9_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="390387.83,-559 389953.82,-559 389842.17,-455 390276.18,-455 390387.83,-559"/>
<text text-anchor="middle" x="390115" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="390115" y="-510" font-family="Arial" font-size="10.00">GPU: 353</text>
<text text-anchor="middle" x="390115" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="390115" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_1_ep_6 -->
<g id="edge1830" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M389787.93,-624.91C389843.07,-605.2 389906.25,-582.62 389962.29,-562.59"/>
<polygon fill="black" stroke="black" points="389963.7,-565.8 389971.94,-559.14 389961.35,-559.21 389963.7,-565.8"/>
</g>
<!-- layer_9_expert_2_ep_6 -->
<g id="node1005" class="node">
<title>layer_9_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="390950.83,-559 390516.82,-559 390405.17,-455 390839.18,-455 390950.83,-559"/>
<text text-anchor="middle" x="390678" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="390678" y="-510" font-family="Arial" font-size="10.00">GPU: 354</text>
<text text-anchor="middle" x="390678" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="390678" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_2_ep_6 -->
<g id="edge1831" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M389834.42,-641.42C389870.09,-635.5 389907.14,-629.73 389942,-625 390061.5,-608.78 390091.71,-606.61 390212,-598 390294.09,-592.13 390315.8,-603.4 390397,-590 390436.75,-583.44 390478.83,-573.08 390517.99,-561.9"/>
<polygon fill="black" stroke="black" points="390519.24,-565.18 390527.88,-559.04 390517.3,-558.45 390519.24,-565.18"/>
</g>
<!-- layer_9_expert_3_ep_6 -->
<g id="node1006" class="node">
<title>layer_9_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="391513.83,-559 391079.82,-559 390968.17,-455 391402.18,-455 391513.83,-559"/>
<text text-anchor="middle" x="391241" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="391241" y="-510" font-family="Arial" font-size="10.00">GPU: 355</text>
<text text-anchor="middle" x="391241" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="391241" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_3_ep_6 -->
<g id="edge1832" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M389833.55,-640.94C389869.47,-635.02 389906.83,-629.39 389942,-625 389980.15,-620.24 390248.59,-599.73 390287,-598 390361.71,-594.64 390886.03,-601.02 390960,-590 391000.86,-583.91 391044.11,-573.42 391084.11,-561.94"/>
<polygon fill="black" stroke="black" points="391085.31,-565.23 391093.93,-559.08 391083.35,-558.51 391085.31,-565.23"/>
</g>
<!-- layer_9_expert_4_ep_6 -->
<g id="node1007" class="node">
<title>layer_9_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="392076.83,-559 391642.82,-559 391531.17,-455 391965.18,-455 392076.83,-559"/>
<text text-anchor="middle" x="391804" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="391804" y="-510" font-family="Arial" font-size="10.00">GPU: 356</text>
<text text-anchor="middle" x="391804" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="391804" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_4_ep_6 -->
<g id="edge1833" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M389833.1,-640.57C389869.15,-634.67 389906.67,-629.13 389942,-625 390068.5,-610.2 390101.01,-616.71 390228,-607 390272.49,-603.6 390283.43,-600.15 390328,-598 390394.31,-594.8 391457.31,-599.61 391523,-590 391564.2,-583.97 391607.81,-573.4 391648.07,-561.82"/>
<polygon fill="black" stroke="black" points="391649.06,-565.17 391657.68,-559.01 391647.1,-558.45 391649.06,-565.17"/>
</g>
<!-- layer_9_expert_5_ep_6 -->
<g id="node1008" class="node">
<title>layer_9_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="392639.83,-559 392205.82,-559 392094.17,-455 392528.18,-455 392639.83,-559"/>
<text text-anchor="middle" x="392367" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="392367" y="-510" font-family="Arial" font-size="10.00">GPU: 357</text>
<text text-anchor="middle" x="392367" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="392367" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_5_ep_6 -->
<g id="edge1834" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M389833.06,-640.28C389869.12,-634.41 389906.64,-628.95 389942,-625 390092.83,-608.13 390131.86,-620.82 390283,-607 390313.8,-604.18 390321.14,-600.08 390352,-598 390448.12,-591.54 391990.67,-603.85 392086,-590 392127.2,-584.01 392170.82,-573.46 392211.08,-561.88"/>
<polygon fill="black" stroke="black" points="392212.07,-565.23 392220.69,-559.07 392210.11,-558.51 392212.07,-565.23"/>
</g>
<!-- layer_9_expert_6_ep_6 -->
<g id="node1009" class="node">
<title>layer_9_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="393202.83,-559 392768.82,-559 392657.17,-455 393091.18,-455 393202.83,-559"/>
<text text-anchor="middle" x="392930" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="392930" y="-510" font-family="Arial" font-size="10.00">GPU: 358</text>
<text text-anchor="middle" x="392930" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="392930" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_6_ep_6 -->
<g id="edge1835" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M389832.65,-640.19C389868.83,-634.31 389906.5,-628.87 389942,-625 390110.08,-606.66 390154.14,-627.29 390322,-607 390342.68,-604.5 390347.27,-600.05 390368,-598 390494.11,-585.56 392523.58,-608.15 392649,-590 392690.21,-584.04 392733.82,-573.49 392774.08,-561.91"/>
<polygon fill="black" stroke="black" points="392775.08,-565.26 392783.7,-559.1 392773.12,-558.54 392775.08,-565.26"/>
</g>
<!-- layer_9_expert_7_ep_6 -->
<g id="node1010" class="node">
<title>layer_9_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="393765.83,-559 393331.82,-559 393220.17,-455 393654.18,-455 393765.83,-559"/>
<text text-anchor="middle" x="393493" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="393493" y="-510" font-family="Arial" font-size="10.00">GPU: 359</text>
<text text-anchor="middle" x="393493" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="393493" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_6&#45;&gt;layer_9_expert_7_ep_6 -->
<g id="edge1836" class="edge">
<title>layer_9_route_ep_6&#45;&gt;layer_9_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M389832.2,-639.71C389868.5,-633.85 389906.34,-628.55 389942,-625 390047.63,-614.49 390790.86,-599.68 390897,-598 390961.3,-596.98 393148.36,-599.21 393212,-590 393253.21,-584.04 393296.82,-573.49 393337.08,-561.91"/>
<polygon fill="black" stroke="black" points="393338.08,-565.26 393346.7,-559.1 393336.12,-558.54 393338.08,-565.26"/>
</g>
<!-- layer_9_expert_0_ep_7 -->
<g id="node1011" class="node">
<title>layer_9_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="394328.83,-559 393894.82,-559 393783.17,-455 394217.18,-455 394328.83,-559"/>
<text text-anchor="middle" x="394056" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="394056" y="-510" font-family="Arial" font-size="10.00">GPU: 368</text>
<text text-anchor="middle" x="394056" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="394056" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_0_ep_7 -->
<g id="edge1837" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M390425.75,-639.32C390462.18,-633.47 390500.18,-628.28 390536,-625 391018.91,-580.83 392233.1,-602.84 392718,-598 392776.72,-597.41 393716.9,-598.53 393775,-590 393815.99,-583.98 393859.38,-573.48 393899.47,-561.96"/>
<polygon fill="black" stroke="black" points="393900.69,-565.25 393909.31,-559.09 393898.73,-558.53 393900.69,-565.25"/>
</g>
<!-- layer_9_expert_1_ep_7 -->
<g id="node1012" class="node">
<title>layer_9_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="394891.83,-559 394457.82,-559 394346.17,-455 394780.18,-455 394891.83,-559"/>
<text text-anchor="middle" x="394619" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="394619" y="-510" font-family="Arial" font-size="10.00">GPU: 369</text>
<text text-anchor="middle" x="394619" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="394619" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_1_ep_7 -->
<g id="edge1838" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M390425.75,-639.23C390462.17,-633.39 390500.18,-628.22 390536,-625 390641.19,-615.55 394233.52,-605.42 394338,-590 394378.99,-583.95 394422.37,-573.44 394462.46,-561.92"/>
<polygon fill="black" stroke="black" points="394463.69,-565.2 394472.31,-559.05 394461.73,-558.48 394463.69,-565.2"/>
</g>
<!-- layer_9_expert_2_ep_7 -->
<g id="node1013" class="node">
<title>layer_9_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="395454.83,-559 395020.82,-559 394909.17,-455 395343.18,-455 395454.83,-559"/>
<text text-anchor="middle" x="395182" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="395182" y="-510" font-family="Arial" font-size="10.00">GPU: 370</text>
<text text-anchor="middle" x="395182" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="395182" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_2_ep_7 -->
<g id="edge1839" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M390425.74,-639.14C390462.17,-633.31 390500.17,-628.17 390536,-625 390694.44,-610.99 393239.95,-608.4 393399,-607 393732.79,-604.06 394570.83,-639.1 394901,-590 394941.87,-583.92 394985.11,-573.44 395025.11,-561.95"/>
<polygon fill="black" stroke="black" points="395026.31,-565.25 395034.94,-559.09 395024.36,-558.53 395026.31,-565.25"/>
</g>
<!-- layer_9_expert_3_ep_7 -->
<g id="node1014" class="node">
<title>layer_9_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="396017.83,-559 395583.82,-559 395472.17,-455 395906.18,-455 396017.83,-559"/>
<text text-anchor="middle" x="395745" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="395745" y="-510" font-family="Arial" font-size="10.00">GPU: 371</text>
<text text-anchor="middle" x="395745" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="395745" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_3_ep_7 -->
<g id="edge1840" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M390425.74,-639.11C390462.16,-633.28 390500.17,-628.14 390536,-625 390733.8,-607.64 393911.45,-608.75 394110,-607 394410.9,-604.35 395166.39,-634.44 395464,-590 395504.86,-583.9 395548.11,-573.4 395588.11,-561.92"/>
<polygon fill="black" stroke="black" points="395589.31,-565.21 395597.93,-559.06 395587.35,-558.49 395589.31,-565.21"/>
</g>
<!-- layer_9_expert_4_ep_7 -->
<g id="node1015" class="node">
<title>layer_9_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="396580.83,-559 396146.82,-559 396035.17,-455 396469.18,-455 396580.83,-559"/>
<text text-anchor="middle" x="396308" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="396308" y="-510" font-family="Arial" font-size="10.00">GPU: 372</text>
<text text-anchor="middle" x="396308" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="396308" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_4_ep_7 -->
<g id="edge1841" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M390425.73,-639.08C390462.16,-633.26 390500.17,-628.13 390536,-625 390769.34,-604.61 394517.78,-609.06 394752,-607 395035.35,-604.51 395746.77,-631.96 396027,-590 396067.86,-583.88 396111.11,-573.38 396151.1,-561.9"/>
<polygon fill="black" stroke="black" points="396152.3,-565.19 396160.93,-559.04 396150.35,-558.47 396152.3,-565.19"/>
</g>
<!-- layer_9_expert_5_ep_7 -->
<g id="node1016" class="node">
<title>layer_9_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="397143.83,-559 396709.82,-559 396598.17,-455 397032.18,-455 397143.83,-559"/>
<text text-anchor="middle" x="396871" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="396871" y="-510" font-family="Arial" font-size="10.00">GPU: 373</text>
<text text-anchor="middle" x="396871" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="396871" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_5_ep_7 -->
<g id="edge1842" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M390425.73,-639.07C390462.16,-633.24 390500.17,-628.12 390536,-625 390802.77,-601.76 395088.23,-609.34 395356,-607 395630.24,-604.6 396318.78,-630.67 396590,-590 396630.86,-583.87 396674.1,-573.37 396714.1,-561.88"/>
<polygon fill="black" stroke="black" points="396715.3,-565.18 396723.92,-559.02 396713.35,-558.46 396715.3,-565.18"/>
</g>
<!-- layer_9_expert_6_ep_7 -->
<g id="node1017" class="node">
<title>layer_9_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="397706.83,-559 397272.82,-559 397161.17,-455 397595.18,-455 397706.83,-559"/>
<text text-anchor="middle" x="397434" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="397434" y="-510" font-family="Arial" font-size="10.00">GPU: 374</text>
<text text-anchor="middle" x="397434" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="397434" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_6_ep_7 -->
<g id="edge1843" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M390425.73,-639.06C390462.16,-633.23 390500.17,-628.11 390536,-625 390685.58,-612 395790.87,-608.3 395941,-607 396210.35,-604.66 396886.62,-629.98 397153,-590 397193.86,-583.87 397237.1,-573.36 397277.1,-561.88"/>
<polygon fill="black" stroke="black" points="397278.3,-565.17 397286.92,-559.02 397276.34,-558.45 397278.3,-565.17"/>
</g>
<!-- layer_9_expert_7_ep_7 -->
<g id="node1018" class="node">
<title>layer_9_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="398269.83,-559 397835.82,-559 397724.17,-455 398158.18,-455 398269.83,-559"/>
<text text-anchor="middle" x="397997" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="397997" y="-510" font-family="Arial" font-size="10.00">GPU: 375</text>
<text text-anchor="middle" x="397997" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="397997" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_9_route_ep_7&#45;&gt;layer_9_expert_7_ep_7 -->
<g id="edge1844" class="edge">
<title>layer_9_route_ep_7&#45;&gt;layer_9_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M390425.73,-639.05C390462.16,-633.23 390500.17,-628.11 390536,-625 390701.49,-610.64 396349.89,-608.43 396516,-607 396782.68,-604.71 397452.26,-629.6 397716,-590 397756.86,-583.86 397800.1,-573.36 397840.1,-561.87"/>
<polygon fill="black" stroke="black" points="397841.3,-565.17 397849.92,-559.01 397839.34,-558.45 397841.3,-565.17"/>
</g>
<!-- layer_9_agg_ep_0 -->
<g id="node1019" class="node">
<title>layer_9_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="365063.07,-410 364612.77,-410 364496.93,-306 364947.23,-306 365063.07,-410"/>
<text text-anchor="middle" x="364780" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="364780" y="-361" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="364780" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="364780" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1845" class="edge">
<title>layer_9_expert_0_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M362700.39,-465.2C362736.11,-458.05 362773.64,-451.47 362809,-447 363139.72,-405.18 364106.93,-376.08 364551.58,-364.54"/>
<polygon fill="black" stroke="black" points="364551.76,-368.03 364561.66,-364.27 364551.58,-361.03 364551.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1846" class="edge">
<title>layer_9_expert_1_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M363263.82,-465.62C363299.43,-458.45 363336.8,-451.77 363372,-447 363784.65,-391.08 364270.25,-370.62 364549.87,-363.19"/>
<polygon fill="black" stroke="black" points="364550.24,-366.68 364560.14,-362.92 364550.05,-359.68 364550.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1847" class="edge">
<title>layer_9_expert_2_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M363827.74,-466.6C363863.11,-459.4 363900.16,-452.46 363935,-447 364147.34,-413.74 364391.74,-389.83 364562.9,-375.41"/>
<polygon fill="black" stroke="black" points="364563.36,-378.88 364573.04,-374.55 364562.78,-371.9 364563.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1848" class="edge">
<title>layer_9_expert_3_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M364385.92,-461.9C364452.29,-444.56 364528.66,-424.62 364596.4,-406.94"/>
<polygon fill="black" stroke="black" points="364597.53,-410.26 364606.33,-404.35 364595.77,-403.49 364597.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1849" class="edge">
<title>layer_9_expert_4_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M364780,-455C364780,-443.95 364780,-432.15 364780,-420.75"/>
<polygon fill="black" stroke="black" points="364783.5,-420.41 364780,-410.41 364776.5,-420.41 364783.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1850" class="edge">
<title>layer_9_expert_5_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M365147.67,-455C365095.2,-441.3 365038.31,-426.44 364985.31,-412.61"/>
<polygon fill="black" stroke="black" points="364986.02,-409.18 364975.46,-410.04 364984.25,-415.95 364986.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1851" class="edge">
<title>layer_9_expert_6_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M365672.13,-455C365656.21,-452.11 365640.39,-449.41 365625,-447 365428.91,-416.29 365205.48,-393.55 365037.64,-378.88"/>
<polygon fill="black" stroke="black" points="365037.94,-375.4 365027.68,-378.02 365037.34,-382.37 365037.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_0&#45;&gt;layer_9_agg_ep_0 -->
<g id="edge1852" class="edge">
<title>layer_9_expert_7_ep_0&#45;&gt;layer_9_agg_ep_0</title>
<path fill="none" stroke="black" d="M366239.44,-454.98C366222.09,-451.99 366204.79,-449.28 366188,-447 365780.89,-391.83 365302.79,-371.18 365021.51,-363.5"/>
<polygon fill="black" stroke="black" points="365021.26,-359.99 365011.17,-363.22 365021.07,-366.99 365021.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_1 -->
<g id="node1020" class="node">
<title>layer_9_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="369567.07,-410 369116.77,-410 369000.93,-306 369451.23,-306 369567.07,-410"/>
<text text-anchor="middle" x="369284" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="369284" y="-361" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="369284" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="369284" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1854" class="edge">
<title>layer_9_expert_0_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M367204.39,-465.2C367240.11,-458.05 367277.64,-451.47 367313,-447 367643.72,-405.18 368610.93,-376.08 369055.58,-364.54"/>
<polygon fill="black" stroke="black" points="369055.76,-368.03 369065.66,-364.27 369055.58,-361.03 369055.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1855" class="edge">
<title>layer_9_expert_1_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M367767.82,-465.62C367803.43,-458.45 367840.8,-451.77 367876,-447 368288.65,-391.08 368774.25,-370.62 369053.87,-363.19"/>
<polygon fill="black" stroke="black" points="369054.24,-366.68 369064.14,-362.92 369054.05,-359.68 369054.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1856" class="edge">
<title>layer_9_expert_2_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M368331.74,-466.6C368367.11,-459.4 368404.16,-452.46 368439,-447 368651.34,-413.74 368895.74,-389.83 369066.9,-375.41"/>
<polygon fill="black" stroke="black" points="369067.36,-378.88 369077.04,-374.55 369066.78,-371.9 369067.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1857" class="edge">
<title>layer_9_expert_3_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M368889.92,-461.9C368956.29,-444.56 369032.66,-424.62 369100.4,-406.94"/>
<polygon fill="black" stroke="black" points="369101.53,-410.26 369110.33,-404.35 369099.77,-403.49 369101.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1858" class="edge">
<title>layer_9_expert_4_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M369284,-455C369284,-443.95 369284,-432.15 369284,-420.75"/>
<polygon fill="black" stroke="black" points="369287.5,-420.41 369284,-410.41 369280.5,-420.41 369287.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1859" class="edge">
<title>layer_9_expert_5_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M369651.67,-455C369599.2,-441.3 369542.31,-426.44 369489.31,-412.61"/>
<polygon fill="black" stroke="black" points="369490.02,-409.18 369479.46,-410.04 369488.25,-415.95 369490.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1860" class="edge">
<title>layer_9_expert_6_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M370176.13,-455C370160.21,-452.11 370144.39,-449.41 370129,-447 369932.91,-416.29 369709.48,-393.55 369541.64,-378.88"/>
<polygon fill="black" stroke="black" points="369541.94,-375.4 369531.68,-378.02 369541.34,-382.37 369541.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_1&#45;&gt;layer_9_agg_ep_1 -->
<g id="edge1861" class="edge">
<title>layer_9_expert_7_ep_1&#45;&gt;layer_9_agg_ep_1</title>
<path fill="none" stroke="black" d="M370743.44,-454.98C370726.09,-451.99 370708.79,-449.28 370692,-447 370284.89,-391.83 369806.79,-371.18 369525.51,-363.5"/>
<polygon fill="black" stroke="black" points="369525.26,-359.99 369515.17,-363.22 369525.07,-366.99 369525.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_2 -->
<g id="node1021" class="node">
<title>layer_9_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="374071.07,-410 373620.77,-410 373504.93,-306 373955.23,-306 374071.07,-410"/>
<text text-anchor="middle" x="373788" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="373788" y="-361" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="373788" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="373788" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1863" class="edge">
<title>layer_9_expert_0_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M371708.39,-465.2C371744.11,-458.05 371781.64,-451.47 371817,-447 372147.72,-405.18 373114.93,-376.08 373559.58,-364.54"/>
<polygon fill="black" stroke="black" points="373559.76,-368.03 373569.66,-364.27 373559.58,-361.03 373559.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1864" class="edge">
<title>layer_9_expert_1_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M372271.82,-465.62C372307.43,-458.45 372344.8,-451.77 372380,-447 372792.65,-391.08 373278.25,-370.62 373557.87,-363.19"/>
<polygon fill="black" stroke="black" points="373558.24,-366.68 373568.14,-362.92 373558.05,-359.68 373558.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1865" class="edge">
<title>layer_9_expert_2_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M372835.74,-466.6C372871.11,-459.4 372908.16,-452.46 372943,-447 373155.34,-413.74 373399.74,-389.83 373570.9,-375.41"/>
<polygon fill="black" stroke="black" points="373571.36,-378.88 373581.04,-374.55 373570.78,-371.9 373571.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1866" class="edge">
<title>layer_9_expert_3_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M373393.92,-461.9C373460.29,-444.56 373536.66,-424.62 373604.4,-406.94"/>
<polygon fill="black" stroke="black" points="373605.53,-410.26 373614.33,-404.35 373603.77,-403.49 373605.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1867" class="edge">
<title>layer_9_expert_4_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M373788,-455C373788,-443.95 373788,-432.15 373788,-420.75"/>
<polygon fill="black" stroke="black" points="373791.5,-420.41 373788,-410.41 373784.5,-420.41 373791.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1868" class="edge">
<title>layer_9_expert_5_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M374155.67,-455C374103.2,-441.3 374046.31,-426.44 373993.31,-412.61"/>
<polygon fill="black" stroke="black" points="373994.02,-409.18 373983.46,-410.04 373992.25,-415.95 373994.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1869" class="edge">
<title>layer_9_expert_6_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M374680.13,-455C374664.21,-452.11 374648.39,-449.41 374633,-447 374436.91,-416.29 374213.48,-393.55 374045.64,-378.88"/>
<polygon fill="black" stroke="black" points="374045.94,-375.4 374035.68,-378.02 374045.34,-382.37 374045.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_2&#45;&gt;layer_9_agg_ep_2 -->
<g id="edge1870" class="edge">
<title>layer_9_expert_7_ep_2&#45;&gt;layer_9_agg_ep_2</title>
<path fill="none" stroke="black" d="M375247.44,-454.98C375230.09,-451.99 375212.79,-449.28 375196,-447 374788.89,-391.83 374310.79,-371.18 374029.51,-363.5"/>
<polygon fill="black" stroke="black" points="374029.26,-359.99 374019.17,-363.22 374029.07,-366.99 374029.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_3 -->
<g id="node1022" class="node">
<title>layer_9_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="378575.07,-410 378124.77,-410 378008.93,-306 378459.23,-306 378575.07,-410"/>
<text text-anchor="middle" x="378292" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="378292" y="-361" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="378292" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="378292" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1872" class="edge">
<title>layer_9_expert_0_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M376212.39,-465.2C376248.11,-458.05 376285.64,-451.47 376321,-447 376651.72,-405.18 377618.93,-376.08 378063.58,-364.54"/>
<polygon fill="black" stroke="black" points="378063.76,-368.03 378073.66,-364.27 378063.58,-361.03 378063.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1873" class="edge">
<title>layer_9_expert_1_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M376775.82,-465.62C376811.43,-458.45 376848.8,-451.77 376884,-447 377296.65,-391.08 377782.25,-370.62 378061.87,-363.19"/>
<polygon fill="black" stroke="black" points="378062.24,-366.68 378072.14,-362.92 378062.05,-359.68 378062.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1874" class="edge">
<title>layer_9_expert_2_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M377339.74,-466.6C377375.11,-459.4 377412.16,-452.46 377447,-447 377659.34,-413.74 377903.74,-389.83 378074.9,-375.41"/>
<polygon fill="black" stroke="black" points="378075.36,-378.88 378085.04,-374.55 378074.78,-371.9 378075.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1875" class="edge">
<title>layer_9_expert_3_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M377897.92,-461.9C377964.29,-444.56 378040.66,-424.62 378108.4,-406.94"/>
<polygon fill="black" stroke="black" points="378109.53,-410.26 378118.33,-404.35 378107.77,-403.49 378109.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1876" class="edge">
<title>layer_9_expert_4_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M378292,-455C378292,-443.95 378292,-432.15 378292,-420.75"/>
<polygon fill="black" stroke="black" points="378295.5,-420.41 378292,-410.41 378288.5,-420.41 378295.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1877" class="edge">
<title>layer_9_expert_5_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M378659.67,-455C378607.2,-441.3 378550.31,-426.44 378497.31,-412.61"/>
<polygon fill="black" stroke="black" points="378498.02,-409.18 378487.46,-410.04 378496.25,-415.95 378498.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1878" class="edge">
<title>layer_9_expert_6_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M379184.13,-455C379168.21,-452.11 379152.39,-449.41 379137,-447 378940.91,-416.29 378717.48,-393.55 378549.64,-378.88"/>
<polygon fill="black" stroke="black" points="378549.94,-375.4 378539.68,-378.02 378549.34,-382.37 378549.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_3&#45;&gt;layer_9_agg_ep_3 -->
<g id="edge1879" class="edge">
<title>layer_9_expert_7_ep_3&#45;&gt;layer_9_agg_ep_3</title>
<path fill="none" stroke="black" d="M379751.44,-454.98C379734.09,-451.99 379716.79,-449.28 379700,-447 379292.89,-391.83 378814.79,-371.18 378533.51,-363.5"/>
<polygon fill="black" stroke="black" points="378533.26,-359.99 378523.17,-363.22 378533.07,-366.99 378533.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_4 -->
<g id="node1023" class="node">
<title>layer_9_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="383079.07,-410 382628.77,-410 382512.93,-306 382963.23,-306 383079.07,-410"/>
<text text-anchor="middle" x="382796" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="382796" y="-361" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="382796" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="382796" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1881" class="edge">
<title>layer_9_expert_0_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M380716.39,-465.2C380752.11,-458.05 380789.64,-451.47 380825,-447 381155.72,-405.18 382122.93,-376.08 382567.58,-364.54"/>
<polygon fill="black" stroke="black" points="382567.76,-368.03 382577.66,-364.27 382567.58,-361.03 382567.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1882" class="edge">
<title>layer_9_expert_1_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M381279.82,-465.62C381315.43,-458.45 381352.8,-451.77 381388,-447 381800.65,-391.08 382286.25,-370.62 382565.87,-363.19"/>
<polygon fill="black" stroke="black" points="382566.24,-366.68 382576.14,-362.92 382566.05,-359.68 382566.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1883" class="edge">
<title>layer_9_expert_2_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M381843.74,-466.6C381879.11,-459.4 381916.16,-452.46 381951,-447 382163.34,-413.74 382407.74,-389.83 382578.9,-375.41"/>
<polygon fill="black" stroke="black" points="382579.36,-378.88 382589.04,-374.55 382578.78,-371.9 382579.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1884" class="edge">
<title>layer_9_expert_3_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M382401.92,-461.9C382468.29,-444.56 382544.66,-424.62 382612.4,-406.94"/>
<polygon fill="black" stroke="black" points="382613.53,-410.26 382622.33,-404.35 382611.77,-403.49 382613.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1885" class="edge">
<title>layer_9_expert_4_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M382796,-455C382796,-443.95 382796,-432.15 382796,-420.75"/>
<polygon fill="black" stroke="black" points="382799.5,-420.41 382796,-410.41 382792.5,-420.41 382799.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1886" class="edge">
<title>layer_9_expert_5_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M383163.67,-455C383111.2,-441.3 383054.31,-426.44 383001.31,-412.61"/>
<polygon fill="black" stroke="black" points="383002.02,-409.18 382991.46,-410.04 383000.25,-415.95 383002.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1887" class="edge">
<title>layer_9_expert_6_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M383688.13,-455C383672.21,-452.11 383656.39,-449.41 383641,-447 383444.91,-416.29 383221.48,-393.55 383053.64,-378.88"/>
<polygon fill="black" stroke="black" points="383053.94,-375.4 383043.68,-378.02 383053.34,-382.37 383053.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_4&#45;&gt;layer_9_agg_ep_4 -->
<g id="edge1888" class="edge">
<title>layer_9_expert_7_ep_4&#45;&gt;layer_9_agg_ep_4</title>
<path fill="none" stroke="black" d="M384255.44,-454.98C384238.09,-451.99 384220.79,-449.28 384204,-447 383796.89,-391.83 383318.79,-371.18 383037.51,-363.5"/>
<polygon fill="black" stroke="black" points="383037.26,-359.99 383027.17,-363.22 383037.07,-366.99 383037.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_5 -->
<g id="node1024" class="node">
<title>layer_9_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="387583.07,-410 387132.77,-410 387016.93,-306 387467.23,-306 387583.07,-410"/>
<text text-anchor="middle" x="387300" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="387300" y="-361" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="387300" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="387300" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1890" class="edge">
<title>layer_9_expert_0_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M385220.39,-465.2C385256.11,-458.05 385293.64,-451.47 385329,-447 385659.72,-405.18 386626.93,-376.08 387071.58,-364.54"/>
<polygon fill="black" stroke="black" points="387071.76,-368.03 387081.66,-364.27 387071.58,-361.03 387071.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1891" class="edge">
<title>layer_9_expert_1_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M385783.82,-465.62C385819.43,-458.45 385856.8,-451.77 385892,-447 386304.65,-391.08 386790.25,-370.62 387069.87,-363.19"/>
<polygon fill="black" stroke="black" points="387070.24,-366.68 387080.14,-362.92 387070.05,-359.68 387070.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1892" class="edge">
<title>layer_9_expert_2_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M386347.74,-466.6C386383.11,-459.4 386420.16,-452.46 386455,-447 386667.34,-413.74 386911.74,-389.83 387082.9,-375.41"/>
<polygon fill="black" stroke="black" points="387083.36,-378.88 387093.04,-374.55 387082.78,-371.9 387083.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1893" class="edge">
<title>layer_9_expert_3_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M386905.92,-461.9C386972.29,-444.56 387048.66,-424.62 387116.4,-406.94"/>
<polygon fill="black" stroke="black" points="387117.53,-410.26 387126.33,-404.35 387115.77,-403.49 387117.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1894" class="edge">
<title>layer_9_expert_4_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M387300,-455C387300,-443.95 387300,-432.15 387300,-420.75"/>
<polygon fill="black" stroke="black" points="387303.5,-420.41 387300,-410.41 387296.5,-420.41 387303.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1895" class="edge">
<title>layer_9_expert_5_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M387667.67,-455C387615.2,-441.3 387558.31,-426.44 387505.31,-412.61"/>
<polygon fill="black" stroke="black" points="387506.02,-409.18 387495.46,-410.04 387504.25,-415.95 387506.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1896" class="edge">
<title>layer_9_expert_6_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M388192.13,-455C388176.21,-452.11 388160.39,-449.41 388145,-447 387948.91,-416.29 387725.48,-393.55 387557.64,-378.88"/>
<polygon fill="black" stroke="black" points="387557.94,-375.4 387547.68,-378.02 387557.34,-382.37 387557.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_5&#45;&gt;layer_9_agg_ep_5 -->
<g id="edge1897" class="edge">
<title>layer_9_expert_7_ep_5&#45;&gt;layer_9_agg_ep_5</title>
<path fill="none" stroke="black" d="M388759.44,-454.98C388742.09,-451.99 388724.79,-449.28 388708,-447 388300.89,-391.83 387822.79,-371.18 387541.51,-363.5"/>
<polygon fill="black" stroke="black" points="387541.26,-359.99 387531.17,-363.22 387541.07,-366.99 387541.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_6 -->
<g id="node1025" class="node">
<title>layer_9_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="392087.07,-410 391636.77,-410 391520.93,-306 391971.23,-306 392087.07,-410"/>
<text text-anchor="middle" x="391804" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="391804" y="-361" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="391804" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="391804" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1899" class="edge">
<title>layer_9_expert_0_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M389724.39,-465.2C389760.11,-458.05 389797.64,-451.47 389833,-447 390163.72,-405.18 391130.93,-376.08 391575.58,-364.54"/>
<polygon fill="black" stroke="black" points="391575.76,-368.03 391585.66,-364.27 391575.58,-361.03 391575.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1900" class="edge">
<title>layer_9_expert_1_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M390287.82,-465.62C390323.43,-458.45 390360.8,-451.77 390396,-447 390808.65,-391.08 391294.25,-370.62 391573.87,-363.19"/>
<polygon fill="black" stroke="black" points="391574.24,-366.68 391584.14,-362.92 391574.05,-359.68 391574.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1901" class="edge">
<title>layer_9_expert_2_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M390851.74,-466.6C390887.11,-459.4 390924.16,-452.46 390959,-447 391171.34,-413.74 391415.74,-389.83 391586.9,-375.41"/>
<polygon fill="black" stroke="black" points="391587.36,-378.88 391597.04,-374.55 391586.78,-371.9 391587.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1902" class="edge">
<title>layer_9_expert_3_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M391409.92,-461.9C391476.29,-444.56 391552.66,-424.62 391620.4,-406.94"/>
<polygon fill="black" stroke="black" points="391621.53,-410.26 391630.33,-404.35 391619.77,-403.49 391621.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1903" class="edge">
<title>layer_9_expert_4_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M391804,-455C391804,-443.95 391804,-432.15 391804,-420.75"/>
<polygon fill="black" stroke="black" points="391807.5,-420.41 391804,-410.41 391800.5,-420.41 391807.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1904" class="edge">
<title>layer_9_expert_5_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M392171.67,-455C392119.2,-441.3 392062.31,-426.44 392009.31,-412.61"/>
<polygon fill="black" stroke="black" points="392010.02,-409.18 391999.46,-410.04 392008.25,-415.95 392010.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1905" class="edge">
<title>layer_9_expert_6_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M392696.13,-455C392680.21,-452.11 392664.39,-449.41 392649,-447 392452.91,-416.29 392229.48,-393.55 392061.64,-378.88"/>
<polygon fill="black" stroke="black" points="392061.94,-375.4 392051.68,-378.02 392061.34,-382.37 392061.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_6&#45;&gt;layer_9_agg_ep_6 -->
<g id="edge1906" class="edge">
<title>layer_9_expert_7_ep_6&#45;&gt;layer_9_agg_ep_6</title>
<path fill="none" stroke="black" d="M393263.44,-454.98C393246.09,-451.99 393228.79,-449.28 393212,-447 392804.89,-391.83 392326.79,-371.18 392045.51,-363.5"/>
<polygon fill="black" stroke="black" points="392045.26,-359.99 392035.17,-363.22 392045.07,-366.99 392045.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_7 -->
<g id="node1026" class="node">
<title>layer_9_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="396591.07,-410 396140.77,-410 396024.93,-306 396475.23,-306 396591.07,-410"/>
<text text-anchor="middle" x="396308" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="396308" y="-361" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="396308" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="396308" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_expert_0_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1908" class="edge">
<title>layer_9_expert_0_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M394228.39,-465.2C394264.11,-458.05 394301.64,-451.47 394337,-447 394667.72,-405.18 395634.93,-376.08 396079.58,-364.54"/>
<polygon fill="black" stroke="black" points="396079.76,-368.03 396089.66,-364.27 396079.58,-361.03 396079.76,-368.03"/>
</g>
<!-- layer_9_expert_1_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1909" class="edge">
<title>layer_9_expert_1_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M394791.82,-465.62C394827.43,-458.45 394864.8,-451.77 394900,-447 395312.65,-391.08 395798.25,-370.62 396077.87,-363.19"/>
<polygon fill="black" stroke="black" points="396078.24,-366.68 396088.14,-362.92 396078.05,-359.68 396078.24,-366.68"/>
</g>
<!-- layer_9_expert_2_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1910" class="edge">
<title>layer_9_expert_2_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M395355.74,-466.6C395391.11,-459.4 395428.16,-452.46 395463,-447 395675.34,-413.74 395919.74,-389.83 396090.9,-375.41"/>
<polygon fill="black" stroke="black" points="396091.36,-378.88 396101.04,-374.55 396090.78,-371.9 396091.36,-378.88"/>
</g>
<!-- layer_9_expert_3_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1911" class="edge">
<title>layer_9_expert_3_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M395913.92,-461.9C395980.29,-444.56 396056.66,-424.62 396124.4,-406.94"/>
<polygon fill="black" stroke="black" points="396125.53,-410.26 396134.33,-404.35 396123.77,-403.49 396125.53,-410.26"/>
</g>
<!-- layer_9_expert_4_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1912" class="edge">
<title>layer_9_expert_4_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M396308,-455C396308,-443.95 396308,-432.15 396308,-420.75"/>
<polygon fill="black" stroke="black" points="396311.5,-420.41 396308,-410.41 396304.5,-420.41 396311.5,-420.41"/>
</g>
<!-- layer_9_expert_5_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1913" class="edge">
<title>layer_9_expert_5_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M396675.67,-455C396623.2,-441.3 396566.31,-426.44 396513.31,-412.61"/>
<polygon fill="black" stroke="black" points="396514.02,-409.18 396503.46,-410.04 396512.25,-415.95 396514.02,-409.18"/>
</g>
<!-- layer_9_expert_6_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1914" class="edge">
<title>layer_9_expert_6_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M397200.13,-455C397184.21,-452.11 397168.39,-449.41 397153,-447 396956.91,-416.29 396733.48,-393.55 396565.64,-378.88"/>
<polygon fill="black" stroke="black" points="396565.94,-375.4 396555.68,-378.02 396565.34,-382.37 396565.94,-375.4"/>
</g>
<!-- layer_9_expert_7_ep_7&#45;&gt;layer_9_agg_ep_7 -->
<g id="edge1915" class="edge">
<title>layer_9_expert_7_ep_7&#45;&gt;layer_9_agg_ep_7</title>
<path fill="none" stroke="black" d="M397767.44,-454.98C397750.09,-451.99 397732.79,-449.28 397716,-447 397308.89,-391.83 396830.79,-371.18 396549.51,-363.5"/>
<polygon fill="black" stroke="black" points="396549.26,-359.99 396539.17,-363.22 396549.07,-366.99 396549.26,-359.99"/>
</g>
<!-- layer_9_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1853" class="edge">
<title>layer_9_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M364999.51,-352.85C365623.95,-341.29 367463.8,-308.82 368992,-298 369902.21,-291.56 433618.91,-304.32 434529,-288 434541.45,-287.78 434544.55,-287.22 434557,-287 435560.46,-268.96 505814.38,-269.48 506818,-269 537959.2,-254.12 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1862" class="edge">
<title>layer_9_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M369503.51,-352.85C370127.95,-341.29 371967.8,-308.83 373496,-298 374344.01,-291.99 433706.11,-303.21 434554,-288 434566.45,-287.78 434569.55,-287.22 434582,-287 435585.12,-268.97 505814.72,-269.48 506818,-269 537959.2,-254.12 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1871" class="edge">
<title>layer_9_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M374007.51,-352.86C374631.95,-341.29 376471.8,-308.84 378000,-298 378785.8,-292.43 433793.31,-302.1 434579,-288 434591.45,-287.78 434594.55,-287.22 434607,-287 435609.77,-268.97 505815.07,-269.48 506818,-269 537959.2,-254.12 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1880" class="edge">
<title>layer_9_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M378511.51,-352.86C379135.95,-341.3 380975.8,-308.85 382504,-298 383227.59,-292.86 433880.51,-300.98 434604,-288 434616.45,-287.78 434619.55,-287.22 434632,-287 435634.42,-268.98 505815.42,-269.48 506818,-269 537959.2,-254.12 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1889" class="edge">
<title>layer_9_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M383015.51,-352.86C383639.95,-341.3 385479.8,-308.86 387008,-298 387669.39,-293.3 433967.7,-299.87 434629,-288 434641.45,-287.78 434644.55,-287.22 434657,-287 435659.07,-268.99 505815.76,-269.48 506818,-269 537959.2,-254.12 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1898" class="edge">
<title>layer_9_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M387519.51,-352.86C388143.95,-341.31 389983.8,-308.88 391512,-298 392111.18,-293.73 434054.9,-298.76 434654,-288 434666.45,-287.78 434669.55,-287.22 434682,-287 435683.73,-268.99 505816.11,-269.48 506818,-269 537959.2,-254.12 576654.62,-220.1 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1907" class="edge">
<title>layer_9_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M392023.51,-352.86C392647.95,-341.32 394487.8,-308.9 396016,-298 397089.94,-290.34 433605.03,-288.28 434679,-288 466740.78,-279.63 474756.22,-284.54 506818,-269 537959.2,-253.9 576654.62,-220.09 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge1916" class="edge">
<title>layer_9_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M396531.68,-356.56C398846.93,-352.01 418680.78,-313.56 434740,-298 466774.65,-266.97 474783.34,-286.76 506818,-269 537959.2,-251.74 576654.62,-219.96 578924.23,-218.09"/>
<polygon fill="black" stroke="black" points="578924.39,-221.59 578934.38,-218.08 578924.38,-214.59 578924.39,-221.59"/>
</g>
<!-- layer_9_moe_alltoall -->
<g id="node1027" class="node">
<title>layer_9_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="386822" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="386822" y="-861" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="386822" y="-850" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="386822" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="386822" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_9_ln_tp_0 -->
<g id="node1028" class="node">
<title>layer_9_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="393818.07,-899 393367.77,-899 393251.93,-795 393702.23,-795 393818.07,-899"/>
<text text-anchor="middle" x="393535" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="393535" y="-850" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="393535" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="393535" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_qkv_tp_0 -->
<g id="node1032" class="node">
<title>layer_10_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="324469.7,-729 324027.94,-729 323914.3,-625 324356.06,-625 324469.7,-729"/>
<text text-anchor="middle" x="324192" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="324192" y="-680" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="324192" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="324192" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_9_ln_tp_0&#45;&gt;layer_10_qkv_tp_0 -->
<g id="edge3113" class="edge">
<title>layer_9_ln_tp_0&#45;&gt;layer_10_qkv_tp_0</title>
<path fill="none" stroke="black" d="M393252.66,-795.88C393249.43,-795.57 393246.2,-795.28 393243,-795 393025.8,-776.14 330671.02,-777.34 330453,-777 330121.11,-776.48 324807.62,-806.5 324479,-760 324436.84,-754.03 324392.18,-743.45 324350.97,-731.83"/>
<polygon fill="black" stroke="black" points="324351.7,-728.4 324341.13,-729.02 324349.78,-735.13 324351.7,-728.4"/>
</g>
<!-- layer_9_ln_tp_1 -->
<g id="node1029" class="node">
<title>layer_9_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="394402.07,-899 393951.77,-899 393835.93,-795 394286.23,-795 394402.07,-899"/>
<text text-anchor="middle" x="394119" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="394119" y="-850" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="394119" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="394119" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_qkv_tp_1 -->
<g id="node1033" class="node">
<title>layer_10_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="325043.7,-729 324601.94,-729 324488.3,-625 324930.06,-625 325043.7,-729"/>
<text text-anchor="middle" x="324766" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="324766" y="-680" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="324766" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="324766" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_9_ln_tp_1&#45;&gt;layer_10_qkv_tp_1 -->
<g id="edge3114" class="edge">
<title>layer_9_ln_tp_1&#45;&gt;layer_10_qkv_tp_1</title>
<path fill="none" stroke="black" d="M393836.66,-795.88C393833.43,-795.57 393830.2,-795.28 393827,-795 393627.49,-777.68 336352.26,-777.18 336152,-777 336113.46,-776.96 325091.16,-765.37 325053,-760 325010.84,-754.06 324966.18,-743.49 324924.96,-731.87"/>
<polygon fill="black" stroke="black" points="324925.7,-728.44 324915.12,-729.05 324923.77,-735.17 324925.7,-728.44"/>
</g>
<!-- layer_9_ln_tp_2 -->
<g id="node1030" class="node">
<title>layer_9_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="394986.07,-899 394535.77,-899 394419.93,-795 394870.23,-795 394986.07,-899"/>
<text text-anchor="middle" x="394703" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="394703" y="-850" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="394703" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="394703" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_qkv_tp_2 -->
<g id="node1034" class="node">
<title>layer_10_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="325617.7,-729 325175.94,-729 325062.3,-625 325504.06,-625 325617.7,-729"/>
<text text-anchor="middle" x="325340" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="325340" y="-680" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="325340" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="325340" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_9_ln_tp_2&#45;&gt;layer_10_qkv_tp_2 -->
<g id="edge3115" class="edge">
<title>layer_9_ln_tp_2&#45;&gt;layer_10_qkv_tp_2</title>
<path fill="none" stroke="black" d="M394420.66,-795.88C394417.43,-795.57 394414.2,-795.28 394411,-795 394246.91,-780.75 347140.7,-777.1 346976,-777 346938.94,-776.98 325663.7,-765.16 325627,-760 325584.84,-754.08 325540.17,-743.51 325498.96,-731.89"/>
<polygon fill="black" stroke="black" points="325499.7,-728.46 325489.12,-729.08 325497.77,-735.19 325499.7,-728.46"/>
</g>
<!-- layer_9_ln_tp_3 -->
<g id="node1031" class="node">
<title>layer_9_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="395570.07,-899 395119.77,-899 395003.93,-795 395454.23,-795 395570.07,-899"/>
<text text-anchor="middle" x="395287" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="395287" y="-850" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="395287" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="395287" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_qkv_tp_3 -->
<g id="node1035" class="node">
<title>layer_10_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="326191.7,-729 325749.94,-729 325636.3,-625 326078.06,-625 326191.7,-729"/>
<text text-anchor="middle" x="325914" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="325914" y="-680" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="325914" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="325914" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_9_ln_tp_3&#45;&gt;layer_10_qkv_tp_3 -->
<g id="edge3116" class="edge">
<title>layer_9_ln_tp_3&#45;&gt;layer_10_qkv_tp_3</title>
<path fill="none" stroke="black" d="M395004.66,-795.89C395001.43,-795.57 394998.2,-795.28 394995,-795 394824.76,-780.18 370558.88,-777.24 370388,-777 351743.47,-750.72 328702.38,-685.94 326147.29,-678.67"/>
<polygon fill="black" stroke="black" points="326147.11,-675.17 326137.1,-678.64 326147.09,-682.17 326147.11,-675.17"/>
</g>
<!-- layer_10_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1925" class="edge">
<title>layer_10_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M324371.63,-639.09C324407.07,-633.22 324444.09,-628.08 324479,-625 324479,-625 579362,-607 579362,-607 579378.44,-603.12 579387.12,-604.37 579396,-590 579429.41,-535.94 579421.78,-505.09 579396,-447 579390.89,-435.5 579386.74,-432.52 579375,-428 579375,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_10_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1926" class="edge">
<title>layer_10_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M324945.63,-639.09C324981.07,-633.22 325018.09,-628.08 325053,-625 325053,-625 579389,-607 579389,-607 579459.37,-589.47 579453.22,-511.97 579421,-447 579414.8,-434.5 579409.23,-432.46 579396,-428 579396,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_10_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1927" class="edge">
<title>layer_10_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M325519.63,-639.09C325555.07,-633.22 325592.09,-628.08 325627,-625 325627,-625 579414,-607 579414,-607 579484.37,-589.47 579479.41,-511.36 579446,-447 579439.24,-433.98 579432.99,-432.43 579419,-428 579419,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_10_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge1928" class="edge">
<title>layer_10_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M326133.62,-675.58C328360.25,-671.34 347081.27,-636.27 362243,-625 362243,-625 579438,-607 579438,-607 579508.56,-589.89 579505.52,-510.88 579471,-447 579463.67,-433.44 579456.77,-432.41 579442,-428 579442,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_10_qkv_comm -->
<g id="node1036" class="node">
<title>layer_10_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="323703" cy="-677" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="323703" y="-691" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="323703" y="-680" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="323703" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="323703" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_10_attn_tp_0 -->
<g id="node1037" class="node">
<title>layer_10_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="290732.7,-729 290290.94,-729 290177.3,-625 290619.06,-625 290732.7,-729"/>
<text text-anchor="middle" x="290455" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="290455" y="-680" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="290455" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="290455" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_out_tp_0 -->
<g id="node1041" class="node">
<title>layer_10_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="290732.7,-559 290290.94,-559 290177.3,-455 290619.06,-455 290732.7,-559"/>
<text text-anchor="middle" x="290455" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="290455" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="290455" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="290455" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_tp_0&#45;&gt;layer_10_attn_out_tp_0 -->
<g id="edge1933" class="edge">
<title>layer_10_attn_tp_0&#45;&gt;layer_10_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M290455,-624.68C290455,-607.18 290455,-587.43 290455,-569.22"/>
<polygon fill="black" stroke="black" points="290458.5,-569 290455,-559 290451.5,-569 290458.5,-569"/>
</g>
<!-- layer_10_attn_tp_1 -->
<g id="node1038" class="node">
<title>layer_10_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="291306.7,-729 290864.94,-729 290751.3,-625 291193.06,-625 291306.7,-729"/>
<text text-anchor="middle" x="291029" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="291029" y="-680" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="291029" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="291029" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_out_tp_1 -->
<g id="node1042" class="node">
<title>layer_10_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="291306.7,-559 290864.94,-559 290751.3,-455 291193.06,-455 291306.7,-559"/>
<text text-anchor="middle" x="291029" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="291029" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="291029" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="291029" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_tp_1&#45;&gt;layer_10_attn_out_tp_1 -->
<g id="edge1935" class="edge">
<title>layer_10_attn_tp_1&#45;&gt;layer_10_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M291029,-624.68C291029,-607.18 291029,-587.43 291029,-569.22"/>
<polygon fill="black" stroke="black" points="291032.5,-569 291029,-559 291025.5,-569 291032.5,-569"/>
</g>
<!-- layer_10_attn_tp_2 -->
<g id="node1039" class="node">
<title>layer_10_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="291880.7,-729 291438.94,-729 291325.3,-625 291767.06,-625 291880.7,-729"/>
<text text-anchor="middle" x="291603" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="291603" y="-680" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="291603" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="291603" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_out_tp_2 -->
<g id="node1043" class="node">
<title>layer_10_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="291880.7,-559 291438.94,-559 291325.3,-455 291767.06,-455 291880.7,-559"/>
<text text-anchor="middle" x="291603" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="291603" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="291603" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="291603" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_tp_2&#45;&gt;layer_10_attn_out_tp_2 -->
<g id="edge1937" class="edge">
<title>layer_10_attn_tp_2&#45;&gt;layer_10_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M291603,-624.68C291603,-607.18 291603,-587.43 291603,-569.22"/>
<polygon fill="black" stroke="black" points="291606.5,-569 291603,-559 291599.5,-569 291606.5,-569"/>
</g>
<!-- layer_10_attn_tp_3 -->
<g id="node1040" class="node">
<title>layer_10_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="292454.7,-729 292012.94,-729 291899.3,-625 292341.06,-625 292454.7,-729"/>
<text text-anchor="middle" x="292177" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="292177" y="-680" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="292177" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="292177" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_out_tp_3 -->
<g id="node1044" class="node">
<title>layer_10_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="292454.7,-559 292012.94,-559 291899.3,-455 292341.06,-455 292454.7,-559"/>
<text text-anchor="middle" x="292177" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="292177" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="292177" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="292177" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_10_attn_tp_3&#45;&gt;layer_10_attn_out_tp_3 -->
<g id="edge1939" class="edge">
<title>layer_10_attn_tp_3&#45;&gt;layer_10_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M292177,-624.68C292177,-607.18 292177,-587.43 292177,-569.22"/>
<polygon fill="black" stroke="black" points="292180.5,-569 292177,-559 292173.5,-569 292180.5,-569"/>
</g>
<!-- layer_10_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1934" class="edge">
<title>layer_10_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M290300.04,-559.1C290254.48,-571.81 290204.19,-583.62 290157,-590 290157,-590 145076,-598 145076,-598 145061.55,-612.45 145072.65,-634.07 145085.9,-650.88"/>
<polygon fill="black" stroke="black" points="145083.36,-653.3 145092.48,-658.7 145088.72,-648.79 145083.36,-653.3"/>
</g>
<!-- layer_10_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1936" class="edge">
<title>layer_10_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M290879.88,-559.1C290836.01,-571.81 290787.55,-583.62 290742,-590 290742,-590 145101,-598 145101,-598 145087.87,-611.13 145091.26,-632.38 145097.31,-649.39"/>
<polygon fill="black" stroke="black" points="145094.12,-650.83 145101.08,-658.82 145100.62,-648.23 145094.12,-650.83"/>
</g>
<!-- layer_10_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1938" class="edge">
<title>layer_10_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M291453.88,-559.1C291410.01,-571.81 291361.55,-583.62 291316,-590 291316,-590 145126,-598 145126,-598 145111.36,-609.94 145107.79,-631.36 145107.65,-648.73"/>
<polygon fill="black" stroke="black" points="145104.15,-649.01 145107.93,-658.9 145111.15,-648.81 145104.15,-649.01"/>
</g>
<!-- layer_10_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge1940" class="edge">
<title>layer_10_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M292027.88,-559.1C291984.01,-571.81 291935.55,-583.62 291890,-590 291890,-590 145151,-598 145151,-598 145132.74,-609.03 145122.21,-631.18 145116.41,-649.06"/>
<polygon fill="black" stroke="black" points="145113.03,-648.15 145113.58,-658.73 145119.75,-650.11 145113.03,-648.15"/>
</g>
<!-- layer_10_attn_allreduce -->
<g id="node1045" class="node">
<title>layer_10_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="313848" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="313848" y="-691" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="313848" y="-680" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="313848" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="313848" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_gate_tp_0 -->
<g id="node1046" class="node">
<title>layer_10_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="305214.99,-729 304766.4,-729 304651.01,-625 305099.6,-625 305214.99,-729"/>
<text text-anchor="middle" x="304933" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="304933" y="-680" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="304933" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="304933" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_10_route_ep_0 -->
<g id="node1050" class="node">
<title>layer_10_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="314103.43,-559 313644.6,-559 313526.57,-455 313985.4,-455 314103.43,-559"/>
<text text-anchor="middle" x="313815" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="313815" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="313815" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="313815" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_0 -->
<g id="edge1941" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305115.97,-639.42C305151.66,-633.57 305188.9,-628.34 305224,-625 305345.36,-613.44 306201.58,-631.5 306321,-607 306331.35,-604.88 306332.64,-600.05 306343,-598 306386.53,-589.38 309493.63,-590.48 309538,-590 311082.22,-573.26 312939.66,-529.62 313582.65,-513.82"/>
<polygon fill="black" stroke="black" points="313583.05,-517.31 313592.96,-513.56 313582.88,-510.31 313583.05,-517.31"/>
<text text-anchor="middle" x="306369" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_1 -->
<g id="node1051" class="node">
<title>layer_10_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="306220.43,-559 305761.6,-559 305643.57,-455 306102.4,-455 306220.43,-559"/>
<text text-anchor="middle" x="305932" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="305932" y="-510" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="305932" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="305932" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_1 -->
<g id="edge1942" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M304966.57,-624.62C304975.83,-614.17 304986.74,-604.42 304999,-598 305116.12,-536.68 305460.4,-516.94 305696.32,-510.71"/>
<polygon fill="black" stroke="black" points="305696.51,-514.2 305706.42,-510.45 305696.33,-507.2 305696.51,-514.2"/>
<text text-anchor="middle" x="305025" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_2 -->
<g id="node1052" class="node">
<title>layer_10_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="323111.43,-559 322652.6,-559 322534.57,-455 322993.4,-455 323111.43,-559"/>
<text text-anchor="middle" x="322823" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="322823" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="322823" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="322823" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_2 -->
<g id="edge1943" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305115.54,-639.1C305151.36,-633.26 305188.75,-628.11 305224,-625 305404.1,-609.09 311552.19,-607.57 311733,-607 312879.22,-603.42 313165.77,-601.07 314312,-598 315268.44,-595.44 317659.61,-600.21 318616,-590 320132,-573.82 321954.89,-529.98 322590.75,-513.96"/>
<polygon fill="black" stroke="black" points="322591.04,-517.46 322600.95,-513.71 322590.87,-510.46 322591.04,-517.46"/>
<text text-anchor="middle" x="314338" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_3 -->
<g id="node1053" class="node">
<title>layer_10_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="293765.43,-559 293306.6,-559 293188.57,-455 293647.4,-455 293765.43,-559"/>
<text text-anchor="middle" x="293477" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="293477" y="-510" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="293477" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="293477" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_3 -->
<g id="edge1944" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M304705.16,-674C303811.09,-666.02 300455.98,-634.64 297694,-590 296185.66,-565.62 294374.02,-527.38 293724.04,-513.37"/>
<polygon fill="black" stroke="black" points="293723.68,-509.86 293713.61,-513.15 293723.53,-516.86 293723.68,-509.86"/>
<text text-anchor="middle" x="298704" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_4 -->
<g id="node1054" class="node">
<title>layer_10_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="302863.43,-559 302404.6,-559 302286.57,-455 302745.4,-455 302863.43,-559"/>
<text text-anchor="middle" x="302575" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="302575" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="302575" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="302575" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_4 -->
<g id="edge1945" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M304697.17,-666.84C304431.87,-655.81 303988.19,-635.19 303607,-607 303349.26,-587.94 303055.99,-559.12 302848.13,-537.48"/>
<polygon fill="black" stroke="black" points="302848.29,-533.98 302837.98,-536.42 302847.57,-540.94 302848.29,-533.98"/>
<text text-anchor="middle" x="303633" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_5 -->
<g id="node1055" class="node">
<title>layer_10_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="318607.43,-559 318148.6,-559 318030.57,-455 318489.4,-455 318607.43,-559"/>
<text text-anchor="middle" x="318319" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="318319" y="-510" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="318319" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="318319" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_5 -->
<g id="edge1946" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305115.56,-639.24C305151.37,-633.38 305188.75,-628.2 305224,-625 305356.74,-612.95 307492.32,-633.21 307623,-607 307633.36,-604.92 307634.64,-600.04 307645,-598 307689.06,-589.31 314067.09,-590.47 314112,-590 315628.24,-574.29 317451.44,-530.15 318087.04,-514.01"/>
<polygon fill="black" stroke="black" points="318087.33,-517.5 318097.23,-513.75 318087.15,-510.5 318087.33,-517.5"/>
<text text-anchor="middle" x="307671" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_6 -->
<g id="node1056" class="node">
<title>layer_10_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="309529.43,-559 309070.6,-559 308952.57,-455 309411.4,-455 309529.43,-559"/>
<text text-anchor="middle" x="309241" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="309241" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="309241" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="309241" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_6 -->
<g id="edge1947" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305117.28,-640.58C305152.6,-634.68 305189.37,-629.14 305224,-625 305408.85,-602.9 305455.98,-605.27 305642,-598 305902.71,-587.81 305968.14,-595.33 306229,-590 307266.88,-568.8 308505.6,-531.19 309010.12,-515.36"/>
<polygon fill="black" stroke="black" points="309010.54,-518.84 309020.43,-515.03 309010.32,-511.85 309010.54,-518.84"/>
<text text-anchor="middle" x="305668" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_route_ep_7 -->
<g id="node1057" class="node">
<title>layer_10_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="298279.43,-559 297820.6,-559 297702.57,-455 298161.4,-455 298279.43,-559"/>
<text text-anchor="middle" x="297991" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="297991" y="-510" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="297991" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="297991" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_7 -->
<g id="edge1948" class="edge">
<title>layer_10_gate_tp_0&#45;&gt;layer_10_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M304706.42,-675.28C303787.14,-672.05 300332.83,-656.8 299241,-607 298902.6,-591.57 298513.75,-558.32 298260.8,-534.61"/>
<polygon fill="black" stroke="black" points="298261.02,-531.12 298250.74,-533.67 298260.37,-538.09 298261.02,-531.12"/>
<text text-anchor="middle" x="299267" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1 -->
<g id="node1047" class="node">
<title>layer_10_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="306378.99,-729 305930.4,-729 305815.01,-625 306263.6,-625 306378.99,-729"/>
<text text-anchor="middle" x="306097" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="306097" y="-680" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="306097" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="306097" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_0 -->
<g id="edge1949" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306279.56,-639.34C306315.38,-633.47 306352.76,-628.26 306388,-625 306431.57,-620.97 309494.25,-590.66 309538,-590 311081.44,-566.63 312937.96,-527.16 313581.78,-513.13"/>
<polygon fill="black" stroke="black" points="313582.18,-516.62 313592.1,-512.91 313582.03,-509.63 313582.18,-516.62"/>
<text text-anchor="middle" x="308709" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_1 -->
<g id="edge1950" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306046.6,-624.68C306028.45,-606.2 306007.84,-585.22 305989.15,-566.19"/>
<polygon fill="black" stroke="black" points="305991.6,-563.69 305982.09,-559 305986.6,-568.59 305991.6,-563.69"/>
<text text-anchor="middle" x="306050" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_2 -->
<g id="edge1951" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306279.54,-639.06C306315.35,-633.22 306352.74,-628.09 306388,-625 306578.12,-608.34 319938.19,-610.63 320129,-607 321044.09,-589.59 322133.16,-541.01 322596.42,-519.04"/>
<polygon fill="black" stroke="black" points="322596.75,-522.53 322606.57,-518.56 322596.41,-515.54 322596.75,-522.53"/>
<text text-anchor="middle" x="320521" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_3 -->
<g id="edge1952" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305816.02,-625.94C305812.66,-625.61 305809.32,-625.29 305806,-625 305506.73,-598.47 300698.42,-610.61 300398,-607 300204.64,-604.68 300156.36,-600.34 299963,-598 298954.62,-585.79 298702.38,-601.58 297694,-590 296186.24,-572.68 294375.62,-530.17 293724.91,-514.2"/>
<polygon fill="black" stroke="black" points="293724.55,-510.69 293714.47,-513.94 293724.38,-517.69 293724.55,-510.69"/>
<text text-anchor="middle" x="300424" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_4 -->
<g id="edge1953" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305816,-626.08C305812.65,-625.7 305809.32,-625.34 305806,-625 305563.61,-599.9 305501.36,-619.68 305258,-607 305201.93,-604.08 305188.06,-600.99 305132,-598 304284.93,-552.86 303278.76,-524.98 302822.21,-513.73"/>
<polygon fill="black" stroke="black" points="302822.28,-510.23 302812.2,-513.49 302822.11,-517.23 302822.28,-510.23"/>
<text text-anchor="middle" x="305284" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_5 -->
<g id="edge1954" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306279.54,-639.09C306315.36,-633.24 306352.75,-628.1 306388,-625 306625.42,-604.1 314729.7,-610.77 314968,-607 316142.22,-588.43 317547.18,-537.63 318089.69,-516.94"/>
<polygon fill="black" stroke="black" points="318090.12,-520.43 318099.98,-516.55 318089.86,-513.44 318090.12,-520.43"/>
<text text-anchor="middle" x="315449" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_6 -->
<g id="edge1955" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306280.43,-640.05C306315.99,-634.16 306353.07,-628.76 306388,-625 307352.64,-521.15 308509.84,-507.71 309001.36,-507.13"/>
<polygon fill="black" stroke="black" points="309001.42,-510.63 309011.42,-507.12 309001.41,-503.63 309001.42,-510.63"/>
<text text-anchor="middle" x="306644" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_7 -->
<g id="edge1956" class="edge">
<title>layer_10_gate_tp_1&#45;&gt;layer_10_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305816.01,-625.99C305812.66,-625.65 305809.32,-625.31 305806,-625 305545.14,-600.31 304889,-611.13 304627,-607 304380.78,-603.12 304319.24,-600.55 304073,-598 303275.26,-589.74 303075.73,-599.41 302278,-590 300741.61,-571.88 298895.86,-529.67 298238.36,-514"/>
<polygon fill="black" stroke="black" points="298238.37,-510.5 298228.29,-513.76 298238.21,-517.5 298238.37,-510.5"/>
<text text-anchor="middle" x="304653" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2 -->
<g id="node1048" class="node">
<title>layer_10_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="306960.99,-729 306512.4,-729 306397.01,-625 306845.6,-625 306960.99,-729"/>
<text text-anchor="middle" x="306679" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="306679" y="-680" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="306679" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="306679" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_0 -->
<g id="edge1957" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306901.06,-674.87C307578.37,-670.98 309677.76,-655.56 311417,-607 312215.68,-584.7 313163.31,-540.26 313588.63,-519.36"/>
<polygon fill="black" stroke="black" points="313589.07,-522.84 313598.89,-518.86 313588.73,-515.85 313589.07,-522.84"/>
<text text-anchor="middle" x="311703" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_1 -->
<g id="edge1958" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306398.7,-626.75C306395.11,-626.16 306391.54,-625.58 306388,-625 306335.21,-616.38 306321.23,-618.56 306269,-607 306213.12,-594.62 306152.91,-578.02 306099.06,-561.94"/>
<polygon fill="black" stroke="black" points="306100.01,-558.57 306089.43,-559.05 306098,-565.28 306100.01,-558.57"/>
<text text-anchor="middle" x="306295" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_2 -->
<g id="edge1959" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306899.98,-673.99C307762.67,-666.22 310987.01,-637.95 313642,-625 314465.33,-620.98 320229.01,-630.99 321052,-607 321610.48,-590.72 322266.89,-547.79 322601.91,-524.16"/>
<polygon fill="black" stroke="black" points="322602.49,-527.63 322612.22,-523.43 322602,-520.65 322602.49,-527.63"/>
<text text-anchor="middle" x="321319" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_3 -->
<g id="edge1960" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306398.02,-625.94C306394.66,-625.61 306391.32,-625.3 306388,-625 306305.85,-617.67 300532.47,-598.31 300450,-598 299225.11,-593.44 298918.82,-603.69 297694,-590 296186.24,-573.15 294375.62,-530.35 293724.91,-514.25"/>
<polygon fill="black" stroke="black" points="293724.55,-510.74 293714.47,-513.99 293724.38,-517.74 293724.55,-510.74"/>
<text text-anchor="middle" x="302920" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_4 -->
<g id="edge1961" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306398.01,-626C306394.66,-625.65 306391.32,-625.32 306388,-625 305932.68,-581.39 305814.14,-652.47 305359,-607 305336.97,-604.8 305332.01,-600.37 305310,-598 304831.39,-546.46 303396.68,-520.12 302819.48,-511.38"/>
<polygon fill="black" stroke="black" points="302819.42,-507.88 302809.37,-511.23 302819.31,-514.88 302819.42,-507.88"/>
<text text-anchor="middle" x="305385" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_5 -->
<g id="edge1962" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306900.35,-674.12C307763.59,-666.84 310987.4,-640.18 313642,-625 313763.61,-624.3 317899.98,-626.61 318020,-607 318075.13,-597.99 318133.88,-580.41 318184.58,-562.53"/>
<polygon fill="black" stroke="black" points="318186.04,-565.72 318194.28,-559.07 318183.69,-559.13 318186.04,-565.72"/>
<text text-anchor="middle" x="318087" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_6 -->
<g id="edge1963" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306880.78,-656.42C307061.47,-639.35 307333.75,-614.76 307571,-598 308086.02,-561.61 308691.3,-532.35 309012.97,-517.87"/>
<polygon fill="black" stroke="black" points="309013.52,-521.35 309023.35,-517.41 309013.2,-514.36 309013.52,-521.35"/>
<text text-anchor="middle" x="307597" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_7 -->
<g id="edge1964" class="edge">
<title>layer_10_gate_tp_2&#45;&gt;layer_10_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M306398.01,-625.98C306394.66,-625.64 306391.32,-625.31 306388,-625 306065.15,-594.92 305253.15,-614.83 304929,-607 304817.85,-604.31 304790.16,-600.19 304679,-598 304145.54,-587.51 302811.52,-595.99 302278,-590 300741.6,-572.75 298895.85,-530.01 298238.36,-514.1"/>
<polygon fill="black" stroke="black" points="298238.37,-510.6 298228.29,-513.85 298238.2,-517.6 298238.37,-510.6"/>
<text text-anchor="middle" x="304955" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3 -->
<g id="node1049" class="node">
<title>layer_10_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="305796.99,-729 305348.4,-729 305233.01,-625 305681.6,-625 305796.99,-729"/>
<text text-anchor="middle" x="305515" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="305515" y="-680" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="305515" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="305515" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_0 -->
<g id="edge1965" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305697.56,-639.29C305733.37,-633.43 305770.76,-628.23 305806,-625 306015.68,-605.76 307490.51,-612.62 307701,-607 307792.17,-604.57 307814.83,-600.22 307906,-598 308268.56,-589.16 309175.36,-594.36 309538,-590 311081.96,-571.42 312939.1,-528.93 313582.36,-513.63"/>
<polygon fill="black" stroke="black" points="313582.76,-517.12 313592.67,-513.38 313582.59,-510.12 313582.76,-517.12"/>
<text text-anchor="middle" x="307932" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_1 -->
<g id="edge1966" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305641.81,-624.91C305690.44,-605.32 305746.1,-582.9 305795.59,-562.96"/>
<polygon fill="black" stroke="black" points="305797.11,-566.12 305805.07,-559.14 305794.49,-559.63 305797.11,-566.12"/>
<text text-anchor="middle" x="305724" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_2 -->
<g id="edge1967" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305697.54,-639.07C305733.35,-633.22 305770.74,-628.09 305806,-625 305976.33,-610.06 317946.02,-608.92 318117,-607 319835.85,-587.67 321907.27,-533.26 322591.39,-514.48"/>
<polygon fill="black" stroke="black" points="322591.71,-517.97 322601.61,-514.2 322591.52,-510.97 322591.71,-517.97"/>
<text text-anchor="middle" x="318783" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_3 -->
<g id="edge1968" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305234.02,-625.94C305230.66,-625.61 305227.32,-625.29 305224,-625 305076.99,-611.96 300058.58,-608.32 299911,-607 299636.32,-604.53 299567.68,-600.69 299293,-598 298582.36,-591.05 298404.62,-598.69 297694,-590 296186.03,-571.57 294375.08,-529.72 293724.61,-514.06"/>
<polygon fill="black" stroke="black" points="293724.26,-510.55 293714.18,-513.81 293724.09,-517.55 293724.26,-510.55"/>
<text text-anchor="middle" x="299937" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_4 -->
<g id="edge1969" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305234.72,-626.62C305231.12,-626.07 305227.55,-625.53 305224,-625 305160.22,-615.43 305143.05,-620.61 305080,-607 305066.81,-604.15 305064.3,-600.26 305051,-598 304626.62,-525.75 303352.23,-511.46 302816.46,-508.67"/>
<polygon fill="black" stroke="black" points="302816.3,-505.17 302806.28,-508.61 302816.26,-512.16 302816.3,-505.17"/>
<text text-anchor="middle" x="305106" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_5 -->
<g id="edge1970" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305697.54,-639.09C305733.36,-633.24 305770.75,-628.1 305806,-625 306042.92,-604.15 314130.19,-610.23 314368,-607 315099.88,-597.06 317356.03,-534.93 318087.49,-514.5"/>
<polygon fill="black" stroke="black" points="318087.71,-518 318097.61,-514.22 318087.52,-511 318087.71,-518"/>
<text text-anchor="middle" x="314877" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_6 -->
<g id="edge1971" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305698.4,-639.75C305733.97,-633.89 305771.05,-628.57 305806,-625 306068.31,-598.17 306135.56,-618.27 306399,-607 306471.49,-603.9 306489.52,-601.22 306562,-598 307466.84,-557.83 308544.3,-526.72 309008.92,-514.11"/>
<polygon fill="black" stroke="black" points="309009.2,-517.6 309019.1,-513.83 309009.01,-510.61 309009.2,-517.6"/>
<text text-anchor="middle" x="306588" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_7 -->
<g id="edge1972" class="edge">
<title>layer_10_gate_tp_3&#45;&gt;layer_10_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M305234.01,-625.99C305230.66,-625.64 305227.32,-625.31 305224,-625 304957.82,-599.84 304288.31,-612.32 304021,-607 303860.09,-603.8 303819.92,-600.47 303659,-598 303045.28,-588.59 302891.74,-597.65 302278,-590 300741.39,-570.85 298895.31,-529.26 298238.07,-513.88"/>
<polygon fill="black" stroke="black" points="298238.08,-510.38 298228,-513.64 298237.92,-517.38 298238.08,-510.38"/>
<text text-anchor="middle" x="304047" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_10_expert_0_ep_0 -->
<g id="node1058" class="node">
<title>layer_10_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="313242.83,-410 312808.82,-410 312697.17,-306 313131.18,-306 313242.83,-410"/>
<text text-anchor="middle" x="312970" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="312970" y="-361" font-family="Arial" font-size="10.00">GPU: 256</text>
<text text-anchor="middle" x="312970" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="312970" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_0_ep_0 -->
<g id="edge1973" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M313529.78,-458.08C313440.48,-442.9 313341.61,-425.93 313251,-410 313250.9,-409.98 313250.79,-409.96 313250.69,-409.95"/>
<polygon fill="black" stroke="black" points="313251.51,-406.54 313241.05,-408.25 313250.29,-413.43 313251.51,-406.54"/>
</g>
<!-- layer_10_expert_1_ep_0 -->
<g id="node1059" class="node">
<title>layer_10_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="313805.83,-410 313371.82,-410 313260.17,-306 313694.18,-306 313805.83,-410"/>
<text text-anchor="middle" x="313533" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="313533" y="-361" font-family="Arial" font-size="10.00">GPU: 257</text>
<text text-anchor="middle" x="313533" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="313533" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_1_ep_0 -->
<g id="edge1974" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M313717.16,-455C313692.26,-442.02 313665.37,-428 313640.03,-414.79"/>
<polygon fill="black" stroke="black" points="313641.63,-411.68 313631.14,-410.16 313638.39,-417.89 313641.63,-411.68"/>
</g>
<!-- layer_10_expert_2_ep_0 -->
<g id="node1060" class="node">
<title>layer_10_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="314368.83,-410 313934.82,-410 313823.17,-306 314257.18,-306 314368.83,-410"/>
<text text-anchor="middle" x="314096" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="314096" y="-361" font-family="Arial" font-size="10.00">GPU: 258</text>
<text text-anchor="middle" x="314096" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="314096" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_2_ep_0 -->
<g id="edge1975" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M313912.49,-455C313937.2,-442.07 313963.87,-428.12 313989.02,-414.97"/>
<polygon fill="black" stroke="black" points="313990.97,-417.9 313998.21,-410.16 313987.72,-411.69 313990.97,-417.9"/>
</g>
<!-- layer_10_expert_3_ep_0 -->
<g id="node1061" class="node">
<title>layer_10_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="314931.83,-410 314497.82,-410 314386.17,-306 314820.18,-306 314931.83,-410"/>
<text text-anchor="middle" x="314659" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="314659" y="-361" font-family="Arial" font-size="10.00">GPU: 259</text>
<text text-anchor="middle" x="314659" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="314659" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_3_ep_0 -->
<g id="edge1976" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M314006.94,-473.79C314115.83,-455.39 314254.59,-431.72 314378,-410 314407.17,-404.87 314438.04,-399.35 314468.21,-393.91"/>
<polygon fill="black" stroke="black" points="314469.19,-397.29 314478.41,-392.07 314467.95,-390.4 314469.19,-397.29"/>
</g>
<!-- layer_10_expert_4_ep_0 -->
<g id="node1062" class="node">
<title>layer_10_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="315494.83,-410 315060.82,-410 314949.17,-306 315383.18,-306 315494.83,-410"/>
<text text-anchor="middle" x="315222" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="315222" y="-361" font-family="Arial" font-size="10.00">GPU: 260</text>
<text text-anchor="middle" x="315222" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="315222" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_4_ep_0 -->
<g id="edge1977" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M314029.42,-493.77C314256.45,-479.4 314624.97,-452.06 314941,-410 314970.94,-406.02 315002.53,-401.04 315033.31,-395.77"/>
<polygon fill="black" stroke="black" points="315034.01,-399.2 315043.27,-394.05 315032.82,-392.31 315034.01,-399.2"/>
</g>
<!-- layer_10_expert_5_ep_0 -->
<g id="node1063" class="node">
<title>layer_10_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="316057.83,-410 315623.82,-410 315512.17,-306 315946.18,-306 316057.83,-410"/>
<text text-anchor="middle" x="315785" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="315785" y="-361" font-family="Arial" font-size="10.00">GPU: 261</text>
<text text-anchor="middle" x="315785" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="315785" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_5_ep_0 -->
<g id="edge1978" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M314038.78,-502.01C314362.89,-494.26 314981.39,-472.04 315504,-410 315534.21,-406.41 315566.08,-401.62 315597.08,-396.4"/>
<polygon fill="black" stroke="black" points="315597.85,-399.82 315607.12,-394.69 315596.67,-392.92 315597.85,-399.82"/>
</g>
<!-- layer_10_expert_6_ep_0 -->
<g id="node1064" class="node">
<title>layer_10_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="316620.83,-410 316186.82,-410 316075.17,-306 316509.18,-306 316620.83,-410"/>
<text text-anchor="middle" x="316348" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="316348" y="-361" font-family="Arial" font-size="10.00">GPU: 262</text>
<text text-anchor="middle" x="316348" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="316348" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_6_ep_0 -->
<g id="edge1979" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M314043.95,-506.57C314451.87,-505.28 315330.73,-492.12 316067,-410 316097.35,-406.62 316129.35,-401.91 316160.47,-396.71"/>
<polygon fill="black" stroke="black" points="316161.26,-400.13 316170.54,-395.01 316160.09,-393.22 316161.26,-400.13"/>
</g>
<!-- layer_10_expert_7_ep_0 -->
<g id="node1065" class="node">
<title>layer_10_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="317183.83,-410 316749.82,-410 316638.17,-306 317072.18,-306 317183.83,-410"/>
<text text-anchor="middle" x="316911" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="316911" y="-361" font-family="Arial" font-size="10.00">GPU: 263</text>
<text text-anchor="middle" x="316911" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="316911" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_0&#45;&gt;layer_10_expert_7_ep_0 -->
<g id="edge1980" class="edge">
<title>layer_10_route_ep_0&#45;&gt;layer_10_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M314035.05,-498.66C314409.59,-486.15 315194.98,-459.83 315859,-437 316201.67,-425.22 316289.09,-446.71 316630,-410 316660.36,-406.73 316692.37,-402.08 316723.49,-396.91"/>
<polygon fill="black" stroke="black" points="316724.28,-400.33 316733.56,-395.21 316723.12,-393.42 316724.28,-400.33"/>
</g>
<!-- layer_10_expert_0_ep_1 -->
<g id="node1066" class="node">
<title>layer_10_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="304234.83,-410 303800.82,-410 303689.17,-306 304123.18,-306 304234.83,-410"/>
<text text-anchor="middle" x="303962" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="303962" y="-361" font-family="Arial" font-size="10.00">GPU: 272</text>
<text text-anchor="middle" x="303962" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="303962" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_0_ep_1 -->
<g id="edge1981" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M305696.57,-501.73C305371.53,-493.78 304767.14,-471.59 304243.74,-410.05"/>
<polygon fill="black" stroke="black" points="304244.06,-406.57 304233.72,-408.87 304243.24,-413.52 304244.06,-406.57"/>
</g>
<!-- layer_10_expert_1_ep_1 -->
<g id="node1067" class="node">
<title>layer_10_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="304797.83,-410 304363.82,-410 304252.17,-306 304686.18,-306 304797.83,-410"/>
<text text-anchor="middle" x="304525" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="304525" y="-361" font-family="Arial" font-size="10.00">GPU: 273</text>
<text text-anchor="middle" x="304525" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="304525" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_1_ep_1 -->
<g id="edge1982" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M305684.98,-491.68C305458.82,-476.98 305114.81,-450.67 304806.76,-410.07"/>
<polygon fill="black" stroke="black" points="304807.11,-406.59 304796.73,-408.74 304806.19,-413.53 304807.11,-406.59"/>
</g>
<!-- layer_10_expert_2_ep_1 -->
<g id="node1068" class="node">
<title>layer_10_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="305360.83,-410 304926.82,-410 304815.17,-306 305249.18,-306 305360.83,-410"/>
<text text-anchor="middle" x="305088" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="305088" y="-361" font-family="Arial" font-size="10.00">GPU: 274</text>
<text text-anchor="middle" x="305088" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="305088" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_2_ep_1 -->
<g id="edge1983" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M305646.93,-458C305557.89,-442.84 305459.33,-425.9 305369,-410 305368.9,-409.98 305368.79,-409.96 305368.69,-409.95"/>
<polygon fill="black" stroke="black" points="305369.51,-406.54 305359.05,-408.25 305368.29,-413.43 305369.51,-406.54"/>
</g>
<!-- layer_10_expert_3_ep_1 -->
<g id="node1069" class="node">
<title>layer_10_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="305923.83,-410 305489.82,-410 305378.17,-306 305812.18,-306 305923.83,-410"/>
<text text-anchor="middle" x="305651" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="305651" y="-361" font-family="Arial" font-size="10.00">GPU: 275</text>
<text text-anchor="middle" x="305651" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="305651" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_3_ep_1 -->
<g id="edge1984" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M305834.51,-455C305809.8,-442.07 305783.13,-428.12 305757.98,-414.97"/>
<polygon fill="black" stroke="black" points="305759.28,-411.69 305748.79,-410.16 305756.03,-417.9 305759.28,-411.69"/>
</g>
<!-- layer_10_expert_4_ep_1 -->
<g id="node1070" class="node">
<title>layer_10_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="306486.83,-410 306052.82,-410 305941.17,-306 306375.18,-306 306486.83,-410"/>
<text text-anchor="middle" x="306214" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="306214" y="-361" font-family="Arial" font-size="10.00">GPU: 276</text>
<text text-anchor="middle" x="306214" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="306214" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_4_ep_1 -->
<g id="edge1985" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M306029.84,-455C306054.74,-442.02 306081.63,-428 306106.97,-414.79"/>
<polygon fill="black" stroke="black" points="306108.61,-417.89 306115.86,-410.16 306105.37,-411.68 306108.61,-417.89"/>
</g>
<!-- layer_10_expert_5_ep_1 -->
<g id="node1071" class="node">
<title>layer_10_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="307049.83,-410 306615.82,-410 306504.17,-306 306938.18,-306 307049.83,-410"/>
<text text-anchor="middle" x="306777" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="306777" y="-361" font-family="Arial" font-size="10.00">GPU: 277</text>
<text text-anchor="middle" x="306777" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="306777" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_5_ep_1 -->
<g id="edge1986" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M306123.96,-473.86C306233.09,-455.46 306372.25,-431.76 306496,-410 306525.18,-404.87 306556.04,-399.36 306586.21,-393.92"/>
<polygon fill="black" stroke="black" points="306587.19,-397.3 306596.41,-392.08 306585.95,-390.41 306587.19,-397.3"/>
</g>
<!-- layer_10_expert_6_ep_1 -->
<g id="node1072" class="node">
<title>layer_10_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="307612.83,-410 307178.82,-410 307067.17,-306 307501.18,-306 307612.83,-410"/>
<text text-anchor="middle" x="307340" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="307340" y="-361" font-family="Arial" font-size="10.00">GPU: 278</text>
<text text-anchor="middle" x="307340" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="307340" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_6_ep_1 -->
<g id="edge1987" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M306146.61,-493.78C306373.85,-479.42 306742.69,-452.08 307059,-410 307088.94,-406.02 307120.53,-401.04 307151.31,-395.77"/>
<polygon fill="black" stroke="black" points="307152.01,-399.21 307161.27,-394.05 307150.82,-392.31 307152.01,-399.21"/>
</g>
<!-- layer_10_expert_7_ep_1 -->
<g id="node1073" class="node">
<title>layer_10_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="308175.83,-410 307741.82,-410 307630.17,-306 308064.18,-306 308175.83,-410"/>
<text text-anchor="middle" x="307903" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="307903" y="-361" font-family="Arial" font-size="10.00">GPU: 279</text>
<text text-anchor="middle" x="307903" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="307903" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_1&#45;&gt;layer_10_expert_7_ep_1 -->
<g id="edge1988" class="edge">
<title>layer_10_route_ep_1&#45;&gt;layer_10_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M306155.91,-502.02C306480.21,-494.28 307099.08,-472.07 307622,-410 307652.21,-406.41 307684.08,-401.62 307715.08,-396.4"/>
<polygon fill="black" stroke="black" points="307715.85,-399.82 307725.12,-394.69 307714.67,-392.92 307715.85,-399.82"/>
</g>
<!-- layer_10_expert_0_ep_2 -->
<g id="node1074" class="node">
<title>layer_10_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="322250.83,-410 321816.82,-410 321705.17,-306 322139.18,-306 322250.83,-410"/>
<text text-anchor="middle" x="321978" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="321978" y="-361" font-family="Arial" font-size="10.00">GPU: 288</text>
<text text-anchor="middle" x="321978" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="321978" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_0_ep_2 -->
<g id="edge1989" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M322537.78,-458.08C322448.48,-442.9 322349.61,-425.93 322259,-410 322258.9,-409.98 322258.79,-409.96 322258.69,-409.95"/>
<polygon fill="black" stroke="black" points="322259.51,-406.54 322249.05,-408.25 322258.29,-413.43 322259.51,-406.54"/>
</g>
<!-- layer_10_expert_1_ep_2 -->
<g id="node1075" class="node">
<title>layer_10_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="322813.83,-410 322379.82,-410 322268.17,-306 322702.18,-306 322813.83,-410"/>
<text text-anchor="middle" x="322541" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="322541" y="-361" font-family="Arial" font-size="10.00">GPU: 289</text>
<text text-anchor="middle" x="322541" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="322541" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_1_ep_2 -->
<g id="edge1990" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M322725.16,-455C322700.26,-442.02 322673.37,-428 322648.03,-414.79"/>
<polygon fill="black" stroke="black" points="322649.63,-411.68 322639.14,-410.16 322646.39,-417.89 322649.63,-411.68"/>
</g>
<!-- layer_10_expert_2_ep_2 -->
<g id="node1076" class="node">
<title>layer_10_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="323376.83,-410 322942.82,-410 322831.17,-306 323265.18,-306 323376.83,-410"/>
<text text-anchor="middle" x="323104" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="323104" y="-361" font-family="Arial" font-size="10.00">GPU: 290</text>
<text text-anchor="middle" x="323104" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="323104" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_2_ep_2 -->
<g id="edge1991" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M322920.49,-455C322945.2,-442.07 322971.87,-428.12 322997.02,-414.97"/>
<polygon fill="black" stroke="black" points="322998.97,-417.9 323006.21,-410.16 322995.72,-411.69 322998.97,-417.9"/>
</g>
<!-- layer_10_expert_3_ep_2 -->
<g id="node1077" class="node">
<title>layer_10_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="323939.83,-410 323505.82,-410 323394.17,-306 323828.18,-306 323939.83,-410"/>
<text text-anchor="middle" x="323667" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="323667" y="-361" font-family="Arial" font-size="10.00">GPU: 291</text>
<text text-anchor="middle" x="323667" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="323667" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_3_ep_2 -->
<g id="edge1992" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M323014.94,-473.79C323123.83,-455.39 323262.59,-431.72 323386,-410 323415.17,-404.87 323446.04,-399.35 323476.21,-393.91"/>
<polygon fill="black" stroke="black" points="323477.19,-397.29 323486.41,-392.07 323475.95,-390.4 323477.19,-397.29"/>
</g>
<!-- layer_10_expert_4_ep_2 -->
<g id="node1078" class="node">
<title>layer_10_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="324502.83,-410 324068.82,-410 323957.17,-306 324391.18,-306 324502.83,-410"/>
<text text-anchor="middle" x="324230" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="324230" y="-361" font-family="Arial" font-size="10.00">GPU: 292</text>
<text text-anchor="middle" x="324230" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="324230" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_4_ep_2 -->
<g id="edge1993" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M323037.42,-493.77C323264.45,-479.4 323632.97,-452.06 323949,-410 323978.94,-406.02 324010.53,-401.04 324041.31,-395.77"/>
<polygon fill="black" stroke="black" points="324042.01,-399.2 324051.27,-394.05 324040.82,-392.31 324042.01,-399.2"/>
</g>
<!-- layer_10_expert_5_ep_2 -->
<g id="node1079" class="node">
<title>layer_10_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="325065.83,-410 324631.82,-410 324520.17,-306 324954.18,-306 325065.83,-410"/>
<text text-anchor="middle" x="324793" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="324793" y="-361" font-family="Arial" font-size="10.00">GPU: 293</text>
<text text-anchor="middle" x="324793" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="324793" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_5_ep_2 -->
<g id="edge1994" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M323046.78,-502.01C323370.89,-494.26 323989.39,-472.04 324512,-410 324542.21,-406.41 324574.08,-401.62 324605.08,-396.4"/>
<polygon fill="black" stroke="black" points="324605.85,-399.82 324615.12,-394.69 324604.67,-392.92 324605.85,-399.82"/>
</g>
<!-- layer_10_expert_6_ep_2 -->
<g id="node1080" class="node">
<title>layer_10_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="325628.83,-410 325194.82,-410 325083.17,-306 325517.18,-306 325628.83,-410"/>
<text text-anchor="middle" x="325356" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="325356" y="-361" font-family="Arial" font-size="10.00">GPU: 294</text>
<text text-anchor="middle" x="325356" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="325356" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_6_ep_2 -->
<g id="edge1995" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M323051.95,-506.57C323459.87,-505.28 324338.73,-492.12 325075,-410 325105.35,-406.62 325137.35,-401.91 325168.47,-396.71"/>
<polygon fill="black" stroke="black" points="325169.26,-400.13 325178.54,-395.01 325168.09,-393.22 325169.26,-400.13"/>
</g>
<!-- layer_10_expert_7_ep_2 -->
<g id="node1081" class="node">
<title>layer_10_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="326191.83,-410 325757.82,-410 325646.17,-306 326080.18,-306 326191.83,-410"/>
<text text-anchor="middle" x="325919" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="325919" y="-361" font-family="Arial" font-size="10.00">GPU: 295</text>
<text text-anchor="middle" x="325919" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="325919" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_2&#45;&gt;layer_10_expert_7_ep_2 -->
<g id="edge1996" class="edge">
<title>layer_10_route_ep_2&#45;&gt;layer_10_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M323043.05,-498.66C323417.59,-486.15 324202.98,-459.83 324867,-437 325209.67,-425.22 325297.09,-446.71 325638,-410 325668.36,-406.73 325700.37,-402.08 325731.49,-396.91"/>
<polygon fill="black" stroke="black" points="325732.28,-400.33 325741.56,-395.21 325731.12,-393.42 325732.28,-400.33"/>
</g>
<!-- layer_10_expert_0_ep_3 -->
<g id="node1082" class="node">
<title>layer_10_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="290722.83,-410 290288.82,-410 290177.17,-306 290611.18,-306 290722.83,-410"/>
<text text-anchor="middle" x="290450" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="290450" y="-361" font-family="Arial" font-size="10.00">GPU: 304</text>
<text text-anchor="middle" x="290450" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="290450" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_0_ep_3 -->
<g id="edge1997" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M293225.81,-488.03C293020.92,-474.18 292723.91,-455.93 292464,-447 292082.32,-433.89 291130.44,-450.87 290732.25,-410.08"/>
<polygon fill="black" stroke="black" points="290732.39,-406.57 290722.08,-409.01 290731.66,-413.53 290732.39,-406.57"/>
</g>
<!-- layer_10_expert_1_ep_3 -->
<g id="node1083" class="node">
<title>layer_10_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="291285.83,-410 290851.82,-410 290740.17,-306 291174.18,-306 291285.83,-410"/>
<text text-anchor="middle" x="291013" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="291013" y="-361" font-family="Arial" font-size="10.00">GPU: 305</text>
<text text-anchor="middle" x="291013" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="291013" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_1_ep_3 -->
<g id="edge1998" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M293227.83,-489.64C293022.84,-476.62 292724.68,-458.71 292464,-447 291947.56,-423.8 291813.07,-464.31 291295.05,-410.07"/>
<polygon fill="black" stroke="black" points="291295.39,-406.59 291285.08,-409.02 291294.66,-413.55 291295.39,-406.59"/>
</g>
<!-- layer_10_expert_2_ep_3 -->
<g id="node1084" class="node">
<title>layer_10_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="291848.83,-410 291414.82,-410 291303.17,-306 291737.18,-306 291848.83,-410"/>
<text text-anchor="middle" x="291576" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="291576" y="-361" font-family="Arial" font-size="10.00">GPU: 306</text>
<text text-anchor="middle" x="291576" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="291576" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_2_ep_3 -->
<g id="edge1999" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M293229.66,-491.53C292802.56,-466.52 291962.97,-417.25 291858,-409.69"/>
<polygon fill="black" stroke="black" points="291857.97,-406.18 291847.72,-408.86 291857.4,-413.15 291857.97,-406.18"/>
</g>
<!-- layer_10_expert_3_ep_3 -->
<g id="node1085" class="node">
<title>layer_10_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="292411.83,-410 291977.82,-410 291866.17,-306 292300.18,-306 292411.83,-410"/>
<text text-anchor="middle" x="292139" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="292139" y="-361" font-family="Arial" font-size="10.00">GPU: 307</text>
<text text-anchor="middle" x="292139" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="292139" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_3_ep_3 -->
<g id="edge2000" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M293227.76,-489.65C293015.63,-474.25 292702.79,-448.04 292420.76,-410.07"/>
<polygon fill="black" stroke="black" points="292421.12,-406.59 292410.74,-408.72 292420.18,-413.53 292421.12,-406.59"/>
</g>
<!-- layer_10_expert_4_ep_3 -->
<g id="node1086" class="node">
<title>layer_10_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="292974.83,-410 292540.82,-410 292429.17,-306 292863.18,-306 292974.83,-410"/>
<text text-anchor="middle" x="292702" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="292702" y="-361" font-family="Arial" font-size="10.00">GPU: 308</text>
<text text-anchor="middle" x="292702" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="292702" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_4_ep_3 -->
<g id="edge2001" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M293208.12,-455C293134.69,-441.07 293054.97,-425.95 292980.99,-411.92"/>
<polygon fill="black" stroke="black" points="292981.54,-408.46 292971.06,-410.04 292980.24,-415.34 292981.54,-408.46"/>
</g>
<!-- layer_10_expert_5_ep_3 -->
<g id="node1087" class="node">
<title>layer_10_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="293537.83,-410 293103.82,-410 292992.17,-306 293426.18,-306 293537.83,-410"/>
<text text-anchor="middle" x="293265" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="293265" y="-361" font-family="Arial" font-size="10.00">GPU: 309</text>
<text text-anchor="middle" x="293265" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="293265" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_5_ep_3 -->
<g id="edge2002" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M293403.45,-455C293385.3,-442.41 293365.75,-428.86 293347.21,-416.01"/>
<polygon fill="black" stroke="black" points="293348.99,-412.98 293338.78,-410.16 293345,-418.73 293348.99,-412.98"/>
</g>
<!-- layer_10_expert_6_ep_3 -->
<g id="node1088" class="node">
<title>layer_10_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="294100.83,-410 293666.82,-410 293555.17,-306 293989.18,-306 294100.83,-410"/>
<text text-anchor="middle" x="293828" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="293828" y="-361" font-family="Arial" font-size="10.00">GPU: 310</text>
<text text-anchor="middle" x="293828" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="293828" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_6_ep_3 -->
<g id="edge2003" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M293598.78,-455C293630.41,-441.75 293664.61,-427.43 293696.7,-413.99"/>
<polygon fill="black" stroke="black" points="293698.27,-417.13 293706.14,-410.04 293695.56,-410.67 293698.27,-417.13"/>
</g>
<!-- layer_10_expert_7_ep_3 -->
<g id="node1089" class="node">
<title>layer_10_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="294663.83,-410 294229.82,-410 294118.17,-306 294552.18,-306 294663.83,-410"/>
<text text-anchor="middle" x="294391" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="294391" y="-361" font-family="Arial" font-size="10.00">GPU: 311</text>
<text text-anchor="middle" x="294391" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="294391" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_3&#45;&gt;layer_10_expert_7_ep_3 -->
<g id="edge2004" class="edge">
<title>layer_10_route_ep_3&#45;&gt;layer_10_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M293673.27,-477.73C293798.4,-459.34 293963.9,-434.33 294110,-410 294139.46,-405.09 294170.61,-399.67 294201.03,-394.25"/>
<polygon fill="black" stroke="black" points="294201.65,-397.7 294210.87,-392.49 294200.41,-390.81 294201.65,-397.7"/>
</g>
<!-- layer_10_expert_0_ep_4 -->
<g id="node1090" class="node">
<title>layer_10_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="299730.83,-410 299296.82,-410 299185.17,-306 299619.18,-306 299730.83,-410"/>
<text text-anchor="middle" x="299458" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="299458" y="-361" font-family="Arial" font-size="10.00">GPU: 320</text>
<text text-anchor="middle" x="299458" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="299458" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_0_ep_4 -->
<g id="edge2005" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M302335.53,-498.38C301946.52,-485.93 301153.06,-460.3 300481,-437 300154.58,-425.68 300068.83,-445.15 299740.37,-410.11"/>
<polygon fill="black" stroke="black" points="299740.4,-406.59 299730.08,-409 299739.65,-413.55 299740.4,-406.59"/>
</g>
<!-- layer_10_expert_1_ep_4 -->
<g id="node1091" class="node">
<title>layer_10_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="300293.83,-410 299859.82,-410 299748.17,-306 300182.18,-306 300293.83,-410"/>
<text text-anchor="middle" x="300021" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="300021" y="-361" font-family="Arial" font-size="10.00">GPU: 321</text>
<text text-anchor="middle" x="300021" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="300021" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_1_ep_4 -->
<g id="edge2006" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M302345.14,-506.7C301935.81,-505.63 301053.88,-492.93 300302.93,-410.06"/>
<polygon fill="black" stroke="black" points="300303.04,-406.55 300292.71,-408.93 300302.27,-413.51 300303.04,-406.55"/>
</g>
<!-- layer_10_expert_2_ep_4 -->
<g id="node1092" class="node">
<title>layer_10_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="300856.83,-410 300422.82,-410 300311.17,-306 300745.18,-306 300856.83,-410"/>
<text text-anchor="middle" x="300584" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="300584" y="-361" font-family="Arial" font-size="10.00">GPU: 322</text>
<text text-anchor="middle" x="300584" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="300584" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_2_ep_4 -->
<g id="edge2007" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M302339.79,-501.97C302011.48,-494.28 301397.35,-472.36 300865.89,-410.07"/>
<polygon fill="black" stroke="black" points="300866.06,-406.56 300855.72,-408.87 300865.24,-413.52 300866.06,-406.56"/>
</g>
<!-- layer_10_expert_3_ep_4 -->
<g id="node1093" class="node">
<title>layer_10_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="301419.83,-410 300985.82,-410 300874.17,-306 301308.18,-306 301419.83,-410"/>
<text text-anchor="middle" x="301147" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="301147" y="-361" font-family="Arial" font-size="10.00">GPU: 323</text>
<text text-anchor="middle" x="301147" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="301147" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_3_ep_4 -->
<g id="edge2008" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M302328.7,-492.25C302098.44,-477.79 301744.98,-451.49 301429.01,-410.1"/>
<polygon fill="black" stroke="black" points="301429.11,-406.59 301418.73,-408.75 301428.19,-413.53 301429.11,-406.59"/>
</g>
<!-- layer_10_expert_4_ep_4 -->
<g id="node1094" class="node">
<title>layer_10_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="301982.83,-410 301548.82,-410 301437.17,-306 301871.18,-306 301982.83,-410"/>
<text text-anchor="middle" x="301710" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="301710" y="-361" font-family="Arial" font-size="10.00">GPU: 324</text>
<text text-anchor="middle" x="301710" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="301710" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_4_ep_4 -->
<g id="edge2009" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M302292.65,-460.56C302196.84,-444.88 302089.21,-426.98 301991,-410 301990.9,-409.98 301990.79,-409.96 301990.69,-409.95"/>
<polygon fill="black" stroke="black" points="301991.5,-406.53 301981.05,-408.27 301990.3,-413.43 301991.5,-406.53"/>
</g>
<!-- layer_10_expert_5_ep_4 -->
<g id="node1095" class="node">
<title>layer_10_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="302545.83,-410 302111.82,-410 302000.17,-306 302434.18,-306 302545.83,-410"/>
<text text-anchor="middle" x="302273" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="302273" y="-361" font-family="Arial" font-size="10.00">GPU: 325</text>
<text text-anchor="middle" x="302273" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="302273" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_5_ep_4 -->
<g id="edge2010" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M302470.22,-455C302443.36,-441.92 302414.34,-427.8 302387.04,-414.51"/>
<polygon fill="black" stroke="black" points="302388.37,-411.26 302377.85,-410.04 302385.31,-417.56 302388.37,-411.26"/>
</g>
<!-- layer_10_expert_6_ep_4 -->
<g id="node1096" class="node">
<title>layer_10_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="303108.83,-410 302674.82,-410 302563.17,-306 302997.18,-306 303108.83,-410"/>
<text text-anchor="middle" x="302836" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="302836" y="-361" font-family="Arial" font-size="10.00">GPU: 326</text>
<text text-anchor="middle" x="302836" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="302836" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_6_ep_4 -->
<g id="edge2011" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M302665.55,-455C302688.4,-442.13 302713.05,-428.25 302736.32,-415.14"/>
<polygon fill="black" stroke="black" points="302738.17,-418.12 302745.17,-410.16 302734.73,-412.02 302738.17,-418.12"/>
</g>
<!-- layer_10_expert_7_ep_4 -->
<g id="node1097" class="node">
<title>layer_10_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="303671.83,-410 303237.82,-410 303126.17,-306 303560.18,-306 303671.83,-410"/>
<text text-anchor="middle" x="303399" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="303399" y="-361" font-family="Arial" font-size="10.00">GPU: 327</text>
<text text-anchor="middle" x="303399" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="303399" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_4&#45;&gt;layer_10_expert_7_ep_4 -->
<g id="edge2012" class="edge">
<title>layer_10_route_ep_4&#45;&gt;layer_10_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M302765.39,-472.56C302869.57,-454.2 303000.92,-430.97 303118,-410 303147.16,-404.78 303178.01,-399.21 303208.18,-393.75"/>
<polygon fill="black" stroke="black" points="303209.17,-397.13 303218.38,-391.91 303207.92,-390.24 303209.17,-397.13"/>
</g>
<!-- layer_10_expert_0_ep_5 -->
<g id="node1098" class="node">
<title>layer_10_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="317746.83,-410 317312.82,-410 317201.17,-306 317635.18,-306 317746.83,-410"/>
<text text-anchor="middle" x="317474" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="317474" y="-361" font-family="Arial" font-size="10.00">GPU: 336</text>
<text text-anchor="middle" x="317474" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="317474" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_0_ep_5 -->
<g id="edge2013" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M318033.78,-458.08C317944.48,-442.9 317845.61,-425.93 317755,-410 317754.9,-409.98 317754.79,-409.96 317754.69,-409.95"/>
<polygon fill="black" stroke="black" points="317755.51,-406.54 317745.05,-408.25 317754.29,-413.43 317755.51,-406.54"/>
</g>
<!-- layer_10_expert_1_ep_5 -->
<g id="node1099" class="node">
<title>layer_10_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="318309.83,-410 317875.82,-410 317764.17,-306 318198.18,-306 318309.83,-410"/>
<text text-anchor="middle" x="318037" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="318037" y="-361" font-family="Arial" font-size="10.00">GPU: 337</text>
<text text-anchor="middle" x="318037" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="318037" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_1_ep_5 -->
<g id="edge2014" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M318221.16,-455C318196.26,-442.02 318169.37,-428 318144.03,-414.79"/>
<polygon fill="black" stroke="black" points="318145.63,-411.68 318135.14,-410.16 318142.39,-417.89 318145.63,-411.68"/>
</g>
<!-- layer_10_expert_2_ep_5 -->
<g id="node1100" class="node">
<title>layer_10_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="318872.83,-410 318438.82,-410 318327.17,-306 318761.18,-306 318872.83,-410"/>
<text text-anchor="middle" x="318600" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="318600" y="-361" font-family="Arial" font-size="10.00">GPU: 338</text>
<text text-anchor="middle" x="318600" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="318600" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_2_ep_5 -->
<g id="edge2015" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M318416.49,-455C318441.2,-442.07 318467.87,-428.12 318493.02,-414.97"/>
<polygon fill="black" stroke="black" points="318494.97,-417.9 318502.21,-410.16 318491.72,-411.69 318494.97,-417.9"/>
</g>
<!-- layer_10_expert_3_ep_5 -->
<g id="node1101" class="node">
<title>layer_10_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="319435.83,-410 319001.82,-410 318890.17,-306 319324.18,-306 319435.83,-410"/>
<text text-anchor="middle" x="319163" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="319163" y="-361" font-family="Arial" font-size="10.00">GPU: 339</text>
<text text-anchor="middle" x="319163" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="319163" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_3_ep_5 -->
<g id="edge2016" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M318510.94,-473.79C318619.83,-455.39 318758.59,-431.72 318882,-410 318911.17,-404.87 318942.04,-399.35 318972.21,-393.91"/>
<polygon fill="black" stroke="black" points="318973.19,-397.29 318982.41,-392.07 318971.95,-390.4 318973.19,-397.29"/>
</g>
<!-- layer_10_expert_4_ep_5 -->
<g id="node1102" class="node">
<title>layer_10_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="319998.83,-410 319564.82,-410 319453.17,-306 319887.18,-306 319998.83,-410"/>
<text text-anchor="middle" x="319726" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="319726" y="-361" font-family="Arial" font-size="10.00">GPU: 340</text>
<text text-anchor="middle" x="319726" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="319726" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_4_ep_5 -->
<g id="edge2017" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M318533.42,-493.77C318760.45,-479.4 319128.97,-452.06 319445,-410 319474.94,-406.02 319506.53,-401.04 319537.31,-395.77"/>
<polygon fill="black" stroke="black" points="319538.01,-399.2 319547.27,-394.05 319536.82,-392.31 319538.01,-399.2"/>
</g>
<!-- layer_10_expert_5_ep_5 -->
<g id="node1103" class="node">
<title>layer_10_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="320561.83,-410 320127.82,-410 320016.17,-306 320450.18,-306 320561.83,-410"/>
<text text-anchor="middle" x="320289" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="320289" y="-361" font-family="Arial" font-size="10.00">GPU: 341</text>
<text text-anchor="middle" x="320289" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="320289" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_5_ep_5 -->
<g id="edge2018" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M318542.78,-502.01C318866.89,-494.26 319485.39,-472.04 320008,-410 320038.21,-406.41 320070.08,-401.62 320101.08,-396.4"/>
<polygon fill="black" stroke="black" points="320101.85,-399.82 320111.12,-394.69 320100.67,-392.92 320101.85,-399.82"/>
</g>
<!-- layer_10_expert_6_ep_5 -->
<g id="node1104" class="node">
<title>layer_10_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="321124.83,-410 320690.82,-410 320579.17,-306 321013.18,-306 321124.83,-410"/>
<text text-anchor="middle" x="320852" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="320852" y="-361" font-family="Arial" font-size="10.00">GPU: 342</text>
<text text-anchor="middle" x="320852" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="320852" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_6_ep_5 -->
<g id="edge2019" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M318547.95,-506.57C318955.87,-505.28 319834.73,-492.12 320571,-410 320601.35,-406.62 320633.35,-401.91 320664.47,-396.71"/>
<polygon fill="black" stroke="black" points="320665.26,-400.13 320674.54,-395.01 320664.09,-393.22 320665.26,-400.13"/>
</g>
<!-- layer_10_expert_7_ep_5 -->
<g id="node1105" class="node">
<title>layer_10_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="321687.83,-410 321253.82,-410 321142.17,-306 321576.18,-306 321687.83,-410"/>
<text text-anchor="middle" x="321415" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="321415" y="-361" font-family="Arial" font-size="10.00">GPU: 343</text>
<text text-anchor="middle" x="321415" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="321415" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_5&#45;&gt;layer_10_expert_7_ep_5 -->
<g id="edge2020" class="edge">
<title>layer_10_route_ep_5&#45;&gt;layer_10_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M318539.05,-498.66C318913.59,-486.15 319698.98,-459.83 320363,-437 320705.67,-425.22 320793.09,-446.71 321134,-410 321164.36,-406.73 321196.37,-402.08 321227.49,-396.91"/>
<polygon fill="black" stroke="black" points="321228.28,-400.33 321237.56,-395.21 321227.12,-393.42 321228.28,-400.33"/>
</g>
<!-- layer_10_expert_0_ep_6 -->
<g id="node1106" class="node">
<title>layer_10_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="308738.83,-410 308304.82,-410 308193.17,-306 308627.18,-306 308738.83,-410"/>
<text text-anchor="middle" x="308466" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="308466" y="-361" font-family="Arial" font-size="10.00">GPU: 352</text>
<text text-anchor="middle" x="308466" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="308466" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_0_ep_6 -->
<g id="edge2021" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M308972.12,-455C308898.69,-441.07 308818.97,-425.95 308744.99,-411.92"/>
<polygon fill="black" stroke="black" points="308745.54,-408.46 308735.06,-410.04 308744.24,-415.34 308745.54,-408.46"/>
</g>
<!-- layer_10_expert_1_ep_6 -->
<g id="node1107" class="node">
<title>layer_10_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="309301.83,-410 308867.82,-410 308756.17,-306 309190.18,-306 309301.83,-410"/>
<text text-anchor="middle" x="309029" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="309029" y="-361" font-family="Arial" font-size="10.00">GPU: 353</text>
<text text-anchor="middle" x="309029" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="309029" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_1_ep_6 -->
<g id="edge2022" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M309167.45,-455C309149.3,-442.41 309129.75,-428.86 309111.21,-416.01"/>
<polygon fill="black" stroke="black" points="309112.99,-412.98 309102.78,-410.16 309109,-418.73 309112.99,-412.98"/>
</g>
<!-- layer_10_expert_2_ep_6 -->
<g id="node1108" class="node">
<title>layer_10_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="309864.83,-410 309430.82,-410 309319.17,-306 309753.18,-306 309864.83,-410"/>
<text text-anchor="middle" x="309592" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="309592" y="-361" font-family="Arial" font-size="10.00">GPU: 354</text>
<text text-anchor="middle" x="309592" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="309592" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_2_ep_6 -->
<g id="edge2023" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M309362.78,-455C309394.41,-441.75 309428.61,-427.43 309460.7,-413.99"/>
<polygon fill="black" stroke="black" points="309462.27,-417.13 309470.14,-410.04 309459.56,-410.67 309462.27,-417.13"/>
</g>
<!-- layer_10_expert_3_ep_6 -->
<g id="node1109" class="node">
<title>layer_10_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="310427.83,-410 309993.82,-410 309882.17,-306 310316.18,-306 310427.83,-410"/>
<text text-anchor="middle" x="310155" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="310155" y="-361" font-family="Arial" font-size="10.00">GPU: 355</text>
<text text-anchor="middle" x="310155" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="310155" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_3_ep_6 -->
<g id="edge2024" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M309437.27,-477.73C309562.4,-459.34 309727.9,-434.33 309874,-410 309903.46,-405.09 309934.61,-399.67 309965.03,-394.25"/>
<polygon fill="black" stroke="black" points="309965.65,-397.7 309974.87,-392.49 309964.41,-390.81 309965.65,-397.7"/>
</g>
<!-- layer_10_expert_4_ep_6 -->
<g id="node1110" class="node">
<title>layer_10_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="310990.83,-410 310556.82,-410 310445.17,-306 310879.18,-306 310990.83,-410"/>
<text text-anchor="middle" x="310718" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="310718" y="-361" font-family="Arial" font-size="10.00">GPU: 356</text>
<text text-anchor="middle" x="310718" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="310718" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_4_ep_6 -->
<g id="edge2025" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M309457.19,-495.13C309697.26,-481.55 310095.93,-454.53 310437,-410 310467.06,-406.08 310498.78,-401.12 310529.67,-395.84"/>
<polygon fill="black" stroke="black" points="310530.4,-399.27 310539.66,-394.12 310529.21,-392.37 310530.4,-399.27"/>
</g>
<!-- layer_10_expert_5_ep_6 -->
<g id="node1111" class="node">
<title>layer_10_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="311553.83,-410 311119.82,-410 311008.17,-306 311442.18,-306 311553.83,-410"/>
<text text-anchor="middle" x="311281" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="311281" y="-361" font-family="Arial" font-size="10.00">GPU: 357</text>
<text text-anchor="middle" x="311281" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="311281" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_5_ep_6 -->
<g id="edge2026" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M309465.64,-502.72C309800.8,-495.79 310451.17,-474.52 311000,-410 311030.21,-406.45 311062.09,-401.67 311093.09,-396.45"/>
<polygon fill="black" stroke="black" points="311093.85,-399.88 311103.12,-394.75 311092.68,-392.97 311093.85,-399.88"/>
</g>
<!-- layer_10_expert_6_ep_6 -->
<g id="node1112" class="node">
<title>layer_10_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="312116.83,-410 311682.82,-410 311571.17,-306 312005.18,-306 312116.83,-410"/>
<text text-anchor="middle" x="311844" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="311844" y="-361" font-family="Arial" font-size="10.00">GPU: 358</text>
<text text-anchor="middle" x="311844" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="311844" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_6_ep_6 -->
<g id="edge2027" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M309463.47,-500.73C309962.87,-488.26 311160.74,-454.6 311563,-410 311593.35,-406.63 311625.36,-401.94 311656.47,-396.74"/>
<polygon fill="black" stroke="black" points="311657.26,-400.16 311666.54,-395.04 311656.1,-393.26 311657.26,-400.16"/>
</g>
<!-- layer_10_expert_7_ep_6 -->
<g id="node1113" class="node">
<title>layer_10_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="312679.83,-410 312245.82,-410 312134.17,-306 312568.18,-306 312679.83,-410"/>
<text text-anchor="middle" x="312407" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="312407" y="-361" font-family="Arial" font-size="10.00">GPU: 359</text>
<text text-anchor="middle" x="312407" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="312407" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_6&#45;&gt;layer_10_expert_7_ep_6 -->
<g id="edge2028" class="edge">
<title>layer_10_route_ep_6&#45;&gt;layer_10_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M309465.7,-502.78C310050.8,-493.7 311611.65,-464.94 312126,-410 312156.36,-406.76 312188.38,-402.12 312219.5,-396.95"/>
<polygon fill="black" stroke="black" points="312220.28,-400.37 312229.56,-395.26 312219.12,-393.47 312220.28,-400.37"/>
</g>
<!-- layer_10_expert_0_ep_7 -->
<g id="node1114" class="node">
<title>layer_10_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="295226.83,-410 294792.82,-410 294681.17,-306 295115.18,-306 295226.83,-410"/>
<text text-anchor="middle" x="294954" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="294954" y="-361" font-family="Arial" font-size="10.00">GPU: 368</text>
<text text-anchor="middle" x="294954" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="294954" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_0_ep_7 -->
<g id="edge2029" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M297751.06,-498.01C297372.53,-485.36 296613.59,-459.81 295970,-437 295646.67,-425.54 295561.71,-444.87 295236.28,-410.1"/>
<polygon fill="black" stroke="black" points="295236.4,-406.59 295226.08,-409 295235.65,-413.55 295236.4,-406.59"/>
</g>
<!-- layer_10_expert_1_ep_7 -->
<g id="node1115" class="node">
<title>layer_10_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="295789.83,-410 295355.82,-410 295244.17,-306 295678.18,-306 295789.83,-410"/>
<text text-anchor="middle" x="295517" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="295517" y="-361" font-family="Arial" font-size="10.00">GPU: 369</text>
<text text-anchor="middle" x="295517" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="295517" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_1_ep_7 -->
<g id="edge2030" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M297760.52,-506.18C297361.93,-504.21 296518.34,-490.01 295798.76,-410.05"/>
<polygon fill="black" stroke="black" points="295799.04,-406.56 295788.71,-408.92 295798.26,-413.51 295799.04,-406.56"/>
</g>
<!-- layer_10_expert_2_ep_7 -->
<g id="node1116" class="node">
<title>layer_10_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="296352.83,-410 295918.82,-410 295807.17,-306 296241.18,-306 296352.83,-410"/>
<text text-anchor="middle" x="296080" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="296080" y="-361" font-family="Arial" font-size="10.00">GPU: 370</text>
<text text-anchor="middle" x="296080" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="296080" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_2_ep_7 -->
<g id="edge2031" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M297754.69,-501.02C297438.99,-492.34 296862.29,-469.42 296361.68,-410.04"/>
<polygon fill="black" stroke="black" points="296362.06,-406.57 296351.72,-408.86 296361.24,-413.52 296362.06,-406.57"/>
</g>
<!-- layer_10_expert_3_ep_7 -->
<g id="node1117" class="node">
<title>layer_10_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="296915.83,-410 296481.82,-410 296370.17,-306 296804.18,-306 296915.83,-410"/>
<text text-anchor="middle" x="296643" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="296643" y="-361" font-family="Arial" font-size="10.00">GPU: 371</text>
<text text-anchor="middle" x="296643" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="296643" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_3_ep_7 -->
<g id="edge2032" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M297742.08,-489.96C297527.92,-474.66 297210.65,-448.43 296924.89,-410.09"/>
<polygon fill="black" stroke="black" points="296925.12,-406.59 296914.74,-408.72 296924.18,-413.53 296925.12,-406.59"/>
</g>
<!-- layer_10_expert_4_ep_7 -->
<g id="node1118" class="node">
<title>layer_10_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="297478.83,-410 297044.82,-410 296933.17,-306 297367.18,-306 297478.83,-410"/>
<text text-anchor="middle" x="297206" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="297206" y="-361" font-family="Arial" font-size="10.00">GPU: 372</text>
<text text-anchor="middle" x="297206" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="297206" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_4_ep_7 -->
<g id="edge2033" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M297718.65,-455C297644.27,-441.07 297563.52,-425.95 297488.59,-411.92"/>
<polygon fill="black" stroke="black" points="297489.01,-408.44 297478.53,-410.04 297487.72,-415.32 297489.01,-408.44"/>
</g>
<!-- layer_10_expert_5_ep_7 -->
<g id="node1119" class="node">
<title>layer_10_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="298041.83,-410 297607.82,-410 297496.17,-306 297930.18,-306 298041.83,-410"/>
<text text-anchor="middle" x="297769" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="297769" y="-361" font-family="Arial" font-size="10.00">GPU: 373</text>
<text text-anchor="middle" x="297769" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="297769" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_5_ep_7 -->
<g id="edge2034" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M297913.98,-455C297894.89,-442.36 297874.31,-428.73 297854.83,-415.83"/>
<polygon fill="black" stroke="black" points="297856.53,-412.76 297846.26,-410.16 297852.67,-418.6 297856.53,-412.76"/>
</g>
<!-- layer_10_expert_6_ep_7 -->
<g id="node1120" class="node">
<title>layer_10_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="298604.83,-410 298170.82,-410 298059.17,-306 298493.18,-306 298604.83,-410"/>
<text text-anchor="middle" x="298332" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="298332" y="-361" font-family="Arial" font-size="10.00">GPU: 374</text>
<text text-anchor="middle" x="298332" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="298332" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_6_ep_7 -->
<g id="edge2035" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M298109.31,-455C298139.9,-441.81 298172.98,-427.55 298204.04,-414.16"/>
<polygon fill="black" stroke="black" points="298205.81,-417.21 298213.61,-410.04 298203.04,-410.78 298205.81,-417.21"/>
</g>
<!-- layer_10_expert_7_ep_7 -->
<g id="node1121" class="node">
<title>layer_10_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="299167.83,-410 298733.82,-410 298622.17,-306 299056.18,-306 299167.83,-410"/>
<text text-anchor="middle" x="298895" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="298895" y="-361" font-family="Arial" font-size="10.00">GPU: 375</text>
<text text-anchor="middle" x="298895" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="298895" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_10_route_ep_7&#45;&gt;layer_10_expert_7_ep_7 -->
<g id="edge2036" class="edge">
<title>layer_10_route_ep_7&#45;&gt;layer_10_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M298186.93,-477.18C298309.74,-458.77 298471.27,-433.95 298614,-410 298643.45,-405.06 298674.6,-399.62 298705.02,-394.19"/>
<polygon fill="black" stroke="black" points="298705.64,-397.64 298714.86,-392.43 298704.4,-390.74 298705.64,-397.64"/>
</g>
<!-- layer_10_agg_ep_0 -->
<g id="node1122" class="node">
<title>layer_10_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="315505.07,-269 315054.77,-269 314938.93,-165 315389.23,-165 315505.07,-269"/>
<text text-anchor="middle" x="315222" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="315222" y="-220" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="315222" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="315222" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2037" class="edge">
<title>layer_10_expert_0_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M313142.37,-316.09C313178.1,-308.94 313215.63,-302.4 313251,-298 313581.43,-256.9 314547.09,-232.08 314992.31,-222.52"/>
<polygon fill="black" stroke="black" points="314992.48,-226.02 315002.4,-222.31 314992.33,-219.02 314992.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2038" class="edge">
<title>layer_10_expert_1_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M313705.8,-316.46C313741.41,-309.31 313778.79,-302.67 313814,-298 314225.77,-243.39 314710.14,-226.03 314990.05,-220.53"/>
<polygon fill="black" stroke="black" points="314990.4,-224.02 315000.33,-220.33 314990.26,-217.02 314990.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2039" class="edge">
<title>layer_10_expert_2_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M314269.7,-317.34C314305.07,-310.17 314342.13,-303.29 314377,-298 314588.23,-265.93 314831.24,-244.53 315002.27,-231.99"/>
<polygon fill="black" stroke="black" points="315002.69,-235.47 315012.41,-231.25 315002.18,-228.49 315002.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2040" class="edge">
<title>layer_10_expert_3_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M314829.83,-314.82C314895.06,-298.72 314969.72,-280.29 315036.27,-263.86"/>
<polygon fill="black" stroke="black" points="315037.15,-267.24 315046.02,-261.45 315035.48,-260.45 315037.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2041" class="edge">
<title>layer_10_expert_4_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M315222,-305.64C315222,-297.08 315222,-288.12 315222,-279.34"/>
<polygon fill="black" stroke="black" points="315225.5,-279.15 315222,-269.15 315218.5,-279.15 315225.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2042" class="edge">
<title>layer_10_expert_5_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M315578.16,-305.93C315532.62,-294.69 315484.27,-282.75 315438.37,-271.42"/>
<polygon fill="black" stroke="black" points="315439.16,-268.01 315428.61,-269.01 315437.48,-274.81 315439.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2043" class="edge">
<title>layer_10_expert_6_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M316114.92,-305.97C316098.74,-303.07 316082.65,-300.38 316067,-298 315869.52,-268.02 315644.26,-247.36 315476.01,-234.55"/>
<polygon fill="black" stroke="black" points="315476.26,-231.06 315466.02,-233.8 315475.73,-238.04 315476.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_0&#45;&gt;layer_10_agg_ep_0 -->
<g id="edge2044" class="edge">
<title>layer_10_expert_7_ep_0&#45;&gt;layer_10_agg_ep_0</title>
<path fill="none" stroke="black" d="M316681.84,-305.94C316664.35,-302.94 316646.92,-300.24 316630,-298 316221.97,-243.88 315742.66,-226.34 315461.64,-220.68"/>
<polygon fill="black" stroke="black" points="315461.38,-217.17 315451.32,-220.47 315461.24,-224.17 315461.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_1 -->
<g id="node1123" class="node">
<title>layer_10_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="306497.07,-269 306046.77,-269 305930.93,-165 306381.23,-165 306497.07,-269"/>
<text text-anchor="middle" x="306214" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="306214" y="-220" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="306214" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="306214" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2046" class="edge">
<title>layer_10_expert_0_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M304134.37,-316.09C304170.1,-308.94 304207.63,-302.4 304243,-298 304573.43,-256.9 305539.09,-232.08 305984.31,-222.52"/>
<polygon fill="black" stroke="black" points="305984.48,-226.02 305994.4,-222.31 305984.33,-219.02 305984.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2047" class="edge">
<title>layer_10_expert_1_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M304697.8,-316.46C304733.41,-309.31 304770.79,-302.67 304806,-298 305217.77,-243.39 305702.14,-226.03 305982.05,-220.53"/>
<polygon fill="black" stroke="black" points="305982.4,-224.02 305992.33,-220.33 305982.26,-217.02 305982.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2048" class="edge">
<title>layer_10_expert_2_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M305261.7,-317.34C305297.07,-310.17 305334.13,-303.29 305369,-298 305580.23,-265.93 305823.24,-244.53 305994.27,-231.99"/>
<polygon fill="black" stroke="black" points="305994.69,-235.47 306004.41,-231.25 305994.18,-228.49 305994.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2049" class="edge">
<title>layer_10_expert_3_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M305821.83,-314.82C305887.06,-298.72 305961.72,-280.29 306028.27,-263.86"/>
<polygon fill="black" stroke="black" points="306029.15,-267.24 306038.02,-261.45 306027.48,-260.45 306029.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2050" class="edge">
<title>layer_10_expert_4_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M306214,-305.64C306214,-297.08 306214,-288.12 306214,-279.34"/>
<polygon fill="black" stroke="black" points="306217.5,-279.15 306214,-269.15 306210.5,-279.15 306217.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2051" class="edge">
<title>layer_10_expert_5_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M306570.16,-305.93C306524.62,-294.69 306476.27,-282.75 306430.37,-271.42"/>
<polygon fill="black" stroke="black" points="306431.16,-268.01 306420.61,-269.01 306429.48,-274.81 306431.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2052" class="edge">
<title>layer_10_expert_6_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M307106.92,-305.97C307090.74,-303.07 307074.65,-300.38 307059,-298 306861.52,-268.02 306636.26,-247.36 306468.01,-234.55"/>
<polygon fill="black" stroke="black" points="306468.26,-231.06 306458.02,-233.8 306467.73,-238.04 306468.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_1&#45;&gt;layer_10_agg_ep_1 -->
<g id="edge2053" class="edge">
<title>layer_10_expert_7_ep_1&#45;&gt;layer_10_agg_ep_1</title>
<path fill="none" stroke="black" d="M307673.84,-305.94C307656.35,-302.94 307638.92,-300.24 307622,-298 307213.97,-243.88 306734.66,-226.34 306453.64,-220.68"/>
<polygon fill="black" stroke="black" points="306453.38,-217.17 306443.32,-220.47 306453.24,-224.17 306453.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_2 -->
<g id="node1124" class="node">
<title>layer_10_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="324513.07,-269 324062.77,-269 323946.93,-165 324397.23,-165 324513.07,-269"/>
<text text-anchor="middle" x="324230" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="324230" y="-220" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="324230" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="324230" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2055" class="edge">
<title>layer_10_expert_0_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M322150.37,-316.09C322186.1,-308.94 322223.63,-302.4 322259,-298 322589.43,-256.9 323555.09,-232.08 324000.31,-222.52"/>
<polygon fill="black" stroke="black" points="324000.48,-226.02 324010.4,-222.31 324000.33,-219.02 324000.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2056" class="edge">
<title>layer_10_expert_1_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M322713.8,-316.46C322749.41,-309.31 322786.79,-302.67 322822,-298 323233.77,-243.39 323718.14,-226.03 323998.05,-220.53"/>
<polygon fill="black" stroke="black" points="323998.4,-224.02 324008.33,-220.33 323998.26,-217.02 323998.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2057" class="edge">
<title>layer_10_expert_2_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M323277.7,-317.34C323313.07,-310.17 323350.13,-303.29 323385,-298 323596.23,-265.93 323839.24,-244.53 324010.27,-231.99"/>
<polygon fill="black" stroke="black" points="324010.69,-235.47 324020.41,-231.25 324010.18,-228.49 324010.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2058" class="edge">
<title>layer_10_expert_3_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M323837.83,-314.82C323903.06,-298.72 323977.72,-280.29 324044.27,-263.86"/>
<polygon fill="black" stroke="black" points="324045.15,-267.24 324054.02,-261.45 324043.48,-260.45 324045.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2059" class="edge">
<title>layer_10_expert_4_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M324230,-305.64C324230,-297.08 324230,-288.12 324230,-279.34"/>
<polygon fill="black" stroke="black" points="324233.5,-279.15 324230,-269.15 324226.5,-279.15 324233.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2060" class="edge">
<title>layer_10_expert_5_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M324586.16,-305.93C324540.62,-294.69 324492.27,-282.75 324446.37,-271.42"/>
<polygon fill="black" stroke="black" points="324447.16,-268.01 324436.61,-269.01 324445.48,-274.81 324447.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2061" class="edge">
<title>layer_10_expert_6_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M325122.92,-305.97C325106.74,-303.07 325090.65,-300.38 325075,-298 324877.52,-268.02 324652.26,-247.36 324484.01,-234.55"/>
<polygon fill="black" stroke="black" points="324484.26,-231.06 324474.02,-233.8 324483.73,-238.04 324484.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_2&#45;&gt;layer_10_agg_ep_2 -->
<g id="edge2062" class="edge">
<title>layer_10_expert_7_ep_2&#45;&gt;layer_10_agg_ep_2</title>
<path fill="none" stroke="black" d="M325689.84,-305.94C325672.35,-302.94 325654.92,-300.24 325638,-298 325229.97,-243.88 324750.66,-226.34 324469.64,-220.68"/>
<polygon fill="black" stroke="black" points="324469.38,-217.17 324459.32,-220.47 324469.24,-224.17 324469.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_3 -->
<g id="node1125" class="node">
<title>layer_10_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="292985.07,-269 292534.77,-269 292418.93,-165 292869.23,-165 292985.07,-269"/>
<text text-anchor="middle" x="292702" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="292702" y="-220" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="292702" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="292702" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2064" class="edge">
<title>layer_10_expert_0_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M290622.37,-316.09C290658.1,-308.94 290695.63,-302.4 290731,-298 291061.43,-256.9 292027.09,-232.08 292472.31,-222.52"/>
<polygon fill="black" stroke="black" points="292472.48,-226.02 292482.4,-222.31 292472.33,-219.02 292472.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2065" class="edge">
<title>layer_10_expert_1_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M291185.8,-316.46C291221.41,-309.31 291258.79,-302.67 291294,-298 291705.77,-243.39 292190.14,-226.03 292470.05,-220.53"/>
<polygon fill="black" stroke="black" points="292470.4,-224.02 292480.33,-220.33 292470.26,-217.02 292470.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2066" class="edge">
<title>layer_10_expert_2_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M291749.7,-317.34C291785.07,-310.17 291822.13,-303.29 291857,-298 292068.23,-265.93 292311.24,-244.53 292482.27,-231.99"/>
<polygon fill="black" stroke="black" points="292482.69,-235.47 292492.41,-231.25 292482.18,-228.49 292482.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2067" class="edge">
<title>layer_10_expert_3_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M292309.83,-314.82C292375.06,-298.72 292449.72,-280.29 292516.27,-263.86"/>
<polygon fill="black" stroke="black" points="292517.15,-267.24 292526.02,-261.45 292515.48,-260.45 292517.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2068" class="edge">
<title>layer_10_expert_4_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M292702,-305.64C292702,-297.08 292702,-288.12 292702,-279.34"/>
<polygon fill="black" stroke="black" points="292705.5,-279.15 292702,-269.15 292698.5,-279.15 292705.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2069" class="edge">
<title>layer_10_expert_5_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M293058.16,-305.93C293012.62,-294.69 292964.27,-282.75 292918.37,-271.42"/>
<polygon fill="black" stroke="black" points="292919.16,-268.01 292908.61,-269.01 292917.48,-274.81 292919.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2070" class="edge">
<title>layer_10_expert_6_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M293594.92,-305.97C293578.74,-303.07 293562.65,-300.38 293547,-298 293349.52,-268.02 293124.26,-247.36 292956.01,-234.55"/>
<polygon fill="black" stroke="black" points="292956.26,-231.06 292946.02,-233.8 292955.73,-238.04 292956.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_3&#45;&gt;layer_10_agg_ep_3 -->
<g id="edge2071" class="edge">
<title>layer_10_expert_7_ep_3&#45;&gt;layer_10_agg_ep_3</title>
<path fill="none" stroke="black" d="M294161.84,-305.94C294144.35,-302.94 294126.92,-300.24 294110,-298 293701.97,-243.88 293222.66,-226.34 292941.64,-220.68"/>
<polygon fill="black" stroke="black" points="292941.38,-217.17 292931.32,-220.47 292941.24,-224.17 292941.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_4 -->
<g id="node1126" class="node">
<title>layer_10_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="301993.07,-269 301542.77,-269 301426.93,-165 301877.23,-165 301993.07,-269"/>
<text text-anchor="middle" x="301710" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="301710" y="-220" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="301710" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="301710" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2073" class="edge">
<title>layer_10_expert_0_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M299630.37,-316.09C299666.1,-308.94 299703.63,-302.4 299739,-298 300069.43,-256.9 301035.09,-232.08 301480.31,-222.52"/>
<polygon fill="black" stroke="black" points="301480.48,-226.02 301490.4,-222.31 301480.33,-219.02 301480.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2074" class="edge">
<title>layer_10_expert_1_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M300193.8,-316.46C300229.41,-309.31 300266.79,-302.67 300302,-298 300713.77,-243.39 301198.14,-226.03 301478.05,-220.53"/>
<polygon fill="black" stroke="black" points="301478.4,-224.02 301488.33,-220.33 301478.26,-217.02 301478.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2075" class="edge">
<title>layer_10_expert_2_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M300757.7,-317.34C300793.07,-310.17 300830.13,-303.29 300865,-298 301076.23,-265.93 301319.24,-244.53 301490.27,-231.99"/>
<polygon fill="black" stroke="black" points="301490.69,-235.47 301500.41,-231.25 301490.18,-228.49 301490.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2076" class="edge">
<title>layer_10_expert_3_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M301317.83,-314.82C301383.06,-298.72 301457.72,-280.29 301524.27,-263.86"/>
<polygon fill="black" stroke="black" points="301525.15,-267.24 301534.02,-261.45 301523.48,-260.45 301525.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2077" class="edge">
<title>layer_10_expert_4_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M301710,-305.64C301710,-297.08 301710,-288.12 301710,-279.34"/>
<polygon fill="black" stroke="black" points="301713.5,-279.15 301710,-269.15 301706.5,-279.15 301713.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2078" class="edge">
<title>layer_10_expert_5_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M302066.16,-305.93C302020.62,-294.69 301972.27,-282.75 301926.37,-271.42"/>
<polygon fill="black" stroke="black" points="301927.16,-268.01 301916.61,-269.01 301925.48,-274.81 301927.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2079" class="edge">
<title>layer_10_expert_6_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M302602.92,-305.97C302586.74,-303.07 302570.65,-300.38 302555,-298 302357.52,-268.02 302132.26,-247.36 301964.01,-234.55"/>
<polygon fill="black" stroke="black" points="301964.26,-231.06 301954.02,-233.8 301963.73,-238.04 301964.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_4&#45;&gt;layer_10_agg_ep_4 -->
<g id="edge2080" class="edge">
<title>layer_10_expert_7_ep_4&#45;&gt;layer_10_agg_ep_4</title>
<path fill="none" stroke="black" d="M303169.84,-305.94C303152.35,-302.94 303134.92,-300.24 303118,-298 302709.97,-243.88 302230.66,-226.34 301949.64,-220.68"/>
<polygon fill="black" stroke="black" points="301949.38,-217.17 301939.32,-220.47 301949.24,-224.17 301949.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_5 -->
<g id="node1127" class="node">
<title>layer_10_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="320009.07,-269 319558.77,-269 319442.93,-165 319893.23,-165 320009.07,-269"/>
<text text-anchor="middle" x="319726" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="319726" y="-220" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="319726" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="319726" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2082" class="edge">
<title>layer_10_expert_0_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M317646.37,-316.09C317682.1,-308.94 317719.63,-302.4 317755,-298 318085.43,-256.9 319051.09,-232.08 319496.31,-222.52"/>
<polygon fill="black" stroke="black" points="319496.48,-226.02 319506.4,-222.31 319496.33,-219.02 319496.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2083" class="edge">
<title>layer_10_expert_1_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M318209.8,-316.46C318245.41,-309.31 318282.79,-302.67 318318,-298 318729.77,-243.39 319214.14,-226.03 319494.05,-220.53"/>
<polygon fill="black" stroke="black" points="319494.4,-224.02 319504.33,-220.33 319494.26,-217.02 319494.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2084" class="edge">
<title>layer_10_expert_2_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M318773.7,-317.34C318809.07,-310.17 318846.13,-303.29 318881,-298 319092.23,-265.93 319335.24,-244.53 319506.27,-231.99"/>
<polygon fill="black" stroke="black" points="319506.69,-235.47 319516.41,-231.25 319506.18,-228.49 319506.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2085" class="edge">
<title>layer_10_expert_3_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M319333.83,-314.82C319399.06,-298.72 319473.72,-280.29 319540.27,-263.86"/>
<polygon fill="black" stroke="black" points="319541.15,-267.24 319550.02,-261.45 319539.48,-260.45 319541.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2086" class="edge">
<title>layer_10_expert_4_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M319726,-305.64C319726,-297.08 319726,-288.12 319726,-279.34"/>
<polygon fill="black" stroke="black" points="319729.5,-279.15 319726,-269.15 319722.5,-279.15 319729.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2087" class="edge">
<title>layer_10_expert_5_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M320082.16,-305.93C320036.62,-294.69 319988.27,-282.75 319942.37,-271.42"/>
<polygon fill="black" stroke="black" points="319943.16,-268.01 319932.61,-269.01 319941.48,-274.81 319943.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2088" class="edge">
<title>layer_10_expert_6_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M320618.92,-305.97C320602.74,-303.07 320586.65,-300.38 320571,-298 320373.52,-268.02 320148.26,-247.36 319980.01,-234.55"/>
<polygon fill="black" stroke="black" points="319980.26,-231.06 319970.02,-233.8 319979.73,-238.04 319980.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_5&#45;&gt;layer_10_agg_ep_5 -->
<g id="edge2089" class="edge">
<title>layer_10_expert_7_ep_5&#45;&gt;layer_10_agg_ep_5</title>
<path fill="none" stroke="black" d="M321185.84,-305.94C321168.35,-302.94 321150.92,-300.24 321134,-298 320725.97,-243.88 320246.66,-226.34 319965.64,-220.68"/>
<polygon fill="black" stroke="black" points="319965.38,-217.17 319955.32,-220.47 319965.24,-224.17 319965.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_6 -->
<g id="node1128" class="node">
<title>layer_10_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="311001.07,-269 310550.77,-269 310434.93,-165 310885.23,-165 311001.07,-269"/>
<text text-anchor="middle" x="310718" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="310718" y="-220" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="310718" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="310718" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2091" class="edge">
<title>layer_10_expert_0_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M308638.37,-316.09C308674.1,-308.94 308711.63,-302.4 308747,-298 309077.43,-256.9 310043.09,-232.08 310488.31,-222.52"/>
<polygon fill="black" stroke="black" points="310488.48,-226.02 310498.4,-222.31 310488.33,-219.02 310488.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2092" class="edge">
<title>layer_10_expert_1_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M309201.8,-316.46C309237.41,-309.31 309274.79,-302.67 309310,-298 309721.77,-243.39 310206.14,-226.03 310486.05,-220.53"/>
<polygon fill="black" stroke="black" points="310486.4,-224.02 310496.33,-220.33 310486.26,-217.02 310486.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2093" class="edge">
<title>layer_10_expert_2_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M309765.7,-317.34C309801.07,-310.17 309838.13,-303.29 309873,-298 310084.23,-265.93 310327.24,-244.53 310498.27,-231.99"/>
<polygon fill="black" stroke="black" points="310498.69,-235.47 310508.41,-231.25 310498.18,-228.49 310498.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2094" class="edge">
<title>layer_10_expert_3_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M310325.83,-314.82C310391.06,-298.72 310465.72,-280.29 310532.27,-263.86"/>
<polygon fill="black" stroke="black" points="310533.15,-267.24 310542.02,-261.45 310531.48,-260.45 310533.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2095" class="edge">
<title>layer_10_expert_4_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M310718,-305.64C310718,-297.08 310718,-288.12 310718,-279.34"/>
<polygon fill="black" stroke="black" points="310721.5,-279.15 310718,-269.15 310714.5,-279.15 310721.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2096" class="edge">
<title>layer_10_expert_5_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M311074.16,-305.93C311028.62,-294.69 310980.27,-282.75 310934.37,-271.42"/>
<polygon fill="black" stroke="black" points="310935.16,-268.01 310924.61,-269.01 310933.48,-274.81 310935.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2097" class="edge">
<title>layer_10_expert_6_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M311610.92,-305.97C311594.74,-303.07 311578.65,-300.38 311563,-298 311365.52,-268.02 311140.26,-247.36 310972.01,-234.55"/>
<polygon fill="black" stroke="black" points="310972.26,-231.06 310962.02,-233.8 310971.73,-238.04 310972.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_6&#45;&gt;layer_10_agg_ep_6 -->
<g id="edge2098" class="edge">
<title>layer_10_expert_7_ep_6&#45;&gt;layer_10_agg_ep_6</title>
<path fill="none" stroke="black" d="M312177.84,-305.94C312160.35,-302.94 312142.92,-300.24 312126,-298 311717.97,-243.88 311238.66,-226.34 310957.64,-220.68"/>
<polygon fill="black" stroke="black" points="310957.38,-217.17 310947.32,-220.47 310957.24,-224.17 310957.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_7 -->
<g id="node1129" class="node">
<title>layer_10_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="297489.07,-269 297038.77,-269 296922.93,-165 297373.23,-165 297489.07,-269"/>
<text text-anchor="middle" x="297206" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="297206" y="-220" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="297206" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="297206" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_expert_0_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2100" class="edge">
<title>layer_10_expert_0_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M295126.37,-316.09C295162.1,-308.94 295199.63,-302.4 295235,-298 295565.43,-256.9 296531.09,-232.08 296976.31,-222.52"/>
<polygon fill="black" stroke="black" points="296976.48,-226.02 296986.4,-222.31 296976.33,-219.02 296976.48,-226.02"/>
</g>
<!-- layer_10_expert_1_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2101" class="edge">
<title>layer_10_expert_1_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M295689.8,-316.46C295725.41,-309.31 295762.79,-302.67 295798,-298 296209.77,-243.39 296694.14,-226.03 296974.05,-220.53"/>
<polygon fill="black" stroke="black" points="296974.4,-224.02 296984.33,-220.33 296974.26,-217.02 296974.4,-224.02"/>
</g>
<!-- layer_10_expert_2_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2102" class="edge">
<title>layer_10_expert_2_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M296253.7,-317.34C296289.07,-310.17 296326.13,-303.29 296361,-298 296572.23,-265.93 296815.24,-244.53 296986.27,-231.99"/>
<polygon fill="black" stroke="black" points="296986.69,-235.47 296996.41,-231.25 296986.18,-228.49 296986.69,-235.47"/>
</g>
<!-- layer_10_expert_3_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2103" class="edge">
<title>layer_10_expert_3_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M296813.83,-314.82C296879.06,-298.72 296953.72,-280.29 297020.27,-263.86"/>
<polygon fill="black" stroke="black" points="297021.15,-267.24 297030.02,-261.45 297019.48,-260.45 297021.15,-267.24"/>
</g>
<!-- layer_10_expert_4_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2104" class="edge">
<title>layer_10_expert_4_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M297206,-305.64C297206,-297.08 297206,-288.12 297206,-279.34"/>
<polygon fill="black" stroke="black" points="297209.5,-279.15 297206,-269.15 297202.5,-279.15 297209.5,-279.15"/>
</g>
<!-- layer_10_expert_5_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2105" class="edge">
<title>layer_10_expert_5_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M297562.16,-305.93C297516.62,-294.69 297468.27,-282.75 297422.37,-271.42"/>
<polygon fill="black" stroke="black" points="297423.16,-268.01 297412.61,-269.01 297421.48,-274.81 297423.16,-268.01"/>
</g>
<!-- layer_10_expert_6_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2106" class="edge">
<title>layer_10_expert_6_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M298098.92,-305.97C298082.74,-303.07 298066.65,-300.38 298051,-298 297853.52,-268.02 297628.26,-247.36 297460.01,-234.55"/>
<polygon fill="black" stroke="black" points="297460.26,-231.06 297450.02,-233.8 297459.73,-238.04 297460.26,-231.06"/>
</g>
<!-- layer_10_expert_7_ep_7&#45;&gt;layer_10_agg_ep_7 -->
<g id="edge2107" class="edge">
<title>layer_10_expert_7_ep_7&#45;&gt;layer_10_agg_ep_7</title>
<path fill="none" stroke="black" d="M298665.84,-305.94C298648.35,-302.94 298630.92,-300.24 298614,-298 298205.97,-243.88 297726.66,-226.34 297445.64,-220.68"/>
<polygon fill="black" stroke="black" points="297445.38,-217.17 297435.32,-220.47 297445.24,-224.17 297445.38,-217.17"/>
</g>
<!-- layer_10_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2045" class="edge">
<title>layer_10_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M315452.76,-221.91C316088.69,-235.17 317920.21,-271.51 319443,-283.5 322045.22,-304 504206.69,-284.7 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2054" class="edge">
<title>layer_10_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M306444.76,-221.91C307080.69,-235.17 308912.21,-271.51 310435,-283.5 313162.33,-304.98 504081.58,-284.76 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2063" class="edge">
<title>layer_10_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M324466.88,-227.51C324838.7,-243.43 325582.07,-272.92 326213,-283.5 327466.96,-304.52 505554.86,-284.08 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2072" class="edge">
<title>layer_10_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M292932.76,-221.91C293568.69,-235.17 295400.21,-271.51 296923,-283.5 299837.99,-306.46 503893.92,-284.84 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2081" class="edge">
<title>layer_10_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M301940.76,-221.91C302576.69,-235.17 304408.21,-271.51 305931,-283.5 308720.89,-305.48 504019.03,-284.78 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2090" class="edge">
<title>layer_10_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M319956.76,-221.91C320592.69,-235.17 322424.21,-271.51 323947,-283.5 326486.67,-303.5 504269.25,-284.67 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2099" class="edge">
<title>layer_10_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M310948.76,-221.91C311584.69,-235.17 313416.21,-271.51 314939,-283.5 317603.78,-304.49 504144.14,-284.73 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2108" class="edge">
<title>layer_10_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M297436.76,-221.91C298072.69,-235.17 299904.21,-271.51 301427,-283.5 304279.44,-305.97 503956.47,-284.81 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_10_moe_alltoall -->
<g id="node1130" class="node">
<title>layer_10_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="298772" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="298772" y="-691" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="298772" y="-680" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="298772" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="298772" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_10_ln_tp_0 -->
<g id="node1131" class="node">
<title>layer_10_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="321740.07,-729 321289.77,-729 321173.93,-625 321624.23,-625 321740.07,-729"/>
<text text-anchor="middle" x="321457" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="321457" y="-680" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="321457" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="321457" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_qkv_tp_0 -->
<g id="node1135" class="node">
<title>layer_11_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="357768.7,-559 357326.94,-559 357213.3,-455 357655.06,-455 357768.7,-559"/>
<text text-anchor="middle" x="357491" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="357491" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="357491" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="357491" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_10_ln_tp_0&#45;&gt;layer_11_qkv_tp_0 -->
<g id="edge3117" class="edge">
<title>layer_10_ln_tp_0&#45;&gt;layer_11_qkv_tp_0</title>
<path fill="none" stroke="black" d="M321640.17,-639.06C321676.11,-633.22 321713.63,-628.09 321749,-625 322343.16,-573.13 342623.58,-598.55 343220,-598 343268.56,-597.96 357156.92,-596.77 357205,-590 357247.03,-584.08 357291.54,-573.52 357332.61,-561.9"/>
<polygon fill="black" stroke="black" points="357333.77,-565.2 357342.41,-559.08 357331.84,-558.47 357333.77,-565.2"/>
</g>
<!-- layer_10_ln_tp_1 -->
<g id="node1132" class="node">
<title>layer_10_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="323492.07,-729 323041.77,-729 322925.93,-625 323376.23,-625 323492.07,-729"/>
<text text-anchor="middle" x="323209" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="323209" y="-680" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="323209" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="323209" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_qkv_tp_1 -->
<g id="node1136" class="node">
<title>layer_11_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="359490.7,-559 359048.94,-559 358935.3,-455 359377.06,-455 359490.7,-559"/>
<text text-anchor="middle" x="359213" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="359213" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="359213" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="359213" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_10_ln_tp_1&#45;&gt;layer_11_qkv_tp_1 -->
<g id="edge3118" class="edge">
<title>layer_10_ln_tp_1&#45;&gt;layer_11_qkv_tp_1</title>
<path fill="none" stroke="black" d="M323392.17,-639.05C323428.11,-633.21 323465.63,-628.08 323501,-625 323991.16,-582.27 358438.78,-658.48 358926,-590 358968.16,-584.07 359012.82,-573.5 359054.04,-561.88"/>
<polygon fill="black" stroke="black" points="359055.23,-565.18 359063.88,-559.07 359053.3,-558.45 359055.23,-565.18"/>
</g>
<!-- layer_10_ln_tp_2 -->
<g id="node1133" class="node">
<title>layer_10_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="322324.07,-729 321873.77,-729 321757.93,-625 322208.23,-625 322324.07,-729"/>
<text text-anchor="middle" x="322041" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="322041" y="-680" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="322041" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="322041" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_qkv_tp_2 -->
<g id="node1137" class="node">
<title>layer_11_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="358342.7,-559 357900.94,-559 357787.3,-455 358229.06,-455 358342.7,-559"/>
<text text-anchor="middle" x="358065" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="358065" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="358065" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="358065" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_10_ln_tp_2&#45;&gt;layer_11_qkv_tp_2 -->
<g id="edge3119" class="edge">
<title>layer_10_ln_tp_2&#45;&gt;layer_11_qkv_tp_2</title>
<path fill="none" stroke="black" d="M322224.17,-639.05C322260.11,-633.21 322297.63,-628.08 322333,-625 322394.3,-619.66 357717.06,-598.57 357778,-590 357820.16,-584.07 357864.82,-573.5 357906.04,-561.88"/>
<polygon fill="black" stroke="black" points="357907.23,-565.18 357915.88,-559.07 357905.3,-558.45 357907.23,-565.18"/>
</g>
<!-- layer_10_ln_tp_3 -->
<g id="node1134" class="node">
<title>layer_10_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="322908.07,-729 322457.77,-729 322341.93,-625 322792.23,-625 322908.07,-729"/>
<text text-anchor="middle" x="322625" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="322625" y="-680" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="322625" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="322625" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_qkv_tp_3 -->
<g id="node1138" class="node">
<title>layer_11_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="358916.7,-559 358474.94,-559 358361.3,-455 358803.06,-455 358916.7,-559"/>
<text text-anchor="middle" x="358639" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="358639" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="358639" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="358639" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_10_ln_tp_3&#45;&gt;layer_11_qkv_tp_3 -->
<g id="edge3120" class="edge">
<title>layer_10_ln_tp_3&#45;&gt;layer_11_qkv_tp_3</title>
<path fill="none" stroke="black" d="M322808.17,-639.05C322844.11,-633.21 322881.63,-628.08 322917,-625 323162.15,-603.63 358108.32,-624.25 358352,-590 358394.16,-584.07 358438.82,-573.5 358480.04,-561.88"/>
<polygon fill="black" stroke="black" points="358481.23,-565.18 358489.88,-559.07 358479.3,-558.45 358481.23,-565.18"/>
</g>
<!-- layer_11_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2117" class="edge">
<title>layer_11_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M357665.43,-464.27C357702.38,-457.08 357741.31,-450.73 357778,-447 357778,-447 506818,-437 506818,-437 506820.83,-434.17 506820.83,-430.83 506818,-428 506818,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_11_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2118" class="edge">
<title>layer_11_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M359387.43,-464.27C359424.38,-457.08 359463.31,-450.73 359500,-447 359500,-447 506863,-437 506863,-437 506865.83,-434.17 506865.83,-430.83 506863,-428 506863,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_11_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2119" class="edge">
<title>layer_11_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M358239.43,-464.27C358276.38,-457.08 358315.31,-450.73 358352,-447 358352,-447 506833,-437 506833,-437 506835.83,-434.17 506835.83,-430.83 506833,-428 506833,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_11_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2120" class="edge">
<title>layer_11_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M358813.43,-464.27C358850.38,-457.08 358889.31,-450.73 358926,-447 358926,-447 506848,-437 506848,-437 506850.83,-434.17 506850.83,-430.83 506848,-428 506848,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_11_qkv_comm -->
<g id="node1139" class="node">
<title>layer_11_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="359702" cy="-507" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="359702" y="-521" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="359702" y="-510" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="359702" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="359702" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_11_attn_tp_0 -->
<g id="node1140" class="node">
<title>layer_11_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="355062.7,-559 354620.94,-559 354507.3,-455 354949.06,-455 355062.7,-559"/>
<text text-anchor="middle" x="354785" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="354785" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="354785" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="354785" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_out_tp_0 -->
<g id="node1144" class="node">
<title>layer_11_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="360008.7,-410 359566.94,-410 359453.3,-306 359895.06,-306 360008.7,-410"/>
<text text-anchor="middle" x="359731" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="359731" y="-361" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="359731" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="359731" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_tp_0&#45;&gt;layer_11_attn_out_tp_0 -->
<g id="edge2125" class="edge">
<title>layer_11_attn_tp_0&#45;&gt;layer_11_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M354960.3,-465.07C354997.02,-457.87 355035.63,-451.32 355072,-447 355321.5,-417.38 355385.79,-432.91 355637,-428 356365.09,-413.76 358186.19,-434.7 358914,-410 359119.38,-403.03 359353.4,-387.66 359518.19,-375.61"/>
<polygon fill="black" stroke="black" points="359518.73,-379.08 359528.44,-374.86 359518.22,-372.1 359518.73,-379.08"/>
</g>
<!-- layer_11_attn_tp_1 -->
<g id="node1141" class="node">
<title>layer_11_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="355636.7,-559 355194.94,-559 355081.3,-455 355523.06,-455 355636.7,-559"/>
<text text-anchor="middle" x="355359" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="355359" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="355359" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="355359" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_out_tp_1 -->
<g id="node1145" class="node">
<title>layer_11_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="360847.7,-410 360405.94,-410 360292.3,-306 360734.06,-306 360847.7,-410"/>
<text text-anchor="middle" x="360570" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="360570" y="-361" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="360570" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="360570" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_tp_1&#45;&gt;layer_11_attn_out_tp_1 -->
<g id="edge2127" class="edge">
<title>layer_11_attn_tp_1&#45;&gt;layer_11_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M355534.3,-465.07C355571.02,-457.87 355609.63,-451.32 355646,-447 355895.5,-417.38 355959.79,-432.82 356211,-428 356633.93,-419.89 359595.49,-430.48 360018,-410 360132.78,-404.44 360260.57,-392.97 360364.26,-382.31"/>
<polygon fill="black" stroke="black" points="360364.63,-385.8 360374.22,-381.29 360363.91,-378.83 360364.63,-385.8"/>
</g>
<!-- layer_11_attn_tp_2 -->
<g id="node1142" class="node">
<title>layer_11_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="356210.7,-559 355768.94,-559 355655.3,-455 356097.06,-455 356210.7,-559"/>
<text text-anchor="middle" x="355933" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="355933" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="355933" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="355933" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_out_tp_2 -->
<g id="node1146" class="node">
<title>layer_11_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="361553.7,-410 361111.94,-410 360998.3,-306 361440.06,-306 361553.7,-410"/>
<text text-anchor="middle" x="361276" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="361276" y="-361" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="361276" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="361276" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_tp_2&#45;&gt;layer_11_attn_out_tp_2 -->
<g id="edge2129" class="edge">
<title>layer_11_attn_tp_2&#45;&gt;layer_11_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M356107.45,-464.49C356144.4,-457.29 356183.32,-450.88 356220,-447 356732.38,-392.81 360342.83,-443.24 360857,-410 360928.7,-405.37 361006.95,-396.8 361076.2,-387.99"/>
<polygon fill="black" stroke="black" points="361076.88,-391.43 361086.35,-386.69 361075.99,-384.49 361076.88,-391.43"/>
</g>
<!-- layer_11_attn_tp_3 -->
<g id="node1143" class="node">
<title>layer_11_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="356784.7,-559 356342.94,-559 356229.3,-455 356671.06,-455 356784.7,-559"/>
<text text-anchor="middle" x="356507" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="356507" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="356507" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="356507" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_out_tp_3 -->
<g id="node1147" class="node">
<title>layer_11_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="362193.7,-410 361751.94,-410 361638.3,-306 362080.06,-306 362193.7,-410"/>
<text text-anchor="middle" x="361916" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="361916" y="-361" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="361916" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="361916" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_11_attn_tp_3&#45;&gt;layer_11_attn_out_tp_3 -->
<g id="edge2131" class="edge">
<title>layer_11_attn_tp_3&#45;&gt;layer_11_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M356681.6,-464.34C356718.2,-457.2 356756.7,-450.85 356793,-447 357320.06,-391.14 361034.5,-450.04 361563,-410 361614.23,-406.12 361669.33,-399.4 361720.41,-392.08"/>
<polygon fill="black" stroke="black" points="361721.18,-395.51 361730.57,-390.61 361720.17,-388.58 361721.18,-395.51"/>
</g>
<!-- layer_11_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2126" class="edge">
<title>layer_11_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M359984.17,-387.32C360077.92,-396.5 360185.18,-405.48 360283,-410 360283,-410 506878,-428 506878,-428 506880.83,-430.83 506880.83,-434.17 506878,-437 506878,-437 434560,-447 434560,-447 434440.69,-479.98 434440.31,-557.03 434321,-590 434321,-590 145276,-598 145276,-598 145250.92,-603.6 145191.46,-633.15 145150.96,-654.22"/>
<polygon fill="black" stroke="black" points="145149.1,-651.24 145141.86,-658.98 145152.35,-657.45 145149.1,-651.24"/>
</g>
<!-- layer_11_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2128" class="edge">
<title>layer_11_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M360832.46,-395.88C360884.24,-401.76 360938.26,-406.92 360989,-410 360989,-410 506893,-428 506893,-428 506895.83,-430.83 506895.83,-434.17 506893,-437 506893,-437 434632,-447 434632,-447 434536.28,-480.69 434549.72,-556.31 434454,-590 434454,-590 145301,-598 145301,-598 145286.4,-600.87 145210.29,-632.87 145158.67,-654.98"/>
<polygon fill="black" stroke="black" points="145157.14,-651.83 145149.33,-658.99 145159.9,-658.26 145157.14,-651.83"/>
</g>
<!-- layer_11_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2130" class="edge">
<title>layer_11_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M361544.91,-401.92C361573.24,-405.22 361601.67,-408.03 361629,-410 361629,-410 506908,-428 506908,-428 506910.83,-430.83 506910.83,-434.17 506908,-437 506908,-437 434687,-447 434687,-447 434608.45,-481.75 434635.55,-555.25 434557,-590 434557,-590 145326,-598 145326,-598 145317.73,-599.45 145226.78,-632.78 145165.57,-655.39"/>
<polygon fill="black" stroke="black" points="145164.18,-652.17 145156.02,-658.93 145166.61,-658.74 145164.18,-652.17"/>
</g>
<!-- layer_11_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2132" class="edge">
<title>layer_11_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M362188.18,-404.69C362206.69,-406.8 362225.1,-408.61 362243,-410 362243,-410 506923,-428 506923,-428 506925.83,-430.83 506925.83,-434.17 506923,-437 506923,-437 434740,-447 434740,-447 434669.97,-482.67 434706.03,-554.34 434636,-590 434636,-590 145351,-598 145351,-598 145338.09,-600.02 145335.56,-603.37 145323,-607 145292.14,-615.92 145283.72,-615.59 145253,-625 145223.26,-634.11 145190.55,-645.65 145163.93,-655.46"/>
<polygon fill="black" stroke="black" points="145162.58,-652.23 145154.42,-658.98 145165.01,-658.79 145162.58,-652.23"/>
</g>
<!-- layer_11_attn_allreduce -->
<g id="node1148" class="node">
<title>layer_11_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="356999" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="356999" y="-521" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="356999" y="-510" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="356999" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="356999" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_gate_tp_0 -->
<g id="node1149" class="node">
<title>layer_11_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="340992.99,-559 340544.4,-559 340429.01,-455 340877.6,-455 340992.99,-559"/>
<text text-anchor="middle" x="340711" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="340711" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="340711" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="340711" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_11_route_ep_0 -->
<g id="node1153" class="node">
<title>layer_11_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="345638.43,-410 345179.6,-410 345061.57,-306 345520.4,-306 345638.43,-410"/>
<text text-anchor="middle" x="345350" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="345350" y="-361" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="345350" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="345350" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_0 -->
<g id="edge2133" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340888.71,-464.64C340925.95,-457.48 340965.11,-451.04 341002,-447 341062.76,-440.34 341492.36,-450.37 341552,-437 341561.51,-434.87 341562.49,-430.13 341572,-428 341658.64,-408.57 344302.42,-372.64 345114.85,-362.02"/>
<polygon fill="black" stroke="black" points="345114.96,-365.52 345124.92,-361.89 345114.87,-358.52 345114.96,-365.52"/>
<text text-anchor="middle" x="341598" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_1 -->
<g id="node1154" class="node">
<title>layer_11_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="342002.43,-410 341543.6,-410 341425.57,-306 341884.4,-306 342002.43,-410"/>
<text text-anchor="middle" x="341714" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="341714" y="-361" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="341714" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="341714" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_1 -->
<g id="edge2134" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340830.28,-454.95C340858.89,-444.48 340889.66,-434.64 340919,-428 341104.27,-386.05 341319.14,-369.24 341478.75,-362.68"/>
<polygon fill="black" stroke="black" points="341479.33,-366.16 341489.19,-362.26 341479.05,-359.17 341479.33,-366.16"/>
<text text-anchor="middle" x="340945" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_2 -->
<g id="node1155" class="node">
<title>layer_11_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="334308.43,-410 333849.6,-410 333731.57,-306 334190.4,-306 334308.43,-410"/>
<text text-anchor="middle" x="334020" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="334020" y="-361" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="334020" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="334020" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_2 -->
<g id="edge2135" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340479.71,-500.92C339454.38,-478.39 335323.33,-387.63 334266.97,-364.43"/>
<polygon fill="black" stroke="black" points="334266.66,-360.92 334256.59,-364.2 334266.51,-367.92 334266.66,-360.92"/>
<text text-anchor="middle" x="337592" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_3 -->
<g id="node1156" class="node">
<title>layer_11_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="350090.43,-410 349631.6,-410 349513.57,-306 349972.4,-306 350090.43,-410"/>
<text text-anchor="middle" x="349802" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="349802" y="-361" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="349802" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="349802" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_3 -->
<g id="edge2136" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340888.31,-464.53C340925.66,-457.35 340964.96,-450.94 341002,-447 341096.03,-437.01 341759.59,-451.72 341853,-437 341866.33,-434.9 341868.66,-430.05 341882,-428 341985.37,-412.08 345542.42,-410.89 345647,-410 347139.86,-397.27 348934.32,-371.79 349567.22,-362.5"/>
<polygon fill="black" stroke="black" points="349567.42,-366 349577.37,-362.35 349567.32,-359 349567.42,-366"/>
<text text-anchor="middle" x="341908" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_4 -->
<g id="node1157" class="node">
<title>layer_11_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="354734.43,-410 354275.6,-410 354157.57,-306 354616.4,-306 354734.43,-410"/>
<text text-anchor="middle" x="354446" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="354446" y="-361" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="354446" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="354446" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_4 -->
<g id="edge2137" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340888.28,-464.29C340925.63,-457.13 340964.95,-450.78 341002,-447 341086.12,-438.42 343961.44,-437.33 344046,-437 344130.07,-436.67 350014.93,-410.68 350099,-410 351669.05,-397.29 353557.97,-371.56 354210.71,-362.36"/>
<polygon fill="black" stroke="black" points="354211.23,-365.85 354221.18,-362.21 354211.13,-358.86 354211.23,-365.85"/>
<text text-anchor="middle" x="346044" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_5 -->
<g id="node1158" class="node">
<title>layer_11_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="358905.43,-410 358446.6,-410 358328.57,-306 358787.4,-306 358905.43,-410"/>
<text text-anchor="middle" x="358617" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="358617" y="-361" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="358617" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="358617" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_5 -->
<g id="edge2138" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340888.27,-464.23C340925.63,-457.07 340964.94,-450.74 341002,-447 341112.95,-435.8 348919.49,-438.05 349031,-437 349258.14,-434.86 349314.87,-430.39 349542,-428 351853.44,-403.65 352431.51,-429.21 354743,-410 356122.88,-398.53 357779.07,-372.69 358382.54,-362.88"/>
<polygon fill="black" stroke="black" points="358382.72,-366.38 358392.66,-362.71 358382.6,-359.38 358382.72,-366.38"/>
<text text-anchor="middle" x="349568" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_6 -->
<g id="node1159" class="node">
<title>layer_11_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="329804.43,-410 329345.6,-410 329227.57,-306 329686.4,-306 329804.43,-410"/>
<text text-anchor="middle" x="329516" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="329516" y="-361" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="329516" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="329516" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_6 -->
<g id="edge2139" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340481.98,-502.99C339041.43,-484.08 331245.44,-381.71 329760.42,-362.21"/>
<polygon fill="black" stroke="black" points="329760.21,-358.71 329750.17,-362.07 329760.12,-365.71 329760.21,-358.71"/>
<text text-anchor="middle" x="335475" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_route_ep_7 -->
<g id="node1160" class="node">
<title>layer_11_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="338882.43,-410 338423.6,-410 338305.57,-306 338764.4,-306 338882.43,-410"/>
<text text-anchor="middle" x="338594" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="338594" y="-361" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="338594" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="338594" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_7 -->
<g id="edge2140" class="edge">
<title>layer_11_gate_tp_0&#45;&gt;layer_11_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340450.95,-455C340388.93,-444.48 340322.79,-434.61 340261,-428 339755.55,-373.97 339159.7,-361.59 338834.93,-359.15"/>
<polygon fill="black" stroke="black" points="338834.94,-355.65 338824.92,-359.08 338834.89,-362.65 338834.94,-355.65"/>
<text text-anchor="middle" x="340348" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1 -->
<g id="node1150" class="node">
<title>layer_11_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="341574.99,-559 341126.4,-559 341011.01,-455 341459.6,-455 341574.99,-559"/>
<text text-anchor="middle" x="341293" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="341293" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="341293" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="341293" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_0 -->
<g id="edge2141" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341470.75,-464.93C341507.98,-457.75 341547.13,-451.23 341584,-447 341588.62,-446.47 342249.35,-428.12 342254,-428 343323.17,-400.93 344600.18,-374.26 345116.42,-363.72"/>
<polygon fill="black" stroke="black" points="345116.67,-367.22 345126.59,-363.51 345116.52,-360.22 345116.67,-367.22"/>
<text text-anchor="middle" x="342280" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_1 -->
<g id="edge2142" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341475.47,-468.92C341552.9,-453.11 341626.02,-438 341628,-437 341638.67,-431.58 341649.02,-424.48 341658.62,-416.77"/>
<polygon fill="black" stroke="black" points="341661.08,-419.27 341666.5,-410.17 341656.58,-413.91 341661.08,-419.27"/>
<text text-anchor="middle" x="341667" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_2 -->
<g id="edge2143" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341059.29,-454.95C341039.97,-451.85 341020.69,-449.13 341002,-447 340918.95,-437.55 340709.54,-439.63 340626,-437 340515.76,-433.53 340488.27,-430.48 340378,-428 339453.31,-407.23 339221.87,-419.51 338297,-410 336762.27,-394.21 334917.81,-370.67 334264.14,-362.19"/>
<polygon fill="black" stroke="black" points="334264.17,-358.69 334254.13,-362.06 334264.08,-365.69 334264.17,-358.69"/>
<text text-anchor="middle" x="340652" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_3 -->
<g id="edge2144" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341470.28,-464.26C341507.63,-457.1 341546.95,-450.76 341584,-447 341710.24,-434.19 346025.12,-438.49 346152,-437 347444.23,-421.78 348993.39,-381.33 349570.51,-365.49"/>
<polygon fill="black" stroke="black" points="349570.71,-368.98 349580.61,-365.21 349570.52,-361.99 349570.71,-368.98"/>
<text text-anchor="middle" x="346775" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_4 -->
<g id="edge2145" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341470.27,-464.23C341507.63,-457.07 341546.94,-450.74 341584,-447 341694.74,-435.82 349486.7,-437.96 349598,-437 351373,-421.61 353513.22,-378.65 354212.63,-363.98"/>
<polygon fill="black" stroke="black" points="354212.9,-367.48 354222.82,-363.77 354212.75,-360.48 354212.9,-367.48"/>
<text text-anchor="middle" x="350417" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_5 -->
<g id="edge2146" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341470.27,-464.22C341507.63,-457.06 341546.94,-450.73 341584,-447 341667.96,-438.54 353650.62,-437.71 353735,-437 354657.32,-429.25 357539.44,-378.31 358382.9,-363.21"/>
<polygon fill="black" stroke="black" points="358383.1,-366.71 358393.03,-363.03 358382.97,-359.71 358383.1,-366.71"/>
<text text-anchor="middle" x="354463" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_6 -->
<g id="edge2147" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341062.12,-454.95C341041.86,-451.76 341021.61,-449.02 341002,-447 340996.16,-446.4 337627.87,-428.03 337622,-428 335889.12,-419.13 335455.85,-424.5 333723,-410 332217.13,-397.4 330408.18,-372.02 329760.99,-362.61"/>
<polygon fill="black" stroke="black" points="329760.65,-359.11 329750.6,-362.46 329760.55,-366.11 329760.65,-359.11"/>
<text text-anchor="middle" x="339236" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_7 -->
<g id="edge2148" class="edge">
<title>layer_11_gate_tp_1&#45;&gt;layer_11_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341057.1,-454.97C341035.65,-449.31 341014.36,-443.3 340994,-437 340983.51,-433.76 340981.76,-430.19 340971,-428 340766.48,-386.33 339401.79,-367.44 338837.5,-361.34"/>
<polygon fill="black" stroke="black" points="338837.23,-357.84 338827.2,-361.23 338837.16,-364.83 338837.23,-357.84"/>
<text text-anchor="middle" x="341020" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2 -->
<g id="node1151" class="node">
<title>layer_11_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="342156.99,-559 341708.4,-559 341593.01,-455 342041.6,-455 342156.99,-559"/>
<text text-anchor="middle" x="341875" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="341875" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="341875" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="341875" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_0 -->
<g id="edge2149" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342052.74,-464.91C342089.97,-457.73 342129.13,-451.22 342166,-447 342736.28,-381.8 344475.46,-364.48 345112.74,-360.26"/>
<polygon fill="black" stroke="black" points="345112.99,-363.75 345122.96,-360.19 345112.94,-356.75 345112.99,-363.75"/>
<text text-anchor="middle" x="342392" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_1 -->
<g id="edge2150" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341742.7,-454.76C341736.53,-449.4 341730.88,-443.49 341726,-437 341722.16,-431.9 341719.32,-426.07 341717.25,-419.95"/>
<polygon fill="black" stroke="black" points="341720.59,-418.88 341714.58,-410.15 341713.83,-420.72 341720.59,-418.88"/>
<text text-anchor="middle" x="341752" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_2 -->
<g id="edge2151" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341643.31,-454.95C341623.32,-451.78 341603.35,-449.05 341584,-447 341487.2,-436.73 340804.23,-451.68 340708,-437 340694.24,-434.9 340691.77,-430.07 340678,-428 340547.19,-408.3 338429.28,-411.29 338297,-410 336762.49,-395.05 334918.36,-371 334264.43,-362.29"/>
<polygon fill="black" stroke="black" points="334264.47,-358.79 334254.42,-362.15 334264.37,-365.79 334264.47,-358.79"/>
<text text-anchor="middle" x="340734" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_3 -->
<g id="edge2152" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342052.28,-464.24C342089.63,-457.08 342128.95,-450.75 342166,-447 342324.52,-430.95 347742.7,-440.41 347902,-437 348507.42,-424.05 349220.68,-389.61 349576.44,-371.13"/>
<polygon fill="black" stroke="black" points="349576.8,-374.62 349586.6,-370.6 349576.43,-367.63 349576.8,-374.62"/>
<text text-anchor="middle" x="348239" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_4 -->
<g id="edge2153" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342052.27,-464.22C342089.63,-457.06 342128.94,-450.74 342166,-447 342304.57,-433.02 352054.74,-439.48 352194,-437 352934.88,-423.8 353812.27,-387.43 354218.56,-369.41"/>
<polygon fill="black" stroke="black" points="354218.83,-372.9 354228.67,-368.96 354218.52,-365.91 354218.83,-372.9"/>
<text text-anchor="middle" x="352588" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_5 -->
<g id="edge2154" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342052.27,-464.22C342089.63,-457.06 342128.94,-450.73 342166,-447 342338.16,-429.65 354451.03,-441.46 354624,-437 354702.74,-434.97 354722.28,-430.71 354801,-428 356155.24,-381.34 357780.98,-365.2 358380.26,-360.59"/>
<polygon fill="black" stroke="black" points="358380.34,-364.09 358390.32,-360.51 358380.29,-357.09 358380.34,-364.09"/>
<text text-anchor="middle" x="354827" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_6 -->
<g id="edge2155" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341644.12,-454.98C341623.86,-451.78 341603.61,-449.04 341584,-447 341503.71,-438.66 340211.72,-437.7 340131,-437 339746.55,-433.68 339650.46,-430.62 339266,-428 336802.49,-411.18 336186.5,-428.93 333723,-410 332217.35,-398.43 330408.72,-372.43 329761.28,-362.73"/>
<polygon fill="black" stroke="black" points="329760.94,-359.23 329750.89,-362.58 329760.84,-366.23 329760.94,-359.23"/>
<text text-anchor="middle" x="340157" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_7 -->
<g id="edge2156" class="edge">
<title>layer_11_gate_tp_2&#45;&gt;layer_11_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M341642.5,-454.99C341622.78,-451.84 341603.09,-449.1 341584,-447 341470.66,-434.51 341183.13,-457.7 341071,-437 341059.39,-434.86 341057.6,-430.19 341046,-428 340833.52,-387.83 339414.64,-367.97 338837.48,-361.47"/>
<polygon fill="black" stroke="black" points="338837.41,-357.97 338827.37,-361.36 338837.33,-364.97 338837.41,-357.97"/>
<text text-anchor="middle" x="341097" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3 -->
<g id="node1152" class="node">
<title>layer_11_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="342738.99,-559 342290.4,-559 342175.01,-455 342623.6,-455 342738.99,-559"/>
<text text-anchor="middle" x="342457" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="342457" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="342457" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="342457" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_0 -->
<g id="edge2157" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342668.56,-495.25C343198.25,-468.34 344578.05,-398.22 345123.43,-370.51"/>
<polygon fill="black" stroke="black" points="345123.97,-373.99 345133.78,-369.99 345123.61,-367 345123.97,-373.99"/>
<text text-anchor="middle" x="344016" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_1 -->
<g id="edge2158" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342223.29,-454.96C342203.97,-451.86 342184.69,-449.13 342166,-447 342125.69,-442.4 341838.69,-452.02 341801,-437 341788.99,-432.21 341777.56,-424.97 341767.18,-416.8"/>
<polygon fill="black" stroke="black" points="341769.38,-414.08 341759.44,-410.39 341764.91,-419.47 341769.38,-414.08"/>
<text text-anchor="middle" x="341827" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_2 -->
<g id="edge2159" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342226.11,-454.99C342205.86,-451.79 342185.61,-449.04 342166,-447 342018.68,-431.66 340980.8,-446.63 340833,-437 340800.38,-434.87 340792.62,-430.12 340760,-428 340486.9,-410.23 338570.66,-412.63 338297,-410 336762.49,-395.24 334918.36,-371.08 334264.43,-362.31"/>
<polygon fill="black" stroke="black" points="334264.47,-358.81 334254.42,-362.18 334264.37,-365.81 334264.47,-358.81"/>
<text text-anchor="middle" x="340859" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_3 -->
<g id="edge2160" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342678.86,-504.49C343730.93,-497.2 348192.24,-464.89 348814,-437 349080.44,-425.05 349386.45,-398.97 349586.43,-380.26"/>
<polygon fill="black" stroke="black" points="349586.84,-383.74 349596.47,-379.32 349586.18,-376.77 349586.84,-383.74"/>
<text text-anchor="middle" x="349001" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_4 -->
<g id="edge2161" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342677.44,-503.22C343464.76,-493.42 346211.86,-460.35 348479,-447 348759.55,-445.35 353248.71,-449.18 353529,-437 353770.58,-426.5 354047.01,-401.16 354232.65,-382.19"/>
<polygon fill="black" stroke="black" points="354233.21,-385.65 354242.8,-381.15 354232.5,-378.69 354233.21,-385.65"/>
<text text-anchor="middle" x="353705" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_5 -->
<g id="edge2162" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342677.1,-503.19C343463.97,-493.28 346211.53,-459.89 348479,-447 349187.66,-442.97 354148.44,-449.54 354857,-437 354975.27,-434.91 355004.75,-431.17 355123,-428 356349.88,-395.13 357819.48,-371.12 358382.15,-362.5"/>
<polygon fill="black" stroke="black" points="358382.46,-365.99 358392.41,-362.34 358382.36,-358.99 358382.46,-365.99"/>
<text text-anchor="middle" x="355149" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_6 -->
<g id="edge2163" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342226.12,-454.94C342205.86,-451.75 342185.61,-449.02 342166,-447 342057.63,-435.85 340311.84,-458.29 340205,-437 340194.64,-434.94 340193.36,-430.05 340183,-428 340094.99,-410.57 333812.72,-410.67 333723,-410 332217.34,-398.78 330408.72,-372.56 329761.28,-362.77"/>
<polygon fill="black" stroke="black" points="329760.94,-359.27 329750.89,-362.62 329760.84,-366.27 329760.94,-359.27"/>
<text text-anchor="middle" x="340231" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_7 -->
<g id="edge2164" class="edge">
<title>layer_11_gate_tp_3&#45;&gt;layer_11_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342224.91,-454.96C342205.05,-451.81 342185.22,-449.07 342166,-447 342018.84,-431.12 341647.98,-440.1 341500,-437 341238.65,-431.53 339496.96,-383.83 338842.21,-365.83"/>
<polygon fill="black" stroke="black" points="338842.27,-362.33 338832.17,-365.55 338842.07,-369.33 338842.27,-362.33"/>
<text text-anchor="middle" x="341526" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_11_expert_0_ep_0 -->
<g id="node1161" class="node">
<title>layer_11_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="344777.83,-269 344343.82,-269 344232.17,-165 344666.18,-165 344777.83,-269"/>
<text text-anchor="middle" x="344505" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="344505" y="-220" font-family="Arial" font-size="10.00">GPU: 256</text>
<text text-anchor="middle" x="344505" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="344505" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_0_ep_0 -->
<g id="edge2165" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M345071.52,-314.95C344980.44,-300.82 344878.83,-284.66 344786,-269 344785.9,-268.98 344785.79,-268.97 344785.69,-268.95"/>
<polygon fill="black" stroke="black" points="344786.48,-265.53 344776.04,-267.31 344785.31,-272.43 344786.48,-265.53"/>
</g>
<!-- layer_11_expert_1_ep_0 -->
<g id="node1162" class="node">
<title>layer_11_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="345340.83,-269 344906.82,-269 344795.17,-165 345229.18,-165 345340.83,-269"/>
<text text-anchor="middle" x="345068" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="345068" y="-220" font-family="Arial" font-size="10.00">GPU: 257</text>
<text text-anchor="middle" x="345068" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="345068" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_1_ep_0 -->
<g id="edge2166" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M345246.19,-305.83C345224.9,-295.34 345202.38,-284.24 345180.78,-273.59"/>
<polygon fill="black" stroke="black" points="345182.1,-270.34 345171.59,-269.06 345179.01,-276.62 345182.1,-270.34"/>
</g>
<!-- layer_11_expert_2_ep_0 -->
<g id="node1163" class="node">
<title>layer_11_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="345903.83,-269 345469.82,-269 345358.17,-165 345792.18,-165 345903.83,-269"/>
<text text-anchor="middle" x="345631" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="345631" y="-220" font-family="Arial" font-size="10.00">GPU: 258</text>
<text text-anchor="middle" x="345631" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="345631" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_2_ep_0 -->
<g id="edge2167" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M345453.44,-305.83C345474.66,-295.34 345497.1,-284.24 345518.62,-273.59"/>
<polygon fill="black" stroke="black" points="345520.37,-276.63 345527.78,-269.06 345517.27,-270.35 345520.37,-276.63"/>
</g>
<!-- layer_11_expert_3_ep_0 -->
<g id="node1164" class="node">
<title>layer_11_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="346466.83,-269 346032.82,-269 345921.17,-165 346355.18,-165 346466.83,-269"/>
<text text-anchor="middle" x="346194" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="346194" y="-220" font-family="Arial" font-size="10.00">GPU: 259</text>
<text text-anchor="middle" x="346194" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="346194" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_3_ep_0 -->
<g id="edge2168" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M345545.28,-327.68C345653.7,-311.1 345790.94,-289.61 345913,-269 345942.45,-264.03 345973.59,-258.57 346004.01,-253.13"/>
<polygon fill="black" stroke="black" points="346004.63,-256.58 346013.85,-251.37 346003.39,-249.69 346004.63,-256.58"/>
</g>
<!-- layer_11_expert_4_ep_0 -->
<g id="node1165" class="node">
<title>layer_11_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="347029.83,-269 346595.82,-269 346484.17,-165 346918.18,-165 347029.83,-269"/>
<text text-anchor="middle" x="346757" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="346757" y="-220" font-family="Arial" font-size="10.00">GPU: 260</text>
<text text-anchor="middle" x="346757" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="346757" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_4_ep_0 -->
<g id="edge2169" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M345566.53,-346.62C345793.75,-334.2 346160.98,-309.79 346476,-269 346506.06,-265.11 346537.79,-260.17 346568.67,-254.9"/>
<polygon fill="black" stroke="black" points="346569.41,-258.32 346578.67,-253.18 346568.22,-251.42 346569.41,-258.32"/>
</g>
<!-- layer_11_expert_5_ep_0 -->
<g id="node1166" class="node">
<title>layer_11_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="347592.83,-269 347158.82,-269 347047.17,-165 347481.18,-165 347592.83,-269"/>
<text text-anchor="middle" x="347320" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="347320" y="-220" font-family="Arial" font-size="10.00">GPU: 261</text>
<text text-anchor="middle" x="347320" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="347320" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_5_ep_0 -->
<g id="edge2170" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M345575.47,-354.37C345900.04,-348.53 346517.29,-329.68 347039,-269 347069.22,-265.48 347101.1,-260.73 347132.1,-255.52"/>
<polygon fill="black" stroke="black" points="347132.86,-258.94 347142.13,-253.81 347131.69,-252.04 347132.86,-258.94"/>
</g>
<!-- layer_11_expert_6_ep_0 -->
<g id="node1167" class="node">
<title>layer_11_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="348155.83,-269 347721.82,-269 347610.17,-165 348044.18,-165 348155.83,-269"/>
<text text-anchor="middle" x="347883" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="347883" y="-220" font-family="Arial" font-size="10.00">GPU: 262</text>
<text text-anchor="middle" x="347883" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="347883" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_6_ep_0 -->
<g id="edge2171" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M345573.05,-352.27C346061.66,-341.27 347213.79,-311.6 347602,-269 347632.35,-265.67 347664.36,-260.99 347695.48,-255.8"/>
<polygon fill="black" stroke="black" points="347696.27,-259.22 347705.55,-254.1 347695.1,-252.32 347696.27,-259.22"/>
</g>
<!-- layer_11_expert_7_ep_0 -->
<g id="node1168" class="node">
<title>layer_11_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="348718.83,-269 348284.82,-269 348173.17,-165 348607.18,-165 348718.83,-269"/>
<text text-anchor="middle" x="348446" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="348446" y="-220" font-family="Arial" font-size="10.00">GPU: 263</text>
<text text-anchor="middle" x="348446" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="348446" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_0&#45;&gt;layer_11_expert_7_ep_0 -->
<g id="edge2172" class="edge">
<title>layer_11_route_ep_0&#45;&gt;layer_11_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M345575.24,-354.27C346150.73,-346.61 347664.86,-321.91 348165,-269 348195.48,-265.78 348227.62,-261.14 348258.84,-255.95"/>
<polygon fill="black" stroke="black" points="348259.67,-259.36 348268.95,-254.25 348258.5,-252.46 348259.67,-259.36"/>
</g>
<!-- layer_11_expert_0_ep_1 -->
<g id="node1169" class="node">
<title>layer_11_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="340273.83,-269 339839.82,-269 339728.17,-165 340162.18,-165 340273.83,-269"/>
<text text-anchor="middle" x="340001" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="340001" y="-220" font-family="Arial" font-size="10.00">GPU: 272</text>
<text text-anchor="middle" x="340001" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="340001" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_0_ep_1 -->
<g id="edge2173" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M341476.62,-350.99C341194.15,-341.89 340708.33,-320.02 340282.76,-269.06"/>
<polygon fill="black" stroke="black" points="340283.07,-265.57 340272.72,-267.85 340282.23,-272.52 340283.07,-265.57"/>
</g>
<!-- layer_11_expert_1_ep_1 -->
<g id="node1170" class="node">
<title>layer_11_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="340836.83,-269 340402.82,-269 340291.17,-165 340725.18,-165 340836.83,-269"/>
<text text-anchor="middle" x="340564" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="340564" y="-220" font-family="Arial" font-size="10.00">GPU: 273</text>
<text text-anchor="middle" x="340564" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="340564" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_1_ep_1 -->
<g id="edge2174" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M341460.02,-336.58C341289.11,-321.56 341058.6,-298.84 340845.51,-269.04"/>
<polygon fill="black" stroke="black" points="340845.76,-265.55 340835.37,-267.62 340844.79,-272.48 340845.76,-265.55"/>
</g>
<!-- layer_11_expert_2_ep_1 -->
<g id="node1171" class="node">
<title>layer_11_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="341399.83,-269 340965.82,-269 340854.17,-165 341288.18,-165 341399.83,-269"/>
<text text-anchor="middle" x="341127" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="341127" y="-220" font-family="Arial" font-size="10.00">GPU: 274</text>
<text text-anchor="middle" x="341127" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="341127" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_2_ep_1 -->
<g id="edge2175" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M341498.34,-305.93C341450.76,-294.67 341400.24,-282.7 341352.29,-271.35"/>
<polygon fill="black" stroke="black" points="341352.96,-267.91 341342.42,-269.01 341351.34,-274.72 341352.96,-267.91"/>
</g>
<!-- layer_11_expert_3_ep_1 -->
<g id="node1172" class="node">
<title>layer_11_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="341962.83,-269 341528.82,-269 341417.17,-165 341851.18,-165 341962.83,-269"/>
<text text-anchor="middle" x="341690" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="341690" y="-220" font-family="Arial" font-size="10.00">GPU: 275</text>
<text text-anchor="middle" x="341690" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="341690" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_3_ep_1 -->
<g id="edge2176" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M341705.13,-305.64C341703.64,-296.98 341702.07,-287.93 341700.54,-279.06"/>
<polygon fill="black" stroke="black" points="341703.98,-278.41 341698.83,-269.15 341697.08,-279.6 341703.98,-278.41"/>
</g>
<!-- layer_11_expert_4_ep_1 -->
<g id="node1173" class="node">
<title>layer_11_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="342525.83,-269 342091.82,-269 341980.17,-165 342414.18,-165 342525.83,-269"/>
<text text-anchor="middle" x="342253" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="342253" y="-220" font-family="Arial" font-size="10.00">GPU: 276</text>
<text text-anchor="middle" x="342253" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="342253" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_4_ep_1 -->
<g id="edge2177" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M341890.86,-311.39C341949.59,-296.24 342015,-279.38 342073.9,-264.19"/>
<polygon fill="black" stroke="black" points="342074.87,-267.55 342083.67,-261.67 342073.12,-260.77 342074.87,-267.55"/>
</g>
<!-- layer_11_expert_5_ep_1 -->
<g id="node1174" class="node">
<title>layer_11_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="343088.83,-269 342654.82,-269 342543.17,-165 342977.18,-165 343088.83,-269"/>
<text text-anchor="middle" x="342816" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="342816" y="-220" font-family="Arial" font-size="10.00">GPU: 277</text>
<text text-anchor="middle" x="342816" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="342816" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_5_ep_1 -->
<g id="edge2178" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M341922.04,-338.92C342088.31,-323.45 342327.14,-298.96 342535,-269 342564.78,-264.71 342596.23,-259.58 342626.89,-254.27"/>
<polygon fill="black" stroke="black" points="342627.56,-257.7 342636.81,-252.53 342626.36,-250.81 342627.56,-257.7"/>
</g>
<!-- layer_11_expert_6_ep_1 -->
<g id="node1175" class="node">
<title>layer_11_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="343651.83,-269 343217.82,-269 343106.17,-165 343540.18,-165 343651.83,-269"/>
<text text-anchor="middle" x="343379" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="343379" y="-220" font-family="Arial" font-size="10.00">GPU: 278</text>
<text text-anchor="middle" x="343379" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="343379" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_6_ep_1 -->
<g id="edge2179" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M341927.19,-343.6C342311.83,-319.41 343083.66,-270.75 343098,-269 343128.2,-265.31 343160.06,-260.46 343191.06,-255.22"/>
<polygon fill="black" stroke="black" points="343191.83,-258.64 343201.09,-253.5 343190.65,-251.74 343191.83,-258.64"/>
</g>
<!-- layer_11_expert_7_ep_1 -->
<g id="node1176" class="node">
<title>layer_11_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="344214.83,-269 343780.82,-269 343669.17,-165 344103.18,-165 344214.83,-269"/>
<text text-anchor="middle" x="343942" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="343942" y="-220" font-family="Arial" font-size="10.00">GPU: 279</text>
<text text-anchor="middle" x="343942" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="343942" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_1&#45;&gt;layer_11_expert_7_ep_1 -->
<g id="edge2180" class="edge">
<title>layer_11_route_ep_1&#45;&gt;layer_11_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M341941.85,-356.6C342306.18,-353.75 343041.91,-338.85 343661,-269 343691.34,-265.58 343723.35,-260.85 343754.46,-255.64"/>
<polygon fill="black" stroke="black" points="343755.25,-259.06 343764.53,-253.94 343754.08,-252.16 343755.25,-259.06"/>
</g>
<!-- layer_11_expert_0_ep_2 -->
<g id="node1177" class="node">
<title>layer_11_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="331265.83,-269 330831.82,-269 330720.17,-165 331154.18,-165 331265.83,-269"/>
<text text-anchor="middle" x="330993" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="330993" y="-220" font-family="Arial" font-size="10.00">GPU: 288</text>
<text text-anchor="middle" x="330993" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="330993" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_0_ep_2 -->
<g id="edge2181" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M333785.75,-353.94C333217.74,-345.8 331777.59,-320.71 331275.32,-269.09"/>
<polygon fill="black" stroke="black" points="331275.39,-265.58 331265.08,-268.02 331274.66,-272.54 331275.39,-265.58"/>
</g>
<!-- layer_11_expert_1_ep_2 -->
<g id="node1178" class="node">
<title>layer_11_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="331828.83,-269 331394.82,-269 331283.17,-165 331717.18,-165 331828.83,-269"/>
<text text-anchor="middle" x="331556" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="331556" y="-220" font-family="Arial" font-size="10.00">GPU: 289</text>
<text text-anchor="middle" x="331556" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="331556" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_1_ep_2 -->
<g id="edge2182" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M333782.92,-351.62C333302.39,-340.03 332227,-310.46 331837.9,-269.04"/>
<polygon fill="black" stroke="black" points="331838.03,-265.54 331827.71,-267.94 331837.28,-272.5 331838.03,-265.54"/>
</g>
<!-- layer_11_expert_2_ep_2 -->
<g id="node1179" class="node">
<title>layer_11_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="332391.83,-269 331957.82,-269 331846.17,-165 332280.18,-165 332391.83,-269"/>
<text text-anchor="middle" x="332119" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="332119" y="-220" font-family="Arial" font-size="10.00">GPU: 290</text>
<text text-anchor="middle" x="332119" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="332119" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_2_ep_2 -->
<g id="edge2183" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M333785.14,-353.46C333471.45,-346.64 332898.5,-326.89 332400.98,-269.08"/>
<polygon fill="black" stroke="black" points="332401.06,-265.56 332390.72,-267.88 332400.24,-272.52 332401.06,-265.56"/>
</g>
<!-- layer_11_expert_3_ep_2 -->
<g id="node1180" class="node">
<title>layer_11_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="332954.83,-269 332520.82,-269 332409.17,-165 332843.18,-165 332954.83,-269"/>
<text text-anchor="middle" x="332682" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="332682" y="-220" font-family="Arial" font-size="10.00">GPU: 291</text>
<text text-anchor="middle" x="332682" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="332682" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_3_ep_2 -->
<g id="edge2184" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M333773.66,-343.24C333561.5,-329.8 333247.05,-306.09 332963.8,-269.07"/>
<polygon fill="black" stroke="black" points="332964.1,-265.58 332953.73,-267.75 332963.19,-272.52 332964.1,-265.58"/>
</g>
<!-- layer_11_expert_4_ep_2 -->
<g id="node1181" class="node">
<title>layer_11_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="333517.83,-269 333083.82,-269 332972.17,-165 333406.18,-165 333517.83,-269"/>
<text text-anchor="middle" x="333245" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="333245" y="-220" font-family="Arial" font-size="10.00">GPU: 292</text>
<text text-anchor="middle" x="333245" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="333245" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_4_ep_2 -->
<g id="edge2185" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M333732.63,-305.97C333664.86,-293.89 333592.88,-281.03 333526,-269 333525.9,-268.98 333525.79,-268.96 333525.69,-268.94"/>
<polygon fill="black" stroke="black" points="333526.52,-265.54 333516.06,-267.21 333525.28,-272.43 333526.52,-265.54"/>
</g>
<!-- layer_11_expert_5_ep_2 -->
<g id="node1182" class="node">
<title>layer_11_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="334080.83,-269 333646.82,-269 333535.17,-165 333969.18,-165 334080.83,-269"/>
<text text-anchor="middle" x="333808" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="333808" y="-220" font-family="Arial" font-size="10.00">GPU: 293</text>
<text text-anchor="middle" x="333808" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="333808" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_5_ep_2 -->
<g id="edge2186" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M333941.96,-305.83C333926.52,-295.71 333910.23,-285.03 333894.53,-274.73"/>
<polygon fill="black" stroke="black" points="333896.15,-271.61 333885.87,-269.06 333892.32,-277.47 333896.15,-271.61"/>
</g>
<!-- layer_11_expert_6_ep_2 -->
<g id="node1183" class="node">
<title>layer_11_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="334643.83,-269 334209.82,-269 334098.17,-165 334532.18,-165 334643.83,-269"/>
<text text-anchor="middle" x="334371" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="334371" y="-220" font-family="Arial" font-size="10.00">GPU: 294</text>
<text text-anchor="middle" x="334371" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="334371" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_6_ep_2 -->
<g id="edge2187" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M334149.2,-305.83C334176.31,-295.1 334205,-283.74 334232.42,-272.88"/>
<polygon fill="black" stroke="black" points="334234.06,-275.99 334242.07,-269.06 334231.48,-269.49 334234.06,-275.99"/>
</g>
<!-- layer_11_expert_7_ep_2 -->
<g id="node1184" class="node">
<title>layer_11_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="335206.83,-269 334772.82,-269 334661.17,-165 335095.18,-165 335206.83,-269"/>
<text text-anchor="middle" x="334934" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="334934" y="-220" font-family="Arial" font-size="10.00">GPU: 295</text>
<text text-anchor="middle" x="334934" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="334934" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_2&#45;&gt;layer_11_expert_7_ep_2 -->
<g id="edge2188" class="edge">
<title>layer_11_route_ep_2&#45;&gt;layer_11_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M334219.53,-331.41C334344.3,-314.88 334508.25,-292.19 334653,-269 334682.6,-264.26 334713.89,-258.91 334744.42,-253.51"/>
<polygon fill="black" stroke="black" points="334745.07,-256.95 334754.3,-251.76 334743.85,-250.06 334745.07,-256.95"/>
</g>
<!-- layer_11_expert_0_ep_3 -->
<g id="node1185" class="node">
<title>layer_11_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="349281.83,-269 348847.82,-269 348736.17,-165 349170.18,-165 349281.83,-269"/>
<text text-anchor="middle" x="349009" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="349009" y="-220" font-family="Arial" font-size="10.00">GPU: 304</text>
<text text-anchor="middle" x="349009" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="349009" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_0_ep_3 -->
<g id="edge2189" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M349516.22,-308.37C349442.49,-295.69 349363.27,-281.95 349290,-269 349289.9,-268.98 349289.79,-268.96 349289.69,-268.95"/>
<polygon fill="black" stroke="black" points="349290.51,-265.54 349280.05,-267.24 349289.29,-272.43 349290.51,-265.54"/>
</g>
<!-- layer_11_expert_1_ep_3 -->
<g id="node1186" class="node">
<title>layer_11_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="349844.83,-269 349410.82,-269 349299.17,-165 349733.18,-165 349844.83,-269"/>
<text text-anchor="middle" x="349572" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="349572" y="-220" font-family="Arial" font-size="10.00">GPU: 305</text>
<text text-anchor="middle" x="349572" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="349572" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_1_ep_3 -->
<g id="edge2190" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M349717.34,-305.83C349700.43,-295.62 349682.58,-284.83 349665.4,-274.45"/>
<polygon fill="black" stroke="black" points="349666.85,-271.23 349656.48,-269.06 349663.23,-277.23 349666.85,-271.23"/>
</g>
<!-- layer_11_expert_2_ep_3 -->
<g id="node1187" class="node">
<title>layer_11_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="350407.83,-269 349973.82,-269 349862.17,-165 350296.18,-165 350407.83,-269"/>
<text text-anchor="middle" x="350135" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="350135" y="-220" font-family="Arial" font-size="10.00">GPU: 306</text>
<text text-anchor="middle" x="350135" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="350135" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_2_ep_3 -->
<g id="edge2191" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M349924.58,-305.83C349950.18,-295.15 349977.27,-283.84 350003.19,-273.02"/>
<polygon fill="black" stroke="black" points="350004.8,-276.14 350012.68,-269.06 350002.1,-269.68 350004.8,-276.14"/>
</g>
<!-- layer_11_expert_3_ep_3 -->
<g id="node1188" class="node">
<title>layer_11_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="350970.83,-269 350536.82,-269 350425.17,-165 350859.18,-165 350970.83,-269"/>
<text text-anchor="middle" x="350698" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="350698" y="-220" font-family="Arial" font-size="10.00">GPU: 307</text>
<text text-anchor="middle" x="350698" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="350698" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_3_ep_3 -->
<g id="edge2192" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M350000.32,-330.54C350120.96,-313.97 350278.06,-291.54 350417,-269 350446.48,-264.22 350477.64,-258.86 350508.06,-253.47"/>
<polygon fill="black" stroke="black" points="350508.68,-256.91 350517.91,-251.72 350507.45,-250.02 350508.68,-256.91"/>
</g>
<!-- layer_11_expert_4_ep_3 -->
<g id="node1189" class="node">
<title>layer_11_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="351533.83,-269 351099.82,-269 350988.17,-165 351422.18,-165 351533.83,-269"/>
<text text-anchor="middle" x="351261" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="351261" y="-220" font-family="Arial" font-size="10.00">GPU: 308</text>
<text text-anchor="middle" x="351261" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="351261" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_4_ep_3 -->
<g id="edge2193" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M350019.8,-347.59C350256.75,-335.75 350646.37,-311.62 350980,-269 351010.07,-265.16 351041.8,-260.24 351072.68,-254.99"/>
<polygon fill="black" stroke="black" points="351073.42,-258.41 351082.68,-253.27 351072.23,-251.51 351073.42,-258.41"/>
</g>
<!-- layer_11_expert_5_ep_3 -->
<g id="node1190" class="node">
<title>layer_11_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="352096.83,-269 351662.82,-269 351551.17,-165 351985.18,-165 352096.83,-269"/>
<text text-anchor="middle" x="351824" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="351824" y="-220" font-family="Arial" font-size="10.00">GPU: 309</text>
<text text-anchor="middle" x="351824" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="351824" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_5_ep_3 -->
<g id="edge2194" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M350014.46,-342.83C350252.44,-327.34 350649.72,-302.66 350992,-287 351236.76,-275.81 351299.36,-294.95 351543,-269 351573.36,-265.77 351605.38,-261.14 351636.5,-255.97"/>
<polygon fill="black" stroke="black" points="351637.29,-259.39 351646.57,-254.28 351636.12,-252.48 351637.29,-259.39"/>
</g>
<!-- layer_11_expert_6_ep_3 -->
<g id="node1191" class="node">
<title>layer_11_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="352659.83,-269 352225.82,-269 352114.17,-165 352548.18,-165 352659.83,-269"/>
<text text-anchor="middle" x="352387" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="352387" y="-220" font-family="Arial" font-size="10.00">GPU: 310</text>
<text text-anchor="middle" x="352387" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="352387" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_6_ep_3 -->
<g id="edge2195" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M350025.53,-352.49C350522.7,-341.81 351707.58,-312.54 352106,-269 352136.35,-265.68 352168.37,-261.01 352199.48,-255.83"/>
<polygon fill="black" stroke="black" points="352200.27,-259.24 352209.55,-254.13 352199.11,-252.34 352200.27,-259.24"/>
</g>
<!-- layer_11_expert_7_ep_3 -->
<g id="node1192" class="node">
<title>layer_11_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="353222.83,-269 352788.82,-269 352677.17,-165 353111.18,-165 353222.83,-269"/>
<text text-anchor="middle" x="352950" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="352950" y="-220" font-family="Arial" font-size="10.00">GPU: 311</text>
<text text-anchor="middle" x="352950" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="352950" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_3&#45;&gt;layer_11_expert_7_ep_3 -->
<g id="edge2196" class="edge">
<title>layer_11_route_ep_3&#45;&gt;layer_11_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M350027.41,-354.42C350610.49,-347.05 352158.45,-322.86 352669,-269 352699.48,-265.78 352731.62,-261.15 352762.84,-255.97"/>
<polygon fill="black" stroke="black" points="352763.67,-259.38 352772.95,-254.26 352762.5,-252.47 352763.67,-259.38"/>
</g>
<!-- layer_11_expert_0_ep_4 -->
<g id="node1193" class="node">
<title>layer_11_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="353785.83,-269 353351.82,-269 353240.17,-165 353674.18,-165 353785.83,-269"/>
<text text-anchor="middle" x="353513" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="353513" y="-220" font-family="Arial" font-size="10.00">GPU: 320</text>
<text text-anchor="middle" x="353513" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="353513" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_0_ep_4 -->
<g id="edge2197" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M354177.15,-323.5C354062.26,-308.48 353926.46,-289.81 353794.31,-269.03"/>
<polygon fill="black" stroke="black" points="353794.82,-265.57 353784.39,-267.47 353793.73,-272.48 353794.82,-265.57"/>
</g>
<!-- layer_11_expert_1_ep_4 -->
<g id="node1194" class="node">
<title>layer_11_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="354348.83,-269 353914.82,-269 353803.17,-165 354237.18,-165 354348.83,-269"/>
<text text-anchor="middle" x="354076" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="354076" y="-220" font-family="Arial" font-size="10.00">GPU: 321</text>
<text text-anchor="middle" x="354076" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="354076" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_1_ep_4 -->
<g id="edge2198" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M354310.06,-305.93C354281.14,-295.07 354250.49,-283.55 354221.23,-272.56"/>
<polygon fill="black" stroke="black" points="354222.38,-269.25 354211.78,-269.01 354219.91,-275.8 354222.38,-269.25"/>
</g>
<!-- layer_11_expert_2_ep_4 -->
<g id="node1195" class="node">
<title>layer_11_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="354911.83,-269 354477.82,-269 354366.17,-165 354800.18,-165 354911.83,-269"/>
<text text-anchor="middle" x="354639" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="354639" y="-220" font-family="Arial" font-size="10.00">GPU: 322</text>
<text text-anchor="middle" x="354639" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="354639" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_2_ep_4 -->
<g id="edge2199" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M354517.04,-305.83C354530.97,-295.8 354545.66,-285.23 354559.83,-275.02"/>
<polygon fill="black" stroke="black" points="354562.04,-277.74 354568.11,-269.06 354557.95,-272.06 354562.04,-277.74"/>
</g>
<!-- layer_11_expert_3_ep_4 -->
<g id="node1196" class="node">
<title>layer_11_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="355474.83,-269 355040.82,-269 354929.17,-165 355363.18,-165 355474.83,-269"/>
<text text-anchor="middle" x="355202" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="355202" y="-220" font-family="Arial" font-size="10.00">GPU: 323</text>
<text text-anchor="middle" x="355202" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="355202" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_3_ep_4 -->
<g id="edge2200" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M354635.31,-322.19C354750.16,-301.08 354896.27,-274.21 355011.36,-253.05"/>
<polygon fill="black" stroke="black" points="355012.14,-256.47 355021.34,-251.22 355010.87,-249.58 355012.14,-256.47"/>
</g>
<!-- layer_11_expert_4_ep_4 -->
<g id="node1197" class="node">
<title>layer_11_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="356037.83,-269 355603.82,-269 355492.17,-165 355926.18,-165 356037.83,-269"/>
<text text-anchor="middle" x="355765" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="355765" y="-220" font-family="Arial" font-size="10.00">GPU: 324</text>
<text text-anchor="middle" x="355765" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="355765" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_4_ep_4 -->
<g id="edge2201" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M354660.85,-344.76C354871.21,-331.37 355200.51,-306.66 355484,-269 355513.94,-265.02 355545.53,-260.05 355576.31,-254.78"/>
<polygon fill="black" stroke="black" points="355577.01,-258.22 355586.27,-253.06 355575.82,-251.32 355577.01,-258.22"/>
</g>
<!-- layer_11_expert_5_ep_4 -->
<g id="node1198" class="node">
<title>layer_11_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="356600.83,-269 356166.82,-269 356055.17,-165 356489.18,-165 356600.83,-269"/>
<text text-anchor="middle" x="356328" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="356328" y="-220" font-family="Arial" font-size="10.00">GPU: 325</text>
<text text-anchor="middle" x="356328" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="356328" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_5_ep_4 -->
<g id="edge2202" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M354670.48,-353.47C354980.87,-346.59 355558.18,-326.57 356047,-269 356077.21,-265.44 356109.09,-260.66 356140.09,-255.44"/>
<polygon fill="black" stroke="black" points="356140.85,-258.87 356150.12,-253.74 356139.68,-251.96 356140.85,-258.87"/>
</g>
<!-- layer_11_expert_6_ep_4 -->
<g id="node1199" class="node">
<title>layer_11_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="357163.83,-269 356729.82,-269 356618.17,-165 357052.18,-165 357163.83,-269"/>
<text text-anchor="middle" x="356891" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="356891" y="-220" font-family="Arial" font-size="10.00">GPU: 326</text>
<text text-anchor="middle" x="356891" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="356891" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_6_ep_4 -->
<g id="edge2203" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M354668.78,-351.87C355143,-340.31 356239.19,-309.99 356610,-269 356640.35,-265.65 356672.36,-260.95 356703.47,-255.76"/>
<polygon fill="black" stroke="black" points="356704.27,-259.18 356713.54,-254.06 356703.1,-252.27 356704.27,-259.18"/>
</g>
<!-- layer_11_expert_7_ep_4 -->
<g id="node1200" class="node">
<title>layer_11_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="357726.83,-269 357292.82,-269 357181.17,-165 357615.18,-165 357726.83,-269"/>
<text text-anchor="middle" x="357454" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="357454" y="-220" font-family="Arial" font-size="10.00">GPU: 327</text>
<text text-anchor="middle" x="357454" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="357454" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_4&#45;&gt;layer_11_expert_7_ep_4 -->
<g id="edge2204" class="edge">
<title>layer_11_route_ep_4&#45;&gt;layer_11_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M354671.11,-354.01C355233.72,-345.85 356690.49,-320.29 357173,-269 357203.48,-265.76 357235.62,-261.11 357266.84,-255.92"/>
<polygon fill="black" stroke="black" points="357267.66,-259.34 357276.94,-254.22 357266.5,-252.43 357267.66,-259.34"/>
</g>
<!-- layer_11_expert_0_ep_5 -->
<g id="node1201" class="node">
<title>layer_11_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="358289.83,-269 357855.82,-269 357744.17,-165 358178.18,-165 358289.83,-269"/>
<text text-anchor="middle" x="358017" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="358017" y="-220" font-family="Arial" font-size="10.00">GPU: 336</text>
<text text-anchor="middle" x="358017" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="358017" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_0_ep_5 -->
<g id="edge2205" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M358396.56,-305.93C358347.83,-294.64 358296.08,-282.65 358246.97,-271.28"/>
<polygon fill="black" stroke="black" points="358247.72,-267.86 358237.19,-269.01 358246.14,-274.68 358247.72,-267.86"/>
</g>
<!-- layer_11_expert_1_ep_5 -->
<g id="node1202" class="node">
<title>layer_11_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="358852.83,-269 358418.82,-269 358307.17,-165 358741.18,-165 358852.83,-269"/>
<text text-anchor="middle" x="358580" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="358580" y="-220" font-family="Arial" font-size="10.00">GPU: 337</text>
<text text-anchor="middle" x="358580" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="358580" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_1_ep_5 -->
<g id="edge2206" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M358603.33,-305.64C358601.02,-296.98 358598.61,-287.93 358596.25,-279.06"/>
<polygon fill="black" stroke="black" points="358599.57,-277.92 358593.62,-269.15 358592.81,-279.72 358599.57,-277.92"/>
</g>
<!-- layer_11_expert_2_ep_5 -->
<g id="node1203" class="node">
<title>layer_11_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="359415.83,-269 358981.82,-269 358870.17,-165 359304.18,-165 359415.83,-269"/>
<text text-anchor="middle" x="359143" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="359143" y="-220" font-family="Arial" font-size="10.00">GPU: 338</text>
<text text-anchor="middle" x="359143" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="359143" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_2_ep_5 -->
<g id="edge2207" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M358792.88,-310.52C358848.1,-295.93 358909.1,-279.81 358964.5,-265.17"/>
<polygon fill="black" stroke="black" points="358965.64,-268.49 358974.42,-262.55 358963.85,-261.72 358965.64,-268.49"/>
</g>
<!-- layer_11_expert_3_ep_5 -->
<g id="node1204" class="node">
<title>layer_11_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="359978.83,-269 359544.82,-269 359433.17,-165 359867.18,-165 359978.83,-269"/>
<text text-anchor="middle" x="359706" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="359706" y="-220" font-family="Arial" font-size="10.00">GPU: 339</text>
<text text-anchor="middle" x="359706" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="359706" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_3_ep_5 -->
<g id="edge2208" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M358824.67,-338.48C358988.18,-322.91 359221.64,-298.49 359425,-269 359454.78,-264.68 359486.22,-259.55 359516.88,-254.22"/>
<polygon fill="black" stroke="black" points="359517.55,-257.66 359526.8,-252.49 359516.35,-250.76 359517.55,-257.66"/>
</g>
<!-- layer_11_expert_4_ep_5 -->
<g id="node1205" class="node">
<title>layer_11_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="360541.83,-269 360107.82,-269 359996.17,-165 360430.18,-165 360541.83,-269"/>
<text text-anchor="middle" x="360269" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="360269" y="-220" font-family="Arial" font-size="10.00">GPU: 340</text>
<text text-anchor="middle" x="360269" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="360269" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_4_ep_5 -->
<g id="edge2209" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M358827.25,-340.95C358994.35,-328.45 359234.07,-311.08 359444,-298 359685.65,-282.94 359747.52,-297.12 359988,-269 360018.22,-265.47 360050.09,-260.7 360081.09,-255.49"/>
<polygon fill="black" stroke="black" points="360081.85,-258.91 360091.13,-253.78 360080.68,-252.01 360081.85,-258.91"/>
</g>
<!-- layer_11_expert_5_ep_5 -->
<g id="node1206" class="node">
<title>layer_11_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="361104.83,-269 360670.82,-269 360559.17,-165 360993.18,-165 361104.83,-269"/>
<text text-anchor="middle" x="360832" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="360832" y="-220" font-family="Arial" font-size="10.00">GPU: 341</text>
<text text-anchor="middle" x="360832" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="360832" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_5_ep_5 -->
<g id="edge2210" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M358825.45,-339.52C358992.58,-326.14 359233.2,-308.28 359444,-298 359935.59,-274.04 360061.43,-319.54 360551,-269 360581.48,-265.85 360613.63,-261.25 360644.86,-256.08"/>
<polygon fill="black" stroke="black" points="360645.68,-259.5 360654.96,-254.39 360644.52,-252.59 360645.68,-259.5"/>
</g>
<!-- layer_11_expert_6_ep_5 -->
<g id="node1207" class="node">
<title>layer_11_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="361667.83,-269 361233.82,-269 361122.17,-165 361556.18,-165 361667.83,-269"/>
<text text-anchor="middle" x="361395" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="361395" y="-220" font-family="Arial" font-size="10.00">GPU: 342</text>
<text text-anchor="middle" x="361395" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="361395" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_6_ep_5 -->
<g id="edge2211" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M358824.98,-338.7C358992.1,-324.83 359232.95,-306.72 359444,-298 359814.85,-282.67 360744.75,-306.71 361114,-269 361144.49,-265.89 361176.64,-261.3 361207.86,-256.14"/>
<polygon fill="black" stroke="black" points="361208.68,-259.55 361217.97,-254.45 361207.52,-252.65 361208.68,-259.55"/>
</g>
<!-- layer_11_expert_7_ep_5 -->
<g id="node1208" class="node">
<title>layer_11_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="362230.83,-269 361796.82,-269 361685.17,-165 362119.18,-165 362230.83,-269"/>
<text text-anchor="middle" x="361958" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="361958" y="-220" font-family="Arial" font-size="10.00">GPU: 343</text>
<text text-anchor="middle" x="361958" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="361958" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_5&#45;&gt;layer_11_expert_7_ep_5 -->
<g id="edge2212" class="edge">
<title>layer_11_route_ep_5&#45;&gt;layer_11_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M358824.54,-338.53C358991.68,-324.53 359232.75,-306.34 359444,-298 359939.88,-278.41 361183.21,-318.48 361677,-269 361707.49,-265.94 361739.64,-261.39 361770.87,-256.24"/>
<polygon fill="black" stroke="black" points="361771.69,-259.65 361780.98,-254.55 361770.54,-252.75 361771.69,-259.65"/>
</g>
<!-- layer_11_expert_0_ep_6 -->
<g id="node1209" class="node">
<title>layer_11_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="326761.83,-269 326327.82,-269 326216.17,-165 326650.18,-165 326761.83,-269"/>
<text text-anchor="middle" x="326489" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="326489" y="-220" font-family="Arial" font-size="10.00">GPU: 352</text>
<text text-anchor="middle" x="326489" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="326489" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_0_ep_6 -->
<g id="edge2213" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M329281.75,-353.94C328713.74,-345.8 327273.59,-320.71 326771.32,-269.09"/>
<polygon fill="black" stroke="black" points="326771.39,-265.58 326761.08,-268.02 326770.66,-272.54 326771.39,-265.58"/>
</g>
<!-- layer_11_expert_1_ep_6 -->
<g id="node1210" class="node">
<title>layer_11_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="327324.83,-269 326890.82,-269 326779.17,-165 327213.18,-165 327324.83,-269"/>
<text text-anchor="middle" x="327052" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="327052" y="-220" font-family="Arial" font-size="10.00">GPU: 353</text>
<text text-anchor="middle" x="327052" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="327052" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_1_ep_6 -->
<g id="edge2214" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M329278.92,-351.62C328798.39,-340.03 327723,-310.46 327333.9,-269.04"/>
<polygon fill="black" stroke="black" points="327334.03,-265.54 327323.71,-267.94 327333.28,-272.5 327334.03,-265.54"/>
</g>
<!-- layer_11_expert_2_ep_6 -->
<g id="node1211" class="node">
<title>layer_11_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="327887.83,-269 327453.82,-269 327342.17,-165 327776.18,-165 327887.83,-269"/>
<text text-anchor="middle" x="327615" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="327615" y="-220" font-family="Arial" font-size="10.00">GPU: 354</text>
<text text-anchor="middle" x="327615" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="327615" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_2_ep_6 -->
<g id="edge2215" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M329281.14,-353.46C328967.45,-346.64 328394.5,-326.89 327896.98,-269.08"/>
<polygon fill="black" stroke="black" points="327897.06,-265.56 327886.72,-267.88 327896.24,-272.52 327897.06,-265.56"/>
</g>
<!-- layer_11_expert_3_ep_6 -->
<g id="node1212" class="node">
<title>layer_11_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="328450.83,-269 328016.82,-269 327905.17,-165 328339.18,-165 328450.83,-269"/>
<text text-anchor="middle" x="328178" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="328178" y="-220" font-family="Arial" font-size="10.00">GPU: 355</text>
<text text-anchor="middle" x="328178" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="328178" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_3_ep_6 -->
<g id="edge2216" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M329269.66,-343.24C329057.5,-329.8 328743.05,-306.09 328459.8,-269.07"/>
<polygon fill="black" stroke="black" points="328460.1,-265.58 328449.73,-267.75 328459.19,-272.52 328460.1,-265.58"/>
</g>
<!-- layer_11_expert_4_ep_6 -->
<g id="node1213" class="node">
<title>layer_11_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="329013.83,-269 328579.82,-269 328468.17,-165 328902.18,-165 329013.83,-269"/>
<text text-anchor="middle" x="328741" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="328741" y="-220" font-family="Arial" font-size="10.00">GPU: 356</text>
<text text-anchor="middle" x="328741" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="328741" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_4_ep_6 -->
<g id="edge2217" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M329228.63,-305.97C329160.86,-293.89 329088.88,-281.03 329022,-269 329021.9,-268.98 329021.79,-268.96 329021.69,-268.94"/>
<polygon fill="black" stroke="black" points="329022.52,-265.54 329012.06,-267.21 329021.28,-272.43 329022.52,-265.54"/>
</g>
<!-- layer_11_expert_5_ep_6 -->
<g id="node1214" class="node">
<title>layer_11_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="329576.83,-269 329142.82,-269 329031.17,-165 329465.18,-165 329576.83,-269"/>
<text text-anchor="middle" x="329304" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="329304" y="-220" font-family="Arial" font-size="10.00">GPU: 357</text>
<text text-anchor="middle" x="329304" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="329304" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_5_ep_6 -->
<g id="edge2218" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M329437.96,-305.83C329422.52,-295.71 329406.23,-285.03 329390.53,-274.73"/>
<polygon fill="black" stroke="black" points="329392.15,-271.61 329381.87,-269.06 329388.32,-277.47 329392.15,-271.61"/>
</g>
<!-- layer_11_expert_6_ep_6 -->
<g id="node1215" class="node">
<title>layer_11_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="330139.83,-269 329705.82,-269 329594.17,-165 330028.18,-165 330139.83,-269"/>
<text text-anchor="middle" x="329867" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="329867" y="-220" font-family="Arial" font-size="10.00">GPU: 358</text>
<text text-anchor="middle" x="329867" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="329867" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_6_ep_6 -->
<g id="edge2219" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M329645.2,-305.83C329672.31,-295.1 329701,-283.74 329728.42,-272.88"/>
<polygon fill="black" stroke="black" points="329730.06,-275.99 329738.07,-269.06 329727.48,-269.49 329730.06,-275.99"/>
</g>
<!-- layer_11_expert_7_ep_6 -->
<g id="node1216" class="node">
<title>layer_11_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="330702.83,-269 330268.82,-269 330157.17,-165 330591.18,-165 330702.83,-269"/>
<text text-anchor="middle" x="330430" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="330430" y="-220" font-family="Arial" font-size="10.00">GPU: 359</text>
<text text-anchor="middle" x="330430" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="330430" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_6&#45;&gt;layer_11_expert_7_ep_6 -->
<g id="edge2220" class="edge">
<title>layer_11_route_ep_6&#45;&gt;layer_11_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M329715.53,-331.41C329840.3,-314.88 330004.25,-292.19 330149,-269 330178.6,-264.26 330209.89,-258.91 330240.42,-253.51"/>
<polygon fill="black" stroke="black" points="330241.07,-256.95 330250.3,-251.76 330239.85,-250.06 330241.07,-256.95"/>
</g>
<!-- layer_11_expert_0_ep_7 -->
<g id="node1217" class="node">
<title>layer_11_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="335769.83,-269 335335.82,-269 335224.17,-165 335658.18,-165 335769.83,-269"/>
<text text-anchor="middle" x="335497" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="335497" y="-220" font-family="Arial" font-size="10.00">GPU: 368</text>
<text text-anchor="middle" x="335497" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="335497" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_0_ep_7 -->
<g id="edge2221" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M338360.21,-354.16C337782.12,-346.43 336295.66,-321.99 335779.23,-269.08"/>
<polygon fill="black" stroke="black" points="335779.39,-265.58 335769.08,-268.02 335778.66,-272.54 335779.39,-265.58"/>
</g>
<!-- layer_11_expert_1_ep_7 -->
<g id="node1218" class="node">
<title>layer_11_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="336332.83,-269 335898.82,-269 335787.17,-165 336221.18,-165 336332.83,-269"/>
<text text-anchor="middle" x="336060" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="336060" y="-220" font-family="Arial" font-size="10.00">GPU: 369</text>
<text text-anchor="middle" x="336060" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="336060" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_1_ep_7 -->
<g id="edge2222" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M338357.37,-351.97C337865.27,-340.83 336744.66,-311.72 336341.68,-269.02"/>
<polygon fill="black" stroke="black" points="336342.03,-265.54 336331.71,-267.95 336341.28,-272.5 336342.03,-265.54"/>
</g>
<!-- layer_11_expert_2_ep_7 -->
<g id="node1219" class="node">
<title>layer_11_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="336895.83,-269 336461.82,-269 336350.17,-165 336784.18,-165 336895.83,-269"/>
<text text-anchor="middle" x="336623" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="336623" y="-220" font-family="Arial" font-size="10.00">GPU: 370</text>
<text text-anchor="middle" x="336623" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="336623" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_2_ep_7 -->
<g id="edge2223" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M338360.16,-354.23C338035.36,-348.26 337429.39,-329.44 336904.76,-269.05"/>
<polygon fill="black" stroke="black" points="336905.05,-265.56 336894.72,-267.89 336904.25,-272.51 336905.05,-265.56"/>
</g>
<!-- layer_11_expert_3_ep_7 -->
<g id="node1220" class="node">
<title>layer_11_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="337458.83,-269 337024.82,-269 336913.17,-165 337347.18,-165 337458.83,-269"/>
<text text-anchor="middle" x="337186" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="337186" y="-220" font-family="Arial" font-size="10.00">GPU: 371</text>
<text text-anchor="middle" x="337186" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="337186" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_3_ep_7 -->
<g id="edge2224" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M338349.79,-345.11C338123.47,-332.41 337777.42,-308.72 337467.8,-269.07"/>
<polygon fill="black" stroke="black" points="337468.1,-265.58 337457.73,-267.77 337467.2,-272.52 337468.1,-265.58"/>
</g>
<!-- layer_11_expert_4_ep_7 -->
<g id="node1221" class="node">
<title>layer_11_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="338021.83,-269 337587.82,-269 337476.17,-165 337910.18,-165 338021.83,-269"/>
<text text-anchor="middle" x="337749" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="337749" y="-220" font-family="Arial" font-size="10.00">GPU: 372</text>
<text text-anchor="middle" x="337749" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="337749" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_4_ep_7 -->
<g id="edge2225" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M338315.52,-314.95C338224.44,-300.82 338122.83,-284.66 338030,-269 338029.9,-268.98 338029.79,-268.97 338029.69,-268.95"/>
<polygon fill="black" stroke="black" points="338030.48,-265.53 338020.04,-267.31 338029.31,-272.43 338030.48,-265.53"/>
</g>
<!-- layer_11_expert_5_ep_7 -->
<g id="node1222" class="node">
<title>layer_11_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="338584.83,-269 338150.82,-269 338039.17,-165 338473.18,-165 338584.83,-269"/>
<text text-anchor="middle" x="338312" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="338312" y="-220" font-family="Arial" font-size="10.00">GPU: 373</text>
<text text-anchor="middle" x="338312" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="338312" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_5_ep_7 -->
<g id="edge2226" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M338490.19,-305.83C338468.9,-295.34 338446.38,-284.24 338424.78,-273.59"/>
<polygon fill="black" stroke="black" points="338426.1,-270.34 338415.59,-269.06 338423.01,-276.62 338426.1,-270.34"/>
</g>
<!-- layer_11_expert_6_ep_7 -->
<g id="node1223" class="node">
<title>layer_11_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="339147.83,-269 338713.82,-269 338602.17,-165 339036.18,-165 339147.83,-269"/>
<text text-anchor="middle" x="338875" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="338875" y="-220" font-family="Arial" font-size="10.00">GPU: 374</text>
<text text-anchor="middle" x="338875" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="338875" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_6_ep_7 -->
<g id="edge2227" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M338697.44,-305.83C338718.66,-295.34 338741.1,-284.24 338762.62,-273.59"/>
<polygon fill="black" stroke="black" points="338764.37,-276.63 338771.78,-269.06 338761.27,-270.35 338764.37,-276.63"/>
</g>
<!-- layer_11_expert_7_ep_7 -->
<g id="node1224" class="node">
<title>layer_11_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="339710.83,-269 339276.82,-269 339165.17,-165 339599.18,-165 339710.83,-269"/>
<text text-anchor="middle" x="339438" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="339438" y="-220" font-family="Arial" font-size="10.00">GPU: 375</text>
<text text-anchor="middle" x="339438" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="339438" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_11_route_ep_7&#45;&gt;layer_11_expert_7_ep_7 -->
<g id="edge2228" class="edge">
<title>layer_11_route_ep_7&#45;&gt;layer_11_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M338789.28,-327.68C338897.7,-311.1 339034.94,-289.61 339157,-269 339186.45,-264.03 339217.59,-258.57 339248.01,-253.13"/>
<polygon fill="black" stroke="black" points="339248.63,-256.58 339257.85,-251.37 339247.39,-249.69 339248.63,-256.58"/>
</g>
<!-- layer_11_agg_ep_0 -->
<g id="node1225" class="node">
<title>layer_11_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="347040.07,-128 346589.77,-128 346473.93,-24 346924.23,-24 347040.07,-128"/>
<text text-anchor="middle" x="346757" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="346757" y="-79" font-family="Arial" font-size="10.00">GPU: 256&#45;271</text>
<text text-anchor="middle" x="346757" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="346757" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2229" class="edge">
<title>layer_11_expert_0_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M344677.37,-175.09C344713.1,-167.94 344750.63,-161.4 344786,-157 345116.43,-115.9 346082.09,-91.08 346527.31,-81.52"/>
<polygon fill="black" stroke="black" points="346527.48,-85.02 346537.4,-81.31 346527.33,-78.02 346527.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2230" class="edge">
<title>layer_11_expert_1_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M345240.8,-175.46C345276.41,-168.31 345313.79,-161.67 345349,-157 345760.77,-102.39 346245.14,-85.03 346525.05,-79.53"/>
<polygon fill="black" stroke="black" points="346525.4,-83.02 346535.33,-79.33 346525.26,-76.02 346525.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2231" class="edge">
<title>layer_11_expert_2_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M345804.7,-176.34C345840.07,-169.17 345877.13,-162.29 345912,-157 346123.23,-124.93 346366.24,-103.53 346537.27,-90.99"/>
<polygon fill="black" stroke="black" points="346537.69,-94.47 346547.41,-90.25 346537.18,-87.49 346537.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2232" class="edge">
<title>layer_11_expert_3_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M346364.83,-173.82C346430.06,-157.72 346504.72,-139.29 346571.27,-122.86"/>
<polygon fill="black" stroke="black" points="346572.15,-126.24 346581.02,-120.45 346570.48,-119.45 346572.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2233" class="edge">
<title>layer_11_expert_4_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M346757,-164.64C346757,-156.08 346757,-147.12 346757,-138.34"/>
<polygon fill="black" stroke="black" points="346760.5,-138.15 346757,-128.15 346753.5,-138.15 346760.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2234" class="edge">
<title>layer_11_expert_5_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M347113.16,-164.93C347067.62,-153.69 347019.27,-141.75 346973.37,-130.42"/>
<polygon fill="black" stroke="black" points="346974.16,-127.01 346963.61,-128.01 346972.48,-133.81 346974.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2235" class="edge">
<title>layer_11_expert_6_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M347649.92,-164.97C347633.74,-162.07 347617.65,-159.38 347602,-157 347404.52,-127.02 347179.26,-106.36 347011.01,-93.55"/>
<polygon fill="black" stroke="black" points="347011.26,-90.06 347001.02,-92.8 347010.73,-97.04 347011.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_0&#45;&gt;layer_11_agg_ep_0 -->
<g id="edge2236" class="edge">
<title>layer_11_expert_7_ep_0&#45;&gt;layer_11_agg_ep_0</title>
<path fill="none" stroke="black" d="M348216.84,-164.94C348199.35,-161.94 348181.92,-159.24 348165,-157 347756.97,-102.88 347277.66,-85.34 346996.64,-79.68"/>
<polygon fill="black" stroke="black" points="346996.38,-76.17 346986.32,-79.47 346996.24,-83.17 346996.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_1 -->
<g id="node1226" class="node">
<title>layer_11_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="342536.07,-128 342085.77,-128 341969.93,-24 342420.23,-24 342536.07,-128"/>
<text text-anchor="middle" x="342253" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="342253" y="-79" font-family="Arial" font-size="10.00">GPU: 272&#45;287</text>
<text text-anchor="middle" x="342253" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="342253" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2238" class="edge">
<title>layer_11_expert_0_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M340173.37,-175.09C340209.1,-167.94 340246.63,-161.4 340282,-157 340612.43,-115.9 341578.09,-91.08 342023.31,-81.52"/>
<polygon fill="black" stroke="black" points="342023.48,-85.02 342033.4,-81.31 342023.33,-78.02 342023.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2239" class="edge">
<title>layer_11_expert_1_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M340736.8,-175.46C340772.41,-168.31 340809.79,-161.67 340845,-157 341256.77,-102.39 341741.14,-85.03 342021.05,-79.53"/>
<polygon fill="black" stroke="black" points="342021.4,-83.02 342031.33,-79.33 342021.26,-76.02 342021.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2240" class="edge">
<title>layer_11_expert_2_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M341300.7,-176.34C341336.07,-169.17 341373.13,-162.29 341408,-157 341619.23,-124.93 341862.24,-103.53 342033.27,-90.99"/>
<polygon fill="black" stroke="black" points="342033.69,-94.47 342043.41,-90.25 342033.18,-87.49 342033.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2241" class="edge">
<title>layer_11_expert_3_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M341860.83,-173.82C341926.06,-157.72 342000.72,-139.29 342067.27,-122.86"/>
<polygon fill="black" stroke="black" points="342068.15,-126.24 342077.02,-120.45 342066.48,-119.45 342068.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2242" class="edge">
<title>layer_11_expert_4_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M342253,-164.64C342253,-156.08 342253,-147.12 342253,-138.34"/>
<polygon fill="black" stroke="black" points="342256.5,-138.15 342253,-128.15 342249.5,-138.15 342256.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2243" class="edge">
<title>layer_11_expert_5_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M342609.16,-164.93C342563.62,-153.69 342515.27,-141.75 342469.37,-130.42"/>
<polygon fill="black" stroke="black" points="342470.16,-127.01 342459.61,-128.01 342468.48,-133.81 342470.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2244" class="edge">
<title>layer_11_expert_6_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M343145.92,-164.97C343129.74,-162.07 343113.65,-159.38 343098,-157 342900.52,-127.02 342675.26,-106.36 342507.01,-93.55"/>
<polygon fill="black" stroke="black" points="342507.26,-90.06 342497.02,-92.8 342506.73,-97.04 342507.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_1&#45;&gt;layer_11_agg_ep_1 -->
<g id="edge2245" class="edge">
<title>layer_11_expert_7_ep_1&#45;&gt;layer_11_agg_ep_1</title>
<path fill="none" stroke="black" d="M343712.84,-164.94C343695.35,-161.94 343677.92,-159.24 343661,-157 343252.97,-102.88 342773.66,-85.34 342492.64,-79.68"/>
<polygon fill="black" stroke="black" points="342492.38,-76.17 342482.32,-79.47 342492.24,-83.17 342492.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_2 -->
<g id="node1227" class="node">
<title>layer_11_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="333528.07,-128 333077.77,-128 332961.93,-24 333412.23,-24 333528.07,-128"/>
<text text-anchor="middle" x="333245" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="333245" y="-79" font-family="Arial" font-size="10.00">GPU: 288&#45;303</text>
<text text-anchor="middle" x="333245" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="333245" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2247" class="edge">
<title>layer_11_expert_0_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M331165.37,-175.09C331201.1,-167.94 331238.63,-161.4 331274,-157 331604.43,-115.9 332570.09,-91.08 333015.31,-81.52"/>
<polygon fill="black" stroke="black" points="333015.48,-85.02 333025.4,-81.31 333015.33,-78.02 333015.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2248" class="edge">
<title>layer_11_expert_1_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M331728.8,-175.46C331764.41,-168.31 331801.79,-161.67 331837,-157 332248.77,-102.39 332733.14,-85.03 333013.05,-79.53"/>
<polygon fill="black" stroke="black" points="333013.4,-83.02 333023.33,-79.33 333013.26,-76.02 333013.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2249" class="edge">
<title>layer_11_expert_2_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M332292.7,-176.34C332328.07,-169.17 332365.13,-162.29 332400,-157 332611.23,-124.93 332854.24,-103.53 333025.27,-90.99"/>
<polygon fill="black" stroke="black" points="333025.69,-94.47 333035.41,-90.25 333025.18,-87.49 333025.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2250" class="edge">
<title>layer_11_expert_3_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M332852.83,-173.82C332918.06,-157.72 332992.72,-139.29 333059.27,-122.86"/>
<polygon fill="black" stroke="black" points="333060.15,-126.24 333069.02,-120.45 333058.48,-119.45 333060.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2251" class="edge">
<title>layer_11_expert_4_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M333245,-164.64C333245,-156.08 333245,-147.12 333245,-138.34"/>
<polygon fill="black" stroke="black" points="333248.5,-138.15 333245,-128.15 333241.5,-138.15 333248.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2252" class="edge">
<title>layer_11_expert_5_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M333601.16,-164.93C333555.62,-153.69 333507.27,-141.75 333461.37,-130.42"/>
<polygon fill="black" stroke="black" points="333462.16,-127.01 333451.61,-128.01 333460.48,-133.81 333462.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2253" class="edge">
<title>layer_11_expert_6_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M334137.92,-164.97C334121.74,-162.07 334105.65,-159.38 334090,-157 333892.52,-127.02 333667.26,-106.36 333499.01,-93.55"/>
<polygon fill="black" stroke="black" points="333499.26,-90.06 333489.02,-92.8 333498.73,-97.04 333499.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_2&#45;&gt;layer_11_agg_ep_2 -->
<g id="edge2254" class="edge">
<title>layer_11_expert_7_ep_2&#45;&gt;layer_11_agg_ep_2</title>
<path fill="none" stroke="black" d="M334704.84,-164.94C334687.35,-161.94 334669.92,-159.24 334653,-157 334244.97,-102.88 333765.66,-85.34 333484.64,-79.68"/>
<polygon fill="black" stroke="black" points="333484.38,-76.17 333474.32,-79.47 333484.24,-83.17 333484.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_3 -->
<g id="node1228" class="node">
<title>layer_11_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="351544.07,-128 351093.77,-128 350977.93,-24 351428.23,-24 351544.07,-128"/>
<text text-anchor="middle" x="351261" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="351261" y="-79" font-family="Arial" font-size="10.00">GPU: 304&#45;319</text>
<text text-anchor="middle" x="351261" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="351261" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2256" class="edge">
<title>layer_11_expert_0_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M349181.37,-175.09C349217.1,-167.94 349254.63,-161.4 349290,-157 349620.43,-115.9 350586.09,-91.08 351031.31,-81.52"/>
<polygon fill="black" stroke="black" points="351031.48,-85.02 351041.4,-81.31 351031.33,-78.02 351031.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2257" class="edge">
<title>layer_11_expert_1_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M349744.8,-175.46C349780.41,-168.31 349817.79,-161.67 349853,-157 350264.77,-102.39 350749.14,-85.03 351029.05,-79.53"/>
<polygon fill="black" stroke="black" points="351029.4,-83.02 351039.33,-79.33 351029.26,-76.02 351029.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2258" class="edge">
<title>layer_11_expert_2_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M350308.7,-176.34C350344.07,-169.17 350381.13,-162.29 350416,-157 350627.23,-124.93 350870.24,-103.53 351041.27,-90.99"/>
<polygon fill="black" stroke="black" points="351041.69,-94.47 351051.41,-90.25 351041.18,-87.49 351041.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2259" class="edge">
<title>layer_11_expert_3_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M350868.83,-173.82C350934.06,-157.72 351008.72,-139.29 351075.27,-122.86"/>
<polygon fill="black" stroke="black" points="351076.15,-126.24 351085.02,-120.45 351074.48,-119.45 351076.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2260" class="edge">
<title>layer_11_expert_4_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M351261,-164.64C351261,-156.08 351261,-147.12 351261,-138.34"/>
<polygon fill="black" stroke="black" points="351264.5,-138.15 351261,-128.15 351257.5,-138.15 351264.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2261" class="edge">
<title>layer_11_expert_5_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M351617.16,-164.93C351571.62,-153.69 351523.27,-141.75 351477.37,-130.42"/>
<polygon fill="black" stroke="black" points="351478.16,-127.01 351467.61,-128.01 351476.48,-133.81 351478.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2262" class="edge">
<title>layer_11_expert_6_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M352153.92,-164.97C352137.74,-162.07 352121.65,-159.38 352106,-157 351908.52,-127.02 351683.26,-106.36 351515.01,-93.55"/>
<polygon fill="black" stroke="black" points="351515.26,-90.06 351505.02,-92.8 351514.73,-97.04 351515.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_3&#45;&gt;layer_11_agg_ep_3 -->
<g id="edge2263" class="edge">
<title>layer_11_expert_7_ep_3&#45;&gt;layer_11_agg_ep_3</title>
<path fill="none" stroke="black" d="M352720.84,-164.94C352703.35,-161.94 352685.92,-159.24 352669,-157 352260.97,-102.88 351781.66,-85.34 351500.64,-79.68"/>
<polygon fill="black" stroke="black" points="351500.38,-76.17 351490.32,-79.47 351500.24,-83.17 351500.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_4 -->
<g id="node1229" class="node">
<title>layer_11_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="356048.07,-128 355597.77,-128 355481.93,-24 355932.23,-24 356048.07,-128"/>
<text text-anchor="middle" x="355765" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="355765" y="-79" font-family="Arial" font-size="10.00">GPU: 320&#45;335</text>
<text text-anchor="middle" x="355765" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="355765" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2265" class="edge">
<title>layer_11_expert_0_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M353685.37,-175.09C353721.1,-167.94 353758.63,-161.4 353794,-157 354124.43,-115.9 355090.09,-91.08 355535.31,-81.52"/>
<polygon fill="black" stroke="black" points="355535.48,-85.02 355545.4,-81.31 355535.33,-78.02 355535.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2266" class="edge">
<title>layer_11_expert_1_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M354248.8,-175.46C354284.41,-168.31 354321.79,-161.67 354357,-157 354768.77,-102.39 355253.14,-85.03 355533.05,-79.53"/>
<polygon fill="black" stroke="black" points="355533.4,-83.02 355543.33,-79.33 355533.26,-76.02 355533.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2267" class="edge">
<title>layer_11_expert_2_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M354812.7,-176.34C354848.07,-169.17 354885.13,-162.29 354920,-157 355131.23,-124.93 355374.24,-103.53 355545.27,-90.99"/>
<polygon fill="black" stroke="black" points="355545.69,-94.47 355555.41,-90.25 355545.18,-87.49 355545.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2268" class="edge">
<title>layer_11_expert_3_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M355372.83,-173.82C355438.06,-157.72 355512.72,-139.29 355579.27,-122.86"/>
<polygon fill="black" stroke="black" points="355580.15,-126.24 355589.02,-120.45 355578.48,-119.45 355580.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2269" class="edge">
<title>layer_11_expert_4_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M355765,-164.64C355765,-156.08 355765,-147.12 355765,-138.34"/>
<polygon fill="black" stroke="black" points="355768.5,-138.15 355765,-128.15 355761.5,-138.15 355768.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2270" class="edge">
<title>layer_11_expert_5_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M356121.16,-164.93C356075.62,-153.69 356027.27,-141.75 355981.37,-130.42"/>
<polygon fill="black" stroke="black" points="355982.16,-127.01 355971.61,-128.01 355980.48,-133.81 355982.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2271" class="edge">
<title>layer_11_expert_6_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M356657.92,-164.97C356641.74,-162.07 356625.65,-159.38 356610,-157 356412.52,-127.02 356187.26,-106.36 356019.01,-93.55"/>
<polygon fill="black" stroke="black" points="356019.26,-90.06 356009.02,-92.8 356018.73,-97.04 356019.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_4&#45;&gt;layer_11_agg_ep_4 -->
<g id="edge2272" class="edge">
<title>layer_11_expert_7_ep_4&#45;&gt;layer_11_agg_ep_4</title>
<path fill="none" stroke="black" d="M357224.84,-164.94C357207.35,-161.94 357189.92,-159.24 357173,-157 356764.97,-102.88 356285.66,-85.34 356004.64,-79.68"/>
<polygon fill="black" stroke="black" points="356004.38,-76.17 355994.32,-79.47 356004.24,-83.17 356004.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_5 -->
<g id="node1230" class="node">
<title>layer_11_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="360552.07,-128 360101.77,-128 359985.93,-24 360436.23,-24 360552.07,-128"/>
<text text-anchor="middle" x="360269" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="360269" y="-79" font-family="Arial" font-size="10.00">GPU: 336&#45;351</text>
<text text-anchor="middle" x="360269" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="360269" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2274" class="edge">
<title>layer_11_expert_0_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M358189.37,-175.09C358225.1,-167.94 358262.63,-161.4 358298,-157 358628.43,-115.9 359594.09,-91.08 360039.31,-81.52"/>
<polygon fill="black" stroke="black" points="360039.48,-85.02 360049.4,-81.31 360039.33,-78.02 360039.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2275" class="edge">
<title>layer_11_expert_1_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M358752.8,-175.46C358788.41,-168.31 358825.79,-161.67 358861,-157 359272.77,-102.39 359757.14,-85.03 360037.05,-79.53"/>
<polygon fill="black" stroke="black" points="360037.4,-83.02 360047.33,-79.33 360037.26,-76.02 360037.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2276" class="edge">
<title>layer_11_expert_2_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M359316.7,-176.34C359352.07,-169.17 359389.13,-162.29 359424,-157 359635.23,-124.93 359878.24,-103.53 360049.27,-90.99"/>
<polygon fill="black" stroke="black" points="360049.69,-94.47 360059.41,-90.25 360049.18,-87.49 360049.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2277" class="edge">
<title>layer_11_expert_3_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M359876.83,-173.82C359942.06,-157.72 360016.72,-139.29 360083.27,-122.86"/>
<polygon fill="black" stroke="black" points="360084.15,-126.24 360093.02,-120.45 360082.48,-119.45 360084.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2278" class="edge">
<title>layer_11_expert_4_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M360269,-164.64C360269,-156.08 360269,-147.12 360269,-138.34"/>
<polygon fill="black" stroke="black" points="360272.5,-138.15 360269,-128.15 360265.5,-138.15 360272.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2279" class="edge">
<title>layer_11_expert_5_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M360625.16,-164.93C360579.62,-153.69 360531.27,-141.75 360485.37,-130.42"/>
<polygon fill="black" stroke="black" points="360486.16,-127.01 360475.61,-128.01 360484.48,-133.81 360486.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2280" class="edge">
<title>layer_11_expert_6_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M361161.92,-164.97C361145.74,-162.07 361129.65,-159.38 361114,-157 360916.52,-127.02 360691.26,-106.36 360523.01,-93.55"/>
<polygon fill="black" stroke="black" points="360523.26,-90.06 360513.02,-92.8 360522.73,-97.04 360523.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_5&#45;&gt;layer_11_agg_ep_5 -->
<g id="edge2281" class="edge">
<title>layer_11_expert_7_ep_5&#45;&gt;layer_11_agg_ep_5</title>
<path fill="none" stroke="black" d="M361728.84,-164.94C361711.35,-161.94 361693.92,-159.24 361677,-157 361268.97,-102.88 360789.66,-85.34 360508.64,-79.68"/>
<polygon fill="black" stroke="black" points="360508.38,-76.17 360498.32,-79.47 360508.24,-83.17 360508.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_6 -->
<g id="node1231" class="node">
<title>layer_11_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="329024.07,-128 328573.77,-128 328457.93,-24 328908.23,-24 329024.07,-128"/>
<text text-anchor="middle" x="328741" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="328741" y="-79" font-family="Arial" font-size="10.00">GPU: 352&#45;367</text>
<text text-anchor="middle" x="328741" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="328741" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2283" class="edge">
<title>layer_11_expert_0_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M326661.37,-175.09C326697.1,-167.94 326734.63,-161.4 326770,-157 327100.43,-115.9 328066.09,-91.08 328511.31,-81.52"/>
<polygon fill="black" stroke="black" points="328511.48,-85.02 328521.4,-81.31 328511.33,-78.02 328511.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2284" class="edge">
<title>layer_11_expert_1_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M327224.8,-175.46C327260.41,-168.31 327297.79,-161.67 327333,-157 327744.77,-102.39 328229.14,-85.03 328509.05,-79.53"/>
<polygon fill="black" stroke="black" points="328509.4,-83.02 328519.33,-79.33 328509.26,-76.02 328509.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2285" class="edge">
<title>layer_11_expert_2_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M327788.7,-176.34C327824.07,-169.17 327861.13,-162.29 327896,-157 328107.23,-124.93 328350.24,-103.53 328521.27,-90.99"/>
<polygon fill="black" stroke="black" points="328521.69,-94.47 328531.41,-90.25 328521.18,-87.49 328521.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2286" class="edge">
<title>layer_11_expert_3_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M328348.83,-173.82C328414.06,-157.72 328488.72,-139.29 328555.27,-122.86"/>
<polygon fill="black" stroke="black" points="328556.15,-126.24 328565.02,-120.45 328554.48,-119.45 328556.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2287" class="edge">
<title>layer_11_expert_4_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M328741,-164.64C328741,-156.08 328741,-147.12 328741,-138.34"/>
<polygon fill="black" stroke="black" points="328744.5,-138.15 328741,-128.15 328737.5,-138.15 328744.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2288" class="edge">
<title>layer_11_expert_5_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M329097.16,-164.93C329051.62,-153.69 329003.27,-141.75 328957.37,-130.42"/>
<polygon fill="black" stroke="black" points="328958.16,-127.01 328947.61,-128.01 328956.48,-133.81 328958.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2289" class="edge">
<title>layer_11_expert_6_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M329633.92,-164.97C329617.74,-162.07 329601.65,-159.38 329586,-157 329388.52,-127.02 329163.26,-106.36 328995.01,-93.55"/>
<polygon fill="black" stroke="black" points="328995.26,-90.06 328985.02,-92.8 328994.73,-97.04 328995.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_6&#45;&gt;layer_11_agg_ep_6 -->
<g id="edge2290" class="edge">
<title>layer_11_expert_7_ep_6&#45;&gt;layer_11_agg_ep_6</title>
<path fill="none" stroke="black" d="M330200.84,-164.94C330183.35,-161.94 330165.92,-159.24 330149,-157 329740.97,-102.88 329261.66,-85.34 328980.64,-79.68"/>
<polygon fill="black" stroke="black" points="328980.38,-76.17 328970.32,-79.47 328980.24,-83.17 328980.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_7 -->
<g id="node1232" class="node">
<title>layer_11_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="338032.07,-128 337581.77,-128 337465.93,-24 337916.23,-24 338032.07,-128"/>
<text text-anchor="middle" x="337749" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="337749" y="-79" font-family="Arial" font-size="10.00">GPU: 368&#45;383</text>
<text text-anchor="middle" x="337749" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="337749" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_expert_0_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2292" class="edge">
<title>layer_11_expert_0_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M335669.37,-175.09C335705.1,-167.94 335742.63,-161.4 335778,-157 336108.43,-115.9 337074.09,-91.08 337519.31,-81.52"/>
<polygon fill="black" stroke="black" points="337519.48,-85.02 337529.4,-81.31 337519.33,-78.02 337519.48,-85.02"/>
</g>
<!-- layer_11_expert_1_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2293" class="edge">
<title>layer_11_expert_1_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M336232.8,-175.46C336268.41,-168.31 336305.79,-161.67 336341,-157 336752.77,-102.39 337237.14,-85.03 337517.05,-79.53"/>
<polygon fill="black" stroke="black" points="337517.4,-83.02 337527.33,-79.33 337517.26,-76.02 337517.4,-83.02"/>
</g>
<!-- layer_11_expert_2_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2294" class="edge">
<title>layer_11_expert_2_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M336796.7,-176.34C336832.07,-169.17 336869.13,-162.29 336904,-157 337115.23,-124.93 337358.24,-103.53 337529.27,-90.99"/>
<polygon fill="black" stroke="black" points="337529.69,-94.47 337539.41,-90.25 337529.18,-87.49 337529.69,-94.47"/>
</g>
<!-- layer_11_expert_3_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2295" class="edge">
<title>layer_11_expert_3_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M337356.83,-173.82C337422.06,-157.72 337496.72,-139.29 337563.27,-122.86"/>
<polygon fill="black" stroke="black" points="337564.15,-126.24 337573.02,-120.45 337562.48,-119.45 337564.15,-126.24"/>
</g>
<!-- layer_11_expert_4_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2296" class="edge">
<title>layer_11_expert_4_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M337749,-164.64C337749,-156.08 337749,-147.12 337749,-138.34"/>
<polygon fill="black" stroke="black" points="337752.5,-138.15 337749,-128.15 337745.5,-138.15 337752.5,-138.15"/>
</g>
<!-- layer_11_expert_5_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2297" class="edge">
<title>layer_11_expert_5_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M338105.16,-164.93C338059.62,-153.69 338011.27,-141.75 337965.37,-130.42"/>
<polygon fill="black" stroke="black" points="337966.16,-127.01 337955.61,-128.01 337964.48,-133.81 337966.16,-127.01"/>
</g>
<!-- layer_11_expert_6_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2298" class="edge">
<title>layer_11_expert_6_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M338641.92,-164.97C338625.74,-162.07 338609.65,-159.38 338594,-157 338396.52,-127.02 338171.26,-106.36 338003.01,-93.55"/>
<polygon fill="black" stroke="black" points="338003.26,-90.06 337993.02,-92.8 338002.73,-97.04 338003.26,-90.06"/>
</g>
<!-- layer_11_expert_7_ep_7&#45;&gt;layer_11_agg_ep_7 -->
<g id="edge2299" class="edge">
<title>layer_11_expert_7_ep_7&#45;&gt;layer_11_agg_ep_7</title>
<path fill="none" stroke="black" d="M339208.84,-164.94C339191.35,-161.94 339173.92,-159.24 339157,-157 338748.97,-102.88 338269.66,-85.34 337988.64,-79.68"/>
<polygon fill="black" stroke="black" points="337988.38,-76.17 337978.32,-79.47 337988.24,-83.17 337988.38,-76.17"/>
</g>
<!-- layer_11_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2237" class="edge">
<title>layer_11_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M346987.57,-80.75C347622.41,-90.88 349449.75,-118.62 350969,-128 353132.51,-141.36 426693.44,-146.6 428857,-147 463506.33,-153.45 472168.67,-140.62 506818,-157 537943.56,-171.71 576615.74,-213.38 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_11_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2246" class="edge">
<title>layer_11_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M342483.57,-80.75C343118.41,-90.87 344945.75,-118.61 346465,-128 348421.88,-140.1 414957.08,-145.45 416914,-146 418342.89,-146.4 418700.11,-146.7 420129,-147 458657.44,-155.21 468289.56,-139.04 506818,-157 537943.56,-171.51 576615.74,-213.37 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_11_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2255" class="edge">
<title>layer_11_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M333475.57,-80.75C334110.41,-90.88 335937.75,-118.62 337457,-128 339647.54,-141.53 414127.42,-146.62 416318,-147 456540.22,-154.07 466595.78,-138.35 506818,-157 537943.56,-171.44 576615.74,-213.36 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_11_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2264" class="edge">
<title>layer_11_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M351491.57,-80.75C352126.41,-90.88 353953.75,-118.64 355473,-128 357879.93,-142.84 439717.03,-146.55 442124,-147 470876.89,-152.37 478065.11,-143.03 506818,-157 537943.56,-172.12 576615.74,-213.41 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_11_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2273" class="edge">
<title>layer_11_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M355995.57,-80.76C356630.41,-90.89 358457.75,-118.65 359977,-128 360996.71,-134.27 505798.27,-156.48 506818,-157 537943.56,-172.79 576615.74,-213.45 578920.78,-215.89"/>
<polygon fill="black" stroke="black" points="578921.09,-219.39 578931.1,-215.9 578921.1,-212.39 578921.09,-219.39"/>
</g>
<!-- layer_11_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2282" class="edge">
<title>layer_11_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M360495.77,-77.18C364592.95,-80.33 423399.15,-125.42 470779,-147 486796.33,-154.3 490800.67,-148.23 506818,-157 537945.51,-174.03 576620.6,-213.53 578921.22,-215.89"/>
<polygon fill="black" stroke="black" points="578921.51,-219.39 578931.51,-215.9 578921.51,-212.39 578921.51,-219.39"/>
</g>
<!-- layer_11_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2291" class="edge">
<title>layer_11_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M328971.57,-80.75C329606.41,-90.87 331433.75,-118.6 332953,-128 341059.29,-178.13 397804.56,-145.54 405911,-147 428334.78,-151.03 484394.22,-146.73 506818,-157 537943.56,-171.26 576615.74,-213.35 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_11_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2300" class="edge">
<title>layer_11_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M337979.57,-80.75C338614.41,-90.88 340441.75,-118.62 341961,-128 346091.87,-153.51 412187.06,-142.03 416318,-146 416582.89,-146.25 416649.11,-146.76 416914,-147 436892.66,-164.87 486839.34,-147.73 506818,-157 537943.56,-171.45 576615.74,-213.37 578920.78,-215.88"/>
<polygon fill="black" stroke="black" points="578921.09,-219.38 578931.1,-215.89 578921.1,-212.38 578921.09,-219.38"/>
</g>
<!-- layer_11_moe_alltoall -->
<g id="node1233" class="node">
<title>layer_11_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="348685" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="348685" y="-521" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="348685" y="-510" font-family="Arial" font-size="10.00">GPUs: 256&#45;383</text>
<text text-anchor="middle" x="348685" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="348685" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_11_ln_tp_0 -->
<g id="node1234" class="node">
<title>layer_11_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="360479.07,-559 360028.77,-559 359912.93,-455 360363.23,-455 360479.07,-559"/>
<text text-anchor="middle" x="360196" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="360196" y="-510" font-family="Arial" font-size="10.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="360196" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="360196" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_qkv_tp_0 -->
<g id="node1238" class="node">
<title>layer_12_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="577161.7,-1069 576719.94,-1069 576606.3,-965 577048.06,-965 577161.7,-1069"/>
<text text-anchor="middle" x="576884" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="576884" y="-1020" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="576884" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="576884" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_11_ln_tp_0&#45;&gt;layer_12_qkv_tp_0 -->
<g id="edge3121" class="edge">
<title>layer_11_ln_tp_0&#45;&gt;layer_12_qkv_tp_0</title>
<path fill="none" stroke="black" d="M360347.77,-559.1C360392.42,-571.81 360441.71,-583.62 360488,-590 360488,-590 580646,-598 580646,-598 580715.86,-600 580733.19,-603.65 580803,-607 580828.82,-608.24 581246.73,-610.31 581268,-625 581335.52,-671.63 581323.67,-714.59 581340,-795 581351.94,-853.8 581376.18,-882.14 581340,-930 581323.28,-952.11 581307.45,-943.15 581280,-947 581166.97,-962.84 577284.54,-945.31 577171,-957 577137.61,-960.44 577102.37,-966.02 577068.44,-972.42"/>
<polygon fill="black" stroke="black" points="577067.6,-969.02 577058.44,-974.34 577068.92,-975.89 577067.6,-969.02"/>
</g>
<!-- layer_11_ln_tp_1 -->
<g id="node1235" class="node">
<title>layer_11_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="361063.07,-559 360612.77,-559 360496.93,-455 360947.23,-455 361063.07,-559"/>
<text text-anchor="middle" x="360780" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="360780" y="-510" font-family="Arial" font-size="10.00">GPU: 288&#45;319</text>
<text text-anchor="middle" x="360780" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="360780" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_qkv_tp_1 -->
<g id="node1239" class="node">
<title>layer_12_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="577735.7,-1069 577293.94,-1069 577180.3,-965 577622.06,-965 577735.7,-1069"/>
<text text-anchor="middle" x="577458" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="577458" y="-1020" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="577458" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="577458" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_11_ln_tp_1&#45;&gt;layer_12_qkv_tp_1 -->
<g id="edge3122" class="edge">
<title>layer_11_ln_tp_1&#45;&gt;layer_12_qkv_tp_1</title>
<path fill="none" stroke="black" d="M360931.77,-559.1C360976.42,-571.81 361025.71,-583.62 361072,-590 361072,-590 580803,-598 580803,-598 580869.76,-600 580886.3,-603.51 580953,-607 580997.76,-609.34 581317.82,-601.52 581356,-625 581414.65,-661.07 581374.36,-722.33 581432,-760 581446.96,-769.77 581494.25,-765.97 581512,-768 581605.49,-778.68 581639.76,-749.27 581722,-795 581789.64,-832.61 581763.37,-894.22 581832,-930 581853.34,-941.12 581923.62,-920.37 581940,-938 581942.72,-940.93 581942.83,-944.17 581940,-947 581929.71,-957.31 577759.49,-955.51 577745,-957 577711.61,-960.44 577676.37,-966.02 577642.44,-972.42"/>
<polygon fill="black" stroke="black" points="577641.6,-969.02 577632.44,-974.34 577642.92,-975.89 577641.6,-969.02"/>
</g>
<!-- layer_11_ln_tp_2 -->
<g id="node1236" class="node">
<title>layer_11_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="361647.07,-559 361196.77,-559 361080.93,-455 361531.23,-455 361647.07,-559"/>
<text text-anchor="middle" x="361364" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="361364" y="-510" font-family="Arial" font-size="10.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="361364" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="361364" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_qkv_tp_2 -->
<g id="node1240" class="node">
<title>layer_12_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="578309.7,-1069 577867.94,-1069 577754.3,-965 578196.06,-965 578309.7,-1069"/>
<text text-anchor="middle" x="578032" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="578032" y="-1020" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="578032" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="578032" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_11_ln_tp_2&#45;&gt;layer_12_qkv_tp_2 -->
<g id="edge3123" class="edge">
<title>layer_11_ln_tp_2&#45;&gt;layer_12_qkv_tp_2</title>
<path fill="none" stroke="black" d="M361515.77,-559.1C361560.42,-571.81 361609.71,-583.62 361656,-590 361656,-590 580953,-598 580953,-598 581166.14,-604.01 581224.34,-576.58 581432,-625 581620.12,-668.87 581656.09,-715.18 581832,-795 581965.05,-855.37 582050.35,-814.24 582128,-938 582130.13,-941.39 582130.82,-944.17 582128,-947 582118.66,-956.36 578332.16,-955.64 578319,-957 578285.61,-960.44 578250.37,-966.03 578216.44,-972.43"/>
<polygon fill="black" stroke="black" points="578215.6,-969.02 578206.44,-974.34 578216.92,-975.9 578215.6,-969.02"/>
</g>
<!-- layer_11_ln_tp_3 -->
<g id="node1237" class="node">
<title>layer_11_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="362231.07,-559 361780.77,-559 361664.93,-455 362115.23,-455 362231.07,-559"/>
<text text-anchor="middle" x="361948" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="361948" y="-510" font-family="Arial" font-size="10.00">GPU: 352&#45;383</text>
<text text-anchor="middle" x="361948" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="361948" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_qkv_tp_3 -->
<g id="node1241" class="node">
<title>layer_12_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="578883.7,-1069 578441.94,-1069 578328.3,-965 578770.06,-965 578883.7,-1069"/>
<text text-anchor="middle" x="578606" y="-1031" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="578606" y="-1020" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="578606" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="578606" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_11_ln_tp_3&#45;&gt;layer_12_qkv_tp_3 -->
<g id="edge3124" class="edge">
<title>layer_11_ln_tp_3&#45;&gt;layer_12_qkv_tp_3</title>
<path fill="none" stroke="black" d="M362101.36,-559.1C362146.47,-571.81 362196.26,-583.62 362243,-590 362243,-590 581345,-598 581345,-598 581561.69,-604.01 581622.25,-570.24 581832,-625 582297.69,-746.59 582115.15,-707.08 582156,-795 582184.47,-856.26 582203.7,-899.16 582156,-947 582148.03,-955 578915.24,-955.88 578904,-957 578867.39,-960.65 578828.6,-966.69 578791.54,-973.55"/>
<polygon fill="black" stroke="black" points="578790.83,-970.12 578781.65,-975.4 578792.12,-977 578790.83,-970.12"/>
</g>
<!-- layer_12_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2309" class="edge">
<title>layer_12_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M577058.43,-974.33C577095.39,-967.14 577134.31,-960.77 577171,-957 577204.57,-953.55 582000.06,-962.55 582030,-947 582157.62,-880.7 582133.03,-750.05 582062,-625 581926.5,-386.45 581751.24,-435.51 581477,-428 580721,-407.3 146614.62,-441.7 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_12_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2310" class="edge">
<title>layer_12_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M577632.44,-974.34C577669.39,-967.15 577708.31,-960.78 577745,-957 577861.33,-945.03 581838.22,-953.21 581955,-947 582095.63,-939.52 582256,-988.83 582256,-848 582256,-848 582256,-848 582256,-506 582256,-371.1 581788.83,-432.17 581654,-428 580897.77,-404.61 146614.92,-441.72 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_12_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2311" class="edge">
<title>layer_12_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M578206.44,-974.34C578243.39,-967.15 578282.31,-960.78 578319,-957 578527.34,-935.53 581879.85,-958.09 582089,-947 582125.59,-945.06 582227,-955.81 582253,-930 582327.97,-855.58 582347.41,-528.83 582270,-447 582217.69,-391.7 582004.09,-430.11 581928,-428 581171.23,-406.98 146615.4,-441.74 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_12_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2312" class="edge">
<title>layer_12_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M578781.65,-975.4C578821.65,-967.79 578864.11,-960.97 578904,-957 579084.77,-939 581992.81,-960.16 582174,-947 582339.08,-935.01 582533,-1013.51 582533,-848 582533,-848 582533,-848 582533,-506 582533,-409.54 582202.35,-432.55 582106,-428 581349.47,-392.31 146615.71,-441.75 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_12_qkv_comm -->
<g id="node1242" class="node">
<title>layer_12_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="576395" cy="-1017" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="576395" y="-1031" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="576395" y="-1020" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="576395" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="576395" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_12_attn_tp_0 -->
<g id="node1243" class="node">
<title>layer_12_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="571714.7,-1069 571272.94,-1069 571159.3,-965 571601.06,-965 571714.7,-1069"/>
<text text-anchor="middle" x="571437" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="571437" y="-1020" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="571437" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="571437" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_out_tp_0 -->
<g id="node1247" class="node">
<title>layer_12_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="576661.7,-899 576219.94,-899 576106.3,-795 576548.06,-795 576661.7,-899"/>
<text text-anchor="middle" x="576384" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="576384" y="-850" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="576384" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="576384" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_tp_0&#45;&gt;layer_12_attn_out_tp_0 -->
<g id="edge2317" class="edge">
<title>layer_12_attn_tp_0&#45;&gt;layer_12_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M571612.3,-975.07C571649.02,-967.87 571687.63,-961.32 571724,-957 571973.5,-927.38 572037.79,-942.53 572289,-938 572471.08,-934.72 575385.13,-939.33 575567,-930 575776.69,-919.25 576015.54,-893.72 576180.59,-873.98"/>
<polygon fill="black" stroke="black" points="576181.34,-877.42 576190.85,-872.75 576180.51,-870.47 576181.34,-877.42"/>
</g>
<!-- layer_12_attn_tp_1 -->
<g id="node1244" class="node">
<title>layer_12_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="572288.7,-1069 571846.94,-1069 571733.3,-965 572175.06,-965 572288.7,-1069"/>
<text text-anchor="middle" x="572011" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="572011" y="-1020" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="572011" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="572011" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_out_tp_1 -->
<g id="node1248" class="node">
<title>layer_12_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="577500.7,-899 577058.94,-899 576945.3,-795 577387.06,-795 577500.7,-899"/>
<text text-anchor="middle" x="577223" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="577223" y="-850" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="577223" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="577223" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_tp_1&#45;&gt;layer_12_attn_out_tp_1 -->
<g id="edge2319" class="edge">
<title>layer_12_attn_tp_1&#45;&gt;layer_12_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M572186.3,-975.07C572223.02,-967.87 572261.63,-961.32 572298,-957 572547.5,-927.38 572611.79,-942.49 572863,-938 572968.76,-936.11 576565.52,-937.9 576671,-930 576790.92,-921.01 576924.32,-901.47 577029.93,-883.71"/>
<polygon fill="black" stroke="black" points="577030.79,-887.11 577040.06,-882 577029.62,-880.21 577030.79,-887.11"/>
</g>
<!-- layer_12_attn_tp_2 -->
<g id="node1245" class="node">
<title>layer_12_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="572862.7,-1069 572420.94,-1069 572307.3,-965 572749.06,-965 572862.7,-1069"/>
<text text-anchor="middle" x="572585" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="572585" y="-1020" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="572585" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="572585" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_out_tp_2 -->
<g id="node1249" class="node">
<title>layer_12_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="578206.7,-899 577764.94,-899 577651.3,-795 578093.06,-795 578206.7,-899"/>
<text text-anchor="middle" x="577929" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="577929" y="-850" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="577929" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="577929" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_tp_2&#45;&gt;layer_12_attn_out_tp_2 -->
<g id="edge2321" class="edge">
<title>layer_12_attn_tp_2&#45;&gt;layer_12_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M572759.45,-974.45C572796.4,-967.25 572835.32,-960.85 572872,-957 573202.08,-922.36 575527.11,-939.86 575859,-938 575950.72,-937.49 577418.73,-939.07 577510,-930 577587.49,-922.3 577671.95,-907.11 577744.6,-891.87"/>
<polygon fill="black" stroke="black" points="577745.71,-895.22 577754.77,-889.72 577744.26,-888.37 577745.71,-895.22"/>
</g>
<!-- layer_12_attn_tp_3 -->
<g id="node1246" class="node">
<title>layer_12_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="573436.7,-1069 572994.94,-1069 572881.3,-965 573323.06,-965 573436.7,-1069"/>
<text text-anchor="middle" x="573159" y="-1031" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="573159" y="-1020" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="573159" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="573159" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_out_tp_3 -->
<g id="node1250" class="node">
<title>layer_12_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="578846.7,-899 578404.94,-899 578291.3,-795 578733.06,-795 578846.7,-899"/>
<text text-anchor="middle" x="578569" y="-861" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="578569" y="-850" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="578569" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="578569" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_12_attn_tp_3&#45;&gt;layer_12_attn_out_tp_3 -->
<g id="edge2323" class="edge">
<title>layer_12_attn_tp_3&#45;&gt;layer_12_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M573333.59,-974.28C573370.19,-967.14 573408.7,-960.81 573445,-957 573576.81,-943.17 578084.38,-945.46 578216,-930 578273.47,-923.25 578335.22,-910.76 578390.74,-897.53"/>
<polygon fill="black" stroke="black" points="578391.77,-900.89 578400.67,-895.15 578390.13,-894.08 578391.77,-900.89"/>
</g>
<!-- layer_12_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2318" class="edge">
<title>layer_12_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M576141.09,-826.91C575978.69,-815.12 575760.18,-801.1 575567,-795 573760.68,-737.93 544844.22,-768.77 543037,-768 543037,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_12_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2320" class="edge">
<title>layer_12_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M576970.17,-817.79C576876.34,-808.6 576768.94,-799.59 576671,-795 575646.73,-747.03 559239.39,-768.76 558214,-768 558214,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_12_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2322" class="edge">
<title>layer_12_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M577666.81,-809.24C577614.95,-803.34 577560.83,-798.15 577510,-795 576909.59,-757.84 567283.56,-768.76 566682,-768 566682,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_12_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2324" class="edge">
<title>layer_12_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M578300.08,-803.19C578271.75,-799.86 578243.33,-797.02 578216,-795 577455.4,-738.84 572114.67,-769.51 571352,-768 571352,-768 145859,-760 145859,-760 145640.5,-748.07 145387.74,-716.72 145238.79,-696.42"/>
<polygon fill="black" stroke="black" points="145239.07,-692.93 145228.69,-695.04 145238.13,-699.86 145239.07,-692.93"/>
</g>
<!-- layer_12_attn_allreduce -->
<g id="node1251" class="node">
<title>layer_12_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="573651" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="573651" y="-1031" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="573651" y="-1020" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="573651" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="573651" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_gate_tp_0 -->
<g id="node1252" class="node">
<title>layer_12_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="562901.99,-1069 562453.4,-1069 562338.01,-965 562786.6,-965 562901.99,-1069"/>
<text text-anchor="middle" x="562620" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="562620" y="-1020" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="562620" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="562620" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_12_route_ep_0 -->
<g id="node1256" class="node">
<title>layer_12_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="546457.43,-899 545998.6,-899 545880.57,-795 546339.4,-795 546457.43,-899"/>
<text text-anchor="middle" x="546169" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="546169" y="-850" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="546169" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="546169" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_0 -->
<g id="edge2325" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562389.92,-965C562369.4,-961.77 562348.87,-959.01 562329,-957 562257.75,-949.78 557244.61,-947.22 557173,-947 556228.55,-944.08 555992.45,-940.81 555048,-938 554009.78,-934.91 551414.17,-941.01 550376,-930 548872.48,-914.06 547067.12,-870.75 546417.2,-854.38"/>
<polygon fill="black" stroke="black" points="546416.86,-850.87 546406.77,-854.12 546416.68,-857.87 546416.86,-850.87"/>
<text text-anchor="middle" x="557199" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_1 -->
<g id="node1257" class="node">
<title>layer_12_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="566676.43,-899 566217.6,-899 566099.57,-795 566558.4,-795 566676.43,-899"/>
<text text-anchor="middle" x="566388" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="566388" y="-850" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="566388" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="566388" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_1 -->
<g id="edge2326" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562797.29,-974.41C562834.64,-967.24 562873.96,-960.86 562911,-957 563055,-941.99 564069.27,-950.85 564214,-947 564926.41,-928.05 565769.25,-883.28 566163.55,-861.03"/>
<polygon fill="black" stroke="black" points="566163.85,-864.51 566173.64,-860.45 566163.46,-857.52 566163.85,-864.51"/>
<text text-anchor="middle" x="564475" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_2 -->
<g id="node1258" class="node">
<title>layer_12_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="550961.43,-899 550502.6,-899 550384.57,-795 550843.4,-795 550961.43,-899"/>
<text text-anchor="middle" x="550673" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="550673" y="-850" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="550673" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="550673" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_2 -->
<g id="edge2327" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562389.52,-964.97C562369.13,-961.76 562348.74,-959.02 562329,-957 562248.92,-948.82 559511.49,-948.41 559431,-947 559303.85,-944.78 559272.16,-940.12 559145,-938 558197.35,-922.2 555827.73,-940.12 554880,-930 553376.26,-913.94 551570.57,-870.68 550920.91,-854.36"/>
<polygon fill="black" stroke="black" points="550920.57,-850.85 550910.48,-854.09 550920.39,-857.84 550920.57,-850.85"/>
<text text-anchor="middle" x="559457" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_3 -->
<g id="node1259" class="node">
<title>layer_12_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="563347.43,-899 562888.6,-899 562770.57,-795 563229.4,-795 563347.43,-899"/>
<text text-anchor="middle" x="563059" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="563059" y="-850" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="563059" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="563059" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_3 -->
<g id="edge2328" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562800.49,-977.43C562836.99,-970.19 562875.16,-963.02 562911,-957 562944.16,-951.43 562957.05,-964.12 562986,-947 563002.21,-937.42 563015.91,-922.69 563026.91,-907.5"/>
<polygon fill="black" stroke="black" points="563029.95,-909.26 563032.74,-899.05 563024.18,-905.29 563029.95,-909.26"/>
<text text-anchor="middle" x="563022" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_4 -->
<g id="node1260" class="node">
<title>layer_12_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="560024.43,-899 559565.6,-899 559447.57,-795 559906.4,-795 560024.43,-899"/>
<text text-anchor="middle" x="559736" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="559736" y="-850" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="559736" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="559736" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_4 -->
<g id="edge2329" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562545.38,-964.93C562525.88,-954.04 562504.34,-944.02 562483,-938 562245.95,-871.08 560604.27,-853.56 559978,-849.29"/>
<polygon fill="black" stroke="black" points="559977.97,-845.79 559967.94,-849.22 559977.92,-852.79 559977.97,-845.79"/>
<text text-anchor="middle" x="562533" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_5 -->
<g id="node1261" class="node">
<title>layer_12_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="555465.43,-899 555006.6,-899 554888.57,-795 555347.4,-795 555465.43,-899"/>
<text text-anchor="middle" x="555177" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="555177" y="-850" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="555177" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="555177" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_5 -->
<g id="edge2330" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562388.71,-964.95C562368.59,-961.77 562348.48,-959.04 562329,-957 562198.71,-943.37 561281,-948.21 561150,-947 560389.55,-940 560199.4,-941.09 559439,-930 557912.32,-907.73 556078.26,-868.1 555423.81,-853.55"/>
<polygon fill="black" stroke="black" points="555423.86,-850.05 555413.79,-853.33 555423.71,-857.05 555423.86,-850.05"/>
<text text-anchor="middle" x="561176" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_6 -->
<g id="node1262" class="node">
<title>layer_12_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="575558.43,-899 575099.6,-899 574981.57,-795 575440.4,-795 575558.43,-899"/>
<text text-anchor="middle" x="575270" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="575270" y="-850" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="575270" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="575270" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_6 -->
<g id="edge2331" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562797.28,-974.26C562834.63,-967.1 562873.95,-960.76 562911,-957 563025.63,-945.36 566943.78,-947.43 567059,-947 567852.78,-944.04 568051.22,-941.25 568845,-938 569978.33,-933.37 570261.74,-943.77 571395,-930 572777.67,-913.2 574437.43,-870.54 575038.5,-854.35"/>
<polygon fill="black" stroke="black" points="575038.68,-857.85 575048.58,-854.08 575038.49,-850.85 575038.68,-857.85"/>
<text text-anchor="middle" x="568871" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_route_ep_7 -->
<g id="node1263" class="node">
<title>layer_12_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="571386.43,-899 570927.6,-899 570809.57,-795 571268.4,-795 571386.43,-899"/>
<text text-anchor="middle" x="571098" y="-861" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="571098" y="-850" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="571098" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="571098" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_7 -->
<g id="edge2332" class="edge">
<title>layer_12_gate_tp_0&#45;&gt;layer_12_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562797.29,-974.34C562834.64,-967.17 562873.95,-960.81 562911,-957 563020.92,-945.69 564790.79,-963.84 564900,-947 564913.34,-944.94 564915.66,-940.05 564929,-938 564977.21,-930.58 566636.22,-930.56 566685,-930 568284.16,-911.5 570208.94,-868.66 570865.54,-853.47"/>
<polygon fill="black" stroke="black" points="570865.67,-856.97 570875.59,-853.24 570865.51,-849.97 570865.67,-856.97"/>
<text text-anchor="middle" x="564955" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1 -->
<g id="node1253" class="node">
<title>layer_12_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="563483.99,-1069 563035.4,-1069 562920.01,-965 563368.6,-965 563483.99,-1069"/>
<text text-anchor="middle" x="563202" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="563202" y="-1020" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="563202" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="563202" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_0 -->
<g id="edge2333" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562971.92,-964.99C562951.4,-961.77 562930.87,-959.01 562911,-957 562757.78,-941.48 557520.92,-952.01 557367,-947 557303.8,-944.94 557288.2,-940.04 557225,-938 556844.7,-925.74 550756.48,-933.93 550376,-930 548872.48,-914.47 547067.12,-870.91 546417.2,-854.43"/>
<polygon fill="black" stroke="black" points="546416.86,-850.92 546406.77,-854.16 546416.68,-857.91 546416.86,-850.92"/>
<text text-anchor="middle" x="557393" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_1 -->
<g id="edge2334" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563379.3,-974.45C563416.65,-967.28 563455.96,-960.89 563493,-957 563615.44,-944.15 564477.95,-950.96 564601,-947 565165.17,-928.84 565828.51,-886.6 566166.18,-863.6"/>
<polygon fill="black" stroke="black" points="566166.59,-867.08 566176.32,-862.91 566166.11,-860.1 566166.59,-867.08"/>
<text text-anchor="middle" x="564870" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_2 -->
<g id="edge2335" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562971.52,-964.96C562951.13,-961.75 562930.74,-959.01 562911,-957 562730.05,-938.56 559818.8,-952.59 559637,-947 559568.47,-944.89 559551.53,-940.06 559483,-938 558971.79,-922.63 555391.42,-935.43 554880,-930 553376.48,-914.04 551571.12,-870.74 550921.2,-854.38"/>
<polygon fill="black" stroke="black" points="550920.86,-850.87 550910.77,-854.11 550920.68,-857.86 550920.86,-850.87"/>
<text text-anchor="middle" x="559663" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_3 -->
<g id="edge2336" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563158.32,-964.68C563142.73,-946.36 563125.04,-925.59 563108.96,-906.69"/>
<polygon fill="black" stroke="black" points="563111.56,-904.35 563102.41,-899 563106.23,-908.89 563111.56,-904.35"/>
<text text-anchor="middle" x="563165" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_4 -->
<g id="edge2337" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562965.86,-965C562947.35,-961.96 562928.9,-959.23 562911,-957 562819.16,-945.55 562795.41,-952.19 562703,-947 562640.75,-943.5 562625.28,-940.99 562563,-938 561609.45,-892.18 560473.8,-864.05 559982.57,-853.17"/>
<polygon fill="black" stroke="black" points="559982.59,-849.67 559972.52,-852.94 559982.44,-856.66 559982.59,-849.67"/>
<text text-anchor="middle" x="562729" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_5 -->
<g id="edge2338" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562970.71,-964.96C562950.59,-961.78 562930.48,-959.04 562911,-957 562786.68,-943.97 561911,-948.52 561786,-947 561526.43,-943.85 561461.57,-940.59 561202,-938 560418.48,-930.19 560222.51,-939.31 559439,-930 557912.72,-911.86 556079.34,-869.72 555424.4,-854.03"/>
<polygon fill="black" stroke="black" points="555424.45,-850.53 555414.37,-853.79 555424.28,-857.53 555424.45,-850.53"/>
<text text-anchor="middle" x="561812" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_6 -->
<g id="edge2339" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563379.28,-974.25C563416.63,-967.09 563455.95,-960.75 563493,-957 563567.73,-949.43 568825.89,-947.33 568901,-947 569178.11,-945.8 571117.91,-933.88 571395,-930 572777.21,-910.67 574436.41,-869.56 575037.95,-854.07"/>
<polygon fill="black" stroke="black" points="575038.13,-857.57 575048.04,-853.81 575037.95,-850.57 575038.13,-857.57"/>
<text text-anchor="middle" x="570372" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_7 -->
<g id="edge2340" class="edge">
<title>layer_12_gate_tp_1&#45;&gt;layer_12_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563379.29,-974.39C563416.64,-967.22 563455.95,-960.84 563493,-957 563657.9,-939.89 564819.75,-960.3 564985,-947 565011,-944.91 565017,-940.07 565043,-938 565133.94,-930.76 566593.78,-931.07 566685,-930 568284.16,-911.25 570208.94,-868.57 570865.54,-853.44"/>
<polygon fill="black" stroke="black" points="570865.67,-856.94 570875.59,-853.21 570865.51,-849.94 570865.67,-856.94"/>
<text text-anchor="middle" x="565069" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2 -->
<g id="node1254" class="node">
<title>layer_12_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="562319.99,-1069 561871.4,-1069 561756.01,-965 562204.6,-965 562319.99,-1069"/>
<text text-anchor="middle" x="562038" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="562038" y="-1020" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="562038" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="562038" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_0 -->
<g id="edge2341" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M561811.75,-1015.35C560623.8,-1011.74 554986.86,-991.93 550376,-930 548872.08,-909.8 547066.05,-869.05 546416.62,-853.87"/>
<polygon fill="black" stroke="black" points="546416.28,-850.37 546406.2,-853.63 546416.11,-857.36 546416.28,-850.37"/>
<text text-anchor="middle" x="551666" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_1 -->
<g id="edge2342" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562215.71,-974.61C562252.94,-967.45 562292.1,-961.02 562329,-957 562392.96,-950.02 562844.98,-959.96 562908,-947 562918.35,-944.87 562919.65,-940.14 562930,-938 562976.36,-928.43 563308.67,-931.08 563356,-930 564401.36,-906.05 565649.25,-869.92 566156.53,-854.91"/>
<polygon fill="black" stroke="black" points="566157,-858.4 566166.89,-854.61 566156.8,-851.4 566157,-858.4"/>
<text text-anchor="middle" x="562956" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_2 -->
<g id="edge2343" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M561811.13,-1014.86C560933.61,-1010.21 557677.4,-990.84 554996,-947 553445.75,-921.66 551583.2,-872.77 550921.24,-854.82"/>
<polygon fill="black" stroke="black" points="550921.19,-851.32 550911.1,-854.55 550921,-858.32 550921.19,-851.32"/>
<text text-anchor="middle" x="555022" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_3 -->
<g id="edge2344" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562218.96,-977.8C562255.33,-970.55 562293.33,-963.27 562329,-957 562504.49,-926.13 562704.72,-896.64 562851.03,-876.13"/>
<polygon fill="black" stroke="black" points="562851.61,-879.58 562861.03,-874.73 562850.64,-872.65 562851.61,-879.58"/>
<text text-anchor="middle" x="562453" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_4 -->
<g id="edge2345" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M561809.42,-1013.53C561305.28,-1007.34 560128.57,-988.61 559952,-947 559912.38,-937.66 559871.21,-920.81 559835.57,-903.63"/>
<polygon fill="black" stroke="black" points="559836.67,-900.28 559826.15,-899.02 559833.59,-906.56 559836.67,-900.28"/>
<text text-anchor="middle" x="559978" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_5 -->
<g id="edge2346" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M561806.53,-1010.72C561309.61,-999.36 560103.72,-971.62 559093,-947 557706.45,-913.23 556043.8,-870.44 555424.93,-854.43"/>
<polygon fill="black" stroke="black" points="555424.64,-850.92 555414.55,-854.16 555424.45,-857.92 555424.64,-850.92"/>
<text text-anchor="middle" x="559119" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_6 -->
<g id="edge2347" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562215.29,-974.35C562252.64,-967.19 562291.95,-960.82 562329,-957 562428.86,-946.7 564037.55,-966.64 564136,-947 564146.36,-944.93 564147.64,-940.04 564158,-938 564207.31,-928.28 571344.75,-930.56 571395,-930 572777.68,-914.61 574437.44,-871.09 575038.5,-854.52"/>
<polygon fill="black" stroke="black" points="575038.68,-858.01 575048.58,-854.24 575038.49,-851.02 575038.68,-858.01"/>
<text text-anchor="middle" x="564184" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_7 -->
<g id="edge2348" class="edge">
<title>layer_12_gate_tp_2&#45;&gt;layer_12_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M562215.3,-974.45C562252.65,-967.28 562291.96,-960.89 562329,-957 562451.33,-944.17 563313,-948.41 563436,-947 563724.01,-943.7 563795.98,-940.44 564084,-938 565239.96,-928.2 565529.06,-942.52 566685,-930 568284.17,-912.68 570208.94,-869.1 570865.54,-853.59"/>
<polygon fill="black" stroke="black" points="570865.68,-857.09 570875.59,-853.35 570865.51,-850.09 570865.68,-857.09"/>
<text text-anchor="middle" x="564110" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3 -->
<g id="node1255" class="node">
<title>layer_12_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="564065.99,-1069 563617.4,-1069 563502.01,-965 563950.6,-965 564065.99,-1069"/>
<text text-anchor="middle" x="563784" y="-1031" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="563784" y="-1020" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="563784" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="563784" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_0 -->
<g id="edge2349" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563553.52,-964.94C563533.13,-961.74 563512.75,-959 563493,-957 563427.03,-950.31 558785.31,-947.3 558719,-947 558141.21,-944.39 557996.79,-940.33 557419,-938 555853.9,-931.69 551941.03,-946.14 550376,-930 548872.48,-914.49 547067.12,-870.91 546417.2,-854.43"/>
<polygon fill="black" stroke="black" points="546416.86,-850.92 546406.77,-854.16 546416.68,-857.92 546416.86,-850.92"/>
<text text-anchor="middle" x="558745" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_1 -->
<g id="edge2350" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563996.76,-1006.42C564256.87,-994.35 564710.45,-972.11 565099,-947 565475.43,-922.67 565913.17,-887.62 566169.47,-866.41"/>
<polygon fill="black" stroke="black" points="566169.97,-869.88 566179.65,-865.56 566169.39,-862.9 566169.97,-869.88"/>
<text text-anchor="middle" x="565229" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_2 -->
<g id="edge2351" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563553.52,-964.95C563533.13,-961.75 563512.74,-959.01 563493,-957 563392.71,-946.8 559964.77,-949.73 559864,-947 559786.15,-944.89 559766.85,-940.07 559689,-938 559154.85,-923.83 555414.3,-935.65 554880,-930 553376.48,-914.1 551571.12,-870.76 550921.2,-854.38"/>
<polygon fill="black" stroke="black" points="550920.86,-850.87 550910.77,-854.12 550920.68,-857.87 550920.86,-850.87"/>
<text text-anchor="middle" x="559890" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_3 -->
<g id="edge2352" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563542.59,-964.97C563525.85,-962.07 563509.19,-959.38 563493,-957 563444.87,-949.93 563431.74,-956.36 563384,-947 563327.49,-935.92 563266.8,-918.89 563213.36,-902.06"/>
<polygon fill="black" stroke="black" points="563214.4,-898.72 563203.81,-899.04 563212.28,-905.39 563214.4,-898.72"/>
<text text-anchor="middle" x="563410" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_4 -->
<g id="edge2353" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563551.9,-964.98C563532.05,-961.82 563512.22,-959.08 563493,-957 563352.25,-941.76 562997.38,-954.4 562856,-947 562810.99,-944.64 562799.99,-940.67 562755,-938 561724.12,-876.76 560492.61,-856.48 559979.28,-850.38"/>
<polygon fill="black" stroke="black" points="559979.2,-846.88 559969.16,-850.26 559979.12,-853.88 559979.2,-846.88"/>
<text text-anchor="middle" x="562882" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_5 -->
<g id="edge2354" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M563552.71,-964.95C563532.59,-961.77 563512.48,-959.04 563493,-957 563364.59,-943.55 562460.1,-948.73 562331,-947 562111.87,-944.06 562057.13,-940.37 561838,-938 560771.83,-926.49 560505.16,-942.03 559439,-930 557912.71,-912.77 556079.34,-870.08 555424.4,-854.14"/>
<polygon fill="black" stroke="black" points="555424.45,-850.64 555414.37,-853.89 555424.28,-857.63 555424.45,-850.64"/>
<text text-anchor="middle" x="562357" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_6 -->
<g id="edge2355" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M564002.15,-1011.41C564561.88,-999.84 566094.72,-969.54 567372,-957 568762.16,-943.35 569109.86,-962.42 570500,-947 570897.83,-942.59 570997.23,-937.99 571395,-930 572776.44,-902.26 574434.85,-866.27 575037.11,-853.1"/>
<polygon fill="black" stroke="black" points="575037.29,-856.6 575047.22,-852.88 575037.14,-849.6 575037.29,-856.6"/>
<text text-anchor="middle" x="571048" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_7 -->
<g id="edge2356" class="edge">
<title>layer_12_gate_tp_3&#45;&gt;layer_12_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M564001.9,-1010.99C565071.91,-986.42 569762.71,-878.67 570865.35,-853.34"/>
<polygon fill="black" stroke="black" points="570865.46,-856.84 570875.37,-853.11 570865.3,-849.84 570865.46,-856.84"/>
<text text-anchor="middle" x="567029" y="-940.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_12_expert_0_ep_0 -->
<g id="node1264" class="node">
<title>layer_12_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="543414.83,-729 542980.82,-729 542869.17,-625 543303.18,-625 543414.83,-729"/>
<text text-anchor="middle" x="543142" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="543142" y="-680" font-family="Arial" font-size="10.00">GPU: 384</text>
<text text-anchor="middle" x="543142" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="543142" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_0_ep_0 -->
<g id="edge2357" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M545938.54,-846.25C545368.64,-845.68 543904.58,-836.54 543423,-760 543382.78,-753.61 543340.2,-743.18 543300.68,-731.87"/>
<polygon fill="black" stroke="black" points="543301.55,-728.48 543290.97,-729.06 543299.6,-735.2 543301.55,-728.48"/>
</g>
<!-- layer_12_expert_1_ep_0 -->
<g id="node1265" class="node">
<title>layer_12_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="543977.83,-729 543543.82,-729 543432.17,-625 543866.18,-625 543977.83,-729"/>
<text text-anchor="middle" x="543705" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="543705" y="-680" font-family="Arial" font-size="10.00">GPU: 385</text>
<text text-anchor="middle" x="543705" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="543705" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_1_ep_0 -->
<g id="edge2358" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M545929.42,-838.13C545382.23,-819.95 544080.42,-775.4 543986,-760 543946.12,-753.5 543903.9,-743.12 543864.65,-731.91"/>
<polygon fill="black" stroke="black" points="543865.32,-728.46 543854.74,-729.04 543863.37,-735.18 543865.32,-728.46"/>
</g>
<!-- layer_12_expert_2_ep_0 -->
<g id="node1266" class="node">
<title>layer_12_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="544540.83,-729 544106.82,-729 543995.17,-625 544429.18,-625 544540.83,-729"/>
<text text-anchor="middle" x="544268" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="544268" y="-680" font-family="Arial" font-size="10.00">GPU: 386</text>
<text text-anchor="middle" x="544268" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="544268" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_2_ep_0 -->
<g id="edge2359" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M545931.72,-840.13C545547.88,-829.5 544807.66,-804 544549,-760 544509.63,-753.3 544467.95,-742.99 544429.08,-731.91"/>
<polygon fill="black" stroke="black" points="544429.85,-728.49 544419.27,-729.08 544427.91,-735.21 544429.85,-728.49"/>
</g>
<!-- layer_12_expert_3_ep_0 -->
<g id="node1267" class="node">
<title>layer_12_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="545103.83,-729 544669.82,-729 544558.17,-625 544992.18,-625 545103.83,-729"/>
<text text-anchor="middle" x="544831" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="544831" y="-680" font-family="Arial" font-size="10.00">GPU: 387</text>
<text text-anchor="middle" x="544831" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="544831" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_3_ep_0 -->
<g id="edge2360" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M545932.1,-840.44C545716.69,-832.14 545390.82,-811.47 545112,-760 545073.53,-752.9 545032.79,-742.65 544994.62,-731.8"/>
<polygon fill="black" stroke="black" points="544995.55,-728.42 544984.98,-729.03 544993.62,-735.15 544995.55,-728.42"/>
</g>
<!-- layer_12_expert_4_ep_0 -->
<g id="node1268" class="node">
<title>layer_12_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="545666.83,-729 545232.82,-729 545121.17,-625 545555.18,-625 545666.83,-729"/>
<text text-anchor="middle" x="545394" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="545394" y="-680" font-family="Arial" font-size="10.00">GPU: 388</text>
<text text-anchor="middle" x="545394" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="545394" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_4_ep_0 -->
<g id="edge2361" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M545889.33,-802.91C545819.05,-790.55 545744,-776.02 545675,-760 545639.93,-751.86 545602.76,-741.94 545567.32,-731.86"/>
<polygon fill="black" stroke="black" points="545567.95,-728.4 545557.38,-729.01 545566.03,-735.13 545567.95,-728.4"/>
</g>
<!-- layer_12_expert_5_ep_0 -->
<g id="node1269" class="node">
<title>layer_12_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="546229.83,-729 545795.82,-729 545684.17,-625 546118.18,-625 546229.83,-729"/>
<text text-anchor="middle" x="545957" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="545957" y="-680" font-family="Arial" font-size="10.00">GPU: 389</text>
<text text-anchor="middle" x="545957" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="545957" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_5_ep_0 -->
<g id="edge2362" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M546104.53,-794.91C546080.89,-776.18 546053.97,-754.85 546029.66,-735.58"/>
<polygon fill="black" stroke="black" points="546031.54,-732.6 546021.53,-729.14 546027.19,-738.09 546031.54,-732.6"/>
</g>
<!-- layer_12_expert_6_ep_0 -->
<g id="node1270" class="node">
<title>layer_12_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="546792.83,-729 546358.82,-729 546247.17,-625 546681.18,-625 546792.83,-729"/>
<text text-anchor="middle" x="546520" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="546520" y="-680" font-family="Arial" font-size="10.00">GPU: 390</text>
<text text-anchor="middle" x="546520" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="546520" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_6_ep_0 -->
<g id="edge2363" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M546275.74,-794.91C546316.33,-775.48 546362.74,-753.27 546404.14,-733.46"/>
<polygon fill="black" stroke="black" points="546405.65,-736.61 546413.16,-729.14 546402.63,-730.3 546405.65,-736.61"/>
</g>
<!-- layer_12_expert_7_ep_0 -->
<g id="node1271" class="node">
<title>layer_12_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="547355.83,-729 546921.82,-729 546810.17,-625 547244.18,-625 547355.83,-729"/>
<text text-anchor="middle" x="547083" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="547083" y="-680" font-family="Arial" font-size="10.00">GPU: 391</text>
<text text-anchor="middle" x="547083" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="547083" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_0&#45;&gt;layer_12_expert_7_ep_0 -->
<g id="edge2364" class="edge">
<title>layer_12_route_ep_0&#45;&gt;layer_12_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M546374.52,-825.92C546499.02,-811.82 546660.57,-790.07 546802,-760 546838.39,-752.26 546876.95,-742.25 546913.46,-731.88"/>
<polygon fill="black" stroke="black" points="546914.54,-735.22 546923.19,-729.1 546912.61,-728.48 546914.54,-735.22"/>
</g>
<!-- layer_12_expert_0_ep_1 -->
<g id="node1272" class="node">
<title>layer_12_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="565934.83,-729 565500.82,-729 565389.17,-625 565823.18,-625 565934.83,-729"/>
<text text-anchor="middle" x="565662" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="565662" y="-680" font-family="Arial" font-size="10.00">GPU: 400</text>
<text text-anchor="middle" x="565662" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="565662" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_0_ep_1 -->
<g id="edge2365" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M566102.87,-794.98C566049.55,-784.29 565994.43,-772.45 565943,-760 565908.57,-751.67 565872.06,-741.8 565837.16,-731.84"/>
<polygon fill="black" stroke="black" points="565837.94,-728.42 565827.36,-729.03 565836.01,-735.15 565837.94,-728.42"/>
</g>
<!-- layer_12_expert_1_ep_1 -->
<g id="node1273" class="node">
<title>layer_12_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="566497.83,-729 566063.82,-729 565952.17,-625 566386.18,-625 566497.83,-729"/>
<text text-anchor="middle" x="566225" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="566225" y="-680" font-family="Arial" font-size="10.00">GPU: 401</text>
<text text-anchor="middle" x="566225" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="566225" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_1_ep_1 -->
<g id="edge2366" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M566338.21,-794.68C566320.28,-776.2 566299.92,-755.22 566281.46,-736.19"/>
<polygon fill="black" stroke="black" points="566283.96,-733.74 566274.49,-729 566278.94,-738.62 566283.96,-733.74"/>
</g>
<!-- layer_12_expert_2_ep_1 -->
<g id="node1274" class="node">
<title>layer_12_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="567060.83,-729 566626.82,-729 566515.17,-625 566949.18,-625 567060.83,-729"/>
<text text-anchor="middle" x="566788" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="566788" y="-680" font-family="Arial" font-size="10.00">GPU: 402</text>
<text text-anchor="middle" x="566788" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="566788" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_2_ep_1 -->
<g id="edge2367" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M566509.64,-794.91C566556.19,-775.36 566609.46,-752.99 566656.85,-733.08"/>
<polygon fill="black" stroke="black" points="566658.38,-736.24 566666.25,-729.14 566655.67,-729.78 566658.38,-736.24"/>
</g>
<!-- layer_12_expert_3_ep_1 -->
<g id="node1275" class="node">
<title>layer_12_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="567623.83,-729 567189.82,-729 567078.17,-625 567512.18,-625 567623.83,-729"/>
<text text-anchor="middle" x="567351" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="567351" y="-680" font-family="Arial" font-size="10.00">GPU: 403</text>
<text text-anchor="middle" x="567351" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="567351" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_3_ep_1 -->
<g id="edge2368" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M566596.47,-828.36C566732.23,-814.75 566912.69,-792.66 567070,-760 567106.77,-752.37 567145.73,-742.31 567182.54,-731.86"/>
<polygon fill="black" stroke="black" points="567183.71,-735.17 567192.36,-729.05 567181.78,-728.44 567183.71,-735.17"/>
</g>
<!-- layer_12_expert_4_ep_1 -->
<g id="node1276" class="node">
<title>layer_12_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="568186.83,-729 567752.82,-729 567641.17,-625 568075.18,-625 568186.83,-729"/>
<text text-anchor="middle" x="567914" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="567914" y="-680" font-family="Arial" font-size="10.00">GPU: 404</text>
<text text-anchor="middle" x="567914" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="567914" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_4_ep_1 -->
<g id="edge2369" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M566615.26,-844.9C566866.22,-840.31 567281.33,-822.7 567633,-760 567671.86,-753.07 567713,-742.8 567751.47,-731.85"/>
<polygon fill="black" stroke="black" points="567752.55,-735.18 567761.19,-729.05 567750.61,-728.46 567752.55,-735.18"/>
</g>
<!-- layer_12_expert_5_ep_1 -->
<g id="node1277" class="node">
<title>layer_12_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="568749.83,-729 568315.82,-729 568204.17,-625 568638.18,-625 568749.83,-729"/>
<text text-anchor="middle" x="568477" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="568477" y="-680" font-family="Arial" font-size="10.00">GPU: 405</text>
<text text-anchor="middle" x="568477" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="568477" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_5_ep_1 -->
<g id="edge2370" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M566601.37,-832.73C566887.48,-815.37 567411.3,-785.18 567859,-768 567933.85,-765.13 568121.97,-771.48 568196,-760 568236.48,-753.72 568279.32,-743.27 568319.03,-731.89"/>
<polygon fill="black" stroke="black" points="568320.16,-735.21 568328.79,-729.06 568318.21,-728.49 568320.16,-735.21"/>
</g>
<!-- layer_12_expert_6_ep_1 -->
<g id="node1278" class="node">
<title>layer_12_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="569312.83,-729 568878.82,-729 568767.17,-625 569201.18,-625 569312.83,-729"/>
<text text-anchor="middle" x="569040" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="569040" y="-680" font-family="Arial" font-size="10.00">GPU: 406</text>
<text text-anchor="middle" x="569040" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="569040" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_6_ep_1 -->
<g id="edge2371" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M566604.43,-835.39C566875.32,-822.05 567353.49,-798.31 567763,-777 567837.23,-773.14 567855.71,-770.36 567930,-768 568022.07,-765.08 568667.88,-773.47 568759,-760 568799.99,-753.94 568843.37,-743.42 568883.46,-731.9"/>
<polygon fill="black" stroke="black" points="568884.68,-735.19 568893.31,-729.03 568882.73,-728.47 568884.68,-735.19"/>
</g>
<!-- layer_12_expert_7_ep_1 -->
<g id="node1279" class="node">
<title>layer_12_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="569875.83,-729 569441.82,-729 569330.17,-625 569764.18,-625 569875.83,-729"/>
<text text-anchor="middle" x="569603" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="569603" y="-680" font-family="Arial" font-size="10.00">GPU: 407</text>
<text text-anchor="middle" x="569603" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="569603" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_1&#45;&gt;layer_12_expert_7_ep_1 -->
<g id="edge2372" class="edge">
<title>layer_12_route_ep_1&#45;&gt;layer_12_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M566617.46,-846.8C567213.88,-847.69 568802.6,-842.02 569322,-760 569362.35,-753.63 569405.06,-743.18 569444.67,-731.83"/>
<polygon fill="black" stroke="black" points="569445.77,-735.16 569454.4,-729.01 569443.82,-728.43 569445.77,-735.16"/>
</g>
<!-- layer_12_expert_0_ep_2 -->
<g id="node1280" class="node">
<title>layer_12_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="547918.83,-729 547484.82,-729 547373.17,-625 547807.18,-625 547918.83,-729"/>
<text text-anchor="middle" x="547646" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="547646" y="-680" font-family="Arial" font-size="10.00">GPU: 416</text>
<text text-anchor="middle" x="547646" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="547646" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_0_ep_2 -->
<g id="edge2373" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M550442.54,-846.25C549872.64,-845.68 548408.58,-836.54 547927,-760 547886.78,-753.61 547844.2,-743.18 547804.68,-731.87"/>
<polygon fill="black" stroke="black" points="547805.55,-728.48 547794.97,-729.06 547803.6,-735.2 547805.55,-728.48"/>
</g>
<!-- layer_12_expert_1_ep_2 -->
<g id="node1281" class="node">
<title>layer_12_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="548481.83,-729 548047.82,-729 547936.17,-625 548370.18,-625 548481.83,-729"/>
<text text-anchor="middle" x="548209" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="548209" y="-680" font-family="Arial" font-size="10.00">GPU: 417</text>
<text text-anchor="middle" x="548209" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="548209" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_1_ep_2 -->
<g id="edge2374" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M550440.11,-844.01C549956.85,-838.71 548859.43,-820.24 548490,-760 548450.12,-753.5 548407.9,-743.12 548368.65,-731.91"/>
<polygon fill="black" stroke="black" points="548369.32,-728.46 548358.74,-729.04 548367.37,-735.18 548369.32,-728.46"/>
</g>
<!-- layer_12_expert_2_ep_2 -->
<g id="node1282" class="node">
<title>layer_12_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="549044.83,-729 548610.82,-729 548499.17,-625 548933.18,-625 549044.83,-729"/>
<text text-anchor="middle" x="548772" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="548772" y="-680" font-family="Arial" font-size="10.00">GPU: 418</text>
<text text-anchor="middle" x="548772" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="548772" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_2_ep_2 -->
<g id="edge2375" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M550435.72,-840.13C550051.88,-829.5 549311.66,-804 549053,-760 549013.63,-753.3 548971.95,-742.99 548933.08,-731.91"/>
<polygon fill="black" stroke="black" points="548933.85,-728.49 548923.27,-729.08 548931.91,-735.21 548933.85,-728.49"/>
</g>
<!-- layer_12_expert_3_ep_2 -->
<g id="node1283" class="node">
<title>layer_12_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="549607.83,-729 549173.82,-729 549062.17,-625 549496.18,-625 549607.83,-729"/>
<text text-anchor="middle" x="549335" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="549335" y="-680" font-family="Arial" font-size="10.00">GPU: 419</text>
<text text-anchor="middle" x="549335" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="549335" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_3_ep_2 -->
<g id="edge2376" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M550436.1,-840.44C550220.69,-832.14 549894.82,-811.47 549616,-760 549577.53,-752.9 549536.79,-742.65 549498.62,-731.8"/>
<polygon fill="black" stroke="black" points="549499.55,-728.42 549488.98,-729.03 549497.62,-735.15 549499.55,-728.42"/>
</g>
<!-- layer_12_expert_4_ep_2 -->
<g id="node1284" class="node">
<title>layer_12_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="550170.83,-729 549736.82,-729 549625.17,-625 550059.18,-625 550170.83,-729"/>
<text text-anchor="middle" x="549898" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="549898" y="-680" font-family="Arial" font-size="10.00">GPU: 420</text>
<text text-anchor="middle" x="549898" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="549898" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_4_ep_2 -->
<g id="edge2377" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M550393.33,-802.91C550323.05,-790.55 550248,-776.02 550179,-760 550143.93,-751.86 550106.76,-741.94 550071.32,-731.86"/>
<polygon fill="black" stroke="black" points="550071.95,-728.4 550061.38,-729.01 550070.03,-735.13 550071.95,-728.4"/>
</g>
<!-- layer_12_expert_5_ep_2 -->
<g id="node1285" class="node">
<title>layer_12_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="550733.83,-729 550299.82,-729 550188.17,-625 550622.18,-625 550733.83,-729"/>
<text text-anchor="middle" x="550461" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="550461" y="-680" font-family="Arial" font-size="10.00">GPU: 421</text>
<text text-anchor="middle" x="550461" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="550461" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_5_ep_2 -->
<g id="edge2378" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M550608.53,-794.91C550584.89,-776.18 550557.97,-754.85 550533.66,-735.58"/>
<polygon fill="black" stroke="black" points="550535.54,-732.6 550525.53,-729.14 550531.19,-738.09 550535.54,-732.6"/>
</g>
<!-- layer_12_expert_6_ep_2 -->
<g id="node1286" class="node">
<title>layer_12_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="551296.83,-729 550862.82,-729 550751.17,-625 551185.18,-625 551296.83,-729"/>
<text text-anchor="middle" x="551024" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="551024" y="-680" font-family="Arial" font-size="10.00">GPU: 422</text>
<text text-anchor="middle" x="551024" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="551024" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_6_ep_2 -->
<g id="edge2379" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M550779.74,-794.91C550820.33,-775.48 550866.74,-753.27 550908.14,-733.46"/>
<polygon fill="black" stroke="black" points="550909.65,-736.61 550917.16,-729.14 550906.63,-730.3 550909.65,-736.61"/>
</g>
<!-- layer_12_expert_7_ep_2 -->
<g id="node1287" class="node">
<title>layer_12_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="551859.83,-729 551425.82,-729 551314.17,-625 551748.18,-625 551859.83,-729"/>
<text text-anchor="middle" x="551587" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="551587" y="-680" font-family="Arial" font-size="10.00">GPU: 423</text>
<text text-anchor="middle" x="551587" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="551587" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_2&#45;&gt;layer_12_expert_7_ep_2 -->
<g id="edge2380" class="edge">
<title>layer_12_route_ep_2&#45;&gt;layer_12_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M550878.52,-825.92C551003.02,-811.82 551164.57,-790.07 551306,-760 551342.39,-752.26 551380.95,-742.25 551417.46,-731.88"/>
<polygon fill="black" stroke="black" points="551418.54,-735.22 551427.19,-729.1 551416.61,-728.48 551418.54,-735.22"/>
</g>
<!-- layer_12_expert_0_ep_3 -->
<g id="node1288" class="node">
<title>layer_12_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="560867.83,-729 560433.82,-729 560322.17,-625 560756.18,-625 560867.83,-729"/>
<text text-anchor="middle" x="560595" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="560595" y="-680" font-family="Arial" font-size="10.00">GPU: 432</text>
<text text-anchor="middle" x="560595" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="560595" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_0_ep_3 -->
<g id="edge2381" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M562826.11,-844.01C562342.85,-838.71 561245.43,-820.24 560876,-760 560836.12,-753.5 560793.9,-743.12 560754.65,-731.91"/>
<polygon fill="black" stroke="black" points="560755.32,-728.46 560744.74,-729.04 560753.37,-735.18 560755.32,-728.46"/>
</g>
<!-- layer_12_expert_1_ep_3 -->
<g id="node1289" class="node">
<title>layer_12_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="561430.83,-729 560996.82,-729 560885.17,-625 561319.18,-625 561430.83,-729"/>
<text text-anchor="middle" x="561158" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="561158" y="-680" font-family="Arial" font-size="10.00">GPU: 433</text>
<text text-anchor="middle" x="561158" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="561158" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_1_ep_3 -->
<g id="edge2382" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M562821.72,-840.13C562437.88,-829.5 561697.66,-804 561439,-760 561399.63,-753.3 561357.95,-742.99 561319.08,-731.91"/>
<polygon fill="black" stroke="black" points="561319.85,-728.49 561309.27,-729.08 561317.91,-735.21 561319.85,-728.49"/>
</g>
<!-- layer_12_expert_2_ep_3 -->
<g id="node1290" class="node">
<title>layer_12_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="561993.83,-729 561559.82,-729 561448.17,-625 561882.18,-625 561993.83,-729"/>
<text text-anchor="middle" x="561721" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="561721" y="-680" font-family="Arial" font-size="10.00">GPU: 434</text>
<text text-anchor="middle" x="561721" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="561721" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_2_ep_3 -->
<g id="edge2383" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M562822.1,-840.44C562606.69,-832.14 562280.82,-811.47 562002,-760 561963.53,-752.9 561922.79,-742.65 561884.62,-731.8"/>
<polygon fill="black" stroke="black" points="561885.55,-728.42 561874.98,-729.03 561883.62,-735.15 561885.55,-728.42"/>
</g>
<!-- layer_12_expert_3_ep_3 -->
<g id="node1291" class="node">
<title>layer_12_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="563119.83,-729 562685.82,-729 562574.17,-625 563008.18,-625 563119.83,-729"/>
<text text-anchor="middle" x="562847" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="562847" y="-680" font-family="Arial" font-size="10.00">GPU: 435</text>
<text text-anchor="middle" x="562847" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="562847" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_3_ep_3 -->
<g id="edge2384" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M562994.53,-794.91C562970.89,-776.18 562943.97,-754.85 562919.66,-735.58"/>
<polygon fill="black" stroke="black" points="562921.54,-732.6 562911.53,-729.14 562917.19,-738.09 562921.54,-732.6"/>
</g>
<!-- layer_12_expert_4_ep_3 -->
<g id="node1292" class="node">
<title>layer_12_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="563682.83,-729 563248.82,-729 563137.17,-625 563571.18,-625 563682.83,-729"/>
<text text-anchor="middle" x="563410" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="563410" y="-680" font-family="Arial" font-size="10.00">GPU: 436</text>
<text text-anchor="middle" x="563410" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="563410" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_4_ep_3 -->
<g id="edge2385" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M563165.74,-794.91C563206.33,-775.48 563252.74,-753.27 563294.14,-733.46"/>
<polygon fill="black" stroke="black" points="563295.65,-736.61 563303.16,-729.14 563292.63,-730.3 563295.65,-736.61"/>
</g>
<!-- layer_12_expert_5_ep_3 -->
<g id="node1293" class="node">
<title>layer_12_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="564245.83,-729 563811.82,-729 563700.17,-625 564134.18,-625 564245.83,-729"/>
<text text-anchor="middle" x="563973" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="563973" y="-680" font-family="Arial" font-size="10.00">GPU: 437</text>
<text text-anchor="middle" x="563973" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="563973" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_5_ep_3 -->
<g id="edge2386" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M563264.52,-825.92C563389.02,-811.82 563550.57,-790.07 563692,-760 563728.39,-752.26 563766.95,-742.25 563803.46,-731.88"/>
<polygon fill="black" stroke="black" points="563804.54,-735.22 563813.19,-729.1 563802.61,-728.48 563804.54,-735.22"/>
</g>
<!-- layer_12_expert_6_ep_3 -->
<g id="node1294" class="node">
<title>layer_12_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="564808.83,-729 564374.82,-729 564263.17,-625 564697.18,-625 564808.83,-729"/>
<text text-anchor="middle" x="564536" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="564536" y="-680" font-family="Arial" font-size="10.00">GPU: 438</text>
<text text-anchor="middle" x="564536" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="564536" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_6_ep_3 -->
<g id="edge2387" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M563285.06,-843.98C563526.87,-838.51 563920.77,-820.08 564255,-760 564293.73,-753.04 564334.74,-742.78 564373.11,-731.87"/>
<polygon fill="black" stroke="black" points="564374.16,-735.21 564382.81,-729.08 564372.23,-728.48 564374.16,-735.21"/>
</g>
<!-- layer_12_expert_7_ep_3 -->
<g id="node1295" class="node">
<title>layer_12_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="565371.83,-729 564937.82,-729 564826.17,-625 565260.18,-625 565371.83,-729"/>
<text text-anchor="middle" x="565099" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="565099" y="-680" font-family="Arial" font-size="10.00">GPU: 439</text>
<text text-anchor="middle" x="565099" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="565099" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_3&#45;&gt;layer_12_expert_7_ep_3 -->
<g id="edge2388" class="edge">
<title>layer_12_route_ep_3&#45;&gt;layer_12_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M563282.34,-841.62C563687.68,-832.57 564529.2,-808.5 564818,-760 564857.5,-753.37 564899.32,-743.04 564938.28,-731.93"/>
<polygon fill="black" stroke="black" points="564939.48,-735.23 564948.12,-729.09 564937.54,-728.5 564939.48,-735.23"/>
</g>
<!-- layer_12_expert_0_ep_4 -->
<g id="node1296" class="node">
<title>layer_12_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="556926.83,-729 556492.82,-729 556381.17,-625 556815.18,-625 556926.83,-729"/>
<text text-anchor="middle" x="556654" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="556654" y="-680" font-family="Arial" font-size="10.00">GPU: 448</text>
<text text-anchor="middle" x="556654" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="556654" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_0_ep_4 -->
<g id="edge2389" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M559505.7,-846.42C558927.84,-846.28 557427.59,-838.14 556935,-760 556894.78,-753.62 556852.2,-743.2 556812.68,-731.89"/>
<polygon fill="black" stroke="black" points="556813.55,-728.5 556802.97,-729.08 556811.6,-735.22 556813.55,-728.5"/>
</g>
<!-- layer_12_expert_1_ep_4 -->
<g id="node1297" class="node">
<title>layer_12_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="557489.83,-729 557055.82,-729 556944.17,-625 557378.18,-625 557489.83,-729"/>
<text text-anchor="middle" x="557217" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="557217" y="-680" font-family="Arial" font-size="10.00">GPU: 449</text>
<text text-anchor="middle" x="557217" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="557217" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_1_ep_4 -->
<g id="edge2390" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M559503.33,-844.28C559011.09,-839.47 557878.31,-821.83 557498,-760 557458.12,-753.52 557415.9,-743.15 557376.65,-731.94"/>
<polygon fill="black" stroke="black" points="557377.31,-728.49 557366.74,-729.07 557375.37,-735.21 557377.31,-728.49"/>
</g>
<!-- layer_12_expert_2_ep_4 -->
<g id="node1298" class="node">
<title>layer_12_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="558052.83,-729 557618.82,-729 557507.17,-625 557941.18,-625 558052.83,-729"/>
<text text-anchor="middle" x="557780" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="557780" y="-680" font-family="Arial" font-size="10.00">GPU: 450</text>
<text text-anchor="middle" x="557780" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="557780" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_2_ep_4 -->
<g id="edge2391" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M559499,-840.63C559104.61,-830.54 558330.34,-805.57 558061,-760 558021.51,-753.32 557979.69,-742.98 557940.73,-731.86"/>
<polygon fill="black" stroke="black" points="557941.47,-728.43 557930.89,-729.02 557939.53,-735.16 557941.47,-728.43"/>
</g>
<!-- layer_12_expert_3_ep_4 -->
<g id="node1299" class="node">
<title>layer_12_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="558615.83,-729 558181.82,-729 558070.17,-625 558504.18,-625 558615.83,-729"/>
<text text-anchor="middle" x="558343" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="558343" y="-680" font-family="Arial" font-size="10.00">GPU: 451</text>
<text text-anchor="middle" x="558343" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="558343" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_3_ep_4 -->
<g id="edge2392" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M559500.71,-841.88C559274.38,-834.62 558923.42,-814.66 558624,-760 558585.4,-752.95 558544.53,-742.7 558506.26,-731.81"/>
<polygon fill="black" stroke="black" points="558507.17,-728.43 558496.59,-729.03 558505.23,-735.16 558507.17,-728.43"/>
</g>
<!-- layer_12_expert_4_ep_4 -->
<g id="node1300" class="node">
<title>layer_12_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="559178.83,-729 558744.82,-729 558633.17,-625 559067.18,-625 559178.83,-729"/>
<text text-anchor="middle" x="558906" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="558906" y="-680" font-family="Arial" font-size="10.00">GPU: 452</text>
<text text-anchor="middle" x="558906" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="558906" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_4_ep_4 -->
<g id="edge2393" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M559465.23,-810.65C559376.15,-797.14 559276.92,-780.08 559187,-760 559151.41,-752.05 559113.7,-742.12 559077.84,-731.94"/>
<polygon fill="black" stroke="black" points="559078.36,-728.45 559067.78,-729.06 559076.44,-735.18 559078.36,-728.45"/>
</g>
<!-- layer_12_expert_5_ep_4 -->
<g id="node1301" class="node">
<title>layer_12_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="559741.83,-729 559307.82,-729 559196.17,-625 559630.18,-625 559741.83,-729"/>
<text text-anchor="middle" x="559469" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="559469" y="-680" font-family="Arial" font-size="10.00">GPU: 453</text>
<text text-anchor="middle" x="559469" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="559469" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_5_ep_4 -->
<g id="edge2394" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M559654.8,-794.91C559624.51,-775.85 559589.95,-754.11 559558.92,-734.58"/>
<polygon fill="black" stroke="black" points="559560.6,-731.5 559550.27,-729.14 559556.87,-737.42 559560.6,-731.5"/>
</g>
<!-- layer_12_expert_6_ep_4 -->
<g id="node1302" class="node">
<title>layer_12_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="560304.83,-729 559870.82,-729 559759.17,-625 560193.18,-625 560304.83,-729"/>
<text text-anchor="middle" x="560032" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="560032" y="-680" font-family="Arial" font-size="10.00">GPU: 454</text>
<text text-anchor="middle" x="560032" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="560032" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_6_ep_4 -->
<g id="edge2395" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M559826.02,-794.91C559859.88,-775.69 559898.56,-753.73 559933.19,-734.08"/>
<polygon fill="black" stroke="black" points="559934.93,-737.12 559941.9,-729.14 559931.48,-731.03 559934.93,-737.12"/>
</g>
<!-- layer_12_expert_7_ep_4 -->
<g id="node1303" class="node">
<title>layer_12_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="562556.83,-729 562122.82,-729 562011.17,-625 562445.18,-625 562556.83,-729"/>
<text text-anchor="middle" x="562284" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="562284" y="-680" font-family="Arial" font-size="10.00">GPU: 455</text>
<text text-anchor="middle" x="562284" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="562284" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_4&#45;&gt;layer_12_expert_7_ep_4 -->
<g id="edge2396" class="edge">
<title>layer_12_route_ep_4&#45;&gt;layer_12_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M559962.79,-844.47C560456.52,-839.99 561615.44,-822.91 562003,-760 562042.89,-753.53 562085.1,-743.16 562124.35,-731.95"/>
<polygon fill="black" stroke="black" points="562125.63,-735.22 562134.27,-729.08 562123.69,-728.5 562125.63,-735.22"/>
</g>
<!-- layer_12_expert_0_ep_5 -->
<g id="node1304" class="node">
<title>layer_12_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="552422.83,-729 551988.82,-729 551877.17,-625 552311.18,-625 552422.83,-729"/>
<text text-anchor="middle" x="552150" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="552150" y="-680" font-family="Arial" font-size="10.00">GPU: 464</text>
<text text-anchor="middle" x="552150" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="552150" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_0_ep_5 -->
<g id="edge2397" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M554946.54,-846.25C554376.64,-845.68 552912.58,-836.54 552431,-760 552390.78,-753.61 552348.2,-743.18 552308.68,-731.87"/>
<polygon fill="black" stroke="black" points="552309.55,-728.48 552298.97,-729.06 552307.6,-735.2 552309.55,-728.48"/>
</g>
<!-- layer_12_expert_1_ep_5 -->
<g id="node1305" class="node">
<title>layer_12_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="552985.83,-729 552551.82,-729 552440.17,-625 552874.18,-625 552985.83,-729"/>
<text text-anchor="middle" x="552713" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="552713" y="-680" font-family="Arial" font-size="10.00">GPU: 465</text>
<text text-anchor="middle" x="552713" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="552713" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_1_ep_5 -->
<g id="edge2398" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M554944.11,-844.01C554460.85,-838.71 553363.43,-820.24 552994,-760 552954.12,-753.5 552911.9,-743.12 552872.65,-731.91"/>
<polygon fill="black" stroke="black" points="552873.32,-728.46 552862.74,-729.04 552871.37,-735.18 552873.32,-728.46"/>
</g>
<!-- layer_12_expert_2_ep_5 -->
<g id="node1306" class="node">
<title>layer_12_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="553548.83,-729 553114.82,-729 553003.17,-625 553437.18,-625 553548.83,-729"/>
<text text-anchor="middle" x="553276" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="553276" y="-680" font-family="Arial" font-size="10.00">GPU: 466</text>
<text text-anchor="middle" x="553276" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="553276" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_2_ep_5 -->
<g id="edge2399" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M554939.72,-840.13C554555.88,-829.5 553815.66,-804 553557,-760 553517.63,-753.3 553475.95,-742.99 553437.08,-731.91"/>
<polygon fill="black" stroke="black" points="553437.85,-728.49 553427.27,-729.08 553435.91,-735.21 553437.85,-728.49"/>
</g>
<!-- layer_12_expert_3_ep_5 -->
<g id="node1307" class="node">
<title>layer_12_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="554111.83,-729 553677.82,-729 553566.17,-625 554000.18,-625 554111.83,-729"/>
<text text-anchor="middle" x="553839" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="553839" y="-680" font-family="Arial" font-size="10.00">GPU: 467</text>
<text text-anchor="middle" x="553839" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="553839" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_3_ep_5 -->
<g id="edge2400" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M554940.1,-840.44C554724.69,-832.14 554398.82,-811.47 554120,-760 554081.53,-752.9 554040.79,-742.65 554002.62,-731.8"/>
<polygon fill="black" stroke="black" points="554003.55,-728.42 553992.98,-729.03 554001.62,-735.15 554003.55,-728.42"/>
</g>
<!-- layer_12_expert_4_ep_5 -->
<g id="node1308" class="node">
<title>layer_12_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="554674.83,-729 554240.82,-729 554129.17,-625 554563.18,-625 554674.83,-729"/>
<text text-anchor="middle" x="554402" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="554402" y="-680" font-family="Arial" font-size="10.00">GPU: 468</text>
<text text-anchor="middle" x="554402" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="554402" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_4_ep_5 -->
<g id="edge2401" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M554897.33,-802.91C554827.05,-790.55 554752,-776.02 554683,-760 554647.93,-751.86 554610.76,-741.94 554575.32,-731.86"/>
<polygon fill="black" stroke="black" points="554575.95,-728.4 554565.38,-729.01 554574.03,-735.13 554575.95,-728.4"/>
</g>
<!-- layer_12_expert_5_ep_5 -->
<g id="node1309" class="node">
<title>layer_12_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="555237.83,-729 554803.82,-729 554692.17,-625 555126.18,-625 555237.83,-729"/>
<text text-anchor="middle" x="554965" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="554965" y="-680" font-family="Arial" font-size="10.00">GPU: 469</text>
<text text-anchor="middle" x="554965" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="554965" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_5_ep_5 -->
<g id="edge2402" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M555112.53,-794.91C555088.89,-776.18 555061.97,-754.85 555037.66,-735.58"/>
<polygon fill="black" stroke="black" points="555039.54,-732.6 555029.53,-729.14 555035.19,-738.09 555039.54,-732.6"/>
</g>
<!-- layer_12_expert_6_ep_5 -->
<g id="node1310" class="node">
<title>layer_12_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="555800.83,-729 555366.82,-729 555255.17,-625 555689.18,-625 555800.83,-729"/>
<text text-anchor="middle" x="555528" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="555528" y="-680" font-family="Arial" font-size="10.00">GPU: 470</text>
<text text-anchor="middle" x="555528" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="555528" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_6_ep_5 -->
<g id="edge2403" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M555283.74,-794.91C555324.33,-775.48 555370.74,-753.27 555412.14,-733.46"/>
<polygon fill="black" stroke="black" points="555413.65,-736.61 555421.16,-729.14 555410.63,-730.3 555413.65,-736.61"/>
</g>
<!-- layer_12_expert_7_ep_5 -->
<g id="node1311" class="node">
<title>layer_12_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="556363.83,-729 555929.82,-729 555818.17,-625 556252.18,-625 556363.83,-729"/>
<text text-anchor="middle" x="556091" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="556091" y="-680" font-family="Arial" font-size="10.00">GPU: 471</text>
<text text-anchor="middle" x="556091" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="556091" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_5&#45;&gt;layer_12_expert_7_ep_5 -->
<g id="edge2404" class="edge">
<title>layer_12_route_ep_5&#45;&gt;layer_12_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M555382.52,-825.92C555507.02,-811.82 555668.57,-790.07 555810,-760 555846.39,-752.26 555884.95,-742.25 555921.46,-731.88"/>
<polygon fill="black" stroke="black" points="555922.54,-735.22 555931.19,-729.1 555920.61,-728.48 555922.54,-735.22"/>
</g>
<!-- layer_12_expert_0_ep_6 -->
<g id="node1312" class="node">
<title>layer_12_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="574942.83,-729 574508.82,-729 574397.17,-625 574831.18,-625 574942.83,-729"/>
<text text-anchor="middle" x="574670" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="574670" y="-680" font-family="Arial" font-size="10.00">GPU: 480</text>
<text text-anchor="middle" x="574670" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="574670" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_0_ep_6 -->
<g id="edge2405" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M575077.94,-794.91C575036.06,-783.58 574992,-771.51 574951,-760 574919.16,-751.06 574885.35,-741.37 574852.63,-731.89"/>
<polygon fill="black" stroke="black" points="574853.55,-728.51 574842.97,-729.08 574851.6,-735.23 574853.55,-728.51"/>
</g>
<!-- layer_12_expert_1_ep_6 -->
<g id="node1313" class="node">
<title>layer_12_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="575505.83,-729 575071.82,-729 574960.17,-625 575394.18,-625 575505.83,-729"/>
<text text-anchor="middle" x="575233" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="575233" y="-680" font-family="Arial" font-size="10.00">GPU: 481</text>
<text text-anchor="middle" x="575233" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="575233" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_1_ep_6 -->
<g id="edge2406" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M575258.7,-794.68C575254.82,-777.1 575250.45,-757.24 575246.43,-738.97"/>
<polygon fill="black" stroke="black" points="575249.8,-738.02 575244.23,-729 575242.97,-739.52 575249.8,-738.02"/>
</g>
<!-- layer_12_expert_2_ep_6 -->
<g id="node1314" class="node">
<title>layer_12_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="576068.83,-729 575634.82,-729 575523.17,-625 575957.18,-625 576068.83,-729"/>
<text text-anchor="middle" x="575796" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="575796" y="-680" font-family="Arial" font-size="10.00">GPU: 482</text>
<text text-anchor="middle" x="575796" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="575796" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_2_ep_6 -->
<g id="edge2407" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M575429.96,-794.91C575492.06,-775.08 575563.26,-752.34 575626.26,-732.21"/>
<polygon fill="black" stroke="black" points="575627.43,-735.51 575635.89,-729.14 575625.3,-728.84 575627.43,-735.51"/>
</g>
<!-- layer_12_expert_3_ep_6 -->
<g id="node1315" class="node">
<title>layer_12_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="576631.83,-729 576197.82,-729 576086.17,-625 576520.18,-625 576631.83,-729"/>
<text text-anchor="middle" x="576359" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="576359" y="-680" font-family="Arial" font-size="10.00">GPU: 483</text>
<text text-anchor="middle" x="576359" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="576359" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_3_ep_6 -->
<g id="edge2408" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M575484.63,-833.59C575648.36,-821.61 575878.88,-799.32 576078,-760 576115.41,-752.61 576155.04,-742.51 576192.37,-731.92"/>
<polygon fill="black" stroke="black" points="576193.66,-735.19 576202.31,-729.07 576191.74,-728.46 576193.66,-735.19"/>
</g>
<!-- layer_12_expert_4_ep_6 -->
<g id="node1316" class="node">
<title>layer_12_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="577194.83,-729 576760.82,-729 576649.17,-625 577083.18,-625 577194.83,-729"/>
<text text-anchor="middle" x="576922" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="576922" y="-680" font-family="Arial" font-size="10.00">GPU: 484</text>
<text text-anchor="middle" x="576922" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="576922" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_4_ep_6 -->
<g id="edge2409" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M575483.27,-832.77C575866.79,-808.96 576633.95,-761.23 576641,-760 576680.11,-753.15 576721.52,-742.85 576760.19,-731.83"/>
<polygon fill="black" stroke="black" points="576761.31,-735.15 576769.95,-729.02 576759.37,-728.43 576761.31,-735.15"/>
</g>
<!-- layer_12_expert_5_ep_6 -->
<g id="node1317" class="node">
<title>layer_12_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="577757.83,-729 577323.82,-729 577212.17,-625 577646.18,-625 577757.83,-729"/>
<text text-anchor="middle" x="577485" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="577485" y="-680" font-family="Arial" font-size="10.00">GPU: 485</text>
<text text-anchor="middle" x="577485" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="577485" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_5_ep_6 -->
<g id="edge2410" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M575481.51,-831.2C575648.54,-819.94 575887.57,-804.77 576097,-795 576342.86,-783.54 576960.93,-798.67 577204,-760 577244.22,-753.6 577286.8,-743.17 577326.32,-731.86"/>
<polygon fill="black" stroke="black" points="577327.39,-735.2 577336.03,-729.05 577325.45,-728.47 577327.39,-735.2"/>
</g>
<!-- layer_12_expert_6_ep_6 -->
<g id="node1318" class="node">
<title>layer_12_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="578320.83,-729 577886.82,-729 577775.17,-625 578209.18,-625 578320.83,-729"/>
<text text-anchor="middle" x="578048" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="578048" y="-680" font-family="Arial" font-size="10.00">GPU: 486</text>
<text text-anchor="middle" x="578048" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="578048" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_6_ep_6 -->
<g id="edge2411" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M575481.05,-830.44C575648.08,-818.75 575887.33,-803.35 576097,-795 576467.9,-780.22 577400.23,-817.16 577767,-760 577807.47,-753.69 577850.32,-743.23 577890.03,-731.85"/>
<polygon fill="black" stroke="black" points="577891.15,-735.17 577899.78,-729.02 577889.2,-728.44 577891.15,-735.17"/>
</g>
<!-- layer_12_expert_7_ep_6 -->
<g id="node1319" class="node">
<title>layer_12_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="578883.83,-729 578449.82,-729 578338.17,-625 578772.18,-625 578883.83,-729"/>
<text text-anchor="middle" x="578611" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="578611" y="-680" font-family="Arial" font-size="10.00">GPU: 487</text>
<text text-anchor="middle" x="578611" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="578611" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_6&#45;&gt;layer_12_expert_7_ep_6 -->
<g id="edge2412" class="edge">
<title>layer_12_route_ep_6&#45;&gt;layer_12_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M575480.6,-830.1C575647.65,-818.19 575887.12,-802.68 576097,-795 576790.36,-769.64 576964.29,-789.77 577658,-777 577956.71,-771.5 578034.8,-806.01 578330,-760 578370.47,-753.69 578413.32,-743.23 578453.03,-731.85"/>
<polygon fill="black" stroke="black" points="578454.15,-735.17 578462.78,-729.02 578452.2,-728.44 578454.15,-735.17"/>
</g>
<!-- layer_12_expert_0_ep_7 -->
<g id="node1320" class="node">
<title>layer_12_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="570438.83,-729 570004.82,-729 569893.17,-625 570327.18,-625 570438.83,-729"/>
<text text-anchor="middle" x="570166" y="-691" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="570166" y="-680" font-family="Arial" font-size="10.00">GPU: 496</text>
<text text-anchor="middle" x="570166" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="570166" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_0_ep_7 -->
<g id="edge2413" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M570838.66,-820.93C570718.74,-807 570574.87,-786.94 570447,-760 570410.48,-752.31 570371.79,-742.28 570335.18,-731.89"/>
<polygon fill="black" stroke="black" points="570335.99,-728.48 570325.42,-729.1 570334.07,-735.21 570335.99,-728.48"/>
</g>
<!-- layer_12_expert_1_ep_7 -->
<g id="node1321" class="node">
<title>layer_12_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="571001.83,-729 570567.82,-729 570456.17,-625 570890.18,-625 571001.83,-729"/>
<text text-anchor="middle" x="570729" y="-691" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="570729" y="-680" font-family="Arial" font-size="10.00">GPU: 497</text>
<text text-anchor="middle" x="570729" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="570729" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_1_ep_7 -->
<g id="edge2414" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M570985.78,-794.91C570943.03,-775.44 570894.12,-753.17 570850.53,-733.33"/>
<polygon fill="black" stroke="black" points="570851.87,-730.09 570841.32,-729.14 570848.97,-736.47 570851.87,-730.09"/>
</g>
<!-- layer_12_expert_2_ep_7 -->
<g id="node1322" class="node">
<title>layer_12_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="571564.83,-729 571130.82,-729 571019.17,-625 571453.18,-625 571564.83,-729"/>
<text text-anchor="middle" x="571292" y="-691" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="571292" y="-680" font-family="Arial" font-size="10.00">GPU: 498</text>
<text text-anchor="middle" x="571292" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="571292" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_2_ep_7 -->
<g id="edge2415" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M571157,-794.91C571178.54,-776.26 571203.04,-755.03 571225.21,-735.83"/>
<polygon fill="black" stroke="black" points="571227.68,-738.33 571232.95,-729.14 571223.1,-733.04 571227.68,-738.33"/>
</g>
<!-- layer_12_expert_3_ep_7 -->
<g id="node1323" class="node">
<title>layer_12_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="572127.83,-729 571693.82,-729 571582.17,-625 572016.18,-625 572127.83,-729"/>
<text text-anchor="middle" x="571855" y="-691" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="571855" y="-680" font-family="Arial" font-size="10.00">GPU: 499</text>
<text text-anchor="middle" x="571855" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="571855" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_3_ep_7 -->
<g id="edge2416" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M571292.05,-815.7C571378.75,-800.93 571481.94,-781.69 571574,-760 571609.49,-751.64 571647.17,-741.52 571683.01,-731.29"/>
<polygon fill="black" stroke="black" points="571684.42,-734.53 571693.06,-728.41 571682.49,-727.8 571684.42,-734.53"/>
</g>
<!-- layer_12_expert_4_ep_7 -->
<g id="node1324" class="node">
<title>layer_12_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="572690.83,-729 572256.82,-729 572145.17,-625 572579.18,-625 572690.83,-729"/>
<text text-anchor="middle" x="572418" y="-691" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="572418" y="-680" font-family="Arial" font-size="10.00">GPU: 500</text>
<text text-anchor="middle" x="572418" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="572418" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_4_ep_7 -->
<g id="edge2417" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M571320.13,-840.54C571531.68,-832.3 571858.26,-811.66 572137,-760 572175.35,-752.89 572215.96,-742.68 572254.03,-731.86"/>
<polygon fill="black" stroke="black" points="572255,-735.22 572263.65,-729.09 572253.07,-728.49 572255,-735.22"/>
</g>
<!-- layer_12_expert_5_ep_7 -->
<g id="node1325" class="node">
<title>layer_12_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="573253.83,-729 572819.82,-729 572708.17,-625 573142.18,-625 573253.83,-729"/>
<text text-anchor="middle" x="572981" y="-691" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="572981" y="-680" font-family="Arial" font-size="10.00">GPU: 501</text>
<text text-anchor="middle" x="572981" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="572981" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_5_ep_7 -->
<g id="edge2418" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M571311.87,-833.09C571586.93,-816.71 572079.45,-788.19 572501,-768 572589.41,-763.77 572612.64,-774.28 572700,-760 572739.88,-753.48 572782.09,-743.1 572821.34,-731.89"/>
<polygon fill="black" stroke="black" points="572822.62,-735.16 572831.26,-729.02 572820.68,-728.44 572822.62,-735.16"/>
</g>
<!-- layer_12_expert_6_ep_7 -->
<g id="node1326" class="node">
<title>layer_12_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="573816.83,-729 573382.82,-729 573271.17,-625 573705.18,-625 573816.83,-729"/>
<text text-anchor="middle" x="573544" y="-691" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="573544" y="-680" font-family="Arial" font-size="10.00">GPU: 502</text>
<text text-anchor="middle" x="573544" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="573544" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_6_ep_7 -->
<g id="edge2419" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M571313.45,-834.41C571682,-814.74 572418.77,-776.17 572678,-768 572742.97,-765.95 573198.71,-769.64 573263,-760 573303.86,-753.87 573347.1,-743.37 573387.1,-731.89"/>
<polygon fill="black" stroke="black" points="573388.3,-735.18 573396.93,-729.03 573386.35,-728.46 573388.3,-735.18"/>
</g>
<!-- layer_12_expert_7_ep_7 -->
<g id="node1327" class="node">
<title>layer_12_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="574379.83,-729 573945.82,-729 573834.17,-625 574268.18,-625 574379.83,-729"/>
<text text-anchor="middle" x="574107" y="-691" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="574107" y="-680" font-family="Arial" font-size="10.00">GPU: 503</text>
<text text-anchor="middle" x="574107" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="574107" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_12_route_ep_7&#45;&gt;layer_12_expert_7_ep_7 -->
<g id="edge2420" class="edge">
<title>layer_12_route_ep_7&#45;&gt;layer_12_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M571326.69,-846.2C571892.67,-845.5 573347.51,-836.1 573826,-760 573866.22,-753.6 573908.8,-743.17 573948.32,-731.87"/>
<polygon fill="black" stroke="black" points="573949.39,-735.2 573958.03,-729.05 573947.45,-728.47 573949.39,-735.2"/>
</g>
<!-- layer_12_agg_ep_0 -->
<g id="node1328" class="node">
<title>layer_12_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="545677.07,-559 545226.77,-559 545110.93,-455 545561.23,-455 545677.07,-559"/>
<text text-anchor="middle" x="545394" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="545394" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="545394" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="545394" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2421" class="edge">
<title>layer_12_expert_0_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M543319.89,-640.38C543354.01,-634.5 543389.52,-629.02 543423,-625 544050.39,-549.72 544796.2,-522.19 545164.6,-512.68"/>
<polygon fill="black" stroke="black" points="545164.94,-516.17 545174.85,-512.41 545164.76,-509.17 545164.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2422" class="edge">
<title>layer_12_expert_1_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M543883.35,-640.96C543917.34,-635.04 543952.7,-629.4 543986,-625 544403.36,-569.92 544893.96,-536.1 545172,-519.8"/>
<polygon fill="black" stroke="black" points="545172.43,-523.28 545182.21,-519.2 545172.02,-516.29 545172.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2423" class="edge">
<title>layer_12_expert_2_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M544447.69,-642.23C544481.32,-636.24 544516.2,-630.25 544549,-625 544766.23,-590.26 545015.86,-556.45 545187.16,-534.18"/>
<polygon fill="black" stroke="black" points="545187.83,-537.62 545197.3,-532.86 545186.93,-530.68 545187.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2424" class="edge">
<title>layer_12_expert_3_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M544994.6,-627.18C545063.9,-606.5 545144.84,-582.35 545215.67,-561.21"/>
<polygon fill="black" stroke="black" points="545217.01,-564.47 545225.59,-558.25 545215.01,-557.76 545217.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2425" class="edge">
<title>layer_12_expert_4_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M545394,-624.68C545394,-607.18 545394,-587.43 545394,-569.22"/>
<polygon fill="black" stroke="black" points="545397.5,-569 545394,-559 545390.5,-569 545397.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2426" class="edge">
<title>layer_12_expert_5_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M545785.79,-624.91C545719.19,-605.04 545642.8,-582.24 545575.26,-562.09"/>
<polygon fill="black" stroke="black" points="545575.95,-558.64 545565.37,-559.14 545573.95,-565.35 545575.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2427" class="edge">
<title>layer_12_expert_6_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M546248.6,-626.55C546245.38,-626.02 546242.18,-625.51 546239,-625 546048.84,-594.59 545833.86,-564.89 545668.33,-543.02"/>
<polygon fill="black" stroke="black" points="545668.37,-539.5 545658,-541.66 545667.45,-546.44 545668.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_0&#45;&gt;layer_12_agg_ep_0 -->
<g id="edge2428" class="edge">
<title>layer_12_expert_7_ep_0&#45;&gt;layer_12_agg_ep_0</title>
<path fill="none" stroke="black" d="M546811.27,-626.25C546808.16,-625.82 546805.07,-625.41 546802,-625 546398.9,-571.8 545927.48,-538.44 545645.24,-521.53"/>
<polygon fill="black" stroke="black" points="545645.05,-518.01 545634.86,-520.91 545644.63,-525 545645.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_1 -->
<g id="node1329" class="node">
<title>layer_12_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="568197.07,-559 567746.77,-559 567630.93,-455 568081.23,-455 568197.07,-559"/>
<text text-anchor="middle" x="567914" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="567914" y="-510" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="567914" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="567914" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2430" class="edge">
<title>layer_12_expert_0_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M565839.89,-640.38C565874.01,-634.5 565909.52,-629.02 565943,-625 566570.39,-549.72 567316.2,-522.19 567684.6,-512.68"/>
<polygon fill="black" stroke="black" points="567684.94,-516.17 567694.85,-512.41 567684.76,-509.17 567684.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2431" class="edge">
<title>layer_12_expert_1_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M566403.35,-640.96C566437.34,-635.04 566472.7,-629.4 566506,-625 566923.36,-569.92 567413.96,-536.1 567692,-519.8"/>
<polygon fill="black" stroke="black" points="567692.43,-523.28 567702.21,-519.2 567692.02,-516.29 567692.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2432" class="edge">
<title>layer_12_expert_2_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M566967.69,-642.23C567001.32,-636.24 567036.2,-630.25 567069,-625 567286.23,-590.26 567535.86,-556.45 567707.16,-534.18"/>
<polygon fill="black" stroke="black" points="567707.83,-537.62 567717.3,-532.86 567706.93,-530.68 567707.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2433" class="edge">
<title>layer_12_expert_3_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M567514.6,-627.18C567583.9,-606.5 567664.84,-582.35 567735.67,-561.21"/>
<polygon fill="black" stroke="black" points="567737.01,-564.47 567745.59,-558.25 567735.01,-557.76 567737.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2434" class="edge">
<title>layer_12_expert_4_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M567914,-624.68C567914,-607.18 567914,-587.43 567914,-569.22"/>
<polygon fill="black" stroke="black" points="567917.5,-569 567914,-559 567910.5,-569 567917.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2435" class="edge">
<title>layer_12_expert_5_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M568305.79,-624.91C568239.19,-605.04 568162.8,-582.24 568095.26,-562.09"/>
<polygon fill="black" stroke="black" points="568095.95,-558.64 568085.37,-559.14 568093.95,-565.35 568095.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2436" class="edge">
<title>layer_12_expert_6_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M568768.6,-626.55C568765.38,-626.02 568762.18,-625.51 568759,-625 568568.84,-594.59 568353.86,-564.89 568188.33,-543.02"/>
<polygon fill="black" stroke="black" points="568188.37,-539.5 568178,-541.66 568187.45,-546.44 568188.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_1&#45;&gt;layer_12_agg_ep_1 -->
<g id="edge2437" class="edge">
<title>layer_12_expert_7_ep_1&#45;&gt;layer_12_agg_ep_1</title>
<path fill="none" stroke="black" d="M569331.27,-626.25C569328.16,-625.82 569325.07,-625.41 569322,-625 568918.9,-571.8 568447.48,-538.44 568165.24,-521.53"/>
<polygon fill="black" stroke="black" points="568165.05,-518.01 568154.86,-520.91 568164.63,-525 568165.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_2 -->
<g id="node1330" class="node">
<title>layer_12_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="550181.07,-559 549730.77,-559 549614.93,-455 550065.23,-455 550181.07,-559"/>
<text text-anchor="middle" x="549898" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="549898" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="549898" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="549898" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2439" class="edge">
<title>layer_12_expert_0_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M547823.89,-640.38C547858.01,-634.5 547893.52,-629.02 547927,-625 548554.39,-549.72 549300.2,-522.19 549668.6,-512.68"/>
<polygon fill="black" stroke="black" points="549668.94,-516.17 549678.85,-512.41 549668.76,-509.17 549668.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2440" class="edge">
<title>layer_12_expert_1_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M548387.35,-640.96C548421.34,-635.04 548456.7,-629.4 548490,-625 548907.36,-569.92 549397.96,-536.1 549676,-519.8"/>
<polygon fill="black" stroke="black" points="549676.43,-523.28 549686.21,-519.2 549676.02,-516.29 549676.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2441" class="edge">
<title>layer_12_expert_2_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M548951.69,-642.23C548985.32,-636.24 549020.2,-630.25 549053,-625 549270.23,-590.26 549519.86,-556.45 549691.16,-534.18"/>
<polygon fill="black" stroke="black" points="549691.83,-537.62 549701.3,-532.86 549690.93,-530.68 549691.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2442" class="edge">
<title>layer_12_expert_3_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M549498.6,-627.18C549567.9,-606.5 549648.84,-582.35 549719.67,-561.21"/>
<polygon fill="black" stroke="black" points="549721.01,-564.47 549729.59,-558.25 549719.01,-557.76 549721.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2443" class="edge">
<title>layer_12_expert_4_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M549898,-624.68C549898,-607.18 549898,-587.43 549898,-569.22"/>
<polygon fill="black" stroke="black" points="549901.5,-569 549898,-559 549894.5,-569 549901.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2444" class="edge">
<title>layer_12_expert_5_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M550289.79,-624.91C550223.19,-605.04 550146.8,-582.24 550079.26,-562.09"/>
<polygon fill="black" stroke="black" points="550079.95,-558.64 550069.37,-559.14 550077.95,-565.35 550079.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2445" class="edge">
<title>layer_12_expert_6_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M550752.6,-626.55C550749.38,-626.02 550746.18,-625.51 550743,-625 550552.84,-594.59 550337.86,-564.89 550172.33,-543.02"/>
<polygon fill="black" stroke="black" points="550172.37,-539.5 550162,-541.66 550171.45,-546.44 550172.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_2&#45;&gt;layer_12_agg_ep_2 -->
<g id="edge2446" class="edge">
<title>layer_12_expert_7_ep_2&#45;&gt;layer_12_agg_ep_2</title>
<path fill="none" stroke="black" d="M551315.27,-626.25C551312.16,-625.82 551309.07,-625.41 551306,-625 550902.9,-571.8 550431.48,-538.44 550149.24,-521.53"/>
<polygon fill="black" stroke="black" points="550149.05,-518.01 550138.86,-520.91 550148.63,-525 550149.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_3 -->
<g id="node1331" class="node">
<title>layer_12_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="563693.07,-559 563242.77,-559 563126.93,-455 563577.23,-455 563693.07,-559"/>
<text text-anchor="middle" x="563410" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="563410" y="-510" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="563410" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="563410" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2448" class="edge">
<title>layer_12_expert_0_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M560772.48,-640.09C560806.71,-634.21 560842.38,-628.81 560876,-625 561718.79,-529.49 562727.69,-511.47 563175.76,-508.4"/>
<polygon fill="black" stroke="black" points="563175.93,-511.9 563185.91,-508.33 563175.89,-504.9 563175.93,-511.9"/>
</g>
<!-- layer_12_expert_1_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2449" class="edge">
<title>layer_12_expert_1_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M561335.89,-640.38C561370.01,-634.5 561405.52,-629.02 561439,-625 562066.39,-549.72 562812.2,-522.19 563180.6,-512.68"/>
<polygon fill="black" stroke="black" points="563180.94,-516.17 563190.85,-512.41 563180.76,-509.17 563180.94,-516.17"/>
</g>
<!-- layer_12_expert_2_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2450" class="edge">
<title>layer_12_expert_2_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M561899.35,-640.96C561933.34,-635.04 561968.7,-629.4 562002,-625 562419.36,-569.92 562909.96,-536.1 563188,-519.8"/>
<polygon fill="black" stroke="black" points="563188.43,-523.28 563198.21,-519.2 563188.02,-516.29 563188.43,-523.28"/>
</g>
<!-- layer_12_expert_3_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2451" class="edge">
<title>layer_12_expert_3_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M563010.6,-627.18C563079.9,-606.5 563160.84,-582.35 563231.67,-561.21"/>
<polygon fill="black" stroke="black" points="563233.01,-564.47 563241.59,-558.25 563231.01,-557.76 563233.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2452" class="edge">
<title>layer_12_expert_4_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M563410,-624.68C563410,-607.18 563410,-587.43 563410,-569.22"/>
<polygon fill="black" stroke="black" points="563413.5,-569 563410,-559 563406.5,-569 563413.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2453" class="edge">
<title>layer_12_expert_5_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M563801.79,-624.91C563735.19,-605.04 563658.8,-582.24 563591.26,-562.09"/>
<polygon fill="black" stroke="black" points="563591.95,-558.64 563581.37,-559.14 563589.95,-565.35 563591.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2454" class="edge">
<title>layer_12_expert_6_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M564264.6,-626.55C564261.38,-626.02 564258.18,-625.51 564255,-625 564064.84,-594.59 563849.86,-564.89 563684.33,-543.02"/>
<polygon fill="black" stroke="black" points="563684.37,-539.5 563674,-541.66 563683.45,-546.44 563684.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_3&#45;&gt;layer_12_agg_ep_3 -->
<g id="edge2455" class="edge">
<title>layer_12_expert_7_ep_3&#45;&gt;layer_12_agg_ep_3</title>
<path fill="none" stroke="black" d="M564827.27,-626.25C564824.16,-625.82 564821.07,-625.41 564818,-625 564414.9,-571.8 563943.48,-538.44 563661.24,-521.53"/>
<polygon fill="black" stroke="black" points="563661.05,-518.01 563650.86,-520.91 563660.63,-525 563661.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_4 -->
<g id="node1332" class="node">
<title>layer_12_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="559189.07,-559 558738.77,-559 558622.93,-455 559073.23,-455 559189.07,-559"/>
<text text-anchor="middle" x="558906" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="558906" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="558906" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="558906" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2457" class="edge">
<title>layer_12_expert_0_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M556831.89,-640.38C556866.01,-634.5 556901.52,-629.02 556935,-625 557562.39,-549.72 558308.2,-522.19 558676.6,-512.68"/>
<polygon fill="black" stroke="black" points="558676.94,-516.17 558686.85,-512.41 558676.76,-509.17 558676.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2458" class="edge">
<title>layer_12_expert_1_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M557395.35,-640.96C557429.34,-635.04 557464.7,-629.4 557498,-625 557915.36,-569.92 558405.96,-536.1 558684,-519.8"/>
<polygon fill="black" stroke="black" points="558684.43,-523.28 558694.21,-519.2 558684.02,-516.29 558684.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2459" class="edge">
<title>layer_12_expert_2_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M557959.69,-642.23C557993.32,-636.24 558028.2,-630.25 558061,-625 558278.23,-590.26 558527.86,-556.45 558699.16,-534.18"/>
<polygon fill="black" stroke="black" points="558699.83,-537.62 558709.3,-532.86 558698.93,-530.68 558699.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2460" class="edge">
<title>layer_12_expert_3_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M558506.6,-627.18C558575.9,-606.5 558656.84,-582.35 558727.67,-561.21"/>
<polygon fill="black" stroke="black" points="558729.01,-564.47 558737.59,-558.25 558727.01,-557.76 558729.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2461" class="edge">
<title>layer_12_expert_4_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M558906,-624.68C558906,-607.18 558906,-587.43 558906,-569.22"/>
<polygon fill="black" stroke="black" points="558909.5,-569 558906,-559 558902.5,-569 558909.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2462" class="edge">
<title>layer_12_expert_5_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M559297.79,-624.91C559231.19,-605.04 559154.8,-582.24 559087.26,-562.09"/>
<polygon fill="black" stroke="black" points="559087.95,-558.64 559077.37,-559.14 559085.95,-565.35 559087.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2463" class="edge">
<title>layer_12_expert_6_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M559760.6,-626.55C559757.38,-626.02 559754.18,-625.51 559751,-625 559560.84,-594.59 559345.86,-564.89 559180.33,-543.02"/>
<polygon fill="black" stroke="black" points="559180.37,-539.5 559170,-541.66 559179.45,-546.44 559180.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_4&#45;&gt;layer_12_agg_ep_4 -->
<g id="edge2464" class="edge">
<title>layer_12_expert_7_ep_4&#45;&gt;layer_12_agg_ep_4</title>
<path fill="none" stroke="black" d="M562012.29,-626.05C562009.18,-625.69 562006.08,-625.34 562003,-625 561450.95,-564.78 559775.66,-525.61 559147.41,-512.69"/>
<polygon fill="black" stroke="black" points="559147.39,-509.19 559137.32,-512.48 559147.25,-516.19 559147.39,-509.19"/>
</g>
<!-- layer_12_agg_ep_5 -->
<g id="node1333" class="node">
<title>layer_12_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="554685.07,-559 554234.77,-559 554118.93,-455 554569.23,-455 554685.07,-559"/>
<text text-anchor="middle" x="554402" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="554402" y="-510" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="554402" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="554402" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2466" class="edge">
<title>layer_12_expert_0_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M552327.89,-640.38C552362.01,-634.5 552397.52,-629.02 552431,-625 553058.39,-549.72 553804.2,-522.19 554172.6,-512.68"/>
<polygon fill="black" stroke="black" points="554172.94,-516.17 554182.85,-512.41 554172.76,-509.17 554172.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2467" class="edge">
<title>layer_12_expert_1_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M552891.35,-640.96C552925.34,-635.04 552960.7,-629.4 552994,-625 553411.36,-569.92 553901.96,-536.1 554180,-519.8"/>
<polygon fill="black" stroke="black" points="554180.43,-523.28 554190.21,-519.2 554180.02,-516.29 554180.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2468" class="edge">
<title>layer_12_expert_2_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M553455.69,-642.23C553489.32,-636.24 553524.2,-630.25 553557,-625 553774.23,-590.26 554023.86,-556.45 554195.16,-534.18"/>
<polygon fill="black" stroke="black" points="554195.83,-537.62 554205.3,-532.86 554194.93,-530.68 554195.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2469" class="edge">
<title>layer_12_expert_3_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M554002.6,-627.18C554071.9,-606.5 554152.84,-582.35 554223.67,-561.21"/>
<polygon fill="black" stroke="black" points="554225.01,-564.47 554233.59,-558.25 554223.01,-557.76 554225.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2470" class="edge">
<title>layer_12_expert_4_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M554402,-624.68C554402,-607.18 554402,-587.43 554402,-569.22"/>
<polygon fill="black" stroke="black" points="554405.5,-569 554402,-559 554398.5,-569 554405.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2471" class="edge">
<title>layer_12_expert_5_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M554793.79,-624.91C554727.19,-605.04 554650.8,-582.24 554583.26,-562.09"/>
<polygon fill="black" stroke="black" points="554583.95,-558.64 554573.37,-559.14 554581.95,-565.35 554583.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2472" class="edge">
<title>layer_12_expert_6_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M555256.6,-626.55C555253.38,-626.02 555250.18,-625.51 555247,-625 555056.84,-594.59 554841.86,-564.89 554676.33,-543.02"/>
<polygon fill="black" stroke="black" points="554676.37,-539.5 554666,-541.66 554675.45,-546.44 554676.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_5&#45;&gt;layer_12_agg_ep_5 -->
<g id="edge2473" class="edge">
<title>layer_12_expert_7_ep_5&#45;&gt;layer_12_agg_ep_5</title>
<path fill="none" stroke="black" d="M555819.27,-626.25C555816.16,-625.82 555813.07,-625.41 555810,-625 555406.9,-571.8 554935.48,-538.44 554653.24,-521.53"/>
<polygon fill="black" stroke="black" points="554653.05,-518.01 554642.86,-520.91 554652.63,-525 554653.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_6 -->
<g id="node1334" class="node">
<title>layer_12_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="577205.07,-559 576754.77,-559 576638.93,-455 577089.23,-455 577205.07,-559"/>
<text text-anchor="middle" x="576922" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="576922" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="576922" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="576922" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2475" class="edge">
<title>layer_12_expert_0_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M574847.89,-640.38C574882.01,-634.5 574917.52,-629.02 574951,-625 575578.39,-549.72 576324.2,-522.19 576692.6,-512.68"/>
<polygon fill="black" stroke="black" points="576692.94,-516.17 576702.85,-512.41 576692.76,-509.17 576692.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2476" class="edge">
<title>layer_12_expert_1_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M575411.35,-640.96C575445.34,-635.04 575480.7,-629.4 575514,-625 575931.36,-569.92 576421.96,-536.1 576700,-519.8"/>
<polygon fill="black" stroke="black" points="576700.43,-523.28 576710.21,-519.2 576700.02,-516.29 576700.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2477" class="edge">
<title>layer_12_expert_2_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M575975.69,-642.23C576009.32,-636.24 576044.2,-630.25 576077,-625 576294.23,-590.26 576543.86,-556.45 576715.16,-534.18"/>
<polygon fill="black" stroke="black" points="576715.83,-537.62 576725.3,-532.86 576714.93,-530.68 576715.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2478" class="edge">
<title>layer_12_expert_3_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M576522.6,-627.18C576591.9,-606.5 576672.84,-582.35 576743.67,-561.21"/>
<polygon fill="black" stroke="black" points="576745.01,-564.47 576753.59,-558.25 576743.01,-557.76 576745.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2479" class="edge">
<title>layer_12_expert_4_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M576922,-624.68C576922,-607.18 576922,-587.43 576922,-569.22"/>
<polygon fill="black" stroke="black" points="576925.5,-569 576922,-559 576918.5,-569 576925.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2480" class="edge">
<title>layer_12_expert_5_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M577313.79,-624.91C577247.19,-605.04 577170.8,-582.24 577103.26,-562.09"/>
<polygon fill="black" stroke="black" points="577103.95,-558.64 577093.37,-559.14 577101.95,-565.35 577103.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2481" class="edge">
<title>layer_12_expert_6_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M577776.6,-626.55C577773.38,-626.02 577770.18,-625.51 577767,-625 577576.84,-594.59 577361.86,-564.89 577196.33,-543.02"/>
<polygon fill="black" stroke="black" points="577196.37,-539.5 577186,-541.66 577195.45,-546.44 577196.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_6&#45;&gt;layer_12_agg_ep_6 -->
<g id="edge2482" class="edge">
<title>layer_12_expert_7_ep_6&#45;&gt;layer_12_agg_ep_6</title>
<path fill="none" stroke="black" d="M578339.27,-626.25C578336.16,-625.82 578333.07,-625.41 578330,-625 577926.9,-571.8 577455.48,-538.44 577173.24,-521.53"/>
<polygon fill="black" stroke="black" points="577173.05,-518.01 577162.86,-520.91 577172.63,-525 577173.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_7 -->
<g id="node1335" class="node">
<title>layer_12_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="572701.07,-559 572250.77,-559 572134.93,-455 572585.23,-455 572701.07,-559"/>
<text text-anchor="middle" x="572418" y="-521" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="572418" y="-510" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="572418" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="572418" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_expert_0_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2484" class="edge">
<title>layer_12_expert_0_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M570343.89,-640.38C570378.01,-634.5 570413.52,-629.02 570447,-625 571074.39,-549.72 571820.2,-522.19 572188.6,-512.68"/>
<polygon fill="black" stroke="black" points="572188.94,-516.17 572198.85,-512.41 572188.76,-509.17 572188.94,-516.17"/>
</g>
<!-- layer_12_expert_1_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2485" class="edge">
<title>layer_12_expert_1_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M570907.35,-640.96C570941.34,-635.04 570976.7,-629.4 571010,-625 571427.36,-569.92 571917.96,-536.1 572196,-519.8"/>
<polygon fill="black" stroke="black" points="572196.43,-523.28 572206.21,-519.2 572196.02,-516.29 572196.43,-523.28"/>
</g>
<!-- layer_12_expert_2_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2486" class="edge">
<title>layer_12_expert_2_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M571471.69,-642.23C571505.32,-636.24 571540.2,-630.25 571573,-625 571790.23,-590.26 572039.86,-556.45 572211.16,-534.18"/>
<polygon fill="black" stroke="black" points="572211.83,-537.62 572221.3,-532.86 572210.93,-530.68 572211.83,-537.62"/>
</g>
<!-- layer_12_expert_3_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2487" class="edge">
<title>layer_12_expert_3_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M572018.6,-627.18C572087.9,-606.5 572168.84,-582.35 572239.67,-561.21"/>
<polygon fill="black" stroke="black" points="572241.01,-564.47 572249.59,-558.25 572239.01,-557.76 572241.01,-564.47"/>
</g>
<!-- layer_12_expert_4_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2488" class="edge">
<title>layer_12_expert_4_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M572418,-624.68C572418,-607.18 572418,-587.43 572418,-569.22"/>
<polygon fill="black" stroke="black" points="572421.5,-569 572418,-559 572414.5,-569 572421.5,-569"/>
</g>
<!-- layer_12_expert_5_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2489" class="edge">
<title>layer_12_expert_5_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M572809.79,-624.91C572743.19,-605.04 572666.8,-582.24 572599.26,-562.09"/>
<polygon fill="black" stroke="black" points="572599.95,-558.64 572589.37,-559.14 572597.95,-565.35 572599.95,-558.64"/>
</g>
<!-- layer_12_expert_6_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2490" class="edge">
<title>layer_12_expert_6_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M573272.6,-626.55C573269.38,-626.02 573266.18,-625.51 573263,-625 573072.84,-594.59 572857.86,-564.89 572692.33,-543.02"/>
<polygon fill="black" stroke="black" points="572692.37,-539.5 572682,-541.66 572691.45,-546.44 572692.37,-539.5"/>
</g>
<!-- layer_12_expert_7_ep_7&#45;&gt;layer_12_agg_ep_7 -->
<g id="edge2491" class="edge">
<title>layer_12_expert_7_ep_7&#45;&gt;layer_12_agg_ep_7</title>
<path fill="none" stroke="black" d="M573835.27,-626.25C573832.16,-625.82 573829.07,-625.41 573826,-625 573422.9,-571.8 572951.48,-538.44 572669.24,-521.53"/>
<polygon fill="black" stroke="black" points="572669.05,-518.01 572658.86,-520.91 572668.63,-525 572669.05,-518.01"/>
</g>
<!-- layer_12_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2429" class="edge">
<title>layer_12_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M545613.51,-501.87C546237.95,-490.33 548077.81,-457.95 549606,-447 549606,-447 580929,-437 580929,-437 580986.19,-379.79 580813.09,-459.36 580749,-410 580702.76,-374.39 580750.26,-321.25 580703,-287 580639.65,-241.09 579500.07,-223.61 579138.27,-219.2"/>
<polygon fill="black" stroke="black" points="579138.1,-215.7 579128.06,-219.08 579138.01,-222.7 579138.1,-215.7"/>
</g>
<!-- layer_12_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2438" class="edge">
<title>layer_12_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M568133.51,-501.93C568757.96,-490.56 570597.81,-458.56 572126,-447 572141.5,-446.88 581043.05,-447.97 581054,-437 581056.83,-434.17 581056.6,-431.04 581054,-428 581020.37,-388.69 580979.09,-442.69 580939,-410 580893.77,-373.12 580940.33,-321.15 580893,-287 580821.58,-235.47 579525.18,-221.69 579137.57,-218.71"/>
<polygon fill="black" stroke="black" points="579137.5,-215.21 579127.48,-218.64 579137.45,-222.21 579137.5,-215.21"/>
</g>
<!-- layer_12_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2447" class="edge">
<title>layer_12_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M550117.51,-501.87C550741.95,-490.35 552581.81,-457.99 554110,-447 554110,-447 580954,-437 580954,-437 580956.83,-434.17 580956.67,-430.98 580954,-428 580929.06,-400.23 580816.48,-432.89 580787,-410 580740.9,-374.21 580788.28,-321.22 580741,-287 580676.02,-239.96 579504.81,-223.2 579137.94,-219.09"/>
<polygon fill="black" stroke="black" points="579137.88,-215.59 579127.85,-218.98 579137.81,-222.59 579137.88,-215.59"/>
</g>
<!-- layer_12_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2456" class="edge">
<title>layer_12_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M563629.51,-501.9C564253.95,-490.46 566093.81,-458.27 567622,-447 567633.62,-446.91 580995.79,-445.22 581004,-437 581006.83,-434.17 581006.57,-431.06 581004,-428 580974.1,-392.42 580940.07,-435.17 580901,-410 580845.35,-374.15 580874.93,-319.03 580817,-287 580743.44,-246.33 579515.9,-225.1 579138.5,-219.52"/>
<polygon fill="black" stroke="black" points="579138.44,-216.02 579128.39,-219.37 579138.34,-223.02 579138.44,-216.02"/>
</g>
<!-- layer_12_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2465" class="edge">
<title>layer_12_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M559125.51,-501.88C559749.95,-490.4 561589.81,-458.13 563118,-447 563133.53,-446.89 580996.02,-447.98 581007,-437 581009.83,-434.17 581009.58,-431.06 581007,-428 580976.17,-391.49 580940.15,-437.41 580901,-410 580849.47,-373.93 580884.76,-319.65 580831,-287 580758.51,-242.97 579517.41,-224.04 579138.18,-219.27"/>
<polygon fill="black" stroke="black" points="579138.07,-215.76 579128.02,-219.14 579137.98,-222.76 579138.07,-215.76"/>
</g>
<!-- layer_12_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2474" class="edge">
<title>layer_12_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M554621.51,-501.88C555245.95,-490.37 557085.81,-458.04 558614,-447 558614,-447 580979,-437 580979,-437 580981.83,-434.17 580981.65,-430.99 580979,-428 580956.72,-402.89 580855.68,-430.37 580829,-410 580782.1,-374.19 580827.3,-320.9 580779,-287 580711.76,-239.8 579510.34,-223.11 579138.06,-219.06"/>
<polygon fill="black" stroke="black" points="579137.85,-215.56 579127.82,-218.95 579137.78,-222.56 579137.85,-215.56"/>
</g>
<!-- layer_12_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2483" class="edge">
<title>layer_12_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M577139.18,-499.74C577579.52,-487.31 578609.07,-459.65 579474,-447 579485.32,-446.83 581096.02,-445.03 581104,-437 581106.82,-434.16 581106.53,-431.1 581104,-428 581079.07,-397.38 581047.17,-435.48 581017,-410 580972.17,-372.13 581016.86,-320.96 580969,-287 580893.96,-233.75 579534.61,-221.14 579137.24,-218.58"/>
<polygon fill="black" stroke="black" points="579137.2,-215.08 579127.18,-218.52 579137.16,-222.08 579137.2,-215.08"/>
</g>
<!-- layer_12_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2492" class="edge">
<title>layer_12_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M572637.79,-502.01C573262.51,-490.87 575102.05,-459.42 576630,-447 576645.45,-446.87 581068.09,-447.94 581079,-437 581081.83,-434.17 581081.57,-431.06 581079,-428 581049.41,-392.73 581012.39,-439.44 580977,-410 580932.13,-372.68 580978.35,-321.13 580931,-287 580857.96,-234.35 579530.01,-221.33 579137.43,-218.63"/>
<polygon fill="black" stroke="black" points="579137.23,-215.13 579127.21,-218.56 579137.19,-222.13 579137.23,-215.13"/>
</g>
<!-- layer_12_moe_alltoall -->
<g id="node1336" class="node">
<title>layer_12_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="567578" cy="-1017" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="567578" y="-1031" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="567578" y="-1020" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="567578" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="567578" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_12_ln_tp_0 -->
<g id="node1337" class="node">
<title>layer_12_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="574432.07,-1069 573981.77,-1069 573865.93,-965 574316.23,-965 574432.07,-1069"/>
<text text-anchor="middle" x="574149" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="574149" y="-1020" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="574149" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="574149" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_qkv_tp_0 -->
<g id="node1341" class="node">
<title>layer_13_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="541122.7,-899 540680.94,-899 540567.3,-795 541009.06,-795 541122.7,-899"/>
<text text-anchor="middle" x="540845" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="540845" y="-850" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="540845" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="540845" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_12_ln_tp_0&#45;&gt;layer_13_qkv_tp_0 -->
<g id="edge3125" class="edge">
<title>layer_12_ln_tp_0&#45;&gt;layer_13_qkv_tp_0</title>
<path fill="none" stroke="black" d="M573918.13,-964.96C573897.54,-961.74 573876.94,-959 573857,-957 573751.43,-946.42 543408.09,-947.43 543302,-947 543060.88,-946.02 541370.66,-964.38 541132,-930 541090.1,-923.96 541045.71,-913.43 541004.69,-901.88"/>
<polygon fill="black" stroke="black" points="541005.47,-898.46 540994.89,-899.09 541003.55,-905.19 541005.47,-898.46"/>
</g>
<!-- layer_12_ln_tp_1 -->
<g id="node1338" class="node">
<title>layer_12_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="575016.07,-1069 574565.77,-1069 574449.93,-965 574900.23,-965 575016.07,-1069"/>
<text text-anchor="middle" x="574733" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="574733" y="-1020" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="574733" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="574733" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_qkv_tp_1 -->
<g id="node1342" class="node">
<title>layer_13_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="541696.7,-899 541254.94,-899 541141.3,-795 541583.06,-795 541696.7,-899"/>
<text text-anchor="middle" x="541419" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="541419" y="-850" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="541419" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="541419" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_12_ln_tp_1&#45;&gt;layer_13_qkv_tp_1 -->
<g id="edge3126" class="edge">
<title>layer_12_ln_tp_1&#45;&gt;layer_13_qkv_tp_1</title>
<path fill="none" stroke="black" d="M574502.13,-964.96C574481.54,-961.74 574460.94,-959 574441,-957 574339.96,-946.88 545298.54,-947.26 545197,-947 545148.51,-946.87 541754,-936.84 541706,-930 541663.97,-924.01 541619.44,-913.45 541578.33,-901.87"/>
<polygon fill="black" stroke="black" points="541579.08,-898.44 541568.51,-899.06 541577.16,-905.18 541579.08,-898.44"/>
</g>
<!-- layer_12_ln_tp_2 -->
<g id="node1339" class="node">
<title>layer_12_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="575600.07,-1069 575149.77,-1069 575033.93,-965 575484.23,-965 575600.07,-1069"/>
<text text-anchor="middle" x="575317" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="575317" y="-1020" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="575317" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="575317" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_qkv_tp_2 -->
<g id="node1343" class="node">
<title>layer_13_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="542270.7,-899 541828.94,-899 541715.3,-795 542157.06,-795 542270.7,-899"/>
<text text-anchor="middle" x="541993" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="541993" y="-850" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="541993" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="541993" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_12_ln_tp_2&#45;&gt;layer_13_qkv_tp_2 -->
<g id="edge3127" class="edge">
<title>layer_12_ln_tp_2&#45;&gt;layer_13_qkv_tp_2</title>
<path fill="none" stroke="black" d="M575086.13,-964.96C575065.54,-961.74 575044.94,-959 575025,-957 574922.95,-946.78 545589.56,-947.32 545487,-947 544815.44,-944.89 544647.56,-941.58 543976,-938 543928.89,-937.75 542326.64,-936.64 542280,-930 542237.97,-924.01 542193.44,-913.46 542152.33,-901.87"/>
<polygon fill="black" stroke="black" points="542153.08,-898.45 542142.51,-899.07 542151.16,-905.18 542153.08,-898.45"/>
</g>
<!-- layer_12_ln_tp_3 -->
<g id="node1340" class="node">
<title>layer_12_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="576184.07,-1069 575733.77,-1069 575617.93,-965 576068.23,-965 576184.07,-1069"/>
<text text-anchor="middle" x="575901" y="-1031" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="575901" y="-1020" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="575901" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="575901" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_qkv_tp_3 -->
<g id="node1344" class="node">
<title>layer_13_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="542844.7,-899 542402.94,-899 542289.3,-795 542731.06,-795 542844.7,-899"/>
<text text-anchor="middle" x="542567" y="-861" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="542567" y="-850" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="542567" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="542567" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_12_ln_tp_3&#45;&gt;layer_13_qkv_tp_3 -->
<g id="edge3128" class="edge">
<title>layer_12_ln_tp_3&#45;&gt;layer_13_qkv_tp_3</title>
<path fill="none" stroke="black" d="M575670.13,-964.96C575649.54,-961.74 575628.94,-959 575609,-957 575523.97,-948.48 551084.45,-947.11 550999,-947 550942.46,-946.93 542913,-937.82 542857,-930 542814.34,-924.04 542769.12,-913.43 542727.4,-901.78"/>
<polygon fill="black" stroke="black" points="542728.29,-898.39 542717.72,-899.04 542726.39,-905.13 542728.29,-898.39"/>
</g>
<!-- layer_13_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2501" class="edge">
<title>layer_13_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M541024.63,-809.1C541060.07,-803.23 541097.09,-798.09 541132,-795 541398.59,-771.43 579403.51,-785.8 579671,-777 579728.87,-775.1 579886.02,-796.46 579931,-760 580039.09,-672.41 580040.74,-537.41 579935,-447 579917.52,-432.06 579854.52,-441.66 579832,-437 579819.2,-434.35 579816.91,-430.02 579804,-428 579804,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_13_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2502" class="edge">
<title>layer_13_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M541598.63,-809.1C541634.07,-803.23 541671.09,-798.09 541706,-795 541969.57,-771.7 579543.71,-789.73 579808,-777 579886.94,-773.2 579924.52,-810.87 579985,-760 580091.46,-670.45 580093.91,-536.01 579987,-447 579964.73,-428.46 579885.43,-442.58 579857,-437 579844.17,-434.48 579841.91,-430.02 579829,-428 579829,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_13_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2503" class="edge">
<title>layer_13_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M542172.63,-809.1C542208.07,-803.23 542245.09,-798.09 542280,-795 542800.54,-748.98 579383.49,-810.32 579905,-777 579964.47,-773.2 579993.12,-799.21 580038,-760 580142.77,-668.47 580147.24,-535.62 580040,-447 580026.44,-435.79 579899.28,-440.27 579882,-437 579869.16,-434.57 579866.91,-430.02 579854,-428 579854,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_13_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2504" class="edge">
<title>layer_13_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M542746.97,-809.36C542783.25,-803.38 542821.23,-798.13 542857,-795 543370.62,-750.06 579464.89,-815.92 579979,-777 580029.2,-773.2 580053.48,-793.57 580091,-760 580194.68,-667.25 580200.66,-535.11 580093,-447 580076.98,-433.89 579927.35,-440.75 579907,-437 579894.15,-434.63 579891.91,-430.02 579879,-428 579879,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_13_qkv_comm -->
<g id="node1345" class="node">
<title>layer_13_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="540356" cy="-847" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="540356" y="-861" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="540356" y="-850" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="540356" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="540356" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_13_attn_tp_0 -->
<g id="node1346" class="node">
<title>layer_13_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="537397.7,-899 536955.94,-899 536842.3,-795 537284.06,-795 537397.7,-899"/>
<text text-anchor="middle" x="537120" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="537120" y="-850" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="537120" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="537120" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_out_tp_0 -->
<g id="node1350" class="node">
<title>layer_13_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="537397.7,-729 536955.94,-729 536842.3,-625 537284.06,-625 537397.7,-729"/>
<text text-anchor="middle" x="537120" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="537120" y="-680" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="537120" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="537120" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_tp_0&#45;&gt;layer_13_attn_out_tp_0 -->
<g id="edge2509" class="edge">
<title>layer_13_attn_tp_0&#45;&gt;layer_13_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M537120,-794.68C537120,-777.18 537120,-757.43 537120,-739.22"/>
<polygon fill="black" stroke="black" points="537123.5,-739 537120,-729 537116.5,-739 537123.5,-739"/>
</g>
<!-- layer_13_attn_tp_1 -->
<g id="node1347" class="node">
<title>layer_13_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="536823.7,-899 536381.94,-899 536268.3,-795 536710.06,-795 536823.7,-899"/>
<text text-anchor="middle" x="536546" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="536546" y="-850" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="536546" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="536546" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_out_tp_1 -->
<g id="node1351" class="node">
<title>layer_13_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="536823.7,-729 536381.94,-729 536268.3,-625 536710.06,-625 536823.7,-729"/>
<text text-anchor="middle" x="536546" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="536546" y="-680" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="536546" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="536546" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_tp_1&#45;&gt;layer_13_attn_out_tp_1 -->
<g id="edge2511" class="edge">
<title>layer_13_attn_tp_1&#45;&gt;layer_13_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M536546,-794.68C536546,-777.18 536546,-757.43 536546,-739.22"/>
<polygon fill="black" stroke="black" points="536549.5,-739 536546,-729 536542.5,-739 536549.5,-739"/>
</g>
<!-- layer_13_attn_tp_2 -->
<g id="node1348" class="node">
<title>layer_13_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="536249.7,-899 535807.94,-899 535694.3,-795 536136.06,-795 536249.7,-899"/>
<text text-anchor="middle" x="535972" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="535972" y="-850" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="535972" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="535972" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_out_tp_2 -->
<g id="node1352" class="node">
<title>layer_13_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="536249.7,-729 535807.94,-729 535694.3,-625 536136.06,-625 536249.7,-729"/>
<text text-anchor="middle" x="535972" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="535972" y="-680" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="535972" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="535972" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_tp_2&#45;&gt;layer_13_attn_out_tp_2 -->
<g id="edge2513" class="edge">
<title>layer_13_attn_tp_2&#45;&gt;layer_13_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M535972,-794.68C535972,-777.18 535972,-757.43 535972,-739.22"/>
<polygon fill="black" stroke="black" points="535975.5,-739 535972,-729 535968.5,-739 535975.5,-739"/>
</g>
<!-- layer_13_attn_tp_3 -->
<g id="node1349" class="node">
<title>layer_13_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="535675.7,-899 535233.94,-899 535120.3,-795 535562.06,-795 535675.7,-899"/>
<text text-anchor="middle" x="535398" y="-861" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="535398" y="-850" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="535398" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="535398" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_out_tp_3 -->
<g id="node1353" class="node">
<title>layer_13_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="535675.7,-729 535233.94,-729 535120.3,-625 535562.06,-625 535675.7,-729"/>
<text text-anchor="middle" x="535398" y="-691" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="535398" y="-680" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="535398" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="535398" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_13_attn_tp_3&#45;&gt;layer_13_attn_out_tp_3 -->
<g id="edge2515" class="edge">
<title>layer_13_attn_tp_3&#45;&gt;layer_13_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M535398,-794.68C535398,-777.18 535398,-757.43 535398,-739.22"/>
<polygon fill="black" stroke="black" points="535401.5,-739 535398,-729 535394.5,-739 535401.5,-739"/>
</g>
<!-- layer_13_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2510" class="edge">
<title>layer_13_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M536996.3,-729.09C536944.12,-748.39 536882.1,-767.91 536824,-777.5 536824,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_13_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2512" class="edge">
<title>layer_13_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M536422.3,-729.09C536370.12,-748.39 536308.1,-767.91 536250,-777.5 536250,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_13_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2514" class="edge">
<title>layer_13_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M535848.3,-729.09C535796.12,-748.39 535734.1,-767.91 535676,-777.5 535676,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_13_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2516" class="edge">
<title>layer_13_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M535274.3,-729.09C535222.12,-748.39 535160.1,-767.91 535102,-777.5 535102,-777.5 145566,-777.5 145566,-777.5 145427.93,-762.47 145270.43,-722.54 145181.34,-697.78"/>
<polygon fill="black" stroke="black" points="145182.19,-694.38 145171.62,-695.06 145180.3,-701.12 145182.19,-694.38"/>
</g>
<!-- layer_13_attn_allreduce -->
<g id="node1354" class="node">
<title>layer_13_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="537612" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="537612" y="-861" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="537612" y="-850" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="537612" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="537612" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_gate_tp_0 -->
<g id="node1355" class="node">
<title>layer_13_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="527016.99,-899 526568.4,-899 526453.01,-795 526901.6,-795 527016.99,-899"/>
<text text-anchor="middle" x="526735" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="526735" y="-850" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="526735" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="526735" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_13_route_ep_0 -->
<g id="node1359" class="node">
<title>layer_13_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="510488.43,-729 510029.6,-729 509911.57,-625 510370.4,-625 510488.43,-729"/>
<text text-anchor="middle" x="510200" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="510200" y="-680" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="510200" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="510200" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_0 -->
<g id="edge2517" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526454.02,-795.94C526450.66,-795.61 526447.32,-795.29 526444,-795 526302.33,-782.43 521466.22,-777.53 521324,-777 520317.78,-773.23 520066.23,-770.83 519060,-768 517976,-764.96 515265.93,-772.05 514182,-760 512768.97,-744.29 511074.32,-701.41 510448.19,-684.75"/>
<polygon fill="black" stroke="black" points="510448.23,-681.25 510438.14,-684.48 510448.04,-688.24 510448.23,-681.25"/>
<text text-anchor="middle" x="521350" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_1 -->
<g id="node1360" class="node">
<title>layer_13_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="514767.43,-729 514308.6,-729 514190.57,-625 514649.4,-625 514767.43,-729"/>
<text text-anchor="middle" x="514479" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="514479" y="-680" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="514479" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="514479" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_1 -->
<g id="edge2518" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526454.02,-795.95C526450.66,-795.62 526447.32,-795.3 526444,-795 526288.35,-780.96 523787.27,-778.88 523631,-777 523404.31,-774.27 523347.69,-770.21 523121,-768 521218.87,-749.44 520743.12,-779.66 518841,-760 517274.42,-743.81 515391.76,-700.25 514726.47,-684.12"/>
<polygon fill="black" stroke="black" points="514726.37,-680.62 514716.28,-683.87 514726.2,-687.61 514726.37,-680.62"/>
<text text-anchor="middle" x="523657" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_2 -->
<g id="node1361" class="node">
<title>layer_13_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="519426.43,-729 518967.6,-729 518849.57,-625 519308.4,-625 519426.43,-729"/>
<text text-anchor="middle" x="519138" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="519138" y="-680" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="519138" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="519138" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_2 -->
<g id="edge2519" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526454.01,-795.98C526450.66,-795.64 526447.32,-795.31 526444,-795 526366.77,-787.8 523729.55,-761.19 523652,-760 522023.2,-735 520063.97,-696.55 519384.32,-682.96"/>
<polygon fill="black" stroke="black" points="519384.23,-679.46 519374.16,-682.76 519384.09,-686.46 519384.23,-679.46"/>
<text text-anchor="middle" x="525155" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_3 -->
<g id="node1362" class="node">
<title>layer_13_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="524237.43,-729 523778.6,-729 523660.57,-625 524119.4,-625 524237.43,-729"/>
<text text-anchor="middle" x="523949" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="523949" y="-680" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="523949" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="523949" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_3 -->
<g id="edge2520" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526653.37,-794.95C526632.18,-784.06 526608.87,-774.04 526586,-768 526358.78,-707.99 524801.3,-686.36 524192.32,-680.14"/>
<polygon fill="black" stroke="black" points="524192.13,-676.63 524182.09,-680.03 524192.06,-683.63 524192.13,-676.63"/>
<text text-anchor="middle" x="526638" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_4 -->
<g id="node1363" class="node">
<title>layer_13_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="527431.43,-729 526972.6,-729 526854.57,-625 527313.4,-625 527431.43,-729"/>
<text text-anchor="middle" x="527143" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="527143" y="-680" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="527143" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="527143" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_4 -->
<g id="edge2521" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526922.31,-813.22C526991.3,-800.03 527056.12,-785.88 527070,-777 527085.63,-767 527099.06,-752.38 527109.99,-737.43"/>
<polygon fill="black" stroke="black" points="527112.94,-739.31 527115.8,-729.11 527107.2,-735.3 527112.94,-739.31"/>
<text text-anchor="middle" x="527106" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_5 -->
<g id="node1364" class="node">
<title>layer_13_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="530686.43,-729 530227.6,-729 530109.57,-625 530568.4,-625 530686.43,-729"/>
<text text-anchor="middle" x="530398" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="530398" y="-680" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="530398" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="530398" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_5 -->
<g id="edge2522" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526917.98,-809.52C526953.67,-803.65 526990.9,-798.4 527026,-795 527127.21,-785.19 527841.6,-798.42 527941,-777 527950.93,-774.86 527952.09,-770.23 527962,-768 528172.59,-720.71 529594.4,-691.64 530163.35,-681.78"/>
<polygon fill="black" stroke="black" points="530163.8,-685.27 530173.73,-681.6 530163.67,-678.27 530163.8,-685.27"/>
<text text-anchor="middle" x="527988" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_6 -->
<g id="node1365" class="node">
<title>layer_13_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="534508.43,-729 534049.6,-729 533931.57,-625 534390.4,-625 534508.43,-729"/>
<text text-anchor="middle" x="534220" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="534220" y="-680" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="534220" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="534220" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_6 -->
<g id="edge2523" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526917.56,-809.3C526953.37,-803.43 526990.76,-798.23 527026,-795 527127.49,-785.69 530593.09,-761.67 530695,-760 531936.94,-739.63 533424.67,-700.04 533988.31,-684.49"/>
<polygon fill="black" stroke="black" points="533988.69,-687.98 533998.59,-684.21 533988.5,-680.98 533988.69,-687.98"/>
<text text-anchor="middle" x="529617" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_route_ep_7 -->
<g id="node1366" class="node">
<title>layer_13_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="535102.43,-729 534643.6,-729 534525.57,-625 534984.4,-625 535102.43,-729"/>
<text text-anchor="middle" x="534814" y="-691" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="534814" y="-680" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="534814" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="534814" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_7 -->
<g id="edge2524" class="edge">
<title>layer_13_gate_tp_0&#45;&gt;layer_13_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526917.55,-809.15C526953.36,-803.3 526990.75,-798.14 527026,-795 527255.76,-774.52 530947.34,-778.62 531178,-777 531590.9,-774.1 531694.1,-770.69 532107,-768 532173.94,-767.56 534450.68,-769.1 534517,-760 534560.73,-754 534607.12,-743.35 534649.92,-731.67"/>
<polygon fill="black" stroke="black" points="534650.86,-735.04 534659.56,-729 534648.99,-728.29 534650.86,-735.04"/>
<text text-anchor="middle" x="532133" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1 -->
<g id="node1356" class="node">
<title>layer_13_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="527598.99,-899 527150.4,-899 527035.01,-795 527483.6,-795 527598.99,-899"/>
<text text-anchor="middle" x="527317" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="527317" y="-850" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="527317" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="527317" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_0 -->
<g id="edge2525" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527036.02,-795.94C527032.66,-795.61 527029.32,-795.29 527026,-795 526717.21,-767.64 521755.34,-797.31 521446,-777 521414.7,-774.95 521407.3,-770.02 521376,-768 521276.29,-761.56 514281.91,-761.08 514182,-760 512768.97,-744.67 511074.32,-701.56 510448.19,-684.79"/>
<polygon fill="black" stroke="black" points="510448.23,-681.29 510438.14,-684.52 510448.04,-688.29 510448.23,-681.29"/>
<text text-anchor="middle" x="521472" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_1 -->
<g id="edge2526" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527036.02,-795.95C527032.66,-795.61 527029.32,-795.3 527026,-795 526674.08,-763.39 524199.18,-787.74 523846,-777 523773.48,-774.79 523755.53,-770.06 523683,-768 523145.22,-752.72 519378.97,-765.5 518841,-760 517274.42,-743.98 515391.76,-700.32 514726.47,-684.14"/>
<polygon fill="black" stroke="black" points="514726.37,-680.63 514716.28,-683.89 514726.19,-687.63 514726.37,-680.63"/>
<text text-anchor="middle" x="523872" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_2 -->
<g id="edge2527" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527036.01,-795.99C527032.66,-795.64 527029.32,-795.31 527026,-795 526924.16,-785.39 525287.28,-769.02 525185,-768 524503.69,-761.23 524333.3,-767.97 523652,-760 522023.61,-740.96 520065.11,-698.81 519384.92,-683.61"/>
<polygon fill="black" stroke="black" points="519384.83,-680.11 519374.75,-683.38 519384.67,-687.1 519384.83,-680.11"/>
<text text-anchor="middle" x="526027" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_3 -->
<g id="edge2528" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527036.37,-796.29C527032.89,-795.85 527029.44,-795.42 527026,-795 526909.25,-780.83 526879.21,-786.61 526762,-777 526720.17,-773.57 526709.88,-770.7 526668,-768 525755.99,-709.3 524669.3,-687.92 524193.01,-680.98"/>
<polygon fill="black" stroke="black" points="524192.97,-677.48 524182.92,-680.83 524192.87,-684.48 524192.97,-677.48"/>
<text text-anchor="middle" x="526788" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_4 -->
<g id="edge2529" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527263.85,-794.68C527244.71,-776.2 527222.97,-755.22 527203.27,-736.19"/>
<polygon fill="black" stroke="black" points="527205.45,-733.43 527195.83,-729 527200.59,-738.47 527205.45,-733.43"/>
<text text-anchor="middle" x="527266" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_5 -->
<g id="edge2530" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527500.44,-810.13C527536,-804.23 527573.07,-798.81 527608,-795 527789.32,-775.22 527835.78,-785.1 528018,-777 528106.89,-773.05 528129.1,-771.84 528218,-768 528929.72,-737.29 529772.26,-703.13 530169.29,-687.16"/>
<polygon fill="black" stroke="black" points="530169.61,-690.65 530179.46,-686.75 530169.33,-683.66 530169.61,-690.65"/>
<text text-anchor="middle" x="528244" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_6 -->
<g id="edge2531" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527499.55,-809.24C527535.37,-803.38 527572.75,-798.2 527608,-795 527875.91,-770.7 529760.02,-781.18 530029,-777 531539.28,-753.55 533355.21,-703.06 533988.64,-684.78"/>
<polygon fill="black" stroke="black" points="533988.9,-688.27 533998.8,-684.49 533988.7,-681.28 533988.9,-688.27"/>
<text text-anchor="middle" x="530509" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_7 -->
<g id="edge2532" class="edge">
<title>layer_13_gate_tp_1&#45;&gt;layer_13_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527499.55,-809.14C527535.36,-803.29 527572.75,-798.14 527608,-795 527860.06,-772.58 531909.95,-778.41 532163,-777 532195.69,-776.82 534484.62,-764.51 534517,-760 534560.38,-753.96 534606.39,-743.4 534648.91,-731.82"/>
<polygon fill="black" stroke="black" points="534650.07,-735.13 534658.78,-729.1 534648.21,-728.39 534650.07,-735.13"/>
<text text-anchor="middle" x="533642" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2 -->
<g id="node1357" class="node">
<title>layer_13_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="526434.99,-899 525986.4,-899 525871.01,-795 526319.6,-795 526434.99,-899"/>
<text text-anchor="middle" x="526153" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="526153" y="-850" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="526153" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="526153" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_0 -->
<g id="edge2533" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M525926.74,-845.5C524720.38,-842.63 518922.78,-825.84 514182,-760 512768.59,-740.37 511073.31,-699.8 510447.62,-684.25"/>
<polygon fill="black" stroke="black" points="510447.66,-680.75 510437.58,-684 510447.49,-687.75 510447.66,-680.75"/>
<text text-anchor="middle" x="515506" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_1 -->
<g id="edge2534" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M525926.23,-844.82C525040.93,-839.98 521732.13,-819.93 519008,-777 517374.41,-751.26 515409.77,-702.1 514727.04,-684.48"/>
<polygon fill="black" stroke="black" points="514726.92,-680.98 514716.84,-684.22 514726.74,-687.98 514726.92,-680.98"/>
<text text-anchor="middle" x="519034" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_2 -->
<g id="edge2535" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M525921.1,-840.45C524860.63,-815.05 520477.87,-710.09 519385.49,-683.93"/>
<polygon fill="black" stroke="black" points="519385.23,-680.42 519375.15,-683.68 519385.06,-687.42 519385.23,-680.42"/>
<text text-anchor="middle" x="523091" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_3 -->
<g id="edge2536" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M525924.05,-842.81C525397.51,-834.9 524139.02,-812.39 524054,-777 524032.54,-768.07 524012.84,-752.6 523996.45,-736.52"/>
<polygon fill="black" stroke="black" points="523998.66,-733.78 523989.15,-729.1 523993.67,-738.69 523998.66,-733.78"/>
<text text-anchor="middle" x="524080" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_4 -->
<g id="edge2537" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526333.34,-806.95C526396.64,-793.81 526468.34,-779.56 526534,-768 526666.83,-744.61 526816.69,-722.41 526934.52,-705.91"/>
<polygon fill="black" stroke="black" points="526935.32,-709.33 526944.74,-704.48 526934.35,-702.4 526935.32,-709.33"/>
<text text-anchor="middle" x="526560" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_5 -->
<g id="edge2538" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526336.4,-809.82C526371.97,-803.95 526409.05,-798.62 526444,-795 526565.2,-782.45 526872.85,-802.47 526992,-777 527002.33,-774.79 527003.65,-770.14 527014,-768 527060.36,-758.43 527392.67,-761.1 527440,-760 528456.35,-736.37 529668.91,-700.27 530167.05,-685.1"/>
<polygon fill="black" stroke="black" points="530167.34,-688.6 530177.23,-684.79 530167.13,-681.6 530167.34,-688.6"/>
<text text-anchor="middle" x="527040" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_6 -->
<g id="edge2539" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526335.96,-809.39C526371.66,-803.54 526408.89,-798.32 526444,-795 526704.64,-770.33 527360.27,-783.48 527622,-777 527738.92,-774.11 527768.06,-770.17 527885,-768 528509.34,-756.43 530070.61,-768.15 530695,-760 531937.38,-743.78 533425.6,-701.73 533988.84,-685.01"/>
<polygon fill="black" stroke="black" points="533989.22,-688.5 533999.11,-684.7 533989.01,-681.5 533989.22,-688.5"/>
<text text-anchor="middle" x="527911" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_7 -->
<g id="edge2540" class="edge">
<title>layer_13_gate_tp_2&#45;&gt;layer_13_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M526335.56,-809.29C526371.37,-803.42 526408.76,-798.23 526444,-795 526658.89,-775.31 528170.29,-782.76 528386,-777 528476.72,-774.58 528499.27,-770.06 528590,-768 528672.3,-766.13 534435.43,-771.11 534517,-760 534560.73,-754.04 534607.13,-743.41 534649.92,-731.73"/>
<polygon fill="black" stroke="black" points="534650.86,-735.1 534659.57,-729.06 534649,-728.35 534650.86,-735.1"/>
<text text-anchor="middle" x="528616" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3 -->
<g id="node1358" class="node">
<title>layer_13_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="528180.99,-899 527732.4,-899 527617.01,-795 528065.6,-795 528180.99,-899"/>
<text text-anchor="middle" x="527899" y="-861" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="527899" y="-850" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="527899" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="527899" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_0 -->
<g id="edge2541" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527618.02,-795.94C527614.66,-795.61 527611.32,-795.3 527608,-795 527353.5,-772.37 523264.5,-778.26 523009,-777 522337.44,-773.69 522169.56,-770.37 521498,-768 520685.12,-765.13 514994.84,-768.81 514182,-760 512768.97,-744.68 511074.32,-701.56 510448.19,-684.79"/>
<polygon fill="black" stroke="black" points="510448.23,-681.29 510438.14,-684.52 510448.04,-688.29 510448.23,-681.29"/>
<text text-anchor="middle" x="523035" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_1 -->
<g id="edge2542" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527618.02,-795.94C527614.66,-795.61 527611.32,-795.3 527608,-795 527206.49,-759.08 524382.46,-800.02 523980,-777 523943.4,-774.91 523934.61,-770.03 523898,-768 523757.74,-760.21 518981.47,-761.43 518841,-760 517274.42,-744.04 515391.76,-700.34 514726.47,-684.14"/>
<polygon fill="black" stroke="black" points="514726.37,-680.64 514716.28,-683.9 514726.19,-687.64 514726.37,-680.64"/>
<text text-anchor="middle" x="524006" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_2 -->
<g id="edge2543" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527618.01,-795.99C527614.66,-795.65 527611.32,-795.31 527608,-795 527348.69,-770.44 526696.43,-782.09 526436,-777 526267.54,-773.71 526225.48,-770.28 526057,-768 524988.2,-753.53 524720.83,-771.49 523652,-760 522023.84,-742.5 520065.69,-699.41 519385.22,-683.78"/>
<polygon fill="black" stroke="black" points="519385.13,-680.28 519375.05,-683.55 519384.97,-687.27 519385.13,-680.28"/>
<text text-anchor="middle" x="526462" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_3 -->
<g id="edge2544" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527618.01,-796.05C527614.65,-795.68 527611.32,-795.33 527608,-795 527312.49,-765.29 527236.64,-791.58 526940,-777 526883.93,-774.24 526870.07,-770.88 526814,-768 525845.03,-718.19 524690.19,-692.05 524194.64,-682.41"/>
<polygon fill="black" stroke="black" points="524194.56,-678.91 524184.5,-682.22 524194.43,-685.91 524194.56,-678.91"/>
<text text-anchor="middle" x="526966" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_4 -->
<g id="edge2545" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M527669.35,-794.97C527578.6,-774.8 527474.29,-751.62 527382.58,-731.24"/>
<polygon fill="black" stroke="black" points="527383.13,-727.78 527372.61,-729.02 527381.61,-734.61 527383.13,-727.78"/>
<text text-anchor="middle" x="527592" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_5 -->
<g id="edge2546" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M528080.23,-807.91C528158.01,-793.02 528250.12,-777.31 528334,-768 528992.12,-694.98 529774.42,-680.47 530159.55,-678.06"/>
<polygon fill="black" stroke="black" points="530159.72,-681.56 530169.7,-678 530159.68,-674.56 530159.72,-681.56"/>
<text text-anchor="middle" x="528360" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_6 -->
<g id="edge2547" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M528117.36,-841.34C528606.48,-830.8 529827.33,-803.95 530849,-777 532029.6,-745.86 533442.59,-702.33 533988.78,-685.27"/>
<polygon fill="black" stroke="black" points="533989.26,-688.75 533999.14,-684.94 533989.04,-681.76 533989.26,-688.75"/>
<text text-anchor="middle" x="531148" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_7 -->
<g id="edge2548" class="edge">
<title>layer_13_gate_tp_3&#45;&gt;layer_13_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M528118.39,-842.51C528688.54,-833.54 530263.91,-809.36 531576,-795 532573.31,-784.08 532822.77,-793.16 533820,-777 534129.83,-771.98 534210.47,-805.35 534517,-760 534559.83,-753.66 534605.27,-743.14 534647.39,-731.7"/>
<polygon fill="black" stroke="black" points="534648.45,-735.04 534657.16,-729.01 534646.59,-728.29 534648.45,-735.04"/>
<text text-anchor="middle" x="534473" y="-770.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_13_expert_0_ep_0 -->
<g id="node1367" class="node">
<title>layer_13_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="507375.83,-559 506941.82,-559 506830.17,-455 507264.18,-455 507375.83,-559"/>
<text text-anchor="middle" x="507103" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="507103" y="-510" font-family="Arial" font-size="10.00">GPU: 384</text>
<text text-anchor="middle" x="507103" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="507103" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_0_ep_0 -->
<g id="edge2549" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M509969.79,-676.47C509389.81,-676.44 507879.61,-668.57 507384,-590 507343.77,-583.62 507301.2,-573.2 507261.68,-561.89"/>
<polygon fill="black" stroke="black" points="507262.55,-558.5 507251.97,-559.08 507260.6,-565.23 507262.55,-558.5"/>
</g>
<!-- layer_13_expert_1_ep_0 -->
<g id="node1368" class="node">
<title>layer_13_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="507938.83,-559 507504.82,-559 507393.17,-455 507827.18,-455 507938.83,-559"/>
<text text-anchor="middle" x="507666" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="507666" y="-510" font-family="Arial" font-size="10.00">GPU: 385</text>
<text text-anchor="middle" x="507666" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="507666" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_1_ep_0 -->
<g id="edge2550" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M509967.17,-674.35C509472.39,-669.67 508330.23,-652.25 507947,-590 507907.12,-583.52 507864.9,-573.16 507825.65,-561.94"/>
<polygon fill="black" stroke="black" points="507826.31,-558.49 507815.73,-559.08 507824.37,-565.22 507826.31,-558.49"/>
</g>
<!-- layer_13_expert_2_ep_0 -->
<g id="node1369" class="node">
<title>layer_13_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="508501.83,-559 508067.82,-559 507956.17,-455 508390.18,-455 508501.83,-559"/>
<text text-anchor="middle" x="508229" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="508229" y="-510" font-family="Arial" font-size="10.00">GPU: 386</text>
<text text-anchor="middle" x="508229" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="508229" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_2_ep_0 -->
<g id="edge2551" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M509963.26,-670.76C509566.09,-660.82 508782.3,-636.01 508510,-590 508470.5,-583.33 508428.69,-572.99 508389.73,-561.88"/>
<polygon fill="black" stroke="black" points="508390.47,-558.45 508379.89,-559.04 508388.53,-565.17 508390.47,-558.45"/>
</g>
<!-- layer_13_expert_3_ep_0 -->
<g id="node1370" class="node">
<title>layer_13_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="509064.83,-559 508630.82,-559 508519.17,-455 508953.18,-455 509064.83,-559"/>
<text text-anchor="middle" x="508792" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="508792" y="-510" font-family="Arial" font-size="10.00">GPU: 387</text>
<text text-anchor="middle" x="508792" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="508792" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_3_ep_0 -->
<g id="edge2552" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M509965.08,-672.25C509735.84,-665.27 509378.03,-645.52 509073,-590 509034.4,-582.97 508993.52,-572.73 508955.25,-561.84"/>
<polygon fill="black" stroke="black" points="508956.16,-558.46 508945.58,-559.06 508954.23,-565.19 508956.16,-558.46"/>
</g>
<!-- layer_13_expert_4_ep_0 -->
<g id="node1371" class="node">
<title>layer_13_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="509627.83,-559 509193.82,-559 509082.17,-455 509516.18,-455 509627.83,-559"/>
<text text-anchor="middle" x="509355" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="509355" y="-510" font-family="Arial" font-size="10.00">GPU: 388</text>
<text text-anchor="middle" x="509355" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="509355" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_4_ep_0 -->
<g id="edge2553" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M509931.12,-642.42C509837.25,-628.74 509731.5,-611.12 509636,-590 509600.13,-582.07 509562.11,-572.08 509526.02,-561.82"/>
<polygon fill="black" stroke="black" points="509526.97,-558.45 509516.39,-559.07 509525.04,-565.18 509526.97,-558.45"/>
</g>
<!-- layer_13_expert_5_ep_0 -->
<g id="node1372" class="node">
<title>layer_13_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="510190.83,-559 509756.82,-559 509645.17,-455 510079.18,-455 510190.83,-559"/>
<text text-anchor="middle" x="509918" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="509918" y="-510" font-family="Arial" font-size="10.00">GPU: 389</text>
<text text-anchor="middle" x="509918" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="509918" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_5_ep_0 -->
<g id="edge2554" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M510114.24,-624.91C510082.11,-605.77 510045.44,-583.92 510012.55,-564.33"/>
<polygon fill="black" stroke="black" points="510014.22,-561.25 510003.84,-559.14 510010.64,-567.26 510014.22,-561.25"/>
</g>
<!-- layer_13_expert_6_ep_0 -->
<g id="node1373" class="node">
<title>layer_13_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="510753.83,-559 510319.82,-559 510208.17,-455 510642.18,-455 510753.83,-559"/>
<text text-anchor="middle" x="510481" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="510481" y="-510" font-family="Arial" font-size="10.00">GPU: 390</text>
<text text-anchor="middle" x="510481" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="510481" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_6_ep_0 -->
<g id="edge2555" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M510285.45,-624.91C510317.47,-605.77 510354.02,-583.92 510386.78,-564.33"/>
<polygon fill="black" stroke="black" points="510388.68,-567.27 510395.47,-559.14 510385.09,-561.26 510388.68,-567.27"/>
</g>
<!-- layer_13_expert_7_ep_0 -->
<g id="node1374" class="node">
<title>layer_13_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="511316.83,-559 510882.82,-559 510771.17,-455 511205.18,-455 511316.83,-559"/>
<text text-anchor="middle" x="511044" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="511044" y="-510" font-family="Arial" font-size="10.00">GPU: 391</text>
<text text-anchor="middle" x="511044" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="511044" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_0&#45;&gt;layer_13_expert_7_ep_0 -->
<g id="edge2556" class="edge">
<title>layer_13_route_ep_0&#45;&gt;layer_13_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M510401.18,-651.85C510509.1,-637.24 510644.01,-616.33 510763,-590 510798.87,-582.06 510836.89,-572.07 510872.98,-561.82"/>
<polygon fill="black" stroke="black" points="510873.96,-565.18 510882.61,-559.06 510872.03,-558.45 510873.96,-565.18"/>
</g>
<!-- layer_13_expert_0_ep_1 -->
<g id="node1375" class="node">
<title>layer_13_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="511879.83,-559 511445.82,-559 511334.17,-455 511768.18,-455 511879.83,-559"/>
<text text-anchor="middle" x="511607" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="511607" y="-510" font-family="Arial" font-size="10.00">GPU: 400</text>
<text text-anchor="middle" x="511607" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="511607" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_0_ep_1 -->
<g id="edge2557" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M514248.06,-675.74C513701.06,-673.92 512338.61,-662.05 511888,-590 511847.78,-583.57 511805.21,-573.13 511765.69,-561.82"/>
<polygon fill="black" stroke="black" points="511766.56,-558.43 511755.98,-559.01 511764.61,-565.15 511766.56,-558.43"/>
</g>
<!-- layer_13_expert_1_ep_1 -->
<g id="node1376" class="node">
<title>layer_13_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="512442.83,-559 512008.82,-559 511897.17,-455 512331.18,-455 512442.83,-559"/>
<text text-anchor="middle" x="512170" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="512170" y="-510" font-family="Arial" font-size="10.00">GPU: 401</text>
<text text-anchor="middle" x="512170" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="512170" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_1_ep_1 -->
<g id="edge2558" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M514244.87,-673.17C513787.32,-666.46 512789.7,-645.76 512451,-590 512411.24,-583.46 512369.16,-573.1 512330.01,-561.92"/>
<polygon fill="black" stroke="black" points="512330.7,-558.48 512320.12,-559.06 512328.75,-565.2 512330.7,-558.48"/>
</g>
<!-- layer_13_expert_2_ep_1 -->
<g id="node1377" class="node">
<title>layer_13_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="513005.83,-559 512571.82,-559 512460.17,-455 512894.18,-455 513005.83,-559"/>
<text text-anchor="middle" x="512733" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="512733" y="-510" font-family="Arial" font-size="10.00">GPU: 402</text>
<text text-anchor="middle" x="512733" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="512733" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_2_ep_1 -->
<g id="edge2559" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M514239.8,-668.5C513886.53,-656.31 513242.46,-629.52 513014,-590 512974.76,-583.21 512933.22,-572.9 512894.45,-561.85"/>
<polygon fill="black" stroke="black" points="512895.24,-558.43 512884.66,-559.03 512893.3,-565.16 512895.24,-558.43"/>
</g>
<!-- layer_13_expert_3_ep_1 -->
<g id="node1378" class="node">
<title>layer_13_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="513568.83,-559 513134.82,-559 513023.17,-455 513457.18,-455 513568.83,-559"/>
<text text-anchor="middle" x="513296" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="513296" y="-510" font-family="Arial" font-size="10.00">GPU: 403</text>
<text text-anchor="middle" x="513296" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="513296" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_3_ep_1 -->
<g id="edge2560" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M514236.05,-665.29C514053.48,-654.24 513797.92,-632.37 513577,-590 513539.2,-582.75 513499.18,-572.61 513461.55,-561.93"/>
<polygon fill="black" stroke="black" points="513462.1,-558.45 513451.52,-559.06 513460.17,-565.18 513462.1,-558.45"/>
</g>
<!-- layer_13_expert_4_ep_1 -->
<g id="node1379" class="node">
<title>layer_13_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="514131.83,-559 513697.82,-559 513586.17,-455 514020.18,-455 514131.83,-559"/>
<text text-anchor="middle" x="513859" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="513859" y="-510" font-family="Arial" font-size="10.00">GPU: 404</text>
<text text-anchor="middle" x="513859" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="513859" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_4_ep_1 -->
<g id="edge2561" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M514272.98,-624.98C514229.02,-613.75 514182.91,-601.7 514140,-590 514107.65,-581.18 514073.3,-571.46 514040.14,-561.88"/>
<polygon fill="black" stroke="black" points="514040.94,-558.47 514030.36,-559.06 514039,-565.2 514040.94,-558.47"/>
</g>
<!-- layer_13_expert_5_ep_1 -->
<g id="node1380" class="node">
<title>layer_13_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="514694.83,-559 514260.82,-559 514149.17,-455 514583.18,-455 514694.83,-559"/>
<text text-anchor="middle" x="514422" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="514422" y="-510" font-family="Arial" font-size="10.00">GPU: 405</text>
<text text-anchor="middle" x="514422" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="514422" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_5_ep_1 -->
<g id="edge2562" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M514461.59,-624.68C514455.59,-607.01 514448.82,-587.06 514442.6,-568.72"/>
<polygon fill="black" stroke="black" points="514445.83,-567.35 514439.3,-559 514439.2,-569.6 514445.83,-567.35"/>
</g>
<!-- layer_13_expert_6_ep_1 -->
<g id="node1381" class="node">
<title>layer_13_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="515257.83,-559 514823.82,-559 514712.17,-455 515146.18,-455 515257.83,-559"/>
<text text-anchor="middle" x="514985" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="514985" y="-510" font-family="Arial" font-size="10.00">GPU: 406</text>
<text text-anchor="middle" x="514985" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="514985" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_6_ep_1 -->
<g id="edge2563" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M514632.88,-624.91C514692.49,-605.12 514760.83,-582.43 514821.34,-562.34"/>
<polygon fill="black" stroke="black" points="514822.59,-565.61 514830.98,-559.14 514820.39,-558.97 514822.59,-565.61"/>
</g>
<!-- layer_13_expert_7_ep_1 -->
<g id="node1382" class="node">
<title>layer_13_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="515820.83,-559 515386.82,-559 515275.17,-455 515709.18,-455 515820.83,-559"/>
<text text-anchor="middle" x="515548" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="515548" y="-510" font-family="Arial" font-size="10.00">GPU: 407</text>
<text text-anchor="middle" x="515548" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="515548" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_1&#45;&gt;layer_13_expert_7_ep_1 -->
<g id="edge2564" class="edge">
<title>layer_13_route_ep_1&#45;&gt;layer_13_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M514692.5,-662.87C514851.9,-650.61 515074.49,-628.29 515267,-590 515304.29,-582.58 515343.78,-572.5 515381.01,-561.94"/>
<polygon fill="black" stroke="black" points="515382.28,-565.22 515390.93,-559.1 515380.35,-558.49 515382.28,-565.22"/>
</g>
<!-- layer_13_expert_0_ep_2 -->
<g id="node1383" class="node">
<title>layer_13_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="516383.83,-559 515949.82,-559 515838.17,-455 516272.18,-455 516383.83,-559"/>
<text text-anchor="middle" x="516111" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="516111" y="-510" font-family="Arial" font-size="10.00">GPU: 416</text>
<text text-anchor="middle" x="516111" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="516111" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_0_ep_2 -->
<g id="edge2565" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M518907.54,-676.25C518337.64,-675.68 516873.58,-666.54 516392,-590 516351.78,-583.61 516309.2,-573.18 516269.68,-561.87"/>
<polygon fill="black" stroke="black" points="516270.55,-558.48 516259.97,-559.06 516268.6,-565.2 516270.55,-558.48"/>
</g>
<!-- layer_13_expert_1_ep_2 -->
<g id="node1384" class="node">
<title>layer_13_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="516946.83,-559 516512.82,-559 516401.17,-455 516835.18,-455 516946.83,-559"/>
<text text-anchor="middle" x="516674" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="516674" y="-510" font-family="Arial" font-size="10.00">GPU: 417</text>
<text text-anchor="middle" x="516674" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="516674" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_1_ep_2 -->
<g id="edge2566" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M518905.11,-674.01C518421.85,-668.71 517324.43,-650.24 516955,-590 516915.12,-583.5 516872.9,-573.12 516833.65,-561.91"/>
<polygon fill="black" stroke="black" points="516834.32,-558.46 516823.74,-559.04 516832.37,-565.18 516834.32,-558.46"/>
</g>
<!-- layer_13_expert_2_ep_2 -->
<g id="node1385" class="node">
<title>layer_13_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="517509.83,-559 517075.82,-559 516964.17,-455 517398.18,-455 517509.83,-559"/>
<text text-anchor="middle" x="517237" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="517237" y="-510" font-family="Arial" font-size="10.00">GPU: 418</text>
<text text-anchor="middle" x="517237" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="517237" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_2_ep_2 -->
<g id="edge2567" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M518900.72,-670.13C518516.88,-659.5 517776.66,-634 517518,-590 517478.63,-583.3 517436.95,-572.99 517398.08,-561.91"/>
<polygon fill="black" stroke="black" points="517398.85,-558.49 517388.27,-559.08 517396.91,-565.21 517398.85,-558.49"/>
</g>
<!-- layer_13_expert_3_ep_2 -->
<g id="node1386" class="node">
<title>layer_13_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="518072.83,-559 517638.82,-559 517527.17,-455 517961.18,-455 518072.83,-559"/>
<text text-anchor="middle" x="517800" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="517800" y="-510" font-family="Arial" font-size="10.00">GPU: 419</text>
<text text-anchor="middle" x="517800" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="517800" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_3_ep_2 -->
<g id="edge2568" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M518901.1,-670.44C518685.69,-662.14 518359.82,-641.47 518081,-590 518042.53,-582.9 518001.79,-572.65 517963.62,-561.8"/>
<polygon fill="black" stroke="black" points="517964.55,-558.42 517953.98,-559.03 517962.62,-565.15 517964.55,-558.42"/>
</g>
<!-- layer_13_expert_4_ep_2 -->
<g id="node1387" class="node">
<title>layer_13_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="518635.83,-559 518201.82,-559 518090.17,-455 518524.18,-455 518635.83,-559"/>
<text text-anchor="middle" x="518363" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="518363" y="-510" font-family="Arial" font-size="10.00">GPU: 420</text>
<text text-anchor="middle" x="518363" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="518363" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_4_ep_2 -->
<g id="edge2569" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M518858.33,-632.91C518788.05,-620.55 518713,-606.02 518644,-590 518608.93,-581.86 518571.76,-571.94 518536.32,-561.86"/>
<polygon fill="black" stroke="black" points="518536.95,-558.4 518526.38,-559.01 518535.03,-565.13 518536.95,-558.4"/>
</g>
<!-- layer_13_expert_5_ep_2 -->
<g id="node1388" class="node">
<title>layer_13_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="519198.83,-559 518764.82,-559 518653.17,-455 519087.18,-455 519198.83,-559"/>
<text text-anchor="middle" x="518926" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="518926" y="-510" font-family="Arial" font-size="10.00">GPU: 421</text>
<text text-anchor="middle" x="518926" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="518926" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_5_ep_2 -->
<g id="edge2570" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M519073.53,-624.91C519049.89,-606.18 519022.97,-584.85 518998.66,-565.58"/>
<polygon fill="black" stroke="black" points="519000.54,-562.6 518990.53,-559.14 518996.19,-568.09 519000.54,-562.6"/>
</g>
<!-- layer_13_expert_6_ep_2 -->
<g id="node1389" class="node">
<title>layer_13_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="519761.83,-559 519327.82,-559 519216.17,-455 519650.18,-455 519761.83,-559"/>
<text text-anchor="middle" x="519489" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="519489" y="-510" font-family="Arial" font-size="10.00">GPU: 422</text>
<text text-anchor="middle" x="519489" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="519489" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_6_ep_2 -->
<g id="edge2571" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M519244.74,-624.91C519285.33,-605.48 519331.74,-583.27 519373.14,-563.46"/>
<polygon fill="black" stroke="black" points="519374.65,-566.61 519382.16,-559.14 519371.63,-560.3 519374.65,-566.61"/>
</g>
<!-- layer_13_expert_7_ep_2 -->
<g id="node1390" class="node">
<title>layer_13_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="520324.83,-559 519890.82,-559 519779.17,-455 520213.18,-455 520324.83,-559"/>
<text text-anchor="middle" x="520052" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="520052" y="-510" font-family="Arial" font-size="10.00">GPU: 423</text>
<text text-anchor="middle" x="520052" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="520052" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_2&#45;&gt;layer_13_expert_7_ep_2 -->
<g id="edge2572" class="edge">
<title>layer_13_route_ep_2&#45;&gt;layer_13_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M519343.52,-655.92C519468.02,-641.82 519629.57,-620.07 519771,-590 519807.39,-582.26 519845.95,-572.25 519882.46,-561.88"/>
<polygon fill="black" stroke="black" points="519883.54,-565.22 519892.19,-559.1 519881.61,-558.48 519883.54,-565.22"/>
</g>
<!-- layer_13_expert_0_ep_3 -->
<g id="node1391" class="node">
<title>layer_13_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="520887.83,-559 520453.82,-559 520342.17,-455 520776.18,-455 520887.83,-559"/>
<text text-anchor="middle" x="520615" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="520615" y="-510" font-family="Arial" font-size="10.00">GPU: 432</text>
<text text-anchor="middle" x="520615" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="520615" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_0_ep_3 -->
<g id="edge2573" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M523714.74,-672.85C523048.11,-663.4 521170.91,-633.25 520896,-590 520855.65,-583.65 520812.94,-573.21 520773.33,-561.86"/>
<polygon fill="black" stroke="black" points="520774.17,-558.47 520763.59,-559.04 520772.22,-565.19 520774.17,-558.47"/>
</g>
<!-- layer_13_expert_1_ep_3 -->
<g id="node1392" class="node">
<title>layer_13_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="521450.83,-559 521016.82,-559 520905.17,-455 521339.18,-455 521450.83,-559"/>
<text text-anchor="middle" x="521178" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="521178" y="-510" font-family="Arial" font-size="10.00">GPU: 433</text>
<text text-anchor="middle" x="521178" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="521178" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_1_ep_3 -->
<g id="edge2574" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M523717.49,-675.36C523185.67,-672.71 521889.41,-659.12 521459,-590 521418.99,-583.57 521376.64,-573.2 521337.29,-561.95"/>
<polygon fill="black" stroke="black" points="521337.93,-558.49 521327.35,-559.07 521335.99,-565.22 521337.93,-558.49"/>
</g>
<!-- layer_13_expert_2_ep_3 -->
<g id="node1393" class="node">
<title>layer_13_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="522013.83,-559 521579.82,-559 521468.17,-455 521902.18,-455 522013.83,-559"/>
<text text-anchor="middle" x="521741" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="521741" y="-510" font-family="Arial" font-size="10.00">GPU: 434</text>
<text text-anchor="middle" x="521741" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="521741" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_2_ep_3 -->
<g id="edge2575" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M523709.57,-668.52C523230.12,-653.08 522184.09,-616.87 522022,-590 521982.25,-583.41 521940.17,-573.04 521901.02,-561.86"/>
<polygon fill="black" stroke="black" points="521901.71,-558.41 521891.13,-559 521899.77,-565.14 521901.71,-558.41"/>
</g>
<!-- layer_13_expert_3_ep_3 -->
<g id="node1394" class="node">
<title>layer_13_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="522576.83,-559 522142.82,-559 522031.17,-455 522465.18,-455 522576.83,-559"/>
<text text-anchor="middle" x="522304" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="522304" y="-510" font-family="Arial" font-size="10.00">GPU: 435</text>
<text text-anchor="middle" x="522304" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="522304" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_3_ep_3 -->
<g id="edge2576" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M523708.41,-667.23C523376.07,-654.02 522793.88,-626.6 522585,-590 522545.89,-583.15 522504.48,-572.84 522465.82,-561.83"/>
<polygon fill="black" stroke="black" points="522466.63,-558.42 522456.05,-559.01 522464.69,-565.14 522466.63,-558.42"/>
</g>
<!-- layer_13_expert_4_ep_3 -->
<g id="node1395" class="node">
<title>layer_13_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="523139.83,-559 522705.82,-559 522594.17,-455 523028.18,-455 523139.83,-559"/>
<text text-anchor="middle" x="522867" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="522867" y="-510" font-family="Arial" font-size="10.00">GPU: 436</text>
<text text-anchor="middle" x="522867" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="522867" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_4_ep_3 -->
<g id="edge2577" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M523701.01,-660.75C523541.91,-648.17 523331.5,-626.33 523148,-590 523110.59,-582.59 523070.96,-572.48 523033.64,-561.89"/>
<polygon fill="black" stroke="black" points="523034.27,-558.43 523023.69,-559.04 523032.34,-565.16 523034.27,-558.43"/>
</g>
<!-- layer_13_expert_5_ep_3 -->
<g id="node1396" class="node">
<title>layer_13_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="523702.83,-559 523268.82,-559 523157.17,-455 523591.18,-455 523702.83,-559"/>
<text text-anchor="middle" x="523430" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="523430" y="-510" font-family="Arial" font-size="10.00">GPU: 437</text>
<text text-anchor="middle" x="523430" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="523430" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_5_ep_3 -->
<g id="edge2578" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M523791.17,-624.91C523730.02,-605.12 523659.93,-582.43 523597.86,-562.34"/>
<polygon fill="black" stroke="black" points="523598.57,-558.89 523587.97,-559.14 523596.41,-565.55 523598.57,-558.89"/>
</g>
<!-- layer_13_expert_6_ep_3 -->
<g id="node1397" class="node">
<title>layer_13_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="524265.83,-559 523831.82,-559 523720.17,-455 524154.18,-455 524265.83,-559"/>
<text text-anchor="middle" x="523993" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="523993" y="-510" font-family="Arial" font-size="10.00">GPU: 438</text>
<text text-anchor="middle" x="523993" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="523993" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_6_ep_3 -->
<g id="edge2579" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M523962.44,-624.68C523967.07,-607.01 523972.29,-587.06 523977.1,-568.72"/>
<polygon fill="black" stroke="black" points="523980.49,-569.56 523979.64,-559 523973.72,-567.79 523980.49,-569.56"/>
</g>
<!-- layer_13_expert_7_ep_3 -->
<g id="node1398" class="node">
<title>layer_13_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="524828.83,-559 524394.82,-559 524283.17,-455 524717.18,-455 524828.83,-559"/>
<text text-anchor="middle" x="524556" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="524556" y="-510" font-family="Arial" font-size="10.00">GPU: 439</text>
<text text-anchor="middle" x="524556" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="524556" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_3&#45;&gt;layer_13_expert_7_ep_3 -->
<g id="edge2580" class="edge">
<title>layer_13_route_ep_3&#45;&gt;layer_13_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M524125.61,-630.31C524174.1,-617.52 524226.64,-603.43 524275,-590 524309.69,-580.37 524346.69,-569.78 524382.08,-559.52"/>
<polygon fill="black" stroke="black" points="524383.39,-562.78 524392.02,-556.63 524381.44,-556.06 524383.39,-562.78"/>
</g>
<!-- layer_13_expert_0_ep_4 -->
<g id="node1399" class="node">
<title>layer_13_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="525391.83,-559 524957.82,-559 524846.17,-455 525280.18,-455 525391.83,-559"/>
<text text-anchor="middle" x="525119" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="525119" y="-510" font-family="Arial" font-size="10.00">GPU: 448</text>
<text text-anchor="middle" x="525119" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="525119" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_0_ep_4 -->
<g id="edge2581" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M526906.96,-671.21C526499.99,-661.79 525682.72,-637.55 525400,-590 525360.5,-583.36 525318.68,-573.03 525279.72,-561.92"/>
<polygon fill="black" stroke="black" points="525280.46,-558.49 525269.88,-559.08 525278.52,-565.22 525280.46,-558.49"/>
</g>
<!-- layer_13_expert_1_ep_4 -->
<g id="node1400" class="node">
<title>layer_13_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="525954.83,-559 525520.82,-559 525409.17,-455 525843.18,-455 525954.83,-559"/>
<text text-anchor="middle" x="525682" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="525682" y="-510" font-family="Arial" font-size="10.00">GPU: 449</text>
<text text-anchor="middle" x="525682" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="525682" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_1_ep_4 -->
<g id="edge2582" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M526909.45,-673.47C526670.08,-667.5 526287.95,-648.57 525963,-590 525924.27,-583.02 525883.26,-572.76 525844.89,-561.84"/>
<polygon fill="black" stroke="black" points="525845.78,-558.45 525835.2,-559.05 525843.84,-565.18 525845.78,-558.45"/>
</g>
<!-- layer_13_expert_2_ep_4 -->
<g id="node1401" class="node">
<title>layer_13_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="526517.83,-559 526083.82,-559 525972.17,-455 526406.18,-455 526517.83,-559"/>
<text text-anchor="middle" x="526245" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="526245" y="-510" font-family="Arial" font-size="10.00">GPU: 450</text>
<text text-anchor="middle" x="526245" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="526245" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_2_ep_4 -->
<g id="edge2583" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M526880.34,-647.94C526770.23,-633.97 526641.27,-614.71 526526,-590 526489.62,-582.2 526451.07,-572.16 526414.56,-561.79"/>
<polygon fill="black" stroke="black" points="526415.41,-558.39 526404.83,-559 526413.48,-565.12 526415.41,-558.39"/>
</g>
<!-- layer_13_expert_3_ep_4 -->
<g id="node1402" class="node">
<title>layer_13_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="527080.83,-559 526646.82,-559 526535.17,-455 526969.18,-455 527080.83,-559"/>
<text text-anchor="middle" x="526808" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="526808" y="-510" font-family="Arial" font-size="10.00">GPU: 451</text>
<text text-anchor="middle" x="526808" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="526808" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_3_ep_4 -->
<g id="edge2584" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M527041.12,-624.91C527002.63,-605.61 526958.64,-583.55 526919.33,-563.83"/>
<polygon fill="black" stroke="black" points="526920.48,-560.49 526909.97,-559.14 526917.34,-566.75 526920.48,-560.49"/>
</g>
<!-- layer_13_expert_4_ep_4 -->
<g id="node1403" class="node">
<title>layer_13_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="527643.83,-559 527209.82,-559 527098.17,-455 527532.18,-455 527643.83,-559"/>
<text text-anchor="middle" x="527371" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="527371" y="-510" font-family="Arial" font-size="10.00">GPU: 452</text>
<text text-anchor="middle" x="527371" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="527371" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_4_ep_4 -->
<g id="edge2585" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M527212.34,-624.91C527237.98,-606.01 527267.21,-584.48 527293.53,-565.08"/>
<polygon fill="black" stroke="black" points="527295.63,-567.89 527301.6,-559.14 527291.47,-562.25 527295.63,-567.89"/>
</g>
<!-- layer_13_expert_5_ep_4 -->
<g id="node1404" class="node">
<title>layer_13_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="528206.83,-559 527772.82,-559 527661.17,-455 528095.18,-455 528206.83,-559"/>
<text text-anchor="middle" x="527934" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="527934" y="-510" font-family="Arial" font-size="10.00">GPU: 453</text>
<text text-anchor="middle" x="527934" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="527934" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_5_ep_4 -->
<g id="edge2586" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M527339.92,-648.29C527435.03,-633.51 527550.49,-613.51 527653,-590 527688.54,-581.85 527726.24,-571.82 527762.08,-561.62"/>
<polygon fill="black" stroke="black" points="527763.49,-564.85 527772.14,-558.73 527761.56,-558.12 527763.49,-564.85"/>
</g>
<!-- layer_13_expert_6_ep_4 -->
<g id="node1405" class="node">
<title>layer_13_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="528769.83,-559 528335.82,-559 528224.17,-455 528658.18,-455 528769.83,-559"/>
<text text-anchor="middle" x="528497" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="528497" y="-510" font-family="Arial" font-size="10.00">GPU: 454</text>
<text text-anchor="middle" x="528497" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="528497" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_6_ep_4 -->
<g id="edge2587" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M527366.15,-671.35C527584.4,-663.7 527925.37,-643.47 528216,-590 528254.47,-582.92 528295.22,-572.69 528333.38,-561.83"/>
<polygon fill="black" stroke="black" points="528334.39,-565.19 528343.03,-559.06 528332.45,-558.46 528334.39,-565.19"/>
</g>
<!-- layer_13_expert_7_ep_4 -->
<g id="node1406" class="node">
<title>layer_13_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="529332.83,-559 528898.82,-559 528787.17,-455 529221.18,-455 529332.83,-559"/>
<text text-anchor="middle" x="529060" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="529060" y="-510" font-family="Arial" font-size="10.00">GPU: 455</text>
<text text-anchor="middle" x="529060" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="529060" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_4&#45;&gt;layer_13_expert_7_ep_4 -->
<g id="edge2588" class="edge">
<title>layer_13_route_ep_4&#45;&gt;layer_13_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M527365.32,-670.68C527747.57,-660.46 528513.84,-635.03 528779,-590 528818.38,-583.31 528860.06,-573 528898.92,-561.93"/>
<polygon fill="black" stroke="black" points="528900.1,-565.23 528908.73,-559.1 528898.16,-558.5 528900.1,-565.23"/>
</g>
<!-- layer_13_expert_0_ep_5 -->
<g id="node1407" class="node">
<title>layer_13_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="529895.83,-559 529461.82,-559 529350.17,-455 529784.18,-455 529895.83,-559"/>
<text text-anchor="middle" x="529623" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="529623" y="-510" font-family="Arial" font-size="10.00">GPU: 464</text>
<text text-anchor="middle" x="529623" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="529623" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_0_ep_5 -->
<g id="edge2589" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M530118.33,-632.91C530048.05,-620.55 529973,-606.02 529904,-590 529868.93,-581.86 529831.76,-571.94 529796.32,-561.86"/>
<polygon fill="black" stroke="black" points="529796.95,-558.4 529786.38,-559.01 529795.03,-565.13 529796.95,-558.4"/>
</g>
<!-- layer_13_expert_1_ep_5 -->
<g id="node1408" class="node">
<title>layer_13_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="530458.83,-559 530024.82,-559 529913.17,-455 530347.18,-455 530458.83,-559"/>
<text text-anchor="middle" x="530186" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="530186" y="-510" font-family="Arial" font-size="10.00">GPU: 465</text>
<text text-anchor="middle" x="530186" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="530186" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_1_ep_5 -->
<g id="edge2590" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M530333.53,-624.91C530309.89,-606.18 530282.97,-584.85 530258.66,-565.58"/>
<polygon fill="black" stroke="black" points="530260.54,-562.6 530250.53,-559.14 530256.19,-568.09 530260.54,-562.6"/>
</g>
<!-- layer_13_expert_2_ep_5 -->
<g id="node1409" class="node">
<title>layer_13_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="531021.83,-559 530587.82,-559 530476.17,-455 530910.18,-455 531021.83,-559"/>
<text text-anchor="middle" x="530749" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="530749" y="-510" font-family="Arial" font-size="10.00">GPU: 466</text>
<text text-anchor="middle" x="530749" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="530749" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_2_ep_5 -->
<g id="edge2591" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M530504.74,-624.91C530545.33,-605.48 530591.74,-583.27 530633.14,-563.46"/>
<polygon fill="black" stroke="black" points="530634.65,-566.61 530642.16,-559.14 530631.63,-560.3 530634.65,-566.61"/>
</g>
<!-- layer_13_expert_3_ep_5 -->
<g id="node1410" class="node">
<title>layer_13_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="531584.83,-559 531150.82,-559 531039.17,-455 531473.18,-455 531584.83,-559"/>
<text text-anchor="middle" x="531312" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="531312" y="-510" font-family="Arial" font-size="10.00">GPU: 467</text>
<text text-anchor="middle" x="531312" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="531312" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_3_ep_5 -->
<g id="edge2592" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M530603.52,-655.92C530728.02,-641.82 530889.57,-620.07 531031,-590 531067.39,-582.26 531105.95,-572.25 531142.46,-561.88"/>
<polygon fill="black" stroke="black" points="531143.54,-565.22 531152.19,-559.1 531141.61,-558.48 531143.54,-565.22"/>
</g>
<!-- layer_13_expert_4_ep_5 -->
<g id="node1411" class="node">
<title>layer_13_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="532147.83,-559 531713.82,-559 531602.17,-455 532036.18,-455 532147.83,-559"/>
<text text-anchor="middle" x="531875" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="531875" y="-510" font-family="Arial" font-size="10.00">GPU: 468</text>
<text text-anchor="middle" x="531875" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="531875" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_4_ep_5 -->
<g id="edge2593" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M530624.06,-673.98C530865.87,-668.51 531259.77,-650.08 531594,-590 531632.73,-583.04 531673.74,-572.78 531712.11,-561.87"/>
<polygon fill="black" stroke="black" points="531713.16,-565.21 531721.81,-559.08 531711.23,-558.48 531713.16,-565.21"/>
</g>
<!-- layer_13_expert_5_ep_5 -->
<g id="node1412" class="node">
<title>layer_13_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="532710.83,-559 532276.82,-559 532165.17,-455 532599.18,-455 532710.83,-559"/>
<text text-anchor="middle" x="532438" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="532438" y="-510" font-family="Arial" font-size="10.00">GPU: 469</text>
<text text-anchor="middle" x="532438" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="532438" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_5_ep_5 -->
<g id="edge2594" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M530621.34,-671.62C531026.68,-662.57 531868.2,-638.5 532157,-590 532196.5,-583.37 532238.32,-573.04 532277.28,-561.93"/>
<polygon fill="black" stroke="black" points="532278.48,-565.23 532287.12,-559.09 532276.54,-558.5 532278.48,-565.23"/>
</g>
<!-- layer_13_expert_6_ep_5 -->
<g id="node1413" class="node">
<title>layer_13_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="533273.83,-559 532839.82,-559 532728.17,-455 533162.18,-455 533273.83,-559"/>
<text text-anchor="middle" x="533001" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="533001" y="-510" font-family="Arial" font-size="10.00">GPU: 470</text>
<text text-anchor="middle" x="533001" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="533001" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_6_ep_5 -->
<g id="edge2595" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M530625.09,-674.71C531127.8,-670.7 532321.66,-654.48 532720,-590 532760,-583.52 532802.35,-573.13 532841.7,-561.88"/>
<polygon fill="black" stroke="black" points="532843,-565.15 532851.64,-559 532841.06,-558.42 532843,-565.15"/>
</g>
<!-- layer_13_expert_7_ep_5 -->
<g id="node1414" class="node">
<title>layer_13_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="533836.83,-559 533402.82,-559 533291.17,-455 533725.18,-455 533836.83,-559"/>
<text text-anchor="middle" x="533564" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="533564" y="-510" font-family="Arial" font-size="10.00">GPU: 471</text>
<text text-anchor="middle" x="533564" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="533564" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_5&#45;&gt;layer_13_expert_7_ep_5 -->
<g id="edge2596" class="edge">
<title>layer_13_route_ep_5&#45;&gt;layer_13_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M530627.1,-676.67C531216.24,-677.18 532773.29,-670.62 533283,-590 533323.23,-583.64 533365.81,-573.22 533405.32,-561.92"/>
<polygon fill="black" stroke="black" points="533406.4,-565.25 533415.03,-559.1 533404.45,-558.52 533406.4,-565.25"/>
</g>
<!-- layer_13_expert_0_ep_6 -->
<g id="node1415" class="node">
<title>layer_13_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="534399.83,-559 533965.82,-559 533854.17,-455 534288.18,-455 534399.83,-559"/>
<text text-anchor="middle" x="534127" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="534127" y="-510" font-family="Arial" font-size="10.00">GPU: 480</text>
<text text-anchor="middle" x="534127" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="534127" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_0_ep_6 -->
<g id="edge2597" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M534191.59,-624.68C534181.68,-606.77 534170.46,-586.51 534160.19,-567.96"/>
<polygon fill="black" stroke="black" points="534163.14,-566.06 534155.23,-559 534157.02,-569.45 534163.14,-566.06"/>
</g>
<!-- layer_13_expert_1_ep_6 -->
<g id="node1416" class="node">
<title>layer_13_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="534962.83,-559 534528.82,-559 534417.17,-455 534851.18,-455 534962.83,-559"/>
<text text-anchor="middle" x="534690" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="534690" y="-510" font-family="Arial" font-size="10.00">GPU: 481</text>
<text text-anchor="middle" x="534690" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="534690" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_1_ep_6 -->
<g id="edge2598" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M534362.93,-624.91C534418.07,-605.2 534481.25,-582.62 534537.29,-562.59"/>
<polygon fill="black" stroke="black" points="534538.7,-565.8 534546.94,-559.14 534536.35,-559.21 534538.7,-565.8"/>
</g>
<!-- layer_13_expert_2_ep_6 -->
<g id="node1417" class="node">
<title>layer_13_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="535525.83,-559 535091.82,-559 534980.17,-455 535414.18,-455 535525.83,-559"/>
<text text-anchor="middle" x="535253" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="535253" y="-510" font-family="Arial" font-size="10.00">GPU: 482</text>
<text text-anchor="middle" x="535253" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="535253" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_2_ep_6 -->
<g id="edge2599" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M534404.36,-637.15C534483.33,-622.15 534576.81,-606.57 534662,-598 534730.57,-591.1 534903.91,-600.63 534972,-590 535012.47,-583.68 535055.32,-573.21 535095.02,-561.83"/>
<polygon fill="black" stroke="black" points="535096.15,-565.15 535104.78,-559 535094.2,-558.43 535096.15,-565.15"/>
</g>
<!-- layer_13_expert_3_ep_6 -->
<g id="node1418" class="node">
<title>layer_13_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="536088.83,-559 535654.82,-559 535543.17,-455 535977.18,-455 536088.83,-559"/>
<text text-anchor="middle" x="535816" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="535816" y="-510" font-family="Arial" font-size="10.00">GPU: 483</text>
<text text-anchor="middle" x="535816" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="535816" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_3_ep_6 -->
<g id="edge2600" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M534409.91,-642C534445.45,-636.03 534482.32,-630.1 534517,-625 534614.46,-610.66 534638.7,-604.5 534737,-598 534825.48,-592.15 535447.28,-602.99 535535,-590 535575.99,-583.93 535619.37,-573.41 535659.46,-561.89"/>
<polygon fill="black" stroke="black" points="535660.68,-565.18 535669.3,-559.02 535658.72,-558.46 535660.68,-565.18"/>
</g>
<!-- layer_13_expert_4_ep_6 -->
<g id="node1419" class="node">
<title>layer_13_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="536651.83,-559 536217.82,-559 536106.17,-455 536540.18,-455 536651.83,-559"/>
<text text-anchor="middle" x="536379" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="536379" y="-510" font-family="Arial" font-size="10.00">GPU: 484</text>
<text text-anchor="middle" x="536379" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="536379" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_4_ep_6 -->
<g id="edge2601" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M534409.43,-641.47C534445.1,-635.54 534482.14,-629.76 534517,-625 534595.35,-614.3 534615.36,-615.21 534694,-607 534731.34,-603.1 534740.51,-600.12 534778,-598 534851.22,-593.87 536025.43,-600.6 536098,-590 536139.2,-583.98 536182.81,-573.42 536223.07,-561.83"/>
<polygon fill="black" stroke="black" points="536224.06,-565.19 536232.68,-559.03 536222.1,-558.47 536224.06,-565.19"/>
</g>
<!-- layer_13_expert_5_ep_6 -->
<g id="node1420" class="node">
<title>layer_13_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="537214.83,-559 536780.82,-559 536669.17,-455 537103.18,-455 537214.83,-559"/>
<text text-anchor="middle" x="536942" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="536942" y="-510" font-family="Arial" font-size="10.00">GPU: 485</text>
<text text-anchor="middle" x="536942" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="536942" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_5_ep_6 -->
<g id="edge2602" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M534408.95,-640.94C534444.75,-635.04 534481.96,-629.41 534517,-625 534616.1,-612.54 534641.76,-618.3 534741,-607 534768.23,-603.9 534774.67,-600.06 534802,-598 534904.99,-590.22 536558.79,-604.83 536661,-590 536702.21,-584.02 536745.82,-573.47 536786.08,-561.88"/>
<polygon fill="black" stroke="black" points="536787.07,-565.24 536795.69,-559.08 536785.11,-558.52 536787.07,-565.24"/>
</g>
<!-- layer_13_expert_6_ep_6 -->
<g id="node1421" class="node">
<title>layer_13_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="537777.83,-559 537343.82,-559 537232.17,-455 537666.18,-455 537777.83,-559"/>
<text text-anchor="middle" x="537505" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="537505" y="-510" font-family="Arial" font-size="10.00">GPU: 486</text>
<text text-anchor="middle" x="537505" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="537505" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_6_ep_6 -->
<g id="edge2603" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M534408.52,-640.69C534444.44,-634.8 534481.81,-629.23 534517,-625 534631.56,-611.22 534661.74,-623.13 534776,-607 534794.9,-604.33 534799.02,-600.04 534818,-598 534950.9,-583.7 537091.71,-609.13 537224,-590 537265.32,-584.02 537309.07,-573.44 537349.42,-561.81"/>
<polygon fill="black" stroke="black" points="537350.44,-565.16 537359.06,-559 537348.48,-558.44 537350.44,-565.16"/>
</g>
<!-- layer_13_expert_7_ep_6 -->
<g id="node1422" class="node">
<title>layer_13_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="538340.83,-559 537906.82,-559 537795.17,-455 538229.18,-455 538340.83,-559"/>
<text text-anchor="middle" x="538068" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="538068" y="-510" font-family="Arial" font-size="10.00">GPU: 487</text>
<text text-anchor="middle" x="538068" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="538068" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_6&#45;&gt;layer_13_expert_7_ep_6 -->
<g id="edge2604" class="edge">
<title>layer_13_route_ep_6&#45;&gt;layer_13_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M534407.2,-639.71C534443.5,-633.85 534481.34,-628.55 534517,-625 534728.26,-603.98 535259.72,-601.37 535472,-598 535536.3,-596.98 537723.36,-599.21 537787,-590 537828.21,-584.04 537871.82,-573.49 537912.08,-561.91"/>
<polygon fill="black" stroke="black" points="537913.08,-565.26 537921.7,-559.1 537911.12,-558.54 537913.08,-565.26"/>
</g>
<!-- layer_13_expert_0_ep_7 -->
<g id="node1423" class="node">
<title>layer_13_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="538903.83,-559 538469.82,-559 538358.17,-455 538792.18,-455 538903.83,-559"/>
<text text-anchor="middle" x="538631" y="-521" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="538631" y="-510" font-family="Arial" font-size="10.00">GPU: 496</text>
<text text-anchor="middle" x="538631" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="538631" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_0_ep_7 -->
<g id="edge2605" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M535000.75,-639.32C535037.18,-633.47 535075.18,-628.28 535111,-625 535593.91,-580.83 536808.1,-602.84 537293,-598 537351.72,-597.41 538291.9,-598.53 538350,-590 538390.99,-583.98 538434.38,-573.48 538474.47,-561.96"/>
<polygon fill="black" stroke="black" points="538475.69,-565.25 538484.31,-559.09 538473.73,-558.53 538475.69,-565.25"/>
</g>
<!-- layer_13_expert_1_ep_7 -->
<g id="node1424" class="node">
<title>layer_13_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="539466.83,-559 539032.82,-559 538921.17,-455 539355.18,-455 539466.83,-559"/>
<text text-anchor="middle" x="539194" y="-521" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="539194" y="-510" font-family="Arial" font-size="10.00">GPU: 497</text>
<text text-anchor="middle" x="539194" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="539194" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_1_ep_7 -->
<g id="edge2606" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M535000.75,-639.23C535037.17,-633.39 535075.18,-628.22 535111,-625 535216.19,-615.55 538808.52,-605.42 538913,-590 538953.99,-583.95 538997.37,-573.44 539037.46,-561.92"/>
<polygon fill="black" stroke="black" points="539038.69,-565.2 539047.31,-559.05 539036.73,-558.48 539038.69,-565.2"/>
</g>
<!-- layer_13_expert_2_ep_7 -->
<g id="node1425" class="node">
<title>layer_13_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="540029.83,-559 539595.82,-559 539484.17,-455 539918.18,-455 540029.83,-559"/>
<text text-anchor="middle" x="539757" y="-521" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="539757" y="-510" font-family="Arial" font-size="10.00">GPU: 498</text>
<text text-anchor="middle" x="539757" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="539757" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_2_ep_7 -->
<g id="edge2607" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M535000.74,-639.14C535037.17,-633.31 535075.17,-628.17 535111,-625 535269.44,-610.99 537814.95,-608.4 537974,-607 538307.79,-604.06 539145.83,-639.1 539476,-590 539516.87,-583.92 539560.11,-573.44 539600.11,-561.95"/>
<polygon fill="black" stroke="black" points="539601.31,-565.25 539609.94,-559.09 539599.36,-558.53 539601.31,-565.25"/>
</g>
<!-- layer_13_expert_3_ep_7 -->
<g id="node1426" class="node">
<title>layer_13_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="540592.83,-559 540158.82,-559 540047.17,-455 540481.18,-455 540592.83,-559"/>
<text text-anchor="middle" x="540320" y="-521" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="540320" y="-510" font-family="Arial" font-size="10.00">GPU: 499</text>
<text text-anchor="middle" x="540320" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="540320" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_3_ep_7 -->
<g id="edge2608" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M535000.74,-639.11C535037.16,-633.28 535075.17,-628.14 535111,-625 535308.8,-607.64 538486.45,-608.75 538685,-607 538985.9,-604.35 539741.39,-634.44 540039,-590 540079.86,-583.9 540123.11,-573.4 540163.11,-561.92"/>
<polygon fill="black" stroke="black" points="540164.31,-565.21 540172.93,-559.06 540162.35,-558.49 540164.31,-565.21"/>
</g>
<!-- layer_13_expert_4_ep_7 -->
<g id="node1427" class="node">
<title>layer_13_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="541155.83,-559 540721.82,-559 540610.17,-455 541044.18,-455 541155.83,-559"/>
<text text-anchor="middle" x="540883" y="-521" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="540883" y="-510" font-family="Arial" font-size="10.00">GPU: 500</text>
<text text-anchor="middle" x="540883" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="540883" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_4_ep_7 -->
<g id="edge2609" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M535000.73,-639.08C535037.16,-633.26 535075.17,-628.13 535111,-625 535344.34,-604.61 539092.78,-609.06 539327,-607 539610.35,-604.51 540321.77,-631.96 540602,-590 540642.86,-583.88 540686.11,-573.38 540726.1,-561.9"/>
<polygon fill="black" stroke="black" points="540727.3,-565.19 540735.93,-559.04 540725.35,-558.47 540727.3,-565.19"/>
</g>
<!-- layer_13_expert_5_ep_7 -->
<g id="node1428" class="node">
<title>layer_13_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="541718.83,-559 541284.82,-559 541173.17,-455 541607.18,-455 541718.83,-559"/>
<text text-anchor="middle" x="541446" y="-521" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="541446" y="-510" font-family="Arial" font-size="10.00">GPU: 501</text>
<text text-anchor="middle" x="541446" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="541446" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_5_ep_7 -->
<g id="edge2610" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M535000.73,-639.07C535037.16,-633.24 535075.17,-628.12 535111,-625 535377.77,-601.76 539663.23,-609.34 539931,-607 540205.24,-604.6 540893.78,-630.67 541165,-590 541205.86,-583.87 541249.1,-573.37 541289.1,-561.88"/>
<polygon fill="black" stroke="black" points="541290.3,-565.18 541298.92,-559.02 541288.35,-558.46 541290.3,-565.18"/>
</g>
<!-- layer_13_expert_6_ep_7 -->
<g id="node1429" class="node">
<title>layer_13_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="542281.83,-559 541847.82,-559 541736.17,-455 542170.18,-455 542281.83,-559"/>
<text text-anchor="middle" x="542009" y="-521" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="542009" y="-510" font-family="Arial" font-size="10.00">GPU: 502</text>
<text text-anchor="middle" x="542009" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="542009" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_6_ep_7 -->
<g id="edge2611" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M535000.73,-639.06C535037.16,-633.23 535075.17,-628.11 535111,-625 535260.58,-612 540365.87,-608.3 540516,-607 540785.35,-604.66 541461.62,-629.98 541728,-590 541768.86,-583.87 541812.1,-573.36 541852.1,-561.88"/>
<polygon fill="black" stroke="black" points="541853.3,-565.17 541861.92,-559.02 541851.34,-558.45 541853.3,-565.17"/>
</g>
<!-- layer_13_expert_7_ep_7 -->
<g id="node1430" class="node">
<title>layer_13_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="542844.83,-559 542410.82,-559 542299.17,-455 542733.18,-455 542844.83,-559"/>
<text text-anchor="middle" x="542572" y="-521" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="542572" y="-510" font-family="Arial" font-size="10.00">GPU: 503</text>
<text text-anchor="middle" x="542572" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="542572" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_13_route_ep_7&#45;&gt;layer_13_expert_7_ep_7 -->
<g id="edge2612" class="edge">
<title>layer_13_route_ep_7&#45;&gt;layer_13_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M535000.73,-639.05C535037.16,-633.23 535075.17,-628.11 535111,-625 535276.49,-610.64 540924.89,-608.43 541091,-607 541357.68,-604.71 542027.26,-629.6 542291,-590 542331.86,-583.86 542375.1,-573.36 542415.1,-561.87"/>
<polygon fill="black" stroke="black" points="542416.3,-565.17 542424.92,-559.01 542414.34,-558.45 542416.3,-565.17"/>
</g>
<!-- layer_13_agg_ep_0 -->
<g id="node1431" class="node">
<title>layer_13_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="509638.07,-410 509187.77,-410 509071.93,-306 509522.23,-306 509638.07,-410"/>
<text text-anchor="middle" x="509355" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="509355" y="-361" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="509355" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="509355" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2613" class="edge">
<title>layer_13_expert_0_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M507275.39,-465.2C507311.11,-458.05 507348.64,-451.47 507384,-447 507714.72,-405.18 508681.93,-376.08 509126.58,-364.54"/>
<polygon fill="black" stroke="black" points="509126.76,-368.03 509136.66,-364.27 509126.58,-361.03 509126.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2614" class="edge">
<title>layer_13_expert_1_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M507838.82,-465.62C507874.43,-458.45 507911.8,-451.77 507947,-447 508359.65,-391.08 508845.25,-370.62 509124.87,-363.19"/>
<polygon fill="black" stroke="black" points="509125.24,-366.68 509135.14,-362.92 509125.05,-359.68 509125.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2615" class="edge">
<title>layer_13_expert_2_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M508402.74,-466.6C508438.11,-459.4 508475.16,-452.46 508510,-447 508722.34,-413.74 508966.74,-389.83 509137.9,-375.41"/>
<polygon fill="black" stroke="black" points="509138.36,-378.88 509148.04,-374.55 509137.78,-371.9 509138.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2616" class="edge">
<title>layer_13_expert_3_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M508960.92,-461.9C509027.29,-444.56 509103.66,-424.62 509171.4,-406.94"/>
<polygon fill="black" stroke="black" points="509172.53,-410.26 509181.33,-404.35 509170.77,-403.49 509172.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2617" class="edge">
<title>layer_13_expert_4_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M509355,-455C509355,-443.95 509355,-432.15 509355,-420.75"/>
<polygon fill="black" stroke="black" points="509358.5,-420.41 509355,-410.41 509351.5,-420.41 509358.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2618" class="edge">
<title>layer_13_expert_5_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M509722.67,-455C509670.2,-441.3 509613.31,-426.44 509560.31,-412.61"/>
<polygon fill="black" stroke="black" points="509561.02,-409.18 509550.46,-410.04 509559.25,-415.95 509561.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2619" class="edge">
<title>layer_13_expert_6_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M510247.13,-455C510231.21,-452.11 510215.39,-449.41 510200,-447 510003.91,-416.29 509780.48,-393.55 509612.64,-378.88"/>
<polygon fill="black" stroke="black" points="509612.94,-375.4 509602.68,-378.02 509612.34,-382.37 509612.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_0&#45;&gt;layer_13_agg_ep_0 -->
<g id="edge2620" class="edge">
<title>layer_13_expert_7_ep_0&#45;&gt;layer_13_agg_ep_0</title>
<path fill="none" stroke="black" d="M510814.44,-454.98C510797.09,-451.99 510779.79,-449.28 510763,-447 510355.89,-391.83 509877.79,-371.18 509596.51,-363.5"/>
<polygon fill="black" stroke="black" points="509596.26,-359.99 509586.17,-363.22 509596.07,-366.99 509596.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_1 -->
<g id="node1432" class="node">
<title>layer_13_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="514142.07,-410 513691.77,-410 513575.93,-306 514026.23,-306 514142.07,-410"/>
<text text-anchor="middle" x="513859" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="513859" y="-361" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="513859" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="513859" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2622" class="edge">
<title>layer_13_expert_0_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M511779.39,-465.2C511815.11,-458.05 511852.64,-451.47 511888,-447 512218.72,-405.18 513185.93,-376.08 513630.58,-364.54"/>
<polygon fill="black" stroke="black" points="513630.76,-368.03 513640.66,-364.27 513630.58,-361.03 513630.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2623" class="edge">
<title>layer_13_expert_1_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M512342.82,-465.62C512378.43,-458.45 512415.8,-451.77 512451,-447 512863.65,-391.08 513349.25,-370.62 513628.87,-363.19"/>
<polygon fill="black" stroke="black" points="513629.24,-366.68 513639.14,-362.92 513629.05,-359.68 513629.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2624" class="edge">
<title>layer_13_expert_2_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M512906.74,-466.6C512942.11,-459.4 512979.16,-452.46 513014,-447 513226.34,-413.74 513470.74,-389.83 513641.9,-375.41"/>
<polygon fill="black" stroke="black" points="513642.36,-378.88 513652.04,-374.55 513641.78,-371.9 513642.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2625" class="edge">
<title>layer_13_expert_3_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M513464.92,-461.9C513531.29,-444.56 513607.66,-424.62 513675.4,-406.94"/>
<polygon fill="black" stroke="black" points="513676.53,-410.26 513685.33,-404.35 513674.77,-403.49 513676.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2626" class="edge">
<title>layer_13_expert_4_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M513859,-455C513859,-443.95 513859,-432.15 513859,-420.75"/>
<polygon fill="black" stroke="black" points="513862.5,-420.41 513859,-410.41 513855.5,-420.41 513862.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2627" class="edge">
<title>layer_13_expert_5_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M514226.67,-455C514174.2,-441.3 514117.31,-426.44 514064.31,-412.61"/>
<polygon fill="black" stroke="black" points="514065.02,-409.18 514054.46,-410.04 514063.25,-415.95 514065.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2628" class="edge">
<title>layer_13_expert_6_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M514751.13,-455C514735.21,-452.11 514719.39,-449.41 514704,-447 514507.91,-416.29 514284.48,-393.55 514116.64,-378.88"/>
<polygon fill="black" stroke="black" points="514116.94,-375.4 514106.68,-378.02 514116.34,-382.37 514116.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_1&#45;&gt;layer_13_agg_ep_1 -->
<g id="edge2629" class="edge">
<title>layer_13_expert_7_ep_1&#45;&gt;layer_13_agg_ep_1</title>
<path fill="none" stroke="black" d="M515318.44,-454.98C515301.09,-451.99 515283.79,-449.28 515267,-447 514859.89,-391.83 514381.79,-371.18 514100.51,-363.5"/>
<polygon fill="black" stroke="black" points="514100.26,-359.99 514090.17,-363.22 514100.07,-366.99 514100.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_2 -->
<g id="node1433" class="node">
<title>layer_13_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="518646.07,-410 518195.77,-410 518079.93,-306 518530.23,-306 518646.07,-410"/>
<text text-anchor="middle" x="518363" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="518363" y="-361" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="518363" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="518363" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2631" class="edge">
<title>layer_13_expert_0_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M516283.39,-465.2C516319.11,-458.05 516356.64,-451.47 516392,-447 516722.72,-405.18 517689.93,-376.08 518134.58,-364.54"/>
<polygon fill="black" stroke="black" points="518134.76,-368.03 518144.66,-364.27 518134.58,-361.03 518134.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2632" class="edge">
<title>layer_13_expert_1_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M516846.82,-465.62C516882.43,-458.45 516919.8,-451.77 516955,-447 517367.65,-391.08 517853.25,-370.62 518132.87,-363.19"/>
<polygon fill="black" stroke="black" points="518133.24,-366.68 518143.14,-362.92 518133.05,-359.68 518133.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2633" class="edge">
<title>layer_13_expert_2_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M517410.74,-466.6C517446.11,-459.4 517483.16,-452.46 517518,-447 517730.34,-413.74 517974.74,-389.83 518145.9,-375.41"/>
<polygon fill="black" stroke="black" points="518146.36,-378.88 518156.04,-374.55 518145.78,-371.9 518146.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2634" class="edge">
<title>layer_13_expert_3_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M517968.92,-461.9C518035.29,-444.56 518111.66,-424.62 518179.4,-406.94"/>
<polygon fill="black" stroke="black" points="518180.53,-410.26 518189.33,-404.35 518178.77,-403.49 518180.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2635" class="edge">
<title>layer_13_expert_4_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M518363,-455C518363,-443.95 518363,-432.15 518363,-420.75"/>
<polygon fill="black" stroke="black" points="518366.5,-420.41 518363,-410.41 518359.5,-420.41 518366.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2636" class="edge">
<title>layer_13_expert_5_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M518730.67,-455C518678.2,-441.3 518621.31,-426.44 518568.31,-412.61"/>
<polygon fill="black" stroke="black" points="518569.02,-409.18 518558.46,-410.04 518567.25,-415.95 518569.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2637" class="edge">
<title>layer_13_expert_6_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M519255.13,-455C519239.21,-452.11 519223.39,-449.41 519208,-447 519011.91,-416.29 518788.48,-393.55 518620.64,-378.88"/>
<polygon fill="black" stroke="black" points="518620.94,-375.4 518610.68,-378.02 518620.34,-382.37 518620.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_2&#45;&gt;layer_13_agg_ep_2 -->
<g id="edge2638" class="edge">
<title>layer_13_expert_7_ep_2&#45;&gt;layer_13_agg_ep_2</title>
<path fill="none" stroke="black" d="M519822.44,-454.98C519805.09,-451.99 519787.79,-449.28 519771,-447 519363.89,-391.83 518885.79,-371.18 518604.51,-363.5"/>
<polygon fill="black" stroke="black" points="518604.26,-359.99 518594.17,-363.22 518604.07,-366.99 518604.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_3 -->
<g id="node1434" class="node">
<title>layer_13_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="523150.07,-410 522699.77,-410 522583.93,-306 523034.23,-306 523150.07,-410"/>
<text text-anchor="middle" x="522867" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="522867" y="-361" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="522867" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="522867" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2640" class="edge">
<title>layer_13_expert_0_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M520787.39,-465.2C520823.11,-458.05 520860.64,-451.47 520896,-447 521226.72,-405.18 522193.93,-376.08 522638.58,-364.54"/>
<polygon fill="black" stroke="black" points="522638.76,-368.03 522648.66,-364.27 522638.58,-361.03 522638.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2641" class="edge">
<title>layer_13_expert_1_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M521350.82,-465.62C521386.43,-458.45 521423.8,-451.77 521459,-447 521871.65,-391.08 522357.25,-370.62 522636.87,-363.19"/>
<polygon fill="black" stroke="black" points="522637.24,-366.68 522647.14,-362.92 522637.05,-359.68 522637.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2642" class="edge">
<title>layer_13_expert_2_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M521914.74,-466.6C521950.11,-459.4 521987.16,-452.46 522022,-447 522234.34,-413.74 522478.74,-389.83 522649.9,-375.41"/>
<polygon fill="black" stroke="black" points="522650.36,-378.88 522660.04,-374.55 522649.78,-371.9 522650.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2643" class="edge">
<title>layer_13_expert_3_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M522472.92,-461.9C522539.29,-444.56 522615.66,-424.62 522683.4,-406.94"/>
<polygon fill="black" stroke="black" points="522684.53,-410.26 522693.33,-404.35 522682.77,-403.49 522684.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2644" class="edge">
<title>layer_13_expert_4_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M522867,-455C522867,-443.95 522867,-432.15 522867,-420.75"/>
<polygon fill="black" stroke="black" points="522870.5,-420.41 522867,-410.41 522863.5,-420.41 522870.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2645" class="edge">
<title>layer_13_expert_5_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M523234.67,-455C523182.2,-441.3 523125.31,-426.44 523072.31,-412.61"/>
<polygon fill="black" stroke="black" points="523073.02,-409.18 523062.46,-410.04 523071.25,-415.95 523073.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2646" class="edge">
<title>layer_13_expert_6_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M523759.13,-455C523743.21,-452.11 523727.39,-449.41 523712,-447 523515.91,-416.29 523292.48,-393.55 523124.64,-378.88"/>
<polygon fill="black" stroke="black" points="523124.94,-375.4 523114.68,-378.02 523124.34,-382.37 523124.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_3&#45;&gt;layer_13_agg_ep_3 -->
<g id="edge2647" class="edge">
<title>layer_13_expert_7_ep_3&#45;&gt;layer_13_agg_ep_3</title>
<path fill="none" stroke="black" d="M524326.44,-454.98C524309.09,-451.99 524291.79,-449.28 524275,-447 523867.89,-391.83 523389.79,-371.18 523108.51,-363.5"/>
<polygon fill="black" stroke="black" points="523108.26,-359.99 523098.17,-363.22 523108.07,-366.99 523108.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_4 -->
<g id="node1435" class="node">
<title>layer_13_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="527654.07,-410 527203.77,-410 527087.93,-306 527538.23,-306 527654.07,-410"/>
<text text-anchor="middle" x="527371" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="527371" y="-361" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="527371" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="527371" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2649" class="edge">
<title>layer_13_expert_0_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M525291.39,-465.2C525327.11,-458.05 525364.64,-451.47 525400,-447 525730.72,-405.18 526697.93,-376.08 527142.58,-364.54"/>
<polygon fill="black" stroke="black" points="527142.76,-368.03 527152.66,-364.27 527142.58,-361.03 527142.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2650" class="edge">
<title>layer_13_expert_1_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M525854.82,-465.62C525890.43,-458.45 525927.8,-451.77 525963,-447 526375.65,-391.08 526861.25,-370.62 527140.87,-363.19"/>
<polygon fill="black" stroke="black" points="527141.24,-366.68 527151.14,-362.92 527141.05,-359.68 527141.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2651" class="edge">
<title>layer_13_expert_2_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M526418.74,-466.6C526454.11,-459.4 526491.16,-452.46 526526,-447 526738.34,-413.74 526982.74,-389.83 527153.9,-375.41"/>
<polygon fill="black" stroke="black" points="527154.36,-378.88 527164.04,-374.55 527153.78,-371.9 527154.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2652" class="edge">
<title>layer_13_expert_3_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M526976.92,-461.9C527043.29,-444.56 527119.66,-424.62 527187.4,-406.94"/>
<polygon fill="black" stroke="black" points="527188.53,-410.26 527197.33,-404.35 527186.77,-403.49 527188.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2653" class="edge">
<title>layer_13_expert_4_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M527371,-455C527371,-443.95 527371,-432.15 527371,-420.75"/>
<polygon fill="black" stroke="black" points="527374.5,-420.41 527371,-410.41 527367.5,-420.41 527374.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2654" class="edge">
<title>layer_13_expert_5_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M527738.67,-455C527686.2,-441.3 527629.31,-426.44 527576.31,-412.61"/>
<polygon fill="black" stroke="black" points="527577.02,-409.18 527566.46,-410.04 527575.25,-415.95 527577.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2655" class="edge">
<title>layer_13_expert_6_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M528263.13,-455C528247.21,-452.11 528231.39,-449.41 528216,-447 528019.91,-416.29 527796.48,-393.55 527628.64,-378.88"/>
<polygon fill="black" stroke="black" points="527628.94,-375.4 527618.68,-378.02 527628.34,-382.37 527628.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_4&#45;&gt;layer_13_agg_ep_4 -->
<g id="edge2656" class="edge">
<title>layer_13_expert_7_ep_4&#45;&gt;layer_13_agg_ep_4</title>
<path fill="none" stroke="black" d="M528830.44,-454.98C528813.09,-451.99 528795.79,-449.28 528779,-447 528371.89,-391.83 527893.79,-371.18 527612.51,-363.5"/>
<polygon fill="black" stroke="black" points="527612.26,-359.99 527602.17,-363.22 527612.07,-366.99 527612.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_5 -->
<g id="node1436" class="node">
<title>layer_13_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="532158.07,-410 531707.77,-410 531591.93,-306 532042.23,-306 532158.07,-410"/>
<text text-anchor="middle" x="531875" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="531875" y="-361" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="531875" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="531875" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2658" class="edge">
<title>layer_13_expert_0_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M529795.39,-465.2C529831.11,-458.05 529868.64,-451.47 529904,-447 530234.72,-405.18 531201.93,-376.08 531646.58,-364.54"/>
<polygon fill="black" stroke="black" points="531646.76,-368.03 531656.66,-364.27 531646.58,-361.03 531646.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2659" class="edge">
<title>layer_13_expert_1_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M530358.82,-465.62C530394.43,-458.45 530431.8,-451.77 530467,-447 530879.65,-391.08 531365.25,-370.62 531644.87,-363.19"/>
<polygon fill="black" stroke="black" points="531645.24,-366.68 531655.14,-362.92 531645.05,-359.68 531645.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2660" class="edge">
<title>layer_13_expert_2_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M530922.74,-466.6C530958.11,-459.4 530995.16,-452.46 531030,-447 531242.34,-413.74 531486.74,-389.83 531657.9,-375.41"/>
<polygon fill="black" stroke="black" points="531658.36,-378.88 531668.04,-374.55 531657.78,-371.9 531658.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2661" class="edge">
<title>layer_13_expert_3_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M531480.92,-461.9C531547.29,-444.56 531623.66,-424.62 531691.4,-406.94"/>
<polygon fill="black" stroke="black" points="531692.53,-410.26 531701.33,-404.35 531690.77,-403.49 531692.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2662" class="edge">
<title>layer_13_expert_4_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M531875,-455C531875,-443.95 531875,-432.15 531875,-420.75"/>
<polygon fill="black" stroke="black" points="531878.5,-420.41 531875,-410.41 531871.5,-420.41 531878.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2663" class="edge">
<title>layer_13_expert_5_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M532242.67,-455C532190.2,-441.3 532133.31,-426.44 532080.31,-412.61"/>
<polygon fill="black" stroke="black" points="532081.02,-409.18 532070.46,-410.04 532079.25,-415.95 532081.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2664" class="edge">
<title>layer_13_expert_6_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M532767.13,-455C532751.21,-452.11 532735.39,-449.41 532720,-447 532523.91,-416.29 532300.48,-393.55 532132.64,-378.88"/>
<polygon fill="black" stroke="black" points="532132.94,-375.4 532122.68,-378.02 532132.34,-382.37 532132.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_5&#45;&gt;layer_13_agg_ep_5 -->
<g id="edge2665" class="edge">
<title>layer_13_expert_7_ep_5&#45;&gt;layer_13_agg_ep_5</title>
<path fill="none" stroke="black" d="M533334.44,-454.98C533317.09,-451.99 533299.79,-449.28 533283,-447 532875.89,-391.83 532397.79,-371.18 532116.51,-363.5"/>
<polygon fill="black" stroke="black" points="532116.26,-359.99 532106.17,-363.22 532116.07,-366.99 532116.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_6 -->
<g id="node1437" class="node">
<title>layer_13_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="536662.07,-410 536211.77,-410 536095.93,-306 536546.23,-306 536662.07,-410"/>
<text text-anchor="middle" x="536379" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="536379" y="-361" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="536379" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="536379" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2667" class="edge">
<title>layer_13_expert_0_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M534299.39,-465.2C534335.11,-458.05 534372.64,-451.47 534408,-447 534738.72,-405.18 535705.93,-376.08 536150.58,-364.54"/>
<polygon fill="black" stroke="black" points="536150.76,-368.03 536160.66,-364.27 536150.58,-361.03 536150.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2668" class="edge">
<title>layer_13_expert_1_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M534862.82,-465.62C534898.43,-458.45 534935.8,-451.77 534971,-447 535383.65,-391.08 535869.25,-370.62 536148.87,-363.19"/>
<polygon fill="black" stroke="black" points="536149.24,-366.68 536159.14,-362.92 536149.05,-359.68 536149.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2669" class="edge">
<title>layer_13_expert_2_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M535426.74,-466.6C535462.11,-459.4 535499.16,-452.46 535534,-447 535746.34,-413.74 535990.74,-389.83 536161.9,-375.41"/>
<polygon fill="black" stroke="black" points="536162.36,-378.88 536172.04,-374.55 536161.78,-371.9 536162.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2670" class="edge">
<title>layer_13_expert_3_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M535984.92,-461.9C536051.29,-444.56 536127.66,-424.62 536195.4,-406.94"/>
<polygon fill="black" stroke="black" points="536196.53,-410.26 536205.33,-404.35 536194.77,-403.49 536196.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2671" class="edge">
<title>layer_13_expert_4_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M536379,-455C536379,-443.95 536379,-432.15 536379,-420.75"/>
<polygon fill="black" stroke="black" points="536382.5,-420.41 536379,-410.41 536375.5,-420.41 536382.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2672" class="edge">
<title>layer_13_expert_5_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M536746.67,-455C536694.2,-441.3 536637.31,-426.44 536584.31,-412.61"/>
<polygon fill="black" stroke="black" points="536585.02,-409.18 536574.46,-410.04 536583.25,-415.95 536585.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2673" class="edge">
<title>layer_13_expert_6_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M537271.13,-455C537255.21,-452.11 537239.39,-449.41 537224,-447 537027.91,-416.29 536804.48,-393.55 536636.64,-378.88"/>
<polygon fill="black" stroke="black" points="536636.94,-375.4 536626.68,-378.02 536636.34,-382.37 536636.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_6&#45;&gt;layer_13_agg_ep_6 -->
<g id="edge2674" class="edge">
<title>layer_13_expert_7_ep_6&#45;&gt;layer_13_agg_ep_6</title>
<path fill="none" stroke="black" d="M537838.44,-454.98C537821.09,-451.99 537803.79,-449.28 537787,-447 537379.89,-391.83 536901.79,-371.18 536620.51,-363.5"/>
<polygon fill="black" stroke="black" points="536620.26,-359.99 536610.17,-363.22 536620.07,-366.99 536620.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_7 -->
<g id="node1438" class="node">
<title>layer_13_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="541166.07,-410 540715.77,-410 540599.93,-306 541050.23,-306 541166.07,-410"/>
<text text-anchor="middle" x="540883" y="-372" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="540883" y="-361" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="540883" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="540883" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_expert_0_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2676" class="edge">
<title>layer_13_expert_0_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M538803.39,-465.2C538839.11,-458.05 538876.64,-451.47 538912,-447 539242.72,-405.18 540209.93,-376.08 540654.58,-364.54"/>
<polygon fill="black" stroke="black" points="540654.76,-368.03 540664.66,-364.27 540654.58,-361.03 540654.76,-368.03"/>
</g>
<!-- layer_13_expert_1_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2677" class="edge">
<title>layer_13_expert_1_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M539366.82,-465.62C539402.43,-458.45 539439.8,-451.77 539475,-447 539887.65,-391.08 540373.25,-370.62 540652.87,-363.19"/>
<polygon fill="black" stroke="black" points="540653.24,-366.68 540663.14,-362.92 540653.05,-359.68 540653.24,-366.68"/>
</g>
<!-- layer_13_expert_2_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2678" class="edge">
<title>layer_13_expert_2_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M539930.74,-466.6C539966.11,-459.4 540003.16,-452.46 540038,-447 540250.34,-413.74 540494.74,-389.83 540665.9,-375.41"/>
<polygon fill="black" stroke="black" points="540666.36,-378.88 540676.04,-374.55 540665.78,-371.9 540666.36,-378.88"/>
</g>
<!-- layer_13_expert_3_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2679" class="edge">
<title>layer_13_expert_3_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M540488.92,-461.9C540555.29,-444.56 540631.66,-424.62 540699.4,-406.94"/>
<polygon fill="black" stroke="black" points="540700.53,-410.26 540709.33,-404.35 540698.77,-403.49 540700.53,-410.26"/>
</g>
<!-- layer_13_expert_4_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2680" class="edge">
<title>layer_13_expert_4_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M540883,-455C540883,-443.95 540883,-432.15 540883,-420.75"/>
<polygon fill="black" stroke="black" points="540886.5,-420.41 540883,-410.41 540879.5,-420.41 540886.5,-420.41"/>
</g>
<!-- layer_13_expert_5_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2681" class="edge">
<title>layer_13_expert_5_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M541250.67,-455C541198.2,-441.3 541141.31,-426.44 541088.31,-412.61"/>
<polygon fill="black" stroke="black" points="541089.02,-409.18 541078.46,-410.04 541087.25,-415.95 541089.02,-409.18"/>
</g>
<!-- layer_13_expert_6_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2682" class="edge">
<title>layer_13_expert_6_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M541775.13,-455C541759.21,-452.11 541743.39,-449.41 541728,-447 541531.91,-416.29 541308.48,-393.55 541140.64,-378.88"/>
<polygon fill="black" stroke="black" points="541140.94,-375.4 541130.68,-378.02 541140.34,-382.37 541140.94,-375.4"/>
</g>
<!-- layer_13_expert_7_ep_7&#45;&gt;layer_13_agg_ep_7 -->
<g id="edge2683" class="edge">
<title>layer_13_expert_7_ep_7&#45;&gt;layer_13_agg_ep_7</title>
<path fill="none" stroke="black" d="M542342.44,-454.98C542325.09,-451.99 542307.79,-449.28 542291,-447 541883.89,-391.83 541405.79,-371.18 541124.51,-363.5"/>
<polygon fill="black" stroke="black" points="541124.26,-359.99 541114.17,-363.22 541124.07,-366.99 541124.26,-359.99"/>
</g>
<!-- layer_13_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2621" class="edge">
<title>layer_13_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M509574.79,-352.97C510199.51,-341.74 512039.04,-310.06 513567,-298 516313.14,-276.32 516999.78,-291.04 519746,-287 545230.2,-249.49 576876.62,-219.99 578924.2,-218.1"/>
<polygon fill="black" stroke="black" points="578924.46,-221.6 578934.46,-218.09 578924.45,-214.6 578924.46,-221.6"/>
</g>
<!-- layer_13_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2630" class="edge">
<title>layer_13_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M514078.79,-352.97C514703.51,-341.74 516543.04,-310.06 518071,-298 520819.81,-276.3 521507.11,-291.18 524256,-287 547768.89,-251.28 576959.44,-220.19 578924.16,-218.11"/>
<polygon fill="black" stroke="black" points="578924.36,-221.61 578934.36,-218.1 578924.35,-214.61 578924.36,-221.61"/>
</g>
<!-- layer_13_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2639" class="edge">
<title>layer_13_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M518582.79,-352.97C519207.51,-341.73 521047.04,-310.06 522575,-298 525332.25,-276.25 526021.67,-291.34 528779,-287 550317.65,-253.12 577049.37,-220.41 578924.47,-218.13"/>
<polygon fill="black" stroke="black" points="578924.54,-221.63 578934.54,-218.11 578924.54,-214.63 578924.54,-221.63"/>
</g>
<!-- layer_13_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2648" class="edge">
<title>layer_13_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M523086.79,-352.97C523711.51,-341.73 525551.04,-310.04 527079,-298 529867.36,-276.03 530564.55,-291.55 533353,-287 552894.08,-255.11 577137.69,-220.68 578924.08,-218.15"/>
<polygon fill="black" stroke="black" points="578924.31,-221.65 578934.3,-218.13 578924.3,-214.65 578924.31,-221.65"/>
</g>
<!-- layer_13_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2657" class="edge">
<title>layer_13_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M527590.79,-352.98C528215.51,-341.74 530055.04,-310.08 531583,-298 534295.36,-276.56 534973.56,-291.71 537686,-287 555338.72,-256.36 577231.23,-220.91 578924.3,-218.17"/>
<polygon fill="black" stroke="black" points="578924.61,-221.67 578934.6,-218.15 578924.6,-214.67 578924.61,-221.67"/>
</g>
<!-- layer_13_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2666" class="edge">
<title>layer_13_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M532094.79,-352.98C532719.51,-341.76 534559.04,-310.12 536087,-298 545317.71,-224.75 576872.66,-218.36 578924.1,-218.02"/>
<polygon fill="black" stroke="black" points="578924.38,-221.52 578934.38,-218.01 578924.38,-214.52 578924.38,-221.52"/>
</g>
<!-- layer_13_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2675" class="edge">
<title>layer_13_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M536598.79,-353C537223.51,-341.82 539063.04,-310.29 540591,-298 541108.48,-293.84 576740.25,-222.57 578924.31,-218.21"/>
<polygon fill="black" stroke="black" points="578924.48,-221.71 578934.47,-218.19 578924.47,-214.71 578924.48,-221.71"/>
</g>
<!-- layer_13_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2684" class="edge">
<title>layer_13_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M541106.42,-356.19C544129.05,-345.17 576838.79,-225.98 578924.71,-218.38"/>
<polygon fill="black" stroke="black" points="578924.8,-221.88 578934.79,-218.34 578924.78,-214.88 578924.8,-221.88"/>
</g>
<!-- layer_13_moe_alltoall -->
<g id="node1439" class="node">
<title>layer_13_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="531782" cy="-847" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="531782" y="-861" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="531782" y="-850" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="531782" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="531782" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_13_ln_tp_0 -->
<g id="node1440" class="node">
<title>layer_13_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="538393.07,-899 537942.77,-899 537826.93,-795 538277.23,-795 538393.07,-899"/>
<text text-anchor="middle" x="538110" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="538110" y="-850" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="538110" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="538110" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_qkv_tp_0 -->
<g id="node1444" class="node">
<title>layer_14_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="469044.7,-729 468602.94,-729 468489.3,-625 468931.06,-625 469044.7,-729"/>
<text text-anchor="middle" x="468767" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="468767" y="-680" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="468767" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="468767" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_13_ln_tp_0&#45;&gt;layer_14_qkv_tp_0 -->
<g id="edge3129" class="edge">
<title>layer_13_ln_tp_0&#45;&gt;layer_14_qkv_tp_0</title>
<path fill="none" stroke="black" d="M537827.66,-795.88C537824.43,-795.57 537821.2,-795.28 537818,-795 537600.65,-776.13 475205.16,-777.34 474987,-777 474657.39,-776.48 469380.36,-806.19 469054,-760 469011.84,-754.03 468967.18,-743.45 468925.97,-731.83"/>
<polygon fill="black" stroke="black" points="468926.7,-728.4 468916.13,-729.02 468924.78,-735.13 468926.7,-728.4"/>
</g>
<!-- layer_13_ln_tp_1 -->
<g id="node1441" class="node">
<title>layer_13_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="538977.07,-899 538526.77,-899 538410.93,-795 538861.23,-795 538977.07,-899"/>
<text text-anchor="middle" x="538694" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="538694" y="-850" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="538694" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="538694" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_qkv_tp_1 -->
<g id="node1445" class="node">
<title>layer_14_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="469618.7,-729 469176.94,-729 469063.3,-625 469505.06,-625 469618.7,-729"/>
<text text-anchor="middle" x="469341" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="469341" y="-680" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="469341" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="469341" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_13_ln_tp_1&#45;&gt;layer_14_qkv_tp_1 -->
<g id="edge3130" class="edge">
<title>layer_13_ln_tp_1&#45;&gt;layer_14_qkv_tp_1</title>
<path fill="none" stroke="black" d="M538411.66,-795.88C538408.43,-795.57 538405.2,-795.28 538402,-795 538202.21,-777.65 480846.54,-777.19 480646,-777 480607.74,-776.96 469665.88,-765.34 469628,-760 469585.84,-754.06 469541.18,-743.49 469499.96,-731.87"/>
<polygon fill="black" stroke="black" points="469500.7,-728.44 469490.12,-729.05 469498.77,-735.17 469500.7,-728.44"/>
</g>
<!-- layer_13_ln_tp_2 -->
<g id="node1442" class="node">
<title>layer_13_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="539561.07,-899 539110.77,-899 538994.93,-795 539445.23,-795 539561.07,-899"/>
<text text-anchor="middle" x="539278" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="539278" y="-850" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="539278" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="539278" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_qkv_tp_2 -->
<g id="node1446" class="node">
<title>layer_14_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="470192.7,-729 469750.94,-729 469637.3,-625 470079.06,-625 470192.7,-729"/>
<text text-anchor="middle" x="469915" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="469915" y="-680" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="469915" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="469915" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_13_ln_tp_2&#45;&gt;layer_14_qkv_tp_2 -->
<g id="edge3131" class="edge">
<title>layer_13_ln_tp_2&#45;&gt;layer_14_qkv_tp_2</title>
<path fill="none" stroke="black" d="M538995.66,-795.88C538992.43,-795.57 538989.2,-795.28 538986,-795 538821.36,-780.7 491555.26,-777.1 491390,-777 491353.22,-776.98 470238.43,-765.12 470202,-760 470159.84,-754.08 470115.17,-743.51 470073.96,-731.89"/>
<polygon fill="black" stroke="black" points="470074.7,-728.46 470064.12,-729.08 470072.77,-735.19 470074.7,-728.46"/>
</g>
<!-- layer_13_ln_tp_3 -->
<g id="node1443" class="node">
<title>layer_13_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="540145.07,-899 539694.77,-899 539578.93,-795 540029.23,-795 540145.07,-899"/>
<text text-anchor="middle" x="539862" y="-861" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="539862" y="-850" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="539862" y="-839" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="539862" y="-828" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_qkv_tp_3 -->
<g id="node1447" class="node">
<title>layer_14_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="470766.7,-729 470324.94,-729 470211.3,-625 470653.06,-625 470766.7,-729"/>
<text text-anchor="middle" x="470489" y="-691" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="470489" y="-680" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="470489" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="470489" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_13_ln_tp_3&#45;&gt;layer_14_qkv_tp_3 -->
<g id="edge3132" class="edge">
<title>layer_13_ln_tp_3&#45;&gt;layer_14_qkv_tp_3</title>
<path fill="none" stroke="black" d="M539579.66,-795.89C539576.43,-795.57 539573.2,-795.28 539570,-795 539398.79,-780.1 514993.86,-777.25 514822,-777 496237.78,-750.51 473271.51,-685.92 470722.05,-678.67"/>
<polygon fill="black" stroke="black" points="470721.88,-675.17 470711.87,-678.64 470721.86,-682.17 470721.88,-675.17"/>
</g>
<!-- layer_14_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2693" class="edge">
<title>layer_14_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M468946.63,-639.09C468982.07,-633.23 469019.09,-628.08 469054,-625 469149.47,-616.58 579369.86,-629.59 579463,-607 579533.56,-589.89 579531.01,-510.61 579496,-447 579488.39,-433.17 579481.16,-432.4 579466,-428 579466,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_14_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2694" class="edge">
<title>layer_14_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M469520.63,-639.09C469556.07,-633.23 469593.09,-628.08 469628,-625 469723,-616.62 579395.32,-629.48 579488,-607 579558.56,-589.89 579556.01,-510.61 579521,-447 579513.39,-433.17 579506.16,-432.4 579491,-428 579491,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_14_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2695" class="edge">
<title>layer_14_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M470094.63,-639.09C470130.07,-633.23 470167.09,-628.08 470202,-625 470296.52,-616.66 579420.79,-629.36 579513,-607 579583.56,-589.89 579581.01,-510.61 579546,-447 579538.39,-433.17 579531.16,-432.4 579516,-428 579516,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_14_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2696" class="edge">
<title>layer_14_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M470708.62,-675.59C472935.25,-671.5 491656.27,-637.52 506818,-625 506881.12,-624.95 579476.65,-621.88 579538,-607 579608.56,-589.88 579606.01,-510.61 579571,-447 579563.39,-433.17 579556.16,-432.4 579541,-428 579541,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.79 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_14_qkv_comm -->
<g id="node1448" class="node">
<title>layer_14_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="468278" cy="-677" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="468278" y="-691" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="468278" y="-680" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="468278" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="468278" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_14_attn_tp_0 -->
<g id="node1449" class="node">
<title>layer_14_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="435307.7,-729 434865.94,-729 434752.3,-625 435194.06,-625 435307.7,-729"/>
<text text-anchor="middle" x="435030" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="435030" y="-680" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="435030" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="435030" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_out_tp_0 -->
<g id="node1453" class="node">
<title>layer_14_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="435307.7,-559 434865.94,-559 434752.3,-455 435194.06,-455 435307.7,-559"/>
<text text-anchor="middle" x="435030" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="435030" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="435030" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="435030" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_tp_0&#45;&gt;layer_14_attn_out_tp_0 -->
<g id="edge2701" class="edge">
<title>layer_14_attn_tp_0&#45;&gt;layer_14_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M435030,-624.68C435030,-607.18 435030,-587.43 435030,-569.22"/>
<polygon fill="black" stroke="black" points="435033.5,-569 435030,-559 435026.5,-569 435033.5,-569"/>
</g>
<!-- layer_14_attn_tp_1 -->
<g id="node1450" class="node">
<title>layer_14_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="435881.7,-729 435439.94,-729 435326.3,-625 435768.06,-625 435881.7,-729"/>
<text text-anchor="middle" x="435604" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="435604" y="-680" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="435604" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="435604" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_out_tp_1 -->
<g id="node1454" class="node">
<title>layer_14_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="435881.7,-559 435439.94,-559 435326.3,-455 435768.06,-455 435881.7,-559"/>
<text text-anchor="middle" x="435604" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="435604" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="435604" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="435604" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_tp_1&#45;&gt;layer_14_attn_out_tp_1 -->
<g id="edge2703" class="edge">
<title>layer_14_attn_tp_1&#45;&gt;layer_14_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M435604,-624.68C435604,-607.18 435604,-587.43 435604,-569.22"/>
<polygon fill="black" stroke="black" points="435607.5,-569 435604,-559 435600.5,-569 435607.5,-569"/>
</g>
<!-- layer_14_attn_tp_2 -->
<g id="node1451" class="node">
<title>layer_14_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="436455.7,-729 436013.94,-729 435900.3,-625 436342.06,-625 436455.7,-729"/>
<text text-anchor="middle" x="436178" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="436178" y="-680" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="436178" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="436178" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_out_tp_2 -->
<g id="node1455" class="node">
<title>layer_14_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="436455.7,-559 436013.94,-559 435900.3,-455 436342.06,-455 436455.7,-559"/>
<text text-anchor="middle" x="436178" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="436178" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="436178" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="436178" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_tp_2&#45;&gt;layer_14_attn_out_tp_2 -->
<g id="edge2705" class="edge">
<title>layer_14_attn_tp_2&#45;&gt;layer_14_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M436178,-624.68C436178,-607.18 436178,-587.43 436178,-569.22"/>
<polygon fill="black" stroke="black" points="436181.5,-569 436178,-559 436174.5,-569 436181.5,-569"/>
</g>
<!-- layer_14_attn_tp_3 -->
<g id="node1452" class="node">
<title>layer_14_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="437029.7,-729 436587.94,-729 436474.3,-625 436916.06,-625 437029.7,-729"/>
<text text-anchor="middle" x="436752" y="-691" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="436752" y="-680" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="436752" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="436752" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_out_tp_3 -->
<g id="node1456" class="node">
<title>layer_14_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="437029.7,-559 436587.94,-559 436474.3,-455 436916.06,-455 437029.7,-559"/>
<text text-anchor="middle" x="436752" y="-521" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="436752" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="436752" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="436752" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_14_attn_tp_3&#45;&gt;layer_14_attn_out_tp_3 -->
<g id="edge2707" class="edge">
<title>layer_14_attn_tp_3&#45;&gt;layer_14_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M436752,-624.68C436752,-607.18 436752,-587.43 436752,-569.22"/>
<polygon fill="black" stroke="black" points="436755.5,-569 436752,-559 436748.5,-569 436755.5,-569"/>
</g>
<!-- layer_14_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2702" class="edge">
<title>layer_14_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M434866.43,-559C434818.16,-571.76 434764.89,-583.61 434715,-590 434715,-590 145376,-598 145376,-598 145363.09,-600.02 145360.67,-603.78 145348,-607 145306.35,-617.6 145294.47,-613.75 145253,-625 145222.3,-633.33 145188.77,-645.14 145161.89,-655.3"/>
<polygon fill="black" stroke="black" points="145160.41,-652.12 145152.31,-658.95 145162.9,-658.66 145160.41,-652.12"/>
</g>
<!-- layer_14_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2704" class="edge">
<title>layer_14_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M435454.89,-559.1C435411.01,-571.81 435362.55,-583.62 435317,-590 435317,-590 145401,-598 145401,-598 145388.09,-600.02 145385.73,-604.02 145373,-607 145320.49,-619.29 145305.31,-611.88 145253,-625 145221.81,-632.82 145187.86,-644.78 145160.88,-655.14"/>
<polygon fill="black" stroke="black" points="145159.32,-651.99 145151.27,-658.88 145161.86,-658.52 145159.32,-651.99"/>
</g>
<!-- layer_14_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2706" class="edge">
<title>layer_14_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M436028.89,-559.1C435985.01,-571.81 435936.55,-583.62 435891,-590 435891,-590 145426,-598 145426,-598 145413.09,-600.02 145410.76,-604.18 145398,-607 145334.59,-621 145316.18,-610 145253,-625 145221.37,-632.51 145187.02,-644.62 145159.91,-655.16"/>
<polygon fill="black" stroke="black" points="145158.29,-652.04 145150.27,-658.96 145160.86,-658.55 145158.29,-652.04"/>
</g>
<!-- layer_14_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2708" class="edge">
<title>layer_14_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M436602.89,-559.1C436559.01,-571.81 436510.55,-583.62 436465,-590 436465,-590 145451,-598 145451,-598 145438.09,-600.02 145435.79,-604.3 145423,-607 145348.66,-622.71 145327.08,-608.12 145253,-625 145221.19,-632.25 145186.7,-644.41 145159.57,-655.04"/>
<polygon fill="black" stroke="black" points="145157.92,-651.93 145149.92,-658.88 145160.51,-658.44 145157.92,-651.93"/>
</g>
<!-- layer_14_attn_allreduce -->
<g id="node1457" class="node">
<title>layer_14_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="458851" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="458851" y="-691" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="458851" y="-680" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="458851" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="458851" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_gate_tp_0 -->
<g id="node1458" class="node">
<title>layer_14_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="449973.99,-729 449525.4,-729 449410.01,-625 449858.6,-625 449973.99,-729"/>
<text text-anchor="middle" x="449692" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="449692" y="-680" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="449692" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="449692" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_14_route_ep_0 -->
<g id="node1462" class="node">
<title>layer_14_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="458678.43,-559 458219.6,-559 458101.57,-455 458560.4,-455 458678.43,-559"/>
<text text-anchor="middle" x="458390" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="458390" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="458390" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="458390" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_0 -->
<g id="edge2709" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449875,-639.72C449910.69,-633.84 449947.91,-628.53 449983,-625 450277.62,-595.36 450353.51,-626.08 450649,-607 450688.23,-604.47 450697.74,-600.05 450737,-598 450924.3,-588.22 453925.45,-592.02 454113,-590 455657.22,-573.37 457514.66,-529.65 458157.65,-513.83"/>
<polygon fill="black" stroke="black" points="458158.05,-517.32 458167.96,-513.57 458157.88,-510.32 458158.05,-517.32"/>
<text text-anchor="middle" x="450763" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_1 -->
<g id="node1463" class="node">
<title>layer_14_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="450726.43,-559 450267.6,-559 450149.57,-455 450608.4,-455 450726.43,-559"/>
<text text-anchor="middle" x="450438" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="450438" y="-510" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="450438" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="450438" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_1 -->
<g id="edge2710" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449721.3,-624.97C449729.6,-614.5 449739.55,-604.66 449751,-598 449827.27,-553.64 450041.74,-530.57 450210.96,-518.95"/>
<polygon fill="black" stroke="black" points="450211.28,-522.44 450221.02,-518.27 450210.8,-515.45 450211.28,-522.44"/>
<text text-anchor="middle" x="449777" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_2 -->
<g id="node1464" class="node">
<title>layer_14_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="467686.43,-559 467227.6,-559 467109.57,-455 467568.4,-455 467686.43,-559"/>
<text text-anchor="middle" x="467398" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="467398" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="467398" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="467398" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_2 -->
<g id="edge2711" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449874.54,-639.1C449910.36,-633.25 449947.75,-628.11 449983,-625 450176.5,-607.92 456781.75,-607.52 456976,-607 457019.16,-606.89 463147.84,-590.48 463191,-590 464707,-573.15 466529.89,-529.73 467165.75,-513.89"/>
<polygon fill="black" stroke="black" points="467166.04,-517.39 467175.95,-513.64 467165.87,-510.39 467166.04,-517.39"/>
<text text-anchor="middle" x="460294" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_3 -->
<g id="node1465" class="node">
<title>layer_14_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="438340.43,-559 437881.6,-559 437763.57,-455 438222.4,-455 438340.43,-559"/>
<text text-anchor="middle" x="438052" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="438052" y="-510" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="438052" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="438052" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_3 -->
<g id="edge2712" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449464.2,-674.01C448556.25,-665.96 445107.24,-634.04 442269,-590 440760.64,-566.6 438949.01,-527.76 438299.03,-513.48"/>
<polygon fill="black" stroke="black" points="438298.68,-509.97 438288.61,-513.25 438298.53,-516.97 438298.68,-509.97"/>
<text text-anchor="middle" x="443304" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_4 -->
<g id="node1466" class="node">
<title>layer_14_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="447438.43,-559 446979.6,-559 446861.57,-455 447320.4,-455 447438.43,-559"/>
<text text-anchor="middle" x="447150" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="447150" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="447150" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="447150" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_4 -->
<g id="edge2713" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449453.43,-664.24C449202.94,-651.54 448797.66,-630.03 448448,-607 448089.95,-583.42 447676.75,-551.01 447414.54,-529.79"/>
<polygon fill="black" stroke="black" points="447414.75,-526.3 447404.5,-528.98 447414.18,-533.27 447414.75,-526.3"/>
<text text-anchor="middle" x="448474" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_5 -->
<g id="node1467" class="node">
<title>layer_14_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="463182.43,-559 462723.6,-559 462605.57,-455 463064.4,-455 463182.43,-559"/>
<text text-anchor="middle" x="462894" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="462894" y="-510" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="462894" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="462894" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_5 -->
<g id="edge2714" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449874.55,-639.19C449910.36,-633.33 449947.75,-628.17 449983,-625 450047.53,-619.2 454583.21,-598.25 454648,-598 455545.55,-594.51 457789.49,-599.63 458687,-590 460203,-573.73 462025.89,-529.95 462661.75,-513.95"/>
<polygon fill="black" stroke="black" points="462662.04,-517.45 462671.95,-513.7 462661.87,-510.45 462662.04,-517.45"/>
<text text-anchor="middle" x="454674" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_6 -->
<g id="node1468" class="node">
<title>layer_14_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="454104.43,-559 453645.6,-559 453527.57,-455 453986.4,-455 454104.43,-559"/>
<text text-anchor="middle" x="453816" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="453816" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="453816" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="453816" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_6 -->
<g id="edge2715" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449876.75,-641.17C449911.95,-635.23 449948.55,-629.53 449983,-625 450050.9,-616.08 450221.61,-601.62 450290,-598 450487.53,-587.55 450537.24,-594.41 450735,-590 451800.18,-566.25 453072.28,-529.84 453585.02,-514.83"/>
<polygon fill="black" stroke="black" points="453585.23,-518.32 453595.12,-514.53 453585.02,-511.33 453585.23,-518.32"/>
<text text-anchor="middle" x="450316" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_route_ep_7 -->
<g id="node1469" class="node">
<title>layer_14_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="442854.43,-559 442395.6,-559 442277.57,-455 442736.4,-455 442854.43,-559"/>
<text text-anchor="middle" x="442566" y="-521" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="442566" y="-510" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="442566" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="442566" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_7 -->
<g id="edge2716" class="edge">
<title>layer_14_gate_tp_0&#45;&gt;layer_14_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449464.9,-674.73C448787.17,-670.51 446719.82,-654.38 445006,-607 444208.19,-584.94 443264.3,-541.79 442820.59,-520.5"/>
<polygon fill="black" stroke="black" points="442820.68,-517 442810.52,-520.01 442820.34,-523.99 442820.68,-517"/>
<text text-anchor="middle" x="445032" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1 -->
<g id="node1459" class="node">
<title>layer_14_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="451137.99,-729 450689.4,-729 450574.01,-625 451022.6,-625 451137.99,-729"/>
<text text-anchor="middle" x="450856" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="450856" y="-680" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="450856" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="450856" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_0 -->
<g id="edge2717" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451038.55,-639.15C451074.36,-633.3 451111.75,-628.14 451147,-625 451370.12,-605.09 454955.03,-610.95 455179,-607 456297.67,-587.26 457634.86,-537.67 458161.17,-517.13"/>
<polygon fill="black" stroke="black" points="458161.68,-520.61 458171.54,-516.72 458161.41,-513.62 458161.68,-520.61"/>
<text text-anchor="middle" x="455641" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_1 -->
<g id="edge2718" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450575.57,-626.42C450542.28,-619.08 450517.13,-612.24 450509,-607 450493.55,-597.04 450480.41,-582.44 450469.79,-567.49"/>
<polygon fill="black" stroke="black" points="450472.66,-565.48 450464.15,-559.17 450466.86,-569.41 450472.66,-565.48"/>
<text text-anchor="middle" x="450535" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_2 -->
<g id="edge2719" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451038.54,-639.07C451074.35,-633.22 451111.74,-628.09 451147,-625 451307.01,-610.96 462551.39,-608.82 462712,-607 464422.78,-587.6 466484.33,-533.29 467166.47,-514.5"/>
<polygon fill="black" stroke="black" points="467166.76,-517.99 467176.66,-514.21 467166.57,-510.99 467166.76,-517.99"/>
<text text-anchor="middle" x="463375" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_3 -->
<g id="edge2720" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450575.02,-625.94C450571.66,-625.61 450568.32,-625.3 450565,-625 450345.37,-605.4 446816.46,-611.13 446596,-607 446474.62,-604.72 446444.38,-600.12 446323,-598 445422.25,-582.27 443169.84,-599.65 442269,-590 440761.23,-573.85 438950.62,-530.63 438299.91,-514.33"/>
<polygon fill="black" stroke="black" points="438299.55,-510.82 438289.47,-514.07 438299.37,-517.82 438299.55,-510.82"/>
<text text-anchor="middle" x="446622" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_4 -->
<g id="edge2721" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450575,-626.08C450571.65,-625.7 450568.32,-625.34 450565,-625 450328.36,-600.4 450267.42,-622.34 450030,-607 449988.12,-604.29 449977.88,-600.68 449936,-598 448997.63,-537.98 447878.76,-517.22 447393.95,-510.7"/>
<polygon fill="black" stroke="black" points="447393.73,-507.2 447383.68,-510.57 447393.63,-514.2 447393.73,-507.2"/>
<text text-anchor="middle" x="450056" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_5 -->
<g id="edge2722" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451038.54,-639.07C451074.35,-633.23 451111.74,-628.1 451147,-625 451442.83,-599.02 461541.36,-621.12 461838,-607 461848.4,-606.5 462371.31,-557.28 462677.28,-528.44"/>
<polygon fill="black" stroke="black" points="462678,-531.89 462687.62,-527.47 462677.34,-524.92 462678,-531.89"/>
<text text-anchor="middle" x="461959" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_6 -->
<g id="edge2723" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451039.44,-640.13C451075,-634.23 451112.07,-628.81 451147,-625 452040.09,-527.58 453109.66,-510.6 453577.38,-508.11"/>
<polygon fill="black" stroke="black" points="453577.65,-511.6 453587.63,-508.05 453577.62,-504.6 453577.65,-511.6"/>
<text text-anchor="middle" x="451388" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_7 -->
<g id="edge2724" class="edge">
<title>layer_14_gate_tp_1&#45;&gt;layer_14_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450575.01,-625.99C450571.66,-625.65 450568.32,-625.32 450565,-625 450313.43,-601.11 449680.64,-612.3 449428,-607 449275.09,-603.79 449236.92,-600.27 449084,-598 448092.55,-583.25 447844.5,-601.26 446853,-590 445316.61,-572.55 443470.85,-529.93 442813.36,-514.08"/>
<polygon fill="black" stroke="black" points="442813.37,-510.58 442803.29,-513.83 442813.2,-517.57 442813.37,-510.58"/>
<text text-anchor="middle" x="449454" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2 -->
<g id="node1460" class="node">
<title>layer_14_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="451719.99,-729 451271.4,-729 451156.01,-625 451604.6,-625 451719.99,-729"/>
<text text-anchor="middle" x="451438" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="451438" y="-680" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="451438" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="451438" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_0 -->
<g id="edge2725" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451659.71,-674.51C452531.78,-668.41 455727.57,-643.99 456741,-607 457252.95,-588.31 457853.29,-547.5 458169.43,-524.54"/>
<polygon fill="black" stroke="black" points="458169.91,-528.02 458179.63,-523.8 458169.4,-521.04 458169.91,-528.02"/>
<text text-anchor="middle" x="456946" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_1 -->
<g id="edge2726" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451157,-626.07C451153.65,-625.7 451150.32,-625.34 451147,-625 451086.18,-618.71 450655.51,-624.77 450597,-607 450566.95,-597.87 450536.94,-581.54 450511.22,-564.74"/>
<polygon fill="black" stroke="black" points="450512.93,-561.68 450502.67,-559.04 450509.05,-567.5 450512.93,-561.68"/>
<text text-anchor="middle" x="450623" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_2 -->
<g id="edge2727" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451659.16,-674.1C452540.65,-666.61 455889.16,-638.81 458645,-625 460004.32,-618.19 463402.94,-634.51 464762,-607 465654.27,-588.94 466715.58,-541.01 467171.53,-519.15"/>
<polygon fill="black" stroke="black" points="467171.7,-522.64 467181.52,-518.67 467171.36,-515.65 467171.7,-522.64"/>
<text text-anchor="middle" x="465146" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_3 -->
<g id="edge2728" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451157.02,-625.95C451153.66,-625.62 451150.32,-625.3 451147,-625 451115.88,-622.2 446679.24,-598.12 446648,-598 445674.89,-594.19 443242.06,-600.35 442269,-590 440761.23,-573.96 438950.62,-530.67 438299.91,-514.35"/>
<polygon fill="black" stroke="black" points="438299.55,-510.84 438289.47,-514.08 438299.37,-517.83 438299.55,-510.84"/>
<text text-anchor="middle" x="448262" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_4 -->
<g id="edge2729" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451157.01,-626C451153.66,-625.65 451150.32,-625.32 451147,-625 450918.68,-603.14 450342.06,-639.43 450115,-607 450099.95,-604.85 450097.04,-600.25 450082,-598 449565.67,-520.77 447995.7,-509.52 447391,-508.1"/>
<polygon fill="black" stroke="black" points="447390.86,-504.6 447380.85,-508.08 447390.84,-511.6 447390.86,-504.6"/>
<text text-anchor="middle" x="450141" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_5 -->
<g id="edge2730" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451659.54,-674.3C452541.6,-667.54 455889.57,-642.16 458645,-625 459017,-622.68 461621.61,-628.34 461993,-607 462231.73,-593.28 462504.5,-560.97 462686.79,-536.97"/>
<polygon fill="black" stroke="black" points="462687.3,-540.43 462696.76,-535.65 462686.38,-533.49 462687.3,-540.43"/>
<text text-anchor="middle" x="462141" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_6 -->
<g id="edge2731" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451645.13,-661.37C452090.62,-629.89 453136.46,-556.01 453594.52,-523.65"/>
<polygon fill="black" stroke="black" points="453594.83,-527.13 453604.56,-522.94 453594.34,-520.15 453594.83,-527.13"/>
<text text-anchor="middle" x="452510" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_7 -->
<g id="edge2732" class="edge">
<title>layer_14_gate_tp_2&#45;&gt;layer_14_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451157.01,-625.98C451153.66,-625.64 451150.32,-625.31 451147,-625 450823.27,-594.84 450009.01,-616.17 449684,-607 449593.28,-604.44 449570.73,-600.14 449480,-598 448896.38,-584.24 447436.74,-596.47 446853,-590 445316.6,-572.97 443470.85,-530.09 442813.36,-514.12"/>
<polygon fill="black" stroke="black" points="442813.37,-510.62 442803.29,-513.88 442813.2,-517.62 442813.37,-510.62"/>
<text text-anchor="middle" x="449710" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3 -->
<g id="node1461" class="node">
<title>layer_14_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="450555.99,-729 450107.4,-729 449992.01,-625 450440.6,-625 450555.99,-729"/>
<text text-anchor="middle" x="450274" y="-691" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="450274" y="-680" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="450274" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="450274" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_0 -->
<g id="edge2733" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450456.55,-639.15C450492.36,-633.3 450529.75,-628.14 450565,-625 450794.04,-604.58 454474.08,-610.59 454704,-607 455047.34,-601.64 457404.35,-535.72 458158.48,-514.52"/>
<polygon fill="black" stroke="black" points="458158.75,-518.02 458168.64,-514.24 458158.55,-511.02 458158.75,-518.02"/>
<text text-anchor="middle" x="455121" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_1 -->
<g id="edge2734" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450324.1,-624.68C450342.14,-606.2 450362.62,-585.22 450381.19,-566.19"/>
<polygon fill="black" stroke="black" points="450383.73,-568.6 450388.21,-559 450378.72,-563.72 450383.73,-568.6"/>
<text text-anchor="middle" x="450372" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_2 -->
<g id="edge2735" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450456.54,-639.07C450492.35,-633.22 450529.74,-628.09 450565,-625 450725.58,-610.91 462009.81,-608.62 462171,-607 462386.58,-604.83 462440.44,-601.61 462656,-598 462893.77,-594.02 462953.23,-594.09 463191,-590 464705.96,-563.91 466527.65,-526.27 467164.59,-512.92"/>
<polygon fill="black" stroke="black" points="467164.89,-516.42 467174.81,-512.71 467164.74,-509.42 467164.89,-516.42"/>
<text text-anchor="middle" x="462682" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_3 -->
<g id="edge2736" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449993.02,-625.94C449989.66,-625.61 449986.32,-625.3 449983,-625 449777.59,-606.63 446477.22,-608.27 446271,-607 445731.88,-603.69 445597.12,-600.77 445058,-598 443818.46,-591.62 443508.48,-603.83 442269,-590 440761.24,-573.18 438950.62,-530.36 438299.91,-514.26"/>
<polygon fill="black" stroke="black" points="438299.55,-510.75 438289.47,-514 438299.38,-517.74 438299.55,-510.75"/>
<text text-anchor="middle" x="446297" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_4 -->
<g id="edge2737" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450007.73,-624.97C449941.12,-614.12 449869.65,-604.11 449803,-598 449340.46,-555.61 447961.47,-524.17 447396.03,-512.73"/>
<polygon fill="black" stroke="black" points="447395.77,-509.22 447385.7,-512.52 447395.63,-516.22 447395.77,-509.22"/>
<text text-anchor="middle" x="449906" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_5 -->
<g id="edge2738" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450456.54,-639.08C450492.35,-633.23 450529.75,-628.1 450565,-625 450836.79,-601.11 460114.22,-612.63 460387,-607 461228.76,-589.61 462228.6,-542.04 462667.93,-519.78"/>
<polygon fill="black" stroke="black" points="462668.4,-523.26 462678.21,-519.26 462668.04,-516.27 462668.4,-523.26"/>
<text text-anchor="middle" x="460754" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_6 -->
<g id="edge2739" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450457.41,-639.92C450492.98,-634.04 450530.06,-628.68 450565,-625 450892.74,-590.47 450976.66,-609.9 451306,-598 452146.33,-567.62 453144.92,-531.94 453586.5,-516.18"/>
<polygon fill="black" stroke="black" points="453586.64,-519.68 453596.51,-515.83 453586.39,-512.69 453586.64,-519.68"/>
<text text-anchor="middle" x="451332" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_7 -->
<g id="edge2740" class="edge">
<title>layer_14_gate_tp_3&#45;&gt;layer_14_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M449993.01,-626.01C449989.66,-625.65 449986.32,-625.32 449983,-625 449941.99,-621.06 448541.2,-598.48 448500,-598 447768.04,-589.56 447584.96,-598.78 446853,-590 445316.62,-571.58 443470.86,-529.56 442813.36,-513.97"/>
<polygon fill="black" stroke="black" points="442813.37,-510.47 442803.29,-513.73 442813.21,-517.46 442813.37,-510.47"/>
<text text-anchor="middle" x="449054" y="-600.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_14_expert_0_ep_0 -->
<g id="node1470" class="node">
<title>layer_14_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="457817.83,-410 457383.82,-410 457272.17,-306 457706.18,-306 457817.83,-410"/>
<text text-anchor="middle" x="457545" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="457545" y="-361" font-family="Arial" font-size="10.00">GPU: 384</text>
<text text-anchor="middle" x="457545" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="457545" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_0_ep_0 -->
<g id="edge2741" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M458104.78,-458.08C458015.48,-442.9 457916.61,-425.93 457826,-410 457825.9,-409.98 457825.79,-409.96 457825.69,-409.95"/>
<polygon fill="black" stroke="black" points="457826.51,-406.54 457816.05,-408.25 457825.29,-413.43 457826.51,-406.54"/>
</g>
<!-- layer_14_expert_1_ep_0 -->
<g id="node1471" class="node">
<title>layer_14_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="458380.83,-410 457946.82,-410 457835.17,-306 458269.18,-306 458380.83,-410"/>
<text text-anchor="middle" x="458108" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="458108" y="-361" font-family="Arial" font-size="10.00">GPU: 385</text>
<text text-anchor="middle" x="458108" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="458108" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_1_ep_0 -->
<g id="edge2742" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M458292.16,-455C458267.26,-442.02 458240.37,-428 458215.03,-414.79"/>
<polygon fill="black" stroke="black" points="458216.63,-411.68 458206.14,-410.16 458213.39,-417.89 458216.63,-411.68"/>
</g>
<!-- layer_14_expert_2_ep_0 -->
<g id="node1472" class="node">
<title>layer_14_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="458943.83,-410 458509.82,-410 458398.17,-306 458832.18,-306 458943.83,-410"/>
<text text-anchor="middle" x="458671" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="458671" y="-361" font-family="Arial" font-size="10.00">GPU: 386</text>
<text text-anchor="middle" x="458671" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="458671" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_2_ep_0 -->
<g id="edge2743" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M458487.49,-455C458512.2,-442.07 458538.87,-428.12 458564.02,-414.97"/>
<polygon fill="black" stroke="black" points="458565.97,-417.9 458573.21,-410.16 458562.72,-411.69 458565.97,-417.9"/>
</g>
<!-- layer_14_expert_3_ep_0 -->
<g id="node1473" class="node">
<title>layer_14_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="459506.83,-410 459072.82,-410 458961.17,-306 459395.18,-306 459506.83,-410"/>
<text text-anchor="middle" x="459234" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="459234" y="-361" font-family="Arial" font-size="10.00">GPU: 387</text>
<text text-anchor="middle" x="459234" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="459234" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_3_ep_0 -->
<g id="edge2744" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M458581.94,-473.79C458690.83,-455.39 458829.59,-431.72 458953,-410 458982.17,-404.87 459013.04,-399.35 459043.21,-393.91"/>
<polygon fill="black" stroke="black" points="459044.19,-397.29 459053.41,-392.07 459042.95,-390.4 459044.19,-397.29"/>
</g>
<!-- layer_14_expert_4_ep_0 -->
<g id="node1474" class="node">
<title>layer_14_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="460069.83,-410 459635.82,-410 459524.17,-306 459958.18,-306 460069.83,-410"/>
<text text-anchor="middle" x="459797" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="459797" y="-361" font-family="Arial" font-size="10.00">GPU: 388</text>
<text text-anchor="middle" x="459797" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="459797" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_4_ep_0 -->
<g id="edge2745" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M458604.42,-493.77C458831.45,-479.4 459199.97,-452.06 459516,-410 459545.94,-406.02 459577.53,-401.04 459608.31,-395.77"/>
<polygon fill="black" stroke="black" points="459609.01,-399.2 459618.27,-394.05 459607.82,-392.31 459609.01,-399.2"/>
</g>
<!-- layer_14_expert_5_ep_0 -->
<g id="node1475" class="node">
<title>layer_14_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="460632.83,-410 460198.82,-410 460087.17,-306 460521.18,-306 460632.83,-410"/>
<text text-anchor="middle" x="460360" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="460360" y="-361" font-family="Arial" font-size="10.00">GPU: 389</text>
<text text-anchor="middle" x="460360" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="460360" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_5_ep_0 -->
<g id="edge2746" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M458613.78,-502.01C458937.89,-494.26 459556.39,-472.04 460079,-410 460109.21,-406.41 460141.08,-401.62 460172.08,-396.4"/>
<polygon fill="black" stroke="black" points="460172.85,-399.82 460182.12,-394.69 460171.67,-392.92 460172.85,-399.82"/>
</g>
<!-- layer_14_expert_6_ep_0 -->
<g id="node1476" class="node">
<title>layer_14_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="461195.83,-410 460761.82,-410 460650.17,-306 461084.18,-306 461195.83,-410"/>
<text text-anchor="middle" x="460923" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="460923" y="-361" font-family="Arial" font-size="10.00">GPU: 390</text>
<text text-anchor="middle" x="460923" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="460923" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_6_ep_0 -->
<g id="edge2747" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M458618.95,-506.57C459026.87,-505.28 459905.73,-492.12 460642,-410 460672.35,-406.62 460704.35,-401.91 460735.47,-396.71"/>
<polygon fill="black" stroke="black" points="460736.26,-400.13 460745.54,-395.01 460735.09,-393.22 460736.26,-400.13"/>
</g>
<!-- layer_14_expert_7_ep_0 -->
<g id="node1477" class="node">
<title>layer_14_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="461758.83,-410 461324.82,-410 461213.17,-306 461647.18,-306 461758.83,-410"/>
<text text-anchor="middle" x="461486" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="461486" y="-361" font-family="Arial" font-size="10.00">GPU: 391</text>
<text text-anchor="middle" x="461486" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="461486" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_0&#45;&gt;layer_14_expert_7_ep_0 -->
<g id="edge2748" class="edge">
<title>layer_14_route_ep_0&#45;&gt;layer_14_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M458610.05,-498.66C458984.59,-486.15 459769.98,-459.83 460434,-437 460776.67,-425.22 460864.09,-446.71 461205,-410 461235.36,-406.73 461267.37,-402.08 461298.49,-396.91"/>
<polygon fill="black" stroke="black" points="461299.28,-400.33 461308.56,-395.21 461298.12,-393.42 461299.28,-400.33"/>
</g>
<!-- layer_14_expert_0_ep_1 -->
<g id="node1478" class="node">
<title>layer_14_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="448809.83,-410 448375.82,-410 448264.17,-306 448698.18,-306 448809.83,-410"/>
<text text-anchor="middle" x="448537" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="448537" y="-361" font-family="Arial" font-size="10.00">GPU: 400</text>
<text text-anchor="middle" x="448537" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="448537" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_0_ep_1 -->
<g id="edge2749" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M450201.45,-500.89C449887.39,-492.09 449315.6,-469.05 448818.96,-410.08"/>
<polygon fill="black" stroke="black" points="448819.06,-406.57 448808.72,-408.86 448818.24,-413.52 448819.06,-406.57"/>
</g>
<!-- layer_14_expert_1_ep_1 -->
<g id="node1479" class="node">
<title>layer_14_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="449372.83,-410 448938.82,-410 448827.17,-306 449261.18,-306 449372.83,-410"/>
<text text-anchor="middle" x="449100" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="449100" y="-361" font-family="Arial" font-size="10.00">GPU: 401</text>
<text text-anchor="middle" x="449100" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="449100" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_1_ep_1 -->
<g id="edge2750" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M450188.76,-489.65C449976.63,-474.25 449663.79,-448.04 449381.76,-410.07"/>
<polygon fill="black" stroke="black" points="449382.12,-406.59 449371.74,-408.72 449381.18,-413.53 449382.12,-406.59"/>
</g>
<!-- layer_14_expert_2_ep_1 -->
<g id="node1480" class="node">
<title>layer_14_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="449935.83,-410 449501.82,-410 449390.17,-306 449824.18,-306 449935.83,-410"/>
<text text-anchor="middle" x="449663" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="449663" y="-361" font-family="Arial" font-size="10.00">GPU: 402</text>
<text text-anchor="middle" x="449663" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="449663" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_2_ep_1 -->
<g id="edge2751" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M450169.12,-455C450095.69,-441.07 450015.97,-425.95 449941.99,-411.92"/>
<polygon fill="black" stroke="black" points="449942.54,-408.46 449932.06,-410.04 449941.24,-415.34 449942.54,-408.46"/>
</g>
<!-- layer_14_expert_3_ep_1 -->
<g id="node1481" class="node">
<title>layer_14_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="450498.83,-410 450064.82,-410 449953.17,-306 450387.18,-306 450498.83,-410"/>
<text text-anchor="middle" x="450226" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="450226" y="-361" font-family="Arial" font-size="10.00">GPU: 403</text>
<text text-anchor="middle" x="450226" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="450226" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_3_ep_1 -->
<g id="edge2752" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M450364.45,-455C450346.3,-442.41 450326.75,-428.86 450308.21,-416.01"/>
<polygon fill="black" stroke="black" points="450309.99,-412.98 450299.78,-410.16 450306,-418.73 450309.99,-412.98"/>
</g>
<!-- layer_14_expert_4_ep_1 -->
<g id="node1482" class="node">
<title>layer_14_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="451061.83,-410 450627.82,-410 450516.17,-306 450950.18,-306 451061.83,-410"/>
<text text-anchor="middle" x="450789" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="450789" y="-361" font-family="Arial" font-size="10.00">GPU: 404</text>
<text text-anchor="middle" x="450789" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="450789" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_4_ep_1 -->
<g id="edge2753" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M450559.78,-455C450591.41,-441.75 450625.61,-427.43 450657.7,-413.99"/>
<polygon fill="black" stroke="black" points="450659.27,-417.13 450667.14,-410.04 450656.56,-410.67 450659.27,-417.13"/>
</g>
<!-- layer_14_expert_5_ep_1 -->
<g id="node1483" class="node">
<title>layer_14_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="451624.83,-410 451190.82,-410 451079.17,-306 451513.18,-306 451624.83,-410"/>
<text text-anchor="middle" x="451352" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="451352" y="-361" font-family="Arial" font-size="10.00">GPU: 405</text>
<text text-anchor="middle" x="451352" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="451352" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_5_ep_1 -->
<g id="edge2754" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M450634.27,-477.73C450759.4,-459.34 450924.9,-434.33 451071,-410 451100.46,-405.09 451131.61,-399.67 451162.03,-394.25"/>
<polygon fill="black" stroke="black" points="451162.65,-397.7 451171.87,-392.49 451161.41,-390.81 451162.65,-397.7"/>
</g>
<!-- layer_14_expert_6_ep_1 -->
<g id="node1484" class="node">
<title>layer_14_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="452187.83,-410 451753.82,-410 451642.17,-306 452076.18,-306 452187.83,-410"/>
<text text-anchor="middle" x="451915" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="451915" y="-361" font-family="Arial" font-size="10.00">GPU: 406</text>
<text text-anchor="middle" x="451915" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="451915" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_6_ep_1 -->
<g id="edge2755" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M450654.19,-495.13C450894.26,-481.55 451292.93,-454.53 451634,-410 451664.06,-406.08 451695.78,-401.12 451726.67,-395.84"/>
<polygon fill="black" stroke="black" points="451727.4,-399.27 451736.66,-394.12 451726.21,-392.37 451727.4,-399.27"/>
</g>
<!-- layer_14_expert_7_ep_1 -->
<g id="node1485" class="node">
<title>layer_14_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="452750.83,-410 452316.82,-410 452205.17,-306 452639.18,-306 452750.83,-410"/>
<text text-anchor="middle" x="452478" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="452478" y="-361" font-family="Arial" font-size="10.00">GPU: 407</text>
<text text-anchor="middle" x="452478" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="452478" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_1&#45;&gt;layer_14_expert_7_ep_1 -->
<g id="edge2756" class="edge">
<title>layer_14_route_ep_1&#45;&gt;layer_14_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M450662.64,-502.72C450997.8,-495.79 451648.17,-474.52 452197,-410 452227.21,-406.45 452259.09,-401.67 452290.09,-396.45"/>
<polygon fill="black" stroke="black" points="452290.85,-399.88 452300.12,-394.75 452289.68,-392.97 452290.85,-399.88"/>
</g>
<!-- layer_14_expert_0_ep_2 -->
<g id="node1486" class="node">
<title>layer_14_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="466825.83,-410 466391.82,-410 466280.17,-306 466714.18,-306 466825.83,-410"/>
<text text-anchor="middle" x="466553" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="466553" y="-361" font-family="Arial" font-size="10.00">GPU: 416</text>
<text text-anchor="middle" x="466553" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="466553" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_0_ep_2 -->
<g id="edge2757" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M467112.78,-458.08C467023.48,-442.9 466924.61,-425.93 466834,-410 466833.9,-409.98 466833.79,-409.96 466833.69,-409.95"/>
<polygon fill="black" stroke="black" points="466834.51,-406.54 466824.05,-408.25 466833.29,-413.43 466834.51,-406.54"/>
</g>
<!-- layer_14_expert_1_ep_2 -->
<g id="node1487" class="node">
<title>layer_14_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="467388.83,-410 466954.82,-410 466843.17,-306 467277.18,-306 467388.83,-410"/>
<text text-anchor="middle" x="467116" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="467116" y="-361" font-family="Arial" font-size="10.00">GPU: 417</text>
<text text-anchor="middle" x="467116" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="467116" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_1_ep_2 -->
<g id="edge2758" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M467300.16,-455C467275.26,-442.02 467248.37,-428 467223.03,-414.79"/>
<polygon fill="black" stroke="black" points="467224.63,-411.68 467214.14,-410.16 467221.39,-417.89 467224.63,-411.68"/>
</g>
<!-- layer_14_expert_2_ep_2 -->
<g id="node1488" class="node">
<title>layer_14_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="467951.83,-410 467517.82,-410 467406.17,-306 467840.18,-306 467951.83,-410"/>
<text text-anchor="middle" x="467679" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="467679" y="-361" font-family="Arial" font-size="10.00">GPU: 418</text>
<text text-anchor="middle" x="467679" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="467679" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_2_ep_2 -->
<g id="edge2759" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M467495.49,-455C467520.2,-442.07 467546.87,-428.12 467572.02,-414.97"/>
<polygon fill="black" stroke="black" points="467573.97,-417.9 467581.21,-410.16 467570.72,-411.69 467573.97,-417.9"/>
</g>
<!-- layer_14_expert_3_ep_2 -->
<g id="node1489" class="node">
<title>layer_14_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="468514.83,-410 468080.82,-410 467969.17,-306 468403.18,-306 468514.83,-410"/>
<text text-anchor="middle" x="468242" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="468242" y="-361" font-family="Arial" font-size="10.00">GPU: 419</text>
<text text-anchor="middle" x="468242" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="468242" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_3_ep_2 -->
<g id="edge2760" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M467589.94,-473.79C467698.83,-455.39 467837.59,-431.72 467961,-410 467990.17,-404.87 468021.04,-399.35 468051.21,-393.91"/>
<polygon fill="black" stroke="black" points="468052.19,-397.29 468061.41,-392.07 468050.95,-390.4 468052.19,-397.29"/>
</g>
<!-- layer_14_expert_4_ep_2 -->
<g id="node1490" class="node">
<title>layer_14_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="469077.83,-410 468643.82,-410 468532.17,-306 468966.18,-306 469077.83,-410"/>
<text text-anchor="middle" x="468805" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="468805" y="-361" font-family="Arial" font-size="10.00">GPU: 420</text>
<text text-anchor="middle" x="468805" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="468805" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_4_ep_2 -->
<g id="edge2761" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M467612.42,-493.77C467839.45,-479.4 468207.97,-452.06 468524,-410 468553.94,-406.02 468585.53,-401.04 468616.31,-395.77"/>
<polygon fill="black" stroke="black" points="468617.01,-399.2 468626.27,-394.05 468615.82,-392.31 468617.01,-399.2"/>
</g>
<!-- layer_14_expert_5_ep_2 -->
<g id="node1491" class="node">
<title>layer_14_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="469640.83,-410 469206.82,-410 469095.17,-306 469529.18,-306 469640.83,-410"/>
<text text-anchor="middle" x="469368" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="469368" y="-361" font-family="Arial" font-size="10.00">GPU: 421</text>
<text text-anchor="middle" x="469368" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="469368" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_5_ep_2 -->
<g id="edge2762" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M467621.78,-502.01C467945.89,-494.26 468564.39,-472.04 469087,-410 469117.21,-406.41 469149.08,-401.62 469180.08,-396.4"/>
<polygon fill="black" stroke="black" points="469180.85,-399.82 469190.12,-394.69 469179.67,-392.92 469180.85,-399.82"/>
</g>
<!-- layer_14_expert_6_ep_2 -->
<g id="node1492" class="node">
<title>layer_14_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="470203.83,-410 469769.82,-410 469658.17,-306 470092.18,-306 470203.83,-410"/>
<text text-anchor="middle" x="469931" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="469931" y="-361" font-family="Arial" font-size="10.00">GPU: 422</text>
<text text-anchor="middle" x="469931" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="469931" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_6_ep_2 -->
<g id="edge2763" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M467626.95,-506.57C468034.87,-505.28 468913.73,-492.12 469650,-410 469680.35,-406.62 469712.35,-401.91 469743.47,-396.71"/>
<polygon fill="black" stroke="black" points="469744.26,-400.13 469753.54,-395.01 469743.09,-393.22 469744.26,-400.13"/>
</g>
<!-- layer_14_expert_7_ep_2 -->
<g id="node1493" class="node">
<title>layer_14_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="470766.83,-410 470332.82,-410 470221.17,-306 470655.18,-306 470766.83,-410"/>
<text text-anchor="middle" x="470494" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="470494" y="-361" font-family="Arial" font-size="10.00">GPU: 423</text>
<text text-anchor="middle" x="470494" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="470494" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_2&#45;&gt;layer_14_expert_7_ep_2 -->
<g id="edge2764" class="edge">
<title>layer_14_route_ep_2&#45;&gt;layer_14_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M467618.05,-498.66C467992.59,-486.15 468777.98,-459.83 469442,-437 469784.67,-425.22 469872.09,-446.71 470213,-410 470243.36,-406.73 470275.37,-402.08 470306.49,-396.91"/>
<polygon fill="black" stroke="black" points="470307.28,-400.33 470316.56,-395.21 470306.12,-393.42 470307.28,-400.33"/>
</g>
<!-- layer_14_expert_0_ep_3 -->
<g id="node1494" class="node">
<title>layer_14_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="435297.83,-410 434863.82,-410 434752.17,-306 435186.18,-306 435297.83,-410"/>
<text text-anchor="middle" x="435025" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="435025" y="-361" font-family="Arial" font-size="10.00">GPU: 432</text>
<text text-anchor="middle" x="435025" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="435025" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_0_ep_3 -->
<g id="edge2765" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M437800.81,-488.03C437595.92,-474.18 437298.91,-455.93 437039,-447 436657.32,-433.89 435705.44,-450.87 435307.25,-410.08"/>
<polygon fill="black" stroke="black" points="435307.39,-406.57 435297.08,-409.01 435306.66,-413.53 435307.39,-406.57"/>
</g>
<!-- layer_14_expert_1_ep_3 -->
<g id="node1495" class="node">
<title>layer_14_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="435860.83,-410 435426.82,-410 435315.17,-306 435749.18,-306 435860.83,-410"/>
<text text-anchor="middle" x="435588" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="435588" y="-361" font-family="Arial" font-size="10.00">GPU: 433</text>
<text text-anchor="middle" x="435588" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="435588" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_1_ep_3 -->
<g id="edge2766" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M437802.83,-489.64C437597.84,-476.62 437299.68,-458.71 437039,-447 436522.56,-423.8 436388.07,-464.31 435870.05,-410.07"/>
<polygon fill="black" stroke="black" points="435870.39,-406.59 435860.08,-409.02 435869.66,-413.55 435870.39,-406.59"/>
</g>
<!-- layer_14_expert_2_ep_3 -->
<g id="node1496" class="node">
<title>layer_14_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="436423.83,-410 435989.82,-410 435878.17,-306 436312.18,-306 436423.83,-410"/>
<text text-anchor="middle" x="436151" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="436151" y="-361" font-family="Arial" font-size="10.00">GPU: 434</text>
<text text-anchor="middle" x="436151" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="436151" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_2_ep_3 -->
<g id="edge2767" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M437804.66,-491.53C437377.56,-466.52 436537.97,-417.25 436433,-409.69"/>
<polygon fill="black" stroke="black" points="436432.97,-406.18 436422.72,-408.86 436432.4,-413.15 436432.97,-406.18"/>
</g>
<!-- layer_14_expert_3_ep_3 -->
<g id="node1497" class="node">
<title>layer_14_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="436986.83,-410 436552.82,-410 436441.17,-306 436875.18,-306 436986.83,-410"/>
<text text-anchor="middle" x="436714" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="436714" y="-361" font-family="Arial" font-size="10.00">GPU: 435</text>
<text text-anchor="middle" x="436714" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="436714" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_3_ep_3 -->
<g id="edge2768" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M437802.76,-489.65C437590.63,-474.25 437277.79,-448.04 436995.76,-410.07"/>
<polygon fill="black" stroke="black" points="436996.12,-406.59 436985.74,-408.72 436995.18,-413.53 436996.12,-406.59"/>
</g>
<!-- layer_14_expert_4_ep_3 -->
<g id="node1498" class="node">
<title>layer_14_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="437549.83,-410 437115.82,-410 437004.17,-306 437438.18,-306 437549.83,-410"/>
<text text-anchor="middle" x="437277" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="437277" y="-361" font-family="Arial" font-size="10.00">GPU: 436</text>
<text text-anchor="middle" x="437277" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="437277" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_4_ep_3 -->
<g id="edge2769" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M437783.12,-455C437709.69,-441.07 437629.97,-425.95 437555.99,-411.92"/>
<polygon fill="black" stroke="black" points="437556.54,-408.46 437546.06,-410.04 437555.24,-415.34 437556.54,-408.46"/>
</g>
<!-- layer_14_expert_5_ep_3 -->
<g id="node1499" class="node">
<title>layer_14_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="438112.83,-410 437678.82,-410 437567.17,-306 438001.18,-306 438112.83,-410"/>
<text text-anchor="middle" x="437840" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="437840" y="-361" font-family="Arial" font-size="10.00">GPU: 437</text>
<text text-anchor="middle" x="437840" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="437840" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_5_ep_3 -->
<g id="edge2770" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M437978.45,-455C437960.3,-442.41 437940.75,-428.86 437922.21,-416.01"/>
<polygon fill="black" stroke="black" points="437923.99,-412.98 437913.78,-410.16 437920,-418.73 437923.99,-412.98"/>
</g>
<!-- layer_14_expert_6_ep_3 -->
<g id="node1500" class="node">
<title>layer_14_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="438675.83,-410 438241.82,-410 438130.17,-306 438564.18,-306 438675.83,-410"/>
<text text-anchor="middle" x="438403" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="438403" y="-361" font-family="Arial" font-size="10.00">GPU: 438</text>
<text text-anchor="middle" x="438403" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="438403" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_6_ep_3 -->
<g id="edge2771" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M438173.78,-455C438205.41,-441.75 438239.61,-427.43 438271.7,-413.99"/>
<polygon fill="black" stroke="black" points="438273.27,-417.13 438281.14,-410.04 438270.56,-410.67 438273.27,-417.13"/>
</g>
<!-- layer_14_expert_7_ep_3 -->
<g id="node1501" class="node">
<title>layer_14_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="439238.83,-410 438804.82,-410 438693.17,-306 439127.18,-306 439238.83,-410"/>
<text text-anchor="middle" x="438966" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="438966" y="-361" font-family="Arial" font-size="10.00">GPU: 439</text>
<text text-anchor="middle" x="438966" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="438966" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_3&#45;&gt;layer_14_expert_7_ep_3 -->
<g id="edge2772" class="edge">
<title>layer_14_route_ep_3&#45;&gt;layer_14_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M438248.27,-477.73C438373.4,-459.34 438538.9,-434.33 438685,-410 438714.46,-405.09 438745.61,-399.67 438776.03,-394.25"/>
<polygon fill="black" stroke="black" points="438776.65,-397.7 438785.87,-392.49 438775.41,-390.81 438776.65,-397.7"/>
</g>
<!-- layer_14_expert_0_ep_4 -->
<g id="node1502" class="node">
<title>layer_14_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="444305.83,-410 443871.82,-410 443760.17,-306 444194.18,-306 444305.83,-410"/>
<text text-anchor="middle" x="444033" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="444033" y="-361" font-family="Arial" font-size="10.00">GPU: 448</text>
<text text-anchor="middle" x="444033" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="444033" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_0_ep_4 -->
<g id="edge2773" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M446910.53,-498.38C446521.52,-485.93 445728.06,-460.3 445056,-437 444729.58,-425.68 444643.83,-445.15 444315.37,-410.11"/>
<polygon fill="black" stroke="black" points="444315.4,-406.59 444305.08,-409 444314.65,-413.55 444315.4,-406.59"/>
</g>
<!-- layer_14_expert_1_ep_4 -->
<g id="node1503" class="node">
<title>layer_14_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="444868.83,-410 444434.82,-410 444323.17,-306 444757.18,-306 444868.83,-410"/>
<text text-anchor="middle" x="444596" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="444596" y="-361" font-family="Arial" font-size="10.00">GPU: 449</text>
<text text-anchor="middle" x="444596" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="444596" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_1_ep_4 -->
<g id="edge2774" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M446920.14,-506.7C446510.81,-505.63 445628.88,-492.93 444877.93,-410.06"/>
<polygon fill="black" stroke="black" points="444878.04,-406.55 444867.71,-408.93 444877.27,-413.51 444878.04,-406.55"/>
</g>
<!-- layer_14_expert_2_ep_4 -->
<g id="node1504" class="node">
<title>layer_14_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="445431.83,-410 444997.82,-410 444886.17,-306 445320.18,-306 445431.83,-410"/>
<text text-anchor="middle" x="445159" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="445159" y="-361" font-family="Arial" font-size="10.00">GPU: 450</text>
<text text-anchor="middle" x="445159" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="445159" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_2_ep_4 -->
<g id="edge2775" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M446914.79,-501.97C446586.48,-494.28 445972.35,-472.36 445440.89,-410.07"/>
<polygon fill="black" stroke="black" points="445441.06,-406.56 445430.72,-408.87 445440.24,-413.52 445441.06,-406.56"/>
</g>
<!-- layer_14_expert_3_ep_4 -->
<g id="node1505" class="node">
<title>layer_14_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="445994.83,-410 445560.82,-410 445449.17,-306 445883.18,-306 445994.83,-410"/>
<text text-anchor="middle" x="445722" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="445722" y="-361" font-family="Arial" font-size="10.00">GPU: 451</text>
<text text-anchor="middle" x="445722" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="445722" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_3_ep_4 -->
<g id="edge2776" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M446903.7,-492.25C446673.44,-477.79 446319.98,-451.49 446004.01,-410.1"/>
<polygon fill="black" stroke="black" points="446004.11,-406.59 445993.73,-408.75 446003.19,-413.53 446004.11,-406.59"/>
</g>
<!-- layer_14_expert_4_ep_4 -->
<g id="node1506" class="node">
<title>layer_14_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="446557.83,-410 446123.82,-410 446012.17,-306 446446.18,-306 446557.83,-410"/>
<text text-anchor="middle" x="446285" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="446285" y="-361" font-family="Arial" font-size="10.00">GPU: 452</text>
<text text-anchor="middle" x="446285" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="446285" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_4_ep_4 -->
<g id="edge2777" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M446867.65,-460.56C446771.84,-444.88 446664.21,-426.98 446566,-410 446565.9,-409.98 446565.79,-409.96 446565.69,-409.95"/>
<polygon fill="black" stroke="black" points="446566.5,-406.53 446556.05,-408.27 446565.3,-413.43 446566.5,-406.53"/>
</g>
<!-- layer_14_expert_5_ep_4 -->
<g id="node1507" class="node">
<title>layer_14_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="447120.83,-410 446686.82,-410 446575.17,-306 447009.18,-306 447120.83,-410"/>
<text text-anchor="middle" x="446848" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="446848" y="-361" font-family="Arial" font-size="10.00">GPU: 453</text>
<text text-anchor="middle" x="446848" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="446848" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_5_ep_4 -->
<g id="edge2778" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M447045.22,-455C447018.36,-441.92 446989.34,-427.8 446962.04,-414.51"/>
<polygon fill="black" stroke="black" points="446963.37,-411.26 446952.85,-410.04 446960.31,-417.56 446963.37,-411.26"/>
</g>
<!-- layer_14_expert_6_ep_4 -->
<g id="node1508" class="node">
<title>layer_14_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="447683.83,-410 447249.82,-410 447138.17,-306 447572.18,-306 447683.83,-410"/>
<text text-anchor="middle" x="447411" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="447411" y="-361" font-family="Arial" font-size="10.00">GPU: 454</text>
<text text-anchor="middle" x="447411" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="447411" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_6_ep_4 -->
<g id="edge2779" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M447240.55,-455C447263.4,-442.13 447288.05,-428.25 447311.32,-415.14"/>
<polygon fill="black" stroke="black" points="447313.17,-418.12 447320.17,-410.16 447309.73,-412.02 447313.17,-418.12"/>
</g>
<!-- layer_14_expert_7_ep_4 -->
<g id="node1509" class="node">
<title>layer_14_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="448246.83,-410 447812.82,-410 447701.17,-306 448135.18,-306 448246.83,-410"/>
<text text-anchor="middle" x="447974" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="447974" y="-361" font-family="Arial" font-size="10.00">GPU: 455</text>
<text text-anchor="middle" x="447974" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="447974" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_4&#45;&gt;layer_14_expert_7_ep_4 -->
<g id="edge2780" class="edge">
<title>layer_14_route_ep_4&#45;&gt;layer_14_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M447340.39,-472.56C447444.57,-454.2 447575.92,-430.97 447693,-410 447722.16,-404.78 447753.01,-399.21 447783.18,-393.75"/>
<polygon fill="black" stroke="black" points="447784.17,-397.13 447793.38,-391.91 447782.92,-390.24 447784.17,-397.13"/>
</g>
<!-- layer_14_expert_0_ep_5 -->
<g id="node1510" class="node">
<title>layer_14_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="462321.83,-410 461887.82,-410 461776.17,-306 462210.18,-306 462321.83,-410"/>
<text text-anchor="middle" x="462049" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="462049" y="-361" font-family="Arial" font-size="10.00">GPU: 464</text>
<text text-anchor="middle" x="462049" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="462049" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_0_ep_5 -->
<g id="edge2781" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M462608.78,-458.08C462519.48,-442.9 462420.61,-425.93 462330,-410 462329.9,-409.98 462329.79,-409.96 462329.69,-409.95"/>
<polygon fill="black" stroke="black" points="462330.51,-406.54 462320.05,-408.25 462329.29,-413.43 462330.51,-406.54"/>
</g>
<!-- layer_14_expert_1_ep_5 -->
<g id="node1511" class="node">
<title>layer_14_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="462884.83,-410 462450.82,-410 462339.17,-306 462773.18,-306 462884.83,-410"/>
<text text-anchor="middle" x="462612" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="462612" y="-361" font-family="Arial" font-size="10.00">GPU: 465</text>
<text text-anchor="middle" x="462612" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="462612" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_1_ep_5 -->
<g id="edge2782" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M462796.16,-455C462771.26,-442.02 462744.37,-428 462719.03,-414.79"/>
<polygon fill="black" stroke="black" points="462720.63,-411.68 462710.14,-410.16 462717.39,-417.89 462720.63,-411.68"/>
</g>
<!-- layer_14_expert_2_ep_5 -->
<g id="node1512" class="node">
<title>layer_14_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="463447.83,-410 463013.82,-410 462902.17,-306 463336.18,-306 463447.83,-410"/>
<text text-anchor="middle" x="463175" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="463175" y="-361" font-family="Arial" font-size="10.00">GPU: 466</text>
<text text-anchor="middle" x="463175" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="463175" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_2_ep_5 -->
<g id="edge2783" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M462991.49,-455C463016.2,-442.07 463042.87,-428.12 463068.02,-414.97"/>
<polygon fill="black" stroke="black" points="463069.97,-417.9 463077.21,-410.16 463066.72,-411.69 463069.97,-417.9"/>
</g>
<!-- layer_14_expert_3_ep_5 -->
<g id="node1513" class="node">
<title>layer_14_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="464010.83,-410 463576.82,-410 463465.17,-306 463899.18,-306 464010.83,-410"/>
<text text-anchor="middle" x="463738" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="463738" y="-361" font-family="Arial" font-size="10.00">GPU: 467</text>
<text text-anchor="middle" x="463738" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="463738" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_3_ep_5 -->
<g id="edge2784" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M463085.94,-473.79C463194.83,-455.39 463333.59,-431.72 463457,-410 463486.17,-404.87 463517.04,-399.35 463547.21,-393.91"/>
<polygon fill="black" stroke="black" points="463548.19,-397.29 463557.41,-392.07 463546.95,-390.4 463548.19,-397.29"/>
</g>
<!-- layer_14_expert_4_ep_5 -->
<g id="node1514" class="node">
<title>layer_14_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="464573.83,-410 464139.82,-410 464028.17,-306 464462.18,-306 464573.83,-410"/>
<text text-anchor="middle" x="464301" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="464301" y="-361" font-family="Arial" font-size="10.00">GPU: 468</text>
<text text-anchor="middle" x="464301" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="464301" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_4_ep_5 -->
<g id="edge2785" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M463108.42,-493.77C463335.45,-479.4 463703.97,-452.06 464020,-410 464049.94,-406.02 464081.53,-401.04 464112.31,-395.77"/>
<polygon fill="black" stroke="black" points="464113.01,-399.2 464122.27,-394.05 464111.82,-392.31 464113.01,-399.2"/>
</g>
<!-- layer_14_expert_5_ep_5 -->
<g id="node1515" class="node">
<title>layer_14_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="465136.83,-410 464702.82,-410 464591.17,-306 465025.18,-306 465136.83,-410"/>
<text text-anchor="middle" x="464864" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="464864" y="-361" font-family="Arial" font-size="10.00">GPU: 469</text>
<text text-anchor="middle" x="464864" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="464864" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_5_ep_5 -->
<g id="edge2786" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M463117.78,-502.01C463441.89,-494.26 464060.39,-472.04 464583,-410 464613.21,-406.41 464645.08,-401.62 464676.08,-396.4"/>
<polygon fill="black" stroke="black" points="464676.85,-399.82 464686.12,-394.69 464675.67,-392.92 464676.85,-399.82"/>
</g>
<!-- layer_14_expert_6_ep_5 -->
<g id="node1516" class="node">
<title>layer_14_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="465699.83,-410 465265.82,-410 465154.17,-306 465588.18,-306 465699.83,-410"/>
<text text-anchor="middle" x="465427" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="465427" y="-361" font-family="Arial" font-size="10.00">GPU: 470</text>
<text text-anchor="middle" x="465427" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="465427" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_6_ep_5 -->
<g id="edge2787" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M463122.95,-506.57C463530.87,-505.28 464409.73,-492.12 465146,-410 465176.35,-406.62 465208.35,-401.91 465239.47,-396.71"/>
<polygon fill="black" stroke="black" points="465240.26,-400.13 465249.54,-395.01 465239.09,-393.22 465240.26,-400.13"/>
</g>
<!-- layer_14_expert_7_ep_5 -->
<g id="node1517" class="node">
<title>layer_14_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="466262.83,-410 465828.82,-410 465717.17,-306 466151.18,-306 466262.83,-410"/>
<text text-anchor="middle" x="465990" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="465990" y="-361" font-family="Arial" font-size="10.00">GPU: 471</text>
<text text-anchor="middle" x="465990" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="465990" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_5&#45;&gt;layer_14_expert_7_ep_5 -->
<g id="edge2788" class="edge">
<title>layer_14_route_ep_5&#45;&gt;layer_14_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M463114.05,-498.66C463488.59,-486.15 464273.98,-459.83 464938,-437 465280.67,-425.22 465368.09,-446.71 465709,-410 465739.36,-406.73 465771.37,-402.08 465802.49,-396.91"/>
<polygon fill="black" stroke="black" points="465803.28,-400.33 465812.56,-395.21 465802.12,-393.42 465803.28,-400.33"/>
</g>
<!-- layer_14_expert_0_ep_6 -->
<g id="node1518" class="node">
<title>layer_14_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="453313.83,-410 452879.82,-410 452768.17,-306 453202.18,-306 453313.83,-410"/>
<text text-anchor="middle" x="453041" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="453041" y="-361" font-family="Arial" font-size="10.00">GPU: 480</text>
<text text-anchor="middle" x="453041" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="453041" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_0_ep_6 -->
<g id="edge2789" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M453547.12,-455C453473.69,-441.07 453393.97,-425.95 453319.99,-411.92"/>
<polygon fill="black" stroke="black" points="453320.54,-408.46 453310.06,-410.04 453319.24,-415.34 453320.54,-408.46"/>
</g>
<!-- layer_14_expert_1_ep_6 -->
<g id="node1519" class="node">
<title>layer_14_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="453876.83,-410 453442.82,-410 453331.17,-306 453765.18,-306 453876.83,-410"/>
<text text-anchor="middle" x="453604" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="453604" y="-361" font-family="Arial" font-size="10.00">GPU: 481</text>
<text text-anchor="middle" x="453604" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="453604" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_1_ep_6 -->
<g id="edge2790" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M453742.45,-455C453724.3,-442.41 453704.75,-428.86 453686.21,-416.01"/>
<polygon fill="black" stroke="black" points="453687.99,-412.98 453677.78,-410.16 453684,-418.73 453687.99,-412.98"/>
</g>
<!-- layer_14_expert_2_ep_6 -->
<g id="node1520" class="node">
<title>layer_14_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="454439.83,-410 454005.82,-410 453894.17,-306 454328.18,-306 454439.83,-410"/>
<text text-anchor="middle" x="454167" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="454167" y="-361" font-family="Arial" font-size="10.00">GPU: 482</text>
<text text-anchor="middle" x="454167" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="454167" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_2_ep_6 -->
<g id="edge2791" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M453937.78,-455C453969.41,-441.75 454003.61,-427.43 454035.7,-413.99"/>
<polygon fill="black" stroke="black" points="454037.27,-417.13 454045.14,-410.04 454034.56,-410.67 454037.27,-417.13"/>
</g>
<!-- layer_14_expert_3_ep_6 -->
<g id="node1521" class="node">
<title>layer_14_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="455002.83,-410 454568.82,-410 454457.17,-306 454891.18,-306 455002.83,-410"/>
<text text-anchor="middle" x="454730" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="454730" y="-361" font-family="Arial" font-size="10.00">GPU: 483</text>
<text text-anchor="middle" x="454730" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="454730" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_3_ep_6 -->
<g id="edge2792" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M454012.27,-477.73C454137.4,-459.34 454302.9,-434.33 454449,-410 454478.46,-405.09 454509.61,-399.67 454540.03,-394.25"/>
<polygon fill="black" stroke="black" points="454540.65,-397.7 454549.87,-392.49 454539.41,-390.81 454540.65,-397.7"/>
</g>
<!-- layer_14_expert_4_ep_6 -->
<g id="node1522" class="node">
<title>layer_14_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="455565.83,-410 455131.82,-410 455020.17,-306 455454.18,-306 455565.83,-410"/>
<text text-anchor="middle" x="455293" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="455293" y="-361" font-family="Arial" font-size="10.00">GPU: 484</text>
<text text-anchor="middle" x="455293" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="455293" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_4_ep_6 -->
<g id="edge2793" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M454032.19,-495.13C454272.26,-481.55 454670.93,-454.53 455012,-410 455042.06,-406.08 455073.78,-401.12 455104.67,-395.84"/>
<polygon fill="black" stroke="black" points="455105.4,-399.27 455114.66,-394.12 455104.21,-392.37 455105.4,-399.27"/>
</g>
<!-- layer_14_expert_5_ep_6 -->
<g id="node1523" class="node">
<title>layer_14_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="456128.83,-410 455694.82,-410 455583.17,-306 456017.18,-306 456128.83,-410"/>
<text text-anchor="middle" x="455856" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="455856" y="-361" font-family="Arial" font-size="10.00">GPU: 485</text>
<text text-anchor="middle" x="455856" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="455856" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_5_ep_6 -->
<g id="edge2794" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M454040.64,-502.72C454375.8,-495.79 455026.17,-474.52 455575,-410 455605.21,-406.45 455637.09,-401.67 455668.09,-396.45"/>
<polygon fill="black" stroke="black" points="455668.85,-399.88 455678.12,-394.75 455667.68,-392.97 455668.85,-399.88"/>
</g>
<!-- layer_14_expert_6_ep_6 -->
<g id="node1524" class="node">
<title>layer_14_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="456691.83,-410 456257.82,-410 456146.17,-306 456580.18,-306 456691.83,-410"/>
<text text-anchor="middle" x="456419" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="456419" y="-361" font-family="Arial" font-size="10.00">GPU: 486</text>
<text text-anchor="middle" x="456419" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="456419" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_6_ep_6 -->
<g id="edge2795" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M454038.47,-500.73C454537.87,-488.26 455735.74,-454.6 456138,-410 456168.35,-406.63 456200.36,-401.94 456231.47,-396.74"/>
<polygon fill="black" stroke="black" points="456232.26,-400.16 456241.54,-395.04 456231.1,-393.26 456232.26,-400.16"/>
</g>
<!-- layer_14_expert_7_ep_6 -->
<g id="node1525" class="node">
<title>layer_14_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="457254.83,-410 456820.82,-410 456709.17,-306 457143.18,-306 457254.83,-410"/>
<text text-anchor="middle" x="456982" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="456982" y="-361" font-family="Arial" font-size="10.00">GPU: 487</text>
<text text-anchor="middle" x="456982" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="456982" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_6&#45;&gt;layer_14_expert_7_ep_6 -->
<g id="edge2796" class="edge">
<title>layer_14_route_ep_6&#45;&gt;layer_14_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M454040.7,-502.78C454625.8,-493.7 456186.65,-464.94 456701,-410 456731.36,-406.76 456763.38,-402.12 456794.5,-396.95"/>
<polygon fill="black" stroke="black" points="456795.28,-400.37 456804.56,-395.26 456794.12,-393.47 456795.28,-400.37"/>
</g>
<!-- layer_14_expert_0_ep_7 -->
<g id="node1526" class="node">
<title>layer_14_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="439801.83,-410 439367.82,-410 439256.17,-306 439690.18,-306 439801.83,-410"/>
<text text-anchor="middle" x="439529" y="-372" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="439529" y="-361" font-family="Arial" font-size="10.00">GPU: 496</text>
<text text-anchor="middle" x="439529" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="439529" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_0_ep_7 -->
<g id="edge2797" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M442326.06,-498.01C441947.53,-485.36 441188.59,-459.81 440545,-437 440221.67,-425.54 440136.71,-444.87 439811.28,-410.1"/>
<polygon fill="black" stroke="black" points="439811.4,-406.59 439801.08,-409 439810.65,-413.55 439811.4,-406.59"/>
</g>
<!-- layer_14_expert_1_ep_7 -->
<g id="node1527" class="node">
<title>layer_14_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="440364.83,-410 439930.82,-410 439819.17,-306 440253.18,-306 440364.83,-410"/>
<text text-anchor="middle" x="440092" y="-372" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="440092" y="-361" font-family="Arial" font-size="10.00">GPU: 497</text>
<text text-anchor="middle" x="440092" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="440092" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_1_ep_7 -->
<g id="edge2798" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M442335.52,-506.18C441936.93,-504.21 441093.34,-490.01 440373.76,-410.05"/>
<polygon fill="black" stroke="black" points="440374.04,-406.56 440363.71,-408.92 440373.26,-413.51 440374.04,-406.56"/>
</g>
<!-- layer_14_expert_2_ep_7 -->
<g id="node1528" class="node">
<title>layer_14_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="440927.83,-410 440493.82,-410 440382.17,-306 440816.18,-306 440927.83,-410"/>
<text text-anchor="middle" x="440655" y="-372" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="440655" y="-361" font-family="Arial" font-size="10.00">GPU: 498</text>
<text text-anchor="middle" x="440655" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="440655" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_2_ep_7 -->
<g id="edge2799" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M442329.69,-501.02C442013.99,-492.34 441437.29,-469.42 440936.68,-410.04"/>
<polygon fill="black" stroke="black" points="440937.06,-406.57 440926.72,-408.86 440936.24,-413.52 440937.06,-406.57"/>
</g>
<!-- layer_14_expert_3_ep_7 -->
<g id="node1529" class="node">
<title>layer_14_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="441490.83,-410 441056.82,-410 440945.17,-306 441379.18,-306 441490.83,-410"/>
<text text-anchor="middle" x="441218" y="-372" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="441218" y="-361" font-family="Arial" font-size="10.00">GPU: 499</text>
<text text-anchor="middle" x="441218" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="441218" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_3_ep_7 -->
<g id="edge2800" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M442317.08,-489.96C442102.92,-474.66 441785.65,-448.43 441499.89,-410.09"/>
<polygon fill="black" stroke="black" points="441500.12,-406.59 441489.74,-408.72 441499.18,-413.53 441500.12,-406.59"/>
</g>
<!-- layer_14_expert_4_ep_7 -->
<g id="node1530" class="node">
<title>layer_14_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="442053.83,-410 441619.82,-410 441508.17,-306 441942.18,-306 442053.83,-410"/>
<text text-anchor="middle" x="441781" y="-372" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="441781" y="-361" font-family="Arial" font-size="10.00">GPU: 500</text>
<text text-anchor="middle" x="441781" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="441781" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_4_ep_7 -->
<g id="edge2801" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M442293.65,-455C442219.27,-441.07 442138.52,-425.95 442063.59,-411.92"/>
<polygon fill="black" stroke="black" points="442064.01,-408.44 442053.53,-410.04 442062.72,-415.32 442064.01,-408.44"/>
</g>
<!-- layer_14_expert_5_ep_7 -->
<g id="node1531" class="node">
<title>layer_14_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="442616.83,-410 442182.82,-410 442071.17,-306 442505.18,-306 442616.83,-410"/>
<text text-anchor="middle" x="442344" y="-372" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="442344" y="-361" font-family="Arial" font-size="10.00">GPU: 501</text>
<text text-anchor="middle" x="442344" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="442344" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_5_ep_7 -->
<g id="edge2802" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M442488.98,-455C442469.89,-442.36 442449.31,-428.73 442429.83,-415.83"/>
<polygon fill="black" stroke="black" points="442431.53,-412.76 442421.26,-410.16 442427.67,-418.6 442431.53,-412.76"/>
</g>
<!-- layer_14_expert_6_ep_7 -->
<g id="node1532" class="node">
<title>layer_14_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="443179.83,-410 442745.82,-410 442634.17,-306 443068.18,-306 443179.83,-410"/>
<text text-anchor="middle" x="442907" y="-372" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="442907" y="-361" font-family="Arial" font-size="10.00">GPU: 502</text>
<text text-anchor="middle" x="442907" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="442907" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_6_ep_7 -->
<g id="edge2803" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M442684.31,-455C442714.9,-441.81 442747.98,-427.55 442779.04,-414.16"/>
<polygon fill="black" stroke="black" points="442780.81,-417.21 442788.61,-410.04 442778.04,-410.78 442780.81,-417.21"/>
</g>
<!-- layer_14_expert_7_ep_7 -->
<g id="node1533" class="node">
<title>layer_14_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="443742.83,-410 443308.82,-410 443197.17,-306 443631.18,-306 443742.83,-410"/>
<text text-anchor="middle" x="443470" y="-372" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="443470" y="-361" font-family="Arial" font-size="10.00">GPU: 503</text>
<text text-anchor="middle" x="443470" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="443470" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_14_route_ep_7&#45;&gt;layer_14_expert_7_ep_7 -->
<g id="edge2804" class="edge">
<title>layer_14_route_ep_7&#45;&gt;layer_14_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M442761.93,-477.18C442884.74,-458.77 443046.27,-433.95 443189,-410 443218.45,-405.06 443249.6,-399.62 443280.02,-394.19"/>
<polygon fill="black" stroke="black" points="443280.64,-397.64 443289.86,-392.43 443279.4,-390.74 443280.64,-397.64"/>
</g>
<!-- layer_14_agg_ep_0 -->
<g id="node1534" class="node">
<title>layer_14_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="460080.07,-269 459629.77,-269 459513.93,-165 459964.23,-165 460080.07,-269"/>
<text text-anchor="middle" x="459797" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="459797" y="-220" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="459797" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="459797" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2805" class="edge">
<title>layer_14_expert_0_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M457717.37,-316.09C457753.1,-308.94 457790.63,-302.4 457826,-298 458156.43,-256.9 459122.09,-232.08 459567.31,-222.52"/>
<polygon fill="black" stroke="black" points="459567.48,-226.02 459577.4,-222.31 459567.33,-219.02 459567.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2806" class="edge">
<title>layer_14_expert_1_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M458280.8,-316.46C458316.41,-309.31 458353.79,-302.67 458389,-298 458800.77,-243.39 459285.14,-226.03 459565.05,-220.53"/>
<polygon fill="black" stroke="black" points="459565.4,-224.02 459575.33,-220.33 459565.26,-217.02 459565.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2807" class="edge">
<title>layer_14_expert_2_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M458844.7,-317.34C458880.07,-310.17 458917.13,-303.29 458952,-298 459163.23,-265.93 459406.24,-244.53 459577.27,-231.99"/>
<polygon fill="black" stroke="black" points="459577.69,-235.47 459587.41,-231.25 459577.18,-228.49 459577.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2808" class="edge">
<title>layer_14_expert_3_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M459404.83,-314.82C459470.06,-298.72 459544.72,-280.29 459611.27,-263.86"/>
<polygon fill="black" stroke="black" points="459612.15,-267.24 459621.02,-261.45 459610.48,-260.45 459612.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2809" class="edge">
<title>layer_14_expert_4_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M459797,-305.64C459797,-297.08 459797,-288.12 459797,-279.34"/>
<polygon fill="black" stroke="black" points="459800.5,-279.15 459797,-269.15 459793.5,-279.15 459800.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2810" class="edge">
<title>layer_14_expert_5_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M460153.16,-305.93C460107.62,-294.69 460059.27,-282.75 460013.37,-271.42"/>
<polygon fill="black" stroke="black" points="460014.16,-268.01 460003.61,-269.01 460012.48,-274.81 460014.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2811" class="edge">
<title>layer_14_expert_6_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M460689.92,-305.97C460673.74,-303.07 460657.65,-300.38 460642,-298 460444.52,-268.02 460219.26,-247.36 460051.01,-234.55"/>
<polygon fill="black" stroke="black" points="460051.26,-231.06 460041.02,-233.8 460050.73,-238.04 460051.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_0&#45;&gt;layer_14_agg_ep_0 -->
<g id="edge2812" class="edge">
<title>layer_14_expert_7_ep_0&#45;&gt;layer_14_agg_ep_0</title>
<path fill="none" stroke="black" d="M461256.84,-305.94C461239.35,-302.94 461221.92,-300.24 461205,-298 460796.97,-243.88 460317.66,-226.34 460036.64,-220.68"/>
<polygon fill="black" stroke="black" points="460036.38,-217.17 460026.32,-220.47 460036.24,-224.17 460036.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_1 -->
<g id="node1535" class="node">
<title>layer_14_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="451072.07,-269 450621.77,-269 450505.93,-165 450956.23,-165 451072.07,-269"/>
<text text-anchor="middle" x="450789" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="450789" y="-220" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="450789" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="450789" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2814" class="edge">
<title>layer_14_expert_0_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M448709.37,-316.09C448745.1,-308.94 448782.63,-302.4 448818,-298 449148.43,-256.9 450114.09,-232.08 450559.31,-222.52"/>
<polygon fill="black" stroke="black" points="450559.48,-226.02 450569.4,-222.31 450559.33,-219.02 450559.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2815" class="edge">
<title>layer_14_expert_1_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M449272.8,-316.46C449308.41,-309.31 449345.79,-302.67 449381,-298 449792.77,-243.39 450277.14,-226.03 450557.05,-220.53"/>
<polygon fill="black" stroke="black" points="450557.4,-224.02 450567.33,-220.33 450557.26,-217.02 450557.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2816" class="edge">
<title>layer_14_expert_2_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M449836.7,-317.34C449872.07,-310.17 449909.13,-303.29 449944,-298 450155.23,-265.93 450398.24,-244.53 450569.27,-231.99"/>
<polygon fill="black" stroke="black" points="450569.69,-235.47 450579.41,-231.25 450569.18,-228.49 450569.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2817" class="edge">
<title>layer_14_expert_3_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M450396.83,-314.82C450462.06,-298.72 450536.72,-280.29 450603.27,-263.86"/>
<polygon fill="black" stroke="black" points="450604.15,-267.24 450613.02,-261.45 450602.48,-260.45 450604.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2818" class="edge">
<title>layer_14_expert_4_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M450789,-305.64C450789,-297.08 450789,-288.12 450789,-279.34"/>
<polygon fill="black" stroke="black" points="450792.5,-279.15 450789,-269.15 450785.5,-279.15 450792.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2819" class="edge">
<title>layer_14_expert_5_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M451145.16,-305.93C451099.62,-294.69 451051.27,-282.75 451005.37,-271.42"/>
<polygon fill="black" stroke="black" points="451006.16,-268.01 450995.61,-269.01 451004.48,-274.81 451006.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2820" class="edge">
<title>layer_14_expert_6_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M451681.92,-305.97C451665.74,-303.07 451649.65,-300.38 451634,-298 451436.52,-268.02 451211.26,-247.36 451043.01,-234.55"/>
<polygon fill="black" stroke="black" points="451043.26,-231.06 451033.02,-233.8 451042.73,-238.04 451043.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_1&#45;&gt;layer_14_agg_ep_1 -->
<g id="edge2821" class="edge">
<title>layer_14_expert_7_ep_1&#45;&gt;layer_14_agg_ep_1</title>
<path fill="none" stroke="black" d="M452248.84,-305.94C452231.35,-302.94 452213.92,-300.24 452197,-298 451788.97,-243.88 451309.66,-226.34 451028.64,-220.68"/>
<polygon fill="black" stroke="black" points="451028.38,-217.17 451018.32,-220.47 451028.24,-224.17 451028.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_2 -->
<g id="node1536" class="node">
<title>layer_14_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="469088.07,-269 468637.77,-269 468521.93,-165 468972.23,-165 469088.07,-269"/>
<text text-anchor="middle" x="468805" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="468805" y="-220" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="468805" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="468805" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2823" class="edge">
<title>layer_14_expert_0_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M466725.37,-316.09C466761.1,-308.94 466798.63,-302.4 466834,-298 467164.43,-256.9 468130.09,-232.08 468575.31,-222.52"/>
<polygon fill="black" stroke="black" points="468575.48,-226.02 468585.4,-222.31 468575.33,-219.02 468575.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2824" class="edge">
<title>layer_14_expert_1_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M467288.8,-316.46C467324.41,-309.31 467361.79,-302.67 467397,-298 467808.77,-243.39 468293.14,-226.03 468573.05,-220.53"/>
<polygon fill="black" stroke="black" points="468573.4,-224.02 468583.33,-220.33 468573.26,-217.02 468573.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2825" class="edge">
<title>layer_14_expert_2_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M467852.7,-317.34C467888.07,-310.17 467925.13,-303.29 467960,-298 468171.23,-265.93 468414.24,-244.53 468585.27,-231.99"/>
<polygon fill="black" stroke="black" points="468585.69,-235.47 468595.41,-231.25 468585.18,-228.49 468585.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2826" class="edge">
<title>layer_14_expert_3_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M468412.83,-314.82C468478.06,-298.72 468552.72,-280.29 468619.27,-263.86"/>
<polygon fill="black" stroke="black" points="468620.15,-267.24 468629.02,-261.45 468618.48,-260.45 468620.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2827" class="edge">
<title>layer_14_expert_4_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M468805,-305.64C468805,-297.08 468805,-288.12 468805,-279.34"/>
<polygon fill="black" stroke="black" points="468808.5,-279.15 468805,-269.15 468801.5,-279.15 468808.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2828" class="edge">
<title>layer_14_expert_5_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M469161.16,-305.93C469115.62,-294.69 469067.27,-282.75 469021.37,-271.42"/>
<polygon fill="black" stroke="black" points="469022.16,-268.01 469011.61,-269.01 469020.48,-274.81 469022.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2829" class="edge">
<title>layer_14_expert_6_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M469697.92,-305.97C469681.74,-303.07 469665.65,-300.38 469650,-298 469452.52,-268.02 469227.26,-247.36 469059.01,-234.55"/>
<polygon fill="black" stroke="black" points="469059.26,-231.06 469049.02,-233.8 469058.73,-238.04 469059.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_2&#45;&gt;layer_14_agg_ep_2 -->
<g id="edge2830" class="edge">
<title>layer_14_expert_7_ep_2&#45;&gt;layer_14_agg_ep_2</title>
<path fill="none" stroke="black" d="M470264.84,-305.94C470247.35,-302.94 470229.92,-300.24 470213,-298 469804.97,-243.88 469325.66,-226.34 469044.64,-220.68"/>
<polygon fill="black" stroke="black" points="469044.38,-217.17 469034.32,-220.47 469044.24,-224.17 469044.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_3 -->
<g id="node1537" class="node">
<title>layer_14_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="437560.07,-269 437109.77,-269 436993.93,-165 437444.23,-165 437560.07,-269"/>
<text text-anchor="middle" x="437277" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="437277" y="-220" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="437277" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="437277" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2832" class="edge">
<title>layer_14_expert_0_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M435197.37,-316.09C435233.1,-308.94 435270.63,-302.4 435306,-298 435636.43,-256.9 436602.09,-232.08 437047.31,-222.52"/>
<polygon fill="black" stroke="black" points="437047.48,-226.02 437057.4,-222.31 437047.33,-219.02 437047.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2833" class="edge">
<title>layer_14_expert_1_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M435760.8,-316.46C435796.41,-309.31 435833.79,-302.67 435869,-298 436280.77,-243.39 436765.14,-226.03 437045.05,-220.53"/>
<polygon fill="black" stroke="black" points="437045.4,-224.02 437055.33,-220.33 437045.26,-217.02 437045.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2834" class="edge">
<title>layer_14_expert_2_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M436324.7,-317.34C436360.07,-310.17 436397.13,-303.29 436432,-298 436643.23,-265.93 436886.24,-244.53 437057.27,-231.99"/>
<polygon fill="black" stroke="black" points="437057.69,-235.47 437067.41,-231.25 437057.18,-228.49 437057.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2835" class="edge">
<title>layer_14_expert_3_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M436884.83,-314.82C436950.06,-298.72 437024.72,-280.29 437091.27,-263.86"/>
<polygon fill="black" stroke="black" points="437092.15,-267.24 437101.02,-261.45 437090.48,-260.45 437092.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2836" class="edge">
<title>layer_14_expert_4_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M437277,-305.64C437277,-297.08 437277,-288.12 437277,-279.34"/>
<polygon fill="black" stroke="black" points="437280.5,-279.15 437277,-269.15 437273.5,-279.15 437280.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2837" class="edge">
<title>layer_14_expert_5_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M437633.16,-305.93C437587.62,-294.69 437539.27,-282.75 437493.37,-271.42"/>
<polygon fill="black" stroke="black" points="437494.16,-268.01 437483.61,-269.01 437492.48,-274.81 437494.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2838" class="edge">
<title>layer_14_expert_6_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M438169.92,-305.97C438153.74,-303.07 438137.65,-300.38 438122,-298 437924.52,-268.02 437699.26,-247.36 437531.01,-234.55"/>
<polygon fill="black" stroke="black" points="437531.26,-231.06 437521.02,-233.8 437530.73,-238.04 437531.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_3&#45;&gt;layer_14_agg_ep_3 -->
<g id="edge2839" class="edge">
<title>layer_14_expert_7_ep_3&#45;&gt;layer_14_agg_ep_3</title>
<path fill="none" stroke="black" d="M438736.84,-305.94C438719.35,-302.94 438701.92,-300.24 438685,-298 438276.97,-243.88 437797.66,-226.34 437516.64,-220.68"/>
<polygon fill="black" stroke="black" points="437516.38,-217.17 437506.32,-220.47 437516.24,-224.17 437516.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_4 -->
<g id="node1538" class="node">
<title>layer_14_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="446568.07,-269 446117.77,-269 446001.93,-165 446452.23,-165 446568.07,-269"/>
<text text-anchor="middle" x="446285" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="446285" y="-220" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="446285" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="446285" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2841" class="edge">
<title>layer_14_expert_0_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M444205.37,-316.09C444241.1,-308.94 444278.63,-302.4 444314,-298 444644.43,-256.9 445610.09,-232.08 446055.31,-222.52"/>
<polygon fill="black" stroke="black" points="446055.48,-226.02 446065.4,-222.31 446055.33,-219.02 446055.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2842" class="edge">
<title>layer_14_expert_1_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M444768.8,-316.46C444804.41,-309.31 444841.79,-302.67 444877,-298 445288.77,-243.39 445773.14,-226.03 446053.05,-220.53"/>
<polygon fill="black" stroke="black" points="446053.4,-224.02 446063.33,-220.33 446053.26,-217.02 446053.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2843" class="edge">
<title>layer_14_expert_2_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M445332.7,-317.34C445368.07,-310.17 445405.13,-303.29 445440,-298 445651.23,-265.93 445894.24,-244.53 446065.27,-231.99"/>
<polygon fill="black" stroke="black" points="446065.69,-235.47 446075.41,-231.25 446065.18,-228.49 446065.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2844" class="edge">
<title>layer_14_expert_3_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M445892.83,-314.82C445958.06,-298.72 446032.72,-280.29 446099.27,-263.86"/>
<polygon fill="black" stroke="black" points="446100.15,-267.24 446109.02,-261.45 446098.48,-260.45 446100.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2845" class="edge">
<title>layer_14_expert_4_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M446285,-305.64C446285,-297.08 446285,-288.12 446285,-279.34"/>
<polygon fill="black" stroke="black" points="446288.5,-279.15 446285,-269.15 446281.5,-279.15 446288.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2846" class="edge">
<title>layer_14_expert_5_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M446641.16,-305.93C446595.62,-294.69 446547.27,-282.75 446501.37,-271.42"/>
<polygon fill="black" stroke="black" points="446502.16,-268.01 446491.61,-269.01 446500.48,-274.81 446502.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2847" class="edge">
<title>layer_14_expert_6_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M447177.92,-305.97C447161.74,-303.07 447145.65,-300.38 447130,-298 446932.52,-268.02 446707.26,-247.36 446539.01,-234.55"/>
<polygon fill="black" stroke="black" points="446539.26,-231.06 446529.02,-233.8 446538.73,-238.04 446539.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_4&#45;&gt;layer_14_agg_ep_4 -->
<g id="edge2848" class="edge">
<title>layer_14_expert_7_ep_4&#45;&gt;layer_14_agg_ep_4</title>
<path fill="none" stroke="black" d="M447744.84,-305.94C447727.35,-302.94 447709.92,-300.24 447693,-298 447284.97,-243.88 446805.66,-226.34 446524.64,-220.68"/>
<polygon fill="black" stroke="black" points="446524.38,-217.17 446514.32,-220.47 446524.24,-224.17 446524.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_5 -->
<g id="node1539" class="node">
<title>layer_14_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="464584.07,-269 464133.77,-269 464017.93,-165 464468.23,-165 464584.07,-269"/>
<text text-anchor="middle" x="464301" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="464301" y="-220" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="464301" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="464301" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2850" class="edge">
<title>layer_14_expert_0_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M462221.37,-316.09C462257.1,-308.94 462294.63,-302.4 462330,-298 462660.43,-256.9 463626.09,-232.08 464071.31,-222.52"/>
<polygon fill="black" stroke="black" points="464071.48,-226.02 464081.4,-222.31 464071.33,-219.02 464071.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2851" class="edge">
<title>layer_14_expert_1_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M462784.8,-316.46C462820.41,-309.31 462857.79,-302.67 462893,-298 463304.77,-243.39 463789.14,-226.03 464069.05,-220.53"/>
<polygon fill="black" stroke="black" points="464069.4,-224.02 464079.33,-220.33 464069.26,-217.02 464069.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2852" class="edge">
<title>layer_14_expert_2_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M463348.7,-317.34C463384.07,-310.17 463421.13,-303.29 463456,-298 463667.23,-265.93 463910.24,-244.53 464081.27,-231.99"/>
<polygon fill="black" stroke="black" points="464081.69,-235.47 464091.41,-231.25 464081.18,-228.49 464081.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2853" class="edge">
<title>layer_14_expert_3_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M463908.83,-314.82C463974.06,-298.72 464048.72,-280.29 464115.27,-263.86"/>
<polygon fill="black" stroke="black" points="464116.15,-267.24 464125.02,-261.45 464114.48,-260.45 464116.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2854" class="edge">
<title>layer_14_expert_4_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M464301,-305.64C464301,-297.08 464301,-288.12 464301,-279.34"/>
<polygon fill="black" stroke="black" points="464304.5,-279.15 464301,-269.15 464297.5,-279.15 464304.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2855" class="edge">
<title>layer_14_expert_5_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M464657.16,-305.93C464611.62,-294.69 464563.27,-282.75 464517.37,-271.42"/>
<polygon fill="black" stroke="black" points="464518.16,-268.01 464507.61,-269.01 464516.48,-274.81 464518.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2856" class="edge">
<title>layer_14_expert_6_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M465193.92,-305.97C465177.74,-303.07 465161.65,-300.38 465146,-298 464948.52,-268.02 464723.26,-247.36 464555.01,-234.55"/>
<polygon fill="black" stroke="black" points="464555.26,-231.06 464545.02,-233.8 464554.73,-238.04 464555.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_5&#45;&gt;layer_14_agg_ep_5 -->
<g id="edge2857" class="edge">
<title>layer_14_expert_7_ep_5&#45;&gt;layer_14_agg_ep_5</title>
<path fill="none" stroke="black" d="M465760.84,-305.94C465743.35,-302.94 465725.92,-300.24 465709,-298 465300.97,-243.88 464821.66,-226.34 464540.64,-220.68"/>
<polygon fill="black" stroke="black" points="464540.38,-217.17 464530.32,-220.47 464540.24,-224.17 464540.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_6 -->
<g id="node1540" class="node">
<title>layer_14_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="455576.07,-269 455125.77,-269 455009.93,-165 455460.23,-165 455576.07,-269"/>
<text text-anchor="middle" x="455293" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="455293" y="-220" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="455293" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="455293" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2859" class="edge">
<title>layer_14_expert_0_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M453213.37,-316.09C453249.1,-308.94 453286.63,-302.4 453322,-298 453652.43,-256.9 454618.09,-232.08 455063.31,-222.52"/>
<polygon fill="black" stroke="black" points="455063.48,-226.02 455073.4,-222.31 455063.33,-219.02 455063.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2860" class="edge">
<title>layer_14_expert_1_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M453776.8,-316.46C453812.41,-309.31 453849.79,-302.67 453885,-298 454296.77,-243.39 454781.14,-226.03 455061.05,-220.53"/>
<polygon fill="black" stroke="black" points="455061.4,-224.02 455071.33,-220.33 455061.26,-217.02 455061.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2861" class="edge">
<title>layer_14_expert_2_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M454340.7,-317.34C454376.07,-310.17 454413.13,-303.29 454448,-298 454659.23,-265.93 454902.24,-244.53 455073.27,-231.99"/>
<polygon fill="black" stroke="black" points="455073.69,-235.47 455083.41,-231.25 455073.18,-228.49 455073.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2862" class="edge">
<title>layer_14_expert_3_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M454900.83,-314.82C454966.06,-298.72 455040.72,-280.29 455107.27,-263.86"/>
<polygon fill="black" stroke="black" points="455108.15,-267.24 455117.02,-261.45 455106.48,-260.45 455108.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2863" class="edge">
<title>layer_14_expert_4_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M455293,-305.64C455293,-297.08 455293,-288.12 455293,-279.34"/>
<polygon fill="black" stroke="black" points="455296.5,-279.15 455293,-269.15 455289.5,-279.15 455296.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2864" class="edge">
<title>layer_14_expert_5_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M455649.16,-305.93C455603.62,-294.69 455555.27,-282.75 455509.37,-271.42"/>
<polygon fill="black" stroke="black" points="455510.16,-268.01 455499.61,-269.01 455508.48,-274.81 455510.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2865" class="edge">
<title>layer_14_expert_6_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M456185.92,-305.97C456169.74,-303.07 456153.65,-300.38 456138,-298 455940.52,-268.02 455715.26,-247.36 455547.01,-234.55"/>
<polygon fill="black" stroke="black" points="455547.26,-231.06 455537.02,-233.8 455546.73,-238.04 455547.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_6&#45;&gt;layer_14_agg_ep_6 -->
<g id="edge2866" class="edge">
<title>layer_14_expert_7_ep_6&#45;&gt;layer_14_agg_ep_6</title>
<path fill="none" stroke="black" d="M456752.84,-305.94C456735.35,-302.94 456717.92,-300.24 456701,-298 456292.97,-243.88 455813.66,-226.34 455532.64,-220.68"/>
<polygon fill="black" stroke="black" points="455532.38,-217.17 455522.32,-220.47 455532.24,-224.17 455532.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_7 -->
<g id="node1541" class="node">
<title>layer_14_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="442064.07,-269 441613.77,-269 441497.93,-165 441948.23,-165 442064.07,-269"/>
<text text-anchor="middle" x="441781" y="-231" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="441781" y="-220" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="441781" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="441781" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_expert_0_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2868" class="edge">
<title>layer_14_expert_0_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M439701.37,-316.09C439737.1,-308.94 439774.63,-302.4 439810,-298 440140.43,-256.9 441106.09,-232.08 441551.31,-222.52"/>
<polygon fill="black" stroke="black" points="441551.48,-226.02 441561.4,-222.31 441551.33,-219.02 441551.48,-226.02"/>
</g>
<!-- layer_14_expert_1_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2869" class="edge">
<title>layer_14_expert_1_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M440264.8,-316.46C440300.41,-309.31 440337.79,-302.67 440373,-298 440784.77,-243.39 441269.14,-226.03 441549.05,-220.53"/>
<polygon fill="black" stroke="black" points="441549.4,-224.02 441559.33,-220.33 441549.26,-217.02 441549.4,-224.02"/>
</g>
<!-- layer_14_expert_2_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2870" class="edge">
<title>layer_14_expert_2_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M440828.7,-317.34C440864.07,-310.17 440901.13,-303.29 440936,-298 441147.23,-265.93 441390.24,-244.53 441561.27,-231.99"/>
<polygon fill="black" stroke="black" points="441561.69,-235.47 441571.41,-231.25 441561.18,-228.49 441561.69,-235.47"/>
</g>
<!-- layer_14_expert_3_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2871" class="edge">
<title>layer_14_expert_3_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M441388.83,-314.82C441454.06,-298.72 441528.72,-280.29 441595.27,-263.86"/>
<polygon fill="black" stroke="black" points="441596.15,-267.24 441605.02,-261.45 441594.48,-260.45 441596.15,-267.24"/>
</g>
<!-- layer_14_expert_4_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2872" class="edge">
<title>layer_14_expert_4_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M441781,-305.64C441781,-297.08 441781,-288.12 441781,-279.34"/>
<polygon fill="black" stroke="black" points="441784.5,-279.15 441781,-269.15 441777.5,-279.15 441784.5,-279.15"/>
</g>
<!-- layer_14_expert_5_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2873" class="edge">
<title>layer_14_expert_5_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M442137.16,-305.93C442091.62,-294.69 442043.27,-282.75 441997.37,-271.42"/>
<polygon fill="black" stroke="black" points="441998.16,-268.01 441987.61,-269.01 441996.48,-274.81 441998.16,-268.01"/>
</g>
<!-- layer_14_expert_6_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2874" class="edge">
<title>layer_14_expert_6_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M442673.92,-305.97C442657.74,-303.07 442641.65,-300.38 442626,-298 442428.52,-268.02 442203.26,-247.36 442035.01,-234.55"/>
<polygon fill="black" stroke="black" points="442035.26,-231.06 442025.02,-233.8 442034.73,-238.04 442035.26,-231.06"/>
</g>
<!-- layer_14_expert_7_ep_7&#45;&gt;layer_14_agg_ep_7 -->
<g id="edge2875" class="edge">
<title>layer_14_expert_7_ep_7&#45;&gt;layer_14_agg_ep_7</title>
<path fill="none" stroke="black" d="M443240.84,-305.94C443223.35,-302.94 443205.92,-300.24 443189,-298 442780.97,-243.88 442301.66,-226.34 442020.64,-220.68"/>
<polygon fill="black" stroke="black" points="442020.38,-217.17 442010.32,-220.47 442020.24,-224.17 442020.38,-217.17"/>
</g>
<!-- layer_14_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2813" class="edge">
<title>layer_14_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M460027.76,-221.91C460663.69,-235.17 462495.21,-271.51 464018,-283.5 466395.2,-302.22 504431.72,-284.59 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2822" class="edge">
<title>layer_14_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M451019.76,-221.91C451655.69,-235.17 453487.21,-271.51 455010,-283.5 457887.63,-306.17 503931.28,-284.82 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2831" class="edge">
<title>layer_14_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M469041.88,-227.51C469413.7,-243.43 470157.07,-272.92 470788,-283.5 471788.44,-300.27 505808.42,-283.96 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2840" class="edge">
<title>layer_14_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M437507.76,-221.91C438143.69,-235.17 439975.21,-271.51 441498,-283.5 445126.28,-312.08 503180.61,-285.17 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2849" class="edge">
<title>layer_14_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M446515.76,-221.91C447151.69,-235.17 448983.21,-271.51 450506,-283.5 453633.85,-308.14 503681.06,-284.94 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2858" class="edge">
<title>layer_14_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M464531.76,-221.91C465167.69,-235.17 466999.21,-271.51 468522,-283.5 470648.99,-300.25 504681.94,-284.48 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2867" class="edge">
<title>layer_14_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M455523.76,-221.91C456159.69,-235.17 457991.21,-271.51 459514,-283.5 462141.42,-304.2 504181.5,-284.71 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge2876" class="edge">
<title>layer_14_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M442011.76,-221.91C442647.69,-235.17 444479.21,-271.51 446002,-283.5 449380.06,-310.11 503430.83,-285.06 506809,-283.5 537948.22,-269.16 576639.74,-220.06 578922.93,-217.14"/>
<polygon fill="black" stroke="black" points="578923.15,-220.64 578933.15,-217.12 578923.14,-213.64 578923.15,-220.64"/>
</g>
<!-- layer_14_moe_alltoall -->
<g id="node1542" class="node">
<title>layer_14_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="443103" cy="-677" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="443103" y="-691" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="443103" y="-680" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="443103" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="443103" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_14_ln_tp_0 -->
<g id="node1543" class="node">
<title>layer_14_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="466315.07,-729 465864.77,-729 465748.93,-625 466199.23,-625 466315.07,-729"/>
<text text-anchor="middle" x="466032" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="466032" y="-680" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="466032" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="466032" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_qkv_tp_0 -->
<g id="node1547" class="node">
<title>layer_15_qkv_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="502343.7,-559 501901.94,-559 501788.3,-455 502230.06,-455 502343.7,-559"/>
<text text-anchor="middle" x="502066" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="502066" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="502066" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="502066" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_14_ln_tp_0&#45;&gt;layer_15_qkv_tp_0 -->
<g id="edge3133" class="edge">
<title>layer_14_ln_tp_0&#45;&gt;layer_15_qkv_tp_0</title>
<path fill="none" stroke="black" d="M466215.17,-639.06C466251.11,-633.22 466288.63,-628.09 466324,-625 466918.16,-573.13 487198.58,-598.55 487795,-598 487843.56,-597.96 501731.92,-596.77 501780,-590 501822.03,-584.08 501866.54,-573.52 501907.61,-561.9"/>
<polygon fill="black" stroke="black" points="501908.77,-565.2 501917.41,-559.08 501906.84,-558.47 501908.77,-565.2"/>
</g>
<!-- layer_14_ln_tp_1 -->
<g id="node1544" class="node">
<title>layer_14_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="468067.07,-729 467616.77,-729 467500.93,-625 467951.23,-625 468067.07,-729"/>
<text text-anchor="middle" x="467784" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="467784" y="-680" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="467784" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="467784" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_qkv_tp_1 -->
<g id="node1548" class="node">
<title>layer_15_qkv_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="504065.7,-559 503623.94,-559 503510.3,-455 503952.06,-455 504065.7,-559"/>
<text text-anchor="middle" x="503788" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="503788" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="503788" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="503788" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_14_ln_tp_1&#45;&gt;layer_15_qkv_tp_1 -->
<g id="edge3134" class="edge">
<title>layer_14_ln_tp_1&#45;&gt;layer_15_qkv_tp_1</title>
<path fill="none" stroke="black" d="M467967.17,-639.05C468003.11,-633.21 468040.63,-628.08 468076,-625 468566.16,-582.27 503013.78,-658.48 503501,-590 503543.16,-584.07 503587.82,-573.5 503629.04,-561.88"/>
<polygon fill="black" stroke="black" points="503630.23,-565.18 503638.88,-559.07 503628.3,-558.45 503630.23,-565.18"/>
</g>
<!-- layer_14_ln_tp_2 -->
<g id="node1545" class="node">
<title>layer_14_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="466899.07,-729 466448.77,-729 466332.93,-625 466783.23,-625 466899.07,-729"/>
<text text-anchor="middle" x="466616" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="466616" y="-680" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="466616" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="466616" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_qkv_tp_2 -->
<g id="node1549" class="node">
<title>layer_15_qkv_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="502917.7,-559 502475.94,-559 502362.3,-455 502804.06,-455 502917.7,-559"/>
<text text-anchor="middle" x="502640" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="502640" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="502640" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="502640" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_14_ln_tp_2&#45;&gt;layer_15_qkv_tp_2 -->
<g id="edge3135" class="edge">
<title>layer_14_ln_tp_2&#45;&gt;layer_15_qkv_tp_2</title>
<path fill="none" stroke="black" d="M466799.17,-639.05C466835.11,-633.21 466872.63,-628.08 466908,-625 466969.3,-619.66 502292.06,-598.57 502353,-590 502395.16,-584.07 502439.82,-573.5 502481.04,-561.88"/>
<polygon fill="black" stroke="black" points="502482.23,-565.18 502490.88,-559.07 502480.3,-558.45 502482.23,-565.18"/>
</g>
<!-- layer_14_ln_tp_3 -->
<g id="node1546" class="node">
<title>layer_14_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="467483.07,-729 467032.77,-729 466916.93,-625 467367.23,-625 467483.07,-729"/>
<text text-anchor="middle" x="467200" y="-691" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="467200" y="-680" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="467200" y="-669" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="467200" y="-658" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_qkv_tp_3 -->
<g id="node1550" class="node">
<title>layer_15_qkv_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="503491.7,-559 503049.94,-559 502936.3,-455 503378.06,-455 503491.7,-559"/>
<text text-anchor="middle" x="503214" y="-521" font-family="Arial" font-size="10.00">QKV Projection (TP)</text>
<text text-anchor="middle" x="503214" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="503214" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="503214" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_14_ln_tp_3&#45;&gt;layer_15_qkv_tp_3 -->
<g id="edge3136" class="edge">
<title>layer_14_ln_tp_3&#45;&gt;layer_15_qkv_tp_3</title>
<path fill="none" stroke="black" d="M467383.17,-639.05C467419.11,-633.21 467456.63,-628.08 467492,-625 467737.15,-603.63 502683.32,-624.25 502927,-590 502969.16,-584.07 503013.82,-573.5 503055.04,-561.88"/>
<polygon fill="black" stroke="black" points="503056.23,-565.18 503064.88,-559.07 503054.3,-558.45 503056.23,-565.18"/>
</g>
<!-- layer_15_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2885" class="edge">
<title>layer_15_qkv_tp_0&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M502240.43,-464.33C502277.39,-457.14 502316.31,-450.77 502353,-447 502368.63,-445.39 506866.9,-448.12 506878,-437 506880.83,-434.17 506880.83,-430.83 506878,-428 506878,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_15_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2886" class="edge">
<title>layer_15_qkv_tp_1&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M503962.44,-464.37C503999.39,-457.17 504038.32,-450.8 504075,-447 504094.67,-444.96 506909.04,-451.01 506923,-437 506925.82,-434.17 506925.83,-430.83 506923,-428 506923,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_15_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2887" class="edge">
<title>layer_15_qkv_tp_2&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M502814.44,-464.34C502851.39,-457.15 502890.31,-450.78 502927,-447 502940.7,-445.59 506883.27,-446.75 506893,-437 506895.82,-434.17 506895.83,-430.83 506893,-428 506893,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_15_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm -->
<g id="edge2888" class="edge">
<title>layer_15_qkv_tp_3&#45;&gt;layer_{layer_id}_qkv_comm</title>
<path fill="none" stroke="black" d="M503388.44,-464.35C503425.39,-457.16 503464.32,-450.79 503501,-447 503512.77,-445.79 506899.65,-445.38 506908,-437 506910.82,-434.17 506910.83,-430.83 506908,-428 506908,-428 145859,-410 145859,-410 145690.07,-402.91 145495.39,-384.78 145373.01,-372.17"/>
<polygon fill="black" stroke="black" points="145373.17,-368.67 145362.87,-371.12 145372.45,-375.63 145373.17,-368.67"/>
</g>
<!-- layer_15_qkv_comm -->
<g id="node1551" class="node">
<title>layer_15_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="504277" cy="-507" rx="193.08" ry="36.54"/>
<text text-anchor="middle" x="504277" y="-521" font-family="Arial" font-size="10.00">QKV AllGather</text>
<text text-anchor="middle" x="504277" y="-510" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="504277" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=768]</text>
<text text-anchor="middle" x="504277" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=768]</text>
</g>
<!-- layer_15_attn_tp_0 -->
<g id="node1552" class="node">
<title>layer_15_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="499637.7,-559 499195.94,-559 499082.3,-455 499524.06,-455 499637.7,-559"/>
<text text-anchor="middle" x="499360" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="499360" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="499360" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="499360" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_out_tp_0 -->
<g id="node1556" class="node">
<title>layer_15_attn_out_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="504583.7,-410 504141.94,-410 504028.3,-306 504470.06,-306 504583.7,-410"/>
<text text-anchor="middle" x="504306" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="504306" y="-361" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="504306" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="504306" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_tp_0&#45;&gt;layer_15_attn_out_tp_0 -->
<g id="edge2893" class="edge">
<title>layer_15_attn_tp_0&#45;&gt;layer_15_attn_out_tp_0</title>
<path fill="none" stroke="black" d="M499534.45,-464.44C499571.4,-457.25 499610.32,-450.85 499647,-447 499736.46,-437.62 501176.06,-437.82 501266,-437 501760.02,-432.47 502995.31,-428.4 503489,-410 503694.18,-402.35 503927.98,-387.1 504092.75,-375.25"/>
<polygon fill="black" stroke="black" points="504093.29,-378.72 504103.01,-374.51 504092.79,-371.74 504093.29,-378.72"/>
</g>
<!-- layer_15_attn_tp_1 -->
<g id="node1553" class="node">
<title>layer_15_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="500211.7,-559 499769.94,-559 499656.3,-455 500098.06,-455 500211.7,-559"/>
<text text-anchor="middle" x="499934" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="499934" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="499934" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="499934" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_out_tp_1 -->
<g id="node1557" class="node">
<title>layer_15_attn_out_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="505422.7,-410 504980.94,-410 504867.3,-306 505309.06,-306 505422.7,-410"/>
<text text-anchor="middle" x="505145" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="505145" y="-361" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="505145" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="505145" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_tp_1&#45;&gt;layer_15_attn_out_tp_1 -->
<g id="edge2895" class="edge">
<title>layer_15_attn_tp_1&#45;&gt;layer_15_attn_out_tp_1</title>
<path fill="none" stroke="black" d="M500108.45,-464.44C500145.4,-457.24 500184.32,-450.84 500221,-447 500311.12,-437.55 501761.39,-437.72 501852,-437 501928.14,-436.39 504516.96,-413.88 504593,-410 504707.76,-404.14 504835.55,-392.66 504939.25,-382.06"/>
<polygon fill="black" stroke="black" points="504939.62,-385.54 504949.21,-381.04 504938.9,-378.58 504939.62,-385.54"/>
</g>
<!-- layer_15_attn_tp_2 -->
<g id="node1554" class="node">
<title>layer_15_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="500785.7,-559 500343.94,-559 500230.3,-455 500672.06,-455 500785.7,-559"/>
<text text-anchor="middle" x="500508" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="500508" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="500508" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="500508" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_out_tp_2 -->
<g id="node1558" class="node">
<title>layer_15_attn_out_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="506128.7,-410 505686.94,-410 505573.3,-306 506015.06,-306 506128.7,-410"/>
<text text-anchor="middle" x="505851" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="505851" y="-361" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="505851" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="505851" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_tp_2&#45;&gt;layer_15_attn_out_tp_2 -->
<g id="edge2897" class="edge">
<title>layer_15_attn_tp_2&#45;&gt;layer_15_attn_out_tp_2</title>
<path fill="none" stroke="black" d="M500682.45,-464.45C500719.4,-457.25 500758.32,-450.85 500795,-447 500880.59,-438.01 502257.95,-437.82 502344,-437 502661.34,-433.98 502740.66,-431.2 503058,-428 503321.77,-425.34 505168.76,-426.96 505432,-410 505503.7,-405.38 505581.95,-396.82 505651.2,-388.01"/>
<polygon fill="black" stroke="black" points="505651.88,-391.45 505661.36,-386.71 505650.99,-384.51 505651.88,-391.45"/>
</g>
<!-- layer_15_attn_tp_3 -->
<g id="node1555" class="node">
<title>layer_15_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="501359.7,-559 500917.94,-559 500804.3,-455 501246.06,-455 501359.7,-559"/>
<text text-anchor="middle" x="501082" y="-521" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="501082" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="501082" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=192]</text>
<text text-anchor="middle" x="501082" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_out_tp_3 -->
<g id="node1559" class="node">
<title>layer_15_attn_out_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="506768.7,-410 506326.94,-410 506213.3,-306 506655.06,-306 506768.7,-410"/>
<text text-anchor="middle" x="506491" y="-372" font-family="Arial" font-size="10.00">Attention Output (TP)</text>
<text text-anchor="middle" x="506491" y="-361" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="506491" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="506491" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=256]</text>
</g>
<!-- layer_15_attn_tp_3&#45;&gt;layer_15_attn_out_tp_3 -->
<g id="edge2899" class="edge">
<title>layer_15_attn_tp_3&#45;&gt;layer_15_attn_out_tp_3</title>
<path fill="none" stroke="black" d="M501256.6,-464.33C501293.2,-457.19 501331.7,-450.84 501368,-447 501441.92,-439.18 502631.67,-437.57 502706,-437 503468.67,-431.15 505377.49,-467.66 506138,-410 506189.23,-406.12 506244.33,-399.39 506295.41,-392.08"/>
<polygon fill="black" stroke="black" points="506296.18,-395.5 506305.57,-390.61 506295.17,-388.58 506296.18,-395.5"/>
</g>
<!-- layer_15_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2894" class="edge">
<title>layer_15_attn_out_tp_0&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M504559.17,-387.3C504652.92,-396.48 504760.18,-405.47 504858,-410 504922.2,-412.98 578850.57,-401.54 578896,-447 578940.93,-491.95 578940.94,-545.06 578896,-590 578896,-590 145576,-598 145576,-598 145563.09,-600.02 145560.82,-604.45 145548,-607 145452.22,-626.07 145425.48,-609.88 145329,-625 145279.44,-632.76 145224.46,-645.58 145181.99,-656.43"/>
<polygon fill="black" stroke="black" points="145181.11,-653.04 145172.3,-658.92 145182.85,-659.82 145181.11,-653.04"/>
</g>
<!-- layer_15_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2896" class="edge">
<title>layer_15_attn_out_tp_1&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M505407.46,-395.88C505459.24,-401.76 505513.26,-406.92 505564,-410 505805.8,-424.69 575089.75,-427.33 575332,-428 575381.92,-428.14 578890.8,-411.61 578926,-447 578970.82,-492.06 578970.94,-545.06 578926,-590 578926,-590 145623,-598 145623,-598 145600.51,-600.01 145595.4,-604.17 145573,-607 145465.12,-620.65 145436.5,-608.62 145329,-625 145279.23,-632.58 145224.03,-645.47 145181.5,-656.39"/>
<polygon fill="black" stroke="black" points="145180.61,-653.01 145171.8,-658.9 145182.36,-659.78 145180.61,-653.01"/>
</g>
<!-- layer_15_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2898" class="edge">
<title>layer_15_attn_out_tp_2&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M506119.91,-401.92C506148.24,-405.22 506176.67,-408.03 506204,-410 506449.41,-427.67 576818.96,-426.73 577065,-428 579807.21,-442.12 579212.22,-333.77 578956,-590 578956,-590 145673,-598 145673,-598 145645.67,-600.01 145639.25,-604.13 145612,-607 145486.66,-620.21 145453.69,-606.64 145329,-625 145278.84,-632.38 145223.2,-645.4 145180.56,-656.44"/>
<polygon fill="black" stroke="black" points="145179.63,-653.06 145170.84,-658.98 145181.4,-659.84 145179.63,-653.06"/>
</g>
<!-- layer_15_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce -->
<g id="edge2900" class="edge">
<title>layer_15_attn_out_tp_3&#45;&gt;layer_{layer_id}_attn_allreduce</title>
<path fill="none" stroke="black" d="M506763.18,-404.69C506781.69,-406.8 506800.1,-408.61 506818,-410 507064.91,-429.17 577895.36,-425.46 578143,-428 578195.01,-428.53 579042.6,-409.85 579079,-447 579123.48,-492.39 579123.94,-545.06 579079,-590 579079,-590 145723,-598 145723,-598 145693.02,-600 145685.91,-604.17 145656,-607 145511.09,-620.7 145473.09,-604.42 145329,-625 145278.63,-632.2 145222.77,-645.29 145180.08,-656.4"/>
<polygon fill="black" stroke="black" points="145179.13,-653.03 145170.35,-658.96 145180.91,-659.8 145179.13,-653.03"/>
</g>
<!-- layer_15_attn_allreduce -->
<g id="node1560" class="node">
<title>layer_15_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="501574" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="501574" y="-521" font-family="Arial" font-size="10.00">Attention AllReduce</text>
<text text-anchor="middle" x="501574" y="-510" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="501574" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=256]</text>
<text text-anchor="middle" x="501574" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_gate_tp_0 -->
<g id="node1561" class="node">
<title>layer_15_gate_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="485622.99,-559 485174.4,-559 485059.01,-455 485507.6,-455 485622.99,-559"/>
<text text-anchor="middle" x="485341" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="485341" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="485341" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="485341" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_15_route_ep_0 -->
<g id="node1565" class="node">
<title>layer_15_route_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="490213.43,-410 489754.6,-410 489636.57,-306 490095.4,-306 490213.43,-410"/>
<text text-anchor="middle" x="489925" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="489925" y="-361" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="489925" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="489925" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_0 -->
<g id="edge2901" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485518.71,-464.64C485555.95,-457.48 485595.11,-451.04 485632,-447 485692.87,-440.33 486123.38,-450.98 486183,-437 486192.1,-434.87 486192.9,-430.13 486202,-428 486287.06,-408.04 488884.49,-372.57 489689.5,-362.03"/>
<polygon fill="black" stroke="black" points="489689.81,-365.53 489699.77,-361.9 489689.72,-358.53 489689.81,-365.53"/>
<text text-anchor="middle" x="486228" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_1 -->
<g id="node1566" class="node">
<title>layer_15_route_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="486622.43,-410 486163.6,-410 486045.57,-306 486504.4,-306 486622.43,-410"/>
<text text-anchor="middle" x="486334" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="486334" y="-361" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="486334" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="486334" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_1 -->
<g id="edge2902" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485460.29,-454.97C485488.9,-444.5 485519.66,-434.66 485549,-428 485730.95,-386.7 485941.83,-369.82 486099.17,-363.06"/>
<polygon fill="black" stroke="black" points="486099.61,-366.55 486109.46,-362.63 486099.32,-359.55 486099.61,-366.55"/>
<text text-anchor="middle" x="485575" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_2 -->
<g id="node1567" class="node">
<title>layer_15_route_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="478883.43,-410 478424.6,-410 478306.57,-306 478765.4,-306 478883.43,-410"/>
<text text-anchor="middle" x="478595" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="478595" y="-361" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="478595" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="478595" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_2 -->
<g id="edge2903" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485114.19,-504.92C484202.85,-500.31 480805.16,-480.52 479730,-437 479431.87,-424.93 479090.36,-399.95 478860.49,-381.49"/>
<polygon fill="black" stroke="black" points="478860.56,-377.98 478850.31,-380.67 478860,-384.96 478860.56,-377.98"/>
<text text-anchor="middle" x="479756" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_3 -->
<g id="node1568" class="node">
<title>layer_15_route_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="494717.43,-410 494258.6,-410 494140.57,-306 494599.4,-306 494717.43,-410"/>
<text text-anchor="middle" x="494429" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="494429" y="-361" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="494429" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="494429" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_3 -->
<g id="edge2904" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485518.31,-464.53C485555.66,-457.35 485594.96,-450.94 485632,-447 485726.03,-437.01 486389.67,-452.19 486483,-437 486495.9,-434.9 486498.09,-430.06 486511,-428 486612.8,-411.79 490118.92,-410.87 490222,-410 491735.82,-397.15 493555.92,-371.68 494194.16,-362.45"/>
<polygon fill="black" stroke="black" points="494194.45,-365.94 494204.4,-362.3 494194.35,-358.94 494194.45,-365.94"/>
<text text-anchor="middle" x="486537" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_4 -->
<g id="node1569" class="node">
<title>layer_15_route_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="499007.43,-410 498548.6,-410 498430.57,-306 498889.4,-306 499007.43,-410"/>
<text text-anchor="middle" x="498719" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="498719" y="-361" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="498719" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="498719" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_4 -->
<g id="edge2905" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485518.28,-464.29C485555.63,-457.13 485594.95,-450.78 485632,-447 485715.32,-438.5 488563.25,-437.42 488647,-437 489236.34,-434.02 489383.66,-431.12 489973,-428 492085.43,-416.83 492613.61,-427.49 494726,-410 496153.64,-398.18 497868.26,-372.37 498484.35,-362.73"/>
<polygon fill="black" stroke="black" points="498484.74,-366.23 498494.68,-362.57 498484.63,-359.23 498484.74,-366.23"/>
<text text-anchor="middle" x="489999" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_5 -->
<g id="node1570" class="node">
<title>layer_15_route_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="503480.43,-410 503021.6,-410 502903.57,-306 503362.4,-306 503480.43,-410"/>
<text text-anchor="middle" x="503192" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="503192" y="-361" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="503192" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="503192" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_5 -->
<g id="edge2906" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485518.27,-464.23C485555.63,-457.08 485594.94,-450.75 485632,-447 485728,-437.3 492482.55,-439.7 492579,-437 492652.41,-434.95 492670.59,-430.11 492744,-428 493440.61,-408.02 498319.13,-415.26 499016,-410 500517.55,-398.68 502322.65,-372.3 502957.47,-362.63"/>
<polygon fill="black" stroke="black" points="502957.7,-366.13 502967.65,-362.48 502957.59,-359.13 502957.7,-366.13"/>
<text text-anchor="middle" x="492770" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_6 -->
<g id="node1571" class="node">
<title>layer_15_route_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="474449.43,-410 473990.6,-410 473872.57,-306 474331.4,-306 474449.43,-410"/>
<text text-anchor="middle" x="474161" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="474161" y="-361" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="474161" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="474161" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_6 -->
<g id="edge2907" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485112.64,-503.54C484329.19,-495.06 481678.07,-465.94 479488,-437 477528.13,-411.1 475162.74,-374.63 474406.17,-362.84"/>
<polygon fill="black" stroke="black" points="474406.02,-359.34 474395.97,-362.68 474405.91,-366.34 474406.02,-359.34"/>
<text text-anchor="middle" x="479514" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_route_ep_7 -->
<g id="node1572" class="node">
<title>layer_15_route_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="483457.43,-410 482998.6,-410 482880.57,-306 483339.4,-306 483457.43,-410"/>
<text text-anchor="middle" x="483169" y="-372" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="483169" y="-361" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="483169" y="-350" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_ids=2]</text>
<text text-anchor="middle" x="483169" y="-339" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, routed_tokens=512]</text>
</g>
<!-- layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_7 -->
<g id="edge2908" class="edge">
<title>layer_15_gate_tp_0&#45;&gt;layer_15_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485097.12,-489.49C484684.47,-461.57 483852.26,-405.24 483428.98,-376.6"/>
<polygon fill="black" stroke="black" points="483428.96,-373.09 483418.75,-375.9 483428.49,-380.07 483428.96,-373.09"/>
<text text-anchor="middle" x="484346" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1 -->
<g id="node1562" class="node">
<title>layer_15_gate_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="486204.99,-559 485756.4,-559 485641.01,-455 486089.6,-455 486204.99,-559"/>
<text text-anchor="middle" x="485923" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="485923" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="485923" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="485923" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_0 -->
<g id="edge2909" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486100.75,-464.93C486137.98,-457.75 486177.13,-451.23 486214,-447 486218.61,-446.47 486877.36,-428.12 486882,-428 487930.25,-401.21 489181.75,-374.49 489691.6,-363.83"/>
<polygon fill="black" stroke="black" points="489691.73,-367.33 489701.65,-363.62 489691.58,-360.33 489691.73,-367.33"/>
<text text-anchor="middle" x="486908" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_1 -->
<g id="edge2910" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486105.5,-468.98C486182.93,-453.17 486256.05,-438.06 486258,-437 486267.65,-431.72 486276.84,-424.81 486285.28,-417.28"/>
<polygon fill="black" stroke="black" points="486287.91,-419.62 486292.81,-410.23 486283.12,-414.51 486287.91,-419.62"/>
<text text-anchor="middle" x="486296" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_2 -->
<g id="edge2911" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485690.91,-454.96C485671.05,-451.81 485651.22,-449.08 485632,-447 485562.62,-439.51 484445.78,-428.94 484376,-428 484340.85,-427.52 479934.8,-374.98 478839.39,-361.91"/>
<polygon fill="black" stroke="black" points="478839.06,-358.41 478829.02,-361.79 478838.98,-365.41 478839.06,-358.41"/>
<text text-anchor="middle" x="485171" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_3 -->
<g id="edge2912" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486100.28,-464.27C486137.63,-457.11 486176.95,-450.77 486214,-447 486319.43,-436.28 489923.03,-438.08 490029,-437 491622.74,-420.79 493540.84,-379.2 494196.35,-364.36"/>
<polygon fill="black" stroke="black" points="494196.46,-367.86 494206.38,-364.13 494196.3,-360.86 494196.46,-367.86"/>
<text text-anchor="middle" x="490775" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_4 -->
<g id="edge2913" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486100.28,-464.24C486137.63,-457.08 486176.94,-450.75 486214,-447 486305.01,-437.8 492708.56,-439.25 492800,-437 492884.07,-434.94 492904.94,-430.44 492989,-428 493760.72,-405.63 493954.01,-418.93 494726,-410 496153.16,-393.49 497867.21,-370.55 498483.79,-362.2"/>
<polygon fill="black" stroke="black" points="498484.18,-365.7 498494.13,-362.06 498484.08,-358.7 498484.18,-365.7"/>
<text text-anchor="middle" x="493015" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_5 -->
<g id="edge2914" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486100.27,-464.23C486137.63,-457.07 486176.94,-450.74 486214,-447 486319.64,-436.33 493752.82,-437.38 493859,-437 494535.45,-434.56 494704.55,-431.67 495381,-428 496996.55,-419.22 497400.48,-423.86 499016,-410 500517.31,-397.12 502322.1,-371.71 502957.18,-362.47"/>
<polygon fill="black" stroke="black" points="502957.42,-365.96 502967.36,-362.32 502957.31,-358.96 502957.42,-365.96"/>
<text text-anchor="middle" x="495407" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_6 -->
<g id="edge2915" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485692.52,-454.97C485672.13,-451.76 485651.74,-449.02 485632,-447 485556.12,-439.25 482962.28,-437.36 482886,-437 480846.88,-427.29 480337.06,-428.57 478298,-410 476820.32,-396.54 475045.84,-371.78 474405.96,-362.57"/>
<polygon fill="black" stroke="black" points="474405.74,-359.07 474395.69,-362.42 474405.64,-366.07 474405.74,-359.07"/>
<text text-anchor="middle" x="482912" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_7 -->
<g id="edge2916" class="edge">
<title>layer_15_gate_tp_1&#45;&gt;layer_15_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M485691.26,-454.95C485669.11,-449.23 485647.07,-443.22 485626,-437 485614.67,-433.66 485612.6,-430.2 485601,-428 485390.51,-388.18 483986.39,-368.14 483412.6,-361.54"/>
<polygon fill="black" stroke="black" points="483412.58,-358.04 483402.55,-361.42 483412.5,-365.04 483412.58,-358.04"/>
<text text-anchor="middle" x="485652" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2 -->
<g id="node1563" class="node">
<title>layer_15_gate_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="486786.99,-559 486338.4,-559 486223.01,-455 486671.6,-455 486786.99,-559"/>
<text text-anchor="middle" x="486505" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="486505" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="486505" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="486505" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_0 -->
<g id="edge2917" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486682.74,-464.92C486719.98,-457.74 486759.13,-451.22 486796,-447 487355.25,-382.92 489058.41,-364.93 489687.88,-360.39"/>
<polygon fill="black" stroke="black" points="489688.01,-363.89 489697.98,-360.32 489687.96,-356.89 489688.01,-363.89"/>
<text text-anchor="middle" x="487019" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_1 -->
<g id="edge2918" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486374.63,-454.84C486367.84,-449.44 486361.55,-443.51 486356,-437 486351.58,-431.82 486348.05,-425.81 486345.23,-419.48"/>
<polygon fill="black" stroke="black" points="486348.44,-418.08 486341.57,-410.01 486341.91,-420.6 486348.44,-418.08"/>
<text text-anchor="middle" x="486382" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_2 -->
<g id="edge2919" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486273.31,-454.95C486253.32,-451.78 486233.35,-449.05 486214,-447 486117.2,-436.73 485435.27,-440.75 485338,-437 485277.03,-434.65 485261.98,-430.24 485201,-428 484683.78,-409.03 483389.55,-415.09 482872,-410 481337.26,-394.92 479492.81,-370.95 478839.14,-362.27"/>
<polygon fill="black" stroke="black" points="478839.17,-358.77 478829.13,-362.14 478839.08,-365.77 478839.17,-358.77"/>
<text text-anchor="middle" x="485364" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_3 -->
<g id="edge2920" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486682.28,-464.25C486719.63,-457.1 486758.95,-450.76 486796,-447 486925.09,-433.91 491337.26,-438.85 491467,-437 492485.82,-422.5 493701.27,-383.74 494199.16,-366.95"/>
<polygon fill="black" stroke="black" points="494199.46,-370.44 494209.34,-366.6 494199.23,-363.44 494199.46,-370.44"/>
<text text-anchor="middle" x="491977" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_4 -->
<g id="edge2921" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486682.28,-464.24C486719.63,-457.08 486758.95,-450.75 486796,-447 486968.7,-429.53 492871.58,-444.63 493045,-437 493091.35,-434.96 493102.66,-430.27 493149,-428 493499.05,-410.88 494375.56,-414.24 494726,-410 496152.94,-392.74 497866.69,-370.27 498483.51,-362.12"/>
<polygon fill="black" stroke="black" points="498483.9,-365.61 498493.85,-361.98 498483.81,-358.62 498483.9,-365.61"/>
<text text-anchor="middle" x="493175" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_5 -->
<g id="edge2922" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486682.27,-464.23C486719.63,-457.07 486758.94,-450.74 486796,-447 486915.41,-434.95 495316.99,-437.52 495437,-437 497027.7,-430.08 497425.37,-425.71 499016,-410 500517.07,-395.17 502321.56,-370.97 502956.89,-362.26"/>
<polygon fill="black" stroke="black" points="502957.13,-365.75 502967.08,-362.12 502957.03,-358.75 502957.13,-365.75"/>
<text text-anchor="middle" x="497073" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_6 -->
<g id="edge2923" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486274.52,-454.97C486254.13,-451.76 486233.74,-449.02 486214,-447 486137.59,-439.19 483525.8,-437.82 483449,-437 483221.87,-434.59 483165.13,-430.44 482938,-428 480875.88,-405.84 480360.17,-426.71 478298,-410 476820.3,-398.03 475045.84,-372.36 474405.96,-362.74"/>
<polygon fill="black" stroke="black" points="474405.74,-359.24 474395.69,-362.59 474405.63,-366.24 474405.74,-359.24"/>
<text text-anchor="middle" x="483475" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_7 -->
<g id="edge2924" class="edge">
<title>layer_15_gate_tp_2&#45;&gt;layer_15_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486272.5,-454.99C486252.78,-451.84 486233.09,-449.1 486214,-447 486100.89,-434.53 485813.77,-458.4 485702,-437 485690.81,-434.86 485689.18,-430.19 485678,-428 485460.11,-385.39 483999.04,-366.89 483412.25,-361.12"/>
<polygon fill="black" stroke="black" points="483412,-357.62 483401.96,-361.02 483411.93,-364.62 483412,-357.62"/>
<text text-anchor="middle" x="485728" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3 -->
<g id="node1564" class="node">
<title>layer_15_gate_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="487368.99,-559 486920.4,-559 486805.01,-455 487253.6,-455 487368.99,-559"/>
<text text-anchor="middle" x="487087" y="-521" font-family="Arial" font-size="10.00">Gate Computation</text>
<text text-anchor="middle" x="487087" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="487087" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="487087" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, expert_scores=64]</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_0 -->
<g id="edge2925" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M487298.28,-495.06C487819.46,-468.06 489162.92,-398.47 489699.11,-370.7"/>
<polygon fill="black" stroke="black" points="489699.48,-374.19 489709.28,-370.17 489699.12,-367.2 489699.48,-374.19"/>
<text text-anchor="middle" x="488617" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_1 -->
<g id="edge2926" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486853.29,-454.96C486833.97,-451.86 486814.69,-449.13 486796,-447 486755.69,-442.4 486469.08,-451 486431,-437 486417.78,-432.14 486405,-424.7 486393.3,-416.3"/>
<polygon fill="black" stroke="black" points="486395.08,-413.26 486384.98,-410.05 486390.87,-418.85 486395.08,-413.26"/>
<text text-anchor="middle" x="486457" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_2 -->
<g id="edge2927" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486856.11,-454.99C486835.86,-451.79 486815.61,-449.04 486796,-447 486648.68,-431.66 485610.8,-446.63 485463,-437 485430.38,-434.87 485422.62,-430.12 485390,-428 485110.8,-409.85 483151.77,-412.67 482872,-410 481337.48,-395.37 479493.36,-371.12 478839.43,-362.32"/>
<polygon fill="black" stroke="black" points="478839.47,-358.82 478829.42,-362.19 478839.37,-365.82 478839.47,-358.82"/>
<text text-anchor="middle" x="485489" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_3 -->
<g id="edge2928" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M487308.85,-504.76C488022.17,-500.38 490321.08,-483.39 492223,-437 492945.4,-419.38 493800.44,-385.4 494200.79,-368.72"/>
<polygon fill="black" stroke="black" points="494201.2,-372.2 494211.04,-368.29 494200.91,-365.21 494201.2,-372.2"/>
<text text-anchor="middle" x="492549" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_4 -->
<g id="edge2929" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M487307.86,-503.74C488103.62,-495.54 490898.84,-466.32 493205,-437 495250.35,-411 497722.38,-374.07 498484.2,-362.56"/>
<polygon fill="black" stroke="black" points="498484.52,-366.06 498494.47,-362.41 498484.42,-359.06 498484.52,-366.06"/>
<text text-anchor="middle" x="493829" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_5 -->
<g id="edge2930" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M487307.11,-503.17C488089.48,-493.23 490809.18,-459.9 493054,-447 494441.53,-439.03 497910.52,-452.01 499298,-437 500688.07,-421.97 502356.86,-380.77 502960.19,-365.13"/>
<polygon fill="black" stroke="black" points="502960.4,-368.63 502970.3,-364.87 502960.22,-361.63 502960.4,-368.63"/>
<text text-anchor="middle" x="499961" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_6 -->
<g id="edge2931" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486856.52,-454.97C486836.13,-451.76 486815.74,-449.02 486796,-447 486722.41,-439.48 484206.97,-437.67 484133,-437 483852.09,-434.47 483781.91,-430.49 483501,-428 481188.63,-407.54 480610.39,-428.25 478298,-410 476820.3,-398.34 475045.84,-372.48 474405.95,-362.78"/>
<polygon fill="black" stroke="black" points="474405.74,-359.27 474395.69,-362.62 474405.63,-366.27 474405.74,-359.27"/>
<text text-anchor="middle" x="484159" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_7 -->
<g id="edge2932" class="edge">
<title>layer_15_gate_tp_3&#45;&gt;layer_15_route_ep_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M486854.91,-454.96C486835.05,-451.81 486815.22,-449.07 486796,-447 486649.06,-431.14 486278.76,-440.06 486131,-437 485863.97,-431.48 484080.83,-383.58 483417.2,-365.7"/>
<polygon fill="black" stroke="black" points="483417.12,-362.19 483407.03,-365.42 483416.94,-369.19 483417.12,-362.19"/>
<text text-anchor="middle" x="486157" y="-430.6" font-family="Arial" font-size="8.00">Gate Selection</text>
</g>
<!-- layer_15_expert_0_ep_0 -->
<g id="node1573" class="node">
<title>layer_15_expert_0_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="489352.83,-269 488918.82,-269 488807.17,-165 489241.18,-165 489352.83,-269"/>
<text text-anchor="middle" x="489080" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="489080" y="-220" font-family="Arial" font-size="10.00">GPU: 384</text>
<text text-anchor="middle" x="489080" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="489080" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_0_ep_0 -->
<g id="edge2933" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_0_ep_0</title>
<path fill="none" stroke="black" d="M489646.52,-314.95C489555.44,-300.82 489453.83,-284.66 489361,-269 489360.9,-268.98 489360.79,-268.97 489360.69,-268.95"/>
<polygon fill="black" stroke="black" points="489361.48,-265.53 489351.04,-267.31 489360.31,-272.43 489361.48,-265.53"/>
</g>
<!-- layer_15_expert_1_ep_0 -->
<g id="node1574" class="node">
<title>layer_15_expert_1_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="489915.83,-269 489481.82,-269 489370.17,-165 489804.18,-165 489915.83,-269"/>
<text text-anchor="middle" x="489643" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="489643" y="-220" font-family="Arial" font-size="10.00">GPU: 385</text>
<text text-anchor="middle" x="489643" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="489643" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_1_ep_0 -->
<g id="edge2934" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_1_ep_0</title>
<path fill="none" stroke="black" d="M489821.19,-305.83C489799.9,-295.34 489777.38,-284.24 489755.78,-273.59"/>
<polygon fill="black" stroke="black" points="489757.1,-270.34 489746.59,-269.06 489754.01,-276.62 489757.1,-270.34"/>
</g>
<!-- layer_15_expert_2_ep_0 -->
<g id="node1575" class="node">
<title>layer_15_expert_2_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="490478.83,-269 490044.82,-269 489933.17,-165 490367.18,-165 490478.83,-269"/>
<text text-anchor="middle" x="490206" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="490206" y="-220" font-family="Arial" font-size="10.00">GPU: 386</text>
<text text-anchor="middle" x="490206" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="490206" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_2_ep_0 -->
<g id="edge2935" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_2_ep_0</title>
<path fill="none" stroke="black" d="M490028.44,-305.83C490049.66,-295.34 490072.1,-284.24 490093.62,-273.59"/>
<polygon fill="black" stroke="black" points="490095.37,-276.63 490102.78,-269.06 490092.27,-270.35 490095.37,-276.63"/>
</g>
<!-- layer_15_expert_3_ep_0 -->
<g id="node1576" class="node">
<title>layer_15_expert_3_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="491041.83,-269 490607.82,-269 490496.17,-165 490930.18,-165 491041.83,-269"/>
<text text-anchor="middle" x="490769" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="490769" y="-220" font-family="Arial" font-size="10.00">GPU: 387</text>
<text text-anchor="middle" x="490769" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="490769" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_3_ep_0 -->
<g id="edge2936" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_3_ep_0</title>
<path fill="none" stroke="black" d="M490120.28,-327.68C490228.7,-311.1 490365.94,-289.61 490488,-269 490517.45,-264.03 490548.59,-258.57 490579.01,-253.13"/>
<polygon fill="black" stroke="black" points="490579.63,-256.58 490588.85,-251.37 490578.39,-249.69 490579.63,-256.58"/>
</g>
<!-- layer_15_expert_4_ep_0 -->
<g id="node1577" class="node">
<title>layer_15_expert_4_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="491604.83,-269 491170.82,-269 491059.17,-165 491493.18,-165 491604.83,-269"/>
<text text-anchor="middle" x="491332" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="491332" y="-220" font-family="Arial" font-size="10.00">GPU: 388</text>
<text text-anchor="middle" x="491332" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="491332" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_4_ep_0 -->
<g id="edge2937" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_4_ep_0</title>
<path fill="none" stroke="black" d="M490141.53,-346.62C490368.75,-334.2 490735.98,-309.79 491051,-269 491081.06,-265.11 491112.79,-260.17 491143.67,-254.9"/>
<polygon fill="black" stroke="black" points="491144.41,-258.32 491153.67,-253.18 491143.22,-251.42 491144.41,-258.32"/>
</g>
<!-- layer_15_expert_5_ep_0 -->
<g id="node1578" class="node">
<title>layer_15_expert_5_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="492167.83,-269 491733.82,-269 491622.17,-165 492056.18,-165 492167.83,-269"/>
<text text-anchor="middle" x="491895" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="491895" y="-220" font-family="Arial" font-size="10.00">GPU: 389</text>
<text text-anchor="middle" x="491895" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="491895" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_5_ep_0 -->
<g id="edge2938" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_5_ep_0</title>
<path fill="none" stroke="black" d="M490150.47,-354.37C490475.04,-348.53 491092.29,-329.68 491614,-269 491644.22,-265.48 491676.1,-260.73 491707.1,-255.52"/>
<polygon fill="black" stroke="black" points="491707.86,-258.94 491717.13,-253.81 491706.69,-252.04 491707.86,-258.94"/>
</g>
<!-- layer_15_expert_6_ep_0 -->
<g id="node1579" class="node">
<title>layer_15_expert_6_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="492730.83,-269 492296.82,-269 492185.17,-165 492619.18,-165 492730.83,-269"/>
<text text-anchor="middle" x="492458" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="492458" y="-220" font-family="Arial" font-size="10.00">GPU: 390</text>
<text text-anchor="middle" x="492458" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="492458" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_6_ep_0 -->
<g id="edge2939" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_6_ep_0</title>
<path fill="none" stroke="black" d="M490148.05,-352.27C490636.66,-341.27 491788.79,-311.6 492177,-269 492207.35,-265.67 492239.36,-260.99 492270.48,-255.8"/>
<polygon fill="black" stroke="black" points="492271.27,-259.22 492280.55,-254.1 492270.1,-252.32 492271.27,-259.22"/>
</g>
<!-- layer_15_expert_7_ep_0 -->
<g id="node1580" class="node">
<title>layer_15_expert_7_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="493293.83,-269 492859.82,-269 492748.17,-165 493182.18,-165 493293.83,-269"/>
<text text-anchor="middle" x="493021" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="493021" y="-220" font-family="Arial" font-size="10.00">GPU: 391</text>
<text text-anchor="middle" x="493021" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="493021" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_0&#45;&gt;layer_15_expert_7_ep_0 -->
<g id="edge2940" class="edge">
<title>layer_15_route_ep_0&#45;&gt;layer_15_expert_7_ep_0</title>
<path fill="none" stroke="black" d="M490150.24,-354.27C490725.73,-346.61 492239.86,-321.91 492740,-269 492770.48,-265.78 492802.62,-261.14 492833.84,-255.95"/>
<polygon fill="black" stroke="black" points="492834.67,-259.36 492843.95,-254.25 492833.5,-252.46 492834.67,-259.36"/>
</g>
<!-- layer_15_expert_0_ep_1 -->
<g id="node1581" class="node">
<title>layer_15_expert_0_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="484848.83,-269 484414.82,-269 484303.17,-165 484737.18,-165 484848.83,-269"/>
<text text-anchor="middle" x="484576" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="484576" y="-220" font-family="Arial" font-size="10.00">GPU: 400</text>
<text text-anchor="middle" x="484576" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="484576" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_0_ep_1 -->
<g id="edge2941" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_0_ep_1</title>
<path fill="none" stroke="black" d="M486097.24,-351.64C485807.09,-343.08 485300.55,-321.67 484857.84,-269.06"/>
<polygon fill="black" stroke="black" points="484858.07,-265.57 484847.72,-267.86 484857.23,-272.52 484858.07,-265.57"/>
</g>
<!-- layer_15_expert_1_ep_1 -->
<g id="node1582" class="node">
<title>layer_15_expert_1_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="485411.83,-269 484977.82,-269 484866.17,-165 485300.18,-165 485411.83,-269"/>
<text text-anchor="middle" x="485139" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="485139" y="-220" font-family="Arial" font-size="10.00">GPU: 401</text>
<text text-anchor="middle" x="485139" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="485139" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_1_ep_1 -->
<g id="edge2942" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_1_ep_1</title>
<path fill="none" stroke="black" d="M486082.15,-338.45C485900.9,-323.73 485650.5,-300.61 485420.96,-269.11"/>
<polygon fill="black" stroke="black" points="485421.13,-265.6 485410.74,-267.7 485420.17,-272.53 485421.13,-265.6"/>
</g>
<!-- layer_15_expert_2_ep_1 -->
<g id="node1583" class="node">
<title>layer_15_expert_2_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="485974.83,-269 485540.82,-269 485429.17,-165 485863.18,-165 485974.83,-269"/>
<text text-anchor="middle" x="485702" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="485702" y="-220" font-family="Arial" font-size="10.00">GPU: 402</text>
<text text-anchor="middle" x="485702" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="485702" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_2_ep_1 -->
<g id="edge2943" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_2_ep_1</title>
<path fill="none" stroke="black" d="M486101.81,-305.93C486050.37,-294.62 485995.73,-282.6 485943.92,-271.21"/>
<polygon fill="black" stroke="black" points="485944.45,-267.74 485933.93,-269.01 485942.95,-274.58 485944.45,-267.74"/>
</g>
<!-- layer_15_expert_3_ep_1 -->
<g id="node1584" class="node">
<title>layer_15_expert_3_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="486537.83,-269 486103.82,-269 485992.17,-165 486426.18,-165 486537.83,-269"/>
<text text-anchor="middle" x="486265" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="486265" y="-220" font-family="Arial" font-size="10.00">GPU: 403</text>
<text text-anchor="middle" x="486265" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="486265" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_3_ep_1 -->
<g id="edge2944" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_3_ep_1</title>
<path fill="none" stroke="black" d="M486308.5,-305.64C486304.07,-296.7 486299.42,-287.34 486294.88,-278.2"/>
<polygon fill="black" stroke="black" points="486297.97,-276.55 486290.39,-269.15 486291.7,-279.67 486297.97,-276.55"/>
</g>
<!-- layer_15_expert_4_ep_1 -->
<g id="node1585" class="node">
<title>layer_15_expert_4_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="487100.83,-269 486666.82,-269 486555.17,-165 486989.18,-165 487100.83,-269"/>
<text text-anchor="middle" x="486828" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="486828" y="-220" font-family="Arial" font-size="10.00">GPU: 404</text>
<text text-anchor="middle" x="486828" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="486828" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_4_ep_1 -->
<g id="edge2945" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_4_ep_1</title>
<path fill="none" stroke="black" d="M486507.12,-308.29C486554.09,-295.07 486604.98,-280.75 486652.1,-267.5"/>
<polygon fill="black" stroke="black" points="486653.1,-270.85 486661.78,-264.77 486651.2,-264.11 486653.1,-270.85"/>
</g>
<!-- layer_15_expert_5_ep_1 -->
<g id="node1586" class="node">
<title>layer_15_expert_5_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="487663.83,-269 487229.82,-269 487118.17,-165 487552.18,-165 487663.83,-269"/>
<text text-anchor="middle" x="487391" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="487391" y="-220" font-family="Arial" font-size="10.00">GPU: 405</text>
<text text-anchor="middle" x="487391" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="487391" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_5_ep_1 -->
<g id="edge2946" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_5_ep_1</title>
<path fill="none" stroke="black" d="M486540.35,-337.38C486696.99,-321.57 486917.51,-297.35 487110,-269 487139.77,-264.62 487171.21,-259.44 487201.86,-254.11"/>
<polygon fill="black" stroke="black" points="487202.54,-257.54 487211.78,-252.37 487201.33,-250.65 487202.54,-257.54"/>
</g>
<!-- layer_15_expert_6_ep_1 -->
<g id="node1587" class="node">
<title>layer_15_expert_6_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="488226.83,-269 487792.82,-269 487681.17,-165 488115.18,-165 488226.83,-269"/>
<text text-anchor="middle" x="487954" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="487954" y="-220" font-family="Arial" font-size="10.00">GPU: 406</text>
<text text-anchor="middle" x="487954" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="487954" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_6_ep_1 -->
<g id="edge2947" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_6_ep_1</title>
<path fill="none" stroke="black" d="M486554.78,-350.2C486820.81,-340.22 487280.94,-317.3 487673,-269 487703.19,-265.28 487735.06,-260.41 487766.06,-255.16"/>
<polygon fill="black" stroke="black" points="487766.82,-258.58 487776.09,-253.45 487765.64,-251.68 487766.82,-258.58"/>
</g>
<!-- layer_15_expert_7_ep_1 -->
<g id="node1588" class="node">
<title>layer_15_expert_7_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="488789.83,-269 488355.82,-269 488244.17,-165 488678.18,-165 488789.83,-269"/>
<text text-anchor="middle" x="488517" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="488517" y="-220" font-family="Arial" font-size="10.00">GPU: 407</text>
<text text-anchor="middle" x="488517" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="488517" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_1&#45;&gt;layer_15_expert_7_ep_1 -->
<g id="edge2948" class="edge">
<title>layer_15_route_ep_1&#45;&gt;layer_15_expert_7_ep_1</title>
<path fill="none" stroke="black" d="M486561.68,-356.25C486919.32,-352.87 487634.1,-337.24 488236,-269 488266.34,-265.56 488298.35,-260.82 488329.46,-255.61"/>
<polygon fill="black" stroke="black" points="488330.25,-259.03 488339.52,-253.91 488329.08,-252.13 488330.25,-259.03"/>
</g>
<!-- layer_15_expert_0_ep_2 -->
<g id="node1589" class="node">
<title>layer_15_expert_0_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="475840.83,-269 475406.82,-269 475295.17,-165 475729.18,-165 475840.83,-269"/>
<text text-anchor="middle" x="475568" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="475568" y="-220" font-family="Arial" font-size="10.00">GPU: 416</text>
<text text-anchor="middle" x="475568" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="475568" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_0_ep_2 -->
<g id="edge2949" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_0_ep_2</title>
<path fill="none" stroke="black" d="M478360.75,-353.94C477792.74,-345.8 476352.59,-320.71 475850.32,-269.09"/>
<polygon fill="black" stroke="black" points="475850.39,-265.58 475840.08,-268.02 475849.66,-272.54 475850.39,-265.58"/>
</g>
<!-- layer_15_expert_1_ep_2 -->
<g id="node1590" class="node">
<title>layer_15_expert_1_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="476403.83,-269 475969.82,-269 475858.17,-165 476292.18,-165 476403.83,-269"/>
<text text-anchor="middle" x="476131" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="476131" y="-220" font-family="Arial" font-size="10.00">GPU: 417</text>
<text text-anchor="middle" x="476131" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="476131" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_1_ep_2 -->
<g id="edge2950" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_1_ep_2</title>
<path fill="none" stroke="black" d="M478357.92,-351.62C477877.39,-340.03 476802,-310.46 476412.9,-269.04"/>
<polygon fill="black" stroke="black" points="476413.03,-265.54 476402.71,-267.94 476412.28,-272.5 476413.03,-265.54"/>
</g>
<!-- layer_15_expert_2_ep_2 -->
<g id="node1591" class="node">
<title>layer_15_expert_2_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="476966.83,-269 476532.82,-269 476421.17,-165 476855.18,-165 476966.83,-269"/>
<text text-anchor="middle" x="476694" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="476694" y="-220" font-family="Arial" font-size="10.00">GPU: 418</text>
<text text-anchor="middle" x="476694" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="476694" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_2_ep_2 -->
<g id="edge2951" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_2_ep_2</title>
<path fill="none" stroke="black" d="M478360.14,-353.46C478046.45,-346.64 477473.5,-326.89 476975.98,-269.08"/>
<polygon fill="black" stroke="black" points="476976.06,-265.56 476965.72,-267.88 476975.24,-272.52 476976.06,-265.56"/>
</g>
<!-- layer_15_expert_3_ep_2 -->
<g id="node1592" class="node">
<title>layer_15_expert_3_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="477529.83,-269 477095.82,-269 476984.17,-165 477418.18,-165 477529.83,-269"/>
<text text-anchor="middle" x="477257" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="477257" y="-220" font-family="Arial" font-size="10.00">GPU: 419</text>
<text text-anchor="middle" x="477257" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="477257" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_3_ep_2 -->
<g id="edge2952" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_3_ep_2</title>
<path fill="none" stroke="black" d="M478348.66,-343.24C478136.5,-329.8 477822.05,-306.09 477538.8,-269.07"/>
<polygon fill="black" stroke="black" points="477539.1,-265.58 477528.73,-267.75 477538.19,-272.52 477539.1,-265.58"/>
</g>
<!-- layer_15_expert_4_ep_2 -->
<g id="node1593" class="node">
<title>layer_15_expert_4_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="478092.83,-269 477658.82,-269 477547.17,-165 477981.18,-165 478092.83,-269"/>
<text text-anchor="middle" x="477820" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="477820" y="-220" font-family="Arial" font-size="10.00">GPU: 420</text>
<text text-anchor="middle" x="477820" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="477820" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_4_ep_2 -->
<g id="edge2953" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_4_ep_2</title>
<path fill="none" stroke="black" d="M478307.63,-305.97C478239.86,-293.89 478167.88,-281.03 478101,-269 478100.9,-268.98 478100.79,-268.96 478100.69,-268.94"/>
<polygon fill="black" stroke="black" points="478101.52,-265.54 478091.06,-267.21 478100.28,-272.43 478101.52,-265.54"/>
</g>
<!-- layer_15_expert_5_ep_2 -->
<g id="node1594" class="node">
<title>layer_15_expert_5_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="478655.83,-269 478221.82,-269 478110.17,-165 478544.18,-165 478655.83,-269"/>
<text text-anchor="middle" x="478383" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="478383" y="-220" font-family="Arial" font-size="10.00">GPU: 421</text>
<text text-anchor="middle" x="478383" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="478383" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_5_ep_2 -->
<g id="edge2954" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_5_ep_2</title>
<path fill="none" stroke="black" d="M478516.96,-305.83C478501.52,-295.71 478485.23,-285.03 478469.53,-274.73"/>
<polygon fill="black" stroke="black" points="478471.15,-271.61 478460.87,-269.06 478467.32,-277.47 478471.15,-271.61"/>
</g>
<!-- layer_15_expert_6_ep_2 -->
<g id="node1595" class="node">
<title>layer_15_expert_6_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="479218.83,-269 478784.82,-269 478673.17,-165 479107.18,-165 479218.83,-269"/>
<text text-anchor="middle" x="478946" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="478946" y="-220" font-family="Arial" font-size="10.00">GPU: 422</text>
<text text-anchor="middle" x="478946" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="478946" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_6_ep_2 -->
<g id="edge2955" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_6_ep_2</title>
<path fill="none" stroke="black" d="M478724.2,-305.83C478751.31,-295.1 478780,-283.74 478807.42,-272.88"/>
<polygon fill="black" stroke="black" points="478809.06,-275.99 478817.07,-269.06 478806.48,-269.49 478809.06,-275.99"/>
</g>
<!-- layer_15_expert_7_ep_2 -->
<g id="node1596" class="node">
<title>layer_15_expert_7_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="479781.83,-269 479347.82,-269 479236.17,-165 479670.18,-165 479781.83,-269"/>
<text text-anchor="middle" x="479509" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="479509" y="-220" font-family="Arial" font-size="10.00">GPU: 423</text>
<text text-anchor="middle" x="479509" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="479509" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_2&#45;&gt;layer_15_expert_7_ep_2 -->
<g id="edge2956" class="edge">
<title>layer_15_route_ep_2&#45;&gt;layer_15_expert_7_ep_2</title>
<path fill="none" stroke="black" d="M478794.53,-331.41C478919.3,-314.88 479083.25,-292.19 479228,-269 479257.6,-264.26 479288.89,-258.91 479319.42,-253.51"/>
<polygon fill="black" stroke="black" points="479320.07,-256.95 479329.3,-251.76 479318.85,-250.06 479320.07,-256.95"/>
</g>
<!-- layer_15_expert_0_ep_3 -->
<g id="node1597" class="node">
<title>layer_15_expert_0_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="493856.83,-269 493422.82,-269 493311.17,-165 493745.18,-165 493856.83,-269"/>
<text text-anchor="middle" x="493584" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="493584" y="-220" font-family="Arial" font-size="10.00">GPU: 432</text>
<text text-anchor="middle" x="493584" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="493584" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_0_ep_3 -->
<g id="edge2957" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_0_ep_3</title>
<path fill="none" stroke="black" d="M494150.52,-314.95C494059.44,-300.82 493957.83,-284.66 493865,-269 493864.9,-268.98 493864.79,-268.97 493864.69,-268.95"/>
<polygon fill="black" stroke="black" points="493865.48,-265.53 493855.04,-267.31 493864.31,-272.43 493865.48,-265.53"/>
</g>
<!-- layer_15_expert_1_ep_3 -->
<g id="node1598" class="node">
<title>layer_15_expert_1_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="494419.83,-269 493985.82,-269 493874.17,-165 494308.18,-165 494419.83,-269"/>
<text text-anchor="middle" x="494147" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="494147" y="-220" font-family="Arial" font-size="10.00">GPU: 433</text>
<text text-anchor="middle" x="494147" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="494147" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_1_ep_3 -->
<g id="edge2958" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_1_ep_3</title>
<path fill="none" stroke="black" d="M494325.19,-305.83C494303.9,-295.34 494281.38,-284.24 494259.78,-273.59"/>
<polygon fill="black" stroke="black" points="494261.1,-270.34 494250.59,-269.06 494258.01,-276.62 494261.1,-270.34"/>
</g>
<!-- layer_15_expert_2_ep_3 -->
<g id="node1599" class="node">
<title>layer_15_expert_2_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="494982.83,-269 494548.82,-269 494437.17,-165 494871.18,-165 494982.83,-269"/>
<text text-anchor="middle" x="494710" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="494710" y="-220" font-family="Arial" font-size="10.00">GPU: 434</text>
<text text-anchor="middle" x="494710" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="494710" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_2_ep_3 -->
<g id="edge2959" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_2_ep_3</title>
<path fill="none" stroke="black" d="M494532.44,-305.83C494553.66,-295.34 494576.1,-284.24 494597.62,-273.59"/>
<polygon fill="black" stroke="black" points="494599.37,-276.63 494606.78,-269.06 494596.27,-270.35 494599.37,-276.63"/>
</g>
<!-- layer_15_expert_3_ep_3 -->
<g id="node1600" class="node">
<title>layer_15_expert_3_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="495545.83,-269 495111.82,-269 495000.17,-165 495434.18,-165 495545.83,-269"/>
<text text-anchor="middle" x="495273" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="495273" y="-220" font-family="Arial" font-size="10.00">GPU: 435</text>
<text text-anchor="middle" x="495273" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="495273" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_3_ep_3 -->
<g id="edge2960" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_3_ep_3</title>
<path fill="none" stroke="black" d="M494624.28,-327.68C494732.7,-311.1 494869.94,-289.61 494992,-269 495021.45,-264.03 495052.59,-258.57 495083.01,-253.13"/>
<polygon fill="black" stroke="black" points="495083.63,-256.58 495092.85,-251.37 495082.39,-249.69 495083.63,-256.58"/>
</g>
<!-- layer_15_expert_4_ep_3 -->
<g id="node1601" class="node">
<title>layer_15_expert_4_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="496108.83,-269 495674.82,-269 495563.17,-165 495997.18,-165 496108.83,-269"/>
<text text-anchor="middle" x="495836" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="495836" y="-220" font-family="Arial" font-size="10.00">GPU: 436</text>
<text text-anchor="middle" x="495836" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="495836" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_4_ep_3 -->
<g id="edge2961" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_4_ep_3</title>
<path fill="none" stroke="black" d="M494645.53,-346.62C494872.75,-334.2 495239.98,-309.79 495555,-269 495585.06,-265.11 495616.79,-260.17 495647.67,-254.9"/>
<polygon fill="black" stroke="black" points="495648.41,-258.32 495657.67,-253.18 495647.22,-251.42 495648.41,-258.32"/>
</g>
<!-- layer_15_expert_5_ep_3 -->
<g id="node1602" class="node">
<title>layer_15_expert_5_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="496671.83,-269 496237.82,-269 496126.17,-165 496560.18,-165 496671.83,-269"/>
<text text-anchor="middle" x="496399" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="496399" y="-220" font-family="Arial" font-size="10.00">GPU: 437</text>
<text text-anchor="middle" x="496399" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="496399" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_5_ep_3 -->
<g id="edge2962" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_5_ep_3</title>
<path fill="none" stroke="black" d="M494654.47,-354.37C494979.04,-348.53 495596.29,-329.68 496118,-269 496148.22,-265.48 496180.1,-260.73 496211.1,-255.52"/>
<polygon fill="black" stroke="black" points="496211.86,-258.94 496221.13,-253.81 496210.69,-252.04 496211.86,-258.94"/>
</g>
<!-- layer_15_expert_6_ep_3 -->
<g id="node1603" class="node">
<title>layer_15_expert_6_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="497234.83,-269 496800.82,-269 496689.17,-165 497123.18,-165 497234.83,-269"/>
<text text-anchor="middle" x="496962" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="496962" y="-220" font-family="Arial" font-size="10.00">GPU: 438</text>
<text text-anchor="middle" x="496962" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="496962" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_6_ep_3 -->
<g id="edge2963" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_6_ep_3</title>
<path fill="none" stroke="black" d="M494652.05,-352.27C495140.66,-341.27 496292.79,-311.6 496681,-269 496711.35,-265.67 496743.36,-260.99 496774.48,-255.8"/>
<polygon fill="black" stroke="black" points="496775.27,-259.22 496784.55,-254.1 496774.1,-252.32 496775.27,-259.22"/>
</g>
<!-- layer_15_expert_7_ep_3 -->
<g id="node1604" class="node">
<title>layer_15_expert_7_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="497797.83,-269 497363.82,-269 497252.17,-165 497686.18,-165 497797.83,-269"/>
<text text-anchor="middle" x="497525" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="497525" y="-220" font-family="Arial" font-size="10.00">GPU: 439</text>
<text text-anchor="middle" x="497525" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="497525" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_3&#45;&gt;layer_15_expert_7_ep_3 -->
<g id="edge2964" class="edge">
<title>layer_15_route_ep_3&#45;&gt;layer_15_expert_7_ep_3</title>
<path fill="none" stroke="black" d="M494654.24,-354.27C495229.73,-346.61 496743.86,-321.91 497244,-269 497274.48,-265.78 497306.62,-261.14 497337.84,-255.95"/>
<polygon fill="black" stroke="black" points="497338.67,-259.36 497347.95,-254.25 497337.5,-252.46 497338.67,-259.36"/>
</g>
<!-- layer_15_expert_0_ep_4 -->
<g id="node1605" class="node">
<title>layer_15_expert_0_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="498360.83,-269 497926.82,-269 497815.17,-165 498249.18,-165 498360.83,-269"/>
<text text-anchor="middle" x="498088" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="498088" y="-220" font-family="Arial" font-size="10.00">GPU: 448</text>
<text text-anchor="middle" x="498088" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="498088" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_0_ep_4 -->
<g id="edge2965" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_0_ep_4</title>
<path fill="none" stroke="black" d="M498487.17,-305.93C498435.82,-294.62 498381.27,-282.6 498329.53,-271.21"/>
<polygon fill="black" stroke="black" points="498330.09,-267.74 498319.57,-269.01 498328.58,-274.58 498330.09,-267.74"/>
</g>
<!-- layer_15_expert_1_ep_4 -->
<g id="node1606" class="node">
<title>layer_15_expert_1_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="498923.83,-269 498489.82,-269 498378.17,-165 498812.18,-165 498923.83,-269"/>
<text text-anchor="middle" x="498651" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="498651" y="-220" font-family="Arial" font-size="10.00">GPU: 449</text>
<text text-anchor="middle" x="498651" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="498651" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_1_ep_4 -->
<g id="edge2966" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_1_ep_4</title>
<path fill="none" stroke="black" d="M498693.87,-305.64C498689.5,-296.7 498684.92,-287.34 498680.45,-278.2"/>
<polygon fill="black" stroke="black" points="498683.56,-276.6 498676.02,-269.15 498677.27,-279.67 498683.56,-276.6"/>
</g>
<!-- layer_15_expert_2_ep_4 -->
<g id="node1607" class="node">
<title>layer_15_expert_2_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="499486.83,-269 499052.82,-269 498941.17,-165 499375.18,-165 499486.83,-269"/>
<text text-anchor="middle" x="499214" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="499214" y="-220" font-family="Arial" font-size="10.00">GPU: 450</text>
<text text-anchor="middle" x="499214" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="499214" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_2_ep_4 -->
<g id="edge2967" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_2_ep_4</title>
<path fill="none" stroke="black" d="M498892.13,-308.38C498939.47,-295.09 498990.81,-280.67 499038.29,-267.34"/>
<polygon fill="black" stroke="black" points="499039.37,-270.67 499048.05,-264.6 499037.47,-263.93 499039.37,-270.67"/>
</g>
<!-- layer_15_expert_3_ep_4 -->
<g id="node1608" class="node">
<title>layer_15_expert_3_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="500049.83,-269 499615.82,-269 499504.17,-165 499938.18,-165 500049.83,-269"/>
<text text-anchor="middle" x="499777" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="499777" y="-220" font-family="Arial" font-size="10.00">GPU: 451</text>
<text text-anchor="middle" x="499777" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="499777" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_3_ep_4 -->
<g id="edge2968" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_3_ep_4</title>
<path fill="none" stroke="black" d="M498925.2,-337.43C499082.08,-321.63 499303.1,-297.4 499496,-269 499525.77,-264.62 499557.21,-259.45 499587.86,-254.11"/>
<polygon fill="black" stroke="black" points="499588.54,-257.54 499597.79,-252.37 499587.33,-250.65 499588.54,-257.54"/>
</g>
<!-- layer_15_expert_4_ep_4 -->
<g id="node1609" class="node">
<title>layer_15_expert_4_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="500612.83,-269 500178.82,-269 500067.17,-165 500501.18,-165 500612.83,-269"/>
<text text-anchor="middle" x="500340" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="500340" y="-220" font-family="Arial" font-size="10.00">GPU: 452</text>
<text text-anchor="middle" x="500340" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="500340" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_4_ep_4 -->
<g id="edge2969" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_4_ep_4</title>
<path fill="none" stroke="black" d="M498939.65,-350.22C499205.83,-340.26 499666.5,-317.35 500059,-269 500089.19,-265.28 500121.06,-260.41 500152.06,-255.16"/>
<polygon fill="black" stroke="black" points="500152.82,-258.58 500162.09,-253.45 500151.64,-251.69 500152.82,-258.58"/>
</g>
<!-- layer_15_expert_5_ep_4 -->
<g id="node1610" class="node">
<title>layer_15_expert_5_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="501175.83,-269 500741.82,-269 500630.17,-165 501064.18,-165 501175.83,-269"/>
<text text-anchor="middle" x="500903" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="500903" y="-220" font-family="Arial" font-size="10.00">GPU: 453</text>
<text text-anchor="middle" x="500903" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="500903" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_5_ep_4 -->
<g id="edge2970" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_5_ep_4</title>
<path fill="none" stroke="black" d="M498946.8,-356.26C499304.63,-352.89 500019.78,-337.27 500622,-269 500652.34,-265.56 500684.35,-260.82 500715.46,-255.61"/>
<polygon fill="black" stroke="black" points="500716.25,-259.03 500725.52,-253.91 500715.08,-252.13 500716.25,-259.03"/>
</g>
<!-- layer_15_expert_6_ep_4 -->
<g id="node1611" class="node">
<title>layer_15_expert_6_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="501738.83,-269 501304.82,-269 501193.17,-165 501627.18,-165 501738.83,-269"/>
<text text-anchor="middle" x="501466" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="501466" y="-220" font-family="Arial" font-size="10.00">GPU: 454</text>
<text text-anchor="middle" x="501466" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="501466" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_6_ep_4 -->
<g id="edge2971" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_6_ep_4</title>
<path fill="none" stroke="black" d="M498943,-353.14C499465.75,-343.45 500754.42,-315.51 501185,-269 501215.36,-265.72 501247.37,-261.07 501278.49,-255.89"/>
<polygon fill="black" stroke="black" points="501279.28,-259.31 501288.56,-254.19 501278.11,-252.41 501279.28,-259.31"/>
</g>
<!-- layer_15_expert_7_ep_4 -->
<g id="node1612" class="node">
<title>layer_15_expert_7_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="502301.83,-269 501867.82,-269 501756.17,-165 502190.18,-165 502301.83,-269"/>
<text text-anchor="middle" x="502029" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="502029" y="-220" font-family="Arial" font-size="10.00">GPU: 455</text>
<text text-anchor="middle" x="502029" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="502029" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_4&#45;&gt;layer_15_expert_7_ep_4 -->
<g id="edge2972" class="edge">
<title>layer_15_route_ep_4&#45;&gt;layer_15_expert_7_ep_4</title>
<path fill="none" stroke="black" d="M498944.96,-354.85C499551.3,-348.36 501204.98,-325.84 501748,-269 501778.48,-265.81 501810.62,-261.19 501841.85,-256.01"/>
<polygon fill="black" stroke="black" points="501842.67,-259.42 501851.95,-254.31 501841.51,-252.52 501842.67,-259.42"/>
</g>
<!-- layer_15_expert_0_ep_5 -->
<g id="node1613" class="node">
<title>layer_15_expert_0_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="502864.83,-269 502430.82,-269 502319.17,-165 502753.18,-165 502864.83,-269"/>
<text text-anchor="middle" x="502592" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="502592" y="-220" font-family="Arial" font-size="10.00">GPU: 464</text>
<text text-anchor="middle" x="502592" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="502592" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_0_ep_5 -->
<g id="edge2973" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_0_ep_5</title>
<path fill="none" stroke="black" d="M502971.56,-305.93C502922.83,-294.64 502871.08,-282.65 502821.97,-271.28"/>
<polygon fill="black" stroke="black" points="502822.72,-267.86 502812.19,-269.01 502821.14,-274.68 502822.72,-267.86"/>
</g>
<!-- layer_15_expert_1_ep_5 -->
<g id="node1614" class="node">
<title>layer_15_expert_1_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="503427.83,-269 502993.82,-269 502882.17,-165 503316.18,-165 503427.83,-269"/>
<text text-anchor="middle" x="503155" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="503155" y="-220" font-family="Arial" font-size="10.00">GPU: 465</text>
<text text-anchor="middle" x="503155" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="503155" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_1_ep_5 -->
<g id="edge2974" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_1_ep_5</title>
<path fill="none" stroke="black" d="M503178.33,-305.64C503176.02,-296.98 503173.61,-287.93 503171.25,-279.06"/>
<polygon fill="black" stroke="black" points="503174.57,-277.92 503168.62,-269.15 503167.81,-279.72 503174.57,-277.92"/>
</g>
<!-- layer_15_expert_2_ep_5 -->
<g id="node1615" class="node">
<title>layer_15_expert_2_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="503990.83,-269 503556.82,-269 503445.17,-165 503879.18,-165 503990.83,-269"/>
<text text-anchor="middle" x="503718" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="503718" y="-220" font-family="Arial" font-size="10.00">GPU: 466</text>
<text text-anchor="middle" x="503718" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="503718" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_2_ep_5 -->
<g id="edge2975" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_2_ep_5</title>
<path fill="none" stroke="black" d="M503367.88,-310.52C503423.1,-295.93 503484.1,-279.81 503539.5,-265.17"/>
<polygon fill="black" stroke="black" points="503540.64,-268.49 503549.42,-262.55 503538.85,-261.72 503540.64,-268.49"/>
</g>
<!-- layer_15_expert_3_ep_5 -->
<g id="node1616" class="node">
<title>layer_15_expert_3_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="504553.83,-269 504119.82,-269 504008.17,-165 504442.18,-165 504553.83,-269"/>
<text text-anchor="middle" x="504281" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="504281" y="-220" font-family="Arial" font-size="10.00">GPU: 467</text>
<text text-anchor="middle" x="504281" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="504281" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_3_ep_5 -->
<g id="edge2976" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_3_ep_5</title>
<path fill="none" stroke="black" d="M503399.67,-338.48C503563.18,-322.91 503796.64,-298.49 504000,-269 504029.78,-264.68 504061.22,-259.55 504091.88,-254.22"/>
<polygon fill="black" stroke="black" points="504092.55,-257.66 504101.8,-252.49 504091.35,-250.76 504092.55,-257.66"/>
</g>
<!-- layer_15_expert_4_ep_5 -->
<g id="node1617" class="node">
<title>layer_15_expert_4_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="505116.83,-269 504682.82,-269 504571.17,-165 505005.18,-165 505116.83,-269"/>
<text text-anchor="middle" x="504844" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="504844" y="-220" font-family="Arial" font-size="10.00">GPU: 468</text>
<text text-anchor="middle" x="504844" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="504844" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_4_ep_5 -->
<g id="edge2977" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_4_ep_5</title>
<path fill="none" stroke="black" d="M503402.25,-340.95C503569.35,-328.45 503809.07,-311.08 504019,-298 504260.65,-282.94 504322.52,-297.12 504563,-269 504593.22,-265.47 504625.09,-260.7 504656.09,-255.49"/>
<polygon fill="black" stroke="black" points="504656.85,-258.91 504666.13,-253.78 504655.68,-252.01 504656.85,-258.91"/>
</g>
<!-- layer_15_expert_5_ep_5 -->
<g id="node1618" class="node">
<title>layer_15_expert_5_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="505679.83,-269 505245.82,-269 505134.17,-165 505568.18,-165 505679.83,-269"/>
<text text-anchor="middle" x="505407" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="505407" y="-220" font-family="Arial" font-size="10.00">GPU: 469</text>
<text text-anchor="middle" x="505407" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="505407" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_5_ep_5 -->
<g id="edge2978" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_5_ep_5</title>
<path fill="none" stroke="black" d="M503400.45,-339.52C503567.58,-326.14 503808.2,-308.28 504019,-298 504510.59,-274.04 504636.43,-319.54 505126,-269 505156.48,-265.85 505188.63,-261.25 505219.86,-256.08"/>
<polygon fill="black" stroke="black" points="505220.68,-259.5 505229.96,-254.39 505219.52,-252.59 505220.68,-259.5"/>
</g>
<!-- layer_15_expert_6_ep_5 -->
<g id="node1619" class="node">
<title>layer_15_expert_6_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="506242.83,-269 505808.82,-269 505697.17,-165 506131.18,-165 506242.83,-269"/>
<text text-anchor="middle" x="505970" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="505970" y="-220" font-family="Arial" font-size="10.00">GPU: 470</text>
<text text-anchor="middle" x="505970" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="505970" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_6_ep_5 -->
<g id="edge2979" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_6_ep_5</title>
<path fill="none" stroke="black" d="M503399.98,-338.7C503567.1,-324.83 503807.95,-306.72 504019,-298 504389.85,-282.67 505319.75,-306.71 505689,-269 505719.49,-265.89 505751.64,-261.3 505782.86,-256.14"/>
<polygon fill="black" stroke="black" points="505783.68,-259.55 505792.97,-254.45 505782.52,-252.65 505783.68,-259.55"/>
</g>
<!-- layer_15_expert_7_ep_5 -->
<g id="node1620" class="node">
<title>layer_15_expert_7_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="506805.83,-269 506371.82,-269 506260.17,-165 506694.18,-165 506805.83,-269"/>
<text text-anchor="middle" x="506533" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="506533" y="-220" font-family="Arial" font-size="10.00">GPU: 471</text>
<text text-anchor="middle" x="506533" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="506533" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_5&#45;&gt;layer_15_expert_7_ep_5 -->
<g id="edge2980" class="edge">
<title>layer_15_route_ep_5&#45;&gt;layer_15_expert_7_ep_5</title>
<path fill="none" stroke="black" d="M503399.54,-338.53C503566.68,-324.53 503807.75,-306.34 504019,-298 504514.88,-278.41 505758.21,-318.48 506252,-269 506282.49,-265.94 506314.64,-261.39 506345.87,-256.24"/>
<polygon fill="black" stroke="black" points="506346.69,-259.65 506355.98,-254.55 506345.54,-252.75 506346.69,-259.65"/>
</g>
<!-- layer_15_expert_0_ep_6 -->
<g id="node1621" class="node">
<title>layer_15_expert_0_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="471336.83,-269 470902.82,-269 470791.17,-165 471225.18,-165 471336.83,-269"/>
<text text-anchor="middle" x="471064" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="471064" y="-220" font-family="Arial" font-size="10.00">GPU: 480</text>
<text text-anchor="middle" x="471064" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="471064" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_0_ep_6 -->
<g id="edge2981" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_0_ep_6</title>
<path fill="none" stroke="black" d="M473927.21,-354.16C473349.12,-346.43 471862.66,-321.99 471346.23,-269.08"/>
<polygon fill="black" stroke="black" points="471346.39,-265.58 471336.08,-268.02 471345.66,-272.54 471346.39,-265.58"/>
</g>
<!-- layer_15_expert_1_ep_6 -->
<g id="node1622" class="node">
<title>layer_15_expert_1_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="471899.83,-269 471465.82,-269 471354.17,-165 471788.18,-165 471899.83,-269"/>
<text text-anchor="middle" x="471627" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="471627" y="-220" font-family="Arial" font-size="10.00">GPU: 481</text>
<text text-anchor="middle" x="471627" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="471627" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_1_ep_6 -->
<g id="edge2982" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_1_ep_6</title>
<path fill="none" stroke="black" d="M473924.37,-351.97C473432.27,-340.83 472311.66,-311.72 471908.68,-269.02"/>
<polygon fill="black" stroke="black" points="471909.03,-265.54 471898.71,-267.95 471908.28,-272.5 471909.03,-265.54"/>
</g>
<!-- layer_15_expert_2_ep_6 -->
<g id="node1623" class="node">
<title>layer_15_expert_2_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="472462.83,-269 472028.82,-269 471917.17,-165 472351.18,-165 472462.83,-269"/>
<text text-anchor="middle" x="472190" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="472190" y="-220" font-family="Arial" font-size="10.00">GPU: 482</text>
<text text-anchor="middle" x="472190" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="472190" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_2_ep_6 -->
<g id="edge2983" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_2_ep_6</title>
<path fill="none" stroke="black" d="M473927.16,-354.23C473602.36,-348.26 472996.39,-329.44 472471.76,-269.05"/>
<polygon fill="black" stroke="black" points="472472.05,-265.56 472461.72,-267.89 472471.25,-272.51 472472.05,-265.56"/>
</g>
<!-- layer_15_expert_3_ep_6 -->
<g id="node1624" class="node">
<title>layer_15_expert_3_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="473025.83,-269 472591.82,-269 472480.17,-165 472914.18,-165 473025.83,-269"/>
<text text-anchor="middle" x="472753" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="472753" y="-220" font-family="Arial" font-size="10.00">GPU: 483</text>
<text text-anchor="middle" x="472753" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="472753" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_3_ep_6 -->
<g id="edge2984" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_3_ep_6</title>
<path fill="none" stroke="black" d="M473916.79,-345.11C473690.47,-332.41 473344.42,-308.72 473034.8,-269.07"/>
<polygon fill="black" stroke="black" points="473035.1,-265.58 473024.73,-267.77 473034.2,-272.52 473035.1,-265.58"/>
</g>
<!-- layer_15_expert_4_ep_6 -->
<g id="node1625" class="node">
<title>layer_15_expert_4_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="473588.83,-269 473154.82,-269 473043.17,-165 473477.18,-165 473588.83,-269"/>
<text text-anchor="middle" x="473316" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="473316" y="-220" font-family="Arial" font-size="10.00">GPU: 484</text>
<text text-anchor="middle" x="473316" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="473316" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_4_ep_6 -->
<g id="edge2985" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_4_ep_6</title>
<path fill="none" stroke="black" d="M473882.52,-314.95C473791.44,-300.82 473689.83,-284.66 473597,-269 473596.9,-268.98 473596.79,-268.97 473596.69,-268.95"/>
<polygon fill="black" stroke="black" points="473597.48,-265.53 473587.04,-267.31 473596.31,-272.43 473597.48,-265.53"/>
</g>
<!-- layer_15_expert_5_ep_6 -->
<g id="node1626" class="node">
<title>layer_15_expert_5_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="474151.83,-269 473717.82,-269 473606.17,-165 474040.18,-165 474151.83,-269"/>
<text text-anchor="middle" x="473879" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="473879" y="-220" font-family="Arial" font-size="10.00">GPU: 485</text>
<text text-anchor="middle" x="473879" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="473879" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_5_ep_6 -->
<g id="edge2986" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_5_ep_6</title>
<path fill="none" stroke="black" d="M474057.19,-305.83C474035.9,-295.34 474013.38,-284.24 473991.78,-273.59"/>
<polygon fill="black" stroke="black" points="473993.1,-270.34 473982.59,-269.06 473990.01,-276.62 473993.1,-270.34"/>
</g>
<!-- layer_15_expert_6_ep_6 -->
<g id="node1627" class="node">
<title>layer_15_expert_6_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="474714.83,-269 474280.82,-269 474169.17,-165 474603.18,-165 474714.83,-269"/>
<text text-anchor="middle" x="474442" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="474442" y="-220" font-family="Arial" font-size="10.00">GPU: 486</text>
<text text-anchor="middle" x="474442" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="474442" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_6_ep_6 -->
<g id="edge2987" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_6_ep_6</title>
<path fill="none" stroke="black" d="M474264.44,-305.83C474285.66,-295.34 474308.1,-284.24 474329.62,-273.59"/>
<polygon fill="black" stroke="black" points="474331.37,-276.63 474338.78,-269.06 474328.27,-270.35 474331.37,-276.63"/>
</g>
<!-- layer_15_expert_7_ep_6 -->
<g id="node1628" class="node">
<title>layer_15_expert_7_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="475277.83,-269 474843.82,-269 474732.17,-165 475166.18,-165 475277.83,-269"/>
<text text-anchor="middle" x="475005" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="475005" y="-220" font-family="Arial" font-size="10.00">GPU: 487</text>
<text text-anchor="middle" x="475005" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="475005" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_6&#45;&gt;layer_15_expert_7_ep_6 -->
<g id="edge2988" class="edge">
<title>layer_15_route_ep_6&#45;&gt;layer_15_expert_7_ep_6</title>
<path fill="none" stroke="black" d="M474356.28,-327.68C474464.7,-311.1 474601.94,-289.61 474724,-269 474753.45,-264.03 474784.59,-258.57 474815.01,-253.13"/>
<polygon fill="black" stroke="black" points="474815.63,-256.58 474824.85,-251.37 474814.39,-249.69 474815.63,-256.58"/>
</g>
<!-- layer_15_expert_0_ep_7 -->
<g id="node1629" class="node">
<title>layer_15_expert_0_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="480344.83,-269 479910.82,-269 479799.17,-165 480233.18,-165 480344.83,-269"/>
<text text-anchor="middle" x="480072" y="-231" font-family="Arial" font-size="10.00">Expert 0 (EP)</text>
<text text-anchor="middle" x="480072" y="-220" font-family="Arial" font-size="10.00">GPU: 496</text>
<text text-anchor="middle" x="480072" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="480072" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_0_ep_7 -->
<g id="edge2989" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_0_ep_7</title>
<path fill="none" stroke="black" d="M482935.21,-354.16C482357.12,-346.43 480870.66,-321.99 480354.23,-269.08"/>
<polygon fill="black" stroke="black" points="480354.39,-265.58 480344.08,-268.02 480353.66,-272.54 480354.39,-265.58"/>
</g>
<!-- layer_15_expert_1_ep_7 -->
<g id="node1630" class="node">
<title>layer_15_expert_1_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="480907.83,-269 480473.82,-269 480362.17,-165 480796.18,-165 480907.83,-269"/>
<text text-anchor="middle" x="480635" y="-231" font-family="Arial" font-size="10.00">Expert 1 (EP)</text>
<text text-anchor="middle" x="480635" y="-220" font-family="Arial" font-size="10.00">GPU: 497</text>
<text text-anchor="middle" x="480635" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="480635" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_1_ep_7 -->
<g id="edge2990" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_1_ep_7</title>
<path fill="none" stroke="black" d="M482932.37,-351.97C482440.27,-340.83 481319.66,-311.72 480916.68,-269.02"/>
<polygon fill="black" stroke="black" points="480917.03,-265.54 480906.71,-267.95 480916.28,-272.5 480917.03,-265.54"/>
</g>
<!-- layer_15_expert_2_ep_7 -->
<g id="node1631" class="node">
<title>layer_15_expert_2_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="481470.83,-269 481036.82,-269 480925.17,-165 481359.18,-165 481470.83,-269"/>
<text text-anchor="middle" x="481198" y="-231" font-family="Arial" font-size="10.00">Expert 2 (EP)</text>
<text text-anchor="middle" x="481198" y="-220" font-family="Arial" font-size="10.00">GPU: 498</text>
<text text-anchor="middle" x="481198" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="481198" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_2_ep_7 -->
<g id="edge2991" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_2_ep_7</title>
<path fill="none" stroke="black" d="M482935.16,-354.23C482610.36,-348.26 482004.39,-329.44 481479.76,-269.05"/>
<polygon fill="black" stroke="black" points="481480.05,-265.56 481469.72,-267.89 481479.25,-272.51 481480.05,-265.56"/>
</g>
<!-- layer_15_expert_3_ep_7 -->
<g id="node1632" class="node">
<title>layer_15_expert_3_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="482033.83,-269 481599.82,-269 481488.17,-165 481922.18,-165 482033.83,-269"/>
<text text-anchor="middle" x="481761" y="-231" font-family="Arial" font-size="10.00">Expert 3 (EP)</text>
<text text-anchor="middle" x="481761" y="-220" font-family="Arial" font-size="10.00">GPU: 499</text>
<text text-anchor="middle" x="481761" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="481761" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_3_ep_7 -->
<g id="edge2992" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_3_ep_7</title>
<path fill="none" stroke="black" d="M482924.79,-345.11C482698.47,-332.41 482352.42,-308.72 482042.8,-269.07"/>
<polygon fill="black" stroke="black" points="482043.1,-265.58 482032.73,-267.77 482042.2,-272.52 482043.1,-265.58"/>
</g>
<!-- layer_15_expert_4_ep_7 -->
<g id="node1633" class="node">
<title>layer_15_expert_4_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="482596.83,-269 482162.82,-269 482051.17,-165 482485.18,-165 482596.83,-269"/>
<text text-anchor="middle" x="482324" y="-231" font-family="Arial" font-size="10.00">Expert 4 (EP)</text>
<text text-anchor="middle" x="482324" y="-220" font-family="Arial" font-size="10.00">GPU: 500</text>
<text text-anchor="middle" x="482324" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="482324" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_4_ep_7 -->
<g id="edge2993" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_4_ep_7</title>
<path fill="none" stroke="black" d="M482890.52,-314.95C482799.44,-300.82 482697.83,-284.66 482605,-269 482604.9,-268.98 482604.79,-268.97 482604.69,-268.95"/>
<polygon fill="black" stroke="black" points="482605.48,-265.53 482595.04,-267.31 482604.31,-272.43 482605.48,-265.53"/>
</g>
<!-- layer_15_expert_5_ep_7 -->
<g id="node1634" class="node">
<title>layer_15_expert_5_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="483159.83,-269 482725.82,-269 482614.17,-165 483048.18,-165 483159.83,-269"/>
<text text-anchor="middle" x="482887" y="-231" font-family="Arial" font-size="10.00">Expert 5 (EP)</text>
<text text-anchor="middle" x="482887" y="-220" font-family="Arial" font-size="10.00">GPU: 501</text>
<text text-anchor="middle" x="482887" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="482887" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_5_ep_7 -->
<g id="edge2994" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_5_ep_7</title>
<path fill="none" stroke="black" d="M483065.19,-305.83C483043.9,-295.34 483021.38,-284.24 482999.78,-273.59"/>
<polygon fill="black" stroke="black" points="483001.1,-270.34 482990.59,-269.06 482998.01,-276.62 483001.1,-270.34"/>
</g>
<!-- layer_15_expert_6_ep_7 -->
<g id="node1635" class="node">
<title>layer_15_expert_6_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="483722.83,-269 483288.82,-269 483177.17,-165 483611.18,-165 483722.83,-269"/>
<text text-anchor="middle" x="483450" y="-231" font-family="Arial" font-size="10.00">Expert 6 (EP)</text>
<text text-anchor="middle" x="483450" y="-220" font-family="Arial" font-size="10.00">GPU: 502</text>
<text text-anchor="middle" x="483450" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="483450" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_6_ep_7 -->
<g id="edge2995" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_6_ep_7</title>
<path fill="none" stroke="black" d="M483272.44,-305.83C483293.66,-295.34 483316.1,-284.24 483337.62,-273.59"/>
<polygon fill="black" stroke="black" points="483339.37,-276.63 483346.78,-269.06 483336.27,-270.35 483339.37,-276.63"/>
</g>
<!-- layer_15_expert_7_ep_7 -->
<g id="node1636" class="node">
<title>layer_15_expert_7_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="484285.83,-269 483851.82,-269 483740.17,-165 484174.18,-165 484285.83,-269"/>
<text text-anchor="middle" x="484013" y="-231" font-family="Arial" font-size="10.00">Expert 7 (EP)</text>
<text text-anchor="middle" x="484013" y="-220" font-family="Arial" font-size="10.00">GPU: 503</text>
<text text-anchor="middle" x="484013" y="-209" font-family="Arial" font-size="10.00">Input: [batch_size=2, seq_len=512, hidden_size=1024]</text>
<text text-anchor="middle" x="484013" y="-198" font-family="Arial" font-size="10.00">Output: [batch_size=2, seq_len=512, hidden_size=1024]</text>
</g>
<!-- layer_15_route_ep_7&#45;&gt;layer_15_expert_7_ep_7 -->
<g id="edge2996" class="edge">
<title>layer_15_route_ep_7&#45;&gt;layer_15_expert_7_ep_7</title>
<path fill="none" stroke="black" d="M483364.28,-327.68C483472.7,-311.1 483609.94,-289.61 483732,-269 483761.45,-264.03 483792.59,-258.57 483823.01,-253.13"/>
<polygon fill="black" stroke="black" points="483823.63,-256.58 483832.85,-251.37 483822.39,-249.69 483823.63,-256.58"/>
</g>
<!-- layer_15_agg_ep_0 -->
<g id="node1637" class="node">
<title>layer_15_agg_ep_0</title>
<polygon fill="lightyellow" stroke="black" points="491615.07,-128 491164.77,-128 491048.93,-24 491499.23,-24 491615.07,-128"/>
<text text-anchor="middle" x="491332" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="491332" y="-79" font-family="Arial" font-size="10.00">GPU: 384&#45;399</text>
<text text-anchor="middle" x="491332" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="491332" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge2997" class="edge">
<title>layer_15_expert_0_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M489252.37,-175.09C489288.1,-167.94 489325.63,-161.4 489361,-157 489691.43,-115.9 490657.09,-91.08 491102.31,-81.52"/>
<polygon fill="black" stroke="black" points="491102.48,-85.02 491112.4,-81.31 491102.33,-78.02 491102.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge2998" class="edge">
<title>layer_15_expert_1_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M489815.8,-175.46C489851.41,-168.31 489888.79,-161.67 489924,-157 490335.77,-102.39 490820.14,-85.03 491100.05,-79.53"/>
<polygon fill="black" stroke="black" points="491100.4,-83.02 491110.33,-79.33 491100.26,-76.02 491100.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge2999" class="edge">
<title>layer_15_expert_2_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M490379.7,-176.34C490415.07,-169.17 490452.13,-162.29 490487,-157 490698.23,-124.93 490941.24,-103.53 491112.27,-90.99"/>
<polygon fill="black" stroke="black" points="491112.69,-94.47 491122.41,-90.25 491112.18,-87.49 491112.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge3000" class="edge">
<title>layer_15_expert_3_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M490939.83,-173.82C491005.06,-157.72 491079.72,-139.29 491146.27,-122.86"/>
<polygon fill="black" stroke="black" points="491147.15,-126.24 491156.02,-120.45 491145.48,-119.45 491147.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge3001" class="edge">
<title>layer_15_expert_4_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M491332,-164.64C491332,-156.08 491332,-147.12 491332,-138.34"/>
<polygon fill="black" stroke="black" points="491335.5,-138.15 491332,-128.15 491328.5,-138.15 491335.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge3002" class="edge">
<title>layer_15_expert_5_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M491688.16,-164.93C491642.62,-153.69 491594.27,-141.75 491548.37,-130.42"/>
<polygon fill="black" stroke="black" points="491549.16,-127.01 491538.61,-128.01 491547.48,-133.81 491549.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge3003" class="edge">
<title>layer_15_expert_6_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M492224.92,-164.97C492208.74,-162.07 492192.65,-159.38 492177,-157 491979.52,-127.02 491754.26,-106.36 491586.01,-93.55"/>
<polygon fill="black" stroke="black" points="491586.26,-90.06 491576.02,-92.8 491585.73,-97.04 491586.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_0&#45;&gt;layer_15_agg_ep_0 -->
<g id="edge3004" class="edge">
<title>layer_15_expert_7_ep_0&#45;&gt;layer_15_agg_ep_0</title>
<path fill="none" stroke="black" d="M492791.84,-164.94C492774.35,-161.94 492756.92,-159.24 492740,-157 492331.97,-102.88 491852.66,-85.34 491571.64,-79.68"/>
<polygon fill="black" stroke="black" points="491571.38,-76.17 491561.32,-79.47 491571.24,-83.17 491571.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_1 -->
<g id="node1638" class="node">
<title>layer_15_agg_ep_1</title>
<polygon fill="lightyellow" stroke="black" points="487111.07,-128 486660.77,-128 486544.93,-24 486995.23,-24 487111.07,-128"/>
<text text-anchor="middle" x="486828" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="486828" y="-79" font-family="Arial" font-size="10.00">GPU: 400&#45;415</text>
<text text-anchor="middle" x="486828" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="486828" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3006" class="edge">
<title>layer_15_expert_0_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M484748.37,-175.09C484784.1,-167.94 484821.63,-161.4 484857,-157 485187.43,-115.9 486153.09,-91.08 486598.31,-81.52"/>
<polygon fill="black" stroke="black" points="486598.48,-85.02 486608.4,-81.31 486598.33,-78.02 486598.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3007" class="edge">
<title>layer_15_expert_1_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M485311.8,-175.46C485347.41,-168.31 485384.79,-161.67 485420,-157 485831.77,-102.39 486316.14,-85.03 486596.05,-79.53"/>
<polygon fill="black" stroke="black" points="486596.4,-83.02 486606.33,-79.33 486596.26,-76.02 486596.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3008" class="edge">
<title>layer_15_expert_2_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M485875.7,-176.34C485911.07,-169.17 485948.13,-162.29 485983,-157 486194.23,-124.93 486437.24,-103.53 486608.27,-90.99"/>
<polygon fill="black" stroke="black" points="486608.69,-94.47 486618.41,-90.25 486608.18,-87.49 486608.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3009" class="edge">
<title>layer_15_expert_3_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M486435.83,-173.82C486501.06,-157.72 486575.72,-139.29 486642.27,-122.86"/>
<polygon fill="black" stroke="black" points="486643.15,-126.24 486652.02,-120.45 486641.48,-119.45 486643.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3010" class="edge">
<title>layer_15_expert_4_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M486828,-164.64C486828,-156.08 486828,-147.12 486828,-138.34"/>
<polygon fill="black" stroke="black" points="486831.5,-138.15 486828,-128.15 486824.5,-138.15 486831.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3011" class="edge">
<title>layer_15_expert_5_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M487184.16,-164.93C487138.62,-153.69 487090.27,-141.75 487044.37,-130.42"/>
<polygon fill="black" stroke="black" points="487045.16,-127.01 487034.61,-128.01 487043.48,-133.81 487045.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3012" class="edge">
<title>layer_15_expert_6_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M487720.92,-164.97C487704.74,-162.07 487688.65,-159.38 487673,-157 487475.52,-127.02 487250.26,-106.36 487082.01,-93.55"/>
<polygon fill="black" stroke="black" points="487082.26,-90.06 487072.02,-92.8 487081.73,-97.04 487082.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_1&#45;&gt;layer_15_agg_ep_1 -->
<g id="edge3013" class="edge">
<title>layer_15_expert_7_ep_1&#45;&gt;layer_15_agg_ep_1</title>
<path fill="none" stroke="black" d="M488287.84,-164.94C488270.35,-161.94 488252.92,-159.24 488236,-157 487827.97,-102.88 487348.66,-85.34 487067.64,-79.68"/>
<polygon fill="black" stroke="black" points="487067.38,-76.17 487057.32,-79.47 487067.24,-83.17 487067.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_2 -->
<g id="node1639" class="node">
<title>layer_15_agg_ep_2</title>
<polygon fill="lightyellow" stroke="black" points="478103.07,-128 477652.77,-128 477536.93,-24 477987.23,-24 478103.07,-128"/>
<text text-anchor="middle" x="477820" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="477820" y="-79" font-family="Arial" font-size="10.00">GPU: 416&#45;431</text>
<text text-anchor="middle" x="477820" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="477820" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3015" class="edge">
<title>layer_15_expert_0_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M475740.37,-175.09C475776.1,-167.94 475813.63,-161.4 475849,-157 476179.43,-115.9 477145.09,-91.08 477590.31,-81.52"/>
<polygon fill="black" stroke="black" points="477590.48,-85.02 477600.4,-81.31 477590.33,-78.02 477590.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3016" class="edge">
<title>layer_15_expert_1_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M476303.8,-175.46C476339.41,-168.31 476376.79,-161.67 476412,-157 476823.77,-102.39 477308.14,-85.03 477588.05,-79.53"/>
<polygon fill="black" stroke="black" points="477588.4,-83.02 477598.33,-79.33 477588.26,-76.02 477588.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3017" class="edge">
<title>layer_15_expert_2_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M476867.7,-176.34C476903.07,-169.17 476940.13,-162.29 476975,-157 477186.23,-124.93 477429.24,-103.53 477600.27,-90.99"/>
<polygon fill="black" stroke="black" points="477600.69,-94.47 477610.41,-90.25 477600.18,-87.49 477600.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3018" class="edge">
<title>layer_15_expert_3_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M477427.83,-173.82C477493.06,-157.72 477567.72,-139.29 477634.27,-122.86"/>
<polygon fill="black" stroke="black" points="477635.15,-126.24 477644.02,-120.45 477633.48,-119.45 477635.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3019" class="edge">
<title>layer_15_expert_4_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M477820,-164.64C477820,-156.08 477820,-147.12 477820,-138.34"/>
<polygon fill="black" stroke="black" points="477823.5,-138.15 477820,-128.15 477816.5,-138.15 477823.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3020" class="edge">
<title>layer_15_expert_5_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M478176.16,-164.93C478130.62,-153.69 478082.27,-141.75 478036.37,-130.42"/>
<polygon fill="black" stroke="black" points="478037.16,-127.01 478026.61,-128.01 478035.48,-133.81 478037.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3021" class="edge">
<title>layer_15_expert_6_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M478712.92,-164.97C478696.74,-162.07 478680.65,-159.38 478665,-157 478467.52,-127.02 478242.26,-106.36 478074.01,-93.55"/>
<polygon fill="black" stroke="black" points="478074.26,-90.06 478064.02,-92.8 478073.73,-97.04 478074.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_2&#45;&gt;layer_15_agg_ep_2 -->
<g id="edge3022" class="edge">
<title>layer_15_expert_7_ep_2&#45;&gt;layer_15_agg_ep_2</title>
<path fill="none" stroke="black" d="M479279.84,-164.94C479262.35,-161.94 479244.92,-159.24 479228,-157 478819.97,-102.88 478340.66,-85.34 478059.64,-79.68"/>
<polygon fill="black" stroke="black" points="478059.38,-76.17 478049.32,-79.47 478059.24,-83.17 478059.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_3 -->
<g id="node1640" class="node">
<title>layer_15_agg_ep_3</title>
<polygon fill="lightyellow" stroke="black" points="496119.07,-128 495668.77,-128 495552.93,-24 496003.23,-24 496119.07,-128"/>
<text text-anchor="middle" x="495836" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="495836" y="-79" font-family="Arial" font-size="10.00">GPU: 432&#45;447</text>
<text text-anchor="middle" x="495836" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="495836" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3024" class="edge">
<title>layer_15_expert_0_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M493756.37,-175.09C493792.1,-167.94 493829.63,-161.4 493865,-157 494195.43,-115.9 495161.09,-91.08 495606.31,-81.52"/>
<polygon fill="black" stroke="black" points="495606.48,-85.02 495616.4,-81.31 495606.33,-78.02 495606.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3025" class="edge">
<title>layer_15_expert_1_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M494319.8,-175.46C494355.41,-168.31 494392.79,-161.67 494428,-157 494839.77,-102.39 495324.14,-85.03 495604.05,-79.53"/>
<polygon fill="black" stroke="black" points="495604.4,-83.02 495614.33,-79.33 495604.26,-76.02 495604.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3026" class="edge">
<title>layer_15_expert_2_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M494883.7,-176.34C494919.07,-169.17 494956.13,-162.29 494991,-157 495202.23,-124.93 495445.24,-103.53 495616.27,-90.99"/>
<polygon fill="black" stroke="black" points="495616.69,-94.47 495626.41,-90.25 495616.18,-87.49 495616.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3027" class="edge">
<title>layer_15_expert_3_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M495443.83,-173.82C495509.06,-157.72 495583.72,-139.29 495650.27,-122.86"/>
<polygon fill="black" stroke="black" points="495651.15,-126.24 495660.02,-120.45 495649.48,-119.45 495651.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3028" class="edge">
<title>layer_15_expert_4_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M495836,-164.64C495836,-156.08 495836,-147.12 495836,-138.34"/>
<polygon fill="black" stroke="black" points="495839.5,-138.15 495836,-128.15 495832.5,-138.15 495839.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3029" class="edge">
<title>layer_15_expert_5_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M496192.16,-164.93C496146.62,-153.69 496098.27,-141.75 496052.37,-130.42"/>
<polygon fill="black" stroke="black" points="496053.16,-127.01 496042.61,-128.01 496051.48,-133.81 496053.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3030" class="edge">
<title>layer_15_expert_6_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M496728.92,-164.97C496712.74,-162.07 496696.65,-159.38 496681,-157 496483.52,-127.02 496258.26,-106.36 496090.01,-93.55"/>
<polygon fill="black" stroke="black" points="496090.26,-90.06 496080.02,-92.8 496089.73,-97.04 496090.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_3&#45;&gt;layer_15_agg_ep_3 -->
<g id="edge3031" class="edge">
<title>layer_15_expert_7_ep_3&#45;&gt;layer_15_agg_ep_3</title>
<path fill="none" stroke="black" d="M497295.84,-164.94C497278.35,-161.94 497260.92,-159.24 497244,-157 496835.97,-102.88 496356.66,-85.34 496075.64,-79.68"/>
<polygon fill="black" stroke="black" points="496075.38,-76.17 496065.32,-79.47 496075.24,-83.17 496075.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_4 -->
<g id="node1641" class="node">
<title>layer_15_agg_ep_4</title>
<polygon fill="lightyellow" stroke="black" points="500623.07,-128 500172.77,-128 500056.93,-24 500507.23,-24 500623.07,-128"/>
<text text-anchor="middle" x="500340" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="500340" y="-79" font-family="Arial" font-size="10.00">GPU: 448&#45;463</text>
<text text-anchor="middle" x="500340" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="500340" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3033" class="edge">
<title>layer_15_expert_0_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M498260.37,-175.09C498296.1,-167.94 498333.63,-161.4 498369,-157 498699.43,-115.9 499665.09,-91.08 500110.31,-81.52"/>
<polygon fill="black" stroke="black" points="500110.48,-85.02 500120.4,-81.31 500110.33,-78.02 500110.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3034" class="edge">
<title>layer_15_expert_1_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M498823.8,-175.46C498859.41,-168.31 498896.79,-161.67 498932,-157 499343.77,-102.39 499828.14,-85.03 500108.05,-79.53"/>
<polygon fill="black" stroke="black" points="500108.4,-83.02 500118.33,-79.33 500108.26,-76.02 500108.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3035" class="edge">
<title>layer_15_expert_2_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M499387.7,-176.34C499423.07,-169.17 499460.13,-162.29 499495,-157 499706.23,-124.93 499949.24,-103.53 500120.27,-90.99"/>
<polygon fill="black" stroke="black" points="500120.69,-94.47 500130.41,-90.25 500120.18,-87.49 500120.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3036" class="edge">
<title>layer_15_expert_3_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M499947.83,-173.82C500013.06,-157.72 500087.72,-139.29 500154.27,-122.86"/>
<polygon fill="black" stroke="black" points="500155.15,-126.24 500164.02,-120.45 500153.48,-119.45 500155.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3037" class="edge">
<title>layer_15_expert_4_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M500340,-164.64C500340,-156.08 500340,-147.12 500340,-138.34"/>
<polygon fill="black" stroke="black" points="500343.5,-138.15 500340,-128.15 500336.5,-138.15 500343.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3038" class="edge">
<title>layer_15_expert_5_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M500696.16,-164.93C500650.62,-153.69 500602.27,-141.75 500556.37,-130.42"/>
<polygon fill="black" stroke="black" points="500557.16,-127.01 500546.61,-128.01 500555.48,-133.81 500557.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3039" class="edge">
<title>layer_15_expert_6_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M501232.92,-164.97C501216.74,-162.07 501200.65,-159.38 501185,-157 500987.52,-127.02 500762.26,-106.36 500594.01,-93.55"/>
<polygon fill="black" stroke="black" points="500594.26,-90.06 500584.02,-92.8 500593.73,-97.04 500594.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_4&#45;&gt;layer_15_agg_ep_4 -->
<g id="edge3040" class="edge">
<title>layer_15_expert_7_ep_4&#45;&gt;layer_15_agg_ep_4</title>
<path fill="none" stroke="black" d="M501799.84,-164.94C501782.35,-161.94 501764.92,-159.24 501748,-157 501339.97,-102.88 500860.66,-85.34 500579.64,-79.68"/>
<polygon fill="black" stroke="black" points="500579.38,-76.17 500569.32,-79.47 500579.24,-83.17 500579.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_5 -->
<g id="node1642" class="node">
<title>layer_15_agg_ep_5</title>
<polygon fill="lightyellow" stroke="black" points="505127.07,-128 504676.77,-128 504560.93,-24 505011.23,-24 505127.07,-128"/>
<text text-anchor="middle" x="504844" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="504844" y="-79" font-family="Arial" font-size="10.00">GPU: 464&#45;479</text>
<text text-anchor="middle" x="504844" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="504844" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3042" class="edge">
<title>layer_15_expert_0_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M502764.37,-175.09C502800.1,-167.94 502837.63,-161.4 502873,-157 503203.43,-115.9 504169.09,-91.08 504614.31,-81.52"/>
<polygon fill="black" stroke="black" points="504614.48,-85.02 504624.4,-81.31 504614.33,-78.02 504614.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3043" class="edge">
<title>layer_15_expert_1_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M503327.8,-175.46C503363.41,-168.31 503400.79,-161.67 503436,-157 503847.77,-102.39 504332.14,-85.03 504612.05,-79.53"/>
<polygon fill="black" stroke="black" points="504612.4,-83.02 504622.33,-79.33 504612.26,-76.02 504612.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3044" class="edge">
<title>layer_15_expert_2_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M503891.7,-176.34C503927.07,-169.17 503964.13,-162.29 503999,-157 504210.23,-124.93 504453.24,-103.53 504624.27,-90.99"/>
<polygon fill="black" stroke="black" points="504624.69,-94.47 504634.41,-90.25 504624.18,-87.49 504624.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3045" class="edge">
<title>layer_15_expert_3_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M504451.83,-173.82C504517.06,-157.72 504591.72,-139.29 504658.27,-122.86"/>
<polygon fill="black" stroke="black" points="504659.15,-126.24 504668.02,-120.45 504657.48,-119.45 504659.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3046" class="edge">
<title>layer_15_expert_4_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M504844,-164.64C504844,-156.08 504844,-147.12 504844,-138.34"/>
<polygon fill="black" stroke="black" points="504847.5,-138.15 504844,-128.15 504840.5,-138.15 504847.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3047" class="edge">
<title>layer_15_expert_5_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M505200.16,-164.93C505154.62,-153.69 505106.27,-141.75 505060.37,-130.42"/>
<polygon fill="black" stroke="black" points="505061.16,-127.01 505050.61,-128.01 505059.48,-133.81 505061.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3048" class="edge">
<title>layer_15_expert_6_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M505736.92,-164.97C505720.74,-162.07 505704.65,-159.38 505689,-157 505491.52,-127.02 505266.26,-106.36 505098.01,-93.55"/>
<polygon fill="black" stroke="black" points="505098.26,-90.06 505088.02,-92.8 505097.73,-97.04 505098.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_5&#45;&gt;layer_15_agg_ep_5 -->
<g id="edge3049" class="edge">
<title>layer_15_expert_7_ep_5&#45;&gt;layer_15_agg_ep_5</title>
<path fill="none" stroke="black" d="M506303.84,-164.94C506286.35,-161.94 506268.92,-159.24 506252,-157 505843.97,-102.88 505364.66,-85.34 505083.64,-79.68"/>
<polygon fill="black" stroke="black" points="505083.38,-76.17 505073.32,-79.47 505083.24,-83.17 505083.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_6 -->
<g id="node1643" class="node">
<title>layer_15_agg_ep_6</title>
<polygon fill="lightyellow" stroke="black" points="473599.07,-128 473148.77,-128 473032.93,-24 473483.23,-24 473599.07,-128"/>
<text text-anchor="middle" x="473316" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="473316" y="-79" font-family="Arial" font-size="10.00">GPU: 480&#45;495</text>
<text text-anchor="middle" x="473316" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="473316" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3051" class="edge">
<title>layer_15_expert_0_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M471236.37,-175.09C471272.1,-167.94 471309.63,-161.4 471345,-157 471675.43,-115.9 472641.09,-91.08 473086.31,-81.52"/>
<polygon fill="black" stroke="black" points="473086.48,-85.02 473096.4,-81.31 473086.33,-78.02 473086.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3052" class="edge">
<title>layer_15_expert_1_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M471799.8,-175.46C471835.41,-168.31 471872.79,-161.67 471908,-157 472319.77,-102.39 472804.14,-85.03 473084.05,-79.53"/>
<polygon fill="black" stroke="black" points="473084.4,-83.02 473094.33,-79.33 473084.26,-76.02 473084.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3053" class="edge">
<title>layer_15_expert_2_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M472363.7,-176.34C472399.07,-169.17 472436.13,-162.29 472471,-157 472682.23,-124.93 472925.24,-103.53 473096.27,-90.99"/>
<polygon fill="black" stroke="black" points="473096.69,-94.47 473106.41,-90.25 473096.18,-87.49 473096.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3054" class="edge">
<title>layer_15_expert_3_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M472923.83,-173.82C472989.06,-157.72 473063.72,-139.29 473130.27,-122.86"/>
<polygon fill="black" stroke="black" points="473131.15,-126.24 473140.02,-120.45 473129.48,-119.45 473131.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3055" class="edge">
<title>layer_15_expert_4_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M473316,-164.64C473316,-156.08 473316,-147.12 473316,-138.34"/>
<polygon fill="black" stroke="black" points="473319.5,-138.15 473316,-128.15 473312.5,-138.15 473319.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3056" class="edge">
<title>layer_15_expert_5_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M473672.16,-164.93C473626.62,-153.69 473578.27,-141.75 473532.37,-130.42"/>
<polygon fill="black" stroke="black" points="473533.16,-127.01 473522.61,-128.01 473531.48,-133.81 473533.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3057" class="edge">
<title>layer_15_expert_6_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M474208.92,-164.97C474192.74,-162.07 474176.65,-159.38 474161,-157 473963.52,-127.02 473738.26,-106.36 473570.01,-93.55"/>
<polygon fill="black" stroke="black" points="473570.26,-90.06 473560.02,-92.8 473569.73,-97.04 473570.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_6&#45;&gt;layer_15_agg_ep_6 -->
<g id="edge3058" class="edge">
<title>layer_15_expert_7_ep_6&#45;&gt;layer_15_agg_ep_6</title>
<path fill="none" stroke="black" d="M474775.84,-164.94C474758.35,-161.94 474740.92,-159.24 474724,-157 474315.97,-102.88 473836.66,-85.34 473555.64,-79.68"/>
<polygon fill="black" stroke="black" points="473555.38,-76.17 473545.32,-79.47 473555.24,-83.17 473555.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_7 -->
<g id="node1644" class="node">
<title>layer_15_agg_ep_7</title>
<polygon fill="lightyellow" stroke="black" points="482607.07,-128 482156.77,-128 482040.93,-24 482491.23,-24 482607.07,-128"/>
<text text-anchor="middle" x="482324" y="-90" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="482324" y="-79" font-family="Arial" font-size="10.00">GPU: 496&#45;511</text>
<text text-anchor="middle" x="482324" y="-68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, expert_outputs=8]</text>
<text text-anchor="middle" x="482324" y="-57" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_expert_0_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3060" class="edge">
<title>layer_15_expert_0_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M480244.37,-175.09C480280.1,-167.94 480317.63,-161.4 480353,-157 480683.43,-115.9 481649.09,-91.08 482094.31,-81.52"/>
<polygon fill="black" stroke="black" points="482094.48,-85.02 482104.4,-81.31 482094.33,-78.02 482094.48,-85.02"/>
</g>
<!-- layer_15_expert_1_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3061" class="edge">
<title>layer_15_expert_1_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M480807.8,-175.46C480843.41,-168.31 480880.79,-161.67 480916,-157 481327.77,-102.39 481812.14,-85.03 482092.05,-79.53"/>
<polygon fill="black" stroke="black" points="482092.4,-83.02 482102.33,-79.33 482092.26,-76.02 482092.4,-83.02"/>
</g>
<!-- layer_15_expert_2_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3062" class="edge">
<title>layer_15_expert_2_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M481371.7,-176.34C481407.07,-169.17 481444.13,-162.29 481479,-157 481690.23,-124.93 481933.24,-103.53 482104.27,-90.99"/>
<polygon fill="black" stroke="black" points="482104.69,-94.47 482114.41,-90.25 482104.18,-87.49 482104.69,-94.47"/>
</g>
<!-- layer_15_expert_3_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3063" class="edge">
<title>layer_15_expert_3_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M481931.83,-173.82C481997.06,-157.72 482071.72,-139.29 482138.27,-122.86"/>
<polygon fill="black" stroke="black" points="482139.15,-126.24 482148.02,-120.45 482137.48,-119.45 482139.15,-126.24"/>
</g>
<!-- layer_15_expert_4_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3064" class="edge">
<title>layer_15_expert_4_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M482324,-164.64C482324,-156.08 482324,-147.12 482324,-138.34"/>
<polygon fill="black" stroke="black" points="482327.5,-138.15 482324,-128.15 482320.5,-138.15 482327.5,-138.15"/>
</g>
<!-- layer_15_expert_5_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3065" class="edge">
<title>layer_15_expert_5_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M482680.16,-164.93C482634.62,-153.69 482586.27,-141.75 482540.37,-130.42"/>
<polygon fill="black" stroke="black" points="482541.16,-127.01 482530.61,-128.01 482539.48,-133.81 482541.16,-127.01"/>
</g>
<!-- layer_15_expert_6_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3066" class="edge">
<title>layer_15_expert_6_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M483216.92,-164.97C483200.74,-162.07 483184.65,-159.38 483169,-157 482971.52,-127.02 482746.26,-106.36 482578.01,-93.55"/>
<polygon fill="black" stroke="black" points="482578.26,-90.06 482568.02,-92.8 482577.73,-97.04 482578.26,-90.06"/>
</g>
<!-- layer_15_expert_7_ep_7&#45;&gt;layer_15_agg_ep_7 -->
<g id="edge3067" class="edge">
<title>layer_15_expert_7_ep_7&#45;&gt;layer_15_agg_ep_7</title>
<path fill="none" stroke="black" d="M483783.84,-164.94C483766.35,-161.94 483748.92,-159.24 483732,-157 483323.97,-102.88 482844.66,-85.34 482563.64,-79.68"/>
<polygon fill="black" stroke="black" points="482563.38,-76.17 482553.32,-79.47 482563.24,-83.17 482563.38,-76.17"/>
</g>
<!-- layer_15_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3005" class="edge">
<title>layer_15_agg_ep_0&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M491562.57,-80.75C492197.41,-90.87 494024.75,-118.6 495544,-128 499213.6,-150.72 557928.34,-138.13 561598,-146 568866.19,-161.58 577839,-209.54 578920.7,-215.41"/>
<polygon fill="black" stroke="black" points="578920.77,-218.91 578930.79,-215.46 578920.81,-211.91 578920.77,-218.91"/>
</g>
<!-- layer_15_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3014" class="edge">
<title>layer_15_agg_ep_1&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M487058.57,-80.75C487693.41,-90.87 489520.75,-118.61 491040,-128 494942.65,-152.13 557386.29,-137.8 561289,-146 561758.88,-146.99 577462.4,-209.74 578920.7,-215.57"/>
<polygon fill="black" stroke="black" points="578920.88,-219.07 578930.9,-215.61 578920.91,-212.07 578920.88,-219.07"/>
</g>
<!-- layer_15_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3023" class="edge">
<title>layer_15_agg_ep_2&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M478050.57,-80.75C478685.41,-90.86 480512.75,-118.58 482032,-128 485389.71,-148.83 539114.22,-142.29 542472,-146 558029.78,-163.21 577311.84,-211.64 578921.05,-215.73"/>
<polygon fill="black" stroke="black" points="578921.13,-219.23 578931.14,-215.75 578921.15,-212.23 578921.13,-219.23"/>
</g>
<!-- layer_15_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3032" class="edge">
<title>layer_15_agg_ep_3&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M496066.57,-80.75C496701.41,-90.86 498528.75,-118.58 500048,-128 503531.93,-149.59 559276.01,-138 562760,-146 569527.89,-161.53 577879.36,-209.31 578920.75,-215.37"/>
<polygon fill="black" stroke="black" points="578920.82,-218.87 578930.84,-215.43 578920.86,-211.87 578920.82,-218.87"/>
</g>
<!-- layer_15_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3041" class="edge">
<title>layer_15_agg_ep_4&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M500570.57,-80.75C501205.41,-90.87 503032.75,-118.6 504552,-128 512033.19,-174.29 564402.76,-108.35 571884,-146 574748.8,-160.42 578259.5,-205.79 578919.36,-214.53"/>
<polygon fill="black" stroke="black" points="578919.76,-218.04 578929.8,-214.67 578919.85,-211.04 578919.76,-218.04"/>
</g>
<!-- layer_15_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3050" class="edge">
<title>layer_15_agg_ep_5&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M505070.51,-77.05C509341.23,-77.92 572614.23,-91.83 576458,-146 577409.06,-159.4 578557.47,-198.97 578916.32,-211.88"/>
<polygon fill="black" stroke="black" points="578916.33,-215.38 578926.45,-212.24 578916.59,-208.38 578916.33,-215.38"/>
</g>
<!-- layer_15_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3059" class="edge">
<title>layer_15_agg_ep_6&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M473546.57,-80.7C474181.42,-90.7 476008.75,-118.14 477528,-128 478910.84,-136.97 575250.09,-213.02 578921.33,-215.92"/>
<polygon fill="black" stroke="black" points="578921.51,-219.42 578931.51,-215.92 578921.52,-212.42 578921.51,-219.42"/>
</g>
<!-- layer_15_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall -->
<g id="edge3068" class="edge">
<title>layer_15_agg_ep_7&#45;&gt;layer_{layer_id}_moe_alltoall</title>
<path fill="none" stroke="black" d="M482554.57,-80.75C483189.41,-90.88 485016.75,-118.62 486536,-128 490655.87,-153.44 556575.06,-137.63 560695,-146 568351.61,-161.55 577806.73,-209.68 578920.34,-215.44"/>
<polygon fill="black" stroke="black" points="578920.71,-218.94 578930.73,-215.49 578920.74,-211.94 578920.71,-218.94"/>
</g>
<!-- layer_15_moe_alltoall -->
<g id="node1645" class="node">
<title>layer_15_moe_alltoall</title>
<ellipse fill="lightgreen" stroke="black" cx="493260" cy="-507" rx="196.65" ry="36.54"/>
<text text-anchor="middle" x="493260" y="-521" font-family="Arial" font-size="10.00">MoE All&#45;to&#45;All</text>
<text text-anchor="middle" x="493260" y="-510" font-family="Arial" font-size="10.00">GPUs: 384&#45;511</text>
<text text-anchor="middle" x="493260" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="493260" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_ln_tp_0 -->
<g id="node1646" class="node">
<title>layer_15_ln_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="505054.07,-559 504603.77,-559 504487.93,-455 504938.23,-455 505054.07,-559"/>
<text text-anchor="middle" x="504771" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="504771" y="-510" font-family="Arial" font-size="10.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="504771" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="504771" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_ln_tp_1 -->
<g id="node1647" class="node">
<title>layer_15_ln_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="505638.07,-559 505187.77,-559 505071.93,-455 505522.23,-455 505638.07,-559"/>
<text text-anchor="middle" x="505355" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="505355" y="-510" font-family="Arial" font-size="10.00">GPU: 416&#45;447</text>
<text text-anchor="middle" x="505355" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="505355" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_ln_tp_2 -->
<g id="node1648" class="node">
<title>layer_15_ln_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="506222.07,-559 505771.77,-559 505655.93,-455 506106.23,-455 506222.07,-559"/>
<text text-anchor="middle" x="505939" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="505939" y="-510" font-family="Arial" font-size="10.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="505939" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="505939" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- layer_15_ln_tp_3 -->
<g id="node1649" class="node">
<title>layer_15_ln_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="506806.07,-559 506355.77,-559 506239.93,-455 506690.23,-455 506806.07,-559"/>
<text text-anchor="middle" x="506523" y="-521" font-family="Arial" font-size="10.00">Layer Norm</text>
<text text-anchor="middle" x="506523" y="-510" font-family="Arial" font-size="10.00">GPU: 480&#45;511</text>
<text text-anchor="middle" x="506523" y="-499" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="506523" y="-488" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=1024, hidden_size=1024]</text>
</g>
<!-- output -->
<g id="node1650" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="black" points="579498.16,-1069 579034.99,-1069 578915.84,-965 579379.01,-965 579498.16,-1069"/>
<text text-anchor="middle" x="579207" y="-1031" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="579207" y="-1020" font-family="Arial" font-size="10.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="579207" y="-1009" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, hidden_size=1024]</text>
<text text-anchor="middle" x="579207" y="-998" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, vocab_size=32000]</text>
</g>
<!-- layer_{layer_id}_attn_tp_0 -->
<g id="node1652" class="node">
<title>layer_{layer_id}_attn_tp_0</title>
<polygon fill="lightyellow" stroke="black" points="144452.45,-235 144276.75,-235 144231.55,-199 144407.25,-199 144452.45,-235"/>
<text text-anchor="middle" x="144342" y="-214.5" font-family="Arial" font-size="10.00">layer_{layer_id}_attn_tp_0</text>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge9" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145153.3,-354.04C144974.11,-345.26 144662.76,-316.94 144408,-269 144366.08,-261.11 144319.92,-249.6 144295.79,-239.51"/>
<polygon fill="black" stroke="black" points="144297.15,-236.28 144286.61,-235.14 144294.14,-242.6 144297.15,-236.28"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge201" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145152.57,-353.56C144981.32,-344.27 144676.34,-316.11 144426,-269 144383.71,-261.04 144337.09,-249.4 144311.32,-239.24"/>
<polygon fill="black" stroke="black" points="144312.48,-235.93 144301.91,-235.14 144309.68,-242.35 144312.48,-235.93"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge393" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145151.95,-353.02C144987.84,-343.2 144689.62,-315.22 144444,-269 144401.18,-260.94 144353.91,-249.1 144326.45,-238.86"/>
<polygon fill="black" stroke="black" points="144327.52,-235.52 144316.94,-235.02 144324.91,-242.01 144327.52,-235.52"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge585" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145151.16,-352.37C144993.28,-342.01 144702.44,-314.24 144462,-269 144418.8,-260.87 144371.08,-248.89 144341.77,-238.59"/>
<polygon fill="black" stroke="black" points="144342.81,-235.24 144332.21,-235.02 144340.36,-241.8 144342.81,-235.24"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge777" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145150.17,-351.61C144997.67,-340.7 144714.8,-313.18 144480,-269 144436.42,-260.8 144388.25,-248.68 144357.01,-238.32"/>
<polygon fill="black" stroke="black" points="144358.08,-234.99 144347.48,-235.02 144355.79,-241.6 144358.08,-234.99"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge969" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145148.95,-350.73C145001.02,-339.26 144726.71,-312.03 144498,-269 144454.23,-260.76 144405.83,-248.58 144372.57,-238.19"/>
<polygon fill="black" stroke="black" points="144373.35,-234.76 144362.76,-235.02 144371.2,-241.42 144373.35,-234.76"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge1161" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145147.43,-349.71C145003.34,-337.68 144738.15,-310.8 144516,-269 144471.86,-260.69 144423,-248.37 144387.63,-237.92"/>
<polygon fill="black" stroke="black" points="144388.61,-234.56 144378.03,-235.02 144386.59,-241.26 144388.61,-234.56"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge1353" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145146.13,-348.58C145005.37,-336.05 144749.45,-309.54 144534,-269 144489.67,-260.66 144440.58,-248.26 144403.07,-237.78"/>
<polygon fill="black" stroke="black" points="144403.87,-234.37 144393.3,-235.02 144401.97,-241.11 144403.87,-234.37"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge1545" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145144.37,-347.28C145006.4,-334.27 144760.29,-308.19 144552,-269 144507.48,-260.62 144458.16,-248.16 144418.45,-237.65"/>
<polygon fill="black" stroke="black" points="144419.13,-234.21 144408.57,-235.02 144417.33,-240.97 144419.13,-234.21"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge1737" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145142.32,-345.83C145006.81,-332.38 144770.82,-306.79 144570,-269 144525.29,-260.59 144475.74,-248.05 144433.78,-237.52"/>
<polygon fill="black" stroke="black" points="144434.39,-234.06 144423.84,-235.02 144432.69,-240.85 144434.39,-234.06"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge1929" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145140.2,-344.25C145006.95,-330.42 144781.2,-305.35 144588,-269 144543.1,-260.55 144493.32,-247.95 144449.06,-237.38"/>
<polygon fill="black" stroke="black" points="144449.65,-233.93 144439.11,-235.02 144448.03,-240.74 144449.65,-233.93"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge2121" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145137.91,-342.53C145006.85,-328.39 144791.43,-303.89 144606,-269 144560.17,-260.38 144509.26,-247.42 144461.98,-236.73"/>
<polygon fill="black" stroke="black" points="144462.47,-233.25 144451.95,-234.48 144460.94,-240.08 144462.47,-233.25"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge2313" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145135.34,-340.66C145006.49,-326.28 144801.51,-302.4 144624,-269 144571.77,-259.17 144512.93,-243.72 144456.94,-232.4"/>
<polygon fill="black" stroke="black" points="144457.38,-228.91 144446.89,-230.4 144456.02,-235.78 144457.38,-228.91"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge2505" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145144.15,-339.98C145018.16,-325.54 144816.77,-301.88 144642,-269 144584.37,-258.16 144518.7,-240.46 144453.05,-229.03"/>
<polygon fill="black" stroke="black" points="144453.39,-225.54 144442.95,-227.32 144452.22,-232.44 144453.39,-225.54"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge2697" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145158.99,-339.98C145036.16,-325.54 144834.77,-301.88 144660,-269 144598.04,-257.34 144526.78,-237.76 144450.48,-226.56"/>
<polygon fill="black" stroke="black" points="144450.57,-223.04 144440.18,-225.1 144449.59,-229.97 144450.57,-223.04"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0 -->
<g id="edge2889" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_0</title>
<path fill="none" stroke="black" d="M145173.83,-339.98C145054.16,-325.54 144852.77,-301.88 144678,-269 144612.44,-256.66 144536.48,-235.47 144448.32,-224.7"/>
<polygon fill="black" stroke="black" points="144448.69,-221.22 144438.36,-223.53 144447.88,-228.17 144448.69,-221.22"/>
</g>
<!-- layer_{layer_id}_attn_tp_1 -->
<g id="node1653" class="node">
<title>layer_{layer_id}_attn_tp_1</title>
<polygon fill="lightyellow" stroke="black" points="144772.45,-235 144596.75,-235 144551.55,-199 144727.25,-199 144772.45,-235"/>
<text text-anchor="middle" x="144662" y="-214.5" font-family="Arial" font-size="10.00">layer_{layer_id}_attn_tp_1</text>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge10" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145149.57,-351.19C145016.76,-338.1 144845.01,-304.62 144703,-269 144668.32,-260.3 144630.16,-249.41 144609.69,-239.93"/>
<polygon fill="black" stroke="black" points="144611.18,-236.75 144600.71,-235.11 144607.88,-242.92 144611.18,-236.75"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge202" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145147.73,-349.96C145024.44,-336.08 144858.74,-303.55 144721,-269 144685.84,-260.18 144647.11,-249.11 144625.27,-239.53"/>
<polygon fill="black" stroke="black" points="144626.77,-236.37 144616.25,-235.11 144623.69,-242.66 144626.77,-236.37"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge394" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145145.7,-348.44C145030.9,-333.81 144871.92,-302.34 144739,-269 144703.52,-260.1 144664.41,-248.91 144641.05,-239.28"/>
<polygon fill="black" stroke="black" points="144642.34,-236.02 144631.78,-235.11 144639.47,-242.4 144642.34,-236.02"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge586" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145143.48,-346.59C145036.15,-331.27 144884.58,-301 144757,-269 144721.2,-260.02 144681.7,-248.71 144656.75,-239.02"/>
<polygon fill="black" stroke="black" points="144657.89,-235.7 144647.31,-235.11 144655.22,-242.17 144657.89,-235.7"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge778" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145140.14,-344.24C145039.39,-328.31 144896.34,-299.43 144775,-269 144738.88,-259.94 144699,-248.5 144672.37,-238.76"/>
<polygon fill="black" stroke="black" points="144673.43,-235.42 144662.84,-235.11 144670.93,-241.96 144673.43,-235.42"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge970" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145136.43,-341.45C145041.5,-325.08 144907.57,-297.74 144793,-269 144756.56,-259.86 144716.3,-248.3 144687.9,-238.5"/>
<polygon fill="black" stroke="black" points="144688.97,-235.17 144678.38,-235.11 144686.63,-241.76 144688.97,-235.17"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge1162" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145141.85,-339.97C145051.6,-323.46 144922.19,-296.89 144811,-269 144774.41,-259.82 144733.95,-248.2 144703.74,-238.37"/>
<polygon fill="black" stroke="black" points="144704.5,-234.94 144693.91,-235.11 144702.3,-241.58 144704.5,-234.94"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge1354" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145155.77,-339.97C145069.6,-323.46 144940.19,-296.89 144829,-269 144792.09,-259.74 144751.24,-248 144719.12,-238.12"/>
<polygon fill="black" stroke="black" points="144720.03,-234.74 144709.44,-235.11 144717.95,-241.42 144720.03,-234.74"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge1546" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145169.7,-339.97C145087.6,-323.46 144958.19,-296.89 144847,-269 144809.93,-259.7 144768.89,-247.9 144734.84,-237.99"/>
<polygon fill="black" stroke="black" points="144735.55,-234.55 144724.97,-235.11 144733.6,-241.27 144735.55,-234.55"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge1738" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145183.63,-339.97C145105.6,-323.46 144976.19,-296.89 144865,-269 144827.77,-259.66 144786.54,-247.8 144750.52,-237.86"/>
<polygon fill="black" stroke="black" points="144751.08,-234.39 144740.51,-235.11 144749.22,-241.14 144751.08,-234.39"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge1930" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145197.55,-339.97C145123.6,-323.46 144994.19,-296.89 144883,-269 144845.61,-259.62 144804.18,-247.7 144766.15,-237.73"/>
<polygon fill="black" stroke="black" points="144766.6,-234.24 144756.04,-235.11 144764.84,-241.01 144766.6,-234.24"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge2122" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145211.48,-339.97C145141.6,-323.46 145012.19,-296.89 144901,-269 144863.37,-259.56 144821.66,-247.54 144781.48,-237.54"/>
<polygon fill="black" stroke="black" points="144782.12,-234.1 144771.57,-235.11 144780.45,-240.9 144782.12,-234.1"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge2314" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145225.41,-339.97C145159.6,-323.46 145030.19,-296.89 144919,-269 144875.25,-258.03 144825.97,-243.56 144776.94,-232.84"/>
<polygon fill="black" stroke="black" points="144777.65,-229.41 144767.14,-230.75 144776.19,-236.26 144777.65,-229.41"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge2506" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145239.33,-339.97C145177.6,-323.46 145048.19,-296.89 144937,-269 144887.97,-256.7 144831.99,-240.02 144772.91,-229.14"/>
<polygon fill="black" stroke="black" points="144773.48,-225.68 144763.02,-227.37 144772.25,-232.57 144773.48,-225.68"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge2698" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145253.26,-339.97C145195.6,-323.46 145066.19,-296.89 144955,-269 144901.73,-255.64 144840.27,-237.11 144770.01,-226.45"/>
<polygon fill="black" stroke="black" points="144770.44,-222.98 144760.04,-225 144769.44,-229.91 144770.44,-222.98"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1 -->
<g id="edge2890" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_1</title>
<path fill="none" stroke="black" d="M145267.19,-339.97C145213.6,-323.46 145084.19,-296.89 144973,-269 144916.37,-254.8 144850.47,-234.74 144767.96,-224.53"/>
<polygon fill="black" stroke="black" points="144768.15,-221.03 144757.81,-223.34 144767.33,-227.98 144768.15,-221.03"/>
</g>
<!-- layer_{layer_id}_attn_tp_2 -->
<g id="node1654" class="node">
<title>layer_{layer_id}_attn_tp_2</title>
<polygon fill="lightyellow" stroke="black" points="145067.45,-235 144891.75,-235 144846.55,-199 145022.25,-199 145067.45,-235"/>
<text text-anchor="middle" x="144957" y="-214.5" font-family="Arial" font-size="10.00">layer_{layer_id}_attn_tp_2</text>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge11" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145146.61,-339.96C145056.66,-315.78 144958.69,-271.35 144930.47,-243.32"/>
<polygon fill="black" stroke="black" points="144932.98,-240.85 144924.03,-235.18 144927.49,-245.2 144932.98,-240.85"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge203" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145155.84,-339.96C145070.31,-315.57 144971.89,-270.59 144940.35,-242.6"/>
<polygon fill="black" stroke="black" points="144942.72,-240.01 144933.29,-235.18 144937.65,-244.84 144942.72,-240.01"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge395" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145165.07,-339.96C145084.05,-315.36 144985.09,-269.82 144950.03,-241.88"/>
<polygon fill="black" stroke="black" points="144952.33,-239.24 144942.55,-235.18 144947.67,-244.46 144952.33,-239.24"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge587" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145174.3,-339.96C145098.2,-315.26 144999.14,-269.43 144960.02,-241.53"/>
<polygon fill="black" stroke="black" points="144961.86,-238.53 144951.81,-235.18 144957.58,-244.07 144961.86,-238.53"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge779" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145183.53,-339.96C145112.09,-315.05 145012.37,-268.66 144969.35,-240.83"/>
<polygon fill="black" stroke="black" points="144971.3,-237.92 144961.07,-235.18 144967.36,-243.7 144971.3,-237.92"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge971" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145192.76,-339.96C145126.35,-314.95 145026.43,-268.27 144979.07,-240.48"/>
<polygon fill="black" stroke="black" points="144980.69,-237.37 144970.32,-235.18 144977.07,-243.36 144980.69,-237.37"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge1163" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145201.98,-339.96C145140.66,-314.84 145040.5,-267.88 144988.68,-240.13"/>
<polygon fill="black" stroke="black" points="144990.04,-236.89 144979.58,-235.18 144986.69,-243.04 144990.04,-236.89"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge1355" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145211.21,-339.96C145154.89,-314.68 145054.16,-267.29 144997.82,-239.62"/>
<polygon fill="black" stroke="black" points="144999.36,-236.47 144988.84,-235.18 144996.26,-242.75 144999.36,-236.47"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge1547" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145220.44,-339.96C145169.4,-314.63 145068.65,-267.1 145007.55,-239.44"/>
<polygon fill="black" stroke="black" points="145008.65,-236.1 144998.1,-235.18 145005.78,-242.48 145008.65,-236.1"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge1739" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145229.67,-339.96C145183.77,-314.49 145082.46,-266.58 145016.55,-238.99"/>
<polygon fill="black" stroke="black" points="145017.67,-235.67 145007.09,-235.07 145014.99,-242.13 145017.67,-235.67"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge1931" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145238.9,-339.96C145198.26,-314.39 145096.54,-266.18 145025.68,-238.65"/>
<polygon fill="black" stroke="black" points="145026.92,-235.38 145016.32,-235.07 145024.41,-241.92 145026.92,-235.38"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge2123" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145248.13,-339.96C145212.87,-314.34 145111.04,-265.99 145035.15,-238.49"/>
<polygon fill="black" stroke="black" points="145036.15,-235.13 145025.56,-235.07 145033.81,-241.72 145036.15,-235.13"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge2315" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145257.36,-339.96C145227.49,-314.29 145125.54,-265.79 145044.56,-238.32"/>
<polygon fill="black" stroke="black" points="145045.39,-234.9 145034.79,-235.07 145043.18,-241.55 145045.39,-234.9"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge2507" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145266.58,-339.96C145242.12,-314.21 145139.83,-265.49 145053.65,-238.07"/>
<polygon fill="black" stroke="black" points="145054.62,-234.7 145044.03,-235.07 145052.54,-241.39 145054.62,-234.7"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge2699" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145275.81,-339.96C145256.8,-314.15 145154.33,-265.29 145062.92,-237.9"/>
<polygon fill="black" stroke="black" points="145063.85,-234.52 145053.26,-235.07 145061.88,-241.24 145063.85,-234.52"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2 -->
<g id="edge2891" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_2</title>
<path fill="none" stroke="black" d="M145285.04,-339.96C145271.51,-314.13 145169.04,-265.2 145072.43,-237.82"/>
<polygon fill="black" stroke="black" points="145073.07,-234.36 145062.5,-235.07 145071.21,-241.11 145073.07,-234.36"/>
</g>
<!-- layer_{layer_id}_attn_tp_3 -->
<g id="node1655" class="node">
<title>layer_{layer_id}_attn_tp_3</title>
<polygon fill="lightyellow" stroke="black" points="145362.45,-235 145186.75,-235 145141.55,-199 145317.25,-199 145362.45,-235"/>
<text text-anchor="middle" x="145252" y="-214.5" font-family="Arial" font-size="10.00">layer_{layer_id}_attn_tp_3</text>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge12" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145182.79,-339.96C145142.22,-314.58 145140.18,-266.88 145176.66,-239.26"/>
<polygon fill="black" stroke="black" points="145178.65,-242.14 145185.04,-233.68 145174.77,-236.31 145178.65,-242.14"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge204" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145192.01,-339.96C145157.95,-315.36 145155.23,-269.82 145183.87,-241.88"/>
<polygon fill="black" stroke="black" points="145186.43,-244.3 145191.82,-235.18 145181.92,-238.95 145186.43,-244.3"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge396" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145201.24,-339.96C145172.66,-315.57 145170.16,-270.59 145193.74,-242.6"/>
<polygon fill="black" stroke="black" points="145196.53,-244.75 145201.08,-235.18 145191.56,-239.83 145196.53,-244.75"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge588" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145210.47,-339.96C145187.29,-315.78 145185.08,-271.35 145203.84,-243.32"/>
<polygon fill="black" stroke="black" points="145206.83,-245.18 145210.34,-235.18 145201.36,-240.81 145206.83,-245.18"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge780" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145219.7,-339.96C145201.82,-315.99 145199.98,-272.12 145214.17,-244.05"/>
<polygon fill="black" stroke="black" points="145217.36,-245.54 145219.6,-235.18 145211.39,-241.88 145217.36,-245.54"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge972" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145228.93,-339.96C145216.21,-316.09 145214.85,-272.5 145224.85,-244.41"/>
<polygon fill="black" stroke="black" points="145228.08,-245.75 145228.85,-235.18 145221.66,-242.96 145228.08,-245.75"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge1164" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145238.16,-339.96C145230.6,-316.3 145229.73,-273.26 145235.55,-245.15"/>
<polygon fill="black" stroke="black" points="145239.02,-245.74 145238.11,-235.18 145232.24,-244 145239.02,-245.74"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge1356" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145247.39,-339.96C145244.87,-316.3 145244.58,-273.26 145246.52,-245.15"/>
<polygon fill="black" stroke="black" points="145250.01,-245.45 145247.37,-235.18 145243.03,-244.85 145250.01,-245.45"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge1548" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145256.61,-339.96C145259.13,-316.3 145259.42,-273.26 145257.48,-245.15"/>
<polygon fill="black" stroke="black" points="145260.97,-244.85 145256.63,-235.18 145253.99,-245.45 145260.97,-244.85"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge1740" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145265.84,-339.96C145273.4,-316.3 145274.27,-273.26 145268.45,-245.15"/>
<polygon fill="black" stroke="black" points="145271.76,-244 145265.89,-235.18 145264.98,-245.74 145271.76,-244"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge1932" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145275.07,-339.96C145287.79,-316.09 145289.15,-272.5 145279.15,-244.41"/>
<polygon fill="black" stroke="black" points="145282.34,-242.96 145275.15,-235.18 145275.92,-245.75 145282.34,-242.96"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge2124" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145284.3,-339.96C145302.18,-315.99 145304.02,-272.12 145289.83,-244.05"/>
<polygon fill="black" stroke="black" points="145292.61,-241.88 145284.4,-235.18 145286.64,-245.54 145292.61,-241.88"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge2316" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145293.53,-339.96C145316.71,-315.78 145318.92,-271.35 145300.16,-243.32"/>
<polygon fill="black" stroke="black" points="145302.64,-240.81 145293.66,-235.18 145297.17,-245.18 145302.64,-240.81"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge2508" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145302.76,-339.96C145331.34,-315.57 145333.84,-270.59 145310.26,-242.6"/>
<polygon fill="black" stroke="black" points="145312.44,-239.83 145302.92,-235.18 145307.47,-244.75 145312.44,-239.83"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge2700" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145311.99,-339.96C145346.05,-315.36 145348.77,-269.82 145320.13,-241.88"/>
<polygon fill="black" stroke="black" points="145322.08,-238.95 145312.18,-235.18 145317.57,-244.3 145322.08,-238.95"/>
</g>
<!-- layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3 -->
<g id="edge2892" class="edge">
<title>layer_{layer_id}_qkv_comm&#45;&gt;layer_{layer_id}_attn_tp_3</title>
<path fill="none" stroke="black" d="M145321.21,-339.96C145360.86,-315.15 145363.71,-269.04 145329.77,-241.18"/>
<polygon fill="black" stroke="black" points="145331.6,-238.18 145321.44,-235.18 145327.51,-243.86 145331.6,-238.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_0 -->
<g id="edge189" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_0</title>
<path fill="none" stroke="black" d="M145204.53,-695.08C145279.22,-710.72 145374.65,-736.24 145398,-768 145404.11,-776.31 145357.24,-940.8 145349,-947 145349,-947 20669,-957 20669,-957 20635.15,-960.4 20599.42,-965.96 20565.03,-972.35"/>
<polygon fill="black" stroke="black" points="20564.06,-968.98 20554.88,-974.27 20565.36,-975.85 20564.06,-968.98"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_1 -->
<g id="edge191" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_1</title>
<path fill="none" stroke="black" d="M145107.92,-695.32C145100.88,-745.16 145073.05,-889.05 144981,-947 144981,-947 20087,-957 20087,-957 20053.15,-960.4 20017.42,-965.96 19983.03,-972.35"/>
<polygon fill="black" stroke="black" points="19982.06,-968.98 19972.88,-974.27 19983.36,-975.85 19982.06,-968.98"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_2 -->
<g id="edge193" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_2</title>
<path fill="none" stroke="black" d="M145218.72,-695.07C145298.85,-710.14 145398.04,-734.86 145423,-768 145447.41,-800.41 145418.52,-921.45 145387,-947 145387,-947 24389,-957 24389,-957 23182.58,-967.43 21737.67,-998.31 21187.65,-1010.74"/>
<polygon fill="black" stroke="black" points="21187.54,-1007.24 21177.62,-1010.96 21187.7,-1014.24 21187.54,-1007.24"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_3 -->
<g id="edge195" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_0_gate_tp_3</title>
<path fill="none" stroke="black" d="M145038.48,-695.04C144934.06,-718.96 144733.45,-761.33 144560,-777 142555.11,-958.14 74103.06,-927.36 72090,-930 71998.71,-930.12 19595.83,-947.86 19505,-957 19471.27,-960.39 19435.67,-965.94 19401.38,-972.3"/>
<polygon fill="black" stroke="black" points="19400.45,-968.92 19391.27,-974.21 19401.75,-975.79 19400.45,-968.92"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_0 -->
<g id="edge381" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_0</title>
<path fill="none" stroke="black" d="M145022.9,-687.66C144825.42,-709.03 144328.38,-759.75 143911,-777 143609.13,-789.47 57198.99,-768.79 56898,-795 56866.05,-797.78 56832.34,-802.25 56799.65,-807.41"/>
<polygon fill="black" stroke="black" points="56798.86,-803.99 56789.54,-809.03 56799.97,-810.9 56798.86,-803.99"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_1 -->
<g id="edge383" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_1</title>
<path fill="none" stroke="black" d="M145016.65,-683.31C144699.08,-701.09 143631.25,-758.41 142748,-777 142447.96,-783.32 56614.98,-768.97 56316,-795 56284.05,-797.78 56250.34,-802.25 56217.65,-807.41"/>
<polygon fill="black" stroke="black" points="56216.86,-803.99 56207.54,-809.03 56217.97,-810.9 56216.86,-803.99"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_2 -->
<g id="edge385" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_2</title>
<path fill="none" stroke="black" d="M145033.14,-694.69C144918.71,-718.59 144696.48,-761.42 144505,-777 144214.99,-800.6 60995.96,-792.86 60705,-795 59464.6,-804.13 57978.24,-830.9 57417.79,-841.55"/>
<polygon fill="black" stroke="black" points="57417.5,-838.05 57407.57,-841.74 57417.63,-845.05 57417.5,-838.05"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_3 -->
<g id="edge387" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_1_gate_tp_3</title>
<path fill="none" stroke="black" d="M145012.81,-680.82C144523.74,-694.87 142283.06,-757.32 140448,-777 140153.87,-780.15 56027.04,-769.48 55734,-795 55702.05,-797.78 55668.34,-802.25 55635.65,-807.41"/>
<polygon fill="black" stroke="black" points="55634.86,-803.99 55625.54,-809.03 55635.97,-810.9 55634.86,-803.99"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_0 -->
<g id="edge573" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_0</title>
<path fill="none" stroke="black" d="M145007.99,-677.39C143431.18,-683.32 123885.75,-756.08 108120,-777.5 107891.11,-777.81 91865.91,-814.33 91640,-777.5 91584.74,-768.49 91525.93,-750.72 91475.15,-732.6"/>
<polygon fill="black" stroke="black" points="91476.03,-729.2 91465.43,-729.09 91473.65,-735.78 91476.03,-729.2"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_1 -->
<g id="edge575" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_1</title>
<path fill="none" stroke="black" d="M145007.99,-677.39C143431.18,-683.32 123885.75,-756.08 108120,-777.5 107907.28,-777.79 93013.95,-811.73 92804,-777.5 92748.74,-768.49 92689.93,-750.72 92639.15,-732.6"/>
<polygon fill="black" stroke="black" points="92640.03,-729.2 92629.43,-729.09 92637.65,-735.78 92640.03,-729.2"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_2 -->
<g id="edge577" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_2</title>
<path fill="none" stroke="black" d="M145007.99,-677.39C143431.18,-683.32 123885.75,-756.08 108120,-777.5 106825.78,-779.26 97766.08,-796.7 96472,-777.5 95294.88,-760.03 93888.33,-708.43 93330.88,-686.76"/>
<polygon fill="black" stroke="black" points="93330.83,-683.26 93320.7,-686.36 93330.56,-690.25 93330.83,-683.26"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_3 -->
<g id="edge579" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_2_gate_tp_3</title>
<path fill="none" stroke="black" d="M145007.99,-677.39C143431.18,-683.32 123885.75,-756.08 108120,-777.5 107899.19,-777.8 92439.93,-813.03 92222,-777.5 92166.74,-768.49 92107.93,-750.72 92057.15,-732.6"/>
<polygon fill="black" stroke="black" points="92058.03,-729.2 92047.43,-729.09 92055.65,-735.78 92058.03,-729.2"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_0 -->
<g id="edge765" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_0</title>
<path fill="none" stroke="black" d="M144995.88,-669.07C144877.37,-660.35 144687.11,-642.06 144526,-607 144513.23,-604.22 144510.91,-600.03 144498,-598 144380.82,-579.6 127535.49,-606.27 127418,-590 127375.19,-584.07 127329.82,-573.48 127287.96,-561.83"/>
<polygon fill="black" stroke="black" points="127288.82,-558.43 127278.24,-559.09 127286.92,-565.17 127288.82,-558.43"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_1 -->
<g id="edge767" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_1</title>
<path fill="none" stroke="black" d="M144994.64,-668.13C144880.86,-658.89 144702.48,-640.38 144551,-607 144538.23,-604.19 144535.91,-600.03 144523,-598 144409.65,-580.2 128113.66,-605.74 128000,-590 127957.19,-584.07 127911.82,-573.48 127869.96,-561.83"/>
<polygon fill="black" stroke="black" points="127870.82,-558.43 127860.24,-559.09 127868.92,-565.17 127870.82,-558.43"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_2 -->
<g id="edge769" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_2</title>
<path fill="none" stroke="black" d="M144993.05,-667.07C144884.14,-657.31 144717.75,-638.66 144576,-607 144563.24,-604.15 144560.91,-600.03 144548,-598 144438.47,-580.8 128691.83,-605.21 128582,-590 128539.19,-584.07 128493.82,-573.48 128451.96,-561.83"/>
<polygon fill="black" stroke="black" points="128452.82,-558.43 128442.24,-559.09 128450.92,-565.17 128452.82,-558.43"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_3 -->
<g id="edge771" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_3_gate_tp_3</title>
<path fill="none" stroke="black" d="M144991.18,-665.87C144887.34,-655.61 144732.98,-636.91 144601,-607 144588.25,-604.11 144585.91,-600.03 144573,-598 144531.61,-591.5 132547.9,-590.49 132506,-590 131229.55,-575.17 129701.31,-532.56 129116.71,-515.34"/>
<polygon fill="black" stroke="black" points="129116.57,-511.84 129106.47,-515.04 129116.36,-518.84 129116.57,-511.84"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_0 -->
<g id="edge957" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_0</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 578913,-768 578913,-768 578927.99,-774.55 578932.03,-779.77 578938,-795 578962.98,-858.74 578978.43,-926.86 578913,-947 578913,-947 274175,-957 274175,-957 274141.15,-960.4 274105.42,-965.96 274071.03,-972.35"/>
<polygon fill="black" stroke="black" points="274070.06,-968.97 274060.88,-974.27 274071.36,-975.85 274070.06,-968.97"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_1 -->
<g id="edge959" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_1</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 578934,-768 578934,-768 578950.03,-774.47 578955.24,-779.09 578962,-795 578988.8,-858.08 579001.68,-927.43 578936,-947 578936,-947 274757,-957 274757,-957 274723.15,-960.4 274687.42,-965.96 274653.03,-972.35"/>
<polygon fill="black" stroke="black" points="274652.06,-968.97 274642.88,-974.27 274653.36,-975.85 274652.06,-968.97"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_2 -->
<g id="edge961" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_2</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 578896,-768 578896,-768 578952.25,-824.25 578952.25,-890.74 578896,-947 578896,-947 273593,-957 273593,-957 273559.15,-960.4 273523.42,-965.96 273489.03,-972.35"/>
<polygon fill="black" stroke="black" points="273488.06,-968.97 273478.88,-974.27 273489.36,-975.85 273488.06,-968.97"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_3 -->
<g id="edge963" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_4_gate_tp_3</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 578956,-768 578956,-768 578972.75,-774.43 578978.7,-778.61 578986,-795 579013.91,-857.68 579024.92,-927.97 578959,-947 578959,-947 275367,-957 275367,-957 275325.07,-960.85 275280.43,-967.48 275238.23,-974.94"/>
<polygon fill="black" stroke="black" points="275237.36,-971.54 275228.13,-976.75 275238.59,-978.43 275237.36,-971.54"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_0 -->
<g id="edge1149" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_0</title>
<path fill="none" stroke="black" d="M145200.34,-695.02C145295.19,-712.95 145448.64,-742.12 145581,-768 145601.02,-771.91 145605.7,-774.99 145626,-777 145926.48,-806.78 232286.19,-768.81 232587,-795 232587.1,-795.01 232587.21,-795.02 232587.31,-795.03"/>
<polygon fill="black" stroke="black" points="232586.74,-798.49 232597.02,-795.92 232587.38,-791.52 232586.74,-798.49"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_1 -->
<g id="edge1151" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_1</title>
<path fill="none" stroke="black" d="M145173.72,-695.07C145266.78,-719.03 145445.69,-761.44 145601,-777 146181.76,-835.2 227119.15,-845.4 232060.18,-845.97"/>
<polygon fill="black" stroke="black" points="232060.48,-849.47 232070.48,-845.97 232060.48,-842.47 232060.48,-849.47"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_2 -->
<g id="edge1153" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_2</title>
<path fill="none" stroke="black" d="M145221.3,-695.03C145324.37,-711.44 145481.69,-738.14 145617,-768 145632.26,-771.37 145635.5,-774.98 145651,-777 145952.34,-816.24 232866.26,-768.64 233169,-795 233169.1,-795.01 233169.21,-795.02 233169.31,-795.03"/>
<polygon fill="black" stroke="black" points="233168.74,-798.49 233179.02,-795.92 233169.38,-791.52 233168.74,-798.49"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_3 -->
<g id="edge1155" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_5_gate_tp_3</title>
<path fill="none" stroke="black" d="M145237.42,-694C145347.1,-709.03 145509.16,-734.26 145648,-768 145660.7,-771.09 145663.09,-774.97 145676,-777 145827.06,-800.7 233598.67,-781.74 233751,-795 233751.1,-795.01 233751.21,-795.02 233751.31,-795.03"/>
<polygon fill="black" stroke="black" points="233750.74,-798.49 233761.02,-795.92 233751.38,-791.52 233750.74,-798.49"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_0 -->
<g id="edge1341" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_0</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145383.14,-813.93 154243.5,-778.55 154370,-777.5 156648.56,-758.64 159407.76,-699.96 160210.67,-682.17"/>
<polygon fill="black" stroke="black" points="160210.98,-685.66 160220.9,-681.94 160210.82,-678.66 160210.98,-685.66"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_1 -->
<g id="edge1343" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_1</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145315.34,-793.54 161249.02,-786.46 161304,-777.5 161359.26,-768.49 161418.07,-750.72 161468.85,-732.6"/>
<polygon fill="black" stroke="black" points="161470.35,-735.78 161478.57,-729.09 161467.97,-729.2 161470.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_2 -->
<g id="edge1345" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_2</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145317.28,-794.12 161829.03,-786.79 161886,-777.5 161941.26,-768.49 162000.07,-750.72 162050.85,-732.6"/>
<polygon fill="black" stroke="black" points="162052.35,-735.78 162060.57,-729.09 162049.97,-729.2 162052.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_3 -->
<g id="edge1347" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_6_gate_tp_3</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145313.41,-792.96 160669.02,-786.14 160722,-777.5 160777.26,-768.49 160836.07,-750.72 160886.85,-732.6"/>
<polygon fill="black" stroke="black" points="160888.35,-735.78 160896.57,-729.09 160885.97,-729.2 160888.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_0 -->
<g id="edge1533" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_0</title>
<path fill="none" stroke="black" d="M144997.49,-670.12C144917.27,-662.08 144830.96,-643.05 144876,-598 144876,-598 190453,-590 190453,-590 192902.93,-574.3 195873.1,-526.06 196709.89,-511.93"/>
<polygon fill="black" stroke="black" points="196710,-515.43 196719.94,-511.76 196709.88,-508.43 196710,-515.43"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_1 -->
<g id="edge1535" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_1</title>
<path fill="none" stroke="black" d="M144990.01,-665.09C144924.62,-654.79 144863.9,-635.11 144901,-598 144901,-598 197230,-590 197230,-590 197272.81,-584.08 197318.18,-573.49 197360.04,-561.84"/>
<polygon fill="black" stroke="black" points="197361.09,-565.18 197369.76,-559.1 197359.19,-558.44 197361.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_2 -->
<g id="edge1537" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_2</title>
<path fill="none" stroke="black" d="M144987.25,-658.94C144936.62,-647.13 144896.01,-627.99 144926,-598 144926,-598 197812,-590 197812,-590 197854.81,-584.08 197900.18,-573.49 197942.04,-561.84"/>
<polygon fill="black" stroke="black" points="197943.09,-565.18 197951.76,-559.1 197941.19,-558.44 197943.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_3 -->
<g id="edge1539" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_7_gate_tp_3</title>
<path fill="none" stroke="black" d="M145013.75,-658.96C144965.31,-646.47 144922.36,-626.65 144951,-598 144951,-598 198394,-590 198394,-590 198436.81,-584.08 198482.18,-573.49 198524.04,-561.84"/>
<polygon fill="black" stroke="black" points="198525.09,-565.18 198533.76,-559.1 198523.19,-558.44 198525.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_0 -->
<g id="edge1725" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_0</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579001,-768 579001,-768 579019.22,-774.35 579026.61,-777.62 579035,-795 579064.94,-857.01 579071.58,-929.44 579005,-947 579005,-947 418308,-957 418308,-957 418274.15,-960.4 418238.42,-965.96 418204.03,-972.35"/>
<polygon fill="black" stroke="black" points="418203.06,-968.98 418193.88,-974.27 418204.36,-975.85 418203.06,-968.98"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_1 -->
<g id="edge1727" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_1</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579024,-768 579024,-768 579042.6,-774.34 579050.33,-777.37 579059,-795 579089.38,-856.8 579095.58,-929.44 579029,-947 579029,-947 418890,-957 418890,-957 418856.15,-960.4 418820.42,-965.96 418786.03,-972.35"/>
<polygon fill="black" stroke="black" points="418785.06,-968.98 418775.88,-974.27 418786.36,-975.85 418785.06,-968.98"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_2 -->
<g id="edge1729" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_2</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 578978,-768 578978,-768 578995.48,-774.39 579002.16,-778.12 579010,-795 579038.95,-857.3 579048.15,-928.49 578982,-947 578982,-947 417726,-957 417726,-957 417692.15,-960.4 417656.42,-965.96 417622.03,-972.35"/>
<polygon fill="black" stroke="black" points="417621.06,-968.98 417611.88,-974.27 417622.36,-975.85 417621.06,-968.98"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_3 -->
<g id="edge1731" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_8_gate_tp_3</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579048,-768 579048,-768 579066.6,-774.34 579074.33,-777.37 579083,-795 579113.38,-856.8 579119.58,-929.44 579053,-947 579053,-947 422655,-957 422655,-957 421430.69,-967.43 419963.94,-998.41 419408.83,-1010.8"/>
<polygon fill="black" stroke="black" points="419408.63,-1007.3 419398.71,-1011.02 419408.78,-1014.3 419408.63,-1007.3"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_0 -->
<g id="edge1917" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_0</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 542872,-768 542872,-768 542874.83,-770.83 542874.83,-774.17 542872,-777 542872,-777 382355,-795 382355,-795 382323.05,-797.78 382289.34,-802.25 382256.65,-807.41"/>
<polygon fill="black" stroke="black" points="382255.86,-803.99 382246.54,-809.03 382256.96,-810.9 382255.86,-803.99"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_1 -->
<g id="edge1919" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_1</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 542887,-768 542887,-768 542889.83,-770.83 542889.83,-774.17 542887,-777 542887,-777 382937,-795 382937,-795 382905.05,-797.78 382871.34,-802.25 382838.65,-807.41"/>
<polygon fill="black" stroke="black" points="382837.86,-803.99 382828.54,-809.03 382838.96,-810.9 382837.86,-803.99"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_2 -->
<g id="edge1921" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_2</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 542857,-768 542857,-768 542859.83,-770.83 542859.83,-774.17 542857,-777 542857,-777 381773,-795 381773,-795 381741.05,-797.78 381707.34,-802.25 381674.65,-807.41"/>
<polygon fill="black" stroke="black" points="381673.86,-803.99 381664.54,-809.03 381674.96,-810.9 381673.86,-803.99"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_3 -->
<g id="edge1923" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_9_gate_tp_3</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 542902,-768 542902,-768 542904.83,-770.83 542904.83,-774.17 542902,-777 542902,-777 386616,-795 386616,-795 385426.89,-804.02 384003.21,-830.59 383456.85,-841.38"/>
<polygon fill="black" stroke="black" points="383456.41,-837.88 383446.48,-841.58 383456.55,-844.88 383456.41,-837.88"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_0 -->
<g id="edge2109" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_0</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145389.77,-815.92 298835.58,-778.62 298969,-777.5 301204.24,-758.67 303910.2,-700.14 304703.91,-682.25"/>
<polygon fill="black" stroke="black" points="304704.11,-685.75 304714.02,-682.02 304703.95,-678.75 304704.11,-685.75"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_1 -->
<g id="edge2111" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_1</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145262,-777.5 305797,-777.5 305797,-777.5 305852.26,-768.49 305911.07,-750.72 305961.85,-732.6"/>
<polygon fill="black" stroke="black" points="305963.35,-735.78 305971.57,-729.09 305960.97,-729.2 305963.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_2 -->
<g id="edge2113" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_2</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145262,-777.5 306379,-777.5 306379,-777.5 306434.26,-768.49 306493.07,-750.72 306543.85,-732.6"/>
<polygon fill="black" stroke="black" points="306545.35,-735.78 306553.57,-729.09 306542.97,-729.2 306545.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_3 -->
<g id="edge2115" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_10_gate_tp_3</title>
<path fill="none" stroke="black" d="M145129.17,-695.2C145156.24,-719.5 145208.38,-761.38 145262,-777.5 145262,-777.5 305215,-777.5 305215,-777.5 305270.26,-768.49 305329.07,-750.72 305379.85,-732.6"/>
<polygon fill="black" stroke="black" points="305381.35,-735.78 305389.57,-729.09 305378.97,-729.2 305381.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_0 -->
<g id="edge2301" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_0</title>
<path fill="none" stroke="black" d="M145118.64,-658.79C145129.23,-639.86 145149.13,-610.46 145176,-598 145176,-598 326204,-590 326204,-590 332007.81,-573.47 339117.56,-520.26 340479.56,-509.8"/>
<polygon fill="black" stroke="black" points="340479.73,-513.29 340489.7,-509.72 340479.67,-506.29 340479.73,-513.29"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_1 -->
<g id="edge2303" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_1</title>
<path fill="none" stroke="black" d="M145123.24,-658.99C145139.27,-639.93 145168.21,-610.13 145201,-598 145201,-598 341002,-590 341002,-590 341044.81,-584.08 341090.18,-573.49 341132.05,-561.84"/>
<polygon fill="black" stroke="black" points="341133.09,-565.18 341141.76,-559.1 341131.19,-558.45 341133.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_2 -->
<g id="edge2305" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_2</title>
<path fill="none" stroke="black" d="M145127.87,-658.9C145149.23,-639.77 145187,-609.89 145226,-598 145226,-598 341584,-590 341584,-590 341626.81,-584.08 341672.18,-573.49 341714.05,-561.84"/>
<polygon fill="black" stroke="black" points="341715.09,-565.18 341723.76,-559.1 341713.19,-558.45 341715.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_3 -->
<g id="edge2307" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_11_gate_tp_3</title>
<path fill="none" stroke="black" d="M145132.4,-658.85C145158.99,-639.67 145205.49,-609.75 145251,-598 145251,-598 342166,-590 342166,-590 342208.81,-584.08 342254.18,-573.49 342296.05,-561.84"/>
<polygon fill="black" stroke="black" points="342297.09,-565.18 342305.76,-559.1 342295.19,-558.45 342297.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_0 -->
<g id="edge2493" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_0</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579096,-768 579096,-768 579114.6,-774.34 579122.33,-777.37 579131,-795 579161.38,-856.8 579167.58,-929.43 579101,-947 579046.65,-961.35 562966.93,-951.37 562911,-957 562877.27,-960.4 562841.67,-965.94 562807.38,-972.3"/>
<polygon fill="black" stroke="black" points="562806.45,-968.92 562797.27,-974.21 562807.75,-975.8 562806.45,-968.92"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_1 -->
<g id="edge2495" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_1</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579120,-768 579120,-768 579138.6,-774.34 579146.33,-777.37 579155,-795 579185.38,-856.8 579191.58,-929.42 579125,-947 579072.52,-960.85 563547,-951.56 563493,-957 563459.27,-960.4 563423.67,-965.94 563389.38,-972.3"/>
<polygon fill="black" stroke="black" points="563388.45,-968.92 563379.27,-974.21 563389.75,-975.8 563388.45,-968.92"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_2 -->
<g id="edge2497" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_2</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579072,-768 579072,-768 579090.6,-774.34 579098.33,-777.37 579107,-795 579137.38,-856.8 579143.58,-929.43 579077,-947 579020.77,-961.84 562386.86,-951.18 562329,-957 562295.27,-960.39 562259.67,-965.94 562225.38,-972.3"/>
<polygon fill="black" stroke="black" points="562224.45,-968.92 562215.27,-974.21 562225.75,-975.8 562224.45,-968.92"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_3 -->
<g id="edge2499" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_12_gate_tp_3</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 579144,-768 579144,-768 579162.6,-774.34 579170.33,-777.37 579179,-795 579209.38,-856.8 579215.58,-929.42 579149,-947 579109.46,-957.44 567412.89,-956.65 567372,-957 566102.5,-967.98 564580.58,-998.86 564012.51,-1011.01"/>
<polygon fill="black" stroke="black" points="564012.07,-1007.52 564002.15,-1011.23 564012.22,-1014.51 564012.07,-1007.52"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_0 -->
<g id="edge2685" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_0</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 542992,-768 542992,-768 542994.83,-770.83 542994.83,-774.17 542992,-777 542972.41,-796.61 527053.61,-792.58 527026,-795 526994.05,-797.8 526960.35,-802.27 526927.65,-807.43"/>
<polygon fill="black" stroke="black" points="526926.86,-804.02 526917.54,-809.06 526927.97,-810.93 526926.86,-804.02"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_1 -->
<g id="edge2687" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_1</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 543007,-768 543007,-768 543009.83,-770.83 543009.83,-774.17 543007,-777 542988.11,-795.92 527634.63,-792.67 527608,-795 527576.05,-797.8 527542.35,-802.27 527509.65,-807.44"/>
<polygon fill="black" stroke="black" points="527508.86,-804.02 527499.54,-809.06 527509.97,-810.93 527508.86,-804.02"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_2 -->
<g id="edge2689" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_2</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 542977,-768 542977,-768 542979.83,-770.83 542979.83,-774.17 542977,-777 542956.71,-797.31 526472.59,-792.5 526444,-795 526412.05,-797.8 526378.35,-802.27 526345.65,-807.43"/>
<polygon fill="black" stroke="black" points="526344.86,-804.02 526335.54,-809.06 526345.97,-810.93 526344.86,-804.02"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_3 -->
<g id="edge2691" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_13_gate_tp_3</title>
<path fill="none" stroke="black" d="M145228.69,-695.04C145376.11,-715.27 145635.48,-747.8 145859,-760 145859,-760 543022,-768 543022,-768 543024.83,-770.83 543024.83,-774.17 543022,-777 543007.96,-791.06 531595.87,-794.85 531576,-795 530271.16,-805.07 528706.03,-831.57 528127.99,-841.85"/>
<polygon fill="black" stroke="black" points="528127.81,-838.35 528117.87,-842.03 528127.93,-845.35 528127.81,-838.35"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_0 -->
<g id="edge2877" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_0</title>
<path fill="none" stroke="black" d="M145171.62,-695.06C145258.59,-719.51 145422.75,-761.9 145566,-777.5 145822.93,-805.48 443041.56,-779.53 443300,-777.5 445710.76,-758.55 448632.48,-699.4 449462.36,-681.92"/>
<polygon fill="black" stroke="black" points="449462.7,-685.41 449472.62,-681.7 449462.55,-678.41 449462.7,-685.41"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_1 -->
<g id="edge2879" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_1</title>
<path fill="none" stroke="black" d="M145171.62,-695.06C145258.59,-719.51 145422.75,-761.9 145566,-777.5 145566,-777.5 450556,-777.5 450556,-777.5 450611.26,-768.49 450670.07,-750.72 450720.85,-732.6"/>
<polygon fill="black" stroke="black" points="450722.35,-735.78 450730.57,-729.09 450719.97,-729.2 450722.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_2 -->
<g id="edge2881" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_2</title>
<path fill="none" stroke="black" d="M145171.62,-695.06C145258.59,-719.51 145422.75,-761.9 145566,-777.5 145566,-777.5 451138,-777.5 451138,-777.5 451193.26,-768.49 451252.07,-750.72 451302.85,-732.6"/>
<polygon fill="black" stroke="black" points="451304.35,-735.78 451312.57,-729.09 451301.97,-729.2 451304.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_3 -->
<g id="edge2883" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_14_gate_tp_3</title>
<path fill="none" stroke="black" d="M145171.62,-695.06C145258.59,-719.51 145422.75,-761.9 145566,-777.5 145566,-777.5 449974,-777.5 449974,-777.5 450029.26,-768.49 450088.07,-750.72 450138.85,-732.6"/>
<polygon fill="black" stroke="black" points="450140.35,-735.78 450148.57,-729.09 450137.97,-729.2 450140.35,-735.78"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_0 -->
<g id="edge3069" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_0</title>
<path fill="none" stroke="black" d="M145149.28,-658.98C145177.58,-647.46 145216.97,-632.96 145253,-625 145337.99,-606.23 145362.73,-624.42 145448,-607 145460.81,-604.38 145463.09,-600.02 145476,-598 145476,-598 470779,-590 470779,-590 476606,-573.52 483744.41,-520.25 485109.51,-509.79"/>
<polygon fill="black" stroke="black" points="485109.7,-513.29 485119.67,-509.71 485109.65,-506.29 485109.7,-513.29"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_1 -->
<g id="edge3071" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_1</title>
<path fill="none" stroke="black" d="M145148.95,-658.98C145177.26,-647.4 145216.8,-632.8 145253,-625 145348.91,-604.35 145376.78,-626.14 145473,-607 145485.82,-604.45 145488.09,-600.02 145501,-598 145501,-598 485632,-590 485632,-590 485674.81,-584.08 485720.18,-573.49 485762.05,-561.84"/>
<polygon fill="black" stroke="black" points="485763.09,-565.18 485771.76,-559.1 485761.19,-558.45 485763.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_2 -->
<g id="edge3073" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_2</title>
<path fill="none" stroke="black" d="M145148.93,-658.89C145177.23,-647.26 145216.76,-632.65 145253,-625 145359.83,-602.46 145390.83,-627.85 145498,-607 145510.83,-604.5 145513.09,-600.02 145526,-598 145526,-598 486214,-590 486214,-590 486256.81,-584.08 486302.18,-573.49 486344.05,-561.84"/>
<polygon fill="black" stroke="black" points="486345.09,-565.18 486353.76,-559.1 486343.19,-558.45 486345.09,-565.18"/>
</g>
<!-- layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_3 -->
<g id="edge3075" class="edge">
<title>layer_{layer_id}_attn_allreduce&#45;&gt;layer_15_gate_tp_3</title>
<path fill="none" stroke="black" d="M145148.61,-658.94C145176.93,-647.25 145216.61,-632.55 145253,-625 145370.76,-600.57 145404.87,-629.57 145523,-607 145535.84,-604.55 145538.09,-600.02 145551,-598 145551,-598 486796,-590 486796,-590 486838.81,-584.08 486884.18,-573.49 486926.05,-561.84"/>
<polygon fill="black" stroke="black" points="486927.09,-565.18 486935.76,-559.1 486925.19,-558.45 486927.09,-565.18"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_0 -->
<g id="edge190" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_0</title>
<path fill="none" stroke="black" d="M579128.51,-219.4C579519.3,-225.16 580937.16,-248.52 581135,-287 581148.94,-289.71 581155,-287.92 581165,-298 581202.22,-335.53 581178.79,-364.1 581205,-410 581208.07,-415.38 581229.84,-427.05 581220,-437 581201.61,-455.58 580304.44,-441 580279,-447 580137.58,-480.36 580126.25,-555.92 579985,-590 579979.49,-591.33 579174.67,-606.94 579169,-607 579169,-607 145737,-625 145737,-625 145677.56,-659.75 145712.47,-714.27 145661,-760 145630.77,-786.86 145606.19,-767.01 145577,-795 145519.5,-850.14 145559.3,-927.74 145482,-947 145482,-947 32744,-957 32744,-957 32710.16,-960.39 32674.44,-965.93 32640.03,-972.29"/>
<polygon fill="black" stroke="black" points="32639.07,-968.91 32629.89,-974.2 32640.36,-975.79 32639.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_1 -->
<g id="edge192" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_1</title>
<path fill="none" stroke="black" d="M579126.66,-218.07C579538.01,-218.74 581112.37,-225.35 581197,-287 581243.93,-321.18 581213.96,-358.62 581241,-410 581243.34,-414.45 581262.93,-427.98 581254,-437 581235.69,-455.5 580337.55,-431.02 580317,-447 580265.08,-487.36 580330.86,-549.57 580279,-590 580265.85,-600.25 579695.51,-595.68 579679,-598 579663.95,-600.12 579661.07,-604.98 579646,-607 579646,-607 145792,-625 145792,-625 145738.24,-661.15 145782.82,-714.2 145737,-760 145707.81,-789.17 145681.81,-767.54 145651,-795 145599.92,-840.52 145630.12,-886.87 145577,-930 145556.81,-946.4 145546.73,-943.18 145521,-947 145425.51,-961.18 34402.06,-947.39 34306,-957 34272.16,-960.39 34236.44,-965.93 34202.03,-972.29"/>
<polygon fill="black" stroke="black" points="34201.07,-968.91 34191.89,-974.2 34202.36,-975.79 34201.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_2 -->
<g id="edge194" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.33,-217.92C579541.86,-217.99 581150.03,-222.43 581235,-287 581271.07,-314.41 581281.43,-434.55 581279,-437 581260.95,-455.25 580375.26,-431.24 580355,-447 580303.09,-487.37 580368.84,-549.54 580317,-590 580304.76,-599.55 579773.5,-597.01 579758,-598 579722.73,-600.26 579714.28,-605 579679,-607 579679,-607 145817,-625 145817,-625 145765.96,-670.06 145829.03,-716.4 145798,-777 145747.4,-875.81 145718.32,-906.41 145615,-947 145615,-947 34890,-957 34890,-957 34856.16,-960.39 34820.44,-965.93 34786.03,-972.29"/>
<polygon fill="black" stroke="black" points="34785.07,-968.91 34775.89,-974.2 34786.36,-975.79 34785.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_3 -->
<g id="edge196" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_0_ln_tp_3</title>
<path fill="none" stroke="black" d="M579126.02,-217.69C579545.93,-216.76 581189.31,-217.57 581273,-287 581339.92,-342.52 581308.5,-432.44 581304,-437 581289.94,-451.26 580602.21,-441.33 580583,-447 580468.28,-480.86 580469.68,-556.01 580355,-590 580328.52,-597.85 579885.58,-596.54 579858,-598 579813.44,-600.36 579802.58,-605 579758,-607 579758,-607 145859,-625 145859,-625 145749.79,-719.72 145922.21,-852.28 145813,-947 145813,-947 35474,-957 35474,-957 35440.16,-960.39 35404.44,-965.93 35370.03,-972.29"/>
<polygon fill="black" stroke="black" points="35369.07,-968.91 35359.89,-974.2 35370.36,-975.79 35369.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_0 -->
<g id="edge382" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_0</title>
<path fill="none" stroke="black" d="M579125.77,-217.39C579468.22,-215.86 580621.46,-216.2 580983,-287 580996.94,-289.73 581003,-287.92 581013,-298 581050.22,-335.53 581014.22,-374.09 581053,-410 581075.31,-430.66 581100.54,-403.84 581119,-428 581121.43,-431.18 581121.82,-434.16 581119,-437 581103.17,-452.93 579524.11,-443.03 579502,-447 579319.05,-479.83 579292.05,-557.73 579109,-590 579109,-590 145751,-598 145751,-598 145729.39,-600.01 145724.55,-604.43 145703,-607 145664.77,-611.56 145391.29,-607.5 145357,-625 145288.31,-660.05 145317.16,-725.89 145248,-760 145213.71,-776.91 144598.23,-776.52 144560,-777 144292.92,-780.33 67901.1,-771.9 67635,-795 67602.94,-797.78 67569.12,-802.25 67536.31,-807.41"/>
<polygon fill="black" stroke="black" points="67535.49,-804 67526.17,-809.03 67536.6,-810.91 67535.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_1 -->
<g id="edge384" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_1</title>
<path fill="none" stroke="black" d="M579127.01,-218.35C579520.27,-220.12 580966.44,-230.49 581045,-287 581092.38,-321.08 581048.12,-370.4 581091,-410 581112.39,-429.76 581136.46,-404.75 581154,-428 581156.41,-431.19 581156.82,-434.16 581154,-437 581139.32,-451.78 579673.34,-439.26 579654,-447 579567.89,-481.47 579588.22,-555.82 579502,-590 579502,-590 145776,-598 145776,-598 145763.09,-600.02 145760.85,-604.61 145748,-607 145713.53,-613.42 145462.75,-606.45 145433,-625 145374.57,-661.43 145415.09,-723.04 145357,-760 145337.07,-772.68 145274.43,-765.01 145251,-768 145228.6,-770.85 145223.49,-774.99 145201,-777 144668.53,-824.6 68751.6,-748.78 68219,-795 68186.94,-797.78 68153.12,-802.25 68120.31,-807.41"/>
<polygon fill="black" stroke="black" points="68119.49,-804 68110.17,-809.03 68120.6,-810.91 68119.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_2 -->
<g id="edge386" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.82,-218.28C579524.53,-219.81 581002.81,-229.36 581083,-287 581130.39,-321.07 581087.48,-368.99 581129,-410 581145.8,-426.6 581165.42,-408.68 581179,-428 581181.3,-431.27 581181.82,-434.16 581179,-437 581164.45,-451.65 579708.33,-434.36 579692,-447 579640,-487.26 579706.13,-549.91 579654,-590 579654,-590 145801,-598 145801,-598 145788.09,-600.02 145785.85,-604.59 145773,-607 145739.96,-613.19 145497.18,-603.92 145471,-625 145422.45,-664.1 145481.53,-720.88 145433,-760 145421.56,-769.22 145315.59,-766.25 145301,-768 145278.58,-770.69 145273.49,-774.99 145251,-777 144722.22,-824.27 69331.9,-749.1 68803,-795 68770.94,-797.78 68737.12,-802.25 68704.31,-807.41"/>
<polygon fill="black" stroke="black" points="68703.49,-804 68694.17,-809.03 68704.6,-810.91 68703.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_3 -->
<g id="edge388" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_1_ln_tp_3</title>
<path fill="none" stroke="black" d="M579126.9,-218.25C579529.33,-219.66 581038.78,-228.81 581121,-287 581168.9,-320.9 581129.7,-366.43 581169,-410 581193.72,-437.41 581221.14,-419.68 581204,-437 581194.69,-446.41 580264.12,-445.28 580251,-447 579996.73,-480.36 579946.44,-557.97 579692,-590 579692,-590 145859,-598 145859,-598 145842.13,-599.51 145724.92,-619.24 145709,-625 145594.64,-666.36 145587.55,-725.29 145471,-760 145416.8,-776.14 145400.09,-760.78 145344,-768 145323.34,-770.66 145318.73,-774.99 145298,-777 144773.3,-827.91 69912.19,-749.42 69387,-795 69354.94,-797.78 69321.12,-802.25 69288.31,-807.41"/>
<polygon fill="black" stroke="black" points="69287.49,-804 69278.17,-809.03 69288.6,-810.91 69287.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_0 -->
<g id="edge574" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_0</title>
<path fill="none" stroke="black" d="M578935.33,-218.69C577438.41,-229.67 558294.83,-368.68 542857,-410 542512.28,-410.92 146078.42,-413.4 145734,-428 145686.76,-430 145675.22,-434.51 145628,-437 145520.13,-442.68 145249.36,-435.06 145142,-447 144825.54,-482.2 144754.27,-538.86 144440,-590 144436.16,-590.62 144304.88,-606.76 144301,-607 144027.35,-623.73 105095.13,-601.26 104822,-625 104789.94,-627.79 104756.12,-632.25 104723.31,-637.42"/>
<polygon fill="black" stroke="black" points="104722.49,-634 104713.17,-639.04 104723.6,-640.92 104722.49,-634"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_1 -->
<g id="edge576" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_1</title>
<path fill="none" stroke="black" d="M579013.97,-235.06C579000.91,-250.59 578982.22,-274.6 578970,-298 578945.67,-344.59 578974.72,-379.38 578932,-410 578932,-410 145761,-428 145761,-428 145747.23,-430.02 145744.74,-434.79 145731,-437 145691.27,-443.39 145407.5,-435.31 145369,-447 145254.91,-481.65 145256.37,-556.26 145142,-590 145105.18,-600.86 144489.31,-595.49 144451,-598 144417.5,-600.2 144409.51,-604.99 144376,-607 144105.86,-623.21 105675.61,-601.57 105406,-625 105373.94,-627.79 105340.12,-632.25 105307.31,-637.42"/>
<polygon fill="black" stroke="black" points="105306.49,-634 105297.17,-639.04 105307.6,-640.92 105306.49,-634"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_2 -->
<g id="edge578" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_2</title>
<path fill="none" stroke="black" d="M579024.32,-235.15C579011.68,-281.23 578977.29,-404.61 578970,-410 578970,-410 146607,-428 146607,-428 146406.3,-430.12 145900.21,-404.72 145704,-447 145545.75,-481.1 145527.46,-556.85 145369,-590 145271.88,-610.32 144573.96,-582.19 144476,-598 144463.1,-600.08 144460.91,-604.97 144448,-607 144186.93,-647.99 106657.27,-602.12 106394,-625 106361.94,-627.79 106328.12,-632.25 106295.31,-637.42"/>
<polygon fill="black" stroke="black" points="106294.49,-634 106285.17,-639.04 106295.6,-640.92 106294.49,-634"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_3 -->
<g id="edge580" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_2_ln_tp_3</title>
<path fill="none" stroke="black" d="M579033.59,-235.12C579042.66,-273.23 579057.93,-365.23 579008,-410 579008,-410 181898,-428 181898,-428 181772.86,-428.04 145975.54,-401.42 145859,-447 145771.71,-481.14 145791.15,-555.51 145704,-590 145679.8,-599.58 144793.02,-597.49 144767,-598 144637.63,-600.55 144605.38,-604.97 144476,-607 144215.63,-611.09 107237.42,-602.45 106978,-625 106945.94,-627.79 106912.12,-632.25 106879.31,-637.42"/>
<polygon fill="black" stroke="black" points="106878.49,-634 106869.17,-639.04 106879.6,-640.92 106878.49,-634"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_0 -->
<g id="edge766" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_0</title>
<path fill="none" stroke="black" d="M578934.38,-218.09C576772.91,-220.17 538006.8,-257.21 506818,-269 506818,-269 145786,-287 145786,-287 145763.38,-289.46 145752.95,-282.82 145736,-298 145696.83,-333.06 145739.99,-378.38 145698,-410 145685.34,-419.54 145143.85,-436.6 145128,-437 144977.21,-440.85 142563.06,-431.71 142413,-447 142379.17,-450.45 142343.45,-456.02 142309.04,-462.39"/>
<polygon fill="black" stroke="black" points="142308.08,-459.01 142298.9,-464.3 142309.37,-465.89 142308.08,-459.01"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_1 -->
<g id="edge768" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_1</title>
<path fill="none" stroke="black" d="M578934.38,-218.09C576772.91,-220.17 538006.8,-257.21 506818,-269 506504.71,-269.12 146221.03,-274.17 145908,-287 145848.29,-289.45 145821.1,-261.23 145774,-298 145732.56,-330.34 145777.61,-377.88 145736,-410 145713.78,-427.16 145511.56,-422.67 145484,-428 145471.17,-430.48 145468.91,-434.95 145456,-437 145321.08,-458.43 143132.91,-433.13 142997,-447 142963.17,-450.45 142927.45,-456.03 142893.04,-462.4"/>
<polygon fill="black" stroke="black" points="142892.08,-459.02 142882.9,-464.31 142893.37,-465.9 142892.08,-459.02"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_2 -->
<g id="edge770" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_2</title>
<path fill="none" stroke="black" d="M578934.38,-218.09C576772.91,-220.17 538006.8,-257.2 506818,-269 496850.39,-272.77 157951.58,-261.51 147984,-287 147923.67,-287.15 145860.95,-262.73 145812,-298 145769.35,-328.73 145815.55,-377.8 145774,-410 145752.86,-426.38 145560.53,-424.63 145534,-428 145511.6,-430.85 145506.48,-434.93 145484,-437 145273.44,-456.36 143791.34,-425.4 143581,-447 143547.17,-450.47 143511.45,-456.06 143477.05,-462.43"/>
<polygon fill="black" stroke="black" points="143476.08,-459.05 143466.9,-464.34 143477.38,-465.93 143476.08,-459.05"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_3 -->
<g id="edge772" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_3_ln_tp_3</title>
<path fill="none" stroke="black" d="M578934.38,-218.09C576772.91,-220.16 538006.8,-256.93 506818,-269 447690,-291.88 299870,-281.57 240742,-287 240659.64,-287.01 145927.59,-252.4 145859,-298 145814.05,-327.89 145855.46,-377.97 145812,-410 145787.02,-428.41 145564.98,-435.13 145534,-437 145347.62,-448.25 145300.6,-440.34 145114,-447 144757.08,-459.73 144342.7,-480.68 144094.51,-493.88"/>
<polygon fill="black" stroke="black" points="144094.08,-490.4 144084.29,-494.43 144094.46,-497.39 144094.08,-490.4"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_0 -->
<g id="edge958" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_0</title>
<path fill="none" stroke="black" d="M579127.07,-218.29C579645.84,-220.08 582052.08,-231.36 582199,-287 582250.41,-306.47 582246.34,-367.07 582212,-410 582189.23,-438.46 582167.16,-418.41 582132,-428 582119.39,-431.44 582116.87,-434.72 582104,-437 582076.41,-441.89 581873.87,-429.48 581852,-447 581800.67,-488.11 581865.14,-548.66 581814,-590 581799.72,-601.54 581667.23,-595.82 581649,-598 581641.08,-598.95 581514.7,-620.67 581508,-625 581446.37,-664.8 581477.26,-724.59 581413,-760 581395.83,-769.46 580727.56,-793.65 580708,-795 579939.74,-847.88 579751.34,-913.18 578982,-947 578725.64,-958.27 283626.59,-954.12 283370,-957 282481.78,-966.98 281425.02,-995.89 280969.47,-1009.18"/>
<polygon fill="black" stroke="black" points="280969.05,-1005.69 280959.16,-1009.48 280969.25,-1012.68 280969.05,-1005.69"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_1 -->
<g id="edge960" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_1</title>
<path fill="none" stroke="black" d="M579126.96,-218.22C579661.56,-219.67 582204.79,-229.58 582261,-287 582299.24,-326.07 582296.21,-368.18 582261,-410 582245.9,-427.94 582179.78,-422.4 582157,-428 582144.31,-431.12 582141.86,-434.66 582129,-437 582107,-441.01 581946.87,-435.01 581928,-447 581867.25,-485.6 581912.84,-551.55 581852,-590 581835.26,-600.58 581693.49,-594.5 581674,-598 581661.13,-600.31 581658.68,-603.84 581646,-607 581602.18,-617.93 581579.43,-594.64 581546,-625 581499.85,-666.9 581555.89,-720.11 581508,-760 581481.92,-781.73 580930.11,-784 580898,-795 580800,-828.56 580805.89,-896.11 580708,-930 580673.52,-941.94 580579.9,-931.47 580544,-938 580531.14,-940.34 580528.91,-944.98 580516,-947 580516,-947 285122,-957 285122,-957 284682.88,-965.88 284169.93,-989.73 283883.86,-1004.25"/>
<polygon fill="black" stroke="black" points="283883.59,-1000.76 283873.78,-1004.76 283883.95,-1007.75 283883.59,-1000.76"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_2 -->
<g id="edge962" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.79,-218.2C579664.78,-219.52 582242.08,-228.87 582299,-287 582337.25,-326.06 582334.6,-368.51 582299,-410 582281.87,-429.97 582207.6,-421.96 582182,-428 582169.28,-431 582166.84,-434.55 582154,-437 582121.19,-443.27 582032.05,-428.85 582004,-447 581943.58,-486.11 581989.03,-551.85 581928,-590 581906.41,-603.49 581724.08,-593.62 581699,-598 581686.12,-600.25 581683.62,-603.61 581671,-607 581634.54,-616.79 581615.84,-599.51 581588,-625 581541.66,-667.43 581592.27,-717.48 581546,-760 581498.63,-803.54 581022.37,-760.6 580968,-795 580910.89,-831.14 580954.89,-893.52 580898,-930 580831.7,-972.51 580622.73,-945.11 580544,-947 580033.29,-959.26 286800.57,-939.82 286290,-957 286064.16,-964.6 285806.12,-983.18 285628.91,-997.48"/>
<polygon fill="black" stroke="black" points="285628.37,-994.01 285618.68,-998.31 285628.93,-1000.99 285628.37,-994.01"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_3 -->
<g id="edge964" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_4_ln_tp_3</title>
<path fill="none" stroke="black" d="M579126.59,-218.17C579667.9,-219.36 582279.36,-228.15 582337,-287 582375.25,-326.06 582372.91,-368.78 582337,-410 582317.84,-431.99 582235.43,-421.51 582207,-428 582194.26,-430.91 582191.83,-434.51 582179,-437 582164.02,-439.91 582053.75,-437.26 582042,-447 581991.36,-488.96 582055.46,-549.06 582004,-590 581993.43,-598.41 581774.42,-596.46 581761,-598 581745.69,-599.76 581636.42,-614.66 581625,-625 581572.08,-672.93 581635.02,-741.62 581573,-777 581529.82,-801.63 581172.56,-777.61 581126,-795 581024.7,-832.84 581038.04,-911.2 580936,-947 580936,-947 287166,-957 287166,-957 287040.41,-963.33 286900.2,-977.27 286788.65,-990.01"/>
<polygon fill="black" stroke="black" points="286788.16,-986.54 286778.63,-991.16 286788.96,-993.49 286788.16,-986.54"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_0 -->
<g id="edge1150" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_0</title>
<path fill="none" stroke="black" d="M579127.04,-218.46C579599.14,-220.92 581620.64,-234.49 581743,-287 581793.44,-308.65 581775.91,-359.68 581754,-410 581746.97,-426.15 581741.33,-430.41 581725,-437 581695.53,-448.89 581178.02,-427.41 581153,-447 581101.22,-487.54 581166.45,-549.04 581115,-590 581104.69,-598.21 580890.98,-595.74 580878,-598 580865.12,-600.24 580862.88,-604.78 580850,-607 580720.52,-629.32 580390.12,-616.52 580259,-625 579651.53,-664.29 579503.99,-729.82 578896,-760 577896.15,-809.63 543858.08,-776.73 542857,-777 542857,-777 249521,-795 249521,-795 249488.94,-797.78 249455.12,-802.24 249422.31,-807.4"/>
<polygon fill="black" stroke="black" points="249421.49,-803.99 249412.17,-809.03 249422.6,-810.9 249421.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_1 -->
<g id="edge1152" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_1</title>
<path fill="none" stroke="black" d="M579127.17,-218.58C579615.04,-221.68 581757.28,-238.08 581805,-287 581843.17,-326.13 581833.2,-363.17 581805,-410 581798.39,-420.99 581766.42,-433.8 581754,-437 581723.71,-444.81 581215.63,-427.71 581191,-447 581139.23,-487.55 581204.48,-549.08 581153,-590 581142.12,-598.65 580916.69,-595.63 580903,-598 580890.12,-600.23 580887.88,-604.76 580875,-607 580815.85,-617.28 580386.31,-593.84 580335,-625 580276.15,-660.74 580316.51,-722.14 580259,-760 580245,-769.22 580200.4,-764.53 580184,-768 580171.21,-770.71 580168.91,-774.98 580156,-777 580156,-777 250105,-795 250105,-795 250072.94,-797.78 250039.12,-802.24 250006.31,-807.4"/>
<polygon fill="black" stroke="black" points="250005.49,-803.99 249996.17,-809.03 250006.6,-810.9 250005.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_2 -->
<g id="edge1154" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_2</title>
<path fill="none" stroke="black" d="M579127.29,-218.55C579619.47,-221.5 581794.58,-237.38 581843,-287 581881.18,-326.13 581873.22,-364.45 581843,-410 581838.73,-416.43 581786.55,-435.4 581779,-437 581749.1,-443.33 581253.06,-428.15 581229,-447 581177.24,-487.56 581242.51,-549.13 581191,-590 581179.55,-599.09 580942.41,-595.52 580928,-598 580915.12,-600.22 580912.87,-604.73 580900,-607 580847.77,-616.2 580469.15,-598.86 580423,-625 580360.68,-660.3 580396.86,-723.9 580335,-760 580310.77,-774.14 580236.57,-762.78 580209,-768 580196.16,-770.43 580193.91,-774.98 580181,-777 580181,-777 250689,-795 250689,-795 250656.94,-797.78 250623.12,-802.24 250590.31,-807.4"/>
<polygon fill="black" stroke="black" points="250589.49,-803.99 250580.17,-809.03 250590.6,-810.9 250589.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_3 -->
<g id="edge1156" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_5_ln_tp_3</title>
<path fill="none" stroke="black" d="M579127.38,-218.51C579623.79,-221.33 581831.88,-236.67 581881,-287 581919.18,-326.12 581912.62,-365.41 581881,-410 581879.69,-411.85 581806.23,-436.6 581804,-437 581789.32,-439.64 581278.74,-437.8 581267,-447 581215.24,-487.57 581280.49,-549.09 581229,-590 581218.08,-598.68 580991.87,-596.54 580978,-598 580955.54,-600.37 580950.41,-604.2 580928,-607 580814.82,-621.12 580781.51,-593.1 580672,-625 580551.14,-660.21 580544.08,-725.56 580423,-760 580393.24,-768.47 580314.82,-765.27 580284,-768 580250.56,-770.97 580242.51,-775 580209,-777 579923.97,-794.05 251557.47,-770.34 251273,-795 251240.94,-797.78 251207.12,-802.24 251174.31,-807.4"/>
<polygon fill="black" stroke="black" points="251173.49,-803.99 251164.17,-809.03 251174.6,-810.9 251173.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_0 -->
<g id="edge1342" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_0</title>
<path fill="none" stroke="black" d="M579128.38,-219.26C579562.18,-224.97 581270.01,-249.8 581311,-287 581374.12,-344.29 581333.19,-432.75 581329,-437 581315.19,-451.01 580636.51,-434.9 580621,-447 580569.15,-487.45 580634.9,-549.62 580583,-590 580567.65,-601.94 579902.19,-594.88 579883,-598 579870.1,-600.1 579867.91,-604.98 579855,-607 579855,-607 177443,-625 177443,-625 177410.94,-627.78 177377.12,-632.24 177344.31,-637.4"/>
<polygon fill="black" stroke="black" points="177343.49,-633.99 177334.17,-639.03 177344.6,-640.9 177343.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_1 -->
<g id="edge1344" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_1</title>
<path fill="none" stroke="black" d="M579127.8,-218.98C579574.37,-223.65 581384.33,-245.15 581425,-287 581463.09,-326.21 581440.84,-357.68 581425,-410 581420.82,-423.8 581419.66,-430.09 581407,-437 581377.93,-452.87 580839.24,-429.7 580811,-447 580749.62,-484.59 580796.25,-552.2 580735,-590 580719.06,-599.84 580416.7,-596.94 580398,-598 580353.45,-600.53 580342.58,-605 580298,-607 579950.17,-622.63 179541.88,-594.93 179195,-625 179162.94,-627.78 179129.12,-632.24 179096.31,-637.4"/>
<polygon fill="black" stroke="black" points="179095.49,-633.99 179086.17,-639.03 179096.6,-640.9 179095.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_2 -->
<g id="edge1346" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_2</title>
<path fill="none" stroke="black" d="M579127.91,-219.11C579565.67,-224.27 581309.03,-247.26 581349,-287 581409.5,-347.15 581357.91,-433.03 581354,-437 581326.89,-464.5 580689.44,-423.24 580659,-447 580607.16,-487.46 580672.9,-549.62 580621,-590 580605.37,-602.16 579927.55,-594.82 579908,-598 579895.1,-600.1 579892.91,-604.98 579880,-607 579880,-607 178027,-625 178027,-625 177994.94,-627.78 177961.12,-632.24 177928.31,-637.4"/>
<polygon fill="black" stroke="black" points="177927.49,-633.99 177918.17,-639.03 177928.6,-640.9 177927.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_3 -->
<g id="edge1348" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_6_ln_tp_3</title>
<path fill="none" stroke="black" d="M579128.08,-219.03C579570.68,-223.88 581347.04,-245.86 581387,-287 581425.09,-326.22 581394.85,-355.9 581387,-410 581385.2,-422.39 581388.97,-429.43 581379,-437 581350.5,-458.63 580765.53,-428.33 580735,-447 580673.6,-484.55 580720.28,-552.24 580659,-590 580650.46,-595.26 580308.03,-597.77 580298,-598 580124.66,-601.92 580081.37,-605 579908,-607 579908,-607 178611,-625 178611,-625 178578.94,-627.78 178545.12,-632.24 178512.31,-637.4"/>
<polygon fill="black" stroke="black" points="178511.49,-633.99 178502.17,-639.03 178512.6,-640.9 178511.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_0 -->
<g id="edge1534" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_0</title>
<path fill="none" stroke="black" d="M579038.02,-235.03C579056.51,-272.56 579093.2,-362.78 579046,-410 579001.67,-454.34 506880.7,-436.99 506818,-437 506818,-437 216182,-447 216182,-447 216148.16,-450.39 216112.44,-455.92 216078.03,-462.29"/>
<polygon fill="black" stroke="black" points="216077.07,-458.91 216067.89,-464.19 216078.36,-465.79 216077.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_1 -->
<g id="edge1536" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_1</title>
<path fill="none" stroke="black" d="M579133.69,-223.13C579306.14,-232.46 579635.15,-254.31 579677,-287 579722.88,-322.83 579674.86,-375.85 579722,-410 579769.9,-444.7 580212.89,-385.48 580254,-428 580256.78,-430.88 580256.83,-434.17 580254,-437 580254,-437 216766,-447 216766,-447 216732.16,-450.39 216696.44,-455.92 216662.03,-462.29"/>
<polygon fill="black" stroke="black" points="216661.07,-458.91 216651.89,-464.19 216662.36,-465.79 216661.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_2 -->
<g id="edge1538" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_2</title>
<path fill="none" stroke="black" d="M579132.61,-222.41C579313.03,-230.96 579670.03,-252.09 579715,-287 579760.98,-322.7 579712.87,-375.83 579760,-410 579806.71,-443.87 580238.91,-386.5 580279,-428 580281.78,-430.88 580281.83,-434.17 580279,-437 580279,-437 217350,-447 217350,-447 217316.16,-450.39 217280.44,-455.92 217246.03,-462.29"/>
<polygon fill="black" stroke="black" points="217245.07,-458.91 217235.89,-464.19 217246.36,-465.79 217245.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_3 -->
<g id="edge1540" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_7_ln_tp_3</title>
<path fill="none" stroke="black" d="M579131.66,-221.78C579319.77,-229.56 579704.91,-249.86 579753,-287 579799.07,-322.58 579750.89,-375.81 579798,-410 579843.53,-443.04 580264.93,-387.52 580304,-428 580306.78,-430.88 580306.83,-434.17 580304,-437 580304,-437 217937,-447 217937,-447 217902.2,-450.45 217865.42,-456.13 217830.09,-462.63"/>
<polygon fill="black" stroke="black" points="217829.35,-459.21 217820.16,-464.49 217830.63,-466.09 217829.35,-459.21"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_0 -->
<g id="edge1726" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_0</title>
<path fill="none" stroke="black" d="M579126.82,-218.15C579672.36,-219.22 582316.66,-227.45 582375,-287 582413.25,-326.05 582410.46,-368.39 582375,-410 582350.48,-438.78 582244.55,-432.51 582207,-437 582192.95,-438.68 582090.87,-437.94 582080,-447 582029.48,-489.1 582092.87,-548.33 582042,-590 582030.8,-599.17 581926.42,-596.78 581912,-598 581883.94,-600.37 581681.51,-606.82 581660,-625 581605.68,-670.9 581672.23,-742.58 581610,-777 581545.34,-812.76 581349.88,-777.89 581278,-795 581132.6,-829.6 581115.56,-896.06 580970,-930 580806.66,-968.09 580760.68,-943.22 580593,-947 580460.34,-949.99 427865.03,-943.79 427733,-957 427699.16,-960.39 427663.44,-965.93 427629.03,-972.29"/>
<polygon fill="black" stroke="black" points="427628.07,-968.91 427618.89,-974.2 427629.36,-975.79 427628.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_1 -->
<g id="edge1728" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_1</title>
<path fill="none" stroke="black" d="M579126.58,-218.13C579675.29,-219.06 582353.95,-226.73 582413,-287 582451.26,-326.05 582443.59,-364.69 582413,-410 582395.04,-436.61 582377.38,-430.2 582346,-437 582321.22,-442.37 582137.76,-431.11 582118,-447 582066.76,-488.22 582130.25,-547.57 582080,-590 582047.43,-617.5 581730.77,-597.74 581698,-625 581650.08,-664.86 581689.81,-705.26 581660,-760 581655.18,-768.85 581653.96,-772.39 581645,-777 581575.07,-812.95 581542.63,-767.4 581469,-795 581371.66,-831.48 581376.05,-895.47 581278,-930 581250.91,-939.54 581177.22,-932.68 581149,-938 581136.16,-940.42 581133.91,-944.98 581121,-947 580989.96,-967.55 428448.98,-943.8 428317,-957 428283.16,-960.39 428247.44,-965.93 428213.03,-972.29"/>
<polygon fill="black" stroke="black" points="428212.07,-968.91 428202.89,-974.2 428213.36,-975.79 428212.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_2 -->
<g id="edge1730" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.5,-218.08C579682.35,-218.77 582428.52,-225.31 582489,-287 582527.27,-326.04 582506.13,-358.09 582489,-410 582484.32,-424.18 582482.21,-430.04 582469,-437 582441.95,-451.25 582217.9,-427.92 582194,-447 582142.61,-488.03 582200.2,-541.31 582156,-590 582152.25,-594.13 582065.79,-620.91 582062,-625 582019.53,-670.79 582065.55,-714.28 582023,-760 581992.34,-792.94 581969.62,-777.9 581928,-795 581793.88,-850.1 581771.94,-895.94 581631,-930 581476.6,-967.31 581432.8,-943.22 581274,-947 581143.63,-950.11 431173.76,-944.02 431044,-957 431010.16,-960.39 430974.44,-965.93 430940.03,-972.29"/>
<polygon fill="black" stroke="black" points="430939.07,-968.91 430929.89,-974.2 430940.36,-975.79 430939.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_3 -->
<g id="edge1732" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_8_ln_tp_3</title>
<path fill="none" stroke="black" d="M579126.77,-218.1C579679.6,-218.92 582391.24,-226.03 582451,-287 582489.26,-326.04 582457.92,-355.77 582451,-410 582449.43,-422.3 582453.67,-429.24 582444,-437 582419.02,-457.03 582181.04,-427.04 582156,-447 582104.57,-487.99 582162.28,-541.38 582118,-590 582110.43,-598.32 582033.44,-620.82 582023,-625 581846.72,-695.63 581792.7,-695.42 581631,-795 581551.2,-844.14 581556.45,-896.29 581469,-930 581448.77,-937.8 581295.65,-936.78 581274,-938 581218.39,-941.14 581204.66,-945 581149,-947 581016.93,-951.75 429032.5,-943.84 428901,-957 428867.16,-960.39 428831.44,-965.93 428797.03,-972.29"/>
<polygon fill="black" stroke="black" points="428796.07,-968.91 428786.89,-974.2 428797.36,-975.79 428796.07,-968.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_0 -->
<g id="edge1918" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_0</title>
<path fill="none" stroke="black" d="M579127.04,-218.48C579626.79,-221.15 581869.16,-235.96 581919,-287 581957.19,-326.11 581951.83,-366.29 581919,-410 581901.77,-432.94 581884.44,-419.61 581857,-428 581844.5,-431.82 581841.89,-434.85 581829,-437 581800.28,-441.78 581327.91,-429.03 581305,-447 581253.25,-487.58 581318.52,-549.13 581267,-590 581255.5,-599.12 581017.46,-595.51 581003,-598 580990.12,-600.22 580987.8,-604.36 580975,-607 580933.68,-615.5 580823.38,-605.43 580786,-625 580716.42,-661.42 580742.66,-725.73 580672,-760 580648.19,-771.55 580460.43,-766.76 580434,-768 580367.29,-771.12 580350.76,-775 580284,-777 579960.44,-786.71 394149.5,-767.03 393827,-795 393794.94,-797.78 393761.12,-802.25 393728.31,-807.41"/>
<polygon fill="black" stroke="black" points="393727.49,-803.99 393718.17,-809.03 393728.6,-810.91 393727.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_1 -->
<g id="edge1920" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_1</title>
<path fill="none" stroke="black" d="M579127.08,-218.45C579630.9,-220.98 581906.46,-235.25 581957,-287 581995.2,-326.11 581990.24,-366.6 581957,-410 581929.01,-446.55 581902.58,-430.5 581857,-437 581842.86,-439.02 581354.24,-438.19 581343,-447 581291.26,-487.59 581356.55,-549.16 581305,-590 581292.93,-599.56 581043.17,-595.4 581028,-598 581015.12,-600.21 581012.76,-604.14 581000,-607 580939.64,-620.52 580913.26,-590.39 580862,-625 580804.94,-663.53 580844.93,-724.4 580786,-760 580772.82,-767.96 580524.35,-766.86 580509,-768 580475.52,-770.49 580467.51,-774.99 580434,-777 580111.62,-796.29 394732.75,-767.1 394411,-795 394378.94,-797.78 394345.12,-802.25 394312.31,-807.41"/>
<polygon fill="black" stroke="black" points="394311.49,-803.99 394302.17,-809.03 394312.6,-810.91 394311.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_2 -->
<g id="edge1922" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_2</title>
<path fill="none" stroke="black" d="M579127.09,-218.42C579634.91,-220.81 581943.75,-234.54 581995,-287 582033.2,-326.1 582020.93,-361.87 581995,-410 581984.65,-429.21 581974.84,-430.55 581954,-437 581923.58,-446.41 581406.07,-427.37 581381,-447 581329.22,-487.54 581394.51,-549.12 581343,-590 581331.59,-599.05 581095.48,-596.42 581081,-598 581072.96,-598.88 580944.57,-620.29 580938,-625 580882.05,-665.14 580920.98,-724.47 580862,-760 580847.58,-768.69 580575.75,-766.28 580559,-768 580536.54,-770.3 580531.49,-774.99 580509,-777 580188.2,-805.66 395315.87,-767.17 394995,-795 394962.94,-797.78 394929.12,-802.25 394896.31,-807.41"/>
<polygon fill="black" stroke="black" points="394895.49,-803.99 394886.17,-809.03 394896.6,-810.91 394895.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_3 -->
<g id="edge1924" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_9_ln_tp_3</title>
<path fill="none" stroke="black" d="M579127.08,-218.39C579638.82,-220.64 581981.04,-233.84 582033,-287 582071.21,-326.1 582061.74,-363.5 582033,-410 582025.95,-421.41 581992.03,-433.8 581979,-437 581948.78,-444.42 581443.5,-427.81 581419,-447 581367.23,-487.55 581432.49,-549.1 581381,-590 581369.95,-598.78 581140.87,-595.35 581127,-598 581092.2,-604.64 581081.09,-604.78 581052,-625 580987.52,-669.83 581008.82,-726.06 580938,-760 580921.51,-767.9 580627.19,-766.15 580609,-768 580586.54,-770.28 580581.49,-774.99 580559,-777 580239.13,-805.57 395898.94,-767.25 395579,-795 395546.94,-797.78 395513.12,-802.25 395480.31,-807.41"/>
<polygon fill="black" stroke="black" points="395479.49,-803.99 395470.17,-809.03 395480.6,-810.91 395479.49,-803.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_0 -->
<g id="edge2110" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_0</title>
<path fill="none" stroke="black" d="M579125.86,-217.58C579567.04,-216.08 581369.12,-214.43 581463,-287 581498.37,-314.34 581506.38,-434.58 581504,-437 581478.46,-462.93 580877.68,-424.6 580849,-447 580797.18,-487.48 580862.71,-549.38 580811,-590 580794.05,-603.32 580444.26,-594.44 580423,-598 580410.11,-600.16 580407.91,-604.98 580395,-607 580173.19,-641.78 321972.68,-605.61 321749,-625 321716.94,-627.78 321683.12,-632.24 321650.31,-637.41"/>
<polygon fill="black" stroke="black" points="321649.49,-633.99 321640.17,-639.03 321650.6,-640.9 321649.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_1 -->
<g id="edge2112" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_1</title>
<path fill="none" stroke="black" d="M579127.79,-218.82C579591.69,-222.91 581533.21,-242.64 581577,-287 581637.07,-347.85 581582.86,-433.08 581579,-437 581555,-461.4 580989.96,-425.92 580963,-447 580911.2,-487.51 580976.6,-549.23 580925,-590 580911.83,-600.41 580639.55,-595.18 580623,-598 580610.11,-600.2 580607.91,-604.98 580595,-607 580374.52,-641.57 323723.34,-605.72 323501,-625 323468.94,-627.78 323435.12,-632.24 323402.31,-637.41"/>
<polygon fill="black" stroke="black" points="323401.49,-633.99 323392.17,-639.03 323402.6,-640.9 323401.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_2 -->
<g id="edge2114" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_2</title>
<path fill="none" stroke="black" d="M579128.07,-219.09C579583.39,-224.3 581454.91,-248.08 581501,-287 581566.95,-342.7 581533.43,-432.5 581529,-437 581503.97,-462.42 580915.11,-425.04 580887,-447 580835.18,-487.49 580900.73,-549.4 580849,-590 580831.47,-603.76 580469.98,-594.33 580448,-598 580435.11,-600.15 580432.91,-604.98 580420,-607 580198.67,-641.7 322556.2,-605.65 322333,-625 322300.94,-627.78 322267.12,-632.24 322234.31,-637.41"/>
<polygon fill="black" stroke="black" points="322233.49,-633.99 322224.17,-639.03 322234.6,-640.9 322233.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_3 -->
<g id="edge2116" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_10_ln_tp_3</title>
<path fill="none" stroke="black" d="M579127.76,-218.95C579587.07,-223.6 581493.96,-245.36 581539,-287 581601.44,-344.72 581558.12,-432.81 581554,-437 581529.48,-461.91 580952.53,-425.48 580925,-447 580873.19,-487.5 580938.57,-549.2 580887,-590 580874.4,-599.97 580614.05,-597.3 580598,-598 580531.28,-600.92 580514.76,-605 580448,-607 580224.55,-613.71 323139.72,-605.69 322917,-625 322884.94,-627.78 322851.12,-632.24 322818.31,-637.41"/>
<polygon fill="black" stroke="black" points="322817.49,-633.99 322808.17,-639.03 322818.6,-640.9 322817.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_0 -->
<g id="edge2302" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_0</title>
<path fill="none" stroke="black" d="M579127.24,-218.36C579376.35,-220.1 580018.42,-230.12 580095,-287 580141.86,-321.8 580093.83,-375.63 580141,-410 580210.86,-460.89 580590.11,-375.88 580529,-437 580529,-437 360488,-447 360488,-447 360454.16,-450.39 360418.44,-455.92 360384.03,-462.29"/>
<polygon fill="black" stroke="black" points="360383.07,-458.91 360373.89,-464.19 360384.36,-465.79 360383.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_1 -->
<g id="edge2304" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_1</title>
<path fill="none" stroke="black" d="M579126.54,-218.12C579381.42,-219.25 580053.2,-227.87 580133,-287 580179.9,-321.75 580131.85,-375.59 580179,-410 580246.49,-459.25 580613.08,-377.92 580554,-437 580554,-437 361072,-447 361072,-447 361038.16,-450.39 361002.44,-455.92 360968.03,-462.29"/>
<polygon fill="black" stroke="black" points="360967.07,-458.91 360957.89,-464.19 360968.36,-465.79 360967.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_2 -->
<g id="edge2306" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.57,-217.89C579387.64,-218.44 580088.05,-225.67 580171,-287 580217.93,-321.7 580169.88,-375.55 580217,-410 580282.12,-457.61 580636.04,-379.96 580579,-437 580579,-437 361656,-447 361656,-447 361622.16,-450.39 361586.44,-455.92 361552.03,-462.29"/>
<polygon fill="black" stroke="black" points="361551.07,-458.91 361541.89,-464.19 361552.36,-465.79 361551.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_3 -->
<g id="edge2308" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_11_ln_tp_3</title>
<path fill="none" stroke="black" d="M579125.95,-217.69C579392.58,-217.65 580122.82,-223.42 580209,-287 580255.96,-321.65 580207.92,-375.51 580255,-410 580317.75,-455.97 580659,-381.99 580604,-437 580604,-437 362243,-447 362243,-447 362208.2,-450.45 362171.42,-456.13 362136.09,-462.64"/>
<polygon fill="black" stroke="black" points="362135.35,-459.21 362126.16,-464.49 362136.63,-466.09 362135.35,-459.21"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_0 -->
<g id="edge2494" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_0</title>
<path fill="none" stroke="black" d="M579126.65,-218.06C579686.51,-218.63 582465.82,-224.6 582527,-287 582565.27,-326.03 582550.41,-360.6 582527,-410 582518.88,-427.12 582511.67,-430.15 582494,-437 582455.4,-451.96 582344.8,-428.04 582308,-447 582235.75,-484.23 582258.99,-541.19 582194,-590 582161.33,-614.54 582137.07,-595.32 582109,-625 582065.34,-671.16 582099.58,-708.77 582062,-760 582046.6,-781 582034.58,-777.82 582015,-795 581952.16,-850.14 581959.56,-894.21 581884,-930 581802.98,-968.38 581772.57,-943.16 581683,-947 581482.02,-955.62 574641.15,-936.84 574441,-957 574407.16,-960.41 574371.44,-965.96 574337.04,-972.33"/>
<polygon fill="black" stroke="black" points="574336.07,-968.95 574326.89,-974.23 574337.36,-975.82 574336.07,-968.95"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_1 -->
<g id="edge2496" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_1</title>
<path fill="none" stroke="black" d="M579126.79,-218.04C579690.6,-218.49 582503.12,-223.9 582565,-287 582603.28,-326.03 582591.45,-362.16 582565,-410 582554.08,-429.75 582543.5,-430.14 582522,-437 582503.34,-442.95 582361.18,-434.62 582346,-447 582295.03,-488.55 582355.4,-544.42 582308,-590 582256.78,-639.25 582204.4,-577 582152,-625 582105.57,-667.53 582147.42,-710.11 582109,-760 582091.32,-782.96 582071.92,-772.23 582054,-795 582009.84,-851.1 582060.06,-905.44 582002,-947 581982.3,-961.1 575049.1,-954.57 575025,-957 574991.16,-960.41 574955.44,-965.96 574921.04,-972.33"/>
<polygon fill="black" stroke="black" points="574920.07,-968.95 574910.89,-974.23 574921.36,-975.83 574920.07,-968.95"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_2 -->
<g id="edge2498" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.46,-218.02C579693.07,-218.35 582540.39,-223.17 582603,-287 582641.28,-326.03 582616.71,-357.08 582603,-410 582599.56,-423.29 582599,-428.79 582588,-437 582571.58,-449.25 582561.59,-438.39 582543,-447 582424.09,-502.03 582409.13,-541.69 582308,-625 582220.54,-697.05 582188.97,-706.67 582118,-795 582074.88,-848.68 582081.89,-873.88 582042,-930 582036.16,-938.21 582036.18,-942.85 582027,-947 582006.69,-956.18 575631.17,-954.76 575609,-957 575575.16,-960.41 575539.44,-965.96 575505.04,-972.33"/>
<polygon fill="black" stroke="black" points="575504.07,-968.95 575494.89,-974.24 575505.36,-975.83 575504.07,-968.95"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_3 -->
<g id="edge2500" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_12_ln_tp_3</title>
<path fill="none" stroke="black" d="M579126.56,-218C579697.01,-218.21 582577.69,-222.47 582641,-287 582679.28,-326.02 582653.95,-356.89 582641,-410 582619.62,-497.68 582604.53,-520.46 582547,-590 582391.91,-777.45 582335.25,-820.5 582118,-930 582092.1,-943.05 582083.75,-943.16 582055,-947 581893.6,-968.53 576355.01,-940.66 576193,-957 576159.16,-960.41 576123.44,-965.97 576089.04,-972.33"/>
<polygon fill="black" stroke="black" points="576088.07,-968.95 576078.89,-974.24 576089.37,-975.83 576088.07,-968.95"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_0 -->
<g id="edge2686" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_0</title>
<path fill="none" stroke="black" d="M579127.05,-218.36C579642.63,-220.47 582018.33,-233.13 582071,-287 582109.21,-326.09 582101.59,-364.69 582071,-410 582066.51,-416.65 582011.86,-435.36 582004,-437 581929.58,-452.56 581735.06,-425.95 581662,-447 581541.59,-481.7 581537.99,-550.71 581419,-590 581349.18,-613.05 581146.18,-577.57 581090,-625 581042.37,-665.21 581101.21,-721.74 581052,-760 581038.05,-770.85 580751.65,-767.14 580734,-768 580678.37,-770.7 580664.66,-774.99 580609,-777 580316.09,-787.59 538694,-769.63 538402,-795 538369.94,-797.79 538336.12,-802.25 538303.31,-807.41"/>
<polygon fill="black" stroke="black" points="538302.49,-804 538293.17,-809.04 538303.6,-810.91 538302.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_1 -->
<g id="edge2688" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_1</title>
<path fill="none" stroke="black" d="M579126.99,-218.33C579646.34,-220.31 582055.63,-232.42 582109,-287 582147.22,-326.09 582140.88,-365.59 582109,-410 582108.32,-410.95 582030.15,-436.79 582029,-437 581997.17,-442.79 581765.44,-429.86 581738,-447 581676.96,-485.13 581723,-551.79 581662,-590 581641.55,-602.81 581468.76,-593.82 581445,-598 581432.13,-600.26 581429.83,-604.51 581417,-607 581362.1,-617.63 581213.24,-595.07 581166,-625 581107.84,-661.86 581148.94,-724.41 581090,-760 581076.63,-768.07 580824.57,-766.85 580809,-768 580775.52,-770.48 580767.51,-774.99 580734,-777 580444.6,-794.36 539274.83,-769.9 538986,-795 538953.94,-797.79 538920.12,-802.25 538887.31,-807.42"/>
<polygon fill="black" stroke="black" points="538886.49,-804 538877.17,-809.04 538887.6,-810.91 538886.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_2 -->
<g id="edge2690" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_2</title>
<path fill="none" stroke="black" d="M579126.91,-218.3C579649.95,-220.15 582092.92,-231.71 582147,-287 582185.23,-326.08 582180.1,-366.49 582147,-410 582128.85,-433.86 582110.72,-419.41 582082,-428 582069.48,-431.75 582066.88,-434.74 582054,-437 582038.78,-439.67 581788.08,-437.36 581776,-447 581724.6,-488.02 581789.36,-548.93 581738,-590 581728.84,-597.33 581538.69,-597.03 581527,-598 581515.33,-598.97 581328.65,-620.15 581318,-625 581235.77,-662.45 581250.04,-726.81 581166,-760 581134.26,-772.53 580892.95,-764.52 580859,-768 580836.54,-770.3 580831.49,-774.99 580809,-777 580238.52,-828.06 540140.61,-745.42 539570,-795 539537.94,-797.79 539504.12,-802.25 539471.31,-807.42"/>
<polygon fill="black" stroke="black" points="539470.49,-804 539461.17,-809.04 539471.6,-810.91 539470.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_3 -->
<g id="edge2692" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_13_ln_tp_3</title>
<path fill="none" stroke="black" d="M579126.8,-218.28C579653.46,-219.98 582130.2,-230.99 582185,-287 582223.23,-326.08 582219.03,-367.22 582185,-410 582162.85,-437.84 582141.3,-418.55 582107,-428 582094.4,-431.47 582091.87,-434.72 582079,-437 582051.08,-441.94 581846.69,-430 581824,-447 581770.35,-487.2 581829.4,-549.47 581776,-590 581762.26,-600.43 581638.12,-595.93 581621,-598 581557.66,-605.66 581537.67,-597.71 581480,-625 581395.28,-665.09 581405.52,-726.47 581318,-760 581222.69,-796.52 580961.05,-775.09 580859,-777 580576.38,-782.29 540435.61,-770.53 540154,-795 540121.94,-797.79 540088.12,-802.25 540055.31,-807.42"/>
<polygon fill="black" stroke="black" points="540054.49,-804 540045.17,-809.04 540055.6,-810.91 540054.49,-804"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_0 -->
<g id="edge2878" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_0</title>
<path fill="none" stroke="black" d="M579127.71,-218.77C579595.78,-222.63 581570.82,-241.62 581615,-287 581653.14,-326.17 581622.85,-355.9 581615,-410 581613.2,-422.39 581616.97,-429.43 581607,-437 581580.19,-457.37 581027.52,-426.26 581001,-447 580949.2,-487.52 581014.62,-549.25 580963,-590 580949.26,-600.85 580665.26,-595.07 580648,-598 580635.11,-600.19 580632.91,-604.97 580620,-607 580423.97,-637.75 466521.69,-607.85 466324,-625 466291.94,-627.78 466258.12,-632.25 466225.31,-637.41"/>
<polygon fill="black" stroke="black" points="466224.49,-633.99 466215.17,-639.03 466225.6,-640.91 466224.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_1 -->
<g id="edge2880" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_1</title>
<path fill="none" stroke="black" d="M579127.24,-218.65C579607.03,-222.05 581682.69,-239.49 581729,-287 581767.16,-326.15 581748.95,-359.1 581729,-410 581723.03,-425.23 581718.93,-430.32 581704,-437 581674.63,-450.13 581150.96,-427.99 581125,-447 581070.91,-486.61 581130.72,-549.89 581077,-590 581067.02,-597.45 580865.27,-595.85 580853,-598 580840.12,-600.25 580837.91,-604.97 580825,-607 580631.62,-637.33 468271.01,-608.08 468076,-625 468043.94,-627.78 468010.12,-632.25 467977.31,-637.41"/>
<polygon fill="black" stroke="black" points="467976.49,-633.99 467967.17,-639.03 467977.6,-640.91 467976.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_2 -->
<g id="edge2882" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_2</title>
<path fill="none" stroke="black" d="M579127.58,-218.73C579599.62,-222.48 581607.95,-241.07 581653,-287 581712.96,-348.12 581657.84,-433.1 581654,-437 581630.03,-461.36 581065.92,-425.95 581039,-447 580987.2,-487.51 581052.6,-549.23 581001,-590 580987.79,-600.44 580714.75,-596.28 580698,-598 580675.54,-600.3 580670.49,-604.99 580648,-607 580254.64,-642.15 467301.45,-590.87 466908,-625 466875.94,-627.78 466842.12,-632.25 466809.31,-637.41"/>
<polygon fill="black" stroke="black" points="466808.49,-633.99 466799.17,-639.03 466809.6,-640.91 466808.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_3 -->
<g id="edge2884" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_14_ln_tp_3</title>
<path fill="none" stroke="black" d="M579127.43,-218.69C579603.41,-222.24 581645.4,-240.2 581691,-287 581729.15,-326.15 581702.35,-356.52 581691,-410 581688.27,-422.85 581689.95,-429.75 581679,-437 581651.11,-455.46 581103.35,-426.39 581077,-447 581025.2,-487.52 581090.36,-548.93 581039,-590 581029.84,-597.33 580839.71,-597.37 580828,-598 580770.17,-601.1 580755.88,-604.99 580698,-607 580305.16,-620.61 467883.61,-591.03 467492,-625 467459.94,-627.78 467426.12,-632.25 467393.31,-637.41"/>
<polygon fill="black" stroke="black" points="467392.49,-633.99 467383.17,-639.03 467393.6,-640.91 467392.49,-633.99"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_0 -->
<g id="edge3070" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_0</title>
<path fill="none" stroke="black" d="M579128.62,-219.51C579457.86,-224.91 580493.49,-245.15 580551,-287 580598.19,-321.34 580550.37,-374.9 580597,-410 580638.47,-441.21 580865.7,-400.3 580829,-437 580829,-437 505063,-447 505063,-447 505029.16,-450.39 504993.44,-455.93 504959.03,-462.29"/>
<polygon fill="black" stroke="black" points="504958.07,-458.91 504948.89,-464.2 504959.36,-465.79 504958.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_1 -->
<g id="edge3072" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_1</title>
<path fill="none" stroke="black" d="M579128.47,-219.4C579463.01,-224.49 580529.88,-244.02 580589,-287 580636.21,-321.32 580588.45,-374.8 580635,-410 580674.11,-439.58 580888.67,-402.32 580854,-437 580854,-437 505647,-447 505647,-447 505613.16,-450.39 505577.44,-455.93 505543.03,-462.29"/>
<polygon fill="black" stroke="black" points="505542.07,-458.91 505532.89,-464.2 505543.36,-465.79 505542.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_2 -->
<g id="edge3074" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_2</title>
<path fill="none" stroke="black" d="M579128.22,-219.28C579467.86,-224.07 580566.26,-242.9 580627,-287 580674.23,-321.29 580626.54,-374.68 580673,-410 580709.75,-437.94 580911.64,-404.35 580879,-437 580879,-437 506231,-447 506231,-447 506197.16,-450.39 506161.44,-455.93 506127.03,-462.29"/>
<polygon fill="black" stroke="black" points="506126.07,-458.91 506116.89,-464.2 506127.36,-465.79 506126.07,-458.91"/>
</g>
<!-- layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_3 -->
<g id="edge3076" class="edge">
<title>layer_{layer_id}_moe_alltoall&#45;&gt;layer_15_ln_tp_3</title>
<path fill="none" stroke="black" d="M579128.18,-219.18C579473.09,-223.67 580602.65,-241.78 580665,-287 580712.24,-321.27 580664.64,-374.54 580711,-410 580779.8,-462.62 580965.24,-375.75 580904,-437 580904,-437 506818,-447 506818,-447 506783.2,-450.45 506746.42,-456.13 506711.09,-462.64"/>
<polygon fill="black" stroke="black" points="506710.35,-459.22 506701.16,-464.49 506711.63,-466.1 506710.35,-459.22"/>
</g>
<!-- layer_15_ln_tp_{tp_rank} -->
<g id="node1658" class="node">
<title>layer_15_ln_tp_{tp_rank}</title>
<polygon fill="lightyellow" stroke="black" points="579313.32,-1236 579144.19,-1236 579100.68,-1200 579269.81,-1200 579313.32,-1236"/>
<text text-anchor="middle" x="579207" y="-1215.5" font-family="Arial" font-size="10.00">layer_15_ln_tp_{tp_rank}</text>
</g>
<!-- layer_15_ln_tp_{tp_rank}&#45;&gt;output -->
<g id="edge3137" class="edge">
<title>layer_15_ln_tp_{tp_rank}&#45;&gt;output</title>
<path fill="none" stroke="black" d="M579194.96,-1199.69C579187.24,-1173.13 579184.97,-1121.04 579188.13,-1079.42"/>
<polygon fill="black" stroke="black" points="579191.63,-1079.63 579189.02,-1069.36 579184.65,-1079.01 579191.63,-1079.63"/>
</g>
<!-- layer_15_ln_tp_{tp_rank}&#45;&gt;output -->
<g id="edge3138" class="edge">
<title>layer_15_ln_tp_{tp_rank}&#45;&gt;output</title>
<path fill="none" stroke="black" d="M579202.99,-1199.69C579200.41,-1173.13 579199.66,-1121.04 579200.71,-1079.42"/>
<polygon fill="black" stroke="black" points="579204.21,-1079.46 579201.01,-1069.36 579197.21,-1079.25 579204.21,-1079.46"/>
</g>
<!-- layer_15_ln_tp_{tp_rank}&#45;&gt;output -->
<g id="edge3139" class="edge">
<title>layer_15_ln_tp_{tp_rank}&#45;&gt;output</title>
<path fill="none" stroke="black" d="M579211.01,-1199.69C579213.59,-1173.13 579214.34,-1121.04 579213.29,-1079.42"/>
<polygon fill="black" stroke="black" points="579216.79,-1079.25 579212.99,-1069.36 579209.79,-1079.46 579216.79,-1079.25"/>
</g>
<!-- layer_15_ln_tp_{tp_rank}&#45;&gt;output -->
<g id="edge3140" class="edge">
<title>layer_15_ln_tp_{tp_rank}&#45;&gt;output</title>
<path fill="none" stroke="black" d="M579219.04,-1199.69C579226.76,-1173.13 579229.03,-1121.04 579225.87,-1079.42"/>
<polygon fill="black" stroke="black" points="579229.35,-1079.01 579224.98,-1069.36 579222.37,-1079.63 579229.35,-1079.01"/>
</g>
</g>
</svg>
