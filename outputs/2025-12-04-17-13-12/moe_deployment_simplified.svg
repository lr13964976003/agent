<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="728pt" height="1946pt"
 viewBox="0.00 0.00 727.78 1945.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1941.74)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1941.74 723.78,-1941.74 723.78,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="lightgray" stroke="black" points="424.18,-1492.74 424.18,-1929.74 598.18,-1929.74 598.18,-1492.74 424.18,-1492.74"/>
<text text-anchor="middle" x="511.18" y="-1914.54" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="511.18" y="-1899.54" font-family="Times,serif" font-size="14.00">GPUs 0&#45;127</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="lightgray" stroke="black" points="424.18,-1022.74 424.18,-1459.74 598.18,-1459.74 598.18,-1022.74 424.18,-1022.74"/>
<text text-anchor="middle" x="511.18" y="-1444.54" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="511.18" y="-1429.54" font-family="Times,serif" font-size="14.00">GPUs 128&#45;255</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<polygon fill="lightgray" stroke="black" points="424.18,-552.74 424.18,-989.74 598.18,-989.74 598.18,-552.74 424.18,-552.74"/>
<text text-anchor="middle" x="511.18" y="-974.54" font-family="Times,serif" font-size="14.00">Pipeline Stage 2</text>
<text text-anchor="middle" x="511.18" y="-959.54" font-family="Times,serif" font-size="14.00">GPUs 256&#45;383</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<polygon fill="lightgray" stroke="black" points="424.18,-82.74 424.18,-519.74 598.18,-519.74 598.18,-82.74 424.18,-82.74"/>
<text text-anchor="middle" x="511.18" y="-504.54" font-family="Times,serif" font-size="14.00">Pipeline Stage 3</text>
<text text-anchor="middle" x="511.18" y="-489.54" font-family="Times,serif" font-size="14.00">GPUs 384&#45;511</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="207.18" cy="-1849.74" rx="207.36" ry="26.74"/>
<text text-anchor="middle" x="207.18" y="-1853.54" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="207.18" y="-1838.54" font-family="Times,serif" font-size="14.00">[batch=128, seq=1024, hidden=1024]</text>
</g>
<!-- stage0_layer0 -->
<g id="node2" class="node">
<title>stage0_layer0</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1883.74 432.18,-1883.74 432.18,-1815.74 590.18,-1815.74 590.18,-1883.74"/>
<text text-anchor="middle" x="511.18" y="-1868.54" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="511.18" y="-1853.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1838.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1823.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage0_layer1 -->
<g id="node3" class="node">
<title>stage0_layer1</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1778.74 432.18,-1778.74 432.18,-1710.74 590.18,-1710.74 590.18,-1778.74"/>
<text text-anchor="middle" x="511.18" y="-1763.54" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="511.18" y="-1748.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1733.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1718.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage0_layer0&#45;&gt;stage0_layer1 -->
<g id="edge1" class="edge">
<title>stage0_layer0&#45;&gt;stage0_layer1</title>
<path fill="none" stroke="black" d="M511.18,-1815.65C511.18,-1815.65 511.18,-1789.02 511.18,-1789.02"/>
<polygon fill="black" stroke="black" points="514.68,-1789.02 511.18,-1779.02 507.68,-1789.02 514.68,-1789.02"/>
</g>
<!-- stage0_layer2 -->
<g id="node4" class="node">
<title>stage0_layer2</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1673.74 432.18,-1673.74 432.18,-1605.74 590.18,-1605.74 590.18,-1673.74"/>
<text text-anchor="middle" x="511.18" y="-1658.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="511.18" y="-1643.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1628.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1613.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage0_layer1&#45;&gt;stage0_layer2 -->
<g id="edge2" class="edge">
<title>stage0_layer1&#45;&gt;stage0_layer2</title>
<path fill="none" stroke="black" d="M511.18,-1710.65C511.18,-1710.65 511.18,-1684.02 511.18,-1684.02"/>
<polygon fill="black" stroke="black" points="514.68,-1684.02 511.18,-1674.02 507.68,-1684.02 514.68,-1684.02"/>
</g>
<!-- stage0_layer3 -->
<g id="node5" class="node">
<title>stage0_layer3</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1568.74 432.18,-1568.74 432.18,-1500.74 590.18,-1500.74 590.18,-1568.74"/>
<text text-anchor="middle" x="511.18" y="-1553.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="511.18" y="-1538.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1523.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1508.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage0_layer2&#45;&gt;stage0_layer3 -->
<g id="edge3" class="edge">
<title>stage0_layer2&#45;&gt;stage0_layer3</title>
<path fill="none" stroke="black" d="M511.18,-1605.65C511.18,-1605.65 511.18,-1579.02 511.18,-1579.02"/>
<polygon fill="black" stroke="black" points="514.68,-1579.02 511.18,-1569.02 507.68,-1579.02 514.68,-1579.02"/>
</g>
<!-- stage1_layer0 -->
<g id="node6" class="node">
<title>stage1_layer0</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1413.74 432.18,-1413.74 432.18,-1345.74 590.18,-1345.74 590.18,-1413.74"/>
<text text-anchor="middle" x="511.18" y="-1398.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="511.18" y="-1383.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1368.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1353.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage0_layer3&#45;&gt;stage1_layer0 -->
<g id="edge13" class="edge">
<title>stage0_layer3&#45;&gt;stage1_layer0</title>
<path fill="none" stroke="black" d="M511.18,-1500.72C511.18,-1500.72 511.18,-1423.94 511.18,-1423.94"/>
<polygon fill="black" stroke="black" points="514.68,-1423.94 511.18,-1413.94 507.68,-1423.94 514.68,-1423.94"/>
<text text-anchor="middle" x="598.68" y="-1471.54" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
</g>
<!-- stage1_layer1 -->
<g id="node7" class="node">
<title>stage1_layer1</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1308.74 432.18,-1308.74 432.18,-1240.74 590.18,-1240.74 590.18,-1308.74"/>
<text text-anchor="middle" x="511.18" y="-1293.54" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="511.18" y="-1278.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1263.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1248.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage1_layer0&#45;&gt;stage1_layer1 -->
<g id="edge4" class="edge">
<title>stage1_layer0&#45;&gt;stage1_layer1</title>
<path fill="none" stroke="black" d="M511.18,-1345.65C511.18,-1345.65 511.18,-1319.02 511.18,-1319.02"/>
<polygon fill="black" stroke="black" points="514.68,-1319.02 511.18,-1309.02 507.68,-1319.02 514.68,-1319.02"/>
</g>
<!-- stage1_layer2 -->
<g id="node8" class="node">
<title>stage1_layer2</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1203.74 432.18,-1203.74 432.18,-1135.74 590.18,-1135.74 590.18,-1203.74"/>
<text text-anchor="middle" x="511.18" y="-1188.54" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="511.18" y="-1173.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1158.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1143.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage1_layer1&#45;&gt;stage1_layer2 -->
<g id="edge5" class="edge">
<title>stage1_layer1&#45;&gt;stage1_layer2</title>
<path fill="none" stroke="black" d="M511.18,-1240.65C511.18,-1240.65 511.18,-1214.02 511.18,-1214.02"/>
<polygon fill="black" stroke="black" points="514.68,-1214.02 511.18,-1204.02 507.68,-1214.02 514.68,-1214.02"/>
</g>
<!-- stage1_layer3 -->
<g id="node9" class="node">
<title>stage1_layer3</title>
<polygon fill="lightblue" stroke="black" points="590.18,-1098.74 432.18,-1098.74 432.18,-1030.74 590.18,-1030.74 590.18,-1098.74"/>
<text text-anchor="middle" x="511.18" y="-1083.54" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="511.18" y="-1068.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-1053.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-1038.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage1_layer2&#45;&gt;stage1_layer3 -->
<g id="edge6" class="edge">
<title>stage1_layer2&#45;&gt;stage1_layer3</title>
<path fill="none" stroke="black" d="M511.18,-1135.65C511.18,-1135.65 511.18,-1109.02 511.18,-1109.02"/>
<polygon fill="black" stroke="black" points="514.68,-1109.02 511.18,-1099.02 507.68,-1109.02 514.68,-1109.02"/>
</g>
<!-- stage2_layer0 -->
<g id="node10" class="node">
<title>stage2_layer0</title>
<polygon fill="lightblue" stroke="black" points="590.18,-943.74 432.18,-943.74 432.18,-875.74 590.18,-875.74 590.18,-943.74"/>
<text text-anchor="middle" x="511.18" y="-928.54" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="511.18" y="-913.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-898.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-883.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage1_layer3&#45;&gt;stage2_layer0 -->
<g id="edge14" class="edge">
<title>stage1_layer3&#45;&gt;stage2_layer0</title>
<path fill="none" stroke="black" d="M511.18,-1030.72C511.18,-1030.72 511.18,-953.94 511.18,-953.94"/>
<polygon fill="black" stroke="black" points="514.68,-953.94 511.18,-943.94 507.68,-953.94 514.68,-953.94"/>
<text text-anchor="middle" x="598.68" y="-1001.54" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
</g>
<!-- stage2_layer1 -->
<g id="node11" class="node">
<title>stage2_layer1</title>
<polygon fill="lightblue" stroke="black" points="590.18,-838.74 432.18,-838.74 432.18,-770.74 590.18,-770.74 590.18,-838.74"/>
<text text-anchor="middle" x="511.18" y="-823.54" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="511.18" y="-808.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-793.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-778.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage2_layer0&#45;&gt;stage2_layer1 -->
<g id="edge7" class="edge">
<title>stage2_layer0&#45;&gt;stage2_layer1</title>
<path fill="none" stroke="black" d="M511.18,-875.65C511.18,-875.65 511.18,-849.02 511.18,-849.02"/>
<polygon fill="black" stroke="black" points="514.68,-849.02 511.18,-839.02 507.68,-849.02 514.68,-849.02"/>
</g>
<!-- stage2_layer2 -->
<g id="node12" class="node">
<title>stage2_layer2</title>
<polygon fill="lightblue" stroke="black" points="590.18,-733.74 432.18,-733.74 432.18,-665.74 590.18,-665.74 590.18,-733.74"/>
<text text-anchor="middle" x="511.18" y="-718.54" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="511.18" y="-703.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-688.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-673.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage2_layer1&#45;&gt;stage2_layer2 -->
<g id="edge8" class="edge">
<title>stage2_layer1&#45;&gt;stage2_layer2</title>
<path fill="none" stroke="black" d="M511.18,-770.65C511.18,-770.65 511.18,-744.02 511.18,-744.02"/>
<polygon fill="black" stroke="black" points="514.68,-744.02 511.18,-734.02 507.68,-744.02 514.68,-744.02"/>
</g>
<!-- stage2_layer3 -->
<g id="node13" class="node">
<title>stage2_layer3</title>
<polygon fill="lightblue" stroke="black" points="590.18,-628.74 432.18,-628.74 432.18,-560.74 590.18,-560.74 590.18,-628.74"/>
<text text-anchor="middle" x="511.18" y="-613.54" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="511.18" y="-598.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-583.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-568.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage2_layer2&#45;&gt;stage2_layer3 -->
<g id="edge9" class="edge">
<title>stage2_layer2&#45;&gt;stage2_layer3</title>
<path fill="none" stroke="black" d="M511.18,-665.65C511.18,-665.65 511.18,-639.02 511.18,-639.02"/>
<polygon fill="black" stroke="black" points="514.68,-639.02 511.18,-629.02 507.68,-639.02 514.68,-639.02"/>
</g>
<!-- stage3_layer0 -->
<g id="node14" class="node">
<title>stage3_layer0</title>
<polygon fill="lightblue" stroke="black" points="590.18,-473.74 432.18,-473.74 432.18,-405.74 590.18,-405.74 590.18,-473.74"/>
<text text-anchor="middle" x="511.18" y="-458.54" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="511.18" y="-443.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-428.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-413.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage2_layer3&#45;&gt;stage3_layer0 -->
<g id="edge15" class="edge">
<title>stage2_layer3&#45;&gt;stage3_layer0</title>
<path fill="none" stroke="black" d="M511.18,-560.72C511.18,-560.72 511.18,-483.94 511.18,-483.94"/>
<polygon fill="black" stroke="black" points="514.68,-483.94 511.18,-473.94 507.68,-483.94 514.68,-483.94"/>
<text text-anchor="middle" x="598.68" y="-531.54" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
</g>
<!-- stage3_layer1 -->
<g id="node15" class="node">
<title>stage3_layer1</title>
<polygon fill="lightblue" stroke="black" points="590.18,-368.74 432.18,-368.74 432.18,-300.74 590.18,-300.74 590.18,-368.74"/>
<text text-anchor="middle" x="511.18" y="-353.54" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="511.18" y="-338.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-323.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-308.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage3_layer0&#45;&gt;stage3_layer1 -->
<g id="edge10" class="edge">
<title>stage3_layer0&#45;&gt;stage3_layer1</title>
<path fill="none" stroke="black" d="M511.18,-405.65C511.18,-405.65 511.18,-379.02 511.18,-379.02"/>
<polygon fill="black" stroke="black" points="514.68,-379.02 511.18,-369.02 507.68,-379.02 514.68,-379.02"/>
</g>
<!-- stage3_layer2 -->
<g id="node16" class="node">
<title>stage3_layer2</title>
<polygon fill="lightblue" stroke="black" points="590.18,-263.74 432.18,-263.74 432.18,-195.74 590.18,-195.74 590.18,-263.74"/>
<text text-anchor="middle" x="511.18" y="-248.54" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="511.18" y="-233.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-218.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-203.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage3_layer1&#45;&gt;stage3_layer2 -->
<g id="edge11" class="edge">
<title>stage3_layer1&#45;&gt;stage3_layer2</title>
<path fill="none" stroke="black" d="M511.18,-300.65C511.18,-300.65 511.18,-274.02 511.18,-274.02"/>
<polygon fill="black" stroke="black" points="514.68,-274.02 511.18,-264.02 507.68,-274.02 514.68,-274.02"/>
</g>
<!-- stage3_layer3 -->
<g id="node17" class="node">
<title>stage3_layer3</title>
<polygon fill="lightblue" stroke="black" points="590.18,-158.74 432.18,-158.74 432.18,-90.74 590.18,-90.74 590.18,-158.74"/>
<text text-anchor="middle" x="511.18" y="-143.54" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="511.18" y="-128.54" font-family="Times,serif" font-size="14.00">4 Layers Total</text>
<text text-anchor="middle" x="511.18" y="-113.54" font-family="Times,serif" font-size="14.00">TP=4, EP=8, DP=4</text>
<text text-anchor="middle" x="511.18" y="-98.54" font-family="Times,serif" font-size="14.00">8 Experts/GPU</text>
</g>
<!-- stage3_layer2&#45;&gt;stage3_layer3 -->
<g id="edge12" class="edge">
<title>stage3_layer2&#45;&gt;stage3_layer3</title>
<path fill="none" stroke="black" d="M511.18,-195.65C511.18,-195.65 511.18,-169.02 511.18,-169.02"/>
<polygon fill="black" stroke="black" points="514.68,-169.02 511.18,-159.02 507.68,-169.02 514.68,-169.02"/>
</g>
<!-- output -->
<g id="node18" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="511.18" cy="-26.87" rx="208.69" ry="26.74"/>
<text text-anchor="middle" x="511.18" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="511.18" y="-15.67" font-family="Times,serif" font-size="14.00">[batch=128, seq=1024, vocab=51200]</text>
</g>
<!-- stage3_layer3&#45;&gt;output -->
<g id="edge16" class="edge">
<title>stage3_layer3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M511.18,-90.51C511.18,-90.51 511.18,-63.84 511.18,-63.84"/>
<polygon fill="black" stroke="black" points="514.68,-63.84 511.18,-53.84 507.68,-63.84 514.68,-63.84"/>
</g>
</g>
</svg>
