digraph LLaMA_7B_HPipe {
    rankdir=LR;
    node [shape=box, style=rounded];
    
    // Input node
    input [label="Input\n(Sequence)"];
    
    // Device layers
    P100_0_layer1 [label="P100_0\nLayer 1"];
    P100_0_layer2 [label="P100_0\nLayer 2"];
    P100_0_layer3 [label="P100_0\nLayer 3"];
    P100_0_layer4 [label="P100_0\nLayer 4"];
    P100_0_layer5 [label="P100_0\nLayer 5"];
    
    P100_1_layer6 [label="P100_1\nLayer 6"];
    P100_1_layer7 [label="P100_1\nLayer 7"];
    P100_1_layer8 [label="P100_1\nLayer 8"];
    P100_1_layer9 [label="P100_1\nLayer 9"];
    P100_1_layer10 [label="P100_1\nLayer 10"];
    P100_1_layer11 [label="P100_1\nLayer 11"];
    
    P100_2_layer12 [label="P100_2\nLayer 12"];
    P100_2_layer13 [label="P100_2\nLayer 13"];
    P100_2_layer14 [label="P100_2\nLayer 14"];
    P100_2_layer15 [label="P100_2\nLayer 15"];
    P100_2_layer16 [label="P100_2\nLayer 16"];
    P100_2_layer17 [label="P100_2\nLayer 17"];
    P100_2_layer18 [label="P100_2\nLayer 18"];
    
    P100_3_layer19 [label="P100_3\nLayer 19"];
    P100_3_layer20 [label="P100_3\nLayer 20"];
    P100_3_layer21 [label="P100_3\nLayer 21"];
    P100_3_layer22 [label="P100_3\nLayer 22"];
    P100_3_layer23 [label="P100_3\nLayer 23"];
    
    RTX3090_0_layer24 [label="RTX3090_0\nLayer 24"];
    RTX3090_0_layer25 [label="RTX3090_0\nLayer 25"];
    RTX3090_0_layer26 [label="RTX3090_0\nLayer 26"];
    RTX3090_0_layer27 [label="RTX3090_0\nLayer 27"];
    RTX3090_0_layer28 [label="RTX3090_0\nLayer 28"];
    RTX3090_0_layer29 [label="RTX3090_0\nLayer 29"];
    
    RTX3090_1_layer30 [label="RTX3090_1\nLayer 30"];
    RTX3090_1_layer31 [label="RTX3090_1\nLayer 31"];
    RTX3090_1_layer32 [label="RTX3090_1\nLayer 32"];
    
    // Output node
    output [label="Output\n(Logits)"];
    
    // Edges connecting the pipeline
    input -> P100_0_layer1;
    P100_0_layer1 -> P100_0_layer2;
    P100_0_layer2 -> P100_0_layer3;
    P100_0_layer3 -> P100_0_layer4;
    P100_0_layer4 -> P100_0_layer5;
    P100_0_layer5 -> P100_1_layer6;
    P100_1_layer6 -> P100_1_layer7;
    P100_1_layer7 -> P100_1_layer8;
    P100_1_layer8 -> P100_1_layer9;
    P100_1_layer9 -> P100_1_layer10;
    P100_1_layer10 -> P100_1_layer11;
    P100_1_layer11 -> P100_2_layer12;
    P100_2_layer12 -> P100_2_layer13;
    P100_2_layer13 -> P100_2_layer14;
    P100_2_layer14 -> P100_2_layer15;
    P100_2_layer15 -> P100_2_layer16;
    P100_2_layer16 -> P100_2_layer17;
    P100_2_layer17 -> P100_2_layer18;
    P100_2_layer18 -> P100_3_layer19;
    P100_3_layer19 -> P100_3_layer20;
    P100_3_layer20 -> P100_3_layer21;
    P100_3_layer21 -> P100_3_layer22;
    P100_3_layer22 -> P100_3_layer23;
    P100_3_layer23 -> RTX3090_0_layer24;
    RTX3090_0_layer24 -> RTX3090_0_layer25;
    RTX3090_0_layer25 -> RTX3090_0_layer26;
    RTX3090_0_layer26 -> RTX3090_0_layer27;
    RTX3090_0_layer27 -> RTX3090_0_layer28;
    RTX3090_0_layer28 -> RTX3090_0_layer29;
    RTX3090_0_layer29 -> RTX3090_1_layer30;
    RTX3090_1_layer30 -> RTX3090_1_layer31;
    RTX3090_1_layer31 -> RTX3090_1_layer32;
    RTX3090_1_layer32 -> output;
}