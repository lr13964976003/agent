digraph GPT3_2B_HPipe {
    rankdir=LR;
    node [shape=box, style=rounded];
    
    // Input node
    input [label="Input\n(Sequence)"];
    
    // Device layers
    P100_0_layer1 [label="P100_0\nLayer 1"];
    P100_0_layer2 [label="P100_0\nLayer 2"];
    P100_0_layer3 [label="P100_0\nLayer 3"];
    P100_0_layer4 [label="P100_0\nLayer 4"];
    
    P100_1_layer5 [label="P100_1\nLayer 5"];
    P100_1_layer6 [label="P100_1\nLayer 6"];
    P100_1_layer7 [label="P100_1\nLayer 7"];
    P100_1_layer8 [label="P100_1\nLayer 8"];
    
    P100_2_layer9 [label="P100_2\nLayer 9"];
    P100_2_layer10 [label="P100_2\nLayer 10"];
    P100_2_layer11 [label="P100_2\nLayer 11"];
    P100_2_layer12 [label="P100_2\nLayer 12"];
    
    RTX3090_0_layer13 [label="RTX3090_0\nLayer 13"];
    RTX3090_0_layer14 [label="RTX3090_0\nLayer 14"];
    RTX3090_0_layer15 [label="RTX3090_0\nLayer 15"];
    RTX3090_0_layer16 [label="RTX3090_0\nLayer 16"];
    RTX3090_0_layer17 [label="RTX3090_0\nLayer 17"];
    RTX3090_0_layer18 [label="RTX3090_0\nLayer 18"];
    
    RTX3090_1_layer19 [label="RTX3090_1\nLayer 19"];
    RTX3090_1_layer20 [label="RTX3090_1\nLayer 20"];
    RTX3090_1_layer21 [label="RTX3090_1\nLayer 21"];
    RTX3090_1_layer22 [label="RTX3090_1\nLayer 22"];
    RTX3090_1_layer23 [label="RTX3090_1\nLayer 23"];
    RTX3090_1_layer24 [label="RTX3090_1\nLayer 24"];
    
    // Output node
    output [label="Output\n(Logits)"];
    
    // Edges connecting the pipeline
    input -> P100_0_layer1;
    P100_0_layer1 -> P100_0_layer2;
    P100_0_layer2 -> P100_0_layer3;
    P100_0_layer3 -> P100_0_layer4;
    P100_0_layer4 -> P100_1_layer5;
    P100_1_layer5 -> P100_1_layer6;
    P100_1_layer6 -> P100_1_layer7;
    P100_1_layer7 -> P100_1_layer8;
    P100_1_layer8 -> P100_2_layer9;
    P100_2_layer9 -> P100_2_layer10;
    P100_2_layer10 -> P100_2_layer11;
    P100_2_layer11 -> P100_2_layer12;
    P100_2_layer12 -> RTX3090_0_layer13;
    RTX3090_0_layer13 -> RTX3090_0_layer14;
    RTX3090_0_layer14 -> RTX3090_0_layer15;
    RTX3090_0_layer15 -> RTX3090_0_layer16;
    RTX3090_0_layer16 -> RTX3090_0_layer17;
    RTX3090_0_layer17 -> RTX3090_0_layer18;
    RTX3090_0_layer18 -> RTX3090_1_layer19;
    RTX3090_1_layer19 -> RTX3090_1_layer20;
    RTX3090_1_layer20 -> RTX3090_1_layer21;
    RTX3090_1_layer21 -> RTX3090_1_layer22;
    RTX3090_1_layer22 -> RTX3090_1_layer23;
    RTX3090_1_layer23 -> RTX3090_1_layer24;
    RTX3090_1_layer24 -> output;
}